```diff
diff --git a/Android.bp b/Android.bp
index b7f2478..37ab91e 100644
--- a/Android.bp
+++ b/Android.bp
@@ -244,3 +244,20 @@ filegroup {
         ":NotoSerifYezidi-VF",
     ],
 }
+
+bootstrap_go_package {
+    name: "soong-noto-fonts",
+    pkgPath: "android/soong/external/noto-fonts",
+    deps: [
+        "blueprint",
+        "blueprint-pathtools",
+        "soong",
+        "soong-android",
+        "soong-cc",
+        "soong-genrule",
+    ],
+    srcs: [
+        "noto-fonts.go",
+    ],
+    pluginFor: ["soong_build"],
+}
diff --git a/OWNERS b/OWNERS
index b3e957c..82c4271 100644
--- a/OWNERS
+++ b/OWNERS
@@ -6,3 +6,4 @@ file:platform/frameworks/base:/core/java/android/text/OWNERS
 # Upstream font owners
 marekj@google.com
 rsheeter@google.com
+include platform/system/core:/janitors/OWNERS #{LAST_RESORT_SUGGESTION}
diff --git a/PREUPLOAD.cfg b/PREUPLOAD.cfg
new file mode 100644
index 0000000..7fa5739
--- /dev/null
+++ b/PREUPLOAD.cfg
@@ -0,0 +1,3 @@
+# go/agcp/tools/repohooks/
+[Builtin Hooks]
+bpfmt = true
diff --git a/emoji-compat-flatbuffers/Android.bp b/emoji-compat-flatbuffers/Android.bp
index 5230667..65aeae8 100644
--- a/emoji-compat-flatbuffers/Android.bp
+++ b/emoji-compat-flatbuffers/Android.bp
@@ -19,9 +19,20 @@ package {
     ],
 }
 
+genrule {
+    name: "noto-emoji-compat-flatbuffers-generated-java",
+    srcs: ["data/emoji_metadata.fbs"],
+    out: [
+        "androidx/text/emoji/flatbuffer/MetadataItem.java",
+        "androidx/text/emoji/flatbuffer/MetadataList.java",
+    ],
+    cmd: "$(location flatc) --java -o $(genDir) $(in)",
+    tools: ["flatc"],
+}
+
 java_library {
     name: "noto-emoji-compat-flatbuffers-java",
-    srcs: ["src/java/**/*.java"],
+    srcs: [":noto-emoji-compat-flatbuffers-generated-java"],
     sdk_version: "current",
 
     static_libs: ["flatbuffers-java"],
diff --git a/emoji-compat-flatbuffers/src/java/androidx/text/emoji/flatbuffer/MetadataItem.java b/emoji-compat-flatbuffers/src/java/androidx/text/emoji/flatbuffer/MetadataItem.java
deleted file mode 100644
index 7986a52..0000000
--- a/emoji-compat-flatbuffers/src/java/androidx/text/emoji/flatbuffer/MetadataItem.java
+++ /dev/null
@@ -1,89 +0,0 @@
-// CHECKSTYLE:OFF Generated code
-/*
- * Copyright (C) 2017 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-// automatically generated by the FlatBuffers compiler, do not modify
-
-package androidx.text.emoji.flatbuffer;
-
-import java.nio.*;
-import java.lang.*;
-import java.util.*;
-import com.google.flatbuffers.*;
-
-@SuppressWarnings("unused")
-public final class MetadataItem extends Table {
-  public static void ValidateVersion() { Constants.FLATBUFFERS_2_0_0(); }
-  public static MetadataItem getRootAsMetadataItem(ByteBuffer _bb) { return getRootAsMetadataItem(_bb, new MetadataItem()); }
-  public static MetadataItem getRootAsMetadataItem(ByteBuffer _bb, MetadataItem obj) { _bb.order(ByteOrder.LITTLE_ENDIAN); return (obj.__assign(_bb.getInt(_bb.position()) + _bb.position(), _bb)); }
-  public void __init(int _i, ByteBuffer _bb) { __reset(_i, _bb); }
-  public MetadataItem __assign(int _i, ByteBuffer _bb) { __init(_i, _bb); return this; }
-
-  public int id() { int o = __offset(4); return o != 0 ? bb.getInt(o + bb_pos) : 0; }
-  public boolean emojiStyle() { int o = __offset(6); return o != 0 ? 0!=bb.get(o + bb_pos) : false; }
-  public short sdkAdded() { int o = __offset(8); return o != 0 ? bb.getShort(o + bb_pos) : 0; }
-  public short compatAdded() { int o = __offset(10); return o != 0 ? bb.getShort(o + bb_pos) : 0; }
-  public short width() { int o = __offset(12); return o != 0 ? bb.getShort(o + bb_pos) : 0; }
-  public short height() { int o = __offset(14); return o != 0 ? bb.getShort(o + bb_pos) : 0; }
-  public int codepoints(int j) { int o = __offset(16); return o != 0 ? bb.getInt(__vector(o) + j * 4) : 0; }
-  public int codepointsLength() { int o = __offset(16); return o != 0 ? __vector_len(o) : 0; }
-  public IntVector codepointsVector() { return codepointsVector(new IntVector()); }
-  public IntVector codepointsVector(IntVector obj) { int o = __offset(16); return o != 0 ? obj.__assign(__vector(o), bb) : null; }
-  public ByteBuffer codepointsAsByteBuffer() { return __vector_as_bytebuffer(16, 4); }
-  public ByteBuffer codepointsInByteBuffer(ByteBuffer _bb) { return __vector_in_bytebuffer(_bb, 16, 4); }
-
-  public static int createMetadataItem(FlatBufferBuilder builder,
-      int id,
-      boolean emojiStyle,
-      short sdkAdded,
-      short compatAdded,
-      short width,
-      short height,
-      int codepointsOffset) {
-    builder.startTable(7);
-    MetadataItem.addCodepoints(builder, codepointsOffset);
-    MetadataItem.addId(builder, id);
-    MetadataItem.addHeight(builder, height);
-    MetadataItem.addWidth(builder, width);
-    MetadataItem.addCompatAdded(builder, compatAdded);
-    MetadataItem.addSdkAdded(builder, sdkAdded);
-    MetadataItem.addEmojiStyle(builder, emojiStyle);
-    return MetadataItem.endMetadataItem(builder);
-  }
-
-  public static void startMetadataItem(FlatBufferBuilder builder) { builder.startTable(7); }
-  public static void addId(FlatBufferBuilder builder, int id) { builder.addInt(0, id, 0); }
-  public static void addEmojiStyle(FlatBufferBuilder builder, boolean emojiStyle) { builder.addBoolean(1, emojiStyle, false); }
-  public static void addSdkAdded(FlatBufferBuilder builder, short sdkAdded) { builder.addShort(2, sdkAdded, 0); }
-  public static void addCompatAdded(FlatBufferBuilder builder, short compatAdded) { builder.addShort(3, compatAdded, 0); }
-  public static void addWidth(FlatBufferBuilder builder, short width) { builder.addShort(4, width, 0); }
-  public static void addHeight(FlatBufferBuilder builder, short height) { builder.addShort(5, height, 0); }
-  public static void addCodepoints(FlatBufferBuilder builder, int codepointsOffset) { builder.addOffset(6, codepointsOffset, 0); }
-  public static int createCodepointsVector(FlatBufferBuilder builder, int[] data) { builder.startVector(4, data.length, 4); for (int i = data.length - 1; i >= 0; i--) builder.addInt(data[i]); return builder.endVector(); }
-  public static void startCodepointsVector(FlatBufferBuilder builder, int numElems) { builder.startVector(4, numElems, 4); }
-  public static int endMetadataItem(FlatBufferBuilder builder) {
-    int o = builder.endTable();
-    return o;
-  }
-
-  public static final class Vector extends BaseVector {
-    public Vector __assign(int _vector, int _element_size, ByteBuffer _bb) { __reset(_vector, _element_size, _bb); return this; }
-
-    public MetadataItem get(int j) { return get(new MetadataItem(), j); }
-    public MetadataItem get(MetadataItem obj, int j) {  return obj.__assign(__indirect(__element(j), bb), bb); }
-  }
-}
-
diff --git a/emoji-compat-flatbuffers/src/java/androidx/text/emoji/flatbuffer/MetadataList.java b/emoji-compat-flatbuffers/src/java/androidx/text/emoji/flatbuffer/MetadataList.java
deleted file mode 100644
index fb6822c..0000000
--- a/emoji-compat-flatbuffers/src/java/androidx/text/emoji/flatbuffer/MetadataList.java
+++ /dev/null
@@ -1,76 +0,0 @@
-// CHECKSTYLE:OFF Generated code
-/*
- * Copyright (C) 2017 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-// automatically generated by the FlatBuffers compiler, do not modify
-
-package androidx.text.emoji.flatbuffer;
-
-import java.nio.*;
-import java.lang.*;
-import java.util.*;
-import com.google.flatbuffers.*;
-
-@SuppressWarnings("unused")
-public final class MetadataList extends Table {
-  public static void ValidateVersion() { Constants.FLATBUFFERS_2_0_0(); }
-  public static MetadataList getRootAsMetadataList(ByteBuffer _bb) { return getRootAsMetadataList(_bb, new MetadataList()); }
-  public static MetadataList getRootAsMetadataList(ByteBuffer _bb, MetadataList obj) { _bb.order(ByteOrder.LITTLE_ENDIAN); return (obj.__assign(_bb.getInt(_bb.position()) + _bb.position(), _bb)); }
-  public void __init(int _i, ByteBuffer _bb) { __reset(_i, _bb); }
-  public MetadataList __assign(int _i, ByteBuffer _bb) { __init(_i, _bb); return this; }
-
-  public int version() { int o = __offset(4); return o != 0 ? bb.getInt(o + bb_pos) : 0; }
-  public androidx.text.emoji.flatbuffer.MetadataItem list(int j) { return list(new androidx.text.emoji.flatbuffer.MetadataItem(), j); }
-  public androidx.text.emoji.flatbuffer.MetadataItem list(androidx.text.emoji.flatbuffer.MetadataItem obj, int j) { int o = __offset(6); return o != 0 ? obj.__assign(__indirect(__vector(o) + j * 4), bb) : null; }
-  public int listLength() { int o = __offset(6); return o != 0 ? __vector_len(o) : 0; }
-  public androidx.text.emoji.flatbuffer.MetadataItem.Vector listVector() { return listVector(new androidx.text.emoji.flatbuffer.MetadataItem.Vector()); }
-  public androidx.text.emoji.flatbuffer.MetadataItem.Vector listVector(androidx.text.emoji.flatbuffer.MetadataItem.Vector obj) { int o = __offset(6); return o != 0 ? obj.__assign(__vector(o), 4, bb) : null; }
-  public String sourceSha() { int o = __offset(8); return o != 0 ? __string(o + bb_pos) : null; }
-  public ByteBuffer sourceShaAsByteBuffer() { return __vector_as_bytebuffer(8, 1); }
-  public ByteBuffer sourceShaInByteBuffer(ByteBuffer _bb) { return __vector_in_bytebuffer(_bb, 8, 1); }
-
-  public static int createMetadataList(FlatBufferBuilder builder,
-      int version,
-      int listOffset,
-      int sourceShaOffset) {
-    builder.startTable(3);
-    MetadataList.addSourceSha(builder, sourceShaOffset);
-    MetadataList.addList(builder, listOffset);
-    MetadataList.addVersion(builder, version);
-    return MetadataList.endMetadataList(builder);
-  }
-
-  public static void startMetadataList(FlatBufferBuilder builder) { builder.startTable(3); }
-  public static void addVersion(FlatBufferBuilder builder, int version) { builder.addInt(0, version, 0); }
-  public static void addList(FlatBufferBuilder builder, int listOffset) { builder.addOffset(1, listOffset, 0); }
-  public static int createListVector(FlatBufferBuilder builder, int[] data) { builder.startVector(4, data.length, 4); for (int i = data.length - 1; i >= 0; i--) builder.addOffset(data[i]); return builder.endVector(); }
-  public static void startListVector(FlatBufferBuilder builder, int numElems) { builder.startVector(4, numElems, 4); }
-  public static void addSourceSha(FlatBufferBuilder builder, int sourceShaOffset) { builder.addOffset(2, sourceShaOffset, 0); }
-  public static int endMetadataList(FlatBufferBuilder builder) {
-    int o = builder.endTable();
-    return o;
-  }
-  public static void finishMetadataListBuffer(FlatBufferBuilder builder, int offset) { builder.finish(offset); }
-  public static void finishSizePrefixedMetadataListBuffer(FlatBufferBuilder builder, int offset) { builder.finishSizePrefixed(offset); }
-
-  public static final class Vector extends BaseVector {
-    public Vector __assign(int _vector, int _element_size, ByteBuffer _bb) { __reset(_vector, _element_size, _bb); return this; }
-
-    public MetadataList get(int j) { return get(new MetadataList(), j); }
-    public MetadataList get(MetadataList obj, int j) {  return obj.__assign(__indirect(__element(j), bb), bb); }
-  }
-}
-
diff --git a/emoji-compat/Android.bp b/emoji-compat/Android.bp
index 92ac0cf..4e67d49 100644
--- a/emoji-compat/Android.bp
+++ b/emoji-compat/Android.bp
@@ -46,48 +46,24 @@ license {
     ],
 }
 
-soong_config_module_type {
-    name: "prebuilt_emoji_font",
-    module_type: "prebuilt_font",
-    config_namespace: "emoji_font",
-    value_variables: ["emoji_font_version"],
-    properties: ["src"],
-}
-
-prebuilt_emoji_font {
+prebuilt_versioned_font {
     name: "NotoColorEmoji.ttf",
     dist: {
         targets: ["droidcore"],
     },
-    // Need a default value because SDK build doesn't include fonts.mk.
-    src: "font/2.047/Noto-COLRv1-noflags.ttf",
-    soong_config_variables: {
-        emoji_font_version: {
-            src: "font/%s/Noto-COLRv1-noflags.ttf",
-        },
-    },
+    fontFile: "Noto-COLRv1-noflags.ttf",
+    versionFlag: "RELEASE_PACKAGE_EMOJI_FONT_VERSION",
+    defaultVersion: "2.047",
 }
 
-soong_config_module_type {
-    name: "prebuilt_flag_emoji_font",
-    module_type: "prebuilt_font",
-    config_namespace: "flag_emoji_font",
-    value_variables: ["flag_emoji_font_version"],
-    properties: ["src"],
-}
-
-prebuilt_flag_emoji_font {
+prebuilt_versioned_font {
     name: "NotoColorEmojiFlags.ttf",
     dist: {
         targets: ["droidcore"],
     },
-    // Need a default value because SDK build doesn't include fonts.mk.
-    src: "font/2.047/NotoColorEmoji-flagsonly.ttf",
-    soong_config_variables: {
-        flag_emoji_font_version: {
-            src: "font/%s/NotoColorEmoji-flagsonly.ttf",
-        },
-    },
+    fontFile: "NotoColorEmoji-flagsonly.ttf",
+    versionFlag: "RELEASE_PACKAGE_EMOJI_FONT_VERSION",
+    defaultVersion: "2.047",
 }
 
 prebuilt_font {
diff --git a/fonts.mk b/fonts.mk
index a9839fa..0b6f06d 100644
--- a/fonts.mk
+++ b/fonts.mk
@@ -16,12 +16,6 @@
 # PRODUCT_COPY_FILES to install the font files, so that the NOTICE file can
 # get installed too.
 
-# Set emoji version in Android.bp
-$(call soong_config_set,emoji_font,emoji_font_version,$(RELEASE_PACKAGE_EMOJI_FONT_VERSION))
-$(call soong_config_set,flag_emoji_font,flag_emoji_font_version,$(RELEASE_PACKAGE_FLAG_EMOJI_FONT_VERSION))
-
-$(call soong_config_set,noto_fonts,notosanskhmer_ver,$(RELEASE_PACKAGE_NOTO_SANS_KHMER_VERSION))
-
 PRODUCT_PACKAGES := \
     $(PRODUCT_PACKAGES) \
     NotoColorEmoji.ttf \
@@ -215,7 +209,3 @@ PRODUCT_PACKAGES := \
     NotoSerifThai-Regular.ttf \
     NotoSerifTibetan-VF.ttf \
     NotoSerifYezidi-VF.ttf
-
-
-# Set Hebrew font version
-$(call soong_config_set,hebrew_font,hebrew_font_version,$(RELEASE_PACKAGE_HEBREW_FONT_VERSION))
diff --git a/noto-fonts.go b/noto-fonts.go
new file mode 100644
index 0000000..0c86fae
--- /dev/null
+++ b/noto-fonts.go
@@ -0,0 +1,157 @@
+package noto_fonts
+import (
+  "android/soong/android"
+  "fmt"
+  prebuilt_etc "android/soong/etc"
+  "os"
+)
+
+type fontProperties struct {
+  // An optional font file of the versioned font files.
+  // If not provided, the module name is used instead.
+  FontFile string
+
+  // An optional directory that contains versioned files.
+  // If not provided, "font" is used instead.
+  VersionDir string
+
+  // A mandatory version flag used for controlling versioning.
+  VersionFlag string
+
+  // A mandatory version string used for environment that does not have build flags, e.g. SDK build.
+  DefaultVersion string
+}
+
+type configProperties struct {
+  // An optional font file of the versioned font files.
+  // If not provided, "font_config.json" is used instead.
+  ConfigFile string
+
+  // An optional directory that contains versioned font files.
+  // If not provided, "font" is used instead.
+  VersionDir string
+
+  // A mandatory version flag used for controlling versioning.
+  VersionFlag string
+
+  // A mandatory version string used for environment that does not have build flags, e.g. SDK build.
+  DefaultVersion string
+}
+
+func init() {
+  android.RegisterModuleType("prebuilt_versioned_font", prebuiltVersionedFontFactory)
+  android.RegisterModuleType("versioned_font_config", versionedFontConfigFactory)
+}
+
+///////////////////////////////////////////////////////////////////////////////
+// prebuilt_versioned_font definition
+///////////////////////////////////////////////////////////////////////////////
+func prebuiltVersionedFontFactory() (android.Module) {
+  // Inherit prebuilt_font module
+  module := prebuilt_etc.PrebuiltFontFactory()
+  module.AddProperties(&fontProperties{})
+  android.AddLoadHook(module, prebuiltVersionFont)
+  return module
+}
+
+func prebuiltVersionFont(ctx android.LoadHookContext) {
+  // Find fontProperties propery from the property list.
+  var fontProp *fontProperties
+  for _, p := range ctx.Module().GetProperties() {
+      _fontProp, ok := p.(*fontProperties)
+      if ok {
+        fontProp = _fontProp
+      }
+  }
+
+  // Check if the default version is specified.
+  defaultVersion := fontProp.DefaultVersion
+  if len(defaultVersion) == 0 {
+    fmt.Printf("defaultVersion is required for SDK build")
+    os.Exit(1)
+  }
+
+  // Read the version number from build flag.
+  // The build flag may not be present, in such case, use default value instead.
+  version, ok := ctx.Config().GetBuildFlag(fontProp.VersionFlag)
+  if !ok {
+    fmt.Printf("No value set to Build Flag %s. Use default version instead.", fontProp.VersionFlag)
+    version = defaultVersion
+  }
+
+  // If no VersionDir is specified, use "font" as a default.
+  if len(fontProp.VersionDir) == 0 {
+    fontProp.VersionDir = "font"
+  }
+
+  // If no FontFile is specified, use module name as a default.
+  if len(fontProp.FontFile) == 0 {
+    fontProp.FontFile = ctx.Module().Name()
+  }
+
+  // Override the src property with newly generated one.
+  type props struct {
+    Src string
+  }
+  p := &props{}
+  p.Src = fontProp.VersionDir + "/" + version + "/" + fontProp.FontFile
+  ctx.AppendProperties(p)
+}
+
+
+///////////////////////////////////////////////////////////////////////////////
+// versioned_font_config definition
+///////////////////////////////////////////////////////////////////////////////
+func versionedFontConfigFactory() (android.Module) {
+  // Inherit filegroup module
+  module := android.FileGroupFactory()
+  module.AddProperties(&configProperties{})
+  android.AddLoadHook(module, versionedFontConfig)
+  return module
+}
+
+func versionedFontConfig(ctx android.LoadHookContext) {
+  // Find fontProperties propery from the property list.
+  var configProp *configProperties
+  for _, p := range ctx.Module().GetProperties() {
+      _configProp, ok := p.(*configProperties)
+      if ok {
+        configProp = _configProp
+      }
+  }
+
+  // Check if the default version is specified.
+  defaultVersion := configProp.DefaultVersion
+  if len(defaultVersion) == 0 {
+    fmt.Printf("defaultVersion is required for SDK build")
+    os.Exit(1)
+  }
+
+  // Read the version number from build flag.
+  // The build flag may not be present, in such case, use default value instead.
+  version, ok := ctx.Config().GetBuildFlag(configProp.VersionFlag)
+  if !ok {
+    fmt.Printf("No value set to Build Flag %s. Use default version instead.", configProp.VersionFlag)
+    version = defaultVersion
+  }
+
+  // If no VersionDir is specified, use "font" as a default.
+  if len(configProp.VersionDir) == 0 {
+    configProp.VersionDir = "font"
+  }
+
+  // If no ConfigFile is specified, use font_config.json instead
+  if len(configProp.ConfigFile) == 0 {
+    configProp.ConfigFile = "font_config.json"
+  }
+
+  // Override the src property with newly generated one.
+  type props struct {
+    Srcs []string
+  }
+  p := &props{}
+  p.Srcs = make([]string, 1)
+  p.Srcs[0] = configProp.VersionDir + "/" + version + "/" + configProp.ConfigFile
+  ctx.AppendProperties(p)
+}
+
diff --git a/notosanshebrew/Android.bp b/notosanshebrew/Android.bp
index 5faa58d..b059fff 100644
--- a/notosanshebrew/Android.bp
+++ b/notosanshebrew/Android.bp
@@ -45,32 +45,18 @@ license {
     ],
 }
 
-soong_config_module_type {
-    name: "prebuilt_hebrew_font",
-    module_type: "prebuilt_font",
-    config_namespace: "hebrew_font",
-    value_variables: ["hebrew_font_version"],
-    properties: ["src"],
-}
-
-prebuilt_hebrew_font {
+prebuilt_versioned_font {
     name: "NotoSansHebrew-Regular.ttf",
-    src: "1.04/NotoSansHebrew-Regular.ttf",
-    soong_config_variables: {
-        hebrew_font_version: {
-            src: "%s/NotoSansHebrew-Regular.ttf",
-        },
-    },
+    versionDir: ".",
+    versionFlag: "RELEASE_PACKAGE_HEBREW_FONT_VERSION",
+    defaultVersion: "1.04",
 }
 
-prebuilt_hebrew_font {
+prebuilt_versioned_font {
     name: "NotoSansHebrew-Bold.ttf",
-    src: "1.04/NotoSansHebrew-Bold.ttf",
-    soong_config_variables: {
-        hebrew_font_version: {
-            src: "./%s/NotoSansHebrew-Bold.ttf",
-        },
-    },
+    versionDir: ".",
+    versionFlag: "RELEASE_PACKAGE_HEBREW_FONT_VERSION",
+    defaultVersion: "1.04",
 }
 
 filegroup {
diff --git a/notosanskhmer/Android.bp b/notosanskhmer/Android.bp
index 52ffd3b..f8c1318 100644
--- a/notosanskhmer/Android.bp
+++ b/notosanskhmer/Android.bp
@@ -45,45 +45,19 @@ license {
     ],
 }
 
-soong_config_module_type {
-    name: "prebuilt_notosanskhmer",
-    module_type: "prebuilt_font",
-    config_namespace: "noto_fonts",
-    value_variables: ["notosanskhmer_ver"],
-    properties: ["src"],
-}
-
-prebuilt_notosanskhmer {
+prebuilt_versioned_font {
     name: "NotoSansKhmer-VF.ttf",
-    soong_config_variables: {
-        notosanskhmer_ver: {
-            src: "%s/NotoSansKhmer-VF.ttf",
-            conditions_default: {
-                src: "1.901/NotoSansKhmer-VF.ttf"
-            }
-        },
-    },
-}
-
-soong_config_module_type {
-    name: "filegroup_notosanskhmer",
-    module_type: "filegroup",
-    config_namespace: "noto_fonts",
-    value_variables: ["notosanskhmer_ver"],
-    properties: ["srcs"],
+    versionDir: ".",
+    versionFlag: "RELEASE_PACKAGE_NOTO_SANS_KHMER_VERSION",
+    defaultVersion: "1.901",
 }
 
-filegroup_notosanskhmer {
+versioned_font_config {
     name: "NotoSansKhmer-VF",
     required: [
         "NotoSansKhmer-VF.ttf"
     ],
-    soong_config_variables: {
-        notosanskhmer_ver: {
-          srcs: ["%s/font_config.json"],
-          conditions_default: {
-              srcs: ["1.901/font_config.json"],
-          },
-        }
-    }
+    versionDir: ".",
+    versionFlag: "RELEASE_PACKAGE_NOTO_SANS_KHMER_VERSION",
+    defaultVersion: "1.901",
 }
```

