```diff
diff --git a/TEST_MAPPING b/TEST_MAPPING
index f8b1644d42..4a0f5c8b1c 100644
--- a/TEST_MAPPING
+++ b/TEST_MAPPING
@@ -25,12 +25,52 @@
       "name": "hal_implementation_test"
     },
     {
-      "name": "CarLibDeviceUnitTest"
-    }
-  ],
-  "ravenwood-presubmit": [
+      "name": "CarServiceCarTest"
+    },
+    {
+      "name": "CarServiceClusterTest"
+    },
+    {
+      "name": "CarServiceDiagnosticTest"
+    },
+    {
+      "name": "CarServiceDrivingStateTest"
+    },
+    {
+      "name": "CarServiceEvsTest"
+    },
+    {
+      "name": "CarServiceGarageModeTest"
+    },
+    {
+      "name": "CarServiceInputTest"
+    },
+    {
+      "name": "CarServiceOsTest"
+    },
+    {
+      "name": "CarServicePmTest"
+    },
+    {
+      "name": "CarServicePowerTest"
+    },
+    {
+      "name": "CarServicePropertyTest"
+    },
+    {
+      "name": "CarServiceRemoteAccessTest"
+    },
+    {
+      "name": "CarServiceStorageMonitoringTest"
+    },
+    {
+      "name": "CarServiceTelemetryTest"
+    },
+    {
+      "name": "CarServiceVmsTest"
+    },
     {
-      "name": "CarLibHostUnitTest"
+      "name": "CarServiceWatchdogTest"
     }
   ]
 }
diff --git a/aconfig/Android.bp b/aconfig/Android.bp
index 0a655f93aa..ecd8e9f5b5 100644
--- a/aconfig/Android.bp
+++ b/aconfig/Android.bp
@@ -22,9 +22,11 @@ java_defaults {
     libs: [
         // Add aconfig-annotations-lib as a dependency for the optimization
         "aconfig-annotations-lib",
+        // Add aconfig new storage reader library for flag reading in flag codegen.
+        "aconfig_storage_reader_java",
         // TODO(b/303773055): Remove the annotation after access issue is resolved.
         "unsupportedappusage",
-        "framework-configinfrastructure",
+        "framework-configinfrastructure.stubs.module_lib",
     ],
 }
 
diff --git a/aconfig/flags.aconfig b/aconfig/flags.aconfig
index 433db6ff9d..a009ae82b1 100644
--- a/aconfig/flags.aconfig
+++ b/aconfig/flags.aconfig
@@ -10,6 +10,25 @@ flag {
   bug: "320545306"
 }
 
+flag {
+  name: "visible_background_user_restrictions"
+  is_exported: true
+  namespace: "car_framework"
+  description: "Apply user restrictions on visible background users"
+  bug: "356522177"
+  metadata {
+      purpose: PURPOSE_BUGFIX
+  }
+}
+
+flag {
+  name: "supports_secure_passenger_users"
+  is_exported: true
+  namespace: "car_framework"
+  description: "Support secure users to run as passengers"
+  bug: "367787957"
+}
+
 # CarPackageManager
 flag {
   name: "display_compatibility"
@@ -28,6 +47,13 @@ flag {
   bug: "281791498"
 }
 
+flag {
+  name: "use_wifi_manager_for_available_channels"
+  namespace: "car_framework"
+  description: "This flag controls if apps can query available WiFi channels using the WifiManager."
+  bug: "325395533"
+}
+
 # CarRemoteAccessManager
 flag {
   name: "serverless_remote_access"
@@ -55,6 +81,16 @@ flag {
   }
 }
 
+flag {
+  name: "multi_display_brightness_control"
+  namespace: "car_framework"
+  description: "Support multi display brightness control"
+  bug: "356419293"
+  metadata {
+    purpose: PURPOSE_BUGFIX
+  }
+}
+
 flag {
   name: "car_power_cancel_shell_command"
   is_exported: true
@@ -70,6 +106,13 @@ flag {
   bug: "324593655"
 }
 
+flag {
+  name: "change_swaps_during_suspend_to_disk"
+  namespace: "car_framework"
+  description: "Controls whether car service allows for changing space before suspend to disk"
+  bug: "339688542"
+}
+
 # CarAudioManager
 flag {
   name: "car_audio_dynamic_devices"
@@ -103,6 +146,30 @@ flag {
     bug: "315695829"
 }
 
+flag {
+    name: "audio_vendor_freeze_improvements"
+    is_exported: true
+    namespace: "car_framework"
+    description: "Controls whether car audio vendor freeze improvements are enabled"
+    bug: "344678175"
+}
+
+flag {
+    name: "audio_legacy_mode_navigation_volume"
+    is_exported: true
+    namespace: "car_framework"
+    description: "Enables navigation audio usage in legacy volume mode."
+    bug: "353872512"
+}
+
+flag {
+    name: "audio_control_hal_configuration"
+    is_exported: true
+    namespace: "car_framework"
+    description: "Controls whether car audio service can be configured using audio control hal configuration."
+    bug: "359686069"
+}
+
 # CarPropertyManager
 flag {
   name: "batched_subscriptions"
@@ -136,6 +203,14 @@ flag {
   bug: "276124296"
 }
 
+flag {
+  name: "handle_property_events_in_binder_thread"
+  is_exported: true
+  namespace: "car_framework"
+  description: "Controls whether to directly handle property evnets in binder thread in CarPropertyManager"
+  bug: "355703549"
+}
+
 # CarServiceBase
 flag {
   name: "car_dump_to_proto"
@@ -144,6 +219,13 @@ flag {
   bug: "302596493"
 }
 
+flag {
+  name: "create_car_use_notifications"
+  namespace: "car_framework"
+  description: "Optimized Car.createCar implementation using ServiceManagerHelper.registerForNotifications and binder death recipient"
+  bug: "343489611"
+}
+
 # ClusterHomeManager
 flag {
   name: "cluster_health_monitoring"
@@ -231,3 +313,27 @@ flag {
   description: "Enables use of Car App Card APIs"
   bug: "331282711"
 }
+
+# CarInputService
+flag {
+  name: "car_input_start_btpairing_lptt"
+  namespace: "car_framework"
+  description: "Start BT pairing form long press PTT"
+  bug: "352562350"
+}
+
+# DistantDisplayTransitions
+flag {
+    name: "distant_display_transitions"
+    namespace: "car_framework"
+    description: "Enables shell transitions handler in distant display"
+    bug: "316069815"
+}
+
+# Features that Support SDV on IVI
+flag {
+    name: "package_manager_extensions_for_sdv"
+    namespace: "car_framework"
+    description: "Enables SDV to access packages manager functions"
+    bug: "344832846"
+}
diff --git a/car-builtin-lib/Android.bp b/car-builtin-lib/Android.bp
index 40579369a9..fe1529b645 100644
--- a/car-builtin-lib/Android.bp
+++ b/car-builtin-lib/Android.bp
@@ -47,7 +47,6 @@ java_defaults {
     ],
 
     stub_only_libs: [
-        "framework-bluetooth",
         "framework-annotations-lib",
     ],
 }
@@ -58,16 +57,27 @@ java_sdk_library {
 
     defaults: ["android.car.builtin-defaults"],
 
+    public: {
+        libs: [
+            "framework-bluetooth.stubs",
+        ],
+    },
     test: {
         enabled: false,
     },
     system: {
         enabled: true,
         sdk_version: "module_current",
+        libs: [
+            "framework-bluetooth.stubs.module_lib",
+        ],
     },
     module_lib: {
         enabled: true,
         sdk_version: "module_current",
+        libs: [
+            "framework-bluetooth.stubs.module_lib",
+        ],
     },
 
     // Only allowed car modules only. Allowed to add tests here.
@@ -79,10 +89,11 @@ java_sdk_library {
         "//packages/services/Car/libs/procfs-inspector/client",
         "//packages/services/Car/service-builtin",
         "//packages/services/Car/service",
+        "//packages/services/Car/tests/CarBuiltinLibUnitTest",
         "//packages/services/Car/tests/CarLibUnitTest:__subpackages__",
-        "//packages/services/Car/tests/carservice_test",
+        "//packages/services/Car/tests/CarServiceTest:__subpackages__",
         "//packages/services/Car/tests/carservice_unit_test",
-        "//packages/services/Car/cpp/watchdog/car-watchdog-lib",
+        "//packages/services/Car/libs/car-watchdog-lib",
         "//cts/tests/tests/car_builtin",
         "//frameworks/opt/car/services/builtInServices",
         "//frameworks/opt/car/services/builtInServices/tests",
diff --git a/car-builtin-lib/TEST_MAPPING b/car-builtin-lib/TEST_MAPPING
new file mode 100644
index 0000000000..52137bfc44
--- /dev/null
+++ b/car-builtin-lib/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarBuiltinLibUnitTest"
+    }
+  ]
+}
diff --git a/car-builtin-lib/api/module-lib-current.txt b/car-builtin-lib/api/module-lib-current.txt
index 8d7d9e42c2..f57121513c 100644
--- a/car-builtin-lib/api/module-lib-current.txt
+++ b/car-builtin-lib/api/module-lib-current.txt
@@ -155,6 +155,15 @@ package android.car.builtin.content.pm {
 
 }
 
+package android.car.builtin.devicepolicy {
+
+  public final class DevicePolicyManagerHelper {
+    method public static void addUserRestriction(@NonNull android.app.admin.DevicePolicyManager, @NonNull String, @NonNull String, @NonNull android.os.UserHandle);
+    method public static void clearUserRestriction(@NonNull android.app.admin.DevicePolicyManager, @NonNull String, @NonNull String, @NonNull android.os.UserHandle);
+  }
+
+}
+
 package android.car.builtin.display {
 
   public final class DisplayManagerHelper {
@@ -302,9 +311,14 @@ package android.car.builtin.os {
     method @Nullable public static android.os.IBinder checkService(@NonNull String);
     method @Nullable public static String[] getDeclaredInstances(@NonNull String);
     method @Nullable public static android.os.IBinder getService(@NonNull String);
+    method public static void registerForNotifications(@NonNull String, @NonNull android.car.builtin.os.ServiceManagerHelper.IServiceRegistrationCallback) throws android.os.RemoteException;
     method @Nullable public static android.os.IBinder waitForDeclaredService(@NonNull String);
   }
 
+  public static interface ServiceManagerHelper.IServiceRegistrationCallback {
+    method public void onRegistration(@NonNull String, android.os.IBinder);
+  }
+
   public final class SharedMemoryHelper {
     method @NonNull public static android.os.ParcelFileDescriptor createParcelFileDescriptor(@NonNull android.os.SharedMemory) throws java.io.IOException;
   }
@@ -577,6 +591,7 @@ package android.car.builtin.view {
     field public static final int INVALID_PORT = -1; // 0xffffffff
     field public static final int TYPE_EXTERNAL = 2; // 0x2
     field public static final int TYPE_INTERNAL = 1; // 0x1
+    field public static final int TYPE_OVERLAY = 4; // 0x4
     field public static final int TYPE_VIRTUAL = 5; // 0x5
   }
 
diff --git a/car-builtin-lib/src/android/car/builtin/devicepolicy/DevicePolicyManagerHelper.java b/car-builtin-lib/src/android/car/builtin/devicepolicy/DevicePolicyManagerHelper.java
new file mode 100644
index 0000000000..a46cecb88a
--- /dev/null
+++ b/car-builtin-lib/src/android/car/builtin/devicepolicy/DevicePolicyManagerHelper.java
@@ -0,0 +1,57 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package android.car.builtin.devicepolicy;
+
+import android.annotation.NonNull;
+import android.annotation.SystemApi;
+import android.app.admin.DevicePolicyManager;
+import android.os.UserHandle;
+
+/**
+ * Helper for accessing hidden API of {@link DevicePolicyManager}.
+ *
+ * @hide
+ */
+@SystemApi(client = SystemApi.Client.MODULE_LIBRARIES)
+public final class DevicePolicyManagerHelper {
+
+    /**
+     * Adds a user restriction on the {@code targetUser}.
+     *
+     * @see DevicePolicyManager#addUserRestriction
+     */
+    public static void addUserRestriction(
+            @NonNull DevicePolicyManager dpm, @NonNull String systemEntity,
+            @NonNull String key, @NonNull UserHandle targetUser) {
+        dpm.addUserRestriction(systemEntity, key, targetUser.getIdentifier());
+    }
+
+    /**
+     * Clears a user restriction from the {@code targetUser}.
+     *
+     * @see DevicePolicyManager#clearUserRestriction
+     */
+    public static void clearUserRestriction(
+            @NonNull DevicePolicyManager dpm, @NonNull String systemEntity,
+            @NonNull String key, @NonNull UserHandle targetUser) {
+        dpm.clearUserRestriction(systemEntity, key, targetUser.getIdentifier());
+    }
+
+    private DevicePolicyManagerHelper() {
+        throw new UnsupportedOperationException();
+    }
+}
diff --git a/car-builtin-lib/src/android/car/builtin/os/ServiceManagerHelper.java b/car-builtin-lib/src/android/car/builtin/os/ServiceManagerHelper.java
index b3a1e99d2a..abac3beacb 100644
--- a/car-builtin-lib/src/android/car/builtin/os/ServiceManagerHelper.java
+++ b/car-builtin-lib/src/android/car/builtin/os/ServiceManagerHelper.java
@@ -20,6 +20,8 @@ import android.annotation.NonNull;
 import android.annotation.Nullable;
 import android.annotation.SystemApi;
 import android.os.IBinder;
+import android.os.IServiceCallback;
+import android.os.RemoteException;
 import android.os.ServiceManager;
 
 /**
@@ -62,4 +64,41 @@ public final class ServiceManagerHelper {
     public static String[] getDeclaredInstances(@NonNull String iface) {
         return ServiceManager.getDeclaredInstances(iface);
     }
+
+    /**
+     * The callback interface for {@link registerForNotifications}.
+     */
+    public interface IServiceRegistrationCallback {
+        /**
+         * Called when a service is registered.
+         *
+         * @param name the service name that has been registered with
+         * @param binder the binder that is registered
+         */
+        void onRegistration(@NonNull String name, IBinder binder);
+    }
+
+    private static final class ServiceCallbackImpl extends IServiceCallback.Stub {
+        private final IServiceRegistrationCallback mClientCallback;
+
+        ServiceCallbackImpl(IServiceRegistrationCallback clientCallback) {
+            mClientCallback = clientCallback;
+        }
+
+        @Override
+        public void onRegistration(String name, IBinder binder) {
+            mClientCallback.onRegistration(name, binder);
+        }
+    }
+
+    /**
+     * Register callback for service registration notifications.
+     *
+     * @throws RemoteException for underlying error.
+     */
+    public static void registerForNotifications(
+            @NonNull String name, @NonNull IServiceRegistrationCallback callback)
+            throws RemoteException {
+        ServiceManager.registerForNotifications(name, new ServiceCallbackImpl(callback));
+    }
 }
diff --git a/car-builtin-lib/src/android/car/builtin/view/DisplayHelper.java b/car-builtin-lib/src/android/car/builtin/view/DisplayHelper.java
index 2e69dcf40d..885c696b69 100644
--- a/car-builtin-lib/src/android/car/builtin/view/DisplayHelper.java
+++ b/car-builtin-lib/src/android/car/builtin/view/DisplayHelper.java
@@ -35,6 +35,8 @@ public final class DisplayHelper {
     public static final int TYPE_EXTERNAL = Display.TYPE_EXTERNAL;
     /** Display type: Virtual display. */
     public static final int TYPE_VIRTUAL = Display.TYPE_VIRTUAL;
+    /** Display type: Overlay display. */
+    public static final int TYPE_OVERLAY = Display.TYPE_OVERLAY;
 
     private DisplayHelper() {
         throw new UnsupportedOperationException();
diff --git a/car-lib-module/Android.bp b/car-lib-module/Android.bp
index 81b026852a..1c716980e6 100644
--- a/car-lib-module/Android.bp
+++ b/car-lib-module/Android.bp
@@ -46,18 +46,14 @@ java_sdk_library {
     shared_library: false, // added to bootclasspath
 
     libs: [
-        "android.car.builtin",
+        "android.car.builtin.stubs.module_lib",
         "framework-annotations-lib",
         "modules-utils-preconditions",
-        "framework-location",
-        "framework-wifi",
-        "framework-bluetooth",
     ],
-    // Stub build drops module api and breaks build. Add it here.
-    stub_only_libs: [
-        "framework-location",
-        "framework-wifi",
-        "framework-bluetooth",
+    impl_only_libs: [
+        "framework-location.stubs.module_lib",
+        "framework-wifi.stubs.module_lib",
+        "framework-bluetooth.stubs.module_lib",
     ],
 
     api_lint: {
@@ -72,18 +68,38 @@ java_sdk_library {
     public: {
         enabled: true,
         sdk_version: "current",
+        libs: [
+            "framework-location.stubs",
+            "framework-wifi.stubs",
+            "framework-bluetooth.stubs",
+        ],
     },
     test: {
         enabled: true,
         sdk_version: "test_current",
+        libs: [
+            "framework-location.stubs.test",
+            "framework-wifi.stubs.system",
+            "framework-bluetooth.stubs.system",
+        ],
     },
     system: {
         enabled: true,
         sdk_version: "system_current",
+        libs: [
+            "framework-location.stubs.system",
+            "framework-wifi.stubs.system",
+            "framework-bluetooth.stubs.system",
+        ],
     },
     module_lib: {
         enabled: true,
         sdk_version: "module_current",
+        libs: [
+            "framework-location.stubs.module_lib",
+            "framework-wifi.stubs.module_lib",
+            "framework-bluetooth.stubs.module_lib",
+        ],
     },
 
     // stubs to everyone
@@ -99,4 +115,7 @@ java_sdk_library {
     compile_dex: true,
 
     installable: true,
+    lint: {
+        baseline_filename: "lint-baseline.xml",
+    },
 }
diff --git a/car-lib-module/lint-baseline.xml b/car-lib-module/lint-baseline.xml
new file mode 100644
index 0000000000..0d1f57ad32
--- /dev/null
+++ b/car-lib-module/lint-baseline.xml
@@ -0,0 +1,697 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<issues format="6" by="lint 8.4.0-alpha08" type="baseline" client="" dependencies="true" name="" variant="all" version="8.4.0-alpha08">
+
+    <issue
+        id="FlaggedApi"
+        message="Class `ClusterHomeManager` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="        CAR_SERVICE_NAMES.put(ClusterHomeManager.class, CLUSTER_HOME_SERVICE);"
+        errorLine2="                              ~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="1741"
+            column="31"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `ClusterHomeManager()` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `createCarManagerLocked` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="                manager = new ClusterHomeManager(this, binder);"
+        errorLine2="                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="2713"
+            column="27"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onAudioZoneConfigurationsChanged()` is a flagged API and should be inside an `if (Flags.carAudioDynamicDevices())` check (or annotate the surrounding method `onAudioZoneConfigurationsChanged` with `@FlaggedApi(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES) to transfer requirement to caller`)"
+        errorLine1="                mExecutor.execute(() -> mCallback.onAudioZoneConfigurationsChanged(configs,"
+        errorLine2="                                        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/media/CarAudioManager.java"
+            line="2252"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `CarEvsBufferDescriptor()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `CarEvsBufferDescriptor` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="        this(id, Flags.carEvsStreamManagement() ?"
+        errorLine2="        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsBufferDescriptor.java"
+            line="79"
+            column="9"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onStreamEvent()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `handleStreamEventLocked` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="            executor.execute(() -> cb.onStreamEvent(origin, event));"
+        errorLine2="                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="595"
+            column="36"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getType()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `handleNewFrame` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="                buffer.getType() : CarEvsUtils.getTag(buffer.getId());"
+        errorLine2="                ~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="610"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getType()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `returnFrameBuffer` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="                buffer.getType() : CarEvsUtils.getTag(buffer.getId());"
+        errorLine2="                ~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="719"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1243"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1274"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1305"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of(subscription), /* callbackExecutor= */ null,"
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1363"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getPropertyId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.propertyId = clientOption.getPropertyId();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1499"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getAreaIds()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.areaIds = clientOption.getAreaIds();"
+        errorLine2="                                     ~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1500"
+            column="38"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.updateRateHz = clientOption.getUpdateRateHz();"
+        errorLine2="                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1501"
+            column="43"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateEnabled()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="            internalOption.enableVariableUpdateRate = clientOption.isVariableUpdateRateEnabled();"
+        errorLine2="                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1502"
+            column="55"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getResolution()` is a flagged API and should be inside an `if (Flags.subscriptionWithResolution())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_SUBSCRIPTION_WITH_RESOLUTION) to transfer requirement to caller`)"
+        errorLine1="            internalOption.resolution = clientOption.getResolution();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1503"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `InVehicleTaskScheduler()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="    private final InVehicleTaskScheduler mInVehicleTaskScheduler = new InVehicleTaskScheduler();"
+        errorLine2="                                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="102"
+            column="68"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onServerlessClientRegistered()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `onServerlessClientRegistered` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="                executor.execute(() -> callback.onServerlessClientRegistered());"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="224"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateSupported()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `sanitizeEnableVariableUpdateRate` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="                if (carPropertyConfig.getAreaIdConfig(areaId)"
+        errorLine2="                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java"
+            line="160"
+            column="21"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Class `ClusterHomeManager` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="        CAR_SERVICE_NAMES.put(ClusterHomeManager.class, CLUSTER_HOME_SERVICE);"
+        errorLine2="                              ~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="1724"
+            column="31"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `ClusterHomeManager()` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `createCarManagerLocked` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="                manager = new ClusterHomeManager(this, binder);"
+        errorLine2="                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="2633"
+            column="27"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onAudioZoneConfigurationsChanged()` is a flagged API and should be inside an `if (Flags.carAudioDynamicDevices())` check (or annotate the surrounding method `onAudioZoneConfigurationsChanged` with `@FlaggedApi(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES) to transfer requirement to caller`)"
+        errorLine1="                mExecutor.execute(() -> mCallback.onAudioZoneConfigurationsChanged(configs,"
+        errorLine2="                                        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/media/CarAudioManager.java"
+            line="2249"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `CarEvsBufferDescriptor()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `CarEvsBufferDescriptor` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="        this(id, Flags.carEvsStreamManagement() ?"
+        errorLine2="        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsBufferDescriptor.java"
+            line="79"
+            column="9"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1228"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1259"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1290"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of(subscription), /* callbackExecutor= */ null,"
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1348"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getPropertyId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.propertyId = clientOption.getPropertyId();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1484"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getAreaIds()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.areaIds = clientOption.getAreaIds();"
+        errorLine2="                                     ~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1485"
+            column="38"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.updateRateHz = clientOption.getUpdateRateHz();"
+        errorLine2="                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1486"
+            column="43"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateEnabled()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="            internalOption.enableVariableUpdateRate = clientOption.isVariableUpdateRateEnabled();"
+        errorLine2="                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1487"
+            column="55"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getResolution()` is a flagged API and should be inside an `if (Flags.subscriptionWithResolution())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_SUBSCRIPTION_WITH_RESOLUTION) to transfer requirement to caller`)"
+        errorLine1="            internalOption.resolution = clientOption.getResolution();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1488"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `InVehicleTaskScheduler()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="    private final InVehicleTaskScheduler mInVehicleTaskScheduler = new InVehicleTaskScheduler();"
+        errorLine2="                                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="102"
+            column="68"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onServerlessClientRegistered()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `onServerlessClientRegistered` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="                executor.execute(() -> callback.onServerlessClientRegistered());"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="224"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateSupported()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `sanitizeEnableVariableUpdateRate` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="                if (carPropertyConfig.getAreaIdConfig(areaId)"
+        errorLine2="                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java"
+            line="159"
+            column="21"/>
+    </issue>
+
+</issues>
diff --git a/car-lib/Android.bp b/car-lib/Android.bp
index 8a36c6b050..c6b64e7290 100644
--- a/car-lib/Android.bp
+++ b/car-lib/Android.bp
@@ -76,17 +76,20 @@ java_defaults {
         ],
     },
     libs: [
-        "android.car.builtin",
+        "android.car.builtin.stubs.module_lib",
         "framework-annotations-lib",
-        "framework-wifi",
-        "framework-bluetooth",
-        "framework-location",
+        "framework-wifi.stubs.module_lib",
+        "framework-bluetooth.stubs.module_lib",
+        "framework-location.stubs.module_lib",
         "modules-utils-preconditions",
     ],
     installable: true,
     // TODO(b/288271411): enable it when car mainline module is supported
     // min_sdk_version: "33",
     sdk_version: "module_current",
+    dist: {
+        targets: ["dist_files"],
+    },
 }
 
 java_library {
@@ -97,6 +100,9 @@ java_library {
     static_libs: [
         "com.android.car.internal.dep",
     ],
+    lint: {
+        baseline_filename: "lint-baseline.xml",
+    },
 }
 
 // TODO(b/248635421): these annotations are part of android.car, but
@@ -125,7 +131,6 @@ droidstubs {
     name: "android.car-stubs-docs",
     defaults: ["android.car-docs-default"],
     args: "--hide UnavailableSymbol --hide HiddenSuperclass --stub-packages android.car* " +
-        "--hide-package com.android.internal --hide-package com.android.car.internal " +
         "--error UnflaggedApi",
     installable: false,
     check_api: {
@@ -151,8 +156,8 @@ droidstubs {
     // TODO(b/174572385): Remove CallbackInterface once this b/174572385 is fixed
     args: "--hide CallbackInterface --hide UnavailableSymbol --hide HiddenSuperclass " +
         "--stub-packages android.car* " +
-        "--show-annotation android.annotation.SystemApi --hide-package com.android.internal " +
-        "--hide-package com.android.car.internal --error UnflaggedApi",
+        "--show-annotation android.annotation.SystemApi " +
+        "--error UnflaggedApi",
     installable: false,
     check_api: {
         last_released: {
@@ -291,6 +296,7 @@ java_library {
     dist: {
         targets: ["dist_files"],
     },
+    is_stubs_module: true,
 }
 
 java_library {
@@ -359,3 +365,33 @@ filegroup {
         "api/system-removed.txt",
     ],
 }
+
+genrule_defaults {
+    name: "car_signature_to_jdiff_defaults",
+    tools: ["metalava"],
+    cmd: "$(location metalava) signature-to-jdiff --strip $(in) $(out)",
+    dist: {
+        targets: ["dist_files"],
+    },
+}
+
+genrule {
+    name: "android.car-test-stubs-jdiff",
+    defaults: ["car_signature_to_jdiff_defaults"],
+    srcs: ["api/test-current.txt"],
+    out: ["car-test-api.xml"],
+}
+
+genrule {
+    name: "android.car-system-stubs-jdiff",
+    defaults: ["car_signature_to_jdiff_defaults"],
+    srcs: ["api/system-current.txt"],
+    out: ["car-system-api.xml"],
+}
+
+genrule {
+    name: "android.car-stubs-jdiff",
+    defaults: ["car_signature_to_jdiff_defaults"],
+    srcs: ["api/current.txt"],
+    out: ["car-api.xml"],
+}
diff --git a/car-lib/Android.mk b/car-lib/Android.mk
deleted file mode 100644
index daeaad0391..0000000000
--- a/car-lib/Android.mk
+++ /dev/null
@@ -1,42 +0,0 @@
-# Copyright (C) 2015 The Android Open Source Project
-#
-# Licensed under the Apache License, Version 2.0 (the "License");
-# you may not use this file except in compliance with the License.
-# You may obtain a copy of the License at
-#
-#      http://www.apache.org/licenses/LICENSE-2.0
-#
-# Unless required by applicable law or agreed to in writing, software
-# distributed under the License is distributed on an "AS IS" BASIS,
-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-# See the License for the specific language governing permissions and
-# limitations under the License.
-#
-#
-
-#disble build in PDK, missing aidl import breaks build
-ifneq ($(TARGET_BUILD_PDK),true)
-
-LOCAL_PATH:= $(call my-dir)
-
-include $(CLEAR_VARS)
-
-ifeq ($(BOARD_IS_AUTOMOTIVE), true)
-full_classes_jar := $(call intermediates-dir-for,JAVA_LIBRARIES,android.car,,COMMON)/classes.jar
-$(call dist-for-goals,dist_files,$(full_classes_jar):android.car.jar)
-
-ifeq ($(EMMA_INSTRUMENT),true)
-# Put XML formatted API files in the dist dir.
-car_api_xmls := $(addprefix $(TARGET_OUT_COMMON_INTERMEDIATES)/,car-api.xml car-system-api.xml car-test-api.xml)
-$(car_api_xmls): $(TARGET_OUT_COMMON_INTERMEDIATES)/car-%api.xml : packages/services/Car/car-lib/api/%current.txt $(APICHECK)
-	$(hide) echo "Converting API file to XML: $@"
-	$(hide) mkdir -p $(dir $@)
-	$(hide) $(APICHECK_COMMAND) signature-to-jdiff --strip $< $@
-
-$(call dist-for-goals, dist_files, $(car_api_xmls))
-car_api_xmls :=
-endif #EMMA_INSTRUMENT
-
-endif #BOARD_IS_AUTOMOTIVE
-
-endif #TARGET_BUILD_PDK
diff --git a/car-lib/TEST_MAPPING b/car-lib/TEST_MAPPING
new file mode 100644
index 0000000000..78ea978aef
--- /dev/null
+++ b/car-lib/TEST_MAPPING
@@ -0,0 +1,14 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibCarUnitTest"
+    }
+  ],
+  "ravenwood-presubmit": [
+    {
+      "name": "CarLibHostUnitTest",
+      "host": true,
+      "keywords": ["automotive_code_coverage"]
+    }
+  ]
+}
diff --git a/car-lib/lint-baseline.xml b/car-lib/lint-baseline.xml
new file mode 100644
index 0000000000..0d1f57ad32
--- /dev/null
+++ b/car-lib/lint-baseline.xml
@@ -0,0 +1,697 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<issues format="6" by="lint 8.4.0-alpha08" type="baseline" client="" dependencies="true" name="" variant="all" version="8.4.0-alpha08">
+
+    <issue
+        id="FlaggedApi"
+        message="Class `ClusterHomeManager` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="        CAR_SERVICE_NAMES.put(ClusterHomeManager.class, CLUSTER_HOME_SERVICE);"
+        errorLine2="                              ~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="1741"
+            column="31"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `ClusterHomeManager()` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `createCarManagerLocked` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="                manager = new ClusterHomeManager(this, binder);"
+        errorLine2="                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="2713"
+            column="27"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onAudioZoneConfigurationsChanged()` is a flagged API and should be inside an `if (Flags.carAudioDynamicDevices())` check (or annotate the surrounding method `onAudioZoneConfigurationsChanged` with `@FlaggedApi(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES) to transfer requirement to caller`)"
+        errorLine1="                mExecutor.execute(() -> mCallback.onAudioZoneConfigurationsChanged(configs,"
+        errorLine2="                                        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/media/CarAudioManager.java"
+            line="2252"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `CarEvsBufferDescriptor()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `CarEvsBufferDescriptor` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="        this(id, Flags.carEvsStreamManagement() ?"
+        errorLine2="        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsBufferDescriptor.java"
+            line="79"
+            column="9"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onStreamEvent()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `handleStreamEventLocked` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="            executor.execute(() -> cb.onStreamEvent(origin, event));"
+        errorLine2="                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="595"
+            column="36"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getType()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `handleNewFrame` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="                buffer.getType() : CarEvsUtils.getTag(buffer.getId());"
+        errorLine2="                ~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="610"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getType()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `returnFrameBuffer` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="                buffer.getType() : CarEvsUtils.getTag(buffer.getId());"
+        errorLine2="                ~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="719"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1243"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1274"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1305"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of(subscription), /* callbackExecutor= */ null,"
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1363"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getPropertyId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.propertyId = clientOption.getPropertyId();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1499"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getAreaIds()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.areaIds = clientOption.getAreaIds();"
+        errorLine2="                                     ~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1500"
+            column="38"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.updateRateHz = clientOption.getUpdateRateHz();"
+        errorLine2="                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1501"
+            column="43"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateEnabled()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="            internalOption.enableVariableUpdateRate = clientOption.isVariableUpdateRateEnabled();"
+        errorLine2="                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1502"
+            column="55"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getResolution()` is a flagged API and should be inside an `if (Flags.subscriptionWithResolution())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_SUBSCRIPTION_WITH_RESOLUTION) to transfer requirement to caller`)"
+        errorLine1="            internalOption.resolution = clientOption.getResolution();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1503"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `InVehicleTaskScheduler()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="    private final InVehicleTaskScheduler mInVehicleTaskScheduler = new InVehicleTaskScheduler();"
+        errorLine2="                                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="102"
+            column="68"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onServerlessClientRegistered()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `onServerlessClientRegistered` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="                executor.execute(() -> callback.onServerlessClientRegistered());"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="224"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateSupported()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `sanitizeEnableVariableUpdateRate` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="                if (carPropertyConfig.getAreaIdConfig(areaId)"
+        errorLine2="                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java"
+            line="160"
+            column="21"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Class `ClusterHomeManager` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="        CAR_SERVICE_NAMES.put(ClusterHomeManager.class, CLUSTER_HOME_SERVICE);"
+        errorLine2="                              ~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="1724"
+            column="31"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `ClusterHomeManager()` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `createCarManagerLocked` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="                manager = new ClusterHomeManager(this, binder);"
+        errorLine2="                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="2633"
+            column="27"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onAudioZoneConfigurationsChanged()` is a flagged API and should be inside an `if (Flags.carAudioDynamicDevices())` check (or annotate the surrounding method `onAudioZoneConfigurationsChanged` with `@FlaggedApi(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES) to transfer requirement to caller`)"
+        errorLine1="                mExecutor.execute(() -> mCallback.onAudioZoneConfigurationsChanged(configs,"
+        errorLine2="                                        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/media/CarAudioManager.java"
+            line="2249"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `CarEvsBufferDescriptor()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `CarEvsBufferDescriptor` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="        this(id, Flags.carEvsStreamManagement() ?"
+        errorLine2="        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsBufferDescriptor.java"
+            line="79"
+            column="9"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1228"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1259"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1290"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of(subscription), /* callbackExecutor= */ null,"
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1348"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getPropertyId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.propertyId = clientOption.getPropertyId();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1484"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getAreaIds()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.areaIds = clientOption.getAreaIds();"
+        errorLine2="                                     ~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1485"
+            column="38"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.updateRateHz = clientOption.getUpdateRateHz();"
+        errorLine2="                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1486"
+            column="43"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateEnabled()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="            internalOption.enableVariableUpdateRate = clientOption.isVariableUpdateRateEnabled();"
+        errorLine2="                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1487"
+            column="55"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getResolution()` is a flagged API and should be inside an `if (Flags.subscriptionWithResolution())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_SUBSCRIPTION_WITH_RESOLUTION) to transfer requirement to caller`)"
+        errorLine1="            internalOption.resolution = clientOption.getResolution();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1488"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `InVehicleTaskScheduler()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="    private final InVehicleTaskScheduler mInVehicleTaskScheduler = new InVehicleTaskScheduler();"
+        errorLine2="                                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="102"
+            column="68"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onServerlessClientRegistered()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `onServerlessClientRegistered` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="                executor.execute(() -> callback.onServerlessClientRegistered());"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="224"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateSupported()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `sanitizeEnableVariableUpdateRate` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="                if (carPropertyConfig.getAreaIdConfig(areaId)"
+        errorLine2="                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java"
+            line="159"
+            column="21"/>
+    </issue>
+
+</issues>
diff --git a/car-lib/src/android/car/Car.java b/car-lib/src/android/car/Car.java
index 7626a459e4..b23336500e 100644
--- a/car-lib/src/android/car/Car.java
+++ b/car-lib/src/android/car/Car.java
@@ -39,6 +39,7 @@ import android.car.app.CarActivityManager;
 import android.car.app.CarDisplayCompatManager;
 import android.car.builtin.os.BuildHelper;
 import android.car.builtin.os.ServiceManagerHelper;
+import android.car.builtin.util.Slogf;
 import android.car.cluster.CarInstrumentClusterManager;
 import android.car.cluster.ClusterActivityState;
 import android.car.cluster.ClusterHomeManager;
@@ -68,7 +69,6 @@ import android.car.storagemonitoring.CarStorageMonitoringManager;
 import android.car.telemetry.CarTelemetryManager;
 import android.car.test.CarTestManager;
 import android.car.user.CarUserManager;
-import android.car.user.ExperimentalCarUserManager;
 import android.car.vms.VmsClientManager;
 import android.car.vms.VmsSubscriberManager;
 import android.car.watchdog.CarWatchdogManager;
@@ -83,8 +83,8 @@ import android.os.Build;
 import android.os.Handler;
 import android.os.IBinder;
 import android.os.Looper;
-import android.os.Process;
 import android.os.RemoteException;
+import android.os.SystemClock;
 import android.os.TransactionTooLargeException;
 import android.util.ArrayMap;
 import android.util.Slog;
@@ -93,6 +93,10 @@ import com.android.car.internal.ICarBase;
 import com.android.car.internal.VisibleForHiddenApiCheck;
 import com.android.car.internal.common.CommonConstants;
 import com.android.car.internal.dep.SystemProperties;
+import com.android.car.internal.os.Process;
+import com.android.car.internal.os.ServiceManager;
+import com.android.car.internal.os.SystemProcess;
+import com.android.car.internal.os.SystemServiceManager;
 import com.android.internal.annotations.GuardedBy;
 import com.android.internal.annotations.VisibleForTesting;
 
@@ -291,18 +295,6 @@ public final class Car implements ICarBase {
     @SystemApi
     public static final String CAR_USER_SERVICE = "car_user_service";
 
-    /**
-     * Service name for {@link ExperimentalCarUserManager}
-     *
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported. It will be marked {@code @removed} in the next major release and hard removed in
-     * the release after that.
-     */
-    @Deprecated
-    @OptionalFeature
-    public static final String EXPERIMENTAL_CAR_USER_SERVICE = "experimental_car_user_service";
-
     /**
      * Service name for ExperimentalCarKeyguardService
      *
@@ -1561,6 +1553,8 @@ public final class Car implements ICarBase {
 
     private static final long CAR_SERVICE_BINDER_POLLING_INTERVAL_MS = 50;
     private static final long CAR_SERVICE_BINDER_POLLING_MAX_RETRY = 100;
+    private static final long CAR_SERVICE_REGISTRATION_TIMEOUT_MS =
+            CAR_SERVICE_BINDER_POLLING_INTERVAL_MS * CAR_SERVICE_BINDER_POLLING_MAX_RETRY;
 
     private static final int STATE_DISCONNECTED = 0;
     private static final int STATE_CONNECTING = 1;
@@ -1614,9 +1608,8 @@ public final class Car implements ICarBase {
     public @interface FeaturerRequestEnum {}
 
     private final Context mContext;
-
     private final Exception mConstructionStack;
-
+    private final long mCreateUptimeMillis;
     private final Object mLock = new Object();
 
     @GuardedBy("mLock")
@@ -1630,6 +1623,19 @@ public final class Car implements ICarBase {
     @GuardedBy("mLock")
     private int mConnectionRetryCount;
 
+    // Whether we have registered the service listener. It should only be registered once.
+    @GuardedBy("mLock")
+    private boolean mServiceListenerRegistered;
+    // The car service binder object we get from ServiceManager.
+    @GuardedBy("mLock")
+    private IBinder mCarServiceBinder;
+    // Whether the client is currently waiting (blocked) for a car service connection.
+    @GuardedBy("mLock")
+    private boolean mWaiting;
+    // Whether client explicitly called disconnect.
+    @GuardedBy("mLock")
+    private boolean mClientRequestDisconnect;
+
     private final Runnable mConnectionRetryRunnable = new Runnable() {
         @Override
         public void run() {
@@ -1645,8 +1651,35 @@ public final class Car implements ICarBase {
         }
     };
 
-    private final ServiceConnection mServiceConnectionListener =
-            new ServiceConnection() {
+    private final ServiceRegistrationCallbackForCar mServiceRegistrationCallback =
+             new ServiceRegistrationCallbackForCar();
+
+    private final class ServiceRegistrationCallbackForCar implements
+            ServiceManagerHelper.IServiceRegistrationCallback  {
+        @Override
+        public void onRegistration(@NonNull String name, IBinder binder) {
+            Slog.i(TAG_CAR, "car_service registered");
+            if (!name.equals(CAR_SERVICE_BINDER_SERVICE_NAME)) {
+                Slog.wtf(TAG_CAR, "Unexpected service name called for onRegistration: " + name);
+                return;
+            }
+            synchronized (mLock) {
+                mCarServiceBinder = binder;
+                if (mWaiting) {
+                    mLock.notifyAll();
+                    return;
+                }
+                if (mClientRequestDisconnect) {
+                    // Client explicitly called disconnect, do not invoke the callbacks.
+                    return;
+                }
+            }
+
+            mMainThreadEventHandler.post(() -> setBinderAndNotifyReady(binder));
+        }
+    }
+
+    private final ServiceConnection mServiceConnectionListener = new ServiceConnection() {
         @Override
         public void onServiceConnected(ComponentName name, IBinder service) {
             synchronized (mLock) {
@@ -1662,8 +1695,10 @@ public final class Car implements ICarBase {
                 mConnectionState = STATE_CONNECTED;
                 mService = newService;
             }
+            Slog.i(TAG_CAR, "car_service ready on main thread, Time between Car object creation "
+                    + "and car_service connected (ms): " + timeSinceCreateMillis());
             if (mStatusChangeCallback != null) {
-                mStatusChangeCallback.onLifecycleChanged(Car.this, true);
+                mStatusChangeCallback.onLifecycleChanged(Car.this, /* ready= */ true);
             } else if (mServiceConnectionListenerClient != null) {
                 mServiceConnectionListenerClient.onServiceConnected(name, service);
             }
@@ -1672,16 +1707,17 @@ public final class Car implements ICarBase {
         @Override
         public void onServiceDisconnected(ComponentName name) {
             // Car service can pick up feature changes after restart.
+            Slog.w(TAG_CAR, "Car service disconnected, probably crashed");
             mFeatures.resetCache();
             synchronized (mLock) {
-                if (mConnectionState  == STATE_DISCONNECTED) {
+                if (mConnectionState == STATE_DISCONNECTED) {
                     // can happen when client calls disconnect before onServiceDisconnected call.
                     return;
                 }
                 handleCarDisconnectLocked();
             }
             if (mStatusChangeCallback != null) {
-                mStatusChangeCallback.onLifecycleChanged(Car.this, false);
+                mStatusChangeCallback.onLifecycleChanged(Car.this, /* ready= */ false);
             } else if (mServiceConnectionListenerClient != null) {
                 mServiceConnectionListenerClient.onServiceDisconnected(name);
             } else {
@@ -1691,6 +1727,26 @@ public final class Car implements ICarBase {
         }
     };
 
+    private final IBinder.DeathRecipient mDeathRecipient = new IBinder.DeathRecipient() {
+        @Override
+        public void binderDied() {
+            Slog.w(TAG_CAR, "Car service disconnected, probably crashed");
+            // Car service can pick up feature changes after restart.
+            mFeatures.resetCache();
+            synchronized (mLock) {
+                if (mConnectionState == STATE_DISCONNECTED) {
+                    Slog.i(TAG_CAR, "State is already disconnected, ignore");
+                    // can happen when client calls disconnect before onServiceDisconnected call.
+                    return;
+                }
+                mCarServiceBinder = null;
+                handleCarDisconnectLocked();
+            }
+            dispatchToMainThread(isMainThread(), () -> notifyCarDisconnected());
+            registerServiceListenerIfNotRegistered();
+        }
+    };
+
     @Nullable
     private final ServiceConnection mServiceConnectionListenerClient;
 
@@ -1708,6 +1764,22 @@ public final class Car implements ICarBase {
 
     private final CarFeatures mFeatures = new CarFeatures();
 
+    /**
+     * The dependencies used by this class.
+     *
+     * @hide
+     */
+    @VisibleForTesting
+    public record Deps(ServiceManager serviceManager, Process process,
+            long carServiceBindRetryIntervalMs, long carServiceBindMaxRetry) {}
+
+    // Real system dependencies.
+    private static final Deps SYSTEM_DEPS = new Deps(
+            new SystemServiceManager(), new SystemProcess(),
+            CAR_SERVICE_BIND_RETRY_INTERVAL_MS, CAR_SERVICE_BIND_MAX_RETRY);
+
+    private final Deps mDeps;
+
     static {
         CAR_SERVICE_NAMES.put(CarSensorManager.class, SENSOR_SERVICE);
         CAR_SERVICE_NAMES.put(CarInfoManager.class, INFO_SERVICE);
@@ -1717,7 +1789,6 @@ public final class Car implements ICarBase {
         CAR_SERVICE_NAMES.put(CarNavigationStatusManager.class, CAR_NAVIGATION_SERVICE);
         CAR_SERVICE_NAMES.put(CarOccupantZoneManager.class, CAR_OCCUPANT_ZONE_SERVICE);
         CAR_SERVICE_NAMES.put(CarUserManager.class, CAR_USER_SERVICE);
-        CAR_SERVICE_NAMES.put(ExperimentalCarUserManager.class, EXPERIMENTAL_CAR_USER_SERVICE);
         CAR_SERVICE_NAMES.put(CarDevicePolicyManager.class, CAR_DEVICE_POLICY_SERVICE);
         CAR_SERVICE_NAMES.put(CarInstrumentClusterManager.class, CAR_INSTRUMENT_CLUSTER_SERVICE);
         CAR_SERVICE_NAMES.put(CarCabinManager.class, CABIN_SERVICE);
@@ -1847,7 +1918,9 @@ public final class Car implements ICarBase {
      *                make sure that its {@link ContextWrapper#getBaseContext() base context} is not
      *                {@code null} as well.
      *                Otherwise it will throw {@link java.lang.NullPointerException}.
-     * @param serviceConnectionListener listener for monitoring service connection.
+     * @param serviceConnectionListener listener for monitoring service connection. It is allowed
+     * but not recommended to pass {@code null}. If this is {@code null}, client has to periodically
+     * check {@link #isConnected()} to know when car service is connected.
      * @param handler the handler on which the callback should execute, or null to execute on the
      * service's main thread. Note: the service connection listener will be always on the main
      * thread regardless of the handler given.
@@ -1858,18 +1931,7 @@ public final class Car implements ICarBase {
     @Deprecated
     public static Car createCar(Context context, ServiceConnection serviceConnectionListener,
             @Nullable Handler handler) {
-        assertNonNullContext(context);
-        if (!context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_AUTOMOTIVE)) {
-            Slog.e(TAG_CAR, "FEATURE_AUTOMOTIVE not declared while android.car is used");
-            return null;
-        }
-        try {
-            return new Car(context, /* service= */ null , serviceConnectionListener,
-                    /* statusChangeListener= */ null, handler);
-        } catch (IllegalArgumentException e) {
-            // Expected when car service loader is not available.
-        }
-        return null;
+        return new CarBuilder().createCar(context, serviceConnectionListener, handler);
     }
 
     /**
@@ -1885,7 +1947,7 @@ public final class Car implements ICarBase {
      */
     @Deprecated
     public static Car createCar(Context context, ServiceConnection serviceConnectionListener) {
-        return createCar(context, serviceConnectionListener, null);
+        return new CarBuilder().createCar(context, serviceConnectionListener);
     }
 
     /**
@@ -1965,9 +2027,8 @@ public final class Car implements ICarBase {
      *                      interpreted as timeout value.
      */
     @NonNull
-    public static Car createCar(@NonNull Context context,
-            @Nullable Handler handler, long waitTimeoutMs,
-            @NonNull CarServiceLifecycleListener statusChangeListener) {
+    public static Car createCar(@NonNull Context context, @Nullable Handler handler,
+            long waitTimeoutMs, @NonNull CarServiceLifecycleListener statusChangeListener) {
         return new CarBuilder().createCar(context, handler, waitTimeoutMs, statusChangeListener);
     }
 
@@ -1978,32 +2039,52 @@ public final class Car implements ICarBase {
      */
     @VisibleForTesting
     public static final class CarBuilder {
+        private Deps mDeps = SYSTEM_DEPS;
+
         /**
-         * The service manager functions we access in this class.
+         * Sets the fake dependencies for testing.
          */
-        public interface ServiceManager {
-            /** Check {@link ServiceManager#getService(String)} */
-            IBinder getService(String name);
+        public CarBuilder setFakeDeps(Deps deps) {
+            mDeps = deps;
+            return this;
         }
 
-        private ServiceManager mServiceManager = new ServiceManager() {
-            @Override
-            public IBinder getService(String name) {
-                return ServiceManagerHelper.getService(name);
-            }
-        };
+        /**
+         * See {@link Car#createCar}.
+         *
+         * Even though serviceConnectionListener is not marked as Nullable, existing client may
+         * pass null.
+         */
+        @Nullable
+        public Car createCar(Context context,
+                @Nullable ServiceConnection serviceConnectionListener) {
+            return createCar(context, serviceConnectionListener, /* handler= */ null);
+        }
 
         /**
-         * Sets the fake service manager for testing.
+         * See {@link Car#createCar}.
          */
-        public CarBuilder setServiceManager(ServiceManager serviceManager) {
-            mServiceManager = serviceManager;
-            return this;
+        @Nullable
+        public Car createCar(Context context, @Nullable ServiceConnection serviceConnectionListener,
+                @Nullable Handler handler) {
+            assertNonNullContext(context);
+            if (!context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_AUTOMOTIVE)) {
+                Slog.e(TAG_CAR, "FEATURE_AUTOMOTIVE not declared while android.car is used");
+                return null;
+            }
+            try {
+                return new Car(context, /* service= */ null , serviceConnectionListener,
+                        /* statusChangeListener= */ null, handler, mDeps);
+            } catch (IllegalArgumentException e) {
+                // Expected when car service loader is not available.
+            }
+            return null;
         }
 
         /**
          * See {@link Car#createCar}.
          */
+        @Nullable
         public Car createCar(Context context) {
             return createCar(context, (Handler) null);
         }
@@ -2011,19 +2092,88 @@ public final class Car implements ICarBase {
         /**
          * See {@link Car#createCar}.
          */
+        @Nullable
         public Car createCar(Context context, @Nullable Handler handler) {
             assertNonNullContext(context);
+
+            if (Flags.createCarUseNotifications()) {
+                // New optimized logic.
+                return createCarInternal(context, handler, CAR_SERVICE_REGISTRATION_TIMEOUT_MS,
+                        /* statusChangeListener= */ null);
+            }
+
+            return createCarInternalLegacy(context, handler);
+        }
+
+        /**
+         * See {@link Car#createCar}.
+         */
+        @NonNull
+        public Car createCar(@NonNull Context context, @Nullable Handler handler,
+                long waitTimeoutMs, @NonNull CarServiceLifecycleListener statusChangeListener) {
+            assertNonNullContext(context);
+            Objects.requireNonNull(statusChangeListener);
+
+            if (Flags.createCarUseNotifications()) {
+                // New optimized logic.
+                // statusChangeListener is not null, so this must not return null.
+                return createCarInternal(context, handler, waitTimeoutMs, statusChangeListener);
+            }
+
+            return createCarInternalLegacy(context, handler, waitTimeoutMs, statusChangeListener);
+        }
+
+        private @Nullable Car createCarInternal(Context context,
+                @Nullable Handler handler, long waitTimeoutMs,
+                @Nullable CarServiceLifecycleListener statusChangeListener) {
+            Car car = new Car(context, /* service= */ null, /* serviceConnectionListener= */ null,
+                    statusChangeListener, handler, mDeps);
+            IBinder binderService = mDeps.serviceManager().getService(
+                    CAR_SERVICE_BINDER_SERVICE_NAME);
+            if (binderService != null) {
+                // Most common case when car service is already ready.
+                car.setCarService(binderService);
+                Slogf.i(TAG_CAR, "createCar car_service is already ready, took (ms): %d",
+                        car.timeSinceCreateMillis());
+                car.notifyCarReadyOnMainThread(binderService);
+                return car;
+            }
+
+            car.registerServiceListenerIfNotRegistered();
+            IBinder serviceBinder = car.waitForCarServiceReady(waitTimeoutMs);
+
+            if (serviceBinder == null) {
+                Slog.w(TAG_CAR,
+                        "createCar (waitTimeoutMs=" + waitTimeoutMs
+                        + ") car_service not ready, took (ms):"
+                        + car.timeSinceCreateMillis());
+                if (statusChangeListener == null) {
+                    return null;
+                }
+                // Return a car instance that is not connected to the car service.
+                return car;
+            }
+
+            Slog.i(TAG_CAR, "createCar (waitTimeoutMs=" + waitTimeoutMs
+                    + ") connected to car_service, took (ms): "
+                    + car.timeSinceCreateMillis());
+            car.notifyCarReadyOnMainThread(serviceBinder);
+            return car;
+        }
+
+        // Legacy createCar implementation.
+        private @Nullable Car createCarInternalLegacy(Context context, @Nullable Handler handler) {
             Car car = null;
             IBinder service = null;
             boolean started = false;
             int retryCount = 0;
             while (true) {
-                service = mServiceManager.getService(CAR_SERVICE_BINDER_SERVICE_NAME);
+                service = mDeps.serviceManager().getService(CAR_SERVICE_BINDER_SERVICE_NAME);
                 if (car == null) {
                     // service can be still null. The constructor is safe for null service.
                     car = new Car(context, ICar.Stub.asInterface(service),
                             null /*serviceConnectionListener*/, null /*statusChangeListener*/,
-                            handler);
+                            handler, mDeps);
                 }
                 if (service != null) {
                     if (!started) {  // specialization for most common case.
@@ -2067,15 +2217,10 @@ public final class Car implements ICarBase {
             return car;
         }
 
-        /**
-         * See {@link Car#createCar}.
-         */
-        @NonNull
-        public Car createCar(@NonNull Context context,
+        // Legacy createCar implementation.
+        private Car createCarInternalLegacy(@NonNull Context context,
                 @Nullable Handler handler, long waitTimeoutMs,
                 @NonNull CarServiceLifecycleListener statusChangeListener) {
-            assertNonNullContext(context);
-            Objects.requireNonNull(statusChangeListener);
             Car car = null;
             IBinder service = null;
             boolean started = false;
@@ -2090,11 +2235,11 @@ public final class Car implements ICarBase {
             }
             boolean isMainThread = Looper.myLooper() == Looper.getMainLooper();
             while (true) {
-                service = mServiceManager.getService(CAR_SERVICE_BINDER_SERVICE_NAME);
+                service = mDeps.serviceManager().getService(CAR_SERVICE_BINDER_SERVICE_NAME);
                 if (car == null) {
                     // service can be still null. The constructor is safe for null service.
                     car = new Car(context, ICar.Stub.asInterface(service), null,
-                            statusChangeListener, handler);
+                            statusChangeListener, handler, mDeps);
                 }
                 if (service != null) {
                     // specialization for most common case : car service already ready
@@ -2152,11 +2297,147 @@ public final class Car implements ICarBase {
                 car.mService = ICar.Stub.asInterface(service);
                 car.mConnectionState = STATE_CONNECTED;
             }
+            Slog.i(TAG_CAR, "createCar car_service is ready, took (ms): "
+                    + car.timeSinceCreateMillis());
             car.dispatchCarReadyToMainThread(isMainThread);
             return car;
         }
     }
 
+    private long timeSinceCreateMillis() {
+        return SystemClock.uptimeMillis() - mCreateUptimeMillis;
+    }
+
+    private void registerServiceListenerIfNotRegistered() {
+        synchronized (mLock) {
+            if (mServiceListenerRegistered) {
+                return;
+            }
+            try {
+                mDeps.serviceManager().registerForNotifications(CAR_SERVICE_BINDER_SERVICE_NAME,
+                        mServiceRegistrationCallback);
+            } catch (RemoteException e) {
+                Slog.e(TAG_CAR, "failed to call ServiceManager.registerForNotifications", e);
+                return;
+            }
+            mServiceListenerRegistered = true;
+            return;
+        }
+    }
+
+    @GuardedBy("mLock")
+    private void waitForCarServiceBinderNoTimeoutLocked() throws InterruptedException {
+        // First wait for 5s.
+        waitForCarServiceBinderLocked(CAR_SERVICE_REGISTRATION_TIMEOUT_MS);
+        if (mCarServiceBinder != null) {
+            return;
+        }
+        // Log warning if car service is not alive even for waiting forever case.
+        Slog.w(TAG_CAR,
+                "createCar (wait indefinitely) still cannot get car_service after "
+                + CAR_SERVICE_REGISTRATION_TIMEOUT_MS + "ms");
+        // If we still cannot get car service, then wait forever.
+        while (mCarServiceBinder == null) {
+            // await in a loop to prevent spurious wakeup.
+            mLock.wait();
+        }
+    }
+
+    @GuardedBy("mLock")
+    private void waitForCarServiceBinderLocked(long waitTimeoutMs) throws InterruptedException {
+        long deadlineMillis = SystemClock.uptimeMillis() + waitTimeoutMs;
+        boolean stillWaiting = true;
+        while (mCarServiceBinder == null) {
+            long uptimeMillis = SystemClock.uptimeMillis();
+            if (uptimeMillis >= deadlineMillis) {
+                break;
+            }
+            Slog.w(TAG_CAR, "wait: " + (deadlineMillis - uptimeMillis));
+            mLock.wait(deadlineMillis - uptimeMillis);
+            Slog.w(TAG_CAR, "after wait");
+        }
+    }
+
+    private @Nullable IBinder waitForCarServiceReady(long waitTimeoutMs) {
+        if (waitTimeoutMs == 0) {
+            return null;
+        }
+
+        IBinder serviceBinder;
+        synchronized (mLock) {
+            mWaiting = true;
+            try {
+                if (waitTimeoutMs < 0) {
+                    waitForCarServiceBinderNoTimeoutLocked();
+                } else {
+                    waitForCarServiceBinderLocked(waitTimeoutMs);
+                }
+                serviceBinder = mCarServiceBinder;
+            } catch (InterruptedException e) {
+                Slog.e(TAG_CAR, "Interrupted while waiting for car_service");
+                Thread.currentThread().interrupt();
+                return null;
+            } finally {
+                mWaiting = false;
+            }
+            if (serviceBinder == null) {
+                // Cannot get car service binder before timeout.
+                return null;
+            }
+            setCarServiceLocked(serviceBinder);
+        }
+        return serviceBinder;
+    }
+
+    private void setCarService(IBinder carServiceBinder) {
+        synchronized (mLock) {
+            setCarServiceLocked(carServiceBinder);
+        }
+    }
+
+    @GuardedBy("mLock")
+    private void setCarServiceLocked(IBinder carServiceBinder) {
+        ICar newService = ICar.Stub.asInterface(carServiceBinder);
+        if (newService == null) {
+            Slogf.wtf(TAG_CAR, "null binder service", new RuntimeException());
+            return;  // should not happen.
+        }
+        mConnectionState = STATE_CONNECTED;
+        mService = newService;
+        try {
+            carServiceBinder.linkToDeath(mDeathRecipient, /* flags= */ 0);
+        } catch (RemoteException e) {
+            Slog.e(TAG_CAR, "Failed to call linkToDeath on car service binder, will not receive "
+                    + "callback if car service crashes", e);
+        }
+    }
+
+    private void notifyCarReady(IBinder serviceBinder) {
+        if (mStatusChangeCallback != null) {
+            mStatusChangeCallback.onLifecycleChanged(/* car= */ this, /* ready= */ true);
+        } else if (mServiceConnectionListenerClient != null) {
+            mServiceConnectionListenerClient.onServiceConnected(
+                    new ComponentName(CAR_SERVICE_PACKAGE, CAR_SERVICE_CLASS), serviceBinder);
+        }
+    }
+
+    private void notifyCarDisconnected() {
+        Slog.i(TAG_CAR, "notify car service disconnected");
+        if (mStatusChangeCallback != null) {
+            mStatusChangeCallback.onLifecycleChanged(Car.this, /* ready= */ false);
+        } else if (mServiceConnectionListenerClient != null) {
+            mServiceConnectionListenerClient.onServiceDisconnected(
+                    new ComponentName(CAR_SERVICE_PACKAGE, CAR_SERVICE_CLASS));
+        } else {
+            // This client does not handle car service restart, so should be terminated.
+            finishClient();
+        }
+    }
+
+    private static boolean isMainThread() {
+        return Looper.myLooper() == Looper.getMainLooper();
+    }
+
     private static void assertNonNullContext(Context context) {
         Objects.requireNonNull(context);
         if (context instanceof ContextWrapper
@@ -2166,20 +2447,37 @@ public final class Car implements ICarBase {
         }
     }
 
-    private void dispatchCarReadyToMainThread(boolean isMainThread) {
+    private void dispatchToMainThread(boolean isMainThread, Runnable runnable) {
         if (isMainThread) {
-            mStatusChangeCallback.onLifecycleChanged(this, true);
+            runnable.run();
         } else {
             // should dispatch to main thread.
-            mMainThreadEventHandler.post(
-                    () -> mStatusChangeCallback.onLifecycleChanged(this, true));
+            mMainThreadEventHandler.post(runnable);
         }
     }
 
+    private void notifyCarReadyOnMainThread(IBinder serviceBinder) {
+        dispatchToMainThread(isMainThread(), () -> notifyCarReady(serviceBinder));
+    }
+
+    private void dispatchCarReadyToMainThread(boolean isMainThread) {
+        dispatchToMainThread(isMainThread,
+                () -> mStatusChangeCallback.onLifecycleChanged(/* car= */ this, /* ready= */ true));
+    }
+
+    private void setBinderAndNotifyReady(IBinder binder) {
+        setCarService(binder);
+        Slog.i(TAG_CAR, "car_service ready on main thread, Time between Car object creation"
+                + " and car_service connected (ms): " + timeSinceCreateMillis());
+        notifyCarReady(binder);
+    }
+
     private Car(Context context, @Nullable ICar service,
             @Nullable ServiceConnection serviceConnectionListener,
             @Nullable CarServiceLifecycleListener statusChangeListener,
-            @Nullable Handler handler) {
+            @Nullable Handler handler, Deps deps) {
+        mDeps = deps;
+        mCreateUptimeMillis = SystemClock.uptimeMillis();
         mContext = context;
         mEventHandler = determineEventHandler(handler);
         mMainThreadEventHandler = determineMainThreadEventHandler(mEventHandler);
@@ -2207,7 +2505,7 @@ public final class Car implements ICarBase {
      */
     public Car(Context context, @Nullable ICar service, @Nullable Handler handler) {
         this(context, service, null /*serviceConnectionListener*/, null /*statusChangeListener*/,
-                handler);
+                handler, SYSTEM_DEPS);
     }
 
     private static Handler determineMainThreadEventHandler(Handler eventHandler) {
@@ -2226,22 +2524,38 @@ public final class Car implements ICarBase {
     }
 
     /**
-     * Connect to car service. This can be called while it is disconnected.
-     * @throws IllegalStateException If connection is still on-going from previous
-     *         connect call or it is already connected
-     *
      * @deprecated this method is not need if this object is created via
      * {@link #createCar(Context, Handler)}.
      */
     @Deprecated
     public void connect() throws IllegalStateException {
+        IBinder carServiceBinder = null;
         synchronized (mLock) {
             if (mConnectionState != STATE_DISCONNECTED) {
                 throw new IllegalStateException("already connected or connecting");
             }
+            mClientRequestDisconnect = false;
             mConnectionState = STATE_CONNECTING;
-            startCarService();
+            if (!Flags.createCarUseNotifications()) {
+                // Ideally this should not be inside the lock, but legacy logic run this inside
+                // the lock.
+                startCarService();
+                return;
+            }
+
+            carServiceBinder = mCarServiceBinder;
         }
+
+        if (carServiceBinder != null) {
+            // If we already have a car service binder ready. This means this is a reconnect
+            // after disconnect or car service crash. And car service is already ready
+            // before connecting.
+
+            // Need this to make carServiceBinder final.
+            IBinder binder = carServiceBinder;
+            dispatchToMainThread(isMainThread(), () -> setBinderAndNotifyReady(binder));
+        }
+        registerServiceListenerIfNotRegistered();
     }
 
     @GuardedBy("mLock")
@@ -2267,6 +2581,7 @@ public final class Car implements ICarBase {
      */
     public void disconnect() {
         synchronized (mLock) {
+            mClientRequestDisconnect = true;
             handleCarDisconnectLocked();
             if (mServiceBound) {
                 mContext.unbindService(mServiceConnectionListener);
@@ -2587,7 +2902,7 @@ public final class Car implements ICarBase {
                         + ".) to handle it properly. Check printed callstack to check where other "
                         + "version of Car.createCar() was called. Killing the client process**",
                 mConstructionStack);
-        Process.killProcess(Process.myPid());
+        mDeps.process().killProcess(mDeps.process().myPid());
     }
 
     /** @hide */
@@ -2697,9 +3012,6 @@ public final class Car implements ICarBase {
             case CAR_USER_SERVICE:
                 manager = new CarUserManager(this, binder);
                 break;
-            case EXPERIMENTAL_CAR_USER_SERVICE:
-                manager = new ExperimentalCarUserManager(this, binder);
-                break;
             case CAR_WATCHDOG_SERVICE:
                 manager = new CarWatchdogManager(this, binder);
                 break;
@@ -2792,12 +3104,12 @@ public final class Car implements ICarBase {
         synchronized (mLock) {
             if (!bound) {
                 mConnectionRetryCount++;
-                if (mConnectionRetryCount > CAR_SERVICE_BIND_MAX_RETRY) {
+                if (mConnectionRetryCount > mDeps.carServiceBindMaxRetry()) {
                     Slog.w(TAG_CAR, "cannot bind to car service after max retry");
                     mMainThreadEventHandler.post(mConnectionRetryFailedRunnable);
                 } else {
                     mEventHandler.postDelayed(mConnectionRetryRunnable,
-                            CAR_SERVICE_BIND_RETRY_INTERVAL_MS);
+                            mDeps.carServiceBindRetryIntervalMs());
                 }
             } else {
                 mEventHandler.removeCallbacks(mConnectionRetryRunnable);
diff --git a/car-lib/src/android/car/IExperimentalCarUserService.aidl b/car-lib/src/android/car/IExperimentalCarUserService.aidl
deleted file mode 100644
index be832e3b47..0000000000
--- a/car-lib/src/android/car/IExperimentalCarUserService.aidl
+++ /dev/null
@@ -1,34 +0,0 @@
-/*
- * Copyright (C) 2021 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package android.car;
-
-import android.os.UserHandle;
-
-import android.car.user.UserCreationResult;
-import android.car.user.UserSwitchResult;
-import android.car.util.concurrent.AndroidFuture;
-
-/** @hide */
-interface IExperimentalCarUserService {
-    AndroidFuture<UserCreationResult> createDriver(@nullable String name, boolean admin);
-    UserHandle createPassenger(@nullable String name, int driverId);
-    void switchDriver(int driverId, in AndroidFuture<UserSwitchResult> receiver);
-    List<UserHandle> getAllDrivers();
-    List<UserHandle> getPassengers(int driverId);
-    boolean startPassenger(int passengerId, int zoneId);
-    boolean stopPassenger(int passengerId);
-}
diff --git a/car-lib/src/android/car/admin/CarDevicePolicyManager.java b/car-lib/src/android/car/admin/CarDevicePolicyManager.java
index e49c4fc0c5..4acaac3a49 100644
--- a/car-lib/src/android/car/admin/CarDevicePolicyManager.java
+++ b/car-lib/src/android/car/admin/CarDevicePolicyManager.java
@@ -317,6 +317,9 @@ public final class CarDevicePolicyManager extends CarManagerBase {
     }
 
     /** @hide */
+    @RequiresPermission(anyOf = {
+        android.Manifest.permission.MANAGE_USERS,
+        android.Manifest.permission.INTERACT_ACROSS_USERS})
     public void setUserDisclaimerAcknowledged(@NonNull UserHandle user) {
         Objects.requireNonNull(user, "user cannot be null");
         try {
diff --git a/car-lib/src/android/car/admin/TEST_MAPPING b/car-lib/src/android/car/admin/TEST_MAPPING
new file mode 100644
index 0000000000..6d17d9890e
--- /dev/null
+++ b/car-lib/src/android/car/admin/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibAdminUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/app/TEST_MAPPING b/car-lib/src/android/car/app/TEST_MAPPING
new file mode 100644
index 0000000000..0485bf08ba
--- /dev/null
+++ b/car-lib/src/android/car/app/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibAppUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/cluster/TEST_MAPPING b/car-lib/src/android/car/cluster/TEST_MAPPING
new file mode 100644
index 0000000000..966615a51c
--- /dev/null
+++ b/car-lib/src/android/car/cluster/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibClusterUnitTest"
+    }
+  ]
+}
diff --git a/tests/BugReportApp/TEST_MAPPING b/car-lib/src/android/car/content/pm/TEST_MAPPING
similarity index 56%
rename from tests/BugReportApp/TEST_MAPPING
rename to car-lib/src/android/car/content/pm/TEST_MAPPING
index 4d4a2a0249..06eca0efb5 100644
--- a/tests/BugReportApp/TEST_MAPPING
+++ b/car-lib/src/android/car/content/pm/TEST_MAPPING
@@ -1,7 +1,7 @@
 {
   "auto-presubmit": [
     {
-      "name": "BugReportAppTest"
+      "name": "CarLibPmUnitTest"
     }
   ]
 }
diff --git a/car-lib/src/android/car/evs/CarEvsManager.java b/car-lib/src/android/car/evs/CarEvsManager.java
index 172ce9f52c..03a93f4afd 100644
--- a/car-lib/src/android/car/evs/CarEvsManager.java
+++ b/car-lib/src/android/car/evs/CarEvsManager.java
@@ -798,22 +798,24 @@ public final class CarEvsManager extends CarManagerBase {
         Objects.requireNonNull(executor);
         Objects.requireNonNull(callback);
 
-        synchronized (mStreamLock) {
-            mStreamCallbacks.put(type, callback);
-            // TODO(b/321913871): Check whether we want to allow the clients to use more than a
-            //                    single executor or not.
-            mStreamCallbackExecutor = executor;
-        }
-
-        int status = ERROR_UNAVAILABLE;
         try {
-            // Requests the service to start a video stream
-            status = mService.startVideoStream(type, token, mStreamListenerToService);
+            int status = mService.startVideoStream(type, token, mStreamListenerToService);
+            if (status != ERROR_NONE) {
+                return status;
+            }
+
+            synchronized (mStreamLock) {
+                mStreamCallbacks.put(type, callback);
+                // TODO(b/321913871): Check whether we want to allow the clients to use more than a
+                //                    single executor or not.
+                mStreamCallbackExecutor = executor;
+            }
         } catch (RemoteException err) {
             handleRemoteExceptionFromCarService(err);
-        } finally {
-            return status;
+            return ERROR_UNAVAILABLE;
         }
+
+        return ERROR_NONE;
     }
 
     /**
diff --git a/car-lib/src/android/car/evs/TEST_MAPPING b/car-lib/src/android/car/evs/TEST_MAPPING
new file mode 100644
index 0000000000..ebf2bea4dc
--- /dev/null
+++ b/car-lib/src/android/car/evs/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibEvsUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/hardware/TEST_MAPPING b/car-lib/src/android/car/hardware/TEST_MAPPING
new file mode 100644
index 0000000000..b2f8eeefc5
--- /dev/null
+++ b/car-lib/src/android/car/hardware/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibPropertyUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/hardware/power/CarPowerManager.java b/car-lib/src/android/car/hardware/power/CarPowerManager.java
index 7097378b71..82967a18bb 100644
--- a/car-lib/src/android/car/hardware/power/CarPowerManager.java
+++ b/car-lib/src/android/car/hardware/power/CarPowerManager.java
@@ -526,8 +526,11 @@ public class CarPowerManager extends CarManagerBase {
      * If the given power policy doesn't exist, this method throws
      * {@link java.lang.IllegalArgumentException}.
      *
+     * <p>When this API returns, it doesn't mean the given power policy is applied. The application
+     * of a power policy can be checked with {@link CarPowerPolicyListener}.
+     *
      * @param policyId ID of power policy.
-     * @throws IllegalArgumentException if {@code policyId} is null.
+     * @throws IllegalArgumentException if {@code policyId} is {@code null}.
      *
      * @hide
      */
diff --git a/car-lib/src/android/car/hardware/property/CarPropertyManager.java b/car-lib/src/android/car/hardware/property/CarPropertyManager.java
index 5703ffe2d7..f144bb8863 100644
--- a/car-lib/src/android/car/hardware/property/CarPropertyManager.java
+++ b/car-lib/src/android/car/hardware/property/CarPropertyManager.java
@@ -400,7 +400,7 @@ public class CarPropertyManager extends CarManagerBase {
          * and the success callback will be called.
          *
          * <p>If this is set to {@code true} (by default), the success callback will be called when
-         * both of the following coniditions are met:
+         * both of the following conditions are met:
          *
          * <ul>
          * <li>the set operation is successfully delivered to vehicle bus.
@@ -1056,24 +1056,7 @@ public class CarPropertyManager extends CarManagerBase {
         mHandler = new SingleMessageHandler<>(eventHandler.getLooper(), MSG_GENERIC_EVENT) {
             @Override
             protected void handleEvent(CarPropertyEvent carPropertyEvent) {
-                int propertyId = carPropertyEvent.getCarPropertyValue().getPropertyId();
-                List<CarPropertyEventCallbackController> cpeCallbacks = new ArrayList<>();
-                synchronized (mLock) {
-                    ArraySet<CarPropertyEventCallbackController> cpeCallbackControllerSet =
-                            mPropIdToCpeCallbackControllerList.get(propertyId);
-                    if (cpeCallbackControllerSet == null) {
-                        Slog.w(TAG, "handleEvent: could not find any callbacks for propertyId="
-                                + VehiclePropertyIds.toString(propertyId));
-                        return;
-                    }
-                    for (int i = 0; i < cpeCallbackControllerSet.size(); i++) {
-                        cpeCallbacks.add(cpeCallbackControllerSet.valueAt(i));
-                    }
-                }
-
-                for (int i = 0; i < cpeCallbacks.size(); i++) {
-                    cpeCallbacks.get(i).onEvent(carPropertyEvent);
-                }
+                handleCarPropertyEvents(List.of(carPropertyEvent));
             }
         };
     }
@@ -1359,7 +1342,7 @@ public class CarPropertyManager extends CarManagerBase {
             @FloatRange(from = 0.0, to = 100.0) float updateRateHz,
             @NonNull CarPropertyEventCallback carPropertyEventCallback) {
         Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)
-                .setUpdateRateHz(updateRateHz).setVariableUpdateRateEnabled(false).build();
+                .setUpdateRateHz(updateRateHz).build();
         return subscribePropertyEvents(List.of(subscription), /* callbackExecutor= */ null,
                 carPropertyEventCallback);
     }
@@ -1641,7 +1624,14 @@ public class CarPropertyManager extends CarManagerBase {
     }
 
     private void handleEvents(List<CarPropertyEvent> carPropertyEvents) {
-        if (mHandler != null) {
+        if (mHandler == null) {
+            Slog.wtf(TAG,
+                    "Event handler was not created successfully, ignore all property events");
+            return;
+        }
+        if (mFeatureFlags.handlePropertyEventsInBinderThread()) {
+            handleCarPropertyEvents(carPropertyEvents);
+        } else {
             mHandler.sendEvents(carPropertyEvents);
         }
     }
@@ -2748,7 +2738,7 @@ public class CarPropertyManager extends CarManagerBase {
      * unavailable for a while.
      * @throws PropertyNotAvailableAndRetryException when [propertyId, areaId] is temporarily not
      * available and likely that retrying will be successful.
-     * @throws IllegalArgumentException when the [propertyId, areaId] is not supported.
+     * @throws IllegalArgumentException when the [propertyId, areaId] or value is not supported.
      */
     public <E> void setProperty(@NonNull Class<E> clazz, int propertyId, int areaId,
             @NonNull E val) {
@@ -3188,6 +3178,8 @@ public class CarPropertyManager extends CarManagerBase {
      * @param setPropertyCallback the callback function to deliver the result
      * @throws SecurityException if missing permission to write one of the specific properties.
      * @throws IllegalArgumentException if one of the properties to set is not supported.
+     * @throws IllegalArgumentException if one of the values to set is not supported by the
+     *   property.
      * @throws IllegalArgumentException if one of the properties is not readable and does not set
      *   {@code waitForPropertyUpdate} to {@code false}.
      * @throws IllegalArgumentException if one of the properties is
@@ -3261,6 +3253,54 @@ public class CarPropertyManager extends CarManagerBase {
                 callbackExecutor, setPropertyCallback);
     }
 
+    private void handleCarPropertyEvents(List<CarPropertyEvent> carPropertyEvents) {
+        SparseArray<List<CarPropertyEvent>> carPropertyEventsByPropertyId = new SparseArray<>();
+        for (int i = 0; i < carPropertyEvents.size(); i++) {
+            CarPropertyEvent carPropertyEvent = carPropertyEvents.get(i);
+            int propertyId = carPropertyEvent.getCarPropertyValue().getPropertyId();
+            if (carPropertyEventsByPropertyId.get(propertyId) == null) {
+                carPropertyEventsByPropertyId.put(propertyId, new ArrayList<>());
+            }
+            carPropertyEventsByPropertyId.get(propertyId).add(carPropertyEvent);
+        }
+
+        ArrayMap<CarPropertyEventCallbackController, List<CarPropertyEvent>> eventsByCallback =
+                new ArrayMap<>();
+
+        synchronized (mLock) {
+            for (int i = 0; i < carPropertyEventsByPropertyId.size(); i++) {
+                int propertyId = carPropertyEventsByPropertyId.keyAt(i);
+                List<CarPropertyEvent> eventsForPropertyId =
+                        carPropertyEventsByPropertyId.valueAt(i);
+                ArraySet<CarPropertyEventCallbackController> cpeCallbackControllerSet =
+                        mPropIdToCpeCallbackControllerList.get(propertyId);
+                if (cpeCallbackControllerSet == null) {
+                    Slog.w(TAG, "handleEvent: could not find any callbacks for propertyId="
+                            + VehiclePropertyIds.toString(propertyId));
+                    return;
+                }
+                for (int j = 0; j < cpeCallbackControllerSet.size(); j++) {
+                    var callback = cpeCallbackControllerSet.valueAt(j);
+                    if (eventsByCallback.get(callback) == null) {
+                        eventsByCallback.put(callback, new ArrayList<>());
+                    }
+                    eventsByCallback.get(callback).addAll(eventsForPropertyId);
+                }
+            }
+        }
+
+        // This might be invoked from a binder thread (CarPropertyEventListenerToService.onEvent),
+        // so we must clear calling identity before calling client executor.
+        Binder.clearCallingIdentity();
+        for (int i = 0; i < eventsByCallback.size(); i++) {
+            var callback = eventsByCallback.keyAt(i);
+            var events = eventsByCallback.valueAt(i);
+            for (int j = 0; j < events.size(); j++) {
+                callback.onEvent(events.get(j));
+            }
+        }
+    }
+
     private void assertPropertyIdIsSupported(int propertyId) {
         if (!CarPropertyHelper.isSupported(propertyId)) {
             throw new IllegalArgumentException("The property: "
diff --git a/car-lib/src/android/car/media/TEST_MAPPING b/car-lib/src/android/car/media/TEST_MAPPING
new file mode 100644
index 0000000000..11ec14c777
--- /dev/null
+++ b/car-lib/src/android/car/media/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibMediaUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/navigation/TEST_MAPPING b/car-lib/src/android/car/navigation/TEST_MAPPING
new file mode 100644
index 0000000000..649a70b7ee
--- /dev/null
+++ b/car-lib/src/android/car/navigation/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibNavigationUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/occupantconnection/TEST_MAPPING b/car-lib/src/android/car/occupantconnection/TEST_MAPPING
new file mode 100644
index 0000000000..0c7d17f7bb
--- /dev/null
+++ b/car-lib/src/android/car/occupantconnection/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibOccupantConnectionUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/oem/TEST_MAPPING b/car-lib/src/android/car/oem/TEST_MAPPING
new file mode 100644
index 0000000000..6bd29a3a3b
--- /dev/null
+++ b/car-lib/src/android/car/oem/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibOemUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/os/CarPerformanceManager.java b/car-lib/src/android/car/os/CarPerformanceManager.java
index 9b4959bfaa..546020a6d4 100644
--- a/car-lib/src/android/car/os/CarPerformanceManager.java
+++ b/car-lib/src/android/car/os/CarPerformanceManager.java
@@ -16,6 +16,9 @@
 
 package android.car.os;
 
+
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DEPRECATED_CODE;
+
 import android.annotation.CallbackExecutor;
 import android.annotation.NonNull;
 import android.annotation.RequiresPermission;
@@ -27,6 +30,8 @@ import android.os.Process;
 import android.os.RemoteException;
 import android.os.ServiceSpecificException;
 
+import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
+
 import java.util.Objects;
 import java.util.concurrent.Executor;
 
@@ -114,6 +119,7 @@ public final class CarPerformanceManager extends CarManagerBase {
      * @removed API not used since Android U. Must be removed in Android W (release 35).
      */
     @RequiresPermission(Car.PERMISSION_COLLECT_CAR_CPU_INFO)
+    @ExcludeFromCodeCoverageGeneratedReport(reason = DEPRECATED_CODE)
     public void addCpuAvailabilityChangeListener(
             @NonNull @CallbackExecutor Executor executor,
             @NonNull CpuAvailabilityMonitoringConfig config,
@@ -136,6 +142,7 @@ public final class CarPerformanceManager extends CarManagerBase {
      * @removed API not used since Android U. Must be removed in Android W (release 35).
      */
     @RequiresPermission(Car.PERMISSION_COLLECT_CAR_CPU_INFO)
+    @ExcludeFromCodeCoverageGeneratedReport(reason = DEPRECATED_CODE)
     public void removeCpuAvailabilityChangeListener(
             @NonNull @CallbackExecutor Executor executor,
             @NonNull CpuAvailabilityChangeListener listener) {
diff --git a/car-lib/src/android/car/os/TEST_MAPPING b/car-lib/src/android/car/os/TEST_MAPPING
new file mode 100644
index 0000000000..31bcca9a40
--- /dev/null
+++ b/car-lib/src/android/car/os/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibOsUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/remoteaccess/TEST_MAPPING b/car-lib/src/android/car/remoteaccess/TEST_MAPPING
new file mode 100644
index 0000000000..ff7c56cb41
--- /dev/null
+++ b/car-lib/src/android/car/remoteaccess/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibRemoteAccessUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/user/CarUserManager.java b/car-lib/src/android/car/user/CarUserManager.java
index 369d17c918..d25d3bc4f6 100644
--- a/car-lib/src/android/car/user/CarUserManager.java
+++ b/car-lib/src/android/car/user/CarUserManager.java
@@ -722,7 +722,6 @@ public final class CarUserManager extends CarManagerBase {
             EventLogHelper.writeCarUserManagerCreateUserReq(uid,
                     UserHelperLite.safeName(name), userType, flags);
             mService.createUser(userCreationRequest, HAL_TIMEOUT_MS, resultCallbackImpl);
-            System.out.println("manager test API replied");
         } catch (SecurityException e) {
             throw e;
         } catch (RemoteException | RuntimeException e) {
diff --git a/car-lib/src/android/car/user/ExperimentalCarUserManager.java b/car-lib/src/android/car/user/ExperimentalCarUserManager.java
deleted file mode 100644
index 3db49bc0f6..0000000000
--- a/car-lib/src/android/car/user/ExperimentalCarUserManager.java
+++ /dev/null
@@ -1,271 +0,0 @@
-/*
- * Copyright (C) 2020 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package android.car.user;
-
-import android.annotation.NonNull;
-import android.annotation.Nullable;
-import android.annotation.RequiresPermission;
-import android.annotation.UserIdInt;
-import android.car.Car;
-import android.car.CarManagerBase;
-import android.car.IExperimentalCarUserService;
-import android.car.annotation.ExperimentalFeature;
-import android.car.builtin.os.UserManagerHelper;
-import android.car.util.concurrent.AndroidFuture;
-import android.os.IBinder;
-import android.os.RemoteException;
-import android.os.UserHandle;
-import android.util.Slog;
-
-import com.android.internal.annotations.VisibleForTesting;
-
-import java.util.ArrayList;
-import java.util.Collections;
-import java.util.List;
-
-/**
- * Temporary class containing {@link CarUserManager} features that are not ready yet.
- *
- * <p>New instances are created through {@link #from(CarUserManager)}.
- *
- * @hide
- * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
- * supported. It will be marked {@code @removed} in the next major release and hard removed in the
- * release after that.
- */
-@ExperimentalFeature
-@Deprecated
-public final class ExperimentalCarUserManager extends CarManagerBase {
-
-    /** @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    public static final String TAG = ExperimentalCarUserManager.class.getSimpleName();
-
-    /**
-     *  User id representing invalid user.
-     */
-    private static final int INVALID_USER_ID = UserManagerHelper.USER_NULL;
-
-    private final IExperimentalCarUserService mService;
-
-    /**
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported. It will be marked {@code @removed} in the next major release and hard removed in
-     * the release after that.
-     */
-    @Deprecated
-    public ExperimentalCarUserManager(@NonNull Car car, @NonNull IBinder service) {
-        this(car, IExperimentalCarUserService.Stub.asInterface(service));
-    }
-
-    @VisibleForTesting
-    public ExperimentalCarUserManager(
-            @NonNull Car car, @NonNull IExperimentalCarUserService service) {
-        super(car);
-
-        mService = service;
-    }
-
-    /**
-     * Creates a driver who is a regular user and is allowed to login to the driving occupant zone.
-     *
-     * @param name The name of the driver to be created.
-     * @param admin Whether the created driver will be an admin.
-     * @return an {@link AndroidFuture} that can be used to track operation's completion and
-     *         retrieve its result (if any).
-     *
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    @RequiresPermission(android.Manifest.permission.MANAGE_USERS)
-    public AndroidFuture<UserCreationResult> createDriver(@NonNull String name, boolean admin) {
-        try {
-            return mService.createDriver(name, admin);
-        } catch (RemoteException e) {
-            AndroidFuture<UserCreationResult> future = new AndroidFuture<>();
-            future.complete(new UserCreationResult(UserCreationResult.STATUS_HAL_INTERNAL_FAILURE));
-            handleRemoteExceptionFromCarService(e);
-            return future;
-        }
-    }
-
-    /**
-     * Creates a passenger who is a profile of the given driver.
-     *
-     * @param name The name of the passenger to be created.
-     * @param driverId User id of the driver under whom a passenger is created.
-     * @return user id of the created passenger, or {@code INVALID_USER_ID} if the passenger
-     *         could not be created.
-     *
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    @RequiresPermission(android.Manifest.permission.MANAGE_USERS)
-    @Nullable
-    public int createPassenger(@NonNull String name, @UserIdInt int driverId) {
-        try {
-            UserHandle ui = mService.createPassenger(name, driverId);
-            return ui != null ? ui.getIdentifier() : INVALID_USER_ID;
-        } catch (RemoteException e) {
-            return handleRemoteExceptionFromCarService(e, null);
-        }
-    }
-
-    /**
-     * Switches a driver to the given user.
-     *
-     * @param driverId User id of the driver to switch to.
-     * @return an {@link AndroidFuture} that can be used to track operation's completion and
-     *         retrieve its result (if any).
-     *
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    @RequiresPermission(android.Manifest.permission.MANAGE_USERS)
-    public AndroidFuture<UserSwitchResult> switchDriver(@UserIdInt int driverId) {
-        try {
-            AndroidFuture<UserSwitchResult> future = new AndroidFuture<>() {
-                @Override
-                protected void onCompleted(UserSwitchResult result, Throwable err) {
-                    if (result == null) {
-                        Slog.w(TAG, "switchDriver(" + driverId + ") failed: " + err);
-                    }
-                    super.onCompleted(result, err);
-                }
-            };
-            mService.switchDriver(driverId, future);
-            return future;
-        } catch (RemoteException e) {
-            AndroidFuture<UserSwitchResult> future = new AndroidFuture<>();
-            future.complete(
-                    new UserSwitchResult(UserSwitchResult.STATUS_HAL_INTERNAL_FAILURE, null));
-            handleRemoteExceptionFromCarService(e);
-            return future;
-        }
-    }
-
-    /**
-     * Returns all drivers who can occupy the driving zone. Guest users are included in the list.
-     *
-     * @return the list of user ids who can be a driver on the device.
-     *
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    @RequiresPermission(android.Manifest.permission.MANAGE_USERS)
-    @NonNull
-    public List<Integer> getAllDrivers() {
-        try {
-            return getUserIdsFromUserHandles(mService.getAllDrivers());
-        } catch (RemoteException e) {
-            return handleRemoteExceptionFromCarService(e, Collections.emptyList());
-        }
-    }
-
-    /**
-     * Returns all passengers under the given driver.
-     *
-     * @param driverId User id of a driver.
-     * @return the list of user ids who are passengers under the given driver.
-     *
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    @RequiresPermission(android.Manifest.permission.MANAGE_USERS)
-    @NonNull
-    public List<Integer> getPassengers(@UserIdInt int driverId) {
-        try {
-            return getUserIdsFromUserHandles(mService.getPassengers(driverId));
-        } catch (RemoteException e) {
-            return handleRemoteExceptionFromCarService(e, Collections.emptyList());
-        }
-    }
-
-    /**
-     * Assigns the passenger to the zone and starts the user if it is not started yet.
-     *
-     * @param passengerId User id of the passenger to be started.
-     * @param zoneId Zone id to which the passenger is assigned.
-     * @return {@code true} if the user is successfully started or the user is already running.
-     *         Otherwise, {@code false}.
-     *
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    @RequiresPermission(android.Manifest.permission.MANAGE_USERS)
-    public boolean startPassenger(@UserIdInt int passengerId, int zoneId) {
-        try {
-            return mService.startPassenger(passengerId, zoneId);
-        } catch (RemoteException e) {
-            return handleRemoteExceptionFromCarService(e, false);
-        }
-    }
-
-    /**
-     * Stops the given passenger.
-     *
-     * @param passengerId User id of the passenger to be stopped.
-     * @return {@code true} if successfully stopped, or {@code false} if failed.
-     *
-     * @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    @RequiresPermission(android.Manifest.permission.MANAGE_USERS)
-    public boolean stopPassenger(@UserIdInt int passengerId) {
-        try {
-            return mService.stopPassenger(passengerId);
-        } catch (RemoteException e) {
-            return handleRemoteExceptionFromCarService(e, false);
-        }
-    }
-
-    /** @hide
-     * @deprecated {@link ExperimentalCarUserManager} was an experimental feature and is no longer
-     * supported.
-     */
-    @Deprecated
-    @Override
-    public void onCarDisconnected() {
-        // nothing to do
-    }
-
-    private List<Integer> getUserIdsFromUserHandles(List<UserHandle> infos) {
-        List<Integer> ids = new ArrayList<>(infos.size());
-        for (UserHandle ui : infos) {
-            ids.add(ui.getIdentifier());
-        }
-        return ids;
-    }
-}
diff --git a/car-lib/src/android/car/user/TEST_MAPPING b/car-lib/src/android/car/user/TEST_MAPPING
new file mode 100644
index 0000000000..1c1e5dfcf6
--- /dev/null
+++ b/car-lib/src/android/car/user/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibUserUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/util/concurrent/TEST_MAPPING b/car-lib/src/android/car/util/concurrent/TEST_MAPPING
new file mode 100644
index 0000000000..9f83e4ee32
--- /dev/null
+++ b/car-lib/src/android/car/util/concurrent/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibUtilConcurrentUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/vms/TEST_MAPPING b/car-lib/src/android/car/vms/TEST_MAPPING
new file mode 100644
index 0000000000..e2bb5ef307
--- /dev/null
+++ b/car-lib/src/android/car/vms/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibVmsUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/android/car/watchdog/CarWatchdogManager.java b/car-lib/src/android/car/watchdog/CarWatchdogManager.java
index 9d2ebe3ea0..9aa26d0a04 100644
--- a/car-lib/src/android/car/watchdog/CarWatchdogManager.java
+++ b/car-lib/src/android/car/watchdog/CarWatchdogManager.java
@@ -47,8 +47,10 @@ import java.util.Objects;
 import java.util.concurrent.Executor;
 
 /**
- * CarWatchdogManager allows applications to collect latest system resource overuse statistics, add
- * listener for resource overuse notifications, and update resource overuse configurations.
+ * CarWatchdogManager enables applications to track and manage system resource usage.
+ *
+ * <p>It allows applications to collect latest system resource overuse statistics, add listener for
+ * resource overuse notifications, and update resource overuse configurations.
  */
 public final class CarWatchdogManager extends CarManagerBase {
 
@@ -61,7 +63,7 @@ public final class CarWatchdogManager extends CarManagerBase {
     private final Runnable mMainThreadCheck = () -> checkMainThread();
 
     /**
-     * Timeout for services which should be responsive. The length is 3,000 milliseconds.
+     * Timeout for critical services that need to be responsive in 3000 milliseconds.
      *
      * @hide
      */
@@ -69,7 +71,7 @@ public final class CarWatchdogManager extends CarManagerBase {
     public static final int TIMEOUT_CRITICAL = 0;
 
     /**
-     * Timeout for services which are relatively responsive. The length is 5,000 milliseconds.
+     * Timeout for moderate services that need to be responsive in 5000 milliseconds.
      *
      * @hide
      */
@@ -77,7 +79,7 @@ public final class CarWatchdogManager extends CarManagerBase {
     public static final int TIMEOUT_MODERATE = 1;
 
     /**
-     * Timeout for all other services. The length is 10,000 milliseconds.
+     * Timeout for normal services that need to be responsive in 10000 milliseconds.
      *
      * @hide
      */
@@ -113,13 +115,16 @@ public final class CarWatchdogManager extends CarManagerBase {
     private int mRemainingConditions;
 
     /**
-     * CarWatchdogClientCallback is implemented by the clients which want to be health-checked by
-     * car watchdog server. Every time onCheckHealthStatus is called, they are expected to
-     * respond by calling {@link #tellClientAlive} within timeout. If they don't
-     * respond, car watchdog server reports the current state and kills them.
+     * A callback class for handling the CarWatchdog daemon's health check pings.
+     *
+     * <p>CarWatchdogClientCallback is implemented by the clients who want to be health-checked by
+     * the CarWatchdog daemon. On each onCheckHealthStatus call, clients are expected to respond by
+     * calling {@link CarWatchdogManager#tellClientAlive} within the timeout. If they fail to
+     * respond, the CarWatchdog daemon reports the current state and kills them.
      *
-     * <p>Before car watchdog server kills the client, it calls onPrepareProcessTermination to allow
-     * them to prepare the termination. They will be killed in 1 second.
+     * <p>Before termination, the CarWatchdog daemon calls {@link
+     * CarWatchdogClientCallback#onPrepareProcessTermination} to allow clients to prepare for the
+     * termination, which will occur after 1 second.
      *
      * @hide
      */
@@ -167,9 +172,8 @@ public final class CarWatchdogManager extends CarManagerBase {
     /**
      * Registers the car watchdog clients to {@link CarWatchdogManager}.
      *
-     * <p>It is allowed to register a client from any thread, but only one client can be
-     * registered. If two or more clients are needed, create a new {@link Car} and register a client
-     * to it.
+     * <p>It is allowed to register a client from any thread, but only one client can be registered.
+     * If two or more clients are needed, create a new {@link Car} and register a client to it.
      *
      * @param client Watchdog client implementing {@link CarWatchdogClientCallback} interface.
      * @param timeout The time duration within which the client desires to respond. The actual
@@ -321,39 +325,73 @@ public final class CarWatchdogManager extends CarManagerBase {
 
     /**
      * Constants that define the stats period in days.
+     *
+     * <p>The following constants represent the stats period for the past N days, It is used to
+     * specify that the stats should be gathered for the last N days, including today and the N-1
+     * previous days.
+     *
+     * <p>The stats period for the current day.
      */
     public static final int STATS_PERIOD_CURRENT_DAY = 1;
+
+    /** The stats period for the past 3 days. */
     public static final int STATS_PERIOD_PAST_3_DAYS = 2;
+
+    /** The stats period for the past 7 days */
     public static final int STATS_PERIOD_PAST_7_DAYS = 3;
+
+    /** The stats period for the past 15 days */
     public static final int STATS_PERIOD_PAST_15_DAYS = 4;
+
+    /** The stats period for the past 30 days */
     public static final int STATS_PERIOD_PAST_30_DAYS = 5;
 
-    /**
-     * Constants that define the type of resource overuse.
-     */
+    /** Constants that define the type of resource overuse. */
     public static final int FLAG_RESOURCE_OVERUSE_IO = 1 << 0;
 
     /**
      * Constants that define the minimum stats for each resource type.
      *
-     * Below constants specify the minimum amount of data written to disk.
+     * <p>The following constants represent the minimum amount of data written to disk.
+     *
+     * <p>The minimum amount of data that should be written to disk is 1 MB.
      *
      * @hide
      */
     @SystemApi
     public static final int FLAG_MINIMUM_STATS_IO_1_MB = 1 << 0;
-    /** @hide */
+
+    /**
+     * The minimum amount of data that should be written to disk is 100 MB.
+     *
+     * @hide
+     */
     @SystemApi
     public static final int FLAG_MINIMUM_STATS_IO_100_MB = 1 << 1;
-    /** @hide */
+
+    /**
+     * The minimum amount of data that should be written to disk is 1 GB.
+     *
+     * @hide
+     */
     @SystemApi
     public static final int FLAG_MINIMUM_STATS_IO_1_GB = 1 << 2;
 
-    // Return codes used to indicate the result of a request.
-    /** @hide */
+    /**
+     * Returns codes used to indicate the result of a request.
+     *
+     * <p>The return code indicating a successful request.
+     *
+     * @hide
+     */
     @SystemApi
     public static final int RETURN_CODE_SUCCESS = 0;
-    /** @hide */
+
+    /**
+     * The return code indicating an error in the request.
+     *
+     * @hide
+     */
     @SystemApi
     public static final int RETURN_CODE_ERROR = -1;
 
@@ -387,18 +425,15 @@ public final class CarWatchdogManager extends CarManagerBase {
      *
      * @param resourceOveruseFlag Flag to indicate the types of resource overuse stats to return.
      * @param minimumStatsFlag Flag to specify the minimum stats for each resource overuse type.
-     *                         Only stats above the specified minimum stats for a resource overuse
-     *                         type will be returned. May provide only one minimum stats flag for
-     *                         each resource overuse type. When no minimum stats flag is specified,
-     *                         all stats are returned.
+     *     Only stats greater than the specified minimum stats for a resource overuse type will be
+     *     returned. May provide only one minimum stats flag for each resource overuse type. When no
+     *     minimum stats flag is specified, all stats are returned.
      * @param maxStatsPeriod Maximum period to aggregate the resource overuse stats.
-     *
      * @return Resource overuse stats for all monitored packages. If any package doesn't have stats
-     *         for a specified resource type, null value is returned for the corresponding resource
-     *         overuse stats. If any package doesn't have sufficient stats for
-     *         {@code maxStatsPeriod} for a specified resource overuse type, the stats are returned
-     *         only for the period returned in the individual resource stats.
-     *
+     *     for a specified resource type, null value is returned for the corresponding resource
+     *     overuse stats. If any package doesn't have sufficient stats for {@code maxStatsPeriod}
+     *     for a specified resource overuse type, the stats are returned only for the period
+     *     returned in the individual resource stats.
      * @hide
      */
     @SystemApi
@@ -460,11 +495,11 @@ public final class CarWatchdogManager extends CarManagerBase {
          *
          * <p>The listener is called at the executor which is specified in {@link
          * CarWatchdogManager#addResourceOveruseListener} or
-         * {@code addResourceOveruseListenerForSystem}.
+         * {@link CarWatchdogManager#addResourceOveruseListenerForSystem}.
          *
          * <p>The listener is called only on overusing one of the resources specified at the
          * {@code resourceOveruseFlag} in {@link CarWatchdogManager#addResourceOveruseListener} or
-         * {@code addResourceOveruseListenerForSystem}.
+         * {@link CarWatchdogManager#addResourceOveruseListenerForSystem}.
          *
          * @param resourceOveruseStats Resource overuse stats containing stats only for resources
          *                             overuse types that are either overused or about to be
diff --git a/car-lib/src/android/car/watchdog/IoOveruseConfiguration.java b/car-lib/src/android/car/watchdog/IoOveruseConfiguration.java
index 08b8c58d0b..8e45a0eb01 100644
--- a/car-lib/src/android/car/watchdog/IoOveruseConfiguration.java
+++ b/car-lib/src/android/car/watchdog/IoOveruseConfiguration.java
@@ -87,7 +87,6 @@ public final class IoOveruseConfiguration implements Parcelable {
     //
     // To regenerate run:
     // $ codegen $ANDROID_BUILD_TOP/packages/services/Car/car-lib/src/android/car/watchdog/IoOveruseConfiguration.java
-    // Added AddedInOrBefore or ApiRequirement Annotation manually
     //
     // To exclude the generated code from IntelliJ auto-formatting enable (one-time):
     //   Settings > Editor > Code Style > Formatter Control
@@ -431,7 +430,7 @@ public final class IoOveruseConfiguration implements Parcelable {
     }
 
     @DataClass.Generated(
-            time = 1628099281770L,
+            time = 1721754505645L,
             codegenVersion = "1.0.23",
             sourceFile = "packages/services/Car/car-lib/src/android/car/watchdog/IoOveruseConfiguration.java",
             inputSignatures = "private @android.annotation.NonNull android.car.watchdog.PerStateBytes mComponentLevelThresholds\nprivate @android.annotation.NonNull java.util.Map<java.lang.String,android.car.watchdog.PerStateBytes> mPackageSpecificThresholds\nprivate @android.annotation.NonNull java.util.Map<java.lang.String,android.car.watchdog.PerStateBytes> mAppCategorySpecificThresholds\nprivate @android.annotation.NonNull java.util.List<android.car.watchdog.IoOveruseAlertThreshold> mSystemWideThresholds\nclass IoOveruseConfiguration extends java.lang.Object implements [android.os.Parcelable]\n@com.android.car.internal.util.DataClass(genToString=true, genBuilder=true, genHiddenConstDefs=true)")
diff --git a/car-lib/src/android/car/watchdog/IoOveruseStats.java b/car-lib/src/android/car/watchdog/IoOveruseStats.java
index 07f580f61c..216f5e4b96 100644
--- a/car-lib/src/android/car/watchdog/IoOveruseStats.java
+++ b/car-lib/src/android/car/watchdog/IoOveruseStats.java
@@ -31,12 +31,12 @@ import com.android.car.internal.util.DataClass;
 @DataClass(genToString = true, genHiddenBuilder = true)
 public final class IoOveruseStats implements Parcelable {
     /**
-     * Start time, in epoch seconds, for the below stats.
+     * Start time of the time period, in epoch seconds.
      */
     private long mStartTime;
 
     /**
-     * Duration, in seconds, for the below stats.
+     * Duration of the time period, in seconds.
      */
     private long mDurationInSeconds;
 
@@ -69,7 +69,7 @@ public final class IoOveruseStats implements Parcelable {
      * <p>On exceeding these limit in at least one system or application state, the package may be
      * killed if {@link #mKillableOnOveruse} is {@code true}.
      *
-     * <p>The above period does not apply to this field.
+     * <p>The {@link #mDurationInSeconds} does not apply to this field.
      */
     private @NonNull PerStateBytes mRemainingWriteBytes = new PerStateBytes(0L, 0L, 0L);
 
@@ -82,7 +82,6 @@ public final class IoOveruseStats implements Parcelable {
     //
     // To regenerate run:
     // $ codegen $ANDROID_BUILD_TOP/packages/services/Car/car-lib/src/android/car/watchdog/IoOveruseStats.java
-    // Added AddedInOrBefore or ApiRequirement Annotation manually
     //
     // To exclude the generated code from IntelliJ auto-formatting enable (one-time):
     //   Settings > Editor > Code Style > Formatter Control
@@ -112,7 +111,7 @@ public final class IoOveruseStats implements Parcelable {
     }
 
     /**
-     * Start time, in epoch seconds, for the below stats.
+     * Start time of the time period, in epoch seconds.
      */
     @DataClass.Generated.Member
     public long getStartTime() {
@@ -120,7 +119,7 @@ public final class IoOveruseStats implements Parcelable {
     }
 
     /**
-     * Duration, in seconds, for the below stats.
+     * Duration of the time period, in seconds.
      */
     @DataClass.Generated.Member
     public long getDurationInSeconds() {
@@ -155,7 +154,7 @@ public final class IoOveruseStats implements Parcelable {
     /**
      * Package may be killed on disk I/O overuse.
      *
-     * <p>Disk I/O overuse is triggered on exceeding {@link #getRemainingWriteBytes()}.
+     * <p>Disk I/O overuse is triggered on exceeding {@link #mRemainingWriteBytes}.
      */
     @DataClass.Generated.Member
     public boolean isKillableOnOveruse() {
@@ -166,9 +165,9 @@ public final class IoOveruseStats implements Parcelable {
      * Number of write bytes remaining in each application or system state.
      *
      * <p>On exceeding these limit in at least one system or application state, the package may be
-     * killed if {@link #isKillableOnOveruse()} is {@code true}.
+     * killed if {@link #mKillableOnOveruse} is {@code true}.
      *
-     * <p>The above period does not apply to this field.
+     * <p>The {@link #mDurationInSeconds} does not apply to this field.
      */
     @DataClass.Generated.Member
     public @NonNull PerStateBytes getRemainingWriteBytes() {
@@ -279,9 +278,9 @@ public final class IoOveruseStats implements Parcelable {
          * Creates a new Builder.
          *
          * @param startTime
-         *   Start time, in epoch seconds, for the below stats.
+         *   Start time of the time period, in epoch seconds.
          * @param durationInSeconds
-         *   Duration, in seconds, for the below stats.
+         *   Duration of the time period, in seconds.
          */
         public Builder(
                 long startTime,
@@ -291,7 +290,7 @@ public final class IoOveruseStats implements Parcelable {
         }
 
         /**
-         * Start time, in epoch seconds, for the below stats.
+         * Start time of the time period, in epoch seconds.
          */
         @DataClass.Generated.Member
         public @NonNull Builder setStartTime(long value) {
@@ -302,7 +301,7 @@ public final class IoOveruseStats implements Parcelable {
         }
 
         /**
-         * Duration, in seconds, for the below stats.
+         * Duration of the time period, in seconds.
          */
         @DataClass.Generated.Member
         public @NonNull Builder setDurationInSeconds(long value) {
@@ -365,7 +364,7 @@ public final class IoOveruseStats implements Parcelable {
          * <p>On exceeding these limit in at least one system or application state, the package may be
          * killed if {@link #mKillableOnOveruse} is {@code true}.
          *
-         * <p>The above period does not apply to this field.
+         * <p>The {@link #mDurationInSeconds} does not apply to this field.
          */
         @DataClass.Generated.Member
         public @NonNull Builder setRemainingWriteBytes(@NonNull PerStateBytes value) {
@@ -415,7 +414,7 @@ public final class IoOveruseStats implements Parcelable {
     }
 
     @DataClass.Generated(
-            time = 1628099298965L,
+            time = 1721770855487L,
             codegenVersion = "1.0.23",
             sourceFile = "packages/services/Car/car-lib/src/android/car/watchdog/IoOveruseStats.java",
             inputSignatures = "private  long mStartTime\nprivate  long mDurationInSeconds\nprivate  long mTotalOveruses\nprivate  long mTotalTimesKilled\nprivate  long mTotalBytesWritten\nprivate  boolean mKillableOnOveruse\nprivate @android.annotation.NonNull android.car.watchdog.PerStateBytes mRemainingWriteBytes\nclass IoOveruseStats extends java.lang.Object implements [android.os.Parcelable]\n@com.android.car.internal.util.DataClass(genToString=true, genHiddenBuilder=true)")
diff --git a/car-lib/src/android/car/watchdog/PackageKillableState.java b/car-lib/src/android/car/watchdog/PackageKillableState.java
index 2e0b5f9c0f..1b51499893 100644
--- a/car-lib/src/android/car/watchdog/PackageKillableState.java
+++ b/car-lib/src/android/car/watchdog/PackageKillableState.java
@@ -48,7 +48,7 @@ public final class PackageKillableState implements Parcelable {
     public static final int KILLABLE_STATE_NO = 2;
 
     /**
-     * A package is never killable i.e., it's setting cannot be updated.
+     * A package is never killable i.e. its setting cannot be updated.
      */
     @KillableState
     public static final int KILLABLE_STATE_NEVER = 3;
@@ -77,7 +77,6 @@ public final class PackageKillableState implements Parcelable {
     //
     // To regenerate run:
     // $ codegen $ANDROID_BUILD_TOP/packages/services/Car/car-lib/src/android/car/watchdog/PackageKillableState.java
-    // Added AddedInOrBefore or ApiRequirement Annotation manually
     //
     // To exclude the generated code from IntelliJ auto-formatting enable (one-time):
     //   Settings > Editor > Code Style > Formatter Control
@@ -247,10 +246,10 @@ public final class PackageKillableState implements Parcelable {
     };
 
     @DataClass.Generated(
-            time = 1673057615349L,
+            time = 1721755741237L,
             codegenVersion = "1.0.23",
             sourceFile = "packages/services/Car/car-lib/src/android/car/watchdog/PackageKillableState.java",
-            inputSignatures = "public static final @android.car.watchdog.PackageKillableState.KillableState @android.car.annotation.AddedInOrBefore int KILLABLE_STATE_YES\npublic static final @android.car.watchdog.PackageKillableState.KillableState @android.car.annotation.AddedInOrBefore int KILLABLE_STATE_NO\npublic static final @android.car.watchdog.PackageKillableState.KillableState @android.car.annotation.AddedInOrBefore int KILLABLE_STATE_NEVER\nprivate @android.annotation.NonNull java.lang.String mPackageName\nprivate @android.annotation.UserIdInt int mUserId\nprivate @android.car.watchdog.PackageKillableState.KillableState int mKillableState\nclass PackageKillableState extends java.lang.Object implements [android.os.Parcelable]\n@com.android.car.internal.util.DataClass(genToString=true, genHiddenConstructor=true, genHiddenConstDefs=true)")
+            inputSignatures = "public static final @android.car.watchdog.PackageKillableState.KillableState int KILLABLE_STATE_YES\npublic static final @android.car.watchdog.PackageKillableState.KillableState int KILLABLE_STATE_NO\npublic static final @android.car.watchdog.PackageKillableState.KillableState int KILLABLE_STATE_NEVER\nprivate @android.annotation.NonNull java.lang.String mPackageName\nprivate @android.annotation.UserIdInt int mUserId\nprivate @android.car.watchdog.PackageKillableState.KillableState int mKillableState\nclass PackageKillableState extends java.lang.Object implements [android.os.Parcelable]\n@com.android.car.internal.util.DataClass(genToString=true, genHiddenConstructor=true, genHiddenConstDefs=true)")
     @Deprecated
     @ExcludeFromCodeCoverageGeneratedReport(reason = BOILERPLATE_CODE)
     private void __metadata() {}
diff --git a/car-lib/src/android/car/watchdog/PerStateBytes.java b/car-lib/src/android/car/watchdog/PerStateBytes.java
index 1bbda2ad9b..64f296af7c 100644
--- a/car-lib/src/android/car/watchdog/PerStateBytes.java
+++ b/car-lib/src/android/car/watchdog/PerStateBytes.java
@@ -45,14 +45,13 @@ public final class PerStateBytes implements Parcelable {
 
 
 
-    // Code below generated by codegen v1.0.22.
+    // Code below generated by codegen v1.0.23.
     //
     // DO NOT MODIFY!
     // CHECKSTYLE:OFF Generated code
     //
     // To regenerate run:
     // $ codegen $ANDROID_BUILD_TOP/packages/services/Car/car-lib/src/android/car/watchdog/PerStateBytes.java
-    // Added AddedInOrBefore or ApiRequirement Annotation manually
     //
     // To exclude the generated code from IntelliJ auto-formatting enable (one-time):
     //   Settings > Editor > Code Style > Formatter Control
@@ -167,8 +166,8 @@ public final class PerStateBytes implements Parcelable {
     };
 
     @DataClass.Generated(
-            time = 1614388529869L,
-            codegenVersion = "1.0.22",
+            time = 1721755909734L,
+            codegenVersion = "1.0.23",
             sourceFile = "packages/services/Car/car-lib/src/android/car/watchdog/PerStateBytes.java",
             inputSignatures = "private  long mForegroundModeBytes\nprivate  long mBackgroundModeBytes\nprivate  long mGarageModeBytes\nclass PerStateBytes extends java.lang.Object implements [android.os.Parcelable]\n@com.android.car.internal.util.DataClass(genToString=true)")
     @Deprecated
diff --git a/car-lib/src/android/car/watchdog/ResourceOveruseConfiguration.java b/car-lib/src/android/car/watchdog/ResourceOveruseConfiguration.java
index 263daa42fa..b1ca5d4825 100644
--- a/car-lib/src/android/car/watchdog/ResourceOveruseConfiguration.java
+++ b/car-lib/src/android/car/watchdog/ResourceOveruseConfiguration.java
@@ -130,7 +130,6 @@ public final class ResourceOveruseConfiguration implements Parcelable {
     //
     // To regenerate run:
     // $ codegen $ANDROID_BUILD_TOP/packages/services/Car/car-lib/src/android/car/watchdog/ResourceOveruseConfiguration.java
-    // Added AddedInOrBefore or ApiRequirement Annotation manually
     //
     // To exclude the generated code from IntelliJ auto-formatting enable (one-time):
     //   Settings > Editor > Code Style > Formatter Control
@@ -567,10 +566,10 @@ public final class ResourceOveruseConfiguration implements Parcelable {
     }
 
     @DataClass.Generated(
-            time = 1673057073656L,
+            time = 1721756194509L,
             codegenVersion = "1.0.23",
             sourceFile = "packages/services/Car/car-lib/src/android/car/watchdog/ResourceOveruseConfiguration.java",
-            inputSignatures = "public static final @android.car.watchdog.ResourceOveruseConfiguration.ComponentType @android.car.annotation.AddedInOrBefore int COMPONENT_TYPE_SYSTEM\npublic static final @android.car.watchdog.ResourceOveruseConfiguration.ComponentType @android.car.annotation.AddedInOrBefore int COMPONENT_TYPE_VENDOR\npublic static final @android.car.watchdog.ResourceOveruseConfiguration.ComponentType @android.car.annotation.AddedInOrBefore int COMPONENT_TYPE_THIRD_PARTY\npublic static final @android.car.watchdog.ResourceOveruseConfiguration.ApplicationCategoryType @android.car.annotation.AddedInOrBefore java.lang.String APPLICATION_CATEGORY_TYPE_MAPS\npublic static final @android.car.watchdog.ResourceOveruseConfiguration.ApplicationCategoryType @android.car.annotation.AddedInOrBefore java.lang.String APPLICATION_CATEGORY_TYPE_MEDIA\nprivate @android.car.watchdog.ResourceOveruseConfiguration.ComponentType int mComponentType\nprivate @android.annotation.NonNull java.util.List<java.lang.String> mSafeToKillPackages\nprivate @android.annotation.NonNull java.util.List<java.lang.String> mVendorPackagePrefixes\nprivate @android.annotation.NonNull java.util.Map<java.lang.String,java.lang.String> mPackagesToAppCategoryTypes\nprivate @android.annotation.Nullable android.car.watchdog.IoOveruseConfiguration mIoOveruseConfiguration\nclass ResourceOveruseConfiguration extends java.lang.Object implements [android.os.Parcelable]\n@com.android.car.internal.util.DataClass(genToString=true, genBuilder=true, genHiddenConstDefs=true)")
+            inputSignatures = "public static final @android.car.watchdog.ResourceOveruseConfiguration.ComponentType int COMPONENT_TYPE_SYSTEM\npublic static final @android.car.watchdog.ResourceOveruseConfiguration.ComponentType int COMPONENT_TYPE_VENDOR\npublic static final @android.car.watchdog.ResourceOveruseConfiguration.ComponentType int COMPONENT_TYPE_THIRD_PARTY\npublic static final @android.car.watchdog.ResourceOveruseConfiguration.ApplicationCategoryType java.lang.String APPLICATION_CATEGORY_TYPE_MAPS\npublic static final @android.car.watchdog.ResourceOveruseConfiguration.ApplicationCategoryType java.lang.String APPLICATION_CATEGORY_TYPE_MEDIA\nprivate @android.car.watchdog.ResourceOveruseConfiguration.ComponentType int mComponentType\nprivate @android.annotation.NonNull java.util.List<java.lang.String> mSafeToKillPackages\nprivate @android.annotation.NonNull java.util.List<java.lang.String> mVendorPackagePrefixes\nprivate @android.annotation.NonNull java.util.Map<java.lang.String,java.lang.String> mPackagesToAppCategoryTypes\nprivate @android.annotation.Nullable android.car.watchdog.IoOveruseConfiguration mIoOveruseConfiguration\nclass ResourceOveruseConfiguration extends java.lang.Object implements [android.os.Parcelable]\n@com.android.car.internal.util.DataClass(genToString=true, genBuilder=true, genHiddenConstDefs=true)")
     @Deprecated
     @ExcludeFromCodeCoverageGeneratedReport(reason = BOILERPLATE_CODE)
     private void __metadata() {}
diff --git a/car-lib/src/android/car/watchdog/ResourceOveruseStats.java b/car-lib/src/android/car/watchdog/ResourceOveruseStats.java
index d02ad30831..40ded02628 100644
--- a/car-lib/src/android/car/watchdog/ResourceOveruseStats.java
+++ b/car-lib/src/android/car/watchdog/ResourceOveruseStats.java
@@ -16,11 +16,14 @@
 
 package android.car.watchdog;
 
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.BOILERPLATE_CODE;
+
 import android.annotation.NonNull;
 import android.annotation.Nullable;
 import android.os.Parcelable;
 import android.os.UserHandle;
 
+import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.util.AnnotationValidations;
 import com.android.car.internal.util.DataClass;
 
@@ -141,6 +144,7 @@ public final class ResourceOveruseStats implements Parcelable {
 
     @Override
     @DataClass.Generated.Member
+    @ExcludeFromCodeCoverageGeneratedReport(reason = BOILERPLATE_CODE)
     public int describeContents() { return 0; }
 
     /** @hide */
@@ -279,11 +283,12 @@ public final class ResourceOveruseStats implements Parcelable {
     }
 
     @DataClass.Generated(
-            time = 1715718593235L,
+            time = 1721756572114L,
             codegenVersion = "1.0.23",
             sourceFile = "packages/services/Car/car-lib/src/android/car/watchdog/ResourceOveruseStats.java",
             inputSignatures = "private @android.annotation.NonNull java.lang.String mPackageName\nprivate @android.annotation.NonNull android.os.UserHandle mUserHandle\nprivate @android.annotation.Nullable android.car.watchdog.IoOveruseStats mIoOveruseStats\nclass ResourceOveruseStats extends java.lang.Object implements [android.os.Parcelable]\n@com.android.car.internal.util.DataClass(genToString=true, genHiddenBuilder=true)")
     @Deprecated
+    @ExcludeFromCodeCoverageGeneratedReport(reason = BOILERPLATE_CODE)
     private void __metadata() {}
 
 
diff --git a/car-lib/src/android/car/wifi/TEST_MAPPING b/car-lib/src/android/car/wifi/TEST_MAPPING
new file mode 100644
index 0000000000..451093f380
--- /dev/null
+++ b/car-lib/src/android/car/wifi/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibWifiUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/com/android/car/internal/CarPermission.java b/car-lib/src/com/android/car/internal/CarPermission.java
index 6b775d734e..0807de8f9d 100644
--- a/car-lib/src/com/android/car/internal/CarPermission.java
+++ b/car-lib/src/com/android/car/internal/CarPermission.java
@@ -23,20 +23,16 @@ import android.os.Process;
 
 /**
  * Represent an Android permission.
- *
- * @hide
  */
 public class CarPermission {
     private final Context mContext;
     private final String mName;
 
-    /** @hide */
     public CarPermission(Context context, String name) {
         mContext = context;
         mName = name;
     }
 
-    /** @hide */
     public boolean checkGranted() {
         if (mName != null) {
             if (Binder.getCallingUid() != Process.myUid()) {
@@ -47,7 +43,6 @@ public class CarPermission {
         return true;
     }
 
-    /** @hide */
     public void assertGranted() {
         if (checkGranted()) return;
         throw new SecurityException(
@@ -59,7 +54,6 @@ public class CarPermission {
                         + Binder.getCallingUid());
     }
 
-    /** @hide */
     @Override
     public String toString() {
         return mName;
diff --git a/car-lib/src/com/android/car/internal/CarRatedListeners.java b/car-lib/src/com/android/car/internal/CarRatedListeners.java
index 5284a5bf8e..8a9d3f7976 100644
--- a/car-lib/src/com/android/car/internal/CarRatedListeners.java
+++ b/car-lib/src/com/android/car/internal/CarRatedListeners.java
@@ -25,7 +25,6 @@ import java.util.Map;
  * Represent listeners for a sensor grouped by their rate.
  *
  * @param <EventListenerType> type of event listener
- * @hide
  */
 public class CarRatedListeners<EventListenerType> {
     private final Map<EventListenerType, Integer> mListenersToRate = new HashMap<>(4);
diff --git a/car-lib/src/com/android/car/internal/CarSafetyAccessibilityServiceImplBase.java b/car-lib/src/com/android/car/internal/CarSafetyAccessibilityServiceImplBase.java
index c74cb3f40e..97ac9ae675 100644
--- a/car-lib/src/com/android/car/internal/CarSafetyAccessibilityServiceImplBase.java
+++ b/car-lib/src/com/android/car/internal/CarSafetyAccessibilityServiceImplBase.java
@@ -21,8 +21,6 @@ import android.view.accessibility.AccessibilityEvent;
 /**
  * Base class for CarSafetyAccessibilityServiceImpl. This is used as an interface between builtin
  * and updatable car service. Do not change it without compatibility check.
- *
- * @hide
  */
 public abstract class CarSafetyAccessibilityServiceImplBase {
     /**
diff --git a/car-lib/src/com/android/car/internal/ExcludeFromCodeCoverageGeneratedReport.java b/car-lib/src/com/android/car/internal/ExcludeFromCodeCoverageGeneratedReport.java
index 5710a7e21d..64f8ff7f2f 100644
--- a/car-lib/src/com/android/car/internal/ExcludeFromCodeCoverageGeneratedReport.java
+++ b/car-lib/src/com/android/car/internal/ExcludeFromCodeCoverageGeneratedReport.java
@@ -23,8 +23,6 @@ import java.lang.annotation.Target;
 
 /**
  * Annotation used to mark code to be excluded from coverage report.
- *
- * @hide
  */
 @Target({ElementType.TYPE, ElementType.CONSTRUCTOR, ElementType.METHOD})
 public @interface ExcludeFromCodeCoverageGeneratedReport {
diff --git a/car-lib/src/com/android/car/internal/FeatureUtil.java b/car-lib/src/com/android/car/internal/FeatureUtil.java
index c601a9d16f..4f44ab350e 100644
--- a/car-lib/src/com/android/car/internal/FeatureUtil.java
+++ b/car-lib/src/com/android/car/internal/FeatureUtil.java
@@ -17,7 +17,6 @@ package com.android.car.internal;
 
 /**
  * Internal utility for checking feature
- * @hide
  */
 public class FeatureUtil {
 
diff --git a/car-lib/src/com/android/car/internal/ICarBase.java b/car-lib/src/com/android/car/internal/ICarBase.java
index af7850bb8c..409578b610 100644
--- a/car-lib/src/com/android/car/internal/ICarBase.java
+++ b/car-lib/src/com/android/car/internal/ICarBase.java
@@ -27,8 +27,6 @@ import android.os.RemoteException;
  * or car manager.
  *
  * This interface allows faking the implementation in unit tests.
- *
- * @hide
  */
 public interface ICarBase {
     /**
diff --git a/car-lib/src/com/android/car/internal/ICarServiceHelper.aidl b/car-lib/src/com/android/car/internal/ICarServiceHelper.aidl
index 874d2a7741..b291e19adb 100644
--- a/car-lib/src/com/android/car/internal/ICarServiceHelper.aidl
+++ b/car-lib/src/com/android/car/internal/ICarServiceHelper.aidl
@@ -26,9 +26,6 @@ import java.util.List;
  *
  * Only for interaction between system server and car service, so it can be changed (without
  * breaking Car Mainline)
- *
- *
- * @hide
  */
 interface ICarServiceHelper {
     /**
@@ -103,4 +100,14 @@ interface ICarServiceHelper {
      * Returns true if the given package requires launching in automotive compatibility mode.
      */
     boolean requiresDisplayCompat(String packageName) = 15;
+
+    /**
+     * See {@link com.android.server.pm.UserManagerInternal#assignUserToExtraDisplay(int, int)}.
+     */
+    boolean assignUserToExtraDisplay(int userId, int displayId) = 16;
+
+    /**
+     * See {@link com.android.server.pm.UserManagerInternal#unassignUserFromExtraDisplay(int, int)}.
+     */
+    boolean unassignUserFromExtraDisplay(int userId, int displayId) = 17;
 }
diff --git a/car-lib/src/com/android/car/internal/ICarSystemServerClient.aidl b/car-lib/src/com/android/car/internal/ICarSystemServerClient.aidl
index 3d0218e201..f3f3ff0d9d 100644
--- a/car-lib/src/com/android/car/internal/ICarSystemServerClient.aidl
+++ b/car-lib/src/com/android/car/internal/ICarSystemServerClient.aidl
@@ -23,7 +23,6 @@ import android.content.ComponentName;
 
 /**
  * API to communicate from CarServiceHelperService to car service.
- * @hide
  */
 oneway interface ICarSystemServerClient {
     /**
diff --git a/car-lib/src/com/android/car/internal/LargeParcelable.java b/car-lib/src/com/android/car/internal/LargeParcelable.java
index 42996811ac..26889f31cc 100644
--- a/car-lib/src/com/android/car/internal/LargeParcelable.java
+++ b/car-lib/src/com/android/car/internal/LargeParcelable.java
@@ -42,8 +42,6 @@ import java.util.concurrent.Callable;
  * #toLargeParcelable(Parcelable)} and deserialization
  * {@link #reconstructStableAIDLParcelable(Parcelable, boolean)}. Plz check included test for the
  * usage.
- *
- * @hide
  */
 public class LargeParcelable extends LargeParcelableBase {
     /**
@@ -289,12 +287,15 @@ public class LargeParcelable extends LargeParcelableBase {
             readMethod.invoke(retParcelable, in);
             if (keepSharedMemory) {
                 fieldSharedMemory.set(retParcelable, sharedMemoryFd);
+            } else {
+                closeFd(sharedMemoryFd);
             }
             if (DBG_PAYLOAD) {
                 Slog.d(TAG, "reconstructStableAIDLParcelable read shared memory, data size:"
                         + in.dataPosition());
             }
         } catch (Exception e) {
+            closeFd(sharedMemoryFd);
             throw new IllegalArgumentException("Cannot access Parcelable constructor/method", e);
         } finally {
             if (in != null) {
@@ -303,4 +304,12 @@ public class LargeParcelable extends LargeParcelableBase {
         }
         return retParcelable;
     }
+
+    private static void closeFd(ParcelFileDescriptor fd) {
+        try {
+            fd.close();
+        } catch (IOException e) {
+            Slog.w(TAG, "Failed to close ParceFileDescriptor", e);
+        }
+    }
 }
diff --git a/car-lib/src/com/android/car/internal/LargeParcelableBase.java b/car-lib/src/com/android/car/internal/LargeParcelableBase.java
index b0df632937..b4ef0f5dc9 100644
--- a/car-lib/src/com/android/car/internal/LargeParcelableBase.java
+++ b/car-lib/src/com/android/car/internal/LargeParcelableBase.java
@@ -46,8 +46,6 @@ import java.nio.ByteBuffer;
  * <li>@Nullable SharedMemory which include serialized Parcelable if non-null. This will be set
  * only when the previous Parcelable is null or this also can be null for no data case.
  * </ul>
- *
- * @hide
  */
 public abstract class LargeParcelableBase implements Parcelable, Closeable {
     /** Payload size bigger than this value will be passed over shared memory. */
diff --git a/car-lib/src/com/android/car/internal/LongPendingRequestPool.java b/car-lib/src/com/android/car/internal/LongPendingRequestPool.java
index f8926d4171..5cafa64d0f 100644
--- a/car-lib/src/com/android/car/internal/LongPendingRequestPool.java
+++ b/car-lib/src/com/android/car/internal/LongPendingRequestPool.java
@@ -35,8 +35,6 @@ import java.util.List;
  * Note that this pool is not thread-safe. Caller must use lock to guard this object.
  *
  * @param <T> The request info type.
- *
- * @hide
  */
 public final class LongPendingRequestPool<T extends LongRequestIdWithTimeout> {
     private static final String TAG = LongPendingRequestPool.class.getSimpleName();
@@ -162,6 +160,16 @@ public final class LongPendingRequestPool<T extends LongRequestIdWithTimeout> {
      * Remove the pending request and the timeout handler for it.
      */
     public void removeRequest(long requestId) {
+        removeRequest(requestId, /* alreadyTimedOut= */ false);
+    }
+
+    /**
+     * Remove the pending request and the timeout handler for it.
+     *
+     * @param requestId The request ID.
+     * @param alreadyTimedOut Whether this request is already timed out.
+     */
+    public void removeRequest(long requestId, boolean alreadyTimedOut) {
         synchronized (mRequestIdsLock) {
             T requestInfo = mRequestIdToRequestInfo.get(requestId);
             if (requestInfo == null) {
@@ -169,6 +177,13 @@ public final class LongPendingRequestPool<T extends LongRequestIdWithTimeout> {
                 return;
             }
             mRequestIdToRequestInfo.remove(requestId);
+
+            if (alreadyTimedOut) {
+                // If the request is already timed out, then it has already been removed from
+                // mTimeoutUptimeMsToRequestIds.
+                return;
+            }
+
             long timeoutUptimeMs = requestInfo.getTimeoutUptimeMs();
             List<Long> requestIds = mTimeoutUptimeMsToRequestIds.get(timeoutUptimeMs);
             if (requestIds == null) {
diff --git a/car-lib/src/com/android/car/internal/LongRequestIdWithTimeout.java b/car-lib/src/com/android/car/internal/LongRequestIdWithTimeout.java
index 6d4e82ae2b..e9cbe49881 100644
--- a/car-lib/src/com/android/car/internal/LongRequestIdWithTimeout.java
+++ b/car-lib/src/com/android/car/internal/LongRequestIdWithTimeout.java
@@ -17,8 +17,6 @@ package com.android.car.internal;
 
 /**
  * An async request with a unique {@code long} ID and a timeout (system uptime in ms).
- *
- * @hide
  */
 public interface LongRequestIdWithTimeout {
     /**
diff --git a/car-lib/src/com/android/car/internal/NotificationHelperBase.java b/car-lib/src/com/android/car/internal/NotificationHelperBase.java
index 8501b75ca4..30451d2fff 100644
--- a/car-lib/src/com/android/car/internal/NotificationHelperBase.java
+++ b/car-lib/src/com/android/car/internal/NotificationHelperBase.java
@@ -26,8 +26,6 @@ import android.util.SparseArray;
  *
  * <p> This is used as an interface between builtin and updatable car service. Do not change it
  * without compatibility check. Adding a new method is ok.
- *
- * @hide
  */
 public abstract class NotificationHelperBase {
 
diff --git a/car-lib/src/com/android/car/internal/PropertyPermissionMapping.java b/car-lib/src/com/android/car/internal/PropertyPermissionMapping.java
index bcb0751800..94fa0413a1 100644
--- a/car-lib/src/com/android/car/internal/PropertyPermissionMapping.java
+++ b/car-lib/src/com/android/car/internal/PropertyPermissionMapping.java
@@ -21,7 +21,6 @@ import android.car.Car;
 import android.car.VehiclePropertyIds;
 import android.util.SparseArray;
 
-/** @hide */
 // TODO(pavelm): use this class in Car Service instead of PropertyHalServiceIds
 public final class PropertyPermissionMapping {
 
diff --git a/car-lib/src/com/android/car/internal/ProxiedService.java b/car-lib/src/com/android/car/internal/ProxiedService.java
index 80a6a7a613..33b4e5c82a 100644
--- a/car-lib/src/com/android/car/internal/ProxiedService.java
+++ b/car-lib/src/com/android/car/internal/ProxiedService.java
@@ -28,8 +28,6 @@ import java.io.PrintWriter;
  * <p> This is used as an interface between builtin and updatable car service. Do not change it
  * without compatibility check. Adding a new method is ok but should have no-op default
  * implementation.
- *
- * @hide
  */
 public abstract class ProxiedService extends Service {
 
diff --git a/car-lib/src/com/android/car/internal/README.md b/car-lib/src/com/android/car/internal/README.md
new file mode 100644
index 0000000000..818abe4693
--- /dev/null
+++ b/car-lib/src/com/android/car/internal/README.md
@@ -0,0 +1,27 @@
+<!--
+  Copyright (C) 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License
+  -->
+
+# Car-lib Internal
+
+Source code for the internal libraries for car-lib implementation.
+
+## Coding Convention
+
+Public methods in car-lib internal are not surfaced to APIs through
+`packages/services/Car/car-lib/src/com/android/car/internal/package-info.java`.
+
+We don't encourage you to add @hide annotation to make them a hidden API.
+
diff --git a/car-lib/src/com/android/car/internal/ResultCallbackImpl.java b/car-lib/src/com/android/car/internal/ResultCallbackImpl.java
index 4003074e25..b91df35602 100644
--- a/car-lib/src/com/android/car/internal/ResultCallbackImpl.java
+++ b/car-lib/src/com/android/car/internal/ResultCallbackImpl.java
@@ -39,8 +39,6 @@ import java.util.concurrent.Executor;
  * {@link #complete(Object)} should be called with the result.
  *
  * @param <V> refer to a Parcelable object.
- *
- * @hide
  */
 public class ResultCallbackImpl<V> implements Parcelable {
 
diff --git a/car-lib/src/com/android/car/internal/ResultWrapper.java b/car-lib/src/com/android/car/internal/ResultWrapper.java
index 7345a19ce9..027523ffed 100644
--- a/car-lib/src/com/android/car/internal/ResultWrapper.java
+++ b/car-lib/src/com/android/car/internal/ResultWrapper.java
@@ -24,7 +24,6 @@ import android.os.Parcelable;
  * Wrapper for a parcelable object <V>
  *
  * @param <V> refer to a Parcelable object.
- * @hide
  */
 public final class ResultWrapper<V> implements Parcelable {
 
diff --git a/car-lib/src/com/android/car/internal/SingleMessageHandler.java b/car-lib/src/com/android/car/internal/SingleMessageHandler.java
index de09250f4b..e9ea614aa6 100644
--- a/car-lib/src/com/android/car/internal/SingleMessageHandler.java
+++ b/car-lib/src/com/android/car/internal/SingleMessageHandler.java
@@ -28,7 +28,6 @@ import java.util.function.Consumer;
  * Handles call back into clients for Car managers.
  *
  * @param <EventType> type of event to be handled
- * @hide
  */
 public abstract class SingleMessageHandler<EventType> implements Callback {
     private final int mHandledMessageWhat;
diff --git a/car-lib/src/com/android/car/internal/StaticBinderInterface.java b/car-lib/src/com/android/car/internal/StaticBinderInterface.java
index d60ac550d8..55aa487505 100644
--- a/car-lib/src/com/android/car/internal/StaticBinderInterface.java
+++ b/car-lib/src/com/android/car/internal/StaticBinderInterface.java
@@ -21,8 +21,6 @@ package com.android.car.internal;
  * internally by car service or car manager.
  *
  * This interface allows faking the implementation in unit tests.
- *
- * @hide
  */
 public interface StaticBinderInterface {
     /**
diff --git a/car-lib/src/com/android/car/internal/SystemConstants.java b/car-lib/src/com/android/car/internal/SystemConstants.java
index 605a34e76f..f88d3e0e13 100644
--- a/car-lib/src/com/android/car/internal/SystemConstants.java
+++ b/car-lib/src/com/android/car/internal/SystemConstants.java
@@ -19,8 +19,6 @@ import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.BO
 
 /**
  * Provides common constants for CarService, CarServiceHelperService and other packages.
- *
- * @hide
  */
 public final class SystemConstants {
 
diff --git a/car-lib/src/com/android/car/internal/SystemStaticBinder.java b/car-lib/src/com/android/car/internal/SystemStaticBinder.java
index 41080880b7..e8158cb074 100644
--- a/car-lib/src/com/android/car/internal/SystemStaticBinder.java
+++ b/car-lib/src/com/android/car/internal/SystemStaticBinder.java
@@ -20,8 +20,6 @@ import android.os.Binder;
 
 /**
  * A real implementation for {@link com.android.car.internal.StaticBinderInterface}.
- *
- * @hide
  */
 public final class SystemStaticBinder implements StaticBinderInterface {
     @Override
diff --git a/car-lib/src/com/android/car/internal/TEST_MAPPING b/car-lib/src/com/android/car/internal/TEST_MAPPING
new file mode 100644
index 0000000000..92403ec711
--- /dev/null
+++ b/car-lib/src/com/android/car/internal/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarLibInternalUnitTest"
+    }
+  ]
+}
diff --git a/car-lib/src/com/android/car/internal/VisibleForHiddenApiCheck.java b/car-lib/src/com/android/car/internal/VisibleForHiddenApiCheck.java
index fe37ab4a7a..041fc27862 100644
--- a/car-lib/src/com/android/car/internal/VisibleForHiddenApiCheck.java
+++ b/car-lib/src/com/android/car/internal/VisibleForHiddenApiCheck.java
@@ -27,8 +27,6 @@ import java.lang.annotation.Target;
 
 /**
  * Annotation for making hidden APIs visible in droiddoc
- *
- * @hide
  */
 @Retention(RetentionPolicy.SOURCE)
 @Target({CONSTRUCTOR, FIELD, TYPE, METHOD})
diff --git a/car-lib/src/com/android/car/internal/annotation/AttributeUsage.java b/car-lib/src/com/android/car/internal/annotation/AttributeUsage.java
index 3bfac64f34..285f3b91be 100644
--- a/car-lib/src/com/android/car/internal/annotation/AttributeUsage.java
+++ b/car-lib/src/com/android/car/internal/annotation/AttributeUsage.java
@@ -47,8 +47,6 @@ import java.lang.annotation.RetentionPolicy;
  * Tells the audio attribute usage (i.e. what type of audio source to use for playback)
  *
  * Copied from frameworks/base/media/java/android/media/AudioAttributes.java
- *
- * @hide
  */
 @IntDef({
         USAGE_UNKNOWN,
diff --git a/car-lib/src/com/android/car/internal/common/CommonConstants.java b/car-lib/src/com/android/car/internal/common/CommonConstants.java
index ebbb734451..d7a5810933 100644
--- a/car-lib/src/com/android/car/internal/common/CommonConstants.java
+++ b/car-lib/src/com/android/car/internal/common/CommonConstants.java
@@ -28,8 +28,6 @@ import java.lang.annotation.RetentionPolicy;
 
 /**
  * Provides common constants for Car library, Car Service, and System Server.
- *
- * @hide
  */
 public final class CommonConstants {
 
diff --git a/car-lib/src/com/android/car/internal/common/UserHelperLite.java b/car-lib/src/com/android/car/internal/common/UserHelperLite.java
index 7d63bc84fb..36adee21e0 100644
--- a/car-lib/src/com/android/car/internal/common/UserHelperLite.java
+++ b/car-lib/src/com/android/car/internal/common/UserHelperLite.java
@@ -27,8 +27,6 @@ import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 
 /**
  * Provides user information related helper methods.
- *
- * @hide
  */
 public final class UserHelperLite {
 
@@ -47,10 +45,19 @@ public final class UserHelperLite {
     }
 
     /**
-     * Checks whether the given user is both {@code SYSTEM} and headless.
+     * Checks whether the given user is both {@code SYSTEM} and the device is in headless system
+     * user mode.
      */
     public static boolean isHeadlessSystemUser(@UserIdInt int userId) {
-        return userId == UserHandle.SYSTEM.getIdentifier()
-                && UserManager.isHeadlessSystemUserMode();
+        return isHeadlessSystemUser(userId, UserManager.isHeadlessSystemUserMode());
+    }
+
+    /**
+     * Checks whether the given user is both {@code SYSTEM} and the device is in headless system
+     * user mode.
+     */
+    public static boolean isHeadlessSystemUser(@UserIdInt int userId,
+            boolean isHeadlessSystemUserMode) {
+        return userId == UserHandle.SYSTEM.getIdentifier() && isHeadlessSystemUserMode;
     }
 }
diff --git a/car-lib/src/com/android/car/internal/evs/CarEvsUtils.java b/car-lib/src/com/android/car/internal/evs/CarEvsUtils.java
index c1dfebd08a..cda091f9f9 100644
--- a/car-lib/src/com/android/car/internal/evs/CarEvsUtils.java
+++ b/car-lib/src/com/android/car/internal/evs/CarEvsUtils.java
@@ -26,13 +26,16 @@ import static android.car.evs.CarEvsManager.SERVICE_TYPE_FRONT_PASSENGERSVIEW;
 import static android.car.evs.CarEvsManager.SERVICE_TYPE_REAR_PASSENGERSVIEW;
 import static android.car.evs.CarEvsManager.SERVICE_TYPE_USER_DEFINED;
 
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DEPRECATED_CODE;
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.PRIVATE_CONSTRUCTOR;
+
 import android.car.builtin.util.Slogf;
 import android.car.evs.CarEvsManager.CarEvsServiceType;
 
+import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
+
 /**
  * This class provide utility methods for CarEvsService clients.
- *
- * @hide
  */
 public final class CarEvsUtils {
     private static final String TAG = CarEvsUtils.class.getSimpleName();
@@ -43,6 +46,7 @@ public final class CarEvsUtils {
     private static final int TAG_BIT_LEFT_SHIFT = 24;
     private static final int DATA_BIT_MASK = ~(0xFF << TAG_BIT_LEFT_SHIFT);
 
+    @ExcludeFromCodeCoverageGeneratedReport(reason = PRIVATE_CONSTRUCTOR)
     private CarEvsUtils() {}
 
     public static @CarEvsServiceType int convertToServiceType(String type) {
@@ -103,7 +107,11 @@ public final class CarEvsUtils {
      *              ICarEvsStreamCallback.onStreamEvent() and ICarEvsStreamCallback.onNewFrame()
      *              callbacks respectively.
      * @return A service type embedded in 8-MSB of a given value.
+     *
+     * @deprecated Please use {@link android.car.evs.CarEvsBufferDescriptor#getType()} instead.
      */
+    @Deprecated
+    @ExcludeFromCodeCoverageGeneratedReport(reason = DEPRECATED_CODE)
     public static @CarEvsServiceType int getTag(int value) {
         return value >> TAG_BIT_LEFT_SHIFT;
     }
@@ -115,7 +123,11 @@ public final class CarEvsUtils {
      *              ICarEvsStreamCallback.onStreamEvent() and ICarEvsStreamCallback.onNewFrame()
      *              callbacks respectively.
      * @return A buffer id or an event.
+     *
+     * @deprecated Please use {@link android.car.evs.CarEvsBufferDescriptor#getId()} instead.
      */
+    @Deprecated
+    @ExcludeFromCodeCoverageGeneratedReport(reason = DEPRECATED_CODE)
     public static int getValue(int value) {
         return value &= DATA_BIT_MASK;
     }
@@ -129,7 +141,12 @@ public final class CarEvsUtils {
      *              ICarEvsStreamCallback.onStreamEvent() and ICarEvsStreamCallback.onNewFrame()
      *              callbacks respectively.
      * @return 32-bit integer that contains a tag in 8-MSB and a value in the rest.
+     *
+     * @deprecated Please construct {@link android.car.evs.CarEvsBufferDescriptor} with a type
+     *             instead.
      */
+    @Deprecated
+    @ExcludeFromCodeCoverageGeneratedReport(reason = DEPRECATED_CODE)
     public static int putTag(int tag, int value) {
         if (tag > 0xFF) {
             Slogf.w(TAG, "A given tag %d is greater than 0xFF. Only 8-LSB will be effective.", tag);
diff --git a/car-lib/src/com/android/car/internal/evs/EvsHalWrapper.java b/car-lib/src/com/android/car/internal/evs/EvsHalWrapper.java
index e7ed287b5f..c965f739b3 100644
--- a/car-lib/src/com/android/car/internal/evs/EvsHalWrapper.java
+++ b/car-lib/src/com/android/car/internal/evs/EvsHalWrapper.java
@@ -20,8 +20,6 @@ import android.hardware.HardwareBuffer;
 
 /**
  * Abstracts EVS HAL. This is used as an interface between updatable and builtin.
- *
- * @hide
  */
 public abstract class EvsHalWrapper {
     /** Callback for events from HAL */
diff --git a/car-lib/src/com/android/car/internal/os/CarSystemProperties.java b/car-lib/src/com/android/car/internal/os/CarSystemProperties.java
index 5963eebce2..e148f6e7ed 100644
--- a/car-lib/src/com/android/car/internal/os/CarSystemProperties.java
+++ b/car-lib/src/com/android/car/internal/os/CarSystemProperties.java
@@ -23,8 +23,6 @@ import java.util.Optional;
 
 /**
  * Replacement for {@code android.sysprop.CarProperties}. This should be manually updated.
- *
- * @hide
  */
 public final class CarSystemProperties {
     private static final String PROP_BOOT_USER_OVERRIDE_ID =
diff --git a/car-lib/src/com/android/car/internal/os/HandlerExecutor.java b/car-lib/src/com/android/car/internal/os/HandlerExecutor.java
index e8db647443..a72fef4c4c 100644
--- a/car-lib/src/com/android/car/internal/os/HandlerExecutor.java
+++ b/car-lib/src/com/android/car/internal/os/HandlerExecutor.java
@@ -26,8 +26,6 @@ import java.util.concurrent.RejectedExecutionException;
 
 /**
  * {@code Executor} to run on an {@code Handler}.
- *
- * @hide
  */
 public class HandlerExecutor implements Executor {
     private final Handler mHandler;
diff --git a/car-lib/src/com/android/car/internal/os/Process.java b/car-lib/src/com/android/car/internal/os/Process.java
new file mode 100644
index 0000000000..e0b6f8c07a
--- /dev/null
+++ b/car-lib/src/com/android/car/internal/os/Process.java
@@ -0,0 +1,27 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.internal.os;
+
+/**
+ * An interface to inject fake {@link android.os.Process}.
+ */
+public interface Process {
+    /** Check {@link android.os.Process#killProcess}. */
+    void killProcess(int pid);
+    /** Check {@link android.os.Process#myPid}. */
+    int myPid();
+}
diff --git a/car-lib/src/com/android/car/internal/os/ServiceManager.java b/car-lib/src/com/android/car/internal/os/ServiceManager.java
new file mode 100644
index 0000000000..b47cabf033
--- /dev/null
+++ b/car-lib/src/com/android/car/internal/os/ServiceManager.java
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.internal.os;
+
+import android.annotation.NonNull;
+import android.car.builtin.os.ServiceManagerHelper;
+import android.os.IBinder;
+import android.os.RemoteException;
+
+/**
+ * An interface to inject fake
+ * {@link android.car.builtin.os.ServiceManagerHelper}.
+ */
+public interface ServiceManager {
+    /** Check {@link ServiceManagerHelper#getService(String)} */
+    IBinder getService(String name);
+
+    /** Check {@link ServiceManagerHelper#registerForNotifications} */
+    void registerForNotifications(@NonNull String name,
+            @NonNull ServiceManagerHelper.IServiceRegistrationCallback callback)
+            throws RemoteException;
+}
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/DistantDisplaySystemUIInitializer.java b/car-lib/src/com/android/car/internal/os/SystemProcess.java
similarity index 52%
rename from car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/DistantDisplaySystemUIInitializer.java
rename to car-lib/src/com/android/car/internal/os/SystemProcess.java
index 9356c701f0..50835d09c7 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/DistantDisplaySystemUIInitializer.java
+++ b/car-lib/src/com/android/car/internal/os/SystemProcess.java
@@ -1,5 +1,5 @@
 /*
- * Copyright (C) 2023 The Android Open Source Project
+ * Copyright (C) 2024 The Android Open Source Project
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -14,24 +14,19 @@
  * limitations under the License.
  */
 
-package com.android.systemui;
-
-import android.content.Context;
-
-import com.android.systemui.dagger.GlobalRootComponent;
-
+package com.android.car.internal.os;
 
 /**
- * Class factory to provide AAECarSystemUI specific SystemUI components.
+ * A real implementation for Process.
  */
-public class DistantDisplaySystemUIInitializer extends CarSystemUIInitializer {
-    public DistantDisplaySystemUIInitializer(Context context) {
-        super(context);
+public final class SystemProcess implements Process {
+    @Override
+    public void killProcess(int pid) {
+        android.os.Process.killProcess(pid);
     }
 
     @Override
-    protected GlobalRootComponent.Builder getGlobalRootComponentBuilder() {
-        return DaggerGlobalRootComponent.builder();
+    public int myPid() {
+        return android.os.Process.myPid();
     }
-
 }
diff --git a/car-lib/src/com/android/car/internal/os/SystemServiceManager.java b/car-lib/src/com/android/car/internal/os/SystemServiceManager.java
new file mode 100644
index 0000000000..271667e206
--- /dev/null
+++ b/car-lib/src/com/android/car/internal/os/SystemServiceManager.java
@@ -0,0 +1,39 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.internal.os;
+
+import android.annotation.NonNull;
+import android.car.builtin.os.ServiceManagerHelper;
+import android.os.IBinder;
+import android.os.RemoteException;
+
+/**
+ * A real implementation for ServiceManager.
+ */
+public final class SystemServiceManager implements ServiceManager {
+    @Override
+    public IBinder getService(String name) {
+        return ServiceManagerHelper.getService(name);
+    }
+
+    @Override
+    public void registerForNotifications(@NonNull String name,
+            @NonNull ServiceManagerHelper.IServiceRegistrationCallback callback)
+            throws RemoteException {
+        ServiceManagerHelper.registerForNotifications(name, callback);
+    }
+}
diff --git a/car-lib/src/com/android/car/internal/package-info.java b/car-lib/src/com/android/car/internal/package-info.java
new file mode 100644
index 0000000000..d750425a2d
--- /dev/null
+++ b/car-lib/src/com/android/car/internal/package-info.java
@@ -0,0 +1,24 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/**
+ * Exclude from API surfaces
+ *
+ * @hide
+ * TODO(b/146466118): remove this javadoc tag
+ */
+@android.annotation.Hide
+package com.android.car.internal;
diff --git a/car-lib/src/com/android/car/internal/property/AsyncPropertyServiceRequest.java b/car-lib/src/com/android/car/internal/property/AsyncPropertyServiceRequest.java
index f735075c27..11f8cbb53c 100644
--- a/car-lib/src/com/android/car/internal/property/AsyncPropertyServiceRequest.java
+++ b/car-lib/src/com/android/car/internal/property/AsyncPropertyServiceRequest.java
@@ -30,8 +30,6 @@ import com.android.car.internal.util.DataClass;
 /**
  * A request for {@link CarPropertyService.getPropertiesAsync} or
  * {@link CarPropertyService.setPropertiesAsync}
- *
- * @hide
  */
 @DataClass(genConstructor = false)
 @ExcludeFromCodeCoverageGeneratedReport(reason = BOILERPLATE_CODE)
@@ -171,7 +169,6 @@ public final class AsyncPropertyServiceRequest implements Parcelable {
     @DataClass.Generated.Member
     public int describeContents() { return 0; }
 
-    /** @hide */
     @SuppressWarnings({"unchecked", "RedundantCast"})
     @DataClass.Generated.Member
     /* package-private */ AsyncPropertyServiceRequest(@android.annotation.NonNull android.os.Parcel in) {
diff --git a/car-lib/src/com/android/car/internal/property/AsyncPropertyServiceRequestList.java b/car-lib/src/com/android/car/internal/property/AsyncPropertyServiceRequestList.java
index 0e38e23beb..a9abb0654b 100644
--- a/car-lib/src/com/android/car/internal/property/AsyncPropertyServiceRequestList.java
+++ b/car-lib/src/com/android/car/internal/property/AsyncPropertyServiceRequestList.java
@@ -27,9 +27,6 @@ import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import java.util.ArrayList;
 import java.util.List;
 
-/**
- * @hide
- */
 public final class AsyncPropertyServiceRequestList extends
         LargeParcelableList<AsyncPropertyServiceRequest> {
 
diff --git a/car-lib/src/com/android/car/internal/property/CarPropertyConfigList.java b/car-lib/src/com/android/car/internal/property/CarPropertyConfigList.java
index 4238c69e46..9bd6c76ce1 100644
--- a/car-lib/src/com/android/car/internal/property/CarPropertyConfigList.java
+++ b/car-lib/src/com/android/car/internal/property/CarPropertyConfigList.java
@@ -26,9 +26,6 @@ import com.android.internal.annotations.VisibleForTesting;
 import java.util.ArrayList;
 import java.util.List;
 
-/**
- * @hide
- */
 public final class CarPropertyConfigList extends LargeParcelableList<CarPropertyConfig> {
 
     private CarPropertyConfigList(Parcel in) {
diff --git a/car-lib/src/com/android/car/internal/property/CarPropertyErrorCodes.java b/car-lib/src/com/android/car/internal/property/CarPropertyErrorCodes.java
index 5ba2fb1725..938afd31c3 100644
--- a/car-lib/src/com/android/car/internal/property/CarPropertyErrorCodes.java
+++ b/car-lib/src/com/android/car/internal/property/CarPropertyErrorCodes.java
@@ -33,8 +33,6 @@ import java.util.StringJoiner;
 /**
  * Stores the various error codes for vehicle properties as they get passed up
  * the stack.
- *
- * @hide
  */
 @DataClass(genConstructor = false)
 public final class CarPropertyErrorCodes implements Parcelable {
@@ -260,7 +258,6 @@ public final class CarPropertyErrorCodes implements Parcelable {
     @DataClass.Generated.Member
     public int describeContents() { return 0; }
 
-    /** @hide */
     @SuppressWarnings({"unchecked", "RedundantCast"})
     @DataClass.Generated.Member
     /* package-private */ CarPropertyErrorCodes(@NonNull Parcel in) {
diff --git a/car-lib/src/com/android/car/internal/property/CarPropertyEventCallbackController.java b/car-lib/src/com/android/car/internal/property/CarPropertyEventCallbackController.java
index e926c03acc..ca74c66d47 100644
--- a/car-lib/src/com/android/car/internal/property/CarPropertyEventCallbackController.java
+++ b/car-lib/src/com/android/car/internal/property/CarPropertyEventCallbackController.java
@@ -29,8 +29,6 @@ import java.util.concurrent.Executor;
 /**
  * Manages a group of property IDs and area IDs registered for the same {@link
  * CarPropertyEventCallback} at possibly different update rates.
- *
- * @hide
  */
 public final class CarPropertyEventCallbackController extends CarPropertyEventController {
     // Abbreviating TAG because class name is longer than the 23 character Log tag limit.
diff --git a/car-lib/src/com/android/car/internal/property/CarPropertyEventController.java b/car-lib/src/com/android/car/internal/property/CarPropertyEventController.java
index 4835325e9d..1ad213a923 100644
--- a/car-lib/src/com/android/car/internal/property/CarPropertyEventController.java
+++ b/car-lib/src/com/android/car/internal/property/CarPropertyEventController.java
@@ -36,8 +36,6 @@ import com.android.internal.annotations.VisibleForTesting;
  * not passed to the client.
  *
  * This class is thread-safe.
- *
- * @hide
  */
 public class CarPropertyEventController {
     // Abbreviating TAG because class name is longer than the 23 character Log tag limit.
diff --git a/car-lib/src/com/android/car/internal/property/CarPropertyEventTracker.java b/car-lib/src/com/android/car/internal/property/CarPropertyEventTracker.java
index 5c398fbbf3..1a4291383e 100644
--- a/car-lib/src/com/android/car/internal/property/CarPropertyEventTracker.java
+++ b/car-lib/src/com/android/car/internal/property/CarPropertyEventTracker.java
@@ -22,8 +22,6 @@ import android.car.hardware.CarPropertyValue;
 /**
  * Records the previous property event information and tracks whether the new property event
  * contains update.
- *
- * @hide
  */
 public interface CarPropertyEventTracker {
 
diff --git a/car-lib/src/com/android/car/internal/property/CarPropertyHelper.java b/car-lib/src/com/android/car/internal/property/CarPropertyHelper.java
index 8d6237524e..ab3eb94b09 100644
--- a/car-lib/src/com/android/car/internal/property/CarPropertyHelper.java
+++ b/car-lib/src/com/android/car/internal/property/CarPropertyHelper.java
@@ -31,8 +31,6 @@ import java.util.StringJoiner;
 
 /**
  * Helper class for CarPropertyService/CarPropertyManager.
- *
- * @hide
  */
 public final class CarPropertyHelper {
     /**
diff --git a/car-lib/src/com/android/car/internal/property/CarSubscription.aidl b/car-lib/src/com/android/car/internal/property/CarSubscription.aidl
index 76ad143193..e11205a6cb 100644
--- a/car-lib/src/com/android/car/internal/property/CarSubscription.aidl
+++ b/car-lib/src/com/android/car/internal/property/CarSubscription.aidl
@@ -16,9 +16,6 @@
 
 package com.android.car.internal.property;
 
-/**
- * @hide
- */
 @JavaDerive(equals = true, toString = true)
 parcelable CarSubscription {
     int propertyId;
diff --git a/car-lib/src/com/android/car/internal/property/ContCarPropertyEventTracker.java b/car-lib/src/com/android/car/internal/property/ContCarPropertyEventTracker.java
index 87ea634b75..5c3c84224b 100644
--- a/car-lib/src/com/android/car/internal/property/ContCarPropertyEventTracker.java
+++ b/car-lib/src/com/android/car/internal/property/ContCarPropertyEventTracker.java
@@ -26,8 +26,6 @@ import java.util.Objects;
 
 /**
  * A {@link CarPropertyEventTracker} implementation for continuous property
- *
- * @hide
  */
 public final class ContCarPropertyEventTracker implements CarPropertyEventTracker{
     private static final String TAG = "ContCarPropertyEventTracker";
@@ -128,7 +126,7 @@ public final class ContCarPropertyEventTracker implements CarPropertyEventTracke
     public boolean hasUpdate(CarPropertyValue<?> carPropertyValue) {
         if (carPropertyValue.getTimestamp() < mNextUpdateTimeNanos) {
             if (mLogger.dbg()) {
-                mLogger.logD(String.format("hasUpdate: Dropping carPropertyValue: %s, "
+                mLogger.logV(String.format("hasUpdate: Dropping carPropertyValue: %s, "
                         + "because getTimestamp()=%d < nextUpdateTimeNanos=%d",
                         carPropertyValue, carPropertyValue.getTimestamp(), mNextUpdateTimeNanos));
             }
@@ -142,7 +140,7 @@ public final class ContCarPropertyEventTracker implements CarPropertyEventTracke
         if (mEnableVur && status == mCurrentStatus && mCurrentCarPropertyValue != null
                     && Objects.deepEquals(value, mCurrentCarPropertyValue.getValue())) {
             if (mLogger.dbg()) {
-                mLogger.logD(String.format("hasUpdate: Dropping carPropertyValue: %s, "
+                mLogger.logV(String.format("hasUpdate: Dropping carPropertyValue: %s, "
                                 + "because VUR is enabled and value is the same",
                         sanitizedCarPropertyValue));
             }
diff --git a/car-lib/src/com/android/car/internal/property/GetPropertyConfigListResult.aidl b/car-lib/src/com/android/car/internal/property/GetPropertyConfigListResult.aidl
index c89cc60478..ec53ddb80c 100644
--- a/car-lib/src/com/android/car/internal/property/GetPropertyConfigListResult.aidl
+++ b/car-lib/src/com/android/car/internal/property/GetPropertyConfigListResult.aidl
@@ -18,9 +18,6 @@ package com.android.car.internal.property;
 
 import com.android.car.internal.property.CarPropertyConfigList;
 
-/**
- * @hide
- */
 parcelable GetPropertyConfigListResult {
     CarPropertyConfigList carPropertyConfigList;
     int[] missingPermissionPropIds;
diff --git a/car-lib/src/com/android/car/internal/property/GetSetValueResult.java b/car-lib/src/com/android/car/internal/property/GetSetValueResult.java
index 46854c9166..2ff82d5bb4 100644
--- a/car-lib/src/com/android/car/internal/property/GetSetValueResult.java
+++ b/car-lib/src/com/android/car/internal/property/GetSetValueResult.java
@@ -27,8 +27,6 @@ import com.android.car.internal.util.DataClass;
 
 /**
  * A request for {@link com.android.car.CarPropertyService#getPropertiesAsync}
- *
- * @hide
  */
 @DataClass(genConstructor = false)
 public final class GetSetValueResult implements Parcelable {
@@ -141,7 +139,6 @@ public final class GetSetValueResult implements Parcelable {
     @DataClass.Generated.Member
     public int describeContents() { return 0; }
 
-    /** @hide */
     @SuppressWarnings({"unchecked", "RedundantCast"})
     @DataClass.Generated.Member
     /* package-private */ GetSetValueResult(@NonNull Parcel in) {
diff --git a/car-lib/src/com/android/car/internal/property/GetSetValueResultList.java b/car-lib/src/com/android/car/internal/property/GetSetValueResultList.java
index 6f035f5196..a4084f3d48 100644
--- a/car-lib/src/com/android/car/internal/property/GetSetValueResultList.java
+++ b/car-lib/src/com/android/car/internal/property/GetSetValueResultList.java
@@ -27,9 +27,6 @@ import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import java.util.ArrayList;
 import java.util.List;
 
-/**
- * @hide
- */
 public final class GetSetValueResultList extends LargeParcelableList<GetSetValueResult> {
 
     public GetSetValueResultList(@NonNull List<GetSetValueResult> getSetValueResultsList) {
diff --git a/car-lib/src/com/android/car/internal/property/IAsyncPropertyResultCallback.aidl b/car-lib/src/com/android/car/internal/property/IAsyncPropertyResultCallback.aidl
index ed59d996c1..96dc880488 100644
--- a/car-lib/src/com/android/car/internal/property/IAsyncPropertyResultCallback.aidl
+++ b/car-lib/src/com/android/car/internal/property/IAsyncPropertyResultCallback.aidl
@@ -20,8 +20,6 @@ import com.android.car.internal.property.GetSetValueResultList;
 
 /**
  * Callback interface for async {@link CarPropertyService#getPropertiesAsync} when successful.
- *
- * @hide
  */
 oneway interface IAsyncPropertyResultCallback {
     /**
diff --git a/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java b/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java
index 725e276d3c..2dbf975f80 100644
--- a/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java
+++ b/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java
@@ -35,8 +35,6 @@ import java.util.List;
 
 /**
  * Common utility functions used by {@link CarPropertyManager} stack to sanitize input arguments.
- *
- * @hide
  */
 public final class InputSanitizationUtils {
 
diff --git a/car-lib/src/com/android/car/internal/property/LargeParcelableList.java b/car-lib/src/com/android/car/internal/property/LargeParcelableList.java
index ae6b49a0ed..86f32ff096 100644
--- a/car-lib/src/com/android/car/internal/property/LargeParcelableList.java
+++ b/car-lib/src/com/android/car/internal/property/LargeParcelableList.java
@@ -46,8 +46,6 @@ import java.util.List;
  * }
  *
  * @param <T> The type for the element stored in this list
- *
- * @hide
  */
 public abstract class LargeParcelableList<T extends Parcelable> extends LargeParcelableBase {
     private List<T> mList;
diff --git a/car-lib/src/com/android/car/internal/property/Logger.java b/car-lib/src/com/android/car/internal/property/Logger.java
index c548c08a85..341deb6722 100644
--- a/car-lib/src/com/android/car/internal/property/Logger.java
+++ b/car-lib/src/com/android/car/internal/property/Logger.java
@@ -22,8 +22,6 @@ import android.util.Log;
 /**
  * A logger that would use {@link Slogf} or {@link Log} depending on whether
  * to use system logger.
- *
- * @hide
  */
 public final class Logger {
 
@@ -63,6 +61,17 @@ public final class Logger {
         }
     }
 
+    /**
+     * Logs a verbose message.
+     */
+    public void logV(String msg) {
+        if (mUseSystemLogger) {
+            Slogf.v(mTag, msg);
+        } else {
+            Log.v(mTag, msg);
+        }
+    }
+
     /**
      * Whether debug logging should be enabled.
      */
diff --git a/car-lib/src/com/android/car/internal/property/OnChangeCarPropertyEventTracker.java b/car-lib/src/com/android/car/internal/property/OnChangeCarPropertyEventTracker.java
index 5990d9dda0..f961148883 100644
--- a/car-lib/src/com/android/car/internal/property/OnChangeCarPropertyEventTracker.java
+++ b/car-lib/src/com/android/car/internal/property/OnChangeCarPropertyEventTracker.java
@@ -20,8 +20,6 @@ import android.car.hardware.CarPropertyValue;
 
 /**
  * A {@link CarPropertyEventTracker} implementation for on-change property
- *
- * @hide
  */
 public final class OnChangeCarPropertyEventTracker implements CarPropertyEventTracker {
     private static final String TAG = "OnChangeCarPropertyEventTracker";
diff --git a/car-lib/src/com/android/car/internal/property/SubscriptionManager.java b/car-lib/src/com/android/car/internal/property/SubscriptionManager.java
index 02a9bf1e42..bb1eb24605 100644
--- a/car-lib/src/com/android/car/internal/property/SubscriptionManager.java
+++ b/car-lib/src/com/android/car/internal/property/SubscriptionManager.java
@@ -67,8 +67,6 @@ import java.util.TreeSet;
  * This class is not thread-safe.
  *
  * @param <ClientType> A class representing a client.
- *
- * @hide
  */
 public final class SubscriptionManager<ClientType> {
     private static final String TAG = SubscriptionManager.class.getSimpleName();
diff --git a/car-lib/src/com/android/car/internal/property/VehiclePropertyIdDebugUtils.java b/car-lib/src/com/android/car/internal/property/VehiclePropertyIdDebugUtils.java
index 51aa56cbfa..56c45a5c49 100644
--- a/car-lib/src/com/android/car/internal/property/VehiclePropertyIdDebugUtils.java
+++ b/car-lib/src/com/android/car/internal/property/VehiclePropertyIdDebugUtils.java
@@ -26,8 +26,6 @@ import com.android.car.internal.util.ConstantDebugUtils;
 
 /**
  * Utility class to convert {@link VehiclePropertyIds} to and from their name and ID.
- *
- * @hide
  */
 public final class VehiclePropertyIdDebugUtils {
     /**
diff --git a/car-lib/src/com/android/car/internal/util/AnnotationValidations.java b/car-lib/src/com/android/car/internal/util/AnnotationValidations.java
index 92c515f127..8731e29208 100644
--- a/car-lib/src/com/android/car/internal/util/AnnotationValidations.java
+++ b/car-lib/src/com/android/car/internal/util/AnnotationValidations.java
@@ -37,8 +37,6 @@ import java.lang.annotation.Annotation;
  * }
  * The ignored {@link Annotation} parameter is used to differentiate between overloads that would
  * otherwise have the same jvm signature. It's usually null at runtime.
- *
- * @hide
  */
 public final class AnnotationValidations {
     private AnnotationValidations() {
diff --git a/car-lib/src/com/android/car/internal/util/ArrayUtils.java b/car-lib/src/com/android/car/internal/util/ArrayUtils.java
index 6ada59566a..3b56273406 100644
--- a/car-lib/src/com/android/car/internal/util/ArrayUtils.java
+++ b/car-lib/src/com/android/car/internal/util/ArrayUtils.java
@@ -43,8 +43,6 @@ import java.util.function.IntFunction;
 /**
  * ArrayUtils contains some methods that you can call to find out
  * the most efficient increments by which to grow arrays.
- *
- * @hide
  */
 public final class ArrayUtils {
     private static final int CACHE_SIZE = 73;
diff --git a/car-lib/src/com/android/car/internal/util/BinderKeyValueContainer.java b/car-lib/src/com/android/car/internal/util/BinderKeyValueContainer.java
index a91771b30c..2bcfcf697d 100644
--- a/car-lib/src/com/android/car/internal/util/BinderKeyValueContainer.java
+++ b/car-lib/src/com/android/car/internal/util/BinderKeyValueContainer.java
@@ -34,8 +34,6 @@ import java.util.Set;
  *
  * @param <K> type of the key of the item
  * @param <V> type wrapped in the value of the item
- *
- * @hide
  */
 public final class BinderKeyValueContainer<K, V extends IInterface> {
 
diff --git a/car-lib/src/com/android/car/internal/util/ConcurrentUtils.java b/car-lib/src/com/android/car/internal/util/ConcurrentUtils.java
index 80880ee380..f121ae9235 100644
--- a/car-lib/src/com/android/car/internal/util/ConcurrentUtils.java
+++ b/car-lib/src/com/android/car/internal/util/ConcurrentUtils.java
@@ -36,8 +36,6 @@ import java.util.concurrent.atomic.AtomicInteger;
 // Copied from frameworks/base
 /**
  * Utility methods for common functionality using java.util.concurrent package
- *
- * @hide
  */
 public final class ConcurrentUtils {
 
diff --git a/car-lib/src/com/android/car/internal/util/ConstantDebugUtils.java b/car-lib/src/com/android/car/internal/util/ConstantDebugUtils.java
index feb5d5efe9..31d74521b7 100644
--- a/car-lib/src/com/android/car/internal/util/ConstantDebugUtils.java
+++ b/car-lib/src/com/android/car/internal/util/ConstantDebugUtils.java
@@ -33,8 +33,6 @@ import java.util.concurrent.atomic.AtomicReference;
 
 /**
  * Utility class to convert integer constants to and from their value or name.
- *
- * @hide
  */
 public final class ConstantDebugUtils {
     private static final String TAG = ConstantDebugUtils.class.getSimpleName();
diff --git a/car-lib/src/com/android/car/internal/util/DataClass.java b/car-lib/src/com/android/car/internal/util/DataClass.java
index 63b76eb1c0..8ebdc53140 100644
--- a/car-lib/src/com/android/car/internal/util/DataClass.java
+++ b/car-lib/src/com/android/car/internal/util/DataClass.java
@@ -35,8 +35,6 @@ import java.lang.annotation.Target;
 
 /**
  * {@code com.android.internal.util.DataClass} replacement for car-lib.
- *
- * @hide
  */
 @Retention(RetentionPolicy.SOURCE)
 @Target(ElementType.TYPE)
@@ -54,8 +52,6 @@ public @interface DataClass {
      * Alternatively, for one-off customizations you can declare methods like:
      * {@code void parcelFieldName(Parcel dest, int flags)}
      * {@code static FieldType unparcelFieldName(Parcel in)}
-     *
-     * @hide
      */
     boolean genParcelable() default false;
 
@@ -77,7 +73,7 @@ public @interface DataClass {
     boolean genGetters() default true;
 
     /**
-     * {@link #genGetters} with @hide
+     * Hidden {@link #genGetters}.
      */
     boolean genHiddenGetters() default false;
 
@@ -87,7 +83,7 @@ public @interface DataClass {
     boolean genSetters() default false;
 
     /**
-     * {@link #genSetters} with @hide
+     * Hidden {@link #genSetters}.
      */
     boolean genHiddenSetters() default false;
 
@@ -107,7 +103,7 @@ public @interface DataClass {
     boolean genConstructor() default true;
 
     /**
-     * {@link #genConstructor} with @hide
+     * Hidden {@link #genConstructor}.
      */
     boolean genHiddenConstructor() default false;
 
@@ -120,7 +116,7 @@ public @interface DataClass {
     boolean genBuilder() default false;
 
     /**
-     * {@link #genBuilder} with @hide
+     * Hidden {@link #genBuilder}.
      */
     boolean genHiddenBuilder() default false;
 
@@ -158,7 +154,7 @@ public @interface DataClass {
     boolean genCopyConstructor() default false;
 
     /**
-     * {@link #genCopyConstructor} with @hide
+     * Hidden {@link #genCopyConstructor}.
      */
     boolean genHiddenCopyConstructor() default false;
 
@@ -184,7 +180,7 @@ public @interface DataClass {
     boolean genConstDefs() default true;
 
     /**
-     * {@link #genConstDefs} with @hide
+     * Hidden {@link #genConstDefs}.
      */
     boolean genHiddenConstDefs() default false;
 
diff --git a/car-lib/src/com/android/car/internal/util/DebugUtils.java b/car-lib/src/com/android/car/internal/util/DebugUtils.java
index 4f4927c388..2687ece809 100644
--- a/car-lib/src/com/android/car/internal/util/DebugUtils.java
+++ b/car-lib/src/com/android/car/internal/util/DebugUtils.java
@@ -22,8 +22,6 @@ import java.lang.reflect.Modifier;
 // Copied from frameworks/base and kept only used codes
 /**
  * <p>Various utilities for debugging and logging.</p>
- *
- * @hide
  */
 public final class DebugUtils {
     private DebugUtils() {}
@@ -31,8 +29,6 @@ public final class DebugUtils {
     /**
      * Use prefixed constants (static final values) on given class to turn value
      * into human-readable string.
-     *
-     * @hide
      */
     public static String valueToString(Class<?> clazz, String prefix, int value) {
         for (Field field : clazz.getDeclaredFields()) {
@@ -53,8 +49,6 @@ public final class DebugUtils {
     /**
      * Use prefixed constants (static final values) on given class to turn flags
      * into human-readable string.
-     *
-     * @hide
      */
     public static String flagsToString(Class<?> clazz, String prefix, int flagsToConvert) {
         int flags = flagsToConvert;
@@ -90,8 +84,6 @@ public final class DebugUtils {
      * Gets human-readable representation of constants (static final values).
      *
      * @see #constantToString(Class, String, int)
-     *
-     * @hide
      */
     public static String constantToString(Class<?> clazz, int value) {
         return constantToString(clazz, "", value);
@@ -99,8 +91,6 @@ public final class DebugUtils {
 
     /**
      * Gets human-readable representation of constants (static final values).
-     *
-     * @hide
      */
     public static String constantToString(Class<?> clazz, String prefix, int value) {
         for (Field field : clazz.getDeclaredFields()) {
diff --git a/car-lib/src/com/android/car/internal/util/ExceptionUtils.java b/car-lib/src/com/android/car/internal/util/ExceptionUtils.java
index 1ca4413c40..baf5163a05 100644
--- a/car-lib/src/com/android/car/internal/util/ExceptionUtils.java
+++ b/car-lib/src/com/android/car/internal/util/ExceptionUtils.java
@@ -26,8 +26,6 @@ import java.io.IOException;
 // Copied from frameworks/base
 /**
  * Utility methods for proxying richer exceptions across Binder calls.
- *
- * @hide
  */
 public class ExceptionUtils {
     /** TODO add javadoc */
diff --git a/car-lib/src/com/android/car/internal/util/FunctionalUtils.java b/car-lib/src/com/android/car/internal/util/FunctionalUtils.java
index ff48bed089..1e03d21aaf 100644
--- a/car-lib/src/com/android/car/internal/util/FunctionalUtils.java
+++ b/car-lib/src/com/android/car/internal/util/FunctionalUtils.java
@@ -28,8 +28,6 @@ import java.util.function.Supplier;
 // Copied from frameworks/base
 /**
  * Utilities specific to functional programming
- *
- * @hide
  */
 public final class FunctionalUtils {
     private FunctionalUtils() {}
diff --git a/car-lib/src/com/android/car/internal/util/IndentingPrintWriter.java b/car-lib/src/com/android/car/internal/util/IndentingPrintWriter.java
index 809e8d87f3..b6a80e0526 100644
--- a/car-lib/src/com/android/car/internal/util/IndentingPrintWriter.java
+++ b/car-lib/src/com/android/car/internal/util/IndentingPrintWriter.java
@@ -31,8 +31,6 @@ import java.util.Arrays;
  * <p>
  * Delays writing indent until first actual write on a newline, enabling indent
  * modification after newline.
- *
- * @hide
  */
 public class IndentingPrintWriter extends PrintWriter {
     private final String mSingleIndent;
diff --git a/car-lib/src/com/android/car/internal/util/IntArray.java b/car-lib/src/com/android/car/internal/util/IntArray.java
index 0cba717204..88d25fba2a 100644
--- a/car-lib/src/com/android/car/internal/util/IntArray.java
+++ b/car-lib/src/com/android/car/internal/util/IntArray.java
@@ -25,8 +25,6 @@ import java.util.Arrays;
 // Copy of frameworks/base/core/java/android/util/IntArray.java
 /**
  * Implements a growing array of int primitives.
- *
- * @hide
  */
 public class IntArray implements Cloneable {
     private static final int MIN_CAPACITY_INCREMENT = 12;
diff --git a/car-lib/src/com/android/car/internal/util/Lists.java b/car-lib/src/com/android/car/internal/util/Lists.java
index 90209eb006..ae58abd529 100644
--- a/car-lib/src/com/android/car/internal/util/Lists.java
+++ b/car-lib/src/com/android/car/internal/util/Lists.java
@@ -28,8 +28,6 @@ import java.util.List;
 /**
  * Provides static methods for creating {@code List} instances easily, and other
  * utility methods for working with lists.
- *
- * @hide
  */
 public class Lists {
 
diff --git a/car-lib/src/com/android/car/internal/util/LocalLog.java b/car-lib/src/com/android/car/internal/util/LocalLog.java
index 9102b03ba7..d57cb1f0fa 100644
--- a/car-lib/src/com/android/car/internal/util/LocalLog.java
+++ b/car-lib/src/com/android/car/internal/util/LocalLog.java
@@ -31,8 +31,6 @@ import java.util.Iterator;
 // Copied from frameworks/base
 /**
  * Utility for in memory logging
- *
- * @hide
  */
 public final class LocalLog {
 
diff --git a/car-lib/src/com/android/car/internal/util/LongArray.java b/car-lib/src/com/android/car/internal/util/LongArray.java
index ae11290513..c50b3c2b89 100644
--- a/car-lib/src/com/android/car/internal/util/LongArray.java
+++ b/car-lib/src/com/android/car/internal/util/LongArray.java
@@ -27,8 +27,6 @@ import java.util.Arrays;
 // Copy of frameworks/base/core/java/android/util/LongArray.java
 /**
  * Implements a growing array of long primitives.
- *
- * @hide
  */
 public class LongArray implements Cloneable {
     private static final int MIN_CAPACITY_INCREMENT = 12;
diff --git a/car-lib/src/com/android/car/internal/util/PairSparseArray.java b/car-lib/src/com/android/car/internal/util/PairSparseArray.java
index f63d379984..c853d8f4e2 100644
--- a/car-lib/src/com/android/car/internal/util/PairSparseArray.java
+++ b/car-lib/src/com/android/car/internal/util/PairSparseArray.java
@@ -30,8 +30,6 @@ import com.android.internal.util.Preconditions;
  *
  * @see LongSparseArray
  * @param <E> value to be stored
- *
- * @hide
  */
 public class PairSparseArray<E> implements Cloneable {
     /** Bitmask for casting an {@code int} into a {@code long} without sign extension. */
diff --git a/car-lib/src/com/android/car/internal/util/ParcelableException.java b/car-lib/src/com/android/car/internal/util/ParcelableException.java
index 8615d66b14..3e3c9d3505 100644
--- a/car-lib/src/com/android/car/internal/util/ParcelableException.java
+++ b/car-lib/src/com/android/car/internal/util/ParcelableException.java
@@ -40,8 +40,6 @@ import java.io.IOException;
  * <li>The receiver side must catch any thrown {@link ParcelableException} and
  * call {@link #maybeRethrow(Class)} for all expected exception types.
  * </ul>
- *
- * @hide
  */
 public final class ParcelableException extends RuntimeException implements Parcelable {
     public ParcelableException(Throwable t) {
diff --git a/car-lib/src/com/android/car/internal/util/Parcelling.java b/car-lib/src/com/android/car/internal/util/Parcelling.java
index 2b724b2643..51f8a3c1c0 100644
--- a/car-lib/src/com/android/car/internal/util/Parcelling.java
+++ b/car-lib/src/com/android/car/internal/util/Parcelling.java
@@ -37,8 +37,6 @@ import java.util.regex.Pattern;
  * Implementations should be stateless.
  *
  * @param <T> the type being [un]parcelled
- *
- * @hide
  */
 public interface Parcelling<T> {
 
diff --git a/car-lib/src/com/android/car/internal/util/Sets.java b/car-lib/src/com/android/car/internal/util/Sets.java
index bfd0435d69..4b02c91661 100644
--- a/car-lib/src/com/android/car/internal/util/Sets.java
+++ b/car-lib/src/com/android/car/internal/util/Sets.java
@@ -28,8 +28,6 @@ import java.util.TreeSet;
 /**
  * Provides static methods for creating mutable {@code Set} instances easily and
  * other static methods for working with Sets.
- *
- * @hide
  */
 public class Sets {
     /**
diff --git a/car-lib/src/com/android/car/internal/util/TextUtils.java b/car-lib/src/com/android/car/internal/util/TextUtils.java
index 1659dbdba9..dbf7502a6d 100644
--- a/car-lib/src/com/android/car/internal/util/TextUtils.java
+++ b/car-lib/src/com/android/car/internal/util/TextUtils.java
@@ -20,8 +20,6 @@ import android.annotation.Nullable;
 
 /**
  * TextUtils for car lib
- *
- * @hide
  */
 public final class TextUtils {
 
diff --git a/car-usb-handler/src/android/car/usb/handler/UsbHostController.java b/car-usb-handler/src/android/car/usb/handler/UsbHostController.java
index 8329348b8c..8fe07b1cdf 100644
--- a/car-usb-handler/src/android/car/usb/handler/UsbHostController.java
+++ b/car-usb-handler/src/android/car/usb/handler/UsbHostController.java
@@ -229,6 +229,10 @@ public final class UsbHostController
 
         UsbManager usbManager = mContext.getSystemService(UsbManager.class);
         UsbDeviceConnection connection = UsbUtil.openConnection(usbManager, device);
+        // USB Manager can return null connection if the device is failed to open one.
+        if (connection == null) {
+            return false;
+        }
         boolean aoapSupported = AoapInterface.isSupported(mContext, device, connection);
         connection.close();
 
diff --git a/car-usb-handler/src/android/car/usb/handler/UsbSettingsStorage.java b/car-usb-handler/src/android/car/usb/handler/UsbSettingsStorage.java
index f9ef3ebb56..1f16e15fb6 100644
--- a/car-usb-handler/src/android/car/usb/handler/UsbSettingsStorage.java
+++ b/car-usb-handler/src/android/car/usb/handler/UsbSettingsStorage.java
@@ -53,11 +53,12 @@ public final class UsbSettingsStorage {
         String serial = device.getSerialNumber();
         String selection;
         List<String> selectionArgs = new ArrayList<>();
-        if (AoapInterface.isDeviceInAoapMode(device)) {
+        if (serial == null) {
+            selection = COLUMN_SERIAL + " IS NULL";
+        }
+        else if (AoapInterface.isDeviceInAoapMode(device)) {
             selection = COLUMN_SERIAL + " = ? AND " + COLUMN_AOAP + " = 1";
             selectionArgs.add(serial);
-        } else if (serial == null) {
-            selection = COLUMN_SERIAL + " IS NULL";
         } else {
             selection = COLUMN_SERIAL + " = ?";
             selectionArgs.add(serial);
diff --git a/car_product/app_overlays/car-ui-customizations/res/layout/car_ui_alert_dialog_title_with_subtitle.xml b/car_product/app_overlays/car-ui-customizations/res/layout/car_ui_alert_dialog_title_with_subtitle.xml
new file mode 100644
index 0000000000..29fbbc5fb3
--- /dev/null
+++ b/car_product/app_overlays/car-ui-customizations/res/layout/car_ui_alert_dialog_title_with_subtitle.xml
@@ -0,0 +1,54 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<!-- Also check car_alert_dialog_title.xml when update layout, This title layout is not the only
+     title layout. See com.android.car.ui.AlertDialogBuilder#prepareDialog for details.
+-->
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/title_template"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:orientation="vertical"
+    android:gravity="center_vertical|start"
+    >
+
+    <ImageView
+        android:id="@+id/car_ui_alert_icon"
+        android:layout_width="@dimen/car_ui_dialog_icon_size"
+        android:layout_height="@dimen/car_ui_dialog_icon_size"
+        android:layout_marginBottom="@dimen/car_alert_dialog_padding"
+        android:scaleType="fitCenter"/>
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="vertical">
+        <TextView
+            android:id="@+id/car_ui_alert_title"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:textAppearance="@style/TextAppearance.CarUi.AlertDialog.Title" />
+
+        <TextView
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_alert_subtitle"
+            android:textAppearance="@style/TextAppearance.CarUi.AlertDialog.Subtitle"/>
+    </LinearLayout>
+
+</LinearLayout>
diff --git a/car_product/app_overlays/car-ui-customizations/res/values/dimens.xml b/car_product/app_overlays/car-ui-customizations/res/values/dimens.xml
index 37dd799072..a9e64fd7e4 100644
--- a/car_product/app_overlays/car-ui-customizations/res/values/dimens.xml
+++ b/car_product/app_overlays/car-ui-customizations/res/values/dimens.xml
@@ -85,4 +85,7 @@
 
     <!-- Height of edit text in dialogs -->
     <dimen name="car_ui_dialog_edittext_height">64dp</dimen>
+
+    <!-- Size of the alert dialog icon -->
+    <dimen name="car_ui_dialog_icon_size">56dp</dimen>
 </resources>
diff --git a/car_product/app_overlays/car-ui-customizations/res/xml/overlays.xml b/car_product/app_overlays/car-ui-customizations/res/xml/overlays.xml
index ec1fb7e233..0b0d736f98 100644
--- a/car_product/app_overlays/car-ui-customizations/res/xml/overlays.xml
+++ b/car_product/app_overlays/car-ui-customizations/res/xml/overlays.xml
@@ -111,7 +111,11 @@
     <item target="id/list" value="@id/list"/>
     <item target="id/seekbar" value="@id/seekbar"/>
     <item target="id/seekbar_value" value="@id/seekbar_value"/>
+    <item target="id/car_ui_alert_icon" value="@id/car_ui_alert_icon"/>
+    <item target="id/car_ui_alert_title" value="@id/car_ui_alert_title"/>
+    <item target="id/car_ui_alert_subtitle" value="@id/car_ui_alert_subtitle"/>
 
+    <item target="layout/car_ui_alert_dialog_title_with_subtitle" value="@layout/car_ui_alert_dialog_title_with_subtitle"/>
     <item target="layout/car_ui_alert_dialog_list" value="@layout/car_ui_alert_dialog_list"/>
     <item target="layout/car_ui_base_layout_toolbar" value="@layout/car_ui_base_layout_toolbar"/>
     <item target="layout/car_ui_list_item_2" value="@layout/car_ui_list_item_2"/>
diff --git a/car_product/build/car.mk b/car_product/build/car.mk
index e010bc7d8f..d44dce6030 100644
--- a/car_product/build/car.mk
+++ b/car_product/build/car.mk
@@ -36,6 +36,7 @@ PRODUCT_PACKAGES += \
     pppd \
     screenrecord
 
+ifneq ($(PRODUCT_IS_AUTOMOTIVE_SDK),true)
 # This is for testing
 ifneq (,$(filter userdebug eng, $(TARGET_BUILD_VARIANT)))
 PRODUCT_PACKAGES += \
@@ -44,7 +45,6 @@ PRODUCT_PACKAGES += \
     GarageModeTestApp \
     ExperimentalCarService \
     BugReportApp \
-    NetworkPreferenceApp \
     SampleCustomInputService \
     AdasLocationTestApp \
     curl \
@@ -57,6 +57,11 @@ PRODUCT_PACKAGES += \
 # SEPolicy for test apps / services
 PRODUCT_PRIVATE_SEPOLICY_DIRS += packages/services/Car/car_product/sepolicy/test
 endif
+endif # PRODUCT_IS_AUTOMOTIVE_SDK
+
+ifneq (,$(filter userdebug eng, $(TARGET_BUILD_VARIANT)))
+PRODUCT_PACKAGES += NetworkPreferenceApp
+endif
 
 # ClusterOsDouble is the testing app to test Cluster2 framework and it can handle Cluster VHAL
 # and do some Cluster OS role.
@@ -154,6 +159,8 @@ PRODUCT_PACKAGES += \
     CarSettings \
     CarUsbHandler \
     RotaryIME \
+    CarRotaryImeRRO \
+    CarRotaryController \
     RotaryPlayground \
     android.car.builtin \
     car-frameworks-service \
diff --git a/car_product/build/car_generic_system.mk b/car_product/build/car_generic_system.mk
index 902ab0a6ff..de9cc54c42 100644
--- a/car_product/build/car_generic_system.mk
+++ b/car_product/build/car_generic_system.mk
@@ -107,15 +107,15 @@ else ifeq ($(ENABLE_SAMPLE_EVS_APP), true)
 PRODUCT_PACKAGES += evs_app
 endif
 
-ifeq ($(USE_AIDL_DISPLAY_SERVICE), true)
-PRODUCT_PACKAGES += cardisplayproxyd
-else
+ifeq ($(USE_HIDL_DISPLAY_SERVICE), true)
 # TODO(b/276340636): Remove HIDL Automotive Display Service implementation when we stop supporting
 # HIDL EVS interface implementations.
 $(warning HIDL version of the Automotive Display Service is deprecated \
           and will be replaced with cardisplayproxyd.)
 PRODUCT_PACKAGES += android.frameworks.automotive.display@1.0-service
-endif  # USE_AIDL_DISPLAY_SERVICE
+else
+PRODUCT_PACKAGES += cardisplayproxyd
+endif  # USE_HIDL_DISPLAY_SERVICE
 
 PRODUCT_NAME := car_generic_system
 PRODUCT_BRAND := generic
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitCarUiProxy/plugin/res/layout-land/car_ui_app_styled_view.xml b/car_product/car_ui_portrait/apps/CarUiPortraitCarUiProxy/plugin/res/layout-land/car_ui_app_styled_view.xml
new file mode 100644
index 0000000000..32e565caf9
--- /dev/null
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitCarUiProxy/plugin/res/layout-land/car_ui_app_styled_view.xml
@@ -0,0 +1,76 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- On the portrait implementation of AAOS, it is possible for the application panel to have
+     width > height, so a landscape resource is still relevant. This layout will override the
+     corresponding one in car-ui-lib when the plugin is being used. An RRO cannot achieve this
+     behavior because this layout is private in car-ui-lib.
+     -->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:padding="0dp"
+    android:background="@drawable/car_ui_app_styled_view_background">
+
+    <!-- When not in touch mode, if we clear focus in current window, Android will re-focus the
+         first focusable view in the window automatically. Adding a FocusParkingView to the window
+         can fix this issue, because it can take focus, and it is transparent and its default focus
+         highlight is disabled, so it's invisible to the user no matter whether it's focused or not.
+         -->
+    <com.android.car.ui.FocusParkingView
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintLeft_toLeftOf="parent"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+    <com.android.car.ui.FocusArea
+        android:id="@+id/car_ui_focus_area"
+        android:layout_width="match_parent"
+        android:layout_height="@dimen/car_ui_toolbar_first_row_height"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintLeft_toLeftOf="parent">
+        <FrameLayout
+            android:id="@+id/car_ui_app_styled_view_nav_icon_container"
+            android:background="@drawable/car_ui_app_styled_view_ripple"
+            android:layout_width="88dp"
+            android:layout_height="88dp"
+            android:layout_gravity="center_vertical|start">
+            <ImageView
+                android:id="@+id/car_ui_app_styled_view_icon_close"
+                android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+                android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+                android:tint="@color/car_ui_toolbar_nav_icon_color"
+                android:layout_gravity="center"
+                android:scaleType="fitXY"
+                tools:ignore="UseAppTint" />
+        </FrameLayout>
+    </com.android.car.ui.FocusArea>
+    <ScrollView
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        android:fillViewport="true"
+        android:overScrollMode="never"
+        android:scrollbars="none"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toBottomOf="@+id/car_ui_focus_area">
+        <FrameLayout
+            android:id="@+id/car_ui_app_styled_content"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"/>
+    </ScrollView>
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_close_animation.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_close_animation.xml
new file mode 100644
index 0000000000..f713d0a0de
--- /dev/null
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_close_animation.xml
@@ -0,0 +1,22 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<translate xmlns:android="http://schemas.android.com/apk/res/android"
+    android:fillEnabled="true"
+    android:fillAfter="true"
+    android:duration="@integer/control_bar_media_card_overflow_animation_duration"
+    android:fromXDelta="-100%"
+    android:toXDelta="-20%" />
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_fade_in.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_fade_in.xml
new file mode 100644
index 0000000000..7f6fd1111b
--- /dev/null
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_fade_in.xml
@@ -0,0 +1,20 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<alpha xmlns:android="http://schemas.android.com/apk/res/android"
+    android:duration="@integer/control_bar_media_card_overflow_animation_duration"
+    android:fromAlpha="0.0"
+    android:toAlpha="1.0" />
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_fade_out.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_fade_out.xml
new file mode 100644
index 0000000000..02c98ac297
--- /dev/null
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_fade_out.xml
@@ -0,0 +1,20 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<alpha xmlns:android="http://schemas.android.com/apk/res/android"
+    android:duration="600"
+    android:fromAlpha="1.0"
+    android:toAlpha="0.0" />
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_open_animation.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_open_animation.xml
new file mode 100644
index 0000000000..8160e09e3f
--- /dev/null
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/anim/media_card_overflow_open_animation.xml
@@ -0,0 +1,22 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<translate xmlns:android="http://schemas.android.com/apk/res/android"
+    android:fillEnabled="true"
+    android:fillAfter="true"
+    android:duration="@integer/control_bar_media_card_overflow_animation_duration"
+    android:fromXDelta="-20%"
+    android:toXDelta="-100%" />
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/car_surface_50.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/car_surface_50.xml
new file mode 100644
index 0000000000..15b5b87b27
--- /dev/null
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/car_surface_50.xml
@@ -0,0 +1,19 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:alpha="0.5" android:color="@color/car_surface" />
+</selector>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/car_surface_container_highest_50.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/car_surface_container_highest_50.xml
new file mode 100644
index 0000000000..21f01d940b
--- /dev/null
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/car_surface_container_highest_50.xml
@@ -0,0 +1,19 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:alpha="0.5" android:color="@color/car_surface_container_highest" />
+</selector>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/control_bar_media_card_panel_button_background.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/control_bar_media_card_panel_button_background.xml
index eb71a3bd0d..4d9cfe82fc 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/control_bar_media_card_panel_button_background.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/control_bar_media_card_panel_button_background.xml
@@ -15,8 +15,10 @@
   -->
 
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
-    <item android:color="@color/car_surface_variant"
-        android:state_selected="false"/>
+    <item android:color="@color/car_surface_container_highest"
+        android:state_selected="false" android:state_enabled="true"/>
     <item android:color="@color/car_on_surface_variant"
-        android:state_selected="true"/>
+        android:state_selected="true" android:state_enabled="true"/>
+    <item android:color="@color/car_surface_container_highest_50"
+        android:state_enabled="false"/>
 </selector>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/control_bar_media_card_panel_button_foreground.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/control_bar_media_card_panel_button_foreground.xml
index 3cdf6ab28e..248899fa54 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/control_bar_media_card_panel_button_foreground.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/color/control_bar_media_card_panel_button_foreground.xml
@@ -15,8 +15,10 @@
   -->
 
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
-    <item android:color="@color/car_surface"
-        android:state_selected="true"/>
-    <item android:color="@color/car_on_surface"
-        android:state_selected="false"/>
+    <item android:color="@color/car_surface_container_highest"
+        android:state_selected="true" android:state_enabled="true"/>
+    <item android:color="@color/car_on_surface_variant"
+        android:state_selected="false" android:state_enabled="true"/>
+    <item android:color="@color/car_surface_50"
+        android:state_enabled="false"/>
 </selector>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/custom_action_overflow_conceal_background.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/custom_action_overflow_conceal_background.xml
new file mode 100644
index 0000000000..7a9b327f20
--- /dev/null
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/custom_action_overflow_conceal_background.xml
@@ -0,0 +1,27 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:height="80dp"
+    android:viewportHeight="67.95"
+    android:viewportWidth="344.26"
+    android:width="405.30978dp">
+
+    <path
+        android:fillColor="@color/car_surface_container_high"
+        android:pathData="M0,0L344.26,0L344.26,0.05C325.58,0.46 310.57,15.43 310.57,33.85C310.57,
+        52.26 325.58,67.24 344.26,67.64L344.26,67.95L0,67.95Z" />
+</vector>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/left_half_pill_button_shape.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/left_half_pill_button_shape.xml
index c38089cded..cfb48f7da5 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/left_half_pill_button_shape.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/left_half_pill_button_shape.xml
@@ -14,9 +14,14 @@
   ~ limitations under the License.
   -->
 
-<shape xmlns:android="http://schemas.android.com/apk/res/android"
-    android:shape="rectangle">
-    <corners android:bottomLeftRadius="@dimen/control_bar_media_card_half_pill_button_radius"
-        android:topLeftRadius="@dimen/control_bar_media_card_half_pill_button_radius" />
-    <solid android:color="@color/car_surface_variant" />
-</shape>
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item>
+        <shape
+            android:shape="rectangle">
+            <corners android:bottomLeftRadius="@dimen/control_bar_media_card_half_pill_button_radius"
+                android:topLeftRadius="@dimen/control_bar_media_card_half_pill_button_radius" />
+            <solid android:color="@color/car_surface_container_highest" />
+        </shape>
+    </item>
+    <item android:drawable="@drawable/button_ripple"/>
+</layer-list>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/right_half_pill_button_shape.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/right_half_pill_button_shape.xml
index ac8a27f187..ab659bd08d 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/right_half_pill_button_shape.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/drawable/right_half_pill_button_shape.xml
@@ -14,10 +14,15 @@
   ~ limitations under the License.
   -->
 
-<shape xmlns:android="http://schemas.android.com/apk/res/android"
-    android:shape="rectangle">
-    <corners
-        android:bottomRightRadius="@dimen/control_bar_media_card_half_pill_button_radius"
-        android:topRightRadius="@dimen/control_bar_media_card_half_pill_button_radius" />
-    <solid android:color="@color/car_surface_variant" />
-</shape>
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item>
+        <shape
+            android:shape="rectangle">
+            <corners
+                android:bottomRightRadius="@dimen/control_bar_media_card_half_pill_button_radius"
+                android:topRightRadius="@dimen/control_bar_media_card_half_pill_button_radius" />
+            <solid android:color="@color/car_surface_container_highest" />
+        </shape>
+    </item>
+    <item android:drawable="@drawable/button_ripple"/>
+</layer-list>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/car_ui_portrait_background_panel_base.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/car_ui_portrait_background_panel_base.xml
index af4d912f25..e0c027c7d9 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/car_ui_portrait_background_panel_base.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/car_ui_portrait_background_panel_base.xml
@@ -29,23 +29,8 @@
         android:text="@string/base_layer_failure_recovery_title_string"
         android:textAppearance="@style/TextAppearance.Car.Display"
         android:textColor="@color/car_on_surface"
-        app:layout_constraintVertical_chainStyle="packed"
         app:layout_constraintStart_toStartOf="parent"
         app:layout_constraintEnd_toEndOf="parent"
         app:layout_constraintTop_toTopOf="parent"
-        app:layout_constraintBottom_toTopOf="@id/base_layer_failure_recovery_message"/>
-
-    <TextView
-        android:id="@+id/base_layer_failure_recovery_message"
-        android:layout_width="wrap_content"
-        android:layout_height="wrap_content"
-        android:layout_gravity="center"
-        android:text="@string/base_layer_failure_recovery_message_string"
-        android:textAppearance="@style/TextAppearance.Car.Body.Medium"
-        android:textColor="@color/car_on_surface"
-        app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintEnd_toEndOf="parent"
-        app:layout_constraintTop_toBottomOf="@id/base_layer_failure_recovery_title"
         app:layout_constraintBottom_toBottomOf="parent"/>
-
 </androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_card.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_card.xml
index c3f08522d6..ffc2d1e28f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_card.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_card.xml
@@ -20,7 +20,7 @@
     android:layout_width="match_parent"
     android:layout_height="@dimen/control_bar_media_card_height"
     android:layout_gravity="center_horizontal|bottom"
-    app:cardBackgroundColor="@color/car_surface"
+    app:cardBackgroundColor="@color/car_surface_container_high"
     app:cardCornerRadius="@dimen/control_bar_media_card_radius"
     app:cardElevation="0dp">
 
@@ -31,69 +31,6 @@
         android:padding="@dimen/control_bar_media_card_padding"
         app:layoutDescription="@xml/control_bar_media_card_queue_history_motion_scene">
 
-        <ImageButton
-            android:id="@+id/play_pause_button"
-            android:layout_width="@dimen/control_bar_media_card_pill_button_width"
-            android:layout_height="@dimen/media_card_large_button_size"
-            android:src="@drawable/ic_play_pause_selector"
-            android:tint="@color/car_surface"
-            android:scaleType="center"
-            android:background="@drawable/pill_button_shape"
-            android:backgroundTint="@color/car_on_surface"
-            app:layout_constraintStart_toStartOf="parent"
-            app:layout_constraintBottom_toBottomOf="parent" />
-
-        <ImageButton
-            android:id="@+id/playback_action_id1"
-            android:layout_width="@dimen/control_bar_media_card_half_pill_button_width"
-            android:layout_height="@dimen/media_card_large_button_size"
-            android:layout_marginStart="@dimen/media_card_view_separation_margin"
-            android:background="@drawable/left_half_pill_button_shape"
-            android:src="@drawable/ic_skip_previous"
-            android:tint="@color/car_on_surface"
-            app:layout_constraintStart_toEndOf="@id/play_pause_button"
-            app:layout_constraintBottom_toBottomOf="@id/play_pause_button"
-            app:layout_constraintTop_toTopOf="@id/play_pause_button" />
-
-        <ImageButton
-            android:id="@+id/playback_action_id2"
-            android:layout_width="@dimen/control_bar_media_card_half_pill_button_width"
-            android:layout_height="@dimen/media_card_large_button_size"
-            android:layout_marginStart="4dp"
-            android:background="@drawable/right_half_pill_button_shape"
-            android:src="@drawable/ic_skip_next"
-            android:tint="@color/car_on_surface"
-            app:layout_goneMarginStart="@dimen/media_card_view_separation_margin"
-            app:layout_constraintStart_toEndOf="@id/playback_action_id1"
-            app:layout_constraintBottom_toBottomOf="@id/play_pause_button"
-            app:layout_constraintTop_toTopOf="@id/play_pause_button" />
-
-        <ImageButton
-            android:id="@+id/queue_button"
-            android:layout_width="@dimen/media_card_large_button_size"
-            android:layout_height="@dimen/media_card_large_button_size"
-            android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
-            android:src="@drawable/ic_queue"
-            android:tint="@color/control_bar_media_card_panel_button_foreground"
-            android:background="@drawable/dark_circle_button_background"
-            android:backgroundTint="@color/control_bar_media_card_panel_button_background"
-            app:layout_constraintHorizontal_chainStyle="packed"
-            app:layout_constraintEnd_toStartOf="@id/history_button"
-            app:layout_constraintBottom_toBottomOf="parent" />
-
-
-        <ImageButton
-            android:id="@+id/history_button"
-            android:layout_width="@dimen/media_card_large_button_size"
-            android:layout_height="@dimen/media_card_large_button_size"
-            android:layout_marginEnd="@dimen/media_card_view_separation_margin"
-            android:src="@drawable/ic_history"
-            android:tint="@color/control_bar_media_card_panel_button_foreground"
-            android:background="@drawable/dark_circle_button_background"
-            android:backgroundTint="@color/control_bar_media_card_panel_button_background"
-            app:layout_constraintEnd_toEndOf="parent"
-            app:layout_constraintBottom_toBottomOf="parent" />
-
         <ImageView
             android:id="@+id/media_widget_app_icon"
             android:layout_width="@dimen/control_bar_media_card_app_icon_size"
@@ -125,18 +62,79 @@
             android:layout_marginTop="@dimen/control_bar_media_card_view_separation_margin"
             android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
             app:logoSize="small"
-            app:logoTint="@color/car_on_surface_variant"
+            app:logoTint="@color/car_on_surface"
             app:layout_constraintTop_toBottomOf="@id/title"
             app:layout_constraintEnd_toStartOf="@id/guideline" />
 
+        <LinearLayout
+            android:id="@+id/custom_action_overflow_container"
+            android:layout_width="wrap_content"
+            android:layout_height="@dimen/media_card_large_button_size"
+            android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
+            android:layout_marginStart="@dimen/media_card_view_separation_margin"
+            android:paddingHorizontal="@dimen/control_bar_media_card_custom_action_layout_horizontal_padding"
+            android:background="@drawable/pill_button_shape"
+            android:backgroundTint="@color/car_on_surface_variant"
+            android:visibility="gone"
+            app:layout_constraintBottom_toBottomOf="@id/play_pause_button"
+            app:layout_constraintStart_toEndOf="@id/playback_action_id2"
+            app:layout_constraintEnd_toStartOf="@id/queue_button"
+            app:layout_constraintTop_toTopOf="@id/play_pause_button"
+            app:layout_constraintHorizontal_bias="1">
+
+            <ImageButton
+                android:id="@+id/playback_action_id9"
+                android:layout_width="@dimen/control_bar_media_card_custom_action_size"
+                android:layout_height="@dimen/control_bar_media_card_custom_action_size"
+                android:layout_gravity="center_vertical"
+                style="@style/ControlBarCustomActionOverflowStyle"/>
+
+            <ImageButton
+                android:id="@+id/playback_action_id10"
+                android:layout_width="@dimen/control_bar_media_card_custom_action_size"
+                android:layout_height="@dimen/control_bar_media_card_custom_action_size"
+                android:layout_gravity="center_vertical"
+                style="@style/ControlBarCustomActionOverflowStyle"
+                android:layout_marginStart="@dimen/control_bar_media_card_custom_action_spacing" />
+
+            <ImageButton
+                android:id="@+id/playback_action_id11"
+                android:layout_width="@dimen/control_bar_media_card_custom_action_size"
+                android:layout_height="@dimen/control_bar_media_card_custom_action_size"
+                android:layout_gravity="center_vertical"
+                style="@style/ControlBarCustomActionOverflowStyle"
+                android:layout_marginStart="@dimen/control_bar_media_card_custom_action_spacing" />
+
+            <ImageButton
+                android:id="@+id/overflow_exit_button"
+                android:layout_width="@dimen/control_bar_media_card_custom_action_size"
+                android:layout_height="@dimen/control_bar_media_card_custom_action_size"
+                android:layout_gravity="center_vertical"
+                style="@style/ControlBarOverflowExitButtonStyle"
+                android:layout_marginStart="@dimen/control_bar_media_card_custom_action_spacing"
+                android:src="@drawable/ic_cancel" />
+        </LinearLayout>
+
+        <View
+            android:id="@+id/custom_action_overflow_conceal_container"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/media_card_large_button_size"
+            android:paddingHorizontal="@dimen/control_bar_media_card_custom_action_layout_horizontal_padding"
+            android:background="@drawable/custom_action_overflow_conceal_background"
+            app:layout_constraintBottom_toBottomOf="@id/play_pause_button"
+            app:layout_constraintStart_toStartOf="@id/custom_action_overflow_container"
+            app:layout_constraintEnd_toEndOf="@id/guideline"
+            app:layout_constraintTop_toTopOf="@id/playback_action_id2"
+            app:layout_constraintHorizontal_bias="1"
+            app:layout_constrainedWidth="true"/>
+
         <LinearLayout
             android:id="@+id/custom_action_container"
             android:layout_width="wrap_content"
             android:layout_height="@dimen/media_card_large_button_size"
             android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
             android:layout_marginStart="@dimen/media_card_view_separation_margin"
-            android:paddingStart="@dimen/control_bar_media_card_custom_action_layout_horizontal_padding"
-            android:paddingEnd="@dimen/control_bar_media_card_custom_action_layout_horizontal_padding"
+            android:paddingHorizontal="@dimen/control_bar_media_card_custom_action_layout_horizontal_padding"
             app:layout_constraintBottom_toBottomOf="@id/play_pause_button"
             app:layout_constraintStart_toEndOf="@id/playback_action_id2"
             app:layout_constraintEnd_toStartOf="@id/queue_button"
@@ -200,55 +198,76 @@
                 android:src="@drawable/ic_overflow_horizontal" />
         </LinearLayout>
 
-        <LinearLayout
-            android:id="@+id/custom_action_overflow_container"
-            android:layout_width="wrap_content"
+        <ImageButton
+            android:id="@+id/play_pause_button"
+            android:layout_width="@dimen/control_bar_media_card_pill_button_width"
             android:layout_height="@dimen/media_card_large_button_size"
-            android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
-            android:layout_marginStart="@dimen/media_card_view_separation_margin"
-            android:paddingStart="@dimen/control_bar_media_card_custom_action_layout_horizontal_padding"
-            android:paddingEnd="@dimen/control_bar_media_card_custom_action_layout_horizontal_padding"
+            android:src="@drawable/ic_play_pause_selector"
+            android:tint="@color/car_surface_container_high"
+            android:scaleType="center"
             android:background="@drawable/pill_button_shape"
-            android:backgroundTint="@color/car_on_surface_variant"
-            android:visibility="gone"
+            android:backgroundTint="@color/car_primary"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintBottom_toBottomOf="parent" />
+
+        <ImageButton
+            android:id="@+id/playback_action_id1"
+            android:layout_width="@dimen/control_bar_media_card_half_pill_button_width"
+            android:layout_height="@dimen/media_card_large_button_size"
+            android:layout_marginStart="@dimen/media_card_view_separation_margin"
+            android:background="@drawable/left_half_pill_button_shape"
+            android:src="@drawable/ic_skip_previous"
+            android:tint="@color/car_on_surface_variant"
+            android:scaleType="fitCenter"
+            android:padding="@dimen/control_bar_media_card_playback_button_icon_padding"
+            android:cropToPadding="true"
+            android:backgroundTint="@color/car_surface_container_highest"
+            app:layout_constraintStart_toEndOf="@id/play_pause_button"
             app:layout_constraintBottom_toBottomOf="@id/play_pause_button"
-            app:layout_constraintStart_toEndOf="@id/playback_action_id2"
-            app:layout_constraintEnd_toStartOf="@id/queue_button"
-            app:layout_constraintTop_toTopOf="@id/play_pause_button"
-            app:layout_constraintHorizontal_bias="1">
+            app:layout_constraintTop_toTopOf="@id/play_pause_button" />
 
-            <ImageButton
-                android:id="@+id/playback_action_id9"
-                android:layout_width="@dimen/control_bar_media_card_custom_action_size"
-                android:layout_height="@dimen/control_bar_media_card_custom_action_size"
-                android:layout_gravity="center_vertical"
-                style="@style/ControlBarCustomActionOverflowStyle"/>
+        <ImageButton
+            android:id="@+id/playback_action_id2"
+            android:layout_width="@dimen/control_bar_media_card_half_pill_button_width"
+            android:layout_height="@dimen/media_card_large_button_size"
+            android:layout_marginStart="4dp"
+            android:background="@drawable/right_half_pill_button_shape"
+            android:src="@drawable/ic_skip_next"
+            android:tint="@color/car_on_surface_variant"
+            android:scaleType="fitCenter"
+            android:padding="@dimen/control_bar_media_card_playback_button_icon_padding"
+            android:cropToPadding="true"
+            android:backgroundTint="@color/car_surface_container_highest"
+            app:layout_goneMarginStart="@dimen/media_card_view_separation_margin"
+            app:layout_constraintStart_toEndOf="@id/playback_action_id1"
+            app:layout_constraintBottom_toBottomOf="@id/play_pause_button"
+            app:layout_constraintTop_toTopOf="@id/play_pause_button" />
 
-            <ImageButton
-                android:id="@+id/playback_action_id10"
-                android:layout_width="@dimen/control_bar_media_card_custom_action_size"
-                android:layout_height="@dimen/control_bar_media_card_custom_action_size"
-                android:layout_gravity="center_vertical"
-                style="@style/ControlBarCustomActionOverflowStyle"
-                android:layout_marginStart="@dimen/control_bar_media_card_custom_action_spacing" />
+        <ImageButton
+            android:id="@+id/queue_button"
+            android:layout_width="@dimen/media_card_large_button_size"
+            android:layout_height="@dimen/media_card_large_button_size"
+            android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
+            android:src="@drawable/ic_queue"
+            android:tint="@color/control_bar_media_card_panel_button_foreground"
+            android:background="@drawable/circle_button_background"
+            android:backgroundTint="@color/control_bar_media_card_panel_button_background"
+            app:layout_constraintHorizontal_chainStyle="packed"
+            app:layout_constraintEnd_toStartOf="@id/history_button"
+            app:layout_constraintBottom_toBottomOf="parent" />
 
-            <ImageButton
-                android:id="@+id/playback_action_id11"
-                android:layout_width="@dimen/control_bar_media_card_custom_action_size"
-                android:layout_height="@dimen/control_bar_media_card_custom_action_size"
-                android:layout_gravity="center_vertical"
-                style="@style/ControlBarCustomActionOverflowStyle"
-                android:layout_marginStart="@dimen/control_bar_media_card_custom_action_spacing" />
 
-            <ImageButton
-                android:id="@+id/overflow_exit_button"
-                android:layout_width="@dimen/control_bar_media_card_custom_action_size"
-                android:layout_height="@dimen/control_bar_media_card_custom_action_size"
-                android:layout_gravity="center_vertical"
-                style="@style/ControlBarOverflowExitButtonStyle"
-                android:layout_marginStart="@dimen/control_bar_media_card_custom_action_spacing"
-                android:src="@drawable/ic_cancel" />
-        </LinearLayout>
+        <ImageButton
+            android:id="@+id/history_button"
+            android:layout_width="@dimen/media_card_large_button_size"
+            android:layout_height="@dimen/media_card_large_button_size"
+            android:layout_marginEnd="@dimen/media_card_view_separation_margin"
+            android:src="@drawable/ic_history"
+            android:tint="@color/control_bar_media_card_panel_button_foreground"
+            android:background="@drawable/circle_button_background"
+            android:backgroundTint="@color/control_bar_media_card_panel_button_background"
+            app:layout_constraintEnd_toEndOf="parent"
+            app:layout_constraintBottom_toBottomOf="parent" />
 
         <SeekBar
             android:id="@+id/playback_seek_bar"
@@ -256,16 +275,17 @@
             android:layout_height="@dimen/control_bar_media_card_seek_bar_height"
             android:layout_marginBottom="@dimen/media_card_view_separation_margin"
             android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
-            android:clickable="false"
             android:paddingEnd="0dp"
             android:paddingStart="0dp"
-            android:progressBackgroundTint="@color/car_on_surface_variant"
+            android:progressBackgroundTint="@color/car_surface_container_highest"
             android:progressDrawable="@drawable/media_card_seekbar_progress"
-            android:progressTint="@color/car_on_surface"
+            android:progressTint="@color/car_primary"
             android:splitTrack="true"
             android:thumb="@drawable/media_card_seekbar_thumb"
             android:thumbTint="@color/car_on_surface"
             android:thumbOffset="0px"
+            android:clickable="true"
+            android:focusable="true"
             app:layout_constraintStart_toStartOf="parent"
             app:layout_constraintBottom_toTopOf="@id/play_pause_button"
             app:layout_constraintEnd_toStartOf="@id/current_time"
@@ -275,7 +295,7 @@
             android:id="@+id/current_time"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
-            android:textColor="@color/car_on_surface"
+            android:textColor="@color/car_text_secondary"
             android:textAppearance="@style/TextAppearance.Car.Sub.Large"
             app:layout_constraintStart_toEndOf="@id/playback_seek_bar"
             app:layout_constraintEnd_toStartOf="@id/inner_separator"
@@ -286,7 +306,7 @@
             android:id="@+id/inner_separator"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
-            android:textColor="@color/car_on_surface_variant"
+            android:textColor="@color/car_text_secondary"
             android:text="@string/times_separator"
             android:textAppearance="@style/TextAppearance.Car.Sub.Large"
             app:layout_constraintStart_toEndOf="@id/current_time"
@@ -299,7 +319,7 @@
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
-            android:textColor="@color/car_on_surface_variant"
+            android:textColor="@color/car_text_secondary"
             android:textAppearance="@style/TextAppearance.Car.Sub.Large"
             app:layout_constraintStart_toEndOf="@id/inner_separator"
             app:layout_constraintEnd_toStartOf="@id/guideline"
@@ -315,7 +335,7 @@
             android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
             android:gravity="center_vertical"
             android:includeFontPadding="false"
-            android:textColor="@color/car_on_surface_variant"
+            android:textColor="@color/car_text_secondary"
             android:textAppearance="@style/TextAppearance.Car.Sub.Large"
             android:maxLines="1"
             android:ellipsize="end"
@@ -331,7 +351,7 @@
             android:layout_marginTop="@dimen/control_bar_media_card_view_separation_margin"
             android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
             android:gravity="center_vertical"
-            android:textColor="@color/car_on_surface"
+            android:textColor="@color/car_text_primary"
             android:maxLines="1"
             android:ellipsize="end"
             app:layout_constraintStart_toStartOf="parent"
@@ -343,11 +363,11 @@
             android:id="@+id/subtitle"
             android:layout_width="0dp"
             android:layout_height="wrap_content"
-            android:layout_marginTop="@dimen/control_bar_media_card_view_separation_margin"
+            android:layout_marginTop="@dimen/control_bar_media_card_subtitle_top_margin"
             android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
             android:gravity="center_vertical"
             android:includeFontPadding="false"
-            android:textColor="@color/car_on_surface_variant"
+            android:textColor="@color/car_text_secondary"
             android:textAppearance="@style/TextAppearance.Car.Body.Medium"
             android:maxLines="1"
             android:ellipsize="end"
@@ -380,10 +400,10 @@
                     android:text="@string/media_card_queue_header_title"
                     android:maxLines="1"
                     android:drawableStart="@drawable/ic_queue"
-                    android:drawableTint="@color/car_on_surface"
+                    android:drawableTint="@color/car_text_primary"
                     android:drawablePadding="@dimen/media_card_view_separation_margin"
                     android:textAppearance="@style/TextAppearance.Car.Body.Medium"
-                    android:textColor="@color/car_on_surface" />
+                    android:textColor="@color/car_text_primary" />
                 <com.android.car.apps.common.CarUiRecyclerViewNoScrollbar
                     android:id="@+id/queue_list"
                     android:layout_width="match_parent"
@@ -407,10 +427,10 @@
                     android:text="@string/media_card_history_header_title"
                     android:maxLines="1"
                     android:drawableStart="@drawable/ic_history"
-                    android:drawableTint="@color/car_on_surface"
+                    android:drawableTint="@color/car_text_primary"
                     android:drawablePadding="@dimen/media_card_view_separation_margin"
                     android:textAppearance="@style/TextAppearance.Car.Body.Medium"
-                    android:textColor="@color/car_on_surface" />
+                    android:textColor="@color/car_text_primary" />
                 <com.android.car.apps.common.CarUiRecyclerViewNoScrollbar
                     android:id="@+id/history_list"
                     android:layout_width="match_parent"
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_history_item.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_history_item.xml
index 71fcb46f9f..6bdf6c1adb 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_history_item.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_history_item.xml
@@ -22,7 +22,7 @@
     android:layout_height="match_parent"
     android:layout_gravity="center_horizontal|bottom"
     android:layout_marginEnd="@dimen/media_card_view_separation_margin"
-    app:cardBackgroundColor="@color/car_surface_variant"
+    app:cardBackgroundColor="@color/car_surface_container_highest"
     app:cardCornerRadius="@dimen/control_bar_media_card_item_card_radius"
     app:cardElevation="0dp">
 
@@ -50,7 +50,7 @@
             android:layout_height="0dp"
             android:layout_width="0dp"
             android:textAppearance="@style/TextAppearance.Car.Body.Small"
-            android:textColor="@color/car_on_surface"
+            android:textColor="@color/car_text_primary"
             android:maxLines="3"
             android:ellipsize="end"
             android:layout_marginStart="@dimen/control_bar_media_card_history_item_margin_large"
@@ -65,7 +65,7 @@
             android:layout_height="wrap_content"
             android:layout_width="0dp"
             android:textAppearance="@style/TextAppearance.Car.Body.Small"
-            android:textColor="@color/car_on_surface_variant"
+            android:textColor="@color/car_text_secondary"
             android:maxLines="1"
             android:ellipsize="end"
             android:layout_marginStart="@dimen/control_bar_media_card_history_item_margin_large"
@@ -105,7 +105,7 @@
             android:layout_width="match_parent"
             android:gravity="center"
             android:textAppearance="@style/TextAppearance.Car.Body.Small"
-            android:textColor="@color/car_on_surface"
+            android:textColor="@color/car_text_primary"
             android:maxLines="1"
             android:ellipsize="end"
             android:layout_marginStart="@dimen/control_bar_media_card_history_item_margin_small"
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_queue_item.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_queue_item.xml
index ee9c7c385c..ae3625c3d8 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_queue_item.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/layout/control_bar_media_queue_item.xml
@@ -19,7 +19,7 @@
     android:layout_width="@dimen/control_bar_media_card_queue_item_card_width"
     android:layout_height="match_parent"
     android:layout_gravity="center_horizontal|bottom"
-    app:cardBackgroundColor="@color/car_surface_variant"
+    app:cardBackgroundColor="@color/car_surface_container_highest"
     app:cardCornerRadius="@dimen/control_bar_media_card_item_card_radius"
     app:cardElevation="0dp"
     android:layout_marginEnd="@dimen/media_card_view_separation_margin">
@@ -34,7 +34,7 @@
             android:layout_height="wrap_content"
             android:layout_width="0dp"
             android:textAppearance="@style/TextAppearance.Car.Body.Small"
-            android:textColor="@color/car_on_surface"
+            android:textColor="@color/car_text_primary"
             android:maxLines="1"
             android:ellipsize="end"
             android:layout_marginEnd="@dimen/media_card_view_separation_margin"
@@ -48,7 +48,7 @@
             android:layout_height="wrap_content"
             android:layout_width="0dp"
             android:textAppearance="@style/TextAppearance.Car.Body.Small"
-            android:textColor="@color/car_on_surface_variant"
+            android:textColor="@color/car_text_secondary"
             android:maxLines="1"
             android:ellipsize="end"
             android:layout_marginEnd="@dimen/media_card_view_separation_margin"
@@ -74,7 +74,7 @@
             android:layout_height="wrap_content"
             android:layout_width="wrap_content"
             android:textAppearance="@style/TextAppearance.Car.Body.Small"
-            android:textColor="@color/car_on_surface_variant"
+            android:textColor="@color/car_text_secondary"
             android:maxLines="1"
             android:ellipsize="end"
             app:layout_constraintBottom_toBottomOf="parent"
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/config.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/config.xml
index db8533a93c..8c937b8337 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/config.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/config.xml
@@ -65,9 +65,13 @@
         <item>android.server.wm.app/android.server.wm.app.MinAspectRatioLandscapeActivity</item>
         <item>android.server.wm.app/android.server.wm.app.MinAspectRatioPortraitActivity</item>
         <item>android.server.wm.app/android.server.wm.app.MinAspectRatioUnsetActivity</item>
+        <!-- TODO(b/372517324): Remove once ag/28710677 is in AOSP.-->
+        <item>android.view.surfacecontrol.cts/android.view.surfacecontrol.cts.SurfaceControlViewHostTests$TestActivity</item>
         <item>android.view.surfacecontrol.cts/android.view.cts.surfacevalidator.CapturedActivity</item>
         <item>android.view.surfacecontrol.cts/.TrustedPresentationCallbackTest$TestActivity</item>
         <item>android.view.surfacecontrol.cts/android.view.cts.surfacevalidator.CapturedActivityWithResource</item>
+        <!-- TODO(b/368426111): Remove once immersive mode doesn't cause extra lifecycle to the activity.-->
+        <item>android.view.surfacecontrol.cts/android.view.surfacecontrol.cts.TestActivity</item>
         <item>android.uirendering.cts/android.uirendering.cts.testinfrastructure.DrawActivity</item>
         <item>android.display.cts/android.display.cts.DisplayManagerTest$TestActivity</item>
         <!-- TODO(b/297060765): Remove AssistantActivity & AnimationTestActivity once find a proper
@@ -91,6 +95,9 @@
         <item>android.server.wm.cts/android.server.wm.animations.ActivityTransitionTests$EdgeExtensionActivity</item>
         <item>android.server.wm.cts/android.server.wm.animations.ActivityTransitionTests$CustomWindowAnimationActivity</item>
         <item>android.server.wm.cts/android.server.wm.animations.ActivityTransitionTests$TransitionActivity</item>
+        <!-- TODO(b/308859591): Remove activities from full screen config once proper solution
+            found. This is only a temporary solution for showing this activity in full screen. -->
+        <item>com.android.car.settings/com.android.car.settings.sound.AudioRouteSelectionActivity</item>
         <!-- END -->
     </string-array>
 
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/dimens.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/dimens.xml
index 4acac1c35a..b87a2a9eac 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/dimens.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/dimens.xml
@@ -51,6 +51,7 @@
     <dimen name="control_bar_media_card_pill_button_width">160dp</dimen>
     <dimen name="control_bar_media_card_app_icon_size">26dp</dimen>
     <dimen name="control_bar_media_card_album_art_size">240dp</dimen>
+    <item name="control_bar_media_card_album_art_drawable_corner_ratio" format="float" type="dimen">0.1</item>
     <dimen name="control_bar_media_card_custom_action_layout_horizontal_padding">38dp</dimen>
     <dimen name="control_bar_media_card_item_card_radius">16dp</dimen>
     <dimen name="control_bar_media_card_queue_item_thumbnail_size">112dp</dimen>
@@ -66,6 +67,8 @@
     <dimen name="control_bar_media_card_history_item_margin_small">12dp</dimen>
     <dimen name="control_bar_media_card_history_item_margin_large">24dp</dimen>
     <dimen name="control_bar_media_card_history_item_width_active">316dp</dimen>
-    <dimen name="control_bar_media_card_history_item_width_inactive">160dp</dimen>
+    <dimen name="control_bar_media_card_history_item_width_inactive">220dp</dimen>
+    <dimen name="control_bar_media_card_subtitle_top_margin">8dp</dimen>
+    <dimen name="control_bar_media_card_playback_button_icon_padding">20dp</dimen>
 
 </resources>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/integers.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/integers.xml
index 427fa50758..ddba3560aa 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/integers.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/integers.xml
@@ -17,4 +17,5 @@
 <resources>
     <!-- Control bar media card panel animation duration in ms -->
     <integer name="control_bar_side_panel_animation_duration">400</integer>
+    <integer name="control_bar_media_card_overflow_animation_duration">200</integer>
 </resources>
\ No newline at end of file
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/strings.xml
index 740270e3c1..23ae9f1021 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/strings.xml
@@ -16,8 +16,7 @@
 -->
 <resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="app_title">Car launcher reference</string>
-    <string name="base_layer_failure_recovery_title_string">Something went wrong</string>
-    <string name="base_layer_failure_recovery_message_string">Please open a navigation app</string>
+    <string name="base_layer_failure_recovery_title_string">Please open a navigation app</string>
 
     <!-- Audio route selection dialog. Placeholder resources for overriding -->
     <string name="audio_route_dialog_title">Audio output</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/styles.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/styles.xml
index 1e9789e699..77aad860e4 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/styles.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/values/styles.xml
@@ -29,21 +29,21 @@
         <item name="android:maxWidth">800dp</item>
     </style>
     <style name="ControlBarCustomActionStyle">
-        <item name="android:tint">@color/car_on_surface_variant</item>
+        <item name="android:tint">@color/car_on_surface</item>
         <item name="android:scaleType">fitCenter</item>
         <item name="android:background">@android:color/transparent</item>
         <item name="android:visibility">gone</item>
     </style>
     <style name="ControlBarOverflowButtonStyle">
-        <item name="android:tint">@color/car_on_surface_variant</item>
+        <item name="android:tint">@color/car_on_surface</item>
         <item name="android:scaleType">fitCenter</item>
         <item name="android:background">@android:color/transparent</item>
         <item name="android:visibility">gone</item>
     </style>
     <style name="ControlBarCustomActionOverflowStyle" parent="ControlBarCustomActionStyle">
-        <item name="android:tint">@color/car_surface_variant</item>
+        <item name="android:tint">@color/car_surface_container_highest</item>
     </style>
     <style name="ControlBarOverflowExitButtonStyle" parent="ControlBarCustomActionStyle">
-        <item name="android:tint">@color/car_surface_variant</item>
+        <item name="android:tint">@color/car_surface_container_highest</item>
     </style>
 </resources>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/xml/control_bar_media_card_queue_history_motion_scene.xml b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/xml/control_bar_media_card_queue_history_motion_scene.xml
index 30d3a5925f..a2c1e05737 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/xml/control_bar_media_card_queue_history_motion_scene.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/res/xml/control_bar_media_card_queue_history_motion_scene.xml
@@ -24,6 +24,14 @@
         motion:duration="@integer/control_bar_side_panel_animation_duration"
         motion:motionInterpolator="standard">
         <KeyFrameSet>
+            <KeyAttribute
+                android:alpha="0"
+                motion:framePosition="50"
+                motion:motionTarget="@id/title" />
+            <KeyAttribute
+                android:alpha="0"
+                motion:framePosition="50"
+                motion:motionTarget="@id/playback_seek_bar" />
         </KeyFrameSet>
     </Transition>
 
@@ -57,6 +65,11 @@
             <PropertySet
                 motion:visibilityMode="ignore"/>
         </ConstraintOverride>
+        <ConstraintOverride
+            android:id="@id/custom_action_overflow_conceal_container">
+            <PropertySet
+                motion:visibilityMode="ignore"/>
+        </ConstraintOverride>
         <ConstraintOverride
             android:id="@id/media_widget_app_icon">
             <PropertySet
@@ -115,7 +128,7 @@
             android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
             motion:layout_goneMarginBottom="@dimen/media_card_view_separation_margin"
             android:gravity="center_vertical"
-            android:textColor="@color/car_on_surface"
+            android:textColor="@color/car_text_primary"
             android:maxLines="1"
             android:ellipsize="end"
             motion:layout_constraintStart_toEndOf="@id/playback_action_id2"
@@ -141,9 +154,9 @@
             android:clickable="false"
             android:paddingEnd="0dp"
             android:paddingStart="0dp"
-            android:progressBackgroundTint="@color/car_on_surface_variant"
+            android:progressBackgroundTint="@color/car_surface_container_highest"
             android:progressDrawable="@drawable/media_card_seekbar_progress"
-            android:progressTint="@color/car_on_surface"
+            android:progressTint="@color/car_primary"
             android:splitTrack="true"
             android:thumb="@drawable/media_card_seekbar_thumb"
             android:thumbTint="@color/car_on_surface"
@@ -182,18 +195,37 @@
             <PropertySet
                 motion:visibilityMode="ignore"/>
         </ConstraintOverride>
+        <ConstraintOverride
+            android:id="@id/custom_action_overflow_conceal_container"
+            android:alpha="0">
+            <PropertySet
+                motion:visibilityMode="ignore"/>
+        </ConstraintOverride>
         <ConstraintOverride
             android:id="@id/media_widget_app_icon"
             android:alpha="0">
         <PropertySet
             motion:visibilityMode="ignore"/>
         </ConstraintOverride>
-        <ConstraintOverride
-            android:id="@id/subtitle"
-            android:alpha="0">
+        <Constraint
+            android:id="@+id/subtitle"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="@dimen/control_bar_media_card_subtitle_top_margin"
+            android:layout_marginEnd="@dimen/control_bar_media_card_view_end_margin"
+            android:gravity="center_vertical"
+            android:includeFontPadding="false"
+            android:textColor="@color/car_on_surface_variant"
+            android:textAppearance="@style/TextAppearance.Car.Body.Medium"
+            android:maxLines="1"
+            android:ellipsize="end"
+            android:alpha="0"
+            motion:layout_constraintStart_toStartOf="parent"
+            motion:layout_constraintTop_toTopOf="parent"
+            motion:layout_constraintBottom_toBottomOf="parent">
             <PropertySet
                 motion:visibilityMode="ignore"/>
-        </ConstraintOverride>
+        </Constraint>
         <ConstraintOverride
             android:id="@id/album_title"
             android:alpha="0">
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/controlbar/ControlBarMediaController.java b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/controlbar/ControlBarMediaController.java
index 89bba16add..98fbd2f239 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/controlbar/ControlBarMediaController.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/controlbar/ControlBarMediaController.java
@@ -16,32 +16,38 @@
 
 package com.android.car.portraitlauncher.controlbar;
 
+import static com.android.car.media.common.ui.PlaybackCardControllerUtilities.getFirstCustomActionInSet;
+import static com.android.car.media.common.ui.PlaybackCardControllerUtilities.skipBackStandardActions;
+import static com.android.car.media.common.ui.PlaybackCardControllerUtilities.skipForwardStandardActions;
 import static com.android.car.media.common.ui.PlaybackCardControllerUtilities.updateActionsWithPlaybackState;
 import static com.android.car.media.common.ui.PlaybackCardControllerUtilities.updatePlayButtonWithPlaybackState;
 import static com.android.car.media.common.ui.PlaybackCardControllerUtilities.updateTextViewAndVisibility;
 
 import android.content.Intent;
-import android.content.res.ColorStateList;
 import android.content.res.Resources;
 import android.graphics.drawable.Drawable;
+import android.view.GestureDetector;
+import android.view.MotionEvent;
 import android.view.View;
 import android.view.ViewGroup;
+import android.view.animation.Animation;
+import android.view.animation.AnimationUtils;
 import android.widget.ImageButton;
 
 import androidx.constraintlayout.motion.widget.MotionLayout;
 
+import com.android.car.apps.common.RoundedDrawable;
 import com.android.car.apps.common.util.ViewUtils;
 import com.android.car.carlauncher.homescreen.audio.media.MediaIntentRouter;
 import com.android.car.media.common.MediaItemMetadata;
-import com.android.car.media.common.R;
 import com.android.car.media.common.playback.PlaybackProgress;
 import com.android.car.media.common.playback.PlaybackViewModel;
 import com.android.car.media.common.playback.PlaybackViewModel.PlaybackController;
 import com.android.car.media.common.source.MediaSource;
-import com.android.car.media.common.source.MediaSourceColors;
 import com.android.car.media.common.ui.PlaybackCardController;
 import com.android.car.media.common.ui.PlaybackHistoryController;
 import com.android.car.media.common.ui.PlaybackQueueController;
+import com.android.car.portraitlauncher.R;
 
 import java.util.ArrayList;
 import java.util.List;
@@ -53,6 +59,7 @@ public class ControlBarMediaController extends PlaybackCardController {
 
     private ViewGroup mCustomActionLayout;
     private ViewGroup mCustomActionOverflowLayout;
+    private View mCustomActionOverflowConcealLayout;
     private ImageButton mActionOverflowExitButton;
     private ViewGroup mQueueContainer;
     private ViewGroup mHistoryContainer;
@@ -70,6 +77,9 @@ public class ControlBarMediaController extends PlaybackCardController {
     private int mCustomActionLayoutVisibility;
     private int mCustomActionOverflowLayoutVisibility;
 
+    private Animation mOverflowConcealOpenAnimation;
+    private Animation mOverflowConcealCloseAnimation;
+
     /**
      * Builder for {@link ControlBarMediaController}. Overrides build() method to return
      * ControlBarMediaController rather than base {@link PlaybackCardController}
@@ -87,14 +97,54 @@ public class ControlBarMediaController extends PlaybackCardController {
     public ControlBarMediaController(ControlBarMediaController.Builder builder) {
         super(builder);
 
-        mView.setOnClickListener(view -> {
-            MediaSource mediaSource = mDataModel.getMediaSource().getValue();
-            Intent intent = mediaSource != null ? mediaSource.getIntent() : null;
-            mMediaIntentRouter.handleMediaIntent(intent);
-        });
+        GestureDetector gestureDetector =
+                new GestureDetector(
+                        mView.getContext(),
+                        new GestureDetector.SimpleOnGestureListener() {
+                            private void sendMediaIntent() {
+                                MediaSource mediaSource = mDataModel.getMediaSource().getValue();
+                                Intent intent =
+                                        mediaSource != null ? mediaSource.getIntent() : null;
+                                mMediaIntentRouter.handleMediaIntent(intent);
+                            }
+
+                            @Override
+                            public boolean onDown(MotionEvent event) {
+                                return true;
+                            }
+
+                            @Override
+                            public boolean onSingleTapUp(MotionEvent e) {
+                                sendMediaIntent();
+                                return true;
+                            }
+
+                            @Override
+                            public boolean onFling(
+                                    MotionEvent e1,
+                                    MotionEvent e2,
+                                    float velocityX,
+                                    float velocityY) {
+                                if (velocityY < 0) {
+                                    sendMediaIntent();
+                                }
+                                return true;
+                            }
+                        });
+
+        mView.setOnTouchListener(
+                (v, event) -> {
+                    if (gestureDetector.onTouchEvent(event)) {
+                        return true;
+                    }
+
+                    return v.onTouchEvent(event);
+                });
 
         mCustomActionLayout = mView.findViewById(R.id.custom_action_container);
         mCustomActionOverflowLayout = mView.findViewById(R.id.custom_action_overflow_container);
+        mCustomActionOverflowConcealLayout = mView.findViewById(
+                R.id.custom_action_overflow_conceal_container);
         mActionOverflowExitButton = mView.findViewById(R.id.overflow_exit_button);
         mActionOverflowExitButton.setOnClickListener(view ->
                 handleCustomActionsOverflowButtonClicked(mActionOverflowButton));
@@ -142,6 +192,11 @@ public class ControlBarMediaController extends PlaybackCardController {
             public void onTransitionTrigger(MotionLayout motionLayout, int i, boolean b, float v) {
             }
         });
+
+        mOverflowConcealOpenAnimation = AnimationUtils.loadAnimation(
+                mView.getContext(), R.anim.media_card_overflow_open_animation);
+        mOverflowConcealCloseAnimation = AnimationUtils.loadAnimation(
+                mView.getContext(), R.anim.media_card_overflow_close_animation);
     }
 
     @Override
@@ -174,6 +229,13 @@ public class ControlBarMediaController extends PlaybackCardController {
         }
     }
 
+    @Override
+    protected void updateAlbumCoverWithDrawable(Drawable drawable) {
+        RoundedDrawable roundedDrawable = new RoundedDrawable(drawable, mView.getResources()
+                .getFloat(R.dimen.control_bar_media_card_album_art_drawable_corner_ratio));
+        super.updateAlbumCoverWithDrawable(roundedDrawable);
+    }
+
     @Override
     protected void updateLogoWithDrawable(Drawable drawable) {
         super.updateLogoWithDrawable(drawable);
@@ -208,22 +270,6 @@ public class ControlBarMediaController extends PlaybackCardController {
         }
     }
 
-    // TODO b/336857156: Add disabled state for play/pause button and make sure it reflects here
-    @Override
-    protected void updateViewsWithMediaSourceColors(MediaSourceColors colors) {
-        int defaultColor = mView.getResources().getColor(R.color.car_on_surface, null);
-        ColorStateList accentColor = colors != null ? ColorStateList.valueOf(
-                colors.getAccentColor(defaultColor)) :
-                ColorStateList.valueOf(defaultColor);
-
-        if (mPlayPauseButton != null) {
-            mPlayPauseButton.setBackgroundTintList(accentColor);
-        }
-        if (mSeekBar != null) {
-            mSeekBar.setProgressTintList(accentColor);
-        }
-    }
-
     @Override
     protected void updatePlaybackState(PlaybackViewModel.PlaybackStateWrapper playbackState) {
         boolean hasOverflow = false;
@@ -231,12 +277,22 @@ public class ControlBarMediaController extends PlaybackCardController {
         if (playbackState != null) {
             updatePlayButtonWithPlaybackState(mPlayPauseButton, playbackState, playbackController);
             int count = 0;
-            if (playbackState.isSkipNextEnabled() || playbackState.isSkipNextReserved()) {
+            if ((playbackState.isSkipNextEnabled() || playbackState.isSkipNextReserved())
+                    || (!playbackState.isSkipNextEnabled() && !playbackState.isSkipNextReserved()
+                    && getFirstCustomActionInSet(playbackState.getCustomActions(),
+                    skipForwardStandardActions) != null)) {
                 count++;
             }
-            if (playbackState.isSkipPreviousEnabled() || playbackState.iSkipPreviousReserved()) {
+            if (playbackState.isSkipPreviousEnabled() || playbackState.iSkipPreviousReserved()
+                    || (!playbackState.isSkipPreviousEnabled()
+                    && !playbackState.iSkipPreviousReserved()
+                    && getFirstCustomActionInSet(playbackState.getCustomActions(),
+                    skipBackStandardActions) != null)) {
                 count++;
             }
+            Drawable skipNextDrawableBackground = count == 1 ? mView.getContext()
+                    .getDrawable(R.drawable.pill_button_shape) : mView.getContext()
+                    .getDrawable(R.drawable.right_half_pill_button_shape);
             List<ImageButton> mActionsCopy = new ArrayList<>(mActions);
             if (playbackState.getCustomActions().size() > (MAX_ACTIONS_IN_DEFAULT_LAYOUT - count)) {
                 while (count >= 0) {
@@ -254,8 +310,8 @@ public class ControlBarMediaController extends PlaybackCardController {
                     playbackController, mView.getContext().getDrawable(R.drawable.ic_skip_previous),
                     mView.getContext().getDrawable(R.drawable.ic_skip_next),
                     mView.getContext().getDrawable(R.drawable.left_half_pill_button_shape),
-                    mView.getContext().getDrawable(R.drawable.right_half_pill_button_shape),
-                    /* reserveSkipSlots */ true, /* defaultButtonDrawable */ null);
+                    skipNextDrawableBackground, /* reserveSkipSlots */ true,
+                    /* defaultButtonDrawable */ null);
 
             if (!hasOverflow && mViewModel.getOverflowExpanded()) {
                 handleCustomActionsOverflowButtonClicked(mActionOverflowButton);
@@ -280,9 +336,41 @@ public class ControlBarMediaController extends PlaybackCardController {
     }
 
     private void setOverflowState(boolean isExpanded) {
+
+        Animation anim = isExpanded ? mOverflowConcealOpenAnimation :
+                mOverflowConcealCloseAnimation;
+        anim.setAnimationListener(new Animation.AnimationListener() {
+            @Override
+            public void onAnimationStart(Animation animation) {
+            }
+
+            @Override
+            public void onAnimationEnd(Animation animation) {
+                if (!isExpanded) {
+                    ViewUtils.setVisible(mCustomActionOverflowLayout, false);
+                    ViewUtils.setVisible(mActionOverflowExitButton, false);
+                }
+            }
+
+            @Override
+            public void onAnimationRepeat(Animation animation) {
+            }
+        });
+        mCustomActionOverflowConcealLayout.startAnimation(anim);
+
+        Animation fadeIn = AnimationUtils.loadAnimation(mView.getContext(),
+                R.anim.media_card_overflow_fade_in);
+        Animation fadeOut = AnimationUtils.loadAnimation(mView.getContext(),
+                R.anim.media_card_overflow_fade_out);
+        if (!isExpanded) {
+            mCustomActionLayout.startAnimation(fadeIn);
+            mCustomActionOverflowLayout.startAnimation(fadeOut);
+        } else {
+            mCustomActionOverflowLayout.startAnimation(fadeIn);
+            ViewUtils.setVisible(mCustomActionOverflowLayout, true);
+            ViewUtils.setVisible(mActionOverflowExitButton, true);
+        }
         ViewUtils.setVisible(mCustomActionLayout, !isExpanded);
-        ViewUtils.setVisible(mCustomActionOverflowLayout, isExpanded);
-        ViewUtils.setVisible(mActionOverflowExitButton, isExpanded);
         mCustomActionLayoutVisibility = mCustomActionLayout.getVisibility();
         mCustomActionOverflowLayoutVisibility = mCustomActionOverflowLayout.getVisibility();
     }
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/homeactivities/CarUiPortraitHomeScreen.java b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/homeactivities/CarUiPortraitHomeScreen.java
index ad417c19c6..ab9dae6ad5 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/homeactivities/CarUiPortraitHomeScreen.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/homeactivities/CarUiPortraitHomeScreen.java
@@ -62,6 +62,7 @@ import android.hardware.input.InputManagerGlobal;
 import android.os.Build;
 import android.os.Bundle;
 import android.os.Handler;
+import android.os.Looper;
 import android.os.Message;
 import android.os.RemoteException;
 import android.os.SystemClock;
@@ -149,6 +150,7 @@ import java.util.Set;
  */
 public final class CarUiPortraitHomeScreen extends FragmentActivity {
     public static final String TAG = CarUiPortraitHomeScreen.class.getSimpleName();
+    private static final int DEFAULT_TASKVIEW_INIT_TIMEOUT_MS = 5000;
 
     private static final boolean DBG = Build.IS_DEBUGGABLE;
     /** Identifiers for panels. */
@@ -163,6 +165,7 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
     private static final int INVALID_TASK_ID = -1;
     private final UserEventReceiver mUserEventReceiver = new UserEventReceiver();
     private final Configuration mConfiguration = new Configuration();
+    private final Handler mHandler = new Handler(Looper.getMainLooper());
 
     private int mStatusBarHeight;
     private FrameLayout mContainer;
@@ -195,11 +198,10 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
                 mRootTaskViewPanel.closePanel(createReason(ON_MEDIA_INTENT, intent.getComponent()));
                 return;
             }
-
-            ActivityOptions options = ActivityOptions.makeBasic();
-            options.setLaunchDisplayId(getDisplay().getDisplayId());
-
-            startActivity(intent, options.toBundle());
+            if (intent != null) {
+                ActivityOptions options = ActivityOptions.makeBasic();
+                startActivity(intent, options.toBundle());
+            }
         }
     };
     /**
@@ -232,6 +234,14 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
                 updateObscuredTouchRegion();
             };
 
+    private final Runnable mDefaultTaskViewInitTimeoutRunnable = new Runnable() {
+        @Override
+        public void run() {
+            Log.e(TAG, "TaskView initialization timeout - finishing activity");
+            finish();
+        }
+    };
+
     private ComponentName mUnhandledImmersiveModeRequestComponent;
     private long mUnhandledImmersiveModeRequestTimestamp;
     private boolean mUnhandledImmersiveModeRequest;
@@ -489,9 +499,11 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
     @Override
     protected void onCreate(@Nullable Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
+        logIfDebuggable("onCreate");
 
         if (getApplicationContext().getResources().getConfiguration().orientation
                 == Configuration.ORIENTATION_LANDSCAPE) {
+            logIfDebuggable("On landscape device, use landscape launcher");
             Intent launcherIntent = new Intent(this, CarLauncher.class);
             launcherIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
             startActivity(launcherIntent);
@@ -520,7 +532,6 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
         // Activity is running fullscreen to allow background task to bleed behind status bar
         mNavBarHeight = getResources().getDimensionPixelSize(
                 com.android.internal.R.dimen.navigation_bar_height);
-        logIfDebuggable("Navbar height: " + mNavBarHeight);
         mContainer = findViewById(R.id.container);
         setHomeScreenBottomPadding(mNavBarHeight);
         mContainer.addOnLayoutChangeListener(mHomeScreenLayoutChangeListener);
@@ -554,6 +565,9 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
             return;
         }
 
+        mFullScreenAppArea = findViewById(R.id.fullscreen_container);
+        mBackgroundAppArea = findViewById(R.id.background_app_area);
+
         mCarUiPortraitServiceManager = new CarUiPortraitServiceManager(/* activity= */ this,
                 new IncomingHandler());
         initializeCards();
@@ -562,10 +576,8 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
                 getApplicationContext());
         MediaIntentRouter.getInstance().registerMediaIntentHandler(mMediaIntentHandler);
 
-        if (mTaskViewControllerWrapper == null) {
-            mTaskViewControllerWrapper = new RemoteCarTaskViewControllerWrapperImpl(
-                    /* activity= */ this, this::onTaskViewControllerReady);
-        }
+        mTaskViewControllerWrapper = new RemoteCarTaskViewControllerWrapperImpl(
+                /* activity= */ this, this::onTaskViewControllerReady);
     }
 
     private void onTaskViewControllerReady() {
@@ -660,18 +672,31 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
 
     @Override
     protected void onDestroy() {
-        mTaskViewControllerWrapper.onDestroy();
-        mRootTaskViewPanel.onDestroy();
-        mTaskCategoryManager.onDestroy();
+        logIfDebuggable("onDestroy");
+        if (mTaskViewControllerWrapper != null) {
+            mTaskViewControllerWrapper.onDestroy();
+        }
+        if (mRootTaskViewPanel != null) {
+            mRootTaskViewPanel.onDestroy();
+        }
+        if (mTaskCategoryManager != null) {
+            mTaskCategoryManager.onDestroy();
+        }
+        if (mCarUiPortraitServiceManager != null) {
+            mCarUiPortraitServiceManager.onDestroy();
+        }
         mUserEventReceiver.unregister();
         TaskStackChangeListeners.getInstance().unregisterTaskStackListener(mTaskStackListener);
-        mCarUiPortraitServiceManager.onDestroy();
         super.onDestroy();
     }
 
     @Override
     protected void onResume() {
         super.onResume();
+        mTaskViewControllerWrapper.updateAllowListedActivities(BACKGROUND,
+                mTaskCategoryManager.getBackgroundActivitiesList());
+        mTaskViewControllerWrapper.updateAllowListedActivities(FULLSCREEN,
+                mTaskCategoryManager.getFullScreenActivitiesList());
         // the showEmbeddedTasks will make the task visible which will lead to opening of the panel
         // and that should be skipped for application panel  when the  home intent is sent. Because
         // that leads to CTS failures.
@@ -889,8 +914,6 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
     }
 
     private void setUpBackgroundTaskView() {
-        mBackgroundAppArea = findViewById(R.id.background_app_area);
-
         TaskViewControllerWrapper.TaskViewCallback callback =
                 new TaskViewControllerWrapper.TaskViewCallback() {
                     @Override
@@ -1110,6 +1133,7 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
                     @Override
                     public void onTaskViewInitialized() {
                         logIfDebuggable("Root Task View is ready");
+                        mHandler.removeCallbacks(mDefaultTaskViewInitTimeoutRunnable);
                         mRootTaskViewPanel.setReady(true);
                         onTaskViewReadinessUpdated();
                         initTaskViews();
@@ -1123,12 +1147,13 @@ public final class CarUiPortraitHomeScreen extends FragmentActivity {
                     }
                 };
 
+        mHandler.removeCallbacks(mDefaultTaskViewInitTimeoutRunnable);
+        mHandler.postDelayed(mDefaultTaskViewInitTimeoutRunnable, DEFAULT_TASKVIEW_INIT_TIMEOUT_MS);
         mTaskViewControllerWrapper.createCarDefaultRootTaskView(callback, getDisplayId(),
                 getMainExecutor());
     }
 
     private void setUpFullScreenTaskView() {
-        mFullScreenAppArea = findViewById(R.id.fullscreen_container);
         TaskViewControllerWrapper.TaskViewCallback callback =
                 new TaskViewControllerWrapper.TaskViewCallback() {
                     @Override
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/homeactivities/TaskCategoryManager.java b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/homeactivities/TaskCategoryManager.java
index e9ca594eaf..19b05cffe3 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/homeactivities/TaskCategoryManager.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/homeactivities/TaskCategoryManager.java
@@ -171,7 +171,8 @@ class TaskCategoryManager {
      * the {@code TaskCategoryManager} is ready.
      */
     public boolean isReady() {
-        Intent intent = CarLauncherUtils.getMapsIntent(mContext);
+        // TODO(b/356668072): Change to check map intent once gTOS story is confirmed
+        Intent intent = CarLauncherUtils.getAppsGridIntent();
         return intent.resolveActivity(mContext.getPackageManager()) != null;
     }
 
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/panel/TaskViewPanel.java b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/panel/TaskViewPanel.java
index 97217b0c9a..3682082528 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/panel/TaskViewPanel.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/src/com/android/car/portraitlauncher/panel/TaskViewPanel.java
@@ -590,7 +590,7 @@ public class TaskViewPanel extends RelativeLayout {
     private void updateBounds(Rect bounds) {
         final FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams) getLayoutParams();
         layoutParams.topMargin = bounds.top;
-        layoutParams.rightMargin = bounds.right;
+        layoutParams.leftMargin = bounds.left;
         layoutParams.width = bounds.width();
         layoutParams.height = bounds.height();
         setLayoutParams(layoutParams);
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/tests/Android.bp b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/tests/Android.bp
index 606cba2425..d13f940d75 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/tests/Android.bp
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitLauncher/tests/Android.bp
@@ -27,8 +27,8 @@ android_test {
     resource_dirs: ["res"],
 
     libs: [
-        "android.test.base",
-        "android.test.mock",
+        "android.test.base.stubs.system",
+        "android.test.mock.stubs.system",
     ],
 
     optimize: {
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/proguard.flags b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/proguard.flags
index 787d98ddc2..6bb0ffda26 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/proguard.flags
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/proguard.flags
@@ -1,4 +1,3 @@
 -keep class com.android.car.caruiportrait.common.service.CarUiPortraitService
--keep class com.android.systemui.car.qc.CarUiPortraitProfileSwitcher { *; }
 
 -include ../../../../../../../packages/apps/Car/SystemUI/proguard.flags
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/drawable/fan_speed_seek_bar_background.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/drawable/fan_speed_seek_bar_background.xml
index 7104440da9..ff3d0ced18 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/drawable/fan_speed_seek_bar_background.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/drawable/fan_speed_seek_bar_background.xml
@@ -22,7 +22,7 @@
         </shape>
     </item>
     <item
-        android:gravity="left"
+        android:gravity="start"
         android:width="@dimen/hvac_panel_button_dimen">
         <selector>
             <item android:state_selected="true">
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_bottom_system_bar.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_bottom_system_bar.xml
index b4c4514147..71e4338b3e 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_bottom_system_bar.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_bottom_system_bar.xml
@@ -57,8 +57,7 @@
                 systemui:intent="intent:#Intent;action=com.android.car.carlauncher.ACTION_APP_GRID;package=com.android.car.portraitlauncher;launchFlags=0x24000000;end"
                 systemui:clearBackStack="false"/>
 
-            <!-- TODO(b/255887799): Use AssistantButton instead of CarUiAssistantButton once is fixed.     -->
-            <com.android.systemui.car.systembar.CarUiAssistantButton
+            <com.android.systemui.car.systembar.AssistantButton
                 android:id="@+id/assist"
                 style="@style/SystemBarButton"
                 systemui:icon="@drawable/car_ic_mic"
@@ -74,7 +73,7 @@
                 systemui:highlightWhenSelected="false"
                 systemui:clearBackStack="false"
                 systemui:intent="intent:#Intent;component=com.android.car.notification/.CarNotificationCenterActivity;launchFlags=0x24000000;end"
-                systemui:longIntent="intent:#Intent;action=com.android.car.bugreport.action.START_AUDIO_FIRST;component=com.android.car.bugreport/.BugReportActivity;end"/>
+                systemui:longIntent="intent:#Intent;action=com.android.car.bugreport.action.START_BUG_REPORT;end"/>
 
             <com.android.systemui.car.systembar.CarSystemBarButton
                 android:id="@+id/hvac"
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_bottom_system_bar_dock.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_bottom_system_bar_dock.xml
index 5fda563dc0..799ecc86cb 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_bottom_system_bar_dock.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_bottom_system_bar_dock.xml
@@ -63,8 +63,7 @@
                 android:layout_height="wrap_content" />
         </com.android.systemui.car.systembar.element.layout.CarSystemBarFrameLayout>
 
-        <!-- TODO(b/255887799): Use AssistantButton instead of CarUiAssistantButton once is fixed.     -->
-        <com.android.systemui.car.systembar.CarUiAssistantButton
+        <com.android.systemui.car.systembar.AssistantButton
             android:id="@+id/assist"
             style="@style/SystemBarButtonWithDock"
             systemui:icon="@drawable/car_ic_mic"
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar.xml
index ae2173e8c2..780da425e7 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar.xml
@@ -29,12 +29,12 @@
         android:layout_height="match_parent">
 
         <include layout="@layout/qc_status_icons_horizontal"
-            android:layout_width="wrap_content"
-            android:layout_height="match_parent"
-            android:layout_marginStart="@dimen/car_quick_controls_entry_points_start_margin"
-            android:layout_centerVertical="true"
-            android:layout_toStartOf="@+id/clock"
-            android:layout_alignParentStart="true" />
+                 android:layout_width="wrap_content"
+                 android:layout_height="match_parent"
+                 android:layout_marginStart="@dimen/car_quick_controls_entry_points_start_margin"
+                 android:layout_centerVertical="true"
+                 android:layout_toStartOf="@+id/clock"
+                 android:layout_alignParentStart="true"/>
 
         <com.android.systemui.statusbar.policy.Clock
             android:id="@+id/clock"
@@ -71,7 +71,7 @@
                      android:layout_width="@dimen/top_system_bar_icon_size"
                      android:layout_height="@dimen/top_system_bar_icon_size"
                      android:layout_marginStart="@dimen/top_system_bar_icon_horizontal_margin"
-                     android:layout_marginEnd="@dimen/top_system_bar_icon_horizontal_margin"            />
+                     android:layout_marginEnd="@dimen/top_system_bar_icon_horizontal_margin"/>
 
             <com.android.systemui.car.statusicon.StatusIconView
                 android:id="@+id/read_only_sensor_text"
@@ -81,20 +81,32 @@
                 android:layout_gravity="center"
                 systemui:controller="com.android.systemui.car.statusicon.ui.StatusBarSensorInfoController"/>
 
-            <com.android.systemui.car.systembar.CarTopSystemBarButton
-                android:id="@+id/user_name"
-                style="@style/CarTopSystemBarButton"
-                android:background="@drawable/status_icon_background"
-                systemui:intent="intent:#Intent;component=com.android.car.settings/.profiles.ProfileSwitcherActivity;launchFlags=0x24000000;end" >
-                <ImageView
-                    android:id="@+id/user_avatar"
-                    android:layout_gravity="center"
-                    android:layout_width="@dimen/top_system_bar_icon_drawing_size"
-                    android:layout_height="@dimen/top_system_bar_icon_drawing_size"
-                    android:src="@drawable/car_ic_user_icon"
-                    android:tint="@color/system_bar_icon_color_with_selection"
-                />
-            </com.android.systemui.car.systembar.CarTopSystemBarButton>
+            <FrameLayout
+                android:id="@+id/user_name_container"
+                android:layout_width="wrap_content"
+                android:layout_height="@dimen/top_system_bar_icon_size"
+                android:gravity="center">
+                <com.android.systemui.car.systembar.CarSystemBarPanelButtonView
+                    android:id="@+id/user_name"
+                    style="@style/CarTopSystemBarButton"
+                    android:background="@drawable/status_icon_background"
+                    systemui:controller="com.android.systemui.car.systembar.UserNamePanelButtonViewController"
+                    systemui:panelLayoutRes="@layout/qc_profile_switcher"
+                    systemui:panelWidthRes="@dimen/car_profile_quick_controls_panel_width"
+                    systemui:gravity="top|end"
+                    systemui:disabledWhileUnprovisioned="true"
+                    systemui:disabledWhileDriving="@bool/config_profile_panel_disabled_while_driving"
+                    systemui:systemBarDisable2Flags="quickSettings">
+                    <com.android.systemui.car.systembar.element.layout.CarSystemBarImageView
+                        android:id="@+id/user_avatar"
+                        android:layout_gravity="center"
+                        android:layout_width="match_parent"
+                        android:layout_height="match_parent"
+                        android:layout_margin="@dimen/car_padding_0"
+                        systemui:controller="com.android.systemui.car.systembar.UserNameImageViewController"
+                        />
+                </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
+            </FrameLayout>
         </LinearLayout>
     </RelativeLayout>
 </com.android.systemui.car.systembar.CarSystemBarView>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar_dock.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar_dock.xml
index 5dfdc902e5..b5ee50c60f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar_dock.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar_dock.xml
@@ -34,7 +34,7 @@
             android:layout_marginStart="@dimen/car_quick_controls_entry_points_start_margin"
             android:layout_centerVertical="true"
             android:layout_toStartOf="@+id/clock"
-            android:layout_alignParentStart="true" />
+            android:layout_alignParentStart="true"/>
 
         <com.android.systemui.statusbar.policy.Clock
             android:id="@+id/clock"
@@ -49,7 +49,7 @@
             android:elevation="@dimen/clock_elevation"
             android:singleLine="true"
             style="@style/TextAppearance.TopSystemBar.Text"
-            systemui:amPmStyle="normal" />
+            systemui:amPmStyle="normal"/>
 
         <LinearLayout
             android:layout_width="wrap_content"
@@ -65,14 +65,14 @@
                 android:layout_width="@dimen/top_system_bar_icon_size"
                 android:layout_height="@dimen/top_system_bar_icon_size"
                 android:layout_marginStart="@dimen/top_system_bar_icon_horizontal_margin"
-                android:layout_marginEnd="@dimen/top_system_bar_icon_horizontal_margin" />
+                android:layout_marginEnd="@dimen/top_system_bar_icon_horizontal_margin"/>
 
             <include
                 layout="@layout/mic_privacy_chip"
                 android:layout_width="@dimen/top_system_bar_icon_size"
                 android:layout_height="@dimen/top_system_bar_icon_size"
                 android:layout_marginStart="@dimen/top_system_bar_icon_horizontal_margin"
-                android:layout_marginEnd="@dimen/top_system_bar_icon_horizontal_margin" />
+                android:layout_marginEnd="@dimen/top_system_bar_icon_horizontal_margin"/>
 
             <com.android.systemui.car.statusicon.StatusIconView
                 android:id="@+id/read_only_sensor_text"
@@ -80,7 +80,7 @@
                 android:layout_height="match_parent"
                 android:layout_marginHorizontal="@dimen/top_system_bar_icon_horizontal_margin"
                 android:layout_gravity="center"
-                systemui:controller="com.android.systemui.car.statusicon.ui.StatusBarSensorInfoController" />
+                systemui:controller="com.android.systemui.car.statusicon.ui.StatusBarSensorInfoController"/>
 
             <com.android.systemui.car.systembar.CarUiPortraitNotificationButton
                 android:id="@+id/standalone_notifications"
@@ -93,7 +93,7 @@
                 systemui:highlightWhenSelected="true"
                 systemui:clearBackStack="false"
                 systemui:intent="intent:#Intent;component=com.android.car.notification/.CarNotificationCenterActivity;launchFlags=0x24000000;end"
-                systemui:longIntent="intent:#Intent;action=com.android.car.bugreport.action.START_AUDIO_FIRST;component=com.android.car.bugreport/.BugReportActivity;end">
+                systemui:longIntent="intent:#Intent;action=com.android.car.bugreport.action.START_BUG_REPORT;end">
 
                 <LinearLayout
                     android:layout_width="match_parent"
@@ -107,28 +107,38 @@
                         android:layout_height="@dimen/top_system_bar_icon_drawing_size"
                         android:layout_gravity="center"
                         android:src="@drawable/car_ic_notification"
-                        android:tint="@color/system_bar_icon_color_with_selection" />
+                        android:tint="@color/system_bar_icon_color_with_selection"/>
 
                 </LinearLayout>
 
             </com.android.systemui.car.systembar.CarUiPortraitNotificationButton>
 
-            <com.android.systemui.car.systembar.CarTopSystemBarButton
-                android:id="@+id/user_name"
-                style="@style/CarTopSystemBarButton"
-                android:background="@drawable/status_icon_background"
-                systemui:intent="intent:#Intent;component=com.android.car.settings/.profiles.ProfileSwitcherActivity;launchFlags=0x24000000;end">
-
-                <ImageView
-                    android:id="@+id/user_avatar"
-                    android:layout_gravity="center"
-                    android:layout_width="@dimen/top_system_bar_icon_drawing_size"
-                    android:layout_height="@dimen/top_system_bar_icon_drawing_size"
-                    android:src="@drawable/car_ic_user_icon"
-                    android:tint="@color/system_bar_icon_color_with_selection" />
-
-            </com.android.systemui.car.systembar.CarTopSystemBarButton>
-
+            <FrameLayout
+                android:id="@+id/user_name_container"
+                android:layout_width="wrap_content"
+                android:layout_height="@dimen/top_system_bar_icon_size"
+                android:gravity="center">
+                <com.android.systemui.car.systembar.CarSystemBarPanelButtonView
+                    android:id="@+id/user_name"
+                    style="@style/CarTopSystemBarButton"
+                    android:background="@drawable/status_icon_background"
+                    systemui:controller="com.android.systemui.car.systembar.UserNamePanelButtonViewController"
+                    systemui:panelLayoutRes="@layout/qc_profile_switcher"
+                    systemui:panelWidthRes="@dimen/car_profile_quick_controls_panel_width"
+                    systemui:gravity="top|end"
+                    systemui:disabledWhileUnprovisioned="true"
+                    systemui:disabledWhileDriving="@bool/config_profile_panel_disabled_while_driving"
+                    systemui:systemBarDisable2Flags="quickSettings">
+                    <com.android.systemui.car.systembar.element.layout.CarSystemBarImageView
+                        android:id="@+id/user_avatar"
+                        android:layout_gravity="center"
+                        android:layout_width="match_parent"
+                        android:layout_height="match_parent"
+                        android:layout_margin="@dimen/car_padding_0"
+                        systemui:controller="com.android.systemui.car.systembar.UserNameImageViewController"
+                        />
+                </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
+            </FrameLayout>
         </LinearLayout>
 
     </RelativeLayout>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar_unprovisioned.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar_unprovisioned.xml
index 5db5a47863..7060b1602a 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar_unprovisioned.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/car_top_system_bar_unprovisioned.xml
@@ -29,12 +29,12 @@
         android:layout_height="match_parent">
 
         <include layout="@layout/qc_status_icons_horizontal"
-            android:layout_width="wrap_content"
-            android:layout_height="match_parent"
-            android:layout_marginStart="@dimen/car_quick_controls_entry_points_start_margin"
-            android:layout_centerVertical="true"
-            android:layout_toStartOf="@+id/clock"
-            android:layout_alignParentStart="true" />
+                 android:layout_width="wrap_content"
+                 android:layout_height="match_parent"
+                 android:layout_marginStart="@dimen/car_quick_controls_entry_points_start_margin"
+                 android:layout_centerVertical="true"
+                 android:layout_toStartOf="@+id/clock"
+                 android:layout_alignParentStart="true"/>
 
         <com.android.systemui.statusbar.policy.Clock
             android:id="@+id/clock"
@@ -71,7 +71,7 @@
                      android:layout_width="@dimen/top_system_bar_icon_size"
                      android:layout_height="@dimen/top_system_bar_icon_size"
                      android:layout_marginStart="@dimen/top_system_bar_icon_horizontal_margin"
-                     android:layout_marginEnd="@dimen/top_system_bar_icon_horizontal_margin" />
+                     android:layout_marginEnd="@dimen/top_system_bar_icon_horizontal_margin"/>
 
             <com.android.systemui.car.statusicon.StatusIconView
                 android:id="@+id/read_only_sensor_text"
@@ -81,19 +81,32 @@
                 android:layout_gravity="center"
                 systemui:controller="com.android.systemui.car.statusicon.ui.StatusBarSensorInfoController"/>
 
-            <com.android.systemui.car.systembar.CarTopSystemBarButton
-                android:id="@+id/user_name"
-                style="@style/CarTopSystemBarButton"
-                android:background="@drawable/status_icon_background"
-                systemui:intent="intent:#Intent;component=com.android.car.settings/.profiles.ProfileSwitcherActivity;launchFlags=0x24000000;end" >
-                <ImageView
-                    android:id="@+id/user_avatar"
-                    android:layout_gravity="center"
-                    android:layout_width="@dimen/top_system_bar_icon_drawing_size"
-                    android:layout_height="@dimen/top_system_bar_icon_drawing_size"
-                    android:src="@drawable/car_ic_user_icon"
-                />
-            </com.android.systemui.car.systembar.CarTopSystemBarButton>
+            <FrameLayout
+                android:id="@+id/user_name_container"
+                android:layout_width="wrap_content"
+                android:layout_height="@dimen/top_system_bar_icon_size"
+                android:gravity="center">
+                <com.android.systemui.car.systembar.CarSystemBarPanelButtonView
+                    android:id="@+id/user_name"
+                    style="@style/CarTopSystemBarButton"
+                    android:background="@drawable/status_icon_background"
+                    systemui:controller="com.android.systemui.car.systembar.UserNamePanelButtonViewController"
+                    systemui:panelLayoutRes="@layout/qc_profile_switcher"
+                    systemui:panelWidthRes="@dimen/car_profile_quick_controls_panel_width"
+                    systemui:gravity="top|end"
+                    systemui:disabledWhileUnprovisioned="true"
+                    systemui:disabledWhileDriving="@bool/config_profile_panel_disabled_while_driving"
+                    systemui:systemBarDisable2Flags="quickSettings">
+                    <com.android.systemui.car.systembar.element.layout.CarSystemBarImageView
+                        android:id="@+id/user_avatar"
+                        android:layout_gravity="center"
+                        android:layout_width="match_parent"
+                        android:layout_height="match_parent"
+                        android:layout_margin="@dimen/car_padding_0"
+                        systemui:controller="com.android.systemui.car.systembar.UserNameImageViewController"
+                        />
+                </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
+            </FrameLayout>
         </LinearLayout>
     </RelativeLayout>
 </com.android.systemui.car.systembar.CarSystemBarView>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/qc_profile_switcher.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/qc_profile_switcher.xml
index b47c0d63e0..1116e9bb5f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/qc_profile_switcher.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/qc_profile_switcher.xml
@@ -43,7 +43,7 @@
                     android:layout_width="match_parent"
                     android:layout_height="wrap_content"
                     android:gravity="center"
-                    app:localQCProvider="com.android.systemui.car.qc.CarUiPortraitProfileSwitcher"/>
+                    app:localQCProvider="com.android.systemui.car.qc.ProfileSwitcher"/>
             </ScrollView>
             <com.android.systemui.car.qc.QCFooterButton
                 android:id="@+id/qc_profile_footer_button"
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/qc_status_icons_horizontal.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/qc_status_icons_horizontal.xml
index f693aaee93..ff323acc2c 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/qc_status_icons_horizontal.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/layout/qc_status_icons_horizontal.xml
@@ -45,30 +45,62 @@
         systemui:panelLayoutRes="@layout/qc_connectivity_panel"
         systemui:disabledWhileUnprovisioned="true"
         systemui:systemBarDisable2Flags="quickSettings">
-        <com.android.systemui.car.statusicon.StatusIconView
-            android:id="@+id/connectivity_status_icon"
+        <FrameLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent">
+            <com.android.systemui.car.statusicon.StatusIconView
+                android:id="@+id/connectivity_status_icon"
+                android:layout_width="@dimen/top_system_bar_qc_icon_drawing_size"
+                android:layout_height="@dimen/top_system_bar_qc_icon_drawing_size"
+                android:layout_gravity="center"
+                android:tint="@color/car_status_icon_color"
+                android:duplicateParentState="true"
+                systemui:controller="com.android.systemui.car.statusicon.ui.SignalStatusIconController"/>
+            <com.android.systemui.car.systembar.element.layout.CarSystemBarImageView
+                android:id="@+id/qc_icon_button_unseen_icon"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_gravity="center"
+                android:src="@drawable/car_qc_icon_button_unseen_indicator"
+                android:scaleType="fitCenter"
+                android:clickable="false"
+                android:visibility="gone"
+                systemui:controller="com.android.systemui.car.systembar.DataSubscriptionUnseenIconController"/>
+        </FrameLayout>
+    </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
+    <com.android.systemui.car.systembar.CarSystemBarPanelButtonView
+        android:id="@+id/display_panel_button"
+        android:orientation="horizontal"
+        android:gravity="center"
+        style="@style/TopBarButton"
+        systemui:panelLayoutRes="@layout/qc_display_panel"
+        systemui:disabledWhileUnprovisioned="true"
+        systemui:systemBarDisable2Flags="quickSettings">
+        <ImageView
+            android:id="@+id/display_status_icon"
             android:layout_width="@dimen/top_system_bar_qc_icon_drawing_size"
             android:layout_height="@dimen/top_system_bar_qc_icon_drawing_size"
             android:layout_gravity="center"
             android:tint="@color/car_status_icon_color"
             android:duplicateParentState="true"
-            systemui:controller="com.android.systemui.car.statusicon.ui.SignalStatusIconController"/>
+            android:src="@drawable/car_ic_brightness"
+            android:contentDescription="@string/status_icon_display_status"/>
     </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
     <com.android.systemui.car.systembar.CarSystemBarPanelButtonView
-        android:id="@+id/display_panel_button"
+        android:id="@+id/volume_panel_button"
         android:orientation="horizontal"
         android:gravity="center"
         style="@style/TopBarButton"
-        systemui:panelLayoutRes="@layout/qc_display_panel"
+        systemui:panelLayoutRes="@layout/qc_volume_panel"
         systemui:disabledWhileUnprovisioned="true"
         systemui:systemBarDisable2Flags="quickSettings">
         <com.android.systemui.car.statusicon.StatusIconView
-            android:id="@+id/display_status_icon"
+            android:id="@+id/volume_status_icon"
             android:layout_width="@dimen/top_system_bar_qc_icon_drawing_size"
             android:layout_height="@dimen/top_system_bar_qc_icon_drawing_size"
             android:layout_gravity="center"
             android:tint="@color/car_status_icon_color"
             android:duplicateParentState="true"
-            systemui:controller="com.android.systemui.car.statusicon.ui.DisplayStatusIconController"/>
+            systemui:controller="com.android.systemui.car.statusicon.ui.MediaVolumeStatusIconController"/>
     </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
 </LinearLayout>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-af/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-af/strings.xml
index e72561375f..69ac7dc7a0 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-af/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-af/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"NVT"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Wag asseblief vir stelsel om te laai"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Huidige profiel"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Gaan voort"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Gemakkontroles"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-am/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-am/strings.xml
index cf70c58960..da4aec6255 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-am/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-am/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"    "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">""</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ar/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ar/strings.xml
index 744b190fd0..6e50ab6124 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ar/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ar/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"      ."</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"  "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"  Android Automotive (AAOS)"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"    "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-as/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-as/strings.xml
index 9a14de89ea..b723c8db16 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-as/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-as/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">" ,     "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-az/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-az/strings.xml
index f668bd26e6..234a8ec7ac 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-az/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-az/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Sistemin yklnmsini gzlyin"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Cari profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Davam edin"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Komfort nizamlayclar"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-b+sr+Latn/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-b+sr+Latn/strings.xml
index 2cb615f25f..bab9f248a9 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-b+sr+Latn/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-b+sr+Latn/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Ne vai"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Saekajte da se sistem uita"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Aktuelni profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Nastavi"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Kontrole reima Udobno"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-be/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-be/strings.xml
index d9c4659569..4608567880 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-be/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-be/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"  "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bg/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bg/strings.xml
index 22e958bba9..3f72c22b3f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bg/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bg/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"."</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">",    "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" . "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"    "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bn/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bn/strings.xml
index ef043760ef..0f733e7bed 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bn/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bn/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"     "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bs/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bs/strings.xml
index b5421e70cf..9ee761f7dd 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bs/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-bs/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Nije primjenjivo"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Priakajte dok se sistem ne uita"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Trenutni profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Nastavi"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Ugodne kontrole"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ca/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ca/strings.xml
index ea29e0d3c4..620884464d 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ca/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ca/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Espera fins que es carregui el sistema"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Perfil actual"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continua"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Controls de confort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-cs/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-cs/strings.xml
index 22dc3b3231..13464c759a 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-cs/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-cs/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Vykejte na naten systmu"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Aktuln profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Pokraovat"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Ovldn reimu Komfort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-da/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-da/strings.xml
index e26a4512f1..14e84cf6ba 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-da/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-da/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Ikke tilgngelig"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Vent p, at systemet indlses"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Aktuel profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Fortst"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Komfort-indstillinger"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-de/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-de/strings.xml
index ec394c5fa1..93246299c6 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-de/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-de/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Bitte warte, bis das System bereit ist"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Aktuelles Profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Weiter"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Komforteinstellungen"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-el/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-el/strings.xml
index 093773922d..841dfc4abc 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-el/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-el/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"/"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"      "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rAU/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rAU/strings.xml
index bfedd8697e..1cdae09342 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rAU/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rAU/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Please wait for system to load"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Current profile"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continue"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Comfort controls"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rCA/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rCA/strings.xml
index bfedd8697e..1cdae09342 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rCA/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rCA/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Please wait for system to load"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Current profile"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continue"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Comfort controls"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rGB/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rGB/strings.xml
index bfedd8697e..1cdae09342 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rGB/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rGB/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Please wait for system to load"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Current profile"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continue"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Comfort controls"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rIN/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rIN/strings.xml
index bfedd8697e..1cdae09342 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rIN/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rIN/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Please wait for system to load"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Current profile"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continue"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Comfort controls"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rXC/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rXC/strings.xml
index cc64c3b36b..9700cd7fda 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rXC/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-en-rXC/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Please wait for system to load"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Current profile"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continue"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Comfort controls"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-es-rUS/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-es-rUS/strings.xml
index 7c93778269..5698049b63 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-es-rUS/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-es-rUS/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Espera a que se cargue el sistema"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Perfil actual"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continuar"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Controles de comodidad"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-es/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-es/strings.xml
index d2a6556969..9b8974766c 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-es/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-es/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Espera a que se cargue el sistema"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Perfil actual"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continuar"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Controles de confort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-et/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-et/strings.xml
index cf88df6b19..f38aeff028 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-et/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-et/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Oodake, kuni ssteem laaditakse"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Praegune profiil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Jtka"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Reiimi Mugav juhtelemendid"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-eu/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-eu/strings.xml
index 4e8c78c3e5..4b87d66665 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-eu/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-eu/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"E.a."</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Itxaron sistema kargatu arte"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Profil hau"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Egin aurrera"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Erosotasun modua kontrolatzeko aukerak"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fa/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fa/strings.xml
index df026ffe0d..c8ef7c508b 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fa/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fa/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"      "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fi/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fi/strings.xml
index 75490ece05..e8fcd9e177 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fi/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fi/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Odota, ett jrjestelm latautuu"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Nykyinen profiili"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Jatka"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Mukavuusasetukset"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fr-rCA/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fr-rCA/strings.xml
index fc4c0741a8..994400e6f7 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fr-rCA/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fr-rCA/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"s.o."</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Veuillez patienter pendant le chargement du systme"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Profil actuel"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"SEAA"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continuer"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Commandes de Confort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fr/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fr/strings.xml
index e0618c114f..7a2338bb7b 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fr/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-fr/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Veuillez patienter pendant le chargement du systme"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Profil actuel"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continuer"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Commandes de confort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-gl/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-gl/strings.xml
index b63d8b6d66..c51c0993fd 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-gl/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-gl/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/D"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Espera a que cargue o sistema"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Perfil actual"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continuar"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Controis de confort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-gu/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-gu/strings.xml
index 551f0a1d94..06dd74a733 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-gu/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-gu/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"        "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"   "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hi/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hi/strings.xml
index 186816963c..e25146a33d 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hi/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hi/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"       "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">""</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"    "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hr/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hr/strings.xml
index 302cb913a7..f66062af8b 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hr/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hr/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Neprimj."</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Priekajte da se sustav uita"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Trenutani profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"OS Android za vozila (AAOS)"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Nastavi"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Kontrole za ugodnost"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hu/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hu/strings.xml
index cb2eb7cbd3..68b7ddccfb 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hu/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hu/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Vrja meg, amg a rendszer befejezi a betltst"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Aktulis profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Tovbb"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Knyelmes hmrsklet belltsa"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hy/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hy/strings.xml
index 76f5ccd41f..e40245df9f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hy/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-hy/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">",   "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-in/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-in/strings.xml
index f814ecde93..c0b3f7fbd0 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-in/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-in/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"T/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Harap tunggu sampai sistem dimuat"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Profil saat ini"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Lanjutkan"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Kontrol kenyamanan"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-is/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-is/strings.xml
index 97d8a626a4..2395748b92 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-is/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-is/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" ekki vi"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Bddu eftir a kerfi hlaist"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Nverandi prfll"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Halda fram"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"gindastillingar"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-it/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-it/strings.xml
index 218b467d91..e3d973110e 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-it/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-it/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Attendi il caricamento del sistema"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Profilo corrente"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continua"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Controlli Comfort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-iw/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-iw/strings.xml
index 7e35648135..0c311c5a6f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-iw/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-iw/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"    "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ja/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ja/strings.xml
index 88e429fcdd..ccecd8f414 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ja/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ja/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">""</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">""</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">""</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ka/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ka/strings.xml
index a78fdaee64..e69e3ea99d 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ka/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ka/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">",   "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-kk/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-kk/strings.xml
index 5817289d25..c492477903 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-kk/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-kk/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"   ."</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"\"\"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-km/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-km/strings.xml
index a736c2c133..79e6e7e71c 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-km/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-km/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">""</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">""</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">""</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-kn/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-kn/strings.xml
index d59b69f49a..8b19a1e42d 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-kn/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-kn/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"   "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ko/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ko/strings.xml
index c458b829c8..11c2c4b79a 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ko/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ko/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"  "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"     ."</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ky/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ky/strings.xml
index 605b203439..0abbcd732e 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ky/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ky/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"   "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"   "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lo/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lo/strings.xml
index ed94cb0a72..1edb4fcb15 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lo/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lo/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">""</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">""</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">""</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lt/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lt/strings.xml
index 3cf973407f..6572067bd7 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lt/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lt/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Netaikoma"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Palaukite, kol sistema bus kelta"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Dabartinis profilis"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Tsti"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Komforto valdikliai"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lv/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lv/strings.xml
index 0c9e9b7656..4bb58b3949 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lv/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-lv/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Neattiecas"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Ldzu, uzgaidiet, ldz sistma tiks ieldta"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Pareizjais profils"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Turpint"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Komforta rema vadklas"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mk/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mk/strings.xml
index 5d559fab06..c3a2264f8f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mk/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mk/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"    "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ml/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ml/strings.xml
index 7a9d28dc96..e8d984efc9 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ml/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ml/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"    "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mn/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mn/strings.xml
index 8dde7f6fe6..e2dfa7793f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mn/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mn/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"   "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"   "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mr/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mr/strings.xml
index d6b37286e0..fc4c085efc 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mr/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-mr/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"     "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"  "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ms/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ms/strings.xml
index ef001994db..62f7387b3c 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ms/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ms/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"T/B"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Sila tunggu sistem dimuatkan"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Profil semasa"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Teruskan"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Kawalan keselesaan"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-my/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-my/strings.xml
index 173903d025..ba8e6e9294 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-my/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-my/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">" "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">""</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-nb/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-nb/strings.xml
index 148985a837..a2a6c099f5 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-nb/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-nb/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"I/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Vent til systemet er lastet inn"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Nvrende profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Fortsett"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Komfort-kontroller"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ne/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ne/strings.xml
index 4fac8e8402..cad1f0e7b9 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ne/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ne/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"   "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-nl/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-nl/strings.xml
index c644a1bac9..163b608c30 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-nl/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-nl/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N.v.t."</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Wacht totdat het systeem is geladen"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Huidig profiel"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Doorgaan"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Comfortregeling"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-or/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-or/strings.xml
index 2f14e7cf41..ad5307adb4 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-or/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-or/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"      "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"   "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pa/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pa/strings.xml
index d928e2df22..abe77b450b 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pa/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pa/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"        "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pl/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pl/strings.xml
index fb9a6ed5f6..ae1a7b51fa 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pl/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pl/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Nd."</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Poczekaj na wczytanie systemu"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Biecy profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Dalej"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Opcje komfortu jazdy"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pt-rPT/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pt-rPT/strings.xml
index 810ddd4c5f..dacdfabe61 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pt-rPT/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pt-rPT/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Aguarde pelo carregamento do sistema"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Perfil atual"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continuar"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Controlos de Conforto"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pt/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pt/strings.xml
index b7816148dd..f41d6efc42 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pt/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-pt/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Aguarde o carregamento do sistema"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Perfil atual"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continuar"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Controles do modo Confortvel"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ro/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ro/strings.xml
index db886e9e85..b0489a6f0f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ro/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ro/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Nu e cazul"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Ateapt s se ncarce sistemul"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Profilul actual"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Continu"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Comenzi pentru Confort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ru/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ru/strings.xml
index ff20b279fc..8d8238bd7a 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ru/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ru/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"/"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"  "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-si/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-si/strings.xml
index 7a5d31f4b4..d5b7c1f73a 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-si/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-si/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"/"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"     "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sk/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sk/strings.xml
index 0d4bc24ada..f501f4bc64 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sk/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sk/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"-"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Pokajte, km sa systm nata"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Aktulny profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"OSAA"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Pokraova"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Ovldanie pohodlia"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sl/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sl/strings.xml
index b0186a6dd2..2af5884c85 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sl/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sl/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"/"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Poakajte, da se sistem naloi"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Trenutni profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Nadaljuj"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Kontrolniki za nain Udobje"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sq/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sq/strings.xml
index 9806d7be51..a7ba8b938a 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sq/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sq/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Nuk ka"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Prit q sistemi t ngarkohet"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Profili aktual"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Vazhdo"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Kontrollet e komoditetit"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sr/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sr/strings.xml
index 16b56b881f..3d56f667bf 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sr/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sr/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">" "</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"    "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sv/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sv/strings.xml
index 210fad6419..592136baa8 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sv/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sv/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Vnta medan systemet lses in"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Aktuell profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Fortstt"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Komfortinstllningar"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sw/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sw/strings.xml
index 6d1411560f..8a669e1687 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sw/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-sw/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Haitumiki"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Tafadhali subiri mfumo upakie"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Wasifu wa sasa"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Endelea"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Vidhibiti vya Starehe"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ta/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ta/strings.xml
index bce5e09208..c4eaaf591e 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ta/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ta/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"   "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">" "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-te/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-te/strings.xml
index 15173e2f03..444e4302f9 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-te/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-te/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"      "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"  "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-th/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-th/strings.xml
index cabb2c10c7..db9c1ba2cf 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-th/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-th/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">""</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">""</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">""</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-tl/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-tl/strings.xml
index 5baa1850db..65a08e4c7b 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-tl/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-tl/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Pakihintay na mag-load ang system"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Kasalukuyang profile"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Magpatuloy"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Mga kontrol sa Comfort"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-tr/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-tr/strings.xml
index 5f9c2587a1..7c7259c953 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-tr/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-tr/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Yok"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Ltfen sistemin yklenmesini bekleyin"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Geerli profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Devam"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Rahatlk denetimleri"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-uk/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-uk/strings.xml
index 3588147ead..c66f96c78d 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-uk/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-uk/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"/"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">",   "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"   \"\""</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ur/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ur/strings.xml
index 06a382964c..997e5002a3 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ur/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-ur/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"N/A"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"        "</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">" "</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">" "</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"   "</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-uz/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-uz/strings.xml
index dd8961b958..038acb07cc 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-uz/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-uz/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"--"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Tizim yuklanishini kuting"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Joriy profil"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Davom etish"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Komfort boshqaruvlar"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-vi/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-vi/strings.xml
index c16fb5f948..127e52bb42 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-vi/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-vi/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Khng c"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Vui lng ch h thng ti"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"H s hin ti"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Tip tc"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Ci t ch  Thoi mi"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rCN/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rCN/strings.xml
index 82dc26d0eb..ad5b681564 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rCN/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rCN/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">""</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">""</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">""</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rHK/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rHK/strings.xml
index a82bf051eb..3b3b9a6f11 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rHK/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rHK/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">""</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">""</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">""</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rTW/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rTW/strings.xml
index 8ba0c666ce..945f17e340 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rTW/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zh-rTW/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">""</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">""</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">""</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">""</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">""</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zu/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zu/strings.xml
index 09bfbe668f..c414a3e864 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zu/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values-zu/strings.xml
@@ -19,7 +19,6 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="default_sensor_string" msgid="3994996854548513870">"Akusebenzi"</string>
     <string name="task_view_not_ready_message" msgid="3019570837236183122">"Sicela ulinde ukuthi isistimu ilayishe"</string>
-    <string name="current_profile_subtitle" msgid="2466874755719023023">"Iphrofayela yamanje"</string>
     <string name="loading_welcome_message" msgid="2351582619179505398">"I-AAOS"</string>
     <string name="loading_action_button_text" msgid="1296096984805774507">"Qhubeka"</string>
     <string name="hvac_panel_header" msgid="1299061170810305529">"Izilawuli zokunethezeka"</string>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/colors.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/colors.xml
index 140041db78..94784faff1 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/colors.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/colors.xml
@@ -95,4 +95,7 @@
 
     <!-- Biometrics -->
     <color name="biometric_background_color">@color/car_surface</color>
+
+    <color name="divider_color">@color/car_outline</color>
+    <color name="qc_chevron_color">@color/car_status_icon_color</color>
 </resources>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/config.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/config.xml
index a538006de1..6bb31955d3 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/config.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/config.xml
@@ -28,7 +28,7 @@
     <!-- Car System UI's OverlayViewsMediator.
          Whenever a new class is added, make sure to also add that class to OverlayWindowModule. -->
     <string-array name="config_carSystemUIOverlayViewsMediators" translatable="false">
-        <item>com.android.systemui.car.hvac.AutoDismissHvacPanelOverlayViewMediator</item>
+        <item>com.android.systemui.car.hvac.HvacPanelOverlayViewMediator</item>
         <item>com.android.systemui.car.keyguard.CarKeyguardOverlayViewMediator</item>
         <item>com.android.systemui.car.userswitcher.FullscreenUserSwitcherViewMediator</item>
         <item>com.android.systemui.car.userswitcher.UserSwitchTransitionViewMediator</item>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/dimens.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/dimens.xml
index a6fcf5ccec..350825449a 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/dimens.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/dimens.xml
@@ -20,7 +20,7 @@
 
     <dimen name="car_quick_controls_footer_button_vertical_margin">10dp</dimen>
     <dimen name="car_quick_controls_footer_button_horizontal_margin">24dp</dimen>
-    <dimen name="car_quick_controls_footer_button_min_height">56dp</dimen>
+    <dimen name="car_quick_controls_footer_button_min_height">88dp</dimen>
     <dimen name="car_quick_controls_footer_button_radius">@dimen/car_portrait_ui_button_radius</dimen>
     <dimen name="car_quick_controls_entry_points_start_margin">24dp</dimen>
     <dimen name="car_profile_switcher_padding_top">16dp</dimen>
@@ -122,4 +122,12 @@
 
     <dimen name="dock_container_margin">@*android:dimen/car_padding_3</dimen>
     <dimen name="dock_item_size">80dp</dimen>
+
+    <dimen name="data_subscription_pop_up_horizontal_offset">120dp</dimen>
+    <dimen name="data_subscription_pop_up_vertical_offset">24dp</dimen>
+    <dimen name="data_subscription_pop_up_button_width">240dp</dimen>
+    <dimen name="data_subscription_pop_up_radius">48dp</dimen>
+    <dimen name="data_subscription_pop_up_arrow_offset">116dp</dimen>
+
+    <dimen name="qc_row_bottom_divider_margin_top">0dp</dimen>
 </resources>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/strings.xml b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/strings.xml
index 790cdd5a6d..9a89cb8e58 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/strings.xml
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/res/values/strings.xml
@@ -22,8 +22,6 @@
     <!-- Message shown when task view is not ready which asks user to wait until system has finished loading [CHAR LIMIT=75]-->
     <string name="task_view_not_ready_message">Please wait for system to load</string>
 
-    <!-- Subtitle for current profile in profile switch panel [CHAR LIMIT=20]-->
-    <string name="current_profile_subtitle">Current profile</string>
     <string name="loading_welcome_message">AAOS</string>
     <string name="loading_action_button_text">Continue</string>
 
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/CarUiPortraitSystemUIBinder.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/CarUiPortraitSystemUIBinder.java
index b687631ec2..c4c1d5f5b3 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/CarUiPortraitSystemUIBinder.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/CarUiPortraitSystemUIBinder.java
@@ -18,7 +18,6 @@ package com.android.systemui;
 
 import com.android.systemui.car.displayarea.CarDisplayAreaModule;
 import com.android.systemui.car.displayarea.DisplayAreaComponent;
-import com.android.systemui.car.qc.CarUiPortraitQuickControlsModule;
 import com.android.systemui.car.statusicon.ui.ReadOnlyStatusIconModule;
 import com.android.systemui.car.systembar.CarUiPortraitSystemBarModule;
 import com.android.systemui.car.window.ExtendedOverlayWindowModule;
@@ -30,8 +29,7 @@ import dagger.multibindings.IntoMap;
 
 /** Binder for AAECarSystemUI specific {@link CoreStartable} modules and components. */
 @Module(includes = {ExtendedOverlayWindowModule.class, CarDisplayAreaModule.class,
-        CarUiPortraitSystemBarModule.class, ReadOnlyStatusIconModule.class,
-        CarUiPortraitQuickControlsModule.class})
+        CarUiPortraitSystemBarModule.class, ReadOnlyStatusIconModule.class})
 abstract class CarUiPortraitSystemUIBinder extends CarSystemUIBinder {
 
     /** Inject into ClusterDisplayController. */
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/CarUiPortraitSystemUIInitializer.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/CarUiPortraitSystemUIInitializer.java
index ddcbb12861..50586c0697 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/CarUiPortraitSystemUIInitializer.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/CarUiPortraitSystemUIInitializer.java
@@ -56,7 +56,6 @@ public class CarUiPortraitSystemUIInitializer extends CarSystemUIInitializer {
                 isSystemUser ? Optional.of(carWm.getRootTaskDisplayAreaOrganizer())
                         : Optional.empty())
                 .setCarUiPortraitDisplaySystemBarsController(
-                        carWm.getCarUiPortraitDisplaySystemBarsController())
-                        .setMDSystemBarsController(carWm.getMDSystemBarController());
+                        carWm.getCarUiPortraitDisplaySystemBarsController());
     }
 }
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/displayarea/CarDisplayAreaController.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/displayarea/CarDisplayAreaController.java
index d7df5123c6..6d280cb1cb 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/displayarea/CarDisplayAreaController.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/displayarea/CarDisplayAreaController.java
@@ -76,6 +76,7 @@ public class CarDisplayAreaController implements ConfigurationController.Configu
     private boolean mUserSetupInProgress;
     private boolean mIsImmersive;
     private boolean mIsLauncherReady;
+    private boolean mIsNotificationCenterOnTop;
     private LoadingViewController mLoadingViewController;
 
     private final CarUiPortraitDisplaySystemBarsController.Callback
@@ -209,10 +210,12 @@ public class CarDisplayAreaController implements ConfigurationController.Configu
 
     @Override
     public void animateCollapsePanels(int flags, boolean force) {
-        Intent intent = new Intent(REQUEST_FROM_SYSTEM_UI);
-        intent.putExtra(INTENT_EXTRA_COLLAPSE_APPLICATION_PANEL, true);
-        mApplicationContext.sendBroadcastAsUser(intent,
-                new UserHandle(ActivityManager.getCurrentUser()));
+        if (mIsNotificationCenterOnTop) {
+            Intent intent = new Intent(REQUEST_FROM_SYSTEM_UI);
+            intent.putExtra(INTENT_EXTRA_COLLAPSE_APPLICATION_PANEL, true);
+            mApplicationContext.sendBroadcastAsUser(intent,
+                    new UserHandle(ActivityManager.getCurrentUser()));
+        }
     }
 
     private static void logIfDebuggable(String message) {
@@ -264,4 +267,9 @@ public class CarDisplayAreaController implements ConfigurationController.Configu
         mApplicationContext.registerReceiverForAllUsers(immersiveModeChangeReceiver,
                 new IntentFilter(REQUEST_FROM_LAUNCHER), null, null, Context.RECEIVER_EXPORTED);
     }
+
+    /** Set Notification Center state. */
+    public void setNotificationCenterOnTop(boolean isNotificationCenterOnTop) {
+        mIsNotificationCenterOnTop = isNotificationCenterOnTop;
+    }
 }
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/displayarea/CarDisplayAreaModule.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/displayarea/CarDisplayAreaModule.java
index c1f01c8161..de36df2d56 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/displayarea/CarDisplayAreaModule.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/displayarea/CarDisplayAreaModule.java
@@ -29,7 +29,7 @@ import com.android.systemui.wm.CarUiPortraitDisplaySystemBarsController;
 import com.android.wm.shell.common.HandlerExecutor;
 import com.android.wm.shell.common.ShellExecutor;
 import com.android.wm.shell.common.SyncTransactionQueue;
-import com.android.wm.shell.common.TransactionPool;
+import com.android.wm.shell.shared.TransactionPool;
 
 import dagger.Module;
 import dagger.Provides;
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/hvac/AutoDismissHvacPanelOverlayViewController.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/hvac/AutoDismissHvacPanelOverlayViewController.java
deleted file mode 100644
index 4326e55f31..0000000000
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/hvac/AutoDismissHvacPanelOverlayViewController.java
+++ /dev/null
@@ -1,151 +0,0 @@
-/*
- * Copyright (C) 2021 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.systemui.car.hvac;
-
-import android.animation.Animator;
-import android.animation.AnimatorInflater;
-import android.animation.AnimatorListenerAdapter;
-import android.animation.ObjectAnimator;
-import android.app.UiModeManager;
-import android.content.Context;
-import android.content.res.Resources;
-import android.os.Handler;
-import android.view.MotionEvent;
-import android.view.View;
-
-import com.android.systemui.R;
-import com.android.systemui.car.CarDeviceProvisionedController;
-import com.android.systemui.car.window.OverlayViewGlobalStateController;
-import com.android.systemui.dagger.SysUISingleton;
-import com.android.systemui.dagger.qualifiers.Main;
-import com.android.systemui.statusbar.policy.ConfigurationController;
-import com.android.wm.shell.animation.FlingAnimationUtils;
-
-import javax.inject.Inject;
-
-/**
- * An extension of {@link HvacPanelOverlayViewController} which auto dismisses the panel if there
- * is no activity for some configured amount of time.
- */
-@SysUISingleton
-public class AutoDismissHvacPanelOverlayViewController extends HvacPanelOverlayViewController {
-
-    private final Resources mResources;
-    private final Handler mHandler;
-    private final Context mContext;
-
-    private int mAutoDismissDurationMs;
-    private ObjectAnimator mOpenAnimator;
-    private ObjectAnimator mCloseAnimator;
-
-    private final Runnable mAutoDismiss = () -> {
-        if (isPanelExpanded()) {
-            toggle();
-        }
-    };
-
-    @Inject
-    public AutoDismissHvacPanelOverlayViewController(Context context,
-            @Main Resources resources,
-            HvacController hvacController,
-            OverlayViewGlobalStateController overlayViewGlobalStateController,
-            FlingAnimationUtils.Builder flingAnimationUtilsBuilder,
-            CarDeviceProvisionedController carDeviceProvisionedController,
-            @Main Handler handler,
-            ConfigurationController configurationController,
-            UiModeManager uiModeManager) {
-        super(context, resources, hvacController, overlayViewGlobalStateController,
-                flingAnimationUtilsBuilder, carDeviceProvisionedController, configurationController,
-                uiModeManager);
-        mResources = resources;
-        mHandler = handler;
-        mContext = context;
-    }
-
-    @Override
-    protected void onTouchEvent(View view, MotionEvent event) {
-        int hvacHeight = mResources.getDimensionPixelSize(R.dimen.hvac_panel_full_expanded_height);
-        if (isPanelExpanded() && (event.getY() < (view.getHeight() - hvacHeight))
-                && (event.getAction() == MotionEvent.ACTION_UP)) {
-            mHandler.post(mAutoDismiss);
-        }
-    }
-
-    @Override
-    protected void onFinishInflate() {
-        super.onFinishInflate();
-
-        mAutoDismissDurationMs = mResources.getInteger(R.integer.config_hvacAutoDismissDurationMs);
-
-        mOpenAnimator = (ObjectAnimator) AnimatorInflater.loadAnimator(mContext,
-                R.anim.hvac_open_anim);
-        mOpenAnimator.setTarget(getLayout());
-        mCloseAnimator = (ObjectAnimator) AnimatorInflater.loadAnimator(mContext,
-                R.anim.hvac_close_anim);
-        mCloseAnimator.setTarget(getLayout());
-    }
-
-    @Override
-    protected void onAnimateExpandPanel() {
-        super.onAnimateExpandPanel();
-
-        mHandler.postDelayed(mAutoDismiss, mAutoDismissDurationMs);
-    }
-
-    @Override
-    protected void onAnimateCollapsePanel() {
-        super.onAnimateCollapsePanel();
-
-        mHandler.removeCallbacks(mAutoDismiss);
-    }
-
-    @Override
-    protected void animate(float from, float to, float velocity, boolean isClosing) {
-        if (isAnimating()) {
-            return;
-        }
-        mIsAnimating = true;
-        setIsTracking(true);
-
-        ObjectAnimator animator = isClosing ? mCloseAnimator : mOpenAnimator;
-        animator.setFloatValues(from, to);
-        animator.removeAllListeners();
-        animator.addListener(new AnimatorListenerAdapter() {
-            @Override
-            public void onAnimationEnd(Animator animation) {
-                super.onAnimationEnd(animation);
-                mIsAnimating = false;
-                setIsTracking(false);
-                mOpeningVelocity = DEFAULT_FLING_VELOCITY;
-                mClosingVelocity = DEFAULT_FLING_VELOCITY;
-                if (isClosing) {
-                    resetPanelVisibility();
-                } else {
-                    onExpandAnimationEnd();
-                    setPanelExpanded(true);
-                    setViewClipBounds((int) to);
-                }
-            }
-        });
-        animator.start();
-    }
-
-    @Override
-    protected void setUpHandleBar() {
-        // No-op
-    }
-}
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/hvac/AutoDismissHvacPanelOverlayViewMediator.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/hvac/AutoDismissHvacPanelOverlayViewMediator.java
deleted file mode 100644
index 26116fb6e6..0000000000
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/hvac/AutoDismissHvacPanelOverlayViewMediator.java
+++ /dev/null
@@ -1,45 +0,0 @@
-/*
- * Copyright (C) 2021 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.systemui.car.hvac;
-
-import android.content.Context;
-
-import com.android.systemui.broadcast.BroadcastDispatcher;
-import com.android.systemui.car.systembar.CarSystemBarController;
-import com.android.systemui.dagger.SysUISingleton;
-import com.android.systemui.settings.UserTracker;
-
-import javax.inject.Inject;
-
-/**
- * Instance of {@link HvacPanelOverlayViewMediator} which uses {@link
- * AutoDismissHvacPanelOverlayViewController}.
- */
-@SysUISingleton
-public class AutoDismissHvacPanelOverlayViewMediator extends HvacPanelOverlayViewMediator {
-
-    @Inject
-    public AutoDismissHvacPanelOverlayViewMediator(
-            Context context,
-            CarSystemBarController carSystemBarController,
-            AutoDismissHvacPanelOverlayViewController hvacPanelOverlayViewController,
-            BroadcastDispatcher broadcastDispatcher,
-            UserTracker userTracker) {
-        super(context, carSystemBarController, hvacPanelOverlayViewController, broadcastDispatcher,
-                userTracker);
-    }
-}
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/qc/CarUiPortraitProfileSwitcher.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/qc/CarUiPortraitProfileSwitcher.java
deleted file mode 100644
index 7a590bc7e4..0000000000
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/qc/CarUiPortraitProfileSwitcher.java
+++ /dev/null
@@ -1,106 +0,0 @@
-/*
- * Copyright (C) 2022 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.systemui.car.qc;
-
-import static com.android.car.ui.utils.CarUiUtils.drawableToBitmap;
-
-import android.content.Context;
-import android.content.pm.UserInfo;
-import android.graphics.drawable.Drawable;
-import android.graphics.drawable.Icon;
-import android.os.Handler;
-
-import com.android.car.qc.QCItem;
-import com.android.car.qc.QCRow;
-import com.android.systemui.R;
-import com.android.systemui.car.CarServiceProvider;
-import com.android.systemui.dagger.qualifiers.Background;
-import com.android.systemui.settings.UserTracker;
-
-import javax.inject.Inject;
-
-/**
- * Local provider for the profile switcher panel with secondary text for current profile.
- */
-public class CarUiPortraitProfileSwitcher extends ProfileSwitcher {
-
-    @Inject
-    public CarUiPortraitProfileSwitcher(Context context, UserTracker userTracker,
-            CarServiceProvider carServiceProvider,  @Background Handler handler) {
-        super(context, userTracker, carServiceProvider, handler);
-
-    }
-
-    @Override
-    protected QCRow createUserProfileRow(UserInfo userInfo) {
-        if (userInfo.id == mUserTracker.getUserId()) {
-            return createUserProfileRowForCurrentProfile(userInfo);
-        }
-        return super.createUserProfileRow(userInfo);
-    }
-
-    @Override
-    protected QCRow createGuestProfileRow() {
-        if (mUserTracker.getUserInfo() != null && mUserTracker.getUserInfo().isGuest()) {
-            return createGuestProfileRowForCurrentProfile();
-        } else {
-            return super.createGuestProfileRow();
-        }
-    }
-
-    private QCRow createUserProfileRowForCurrentProfile(UserInfo userInfo) {
-        QCItem.ActionHandler actionHandler = (item, context, intent) -> {
-            if (mPendingUserAdd) {
-                return;
-            }
-            switchUser(userInfo.id);
-        };
-        return createUserProfileRowForCurrentProfile(userInfo.name,
-                mUserIconProvider.getDrawableWithBadge(mContext, userInfo), actionHandler);
-    }
-
-    private QCRow createGuestProfileRowForCurrentProfile() {
-        QCItem.ActionHandler actionHandler = (item, context, intent) -> {
-            if (mPendingUserAdd) {
-                return;
-            }
-            UserInfo guest = createNewOrFindExistingGuest(mContext);
-            if (guest != null) {
-                switchUser(guest.id);
-            }
-        };
-
-        return createUserProfileRowForCurrentProfile(
-                mContext.getString(com.android.internal.R.string.guest_name),
-                mUserIconProvider.getRoundedGuestDefaultIcon(mContext),
-                actionHandler);
-    }
-
-    private QCRow createUserProfileRowForCurrentProfile(String title, Drawable iconDrawable,
-            QCItem.ActionHandler actionHandler) {
-        Icon icon = Icon.createWithBitmap(drawableToBitmap(iconDrawable));
-        String subtitle = mContext.getString(R.string.current_profile_subtitle);
-        QCRow row = new QCRow.Builder()
-                .setIcon(icon)
-                .setIconTintable(false)
-                .setTitle(title)
-                .setSubtitle(subtitle)
-                .build();
-        row.setActionHandler(actionHandler);
-        return row;
-    }
-}
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/qc/CarUiPortraitQuickControlsModule.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/qc/CarUiPortraitQuickControlsModule.java
deleted file mode 100644
index 2b4f9a2ed8..0000000000
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/qc/CarUiPortraitQuickControlsModule.java
+++ /dev/null
@@ -1,37 +0,0 @@
-/*
- * Copyright (C) 2022 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.systemui.car.qc;
-
-import com.android.car.qc.provider.BaseLocalQCProvider;
-
-import dagger.Binds;
-import dagger.Module;
-import dagger.multibindings.ClassKey;
-import dagger.multibindings.IntoMap;
-
-/**
- * Dagger injection module for {@link SystemUIQCViewController}
- */
-@Module
-public abstract class CarUiPortraitQuickControlsModule {
-    /** Injects CarUiPortraitProfileSwitcher. */
-    @Binds
-    @IntoMap
-    @ClassKey(CarUiPortraitProfileSwitcher.class)
-    public abstract BaseLocalQCProvider bindCarUiPortraitProfileSwitcher(
-            CarUiPortraitProfileSwitcher carUiPortraitProfileSwitcher);
-}
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/statusicon/ui/StatusBarSensorInfoManager.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/statusicon/ui/StatusBarSensorInfoManager.java
index eecd181f1b..f33462a2dd 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/statusicon/ui/StatusBarSensorInfoManager.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/statusicon/ui/StatusBarSensorInfoManager.java
@@ -27,6 +27,7 @@ import android.car.hardware.property.CarPropertyManager;
 import android.content.res.Resources;
 import android.util.Log;
 
+import androidx.annotation.Nullable;
 import androidx.lifecycle.MutableLiveData;
 
 import com.android.systemui.R;
@@ -52,7 +53,7 @@ public class StatusBarSensorInfoManager {
     private final MutableLiveData<String> mSensorStringLiveData;
     private final CarServiceProvider mCarServiceProvider;
     private Executor mExecutor;
-    private CarPropertyManager mCarPropertyManager;
+    private @Nullable CarPropertyManager mCarPropertyManager;
     private MutableLiveData<Boolean> mSensorAvailabilityData;
     private float mTemperatureValueInCelsius;
     private int mTemperatureUnit;
@@ -114,6 +115,10 @@ public class StatusBarSensorInfoManager {
     }
 
     private void initializeHvacProperties() {
+        if (mCarPropertyManager == null) {
+            Log.e(TAG, "Missing car property service, skip initializing the hvac properties.");
+            return;
+        }
         int temperatureAreaId =
                 mCarPropertyManager.getAreaId(ENV_OUTSIDE_TEMPERATURE, SEAT_UNKNOWN);
         mTemperatureValueInCelsius =
@@ -126,6 +131,10 @@ public class StatusBarSensorInfoManager {
     }
 
     private void registerHvacPropertyEventListeners() {
+        if (mCarPropertyManager == null) {
+            Log.e(TAG, "Missing car property service, skip registering event listeners.");
+            return;
+        }
         for (Integer propertyId : SENSOR_PROPERTIES) {
             mCarPropertyManager.registerCallback(mPropertyEventCallback, propertyId,
                     CarPropertyManager.SENSOR_RATE_ONCHANGE);
@@ -133,6 +142,10 @@ public class StatusBarSensorInfoManager {
     }
 
     private void unregisterHvacPropertyEventListeners() {
+        if (mCarPropertyManager == null) {
+            Log.e(TAG, "Missing car property service, skip unregistering event listeners.");
+            return;
+        }
         for (Integer propertyId : SENSOR_PROPERTIES) {
             mCarPropertyManager.unregisterCallback(mPropertyEventCallback, propertyId);
         }
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiAssistantButton.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiAssistantButton.java
deleted file mode 100644
index 0dcd04c02c..0000000000
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiAssistantButton.java
+++ /dev/null
@@ -1,50 +0,0 @@
-/*
- * Copyright (C) 2022 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.systemui.car.systembar;
-
-import android.content.ComponentName;
-import android.content.Context;
-import android.content.Intent;
-import android.os.UserHandle;
-import android.util.AttributeSet;
-
-import com.android.systemui.R;
-
-/**
- * CarUiAssistantButton is an ui component that will trigger the Voice Interaction Service.
- *
- * TODO(b/255887799): Workaround until the issue is fixed.
- */
-public class CarUiAssistantButton extends AssistantButton {
-
-    private final Context mContext;
-    private ComponentName mVoiceAssistantComponent;
-
-    public CarUiAssistantButton(Context context, AttributeSet attrs) {
-        super(context, attrs);
-        mContext = context;
-        mVoiceAssistantComponent = ComponentName.unflattenFromString(
-                context.getResources().getString(R.string.config_VoiceAssistantActivity));
-    }
-
-    @Override
-    void showAssistant() {
-        Intent intent = new Intent();
-        intent.setComponent(mVoiceAssistantComponent);
-        mContext.startActivityAsUser(intent, UserHandle.CURRENT);
-    }
-}
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiPortraitButtonSelectionStateListener.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiPortraitButtonSelectionStateListener.java
index 94dc43eb35..6570100f0e 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiPortraitButtonSelectionStateListener.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiPortraitButtonSelectionStateListener.java
@@ -26,6 +26,8 @@ import android.content.Context;
 import android.content.Intent;
 import android.content.IntentFilter;
 
+import com.android.systemui.car.displayarea.CarDisplayAreaController;
+
 class CarUiPortraitButtonSelectionStateListener extends ButtonSelectionStateListener {
 
     private CarUiPortraitButtonSelectionStateController mPortraitButtonStateController;
@@ -34,7 +36,8 @@ class CarUiPortraitButtonSelectionStateListener extends ButtonSelectionStateList
     private boolean mIsRecentsVisible;
 
     CarUiPortraitButtonSelectionStateListener(Context context,
-            ButtonSelectionStateController carSystemButtonController) {
+            ButtonSelectionStateController carSystemButtonController,
+            CarDisplayAreaController displayAreaController) {
         super(carSystemButtonController);
         if (mButtonSelectionStateController
                 instanceof CarUiPortraitButtonSelectionStateController) {
@@ -57,6 +60,7 @@ class CarUiPortraitButtonSelectionStateListener extends ButtonSelectionStateList
                             INTENT_EXTRA_NOTIFICATION_VISIBILITY_CHANGE, false);
                     mPortraitButtonStateController.setNotificationButtonSelected(
                             mIsNotificationVisible);
+                    displayAreaController.setNotificationCenterOnTop(mIsNotificationVisible);
                 } else if (intent.hasExtra(INTENT_EXTRA_RECENTS_VISIBILITY_CHANGE)) {
                     mIsRecentsVisible = intent.getBooleanExtra(
                             INTENT_EXTRA_RECENTS_VISIBILITY_CHANGE, false);
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiPortraitSystemBarModule.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiPortraitSystemBarModule.java
index dd2897272b..11de6c0e82 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiPortraitSystemBarModule.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarUiPortraitSystemBarModule.java
@@ -47,7 +47,7 @@ public abstract class CarUiPortraitSystemBarModule {
         }
 
         return new CarUiPortraitButtonSelectionStateListener(context,
-                buttonSelectionStateController);
+                buttonSelectionStateController, displayAreaController);
     }
 
     @SysUISingleton
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/window/ExtendedOverlayWindowModule.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/window/ExtendedOverlayWindowModule.java
index 55d426e375..961f39df97 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/window/ExtendedOverlayWindowModule.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/window/ExtendedOverlayWindowModule.java
@@ -16,7 +16,6 @@
 
 package com.android.systemui.car.window;
 
-import com.android.systemui.car.hvac.AutoDismissHvacPanelOverlayViewMediator;
 import com.android.systemui.car.loading.LoadingViewMediator;
 
 import dagger.Binds;
@@ -28,13 +27,6 @@ import dagger.multibindings.IntoMap;
 @Module
 public abstract class ExtendedOverlayWindowModule {
 
-    /** Injects RearViewCameraViewMediator. */
-    @Binds
-    @IntoMap
-    @ClassKey(AutoDismissHvacPanelOverlayViewMediator.class)
-    public abstract OverlayViewMediator bindAutoDismissHvacPanelViewMediator(
-            AutoDismissHvacPanelOverlayViewMediator overlayViewsMediator);
-
     /** Injects LoadingViewMediator. */
     @Binds
     @IntoMap
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/wmshell/CarUiPortraitWMShellModule.java b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/wmshell/CarUiPortraitWMShellModule.java
index a022712f8b..52b3e609fb 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/wmshell/CarUiPortraitWMShellModule.java
+++ b/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/wmshell/CarUiPortraitWMShellModule.java
@@ -25,7 +25,6 @@ import com.android.systemui.car.wm.CarFullscreenTaskMonitorListener;
 import com.android.systemui.dagger.qualifiers.Main;
 import com.android.systemui.wm.CarUiPortraitDisplaySystemBarsController;
 import com.android.systemui.wm.DisplaySystemBarsController;
-import com.android.systemui.wm.MDSystemBarsController;
 import com.android.wm.shell.ShellTaskOrganizer;
 import com.android.wm.shell.common.DisplayController;
 import com.android.wm.shell.common.DisplayInsetsController;
@@ -37,6 +36,7 @@ import com.android.wm.shell.fullscreen.FullscreenTaskListener;
 import com.android.wm.shell.pip.Pip;
 import com.android.wm.shell.recents.RecentTasksController;
 import com.android.wm.shell.sysui.ShellInit;
+import com.android.wm.shell.taskview.TaskViewTransitions;
 import com.android.wm.shell.windowdecor.WindowDecorViewModel;
 
 import dagger.BindsOptionalOf;
@@ -69,9 +69,6 @@ public abstract class CarUiPortraitWMShellModule {
     @BindsOptionalOf
     abstract Pip optionalPip();
 
-    @BindsOptionalOf
-    abstract  MDSystemBarsController optionalMDSystemBarsController();
-
     @WMSingleton
     @Provides
     @DynamicOverride
@@ -81,13 +78,15 @@ public abstract class CarUiPortraitWMShellModule {
             ShellTaskOrganizer shellTaskOrganizer,
             SyncTransactionQueue syncQueue,
             Optional<RecentTasksController> recentTasksOptional,
-            Optional<WindowDecorViewModel> windowDecorViewModelOptional) {
+            Optional<WindowDecorViewModel> windowDecorViewModelOptional,
+            TaskViewTransitions taskViewTransitions) {
         return new CarFullscreenTaskMonitorListener(context,
                 carServiceProvider,
                 shellInit,
                 shellTaskOrganizer,
                 syncQueue,
                 recentTasksOptional,
-                windowDecorViewModelOptional);
+                windowDecorViewModelOptional,
+                taskViewTransitions);
     }
 }
diff --git a/car_product/car_ui_portrait/apps/car_ui_portrait_apps.mk b/car_product/car_ui_portrait/apps/car_ui_portrait_apps.mk
index 51cf6fcde6..b7e5e7661e 100644
--- a/car_product/car_ui_portrait/apps/car_ui_portrait_apps.mk
+++ b/car_product/car_ui_portrait/apps/car_ui_portrait_apps.mk
@@ -21,7 +21,6 @@ PRODUCT_PACKAGES += \
     CarNotification \
     CarUiPortraitCommon \
     CarUiPortraitLauncher \
-    CarUiPortraitSettings \
     CarUiPortraitSystemUI \
     PaintBooth
 
diff --git a/car_product/car_ui_portrait/rro/CarUIPortraitCommon/src/com/android/car/caruiportrait/common/service/CarUiPortraitService.java b/car_product/car_ui_portrait/rro/CarUIPortraitCommon/src/com/android/car/caruiportrait/common/service/CarUiPortraitService.java
index 63c76f8421..71ac11dc68 100644
--- a/car_product/car_ui_portrait/rro/CarUIPortraitCommon/src/com/android/car/caruiportrait/common/service/CarUiPortraitService.java
+++ b/car_product/car_ui_portrait/rro/CarUIPortraitCommon/src/com/android/car/caruiportrait/common/service/CarUiPortraitService.java
@@ -233,8 +233,7 @@ public class CarUiPortraitService extends Service {
                 Log.d(TAG, "Immersive request: source = " + source + ", request=" + isImmersive);
                 if (intent.hasExtra(INTENT_EXTRA_IS_IMMERSIVE_MODE_REQUESTED)
                         && isImmersive != mIsSystemInImmersiveMode
-                        && source != null
-                        && !source.equals(mImmersiveModeSource)) {
+                        && source != null) {
                     mIsSystemInImmersiveMode = isImmersive;
                     mImmersiveModeSource = source;
                     Bundle bundle = new Bundle();
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitCarServiceRRO/Android.bp b/car_product/car_ui_portrait/rro/CarUiPortraitCarServiceRRO/Android.bp
index f5bcffc127..8036aebec7 100644
--- a/car_product/car_ui_portrait/rro/CarUiPortraitCarServiceRRO/Android.bp
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitCarServiceRRO/Android.bp
@@ -15,12 +15,9 @@ package {
     default_applicable_licenses: ["Android-Apache-2.0"],
 }
 
-android_app {
+runtime_resource_overlay {
     name: "CarUiPortraitCarServiceRRO",
     resource_dirs: ["res"],
     sdk_version: "current",
-    aaptflags: [
-        "--no-resource-deduping",
-        "--no-resource-removal",
-    ],
+    manifest: "AndroidManifest.xml",
 }
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitCarServiceRRO/res/values-port/config.xml b/car_product/car_ui_portrait/rro/CarUiPortraitCarServiceRRO/res/values-port/config.xml
index ecfdf8da3c..a000cc1bc2 100644
--- a/car_product/car_ui_portrait/rro/CarUiPortraitCarServiceRRO/res/values-port/config.xml
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitCarServiceRRO/res/values-port/config.xml
@@ -39,7 +39,7 @@
     inputTypes: supported input types for the corresponding display.
 -->
     <string-array translatable="false" name="config_occupant_display_mapping">
-        <item>displayPort=136,displayType=MAIN,occupantZoneId=0,inputTypes=TOUCH_SCREEN|DPAD_KEYS|NAVIGATE_KEYS|ROTARY_NAVIGATION</item>
+        <item>displayPort=135,displayType=MAIN,occupantZoneId=0,inputTypes=TOUCH_SCREEN|DPAD_KEYS|NAVIGATE_KEYS|ROTARY_NAVIGATION</item>
     </string-array>
     <!--
         Specifies optional features that can be enabled by this image. Note that vhal can disable
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/Android.bp b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/Android.bp
new file mode 100644
index 0000000000..7bc9db9c33
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/Android.bp
@@ -0,0 +1,29 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+package {
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+android_app {
+    name: "CarUiPortraitDataSubscriptionReferenceRRO",
+    resource_dirs: ["res"],
+    sdk_version: "current",
+    aaptflags: [
+        "--no-resource-deduping",
+        "--no-resource-removal",
+    ],
+    static_libs: [
+        "car-portrait-ui-common",
+    ],
+}
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/AndroidManifest.xml b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/AndroidManifest.xml
new file mode 100644
index 0000000000..a7740abc48
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/AndroidManifest.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+    package="com.android.car.datasubscription.caruiportrait.rro">
+    <application android:hasCode="false"/>
+    <overlay android:priority="21"
+        android:targetName="DataSubscriptionReference"
+        android:targetPackage="com.android.car.datasubscription"
+        android:resourcesMap="@xml/overlays"
+        android:requiredSystemPropertyName="car.ui.config"
+        android:requiredSystemPropertyValue="rickybobby"
+        android:isStatic="true" />
+</manifest>
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/drawable/qr_code.png b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/drawable/qr_code.png
new file mode 100644
index 0000000000..aabc08fe33
Binary files /dev/null and b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/drawable/qr_code.png differ
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/layout/main.xml b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/layout/main.xml
new file mode 100644
index 0000000000..0afaf5efd8
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/layout/main.xml
@@ -0,0 +1,67 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:orientation="vertical"
+    android:padding="@dimen/data_subscription_flow_padding"
+    android:baselineAligned="false">
+
+    <TextView
+        android:id="@+id/title"
+        android:layout_width="@dimen/data_subscription_content_width"
+        android:layout_height="wrap_content"
+        android:text="@string/data_subscription_title"
+        android:textColor="@color/data_subscription_title_color"
+        android:paddingBottom="@dimen/data_subscription_flow_title_padding"
+        android:textAppearance="@style/TextAppearance.Car.Headline.Large"/>
+
+    <TextView
+        android:id="@+id/description"
+        android:layout_width="@dimen/data_subscription_content_width"
+        android:layout_height="wrap_content"
+        android:text="@string/data_subscription_description"
+        android:textColor="@color/data_subscription_description_color"
+        android:paddingBottom="@dimen/data_subscription_flow_vertical_padding"
+        android:textAppearance="@style/TextAppearance.Car.Body.Medium"/>
+
+    <ImageView
+        android:id="@+id/qr_code"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:src="@drawable/qr_code"
+        android:layout_marginVertical="@dimen/data_subscription_flow_vertical_padding"
+        android:layout_gravity="center_horizontal"
+        android:contentDescription="@string/data_subscription_qr_code_content_description"/>
+
+    <Space
+        android:layout_width="wrap_content"
+        android:layout_height="0dp"
+        android:layout_weight="1" />
+
+    <Button
+        android:id="@+id/exit"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/data_subscription_button_text"
+        android:textColor="@color/button_text_color"
+        android:layout_gravity="bottom"
+        style="@android:style/Widget.DeviceDefault.Button"/>
+
+</LinearLayout>
diff --git a/data/etc/com.android.car.multidisplay.passenger.xml b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/colors.xml
similarity index 57%
rename from data/etc/com.android.car.multidisplay.passenger.xml
rename to car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/colors.xml
index fe1330f5fe..111bfe99ab 100644
--- a/data/etc/com.android.car.multidisplay.passenger.xml
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/colors.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2023 The Android Open Source Project
+  ~ Copyright (C) 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
@@ -12,12 +12,11 @@
   ~ distributed under the License is distributed on an "AS IS" BASIS,
   ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   ~ See the License for the specific language governing permissions and
-  ~ limitations under the License
+  ~ limitations under the License.
   -->
-<permissions>
-    <privapp-permissions package="com.android.car.multidisplay.passenger">
-        <permission name="android.permission.MEDIA_CONTENT_CONTROL"/>
-        <permission name="android.car.permission.MANAGE_CAR_SYSTEM_UI"/>
-        <permission name="android.permission.INTERACT_ACROSS_USERS"/>
-    </privapp-permissions>
-</permissions>
+<resources>
+    <color name="button_text_color">@color/car_on_background</color>
+    <color name="data_subscription_background">@color/car_background</color>
+    <color name="data_subscription_title_color">@color/car_on_background</color>
+    <color name="data_subscription_description_color">@color/car_on_background</color>
+</resources>
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/dimens.xml b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/dimens.xml
new file mode 100644
index 0000000000..ccc913d46d
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/dimens.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<resources>
+    <dimen name="data_subscription_content_width">640dp</dimen>
+    <dimen name="data_subscription_flow_padding">@*android:dimen/car_padding_3</dimen>
+    <dimen name="data_subscription_flow_vertical_padding">@*android:dimen/car_padding_3</dimen>
+    <dimen name="data_subscription_flow_title_padding">@*android:dimen/car_padding_2</dimen>
+</resources>
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/strings.xml b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/strings.xml
new file mode 100644
index 0000000000..5a3d294927
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/values/strings.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<resources>
+    <string name="data_subscription_title">Get a Premium Connectivity subscription</string>
+    <string name="data_subscription_description">Open your phone\'s camera app and focus on this code to automatically scan it. Youll get a notification above the camera screen to continue.</string>
+    <string name="data_subscription_button_text">Don\'t remind me again</string>
+    <string name="data_subscription_qr_code_content_description">Data subscription sign up QR code</string>
+</resources>
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/xml/overlays.xml b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/xml/overlays.xml
new file mode 100644
index 0000000000..29da06989d
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitDataSubscriptionReferenceRRO/res/xml/overlays.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<overlay>
+    <item target="color/button_text_color" value="@color/button_text_color" />
+    <item target="drawable/qr_code" value="@drawable/qr_code" />
+    <item target="id/description" value="@id/description" />
+    <item target="id/exit" value="@id/exit" />
+    <item target="id/qr_code" value="@id/qr_code" />
+    <item target="id/title" value="@id/title" />
+    <item target="layout/main" value="@layout/main" />
+    <item target="string/data_subscription_description" value="@string/data_subscription_description" />
+    <item target="string/data_subscription_title" value="@string/data_subscription_title" />
+</overlay>
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/Android.bp b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/Android.bp
index 1ec4b4d1f8..1be3a340d4 100644
--- a/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/Android.bp
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/Android.bp
@@ -15,7 +15,7 @@ package {
     default_applicable_licenses: ["Android-Apache-2.0"],
 }
 
-android_app {
+runtime_resource_overlay {
     name: "CarUiPortraitSettingsRRO",
     resource_dirs: ["res"],
     sdk_version: "current",
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/preference_dialog_password_edittext.xml b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/preference_dialog_password_edittext.xml
similarity index 97%
rename from car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/preference_dialog_password_edittext.xml
rename to car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/preference_dialog_password_edittext.xml
index 677d880a11..29a1db7c3c 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/preference_dialog_password_edittext.xml
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/preference_dialog_password_edittext.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2022 The Android Open Source Project
+  ~ Copyright (C) 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/settings_recyclerview_default.xml b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/settings_recyclerview_default.xml
similarity index 95%
rename from car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/settings_recyclerview_default.xml
rename to car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/settings_recyclerview_default.xml
index 4616fdf238..104432aea0 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/settings_recyclerview_default.xml
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/settings_recyclerview_default.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2021 The Android Open Source Project
+  ~ Copyright (C) 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/top_level_recyclerview.xml b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/top_level_recyclerview.xml
similarity index 95%
rename from car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/top_level_recyclerview.xml
rename to car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/top_level_recyclerview.xml
index 4dbe9be57f..a62291e6c3 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/layout/top_level_recyclerview.xml
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/layout/top_level_recyclerview.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2021 The Android Open Source Project
+  ~ Copyright (C) 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/values/config.xml b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/config.xml
similarity index 94%
rename from car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/values/config.xml
rename to car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/config.xml
index eaf603f5b1..abcb85a8bb 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/values/config.xml
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/config.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2021 The Android Open Source Project
+  ~ Copyright (C) 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/dimens.xml b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/dimens.xml
index 8138d92ad1..745c6b08b1 100644
--- a/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/dimens.xml
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/dimens.xml
@@ -22,4 +22,20 @@
     <dimen name="toggle_button_radius">16dp</dimen>
     <dimen name="toggle_button_icon_inset">14dp</dimen>
     <dimen name="toggle_button_icon_size">44dp</dimen>
+
+    <!-- Top-level menu -->
+    <dimen name="top_level_recyclerview_margin_right">@*android:dimen/car_padding_2</dimen>
+    <dimen name="top_level_foreground_icon_inset">8dp</dimen>
+
+    <!-- Alert Dialog dimensions for preference_dialog_password_edittext -->
+    <dimen name="alert_dialog_margin_top">@*android:dimen/car_padding_4</dimen>
+    <dimen name="alert_dialog_margin_bottom">@*android:dimen/car_padding_4</dimen>
+    <dimen name="alert_dialog_title_margin_bottom">@*android:dimen/car_padding_4</dimen>
+    <dimen name="alert_dialog_title_margin_start">@*android:dimen/car_padding_3</dimen>
+    <dimen name="alert_dialog_title_margin_end">@*android:dimen/car_padding_3</dimen>
+    <dimen name="alert_dialog_edit_text_margin_start">@*android:dimen/car_padding_3</dimen>
+    <dimen name="alert_dialog_edit_text_margin_end">@*android:dimen/car_padding_3</dimen>
+    <dimen name="alert_dialog_password_checkbox_margin_end">@*android:dimen/car_padding_3</dimen>
+    <dimen name="alert_dialog_password_checkbox_margin_start">@*android:dimen/car_padding_3</dimen>
+    <dimen name="alert_dialog_password_checkbox_margin_top">@*android:dimen/car_padding_1</dimen>
 </resources>
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/strings.xml b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/strings.xml
new file mode 100644
index 0000000000..051c2f565c
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/values/strings.xml
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <!-- Text for show password ListItem -->
+    <string name="show_password">Show password</string>
+</resources>
diff --git a/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/xml/overlays.xml b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/xml/overlays.xml
index cfa83868e6..4ad6fa3859 100644
--- a/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/xml/overlays.xml
+++ b/car_product/car_ui_portrait/rro/CarUiPortraitSettingsRRO/res/xml/overlays.xml
@@ -23,6 +23,8 @@
     <item target="attr/state_ux_restricted" value="@attr/state_ux_restricted"/>
 
     <item target="bool/config_top_level_injection_background_always_use_default" value="true" />
+    <item target="bool/config_global_force_single_pane" value="@bool/config_global_force_single_pane" />
+    <item target="bool/config_top_level_enable_chevrons" value="@bool/config_top_level_enable_chevrons" />
 
     <item target="color/icon_color_default" value="@color/top_level_icon_default"/>
     <item target="color/qc_default_icon_color" value="@color/qc_default_icon_color"/>
@@ -48,6 +50,8 @@
     <item target="dimen/bluetooth_device_icon_size" value="@dimen/toggle_button_icon_size"/>
     <item target="dimen/icon_size" value="@dimen/icon_size"/>
     <item target="dimen/top_level_menu_width" value="@dimen/top_level_menu_width"/>
+    <item target="dimen/top_level_recyclerview_margin_right" value="@dimen/top_level_recyclerview_margin_right"/>
+    <item target="dimen/top_level_foreground_icon_inset" value="@dimen/top_level_foreground_icon_inset"/>
 
     <item target="drawable/ic_bluetooth_button" value="@drawable/bluetooth_button"/>
     <item target="drawable/ic_bluetooth_button_unavailable" value="@drawable/bluetooth_button_unavailable"/>
@@ -58,9 +62,19 @@
     <item target="drawable/top_level_preference_background" value="@drawable/top_level_preference_background"/>
     <item target="drawable/top_level_preference_highlight" value="@drawable/top_level_preference_highlight"/>
 
+    <item target="id/checkbox" value="@id/checkbox"/>
+    <item target="id/settings_recycler_view" value="@id/settings_recycler_view"/>
+    <item target="id/settings_car_ui_focus_area" value="@id/settings_car_ui_focus_area"/>
+    <item target="id/top_level_recycler_view" value="@id/top_level_recycler_view"/>
+
+    <item target="layout/preference_dialog_password_edittext" value="@layout/preference_dialog_password_edittext"/>
+    <item target="layout/settings_recyclerview_default" value="@layout/settings_recyclerview_default"/>
     <item target="layout/top_level_preference" value="@layout/top_level_preference"/>
+    <item target="layout/top_level_recyclerview" value="@layout/top_level_recyclerview"/>
 
     <item target="style/CarSettingsActivityDividerStyle" value="@style/CarSettingsActivityDividerStyle" />
     <item target="style/CarSettingsFragmentContainerStyle" value="@style/CarSettingsFragmentContainerStyle" />
     <item target="style/LockPattern" value="@style/LockPattern"/>
+
+    <item target="string/config_homepage_fragment_class" value="@string/config_homepage_fragment_class" />
 </overlay>
diff --git a/car_product/car_ui_portrait/rro/android/res/color/car_radio_button_unchecked_color.xml b/car_product/car_ui_portrait/rro/android/res/color/car_radio_button_unchecked_color.xml
new file mode 100644
index 0000000000..333d7cbeda
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/android/res/color/car_radio_button_unchecked_color.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (C) 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_secondary"/>
+    <item android:color="@color/car_secondary"/>
+</selector>
+
diff --git a/car_product/car_ui_portrait/rro/android/res/color/car_selection_controls_checked_color.xml b/car_product/car_ui_portrait/rro/android/res/color/car_selection_controls_checked_color.xml
new file mode 100644
index 0000000000..f8881f4f5a
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/android/res/color/car_selection_controls_checked_color.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_primary"/>
+    <item android:color="@color/car_primary"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/car_ui_portrait/rro/android/res/drawable/activated_state_radio_button.xml b/car_product/car_ui_portrait/rro/android/res/drawable/activated_state_radio_button.xml
new file mode 100644
index 0000000000..a3e469e82e
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/android/res/drawable/activated_state_radio_button.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_activated="false" android:drawable="@drawable/car_radio_button_unchecked" />
+    <item android:state_activated="true" android:drawable="@drawable/car_radio_button_checked" />
+</selector>
\ No newline at end of file
diff --git a/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button.xml b/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button.xml
new file mode 100644
index 0000000000..549dbc0a9e
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_checked="false" android:drawable="@drawable/car_radio_button_unchecked" />
+    <item android:state_checked="true" android:drawable="@drawable/car_radio_button_checked" />
+</selector>
diff --git a/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_checked.xml b/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_checked.xml
new file mode 100644
index 0000000000..95215a3575
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_checked.xml
@@ -0,0 +1,46 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+      <item
+        android:bottom="@dimen/car_radio_button_focus_ring_padding"
+        android:gravity="center"
+        android:left="@dimen/car_radio_button_focus_ring_padding"
+        android:right="@dimen/car_radio_button_focus_ring_padding"
+        android:top="@dimen/car_radio_button_focus_ring_padding">
+        <shape android:shape="oval">
+            <size
+                android:width="@dimen/car_radio_button_outer_ring_size"
+                android:height="@dimen/car_radio_button_outer_ring_size" />
+            <stroke
+                android:width="@dimen/car_radio_button_outer_ring_stroke_width"
+                android:color="@color/car_selection_controls_checked_color"/>
+        </shape>
+    </item>
+    <item android:gravity="center">
+        <shape
+            android:shape="oval">
+            <size
+                android:width="@dimen/car_radio_button_inner_circle_size"
+                android:height="@dimen/car_radio_button_inner_circle_size" />
+            <solid android:color="@color/car_selection_controls_checked_color"/>
+        </shape>
+    </item>
+    <item
+        android:drawable="@drawable/car_radio_button_focus_highlight"
+        android:gravity="center" />
+</layer-list>
+
diff --git a/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_focus_highlight.xml b/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_focus_highlight.xml
new file mode 100644
index 0000000000..74fd4a01e0
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_focus_highlight.xml
@@ -0,0 +1,44 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape android:shape="oval">
+            <size
+                android:width="@dimen/car_radio_button_focus_ring_size"
+                android:height="@dimen/car_radio_button_focus_ring_size" />
+            <solid android:color="@color/car_focus_background" />
+            <stroke
+                android:width="@dimen/car_radio_button_focus_pressed_stroke_width"
+                android:color="@color/car_focus_ring" />
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape android:shape="oval">
+            <size
+                android:width="@dimen/car_radio_button_focus_ring_size"
+                android:height="@dimen/car_radio_button_focus_ring_size" />
+            <solid android:color="@color/car_focus_background" />
+            <stroke
+                android:width="@dimen/car_radio_button_focus_stroke_width"
+                android:color="@color/car_focus_ring" />
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="?android:attr/colorControlHighlight" />
+    </item>
+</selector>
+
diff --git a/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_unchecked.xml b/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_unchecked.xml
new file mode 100644
index 0000000000..052023a65f
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/android/res/drawable/car_radio_button_unchecked.xml
@@ -0,0 +1,37 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:bottom="@dimen/car_radio_button_focus_ring_padding"
+        android:gravity="center"
+        android:left="@dimen/car_radio_button_focus_ring_padding"
+        android:right="@dimen/car_radio_button_focus_ring_padding"
+        android:top="@dimen/car_radio_button_focus_ring_padding">
+        <shape android:shape="oval">
+            <size
+                android:width="@dimen/car_radio_button_outer_ring_size"
+                android:height="@dimen/car_radio_button_outer_ring_size" />
+            <stroke
+                android:width="@dimen/car_radio_button_outer_ring_stroke_width"
+                android:color="@color/car_radio_button_unchecked_color" />
+        </shape>
+    </item>
+    <item
+        android:drawable="@drawable/car_radio_button_focus_highlight"
+      android:gravity="center" />
+</layer-list>
+
diff --git a/car_product/car_ui_portrait/rro/android/res/layout/resolve_list_item.xml b/car_product/car_ui_portrait/rro/android/res/layout/resolve_list_item.xml
new file mode 100644
index 0000000000..4b968030d5
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/android/res/layout/resolve_list_item.xml
@@ -0,0 +1,68 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+* Copyright 2024, The Android Open Source Project
+*
+* Licensed under the Apache License, Version 2.0 (the "License");
+* you may not use this file except in compliance with the License.
+* You may obtain a copy of the License at
+*
+*     http://www.apache.org/licenses/LICENSE-2.0
+*
+* Unless required by applicable law or agreed to in writing, software
+* distributed under the License is distributed on an "AS IS" BASIS,
+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+* See the License for the specific language governing permissions and
+* limitations under the License.
+*/
+-->
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:orientation="horizontal"
+    android:layout_height="wrap_content"
+    android:layout_width="match_parent"
+    android:minHeight="@*android:dimen/car_activity_resolver_list_item_height"
+    android:background="?android:attr/colorBackgroundFloating" >
+    <ImageView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_marginStart="?android:attr/listPreferredItemPaddingStart"
+        android:layout_gravity="center"
+        android:clickable="false"
+        android:focusable="false"
+        android:duplicateParentState="true"
+        android:src="@drawable/activated_state_radio_button"/>
+
+    <ImageView android:id="@*android:id/icon"
+        android:layout_width="@*android:dimen/car_icon_size"
+        android:layout_height="@*android:dimen/car_icon_size"
+        android:layout_gravity="start|center_vertical"
+        android:layout_marginStart="@*android:dimen/car_padding_4"
+        android:scaleType="fitXY" />
+
+    <LinearLayout android:gravity="start|center_vertical"
+        android:orientation="vertical"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+        android:layout_height="wrap_content"
+        android:layout_width="wrap_content"
+        android:layout_gravity="start|center_vertical">
+        <!-- Activity name -->
+        <TextView android:id="@*android:id/text1"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_gravity="start|center_vertical"
+            style="?android:attr/textAppearanceListItem"
+            android:minLines="1"
+            android:maxLines="1"
+            android:ellipsize="marquee" />
+        <!-- Extended activity info to distinguish between duplicate activity names -->
+        <TextView android:id="@*android:id/text2"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_gravity="center_vertical"
+            style="?android:attr/textAppearanceListItemSecondary"
+            android:minLines="1"
+            android:maxLines="1"
+            android:ellipsize="marquee" />
+    </LinearLayout>
+</LinearLayout>
\ No newline at end of file
diff --git a/car_product/car_ui_portrait/rro/android/res/values/dimens.xml b/car_product/car_ui_portrait/rro/android/res/values/dimens.xml
index 691a0ae5b8..621b38cec7 100644
--- a/car_product/car_ui_portrait/rro/android/res/values/dimens.xml
+++ b/car_product/car_ui_portrait/rro/android/res/values/dimens.xml
@@ -97,4 +97,13 @@
     <dimen name="car_activity_resolver_width">832dp</dimen>
     <dimen name="car_activity_resolver_corner_radius">48dp</dimen>
     <dimen name="car_activity_resolver_list_max_height">516dp</dimen>
+
+    <!-- Radio buttons -->
+    <dimen name="car_radio_button_outer_ring_size">48dp</dimen>
+    <dimen name="car_radio_button_outer_ring_stroke_width">4dp</dimen>
+    <dimen name="car_radio_button_inner_circle_size">32dp</dimen>
+    <dimen name="car_radio_button_focus_ring_size">69dp</dimen>
+    <dimen name="car_radio_button_focus_ring_padding">24dp</dimen>
+    <dimen name="car_radio_button_focus_stroke_width">8dp</dimen>
+    <dimen name="car_radio_button_focus_pressed_stroke_width">4dp</dimen>
 </resources>
diff --git a/car_product/car_ui_portrait/rro/android/res/values/styles_device_default.xml b/car_product/car_ui_portrait/rro/android/res/values/styles_device_default.xml
index 521c869f5b..db26e24566 100644
--- a/car_product/car_ui_portrait/rro/android/res/values/styles_device_default.xml
+++ b/car_product/car_ui_portrait/rro/android/res/values/styles_device_default.xml
@@ -244,6 +244,12 @@
         <item name="android:textColor">@color/car_on_background</item>
     </style>
 
+    <style name="Widget.DeviceDefault.CompoundButton.RadioButton"
+        parent="android:Widget.Material.CompoundButton.RadioButton">
+        <item name="android:button">@drawable/car_radio_button</item>
+        <item name="android:textColor">@color/car_on_surface</item>
+    </style>
+
     <!-- Preference Styles -->
     <style name="Preference.DeviceDefault" parent="*android:Preference.Material">
         <item name="android:layout">@*android:layout/car_preference</item>
diff --git a/car_product/car_ui_portrait/rro/android/res/values/themes_device_defaults.xml b/car_product/car_ui_portrait/rro/android/res/values/themes_device_defaults.xml
index c99866c38b..54b639dc7f 100644
--- a/car_product/car_ui_portrait/rro/android/res/values/themes_device_defaults.xml
+++ b/car_product/car_ui_portrait/rro/android/res/values/themes_device_defaults.xml
@@ -49,6 +49,7 @@
         <item name="android:colorControlNormal">@color/btn_device_default</item>
         <item name="android:colorFocusedHighlight">@color/car_control_highlight</item>
         <item name="android:textColorPrimary">@color/car_on_background</item>
+        <item name="android:textColorPrimaryDisableOnly">@color/car_on_background</item>
         <item name="android:textColorPrimaryInverse">@color/car_background</item>
         <item name="android:textColorSecondary">@color/car_secondary</item>
         <item name="android:textColorSecondaryInverse">@color/car_on_secondary</item>
@@ -62,6 +63,7 @@
 
     <style name="Theme.DeviceDefault.Dialog" parent="android:Theme.Material.Dialog">
         <item name="android:textColorPrimary">@color/car_on_background</item>
+        <item name="android:textColorPrimaryDisableOnly">@color/car_on_background</item>
         <item name="android:textColorPrimaryInverse">@color/car_background</item>
         <item name="android:textColorSecondary">@color/car_secondary</item>
         <item name="android:textColorSecondaryInverse">@color/car_on_secondary</item>
@@ -115,6 +117,7 @@
         <item name="android:colorButtonNormal">@color/btn_device_default</item>
         <item name="android:background">@android:color/transparent</item>
         <item name="android:textColorPrimary">@color/car_alert_dialog_message_text_color</item>
+        <item name="android:textColorPrimaryDisableOnly">@color/car_on_background</item>
         <item name="android:textColorSecondary">@color/car_alert_dialog_message_text_color</item>
         <item name="android:textColorTertiary">@color/car_alert_dialog_message_text_color</item>
 
diff --git a/car_product/car_ui_portrait/rro/car-ui-customizations/res/drawable/car_ui_app_styled_view_background.xml b/car_product/car_ui_portrait/rro/car-ui-customizations/res/drawable/car_ui_app_styled_view_background.xml
new file mode 100644
index 0000000000..fd6a9f448e
--- /dev/null
+++ b/car_product/car_ui_portrait/rro/car-ui-customizations/res/drawable/car_ui_app_styled_view_background.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle">
+    <solid android:color="@color/car_surface_2"/>
+    <corners android:radius="48dp"/>
+</shape>
diff --git a/car_product/car_ui_portrait/rro/car-ui-customizations/res/values/colors.xml b/car_product/car_ui_portrait/rro/car-ui-customizations/res/values/colors.xml
index 74977c1b87..41d38ef79b 100644
--- a/car_product/car_ui_portrait/rro/car-ui-customizations/res/values/colors.xml
+++ b/car_product/car_ui_portrait/rro/car-ui-customizations/res/values/colors.xml
@@ -15,9 +15,10 @@
   ~ limitations under the License.
   -->
 <resources xmlns:android="http://schemas.android.com/apk/res/android">
+    <color name="car_ui_preference_primary_summary">@color/car_on_surface_variant</color>
     <color name="car_ui_preference_primary_switch_background_color">@color/car_primary_container</color>
-    <color name="car_ui_toolbar_nav_icon_color">@color/car_ui_text_color_primary</color>
     <color name="car_ui_preference_primary_title">@color/car_on_surface</color>
-    <color name="car_ui_preference_primary_summary">@color/car_on_surface_variant</color>
     <color name="car_ui_preference_two_action_divider_color">@color/car_outline</color>
+    <color name="car_ui_toolbar_nav_icon_color">@color/car_ui_text_color_primary</color>
+    <color name="car_ui_toolbar_search_hint_text_color">@color/car_ui_text_color_primary</color>
 </resources>
diff --git a/car_product/car_ui_portrait/rro/car-ui-customizations/res/xml/overlays.xml b/car_product/car_ui_portrait/rro/car-ui-customizations/res/xml/overlays.xml
index cbc3c592d2..71181a2651 100644
--- a/car_product/car_ui_portrait/rro/car-ui-customizations/res/xml/overlays.xml
+++ b/car_product/car_ui_portrait/rro/car-ui-customizations/res/xml/overlays.xml
@@ -40,6 +40,7 @@
     <item target="dimen/car_ui_dialog_edittext_margin_top" value="@dimen/car_ui_dialog_edittext_margin_top"/>
     <item target="dimen/car_ui_list_item_text_no_icon_start_margin" value="@dimen/car_ui_list_item_text_no_icon_start_margin"/>
 
+    <item target="drawable/car_ui_app_styled_view_background" value="@drawable/car_ui_app_styled_view_background" />
     <item target="drawable/car_ui_recyclerview_ic_up" value="@drawable/car_ui_recyclerview_ic_up" />
     <item target="drawable/car_ui_recyclerview_ic_down" value="@drawable/car_ui_recyclerview_ic_down" />
     <item target="drawable/car_ui_recyclerview_scrollbar_thumb" value="@drawable/car_ui_recyclerview_scrollbar_thumb" />
@@ -48,10 +49,10 @@
 
     <item target="color/car_ui_text_color_primary" value="@color/car_ui_text_color_primary" />
     <item target="color/car_ui_text_color_secondary" value="@color/car_ui_text_color_secondary" />
+    <item target="color/car_ui_toolbar_search_hint_text_color" value="@color/car_ui_toolbar_search_hint_text_color" />
     <item target="color/car_ui_toolbar_tab_item_selector" value="@color/car_ui_toolbar_tab_item_selector" />
     <item target="color/car_ui_preference_two_action_divider_color" value="@color/car_ui_preference_two_action_divider_color" />
 
-
     <item target="drawable/car_ui_list_item_background" value="@drawable/car_ui_list_item_background" />
     <item target="drawable/car_ui_toolbar_background" value="@drawable/car_ui_toolbar_background" />
     <item target="drawable/car_ui_toolbar_menu_item_divider" value="@drawable/car_ui_toolbar_menu_item_divider" />
diff --git a/car_product/car_ui_portrait/rro/car_ui_portrait_rro.mk b/car_product/car_ui_portrait/rro/car_ui_portrait_rro.mk
index b48385e9fc..e6360ae14a 100644
--- a/car_product/car_ui_portrait/rro/car_ui_portrait_rro.mk
+++ b/car_product/car_ui_portrait/rro/car_ui_portrait_rro.mk
@@ -25,6 +25,7 @@ PRODUCT_PACKAGES += \
     CarUiPortraitAppGridReferenceRRO \
     CarUiPortraitCarServiceRRO \
     CarUiPortraitCommon \
+    CarUiPortraitDataSubscriptionReferenceRRO \
     CarUiPortraitDialerRRO \
     CarUiPortraitFrameworkResRRO \
     CarUiPortraitLauncherAppsRRO \
diff --git a/car_product/car_ui_portrait/test/hostsidetests/car/Android.bp b/car_product/car_ui_portrait/test/hostsidetests/car/Android.bp
index c87103ea4e..e26d3bb571 100644
--- a/car_product/car_ui_portrait/test/hostsidetests/car/Android.bp
+++ b/car_product/car_ui_portrait/test/hostsidetests/car/Android.bp
@@ -14,6 +14,7 @@
 
 package {
     default_applicable_licenses: ["Android-Apache-2.0"],
+    default_team: "trendy_team_system_experience",
 }
 
 java_test_host {
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/Android.bp b/car_product/distant_display/apps/CarDistantDisplaySystemUI/Android.bp
index 4fda44c192..760a8417f0 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/Android.bp
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/Android.bp
@@ -68,6 +68,8 @@ android_app {
         "privapp_whitelist_com.android.systemui",
         "allowed_privapp_com.android.carsystemui",
     ],
+
+    use_resource_processor: false,
 }
 
 android_library_import {
@@ -77,3 +79,46 @@ android_library_import {
     ],
     sdk_version: "34",
 }
+
+android_library {
+    name: "DistantDisplaySystemUI-tests",
+
+    manifest: "tests/AndroidManifest.xml",
+    resource_dirs: [
+        "tests/res",
+        "res",
+    ],
+    srcs: [
+        "tests/src/**/*.java",
+        "src/**/*.java",
+        "src/**/*.kt",
+        "src/**/I*.aidl",
+    ],
+
+    static_libs: [
+        "CarSystemUI-tests",
+        "displaycompat-service",
+    ],
+
+    libs: [
+        "android.car",
+        "android.car-system-stubs",
+    ],
+    aaptflags: [
+        "--extra-packages",
+        "com.android.systemui",
+    ],
+
+    plugins: ["dagger2-compiler"],
+
+    lint: {
+        test: true,
+    },
+
+    // TODO(b/218518451) re-enable errorprone.
+    errorprone: {
+        enabled: false,
+    },
+    // TODO(b/319708040): re-enable use_resource_processor
+    use_resource_processor: false,
+}
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/AndroidManifest.xml b/car_product/distant_display/apps/CarDistantDisplaySystemUI/AndroidManifest.xml
index bb40040403..75792cf8ac 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/AndroidManifest.xml
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/AndroidManifest.xml
@@ -47,7 +47,7 @@
     <protected-broadcast android:name="REQUEST_FROM_SYSTEM_UI" />
     <application
         tools:replace="android:appComponentFactory"
-        android:appComponentFactory="com.android.systemui.SystemUIAppComponentFactory">
+        android:appComponentFactory="com.android.systemui.CarDistantDisplaySystemUIAppComponentFactory">
         <activity
             android:name=".car.distantdisplay.activity.DistantDisplayCompanionActivity"
             android:documentLaunchMode="always"
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/layout/car_top_system_bar.xml b/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/layout/car_top_system_bar.xml
index d45a291368..c8e595b504 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/layout/car_top_system_bar.xml
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/layout/car_top_system_bar.xml
@@ -97,50 +97,10 @@
                     systemui:controller="com.android.systemui.car.statusicon.ui.DistantDisplayStatusIconController"/>
         </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
 
-        <FrameLayout
-            android:id="@+id/user_name_container"
+        <include layout="@layout/user_name_container"
             android:layout_width="wrap_content"
             android:layout_height="match_parent"
-            android:layout_alignParentEnd="true"
-            android:layout_centerVertical="true">
-            <com.android.systemui.car.systembar.CarSystemBarButton
-                android:id="@+id/user_name"
-                android:layout_width="wrap_content"
-                android:layout_height="@dimen/car_system_bar_user_name_button_height"
-                android:layout_marginEnd="@dimen/car_padding_2"
-                android:background="@drawable/status_icon_background"
-                android:layout_gravity="center_vertical">
-                <LinearLayout
-                    android:layout_width="match_parent"
-                    android:layout_height="match_parent"
-                    android:orientation="horizontal"
-                    android:layout_marginStart="@dimen/car_padding_2"
-                    android:layout_marginEnd="@dimen/car_padding_2"
-                    android:gravity="center_vertical"
-                >
-                    <ImageView
-                        android:id="@+id/user_avatar"
-                        android:layout_width="wrap_content"
-                        android:layout_height="match_parent"
-                        android:src="@drawable/car_ic_users_icon"
-                        android:tint="@color/system_bar_icon_color_with_selection"
-                        android:layout_marginEnd="@dimen/system_bar_user_icon_padding"
-                        android:contentDescription="@string/system_bar_user_avatar"
-                    />
-                    <TextView
-                        android:id="@+id/user_name_text"
-                        android:layout_width="wrap_content"
-                        android:layout_height="match_parent"
-                        android:gravity="center_vertical"
-                        android:textAppearance="@style/TextAppearance.SystemBar.Username"
-                        android:singleLine="true"
-                        android:maxWidth="@dimen/car_system_bar_user_name_max_width"
-                        android:layout_marginEnd="@dimen/system_bar_user_icon_padding"
-                        android:contentDescription="@string/system_bar_user_name_text"
-                    />
-                </LinearLayout>
-            </com.android.systemui.car.systembar.CarSystemBarButton>
-        </FrameLayout>
+            android:layout_alignParentEnd="true" />
     </RelativeLayout>
 
 </com.android.systemui.car.systembar.CarSystemBarView>
\ No newline at end of file
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/layout/car_top_system_bar_dock.xml b/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/layout/car_top_system_bar_dock.xml
index 0f93cc86f3..46f7a0d310 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/layout/car_top_system_bar_dock.xml
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/layout/car_top_system_bar_dock.xml
@@ -64,24 +64,13 @@
         <com.android.systemui.car.systembar.CarSystemBarButton
             android:id="@+id/notifications"
             android:contentDescription="@string/system_bar_notifications_label"
-            android:layout_width="@dimen/car_quick_controls_entry_points_button_width"
+            android:layout_width="wrap_content"
             android:layout_height="match_parent"
             style="@style/TopBarButton"
             android:layout_toLeftOf="@id/distant_display_nav_container"
-            systemui:longIntent="intent:#Intent;action=com.android.car.bugreport.action.START_AUDIO_FIRST;component=com.android.car.bugreport/.BugReportActivity;end">
-            <LinearLayout
-                android:layout_width="match_parent"
-                android:layout_height="match_parent"
-                android:orientation="horizontal"
-                android:gravity="center">
-                <ImageView
-                    android:id="@+id/notification_icon"
-                    android:layout_width="wrap_content"
-                    android:layout_height="match_parent"
-                    android:src="@drawable/car_ic_notification_dock"
-                    android:tint="@color/system_bar_icon_color_with_selection" />
-            </LinearLayout>
-        </com.android.systemui.car.systembar.CarSystemBarButton>
+            systemui:highlightWhenSelected="true"
+            systemui:icon="@drawable/car_ic_notification_dock"
+            systemui:longIntent="intent:#Intent;action=com.android.car.bugreport.action.START_BUG_REPORT;end"/>
 
         <com.android.systemui.car.systembar.CarSystemBarPanelButtonView
             android:id="@+id/distant_display_nav_container"
@@ -118,45 +107,9 @@
             android:layout_toLeftOf="@id/user_name_container"
             android:contentDescription="@string/system_bar_mic_privacy_chip" />
 
-        <FrameLayout
-            android:id="@+id/user_name_container"
+        <include layout="@layout/user_name_container"
             android:layout_width="wrap_content"
             android:layout_height="match_parent"
-            android:layout_alignParentEnd="true"
-            android:layout_centerVertical="true">
-            <com.android.systemui.car.systembar.CarSystemBarButton
-                android:id="@+id/user_name"
-                android:layout_width="wrap_content"
-                android:layout_height="match_parent"
-                style="@style/TopBarButton"
-                android:gravity="center">
-                <LinearLayout
-                    android:layout_width="match_parent"
-                    android:layout_height="match_parent"
-                    android:orientation="horizontal"
-                    android:layout_marginStart="@dimen/car_padding_2"
-                    android:layout_marginEnd="@dimen/car_padding_2"
-                    android:gravity="center_vertical">
-                    <ImageView
-                        android:id="@+id/user_avatar"
-                        android:layout_width="wrap_content"
-                        android:layout_height="match_parent"
-                        android:src="@drawable/car_ic_users_icon"
-                        android:tint="@color/system_bar_icon_color_with_selection"
-                        android:layout_marginEnd="@dimen/system_bar_user_icon_padding"
-                        android:contentDescription="@string/system_bar_user_avatar" />
-                    <TextView
-                        android:id="@+id/user_name_text"
-                        android:layout_width="wrap_content"
-                        android:layout_height="match_parent"
-                        android:gravity="center_vertical"
-                        android:textAppearance="@style/TextAppearance.SystemBar.Username"
-                        android:singleLine="true"
-                        android:maxWidth="@dimen/car_system_bar_user_name_max_width"
-                        android:layout_marginEnd="@dimen/system_bar_user_icon_padding"
-                        android:contentDescription="@string/system_bar_user_name_text" />
-                </LinearLayout>
-            </com.android.systemui.car.systembar.CarSystemBarButton>
-        </FrameLayout>
+            android:layout_alignParentEnd="true" />
     </RelativeLayout>
 </com.android.systemui.car.systembar.CarSystemBarView>
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/values/config.xml b/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/values/config.xml
index ff86e90cb0..43b6199973 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/values/config.xml
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/res/values/config.xml
@@ -31,6 +31,7 @@
         <item>com.android.car.settings/com.android.car.settings.FallbackHome</item>
         <item>com.android.car.driverui/com.android.car.driverui.MainActivity</item>
         <item>com.google.android.apps.maps/com.google.android.maps.LimitedMapsActivity</item>
+        <item>com.google.android.apps.maps/com.google.android.apps.gmm.car.embedded.activity.LimitedMapsActivity</item>
         <item>com.android.car.mapsplaceholder/com.android.car.mapsplaceholder.MapsPlaceholderActivity</item>
         <item>com.android.systemui/com.android.systemui.car.wm.activity.ActivityBlockingActivity</item>
         <item>com.android.car.media/com.android.car.media.MediaActivity</item>
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/GlobalRootComponent.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplayGlobalRootComponent.java
similarity index 71%
rename from car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/GlobalRootComponent.java
rename to car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplayGlobalRootComponent.java
index b87e1003ce..3446981252 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/GlobalRootComponent.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplayGlobalRootComponent.java
@@ -18,6 +18,7 @@ package com.android.systemui;
 
 import com.android.systemui.car.dagger.CarGlobalModule;
 import com.android.systemui.dagger.GlobalModule;
+import com.android.systemui.wmshell.CarDistantDisplayWMComponent;
 
 import dagger.Component;
 
@@ -31,14 +32,20 @@ import javax.inject.Singleton;
         modules = {
                 GlobalModule.class,
                 CarGlobalModule.class,
-                SysUIComponentModule.class
+                CarDistantDisplaySysUIComponentModule.class
         })
-interface GlobalRootComponent extends CarGlobalRootComponent {
+interface CarDistantDisplayGlobalRootComponent extends CarGlobalRootComponent {
     @Component.Builder
     interface Builder extends CarGlobalRootComponent.Builder {
-        GlobalRootComponent build();
+        CarDistantDisplayGlobalRootComponent build();
     }
 
+    /**
+     * Builder for a WMComponent.
+     */
     @Override
-    SysUIComponent.Builder getSysUIComponent();
+    CarDistantDisplayWMComponent.Builder getWMComponentBuilder();
+
+    @Override
+    CarDistantDisplaySysUIComponent.Builder getSysUIComponent();
 }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SysUIComponent.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySysUIComponent.java
similarity index 87%
rename from car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SysUIComponent.java
rename to car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySysUIComponent.java
index 3ec3afb9f3..0a15d94fbe 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SysUIComponent.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySysUIComponent.java
@@ -37,9 +37,9 @@ import java.util.Optional;
         SystemUIModule.class,
         CarSystemUIModule.class,
         CarSystemUICoreStartableModule.class,
-        SystemUIBinder.class,
+        CarDistantDisplaySystemUIBinder.class,
         ShadelessSceneContainerFrameworkModule.class})
-public interface SysUIComponent extends CarSysUIComponent {
+public interface CarDistantDisplaySysUIComponent extends CarSysUIComponent {
     /**
      * Builder for a CarSysUIComponent.
      */
@@ -49,12 +49,12 @@ public interface SysUIComponent extends CarSysUIComponent {
          * sets RootTaskDisplayAreaOrganizer.
          */
         @BindsInstance
-        SysUIComponent.Builder setRootTaskDisplayAreaOrganizer(
+        CarDistantDisplaySysUIComponent.Builder setRootTaskDisplayAreaOrganizer(
                 Optional<RootTaskDisplayAreaOrganizer> r);
 
         /**
          * Builds CarUiDistantDisplaySysUIComponent
          */
-        SysUIComponent build();
+        CarDistantDisplaySysUIComponent build();
     }
 }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SysUIComponentModule.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySysUIComponentModule.java
similarity index 80%
rename from car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SysUIComponentModule.java
rename to car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySysUIComponentModule.java
index db03ee3b73..696e5a5225 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SysUIComponentModule.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySysUIComponentModule.java
@@ -22,9 +22,9 @@ import dagger.Module;
 /**
  * Dagger module for including the CarUiDistantDisplaySysUIComponent.
  */
-@Module(subcomponents = {SysUIComponent.class})
-public abstract class SysUIComponentModule {
+@Module(subcomponents = {CarDistantDisplaySysUIComponent.class})
+public abstract class CarDistantDisplaySysUIComponentModule {
     @Binds
     abstract CarGlobalRootComponent bindSystemUIRootComponent(
-            GlobalRootComponent systemUIRootComponent);
+            CarDistantDisplayGlobalRootComponent systemUIRootComponent);
 }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SystemUIAppComponentFactory.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIAppComponentFactory.java
similarity index 88%
rename from car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SystemUIAppComponentFactory.java
rename to car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIAppComponentFactory.java
index 212e6445fb..0f9fbaa9d0 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SystemUIAppComponentFactory.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIAppComponentFactory.java
@@ -25,10 +25,10 @@ import android.content.Context;
  *
  * @see SystemUIAppComponentFactoryBase
  */
-public class SystemUIAppComponentFactory extends
+public class CarDistantDisplaySystemUIAppComponentFactory extends
         SystemUIAppComponentFactoryBase {
     @Override
     protected SystemUIInitializer createSystemUIInitializer(Context context) {
-        return new DistantDisplaySystemUIInitializer(context);
+        return new CarDistantDisplaySystemUIInitializer(context);
     }
 }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SystemUIBinder.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIBinder.java
similarity index 94%
rename from car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SystemUIBinder.java
rename to car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIBinder.java
index aefd93d314..496d95224a 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/SystemUIBinder.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIBinder.java
@@ -27,7 +27,7 @@ import dagger.multibindings.IntoMap;
 
 /** Binder for AAECarSystemUI specific {@link CoreStartable} modules and components. */
 @Module(includes = {ActivityWindowModule.class, DistantDisplayQuickControlsModule.class})
-abstract class SystemUIBinder extends CarSystemUIBinder {
+abstract class CarDistantDisplaySystemUIBinder extends CarSystemUIBinder {
 
     @Binds
     @IntoMap
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIInitializer.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIInitializer.java
new file mode 100644
index 0000000000..fcf13efb62
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/CarDistantDisplaySystemUIInitializer.java
@@ -0,0 +1,60 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.systemui;
+
+import android.content.Context;
+import android.os.UserHandle;
+
+import com.android.systemui.dagger.GlobalRootComponent;
+import com.android.systemui.dagger.SysUIComponent;
+import com.android.systemui.dagger.WMComponent;
+import com.android.systemui.wmshell.CarDistantDisplayWMComponent;
+
+import java.util.Optional;
+
+
+/**
+ * Class factory to provide AAECarSystemUI specific SystemUI components.
+ */
+public class CarDistantDisplaySystemUIInitializer extends CarSystemUIInitializer {
+    public CarDistantDisplaySystemUIInitializer(Context context) {
+        super(context);
+    }
+
+    @Override
+    protected GlobalRootComponent.Builder getGlobalRootComponentBuilder() {
+        return DaggerCarDistantDisplayGlobalRootComponent.builder();
+    }
+
+    @Override
+    protected SysUIComponent.Builder prepareSysUIComponentBuilder(
+            SysUIComponent.Builder sysUIBuilder, WMComponent wm) {
+        CarDistantDisplayWMComponent carWm = (CarDistantDisplayWMComponent) wm;
+        boolean isSystemUser = UserHandle.myUserId() == UserHandle.USER_SYSTEM;
+        carWm.getDisplaySystemBarsController();
+        if (isSystemUser) {
+            carWm.getCarSystemUIProxy();
+            carWm.getRemoteCarTaskViewTransitions();
+            carWm.getDistantDisplayTransitions();
+        }
+        return ((CarDistantDisplaySysUIComponent.Builder) sysUIBuilder)
+                .setRootTaskDisplayAreaOrganizer(
+                        isSystemUser ? Optional.of(carWm.getRootTaskDisplayAreaOrganizer())
+                                : Optional.empty());
+    }
+
+}
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/CarDistantDisplayMediator.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/CarDistantDisplayMediator.java
new file mode 100644
index 0000000000..fd8c763ec2
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/CarDistantDisplayMediator.java
@@ -0,0 +1,95 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.systemui.car;
+
+import androidx.annotation.AnyThread;
+
+import com.android.internal.annotations.GuardedBy;
+import com.android.systemui.car.distantdisplay.common.DistantDisplayTaskManager;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import javax.inject.Inject;
+import javax.inject.Singleton;
+
+/**
+ * Provides a common connection between the DistantDisplayTaskManager and WM modules that can be
+ * shared.
+ *
+ * It needs to be @Singleton scoped because it is used by a number of components in @WMSingleton &
+ * @SysUISingleton scopes.
+ */
+@Singleton
+public class CarDistantDisplayMediator {
+    // TODO(b/358104325): Add unit tests for this class.
+    private DistantDisplayTaskManager mDistantDisplayTaskManager;
+    private boolean mIsDistantDisplayReady = false;
+    /**
+     * mListeners is guarded by itself.
+     */
+    @GuardedBy("mListeners")
+    private final List<DistantDisplayTaskManagerListener> mListeners = new ArrayList<>();
+
+    @Inject
+    public CarDistantDisplayMediator() {}
+
+    /**
+     * Lets other components set the distant display task manager.
+     */
+    public void setDistantDisplayTaskManager(DistantDisplayTaskManager distantDisplayTaskManager) {
+        mIsDistantDisplayReady = true;
+        mDistantDisplayTaskManager = distantDisplayTaskManager;
+        synchronized (mListeners) {
+            for (DistantDisplayTaskManagerListener listener : mListeners) {
+                listener.onTaskManagerReady(mDistantDisplayTaskManager);
+            }
+        }
+    }
+
+    /**
+     * Let other components hook into the connection to the distant display. If we're already
+     * connected to the distant display, the callback is immediately triggered.
+     */
+    @AnyThread
+    public void addTaskManagerListener(DistantDisplayTaskManagerListener listener) {
+        synchronized (mListeners) {
+            mListeners.add(listener);
+        }
+        if (mIsDistantDisplayReady) {
+            listener.onTaskManagerReady(mDistantDisplayTaskManager);
+        }
+    }
+
+    /**
+     * Remove a distant display task manager listener.
+     */
+    @AnyThread
+    public void removeListener(DistantDisplayTaskManagerListener listener) {
+        synchronized (mListeners) {
+            mListeners.remove(listener);
+        }
+    }
+
+    /**
+     * Listener which is triggered when distant display task manager is created.
+     */
+    public interface DistantDisplayTaskManagerListener {
+        /** Called when the distant display task manager is ready. */
+        void onTaskManagerReady(DistantDisplayTaskManager distantDisplayTaskManager);
+    }
+}
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/DistantDisplayCompanionActivity.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/DistantDisplayCompanionActivity.java
index 1828bfee1a..1355c80674 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/DistantDisplayCompanionActivity.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/DistantDisplayCompanionActivity.java
@@ -28,7 +28,7 @@ import android.widget.Button;
 import android.widget.TextView;
 
 import com.android.systemui.R;
-import com.android.systemui.car.distantdisplay.common.TaskViewController;
+import com.android.systemui.car.distantdisplay.common.DistantDisplayTaskManager;
 
 import javax.inject.Inject;
 
@@ -37,7 +37,7 @@ public class DistantDisplayCompanionActivity extends Activity {
             "key_companion_moved_package_name";
 
     private final Context mContext;
-    private final TaskViewController mTaskViewController;
+    private final DistantDisplayTaskManager mDistantDisplayTaskManager;
 
     /**
      * Create new intent for the DistantDisplayCompanionActivity with the moved package name
@@ -54,9 +54,10 @@ public class DistantDisplayCompanionActivity extends Activity {
     }
 
     @Inject
-    public DistantDisplayCompanionActivity(Context context, TaskViewController taskViewController) {
+    public DistantDisplayCompanionActivity(Context context,
+            DistantDisplayTaskManager distantDisplayTaskManager) {
         mContext = context;
-        mTaskViewController = taskViewController;
+        mDistantDisplayTaskManager = distantDisplayTaskManager;
     }
 
     @Override
@@ -73,7 +74,7 @@ public class DistantDisplayCompanionActivity extends Activity {
         Button moveBackButton = findViewById(R.id.move_back_button);
         if (moveBackButton != null) {
             moveBackButton.setOnClickListener((v) -> {
-                mTaskViewController.moveTaskFromDistantDisplay();
+                mDistantDisplayTaskManager.moveTaskFromDistantDisplay();
             });
         }
     }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/window/ActivityWindowController.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/window/ActivityWindowController.java
index 14d6e70b77..32ea710537 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/window/ActivityWindowController.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/window/ActivityWindowController.java
@@ -22,7 +22,7 @@ import android.os.Build;
 import android.os.UserHandle;
 
 import com.android.systemui.car.distantdisplay.common.DistantDisplayReceiver;
-import com.android.systemui.car.distantdisplay.common.TaskViewController;
+import com.android.systemui.car.distantdisplay.common.DistantDisplayTaskManager;
 import com.android.systemui.dagger.SysUISingleton;
 
 import javax.inject.Inject;
@@ -38,13 +38,13 @@ public class ActivityWindowController {
     public static final String TAG = ActivityWindowController.class.getSimpleName();
     private static final boolean DEBUG = Build.IS_ENG || Build.IS_USERDEBUG;
     private final Context mContext;
-    private final TaskViewController mTaskViewController;
+    private final DistantDisplayTaskManager mDistantDisplayTaskManager;
 
     @Inject
     public ActivityWindowController(Context context,
-            TaskViewController taskViewController) {
+            DistantDisplayTaskManager distantDisplayTaskManager) {
         mContext = context;
-        mTaskViewController = taskViewController;
+        mDistantDisplayTaskManager = distantDisplayTaskManager;
     }
 
     /**
@@ -62,8 +62,8 @@ public class ActivityWindowController {
         IntentFilter filter = new IntentFilter(DistantDisplayReceiver.DISTANT_DISPLAY);
         DistantDisplayReceiver receiver = new DistantDisplayReceiver();
         receiver.register(displayId -> {
-            mTaskViewController.unregister();
-            mTaskViewController.initialize(displayId);
+            mDistantDisplayTaskManager.unregister();
+            mDistantDisplayTaskManager.initialize(displayId);
         });
         mContext.registerReceiverAsUser(receiver,
                 UserHandle.of(ActivityManager.getCurrentUser()),
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/window/ActivityWindowModule.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/window/ActivityWindowModule.java
index e6446a7d2a..0a3cd80576 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/window/ActivityWindowModule.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/activity/window/ActivityWindowModule.java
@@ -24,7 +24,7 @@ import com.android.systemui.dagger.SysUISingleton;
 import com.android.wm.shell.common.HandlerExecutor;
 import com.android.wm.shell.common.ShellExecutor;
 import com.android.wm.shell.common.SyncTransactionQueue;
-import com.android.wm.shell.common.TransactionPool;
+import com.android.wm.shell.shared.TransactionPool;
 
 import dagger.Binds;
 import dagger.Module;
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayController.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayController.java
index 731525f21e..9dda422768 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayController.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayController.java
@@ -16,6 +16,8 @@
 
 package com.android.systemui.car.distantdisplay.common;
 
+import static com.android.systemui.car.distantdisplay.util.Logging.logIfDebuggable;
+
 import android.content.ComponentName;
 import android.content.Context;
 import android.content.Intent;
@@ -27,7 +29,6 @@ import android.media.session.MediaController;
 import android.media.session.MediaSessionManager;
 import android.media.session.MediaSessionManager.OnActiveSessionsChangedListener;
 import android.util.ArraySet;
-import android.util.Log;
 import android.view.Display;
 
 import androidx.annotation.GuardedBy;
@@ -56,14 +57,14 @@ import javax.inject.Inject;
  **/
 @SysUISingleton
 public class DistantDisplayController {
-    public static final String TAG = DistantDisplayController.class.getSimpleName();
+    private static final String TAG = DistantDisplayController.class.getSimpleName();
 
     private final int mDistantDisplayId;
     private final PackageManager mPackageManager;
     private final MediaSessionManager mMediaSessionManager;
     private final Context mContext;
     private final UserTracker mUserTracker;
-    private final TaskViewController mTaskViewController;
+    private final DistantDisplayTaskManager mDistantDisplayTaskManager;
     private final List<ComponentName> mRestrictedActivities;
     private final Drawable mDistantDisplayDrawable;
     private final Drawable mDefaultDisplayDrawable;
@@ -83,22 +84,26 @@ public class DistantDisplayController {
         /**
          * Callback triggered for display changes of the task.
          */
-        default void onDisplayChanged(int displayId) {}
+        default void onDisplayChanged(int displayId) {
+        }
 
         /**
          * Callback triggered for visibility changes.
          */
-        default void onVisibilityChanged(boolean visible) {}
+        default void onVisibilityChanged(boolean visible) {
+        }
     }
 
-    private final TaskViewController.Callback mTaskViewControllerCallback =
-            new TaskViewController.Callback() {
+    private final DistantDisplayTaskManager.Callback mTaskViewControllerCallback =
+            new DistantDisplayTaskManager.Callback() {
                 @Override
                 public void topAppOnDisplayChanged(int displayId, ComponentName componentName) {
+                    logIfDebuggable(TAG,
+                            "topAppOnDisplayChanged displayId " + displayId + " componentName: "
+                                    + componentName);
                     if (displayId == Display.DEFAULT_DISPLAY) {
                         mTopActivityOnDefaultDisplay = componentName;
                         updateButtonState();
-
                     } else if (displayId == mDistantDisplayId) {
                         mTopActivityOnDistantDisplay = componentName;
                         updateButtonState();
@@ -128,10 +133,10 @@ public class DistantDisplayController {
 
     @Inject
     public DistantDisplayController(Context context, UserTracker userTracker,
-            TaskViewController taskViewController) {
+            DistantDisplayTaskManager distantDisplayTaskManager) {
         mContext = context;
         mUserTracker = userTracker;
-        mTaskViewController = taskViewController;
+        mDistantDisplayTaskManager = distantDisplayTaskManager;
         mPackageManager = context.getPackageManager();
         mDistantDisplayId = mContext.getResources().getInteger(R.integer.config_distantDisplayId);
         mDistantDisplayDrawable = mContext.getResources().getDrawable(
@@ -150,7 +155,7 @@ public class DistantDisplayController {
                 userTracker.getUserHandle(),
                 mContext.getMainExecutor(), mOnActiveSessionsChangedListener);
         mUserTracker.addCallback(mUserChangedCallback, context.getMainExecutor());
-        mTaskViewController.addCallback(mTaskViewControllerCallback);
+        mDistantDisplayTaskManager.addCallback(mTaskViewControllerCallback);
     }
 
     /**
@@ -196,7 +201,7 @@ public class DistantDisplayController {
             mediaAppName = (String) applicationInfo.loadLabel(mPackageManager);
             mediaAppIcon = applicationInfo.loadIcon(mPackageManager);
         } catch (PackageManager.NameNotFoundException e) {
-            logIfDebuggable("Error retrieving application info");
+            logIfDebuggable(TAG, "Error retrieving application info");
         }
         MediaDescription mediaDescription = mediaController.getMetadata().getDescription();
         String mediaTitle = (String) mediaDescription.getTitle();
@@ -246,9 +251,9 @@ public class DistantDisplayController {
             public void onAction(@NonNull QCItem item, @NonNull Context context,
                     @NonNull Intent intent) {
                 switch (state) {
-                    case DEFAULT -> mTaskViewController.moveTaskFromDistantDisplay();
-                    case DRIVER_DD -> mTaskViewController.moveTaskToDistantDisplay();
-                    case PASSENGER_DD -> mTaskViewController.moveTaskToRightDistantDisplay();
+                    case DEFAULT -> mDistantDisplayTaskManager.moveTaskFromDistantDisplay();
+                    case DRIVER_DD -> mDistantDisplayTaskManager.moveTaskToDistantDisplay();
+                    case PASSENGER_DD -> mDistantDisplayTaskManager.moveTaskToRightDistantDisplay();
                 }
             }
 
@@ -294,6 +299,7 @@ public class DistantDisplayController {
     }
 
     private void updateButtonState() {
+        logIfDebuggable(TAG, "updateButtonState");
         synchronized (mStatusChangeListeners) {
             mStatusChangeListeners.forEach(this::notifyStatusChangeListener);
         }
@@ -307,17 +313,20 @@ public class DistantDisplayController {
         if (listener == null) return;
 
         if (canMoveBetweenDisplays(mTopActivityOnDistantDisplay)) {
+            logIfDebuggable(TAG, " Task: " + mTopActivityOnDistantDisplay + " changing display to "
+                    + mDistantDisplayId);
             listener.onDisplayChanged(mDistantDisplayId);
             listener.onVisibilityChanged(true);
         } else if (canMoveBetweenDisplays(mTopActivityOnDefaultDisplay)) {
+            logIfDebuggable(TAG, " Task: " + mTopActivityOnDefaultDisplay + " changing display to "
+                    + Display.DEFAULT_DISPLAY);
             listener.onDisplayChanged(Display.DEFAULT_DISPLAY);
             listener.onVisibilityChanged(true);
         } else {
+            logIfDebuggable(TAG,
+                    "cannot move task in b/w displays, changing the visibility for qc to"
+                            + " false");
             listener.onVisibilityChanged(false);
         }
     }
-
-    private static void logIfDebuggable(String message) {
-        Log.d(TAG, message);
-    }
 }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayForegroundTaskMap.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayForegroundTaskMap.java
index dd4c071121..d9dfe9113c 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayForegroundTaskMap.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayForegroundTaskMap.java
@@ -17,6 +17,7 @@
 package com.android.systemui.car.distantdisplay.common;
 
 import android.content.Intent;
+import android.window.WindowContainerToken;
 
 import java.util.LinkedHashMap;
 
@@ -25,7 +26,7 @@ import java.util.LinkedHashMap;
  * element stays towards the end of the list. The elements are mapped with key taskId and value
  * that contain information about a particular task.
  */
-class DistantDisplayForegroundTaskMap {
+public class DistantDisplayForegroundTaskMap {
 
     private final LinkedHashMap<Integer, TaskData> mData;
 
@@ -33,9 +34,9 @@ class DistantDisplayForegroundTaskMap {
         mData = new LinkedHashMap<>();
     }
 
-    void put(int taskId, int displayId, Intent baseIntent) {
+    void put(int taskId, int displayId, Intent baseIntent, WindowContainerToken token) {
         mData.remove(taskId);
-        mData.put(taskId, new TaskData(taskId, displayId, baseIntent));
+        mData.put(taskId, new TaskData(taskId, displayId, baseIntent, token));
     }
 
     TaskData getTopTaskOnDisplay(int displayId) {
@@ -58,15 +59,17 @@ class DistantDisplayForegroundTaskMap {
         return mData.isEmpty();
     }
 
-    static class TaskData {
-        int mTaskId;
-        int mDisplayId;
-        Intent mBaseIntent;
+    public static class TaskData {
+        public int mTaskId;
+        public int mDisplayId;
+        public Intent mBaseIntent;
+        public WindowContainerToken mToken;
 
-        TaskData(int taskId, int displayId, Intent baseIntent) {
+        TaskData(int taskId, int displayId, Intent baseIntent, WindowContainerToken token) {
             mTaskId = taskId;
             mDisplayId = displayId;
             mBaseIntent = baseIntent;
+            mToken = token;
         }
     }
 }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/TaskViewController.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayTaskManager.java
similarity index 88%
rename from car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/TaskViewController.java
rename to car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayTaskManager.java
index 0091c92b46..dc495f3e73 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/TaskViewController.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/common/DistantDisplayTaskManager.java
@@ -18,6 +18,7 @@ package com.android.systemui.car.distantdisplay.common;
 import static android.car.drivingstate.CarUxRestrictions.UX_RESTRICTIONS_NO_VIDEO;
 
 import static com.android.systemui.car.distantdisplay.common.DistantDisplayForegroundTaskMap.TaskData;
+import static com.android.systemui.car.distantdisplay.util.Logging.logIfDebuggable;
 
 import android.app.ActivityManager;
 import android.app.ActivityOptions;
@@ -34,13 +35,16 @@ import android.os.Build;
 import android.os.UserHandle;
 import android.os.UserManager;
 import android.util.Log;
+import android.view.View;
 
 import androidx.annotation.Nullable;
+import androidx.annotation.VisibleForTesting;
 
 import com.android.car.apps.common.util.IntentUtils;
 import com.android.car.ui.utils.CarUxRestrictionsUtil;
 import com.android.systemui.R;
 import com.android.systemui.broadcast.BroadcastDispatcher;
+import com.android.systemui.car.CarDistantDisplayMediator;
 import com.android.systemui.car.distantdisplay.activity.DistantDisplayCompanionActivity;
 import com.android.systemui.car.distantdisplay.activity.DistantDisplayGameController;
 import com.android.systemui.car.distantdisplay.activity.MoveTaskReceiver;
@@ -57,21 +61,22 @@ import com.google.android.car.distantdisplay.service.DistantDisplayService.Servi
 
 import java.util.ArrayList;
 import java.util.Arrays;
+import java.util.HashSet;
 import java.util.List;
 import java.util.Objects;
 
 import javax.inject.Inject;
 
 /**
- * TaskView Controller that manages the implementation details for task views on a distant display.
+ * Distant Display Task Manager that manages the tasks on a distant display.
  * <p>
  * This is also a common class used between two different technical implementation where in one
  * TaskViews are hosted in a window created by systemUI Vs in another where TaskView are created
  * via an activity.
  */
 @SysUISingleton
-public class TaskViewController {
-    public static final String TAG = TaskViewController.class.getSimpleName();
+public class DistantDisplayTaskManager {
+    public static final String TAG = DistantDisplayTaskManager.class.getSimpleName();
     private static final boolean DEBUG = Build.IS_ENG || Build.IS_USERDEBUG;
     private static final int DEFAULT_DISPLAY_ID = 0;
     private static final int INVALID_TASK_ID = -1;
@@ -89,12 +94,13 @@ public class TaskViewController {
     private final List<Callback> mCallbacks = new ArrayList<>();
     private boolean mInitialized;
     private int mDistantDisplayId;
-    private DistantDisplayService mDisplayCompatService;
+    private DistantDisplayService mDistantDisplayService;
     private final DistantDisplayForegroundTaskMap mForegroundTasks =
             new DistantDisplayForegroundTaskMap();
     private int mDistantDisplayRootWallpaperTaskId = INVALID_TASK_ID;
     private MoveTaskReceiver mMoveTaskReceiver;
     private CarUxRestrictionsUtil mCarUxRestrictionsUtil;
+    private HashSet<Integer> mComponentStateSet;
 
     private final CarUxRestrictionsUtil.OnUxRestrictionsChangedListener
             mOnUxRestrictionsChangedListener = carUxRestrictions -> {
@@ -118,10 +124,11 @@ public class TaskViewController {
     private final TaskStackChangeListener mTaskStackChangeLister = new TaskStackChangeListener() {
         @Override
         public void onTaskMovedToFront(ActivityManager.RunningTaskInfo taskInfo) {
-            logIfDebuggable("onTaskMovedToFront: displayId: " + taskInfo.displayId + ", " + taskInfo
-                    + " token: " + taskInfo.token);
-            Intent intent = taskInfo.baseIntent;
-            mForegroundTasks.put(taskInfo.taskId, taskInfo.displayId, taskInfo.baseIntent);
+            logIfDebuggable(TAG,
+                    "onTaskMovedToFront: displayId: " + taskInfo.displayId + ", " + taskInfo
+                            + " token: " + taskInfo.token);
+            mForegroundTasks.put(taskInfo.taskId, taskInfo.displayId, taskInfo.baseIntent,
+                    taskInfo.token);
             if (taskInfo.displayId == DEFAULT_DISPLAY_ID) {
                 notifyListeners(DEFAULT_DISPLAY_ID);
             } else if (taskInfo.displayId == mDistantDisplayId) {
@@ -129,21 +136,29 @@ public class TaskViewController {
                         mContext.getPackageName())) {
                     mDistantDisplayRootWallpaperTaskId = taskInfo.taskId;
                 }
+                if (mComponentStateSet.contains(taskInfo.taskId)) {
+                    mComponentStateSet.remove(taskInfo.taskId);
+                } else {
+                    mDistantDisplayService.updateState(DistantDisplayService.State.DRIVER_DD);
+                }
                 notifyListeners(mDistantDisplayId);
             }
         }
 
         @Override
         public void onTaskDisplayChanged(int taskId, int newDisplayId) {
+            logIfDebuggable(TAG,
+                    "onTaskDisplayChanged: taskId: " + taskId + " newDisplayId: "
+                            + newDisplayId);
             TaskData oldData = mForegroundTasks.get(taskId);
             if (oldData != null) {
                 // If a task has not changed displays, do nothing. If it has truly been moved to
                 // the top of the same display, it should be handled by onTaskMovedToFront
                 if (oldData.mDisplayId == newDisplayId) return;
                 mForegroundTasks.remove(taskId);
-                mForegroundTasks.put(taskId, newDisplayId, oldData.mBaseIntent);
+                mForegroundTasks.put(taskId, newDisplayId, oldData.mBaseIntent, oldData.mToken);
             } else {
-                mForegroundTasks.put(taskId, newDisplayId, null);
+                mForegroundTasks.put(taskId, newDisplayId, null, null);
             }
 
             if (newDisplayId == DEFAULT_DISPLAY_ID || (oldData != null
@@ -151,29 +166,25 @@ public class TaskViewController {
                 // Task on the default display has changed (by either a new task being added or an
                 // old task being moved away) - notify listeners
                 notifyListeners(DEFAULT_DISPLAY_ID);
-                logIfDebuggable(
-                        "onTaskDisplayChanged: taskId: " + taskId + " newDisplayId: "
-                                + newDisplayId);
             }
             if (newDisplayId == mDistantDisplayId || (oldData != null
                     && oldData.mDisplayId == mDistantDisplayId)) {
                 // Task on the distant display has changed  (by either a new task being added or an
                 // old task being moved away) - notify listeners
                 notifyListeners(mDistantDisplayId);
-                logIfDebuggable(
-                        "onTaskDisplayChanged: taskId: " + taskId + " newDisplayId: "
-                                + newDisplayId);
             }
         }
     };
 
     @Inject
-    public TaskViewController(Context context, BroadcastDispatcher broadcastDispatcher,
+    public DistantDisplayTaskManager(Context context,
+            BroadcastDispatcher broadcastDispatcher,
+            CarDistantDisplayMediator carDistantDisplayMediator,
             UserTracker userTracker) {
-
         mContext = context;
         mBroadcastDispatcher = broadcastDispatcher;
         mUserTracker = userTracker;
+        carDistantDisplayMediator.setDistantDisplayTaskManager(this);
         mUserManager = context.getSystemService(UserManager.class);
         mInputManager = context.getSystemService(InputManager.class);
         mDisplayManager = context.getSystemService(DisplayManager.class);
@@ -195,7 +206,7 @@ public class TaskViewController {
                     @Override
                     public void onServiceConnected(DistantDisplayService service) {
                         Log.d(TAG, "TaskViewController onServiceConnected: " + service);
-                        mDisplayCompatService = service;
+                        mDistantDisplayService = service;
                     }
 
                     @Override
@@ -208,6 +219,7 @@ public class TaskViewController {
                     }
                 });
         mDistantDisplayId = mContext.getResources().getInteger(R.integer.config_distantDisplayId);
+        mComponentStateSet = new HashSet<>();
     }
 
     /**
@@ -284,6 +296,15 @@ public class TaskViewController {
         }
     }
 
+    @VisibleForTesting
+    void setDistantDisplayService(DistantDisplayService displayDisplayService) {
+        mDistantDisplayService = displayDisplayService;
+    }
+
+    public int getDistantDisplayId() {
+        return mDistantDisplayId;
+    }
+
     private void setupDebuggingThroughAdb() {
         IntentFilter filter = new IntentFilter(MoveTaskReceiver.MOVE_ACTION);
         mMoveTaskReceiver = new MoveTaskReceiver();
@@ -305,7 +326,8 @@ public class TaskViewController {
             TaskData data = mForegroundTasks.getTopTaskOnDisplay(mDistantDisplayId);
             if (data == null || data.mTaskId == mDistantDisplayRootWallpaperTaskId) return;
             moveTaskToDisplay(data.mTaskId, DEFAULT_DISPLAY_ID);
-            mDisplayCompatService.updateState(DistantDisplayService.State.DEFAULT);
+            mDistantDisplayService.updateState(DistantDisplayService.State.DEFAULT);
+            mComponentStateSet.add(data.mTaskId);
         } else if ((movement.equals(MoveTaskReceiver.MOVE_TO_DISTANT_DISPLAY) || movement.equals(
                 MoveTaskReceiver.MOVE_TO_DISTANT_DISPLAY_PASSENGER))
                 && !mForegroundTasks.isEmpty()) {
@@ -329,7 +351,8 @@ public class TaskViewController {
                     MoveTaskReceiver.MOVE_TO_DISTANT_DISPLAY)
                     ? DistantDisplayService.State.DRIVER_DD
                     : DistantDisplayService.State.PASSENGER_DD;
-            mDisplayCompatService.updateState(state);
+            mDistantDisplayService.updateState(state);
+            mComponentStateSet.add(data.mTaskId);
         }
     }
 
@@ -355,7 +378,8 @@ public class TaskViewController {
             intent = new Intent();
             intent.setComponent(mediaComponent);
             intent.putExtra(Intent.EXTRA_COMPONENT_NAME, componentName.flattenToShortString());
-            intent.putExtra(IntentUtils.EXTRA_MEDIA_BLOCKING_ACTIVITY_DISMISS_ON_PARK, false);
+            intent.putExtra(IntentUtils.EXTRA_MEDIA_BLOCKING_ACTIVITY_EXIT_BUTTON_VISIBILITY,
+                    View.GONE);
             launchUserHandle = mUserTracker.getUserHandle();
         } else {
             intent = DistantDisplayCompanionActivity.createIntent(mContext, packageName);
@@ -419,12 +443,6 @@ public class TaskViewController {
         return componentName.getPackageName();
     }
 
-    private static void logIfDebuggable(String message) {
-        if (DEBUG) {
-            Log.d(TAG, message);
-        }
-    }
-
     /**
      * Called when unregistered - since the top packages can no longer be guaranteed known, notify
      * listeners for both displays that the top package is null.
@@ -455,6 +473,13 @@ public class TaskViewController {
         }
     }
 
+    /**
+     * Return the top task on the distant display.
+     */
+    public TaskData getTopTaskOnDisplay(int displayId) {
+        return mForegroundTasks.getTopTaskOnDisplay(displayId);
+    }
+
     /** Callback to listen to task changes on the default and distant displays. */
     public interface Callback {
         /**
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/util/Logging.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/util/Logging.java
new file mode 100644
index 0000000000..d5a8d9c893
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/distantdisplay/util/Logging.java
@@ -0,0 +1,37 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.systemui.car.distantdisplay.util;
+
+import android.os.Build;
+import android.util.Log;
+
+/**
+ * Utility class for Distant display.
+ */
+public class Logging {
+
+    private static final boolean IS_DEBUGGABLE = Build.IS_ENG || Build.IS_USERDEBUG;
+
+    /**
+     * Use this method for logging on debug builds and keep prod builds faster.
+     */
+    public static void logIfDebuggable(String tag, String message) {
+        if (IS_DEBUGGABLE) {
+            Log.d(tag, message);
+        }
+    }
+}
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/statusicon/ui/DistantDisplayStatusIconController.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/statusicon/ui/DistantDisplayStatusIconController.java
index 80534432a8..9c0b1ffeca 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/statusicon/ui/DistantDisplayStatusIconController.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/statusicon/ui/DistantDisplayStatusIconController.java
@@ -16,6 +16,8 @@
 
 package com.android.systemui.car.statusicon.ui;
 
+import static com.android.systemui.car.distantdisplay.util.Logging.logIfDebuggable;
+
 import android.content.res.Resources;
 import android.graphics.drawable.Drawable;
 
@@ -64,12 +66,14 @@ public class DistantDisplayStatusIconController extends StatusIconViewController
     @Override
     protected void onViewAttached() {
         super.onViewAttached();
+        logIfDebuggable(TAG, "onViewAttached");
         mDistantDisplayController.addDistantDisplayControlStatusInfoListener(this);
     }
 
     @Override
     protected void onViewDetached() {
         super.onViewDetached();
+        logIfDebuggable(TAG, "onViewDetached");
         mDistantDisplayController.removeDistantDisplayControlStatusInfoListener(this);
     }
 
@@ -85,6 +89,7 @@ public class DistantDisplayStatusIconController extends StatusIconViewController
 
     @Override
     public void onDisplayChanged(int displayId) {
+        logIfDebuggable(TAG, "onDisplayChanged " + displayId);
         mCurrentDisplayId = displayId;
         updateStatus();
     }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/statusicon/ui/DistantDisplayStatusIconPanelController.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/statusicon/ui/DistantDisplayStatusIconPanelController.java
index 02a7de809f..5a858c14a9 100644
--- a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/statusicon/ui/DistantDisplayStatusIconPanelController.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/statusicon/ui/DistantDisplayStatusIconPanelController.java
@@ -16,6 +16,8 @@
 
 package com.android.systemui.car.statusicon.ui;
 
+import static com.android.systemui.car.distantdisplay.util.Logging.logIfDebuggable;
+
 import android.view.View;
 
 import com.android.systemui.car.distantdisplay.common.DistantDisplayController;
@@ -35,6 +37,7 @@ import javax.inject.Provider;
 /** Controller for the distant display panel entry point */
 public class DistantDisplayStatusIconPanelController extends CarSystemBarPanelButtonViewController
         implements DistantDisplayController.StatusChangeListener {
+    public static final String TAG = DistantDisplayStatusIconPanelController.class.getSimpleName();
     private final DistantDisplayController mDistantDisplayController;
 
     @AssistedInject
@@ -57,17 +60,20 @@ public class DistantDisplayStatusIconPanelController extends CarSystemBarPanelBu
     @Override
     protected void onViewAttached() {
         super.onViewAttached();
+        logIfDebuggable(TAG, "onViewAttached");
         mDistantDisplayController.addDistantDisplayControlStatusInfoListener(this);
     }
 
     @Override
     protected void onViewDetached() {
         super.onViewDetached();
+        logIfDebuggable(TAG, "onViewDetached");
         mDistantDisplayController.removeDistantDisplayControlStatusInfoListener(this);
     }
 
     @Override
     public void onVisibilityChanged(boolean visible) {
+        logIfDebuggable(TAG, "onVisibilityChanged " + visible);
         mView.setVisibility(visible ? View.VISIBLE : View.GONE);
     }
 }
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/wm/DistantDisplayTransitions.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/wm/DistantDisplayTransitions.java
new file mode 100644
index 0000000000..9b7e263b8a
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/car/wm/DistantDisplayTransitions.java
@@ -0,0 +1,236 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.systemui.car.wm;
+
+import static android.car.feature.Flags.distantDisplayTransitions;
+
+import android.app.ActivityManager;
+import android.app.WindowConfiguration;
+import android.car.Car;
+import android.content.Context;
+import android.hardware.display.DisplayManager;
+import android.os.Handler;
+import android.os.IBinder;
+import android.os.Looper;
+import android.util.Log;
+import android.util.Slog;
+import android.util.SparseArray;
+import android.view.Display;
+import android.view.SurfaceControl;
+import android.window.DisplayAreaInfo;
+import android.window.TransitionInfo;
+import android.window.TransitionRequestInfo;
+import android.window.WindowContainerToken;
+import android.window.WindowContainerTransaction;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+
+import com.android.systemui.Dumpable;
+import com.android.systemui.car.CarDistantDisplayMediator;
+import com.android.systemui.car.CarServiceProvider;
+import com.android.systemui.car.distantdisplay.common.DistantDisplayForegroundTaskMap.TaskData;
+import com.android.systemui.car.distantdisplay.common.DistantDisplayTaskManager;
+import com.android.systemui.dump.DumpManager;
+import com.android.wm.shell.RootTaskDisplayAreaOrganizer;
+import com.android.wm.shell.dagger.WMSingleton;
+import com.android.wm.shell.shared.TransitionUtil;
+import com.android.wm.shell.transition.Transitions;
+
+import java.io.PrintWriter;
+
+import javax.inject.Inject;
+
+/**
+ * This class is the shell transition handler for distant displays which enforces the distant
+ * display policy.
+ */
+@WMSingleton
+public class DistantDisplayTransitions implements Transitions.TransitionHandler,
+        CarServiceProvider.CarServiceOnConnectedListener, Dumpable,
+        CarDistantDisplayMediator.DistantDisplayTaskManagerListener {
+    // TODO(b/358104325): Add unit tests for this class.
+    private static final String TAG = "DistantDisplayTransit";
+    private static final boolean DBG = Log.isLoggable(TAG, Log.DEBUG);
+
+    private final RootTaskDisplayAreaOrganizer mRootTaskDisplayAreaOrganizer;
+    private final SparseArray<WindowContainerToken> mDisplayIdToRootTDAToken = new SparseArray<>();
+    private final DisplayManager mDisplayManager;
+
+    private DistantDisplayTaskManager mDistantDisplayTaskManager;
+    private int mDistantDisplayId = Display.INVALID_DISPLAY;
+
+    @Inject
+    public DistantDisplayTransitions(Transitions transitions,
+            Context context,
+            CarServiceProvider carServiceProvider,
+            CarDistantDisplayMediator carDistantDisplayMediator,
+            RootTaskDisplayAreaOrganizer rootTaskDisplayAreaOrganizer,
+            DumpManager dumpManager) {
+        mDisplayManager = context.getSystemService(DisplayManager.class);
+        mRootTaskDisplayAreaOrganizer = rootTaskDisplayAreaOrganizer;
+        if (!distantDisplayTransitions()) {
+            if (DBG) {
+                Slog.d(TAG, "Not initializing DistantDisplayTransitions, as flag is disabled");
+            }
+            return;
+        }
+
+        if (Transitions.ENABLE_SHELL_TRANSITIONS) {
+            transitions.addHandler(this);
+            carServiceProvider.addListener(this);
+            dumpManager.registerDumpable(this);
+            carDistantDisplayMediator.addTaskManagerListener(this);
+            mDisplayManager.registerDisplayListener(mDisplayListener,
+                    new Handler(Looper.getMainLooper()));
+        } else {
+            Slog.e(TAG,
+                    "Not initializing DistantDisplayTransitions, as shell transitions are "
+                            + "disabled");
+        }
+    }
+
+    private final DisplayManager.DisplayListener mDisplayListener =
+            new DisplayManager.DisplayListener() {
+                @Override
+                public void onDisplayAdded(int displayId) {
+                    mRootTaskDisplayAreaOrganizer.registerListener(displayId, mRootTDAListener);
+                }
+
+                @Override
+                public void onDisplayRemoved(int displayId) {
+                    // No-op
+                }
+
+                @Override
+                public void onDisplayChanged(int displayId) {
+                    // No-op
+                }
+            };
+
+    @Nullable
+    @Override
+    public WindowContainerTransaction handleRequest(@NonNull IBinder transition,
+            @NonNull TransitionRequestInfo request) {
+        if (request.getTriggerTask() == null) {
+            return null;
+        }
+
+        WindowContainerTransaction wct = null;
+        if (mDistantDisplayTaskManager != null) {
+            mDistantDisplayId = mDistantDisplayTaskManager.getDistantDisplayId();
+        }
+
+        if (TransitionUtil.isOpeningType(request.getType()) && !isHome(request.getTriggerTask())
+                && isAlreadyOnDistantDisplay(request.getTriggerTask())) {
+            TaskData taskData = getTopTaskOnDistantDisplay();
+            if (DBG) {
+                Slog.d(TAG, "Task " + taskData.mBaseIntent
+                        + " already running on the distant display. Reparent it to the same "
+                        + "display");
+            }
+            wct = new WindowContainerTransaction();
+            wct.reparent(taskData.mToken, mDisplayIdToRootTDAToken.get(mDistantDisplayId), true);
+        }
+        return wct;
+    }
+
+    @Override
+    public boolean startAnimation(@NonNull IBinder transition, @NonNull TransitionInfo info,
+            @NonNull SurfaceControl.Transaction startTransaction,
+            @NonNull SurfaceControl.Transaction finishTransaction,
+            @NonNull Transitions.TransitionFinishCallback finishCallback) {
+        // TODO(b/350004828): Temporarily return false always
+        return false;
+    }
+
+    private final RootTaskDisplayAreaOrganizer.RootTaskDisplayAreaListener mRootTDAListener =
+            new RootTaskDisplayAreaOrganizer.RootTaskDisplayAreaListener() {
+                @Override
+                public void onDisplayAreaAppeared(DisplayAreaInfo displayAreaInfo) {
+                    if (DBG) {
+                        Slog.d(TAG, "onDisplayAreaAppeared: " + displayAreaInfo);
+                    }
+                    int displayId = displayAreaInfo.displayId;
+                    // TODO(b/360724449): Revisit this logic when architecture moved to 
+                    //  DisplayAreas since there can be multiple DisplayAreas now.
+                    mDisplayIdToRootTDAToken.put(displayId, displayAreaInfo.token);
+                }
+
+                @Override
+                public void onDisplayAreaVanished(DisplayAreaInfo displayAreaInfo) {
+                    if (DBG) {
+                        Slog.d(TAG, "onDisplayAreaVanished: " + displayAreaInfo);
+                    }
+                    int displayId = displayAreaInfo.displayId;
+                    mDisplayIdToRootTDAToken.remove(displayId);
+                }
+
+                @Override
+                public void onDisplayAreaInfoChanged(DisplayAreaInfo displayAreaInfo) {
+                    if (DBG) {
+                        Slog.d(TAG, "onDisplayAreaInfoChanged: " + displayAreaInfo);
+                    }
+                    int displayId = displayAreaInfo.displayId;
+                    mDisplayIdToRootTDAToken.put(displayId, displayAreaInfo.token);
+                }
+            };
+
+    private static boolean isHome(ActivityManager.RunningTaskInfo taskInfo) {
+        return taskInfo.getActivityType() == WindowConfiguration.ACTIVITY_TYPE_HOME;
+    }
+
+    private TaskData getTopTaskOnDistantDisplay() {
+        if (mDistantDisplayTaskManager != null) {
+            return mDistantDisplayTaskManager.getTopTaskOnDisplay(mDistantDisplayId);
+        }
+        return null;
+    }
+
+    private boolean isAlreadyOnDistantDisplay(ActivityManager.RunningTaskInfo taskInfo) {
+        TaskData taskData = getTopTaskOnDistantDisplay();
+        if (taskData != null) {
+            return taskData.mTaskId == taskInfo.taskId && taskData.mDisplayId == mDistantDisplayId;
+        }
+        return false;
+    }
+
+    private void initializeRootTDAOrganizer() {
+        Display[] displays = mDisplayManager.getDisplays();
+        for (int i = 0; i < displays.length; i++) {
+            mRootTaskDisplayAreaOrganizer.registerListener(displays[i].getDisplayId(),
+                    mRootTDAListener);
+        }
+    }
+
+    @Override
+    public void dump(@NonNull PrintWriter writer, @Nullable String[] args) {
+        writer.println("  mDistantDisplayId:" + mDistantDisplayId);
+        // TODO(b/355002192): Add more dumping parameters
+    }
+
+    @Override
+    public void onConnected(Car car) {
+        initializeRootTDAOrganizer();
+    }
+
+    @Override
+    public void onTaskManagerReady(DistantDisplayTaskManager distantDisplayTaskManager) {
+        mDistantDisplayTaskManager = distantDisplayTaskManager;
+        mDistantDisplayId = mDistantDisplayTaskManager.getDistantDisplayId();
+    }
+}
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/wmshell/CarDistantDisplayWMComponent.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/wmshell/CarDistantDisplayWMComponent.java
new file mode 100644
index 0000000000..6f9a679e95
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/src/com/android/systemui/wmshell/CarDistantDisplayWMComponent.java
@@ -0,0 +1,53 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.systemui.wmshell;
+
+import com.android.systemui.car.wm.DistantDisplayTransitions;
+import com.android.wm.shell.RootTaskDisplayAreaOrganizer;
+import com.android.wm.shell.dagger.WMSingleton;
+
+import dagger.Subcomponent;
+
+/**
+ * Dagger Subcomponent for WindowManager.
+ */
+@WMSingleton
+@Subcomponent(modules = {CarWMShellModule.class})
+public interface CarDistantDisplayWMComponent extends CarWMComponent {
+    /**
+     * Builder for a SysUIComponent.
+     */
+    @Subcomponent.Builder
+    interface Builder extends CarWMComponent.Builder {
+        /**
+         * Build the WMComponent.
+         */
+        CarDistantDisplayWMComponent build();
+    }
+
+    /**
+     * get root TDA
+     */
+    @WMSingleton
+    RootTaskDisplayAreaOrganizer getRootTaskDisplayAreaOrganizer();
+
+    /**
+     * Returns the DistantDisplayTransitions used for transitions stuff related to distant displays.
+     */
+    @WMSingleton
+    DistantDisplayTransitions getDistantDisplayTransitions();
+}
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/Android.bp b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/Android.bp
new file mode 100644
index 0000000000..11cd041506
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/Android.bp
@@ -0,0 +1,49 @@
+//
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+//
+
+package {
+    default_team: "trendy_team_system_experience",
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+android_test {
+    name: "CarDistantDisplaySystemUITest",
+
+    dxflags: ["--multi-dex"],
+    platform_apis: true,
+    test_suites: [
+        "device-tests",
+        "automotive-tests",
+    ],
+    static_libs: ["DistantDisplaySystemUI-tests"],
+    compile_multilib: "both",
+
+    jni_libs: [
+        "libdexmakerjvmtiagent",
+        "libmultiplejvmtiagentsinterferenceagent",
+        "libstaticjvmtiagent",
+    ],
+    libs: [
+        "android.test.runner.stubs.system",
+        "telephony-common",
+        "android.test.base.stubs.system",
+    ],
+    aaptflags: [
+        "--extra-packages com.android.systemui",
+    ],
+
+    certificate: "platform",
+}
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/AndroidManifest.xml b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/AndroidManifest.xml
new file mode 100644
index 0000000000..777b46fd90
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/AndroidManifest.xml
@@ -0,0 +1,33 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+          xmlns:tools="http://schemas.android.com/tools"
+          android:sharedUserId="android.uid.system"
+          package="com.android.systemui.tests">
+    <application
+        android:debuggable="true">
+        <uses-library android:name="android.test.runner"/>
+
+        <activity android:name="com.android.systemui.car.distantdisplay.common.TestActivity"
+                  android:exported="false" />
+    </application>
+    <instrumentation
+        android:name="androidx.test.runner.AndroidJUnitRunner"
+        android:label="Tests for Distant Display"
+        android:targetPackage="com.android.systemui.tests"/>
+</manifest>
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/AndroidTest.xml b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/AndroidTest.xml
new file mode 100644
index 0000000000..6a5a208655
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/AndroidTest.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Distant Display Tests">
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarDistantDisplaySystemUITest.apk" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.systemui.tests" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+    </test>
+</configuration>
\ No newline at end of file
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/res/layout/test_activity.xml b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/res/layout/test_activity.xml
new file mode 100644
index 0000000000..98ade30f6d
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/res/layout/test_activity.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/test_container"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+</FrameLayout>
\ No newline at end of file
diff --git a/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/src/com/android/systemui/car/distantdisplay/common/DistantDisplayTaskManagerTest.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/src/com/android/systemui/car/distantdisplay/common/DistantDisplayTaskManagerTest.java
new file mode 100644
index 0000000000..f358007fbb
--- /dev/null
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/src/com/android/systemui/car/distantdisplay/common/DistantDisplayTaskManagerTest.java
@@ -0,0 +1,156 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.systemui.car.distantdisplay.common;
+
+import static junit.framework.Assert.assertEquals;
+import static junit.framework.Assert.assertTrue;
+
+import static org.mockito.Mockito.when;
+
+import android.app.ActivityOptions;
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserHandle;
+
+import androidx.test.filters.SmallTest;
+import androidx.test.runner.AndroidJUnit4;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.systemui.SysuiTestCase;
+import com.android.systemui.broadcast.BroadcastDispatcher;
+import com.android.systemui.car.CarDistantDisplayMediator;
+import com.android.systemui.car.users.CarSystemUIUserUtil;
+import com.android.systemui.settings.UserTracker;
+
+import com.google.android.car.distantdisplay.service.DistantDisplayService;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.concurrent.CountDownLatch;
+import java.util.concurrent.TimeUnit;
+
+@RunWith(AndroidJUnit4.class)
+@SmallTest
+public class DistantDisplayTaskManagerTest extends SysuiTestCase {
+
+    private static final int DEFAULT_DISPLAY_ID = 0;
+    private final UserHandle mUserHandle = UserHandle.of(1000);
+
+    private MockitoSession mSession;
+
+    @Mock
+    private UserTracker mUserTracker;
+
+    @Mock
+    private BroadcastDispatcher mBroadcastDispatcher;
+
+    @Mock
+    private DistantDisplayService mDistantDisplayService;
+
+    @Mock
+    private CarDistantDisplayMediator mCarDistantDisplayMediator;
+
+
+    private DistantDisplayTaskManager mDistantDisplayTaskManager;
+
+    @Before
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .spyStatic(CarSystemUIUserUtil.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        when(mUserTracker.getUserHandle()).thenReturn(mUserHandle);
+        mDistantDisplayTaskManager = new DistantDisplayTaskManager(getContext(),
+                mBroadcastDispatcher, mCarDistantDisplayMediator, mUserTracker);
+        mDistantDisplayTaskManager.setDistantDisplayService(mDistantDisplayService);
+        // TODO: read the display id using DisplayManager
+        mDistantDisplayTaskManager.initialize(3);
+
+    }
+
+    private void startActivity(Context context, Intent intent) {
+        ActivityOptions activityOptions = ActivityOptions.makeBasic();
+        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
+        context.startActivity(intent, activityOptions.toBundle());
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+            mSession = null;
+        }
+    }
+
+    @Test
+    public void launchTask_moveToDistantDisplay() throws InterruptedException {
+        testLaunchOnDefaultDisplay();
+        testMoveTaskOnDistantDisplay();
+    }
+
+    private void testLaunchOnDefaultDisplay() throws InterruptedException {
+        CountDownLatch latch = new CountDownLatch(1);
+        DistantDisplayTaskManager.Callback callback = createCallback(latch, DEFAULT_DISPLAY_ID);
+
+        mDistantDisplayTaskManager.addCallback(callback);
+
+        Intent intent = new Intent(mContext, TestActivity.class);
+        startActivity(mContext, intent);
+
+        verifyCallbackCompletion(latch, "Callback timed out on default display");
+
+        mDistantDisplayTaskManager.removeCallback(callback);
+        waitForIdleSync();
+    }
+
+    private void testMoveTaskOnDistantDisplay() throws InterruptedException {
+        CountDownLatch latch = new CountDownLatch(1);
+        DistantDisplayTaskManager.Callback callback = createCallback(latch,
+                mDistantDisplayTaskManager.getDistantDisplayId());
+
+        mDistantDisplayTaskManager.addCallback(callback);
+        mDistantDisplayTaskManager.moveTaskToDistantDisplay();
+
+        verifyCallbackCompletion(latch, "Callback timed out on distant display");
+    }
+
+    private DistantDisplayTaskManager.Callback createCallback(CountDownLatch latch,
+            int expectedDisplayId) {
+        return (displayId, componentName) -> {
+            if (componentName == null) {
+                return;
+            }
+            assertTrue(
+                    componentName.getClassName().contains(TestActivity.class.getSimpleName()));
+            assertEquals(expectedDisplayId, displayId);
+            latch.countDown();
+        };
+    }
+
+    private void verifyCallbackCompletion(CountDownLatch latch, String timeoutMessage)
+            throws InterruptedException {
+        assertTrue(timeoutMessage, latch.await(5, TimeUnit.SECONDS));
+    }
+}
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarTopSystemBarButton.java b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/src/com/android/systemui/car/distantdisplay/common/TestActivity.java
similarity index 53%
rename from car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarTopSystemBarButton.java
rename to car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/src/com/android/systemui/car/distantdisplay/common/TestActivity.java
index ee7f69a28d..9524a7de4f 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSystemUI/src/com/android/systemui/car/systembar/CarTopSystemBarButton.java
+++ b/car_product/distant_display/apps/CarDistantDisplaySystemUI/tests/src/com/android/systemui/car/distantdisplay/common/TestActivity.java
@@ -1,5 +1,5 @@
 /*
- * Copyright (C) 2022 The Android Open Source Project
+ * Copyright (C) 2024 The Android Open Source Project
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -14,20 +14,18 @@
  * limitations under the License.
  */
 
-package com.android.systemui.car.systembar;
+package com.android.systemui.car.distantdisplay.common;
 
-import android.content.Context;
-import android.util.AttributeSet;
+import android.app.Activity;
+import android.os.Bundle;
 
 import com.android.systemui.R;
 
-/**
- * CarTopSystemBarButton is an {@link CarSystemBarButton} that is used in top status bar and does
- * not use car_nav_button_icon.
- */
-public class CarTopSystemBarButton extends CarSystemBarButton  {
-    public CarTopSystemBarButton(Context context, AttributeSet attrs) {
-        super(context, attrs);
-        this.removeView(findViewById(R.id.car_nav_button_icon));
+public class TestActivity extends Activity {
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        setContentView(R.layout.test_activity);
     }
 }
diff --git a/car_product/distant_display/rro/DriverUiRRO/res/values/config.xml b/car_product/distant_display/rro/DriverUiRRO/res/values/config.xml
index 856854554c..e5446aa937 100644
--- a/car_product/distant_display/rro/DriverUiRRO/res/values/config.xml
+++ b/car_product/distant_display/rro/DriverUiRRO/res/values/config.xml
@@ -20,7 +20,7 @@
     <string name="figma_doc">a1f1PP0ZdKDWSDif9ZHLml</string>
 
     <string-array name="initial_app_cards">
-        <item>com.example.appcard.sampleapplication : com.example.appcard.sampleapplication : clockAppCard</item>
+        <item>com.example.appcard.sample.weather : com.example.appcard.sample.weather : sampleWeatherAppCard</item>
         <item>com.example.appcard.sample.media : com.example.appcard.sample.media : mediaAppCard</item>
         <item>com.example.appcard.sampleapplication : com.example.appcard.sampleapplication : calendarAppCard</item>
     </string-array>
diff --git a/car_product/init/init.car.rc b/car_product/init/init.car.rc
index 81e40b94a1..426352b981 100644
--- a/car_product/init/init.car.rc
+++ b/car_product/init/init.car.rc
@@ -2,3 +2,11 @@
 on post-fs-data
     mkdir /data/system/car 0700 system system
     mkdir /data/system/car/watchdog 0700 system system
+
+# Swapon hibernation block device before suspend to disk
+on property:sys.hibernate=1 && property:ro.sys.hibernate_enabled=1 && property:ro.sys.swap_storage_device=*
+    swapon_all /vendor/etc/fstab.hibernationswap
+
+# Swapoff hibernation block device after resume from hibernation
+on property:sys.hibernate=0 && property:ro.sys.hibernate_enabled=1 && property:ro.sys.swap_storage_device=*
+    swapoff ${ro.sys.swap_storage_device}
diff --git a/car_product/rro/CarSystemUIPassengerRRO/res/layout/car_passenger_bottom_system_bar.xml b/car_product/rro/CarSystemUIPassengerRRO/res/layout/car_passenger_bottom_system_bar.xml
index 9c1a716549..644cc25a68 100644
--- a/car_product/rro/CarSystemUIPassengerRRO/res/layout/car_passenger_bottom_system_bar.xml
+++ b/car_product/rro/CarSystemUIPassengerRRO/res/layout/car_passenger_bottom_system_bar.xml
@@ -60,7 +60,7 @@
                 android:id="@+id/home"
                 android:contentDescription="@string/system_bar_passenger_home_label"
                 style="@style/SystemBarButton"
-                systemui:componentNames="com.android.car.multidisplay.passenger/.LauncherActivity"
+                systemui:componentNames="com.android.car.carlauncher/.CarLauncher"
                 systemui:highlightWhenSelected="true"
                 systemui:icon="@drawable/car_ic_home"
                 systemui:intent="intent:#Intent;action=android.intent.action.MAIN;category=android.intent.category.HOME;launchFlags=0x14000000;end"/>
@@ -106,19 +106,15 @@
             app:systemBarDisable2Flags="quickSettings"
             app:showAsDropDown="false"
             app:gravity="bottom|end">
-            <ImageView
+            <com.android.systemui.car.systembar.element.layout.CarSystemBarImageView
                 android:id="@+id/user_icon"
                 android:layout_width="@dimen/car_quick_controls_entry_points_icon_width"
                 android:layout_height="match_parent"
                 android:adjustViewBounds="true"
                 android:src="@drawable/car_user_icon_circle_background"
                 android:scaleType="fitCenter"
-                android:layout_marginEnd="@dimen/car_quick_controls_entry_points_icon_space"/>
-            <TextView
-                android:id="@+id/user_name_text"
-                android:layout_width="wrap_content"
-                android:layout_height="match_parent"
-                android:visibility="gone"/>
+                android:layout_marginEnd="@dimen/car_quick_controls_entry_points_icon_space"
+                systemui:controller="com.android.systemui.car.systembar.UserNameImageViewController"/>
             <com.android.systemui.car.statusicon.StatusIconView
                 android:id="@+id/media_volume_status_icon"
                 android:layout_width="wrap_content"
diff --git a/car_product/rro/CarSystemUIPassengerRRO/res/layout/car_quick_controls_panel.xml b/car_product/rro/CarSystemUIPassengerRRO/res/layout/car_quick_controls_panel.xml
index 453f6b284f..7f9992a4b6 100644
--- a/car_product/rro/CarSystemUIPassengerRRO/res/layout/car_quick_controls_panel.xml
+++ b/car_product/rro/CarSystemUIPassengerRRO/res/layout/car_quick_controls_panel.xml
@@ -143,7 +143,7 @@
                     app:layout_constraintHorizontal_weight="9"
                     app:layout_constraintStart_toStartOf="parent"
                     app:layout_constraintEnd_toStartOf="@+id/settings_button">
-                    <ImageView
+                    <com.android.systemui.car.systembar.element.layout.CarSystemBarImageView
                         android:id="@+id/user_icon"
                         android:layout_width="0dp"
                         android:layout_height="match_parent"
@@ -151,8 +151,9 @@
                         android:layout_marginStart="@dimen/car_padding_1"
                         app:layout_constraintDimensionRatio="1:1"
                         app:layout_constraintStart_toStartOf="parent"
-                        app:layout_constraintEnd_toStartOf="@+id/user_name_text"/>
-                    <TextView
+                        app:layout_constraintEnd_toStartOf="@+id/user_name_text"
+                        app:controller="com.android.systemui.car.systembar.UserNameImageViewController"/>
+                    <com.android.systemui.car.systembar.element.layout.CarSystemBarTextView
                         android:id="@+id/user_name_text"
                         android:layout_width="0dp"
                         android:layout_height="match_parent"
@@ -163,7 +164,8 @@
                         android:layout_marginEnd="@dimen/car_padding_2"
                         app:layout_constraintHorizontal_weight="1"
                         app:layout_constraintStart_toEndOf="@id/user_icon"
-                        app:layout_constraintEnd_toStartOf="@+id/chevron_right"/>
+                        app:layout_constraintEnd_toStartOf="@+id/chevron_right"
+                        app:controller="com.android.systemui.car.systembar.UserNameTextViewController"/>
                     <ImageView
                         android:id="@+id/chevron_right"
                         android:layout_width="0dp"
diff --git a/car_product/rro/DriveModeOnRRO/res/layout/qc_status_icons_horizontal.xml b/car_product/rro/DriveModeOnRRO/res/layout/qc_status_icons_horizontal.xml
index ddc31e9e88..8f1113980b 100644
--- a/car_product/rro/DriveModeOnRRO/res/layout/qc_status_icons_horizontal.xml
+++ b/car_product/rro/DriveModeOnRRO/res/layout/qc_status_icons_horizontal.xml
@@ -71,14 +71,15 @@
         systemui:panelLayoutRes="@layout/qc_display_panel"
         systemui:disabledWhileUnprovisioned="true"
         systemui:systemBarDisable2Flags="quickSettings">
-        <com.android.systemui.car.statusicon.StatusIconView
+        <ImageView
             android:id="@+id/display_status_icon"
             android:layout_width="wrap_content"
             android:layout_height="match_parent"
             android:layout_gravity="center"
             android:tint="@color/car_status_icon_color"
             android:duplicateParentState="true"
-            systemui:controller="com.android.systemui.car.statusicon.ui.DisplayStatusIconController"/>
+            android:src="@drawable/car_ic_brightness"
+            android:contentDescription="@string/status_icon_display_status"/>
     </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
     <com.android.systemui.car.systembar.CarSystemBarPanelButtonView
         android:id="@+id/drive_mode_panel_button"
diff --git a/car_product/rro/DriveModeOnRRO/res/layout/qc_status_icons_vertical.xml b/car_product/rro/DriveModeOnRRO/res/layout/qc_status_icons_vertical.xml
index c991638eae..63f83a4b63 100644
--- a/car_product/rro/DriveModeOnRRO/res/layout/qc_status_icons_vertical.xml
+++ b/car_product/rro/DriveModeOnRRO/res/layout/qc_status_icons_vertical.xml
@@ -71,14 +71,15 @@
         systemui:panelLayoutRes="@layout/qc_display_panel"
         systemui:disabledWhileUnprovisioned="true"
         systemui:systemBarDisable2Flags="quickSettings">
-        <com.android.systemui.car.statusicon.StatusIconView
+        <ImageView
             android:id="@+id/display_status_icon"
             android:layout_height="wrap_content"
             android:layout_width="match_parent"
             android:layout_gravity="center"
             android:tint="@color/car_status_icon_color"
             android:duplicateParentState="true"
-            systemui:controller="com.android.systemui.car.statusicon.ui.DisplayStatusIconController"/>
+            android:src="@drawable/car_ic_brightness"
+            android:contentDescription="@string/status_icon_display_status"/>
     </com.android.systemui.car.systembar.CarSystemBarPanelButtonView>
     <com.android.systemui.car.systembar.CarSystemBarPanelButtonView
         android:id="@+id/drive_mode_panel_button"
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/Android.bp b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/Android.bp
new file mode 100644
index 0000000000..f0958ff2ca
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/Android.bp
@@ -0,0 +1,20 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+android_library {
+    name: "OEMDesignTokenBase",
+    resource_dirs: ["src/main/res"],
+    manifest: "src/main/AndroidManifest.xml",
+    sdk_version: "current",
+}
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/Android.bp b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/Android.bp
new file mode 100644
index 0000000000..c414a6c34a
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/Android.bp
@@ -0,0 +1,20 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+android_library {
+    name: "NorthStarBase",
+    resource_dirs: ["res"],
+    manifest: "AndroidManifest.xml",
+    sdk_version: "current",
+}
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/AndroidManifest.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/AndroidManifest.xml
new file mode 100644
index 0000000000..c141ea898b
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/AndroidManifest.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+          package="northstar.base">
+</manifest>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/font/moderustic.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/font/moderustic.xml
new file mode 100644
index 0000000000..b9e38655be
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/font/moderustic.xml
@@ -0,0 +1,7 @@
+<?xml version="1.0" encoding="utf-8"?>
+<font-family xmlns:android="http://schemas.android.com/apk/res/android">
+    <font
+        android:fontStyle="normal"
+        android:fontWeight="400"
+        android:font="@font/moderustic_variable" />
+</font-family>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/font/moderustic_variable.ttf b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/font/moderustic_variable.ttf
new file mode 100644
index 0000000000..a8d8a3126b
Binary files /dev/null and b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/font/moderustic_variable.ttf differ
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/colors.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/colors.xml
new file mode 100644
index 0000000000..64394ecd14
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/colors.xml
@@ -0,0 +1,116 @@
+<?xml version='1.0' encoding='UTF-8'?>
+<resources>
+    <color name="color_primary">#FFA17F</color>
+    <color name="color_on_primary">#541700</color>
+    <color name="color_primary_container">#FE5805</color>
+    <color name="color_on_primary_container">#000000</color>
+    <color name="color_secondary">#FFA17F</color>
+    <color name="color_on_secondary">#541700</color>
+    <color name="color_secondary_container">#FE5805</color>
+    <color name="color_on_secondary_container">#000000</color>
+    <color name="color_tertiary">#FFA17F</color>
+    <color name="color_on_tertiary">#541700</color>
+    <color name="color_tertiary_container">#FE5805</color>
+    <color name="color_on_tertiary_container">#000000</color>
+    <color name="color_error">#FFB4AB</color>
+    <color name="color_on_error">#690005</color>
+    <color name="color_error_container">#93000A</color>
+    <color name="color_on_error_container">#FFDAD6</color>
+    <color name="color_outline">#AB897E</color>
+    <color name="color_background">#1E100B</color>
+    <color name="color_on_background">#FADCD3</color>
+    <color name="color_surface">#1E100B</color>
+    <color name="color_on_surface">#FADCD3</color>
+    <color name="color_surface_variant">#5B4037</color>
+    <color name="color_on_surface_variant">#E4BEB2</color>
+    <color name="color_surface_inverse">#FADCD3</color>
+    <color name="color_on_surface_inverse">#3E2C26</color>
+    <color name="color_primary_inverse">#AA3700</color>
+    <color name="color_surface_tint">#FFB59B</color>
+    <color name="color_outline_variant">#5B4037</color>
+    <color name="color_scrim">#000000</color>
+
+    <color name="color_primary_palette_0">#000000</color>
+    <color name="color_primary_palette_10">#380D00</color>
+    <color name="color_primary_palette_20">#5C1A00</color>
+    <color name="color_primary_palette_30">#822800</color>
+    <color name="color_primary_palette_40">#AA3700</color>
+    <color name="color_primary_palette_50">#D44700</color>
+    <color name="color_primary_palette_60">#FE5805</color>
+    <color name="color_primary_palette_70">#FF8C61</color>
+    <color name="color_primary_palette_80">#FFB59B</color>
+    <color name="color_primary_palette_90">#FFDBCF</color>
+    <color name="color_primary_palette_95">#FFEDE8</color>
+    <color name="color_primary_palette_99">#FFFBFF</color>
+    <color name="color_primary_palette_100">#FFFFFF</color>
+
+    <color name="color_secondary_palette_0">#000000</color>
+    <color name="color_secondary_palette_10">#380D00</color>
+    <color name="color_secondary_palette_20">#5C1A00</color>
+    <color name="color_secondary_palette_30">#822800</color>
+    <color name="color_secondary_palette_40">#AA3700</color>
+    <color name="color_secondary_palette_50">#D44700</color>
+    <color name="color_secondary_palette_60">#FE5805</color>
+    <color name="color_secondary_palette_70">#FF8C61</color>
+    <color name="color_secondary_palette_80">#FFB59B</color>
+    <color name="color_secondary_palette_90">#FFDBCF</color>
+    <color name="color_secondary_palette_95">#FFEDE8</color>
+    <color name="color_secondary_palette_99">#FFFBFF</color>
+    <color name="color_secondary_palette_100">#FFFFFF</color>
+
+    <color name="color_tertiary_palette_0">#000000</color>
+    <color name="color_tertiary_palette_10">#380D00</color>
+    <color name="color_tertiary_palette_20">#5C1A00</color>
+    <color name="color_tertiary_palette_30">#822800</color>
+    <color name="color_tertiary_palette_40">#AA3700</color>
+    <color name="color_tertiary_palette_50">#D44700</color>
+    <color name="color_tertiary_palette_60">#FE5805</color>
+    <color name="color_tertiary_palette_70">#FF8C61</color>
+    <color name="color_tertiary_palette_80">#FFB59B</color>
+    <color name="color_tertiary_palette_90">#FFDBCF</color>
+    <color name="color_tertiary_palette_95">#FFEDE8</color>
+    <color name="color_tertiary_palette_99">#FFFBFF</color>
+    <color name="color_tertiary_palette_100">#FFFFFF</color>
+
+    <color name="color_neutral_palette_0">#000000</color>
+    <color name="color_neutral_palette_10">#271812</color>
+    <color name="color_neutral_palette_20">#3E2C26</color>
+    <color name="color_neutral_palette_30">#56423C</color>
+    <color name="color_neutral_palette_40">#6F5A52</color>
+    <color name="color_neutral_palette_50">#8A726A</color>
+    <color name="color_neutral_palette_60">#A58B83</color>
+    <color name="color_neutral_palette_70">#C0A59D</color>
+    <color name="color_neutral_palette_80">#DDC0B7</color>
+    <color name="color_neutral_palette_90">#FADCD3</color>
+    <color name="color_neutral_palette_95">#FFEDE8</color>
+    <color name="color_neutral_palette_99">#FFFBFF</color>
+    <color name="color_neutral_palette_100">#FFFFFF</color>
+
+    <color name="color_neutral_variant_palette_0">#000000</color>
+    <color name="color_neutral_variant_palette_10">#2B160F</color>
+    <color name="color_neutral_variant_palette_20">#432B22</color>
+    <color name="color_neutral_variant_palette_30">#5B4037</color>
+    <color name="color_neutral_variant_palette_40">#75584E</color>
+    <color name="color_neutral_variant_palette_50">#907065</color>
+    <color name="color_neutral_variant_palette_60">#AB897E</color>
+    <color name="color_neutral_variant_palette_70">#C7A397</color>
+    <color name="color_neutral_variant_palette_80">#E4BEB2</color>
+    <color name="color_neutral_variant_palette_90">#FFDBCF</color>
+    <color name="color_neutral_variant_palette_95">#FFEDE8</color>
+    <color name="color_neutral_variant_palette_99">#FFFBFF</color>
+    <color name="color_neutral_variant_palette_100">#FFFFFF</color>
+
+    <color name="color_error_palette_100">#FFFFFF</color>
+    <color name="color_error_palette_99">#FCFCFC</color>
+    <color name="color_error_palette_95">#FFEDE9</color>
+    <color name="color_error_palette_90">#FFDAD4</color>
+    <color name="color_error_palette_80">#FFB4A9</color>
+    <color name="color_error_palette_70">#FF897A</color>
+    <color name="color_error_palette_60">#FF5449</color>
+    <color name="color_error_palette_50">#DD3730</color>
+    <color name="color_error_palette_40">#BA1B1B</color>
+    <color name="color_error_palette_30">#930006</color>
+    <color name="color_error_palette_20">#680003</color>
+    <color name="color_error_palette_10">#410001</color>
+    <color name="color_error_palette_0">#000000</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/dimens.xml
new file mode 100644
index 0000000000..98c8424dff
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/dimens.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024, The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<resources>
+    <dimen name="shape_corner_none">0dp</dimen>
+    <dimen name="shape_corner_extra_small">0dp</dimen>
+    <dimen name="shape_corner_small">0dp</dimen>
+    <dimen name="shape_corner_medium">0dp</dimen>
+    <dimen name="shape_corner_large">0dp</dimen>
+    <dimen name="shape_corner_extra_large">0dp</dimen>
+    <dimen name="shape_corner_full">0dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/styles.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/styles.xml
new file mode 100644
index 0000000000..dc286b8472
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/NorthStarBase/res/values/styles.xml
@@ -0,0 +1,98 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<resources>
+    <style name="BaseTextAppearance">
+        <item name="android:textColor">@color/color_on_background</item>
+        <item name="android:textColorHighlight">@color/color_on_surface_inverse</item>
+        <item name="android:textColorHint">@color/color_on_surface_inverse</item>
+        <item name="android:textColorLink">@color/color_on_surface_inverse</item>
+        <item name="android:textSize">16sp</item>
+        <item name="android:fontFamily">"@font/moderustic</item>
+        <item name="android:textStyle">normal</item>
+    </style>
+
+    <style name="TextAppearance.Display" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Display.Large">
+        <item name="android:textSize">56sp</item>
+    </style>
+
+    <style name="TextAppearance.Display.Medium">
+        <item name="android:textSize">44sp</item>
+    </style>
+
+    <style name="TextAppearance.Display.Small">
+        <item name="android:textSize">36sp</item>
+    </style>
+
+    <style name="TextAppearance.Headline" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Headline.Large">
+        <item name="android:textSize">46sp</item>
+    </style>
+
+    <style name="TextAppearance.Headline.Medium">
+        <item name="android:textSize">40sp</item>
+    </style>
+
+    <style name="TextAppearance.Headline.Small">
+        <item name="android:textSize">36sp</item>
+    </style>
+
+    <style name="TextAppearance.Title" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Title.Large">
+        <item name="android:textSize">32sp</item>
+    </style>
+
+    <style name="TextAppearance.Title.Medium">
+        <item name="android:textSize">28sp</item>
+    </style>
+
+    <style name="TextAppearance.Title.Small">
+        <item name="android:textSize">24sp</item>
+    </style>
+
+    <style name="TextAppearance.Label" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Label.Large">
+        <item name="android:textSize">24sp</item>
+    </style>
+
+    <style name="TextAppearance.Label.Medium">
+        <item name="android:textSize">22sp</item>
+    </style>
+
+    <style name="TextAppearance.Label.Small">
+        <item name="android:textSize">20sp</item>
+    </style>
+
+    <style name="TextAppearance.Body" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Body.Large">
+        <item name="android:textSize">32sp</item>
+    </style>
+
+    <style name="TextAppearance.Body.Medium">
+        <item name="android:textSize">28sp</item>
+    </style>
+
+    <style name="TextAppearance.Body.Small">
+        <item name="android:textSize">24sp</item>
+    </style>
+</resources>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/AndroidManifest.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/AndroidManifest.xml
new file mode 100644
index 0000000000..b4334513c0
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/AndroidManifest.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+          package="oem.brand.model.base">
+</manifest>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values-night/colors.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values-night/colors.xml
new file mode 100644
index 0000000000..71ac33426e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values-night/colors.xml
@@ -0,0 +1,46 @@
+<?xml version='1.0' encoding='UTF-8'?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+ Licensed under the Apache License, Version 2.0 (the "license");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "as_is" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+<resources>
+    <color name="color_primary">#Df8C93</color>
+    <color name="color_on_primary">#35040E</color>
+    <color name="color_primary_container">#72333A</color>
+    <color name="color_on_primary_container">#Ffdadb</color>
+    <color name="color_secondary">#C0999C</color>
+    <color name="color_on_secondary">#271113</color>
+    <color name="color_secondary_container">#5C3F41</color>
+    <color name="color_on_secondary_container">#Ffdadb</color>
+    <color name="color_tertiary">#C19D6D</color>
+    <color name="color_on_tertiary">#241400</color>
+    <color name="color_tertiary_container">#5D421B</color>
+    <color name="color_on_tertiary_container">#Ffddb5</color>
+    <color name="color_error">#Ffb4Ab</color>
+    <color name="color_on_error">#690005</color>
+    <color name="color_error_container">#93000A</color>
+    <color name="color_on_error_container">#Ffdad6</color>
+    <color name="color_outline">#9F8C8D</color>
+    <color name="color_background">#1A1112</color>
+    <color name="color_on_background">#F0Dedf</color>
+    <color name="color_surface">#1A1112</color>
+    <color name="color_on_surface">#F0Dedf</color>
+    <color name="color_surface_variant">#524344</color>
+    <color name="color_on_surface_variant">#D7C1C2</color>
+    <color name="color_surface_inverse">#F0Dedf</color>
+    <color name="color_on_surface_inverse">#382E2E</color>
+    <color name="color_primary_inverse">#8F4A51</color>
+    <color name="color_surface_tint">#Ffb2B8</color>
+    <color name="color_outline_variant">#524344</color>
+    <color name="color_scrim">#000000</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/colors.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/colors.xml
new file mode 100644
index 0000000000..0bf44e1042
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/colors.xml
@@ -0,0 +1,116 @@
+<?xml version='1.0' encoding='UTF-8'?>
+<resources>
+    <color name="color_primary">#48121B</color>
+    <color name="color_on_primary">#Ffffff</color>
+    <color name="color_primary_container">#72333A</color>
+    <color name="color_on_primary_container">#Ffd6D8</color>
+    <color name="color_secondary">#381F21</color>
+    <color name="color_on_secondary">#Ffffff</color>
+    <color name="color_secondary_container">#5C3F41</color>
+    <color name="color_on_secondary_container">#Ffd6D8</color>
+    <color name="color_tertiary">#372100</color>
+    <color name="color_on_tertiary">#Ffffff</color>
+    <color name="color_tertiary_container">#5D421B</color>
+    <color name="color_on_tertiary_container">#Ffdaae</color>
+    <color name="color_error">#Ba1A1A</color>
+    <color name="color_on_error">#Ffffff</color>
+    <color name="color_error_container">#Ffdad6</color>
+    <color name="color_on_error_container">#410002</color>
+    <color name="color_outline">#857374</color>
+    <color name="color_background">#Fff8F7</color>
+    <color name="color_on_background">#22191A</color>
+    <color name="color_surface">#Fff8F7</color>
+    <color name="color_on_surface">#22191A</color>
+    <color name="color_surface_variant">#F4Ddde</color>
+    <color name="color_on_surface_variant">#524344</color>
+    <color name="color_surface_inverse">#382E2E</color>
+    <color name="color_on_surface_inverse">#Ffeded</color>
+    <color name="color_primary_inverse">#Ffb2B8</color>
+    <color name="color_surface_tint">#8F4A51</color>
+    <color name="color_outline_variant">#D7C1C2</color>
+    <color name="color_scrim">#000000</color>
+
+    <color name="color_primary_palette_0">#000000</color>
+    <color name="color_primary_palette_10">#3B0711</color>
+    <color name="color_primary_palette_20">#561D25</color>
+    <color name="color_primary_palette_30">#72333A</color>
+    <color name="color_primary_palette_40">#8F4A51</color>
+    <color name="color_primary_palette_50">#AC6169</color>
+    <color name="color_primary_palette_60">#CA7A81</color>
+    <color name="color_primary_palette_70">#E8949B</color>
+    <color name="color_primary_palette_80">#FFB2B8</color>
+    <color name="color_primary_palette_90">#FFDADB</color>
+    <color name="color_primary_palette_95">#FFECED</color>
+    <color name="color_primary_palette_99">#FFFBFF</color>
+    <color name="color_primary_palette_100">#FFFFFF</color>
+
+    <color name="color_secondary_palette_0">#000000</color>
+    <color name="color_secondary_palette_10">#2C1517</color>
+    <color name="color_secondary_palette_20">#44292B</color>
+    <color name="color_secondary_palette_30">#5C3F41</color>
+    <color name="color_secondary_palette_40">#765658</color>
+    <color name="color_secondary_palette_50">#916E71</color>
+    <color name="color_secondary_palette_60">#AC888A</color>
+    <color name="color_secondary_palette_70">#C9A2A4</color>
+    <color name="color_secondary_palette_80">#E5BDBF</color>
+    <color name="color_secondary_palette_90">#FFDADB</color>
+    <color name="color_secondary_palette_95">#FFECED</color>
+    <color name="color_secondary_palette_99">#FFFBFF</color>
+    <color name="color_secondary_palette_100">#FFFFFF</color>
+
+    <color name="color_tertiary_palette_0">#000000</color>
+    <color name="color_tertiary_palette_10">#2A1800</color>
+    <color name="color_tertiary_palette_20">#442C06</color>
+    <color name="color_tertiary_palette_30">#5D421B</color>
+    <color name="color_tertiary_palette_40">#775930</color>
+    <color name="color_tertiary_palette_50">#927146</color>
+    <color name="color_tertiary_palette_60">#AE8B5D</color>
+    <color name="color_tertiary_palette_70">#CAA575</color>
+    <color name="color_tertiary_palette_80">#E8C08E</color>
+    <color name="color_tertiary_palette_90">#FFDDB5</color>
+    <color name="color_tertiary_palette_95">#FFEEDD</color>
+    <color name="color_tertiary_palette_99">#FFFBFF</color>
+    <color name="color_tertiary_palette_100">#FFFFFF</color>
+
+    <color name="color_neutral_palette_0">#000000</color>
+    <color name="color_neutral_palette_10">#22191A</color>
+    <color name="color_neutral_palette_20">#382E2E</color>
+    <color name="color_neutral_palette_30">#4F4444</color>
+    <color name="color_neutral_palette_40">#685B5C</color>
+    <color name="color_neutral_palette_50">#817474</color>
+    <color name="color_neutral_palette_60">#9C8D8E</color>
+    <color name="color_neutral_palette_70">#B7A8A8</color>
+    <color name="color_neutral_palette_80">#D3C3C3</color>
+    <color name="color_neutral_palette_90">#F0DEDF</color>
+    <color name="color_neutral_palette_95">#FFEDED</color>
+    <color name="color_neutral_palette_99">#FFFBFF</color>
+    <color name="color_neutral_palette_100">#FFFFFF</color>
+
+    <color name="color_neutral_variant_palette_0">#000000</color>
+    <color name="color_neutral_variant_palette_10">#241819</color>
+    <color name="color_neutral_variant_palette_20">#3B2D2E</color>
+    <color name="color_neutral_variant_palette_30">#524344</color>
+    <color name="color_neutral_variant_palette_40">#6B5A5B</color>
+    <color name="color_neutral_variant_palette_50">#857374</color>
+    <color name="color_neutral_variant_palette_60">#9F8C8D</color>
+    <color name="color_neutral_variant_palette_70">#BBA6A7</color>
+    <color name="color_neutral_variant_palette_80">#D7C1C2</color>
+    <color name="color_neutral_variant_palette_90">#F4DDDE</color>
+    <color name="color_neutral_variant_palette_95">#FFECED</color>
+    <color name="color_neutral_variant_palette_99">#FFFBFF</color>
+    <color name="color_neutral_variant_palette_100">#FFFFFF</color>
+
+    <color name="color_error_palette_100">#FFFFFF</color>
+    <color name="color_error_palette_99">#FCFCFC</color>
+    <color name="color_error_palette_95">#FFEDE9</color>
+    <color name="color_error_palette_90">#FFDAD4</color>
+    <color name="color_error_palette_80">#FFB4A9</color>
+    <color name="color_error_palette_70">#FF897A</color>
+    <color name="color_error_palette_60">#FF5449</color>
+    <color name="color_error_palette_50">#DD3730</color>
+    <color name="color_error_palette_40">#BA1B1B</color>
+    <color name="color_error_palette_30">#930006</color>
+    <color name="color_error_palette_20">#680003</color>
+    <color name="color_error_palette_10">#410001</color>
+    <color name="color_error_palette_0">#000000</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/dimens.xml
new file mode 100644
index 0000000000..a199de6378
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/dimens.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024, The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<resources>
+    <dimen name="shape_corner_none">0dp</dimen>
+    <dimen name="shape_corner_extra_small">8dp</dimen>
+    <dimen name="shape_corner_small">16dp</dimen>
+    <dimen name="shape_corner_medium">24dp</dimen>
+    <dimen name="shape_corner_large">32dp</dimen>
+    <dimen name="shape_corner_extra_large">48dp</dimen>
+    <!-- Set to arbitrarily large value ensure full corner radius for shapes of all sizes-->
+    <dimen name="shape_corner_full">1000dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/styles.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/styles.xml
new file mode 100644
index 0000000000..adc06101ce
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenBase/src/main/res/values/styles.xml
@@ -0,0 +1,97 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<resources>
+    <style name="BaseTextAppearance">
+        <item name="android:textColor">@color/color_on_background</item>
+        <item name="android:textColorHighlight">@color/color_on_surface_inverse</item>
+        <item name="android:textColorHint">@color/color_on_surface_inverse</item>
+        <item name="android:textColorLink">@color/color_on_surface_inverse</item>
+        <item name="android:textSize">16sp</item>
+        <item name="android:textStyle">normal</item>
+    </style>
+
+    <style name="TextAppearance.Display" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Display.Large">
+        <item name="android:textSize">56sp</item>
+    </style>
+
+    <style name="TextAppearance.Display.Medium">
+        <item name="android:textSize">44sp</item>
+    </style>
+
+    <style name="TextAppearance.Display.Small">
+        <item name="android:textSize">36sp</item>
+    </style>
+
+    <style name="TextAppearance.Headline" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Headline.Large">
+        <item name="android:textSize">46sp</item>
+    </style>
+
+    <style name="TextAppearance.Headline.Medium">
+        <item name="android:textSize">40sp</item>
+    </style>
+
+    <style name="TextAppearance.Headline.Small">
+        <item name="android:textSize">36sp</item>
+    </style>
+
+    <style name="TextAppearance.Title" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Title.Large">
+        <item name="android:textSize">32sp</item>
+    </style>
+
+    <style name="TextAppearance.Title.Medium">
+        <item name="android:textSize">28sp</item>
+    </style>
+
+    <style name="TextAppearance.Title.Small">
+        <item name="android:textSize">24sp</item>
+    </style>
+
+    <style name="TextAppearance.Label" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Label.Large">
+        <item name="android:textSize">24sp</item>
+    </style>
+
+    <style name="TextAppearance.Label.Medium">
+        <item name="android:textSize">22sp</item>
+    </style>
+
+    <style name="TextAppearance.Label.Small">
+        <item name="android:textSize">20sp</item>
+    </style>
+
+    <style name="TextAppearance.Body" parent="BaseTextAppearance" />
+
+    <style name="TextAppearance.Body.Large">
+        <item name="android:textSize">32sp</item>
+    </style>
+
+    <style name="TextAppearance.Body.Medium">
+        <item name="android:textSize">28sp</item>
+    </style>
+
+    <style name="TextAppearance.Body.Small">
+        <item name="android:textSize">24sp</item>
+    </style>
+</resources>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/Android.bp b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/Android.bp
new file mode 100644
index 0000000000..eabbe39ee5
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/Android.bp
@@ -0,0 +1,32 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+package {
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+android_app {
+    name: "OEMDesignTokenCarUiPluginRRO",
+    manifest: "AndroidManifest.xml",
+    sdk_version: "current",
+    resource_dirs: ["res"],
+    aaptflags: [
+        "--no-resource-deduping",
+        "--no-resource-removal",
+    ],
+    libs: [
+        "token-shared-lib-prebuilt",
+    ],
+    enforce_uses_libs: false,
+}
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/AndroidManifest.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/AndroidManifest.xml
new file mode 100644
index 0000000000..5cfb4e8a52
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/AndroidManifest.xml
@@ -0,0 +1,24 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+  <manifest xmlns:android="http://schemas.android.com/apk/res/android"
+    package="oem.brand.model.plugin.rro">
+    <application android:hasCode="false"/>
+    <overlay
+        android:targetPackage="com.chassis.car.ui.plugin"
+        android:targetName="car-ui-lib"
+        android:resourcesMap="@xml/overlays"/>
+</manifest>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_primary_switch_background_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_primary_switch_background_color.xml
new file mode 100644
index 0000000000..b39d685313
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_primary_switch_background_color.xml
@@ -0,0 +1,30 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item android:state_activated="true" app:state_ux_restricted="true"
+        android:color="#1C66B5FF"/>
+    <item android:state_activated="false" app:state_ux_restricted="true"
+        android:color="#75202424"/>
+    <item android:state_activated="true" android:state_enabled="false"
+        android:color="#1C66B5FF"/>
+    <item android:state_activated="false" android:state_enabled="false"
+        android:color="#75202424"/>
+    <item android:state_activated="false"
+        android:color="#202424"/>
+    <item android:color="#3d66B5FF"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_summary_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_summary_color.xml
new file mode 100644
index 0000000000..1518e3b0b4
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_summary_color.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Copy of ?android:attr/textColorPrimary (frameworks/base/res/res/color/text_color_primary.xml)
+     but with a ux restricted state. -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="?com.android.oem.tokens:colorOnSurfaceVariant"/>
+    <item app:state_ux_restricted="true"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="?com.android.oem.tokens:colorOnSurfaceVariant"/>
+    <item android:color="?com.android.oem.tokens:colorOnSurfaceVariant"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_title_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_title_color.xml
new file mode 100644
index 0000000000..f1c03aae9b
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_preference_title_color.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Copy of ?android:attr/textColorPrimary (frameworks/base/res/res/color/text_color_primary.xml)
+     but with a ux restricted state. -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="?com.android.oem.tokens:colorOnSurface"/>
+    <item app:state_ux_restricted="true"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="?com.android.oem.tokens:colorOnSurface"/>
+    <item android:color="?com.android.oem.tokens:colorOnSurface"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_scrollbar_thumb.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_scrollbar_thumb.xml
new file mode 100644
index 0000000000..44957b1a22
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_scrollbar_thumb.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+    Copyright (C) 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<!-- Activated state is used to highlight recycler view scrollbar thumb when rotary scrolling. -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_activated="true" android:color="#94CBFF" />
+    <item android:color="#75FFFFFF" />
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selected_background_color_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selected_background_color_selector.xml
new file mode 100644
index 0000000000..6233f67081
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selected_background_color_selector.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_selected="true"
+        android:color="@color/car_ui_seekbar_thumb_selected_background_color"/>
+    <item android:color="@android:color/transparent"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selected_stroke_color_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selected_stroke_color_selector.xml
new file mode 100644
index 0000000000..06cd6eed1a
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selected_stroke_color_selector.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_selected="true"
+        android:color="@color/car_ui_seekbar_thumb_selected_stroke_color"/>
+    <item android:color="@android:color/transparent"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selector.xml
new file mode 100644
index 0000000000..6c9385436a
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_seekbar_thumb_selector.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_enabled="false"
+        android:color="?com.android.oem.tokens:colorNeutralPalette40"/>
+    <item android:color="?com.android.oem.tokens:colorSurfaceInverse"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_switch_thumb_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_switch_thumb_color.xml
new file mode 100644
index 0000000000..4d65b5a33b
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_switch_thumb_color.xml
@@ -0,0 +1,38 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+          xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item
+        android:state_checked="true" app:state_ux_restricted="true"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="?com.android.oem.tokens:colorOnPrimary" />
+    <item
+        android:state_checked="false" app:state_ux_restricted="true"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="?com.android.oem.tokens:colorSecondary" />
+    <item
+        android:state_checked="true" android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="?com.android.oem.tokens:colorOnPrimary" />
+    <item
+        android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="?com.android.oem.tokens:colorSecondary" />
+    <item
+        android:state_checked="true" android:color="?com.android.oem.tokens:colorOnPrimary" />
+    <item android:color="?com.android.oem.tokens:colorSecondary" />
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_switch_track_background_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_switch_track_background_selector.xml
new file mode 100644
index 0000000000..d1954ea887
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_switch_track_background_selector.xml
@@ -0,0 +1,38 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+          xmlns:app="http://schemas.android.com/apk/res-auto">
+  <item
+      android:state_checked="true" app:state_ux_restricted="true"
+      android:alpha="?android:attr/disabledAlpha"
+      android:color="?com.android.oem.tokens:colorPrimary" />
+  <item
+      android:state_checked="false" app:state_ux_restricted="true"
+      android:alpha="?android:attr/disabledAlpha"
+      android:color="?com.android.oem.tokens:colorSecondaryContainer" />
+  <item
+      android:state_checked="true" android:state_enabled="false"
+      android:alpha="?android:attr/disabledAlpha"
+      android:color="?com.android.oem.tokens:colorPrimary" />
+  <item
+      android:state_enabled="false"
+      android:alpha="?android:attr/disabledAlpha"
+      android:color="?com.android.oem.tokens:colorSecondaryContainer" />
+  <item
+      android:state_checked="true" android:color="?com.android.oem.tokens:colorPrimary" />
+  <item android:color="?com.android.oem.tokens:colorSecondaryContainer" />
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_text_color_primary.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_text_color_primary.xml
new file mode 100644
index 0000000000..7ab5d7589a
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_text_color_primary.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (C) 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<!-- Copy of ?android:attr/textColorPrimary (frameworks/base/res/res/color/text_color_primary.xml)
+     but with a ux restricted state. -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+          xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="?android:attr/textColorPrimary"/>
+    <item app:state_ux_restricted="true"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="?android:attr/textColorPrimary"/>
+    <item android:color="?android:attr/textColorPrimary"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_text_color_secondary.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_text_color_secondary.xml
new file mode 100644
index 0000000000..f490e6ac90
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_text_color_secondary.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (C) 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<!-- Copy of ?android:attr/textColorSecondary (frameworks/base/res/res/color/text_color_secondary.xml)
+     but with a ux restricted state. -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+          xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="?com.android.oem.tokens:colorSecondary"/>
+    <item app:state_ux_restricted="true"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="?com.android.oem.tokens:colorSecondary"/>
+    <item android:color="?com.android.oem.tokens:colorSecondary"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_toolbar_menu_item_icon_background_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_toolbar_menu_item_icon_background_color.xml
new file mode 100644
index 0000000000..096f0cf57c
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_toolbar_menu_item_icon_background_color.xml
@@ -0,0 +1,31 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright (C) 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+  -->
+<!-- The same as @color/car_ui_text_color_primary but with an activated state.
+     ColorStateLists don't support switching to complex colors, so we have to repeat
+     car_ui_text_color_primary here. -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+          xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item android:state_activated="false"
+          android:color="@android:color/transparent"/>
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="?android:attr/colorForeground"/>
+    <item app:state_ux_restricted="true"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="?android:attr/colorForeground"/>
+    <item android:color="?android:attr/colorForeground" />
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_toolbar_menu_item_icon_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_toolbar_menu_item_icon_color.xml
new file mode 100644
index 0000000000..bb8ec01918
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/color/car_ui_toolbar_menu_item_icon_color.xml
@@ -0,0 +1,31 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright (C) 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+  -->
+<!-- The same as @color/car_ui_text_color_primary but with an activated state.
+     ColorStateLists don't support switching to complex colors, so we have to repeat
+     car_ui_text_color_primary here. -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android"
+          xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item android:state_activated="true"
+          android:color="?android:attr/colorBackground"/>
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="?android:attr/colorForeground"/>
+    <item app:state_ux_restricted="true"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="?android:attr/colorForeground"/>
+    <item android:color="?android:attr/colorForeground" />
+</selector>
diff --git a/data/etc/com.android.car.multidisplay.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_button_ripple_background.xml
similarity index 67%
rename from data/etc/com.android.car.multidisplay.xml
rename to car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_button_ripple_background.xml
index 1d3d366c9c..6ba1247179 100644
--- a/data/etc/com.android.car.multidisplay.xml
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_button_ripple_background.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2022 The Android Open Source Project
+  ~ Copyright 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
@@ -12,10 +12,9 @@
   ~ distributed under the License is distributed on an "AS IS" BASIS,
   ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   ~ See the License for the specific language governing permissions and
-  ~ limitations under the License
+  ~ limitations under the License.
   -->
-<permissions>
-    <privapp-permissions package="com.android.car.multidisplay">
-        <permission name="android.permission.INTERACT_ACROSS_USERS"/>
-    </privapp-permissions>
-</permissions>
+
+<ripple
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:color="@color/car_ui_ripple_color" />
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_ic_down.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_ic_down.xml
new file mode 100644
index 0000000000..3e16f483d3
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_ic_down.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:width="48dp"
+        android:height="48dp"
+        android:viewportWidth="48.0"
+        android:viewportHeight="48.0">
+    <path
+        android:pathData="M14.83,16.42L24,25.59l9.17,-9.17L36,19.25l-12,12 -12,-12z"
+        android:fillColor="#FFFFFF"/>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_ic_up.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_ic_up.xml
new file mode 100644
index 0000000000..95a5c9a81f
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable-ldrtl/car_ui_recyclerview_ic_up.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:width="48dp"
+        android:height="48dp"
+        android:viewportWidth="48.0"
+        android:viewportHeight="48.0">
+    <path
+        android:pathData="M14.83,30.83L24,21.66l9.17,9.17L36,28 24,16 12,28z"
+        android:fillColor="#FFFFFF"/>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_switch_track_focus_highlight.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_switch_track_focus_highlight.xml
new file mode 100644
index 0000000000..d72abb4b47
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_switch_track_focus_highlight.xml
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+  <item android:state_focused="true" android:state_pressed="true">
+    <shape android:shape="rectangle">
+      <corners android:radius="36dp" />
+      <solid android:color="#8A94CBFF" />
+      <padding
+          android:left="12dp"
+          android:right="12dp" />
+      <size
+          android:height="72dp"
+          android:width="112dp" />
+      <stroke
+          android:width="4dp"
+          android:color="#94CBFF" />
+    </shape>
+  </item>
+  <item android:state_focused="true">
+    <shape android:shape="rectangle">
+      <corners android:radius="36dp" />
+      <solid android:color="#3D94CBFF" />
+      <padding
+          android:left="12dp"
+          android:right="12dp" />
+      <size
+          android:height="72dp"
+          android:width="112dp" />
+      <stroke
+          android:width="8dp"
+          android:color="#94CBFF" />
+    </shape>
+  </item>
+  <item>
+    <ripple android:color="?android:attr/colorControlHighlight" />
+  </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_icon_arrow_back.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_icon_arrow_back.xml
new file mode 100644
index 0000000000..da268cdddf
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_icon_arrow_back.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024, The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:autoMirrored="true"
+        android:width="24dp"
+        android:height="24dp"
+        android:viewportWidth="24.0"
+        android:viewportHeight="24.0">
+    <path
+        android:fillColor="#FF000000"
+        android:pathData="M20,11H7.83l5.59,-5.59L12,4l-8,8 8,8 1.41,-1.41L7.83,13H20v-2z"/>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_avatar_icon_outline.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_avatar_icon_outline.xml
new file mode 100644
index 0000000000..2aee0a1f3f
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_avatar_icon_outline.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="oval">
+</shape>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_background.xml
new file mode 100644
index 0000000000..97d797aa16
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_background.xml
@@ -0,0 +1,52 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true" android:state_activated="true">
+        <shape android:shape="rectangle">
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <solid android:color="?android:attr/colorControlActivated"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+        </shape>
+    </item>
+    <item android:state_activated="true">
+        <shape>
+            <solid android:color="?android:attr/colorControlActivated"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="?android:attr/colorControlHighlight">
+            <item android:id="@android:id/mask">
+                <color android:color="@android:color/white" />
+            </item>
+        </ripple>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_divider.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_divider.xml
new file mode 100644
index 0000000000..1ef7bdd781
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_list_item_divider.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+    Copyright (C) 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <solid android:color="#33FFFFFF" />
+</shape>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_preference_primary_switch_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_preference_primary_switch_background.xml
new file mode 100644
index 0000000000..c2056471ca
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_preference_primary_switch_background.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:gravity="center">
+        <shape android:shape="rectangle">
+            <corners android:radius="24dp" />
+            <solid android:color="@color/car_ui_preference_primary_switch_background_color" />
+        </shape>
+    </item>
+    <item android:drawable="@drawable/car_ui_preference_primary_switch_rotary_highlight" />
+</layer-list>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_preference_primary_switch_rotary_highlight.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_preference_primary_switch_rotary_highlight.xml
new file mode 100644
index 0000000000..a4b697bfe7
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_preference_primary_switch_rotary_highlight.xml
@@ -0,0 +1,39 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="24dp" />
+            <solid android:color="#8A94CBFF" />
+            <stroke
+                android:width="4dp"
+                android:color="#94CBFF" />
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="24dp" />
+            <solid android:color="#3D94CBFF" />
+            <stroke
+                android:width="8dp"
+                android:color="#94CBFF" />
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="?android:attr/colorControlHighlight" />
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_preference_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_preference_background.xml
new file mode 100644
index 0000000000..831c67f86f
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_preference_background.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <!-- Highlight the preference when it's focused but not selected. The preference is selected in
+    direct manipulation mode. -->
+    <item android:state_focused="true" android:state_selected="false">
+        <shape android:shape="rectangle">
+            <solid android:color="#3D94CBFF"/>
+            <stroke android:width="8dp"
+                    android:color="#94CBFF"/>
+        </shape>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_thumb.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_thumb.xml
new file mode 100644
index 0000000000..194e896fac
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_thumb.xml
@@ -0,0 +1,41 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:aapt="http://schemas.android.com/aapt"
+    android:width="52dp"
+    android:height="52dp"
+    android:viewportWidth="52"
+    android:viewportHeight="52">
+    <path
+        android:pathData="M52,26A26,26 0,0 1,26 52,26 26,0 0,1 0,26 26,26 0,0 1,26 0,26 26,0 0,1 52,26Z"
+        android:fillAlpha="0.56">
+        <aapt:attr name="android:fillColor">
+            <gradient
+                android:gradientRadius="26"
+                android:centerX="26"
+                android:centerY="26"
+                android:type="radial">
+                <item android:offset="0" android:color="#8F000000"/>
+                <item android:offset="0.92307687" android:color="#8F000000"/>
+                <item android:offset="1" android:color="#00000000"/>
+            </gradient>
+        </aapt:attr>
+    </path>
+    <path
+        android:pathData="M26,26m-24,0a24,24 0,1 1,48 0a24,24 0,1 1,-48 0"
+        android:fillColor="@color/car_ui_seekbar_thumb_selector"/>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_thumb_selectable.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_thumb_selectable.xml
new file mode 100644
index 0000000000..8370b764d7
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_thumb_selectable.xml
@@ -0,0 +1,31 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:drawable="@drawable/car_ui_seekbar_thumb"
+        android:gravity="center" />
+    <item
+        android:gravity="center"
+        android:width="@dimen/car_ui_seekbar_thumb_size"
+        android:height="@dimen/car_ui_seekbar_thumb_size">
+        <shape android:shape="oval">
+            <stroke
+                android:color="@color/car_ui_seekbar_thumb_selected_stroke_color_selector"
+                android:width="@dimen/car_ui_seekbar_thumb_selected_stroke_width" />
+            <solid android:color="@color/car_ui_seekbar_thumb_selected_background_color_selector" />
+        </shape>
+    </item>
+</layer-list>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_track.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_track.xml
new file mode 100644
index 0000000000..f04e561369
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_seekbar_track.xml
@@ -0,0 +1,52 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:id="@android:id/background"
+        android:top="@dimen/car_ui_seekbar_track_vertical_padding"
+        android:bottom="@dimen/car_ui_seekbar_track_vertical_padding">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/car_ui_seekbar_thumb_outer_radius" />
+            <size android:height="@dimen/car_ui_seekbar_track_height" />
+            <solid android:color="?com.android.oem.tokens:colorSurfaceVariant" />
+        </shape>
+    </item>
+    <item
+        android:id="@android:id/secondaryProgress"
+        android:top="@dimen/car_ui_seekbar_track_vertical_padding"
+        android:bottom="@dimen/car_ui_seekbar_track_vertical_padding">
+        <scale android:scaleWidth="100%">
+            <shape android:shape="rectangle">
+                <corners android:radius="@dimen/car_ui_seekbar_thumb_outer_radius" />
+                <size android:height="@dimen/car_ui_seekbar_track_height" />
+                <solid android:color="?com.android.oem.tokens:colorSecondary" />
+            </shape>
+        </scale>
+    </item>
+    <item
+        android:id="@android:id/progress"
+        android:top="@dimen/car_ui_seekbar_track_vertical_padding"
+        android:bottom="@dimen/car_ui_seekbar_track_vertical_padding">
+        <clip>
+            <shape android:shape="rectangle">
+                <corners android:radius="@dimen/car_ui_seekbar_thumb_outer_radius" />
+                <size android:height="@dimen/car_ui_seekbar_track_height" />
+                <solid android:color="?com.android.oem.tokens:colorPrimary" />
+            </shape>
+        </clip>
+    </item>
+</layer-list>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_switch_track.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_switch_track.xml
new file mode 100644
index 0000000000..6cbbdc0bc6
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_switch_track.xml
@@ -0,0 +1,38 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+  <item
+      android:bottom="14dp"
+      android:gravity="center"
+      android:top="14dp">
+    <shape android:shape="rectangle">
+      <corners android:radius="24dp" />
+      <padding
+          android:left="4dp"
+          android:right="4dp" />
+      <size
+          android:height="48dp"
+          android:width="88dp" />
+      <solid android:color="@color/car_ui_switch_track_background_selector" />
+    </shape>
+  </item>
+  <item
+      android:bottom="14dp"
+      android:drawable="@drawable/car_switch_track_focus_highlight"
+      android:gravity="center"
+      android:top="14dp" />
+</layer-list>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_divider.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_divider.xml
new file mode 100644
index 0000000000..2df607aab1
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_divider.xml
@@ -0,0 +1,24 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~
+  ~ Copyright (C) 2024 Google Inc.
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  ~
+ -->
+<shape
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <size
+        android:width="16dp"/>
+</shape>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_icon_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_icon_background.xml
new file mode 100644
index 0000000000..aa94b4b482
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_icon_background.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~
+  ~ Copyright (C) 2024 Google Inc.
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  ~
+ -->
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+       android:shape="oval">
+    <size
+        android:width="54dp"
+        android:height="54dp"/>
+    <solid android:color="@color/car_ui_toolbar_menu_item_icon_background_color"/>
+</shape>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_icon_ripple.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_icon_ripple.xml
new file mode 100644
index 0000000000..99e9604fcd
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_menu_item_icon_ripple.xml
@@ -0,0 +1,47 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~
+  ~ Copyright (C) 2024 Google Inc.
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  ~
+ -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape android:shape="oval">
+            <solid android:color="#8A94CBFF"/>
+            <stroke android:width="4dp"
+                    android:color="#94CBFF"/>
+            <size android:width="48dp"
+                  android:height="48dp"/>
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape android:shape="oval">
+            <solid android:color="#3D94CBFF"/>
+            <stroke android:width="8dp"
+                    android:color="#94CBFF"/>
+            <size android:width="48dp"
+                  android:height="48dp"/>
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="#27ffffff">
+            <item android:id="@android:id/mask">
+                <shape android:shape="oval">
+                    <solid android:color="#FFFFFF"/>
+                </shape>
+            </item>
+        </ripple>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_tab_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_tab_background.xml
new file mode 100644
index 0000000000..2aaeae73f2
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/drawable/car_ui_toolbar_tab_background.xml
@@ -0,0 +1,55 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true" android:state_activated="true">
+        <shape android:shape="rectangle">
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <solid android:color="?com.android.oem.tokens:colorSecondaryContainer"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+        </shape>
+    </item>
+    <item android:state_activated="true">
+        <shape>
+            <solid android:color="?com.android.oem.tokens:colorSecondaryContainer"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="?com.android.oem.tokens:colorSecondaryContainer">
+            <item android:id="@android:id/mask">
+                <shape android:shape="rectangle">
+                    <solid android:color="@android:color/white"/>
+                    <corners android:radius="@dimen/car_selectable_item_radius"/>
+                </shape>
+            </item>
+        </ripple>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl-port/car_ui_base_layout_toolbar.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl-port/car_ui_base_layout_toolbar.xml
new file mode 100644
index 0000000000..3c15be9511
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl-port/car_ui_base_layout_toolbar.xml
@@ -0,0 +1,173 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- This is for the two-row version of the toolbar -->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:tag="carUiToolbar">
+
+    <!-- When not in touch mode, if we clear focus in current window, Android will re-focus the
+         first focusable view in the window automatically. Adding a FocusParkingView to the window
+         can fix this issue, because it can take focus, and it is transparent and its default focus
+         highlight is disabled, so it's invisible to the user no matter whether it's focused or not.
+         -->
+    <com.android.car.ui.FocusParkingView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+
+    <FrameLayout
+        android:id="@+id/car_ui_base_layout_content_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <com.android.car.ui.FocusArea
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+        <androidx.constraintlayout.widget.ConstraintLayout
+            android:id="@+id/car_ui_toolbar_background"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:tag="car_ui_top_inset"
+            app:layout_constraintTop_toTopOf="parent">
+            <com.android.car.ui.baselayout.ClickBlockingView
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintRight_toRightOf="parent"
+                app:layout_constraintTop_toTopOf="parent"
+                app:layout_constraintBottom_toBottomOf="parent"/>
+
+            <androidx.constraintlayout.widget.Guideline
+                android:id="@+id/car_ui_toolbar_row_separator_guideline"
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                android:orientation="horizontal"
+                app:layout_constraintGuide_begin="96dp"/>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_nav_icon_container"
+                style="@style/Widget.CarUi.Toolbar.NavIconContainer"
+                android:layout_width="@dimen/car_ui_toolbar_margin"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintTop_toTopOf="parent">
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_nav_icon"
+                    style="@style/Widget.CarUi.Toolbar.NavIcon"
+                    android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+                    android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY"
+                    android:tint="@color/car_ui_text_color_primary"
+                    tools:ignore="UseAppTint" />
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_logo"
+                    android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY" />
+            </FrameLayout>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_title_logo_container"
+                android:layout_width="112dp"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                app:layout_constraintRight_toRightOf="parent"
+                app:layout_constraintTop_toTopOf="parent">
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_title_logo"
+                    android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY" />
+            </FrameLayout>
+
+            <LinearLayout android:layout_height="wrap_content"
+                          android:layout_width="0dp"
+                          android:id="@+id/car_ui_toolbar_title_container"
+                          android:orientation="vertical"
+                          android:layout_marginRight="112dp"
+                          app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                          app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_menu_items_container"
+                          app:layout_constraintRight_toRightOf="parent"
+                          app:layout_constraintTop_toTopOf="parent" >
+                <TextView android:id="@+id/car_ui_toolbar_title"
+                          android:layout_width="wrap_content"
+                          android:layout_height="wrap_content"
+                          android:singleLine="true"
+                          android:textAlignment="viewStart"
+                          android:textAppearance="@style/TextAppearance.CarUi.Widget.Toolbar.Title"/>
+                <TextView android:id="@+id/car_ui_toolbar_subtitle"
+                          android:layout_width="wrap_content"
+                          android:layout_height="wrap_content"
+                          android:visibility="gone"
+                          android:textAlignment="viewStart"
+                          android:textAppearance="?android:attr/textAppearanceSmall"/>
+            </LinearLayout>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_search_view_container"
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                app:layout_constraintLeft_toRightOf="@+id/car_ui_toolbar_menu_items_container"
+                app:layout_constraintRight_toLeftOf="@id/car_ui_toolbar_title_logo_container"
+                app:layout_constraintTop_toTopOf="parent" />
+
+            <LinearLayout
+                android:id="@+id/car_ui_toolbar_menu_items_container"
+                android:divider="@drawable/car_ui_toolbar_menu_item_divider"
+                android:showDividers="beginning|middle|end"
+                android:layout_width="wrap_content"
+                android:layout_height="0dp"
+                android:orientation="horizontal"
+                app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_nav_icon_container"
+                app:layout_constraintTop_toTopOf="parent" />
+
+            <com.android.car.ui.toolbar.TabLayout
+                android:id="@+id/car_ui_toolbar_tabs"
+                android:layout_width="match_parent"
+                android:layout_height="96dp"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintTop_toBottomOf="@id/car_ui_toolbar_row_separator_guideline" />
+
+            <ProgressBar
+                android:id="@+id/car_ui_toolbar_progress_bar"
+                style="@android:style/Widget.DeviceDefault.ProgressBar.Horizontal"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:indeterminate="true"
+                android:visibility="gone"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintRight_toRightOf="parent"
+                app:layout_constraintLeft_toLeftOf="parent" />
+
+        </androidx.constraintlayout.widget.ConstraintLayout>
+    </com.android.car.ui.FocusArea>
+
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_base_layout_toolbar.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_base_layout_toolbar.xml
new file mode 100644
index 0000000000..53047c3a0d
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_base_layout_toolbar.xml
@@ -0,0 +1,171 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:tag="CarUiBaseLayoutToolbar">
+
+    <!-- When not in touch mode, if we clear focus in current window, Android will re-focus the
+         first focusable view in the window automatically. Adding a FocusParkingView to the window
+         can fix this issue, because it can take focus, and it is transparent and its default focus
+         highlight is disabled, so it's invisible to the user no matter whether it's focused or not.
+         -->
+    <com.android.car.ui.FocusParkingView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+
+    <FrameLayout
+        android:id="@+id/car_ui_base_layout_content_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <com.android.car.ui.FocusArea
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+        <androidx.constraintlayout.widget.ConstraintLayout
+            android:id="@+id/car_ui_toolbar_background"
+            android:layout_width="match_parent"
+            android:layout_height="96dp"
+            android:tag="car_ui_top_inset"
+            app:layout_constraintTop_toTopOf="parent">
+            <com.android.car.ui.baselayout.ClickBlockingView
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintRight_toRightOf="parent"
+                app:layout_constraintTop_toTopOf="parent"
+                app:layout_constraintBottom_toBottomOf="parent"/>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_nav_icon_container"
+                style="@style/Widget.CarUi.Toolbar.NavIconContainer"
+                android:layout_width="@dimen/car_ui_toolbar_margin"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintTop_toTopOf="parent">
+
+                <!-- we need to use android:tint instead of app:tint, because we're
+                    not using classes from androidx/appcompat such as AppCompatImageView -->
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_nav_icon"
+                    style="@style/Widget.CarUi.Toolbar.NavIcon"
+                    android:tint="@color/car_ui_text_color_primary"
+                    android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+                    android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY"
+                    tools:ignore="UseAppTint" />
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_logo"
+                    android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY" />
+            </FrameLayout>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_title_logo_container"
+                android:layout_width="112dp"
+                android:layout_height="wrap_content"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintRight_toRightOf="parent"
+                app:layout_constraintTop_toTopOf="parent">
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_title_logo"
+                    android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY" />
+            </FrameLayout>
+
+            <LinearLayout android:layout_height="wrap_content"
+                          android:layout_width="0dp"
+                          android:id="@+id/car_ui_toolbar_title_container"
+                          android:orientation="vertical"
+                          android:layout_marginRight="112dp"
+                          app:layout_constraintBottom_toBottomOf="parent"
+                          app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_menu_items_container"
+                          app:layout_constraintTop_toTopOf="parent"
+                          app:layout_constraintRight_toRightOf="parent">
+                <TextView android:id="@+id/car_ui_toolbar_title"
+                          android:layout_width="wrap_content"
+                          android:layout_height="wrap_content"
+                          android:singleLine="true"
+                          android:textAlignment="viewStart"
+                          android:textAppearance="@style/TextAppearance.CarUi.Widget.Toolbar.Title"/>
+                <TextView android:id="@+id/car_ui_toolbar_subtitle"
+                          android:layout_width="wrap_content"
+                          android:layout_height="wrap_content"
+                          android:visibility="gone"
+                          android:textAlignment="viewStart"
+                          android:textAppearance="?android:attr/textAppearanceSmall"/>
+            </LinearLayout>
+
+            <com.android.car.ui.toolbar.TabLayout
+                android:id="@+id/car_ui_toolbar_tabs"
+                android:layout_width="wrap_content"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintTop_toTopOf="parent"
+                app:layout_constraintLeft_toRightOf="@+id/car_ui_toolbar_menu_items_container"
+                app:layout_constraintRight_toLeftOf="@+id/car_ui_toolbar_title_logo_container"
+                app:layout_constraintHorizontal_bias="0.0"/>
+
+            <LinearLayout
+                android:id="@+id/car_ui_toolbar_menu_items_container"
+                android:divider="@drawable/car_ui_toolbar_menu_item_divider"
+                android:showDividers="beginning|middle|end"
+                android:layout_width="wrap_content"
+                android:layout_height="0dp"
+                android:orientation="horizontal"
+                app:layout_constraintTop_toTopOf="parent"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_nav_icon_container"/>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_search_view_container"
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_menu_items_container"
+                app:layout_constraintRight_toLeftOf="@id/car_ui_toolbar_title_logo_container"
+                app:layout_constraintTop_toTopOf="parent"/>
+
+            <ProgressBar
+                android:id="@+id/car_ui_toolbar_progress_bar"
+                style="@android:style/Widget.DeviceDefault.ProgressBar.Horizontal"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:indeterminate="true"
+                android:visibility="gone"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintLeft_toLeftOf="parent"
+                app:layout_constraintRight_toRightOf="parent" />
+
+        </androidx.constraintlayout.widget.ConstraintLayout>
+    </com.android.car.ui.FocusArea>
+
+</androidx.constraintlayout.widget.ConstraintLayout>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_toolbar.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_toolbar.xml
new file mode 100644
index 0000000000..6dd024342f
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_toolbar.xml
@@ -0,0 +1,132 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024, The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/car_ui_toolbar_background"
+    android:layout_width="match_parent"
+    android:layout_height="96dp">
+
+    <FrameLayout
+        android:id="@+id/car_ui_toolbar_nav_icon_container"
+        style="@style/Widget.CarUi.Toolbar.NavIconContainer"
+        android:layout_width="@dimen/car_ui_toolbar_margin"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintLeft_toLeftOf="parent"
+        app:layout_constraintTop_toTopOf="parent">
+
+        <ImageView
+            android:id="@+id/car_ui_toolbar_nav_icon"
+            style="@style/Widget.CarUi.Toolbar.NavIcon"
+            android:tint="@color/car_ui_text_color_primary"
+            android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+            android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+            android:layout_gravity="center"
+            android:scaleType="fitXY"
+            tools:ignore="UseAppTint" />
+
+        <ImageView
+            android:id="@+id/car_ui_toolbar_logo"
+            android:layout_width="@dimen/car_ui_toolbar_logo_size"
+            android:layout_height="@dimen/car_ui_toolbar_logo_size"
+            android:layout_gravity="center"
+            android:scaleType="fitXY" />
+    </FrameLayout>
+
+    <FrameLayout
+        android:id="@+id/car_ui_toolbar_title_logo_container"
+        android:layout_width="112dp"
+        android:layout_height="wrap_content"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintRight_toRightOf="parent"
+        app:layout_constraintTop_toTopOf="parent">
+
+        <ImageView
+            android:id="@+id/car_ui_toolbar_title_logo"
+            android:layout_width="@dimen/car_ui_toolbar_logo_size"
+            android:layout_height="@dimen/car_ui_toolbar_logo_size"
+            android:layout_gravity="center"
+            android:scaleType="fitXY" />
+    </FrameLayout>
+
+    <LinearLayout android:layout_height="wrap_content"
+                  android:layout_width="0dp"
+                  android:id="@+id/car_ui_toolbar_title_container"
+                  android:orientation="vertical"
+                  android:layout_marginRight="112dp"
+                  app:layout_constraintBottom_toBottomOf="parent"
+                  app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_menu_items_container"
+                  app:layout_constraintTop_toTopOf="parent"
+                  app:layout_constraintRight_toRightOf="parent">
+        <TextView android:id="@+id/car_ui_toolbar_title"
+                  android:layout_width="wrap_content"
+                  android:layout_height="wrap_content"
+                  android:singleLine="true"
+                  android:textAlignment="viewStart"
+                  android:textAppearance="@style/TextAppearance.CarUi.Widget.Toolbar.Title"/>
+        <TextView android:id="@+id/car_ui_toolbar_subtitle"
+                  android:layout_width="wrap_content"
+                  android:layout_height="wrap_content"
+                  android:visibility="gone"
+                  android:textAlignment="viewStart"
+                  android:textAppearance="?android:attr/textAppearanceSmall"/>
+    </LinearLayout>
+
+    <com.android.car.ui.toolbar.TabLayout
+        android:id="@+id/car_ui_toolbar_tabs"
+        android:layout_width="wrap_content"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintLeft_toRightOf="@+id/car_ui_toolbar_menu_items_container"
+        app:layout_constraintRight_toLeftOf="@+id/car_ui_toolbar_title_logo_container"
+        app:layout_constraintHorizontal_bias="0.0"/>
+
+    <LinearLayout
+        android:id="@+id/car_ui_toolbar_menu_items_container"
+        android:divider="@drawable/car_ui_toolbar_menu_item_divider"
+        android:showDividers="beginning|middle|end"
+        android:layout_width="wrap_content"
+        android:layout_height="0dp"
+        android:orientation="horizontal"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_nav_icon_container"/>
+
+    <FrameLayout
+        android:id="@+id/car_ui_toolbar_search_view_container"
+        android:layout_width="0dp"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintLeft_toRightOf="@+id/car_ui_toolbar_menu_items_container"
+        app:layout_constraintRight_toRightOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <ProgressBar
+        android:id="@+id/car_ui_toolbar_progress_bar"
+        style="@android:style/Widget.DeviceDefault.ProgressBar.Horizontal"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:indeterminate="true"
+        android:visibility="gone"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintLeft_toLeftOf="parent"
+        app:layout_constraintRight_toRightOf="parent" />
+
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_toolbar_two_row.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_toolbar_two_row.xml
new file mode 100644
index 0000000000..c7528c6fa5
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-ldrtl/car_ui_toolbar_two_row.xml
@@ -0,0 +1,136 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024, The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/car_ui_toolbar_background"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content">
+
+    <androidx.constraintlayout.widget.Guideline
+        android:id="@+id/car_ui_toolbar_row_separator_guideline"
+        android:layout_width="0dp"
+        android:layout_height="0dp"
+        android:orientation="horizontal"
+        app:layout_constraintGuide_begin="96dp"/>
+
+    <FrameLayout
+        android:id="@+id/car_ui_toolbar_nav_icon_container"
+        style="@style/Widget.CarUi.Toolbar.NavIconContainer"
+        android:layout_width="@dimen/car_ui_toolbar_margin"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+        app:layout_constraintLeft_toLeftOf="parent"
+        app:layout_constraintTop_toTopOf="parent">
+
+        <ImageView
+            android:id="@+id/car_ui_toolbar_nav_icon"
+            style="@style/Widget.CarUi.Toolbar.NavIcon"
+            android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+            android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+            android:layout_gravity="center"
+            android:scaleType="fitXY"
+            android:tint="@color/car_ui_text_color_primary"
+            tools:ignore="UseAppTint" />
+
+        <ImageView
+            android:id="@+id/car_ui_toolbar_logo"
+            android:layout_width="@dimen/car_ui_toolbar_logo_size"
+            android:layout_height="@dimen/car_ui_toolbar_logo_size"
+            android:layout_gravity="center"
+            android:scaleType="fitXY" />
+    </FrameLayout>
+
+    <FrameLayout
+        android:id="@+id/car_ui_toolbar_title_logo_container"
+        android:layout_width="112dp"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+        app:layout_constraintRight_toRightOf="parent"
+        app:layout_constraintTop_toTopOf="parent">
+
+        <ImageView
+            android:id="@+id/car_ui_toolbar_title_logo"
+            android:layout_width="@dimen/car_ui_toolbar_logo_size"
+            android:layout_height="@dimen/car_ui_toolbar_logo_size"
+            android:layout_gravity="center"
+            android:scaleType="fitXY" />
+    </FrameLayout>
+
+    <LinearLayout android:layout_height="wrap_content"
+                  android:layout_width="0dp"
+                  android:id="@+id/car_ui_toolbar_title_container"
+                  android:orientation="vertical"
+                  android:layout_marginRight="112dp"
+                  app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                  app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_menu_items_container"
+                  app:layout_constraintRight_toRightOf="parent"
+                  app:layout_constraintTop_toTopOf="parent" >
+        <TextView android:id="@+id/car_ui_toolbar_title"
+                  android:layout_width="wrap_content"
+                  android:layout_height="wrap_content"
+                  android:singleLine="true"
+                  android:textAlignment="viewStart"
+                  android:textAppearance="@style/TextAppearance.CarUi.Widget.Toolbar.Title"/>
+        <TextView android:id="@+id/car_ui_toolbar_subtitle"
+                  android:layout_width="wrap_content"
+                  android:layout_height="wrap_content"
+                  android:visibility="gone"
+                  android:textAlignment="viewStart"
+                  android:textAppearance="?android:attr/textAppearanceSmall"/>
+    </LinearLayout>
+
+    <FrameLayout
+        android:id="@+id/car_ui_toolbar_search_view_container"
+        android:layout_width="0dp"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+        app:layout_constraintLeft_toRightOf="@+id/car_ui_toolbar_menu_items_container"
+        app:layout_constraintRight_toRightOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <LinearLayout
+        android:id="@+id/car_ui_toolbar_menu_items_container"
+        android:divider="@drawable/car_ui_toolbar_menu_item_divider"
+        android:showDividers="beginning|middle|end"
+        android:layout_width="wrap_content"
+        android:layout_height="0dp"
+        android:orientation="horizontal"
+        app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+        app:layout_constraintLeft_toRightOf="@id/car_ui_toolbar_nav_icon_container"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <com.android.car.ui.toolbar.TabLayout
+        android:id="@+id/car_ui_toolbar_tabs"
+        android:layout_width="match_parent"
+        android:layout_height="96dp"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintTop_toBottomOf="@id/car_ui_toolbar_row_separator_guideline" />
+
+    <ProgressBar
+        android:id="@+id/car_ui_toolbar_progress_bar"
+        style="@android:style/Widget.DeviceDefault.ProgressBar.Horizontal"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:indeterminate="true"
+        android:visibility="gone"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent" />
+
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-port/car_ui_base_layout_toolbar.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-port/car_ui_base_layout_toolbar.xml
new file mode 100644
index 0000000000..7c22de82da
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout-port/car_ui_base_layout_toolbar.xml
@@ -0,0 +1,178 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- This is for the two-row version of the toolbar -->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:tag="CarUiBaseLayoutToolbar">
+
+    <!-- When not in touch mode, if we clear focus in current window, Android will re-focus the
+         first focusable view in the window automatically. Adding a FocusParkingView to the window
+         can fix this issue, because it can take focus, and it is transparent and its default focus
+         highlight is disabled, so it's invisible to the user no matter whether it's focused or not.
+         -->
+    <com.android.car.ui.FocusParkingView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+
+    <FrameLayout
+        android:id="@+id/car_ui_base_layout_content_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <com.android.car.ui.FocusArea
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+        <androidx.constraintlayout.widget.ConstraintLayout
+            android:id="@+id/car_ui_toolbar_background"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:tag="car_ui_top_inset"
+            app:layout_constraintTop_toTopOf="parent">
+            <com.android.car.ui.baselayout.ClickBlockingView
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                app:layout_constraintStart_toStartOf="parent"
+                app:layout_constraintEnd_toEndOf="parent"
+                app:layout_constraintTop_toTopOf="parent"
+                app:layout_constraintBottom_toBottomOf="parent"/>
+
+            <androidx.constraintlayout.widget.Guideline
+                android:id="@+id/car_ui_toolbar_row_separator_guideline"
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                android:orientation="horizontal"
+                app:layout_constraintGuide_begin="96dp" />
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_nav_icon_container"
+                style="@style/Widget.CarUi.Toolbar.NavIconContainer"
+                android:layout_width="@dimen/car_ui_toolbar_margin"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                app:layout_constraintStart_toStartOf="parent"
+                app:layout_constraintTop_toTopOf="parent">
+
+                <!-- we need to use android:tint instead of app:tint, because we're
+                    not using classes from androidx/appcompat such as AppCompatImageView -->
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_nav_icon"
+                    style="@style/Widget.CarUi.Toolbar.NavIcon"
+                    android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+                    android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY"
+                    android:tint="@color/car_ui_text_color_primary"
+                    tools:ignore="UseAppTint"/>
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_logo"
+                    android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY" />
+            </FrameLayout>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_title_logo_container"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                app:layout_constraintStart_toEndOf="@id/car_ui_toolbar_nav_icon_container"
+                app:layout_constraintTop_toTopOf="parent">
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_title_logo"
+                    android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY" />
+            </FrameLayout>
+
+            <LinearLayout android:layout_height="wrap_content"
+                          android:layout_width="0dp"
+                          android:id="@+id/car_ui_toolbar_title_container"
+                          android:orientation="vertical"
+                          android:layout_marginStart="16dp"
+                          app:layout_goneMarginStart="0dp"
+                          app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                          app:layout_constraintEnd_toStartOf="@id/car_ui_toolbar_menu_items_container"
+                          app:layout_constraintStart_toEndOf="@id/car_ui_toolbar_title_logo_container"
+                          app:layout_constraintTop_toTopOf="parent" >
+                <TextView android:id="@+id/car_ui_toolbar_title"
+                          android:layout_width="wrap_content"
+                          android:layout_height="wrap_content"
+                          android:singleLine="true"
+                          android:textAlignment="viewStart"
+                          android:textAppearance="@style/TextAppearance.CarUi.Widget.Toolbar.Title"/>
+                <TextView android:id="@+id/car_ui_toolbar_subtitle"
+                          android:layout_width="wrap_content"
+                          android:layout_height="wrap_content"
+                          android:visibility="gone"
+                          android:textAlignment="viewStart"
+                          android:textAppearance="?android:attr/textAppearanceSmall"/>
+            </LinearLayout>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_search_view_container"
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_menu_items_container"
+                app:layout_constraintStart_toEndOf="@id/car_ui_toolbar_title_logo_container"
+                app:layout_constraintTop_toTopOf="parent"
+                android:layout_marginStart="16dp"
+                app:layout_goneMarginStart="0dp" />
+
+            <LinearLayout
+                android:id="@+id/car_ui_toolbar_menu_items_container"
+                android:divider="@drawable/car_ui_toolbar_menu_item_divider"
+                android:showDividers="beginning|middle|end"
+                android:layout_width="wrap_content"
+                android:layout_height="0dp"
+                android:orientation="horizontal"
+                app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator_guideline"
+                app:layout_constraintEnd_toEndOf="parent"
+                app:layout_constraintTop_toTopOf="parent" />
+
+            <com.android.car.ui.toolbar.TabLayout
+                android:id="@+id/car_ui_toolbar_tabs"
+                android:layout_width="match_parent"
+                android:layout_height="96dp"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintTop_toBottomOf="@id/car_ui_toolbar_row_separator_guideline" />
+
+            <ProgressBar
+                android:id="@+id/car_ui_toolbar_progress_bar"
+                style="@android:style/Widget.DeviceDefault.ProgressBar.Horizontal"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:indeterminate="true"
+                android:visibility="gone"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintEnd_toEndOf="parent"
+                app:layout_constraintStart_toStartOf="parent" />
+
+        </androidx.constraintlayout.widget.ConstraintLayout>
+    </com.android.car.ui.FocusArea>
+
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_alert_dialog_list.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_alert_dialog_list.xml
new file mode 100644
index 0000000000..7d771b922d
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_alert_dialog_list.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<androidx.recyclerview.widget.RecyclerView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/list"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+</androidx.recyclerview.widget.RecyclerView>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_base_layout_toolbar.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_base_layout_toolbar.xml
new file mode 100644
index 0000000000..e9d3854915
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_base_layout_toolbar.xml
@@ -0,0 +1,177 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:background="@android:color/holo_purple"
+    android:tag="CarUiBaseLayoutToolbar">
+
+    <!-- When not in touch mode, if we clear focus in current window, Android will re-focus the
+         first focusable view in the window automatically. Adding a FocusParkingView to the window
+         can fix this issue, because it can take focus, and it is transparent and its default focus
+         highlight is disabled, so it's invisible to the user no matter whether it's focused or not.
+         -->
+    <com.android.car.ui.FocusParkingView
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"/>
+
+    <FrameLayout
+        android:id="@+id/car_ui_base_layout_content_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintTop_toTopOf="parent"/>
+
+    <com.android.car.ui.FocusArea
+        android:layout_width="match_parent"
+        android:layout_height="@dimen/car_ui_toolbar_first_row_height">
+        <androidx.constraintlayout.widget.ConstraintLayout
+            android:id="@+id/car_ui_toolbar_background"
+            style="@style/Widget.CarUi.Toolbar.Container"
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:tag="car_ui_top_inset"
+            app:layout_constraintTop_toTopOf="parent">
+            <com.android.car.ui.baselayout.ClickBlockingView
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                app:layout_constraintStart_toStartOf="parent"
+                app:layout_constraintEnd_toEndOf="parent"
+                app:layout_constraintTop_toTopOf="parent"
+                app:layout_constraintBottom_toBottomOf="parent"/>
+
+            <!-- The horizontal bias set to 0.0 here is so that when you set this view as GONE, it
+                 will be treated as if it's all the way to the left instead of centered in the
+                 margin -->
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_nav_icon_container"
+                style="@style/Widget.CarUi.Toolbar.NavIconContainer"
+                android:layout_width="@dimen/car_ui_toolbar_margin"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintHorizontal_bias="0.0"
+                app:layout_constraintStart_toStartOf="parent"
+                app:layout_constraintTop_toTopOf="parent">
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_nav_icon"
+                    style="@style/Widget.CarUi.Toolbar.NavIcon"
+                    android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+                    android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY"/>
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_logo"
+                    android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY"/>
+            </FrameLayout>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_title_logo_container"
+                style="@style/Widget.CarUi.Toolbar.LogoContainer"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintStart_toEndOf="@id/car_ui_toolbar_nav_icon_container"
+                app:layout_constraintTop_toTopOf="parent">
+
+                <ImageView
+                    android:id="@+id/car_ui_toolbar_title_logo"
+                    android:layout_margin="@dimen/car_ui_toolbar_logo_margin"
+                    style="@style/Widget.CarUi.Toolbar.Logo"
+                    android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                    android:layout_gravity="center"
+                    android:scaleType="fitXY"/>
+            </FrameLayout>
+
+            <LinearLayout android:layout_height="wrap_content"
+                android:layout_width="0dp"
+                android:id="@+id/car_ui_toolbar_title_container"
+                android:orientation="vertical"
+                android:layout_marginStart="@dimen/car_ui_toolbar_title_margin_start"
+                app:layout_goneMarginStart="@dimen/car_ui_toolbar_title_no_logo_margin_start"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_menu_items_container"
+                app:layout_constraintStart_toEndOf="@+id/car_ui_toolbar_title_logo_container"
+                app:layout_constraintTop_toTopOf="parent">
+                <TextView android:id="@+id/car_ui_toolbar_title"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:singleLine="true"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceHeadlineSmall"
+                    style="@style/Widget.CarUi.Toolbar.Title"/>
+                <TextView android:id="@+id/car_ui_toolbar_subtitle"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:visibility="gone"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"
+                    style="@style/Widget.CarUi.Toolbar.Subtitle"/>
+            </LinearLayout>
+
+            <com.android.car.ui.toolbar.TabLayout
+                android:id="@+id/car_ui_toolbar_tabs"
+                android:layout_width="wrap_content"
+                android:layout_height="0dp"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_menu_items_container"
+                app:layout_constraintHorizontal_bias="0.0"
+                app:layout_constraintStart_toEndOf="@+id/car_ui_toolbar_title_logo_container"
+                app:layout_constraintTop_toTopOf="parent"/>
+
+            <LinearLayout
+                android:id="@+id/car_ui_toolbar_menu_items_container"
+                style="@style/Widget.CarUi.Toolbar.MenuItem.Container"
+                android:layout_width="wrap_content"
+                android:layout_height="0dp"
+                android:orientation="horizontal"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintEnd_toEndOf="parent"
+                app:layout_constraintTop_toTopOf="parent"
+                android:layout_marginRight="@dimen/car_ui_padding_7"/>
+
+            <FrameLayout
+                android:id="@+id/car_ui_toolbar_search_view_container"
+                android:layout_width="0dp"
+                android:layout_height="@dimen/car_ui_toolbar_search_height"
+                android:layout_marginStart="@dimen/car_ui_toolbar_title_margin_start"
+                app:layout_goneMarginStart="@dimen/car_ui_toolbar_title_no_logo_margin_start"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_menu_items_container"
+                app:layout_constraintStart_toEndOf="@+id/car_ui_toolbar_title_logo_container"
+                app:layout_constraintTop_toTopOf="parent"/>
+
+            <ProgressBar
+                android:id="@+id/car_ui_toolbar_progress_bar"
+                style="@style/Widget.CarUi.Toolbar.ProgressBar"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:indeterminate="true"
+                android:visibility="gone"
+                app:layout_constraintBottom_toBottomOf="parent"
+                app:layout_constraintEnd_toEndOf="parent"
+                app:layout_constraintStart_toStartOf="parent"/>
+
+        </androidx.constraintlayout.widget.ConstraintLayout>
+    </com.android.car.ui.FocusArea>
+
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_2.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_2.xml
new file mode 100644
index 0000000000..f03c6b5e2c
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_2.xml
@@ -0,0 +1,46 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<!-- Note that in this RRO layout, ViewStubs are used. Depending on the type of list item (i.e., how
+    many tap targets are used) some of these ViewStubs will be inflated with a View hierarchy which
+    contains a top level tap target (or two) and descendant ui/text elements. If the version of
+    car-ui-lib that the app is compiled with doesn't support car_ui_list_item_2, it will default to
+    the static implementation's layout which is car_ui_list_item which doesn't support talkback. -->
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:tag="carUiListItem"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:minHeight="116dp"
+    android:orientation="horizontal">
+    <ViewStub
+        android:id="@+id/car_ui_list_item_touch_interceptor"
+        android:layout_height="match_parent"
+        android:layout_width="match_parent"
+        android:layout="@layout/car_ui_list_item_touch_interceptor"/>
+    <ViewStub
+        android:id="@+id/car_ui_list_item_reduced_touch_interceptor"
+        android:layout_height="match_parent"
+        android:layout_width="0dp"
+        android:layout_weight="1"
+        android:layout="@layout/car_ui_list_item_reduced_touch_interceptor"/>
+    <ViewStub
+        android:id="@+id/car_ui_list_item_action_container_touch_interceptor"
+        android:layout_height="match_parent"
+        android:layout_width="112dp"
+        android:layout="@layout/car_ui_list_item_action_container_touch_interceptor"/>
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_action.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_action.xml
new file mode 100644
index 0000000000..f94e98ea81
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_action.xml
@@ -0,0 +1,53 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<merge
+    xmlns:android="http://schemas.android.com/apk/res/android">
+    <View
+        android:id="@+id/car_ui_list_item_action_divider"
+        android:layout_width="1dp"
+        android:layout_height="60dp"
+        android:layout_gravity="start|center_vertical"
+        android:background="@drawable/car_ui_list_item_divider" />
+    <Switch
+        android:id="@+id/car_ui_list_item_switch_widget"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"
+        android:focusable="false" />
+    <CheckBox
+        android:id="@+id/car_ui_list_item_checkbox_widget"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"
+        android:focusable="false" />
+    <RadioButton
+        android:id="@+id/car_ui_list_item_radio_button_widget"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"
+        android:focusable="false"
+        android:contentDescription="Radio Button"/>
+    <ImageView
+        android:id="@+id/car_ui_list_item_supplemental_icon"
+        android:layout_width="44dp"
+        android:layout_height="44dp"
+        android:layout_gravity="center"
+        android:scaleType="fitCenter"/>
+</merge>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_action_container_touch_interceptor.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_action_container_touch_interceptor.xml
new file mode 100644
index 0000000000..bb18aedad8
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_action_container_touch_interceptor.xml
@@ -0,0 +1,30 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- This touch interceptor is sized and positioned to encompass the action container   -->
+<com.android.car.ui.SecureView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/car_ui_list_item_action_container_touch_interceptor"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:background="@drawable/car_ui_list_item_background">
+    <FrameLayout
+        android:id="@+id/car_ui_list_item_action_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent">
+        <include layout="@layout/car_ui_list_item_action"/>
+    </FrameLayout>
+</com.android.car.ui.SecureView>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_icon_title_body_container.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_icon_title_body_container.xml
new file mode 100644
index 0000000000..1f59d04dba
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_icon_title_body_container.xml
@@ -0,0 +1,75 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+    <FrameLayout
+        android:id="@+id/car_ui_list_item_icon_container"
+        android:layout_width="112dp"
+        android:layout_height="0dp"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent">
+        <ImageView
+            android:id="@+id/car_ui_list_item_icon"
+            android:layout_width="44dp"
+            android:layout_height="44dp"
+            android:layout_gravity="center"
+            android:scaleType="fitCenter" />
+        <ImageView
+            android:id="@+id/car_ui_list_item_content_icon"
+            android:layout_width="112dp"
+            android:layout_height="112dp"
+            android:layout_gravity="center"
+            android:scaleType="fitCenter" />
+        <ImageView
+            android:id="@+id/car_ui_list_item_avatar_icon"
+            android:background="@drawable/car_ui_list_item_avatar_icon_outline"
+            android:layout_width="44dp"
+            android:layout_height="44dp"
+            android:layout_gravity="center"
+            android:scaleType="fitCenter" />
+    </FrameLayout>
+    <CarUiTextView
+        android:id="@+id/car_ui_list_item_title"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:layout_marginStart="24dp"
+        android:singleLine="false"
+        android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium"
+        android:textAlignment="viewStart"
+        app:layout_constraintBottom_toTopOf="@+id/car_ui_list_item_body"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toEndOf="@+id/car_ui_list_item_icon_container"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintVertical_chainStyle="packed"
+        app:layout_goneMarginStart="24dp" />
+    <CarUiTextView
+        android:id="@+id/car_ui_list_item_body"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:layout_marginStart="24dp"
+        android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"
+        android:textAlignment="viewStart"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toEndOf="@+id/car_ui_list_item_icon_container"
+        app:layout_constraintTop_toBottomOf="@+id/car_ui_list_item_title"
+        app:layout_goneMarginStart="24dp" />
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_reduced_touch_interceptor.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_reduced_touch_interceptor.xml
new file mode 100644
index 0000000000..72de811aa0
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_reduced_touch_interceptor.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- This touch interceptor does not include the action container -->
+<com.android.car.ui.SecureView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/car_ui_list_item_reduced_touch_interceptor"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:background="@drawable/car_ui_list_item_background">
+    <include layout="@layout/car_ui_list_item_icon_title_body_container"/>
+</com.android.car.ui.SecureView>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_touch_interceptor.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_touch_interceptor.xml
new file mode 100644
index 0000000000..6eeee37bc4
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_list_item_touch_interceptor.xml
@@ -0,0 +1,40 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- This touch interceptor spans the entire list item -->
+<com.android.car.ui.SecureView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/car_ui_list_item_touch_interceptor"
+    android:background="@drawable/car_ui_list_item_background"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:orientation="horizontal">
+        <include
+            layout="@layout/car_ui_list_item_icon_title_body_container"
+            android:layout_width="0dp"
+            android:layout_weight="1"
+            android:layout_height="match_parent"/>
+        <FrameLayout
+            android:id="@+id/car_ui_list_item_action_container"
+            android:layout_width="112dp"
+            android:layout_height="match_parent">
+            <include layout="@layout/car_ui_list_item_action"/>
+        </FrameLayout>
+    </LinearLayout>
+</com.android.car.ui.SecureView>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference.xml
new file mode 100644
index 0000000000..a06880f15e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference.xml
@@ -0,0 +1,74 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<com.android.car.ui.uxr.DrawableStateRelativeLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="?android:attr/selectableItemBackground"
+    android:clipToPadding="false"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall"
+    android:tag="carUiPreference"
+    android:paddingStart="?android:attr/listPreferredItemPaddingStart">
+
+    <com.android.car.ui.uxr.DrawableStateImageView
+        android:id="@android:id/icon"
+        android:layout_width="44dp"
+        android:layout_height="44dp"
+        android:layout_alignParentStart="true"
+        android:layout_centerVertical="true"
+        android:layout_marginBottom="16dp"
+        android:layout_marginEnd="16dp"
+        android:layout_marginTop="16dp"
+        android:scaleType="fitCenter"/>
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_centerVertical="true"
+        android:layout_marginBottom="16dp"
+        android:layout_marginTop="16dp"
+        android:layout_marginEnd="?android:attr/listPreferredItemPaddingEnd"
+        android:layout_toEndOf="@android:id/icon"
+        android:layout_toStartOf="@android:id/widget_frame"
+        android:orientation="vertical">
+
+        <com.android.car.ui.uxr.DrawableStateTextView
+            android:id="@android:id/title"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:ellipsize="end"
+            android:maxLines="2"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium"/>
+
+        <com.android.car.ui.uxr.DrawableStateTextView
+            android:id="@android:id/summary"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"/>
+
+    </LinearLayout>
+
+    <!-- Preference should place its actual preference widget here. -->
+    <FrameLayout
+        android:id="@android:id/widget_frame"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_alignParentEnd="true"
+        android:layout_centerVertical="true"/>
+
+</com.android.car.ui.uxr.DrawableStateRelativeLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_category.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_category.xml
new file mode 100644
index 0000000000..f66c03cd70
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_category.xml
@@ -0,0 +1,68 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="?android:attr/selectableItemBackground"
+    android:focusable="true"
+    android:gravity="center_vertical"
+    android:minHeight="76dp"
+    android:orientation="horizontal"
+    android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+    android:paddingStart="?android:attr/listPreferredItemPaddingStart">
+
+    <ImageView
+        android:id="@android:id/icon"
+        android:layout_width="44dp"
+        android:layout_height="44dp"
+        android:layout_gravity="center_vertical"
+        android:layout_marginBottom="16dp"
+        android:layout_marginEnd="16dp"
+        android:layout_marginTop="16dp"
+        android:scaleType="fitCenter"
+        android:tint="?com.android.oem.tokens:colorOnBackground"
+        tools:ignore="UseAppTint" />
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_marginBottom="16dp"
+        android:layout_marginTop="16dp"
+        android:orientation="vertical">
+
+        <TextView
+            android:id="@android:id/title"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:textAlignment="viewStart"
+            android:ellipsize="end"
+            android:maxLines="1"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceLabelMedium" />
+
+        <TextView
+            android:id="@android:id/summary"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:singleLine="true"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceLabelSmall"/>
+
+    </LinearLayout>
+
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_footer.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_footer.xml
new file mode 100644
index 0000000000..c66a5ea9fb
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_footer.xml
@@ -0,0 +1,71 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<com.android.car.ui.uxr.DrawableStateLinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:orientation="vertical"
+    android:gravity="start"
+    android:clipToPadding="false"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall"
+    android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+    android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+    android:paddingBottom="16dp">
+
+    <com.android.car.ui.uxr.DrawableStateLinearLayout
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="start"
+        android:orientation="horizontal">
+
+        <com.android.car.ui.uxr.DrawableStateImageView
+            android:id="@android:id/icon"
+            android:layout_width="36dp"
+            android:layout_height="36dp"
+            android:layout_marginTop="16dp"
+            android:layout_marginEnd="16dp"
+            android:padding="3dp"
+            android:alpha="72"/>
+
+        <com.android.car.ui.uxr.DrawableStateTextView
+            android:id="@android:id/title"
+            android:textColor="@color/car_ui_text_color_secondary"
+            android:textStyle="bold"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="16dp"
+            android:ellipsize="end"
+            android:maxLines="2"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceLabelMedium"/>
+    </com.android.car.ui.uxr.DrawableStateLinearLayout>
+
+    <com.android.car.ui.uxr.DrawableStateTextView
+        android:id="@android:id/summary"
+        android:textAppearance="?com.android.oem.tokens:textAppearanceLabelSmall"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="16dp"/>
+
+    <com.android.car.ui.uxr.DrawableStateTextView
+        android:id="@+id/car_ui_link"
+        android:textColor="?android:attr/colorAccent"
+        android:textStyle="bold"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="16dp"/>
+</com.android.car.ui.uxr.DrawableStateLinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_primary_switch.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_primary_switch.xml
new file mode 100644
index 0000000000..e60b59f148
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_primary_switch.xml
@@ -0,0 +1,75 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<com.android.car.ui.uxr.DrawableStateRelativeLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:layout_marginBottom="22dp"
+    android:background="@drawable/car_ui_preference_primary_switch_background"
+    android:clipToPadding="false"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall"
+    android:tag="carUiPreference"
+    android:paddingStart="?android:attr/listPreferredItemPaddingStart">
+
+    <com.android.car.ui.uxr.DrawableStateImageView
+        android:id="@android:id/icon"
+        android:layout_width="44dp"
+        android:layout_height="44dp"
+        android:layout_alignParentStart="true"
+        android:layout_centerVertical="true"
+        android:layout_marginBottom="16dp"
+        android:layout_marginEnd="16dp"
+        android:layout_marginTop="16dp"
+        android:scaleType="fitCenter"/>
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_centerVertical="true"
+        android:layout_marginBottom="16dp"
+        android:layout_marginTop="16dp"
+        android:layout_marginEnd="?android:attr/listPreferredItemPaddingEnd"
+        android:layout_toEndOf="@android:id/icon"
+        android:layout_toStartOf="@android:id/widget_frame"
+        android:orientation="vertical">
+
+        <com.android.car.ui.uxr.DrawableStateTextView
+            android:id="@android:id/title"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:ellipsize="end"
+            android:maxLines="2"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium"/>
+
+        <com.android.car.ui.uxr.DrawableStateTextView
+            android:id="@android:id/summary"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"/>
+
+    </LinearLayout>
+
+    <!-- Preference should place its actual preference widget here. -->
+    <FrameLayout
+        android:id="@android:id/widget_frame"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_alignParentEnd="true"
+        android:layout_centerVertical="true"/>
+
+</com.android.car.ui.uxr.DrawableStateRelativeLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_icon.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_icon.xml
new file mode 100644
index 0000000000..fbd6617689
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_icon.xml
@@ -0,0 +1,117 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:orientation="horizontal"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall"
+    android:tag="carUiPreference">
+
+    <com.android.car.ui.uxr.DrawableStateConstraintLayout
+        android:id="@+id/car_ui_first_action_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:layout_gravity="center_vertical"
+        android:layout_weight = "1"
+        android:background="?android:attr/selectableItemBackground"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd">
+
+        <RelativeLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent">
+            <com.android.car.ui.uxr.DrawableStateImageView
+                android:id="@android:id/icon"
+                android:layout_width="44dp"
+                android:layout_height="44dp"
+                android:layout_marginEnd="32dp"
+                app:layout_goneMarginEnd="0dp"
+                android:layout_alignParentStart="true"
+                android:layout_centerVertical="true"
+                android:scaleType="fitCenter" />
+
+            <LinearLayout
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:orientation="vertical"
+                android:layout_toEndOf="@android:id/icon"
+                android:layout_centerVertical="true">
+
+                <com.android.car.ui.uxr.DrawableStateTextView
+                    android:id="@android:id/title"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:textAlignment="viewStart"
+                    android:maxLines="2"
+                    android:ellipsize="end"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium"/>
+
+                <com.android.car.ui.uxr.DrawableStateTextView
+                    android:id="@android:id/summary"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:textAlignment="viewStart"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"
+                    android:maxLines="2"/>
+            </LinearLayout>
+        </RelativeLayout>
+    </com.android.car.ui.uxr.DrawableStateConstraintLayout>
+
+    <RelativeLayout
+        android:id="@+id/car_ui_second_action_container"
+        android:layout_height="match_parent"
+        android:layout_width="wrap_content"
+        android:layout_weight = "0"
+        android:layout_gravity="center_vertical">
+
+        <View
+            android:id="@+id/car_ui_divider"
+            android:layout_width="1dp"
+            android:layout_height="match_parent"
+            android:layout_gravity="center_vertical"
+            android:layout_marginBottom="16dp"
+            android:layout_marginTop="16dp"
+            android:background="#75ffffff"/>
+
+        <com.android.car.ui.uxr.DrawableStateFrameLayout
+            android:id="@+id/car_ui_secondary_action"
+            android:layout_width="?android:attr/listPreferredItemHeightSmall"
+            android:layout_height="match_parent"
+            android:background="?android:attr/selectableItemBackground">
+
+            <com.android.car.ui.uxr.DrawableStateImageView
+                android:id="@+id/car_ui_secondary_action_concrete"
+                android:layout_width="48dp"
+                android:layout_height="48dp"
+                android:layout_gravity="center"
+                android:tintMode="src_in"
+                android:tint="@color/car_ui_text_color_primary"/>
+        </com.android.car.ui.uxr.DrawableStateFrameLayout>
+
+        <!-- The widget frame is required for androidx preferences, but we won't use it. -->
+        <FrameLayout
+            android:id="@android:id/widget_frame"
+            android:layout_width="wrap_content"
+            android:layout_height="match_parent"
+            android:layout_alignParentEnd="true"
+            android:layout_toEndOf="@+id/car_ui_secondary_action" />
+    </RelativeLayout>
+
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_switch.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_switch.xml
new file mode 100644
index 0000000000..15e5e82226
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_switch.xml
@@ -0,0 +1,120 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:orientation="horizontal"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall"
+    android:tag="carUiPreference">
+
+    <com.android.car.ui.uxr.DrawableStateConstraintLayout
+        android:id="@+id/car_ui_first_action_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:layout_gravity="center_vertical"
+        android:layout_weight = "1"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+        android:background="?android:attr/selectableItemBackground">
+
+        <RelativeLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent">
+
+            <com.android.car.ui.uxr.DrawableStateImageView
+                android:id="@android:id/icon"
+                android:layout_width="44dp"
+                android:layout_height="44dp"
+                android:layout_marginEnd="32dp"
+                app:layout_goneMarginEnd="0dp"
+                android:layout_alignParentStart="true"
+                android:layout_centerVertical="true"
+                android:scaleType="fitCenter" />
+
+            <LinearLayout
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:orientation="vertical"
+                android:layout_toEndOf="@android:id/icon"
+                android:layout_centerVertical="true">
+
+                <com.android.car.ui.uxr.DrawableStateTextView
+                    android:id="@android:id/title"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:ellipsize="end"
+                    android:maxLines="2"
+                    android:textAlignment="viewStart"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium" />
+
+                <com.android.car.ui.uxr.DrawableStateTextView
+                    android:id="@android:id/summary"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:maxLines="2"
+                    android:textAlignment="viewStart"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall" />
+            </LinearLayout>
+        </RelativeLayout>
+    </com.android.car.ui.uxr.DrawableStateConstraintLayout>
+
+    <RelativeLayout
+        android:id="@+id/car_ui_second_action_container"
+        android:layout_height="match_parent"
+        android:layout_width="wrap_content"
+        android:layout_weight = "0"
+        android:layout_gravity="center_vertical">
+
+        <View
+            android:id="@+id/car_ui_divider"
+            android:layout_width="1dp"
+            android:layout_height="match_parent"
+            android:layout_gravity="center_vertical"
+            android:layout_marginBottom="16dp"
+            android:layout_marginTop="16dp"
+            android:background="#75ffffff"/>
+
+        <com.android.car.ui.uxr.DrawableStateFrameLayout
+            android:id="@+id/car_ui_secondary_action"
+            android:layout_width="?android:attr/listPreferredItemHeightSmall"
+            android:layout_height="match_parent"
+            android:layout_alignParentStart="true"
+            android:background="?android:attr/selectableItemBackground">
+
+            <com.android.car.ui.uxr.DrawableStateSwitch
+                android:id="@+id/car_ui_secondary_action_concrete"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_gravity="center"
+                android:clickable="false"
+                android:focusable="false"
+                style="@style/Widget.CarUi.SwitchPreference.Switch"/>
+        </com.android.car.ui.uxr.DrawableStateFrameLayout>
+
+        <!-- The widget frame is required for androidx preferences, but we won't use it. -->
+        <FrameLayout
+            android:id="@android:id/widget_frame"
+            android:layout_width="wrap_content"
+            android:layout_height="match_parent"
+            android:layout_alignParentEnd="true"
+            android:layout_toEndOf="@+id/car_ui_secondary_action" />
+    </RelativeLayout>
+
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_text.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_text.xml
new file mode 100644
index 0000000000..21d63e102e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_text.xml
@@ -0,0 +1,107 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:orientation="horizontal"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall"
+    android:tag="carUiPreference">
+    <com.android.car.ui.uxr.DrawableStateConstraintLayout
+        android:id="@+id/car_ui_first_action_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:layout_gravity="center_vertical"
+        android:layout_weight = "1"
+        android:background="?android:attr/selectableItemBackground"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd">
+
+        <RelativeLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent">
+
+            <com.android.car.ui.uxr.DrawableStateImageView
+                android:id="@android:id/icon"
+                android:layout_width="44dp"
+                android:layout_height="44dp"
+                android:layout_marginEnd="32dp"
+                app:layout_goneMarginEnd="0dp"
+                android:layout_alignParentStart="true"
+                android:layout_centerVertical="true"
+                android:scaleType="fitCenter" />
+
+            <LinearLayout
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:orientation="vertical"
+                android:layout_toEndOf="@android:id/icon"
+                android:layout_centerVertical="true">
+
+                <com.android.car.ui.uxr.DrawableStateTextView
+                    android:id="@android:id/title"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:textAlignment="viewStart"
+                    android:ellipsize="end"
+                    android:maxLines="2"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium"/>
+
+                <com.android.car.ui.uxr.DrawableStateTextView
+                    android:id="@android:id/summary"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:textAlignment="viewStart"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"
+                    android:maxLines="2"/>
+            </LinearLayout>
+        </RelativeLayout>
+    </com.android.car.ui.uxr.DrawableStateConstraintLayout>
+
+    <View
+        android:id="@+id/car_ui_divider"
+        android:layout_width="1dp"
+        android:layout_height="match_parent"
+        android:layout_gravity="center_vertical"
+        android:layout_marginBottom="16dp"
+        android:layout_marginTop="16dp"
+        android:background="#75ffffff"/>
+
+    <LinearLayout
+        android:id="@+id/car_ui_second_action_container"
+        android:layout_height="match_parent"
+        android:layout_width="wrap_content"
+        android:paddingHorizontal="?android:attr/listPreferredItemPaddingEnd"
+        android:layout_weight = "0">
+
+        <com.android.car.ui.uxr.DrawableStateButton
+            android:id="@+id/car_ui_secondary_action"
+            android:layout_width="wrap_content"
+            android:layout_height="56dp"
+            android:layout_gravity="center"/>
+
+        <!-- The widget frame is required for androidx preferences, but we won't use it. -->
+        <FrameLayout
+            android:id="@android:id/widget_frame"
+            android:layout_width="wrap_content"
+            android:layout_height="match_parent"
+            android:layout_alignParentEnd="true"
+            android:layout_toEndOf="@+id/car_ui_secondary_action"/>
+    </LinearLayout>
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_text_borderless.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_text_borderless.xml
new file mode 100644
index 0000000000..c4295414bf
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_two_action_text_borderless.xml
@@ -0,0 +1,108 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:orientation="horizontal"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall"
+    android:tag="carUiPreference">
+    <com.android.car.ui.uxr.DrawableStateConstraintLayout
+        android:id="@+id/car_ui_first_action_container"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:layout_gravity="center_vertical"
+        android:layout_weight = "1"
+        android:background="?android:attr/selectableItemBackground"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd">
+
+        <RelativeLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent">
+
+            <com.android.car.ui.uxr.DrawableStateImageView
+                android:id="@android:id/icon"
+                android:layout_width="44dp"
+                android:layout_height="44dp"
+                android:layout_marginEnd="32dp"
+                app:layout_goneMarginEnd="0dp"
+                android:layout_alignParentStart="true"
+                android:layout_centerVertical="true"
+                android:scaleType="fitCenter" />
+
+            <LinearLayout
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:orientation="vertical"
+                android:layout_toEndOf="@android:id/icon"
+                android:layout_centerVertical="true">
+
+                <com.android.car.ui.uxr.DrawableStateTextView
+                    android:id="@android:id/title"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:textAlignment="viewStart"
+                    android:ellipsize="end"
+                    android:maxLines="2"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium"/>
+
+                <com.android.car.ui.uxr.DrawableStateTextView
+                    android:id="@android:id/summary"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:textAlignment="viewStart"
+                    android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"
+                    android:maxLines="2"/>
+            </LinearLayout>
+        </RelativeLayout>
+    </com.android.car.ui.uxr.DrawableStateConstraintLayout>
+
+    <View
+        android:id="@+id/car_ui_divider"
+        android:layout_width="1dp"
+        android:layout_height="match_parent"
+        android:layout_gravity="center_vertical"
+        android:layout_marginBottom="16dp"
+        android:layout_marginTop="16dp"
+        android:background="#75ffffff"/>
+
+    <LinearLayout
+        android:id="@+id/car_ui_second_action_container"
+        android:layout_height="match_parent"
+        android:layout_width="wrap_content"
+        android:paddingHorizontal="?android:attr/listPreferredItemPaddingEnd"
+        android:layout_weight = "0">
+        
+        <com.android.car.ui.uxr.DrawableStateButton
+            android:id="@+id/car_ui_secondary_action"
+            android:layout_width="wrap_content"
+            android:layout_height="56dp"
+            android:layout_gravity="center"
+            style="?android:attr/borderlessButtonStyle"/>
+
+        <!-- The widget frame is required for androidx preferences, but we won't use it. -->
+        <FrameLayout
+            android:id="@android:id/widget_frame"
+            android:layout_width="wrap_content"
+            android:layout_height="match_parent"
+            android:layout_alignParentEnd="true"
+            android:layout_toEndOf="@+id/car_ui_secondary_action"/>
+    </LinearLayout>
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_widget_seekbar.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_widget_seekbar.xml
new file mode 100644
index 0000000000..47eed868b3
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_widget_seekbar.xml
@@ -0,0 +1,93 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+    android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+    android:gravity="center_vertical"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall"
+    android:orientation="horizontal"
+    android:background="@drawable/car_ui_seekbar_preference_background"
+    android:clipChildren="false"
+    android:clipToPadding="false">
+
+    <com.android.car.ui.uxr.DrawableStateImageView
+        android:id="@android:id/icon"
+        android:layout_width="44dp"
+        android:layout_height="44dp"
+        android:layout_marginTop="16dp"
+        android:layout_marginBottom="16dp"
+        android:layout_marginEnd="16dp"
+        android:scaleType="fitCenter"
+        android:tint="@color/car_ui_text_color_primary"/>
+
+    <RelativeLayout
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:layout_weight="1"
+        android:layout_marginTop="16dp"
+        android:layout_marginBottom="16dp"
+        android:clipChildren="false"
+        android:clipToPadding="false">
+
+        <com.android.car.ui.uxr.DrawableStateTextView
+            android:id="@android:id/title"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:ellipsize="end"
+            android:maxLines="2"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium"/>
+
+        <com.android.car.ui.uxr.DrawableStateTextView
+            android:id="@android:id/summary"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_alignStart="@android:id/title"
+            android:layout_below="@android:id/title"
+            android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"/>
+
+        <!-- Using UnPressableLinearLayout as a workaround to disable the pressed state propagation
+        to the children of this container layout. Otherwise, the animated pressed state will also
+        play for the thumb in the AbsSeekBar in addition to the preference's ripple background.
+        The background of the SeekBar is also set to null to disable the ripple background -->
+        <androidx.preference.UnPressableLinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_alignStart="@android:id/title"
+            android:layout_below="@android:id/summary"
+            android:clipChildren="false"
+            android:clipToPadding="false">
+            <SeekBar
+                android:id="@+id/seekbar"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1"
+                style="@style/Widget.CarUi.SeekbarPreference.Seekbar"/>
+
+            <TextView
+                android:id="@+id/seekbar_value"
+                android:layout_width="0dp"
+                android:layout_height="0dp"
+                android:visibility="gone"/>
+        </androidx.preference.UnPressableLinearLayout>
+
+    </RelativeLayout>
+
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_widget_switch.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_widget_switch.xml
new file mode 100644
index 0000000000..15ef37cb87
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_preference_widget_switch.xml
@@ -0,0 +1,30 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="?android:attr/listPreferredItemHeightSmall"
+    android:layout_height="?android:attr/listPreferredItemHeightSmall">
+    <com.android.car.ui.uxr.DrawableStateSwitch
+        android:id="@android:id/switch_widget"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"
+        android:focusable="false"
+        style="@style/Widget.CarUi.SwitchPreference.Switch"/>
+</FrameLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar.xml
new file mode 100644
index 0000000000..0d2cfa3839
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar.xml
@@ -0,0 +1,185 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024, The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<com.android.car.ui.FocusArea
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="@dimen/car_ui_toolbar_first_row_height">
+    <androidx.constraintlayout.widget.ConstraintLayout
+        xmlns:app="http://schemas.android.com/apk/res-auto"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:id="@+id/car_ui_toolbar_background"
+        android:tag="carUiToolbar"
+        style="@style/Widget.CarUi.Toolbar.Container">
+
+        <androidx.constraintlayout.widget.Guideline
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_toolbar_start_guideline"
+            app:layout_constraintGuide_begin="@dimen/car_ui_toolbar_start_inset"
+            android:orientation="vertical"/>
+
+        <androidx.constraintlayout.widget.Guideline
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_toolbar_top_guideline"
+            app:layout_constraintGuide_begin="@dimen/car_ui_toolbar_top_inset"
+            android:orientation="horizontal"/>
+
+        <androidx.constraintlayout.widget.Guideline
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_toolbar_end_guideline"
+            app:layout_constraintGuide_end="@dimen/car_ui_toolbar_end_inset"
+            android:orientation="vertical"/>
+
+        <androidx.constraintlayout.widget.Guideline
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_toolbar_bottom_guideline"
+            app:layout_constraintGuide_end="@dimen/car_ui_toolbar_bottom_inset"
+            android:orientation="horizontal"/>
+
+        <!-- The horizontal bias here is so that when you set this view as GONE, it will be
+             treated as if it's all the way to the left instead of centered in the margin -->
+        <FrameLayout
+            android:id="@+id/car_ui_toolbar_nav_icon_container"
+            android:layout_width="@dimen/car_ui_toolbar_margin"
+            android:layout_height="0dp"
+            style="@style/Widget.CarUi.Toolbar.NavIconContainer"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_guideline"
+            app:layout_constraintStart_toEndOf="@id/car_ui_toolbar_start_guideline"
+            app:layout_constraintHorizontal_bias="0.0">
+            <ImageView
+                android:id="@+id/car_ui_toolbar_nav_icon"
+                android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+                android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+                android:layout_gravity="center"
+                android:scaleType="fitXY"
+                style="@style/Widget.CarUi.Toolbar.NavIcon"/>
+            <ImageView
+                android:id="@+id/car_ui_toolbar_logo"
+                android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                android:layout_gravity="center"
+                android:scaleType="fitXY"/>
+        </FrameLayout>
+
+        <FrameLayout
+            android:id="@+id/car_ui_toolbar_title_logo_container"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            style="@style/Widget.CarUi.Toolbar.LogoContainer"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_guideline"
+            app:layout_constraintStart_toEndOf="@id/car_ui_toolbar_nav_icon_container">
+
+            <ImageView
+                android:id="@+id/car_ui_toolbar_title_logo"
+                android:layout_margin="@dimen/car_ui_toolbar_logo_margin"
+                android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                android:scaleType="fitXY"
+                android:layout_gravity="center"
+                style="@style/Widget.CarUi.Toolbar.Logo"/>
+        </FrameLayout>
+
+        <LinearLayout android:layout_height="wrap_content"
+                      android:layout_width="0dp"
+                      android:id="@+id/car_ui_toolbar_title_container"
+                      android:orientation="vertical"
+                      android:layout_marginStart="@dimen/car_ui_toolbar_title_margin_start"
+                      app:layout_goneMarginStart="@dimen/car_ui_toolbar_title_no_logo_margin_start"
+                      app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+                      app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_guideline"
+                      app:layout_constraintStart_toEndOf="@+id/car_ui_toolbar_title_logo_container"
+                      app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_menu_items_container">
+            <TextView android:id="@+id/car_ui_toolbar_title"
+                      android:layout_width="wrap_content"
+                      android:layout_height="wrap_content"
+                      android:textAppearance="?com.android.oem.tokens:textAppearanceHeadlineSmall"
+                      android:singleLine="true"
+                      style="@style/Widget.CarUi.Toolbar.Title"/>
+            <TextView android:id="@+id/car_ui_toolbar_subtitle"
+                      android:layout_width="wrap_content"
+                      android:layout_height="wrap_content"
+                      android:visibility="gone"
+                      android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"
+                      style="@style/Widget.CarUi.Toolbar.Subtitle"/>
+        </LinearLayout>
+
+        <com.android.car.ui.toolbar.TabLayout
+            android:id="@+id/car_ui_toolbar_tabs"
+            android:layout_width="wrap_content"
+            android:layout_height="0dp"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_guideline"
+            app:layout_constraintStart_toEndOf="@+id/car_ui_toolbar_title_logo_container"
+            app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_menu_items_container"
+            app:layout_constraintHorizontal_bias="0.0"/>
+
+        <LinearLayout
+            android:id="@+id/car_ui_toolbar_menu_items_container"
+            android:layout_width="wrap_content"
+            android:layout_height="0dp"
+            android:orientation="horizontal"
+            style="@style/Widget.CarUi.Toolbar.MenuItem.Container"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_guideline"
+            app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_end_guideline"/>
+
+        <FrameLayout
+            android:id="@+id/car_ui_toolbar_search_view_container"
+            android:layout_width="0dp"
+            android:layout_height="@dimen/car_ui_toolbar_search_height"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_guideline"
+            app:layout_constraintStart_toEndOf="@+id/car_ui_toolbar_nav_icon_container"
+            app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_menu_items_container"/>
+
+        <View
+            android:id="@+id/car_ui_toolbar_row_separator"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/car_ui_toolbar_separator_height"
+            style="@style/Widget.CarUi.Toolbar.SeparatorView"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_guideline"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+        <ProgressBar
+            android:id="@+id/car_ui_toolbar_progress_bar"
+            style="@style/Widget.CarUi.Toolbar.ProgressBar"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"
+            android:indeterminate="true"
+            android:visibility="gone"/>
+
+        <View
+            android:id="@+id/car_ui_toolbar_bottom_styleable"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/car_ui_toolbar_bottom_view_height"
+            style="@style/Widget.CarUi.Toolbar.BottomView"
+            app:layout_constraintBottom_toTopOf="@+id/car_ui_toolbar_progress_bar"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+</com.android.car.ui.FocusArea>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_menu_item.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_menu_item.xml
new file mode 100644
index 0000000000..8d44cb4858
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_menu_item.xml
@@ -0,0 +1,66 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024, The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="wrap_content"
+    android:layout_height="match_parent"
+    android:focusable="false">
+    <FrameLayout
+        android:id="@+id/car_ui_toolbar_menu_item_icon_container"
+        style="@style/Widget.CarUi.Toolbar.MenuItem.IndividualContainer"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center">
+        <ImageView
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:layout_gravity="center"
+            android:src="@drawable/car_ui_toolbar_menu_item_icon_background"
+            android:scaleType="center"/>
+        <ImageView
+            android:id="@+id/car_ui_toolbar_menu_item_icon"
+            android:layout_width="44dp"
+            android:layout_height="44dp"
+            android:layout_gravity="center"
+            android:tint="@color/car_ui_toolbar_menu_item_icon_color"
+            android:tintMode="src_in"
+            tools:ignore="UseAppTint" />
+    </FrameLayout>
+    <com.android.car.ui.uxr.DrawableStateSwitch
+        android:id="@+id/car_ui_toolbar_menu_item_switch"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"/>
+
+    <!-- These buttons must have clickable="false" or they will steal the click events from the container -->
+    <com.android.car.ui.uxr.DrawableStateButton
+        android:id="@+id/car_ui_toolbar_menu_item_text"
+        style="@style/Widget.CarUi.Toolbar.TextButton"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"/>
+    <com.android.car.ui.uxr.DrawableStateButton
+        android:id="@+id/car_ui_toolbar_menu_item_text_with_icon"
+        style="@style/Widget.CarUi.Toolbar.TextButton.WithIcon"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"/>
+</FrameLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_menu_item_primary.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_menu_item_primary.xml
new file mode 100644
index 0000000000..7e74dbc0fc
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_menu_item_primary.xml
@@ -0,0 +1,66 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024, The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="wrap_content"
+    android:layout_height="match_parent"
+    android:focusable="false">
+    <FrameLayout
+        android:id="@+id/car_ui_toolbar_menu_item_icon_container"
+        style="@style/Widget.CarUi.Toolbar.MenuItem.IndividualContainer"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center">
+        <ImageView
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:layout_gravity="center"
+            android:src="@drawable/car_ui_toolbar_menu_item_icon_background"
+            android:scaleType="center"/>
+        <ImageView
+            android:id="@+id/car_ui_toolbar_menu_item_icon"
+            android:layout_width="44dp"
+            android:layout_height="44dp"
+            android:layout_gravity="center"
+            android:tint="@color/car_ui_toolbar_menu_item_icon_color"
+            android:tintMode="src_in"
+            tools:ignore="UseAppTint" />
+    </FrameLayout>
+    <com.android.car.ui.uxr.DrawableStateSwitch
+        android:id="@+id/car_ui_toolbar_menu_item_switch"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"/>
+
+    <!-- These buttons must have clickable="false" or they will steal the click events from the container -->
+    <com.android.car.ui.uxr.DrawableStateButton
+        android:id="@+id/car_ui_toolbar_menu_item_text"
+        style="@style/Widget.CarUi.Toolbar.TextButton.Primary"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"/>
+    <com.android.car.ui.uxr.DrawableStateButton
+        android:id="@+id/car_ui_toolbar_menu_item_text_with_icon"
+        style="@style/Widget.CarUi.Toolbar.TextButton.Primary"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:clickable="false"/>
+</FrameLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_two_row.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_two_row.xml
new file mode 100644
index 0000000000..0fe6dc90f5
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_toolbar_two_row.xml
@@ -0,0 +1,185 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024, The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<com.android.car.ui.FocusArea
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content">
+    <androidx.constraintlayout.widget.ConstraintLayout
+        xmlns:app="http://schemas.android.com/apk/res-auto"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:id="@+id/car_ui_toolbar_background"
+        style="@style/Widget.CarUi.Toolbar.Container">
+
+        <androidx.constraintlayout.widget.Guideline
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_toolbar_start_guideline"
+            app:layout_constraintGuide_begin="@dimen/car_ui_toolbar_start_inset"
+            android:orientation="vertical"/>
+
+        <androidx.constraintlayout.widget.Guideline
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_toolbar_top_guideline"
+            app:layout_constraintGuide_begin="@dimen/car_ui_toolbar_top_inset"
+            android:orientation="horizontal"/>
+
+        <androidx.constraintlayout.widget.Guideline
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_toolbar_end_guideline"
+            app:layout_constraintGuide_end="@dimen/car_ui_toolbar_end_inset"
+            android:orientation="vertical"/>
+
+        <androidx.constraintlayout.widget.Guideline
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:id="@+id/car_ui_toolbar_bottom_guideline"
+            app:layout_constraintGuide_end="@dimen/car_ui_toolbar_bottom_inset"
+            android:orientation="horizontal"/>
+
+        <androidx.constraintlayout.widget.Guideline
+            android:id="@+id/car_ui_toolbar_row_separator_guideline"
+            android:layout_width="0dp"
+            android:layout_height="0dp"
+            android:orientation="horizontal"
+            app:layout_constraintGuide_begin="@dimen/car_ui_toolbar_first_row_height"/>
+
+        <View
+            android:id="@+id/car_ui_toolbar_row_separator"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/car_ui_toolbar_separator_height"
+            style="@style/Widget.CarUi.Toolbar.SeparatorView"
+            app:layout_constraintTop_toBottomOf="@id/car_ui_toolbar_row_separator_guideline"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+        <FrameLayout
+            android:id="@+id/car_ui_toolbar_nav_icon_container"
+            android:layout_width="@dimen/car_ui_toolbar_margin"
+            android:layout_height="0dp"
+            style="@style/Widget.CarUi.Toolbar.NavIconContainer"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator"
+            app:layout_constraintStart_toStartOf="@id/car_ui_toolbar_start_guideline">
+            <ImageView
+                android:id="@+id/car_ui_toolbar_nav_icon"
+                android:layout_width="@dimen/car_ui_toolbar_nav_icon_size"
+                android:layout_height="@dimen/car_ui_toolbar_nav_icon_size"
+                android:layout_gravity="center"
+                android:scaleType="fitXY"
+                style="@style/Widget.CarUi.Toolbar.NavIcon"/>
+            <ImageView
+                android:id="@+id/car_ui_toolbar_logo"
+                android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                android:layout_gravity="center"
+                android:scaleType="fitXY"/>
+        </FrameLayout>
+
+        <FrameLayout
+            android:id="@+id/car_ui_toolbar_title_logo_container"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            style="@style/Widget.CarUi.Toolbar.LogoContainer"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator"
+            app:layout_constraintStart_toEndOf="@id/car_ui_toolbar_nav_icon_container">
+
+            <ImageView
+                android:id="@+id/car_ui_toolbar_title_logo"
+                android:layout_margin="@dimen/car_ui_toolbar_logo_margin"
+                android:layout_width="@dimen/car_ui_toolbar_logo_size"
+                android:layout_height="@dimen/car_ui_toolbar_logo_size"
+                android:scaleType="fitXY"
+                android:layout_gravity="center"
+                style="@style/Widget.CarUi.Toolbar.Logo"/>
+        </FrameLayout>
+
+        <LinearLayout android:layout_height="wrap_content"
+                      android:layout_width="0dp"
+                      android:id="@+id/car_ui_toolbar_title_container"
+                      android:orientation="vertical"
+                      android:layout_marginStart="@dimen/car_ui_toolbar_title_margin_start"
+                      app:layout_goneMarginStart="@dimen/car_ui_toolbar_title_no_logo_margin_start"
+                      app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+                      app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator"
+                      app:layout_constraintStart_toEndOf="@id/car_ui_toolbar_title_logo_container"
+                      app:layout_constraintEnd_toStartOf="@id/car_ui_toolbar_menu_items_container">
+            <TextView android:id="@+id/car_ui_toolbar_title"
+                      android:layout_width="wrap_content"
+                      android:layout_height="wrap_content"
+                      android:singleLine="true"
+                      android:textAppearance="?com.android.oem.tokens:textAppearanceHeadlineSmall"
+                      style="@style/Widget.CarUi.Toolbar.Title"/>
+            <TextView android:id="@+id/car_ui_toolbar_subtitle"
+                      android:layout_width="wrap_content"
+                      android:layout_height="wrap_content"
+                      android:visibility="gone"
+                      android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"
+                      style="@style/Widget.CarUi.Toolbar.Subtitle"/>
+        </LinearLayout>
+
+        <FrameLayout
+            android:id="@+id/car_ui_toolbar_search_view_container"
+            android:layout_width="0dp"
+            android:layout_height="@dimen/car_ui_toolbar_search_height"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator"
+            app:layout_constraintStart_toEndOf="@+id/car_ui_toolbar_nav_icon_container"
+            app:layout_constraintEnd_toStartOf="@+id/car_ui_toolbar_menu_items_container"/>
+
+        <LinearLayout
+            android:id="@+id/car_ui_toolbar_menu_items_container"
+            android:layout_width="wrap_content"
+            android:layout_height="0dp"
+            android:orientation="horizontal"
+            style="@style/Widget.CarUi.Toolbar.MenuItem.Container"
+            app:layout_constraintTop_toTopOf="@id/car_ui_toolbar_top_guideline"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_row_separator"
+            app:layout_constraintEnd_toStartOf="@id/car_ui_toolbar_end_guideline"/>
+
+        <com.android.car.ui.toolbar.TabLayout
+            android:id="@+id/car_ui_toolbar_tabs"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/car_ui_toolbar_second_row_height"
+            app:layout_constraintTop_toBottomOf="@id/car_ui_toolbar_row_separator"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_guideline"/>
+
+        <View
+            android:id="@+id/car_ui_toolbar_bottom_styleable"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/car_ui_toolbar_bottom_view_height"
+            style="@style/Widget.CarUi.Toolbar.BottomView"
+            app:layout_constraintBottom_toBottomOf="parent"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"/>
+
+        <ProgressBar
+            android:id="@+id/car_ui_toolbar_progress_bar"
+            style="@style/Widget.CarUi.Toolbar.ProgressBar"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            app:layout_constraintBottom_toTopOf="@id/car_ui_toolbar_bottom_styleable"
+            app:layout_constraintStart_toStartOf="parent"
+            app:layout_constraintEnd_toEndOf="parent"
+            android:indeterminate="true"
+            android:visibility="gone"/>
+
+    </androidx.constraintlayout.widget.ConstraintLayout>
+</com.android.car.ui.FocusArea>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_two_action_preference.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_two_action_preference.xml
new file mode 100644
index 0000000000..5c8cc9778c
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/layout/car_ui_two_action_preference.xml
@@ -0,0 +1,81 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="@android:color/transparent"
+    android:gravity="center_vertical"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall">
+    <com.android.car.ui.uxr.DrawableStateLinearLayout
+        android:id="@+id/car_ui_preference_container_without_widget"
+        android:layout_width="0dp"
+        android:layout_height="match_parent"
+        android:layout_weight="1"
+        android:background="?android:attr/selectableItemBackground"
+        android:clipToPadding="false"
+        android:gravity="start|center_vertical"
+        android:paddingBottom="16dp"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        android:paddingTop="16dp">
+        <androidx.preference.internal.PreferenceImageView
+            android:id="@android:id/icon"
+            android:layout_width="44dp"
+            android:layout_height="44dp"
+            android:layout_marginEnd="16dp"/>
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_centerVertical="true"
+            android:orientation="vertical">
+            <com.android.car.ui.uxr.DrawableStateTextView
+                android:id="@android:id/title"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:ellipsize="end"
+                android:maxLines="2"
+                android:textAppearance="?com.android.oem.tokens:textAppearanceBodyMedium"/>
+            <com.android.car.ui.uxr.DrawableStateTextView
+                android:id="@android:id/summary"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:textAppearance="?com.android.oem.tokens:textAppearanceBodySmall"/>
+        </LinearLayout>
+    </com.android.car.ui.uxr.DrawableStateLinearLayout>
+    <LinearLayout
+        android:id="@+id/action_widget_container"
+        android:layout_width="wrap_content"
+        android:layout_height="match_parent">
+        <View
+            android:layout_width="1dp"
+            android:layout_height="match_parent"
+            android:layout_marginBottom="16dp"
+            android:layout_marginTop="16dp"
+            android:background="#75ffffff"/>
+        <!-- Preference should place its actual preference widget here. -->
+        <com.android.car.ui.uxr.DrawableStateFrameLayout
+            android:id="@android:id/widget_frame"
+            android:layout_width="wrap_content"
+            android:layout_height="match_parent"
+            android:background="?android:attr/selectableItemBackground"
+            android:minWidth="?android:attr/listPreferredItemHeightSmall"
+            android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+            android:paddingStart="?android:attr/listPreferredItemPaddingStart"/>
+    </LinearLayout>
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-ldrtl/values.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-ldrtl/values.xml
new file mode 100644
index 0000000000..b3d46a5992
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-ldrtl/values.xml
@@ -0,0 +1,6 @@
+<resources>
+    <bool name="car_ui_toolbar_nav_icon_reserve_space">false</bool>
+    <bool name="car_ui_toolbar_logo_fills_nav_icon_space">false</bool>
+
+    <color name="car_ui_ripple_color">#27ffffff</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-night/colors.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-night/colors.xml
new file mode 100644
index 0000000000..bfd20e247d
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-night/colors.xml
@@ -0,0 +1,21 @@
+<?xml version='1.0' encoding='UTF-8'?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<resources>
+    <!-- Rotary focus -->
+
+    <color name="car_ui_rotary_focus_stroke_color">#94CBFF</color>
+    <color name="car_ui_rotary_focus_fill_color">#3D94CBFF</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-port/bools.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-port/bools.xml
new file mode 100644
index 0000000000..cff15d6a96
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values-port/bools.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright (C) 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+  -->
+
+<resources>
+    <!-- Toolbar -->
+
+    <!-- Whether tabs should use flex layout or not -->
+    <bool name="car_ui_toolbar_tab_flexible_layout">true</bool>
+    <!-- Whether tabs should be displayed on a second row, or they should be placed in the first
+         row, replacing the title -->
+    <bool name="car_ui_toolbar_tabs_on_second_row">true</bool>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/attrs.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/attrs.xml
new file mode 100644
index 0000000000..68d6530f01
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/attrs.xml
@@ -0,0 +1,67 @@
+<resources>
+    <!-- ConstraintLayout attributes. For a more complete list, see: -->
+    <!-- https://android.googlesource.com/platform/frameworks/opt/sherpa/+/studio-3.0/constraintlayout/src/main/res/values/attrs.xml -->
+
+    <attr name="layout_constraintGuide_begin" format="dimension"/>
+    <attr name="layout_constraintGuide_end" format="dimension"/>
+    <attr name="layout_constraintGuide_percent" format="float"/>
+
+    <attr name="layout_constraintLeft_toLeftOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintLeft_toRightOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintRight_toLeftOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintRight_toRightOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintTop_toTopOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintTop_toBottomOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintBottom_toTopOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintBottom_toBottomOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintBaseline_toBaselineOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintStart_toEndOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintStart_toStartOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintEnd_toStartOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+    <attr name="layout_constraintEnd_toEndOf" format="reference|enum">
+        <enum name="parent" value="0"/>
+    </attr>
+
+    <attr name="layout_constraintHorizontal_bias" format="float"/>
+    <attr name="layout_constraintVertical_bias" format="float"/>
+
+    <attr name="layout_constraintVertical_chainStyle" format="enum">
+        <enum name="spread" value="0"/>
+        <enum name="spread_inside" value="1"/>
+        <enum name="packed" value="2"/>
+    </attr>
+
+    <attr name="layout_goneMarginLeft" format="dimension"/>
+    <attr name="layout_goneMarginTop" format="dimension"/>
+    <attr name="layout_goneMarginRight" format="dimension"/>
+    <attr name="layout_goneMarginBottom" format="dimension"/>
+    <attr name="layout_goneMarginStart" format="dimension"/>
+    <attr name="layout_goneMarginEnd" format="dimension"/>
+
+    <attr name="state_ux_restricted"/>
+
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/bools.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/bools.xml
new file mode 100644
index 0000000000..c2e7b24df8
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/bools.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<resources>
+    <!-- Whether two action switch preference's secondary action focus should outline the switch-->
+    <!-- true outlines switch, false outlines surrounding container (car_ui_secondary_action) -->
+    <bool name="car_ui_preference_two_action_switch_widget_focusable">true</bool>
+</resources>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/colors.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/colors.xml
new file mode 100644
index 0000000000..c6f696055e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/colors.xml
@@ -0,0 +1,35 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2017, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<resources>
+    <!-- Rotary Colors -->
+    <color name="car_rotary_focus_stroke_color">#94CBFF</color>
+    <color name="car_rotary_focus_fill_color">#3D94CBFF</color>
+    <color name="car_rotary_focus_pressed_fill_color">#8A94CBFF</color>
+
+    <!-- Color of the outer ring when the SeekBar is selected. -->
+    <color name="car_ui_seekbar_thumb_selected_stroke_color">@color/car_rotary_focus_stroke_color</color>
+    <!-- Color of the background of the ring when the SeekBar is selected. -->
+    <color name="car_ui_seekbar_thumb_selected_background_color">@color/car_rotary_focus_fill_color</color>
+    <!-- The preference category icon color-->
+    <color name="car_ui_preference_icon_color">@color/car_ui_text_color_primary</color>
+    <!-- The text color for selected toolbar tabs -->
+    <color name="car_ui_toolbar_tab_selected_color">?com.android.oem.tokens:colorOnSecondaryContainer</color>
+    <!-- The text color for unselected toolbar tabs -->
+    <color name="car_ui_toolbar_tab_unselected_color">?com.android.oem.tokens:colorOnSurfaceVariant</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/dimens.xml
new file mode 100644
index 0000000000..8a919487a7
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/dimens.xml
@@ -0,0 +1,93 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+<resources>
+    <dimen name="car_rotary_focus_stroke_width">8dp</dimen>
+    <dimen name="car_rotary_focus_pressed_stroke_width">4dp</dimen>
+
+    <dimen name="car_selectable_item_radius">24dp</dimen>
+
+    <dimen name="car_ui_toolbar_margin">76dp</dimen>
+    <!-- Paddings -->
+    <dimen name="car_ui_padding_0">4dp</dimen>
+    <dimen name="car_ui_padding_1">8dp</dimen>
+    <dimen name="car_ui_padding_2">12dp</dimen>
+    <dimen name="car_ui_padding_3">16dp</dimen>
+    <dimen name="car_ui_padding_4">24dp</dimen>
+    <dimen name="car_ui_padding_5">32dp</dimen>
+    <dimen name="car_ui_padding_6">48dp</dimen>
+    <dimen name="car_ui_padding_7">64dp</dimen>
+    <dimen name="car_ui_padding_8">96dp</dimen>
+
+    <!-- Alpha for disabled CarUiRecyclerView default scrollbar button -->
+    <dimen name="car_ui_button_disabled_alpha">0.46</dimen>
+    <!-- Margin on top and bottom of scrollbar track. -->
+    <dimen name="car_ui_scrollbar_separator_margin">0dp</dimen>
+
+    <!-- SeekBar dimensions. -->
+    <!-- Allows thumb to extend out of the range of the track. -->
+    <!-- For more information see android.widget.SeekBar#attr_android:thumbOffset. -->
+    <dimen name="car_ui_seekbar_thumb_offset">24dp</dimen>
+    <!-- Horizontal padding for the SeekBar.-->
+    <dimen name="car_ui_seekbar_horizontal_padding">24dp</dimen>
+    <!-- The SeekBar track height.-->
+    <dimen name="car_ui_seekbar_track_height">24dp</dimen>
+    <!-- Vertical padding that extends the touch area for the SeekBar. -->
+    <dimen name="car_ui_seekbar_track_vertical_padding">26dp</dimen>
+    <!-- The stroke with of the ring around the SeekBar thumb when selected. -->
+    <dimen name="car_ui_seekbar_thumb_selected_stroke_width">8dp</dimen>
+    <!-- The size of the SeekBar thumb. -->
+    <dimen name="car_ui_seekbar_thumb_size">68dp</dimen>
+    <!-- Should be the half of car_switch_track_height. -->
+    <dimen name="car_ui_seekbar_thumb_outer_radius">24dp</dimen>
+
+    <!-- Height of the top toolbar row. This can be customized independently. -->
+    <dimen name="car_ui_toolbar_first_row_height">@dimen/car_ui_toolbar_row_height</dimen>
+    <!-- Margin at the start of the title when there is no logo present -->
+    <dimen name="car_ui_toolbar_title_no_logo_margin_start">17dp</dimen>
+    <!-- Margin at the start of the title -->
+    <dimen name="car_ui_toolbar_title_margin_start">17dp</dimen>
+    <!-- Height of the search box -->
+    <dimen name="car_ui_toolbar_search_height">0dp</dimen>
+    <!-- Padding on the toolbar start (e.g.: distance between the container start and the start of
+    nav icon or logo) -->
+    <dimen name="car_ui_toolbar_start_inset">0dp</dimen>
+    <!-- Top padding -->
+    <dimen name="car_ui_toolbar_top_inset">0dp</dimen>
+    <!-- End padding (e.g.: distance between the container end and the end of the menu items) -->
+    <dimen name="car_ui_toolbar_end_inset">0dp</dimen>
+    <!-- Bottom padding -->
+    <dimen name="car_ui_toolbar_bottom_inset">0dp</dimen>
+
+    <!-- can't use 0dp for layout_height or the constraintlayout effect kicks in -->
+    <dimen name="car_ui_toolbar_separator_height">0.1dp</dimen>
+    <!-- can't use 0dp for layout_height or the constraintlayout effect kicks in -->
+    <dimen name="car_ui_toolbar_bottom_view_height">0.1dp</dimen>
+    <!-- Height of the bottom toolbar row (if the toolbar is used in two-rows mode. -->
+    <dimen name="car_ui_toolbar_second_row_height">@dimen/car_ui_toolbar_row_height</dimen>
+
+    <!-- Default height for both toolbar rows. See car_ui_toolbar_first_row_height and
+     car_ui_toolbar_second_row_height -->
+    <dimen name="car_ui_toolbar_row_height">96dp</dimen>
+    <!-- Margin between the logo and the title, when both logo and navigation icons are used -->
+    <dimen name="car_ui_toolbar_title_logo_padding">0dp</dimen>
+    <!-- Margin on the outside the toolbar logo -->
+    <dimen name="car_ui_toolbar_logo_margin">17dp</dimen>
+    <!-- Icon size for icon menu items -->
+    <dimen name="car_ui_toolbar_menu_item_icon_size">36dp</dimen>
+
+    <!-- Height of edit text in dialogs -->
+    <dimen name="car_ui_dialog_edittext_height">64dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/drawables.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/drawables.xml
new file mode 100644
index 0000000000..d0bfa8c71c
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/drawables.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<resources xmlns:android="http://schemas.android.com/apk/res/android">
+    <!-- Toolbar background color -->
+    <drawable name="car_ui_toolbar_background">@*android:color/background_device_default_dark</drawable>
+</resources>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/styles.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/styles.xml
new file mode 100644
index 0000000000..4ee484cb72
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/styles.xml
@@ -0,0 +1,156 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+<resources xmlns:android="http://schemas.android.com/apk/res/android">
+    <style name="Widget.CarUi" parent="android:Widget.DeviceDefault"/>
+
+    <style name="Widget.CarUi.Toolbar"/>
+
+    <style name="Widget.CarUi.Toolbar.NavIconContainer">
+        <item name="android:layout_marginVertical">10dp</item>
+        <item name="android:layout_marginHorizontal">18dp</item>
+        <item name="android:background">@drawable/car_ui_toolbar_menu_item_icon_ripple</item>
+    </style>
+
+    <style name="Widget.CarUi.Toolbar.NavIcon">
+        <item name="android:tint">@color/car_ui_text_color_primary</item>
+        <item name="android:src">@drawable/car_ui_icon_arrow_back</item>
+    </style>
+
+    <style name="Widget.CarUi.Toolbar.MenuItem"/>
+
+    <style name="Widget.CarUi.Toolbar.MenuItem.IndividualContainer">
+        <item name="android:minHeight">76dp</item>
+        <item name="android:minWidth">76dp</item>
+        <item name="android:background">@drawable/car_ui_toolbar_menu_item_icon_ripple</item>
+        <item name="android:focusable">true</item>
+    </style>
+
+    <style name="Widget.CarUi.Button.Borderless.Colored"
+           parent="android:Widget.DeviceDefault.Button.Borderless.Colored"/>
+
+    <style name="Widget.CarUi.Button"
+           parent="android:Widget.DeviceDefault.Button"/>
+
+    <style name="Widget.CarUi.Toolbar.TextButton" parent="Widget.CarUi.Button.Borderless.Colored">
+        <item name="android:drawableTint">@color/car_ui_toolbar_menu_item_icon_color</item>
+        <item name="android:drawablePadding">10dp</item>
+        <item name="android:maxWidth">350dp</item>
+        <item name="android:minHeight">75dp</item>
+    </style>
+
+    <style name="Widget.CarUi.Toolbar.TextButton.WithIcon">
+        <item name="android:textColor">@color/car_ui_toolbar_menu_item_icon_color</item>
+    </style>
+    <style name="Widget.CarUi.Toolbar.TextButton.Primary" parent="Widget.CarUi.Button">
+        <item name="android:drawableTint">@color/car_ui_toolbar_menu_item_icon_color</item>
+        <item name="android:maxWidth">350dp</item>
+        <item name="android:drawablePadding">@dimen/car_ui_padding_2</item>
+        <item name="android:paddingBottom">@dimen/car_ui_padding_2</item>
+        <item name="android:paddingTop">@dimen/car_ui_padding_2</item>
+        <item name="android:paddingStart">@dimen/car_ui_padding_3</item>
+        <item name="android:paddingEnd">@dimen/car_ui_padding_4</item>
+    </style>
+
+    <style name="Widget.CarUi.SwitchPreference"/>
+
+    <style name="Widget.CarUi.SwitchPreference.Switch">
+        <item name="android:track">@drawable/car_ui_switch_track</item>
+        <item name="android:thumbTint">@color/car_ui_switch_thumb_color</item>
+    </style>
+
+    <style name="Widget.CarUi.SeekbarPreference"/>
+
+    <!-- Style applied to the seekbar widget within the seekbar preference -->
+    <style name="Widget.CarUi.SeekbarPreference.Seekbar">
+        <item name="android:background">@null</item>
+        <item name="android:clickable">false</item>
+        <item name="android:focusable">false</item>
+        <item name="android:thumb">@drawable/car_ui_seekbar_thumb_selectable</item>
+        <item name="android:progressDrawable">@drawable/car_ui_seekbar_track</item>
+        <item name="android:splitTrack">false</item>
+        <item name="android:thumbOffset">@dimen/car_ui_seekbar_thumb_offset</item>
+        <item name="android:paddingStart">@dimen/car_ui_seekbar_horizontal_padding</item>
+        <item name="android:paddingEnd">@dimen/car_ui_seekbar_horizontal_padding</item>
+        <item name="*android:useDisabledAlpha">true</item>
+        <item name="android:clipToOutline">false</item>
+        <item name="android:clipToPadding">false</item>
+    </style>
+
+    <style name="TextAppearance.CarUi" parent="android:TextAppearance.DeviceDefault">
+        <item name="android:textColor">@color/car_ui_text_color_primary</item>
+        <item name="android:textAlignment">viewStart</item>
+    </style>
+
+    <style name="TextAppearance.CarUi.Body1">
+        <item name="android:textSize">32sp</item>
+    </style>
+
+    <style name="TextAppearance.CarUi.Body3">
+        <item name="android:textSize">24sp</item>
+    </style>
+
+    <style name="TextAppearance.CarUi.ListItem" parent="TextAppearance.CarUi.Body1"/>
+
+    <style name="TextAppearance.CarUi.ListItem.Body" parent="TextAppearance.CarUi.Body3">
+        <item name="android:textColor">@color/car_ui_text_color_secondary</item>
+    </style>
+
+    <style name="TextAppearance.CarUi.AlertDialog.Title" parent="TextAppearance.CarUi" >
+        <item name="android:textSize">36sp</item>
+        <item name="android:lineHeight">44dp</item>
+        <item name="android:textStyle">normal</item>
+        <item name="android:textColor">?com.android.oem.tokens:colorOnSurface</item>
+        <item name="android:stateListAnimator">@null</item>
+    </style>
+
+    <style name="Widget.CarUi.Toolbar.Container"></style>
+    <style name="Widget.CarUi.Toolbar.LogoContainer">
+        <item name="android:paddingEnd">@dimen/car_ui_toolbar_title_logo_padding</item>
+    </style>
+    <style name="Widget.CarUi.Toolbar.Logo"></style>
+    <style name="Widget.CarUi.Toolbar.Title">
+        <item name="android:textAppearance">@style/TextAppearance.CarUi.Widget.Toolbar.Title</item>
+        <item name="android:textAlignment">viewStart</item>
+    </style>
+    <style name="Widget.CarUi.Toolbar.Subtitle">
+        <item name="android:textAppearance">?android:attr/textAppearanceSmall</item>
+        <item name="android:textAlignment">viewStart</item>
+    </style>
+    <style name="Widget.CarUi.Toolbar.MenuItem.Container">
+        <item name="android:divider">@drawable/car_ui_toolbar_menu_item_divider</item>
+        <item name="android:showDividers">beginning|middle|end</item>
+    </style>
+    <style name="Widget.CarUi.Toolbar.ProgressBar"
+        parent="@android:style/Widget.DeviceDefault.ProgressBar.Horizontal"/>
+
+    <style name="Widget.CarUi.Toolbar.SeparatorView">
+        <item name="android:height">0.01dp</item>
+        <item name="android:background">@android:color/transparent</item>
+    </style>
+    <style name="Widget.CarUi.Toolbar.BottomView">
+        <item name="android:height">0.01dp</item>
+        <item name="android:background">@android:color/transparent</item>
+    </style>
+    <style name="Widget.CarUi.Toolbar.Tab"/>
+    <style name="Widget.CarUi.Toolbar.Tab.Container">
+        <item name="android:orientation">vertical</item>
+        <item name="android:paddingStart">12dp</item>
+        <item name="android:paddingEnd">12dp</item>
+        <item name="android:gravity">center</item>
+        <item name="android:background">@drawable/car_ui_toolbar_tab_background</item>
+    </style>
+
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/values.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/values.xml
new file mode 100644
index 0000000000..d7f6526abc
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/values/values.xml
@@ -0,0 +1,15 @@
+<resources>
+    <style name="TextAppearance.CarUi.Widget" parent="android:TextAppearance.DeviceDefault.Widget"/>
+
+    <style name="TextAppearance.CarUi.Widget.Toolbar"/>
+
+    <style name="TextAppearance.CarUi.Widget.Toolbar.Title">
+        <item name="android:singleLine">true</item>
+        <item name="android:textSize">32sp</item>
+    </style>
+
+    <dimen name="car_ui_toolbar_logo_size">44dp</dimen>
+    <dimen name="car_ui_toolbar_nav_icon_size">44dp</dimen>
+
+    <bool name="car_ui_toolbar_menuitem_individual_click_listeners">true</bool>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/xml/overlays.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/xml/overlays.xml
new file mode 100644
index 0000000000..f1f0a53929
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenCarUiPluginRRO/res/xml/overlays.xml
@@ -0,0 +1,151 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+<overlay>
+    <item target="attr/layout_constraintBottom_toBottomOf" value="@attr/layout_constraintBottom_toBottomOf"/>
+    <item target="attr/layout_constraintBottom_toTopOf" value="@attr/layout_constraintBottom_toTopOf"/>
+    <item target="attr/layout_constraintEnd_toEndOf" value="@attr/layout_constraintEnd_toEndOf"/>
+    <item target="attr/layout_constraintEnd_toStartOf" value="@attr/layout_constraintEnd_toStartOf"/>
+    <item target="attr/layout_constraintGuide_begin" value="@attr/layout_constraintGuide_begin"/>
+    <item target="attr/layout_constraintGuide_end" value="@attr/layout_constraintGuide_end"/>
+    <item target="attr/layout_constraintHorizontal_bias" value="@attr/layout_constraintHorizontal_bias"/>
+    <item target="attr/layout_constraintLeft_toLeftOf" value="@attr/layout_constraintLeft_toLeftOf"/>
+    <item target="attr/layout_constraintLeft_toRightOf" value="@attr/layout_constraintLeft_toRightOf"/>
+    <item target="attr/layout_constraintRight_toLeftOf" value="@attr/layout_constraintRight_toLeftOf"/>
+    <item target="attr/layout_constraintRight_toRightOf" value="@attr/layout_constraintRight_toRightOf"/>
+    <item target="attr/layout_constraintStart_toEndOf" value="@attr/layout_constraintStart_toEndOf"/>
+    <item target="attr/layout_constraintStart_toStartOf" value="@attr/layout_constraintStart_toStartOf"/>
+    <item target="attr/layout_constraintTop_toBottomOf" value="@attr/layout_constraintTop_toBottomOf"/>
+    <item target="attr/layout_constraintTop_toTopOf" value="@attr/layout_constraintTop_toTopOf"/>
+    <item target="attr/layout_constraintVertical_chainStyle" value="@attr/layout_constraintVertical_chainStyle"/>
+    <item target="attr/layout_goneMarginBottom" value="@attr/layout_goneMarginBottom"/>
+    <item target="attr/layout_goneMarginEnd" value="@attr/layout_goneMarginEnd"/>
+    <item target="attr/layout_goneMarginLeft" value="@attr/layout_goneMarginLeft"/>
+    <item target="attr/layout_goneMarginRight" value="@attr/layout_goneMarginRight"/>
+    <item target="attr/layout_goneMarginStart" value="@attr/layout_goneMarginStart"/>
+    <item target="attr/layout_goneMarginTop" value="@attr/layout_goneMarginTop"/>
+    <item target="attr/state_ux_restricted" value="@attr/state_ux_restricted"/>
+
+    <item target="bool/car_ui_preference_two_action_switch_widget_focusable" value="@bool/car_ui_preference_two_action_switch_widget_focusable" />
+    <item target="bool/car_ui_toolbar_logo_fills_nav_icon_space" value="@bool/car_ui_toolbar_logo_fills_nav_icon_space" />
+    <item target="bool/car_ui_toolbar_menuitem_individual_click_listeners" value="@bool/car_ui_toolbar_menuitem_individual_click_listeners" />
+    <item target="bool/car_ui_toolbar_nav_icon_reserve_space" value="@bool/car_ui_toolbar_nav_icon_reserve_space" />
+    <item target="bool/car_ui_toolbar_tab_flexible_layout" value="@bool/car_ui_toolbar_tab_flexible_layout" />
+    <item target="bool/car_ui_toolbar_tabs_on_second_row" value="@bool/car_ui_toolbar_tabs_on_second_row" />
+
+    <item target="color/car_ui_text_color_primary" value="@color/car_ui_text_color_primary"/>
+    <item target="color/car_ui_text_color_secondary" value="@color/car_ui_text_color_secondary"/>
+    <item target="color/car_ui_toolbar_menu_item_icon_background_color" value="@color/car_ui_toolbar_menu_item_icon_background_color"/>
+    <item target="color/car_ui_toolbar_menu_item_icon_color" value="@color/car_ui_toolbar_menu_item_icon_color"/>
+    <item target="color/car_ui_toolbar_tab_selected_color" value="@color/car_ui_toolbar_tab_selected_color"/>
+    <item target="color/car_ui_toolbar_tab_unselected_color" value="@color/car_ui_toolbar_tab_unselected_color"/>
+    <item target="color/car_ui_scrollbar_thumb" value="@color/car_ui_scrollbar_thumb"/>
+
+    <item target="dimen/car_ui_toolbar_margin" value="@dimen/car_ui_toolbar_margin"/>
+    <item target="dimen/car_ui_toolbar_menu_item_icon_size" value="@dimen/car_ui_toolbar_menu_item_icon_size"/>
+    <item target="dimen/car_ui_button_disabled_alpha" value="@dimen/car_ui_button_disabled_alpha"/>
+    <item target="dimen/car_ui_scrollbar_separator_margin" value="@dimen/car_ui_scrollbar_separator_margin"/>
+    <item target="dimen/car_ui_dialog_edittext_height" value="@dimen/car_ui_dialog_edittext_height"/>
+
+    <item target="drawable/car_ui_icon_arrow_back" value="@drawable/car_ui_icon_arrow_back"/>
+    <item target="drawable/car_ui_list_item_divider" value="@drawable/car_ui_list_item_divider"/>
+    <item target="drawable/car_ui_list_item_background" value="@drawable/car_ui_list_item_background"/>
+    <item target="drawable/car_ui_list_item_avatar_icon_outline" value="@drawable/car_ui_list_item_avatar_icon_outline"/>
+    <item target="drawable/car_ui_toolbar_background" value="@drawable/car_ui_toolbar_background" />
+    <item target="drawable/car_ui_toolbar_menu_item_icon_background" value="@drawable/car_ui_toolbar_menu_item_icon_background"/>
+
+    <item target="id/car_ui_base_layout_content_container" value="@id/car_ui_base_layout_content_container" />
+    <item target="id/car_ui_first_action_container" value="@id/car_ui_first_action_container" />
+    <item target="id/car_ui_divider" value="@id/car_ui_divider" />
+    <item target="id/car_ui_second_action_container" value="@id/car_ui_second_action_container" />
+    <item target="id/car_ui_secondary_action" value="@id/car_ui_secondary_action" />
+    <item target="id/car_ui_secondary_action_concrete" value="@id/car_ui_secondary_action_concrete" />
+    <item target="id/car_ui_link" value="@id/car_ui_link" />
+    <item target="id/car_ui_list_item_touch_interceptor" value="@id/car_ui_list_item_touch_interceptor"/>
+    <item target="id/car_ui_list_item_reduced_touch_interceptor" value="@id/car_ui_list_item_reduced_touch_interceptor"/>
+    <item target="id/car_ui_list_item_icon_container" value="@id/car_ui_list_item_icon_container"/>
+    <item target="id/car_ui_list_item_icon" value="@id/car_ui_list_item_icon"/>
+    <item target="id/car_ui_list_item_content_icon" value="@id/car_ui_list_item_content_icon"/>
+    <item target="id/car_ui_list_item_avatar_icon" value="@id/car_ui_list_item_avatar_icon"/>
+    <item target="id/car_ui_list_item_title" value="@id/car_ui_list_item_title"/>
+    <item target="id/car_ui_list_item_body" value="@id/car_ui_list_item_body"/>
+    <item target="id/car_ui_list_item_action_container_touch_interceptor" value="@id/car_ui_list_item_action_container_touch_interceptor"/>
+    <item target="id/car_ui_list_item_action_container" value="@id/car_ui_list_item_action_container"/>
+    <item target="id/car_ui_list_item_action_divider" value="@id/car_ui_list_item_action_divider"/>
+    <item target="id/car_ui_list_item_switch_widget" value="@id/car_ui_list_item_switch_widget"/>
+    <item target="id/car_ui_list_item_checkbox_widget" value="@id/car_ui_list_item_checkbox_widget"/>
+    <item target="id/car_ui_list_item_radio_button_widget" value="@id/car_ui_list_item_radio_button_widget"/>
+    <item target="id/car_ui_list_item_supplemental_icon" value="@id/car_ui_list_item_supplemental_icon"/>
+    <item target="id/car_ui_preference_container_without_widget" value="@id/car_ui_preference_container_without_widget" />
+    <item target="id/action_widget_container" value="@id/action_widget_container" />
+    <item target="id/car_ui_toolbar_background" value="@id/car_ui_toolbar_background" />
+    <item target="id/car_ui_toolbar_logo" value="@id/car_ui_toolbar_logo" />
+    <item target="id/car_ui_toolbar_menu_item_icon_container" value="@id/car_ui_toolbar_menu_item_icon_container"/>
+    <item target="id/car_ui_toolbar_menu_item_icon" value="@id/car_ui_toolbar_menu_item_icon"/>
+    <item target="id/car_ui_toolbar_menu_items_container" value="@id/car_ui_toolbar_menu_items_container" />
+    <item target="id/car_ui_toolbar_menu_item_switch" value="@id/car_ui_toolbar_menu_item_switch"/>
+    <item target="id/car_ui_toolbar_menu_item_text" value="@id/car_ui_toolbar_menu_item_text"/>
+    <item target="id/car_ui_toolbar_menu_item_text_with_icon" value="@id/car_ui_toolbar_menu_item_text_with_icon"/>
+    <item target="id/car_ui_toolbar_nav_icon_container" value="@id/car_ui_toolbar_nav_icon_container" />
+    <item target="id/car_ui_toolbar_nav_icon" value="@id/car_ui_toolbar_nav_icon" />
+    <item target="id/car_ui_toolbar_progress_bar" value="@id/car_ui_toolbar_progress_bar" />
+    <item target="id/car_ui_toolbar_search_view_container" value="@id/car_ui_toolbar_search_view_container" />
+    <item target="id/car_ui_toolbar_subtitle" value="@id/car_ui_toolbar_subtitle" />
+    <item target="id/car_ui_toolbar_tabs" value="@id/car_ui_toolbar_tabs" />
+    <item target="id/car_ui_toolbar_title_container" value="@id/car_ui_toolbar_title_container" />
+    <item target="id/car_ui_toolbar_title_logo_container" value="@id/car_ui_toolbar_title_logo_container" />
+    <item target="id/car_ui_toolbar_title_logo" value="@id/car_ui_toolbar_title_logo" />
+    <item target="id/car_ui_toolbar_title" value="@id/car_ui_toolbar_title" />
+    <item target="id/list" value="@id/list"/>
+    <item target="id/seekbar" value="@id/seekbar"/>
+    <item target="id/seekbar_value" value="@id/seekbar_value"/>
+
+    <item target="layout/car_ui_alert_dialog_list" value="@layout/car_ui_alert_dialog_list"/>
+    <item target="layout/car_ui_base_layout_toolbar" value="@layout/car_ui_base_layout_toolbar"/>
+    <item target="layout/car_ui_list_item_2" value="@layout/car_ui_list_item_2"/>
+    <item target="layout/car_ui_preference" value="@layout/car_ui_preference"/>
+    <item target="layout/car_ui_preference_category" value="@layout/car_ui_preference_category"/>
+    <item target="layout/car_ui_preference_footer" value="@layout/car_ui_preference_footer"/>
+    <item target="layout/car_ui_preference_primary_switch" value="@layout/car_ui_preference_primary_switch"/>
+    <item target="layout/car_ui_preference_two_action_icon" value="@layout/car_ui_preference_two_action_icon"/>
+    <item target="layout/car_ui_preference_two_action_switch" value="@layout/car_ui_preference_two_action_switch"/>
+    <item target="layout/car_ui_preference_two_action_text" value="@layout/car_ui_preference_two_action_text"/>
+    <item target="layout/car_ui_preference_two_action_text_borderless" value="@layout/car_ui_preference_two_action_text_borderless"/>
+    <item target="layout/car_ui_preference_widget_switch" value="@layout/car_ui_preference_widget_switch"/>
+    <item target="layout/car_ui_preference_widget_seekbar" value="@layout/car_ui_preference_widget_seekbar"/>
+    <item target="layout/car_ui_two_action_preference" value="@layout/car_ui_two_action_preference"/>
+    <item target="layout/car_ui_toolbar_menu_item_primary" value="@layout/car_ui_toolbar_menu_item_primary"/>
+    <item target="layout/car_ui_toolbar_menu_item" value="@layout/car_ui_toolbar_menu_item"/>
+    <item target="layout/car_ui_toolbar_two_row" value="@layout/car_ui_toolbar_two_row"/>
+    <item target="layout/car_ui_toolbar" value="@layout/car_ui_toolbar"/>
+
+    <item target="style/TextAppearance.CarUi.Body1" value="@style/TextAppearance.CarUi.Body1"/>
+    <item target="style/TextAppearance.CarUi.Body3" value="@style/TextAppearance.CarUi.Body3"/>
+    <item target="style/TextAppearance.CarUi.ListItem" value="@style/TextAppearance.CarUi.ListItem"/>
+    <item target="style/TextAppearance.CarUi.ListItem.Body" value="@style/TextAppearance.CarUi.ListItem.Body"/>
+    <item target="style/TextAppearance.CarUi" value="@style/TextAppearance.CarUi"/>
+    <item target="style/Widget.CarUi.Button.Borderless.Colored" value="@style/Widget.CarUi.Button.Borderless.Colored"/>
+    <item target="style/Widget.CarUi.SeekbarPreference.Seekbar" value="@style/Widget.CarUi.SeekbarPreference.Seekbar"/>
+    <item target="style/Widget.CarUi.SeekbarPreference" value="@style/Widget.CarUi.SeekbarPreference"/>
+    <item target="style/Widget.CarUi.Toolbar.MenuItem.IndividualContainer" value="@style/Widget.CarUi.Toolbar.MenuItem.IndividualContainer"/>
+    <item target="style/Widget.CarUi.Toolbar.MenuItem" value="@style/Widget.CarUi.Toolbar.MenuItem"/>
+    <item target="style/Widget.CarUi.Toolbar.NavIconContainer" value="@style/Widget.CarUi.Toolbar.NavIconContainer"/>
+    <item target="style/Widget.CarUi.Toolbar.NavIcon" value="@style/Widget.CarUi.Toolbar.NavIcon"/>
+    <item target="style/Widget.CarUi.Toolbar.Tab.Container" value="@style/Widget.CarUi.Toolbar.Tab.Container"/>
+    <item target="style/Widget.CarUi.Toolbar.TextButton" value="@style/Widget.CarUi.Toolbar.TextButton"/>
+    <item target="style/Widget.CarUi.Toolbar.TextButton.WithIcon" value="@style/Widget.CarUi.Toolbar.TextButton.WithIcon"/>
+    <item target="style/Widget.CarUi.Toolbar" value="@style/Widget.CarUi.Toolbar"/>
+    <item target="style/Widget.CarUi" value="@style/Widget.CarUi"/>
+</overlay>
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/Android.bp b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/Android.bp
similarity index 62%
rename from car_product/car_ui_portrait/apps/CarUiPortraitSettings/Android.bp
rename to car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/Android.bp
index c3ec7bf5fb..0dfd4442bb 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/Android.bp
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/Android.bp
@@ -1,4 +1,4 @@
-// Copyright (C) 2021 The Android Open Source Project
+// Copyright (C) 2024 The Android Open Source Project
 //
 // Licensed under the Apache License, Version 2.0 (the "License");
 // you may not use this file except in compliance with the License.
@@ -16,32 +16,24 @@ package {
     default_applicable_licenses: ["Android-Apache-2.0"],
 }
 
-android_app {
-    name: "CarUiPortraitSettings",
-    overrides: ["CarSettings"],
-    platform_apis: true,
-
-    manifest: "AndroidManifest.xml",
-
+runtime_resource_overlay {
+    name: "OEMDesignTokenFrameworkResRRO",
     resource_dirs: ["res"],
-
+    certificate: "platform",
+    manifest: "AndroidManifest.xml",
     static_libs: [
-        "CarSettings-core",
+        "OEMDesignTokenBase",
+        "OEMDesignTokenShim",
     ],
+}
 
+runtime_resource_overlay {
+    name: "OEMNorthStarFrameworkResRRO",
+    resource_dirs: ["res"],
     certificate: "platform",
-
-    optimize: {
-        proguard_flags_files: [":CarSettings_proguard_flags"],
-    },
-
-    privileged: true,
-
-    dex_preopt: {
-        enabled: false,
-    },
-
-    required: ["allowed_privapp_com.android.car.settings"],
-
-    dxflags: ["--multi-dex"],
+    manifest: "AndroidManifest.xml",
+    static_libs: [
+        "NorthStarBase",
+        "NorthStarShim",
+    ],
 }
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/AndroidManifest.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/AndroidManifest.xml
similarity index 72%
rename from car_product/car_ui_portrait/apps/CarUiPortraitSettings/AndroidManifest.xml
rename to car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/AndroidManifest.xml
index 4398b83191..7e9dc54aa2 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/AndroidManifest.xml
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/AndroidManifest.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2021 The Android Open Source Project
+  ~ Copyright (C) 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
@@ -14,14 +14,10 @@
   ~ See the License for the specific language governing permissions and
   ~ limitations under the License.
   -->
-
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
-          package="com.android.car.settings"
-          android:sharedUserId="android.uid.system"
-          coreApp="true">
-
-    <uses-sdk
-        android:minSdkVersion="24"
-        android:targetSdkVersion="32"/>
-
+          package="oem.brand.model.android.rro">
+    <application android:hasCode="false" />
+    <overlay
+        android:targetPackage="android"/>
 </manifest>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/anim/fade_in.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/anim/fade_in.xml
new file mode 100644
index 0000000000..9c19d4e35a
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/anim/fade_in.xml
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+-->
+<set xmlns:android="http://schemas.android.com/apk/res/android"
+    android:interpolator="@android:interpolator/decelerate_quad">
+
+    <alpha android:fromAlpha="0.0" android:toAlpha="1.0"
+        android:duration="@android:integer/config_longAnimTime"/>
+</set>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/anim/fade_out.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/anim/fade_out.xml
new file mode 100644
index 0000000000..68de29a892
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/anim/fade_out.xml
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+-->
+<set xmlns:android="http://schemas.android.com/apk/res/android"
+    android:interpolator="@android:interpolator/decelerate_quad">
+
+    <alpha android:fromAlpha="1.0" android:toAlpha="0.0"
+        android:duration="@android:integer/config_longAnimTime"/>
+</set>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/btn_device_default.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/btn_device_default.xml
new file mode 100644
index 0000000000..c1413fce31
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/btn_device_default.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_primary"/>
+    <item android:color="@color/car_primary"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_background_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_background_color.xml
new file mode 100644
index 0000000000..8b3632f35b
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_background_color.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="true"
+          android:color="@color/car_button_background"/>
+
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_button_background"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_colored_background_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_colored_background_color.xml
new file mode 100644
index 0000000000..0b56ccb2d8
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_colored_background_color.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="true"
+          android:color="@color/car_primary"/>
+
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_secondary_container"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_colored_text_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_colored_text_color.xml
new file mode 100644
index 0000000000..add5e955ee
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_colored_text_color.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="true"
+          android:color="@color/car_on_primary"/>
+
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_on_secondary_container"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_text_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_text_color.xml
new file mode 100644
index 0000000000..aeada668d5
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_text_color.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="true"
+          android:color="@color/car_on_primary_container"/>
+
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_on_primary_container"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_toggle_background_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_toggle_background_color.xml
new file mode 100644
index 0000000000..aab172e890
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_toggle_background_color.xml
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="true"
+          android:state_checked="true"
+          android:color="@color/car_button_toggle_background_checked"/>
+    <item android:state_enabled="true"
+          android:state_checked="false"
+          android:color="@color/car_button_toggle_background_unchecked"/>
+
+    <item android:state_enabled="false"
+          android:state_checked="true"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_button_toggle_background_checked"/>
+    <item android:state_enabled="false"
+          android:state_checked="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_button_toggle_background_unchecked"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_toggle_text_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_toggle_text_color.xml
new file mode 100644
index 0000000000..09d87bb688
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_button_toggle_text_color.xml
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="true"
+          android:state_checked="true"
+          android:color="@color/car_button_toggle_foreground_checked"/>
+    <item android:state_enabled="true"
+          android:state_checked="false"
+          android:color="@color/car_button_toggle_foreground_unchecked"/>
+
+    <item android:state_enabled="false"
+          android:state_checked="true"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_button_toggle_foreground_checked"/>
+    <item android:state_enabled="false"
+          android:state_checked="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_button_toggle_foreground_unchecked"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_radio_button_unchecked_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_radio_button_unchecked_color.xml
new file mode 100644
index 0000000000..e62cf88b6d
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_radio_button_unchecked_color.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright (C) 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_secondary_80"/>
+    <item android:color="@color/car_secondary_80"/>
+</selector>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selected_background_color_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selected_background_color_selector.xml
new file mode 100644
index 0000000000..83708378d5
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selected_background_color_selector.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_selected="true"
+        android:color="@color/car_seekbar_thumb_selected_background_color"/>
+    <item android:color="@android:color/transparent"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selected_stroke_color_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selected_stroke_color_selector.xml
new file mode 100644
index 0000000000..473539f833
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selected_stroke_color_selector.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_selected="true"
+        android:color="@color/car_seekbar_thumb_selected_stroke_color"/>
+    <item android:color="@android:color/transparent"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selector.xml
new file mode 100644
index 0000000000..5bbc6f3b4a
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_thumb_selector.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<!--
+    Color for seekbar thumb - use dedicated color for disabled state rather than disabledAlpha
+    to prevent seeing the progress through the thumb.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_enabled="false"
+        android:color="@color/car_seekbar_thumb_disabled"/>
+    <item android:color="@color/car_seekbar_thumb"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_background_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_background_selector.xml
new file mode 100644
index 0000000000..1dc38486c1
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_background_selector.xml
@@ -0,0 +1,23 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_seekbar_track_background"/>
+    <item android:color="@color/car_seekbar_track_background"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_progress_secondary_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_progress_secondary_selector.xml
new file mode 100644
index 0000000000..cc080b01c8
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_progress_secondary_selector.xml
@@ -0,0 +1,23 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_seekbar_track_progress_secondary"/>
+    <item android:color="@color/car_seekbar_track_progress_secondary"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_progress_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_progress_selector.xml
new file mode 100644
index 0000000000..b1d3ea9a54
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_seekbar_track_progress_selector.xml
@@ -0,0 +1,23 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_seekbar_track_progress"/>
+    <item android:color="@color/car_seekbar_track_progress"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_selection_controls_checked_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_selection_controls_checked_color.xml
new file mode 100644
index 0000000000..f8881f4f5a
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_selection_controls_checked_color.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_primary"/>
+    <item android:color="@color/car_primary"/>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_selection_controls_color.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_selection_controls_color.xml
new file mode 100644
index 0000000000..42c2739ec5
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_selection_controls_color.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_checked="true" android:state_enabled="true"
+        android:color="@color/car_primary"/>
+    <item android:state_checked="true" android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_primary"/>
+    <item android:state_checked="false" android:state_enabled="true"
+        android:color="@color/car_secondary_80"/>
+    <item android:state_checked="false" android:state_enabled="false"
+        android:color="@color/car_secondary_80"
+        android:alpha="?android:attr/disabledAlpha"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_switch_thumb_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_switch_thumb_selector.xml
new file mode 100644
index 0000000000..b261d7b30f
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_switch_thumb_selector.xml
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_checked="true" android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_on_primary" />
+    <item
+        android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_secondary" />
+    <item
+        android:state_checked="true" android:color="@color/car_on_primary" />
+    <item android:color="@color/car_secondary" />
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_switch_track_background_selector.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_switch_track_background_selector.xml
new file mode 100644
index 0000000000..c7cfd8b6c6
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/car_switch_track_background_selector.xml
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:state_checked="true" android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_switch_track_background_checked" />
+    <item
+        android:state_enabled="false"
+        android:alpha="?android:attr/disabledAlpha"
+        android:color="@color/car_switch_track_background_unchecked" />
+    <item
+        android:state_checked="true" android:color="@color/car_switch_track_background_checked" />
+    <item android:color="@color/car_switch_track_background_unchecked" />
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_on_accent_device_default.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_on_accent_device_default.xml
new file mode 100644
index 0000000000..a03d1d5c7f
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_on_accent_device_default.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Please see primary_text_material_light.xml -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_on_surface"/>
+    <item android:color="@color/car_on_surface"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_primary_device_default_dark.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_primary_device_default_dark.xml
new file mode 100644
index 0000000000..283bca3ffe
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_primary_device_default_dark.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Please see primary_text_material_dark.xml -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_on_surface"/>
+    <item android:color="@color/car_on_surface"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_primary_device_default_light.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_primary_device_default_light.xml
new file mode 100644
index 0000000000..a03d1d5c7f
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_primary_device_default_light.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Please see primary_text_material_light.xml -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_on_surface"/>
+    <item android:color="@color/car_on_surface"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_secondary_device_default_dark.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_secondary_device_default_dark.xml
new file mode 100644
index 0000000000..a4688d3be6
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_secondary_device_default_dark.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Please see secondary_text_material_dark.xml -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_secondary"/>
+    <item android:color="@color/car_secondary"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_secondary_device_default_light.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_secondary_device_default_light.xml
new file mode 100644
index 0000000000..6f694f46e5
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_secondary_device_default_light.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Please see secondary_text_material_light.xml -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_secondary"/>
+    <item android:color="@color/car_secondary"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_tertiary_device_default_dark.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_tertiary_device_default_dark.xml
new file mode 100644
index 0000000000..7f6882e633
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_tertiary_device_default_dark.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Please see tertiary_text_material_dark.xml -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_tertiary"/>
+    <item android:color="@color/car_tertiary"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_tertiary_device_default_light.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_tertiary_device_default_light.xml
new file mode 100644
index 0000000000..44c160e454
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/color/text_color_tertiary_device_default_light.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Please see tertiary_text_material_light.xml -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_enabled="false"
+          android:alpha="?android:attr/disabledAlpha"
+          android:color="@color/car_tertiary"/>
+    <item android:color="@color/car_tertiary"/>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-hdpi/ic_launcher_android.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-hdpi/ic_launcher_android.xml
new file mode 100644
index 0000000000..89f8d36708
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-hdpi/ic_launcher_android.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
+    <background android:drawable="@color/ic_launcher_android_background"/>
+    <foreground android:drawable="@drawable/ic_launcher_android_foreground"/>
+</adaptive-icon>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-mdpi/ic_launcher_android.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-mdpi/ic_launcher_android.xml
new file mode 100644
index 0000000000..89f8d36708
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-mdpi/ic_launcher_android.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
+    <background android:drawable="@color/ic_launcher_android_background"/>
+    <foreground android:drawable="@drawable/ic_launcher_android_foreground"/>
+</adaptive-icon>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-night-nodpi/default_wallpaper.png b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-night-nodpi/default_wallpaper.png
new file mode 100644
index 0000000000..9a4033e5de
Binary files /dev/null and b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-night-nodpi/default_wallpaper.png differ
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-nodpi/default_wallpaper.png b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-nodpi/default_wallpaper.png
new file mode 100644
index 0000000000..8d20548790
Binary files /dev/null and b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-nodpi/default_wallpaper.png differ
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw600dp-night/default_wallpaper.png b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw600dp-night/default_wallpaper.png
new file mode 100644
index 0000000000..9a4033e5de
Binary files /dev/null and b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw600dp-night/default_wallpaper.png differ
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw600dp-nodpi/default_wallpaper.png b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw600dp-nodpi/default_wallpaper.png
new file mode 100644
index 0000000000..8d20548790
Binary files /dev/null and b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw600dp-nodpi/default_wallpaper.png differ
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw720dp-night/default_wallpaper.png b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw720dp-night/default_wallpaper.png
new file mode 100644
index 0000000000..9a4033e5de
Binary files /dev/null and b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw720dp-night/default_wallpaper.png differ
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw720dp-nodpi/default_wallpaper.png b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw720dp-nodpi/default_wallpaper.png
new file mode 100644
index 0000000000..8d20548790
Binary files /dev/null and b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-sw720dp-nodpi/default_wallpaper.png differ
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xhdpi/ic_launcher_android.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xhdpi/ic_launcher_android.xml
new file mode 100644
index 0000000000..89f8d36708
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xhdpi/ic_launcher_android.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
+    <background android:drawable="@color/ic_launcher_android_background"/>
+    <foreground android:drawable="@drawable/ic_launcher_android_foreground"/>
+</adaptive-icon>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xxhdpi/ic_launcher_android.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xxhdpi/ic_launcher_android.xml
new file mode 100644
index 0000000000..89f8d36708
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xxhdpi/ic_launcher_android.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
+    <background android:drawable="@color/ic_launcher_android_background"/>
+    <foreground android:drawable="@drawable/ic_launcher_android_foreground"/>
+</adaptive-icon>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xxxhdpi/ic_launcher_android.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xxxhdpi/ic_launcher_android.xml
new file mode 100644
index 0000000000..89f8d36708
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable-xxxhdpi/ic_launcher_android.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
+    <background android:drawable="@color/ic_launcher_android_background"/>
+    <foreground android:drawable="@drawable/ic_launcher_android_foreground"/>
+</adaptive-icon>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/activated_item_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/activated_item_background.xml
new file mode 100644
index 0000000000..71579ad9ab
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/activated_item_background.xml
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true" android:state_activated="true">
+        <shape android:shape="rectangle">
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <solid android:color="?android:attr/colorControlActivated"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+        </shape>
+    </item>
+    <item android:state_activated="true">
+        <shape>
+            <solid android:color="?android:attr/colorControlActivated"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="?android:attr/colorControlHighlight">
+            <item android:id="@android:id/mask">
+                <color android:color="@android:color/white" />
+            </item>
+        </ripple>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/activated_state_radio_button.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/activated_state_radio_button.xml
new file mode 100644
index 0000000000..a3e469e82e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/activated_state_radio_button.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_activated="false" android:drawable="@drawable/car_radio_button_unchecked" />
+    <item android:state_activated="true" android:drawable="@drawable/car_radio_button_checked" />
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/btn_borderless_car.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/btn_borderless_car.xml
new file mode 100644
index 0000000000..0d5b4c536d
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/btn_borderless_car.xml
@@ -0,0 +1,57 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true">
+        <inset android:insetLeft="@*android:dimen/button_inset_horizontal_material"
+               android:insetTop="@*android:dimen/button_inset_vertical_material"
+               android:insetRight="@*android:dimen/button_inset_horizontal_material"
+               android:insetBottom="@*android:dimen/button_inset_vertical_material">
+            <selector>
+                <item android:state_focused="true" android:state_pressed="true">
+                    <shape android:shape="rectangle">
+                        <corners android:radius="?android:attr/buttonCornerRadius" />
+                        <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+                        <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width"
+                                android:color="@color/car_rotary_focus_stroke_color"/>
+                        <padding android:left="@*android:dimen/button_padding_horizontal_material"
+                                 android:top="@*android:dimen/button_padding_vertical_material"
+                                 android:right="@*android:dimen/button_padding_horizontal_material"
+                                 android:bottom="@*android:dimen/button_padding_vertical_material" />
+                    </shape>
+                </item>
+                <item android:state_focused="true">
+                    <shape android:shape="rectangle">
+                        <corners android:radius="?android:attr/buttonCornerRadius" />
+                        <solid android:color="@color/car_rotary_focus_fill_color"/>
+                        <stroke android:width="@dimen/car_rotary_focus_stroke_width"
+                                android:color="@color/car_rotary_focus_stroke_color"/>
+                        <padding android:left="@*android:dimen/button_padding_horizontal_material"
+                                 android:top="@*android:dimen/button_padding_vertical_material"
+                                 android:right="@*android:dimen/button_padding_horizontal_material"
+                                 android:bottom="@*android:dimen/button_padding_vertical_material" />
+                    </shape>
+                </item>
+            </selector>
+        </inset>
+    </item>
+    <item>
+        <ripple xmlns:android="http://schemas.android.com/apk/res/android"
+        android:color="?android:attr/colorControlHighlight">
+            <item android:id="@android:id/mask"
+                  android:drawable="@*android:drawable/btn_default_mtrl_shape" />
+        </ripple>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_alert_dialog_bg.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_alert_dialog_bg.xml
new file mode 100644
index 0000000000..584c25d46c
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_alert_dialog_bg.xml
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<shape xmlns:android="http://schemas.android.com/apk/res/android">
+    <solid android:color="@color/car_alert_dialog_background_color"/>
+    <corners android:radius="@dimen/car_window_rounded_corner_radius"/>
+</shape>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_background.xml
new file mode 100644
index 0000000000..3d5bd8f832
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_background.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_button_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_button_radius"/>
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="@color/car_control_highlight">
+            <item>
+                <shape android:shape="rectangle">
+                    <corners android:radius="@dimen/car_button_radius"/>
+                    <solid android:color="@color/car_button_background_color"/>
+                </shape>
+            </item>
+        </ripple>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_colored_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_colored_background.xml
new file mode 100644
index 0000000000..e3d01f92f6
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_colored_background.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_button_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_button_radius"/>
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="@color/car_control_highlight">
+            <item>
+                <shape android:shape="rectangle">
+                    <corners android:radius="@dimen/car_button_radius"/>
+                    <solid android:color="@color/car_button_colored_background_color"/>
+                </shape>
+            </item>
+        </ripple>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_toggle_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_toggle_background.xml
new file mode 100644
index 0000000000..2cfc6ff465
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_button_toggle_background.xml
@@ -0,0 +1,48 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<!-- Default background styles for car buttons when enabled/disabled,
+     focused/unfocused, and pressed/unpressed -->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item>
+        <ripple android:color="@color/car_control_highlight">
+            <item>
+                <shape android:shape="rectangle">
+                    <corners android:radius="@dimen/car_button_radius"/>
+                    <solid android:color="@color/car_button_toggle_background_color"/>
+                </shape>
+            </item>
+        </ripple>
+    </item>
+    <item>
+        <selector>
+            <item android:state_focused="true" android:state_pressed="true">
+                <shape>
+                    <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+                    <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+                    <corners android:radius="@dimen/car_button_radius"/>
+                </shape>
+            </item>
+            <item android:state_focused="true">
+                <shape>
+                    <solid android:color="@color/car_rotary_focus_fill_color"/>
+                    <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+                    <corners android:radius="@dimen/car_button_radius"/>
+                </shape>
+            </item>
+        </selector>
+    </item>
+</layer-list>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox.xml
new file mode 100644
index 0000000000..0bb408a098
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox.xml
@@ -0,0 +1,29 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:width="@dimen/car_checkbox_size"
+        android:height="@dimen/car_checkbox_size"
+        android:drawable="@drawable/car_checkbox_material_anim"/>
+    <item
+        android:width="@dimen/car_checkbox_focus_ring_size"
+        android:height="@dimen/car_checkbox_focus_ring_size"
+        android:drawable="@drawable/car_checkbox_focus_highlight"
+        android:start="6dp"
+        android:top="6dp" />
+</layer-list>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_checked_mtrl.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_checked_mtrl.xml
new file mode 100644
index 0000000000..62893189b3
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_checked_mtrl.xml
@@ -0,0 +1,50 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:name="btn_checkbox_checked"
+    android:width="32dp"
+    android:viewportWidth="48"
+    android:height="32dp"
+    android:viewportHeight="48"
+    android:tint="@color/car_selection_controls_color">
+    <group
+        android:name="icon_null"
+        android:translateX="24"
+        android:translateY="24"
+        android:scaleX="0.2"
+        android:scaleY="0.2">
+        <group
+            android:name="check"
+            android:scaleX="7.5"
+            android:scaleY="7.5">
+            <path
+                android:name="check_path_merged"
+                android:pathData="M 7.0,-9.0 c 0.0,0.0 -14.0,0.0 -14.0,0.0 c -1.1044921875,0.0 -2.0,0.8955078125 -2.0,2.0 c 0.0,0.0 0.0,14.0 0.0,14.0 c 0.0,1.1044921875 0.8955078125,2.0 2.0,2.0 c 0.0,0.0 14.0,0.0 14.0,0.0 c 1.1044921875,0.0 2.0,-0.8955078125 2.0,-2.0 c 0.0,0.0 0.0,-14.0 0.0,-14.0 c 0.0,-1.1044921875 -0.8955078125,-2.0 -2.0,-2.0 c 0.0,0.0 0.0,0.0 0.0,0.0 Z M -2.0,5.00001525879 c 0.0,0.0 -5.0,-5.00001525879 -5.0,-5.00001525879 c 0.0,0.0 1.41409301758,-1.41409301758 1.41409301758,-1.41409301758 c 0.0,0.0 3.58590698242,3.58601379395 3.58590698242,3.58601379395 c 0.0,0.0 7.58590698242,-7.58601379395 7.58590698242,-7.58601379395 c 0.0,0.0 1.41409301758,1.41409301758 1.41409301758,1.41409301758 c 0.0,0.0 -9.0,9.00001525879 -9.0,9.00001525879 Z"
+                android:fillColor="#FF000000" />
+        </group>
+        <group
+            android:name="box_dilate"
+            android:scaleX="7.5"
+            android:scaleY="7.5">
+            <path
+                android:name="box_inner_merged"
+                android:pathData="M 0.0,-1.0 l 0.0,0.0 c 0.5522847498,0.0 1.0,0.4477152502 1.0,1.0 l 0.0,0.0 c 0.0,0.5522847498 -0.4477152502,1.0 -1.0,1.0 l 0.0,0.0 c -0.5522847498,0.0 -1.0,-0.4477152502 -1.0,-1.0 l 0.0,0.0 c 0.0,-0.5522847498 0.4477152502,-1.0 1.0,-1.0 Z M 7.0,-9.0 c 0.0,0.0 -14.0,0.0 -14.0,0.0 c -1.1044921875,0.0 -2.0,0.8955078125 -2.0,2.0 c 0.0,0.0 0.0,14.0 0.0,14.0 c 0.0,1.1044921875 0.8955078125,2.0 2.0,2.0 c 0.0,0.0 14.0,0.0 14.0,0.0 c 1.1044921875,0.0 2.0,-0.8955078125 2.0,-2.0 c 0.0,0.0 0.0,-14.0 0.0,-14.0 c 0.0,-1.1044921875 -0.8955078125,-2.0 -2.0,-2.0 c 0.0,0.0 0.0,0.0 0.0,0.0 Z"
+                android:fillColor="#FF000000"
+                android:fillAlpha="0" />
+        </group>
+    </group>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_checked_to_unchecked_mtrl_animation.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_checked_to_unchecked_mtrl_animation.xml
new file mode 100644
index 0000000000..ecd9146823
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_checked_to_unchecked_mtrl_animation.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<animated-vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:drawable="@drawable/car_checkbox_checked_mtrl">
+    <target
+        android:name="icon_null"
+        android:animation="@*android:anim/btn_checkbox_to_unchecked_icon_null_animation" />
+    <target
+        android:name="check_path_merged"
+        android:animation="@*android:anim/btn_checkbox_to_unchecked_check_path_merged_animation" />
+    <target
+        android:name="box_inner_merged"
+        android:animation="@*android:anim/btn_checkbox_to_unchecked_box_inner_merged_animation" />
+</animated-vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_focus_highlight.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_focus_highlight.xml
new file mode 100644
index 0000000000..336ca58573
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_focus_highlight.xml
@@ -0,0 +1,32 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape android:shape="rectangle">
+            <solid android:color="@color/focus_pressed_fill_color" />
+            <stroke android:width="4dp" android:color="@color/focus_stroke_color" />
+            <corners android:radius="@dimen/car_checkbox_focus_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape android:shape="rectangle">
+            <solid android:alpha="@color/focus_fill_color" />
+            <stroke android:width="8dp" android:color="@color/focus_stroke_color" />
+            <corners android:radius="@dimen/car_checkbox_focus_radius"/>
+        </shape>
+    </item>
+</selector>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_material_anim.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_material_anim.xml
new file mode 100644
index 0000000000..4fd69d8495
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_material_anim.xml
@@ -0,0 +1,33 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<animated-selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:id="@+id/checked"
+        android:state_checked="true"
+        android:drawable="@drawable/car_checkbox_checked_mtrl" />
+    <item
+        android:id="@+id/unchecked"
+        android:drawable="@drawable/car_checkbox_unchecked_mtrl" />
+    <transition
+        android:fromId="@+id/unchecked"
+        android:toId="@+id/checked"
+        android:drawable="@drawable/car_checkbox_unchecked_to_checked_mtrl_animation" />
+    <transition
+        android:fromId="@+id/checked"
+        android:toId="@+id/unchecked"
+        android:drawable="@drawable/car_checkbox_checked_to_unchecked_mtrl_animation" />
+</animated-selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_unchecked_mtrl.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_unchecked_mtrl.xml
new file mode 100644
index 0000000000..ba2d6cb0f6
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_unchecked_mtrl.xml
@@ -0,0 +1,50 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:name="btn_checkbox_unchecked"
+    android:width="32dp"
+    android:viewportWidth="48"
+    android:height="32dp"
+    android:viewportHeight="48"
+    android:tint="@color/car_selection_controls_color">
+    <group
+        android:name="icon_null"
+        android:translateX="24"
+        android:translateY="24"
+        android:scaleX="0.2"
+        android:scaleY="0.2">
+        <group
+            android:name="check"
+            android:scaleX="7.5"
+            android:scaleY="7.5">
+            <path
+                android:name="box_outer_merged"
+                android:pathData="M 7.0,-9.0 c 0.0,0.0 -14.0,0.0 -14.0,0.0 c -1.1044921875,0.0 -2.0,0.8955078125 -2.0,2.0 c 0.0,0.0 0.0,14.0 0.0,14.0 c 0.0,1.1044921875 0.8955078125,2.0 2.0,2.0 c 0.0,0.0 14.0,0.0 14.0,0.0 c 1.1044921875,0.0 2.0,-0.8955078125 2.0,-2.0 c 0.0,0.0 0.0,-14.0 0.0,-14.0 c 0.0,-1.1044921875 -0.8955078125,-2.0 -2.0,-2.0 c 0.0,0.0 0.0,0.0 0.0,0.0 Z M -2.0,5.00001525879 c 0.0,0.0 -1.4234161377,-1.40159606934 -1.4234161377,-1.40159606934 c 0.0,0.0 1.41409301758,-1.41409301758 1.41409301758,-1.41409301758 c 0.0,0.0 0.00932312011719,-0.0124053955078 0.00932312011719,-0.0124053955078 c 0.0,0.0 0.0234069824219,-0.0235137939453 0.0234069824219,-0.0235137939453 c 0.0,0.0 1.41409301758,1.41409301758 1.41409301758,1.41409301758 c 0.0,0.0 -1.4375,1.43751525879 -1.4375,1.43751525879 Z"
+                android:fillColor="#FF000000"
+                android:fillAlpha="0" />
+        </group>
+        <group
+            android:name="box_dilate"
+            android:scaleX="7.5"
+            android:scaleY="7.5">
+            <path
+                android:name="box_inner_merged"
+                android:pathData="M -7.0,-7.0 l 14.0,0.0 c 0.0,0.0 0.0,0.0 0.0,0.0 l 0.0,14.0 c 0.0,0.0 0.0,0.0 0.0,0.0 l -14.0,0.0 c 0.0,0.0 0.0,0.0 0.0,0.0 l 0.0,-14.0 c 0.0,0.0 0.0,0.0 0.0,0.0 Z M 7.0,-9.0 c 0.0,0.0 -14.0,0.0 -14.0,0.0 c -1.1044921875,0.0 -2.0,0.8955078125 -2.0,2.0 c 0.0,0.0 0.0,14.0 0.0,14.0 c 0.0,1.1044921875 0.8955078125,2.0 2.0,2.0 c 0.0,0.0 14.0,0.0 14.0,0.0 c 1.1044921875,0.0 2.0,-0.8955078125 2.0,-2.0 c 0.0,0.0 0.0,-14.0 0.0,-14.0 c 0.0,-1.1044921875 -0.8955078125,-2.0 -2.0,-2.0 c 0.0,0.0 0.0,0.0 0.0,0.0 Z"
+                android:fillColor="#FF000000" />
+        </group>
+    </group>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_unchecked_to_checked_mtrl_animation.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_unchecked_to_checked_mtrl_animation.xml
new file mode 100644
index 0000000000..85ab604892
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_checkbox_unchecked_to_checked_mtrl_animation.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<animated-vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:drawable="@drawable/car_checkbox_unchecked_mtrl">
+    <target
+        android:name="icon_null"
+        android:animation="@*android:anim/btn_checkbox_to_checked_icon_null_animation" />
+    <target
+        android:name="box_outer_merged"
+        android:animation="@*android:anim/btn_checkbox_to_checked_box_outer_merged_animation" />
+    <target
+        android:name="box_inner_merged"
+        android:animation="@*android:anim/btn_checkbox_to_checked_box_inner_merged_animation" />
+</animated-vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button.xml
new file mode 100644
index 0000000000..549dbc0a9e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_checked="false" android:drawable="@drawable/car_radio_button_unchecked" />
+    <item android:state_checked="true" android:drawable="@drawable/car_radio_button_checked" />
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_checked.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_checked.xml
new file mode 100644
index 0000000000..54c86a2563
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_checked.xml
@@ -0,0 +1,48 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+      <item
+        android:bottom="@dimen/car_radio_button_focus_ring_padding"
+        android:gravity="center"
+        android:left="@dimen/car_radio_button_focus_ring_padding"
+        android:right="@dimen/car_radio_button_focus_ring_padding"
+        android:top="@dimen/car_radio_button_focus_ring_padding">
+        <shape android:shape="rectangle">
+            <size
+                android:width="@dimen/car_radio_button_outer_ring_size"
+                android:height="@dimen/car_radio_button_outer_ring_size" />
+            <stroke
+                android:width="@dimen/car_radio_button_outer_ring_stroke_width"
+                android:color="@color/car_selection_controls_checked_color"/>
+            <corners android:radius="@dimen/car_radio_button_outer_ring_radius" />
+        </shape>
+    </item>
+    <item android:gravity="center">
+        <shape
+            android:shape="rectangle">
+            <size
+                android:width="@dimen/car_radio_button_inner_circle_size"
+                android:height="@dimen/car_radio_button_inner_circle_size" />
+            <solid android:color="@color/car_selection_controls_checked_color"/>
+            <corners android:radius="@dimen/car_radio_button_inner_ring_radius" />
+        </shape>
+    </item>
+    <item
+        android:drawable="@drawable/car_radio_button_focus_highlight"
+        android:gravity="center" />
+</layer-list>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_focus_highlight.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_focus_highlight.xml
new file mode 100644
index 0000000000..b9802b6763
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_focus_highlight.xml
@@ -0,0 +1,46 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape android:shape="rectangle">
+            <size
+                android:width="@dimen/car_radio_button_focus_ring_size"
+                android:height="@dimen/car_radio_button_focus_ring_size" />
+            <solid android:color="@color/focus_pressed_fill_color" />
+            <corners android:radius="@dimen/car_radio_button_focus_ring_radius" />
+            <stroke
+                android:width="@dimen/focus_pressed_stroke_width"
+                android:color="@color/focus_pressed_stroke_color" />
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape android:shape="rectangle">
+            <size
+                android:width="@dimen/car_radio_button_focus_ring_size"
+                android:height="@dimen/car_radio_button_focus_ring_size" />
+            <solid android:color="@color/focus_fill_color" />
+            <corners android:radius="@dimen/car_radio_button_focus_ring_radius" />
+            <stroke
+                android:width="@dimen/focus_stroke_width"
+                android:color="@color/focus_stroke_color" />
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="?android:attr/colorControlHighlight" />
+    </item>
+</selector>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_unchecked.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_unchecked.xml
new file mode 100644
index 0000000000..cdf148b6b8
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_radio_button_unchecked.xml
@@ -0,0 +1,38 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:bottom="@dimen/car_radio_button_focus_ring_padding"
+        android:gravity="center"
+        android:left="@dimen/car_radio_button_focus_ring_padding"
+        android:right="@dimen/car_radio_button_focus_ring_padding"
+        android:top="@dimen/car_radio_button_focus_ring_padding">
+        <shape android:shape="rectangle">
+            <size
+                android:width="@dimen/car_radio_button_outer_ring_size"
+                android:height="@dimen/car_radio_button_outer_ring_size" />
+            <stroke
+                android:width="@dimen/car_radio_button_outer_ring_stroke_width"
+                android:color="@color/car_radio_button_unchecked_color" />
+            <corners android:radius="@dimen/car_radio_button_outer_ring_radius" />
+        </shape>
+    </item>
+    <item
+        android:drawable="@drawable/car_radio_button_focus_highlight"
+      android:gravity="center" />
+</layer-list>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_thumb.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_thumb.xml
new file mode 100644
index 0000000000..2fe1739558
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_thumb.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item>
+        <shape android:shape="rectangle">
+            <size
+                android:width="@dimen/car_seekbar_thumb_size"
+                android:height="@dimen/car_seekbar_thumb_size"/>
+            <corners android:radius="@dimen/car_seekbar_thumb_radius" />
+            <solid android:color="@color/car_seekbar_thumb_selector"/>
+        </shape>
+    </item>
+</layer-list>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_thumb_selectable.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_thumb_selectable.xml
new file mode 100644
index 0000000000..e87b30aafc
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_thumb_selectable.xml
@@ -0,0 +1,32 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:drawable="@drawable/car_seekbar_thumb"
+        android:gravity="center" />
+    <item
+        android:gravity="center"
+        android:width="@dimen/car_seekbar_thumb_selectable_size"
+        android:height="@dimen/car_seekbar_thumb_selectable_size">
+        <shape android:shape="rectangle">
+            <stroke
+                android:color="@color/car_seekbar_thumb_selected_stroke_color_selector"
+                android:width="@dimen/car_seekbar_thumb_selected_stroke_width" />
+            <solid android:color="@color/car_seekbar_thumb_selected_background_color_selector" />
+            <corners android:radius="@dimen/car_seekbar_thumb_radius" />
+        </shape>
+    </item>
+</layer-list>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_track.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_track.xml
new file mode 100644
index 0000000000..8b43b2e261
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_seekbar_track.xml
@@ -0,0 +1,52 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:id="@android:id/background"
+        android:top="@dimen/car_seekbar_track_vertical_padding"
+        android:bottom="@dimen/car_seekbar_track_vertical_padding">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/car_seekbar_thumb_outer_radius" />
+            <size android:height="@dimen/car_seekbar_track_height" />
+            <solid android:color="@color/car_seekbar_track_background_selector" />
+        </shape>
+    </item>
+    <item
+        android:id="@android:id/secondaryProgress"
+        android:top="@dimen/car_seekbar_track_vertical_padding"
+        android:bottom="@dimen/car_seekbar_track_vertical_padding">
+        <scale android:scaleWidth="100%">
+            <shape android:shape="rectangle">
+                <corners android:radius="@dimen/car_seekbar_thumb_outer_radius" />
+                <size android:height="@dimen/car_seekbar_track_height" />
+                <solid android:color="@color/car_seekbar_track_progress_secondary_selector" />
+            </shape>
+        </scale>
+    </item>
+    <item
+        android:id="@android:id/progress"
+        android:top="@dimen/car_seekbar_track_vertical_padding"
+        android:bottom="@dimen/car_seekbar_track_vertical_padding">
+        <clip>
+            <shape android:shape="rectangle">
+                <corners android:radius="@dimen/car_seekbar_thumb_outer_radius" />
+                <size android:height="@dimen/car_seekbar_track_height" />
+                <solid android:color="@color/car_seekbar_track_progress_selector" />
+            </shape>
+        </clip>
+    </item>
+</layer-list>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_thumb.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_thumb.xml
new file mode 100644
index 0000000000..4b5be00c39
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_thumb.xml
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android"
+    android:paddingLeft="@dimen/car_switch_thumb_stroke_width"
+    android:paddingRight="@dimen/car_switch_thumb_stroke_width">
+    <item
+        android:gravity="center"
+        android:bottom="@dimen/car_switch_thumb_stroke_width"
+        android:left="@dimen/car_switch_thumb_stroke_width"
+        android:right="@dimen/car_switch_thumb_stroke_width"
+        android:top="@dimen/car_switch_thumb_stroke_width">
+        <shape android:shape="rectangle">
+            <size
+                android:width="@dimen/car_switch_thumb_size"
+                android:height="@dimen/car_switch_thumb_size" />
+            <solid android:color="@color/car_switch_thumb_selector"/>
+            <corners android:radius="@dimen/car_switch_thumb_radius" />
+        </shape>
+    </item>
+</layer-list>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_track.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_track.xml
new file mode 100644
index 0000000000..bd32de9ded
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_track.xml
@@ -0,0 +1,38 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+-->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+    <item
+        android:bottom="@dimen/car_switch_track_margin_vertical"
+        android:gravity="center"
+        android:top="@dimen/car_switch_track_margin_vertical">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/car_switch_thumb_outer_radius" />
+            <padding
+                android:left="@dimen/car_switch_thumb_stroke_width"
+                android:right="@dimen/car_switch_thumb_stroke_width" />
+            <size
+                android:height="@dimen/car_switch_track_height"
+                android:width="@dimen/car_switch_track_width" />
+            <solid android:color="@color/car_switch_track_background_selector" />
+        </shape>
+    </item>
+    <item
+        android:bottom="@dimen/car_switch_track_margin_vertical"
+        android:drawable="@drawable/car_switch_track_focus_highlight"
+        android:gravity="center"
+        android:top="@dimen/car_switch_track_margin_vertical" />
+</layer-list>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_track_focus_highlight.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_track_focus_highlight.xml
new file mode 100644
index 0000000000..89e0be0195
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/car_switch_track_focus_highlight.xml
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/car_switch_track_focus_ring_outer_radius" />
+            <solid android:color="@color/focus_pressed_fill_color" />
+            <padding
+                android:left="@dimen/car_switch_track_focus_ring_padding"
+                android:right="@dimen/car_switch_track_focus_ring_padding" />
+            <size
+                android:height="@dimen/car_switch_track_focus_ring_height"
+                android:width="@dimen/car_switch_track_focus_ring_width" />
+            <stroke
+                android:width="@dimen/focus_pressed_stroke_width"
+                android:color="@color/focus_pressed_stroke_color" />
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="@dimen/car_switch_track_focus_ring_outer_radius" />
+            <solid android:color="@color/focus_fill_color" />
+            <padding
+                android:left="@dimen/car_switch_track_focus_ring_padding"
+                android:right="@dimen/car_switch_track_focus_ring_padding" />
+            <size
+                android:height="@dimen/car_switch_track_focus_ring_height"
+                android:width="@dimen/car_switch_track_focus_ring_width" />
+            <stroke
+                android:width="@dimen/focus_stroke_width"
+                android:color="@color/focus_stroke_color" />
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="?android:attr/colorControlHighlight" />
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_account_circle.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_account_circle.xml
new file mode 100644
index 0000000000..db01811977
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_account_circle.xml
@@ -0,0 +1,24 @@
+<!--
+Copyright (C) 2017 The Android Open Source Project
+
+   Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:width="128.0dp"
+        android:height="128.0dp"
+        android:viewportWidth="48.0"
+        android:viewportHeight="48.0">
+    <path
+        android:pathData="M24,0C10.8,0 0,10.8 0,24s10.8,24 24,24s24,-10.8 24,-24S37.200001,0 24,0zM24,7.2c3.96,0 7.2,3.24 7.2,7.2s-3.24,7.2 -7.2,7.2s-7.2,-3.24 -7.2,-7.2S20.040001,7.2 24,7.2zM24,41.279999c-6,0 -11.28,-3.12 -14.4,-7.68c0.12,-4.8 9.6,-7.44 14.4,-7.44s14.28,2.64 14.4,7.44C35.279999,38.16 30,41.279999 24,41.279999z"
+        android:fillColor="#FFFFFFFF"/>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_collapse_notification.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_collapse_notification.xml
new file mode 100644
index 0000000000..0252706f96
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_collapse_notification.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2017 The Android Open Source Project
+
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+-->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:width="56dp"
+        android:height="56dp"
+        android:viewportWidth="56.0"
+        android:viewportHeight="56.0">
+    <path
+        android:pathData="M28,56C12.54,56 0,43.46 0,28C0,12.54 12.54,0 28,0C43.46,0 56,12.54 56,28C56,43.46 43.46,56 28,56ZM35.64,33L38,30.71L28,21L18,30.71L20.36,33L28,25.58L35.64,33Z"
+        android:strokeColor="#00000000"
+        android:fillColor="@android:color/black"
+        android:strokeWidth="1"/>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_expand_notification.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_expand_notification.xml
new file mode 100644
index 0000000000..c93390c75d
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_expand_notification.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2017 The Android Open Source Project
+
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+-->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:width="56dp"
+        android:height="56dp"
+        android:viewportWidth="56.0"
+        android:viewportHeight="56.0">
+    <path
+        android:pathData="M28,0C43.46,0 56,12.54 56,28C56,43.46 43.46,56 28,56C12.54,56 0,43.46 0,28C0,12.54 12.54,0 28,0ZM20.36,23L18,25.29L28,35L38,25.29L35.64,23L28,30.42L20.36,23Z"
+        android:strokeColor="#00000000"
+        android:fillColor="@android:color/black"
+        android:strokeWidth="1"/>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_launcher_android_foreground.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_launcher_android_foreground.xml
new file mode 100644
index 0000000000..c42c1a4b62
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/ic_launcher_android_foreground.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        xmlns:aapt="http://schemas.android.com/aapt"
+        android:width="108dp"
+        android:height="108dp"
+        android:viewportWidth="108"
+        android:viewportHeight="108">
+    <group>
+        <clip-path
+            android:pathData="M0,0h108v108h-108z"/>
+        <path
+            android:pathData="M37.17,59.17L34,45L73.2,37.39L127.15,91.34L91.34,127.14L33.54,69.35L37.17,59.17Z">
+            <aapt:attr name="android:fillColor">
+                <gradient
+                    android:startX="56.74"
+                    android:startY="61.74"
+                    android:endX="74.62"
+                    android:endY="79.11"
+                    android:type="linear">
+                    <item android:offset="0" android:color="#0C001493"/>
+                    <item android:offset="1" android:color="#02000000"/>
+                </gradient>
+            </aapt:attr>
+        </path>
+        <path
+            android:pathData="M72.73,55.56C72.73,56.5 73.13,57.42 73.86,58.08L77.28,61.14C77.87,61.66 78.02,62.54 77.61,63.24L73.9,69.59C73.49,70.3 72.65,70.6 71.89,70.36L67.5,68.96C66.57,68.67 65.56,68.78 64.74,69.26L61.99,70.82C61.17,71.29 60.56,72.09 60.36,73.04L59.38,77.5C59.22,78.27 58.53,78.84 57.71,78.84H50.29C49.47,78.84 48.78,78.26 48.62,77.5L47.64,73.04C47.44,72.09 46.83,71.29 46.01,70.82L43.26,69.26C42.44,68.79 41.43,68.67 40.5,68.96L36.1,70.36C35.35,70.6 34.51,70.3 34.1,69.59L30.39,63.24C29.98,62.54 30.13,61.66 30.72,61.14L34.14,58.08C34.87,57.43 35.27,56.51 35.27,55.56V52.44C35.27,51.49 34.87,50.57 34.14,49.92L30.72,46.86C30.13,46.34 29.98,45.46 30.39,44.76L34.1,38.41C34.51,37.7 35.35,37.4 36.1,37.64L40.5,39.03C41.43,39.33 42.44,39.22 43.26,38.74L46.01,37.18C46.83,36.71 47.44,35.91 47.64,34.96L48.62,30.5C48.78,29.73 49.47,29.16 50.29,29.16H57.71C58.53,29.16 59.22,29.73 59.38,30.49L60.36,34.95C60.56,35.9 61.17,36.7 61.99,37.18L64.74,38.74C65.56,39.21 66.57,39.33 67.5,39.03L71.89,37.64C72.65,37.4 73.49,37.7 73.9,38.4L77.61,44.76C78.02,45.46 77.87,46.33 77.28,46.86L73.86,49.92C73.13,50.57 72.73,51.49 72.73,52.43V55.56ZM65.53,54C65.53,60.37 60.37,65.53 54,65.53C47.63,65.53 42.47,60.37 42.47,54C42.47,47.63 47.63,42.47 54,42.47C60.37,42.47 65.53,47.63 65.53,54ZM60.88,54C60.88,57.8 57.8,60.88 54,60.88C50.2,60.88 47.13,57.8 47.13,54C47.13,50.2 50.2,47.13 54,47.13C57.8,47.13 60.88,50.2 60.88,54Z"
+            android:fillColor="#ffffff"
+            android:fillType="evenOdd"/>
+    </group>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/item_background.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/item_background.xml
new file mode 100644
index 0000000000..71579ad9ab
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/item_background.xml
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true" android:state_activated="true">
+        <shape android:shape="rectangle">
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <solid android:color="?android:attr/colorControlActivated"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+        </shape>
+    </item>
+    <item android:state_activated="true">
+        <shape>
+            <solid android:color="?android:attr/colorControlActivated"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item android:state_focused="true">
+        <shape>
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width" android:color="@color/car_rotary_focus_stroke_color"/>
+            <corners android:radius="@dimen/car_selectable_item_radius"/>
+        </shape>
+    </item>
+    <item>
+        <ripple android:color="?android:attr/colorControlHighlight">
+            <item android:id="@android:id/mask">
+                <color android:color="@android:color/white" />
+            </item>
+        </ripple>
+    </item>
+</selector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/perm_group_camera.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/perm_group_camera.xml
new file mode 100644
index 0000000000..584776c1f4
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/perm_group_camera.xml
@@ -0,0 +1,23 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="44dp"
+    android:height="44dp"
+    android:viewportWidth="44"
+    android:viewportHeight="44">
+  <path android:fillColor="@android:color/white"
+        android:pathData="M31.1667,19.25V12.8333C31.1667,11.825 30.3417,11 29.3333,11H7.3333C6.325,11 5.5,11.825 5.5,12.8333V31.1667C5.5,32.175 6.325,33 7.3333,33H29.3333C30.3417,33 31.1667,32.175 31.1667,31.1667V24.75L38.5,32.0833V11.9167L31.1667,19.25Z"/>
+</vector>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/toast_frame.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/toast_frame.xml
new file mode 100644
index 0000000000..18b000f599
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/drawable/toast_frame.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/* Copyright 2024, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+       android:shape="rectangle">
+    <solid android:color="@color/car_inverse_surface" />
+    <corners android:radius="@dimen/toast_corner_radius" />
+</shape>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog.xml
new file mode 100644
index 0000000000..babae5c3bf
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog.xml
@@ -0,0 +1,97 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<RelativeLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@*android:id/parentPanel"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:gravity="start|top"
+    android:background="@drawable/car_alert_dialog_bg"
+    android:padding="@dimen/car_alert_dialog_padding"
+    android:orientation="vertical">
+    <ScrollView
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_alignParentTop="true"
+        android:layout_above="@*android:id/buttonPanel"
+        android:fadeScrollbars="false"
+        android:clipToPadding="false">
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:orientation="vertical">
+            <include layout="@layout/car_alert_dialog_title"
+                    android:layout_weight="0"/>
+            <FrameLayout
+                android:id="@*android:id/contentPanel"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_weight="1"
+                android:padding="@dimen/car_alert_dialog_padding"
+                android:minHeight="@dimen/car_alert_dialog_content_min_height">
+                <ScrollView
+                    android:id="@*android:id/scrollView"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:clipToPadding="false">
+                    <LinearLayout
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:orientation="vertical">
+                        <Space
+                            android:id="@*android:id/textSpacerNoTitle"
+                            android:visibility="gone"
+                            android:layout_width="match_parent"
+                            android:layout_height="0dp" />
+                        <TextView
+                            android:id="@android:id/message"
+                            android:layout_width="match_parent"
+                            android:layout_height="wrap_content"
+                            style="@style/CarDialogMessageText"/>
+                        <!-- we don't need this spacer, but the id needs to be here for compatibility -->
+                        <Space
+                            android:id="@*android:id/textSpacerNoButtons"
+                            android:visibility="gone"
+                            android:layout_width="match_parent"
+                            android:layout_height="0dp" />
+                    </LinearLayout>
+                </ScrollView>
+            </FrameLayout>
+            <FrameLayout
+                android:id="@*android:id/customPanel"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_margin="@dimen/car_alert_dialog_padding"
+                android:layout_weight="1"
+                android:minHeight="@dimen/car_alert_dialog_content_min_height">
+                <FrameLayout
+                    android:id="@android:id/custom"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content" />
+            </FrameLayout>
+        </LinearLayout>
+    </ScrollView>
+    <include
+        android:id="@*android:id/buttonPanel"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_alignParentBottom="true"
+        android:layout_marginTop="@dimen/car_alert_dialog_padding"
+        android:layout_marginHorizontal="@dimen/car_alert_dialog_padding"
+        layout="@layout/car_alert_dialog_button_bar"/>
+</RelativeLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog_button_bar.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog_button_bar.xml
new file mode 100644
index 0000000000..a0a5b5b6f6
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog_button_bar.xml
@@ -0,0 +1,55 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+            android:id="@*android:id/buttonPanel"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:scrollbarAlwaysDrawVerticalTrack="true"
+            android:scrollIndicators="none"
+            android:fillViewport="true"
+            style="?android:attr/buttonBarStyle">
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="vertical"
+        android:gravity="center">
+        <Button
+            android:id="@android:id/button3"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/car_alert_dialog_button_height"
+            android:layout_marginBottom="@dimen/car_alert_dialog_button_spacing"
+            style="@style/CarDialogActionButton"/>
+        <Button
+            android:id="@android:id/button2"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/car_alert_dialog_button_height"
+            android:layout_marginBottom="@dimen/car_alert_dialog_button_spacing"
+            style="@style/CarDialogActionButton"/>
+        <Button
+            android:id="@android:id/button1"
+            android:layout_width="match_parent"
+            android:layout_height="@dimen/car_alert_dialog_button_height"
+            android:layout_marginBottom="@dimen/car_alert_dialog_button_spacing"
+            style="@style/CarDialogActionButton1"/>
+        <Space
+            android:id="@*android:id/spacer"
+            android:layout_width="0dp"
+            android:layout_height="0dp"
+            android:visibility="gone" />
+    </LinearLayout>
+</ScrollView>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog_title.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog_title.xml
new file mode 100644
index 0000000000..cb5278fbc9
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout-car/car_alert_dialog_title.xml
@@ -0,0 +1,57 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+              android:id="@*android:id/topPanel"
+              android:layout_width="match_parent"
+              android:layout_height="wrap_content"
+              android:gravity="center_vertical"
+              android:orientation="vertical">
+    <!-- If the client uses a customTitle, it will be added here. -->
+    <RelativeLayout
+        android:id="@*android:id/title_template"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="vertical">
+
+        <ImageView
+            android:id="@android:id/icon"
+            android:layout_width="@dimen/car_alert_dialog_icon_size"
+            android:layout_height="@dimen/car_alert_dialog_icon_size"
+            android:layout_alignParentStart="true"
+            android:layout_centerVertical="true"
+            android:layout_marginBottom="@dimen/car_alert_dialog_padding"
+            android:scaleType="fitCenter"
+            android:src="@null" />
+
+        <com.android.internal.widget.DialogTitle
+            android:id="@*android:id/alertTitle"
+            android:maxLines="1"
+            android:ellipsize="none"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_toEndOf="@+id/icon"
+            android:textAlignment="center"
+            android:layout_centerVertical="true"
+            style="@android:style/TextAppearance.DeviceDefault.DialogWindowTitle" />
+    </RelativeLayout>
+
+    <Space
+        android:id="@*android:id/titleDividerNoCustom"
+        android:visibility="gone"
+        android:layout_width="match_parent"
+        android:layout_height="0dp" />
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/notification_template_right_icon.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/notification_template_right_icon.xml
new file mode 100644
index 0000000000..4ff569d3aa
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/notification_template_right_icon.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2017 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License
+  -->
+
+<ImageView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@*android:id/right_icon"
+    android:layout_width="64dp"
+    android:layout_height="64dp"
+    android:layout_marginEnd="@*android:dimen/notification_content_margin_end"
+    android:layout_marginTop="76dp"
+    android:layout_marginBottom="76dp"
+    android:layout_gravity="center_vertical|end"
+    android:scaleType="centerCrop" />
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/resolve_list_item.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/resolve_list_item.xml
new file mode 100644
index 0000000000..e04beddbd0
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/resolve_list_item.xml
@@ -0,0 +1,68 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+* Copyright 2024, The Android Open Source Project
+*
+* Licensed under the Apache License, Version 2.0 (the "License");
+* you may not use this file except in compliance with the License.
+* You may obtain a copy of the License at
+*
+*     http://www.apache.org/licenses/LICENSE-2.0
+*
+* Unless required by applicable law or agreed to in writing, software
+* distributed under the License is distributed on an "AS IS" BASIS,
+* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+* See the License for the specific language governing permissions and
+* limitations under the License.
+*/
+-->
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+              android:orientation="horizontal"
+              android:layout_height="wrap_content"
+              android:layout_width="match_parent"
+              android:minHeight="96dp"
+              android:background="?android:attr/colorBackgroundFloating" >
+    <ImageView
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_marginStart="?android:attr/listPreferredItemPaddingStart"
+                android:layout_gravity="center"
+                android:clickable="false"
+                android:focusable="false"
+                android:duplicateParentState="true"
+                android:src="@drawable/activated_state_radio_button"/>
+
+    <ImageView android:id="@*android:id/icon"
+               android:layout_width="@*android:dimen/car_icon_size"
+               android:layout_height="@*android:dimen/car_icon_size"
+               android:layout_gravity="start|center_vertical"
+               android:layout_marginStart="@*android:dimen/car_padding_4"
+               android:scaleType="fitXY" />
+
+    <LinearLayout android:gravity="start|center_vertical"
+                  android:orientation="vertical"
+                  android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+                  android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+                  android:layout_height="wrap_content"
+                  android:layout_width="wrap_content"
+                  android:layout_gravity="start|center_vertical">
+        <!-- Activity name -->
+        <TextView android:id="@*android:id/text1"
+                  android:layout_width="wrap_content"
+                  android:layout_height="wrap_content"
+                  android:layout_gravity="start|center_vertical"
+                  style="?android:attr/textAppearanceListItem"
+                  android:minLines="1"
+                  android:maxLines="1"
+                  android:ellipsize="marquee" />
+        <!-- Extended activity info to distinguish between duplicate activity names -->
+        <TextView android:id="@*android:id/text2"
+                  android:layout_width="wrap_content"
+                  android:layout_height="wrap_content"
+                  android:layout_gravity="center_vertical"
+                  style="?android:attr/textAppearanceListItemSecondary"
+                  android:minLines="1"
+                  android:maxLines="1"
+                  android:ellipsize="marquee" />
+    </LinearLayout>
+</LinearLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/resolver_different_item_header.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/resolver_different_item_header.xml
new file mode 100644
index 0000000000..f8ca5fb561
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/resolver_different_item_header.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+ * Copyright 2024, The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+-->
+<TextView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:text="@*android:string/use_a_different_app"
+    android:textAppearance="@*android:style/TextAppearance.DeviceDefault.DialogWindowTitle"
+    android:gravity="start|center_vertical"
+    android:paddingVertical="@*android:dimen/car_padding_4"
+    android:paddingHorizontal="@*android:dimen/car_padding_4" />
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/transient_notification.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/transient_notification.xml
new file mode 100644
index 0000000000..13441d4b0d
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/transient_notification.xml
@@ -0,0 +1,40 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+** Copyright 2024, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="@*android:dimen/toast_width"
+    android:layout_height="wrap_content"
+    android:gravity="center"
+    android:layout_marginBottom="@dimen/car_toast_bottom_margin">
+    <LinearLayout
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:maxWidth="@*android:dimen/toast_width"
+        android:orientation="horizontal"
+        android:gravity="center_vertical"
+        android:background="@android:drawable/toast_frame"
+        android:elevation="@*android:dimen/toast_elevation"
+        android:padding="@dimen/car_toast_margin">
+        <TextView
+            android:id="@android:id/message"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            style="@style/TextAppearance.Car.Toast"/>
+    </LinearLayout>
+</FrameLayout>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/transient_notification_with_icon.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/transient_notification_with_icon.xml
new file mode 100644
index 0000000000..e00b576d65
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/layout/transient_notification_with_icon.xml
@@ -0,0 +1,43 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="@*android:dimen/toast_width"
+    android:layout_height="wrap_content"
+    android:gravity="center"
+    android:layout_marginBottom="@dimen/car_toast_bottom_margin">
+    <LinearLayout
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:maxWidth="@*android:dimen/toast_width"
+        android:orientation="horizontal"
+        android:gravity="center_vertical"
+        android:background="@android:drawable/toast_frame"
+        android:elevation="@*android:dimen/toast_elevation"
+        android:padding="@dimen/car_toast_margin">
+        <ImageView
+            android:id="@android:id/icon"
+            android:layout_width="@dimen/car_toast_icon_size"
+            android:layout_height="@dimen/car_toast_icon_size"
+            android:layout_marginEnd="@dimen/car_toast_icon_margin"/>
+        <TextView
+            android:id="@android:id/message"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            style="@style/TextAppearance.Car.Toast"/>
+    </LinearLayout>
+</FrameLayout>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h1752dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h1752dp/dimens.xml
new file mode 100644
index 0000000000..da38586079
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h1752dp/dimens.xml
@@ -0,0 +1,41 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2017 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<resources>
+    <!-- Application Bar -->
+    <dimen name="car_app_bar_height">112dp</dimen>
+
+    <!-- Text size for car -->
+    <dimen name="car_title2_size">32sp</dimen>
+    <dimen name="car_body1_size">32sp</dimen>
+    <dimen name="car_body2_size">26sp</dimen>
+    <dimen name="car_action1_size">26sp</dimen>
+
+    <!-- Common icon size for car app -->
+    <dimen name="car_icon_size">44dp</dimen>
+
+    <dimen name="car_card_header_height">76dp</dimen>
+    <dimen name="car_card_action_bar_height">76dp</dimen>
+
+    <!-- Keylines for content. -->
+    <dimen name="car_keyline_1">48dp</dimen>
+    <dimen name="car_keyline_2">108dp</dimen>
+    <dimen name="car_keyline_3">152dp</dimen>
+    <dimen name="car_keyline_4">182dp</dimen>
+
+    <!-- Minimum height of list items. -->
+    <dimen name="car_single_line_list_item_height">128dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h480dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h480dp/dimens.xml
new file mode 100644
index 0000000000..7a5151f9a8
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h480dp/dimens.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2024, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<resources>
+    <!-- Padding added to the bottom of button bar of activity resolver -->
+    <dimen name="resolver_button_bar_spacing">0dp</dimen>
+</resources>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h600dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h600dp/dimens.xml
new file mode 100644
index 0000000000..21dab4e938
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-h600dp/dimens.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+-->
+<resources>
+    <!-- Application Bar -->
+    <dimen name="car_app_bar_height">96dp</dimen>
+
+    <!-- Size of notification text titles (see TextAppearance.StatusBar.EventContent.Title) -->
+    <dimen name="notification_title_text_size">40sp</dimen>
+
+    <!-- Size of notification text (see TextAppearance.StatusBar.EventContent) -->
+    <dimen name="notification_text_size">32sp</dimen>
+
+    <!-- The absolute size of the application icon in the notification header. -->
+    <dimen name="notification_header_icon_size">32dp</dimen>
+
+    <!-- The height of the header of a notification. -->
+    <dimen name="notification_header_height">76dp</dimen>
+
+    <!-- Top margin to accommodate for the header before the notification content. This value
+         is smaller than the notification_header_height to bring the text closer. Otherwise,
+         spacing in the font itself makes the space look too large. -->
+    <dimen name="notification_content_margin_top">68dp</dimen>
+
+    <!-- The height of the notification action list. -->
+    <dimen name="notification_action_list_height">96dp</dimen>
+
+    <!-- The size of the media actions in the media notification. -->
+    <dimen name="media_notification_action_button_size">56dp</dimen>
+
+    <!-- Minimum height of list items. -->
+    <dimen name="car_single_line_list_item_height">116dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-night/colors_car.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-night/colors_car.xml
new file mode 100644
index 0000000000..f08c6a2b41
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-night/colors_car.xml
@@ -0,0 +1,30 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+ * Copyright 2024, The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+-->
+<resources>
+
+    <color name="car_colorPrimary">@*android:color/car_grey_958</color>
+    <color name="car_tint_light">@*android:color/car_grey_300</color>
+
+    <color name="car_colorSecondary">@*android:color/car_grey_972</color>
+    <color name="car_colorPrimaryDark">@*android:color/car_grey_958</color>
+
+    <color name="car_body1_light">@*android:color/car_grey_300</color>
+    <color name="car_body1">@*android:color/car_body1_light</color>
+
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-night/colors_device_defaults.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-night/colors_device_defaults.xml
new file mode 100644
index 0000000000..7c6390db9e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-night/colors_device_defaults.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2024, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+
+<resources>
+    <color name="background_floating_device_default_dark">@*android:color/car_grey_900</color>
+    <color name="background_floating_device_default_light">@*android:color/car_grey_900</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-sw600dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-sw600dp/dimens.xml
new file mode 100644
index 0000000000..1172036d96
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-sw600dp/dimens.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2024, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<resources>
+    <dimen name="navigation_bar_height">96dp</dimen>
+    <dimen name="navigation_bar_height_landscape">96dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-sw900dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-sw900dp/dimens.xml
new file mode 100644
index 0000000000..1172036d96
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-sw900dp/dimens.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2024, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<resources>
+    <dimen name="navigation_bar_height">96dp</dimen>
+    <dimen name="navigation_bar_height_landscape">96dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w1280dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w1280dp/dimens.xml
new file mode 100644
index 0000000000..de9bc8b0a6
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w1280dp/dimens.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2017 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<resources>
+    <dimen name="car_keyline_1">32dp</dimen>
+    <dimen name="car_keyline_2">108dp</dimen>
+    <dimen name="car_keyline_3">128dp</dimen>
+    <dimen name="car_keyline_4">168dp</dimen>
+    <dimen name="car_margin">148dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w1920dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w1920dp/dimens.xml
new file mode 100644
index 0000000000..7a0f7a5fd5
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w1920dp/dimens.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2017 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<resources>
+    <dimen name="car_keyline_4">184dp</dimen>
+    <dimen name="car_margin">192dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w690dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w690dp/dimens.xml
new file mode 100644
index 0000000000..4757cd246f
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w690dp/dimens.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2017 The Android Open Source Project
+
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+-->
+<resources>
+    <dimen name="car_keyline_1">24dp</dimen>
+    <dimen name="car_keyline_2">96dp</dimen>
+    <dimen name="car_keyline_3">112dp</dimen>
+    <dimen name="car_keyline_4">148dp</dimen>
+    <dimen name="car_margin">112dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w840dp/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w840dp/dimens.xml
new file mode 100644
index 0000000000..ea826b4dd0
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values-w840dp/dimens.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2017 The Android Open Source Project
+
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+
+  http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+-->
+<resources>
+    <!-- The margin on the start of the content view. This value should match card keyline1. -->
+    <dimen name="notification_content_margin_start">32dp</dimen>
+
+    <!-- The margin on the end of the content view with a picture. This value is the size of
+         the right icon (64dp) + notification_content_margin_end + 16dp. -->
+    <dimen name="notification_content_picture_margin">112dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors.xml
new file mode 100644
index 0000000000..244fd80273
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors.xml
@@ -0,0 +1,82 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2017, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<resources>
+
+    <!-- The background color for the container of notification actions. -->
+    <color name="notification_action_list">@*android:color/car_colorSecondary</color>
+
+    <!-- The primary text color if the text is on top of a light background. -->
+    <color name="notification_primary_text_color_light">@*android:color/car_body1</color>
+
+    <!-- The primary text color if the text is on top of a dark background. -->
+    <color name="notification_primary_text_color_dark">@*android:color/car_body1</color>
+
+    <!-- The secondary text color if the text is on top of a light background. -->
+    <color name="notification_secondary_text_color_light">@*android:color/car_body2</color>
+
+    <!-- The secondary text color if the text is on top of a dark background. -->
+    <color name="notification_secondary_text_color_dark">@*android:color/car_body2</color>
+
+    <!-- The default color for text in a notification. This color is also the default color for
+         icons. -->
+    <color name="notification_default_color">@*android:color/car_accent</color>
+
+    <!-- Focus colors -->
+    <color name="focus_stroke_color">#94CBFF</color>
+    <color name="focus_fill_color">#3D94CBFF</color>
+    <color name="focus_pressed_stroke_color">#94CBFF</color>
+    <color name="focus_pressed_fill_color">#8A94CBFF</color>
+
+    <!-- The Switch track background color when checked. -->
+    <color name="car_switch_track_background_checked">@color/car_primary</color>
+    <!-- The Switch track background color when unchecked. -->
+    <color name="car_switch_track_background_unchecked">@color/car_secondary_container</color>
+    <!-- The Switch track's background color. -->
+    <color name="car_seekbar_track_background">@color/car_surface_variant</color>
+    <!-- The Switch track's progress color. -->
+    <color name="car_seekbar_track_progress">@color/car_primary</color>
+    <!-- The Switch track's secondary progress color. -->
+    <color name="car_seekbar_track_progress_secondary">@color/car_secondary</color>
+    <!-- Color of the outer ring when the SeekBar is selected. -->
+    <color name="car_seekbar_thumb_selected_stroke_color">@color/car_rotary_focus_stroke_color</color>
+    <!-- Color of the background of the ring when the SeekBar is selected. -->
+    <color name="car_seekbar_thumb_selected_background_color">@color/car_rotary_focus_fill_color</color>
+    <!-- The SeekBar thumb color. -->
+    <color name="car_seekbar_thumb">@color/car_inverse_surface</color>
+    <!-- The SeekBar thumb color when disabled -->
+    <color name="car_seekbar_thumb_disabled">@color/car_neutral_40</color>
+    <!-- The SeekBar thumb shadow color. -->
+    <color name="car_seekbar_thumb_shadow">#8F000000</color>
+
+    <!-- Color for launcher icon background -->
+    <color name="ic_launcher_android_background">#1A73E8</color>
+
+    <!-- Button colors -->
+    <color name="car_button_background">@color/car_secondary_container</color>
+    <color name="car_button_foreground">@color/car_on_secondary_container</color>
+
+    <!-- Toggle button colors -->
+    <color name="car_button_toggle_background_checked">@color/car_primary</color>
+    <color name="car_button_toggle_background_unchecked">@color/car_secondary</color>
+    <color name="car_button_toggle_foreground_checked">@color/car_on_primary</color>
+    <color name="car_button_toggle_foreground_unchecked">@color/car_on_secondary</color>
+
+    <!-- Dialog colors -->
+    <color name="car_alert_dialog_background_color">@color/car_surface_2</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors_car.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors_car.xml
new file mode 100644
index 0000000000..d1b262e5c7
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors_car.xml
@@ -0,0 +1,111 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<resources>
+
+    <color name="car_colorPrimary">@color/car_primary</color>
+    <color name="car_colorSecondary">@color/car_secondary</color>
+    <color name="car_colorPrimaryDark">@color/car_primary</color>
+
+    <color name="car_title_light">@color/car_on_surface</color>
+    <color name="car_title_dark">@color/car_on_surface</color>
+    <color name="car_title">@color/car_on_surface</color>
+
+    <color name="car_title2_light">@color/car_on_surface_variant</color>
+    <color name="car_title2_dark">@color/car_on_surface_variant</color>
+    <color name="car_title2">@color/car_on_surface_variant</color>
+
+    <color name="car_headline1_light">@color/car_on_surface</color>
+    <color name="car_headline1_dark">@color/car_on_surface</color>
+    <color name="car_headline1">@color/car_on_surface</color>
+
+    <color name="car_headline2_light">@color/car_on_surface_variant</color>
+    <color name="car_headline2_dark">@color/car_on_surface_variant</color>
+    <color name="car_headline2">@color/car_on_surface_variant</color>
+
+    <color name="car_headline3_light">@color/car_on_surface</color>
+    <color name="car_headline3_dark">@color/car_on_surface</color>
+    <color name="car_headline3">@color/car_headline3_light</color>
+
+    <color name="car_headline4_light">@color/car_on_surface</color>
+    <color name="car_headline4_dark">@color/car_on_surface</color>
+    <color name="car_headline4">@color/car_headline4_light</color>
+
+    <color name="car_body1_light">@color/car_on_surface</color>
+    <color name="car_body1_dark">@color/car_on_surface</color>
+    <color name="car_body1">@color/car_body1_light</color>
+
+    <color name="car_body2_light">@color/car_on_surface</color>
+    <color name="car_body2_dark">@color/car_on_surface</color>
+    <color name="car_body2">@color/car_body2_light</color>
+
+    <color name="car_body3_light">@color/car_on_surface</color>
+    <color name="car_body3_dark">@color/car_on_surface</color>
+    <color name="car_body3">@color/car_body3_light</color>
+
+    <color name="car_body4_light">@color/car_on_surface</color>
+    <color name="car_body4_dark">@color/car_on_surface</color>
+    <color name="car_body4">@color/car_body4_light</color>
+
+    <color name="car_action1_light">@color/car_on_surface</color>
+    <color name="car_action1_dark">@color/car_on_surface</color>
+    <color name="car_action1">@color/car_action1_light</color>
+
+    <color name="car_tint_light">@color/car_on_surface</color>
+    <color name="car_tint_dark">@color/car_on_surface</color>
+    <color name="car_tint">@color/car_on_surface</color>
+
+    <!-- An inverted tinting from car_tint. -->
+    <color name="car_tint_inverse">@color/car_surface</color>
+
+    <!-- The color of the divider in the list. -->
+    <color name="car_list_divider_light">@color/car_neutral_variant_60</color>
+    <color name="car_list_divider_dark">@color/car_neutral_variant_60</color>
+
+    <!-- A light and dark colored card. -->
+    <color name="car_card_light">@color/car_surface</color>
+    <color name="car_card_dark">@color/car_surface</color>
+
+    <color name="car_card">@color/car_surface</color>
+
+    <!-- The ripple colors. The "dark" and "light" designation here refers to the color of the
+         ripple itself. -->
+    <color name="car_card_ripple_background_light">@color/car_secondary_container</color>
+    <color name="car_card_ripple_background_dark">@color/car_secondary_container</color>
+    <color name="car_card_ripple_background">@color/car_card_ripple_background_light</color>
+
+    <!-- The ripple color for a dark-colored card. This color is the opposite of
+         car_card_ripple_background. -->
+    <color name="car_card_ripple_background_inverse">@color/car_card_ripple_background_dark</color>
+
+    <color name="car_toast_background">@color/car_inverse_surface</color>
+
+    <!-- Misc colors -->
+    <color name="car_highlight_light">@color/car_primary</color>
+    <color name="car_highlight_dark">@color/car_primary</color>
+    <color name="car_highlight">@color/car_highlight_light</color>
+
+    <color name="car_accent_light">@color/car_highlight_light</color>
+    <color name="car_accent_dark">@color/car_highlight_dark</color>
+    <color name="car_accent">@color/car_highlight_light</color>
+
+    <color name="car_user_switcher_user_image_bgcolor">@color/car_secondary_container</color>
+    <color name="car_user_switcher_user_image_fgcolor">@color/car_secondary_container</color>
+
+    <color name="car_keyboard_divider_line">@color/car_outline</color>
+    <color name="car_keyboard_text_primary_color">@color/car_on_surface</color>
+    <color name="car_keyboard_text_secondary_color">@color/car_on_surface_variant</color>
+</resources>
\ No newline at end of file
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors_device_defaults.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors_device_defaults.xml
new file mode 100644
index 0000000000..bdb039a951
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/colors_device_defaults.xml
@@ -0,0 +1,50 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2024, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+
+<resources>
+    <color name="primary_device_default_dark">@color/car_primary</color>
+    <color name="primary_device_default_light">@color/car_primary</color>
+
+    <color name="primary_device_default_settings">@color/car_primary</color>
+    <color name="primary_device_default_settings_light">@color/car_primary</color>
+
+    <color name="primary_dark_device_default_dark">@color/car_primary</color>
+    <color name="primary_dark_device_default_light">@color/car_primary</color>
+
+    <color name="primary_dark_device_default_settings">@color/car_primary</color>
+    <color name="primary_dark_device_default_settings_light">@color/car_primary</color>
+
+    <color name="secondary_device_default_settings">@color/car_secondary</color>
+    <color name="secondary_device_default_settings_light">@color/car_secondary</color>
+
+    <color name="tertiary_device_default_settings">@color/car_tertiary</color>
+    <color name="quaternary_device_default_settings">@color/car_tertiary</color>
+
+    <color name="accent_device_default_light">@color/car_primary</color>
+    <color name="accent_device_default_dark">@color/car_primary</color>
+
+    <color name="background_device_default_dark">@color/car_background</color>
+    <color name="background_device_default_light">@color/car_background</color>
+
+    <color name="background_floating_device_default_dark">@color/car_background</color>
+    <color name="background_floating_device_default_light">@color/car_background</color>
+
+    <color name="error_color_device_default_dark">@color/car_error</color>
+    <color name="error_color_device_default_light">@color/car_error</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/dimens.xml
new file mode 100644
index 0000000000..b09fb73836
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/dimens.xml
@@ -0,0 +1,227 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+/*
+** Copyright 2024, The Android Open Source Project
+**
+** Licensed under the Apache License, Version 2.0 (the "License");
+** you may not use this file except in compliance with the License.
+** You may obtain a copy of the License at
+**
+**     http://www.apache.org/licenses/LICENSE-2.0
+**
+** Unless required by applicable law or agreed to in writing, software
+** distributed under the License is distributed on an "AS IS" BASIS,
+** WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+** See the License for the specific language governing permissions and
+** limitations under the License.
+*/
+-->
+<!-- Consider other dimension overrides in values-xxx when adding/changing the value here! -->
+<resources>
+    <dimen name="status_bar_height">76dp</dimen>
+    <dimen name="status_bar_height_default">76dp</dimen>
+    <dimen name="status_bar_height_landscape">76dp</dimen>
+    <dimen name="status_bar_height_portrait">76dp</dimen>
+    <dimen name="car_qs_header_system_icons_area_height">76dp</dimen>
+    <dimen name="navigation_bar_height">96dp</dimen>
+    <dimen name="navigation_bar_height_landscape">96dp</dimen>
+
+    <!-- Original dp unit notification icon size in the status bar. -->
+    <dimen name="status_bar_icon_size">32dp</dimen>
+    <!-- New sp unit notification icon size in the status bar. -->
+    <dimen name="status_bar_icon_size_sp">32sp</dimen>
+    <!-- System status icon size in the status bar. -->
+    <dimen name="status_bar_system_icon_size">32dp</dimen>
+
+    <dimen name="system_gestures_start_threshold">52dp</dimen>
+    <dimen name="system_gestures_distance_threshold">24dp</dimen>
+
+    <!-- The size of the right icon. This size is used to down-sample the bitmaps for "large icon". -->
+    <dimen name="notification_right_icon_size">@*android:dimen/car_touch_target_size</dimen>
+
+    <!-- The height of the header of a notification. -->
+    <dimen name="notification_header_height">58dp</dimen>
+
+    <!-- The absolute size of the notification expand icon. -->
+    <dimen name="notification_header_expand_icon_size">55dp</dimen>
+
+    <!-- The top padding for the notification expand button. -->
+    <dimen name="notification_expand_button_padding_top">0dp</dimen>
+
+    <!-- The end margin after the application icon in the notification header -->
+    <dimen name="notification_header_icon_margin_end">10dp</dimen>
+
+    <!-- The absolute size of the application icon in the notification header. -->
+    <dimen name="notification_header_icon_size">24dp</dimen>
+
+    <!-- The margins before and after each of the items in the notification header.-->
+    <dimen name="notification_header_separating_margin">6dp</dimen>
+
+    <!-- The margins before the start of the app name in the header. -->
+    <dimen name="notification_header_app_name_margin_start">@*android:dimen/notification_header_separating_margin</dimen>
+
+    <!-- The padding at the top of the notification header. -->
+    <dimen name="notification_header_padding_top">0dp</dimen>
+
+    <!-- The padding at the bottom of the notification header. -->
+    <dimen name="notification_header_padding_bottom">0dp</dimen>
+
+    <!-- The margin at the bottom of the notification header. -->
+    <dimen name="notification_header_margin_bottom">0dp</dimen>
+
+    <!-- The absolute height for the header in a media notification. -->
+    <dimen name="media_notification_header_height">@*android:dimen/media_notification_header_height</dimen>
+
+    <!-- Top margin to accommodate for the header before the notification content. This value
+         is 8dp smaller than the notification_header_height to bring the text closer. Otherwise,
+         spacing in the font itself makes the space look too large. -->
+    <dimen name="notification_content_margin_top">55dp</dimen>
+
+    <!-- The bottom margin after the notification content.-->
+    <dimen name="notification_content_margin_bottom">24dp</dimen>
+
+    <!-- The margin on the start of the content view. This value should match card keyline1. -->
+    <dimen name="notification_content_margin_start">24dp</dimen>
+
+    <!-- The margin on the end of the content view. Keep in sync with
+         notification_content_plus_picture_margin! -->
+    <dimen name="notification_content_margin_end">@*android:dimen/notification_content_margin_start</dimen>
+
+    <!-- The margin on the end of the content view with a picture. This value is the size of
+         the right icon (64dp) + notification_content_margin_end + 16dp. -->
+    <dimen name="notification_content_picture_margin">106dp</dimen>
+
+    <!-- The margin on the end of the content view with a picture, plus the standard
+        content end margin. -->
+    <dimen name="notification_content_plus_picture_margin_end">80dp</dimen>
+
+    <!-- Size of notification text titles (see TextAppearance.StatusBar.EventContent.Title). -->
+    <dimen name="notification_title_text_size">32sp</dimen>
+
+    <!-- Size of notification text (see TextAppearance.StatusBar.EventContent). -->
+    <dimen name="notification_text_size">26sp</dimen>
+
+    <!-- Size of smaller notification text (see TextAppearance.StatusBar.EventContent.Line2,
+         Info, Time). -->
+    <dimen name="notification_subtext_size">@*android:dimen/notification_text_size</dimen>
+
+    <!-- The margin on top of the text of the notification. -->
+    <dimen name="notification_text_margin_top">0dp</dimen>
+
+    <!-- The height of the notification action list. -->
+    <dimen name="notification_action_list_height">76dp</dimen>
+
+    <!-- The size of the media actions in the media notification. -->
+    <dimen name="media_notification_action_button_size">36dp</dimen>
+
+    <!-- The bottom padding for the media actions container. -->
+    <dimen name="media_notification_actions_padding_bottom">0dp</dimen>
+
+    <!-- The height of the progress bar. -->
+    <dimen name="notification_progress_bar_height">25dp</dimen>
+
+    <!-- The top margin before the notification progress bar.  -->
+    <dimen name="notification_progress_margin_top">16dp</dimen>
+
+    <!-- Make the dots in lock pattern thicker in Car -->
+    <dimen name="lock_pattern_dot_size">24dp</dimen>
+
+    <!-- Focus dimensions -->
+    <dimen name="focus_stroke_width">8dp</dimen>
+    <dimen name="focus_pressed_stroke_width">4dp</dimen>
+
+    <!-- Autofill save dialog padding -->
+    <dimen name="autofill_save_outer_top_margin">@*android:dimen/car_padding_2</dimen>
+    <dimen name="autofill_save_outer_top_padding">@*android:dimen/car_padding_2</dimen>
+    <dimen name="autofill_elevation">@*android:dimen/car_padding_2</dimen>
+    <dimen name="autofill_save_inner_padding">@*android:dimen/car_padding_2</dimen>
+    <dimen name="autofill_save_icon_size">@*android:dimen/car_primary_icon_size</dimen>
+    <dimen name="autofill_save_title_start_padding">@*android:dimen/car_padding_4</dimen>
+    <dimen name="autofill_save_scroll_view_top_margin">@*android:dimen/car_padding_4</dimen>
+    <dimen name="autofill_save_button_bar_padding">@*android:dimen/car_keyline_1</dimen>
+
+    <!-- Floating toolbar dimensions -->
+    <dimen name="floating_toolbar_menu_button_side_padding">@*android:dimen/car_padding_2</dimen>
+    <dimen name="floating_toolbar_menu_image_width">@*android:dimen/car_primary_icon_size</dimen>
+    <dimen name="floating_toolbar_menu_image_button_vertical_padding">@*android:dimen/car_padding_2</dimen>
+    <dimen name="floating_toolbar_text_size">@*android:dimen/car_body1_size</dimen>
+
+    <!-- Switch dimensions -->
+    <dimen name="car_switch_track_height">48dp</dimen>
+    <dimen name="car_switch_track_width">88dp</dimen>
+    <!-- Increases the vertical touch target size. -->
+    <dimen name="car_switch_track_margin_vertical">14dp</dimen>
+    <!-- Switch focus ring height. -->
+    <dimen name="car_switch_track_focus_ring_height">64dp</dimen>
+    <!-- Switch focus ring width. -->
+    <dimen name="car_switch_track_focus_ring_width">112dp</dimen>
+    <!-- Switch focus ring padding. -->
+    <dimen name="car_switch_track_focus_ring_padding">12dp</dimen>
+    <!-- Should be the half of car_switch_track_focus_ring_height. -->
+    <dimen name="car_switch_track_focus_ring_outer_radius">@dimen/shape_corner_full</dimen>
+    <!-- Should be the half of car_switch_track_height. -->
+    <dimen name="car_switch_thumb_outer_radius">@dimen/shape_corner_full</dimen>
+    <!--  The difference between the track size and the thumb size. -->
+    <dimen name="car_switch_thumb_stroke_width">4dp</dimen>
+    <!-- car_switch_thumb_size + car_switch_thumb_stroke_width == car_switch_track_height -->
+    <dimen name="car_switch_thumb_size">40dp</dimen>
+    <!-- Switch thumb radius -->
+    <dimen name="car_switch_thumb_radius">@dimen/shape_corner_full</dimen>
+
+    <!-- Toast Dimensions -->
+    <dimen name="toast_corner_radius">@dimen/shape_corner_large</dimen>
+    <dimen name="toast_elevation">0dp</dimen>
+    <dimen name="toast_width">1050dp</dimen>
+    <dimen name="toast_y_offset">268dp</dimen>
+
+    <!-- Button Dimensions -->
+    <dimen name="car_button_height">88dp</dimen>
+    <dimen name="car_button_min_height">88dp</dimen>
+    <dimen name="car_button_height_small">64dp</dimen>
+    <dimen name="car_button_min_height_small">64dp</dimen>
+    <dimen name="car_button_min_width">158dp</dimen>
+    <dimen name="car_button_radius">@dimen/shape_corner_full</dimen>
+    <dimen name="car_button_small_radius">@dimen/shape_corner_full</dimen>
+
+    <!-- Radio button dimensions -->
+    <dimen name="car_radio_button_outer_ring_size">45dp</dimen>
+    <dimen name="car_radio_button_outer_ring_stroke_width">4dp</dimen>
+    <dimen name="car_radio_button_inner_circle_size">32dp</dimen>
+    <dimen name="car_radio_button_focus_ring_size">69dp</dimen>
+    <dimen name="car_radio_button_focus_ring_padding">12dp</dimen>
+    <dimen name="car_radio_button_outer_ring_radius">@dimen/shape_corner_full</dimen>
+    <dimen name="car_radio_button_inner_ring_radius">@dimen/shape_corner_full</dimen>
+    <dimen name="car_radio_button_focus_ring_radius">@dimen/shape_corner_full</dimen>
+    <!-- Checkbox dimensions. -->
+    <!-- 77dp scales the material checkbox to provide a 44dp x 44dp checkbox rectangle. -->
+    <dimen name="car_checkbox_size">77dp</dimen>
+    <!-- The checkbox focus ring size -->
+    <dimen name="car_checkbox_focus_ring_size">66dp</dimen>
+    <!-- The checkbox focus radius -->
+    <dimen name="car_checkbox_focus_radius">@dimen/shape_corner_extra_small</dimen>
+
+    <!-- SeekBar dimensions. -->
+    <!-- Allows thumb to extend out of the range of the track. -->
+    <!-- For more information see android.widget.SeekBar#attr_android:thumbOffset. -->
+    <dimen name="car_seekbar_thumb_offset">24dp</dimen>
+    <!-- Horizontal padding for the SeekBar.-->
+    <dimen name="car_seekbar_horizontal_padding">24dp</dimen>
+    <!-- The SeekBar track height.-->
+    <dimen name="car_seekbar_track_height">24dp</dimen>
+    <!-- Vertical padding that extends the touch area for the SeekBar. -->
+    <dimen name="car_seekbar_track_vertical_padding">26dp</dimen>
+    <!-- The stroke with of the ring around the SeekBar thumb when selected. -->
+    <dimen name="car_seekbar_thumb_selected_stroke_width">8dp</dimen>
+    <!-- The size of the SeekBar thumb. -->
+    <dimen name="car_seekbar_thumb_size">48dp</dimen>
+    <!-- The size of the selectable SeekBar thumb. -->
+    <dimen name="car_seekbar_thumb_selectable_size">68dp</dimen>
+    <!-- The radius of the end of the SeekbarTrack. -->
+    <dimen name="car_seekbar_thumb_outer_radius">@dimen/shape_corner_full</dimen>
+    <!-- The radius of the SeekBar thumb. -->
+    <dimen name="car_seekbar_thumb_radius">@dimen/shape_corner_full</dimen>
+    <!-- Sets the Theme android:disabledAlpha value -->
+    <dimen name="car_disabled_alpha">0.35</dimen>
+
+    <dimen name="resolver_max_collapsed_height">400dp</dimen>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/styles.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/styles.xml
new file mode 100644
index 0000000000..717d8b5b6e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/styles.xml
@@ -0,0 +1,74 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2017 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<resources>
+    <!-- Override the default activity transitions. We have to do a full copy and not just inherit
+         and override because we're replacing the default style across the system.
+    -->
+    <style name="Animation.Activity" parent="*android:Animation.Material.Activity">
+        <item name="android:activityOpenEnterAnimation">@*android:anim/fade_in</item>
+        <item name="android:activityOpenExitAnimation">@*android:anim/fade_out</item>
+        <item name="android:activityCloseEnterAnimation">@*android:anim/fade_in</item>
+        <item name="android:activityCloseExitAnimation">@*android:anim/fade_out</item>
+        <item name="android:taskOpenEnterAnimation">@*android:anim/fade_in</item>
+        <item name="android:taskOpenExitAnimation">@*android:anim/fade_out</item>
+        <item name="android:launchTaskBehindTargetAnimation">@*android:anim/launch_task_behind_target</item>
+        <item name="android:launchTaskBehindSourceAnimation">@*android:anim/launch_task_behind_source</item>
+        <item name="android:taskCloseEnterAnimation">@*android:anim/fade_in</item>
+        <item name="android:taskCloseExitAnimation">@*android:anim/fade_out</item>
+        <item name="android:taskToFrontEnterAnimation">@*android:anim/fade_in</item>
+        <item name="android:taskToFrontExitAnimation">@*android:anim/fade_out</item>
+        <item name="android:taskToBackEnterAnimation">@*android:anim/task_close_enter</item>
+        <item name="android:taskToBackExitAnimation">@*android:anim/task_close_exit</item>
+        <item name="android:wallpaperOpenEnterAnimation">@*android:anim/wallpaper_open_enter</item>
+        <item name="android:wallpaperOpenExitAnimation">@*android:anim/wallpaper_open_exit</item>
+        <item name="android:wallpaperCloseEnterAnimation">@*android:anim/wallpaper_close_enter</item>
+        <item name="android:wallpaperCloseExitAnimation">@*android:anim/wallpaper_close_exit</item>
+        <item name="android:wallpaperIntraOpenEnterAnimation">@*android:anim/wallpaper_intra_open_enter</item>
+        <item name="android:wallpaperIntraOpenExitAnimation">@*android:anim/wallpaper_intra_open_exit</item>
+        <item name="android:wallpaperIntraCloseEnterAnimation">@*android:anim/wallpaper_intra_close_enter</item>
+        <item name="android:wallpaperIntraCloseExitAnimation">@*android:anim/wallpaper_intra_close_exit</item>
+        <item name="android:fragmentOpenEnterAnimation">@*android:animator/fragment_open_enter</item>
+        <item name="android:fragmentOpenExitAnimation">@*android:animator/fragment_open_exit</item>
+        <item name="android:fragmentCloseEnterAnimation">@*android:animator/fragment_close_enter</item>
+        <item name="android:fragmentCloseExitAnimation">@*android:animator/fragment_close_exit</item>
+        <item name="android:fragmentFadeEnterAnimation">@*android:animator/fragment_fade_enter</item>
+        <item name="android:fragmentFadeExitAnimation">@*android:animator/fragment_fade_exit</item>
+    </style>
+
+    <!-- The style for the container of media actions in a notification. -->
+    <style name="NotificationMediaActionContainer">
+        <item name="android:background">@*android:color/notification_action_list</item>
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">@*android:dimen/notification_action_list_height</item>
+        <item name="android:layout_marginTop">0dp</item>
+        <item name="android:paddingStart">0dp</item>
+        <item name="android:paddingBottom">@*android:dimen/media_notification_actions_padding_bottom</item>
+        <item name="android:gravity">center</item>
+    </style>
+
+    <style name="CarDialogActionButton" parent="Widget.DeviceDefault.Button" />
+
+    <style name="CarDialogActionButton1" parent="Widget.DeviceDefault.Button.Colored" />
+
+    <style name="CarDialogMessageText" parent="TextAppearance.DeviceDefault.Medium">
+        <item name="android:textStyle">normal</item>
+        <item name="android:lineHeight">40dp</item>
+        <item name="android:textColor">@color/car_on_surface</item>
+        <item name="android:stateListAnimator">@null</item>
+    </style>
+
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/styles_device_default.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/styles_device_default.xml
new file mode 100644
index 0000000000..06fce000f8
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/styles_device_default.xml
@@ -0,0 +1,264 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<!--
+    This is an override of frameworks/base/core/res/res/values/styles_device_default.xml
+    It is how the device default is changed to match the desired look for a car theme.
+-->
+<resources>
+
+    <style name="TextAppearance.DeviceDefault" parent="TextAppearance.Car">
+        <item name="android:textColor">?android:attr/textColorPrimary</item>
+        <item name="android:textColorHint">?android:attr/textColorHint</item>
+        <item name="android:textColorHighlight">?android:attr/textColorHighlight</item>
+        <item name="android:textColorLink">?android:attr/textColorLink</item>
+        <item name="android:lineSpacingMultiplier">
+            @*android:dimen/text_line_spacing_multiplier_material
+        </item>
+        <item name="android:textSize">@*android:dimen/car_body3_size</item>
+    </style>
+    <style name="TextAppearance.DeviceDefault.Inverse" parent="android:TextAppearance.Material.Inverse">
+        <item name="android:textColor">?android:attr/textColorPrimaryInverse</item>
+        <item name="android:textSize">@*android:dimen/car_body3_size</item>
+    </style>
+
+    <style name="TextAppearance.DeviceDefault.Large" parent="TextAppearance.Car.Body.Large">
+        <item name="android:textColor">?android:attr/textColorPrimary</item>
+        <item name="android:textColorHint">?android:attr/textColorHint</item>
+        <item name="android:textColorHighlight">?android:attr/textColorHighlight</item>
+        <item name="android:textColorLink">?android:attr/textColorLink</item>
+    </style>
+    <style name="TextAppearance.DeviceDefault.Large.Inverse"
+           parent="TextAppearance.DeviceDefault.Large">
+        <item name="android:textColor">?android:attr/textColorPrimaryInverse</item>
+        <item name="android:textColorHint">?android:attr/textColorHintInverse</item>
+        <item name="android:textColorHighlight">?android:attr/textColorHighlightInverse</item>
+        <item name="android:textColorLink">?android:attr/textColorLinkInverse</item>
+    </style>
+    <style name="TextAppearance.DeviceDefault.Medium" parent="TextAppearance.Car.Body.Medium">
+        <item name="android:textColor">?android:attr/textColorSecondary</item>
+        <item name="android:textColorHint">?android:attr/textColorHint</item>
+        <item name="android:textColorHighlight">?android:attr/textColorHighlight</item>
+        <item name="android:textColorLink">?android:attr/textColorLink</item>
+    </style>
+    <style name="TextAppearance.DeviceDefault.Medium.Inverse"
+           parent="TextAppearance.DeviceDefault.Medium">
+        <item name="android:textColor">?android:attr/textColorSecondaryInverse</item>
+        <item name="android:textColorHint">?android:attr/textColorHintInverse</item>
+        <item name="android:textColorHighlight">?android:attr/textColorHighlightInverse</item>
+        <item name="android:textColorLink">?android:attr/textColorLinkInverse</item>
+    </style>
+    <style name="TextAppearance.DeviceDefault.Small" parent="TextAppearance.Car.Body.Small">
+        <item name="android:textColor">?android:attr/textColorTertiary</item>
+        <item name="android:textColorHint">?android:attr/textColorHint</item>
+        <item name="android:textColorHighlight">?android:attr/textColorHighlight</item>
+        <item name="android:textColorLink">?android:attr/textColorLink</item>
+    </style>
+    <style name="TextAppearance.DeviceDefault.Small.Inverse"
+           parent="TextAppearance.DeviceDefault.Small">
+        <item name="android:textColor">?android:attr/textColorTertiaryInverse</item>
+        <item name="android:textColorHint">?android:attr/textColorHintInverse</item>
+        <item name="android:textColorHighlight">?android:attr/textColorHighlightInverse</item>
+        <item name="android:textColorLink">?android:attr/textColorLinkInverse</item>
+    </style>
+
+    <style name="TextAppearance.DeviceDefault.Subhead" parent="android:TextAppearance.Material.Subhead">
+        <item name="android:textSize">@*android:dimen/car_body1_size</item>
+    </style>
+
+    <style name="DialogWindowTitle.DeviceDefault" parent="*android:DialogWindowTitle.Material">
+        <item name="android:textAppearance">@*android:style/TextAppearance.DeviceDefault.DialogWindowTitle</item>
+    </style>
+    <style name="TextAppearance.DeviceDefault.DialogWindowTitle" parent="android:TextAppearance.DeviceDefault.Large">
+        <item name="android:fontFamily">@*android:string/config_headlineFontFamilyMedium</item>
+        <item name="android:textStyle">normal</item>
+        <item name="android:textColor">@*android:color/car_body2</item>
+    </style>
+    <style name="TextAppearance.Material.DialogWindowTitle" parent="android:TextAppearance.Material.Title" />
+    <style name="TextAppearance.Material.Title" parent="android:TextAppearance.Material">
+        <item name="android:textSize">@*android:dimen/text_size_title_material</item>
+        <item name="android:fontFamily">@*android:string/font_family_title_material</item>
+        <item name="android:textColor">?android:attr/textColorPrimary</item>
+    </style>
+
+    <style name="TextAppearance.DeviceDefault.Widget.Button" parent="TextAppearance.Car.Button.Medium">
+        <item name="android:textAllCaps">@*android:bool/config_buttonTextAllCaps</item>
+        <item name="android:textColor">@color/car_button_text_color</item>
+    </style>
+
+    <style name="TextAppearance.DeviceDefault.Widget.Button.Small"
+           parent="TextAppearance.Car.Button.Small">
+        <item name="android:textColor">@color/car_button_text_color</item>
+    </style>
+
+    <style name="TextAppearance.DeviceDefault.Widget.Button.Colored"
+           parent="TextAppearance.DeviceDefault.Widget.Button">
+        <item name="android:textColor">@color/car_button_colored_text_color</item>
+    </style>
+
+    <style name="TextAppearance.DeviceDefault.Widget.Button.Borderless"
+           parent="TextAppearance.DeviceDefault.Widget.Button">
+        <item name="android:textColor">@color/car_on_background</item>
+    </style>
+
+    <style name="TextAppearance.DeviceDefault.Widget.Button.Borderless.Colored"
+           parent="TextAppearance.DeviceDefault.Widget.Button">
+        <item name="android:textColor">@color/car_primary</item>
+    </style>
+
+    <style name="TextAppearance.DeviceDefault.Widget.Button.Toggle"
+           parent="TextAppearance.DeviceDefault.Widget.Button">
+        <item name="android:textColor">@color/car_button_toggle_text_color</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.TextView" parent="android:Widget.Material.TextView">
+        <item name="android:ellipsize">none</item>
+        <item name="android:requiresFadingEdge">horizontal</item>
+        <item name="android:fadingEdgeLength">@*android:dimen/car_textview_fading_edge_length</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.Button" parent="android:Widget.Material.Button">
+        <item name="android:singleLine">true</item>
+        <item name="android:ellipsize">none</item>
+        <item name="android:requiresFadingEdge">horizontal</item>
+        <item name="android:fadingEdgeLength">@*android:dimen/car_textview_fading_edge_length</item>
+        <item name="android:background">@drawable/car_button_background</item>
+        <item name="android:textAppearance">@style/TextAppearance.DeviceDefault.Widget.Button</item>
+        <item name="android:minHeight">@dimen/car_button_min_height</item>
+        <item name="android:minWidth">@dimen/car_button_min_width</item>
+        <item name="android:paddingHorizontal">@*android:dimen/car_button_horizontal_padding</item>
+        <item name="android:gravity">center</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.Button.Small" parent="Widget.DeviceDefault.Button">
+        <item name="android:paddingHorizontal">@dimen/car_button_small_radius</item>
+        <item name="android:minHeight">@dimen/car_button_min_height_small</item>
+        <item name="android:textAppearance">
+            @style/TextAppearance.DeviceDefault.Widget.Button.Small
+        </item>
+    </style>
+
+    <style name="Widget.DeviceDefault.Button.Inset" parent="Widget.DeviceDefault.Button"/>
+
+    <style name="Widget.DeviceDefault.Button.Colored" parent="Widget.DeviceDefault.Button">
+        <item name="android:background">@drawable/car_button_colored_background</item>
+        <item name="android:textAppearance">
+            @style/TextAppearance.DeviceDefault.Widget.Button.Colored
+        </item>
+    </style>
+
+    <style name="Widget.DeviceDefault.Button.Toggle" parent="android:Widget.Material.Button.Toggle">
+        <item name="android:singleLine">true</item>
+        <item name="android:ellipsize">none</item>
+        <item name="android:background">@drawable/car_button_toggle_background</item>
+        <item name="android:textAppearance">@style/TextAppearance.DeviceDefault.Widget.Button.Toggle</item>
+        <item name="android:minHeight">@dimen/car_button_min_height</item>
+        <item name="android:minWidth">@dimen/car_button_min_width</item>
+        <item name="android:paddingHorizontal">@*android:dimen/car_button_horizontal_padding</item>
+        <item name="android:gravity">center</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.Button.Borderless" parent="android:Widget.Material.Button.Borderless">
+        <item name="android:background">@drawable/btn_borderless_car</item>
+        <item name="android:textAppearance">@style/TextAppearance.DeviceDefault.Widget.Button.Borderless</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.Button.Borderless.Colored" parent="android:Widget.Material.Button.Borderless.Colored">
+        <item name="android:background">@drawable/btn_borderless_car</item>
+        <item name="android:textAppearance">@style/TextAppearance.DeviceDefault.Widget.Button.Borderless.Colored</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.CompoundButton.CheckBox" parent="android:Widget.Material.CompoundButton.CheckBox">
+        <item name="android:button">@drawable/car_checkbox</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.CompoundButton.RadioButton"
+        parent="android:Widget.Material.CompoundButton.RadioButton">
+        <item name="android:button">@drawable/car_radio_button</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.CompoundButton.Switch"
+        parent="android:Widget.Material.CompoundButton.Switch">
+        <item name="android:thumb">@drawable/car_switch_thumb</item>
+        <item name="android:track">@drawable/car_switch_track</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.Light.CompoundButton.Switch"
+        parent="android:Widget.Material.Light.CompoundButton.Switch">
+        <item name="android:thumb">@drawable/car_switch_thumb</item>
+        <item name="android:track">@drawable/car_switch_track</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.ProgressBar.Horizontal" parent="android:Widget.Material.ProgressBar.Horizontal">
+        <item name="android:minHeight">@*android:dimen/car_progress_bar_height</item>
+        <item name="android:maxHeight">@*android:dimen/car_progress_bar_height</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.SeekBar" parent="android:Widget.Material.SeekBar">
+        <item name="android:thumb">@drawable/car_seekbar_thumb_selectable</item>
+        <item name="android:progressDrawable">@drawable/car_seekbar_track</item>
+        <item name="android:splitTrack">false</item>
+        <item name="android:thumbOffset">@dimen/car_seekbar_thumb_offset</item>
+        <item name="android:paddingStart">@dimen/car_seekbar_horizontal_padding</item>
+        <item name="android:paddingEnd">@dimen/car_seekbar_horizontal_padding</item>
+        <item name="*android:useDisabledAlpha">true</item>
+        <item name="android:clipToOutline">false</item>
+        <item name="android:clipToPadding">false</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.Light.SeekBar" parent="android:Widget.Material.Light.SeekBar">
+        <item name="android:thumb">@drawable/car_seekbar_thumb_selectable</item>
+        <item name="android:progressDrawable">@drawable/car_seekbar_track</item>
+        <item name="android:splitTrack">false</item>
+        <item name="android:thumbOffset">@dimen/car_seekbar_thumb_offset</item>
+        <item name="android:paddingStart">@dimen/car_seekbar_horizontal_padding</item>
+        <item name="android:paddingEnd">@dimen/car_seekbar_horizontal_padding</item>
+        <item name="*android:useDisabledAlpha">true</item>
+        <item name="android:clipToOutline">false</item>
+        <item name="android:clipToPadding">false</item>
+    </style>
+
+    <style name="Widget.DeviceDefault.ActionBar.Solid" parent="android:Widget.Material.ActionBar.Solid">
+        <item name="android:textSize">@*android:dimen/car_body3_size</item>
+        <item name="android:textColor">@color/car_on_background</item>
+    </style>
+
+    <!-- Preference Styles -->
+    <style name="Preference.DeviceDefault" parent="*android:Preference.Material">
+        <item name="android:layout">@*android:layout/car_preference</item>
+    </style>
+    <style name="Preference.DeviceDefault.Category" parent="*android:Preference.Material.Category">
+        <item name="android:layout">@*android:layout/car_preference_category</item>
+    </style>
+    <style name="Preference.DeviceDefault.CheckBoxPreference" parent="*android:Preference.Material.CheckBoxPreference">
+        <item name="android:layout">@*android:layout/car_preference</item>
+    </style>
+    <style name="Preference.DeviceDefault.DialogPreference" parent="*android:Preference.Material.DialogPreference">
+        <item name="android:layout">@*android:layout/car_preference</item>
+    </style>
+    <style name="Preference.DeviceDefault.DialogPreference.EditTextPreference" parent="*android:Preference.Material.DialogPreference.EditTextPreference">
+        <item name="android:layout">@*android:layout/car_preference</item>
+    </style>
+    <style name="Preference.DeviceDefault.SwitchPreference" parent="*android:Preference.Material.SwitchPreference">
+        <item name="android:layout">@*android:layout/car_preference</item>
+    </style>
+
+    <!-- AlertDialog Style -->
+    <style name="AlertDialog.DeviceDefault" parent="*android:AlertDialog.Material">
+        <item name="android:layout">@*android:layout/car_alert_dialog</item>
+    </style>
+
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/themes_device_defaults.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/themes_device_defaults.xml
new file mode 100644
index 0000000000..4268725a8e
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenFrameworkResRRO/res/values/themes_device_defaults.xml
@@ -0,0 +1,348 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<!--
+    This is an override of frameworks/base/core/res/res/values/themes_device_default.xml
+    It is how the device default is changed to match the desired look for a car theme.
+-->
+<resources>
+    <style name="Theme.DeviceDefaultBaseCar" parent="*android:Theme.DeviceDefaultBase">
+        <item name="android:borderlessButtonStyle">@*android:style/Widget.DeviceDefault.Button.Borderless.Colored</item>
+        <item name="android:buttonBarButtonStyle">@*android:style/Widget.DeviceDefault.Button.ButtonBar.AlertDialog</item>
+        <item name="android:buttonStyle">@*android:style/Widget.DeviceDefault.Button</item>
+        <item name="android:colorAccent">@color/car_primary</item>
+        <item name="android:colorBackground">@color/car_background</item>
+        <item name="android:colorBackgroundFloating">@color/car_background</item>
+        <item name="android:colorButtonNormal">@color/btn_device_default</item>
+        <item name="android:colorControlHighlight">@color/car_control_highlight</item>
+        <item name="android:colorControlNormal">@color/btn_device_default</item>
+        <item name="android:colorPrimary">@color/car_primary</item>
+        <item name="android:colorPrimaryDark">@color/car_primary</item>
+        <item name="android:colorForeground">@color/car_on_background</item>
+        <item name="android:editTextColor">@color/car_on_surface</item>
+        <item name="android:listPreferredItemHeightSmall">@*android:dimen/car_single_line_list_item_height</item>
+        <item name="android:selectableItemBackground">@*android:drawable/item_background</item>
+        <item name="android:statusBarColor">@android:color/black</item>
+        <item name="android:textColorHint">@*android:color/car_body2</item>
+        <item name="android:textColorPrimary">@color/car_on_background</item>
+        <item name="android:textColorPrimaryDisableOnly">@color/car_on_background</item>
+        <item name="android:textColorPrimaryInverse">@color/car_background</item>
+        <item name="android:textColorSecondary">@color/car_secondary</item>
+        <item name="android:textColorSecondaryInverse">@color/car_on_secondary</item>
+        <item name="android:textColorTertiary">@color/car_secondary</item>
+        <item name="android:textColorTertiaryInverse">@color/car_on_secondary</item>
+        <item name="android:textAppearanceListItem">@*android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceListItemSmall">@*android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceListItemSecondary">@*android:style/TextAppearance.DeviceDefault.Small</item>
+        <item name="android:textAppearanceButton">@*android:style/TextAppearance.DeviceDefault.Widget.Button</item>
+        <item name="android:actionBarSize">@*android:dimen/car_app_bar_height</item>
+        <item name="*android:disabledAlpha">@dimen/car_disabled_alpha</item>
+        <item name="android:isLightTheme">false</item>
+    </style>
+
+    <style name="Theme.DeviceDefault" parent="Theme.DeviceDefaultBaseCar">
+        <item name="android:windowLayoutInDisplayCutoutMode">always</item>
+    </style>
+
+    <style name="Theme.DeviceDefault.Dialog" parent="android:Theme.Material.Dialog">
+        <item name="android:textAppearanceLarge">@*android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceMedium">@*android:style/TextAppearance.DeviceDefault.Medium</item>
+        <item name="android:textAppearanceSmall">@*android:style/TextAppearance.DeviceDefault.Small</item>
+        <item name="android:textAppearanceLargeInverse">@*android:style/TextAppearance.DeviceDefault.Large.Inverse</item>
+        <item name="android:textAppearanceMediumInverse">@*android:style/TextAppearance.DeviceDefault.Medium.Inverse</item>
+        <item name="android:textAppearanceSmallInverse">@*android:style/TextAppearance.DeviceDefault.Small.Inverse</item>
+        <item name="android:textAppearanceListItem">@*android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceListItemSmall">@*android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceListItemSecondary">@*android:style/TextAppearance.DeviceDefault.Small</item>
+        <item name="android:textAppearanceButton">@*android:style/TextAppearance.DeviceDefault.Widget.Button</item>
+        <item name="android:borderlessButtonStyle">@*android:style/Widget.DeviceDefault.Button.Borderless.Colored</item>
+        <item name="android:buttonBarButtonStyle">@*android:style/Widget.DeviceDefault.Button.ButtonBar.AlertDialog</item>
+        <item name="android:buttonStyle">@*android:style/Widget.DeviceDefault.Button</item>
+        <item name="android:buttonBarPositiveButtonStyle">@*android:style/Widget.DeviceDefault.Button.Colored</item>
+        <item name="android:buttonBarNegativeButtonStyle">@*android:style/Widget.DeviceDefault.Button</item>
+        <item name="android:buttonBarNeutralButtonStyle">@*android:style/Widget.DeviceDefault.Button</item>
+        <item name="android:colorAccent">@color/car_primary</item>
+        <item name="android:colorBackground">@color/car_background</item>
+        <item name="android:colorBackgroundFloating">@color/car_background</item>
+        <item name="android:colorButtonNormal">@color/btn_device_default</item>
+        <item name="android:colorControlHighlight">@color/car_control_highlight</item>
+        <item name="android:colorControlNormal">@color/btn_device_default</item>
+        <item name="android:colorPrimary">@color/car_primary</item>
+        <item name="android:colorPrimaryDark">@color/car_primary</item>
+        <item name="android:colorForeground">@color/car_on_background</item>
+        <item name="android:editTextColor">@color/car_on_surface</item>
+        <item name="android:selectableItemBackground">@*android:drawable/item_background</item>
+        <item name="android:textColorHint">@*android:color/car_body2</item>
+        <item name="android:textColorPrimary">@color/car_on_background</item>
+        <item name="android:textColorPrimaryDisableOnly">@color/car_on_background</item>
+        <item name="android:textColorPrimaryInverse">@color/car_background</item>
+        <item name="android:textColorSecondary">@color/car_secondary</item>
+        <item name="android:textColorSecondaryInverse">@color/car_on_secondary</item>
+        <item name="android:windowTitleStyle">?android:attr/textAppearanceLarge</item>
+    </style>
+
+    <style name="Theme.DeviceDefault.Dialog.NoActionBar" parent="android:Theme.DeviceDefault.Dialog">
+        <item name="android:windowActionBar">false</item>
+        <item name="android:windowNoTitle">true</item>
+    </style>
+
+    <style name="Theme.DeviceDefault.Dialog.Alert" parent="android:Theme.Material.Dialog.Alert">
+        <item name="android:textAppearanceLarge">@*android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceMedium">@*android:style/TextAppearance.DeviceDefault.Medium</item>
+        <item name="android:textAppearanceSmall">@*android:style/TextAppearance.DeviceDefault.Small</item>
+        <item name="android:textAppearanceButton">@*android:style/TextAppearance.DeviceDefault.Widget.Button</item>
+        <item name="android:alertDialogStyle">@*android:style/AlertDialog.DeviceDefault</item>
+        <item name="android:background">@android:color/transparent</item>
+        <item name="android:borderlessButtonStyle">@*android:style/Widget.DeviceDefault.Button.Borderless.Colored</item>
+        <item name="android:buttonBarButtonStyle">@*android:style/Widget.DeviceDefault.Button.ButtonBar.AlertDialog</item>
+        <item name="android:buttonStyle">@*android:style/Widget.DeviceDefault.Button</item>
+        <item name="android:colorAccent">@color/car_primary</item>
+        <item name="android:colorBackground">@android:color/transparent</item>
+        <item name="android:colorBackgroundFloating">@android:color/transparent</item>
+        <item name="android:colorButtonNormal">@color/btn_device_default</item>
+        <item name="android:colorControlHighlight">@color/car_control_highlight</item>
+        <item name="android:colorControlNormal">@color/btn_device_default</item>
+        <item name="android:colorControlActivated">@color/car_control_highlight</item>
+        <item name="android:colorPrimary">@color/car_primary</item>
+        <item name="android:colorPrimaryDark">@color/car_primary</item>
+        <item name="android:colorForeground">@color/car_on_background</item>
+        <item name="android:editTextColor">@color/car_on_surface</item>
+        <item name="android:listPreferredItemHeightSmall">@*android:dimen/car_single_line_list_item_height</item>
+        <item name="android:selectableItemBackground">@*android:drawable/item_background</item>
+        <item name="android:textColorHint">@*android:color/car_body2</item>
+        <item name="android:textColorPrimary">@color/car_on_background</item>
+        <item name="android:textColorPrimaryDisableOnly">@color/car_on_background</item>
+        <item name="android:textColorSecondary">@color/car_secondary</item>
+        <item name="android:textAppearanceListItem">@*android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceListItemSmall">@*android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceListItemSecondary">@*android:style/TextAppearance.DeviceDefault.Small</item>
+        <item name="android:windowTitleStyle">?android:attr/textAppearanceLarge</item>
+    </style>
+
+    <style name="Theme.DeviceDefault.Settings.Dialog" parent="android:Theme.DeviceDefault.Dialog.Alert">
+    </style>
+
+    <!-- The light theme is defined to be the same as the default since currently there is only one
+        defined theme palette -->
+    <style name="Theme.DeviceDefault.Light" parent="android:Theme.DeviceDefault">
+        <item name="android:switchStyle">@style/Widget.DeviceDefault.Light.CompoundButton.Switch</item>
+        <item name="*android:disabledAlpha">@dimen/car_disabled_alpha</item>
+        <!--  To simulate transparency over light (white) background, we don't need a selector. -->
+        <item name="android:windowLayoutInDisplayCutoutMode">always</item>
+        <item name="android:isLightTheme">false</item>
+    </style>
+    <style name="Theme.DeviceDefault.Light.Dialog" parent="android:Theme.DeviceDefault.Dialog"/>
+    <style name="Theme.DeviceDefault.Light.Dialog.Alert" parent="android:Theme.DeviceDefault.Dialog.Alert"/>
+    <style name="Theme.DeviceDefault.Light.Dialog.NoActionBar" parent="android:Theme.DeviceDefault.Dialog.NoActionBar"/>
+
+    <style name="Theme.DeviceDefault.Light.NoActionBar" parent="android:Theme.DeviceDefault.Light">
+        <item name="android:windowActionBar">false</item>
+        <item name="android:windowNoTitle">true</item>
+        <item name="android:windowLayoutInDisplayCutoutMode">always</item>
+        <item name="android:isLightTheme">false</item>
+    </style>
+    <style name="Theme.DeviceDefault.NoActionBar" parent="android:Theme.DeviceDefault">
+        <item name="android:windowActionBar">false</item>
+        <item name="android:windowNoTitle">true</item>
+        <item name="android:windowLayoutInDisplayCutoutMode">always</item>
+        <item name="android:isLightTheme">false</item>
+    </style>
+
+    <style name="Theme.DeviceDefault.InputMethod" parent="android:Theme.Material.InputMethod">
+        <!-- Color palette -->
+        <item name="android:colorAccent">@color/car_primary</item>
+        <item name="android:colorBackground">@color/car_background</item>
+        <item name="android:listDivider">@*android:color/car_keyboard_divider_line</item>
+        <item name="android:selectableItemBackground">@*android:drawable/item_background</item>
+        <item name="android:textColorPrimary">@*android:color/car_keyboard_text_primary_color</item>
+        <item name="android:textColorSecondary">@*android:color/car_keyboard_text_secondary_color</item>
+    </style>
+
+    <style name="Theme.DeviceDefault.Settings" parent="android:Theme.DeviceDefault"/>
+    <style name="Theme.DeviceDefault.Settings.NoActionBar" parent="android:Theme.DeviceDefault.NoActionBar"/>
+
+    <!-- This theme is applied as the app base. Attributes not defined in app/ activity themes will fallthrough to this
+    theme. This makes it app facing, regardless if the app is directly using it or a theme that inherits from it.  -->
+    <style name="Theme.DeviceDefault.Light.DarkActionBar"  parent="Theme.DeviceDefaultBaseCar">
+        <item name="android:isLightTheme">false</item>
+    </style>
+
+    <!-- DeviceDefault theme for the default system theme.  -->
+    <style name="Theme.DeviceDefault.System" parent="android:Theme.DeviceDefault.Light.DarkActionBar" />
+
+    <!-- Theme used for the intent picker activity. -->
+    <style name="Theme.DeviceDefault.Resolver" parent="android:Theme.DeviceDefault">
+        <item name="android:windowEnterTransition">@empty</item>
+        <item name="android:windowExitTransition">@empty</item>
+        <item name="android:windowIsTranslucent">true</item>
+        <item name="android:windowNoTitle">true</item>
+        <item name="android:windowBackground">@android:color/transparent</item>
+        <item name="android:backgroundDimEnabled">true</item>
+        <item name="android:statusBarColor">@android:color/transparent</item>
+        <item name="android:windowContentOverlay">@null</item>
+        <item name="android:colorControlActivated">?*android:attr/colorControlHighlight</item>
+        <item name="android:listPreferredItemPaddingStart">?*android:attr/dialogPreferredPadding</item>
+        <item name="android:listPreferredItemPaddingEnd">?*android:attr/dialogPreferredPadding</item>
+
+        <!-- Dialog attributes -->
+        <item name="android:dialogCornerRadius">@*android:dimen/config_dialogCornerRadius</item>
+        <item name="android:alertDialogTheme">@android:style/Theme.DeviceDefault.Light.Dialog.Alert</item>
+
+        <!-- Button styles -->
+        <item name="android:buttonCornerRadius">@*android:dimen/config_buttonCornerRadius</item>
+        <item name="android:buttonBarButtonStyle">@*android:style/Widget.DeviceDefault.Button.ButtonBar.AlertDialog</item>
+        <item name="android:borderlessButtonStyle">@*android:style/Widget.DeviceDefault.Button.Borderless.Colored</item>
+        <item name="android:buttonStyle">@*android:style/Widget.DeviceDefault.Button</item>
+
+        <!-- Color palette -->
+        <item name="android:colorPrimary">@color/car_primary</item>
+        <item name="android:colorPrimaryDark">@color/car_primary</item>
+        <item name="android:colorAccent">@color/car_primary</item>
+        <item name="android:colorError">@*android:color/error_color_device_default_light</item>
+        <item name="android:colorBackgroundFloating">@color/car_background</item>
+        <item name="android:colorButtonNormal">@color/btn_device_default</item>
+        <item name="android:colorControlHighlight">@color/car_control_highlight</item>
+        <item name="android:colorControlNormal">@color/btn_device_default</item>
+        <item name="android:colorForeground">@color/car_on_background</item>
+        <item name="android:editTextColor">@color/car_on_surface</item>
+        <item name="android:textColorHint">@*android:color/car_body2</item>
+        <item name="android:textColorPrimary">@color/car_on_background</item>
+        <item name="android:textColorSecondary">@color/car_secondary</item>
+
+        <!-- Progress bar attributes -->
+        <item name="*android:colorProgressBackgroundNormal">@*android:color/config_progress_background_tint</item>
+        <item name="*android:progressBarCornerRadius">@*android:dimen/config_progressBarCornerRadius</item>
+
+        <!-- Toolbar attributes -->
+        <item name="android:toolbarStyle">@*android:style/Widget.DeviceDefault.Toolbar</item>
+
+        <item name="*android:toastFrameBackground">@drawable/toast_frame</item>
+        <item name="android:textAppearanceListItem">@android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceListItemSmall">@android:style/TextAppearance.DeviceDefault.Large</item>
+        <item name="android:textAppearanceListItemSecondary">@android:style/TextAppearance.DeviceDefault.Small</item>
+
+        <!-- Icon sizes -->
+        <item name="*android:iconfactoryIconSize">@*android:dimen/resolver_icon_size</item>
+        <item name="*android:iconfactoryBadgeSize">@*android:dimen/resolver_badge_size</item>
+    </style>
+
+
+    <!-- DeviceDefault theme for windows that want to have the user's selected wallpaper appear
+    behind them. -->
+    <style name="Theme.DeviceDefault.Wallpaper" parent="android:Theme.DeviceDefault">
+        <!-- Color palette -->
+        <item name="android:colorPrimary">@color/car_primary</item>
+        <item name="android:colorPrimaryDark">@color/car_primary</item>
+        <item name="android:colorAccent">@color/car_primary</item>
+        <item name="android:colorError">@*android:color/error_color_device_default_dark</item>
+
+        <!-- Dialog attributes -->
+        <item name="android:dialogCornerRadius">@*android:dimen/config_dialogCornerRadius</item>
+        <item name="android:alertDialogTheme">@*android:style/Theme.DeviceDefault.Dialog.Alert</item>
+
+        <!-- Text styles -->
+        <item name="android:textAppearanceButton">@*android:style/TextAppearance.DeviceDefault.Widget.Button</item>
+
+        <!-- Button styles -->
+        <item name="android:buttonCornerRadius">@*android:dimen/config_buttonCornerRadius</item>
+        <item name="android:buttonBarButtonStyle">@*android:style/Widget.DeviceDefault.Button.ButtonBar.AlertDialog</item>
+
+        <!-- Progress bar attributes -->
+        <item name="*android:colorProgressBackgroundNormal">@*android:color/config_progress_background_tint</item>
+        <item name="*android:progressBarCornerRadius">@*android:dimen/config_progressBarCornerRadius</item>
+
+        <!-- Toolbar attributes -->
+        <item name="android:toolbarStyle">@*android:style/Widget.DeviceDefault.Toolbar</item>
+
+        <item name="android:windowBackground">@*android:color/transparent</item>
+        <item name="android:colorBackgroundCacheHint">@null</item>
+        <item name="android:windowShowWallpaper">true</item>
+    </style>
+
+    <!-- DeviceDefault theme for windows that want to have the user's selected wallpaper appear
+    behind them and without an action bar. -->
+    <style name="Theme.DeviceDefault.Wallpaper.NoTitleBar" parent="android:Theme.DeviceDefault.Wallpaper">
+        <!-- Color palette -->
+        <item name="android:colorPrimary">@color/car_primary</item>
+        <item name="android:colorPrimaryDark">@color/car_primary</item>
+        <item name="android:colorAccent">@color/car_primary</item>
+        <item name="android:colorError">@*android:color/error_color_device_default_dark</item>
+
+        <!-- Dialog attributes -->
+        <item name="android:dialogCornerRadius">@*android:dimen/config_dialogCornerRadius</item>
+        <item name="android:alertDialogTheme">@*android:style/Theme.DeviceDefault.Dialog.Alert</item>
+
+        <!-- Text styles -->
+        <item name="android:textAppearanceButton">@*android:style/TextAppearance.DeviceDefault.Widget.Button</item>
+
+        <!-- Button styles -->
+        <item name="android:buttonCornerRadius">@*android:dimen/config_buttonCornerRadius</item>
+        <item name="android:buttonBarButtonStyle">@*android:style/Widget.DeviceDefault.Button.ButtonBar.AlertDialog</item>
+
+        <!-- Progress bar attributes -->
+        <item name="*android:colorProgressBackgroundNormal">@*android:color/config_progress_background_tint</item>
+        <item name="*android:progressBarCornerRadius">@*android:dimen/config_progressBarCornerRadius</item>
+
+        <!-- Toolbar attributes -->
+        <item name="android:toolbarStyle">@*android:style/Widget.DeviceDefault.Toolbar</item>
+
+        <item name="android:windowNoTitle">true</item>
+    </style>
+
+    <!-- DeviceDefault theme for panel windows. This removes all extraneous window decorations, so
+    you basically have an empty rectangle in which to place your content. It makes the window
+    floating, with a transparent background, and turns off dimming behind the window.
+    Used for Autofill screens.-->
+    <style name="Theme.DeviceDefault.Panel" parent="android:Theme.Material.Panel">
+        <!-- Color palette -->
+        <item name="android:colorPrimary">@color/car_primary</item>
+        <item name="android:colorPrimaryDark">@color/car_primary</item>
+        <item name="android:colorAccent">@color/car_primary</item>
+        <item name="android:colorError">@*android:color/error_color_device_default_light</item>
+
+        <!-- Dialog attributes -->
+        <item name="android:dialogCornerRadius">@*android:dimen/config_dialogCornerRadius</item>
+        <item name="android:alertDialogTheme">@*android:style/Theme.DeviceDefault.Dialog.Alert</item>
+
+        <!-- Text styles -->
+        <item name="android:textAppearanceButton">@*android:style/TextAppearance.DeviceDefault.Widget.Button</item>
+
+        <!-- Button styles -->
+        <item name="android:buttonCornerRadius">@*android:dimen/config_buttonCornerRadius</item>
+        <item name="android:buttonBarButtonStyle">@*android:style/Widget.DeviceDefault.Button.ButtonBar.AlertDialog</item>
+
+        <!-- Progress bar attributes -->
+        <item name="*android:colorProgressBackgroundNormal">@*android:color/config_progress_background_tint</item>
+        <item name="*android:progressBarCornerRadius">@*android:dimen/config_progressBarCornerRadius</item>
+
+        <!-- Toolbar attributes -->
+        <item name="android:toolbarStyle">@*android:style/Widget.DeviceDefault.Toolbar</item>
+
+        <!-- Hide action bar -->
+        <item name="android:windowActionBar">false</item>
+        <item name="android:windowNoTitle">true</item>
+
+        <item name="android:selectableItemBackground">@*android:drawable/item_background</item>
+    </style>
+
+    <style name="Theme.DeviceDefault.Light.Panel" parent="android:Theme.DeviceDefault.Panel"/>
+
+    <style name="Theme.DeviceDefault.SystemUI" parent="android:Theme.DeviceDefault.Light">
+        <item name="*android:materialColorOnSurface">@*android:color/text_color_primary</item>
+        <item name="*android:materialColorOnSecondaryFixed">@*android:color/text_color_primary</item>
+        <item name="*android:materialColorSurfaceContainer">@android:color/black</item>
+    </style>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/Android.bp b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/Android.bp
new file mode 100644
index 0000000000..1b512c5918
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/Android.bp
@@ -0,0 +1,55 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+android_app {
+    name: "OEMDesignTokenRRO",
+    resource_dirs: ["src/main/res"],
+    manifest: "src/main/AndroidManifest.xml",
+    sdk_version: "current",
+    aaptflags: [
+        "--no-resource-deduping",
+        "--no-resource-removal",
+    ],
+    libs: [
+        "token-shared-lib-prebuilt",
+    ],
+    enforce_uses_libs: false,
+    static_libs: [
+        "OEMDesignTokenBase",
+    ],
+    dex_preopt: {
+        enabled: false,
+    },
+}
+
+android_app {
+    name: "NorthStarRRO",
+    resource_dirs: ["src/main/res"],
+    manifest: "src/main/AndroidManifest.xml",
+    sdk_version: "current",
+    aaptflags: [
+        "--no-resource-deduping",
+        "--no-resource-removal",
+    ],
+    libs: [
+        "token-shared-lib-prebuilt",
+    ],
+    enforce_uses_libs: false,
+    static_libs: [
+        "NorthStarBase",
+    ],
+    dex_preopt: {
+        enabled: false,
+    },
+}
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/build.gradle b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/build.gradle
new file mode 100644
index 0000000000..2beefc629a
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/build.gradle
@@ -0,0 +1,39 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+apply plugin: 'com.android.application'
+
+android {
+    namespace 'oem.brand.model.rro'
+    compileSdkVersion gradle.ext.aaosLatestSDK
+    defaultConfig {
+        applicationId "oem.brand.model.rro"
+        minSdkVersion 28
+        targetSdkVersion gradle.ext.aaosTargetSDK
+        versionCode gradle.ext.getVersionCode()
+        versionName gradle.ext.getVersionName()
+    }
+
+    compileOptions {
+        sourceCompatibility JavaVersion.VERSION_1_8
+        targetCompatibility JavaVersion.VERSION_1_8
+    }
+}
+
+dependencies {}
+
+android.aaptOptions.additionalParameters "--no-resource-deduping", "--no-resource-removal", "-I", "${projectDir}/../shared-lib/prebuilt/token-shared-lib.apk"
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/AndroidManifest.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/AndroidManifest.xml
new file mode 100644
index 0000000000..a10976e111
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/AndroidManifest.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+          package="oem.brand.model.rro" android:versionCode="66">
+    <application android:hasCode="false"/>
+    <overlay android:priority="2001"
+             android:targetPackage="oem.demo.sharedlib"
+             android:resourcesMap="@xml/overlays"/>
+</manifest>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/values/bools.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/values/bools.xml
new file mode 100644
index 0000000000..c126c3d4ae
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/values/bools.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<resources>
+    <bool name="enable_oem_tokens">true</bool>
+</resources>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/values/styles.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/values/styles.xml
new file mode 100644
index 0000000000..e2892f4fea
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/values/styles.xml
@@ -0,0 +1,142 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+ Licensed under the Apache License, Version 2.0 (the "License");
+ you may not use this file except in compliance with the License.
+ You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+<resources>
+    <style name="OemStyle">
+        <item name="com.android.oem.tokens:colorPrimary">@color/color_primary</item>
+        <item name="com.android.oem.tokens:colorOnPrimary">@color/color_on_primary</item>
+        <item name="com.android.oem.tokens:colorPrimaryContainer">@color/color_primary_container</item>
+        <item name="com.android.oem.tokens:colorOnPrimaryContainer">@color/color_on_primary_container</item>
+        <item name="com.android.oem.tokens:colorSecondary">@color/color_secondary</item>
+        <item name="com.android.oem.tokens:colorOnSecondary">@color/color_on_secondary</item>
+        <item name="com.android.oem.tokens:colorSecondaryContainer">@color/color_secondary_container</item>
+        <item name="com.android.oem.tokens:colorOnSecondaryContainer">@color/color_on_secondary_container</item>
+        <item name="com.android.oem.tokens:colorTertiary">@color/color_tertiary</item>
+        <item name="com.android.oem.tokens:colorOnTertiary">@color/color_on_tertiary</item>
+        <item name="com.android.oem.tokens:colorTertiaryContainer">@color/color_tertiary_container</item>
+        <item name="com.android.oem.tokens:colorOnTertiaryContainer">@color/color_on_tertiary_container</item>
+        <item name="com.android.oem.tokens:colorError">@color/color_error</item>
+        <item name="com.android.oem.tokens:colorOnError">@color/color_on_error</item>
+        <item name="com.android.oem.tokens:colorErrorContainer">@color/color_error_container</item>
+        <item name="com.android.oem.tokens:colorOnErrorContainer">@color/color_on_error_container</item>
+        <item name="com.android.oem.tokens:colorOutline">@color/color_outline</item>
+        <item name="com.android.oem.tokens:colorBackground">@color/color_background</item>
+        <item name="com.android.oem.tokens:colorOnBackground">@color/color_on_background</item>
+        <item name="com.android.oem.tokens:colorSurface">@color/color_surface</item>
+        <item name="com.android.oem.tokens:colorOnSurface">@color/color_on_surface</item>
+        <item name="com.android.oem.tokens:colorSurfaceVariant">@color/color_surface_variant</item>
+        <item name="com.android.oem.tokens:colorOnSurfaceVariant">@color/color_on_surface_variant</item>
+        <item name="com.android.oem.tokens:colorSurfaceInverse">@color/color_surface_inverse</item>
+        <item name="com.android.oem.tokens:colorOnSurfaceInverse">@color/color_on_surface_inverse</item>
+        <item name="com.android.oem.tokens:colorPrimaryInverse">@color/color_primary_inverse</item>
+        <item name="com.android.oem.tokens:colorSurfaceTint">@color/color_surface_tint</item>
+        <item name="com.android.oem.tokens:colorOutlineVariant">@color/color_outline_variant</item>
+        <item name="com.android.oem.tokens:colorScrim">@color/color_scrim</item>
+
+        <item name="com.android.oem.tokens:colorPrimaryPalette0">@color/color_primary_palette_0</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette10">@color/color_primary_palette_10</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette20">@color/color_primary_palette_20</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette30">@color/color_primary_palette_30</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette40">@color/color_primary_palette_40</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette50">@color/color_primary_palette_50</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette60">@color/color_primary_palette_60</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette70">@color/color_primary_palette_70</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette80">@color/color_primary_palette_80</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette90">@color/color_primary_palette_90</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette95">@color/color_primary_palette_95</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette99">@color/color_primary_palette_99</item>
+        <item name="com.android.oem.tokens:colorPrimaryPalette100">@color/color_primary_palette_100</item>
+
+        <item name="com.android.oem.tokens:colorSecondaryPalette0">@color/color_secondary_palette_0</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette10">@color/color_secondary_palette_10</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette20">@color/color_secondary_palette_20</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette30">@color/color_secondary_palette_30</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette40">@color/color_secondary_palette_40</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette50">@color/color_secondary_palette_50</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette60">@color/color_secondary_palette_60</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette70">@color/color_secondary_palette_70</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette80">@color/color_secondary_palette_80</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette90">@color/color_secondary_palette_90</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette95">@color/color_secondary_palette_95</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette99">@color/color_secondary_palette_99</item>
+        <item name="com.android.oem.tokens:colorSecondaryPalette100">@color/color_secondary_palette_100</item>
+
+        <item name="com.android.oem.tokens:colorTertiaryPalette0">@color/color_tertiary_palette_0</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette10">@color/color_tertiary_palette_10</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette20">@color/color_tertiary_palette_20</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette30">@color/color_tertiary_palette_30</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette40">@color/color_tertiary_palette_40</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette50">@color/color_tertiary_palette_50</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette60">@color/color_tertiary_palette_60</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette70">@color/color_tertiary_palette_70</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette80">@color/color_tertiary_palette_80</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette90">@color/color_tertiary_palette_90</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette95">@color/color_tertiary_palette_95</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette99">@color/color_tertiary_palette_99</item>
+        <item name="com.android.oem.tokens:colorTertiaryPalette100">@color/color_tertiary_palette_100</item>
+
+        <item name="com.android.oem.tokens:colorNeutralPalette0">@color/color_neutral_palette_0</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette10">@color/color_neutral_palette_10</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette20">@color/color_neutral_palette_20</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette30">@color/color_neutral_palette_30</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette40">@color/color_neutral_palette_40</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette50">@color/color_neutral_palette_50</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette60">@color/color_neutral_palette_60</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette70">@color/color_neutral_palette_70</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette80">@color/color_neutral_palette_80</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette90">@color/color_neutral_palette_90</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette95">@color/color_neutral_palette_95</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette99">@color/color_neutral_palette_99</item>
+        <item name="com.android.oem.tokens:colorNeutralPalette100">@color/color_neutral_palette_100</item>
+
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette0">@color/color_neutral_variant_palette_0</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette10">@color/color_neutral_variant_palette_10</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette20">@color/color_neutral_variant_palette_20</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette30">@color/color_neutral_variant_palette_30</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette40">@color/color_neutral_variant_palette_40</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette50">@color/color_neutral_variant_palette_50</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette60">@color/color_neutral_variant_palette_60</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette70">@color/color_neutral_variant_palette_70</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette80">@color/color_neutral_variant_palette_80</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette90">@color/color_neutral_variant_palette_90</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette95">@color/color_neutral_variant_palette_95</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette99">@color/color_neutral_variant_palette_99</item>
+        <item name="com.android.oem.tokens:colorNeutralVariantPalette100">@color/color_neutral_variant_palette_100</item>
+
+        <item name="com.android.oem.tokens:textAppearanceDisplayLarge">@style/TextAppearance.Display.Large</item>
+        <item name="com.android.oem.tokens:textAppearanceDisplayMedium">@style/TextAppearance.Display.Medium</item>
+        <item name="com.android.oem.tokens:textAppearanceDisplaySmall">@style/TextAppearance.Display.Small</item>
+        <item name="com.android.oem.tokens:textAppearanceHeadlineLarge">@style/TextAppearance.Headline.Large</item>
+        <item name="com.android.oem.tokens:textAppearanceHeadlineMedium">@style/TextAppearance.Headline.Medium</item>
+        <item name="com.android.oem.tokens:textAppearanceHeadlineSmall">@style/TextAppearance.Headline.Small</item>
+        <item name="com.android.oem.tokens:textAppearanceTitleLarge">@style/TextAppearance.Title.Large</item>
+        <item name="com.android.oem.tokens:textAppearanceTitleMedium">@style/TextAppearance.Title.Medium</item>
+        <item name="com.android.oem.tokens:textAppearanceTitleSmall">@style/TextAppearance.Title.Small</item>
+        <item name="com.android.oem.tokens:textAppearanceLabelLarge">@style/TextAppearance.Label.Large</item>
+        <item name="com.android.oem.tokens:textAppearanceLabelMedium">@style/TextAppearance.Label.Medium</item>
+        <item name="com.android.oem.tokens:textAppearanceLabelSmall">@style/TextAppearance.Label.Small</item>
+        <item name="com.android.oem.tokens:textAppearanceBodyLarge">@style/TextAppearance.Body.Large</item>
+        <item name="com.android.oem.tokens:textAppearanceBodyMedium">@style/TextAppearance.Body.Medium</item>
+        <item name="com.android.oem.tokens:textAppearanceBodySmall">@style/TextAppearance.Body.Small</item>
+
+        <item name="com.android.oem.tokens:shapeCornerNone">@dimen/shape_corner_none</item>
+        <item name="com.android.oem.tokens:shapeCornerExtraSmall">@dimen/shape_corner_extra_small</item>
+        <item name="com.android.oem.tokens:shapeCornerSmall">@dimen/shape_corner_small</item>
+        <item name="com.android.oem.tokens:shapeCornerMedium">@dimen/shape_corner_medium</item>
+        <item name="com.android.oem.tokens:shapeCornerLarge">@dimen/shape_corner_large</item>
+        <item name="com.android.oem.tokens:shapeCornerExtraLarge">@dimen/shape_corner_extra_large</item>
+        <item name="com.android.oem.tokens:shapeCornerFull">@dimen/shape_corner_full</item>
+    </style>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/xml/overlays.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/xml/overlays.xml
new file mode 100644
index 0000000000..15dbba5c62
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenRRO/src/main/res/xml/overlays.xml
@@ -0,0 +1,19 @@
+<?xml version='1.0' encoding='UTF-8'?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<overlay>
+      <item target="bool/enable_oem_tokens" value="@bool/enable_oem_tokens"/>
+      <item target="style/OemStyle" value="@style/OemStyle"/>
+</overlay>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenShim/Android.bp b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/Android.bp
new file mode 100644
index 0000000000..93f9137ed8
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/Android.bp
@@ -0,0 +1,33 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+android_library {
+    name: "OEMDesignTokenShim",
+    resource_dirs: ["src/main/res"],
+    manifest: "src/main/AndroidManifest.xml",
+    sdk_version: "current",
+    static_libs: [
+        "OEMDesignTokenBase",
+    ],
+}
+
+android_library {
+    name: "NorthStarShim",
+    resource_dirs: ["src/main/res"],
+    manifest: "src/main/AndroidManifest.xml",
+    sdk_version: "current",
+    static_libs: [
+        "NorthStarBase",
+    ],
+}
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/AndroidManifest.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/AndroidManifest.xml
new file mode 100644
index 0000000000..a1e56dda26
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/AndroidManifest.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+          package="oem.brand.model.base.shim">
+</manifest>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/colors.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/colors.xml
new file mode 100644
index 0000000000..a20f41a193
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/colors.xml
@@ -0,0 +1,395 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<resources>
+    <!-- primary colors -->
+    <color name="car_primary">@color/color_primary</color>
+    <color name="car_on_primary">@color/color_on_primary</color>
+    <color name="car_primary_container">@color/color_primary_container</color>
+    <color name="car_on_primary_container">@color/color_on_primary_container</color>
+
+    <!-- secondary colors -->
+    <color name="car_secondary">@color/color_secondary</color>
+    <color name="car_on_secondary">@color/color_on_secondary</color>
+    <color name="car_secondary_container">@color/color_secondary_container</color>
+    <color name="car_on_secondary_container">@color/color_on_secondary_container</color>
+
+    <!-- tertiary colors -->
+    <color name="car_tertiary">@color/color_tertiary</color>
+    <color name="car_on_tertiary">@color/color_on_tertiary</color>
+    <color name="car_tertiary_container">@color/color_tertiary_container</color>
+    <color name="car_on_tertiary_container">@color/color_on_tertiary_container</color>
+
+    <!-- text colors, auto specific -->
+    <color name="car_text_primary">@color/car_neutral_95</color>
+    <color name="car_text_secondary">@color/car_neutral_variant_70</color>
+
+    <!-- error colors -->
+    <color name="car_error">@color/color_error</color>
+    <color name="car_on_error">@color/color_on_error</color>
+    <color name="car_error_container">@color/color_error_container</color>
+    <color name="car_on_error_container">@color/color_on_error_container</color>
+
+    <!-- background colors -->
+    <color name="car_background">@color/color_background</color>
+    <color name="car_on_background">@color/color_on_background</color>
+
+    <!-- surface colors -->
+    <color name="car_surface">@color/color_surface</color>
+    <color name="car_on_surface">@color/color_on_surface</color>
+    <color name="car_surface_dim">@color/car_neutral_6</color>
+    <color name="car_surface_bright">@color/car_neutral_24</color>
+    <color name="car_inverse_surface">@color/color_surface_inverse</color>
+    <color name="car_inverse_on_surface">@color/color_on_surface_inverse</color>
+    <color name="car_surface_container">@color/car_neutral_12</color>
+    <color name="car_surface_container_low">@color/car_neutral_10</color>
+    <color name="car_surface_container_lowest">@color/car_neutral_4</color>
+    <color name="car_surface_container_high">@color/car_neutral_17</color>
+    <color name="car_surface_container_highest">@color/car_neutral_22</color>
+    <color name="car_surface_variant">@color/color_surface_variant</color>
+    <color name="car_on_surface_variant">@color/color_on_surface_variant</color>
+    <color name="car_outline">@color/car_neutral_variant_60</color>
+    <color name="car_outline_variant">@color/car_neutral_variant_30</color>
+    <color name="car_scrim">@color/car_neutral_0</color>
+    <color name="car_shadow">@color/car_neutral_0</color>
+    <color name="car_inverse_primary">@color/car_primary_40</color>
+    <color name="car_surface_1">#222429</color>
+    <color name="car_surface_2">#272930</color>
+    <color name="car_surface_3">#2b2e37</color>
+    <color name="car_surface_4">#2d2f39</color>
+    <color name="car_surface_5">#30333e</color>
+
+    <!-- red colors -->
+    <color name="car_red_color">@color/car_red_70</color>
+    <color name="car_red_on_color">@color/car_red_10</color>
+    <color name="car_red_color_container">@color/car_red_30</color>
+    <color name="car_red_on_color_container">@color/car_red_90</color>
+    <color name="car_red_tint">#dc362e</color>
+    <color name="car_decline_red">#d77163</color>
+    <color name="car_on_decline_red">#1c0f0d</color>
+
+    <!-- blue colors -->
+    <color name="car_blue_color">@color/car_blue_70</color>
+    <color name="car_blue_on_color">@color/car_blue_10</color>
+    <color name="car_blue_color_container">@color/car_blue_30</color>
+    <color name="car_blue_on_color_container">@color/car_blue_90</color>
+    <color name="car_blue_tint">#4285f4</color>
+
+    <!-- green colors -->
+    <color name="car_green_color">@color/car_green_70</color>
+    <color name="car_green_on_color">@color/car_green_10</color>
+    <color name="car_green_color_container">@color/car_green_30</color>
+    <color name="car_green_on_color_container">@color/car_green_90</color>
+    <color name="car_green_tint">#37be5f</color>
+    <color name="car_confirm_green">#75b885</color>
+    <color name="car_on_confirm_green">#0f1811</color>
+
+    <!-- yellow colors -->
+    <color name="car_yellow_color">@color/car_yellow_70</color>
+    <color name="car_yellow_on_color">@color/car_yellow_10</color>
+    <color name="car_yellow_color_container">@color/car_yellow_30</color>
+    <color name="car_yellow_on_color_container">@color/car_yellow_90</color>
+    <color name="car_yellow_tint">#fbbc04</color>
+
+    <!-- control highlight colors -->
+    <color name="car_control_highlight">#99d9e2ff</color>
+
+    <!-- indicator colors -->
+    <color name = "car_icon_indicator_color">@color/car_red_tint</color>
+
+    <!-- control focus colors -->
+    <color name="car_focus_ring">@color/car_primary</color>
+    <color name="car_focus_background">#99b0c5ff</color>
+
+    <!-- TODO(b/302163073) - update rotary specs -->
+    <!-- Rotary Colors -->
+    <color name="car_rotary_focus_stroke_color">#94CBFF</color>
+    <color name="car_rotary_focus_fill_color">#3D94CBFF</color>
+    <color name="car_rotary_focus_pressed_fill_color">#8A94CBFF</color>
+
+    <!-- primary colors -->
+    <color name="car_primary_0">@color/color_primary_palette_0</color>
+    <color name="car_primary_10">@color/color_primary_palette_10</color>
+    <color name="car_primary_20">@color/color_primary_palette_20</color>
+    <color name="car_primary_30">@color/color_primary_palette_30</color>
+    <color name="car_primary_40">@color/color_primary_palette_40</color>
+    <color name="car_primary_50">@color/color_primary_palette_50</color>
+    <color name="car_primary_60">@color/color_primary_palette_60</color>
+    <color name="car_primary_70">@color/color_primary_palette_70</color>
+    <color name="car_primary_80">@color/color_primary_palette_80</color>
+    <color name="car_primary_90">@color/color_primary_palette_90</color>
+    <color name="car_primary_95">@color/color_primary_palette_95</color>
+    <color name="car_primary_98">@color/color_primary_palette_99</color>
+    <color name="car_primary_100">@color/color_primary_palette_100</color>
+
+    <color name="car_primary_2">@color/color_primary_palette_0</color>
+    <color name="car_primary_4">@color/color_primary_palette_0</color>
+    <color name="car_primary_5">@color/color_primary_palette_10</color>
+    <color name="car_primary_6">@color/color_primary_palette_10</color>
+    <color name="car_primary_12">@color/color_primary_palette_10</color>
+    <color name="car_primary_17">@color/color_primary_palette_20</color>
+    <color name="car_primary_22">@color/color_primary_palette_20</color>
+    <color name="car_primary_24">@color/color_primary_palette_20</color>
+    <color name="car_primary_85">@color/color_primary_palette_90</color>
+    <color name="car_primary_87">@color/color_primary_palette_90</color>
+    <color name="car_primary_88">@color/color_primary_palette_90</color>
+    <color name="car_primary_92">@color/color_primary_palette_90</color>
+    <color name="car_primary_94">@color/color_primary_palette_90</color>
+
+    <!-- secondary colors -->
+    <color name="car_secondary_0">@color/color_secondary_palette_0</color>
+    <color name="car_secondary_10">@color/color_secondary_palette_10</color>
+    <color name="car_secondary_20">@color/color_secondary_palette_20</color>
+    <color name="car_secondary_30">@color/color_secondary_palette_30</color>
+    <color name="car_secondary_40">@color/color_secondary_palette_40</color>
+    <color name="car_secondary_50">@color/color_secondary_palette_50</color>
+    <color name="car_secondary_60">@color/color_secondary_palette_60</color>
+    <color name="car_secondary_70">@color/color_secondary_palette_70</color>
+    <color name="car_secondary_80">@color/color_secondary_palette_80</color>
+    <color name="car_secondary_90">@color/color_secondary_palette_90</color>
+    <color name="car_secondary_95">@color/color_secondary_palette_95</color>
+    <color name="car_secondary_98">@color/color_secondary_palette_99</color>
+    <color name="car_secondary_100">@color/color_secondary_palette_100</color>
+
+    <color name="car_secondary_2">@color/color_secondary_palette_0</color>
+    <color name="car_secondary_4">@color/color_secondary_palette_0</color>
+    <color name="car_secondary_5">@color/color_secondary_palette_10</color>
+    <color name="car_secondary_6">@color/color_secondary_palette_10</color>
+    <color name="car_secondary_12">@color/color_secondary_palette_10</color>
+    <color name="car_secondary_17">@color/color_secondary_palette_20</color>
+    <color name="car_secondary_22">@color/color_secondary_palette_20</color>
+    <color name="car_secondary_24">@color/color_secondary_palette_20</color>
+    <color name="car_secondary_85">@color/color_secondary_palette_90</color>
+    <color name="car_secondary_87">@color/color_secondary_palette_90</color>
+    <color name="car_secondary_88">@color/color_secondary_palette_90</color>
+    <color name="car_secondary_92">@color/color_secondary_palette_90</color>
+    <color name="car_secondary_94">@color/color_secondary_palette_90</color>
+
+    <!-- tertiary colors -->
+    <color name="car_tertiary_0">@color/color_tertiary_palette_0</color>
+    <color name="car_tertiary_10">@color/color_tertiary_palette_10</color>
+    <color name="car_tertiary_20">@color/color_tertiary_palette_20</color>
+    <color name="car_tertiary_30">@color/color_tertiary_palette_30</color>
+    <color name="car_tertiary_40">@color/color_tertiary_palette_40</color>
+    <color name="car_tertiary_50">@color/color_tertiary_palette_50</color>
+    <color name="car_tertiary_60">@color/color_tertiary_palette_60</color>
+    <color name="car_tertiary_70">@color/color_tertiary_palette_70</color>
+    <color name="car_tertiary_80">@color/color_tertiary_palette_80</color>
+    <color name="car_tertiary_90">@color/color_tertiary_palette_90</color>
+    <color name="car_tertiary_95">@color/color_tertiary_palette_95</color>
+    <color name="car_tertiary_98">@color/color_tertiary_palette_99</color>
+    <color name="car_tertiary_100">@color/color_tertiary_palette_100</color>
+
+    <color name="car_tertiary_2">@color/color_tertiary_palette_0</color>
+    <color name="car_tertiary_4">@color/color_tertiary_palette_0</color>
+    <color name="car_tertiary_5">@color/color_tertiary_palette_10</color>
+    <color name="car_tertiary_6">@color/color_tertiary_palette_10</color>
+    <color name="car_tertiary_12">@color/color_tertiary_palette_10</color>
+    <color name="car_tertiary_17">@color/color_tertiary_palette_20</color>
+    <color name="car_tertiary_22">@color/color_tertiary_palette_20</color>
+    <color name="car_tertiary_24">@color/color_tertiary_palette_20</color>
+    <color name="car_tertiary_85">@color/color_tertiary_palette_90</color>
+    <color name="car_tertiary_87">@color/color_tertiary_palette_90</color>
+    <color name="car_tertiary_88">@color/color_tertiary_palette_90</color>
+    <color name="car_tertiary_92">@color/color_tertiary_palette_90</color>
+    <color name="car_tertiary_94">@color/color_tertiary_palette_90</color>
+
+    <!-- neutral colors -->
+    <color name="car_neutral_0">@color/color_neutral_palette_0</color>
+    <color name="car_neutral_10">@color/color_neutral_palette_10</color>
+    <color name="car_neutral_20">@color/color_neutral_palette_20</color>
+    <color name="car_neutral_30">@color/color_neutral_palette_30</color>
+    <color name="car_neutral_40">@color/color_neutral_palette_40</color>
+    <color name="car_neutral_50">@color/color_neutral_palette_50</color>
+    <color name="car_neutral_60">@color/color_neutral_palette_60</color>
+    <color name="car_neutral_70">@color/color_neutral_palette_70</color>
+    <color name="car_neutral_80">@color/color_neutral_palette_80</color>
+    <color name="car_neutral_90">@color/color_neutral_palette_90</color>
+    <color name="car_neutral_95">@color/color_neutral_palette_95</color>
+    <color name="car_neutral_98">@color/color_neutral_palette_99</color>
+    <color name="car_neutral_100">@color/color_neutral_palette_100</color>
+
+    <color name="car_neutral_2">@color/color_neutral_palette_0</color>
+    <color name="car_neutral_4">@color/color_neutral_palette_0</color>
+    <color name="car_neutral_5">@color/color_neutral_palette_10</color>
+    <color name="car_neutral_6">@color/color_neutral_palette_10</color>
+    <color name="car_neutral_12">@color/color_neutral_palette_10</color>
+    <color name="car_neutral_17">@color/color_neutral_palette_20</color>
+    <color name="car_neutral_22">@color/color_neutral_palette_20</color>
+    <color name="car_neutral_24">@color/color_neutral_palette_20</color>
+    <color name="car_neutral_85">@color/color_neutral_palette_90</color>
+    <color name="car_neutral_87">@color/color_neutral_palette_90</color>
+    <color name="car_neutral_88">@color/color_neutral_palette_90</color>
+    <color name="car_neutral_92">@color/color_neutral_palette_90</color>
+    <color name="car_neutral_94">@color/color_neutral_palette_90</color>
+
+    <!-- neutral_variant colors -->
+    <color name="car_neutral_variant_0">@color/color_neutral_variant_palette_0</color>
+    <color name="car_neutral_variant_10">@color/color_neutral_variant_palette_10</color>
+    <color name="car_neutral_variant_20">@color/color_neutral_variant_palette_20</color>
+    <color name="car_neutral_variant_30">@color/color_neutral_variant_palette_30</color>
+    <color name="car_neutral_variant_40">@color/color_neutral_variant_palette_40</color>
+    <color name="car_neutral_variant_50">@color/color_neutral_variant_palette_50</color>
+    <color name="car_neutral_variant_60">@color/color_neutral_variant_palette_60</color>
+    <color name="car_neutral_variant_70">@color/color_neutral_variant_palette_70</color>
+    <color name="car_neutral_variant_80">@color/color_neutral_variant_palette_80</color>
+    <color name="car_neutral_variant_90">@color/color_neutral_variant_palette_90</color>
+    <color name="car_neutral_variant_95">@color/color_neutral_variant_palette_95</color>
+    <color name="car_neutral_variant_98">@color/color_neutral_variant_palette_99</color>
+    <color name="car_neutral_variant_100">@color/color_neutral_variant_palette_100</color>
+
+    <color name="car_neutral_variant_2">@color/color_neutral_variant_palette_0</color>
+    <color name="car_neutral_variant_4">@color/color_neutral_variant_palette_0</color>
+    <color name="car_neutral_variant_5">@color/color_neutral_variant_palette_10</color>
+    <color name="car_neutral_variant_6">@color/color_neutral_variant_palette_10</color>
+    <color name="car_neutral_variant_12">@color/color_neutral_variant_palette_10</color>
+    <color name="car_neutral_variant_17">@color/color_neutral_variant_palette_20</color>
+    <color name="car_neutral_variant_22">@color/color_neutral_variant_palette_20</color>
+    <color name="car_neutral_variant_24">@color/color_neutral_variant_palette_20</color>
+    <color name="car_neutral_variant_85">@color/color_neutral_variant_palette_90</color>
+    <color name="car_neutral_variant_87">@color/color_neutral_variant_palette_90</color>
+    <color name="car_neutral_variant_88">@color/color_neutral_variant_palette_90</color>
+    <color name="car_neutral_variant_92">@color/color_neutral_variant_palette_90</color>
+    <color name="car_neutral_variant_94">@color/color_neutral_variant_palette_90</color>
+
+    <!-- error colors -->
+    <color name="car_error_0">@color/color_error_palette_0</color>
+    <color name="car_error_10">@color/color_error_palette_10</color>
+    <color name="car_error_20">@color/color_error_palette_20</color>
+    <color name="car_error_30">@color/color_error_palette_30</color>
+    <color name="car_error_40">@color/color_error_palette_40</color>
+    <color name="car_error_50">@color/color_error_palette_50</color>
+    <color name="car_error_60">@color/color_error_palette_60</color>
+    <color name="car_error_70">@color/color_error_palette_70</color>
+    <color name="car_error_80">@color/color_error_palette_80</color>
+    <color name="car_error_90">@color/color_error_palette_90</color>
+    <color name="car_error_95">@color/color_error_palette_95</color>
+    <color name="car_error_98">@color/color_error_palette_99</color>
+    <color name="car_error_100">@color/color_error_palette_100</color>
+
+    <!-- red colors -->
+    <color name="car_red_0">#000000</color>
+    <color name="car_red_2">#1a0000</color>
+    <color name="car_red_4">#280001</color>
+    <color name="car_red_5">#2d0001</color>
+    <color name="car_red_6">#310001</color>
+    <color name="car_red_10">#410001</color>
+    <color name="car_red_12">#490002</color>
+    <color name="car_red_17">#5c0003</color>
+    <color name="car_red_20">#690004</color>
+    <color name="car_red_22">#710005</color>
+    <color name="car_red_24">#790005</color>
+    <color name="car_red_30">#930008</color>
+    <color name="car_red_40">#ba1b19</color>
+    <color name="car_red_50">#de372f</color>
+    <color name="car_red_60">#ff5448</color>
+    <color name="car_red_70">#ff897c</color>
+    <color name="car_red_80">#ffb4aa</color>
+    <color name="car_red_85">#ffc7c0</color>
+    <color name="car_red_87">#ffcfc9</color>
+    <color name="car_red_88">#ffd3cd</color>
+    <color name="car_red_90">#ffdad5</color>
+    <color name="car_red_92">#ffe2de</color>
+    <color name="car_red_94">#ffe9e6</color>
+    <color name="car_red_95">#ffedea</color>
+    <color name="car_red_98">#fff8f7</color>
+    <color name="car_red_100">#ffffff</color>
+
+    <!-- green colors -->
+    <color name="car_green_0">#000000</color>
+    <color name="car_green_2">#000a01</color>
+    <color name="car_green_4">#001203</color>
+    <color name="car_green_5">#001504</color>
+    <color name="car_green_6">#001804</color>
+    <color name="car_green_10">#002107</color>
+    <color name="car_green_12">#002609</color>
+    <color name="car_green_17">#00320f</color>
+    <color name="car_green_20">#003912</color>
+    <color name="car_green_22">#003e14</color>
+    <color name="car_green_24">#004316</color>
+    <color name="car_green_30">#00531d</color>
+    <color name="car_green_40">#006e29</color>
+    <color name="car_green_50">#1d893b</color>
+    <color name="car_green_60">#3ea453</color>
+    <color name="car_green_70">#5bbf6b</color>
+    <color name="car_green_80">#77dc83</color>
+    <color name="car_green_85">#84ea90</color>
+    <color name="car_green_87">#8af095</color>
+    <color name="car_green_88">#8df398</color>
+    <color name="car_green_90">#92f99d</color>
+    <color name="car_green_92">#98ffa2</color>
+    <color name="car_green_94">#b8ffba</color>
+    <color name="car_green_95">#c6ffc6</color>
+    <color name="car_green_98">#ebffe7</color>
+    <color name="car_green_100">#ffffff</color>
+
+    <!-- yellow colors -->
+    <color name="car_yellow_0">#000000</color>
+    <color name="car_yellow_2">#0e0600</color>
+    <color name="car_yellow_4">#180c00</color>
+    <color name="car_yellow_5">#1b0e00</color>
+    <color name="car_yellow_6">#1f1000</color>
+    <color name="car_yellow_10">#2a1800</color>
+    <color name="car_yellow_12">#2f1b00</color>
+    <color name="car_yellow_17">#3d2500</color>
+    <color name="car_yellow_20">#462b00</color>
+    <color name="car_yellow_22">#4c2e00</color>
+    <color name="car_yellow_24">#523200</color>
+    <color name="car_yellow_30">#643f00</color>
+    <color name="car_yellow_40">#845400</color>
+    <color name="car_yellow_50">#a56b00</color>
+    <color name="car_yellow_60">#c78200</color>
+    <color name="car_yellow_70">#eb9a00</color>
+    <color name="car_yellow_80">#ffb958</color>
+    <color name="car_yellow_85">#ffcb8a</color>
+    <color name="car_yellow_87">#ffd29c</color>
+    <color name="car_yellow_88">#ffd6a5</color>
+    <color name="car_yellow_90">#ffddb6</color>
+    <color name="car_yellow_92">#ffe4c6</color>
+    <color name="car_yellow_94">#ffebd5</color>
+    <color name="car_yellow_95">#ffeedd</color>
+    <color name="car_yellow_98">#fff8f4</color>
+    <color name="car_yellow_100">#ffffff</color>
+
+    <!-- blue colors -->
+    <color name="car_blue_0">#000000</color>
+    <color name="car_blue_2">#00061c</color>
+    <color name="car_blue_4">#000c2a</color>
+    <color name="car_blue_5">#000f30</color>
+    <color name="car_blue_6">#001135</color>
+    <color name="car_blue_10">#001945</color>
+    <color name="car_blue_12">#001d4d</color>
+    <color name="car_blue_17">#002662</color>
+    <color name="car_blue_20">#002c6f</color>
+    <color name="car_blue_22">#003178</color>
+    <color name="car_blue_24">#003581</color>
+    <color name="car_blue_30">#00419c</color>
+    <color name="car_blue_40">#0057cc</color>
+    <color name="car_blue_50">#1f70f5</color>
+    <color name="car_blue_60">#578cff</color>
+    <color name="car_blue_70">#86a9ff</color>
+    <color name="car_blue_80">#b0c6ff</color>
+    <color name="car_blue_85">#c5d4ff</color>
+    <color name="car_blue_87">#cdd9ff</color>
+    <color name="car_blue_88">#d1dcff</color>
+    <color name="car_blue_90">#d9e2ff</color>
+    <color name="car_blue_92">#e1e7ff</color>
+    <color name="car_blue_94">#eaedff</color>
+    <color name="car_blue_95">#eef0ff</color>
+    <color name="car_blue_98">#faf8ff</color>
+    <color name="car_blue_100">#ffffff</color>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/dimens.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/dimens.xml
new file mode 100644
index 0000000000..b107c998f0
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/dimens.xml
@@ -0,0 +1,37 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<resources>
+    <dimen name="car_selectable_item_radius">24dp</dimen>
+    <dimen name="car_window_rounded_corner_radius">48dp</dimen>
+
+    <!-- TODO(b/302163073) - update rotary specs -->
+    <dimen name="car_rotary_focus_stroke_width">8dp</dimen>
+    <dimen name="car_rotary_focus_pressed_stroke_width">4dp</dimen>
+
+    <dimen name="car_alert_dialog_padding">24dp</dimen>
+    <dimen name="car_alert_dialog_content_min_height">48dp</dimen>
+    <dimen name="car_alert_dialog_icon_size">64dp</dimen>
+    <dimen name="car_alert_dialog_button_spacing">16dp</dimen>
+    <dimen name="car_alert_dialog_button_height">88dp</dimen>
+
+    <!-- Toast Dimensions -->
+    <dimen name="car_toast_margin">24dp</dimen>
+    <dimen name="car_toast_bottom_margin">32dp</dimen>
+    <dimen name="car_toast_icon_margin">24dp</dimen>
+    <dimen name="car_toast_icon_size">48dp</dimen>
+</resources>
+
diff --git a/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/styles.xml b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/styles.xml
new file mode 100644
index 0000000000..7083439861
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/OEMDesignTokenShim/src/main/res/values/styles.xml
@@ -0,0 +1,54 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<resources>
+    <style name="TextAppearance.Car" parent="BaseTextAppearance" />
+    <style name="TextAppearance.Car.Display" parent="TextAppearance.Display" />
+    <style name="TextAppearance.Car.Headline" parent="TextAppearance.Headline" />
+    <style name="TextAppearance.Car.Headline.Large" parent="TextAppearance.Headline.Large" />
+    <style name="TextAppearance.Car.Headline.Medium" parent="TextAppearance.Headline.Medium" />
+
+    <style name="TextAppearance.Car.Body" parent="TextAppearance.Body" />
+    <style name="TextAppearance.Car.Body.Large" parent="TextAppearance.Body.Large" />
+    <style name="TextAppearance.Car.Body.Medium" parent="TextAppearance.Body.Medium" />
+    <style name="TextAppearance.Car.Body.Small" parent="TextAppearance.Body.Small" />
+
+    <style name="TextAppearance.Car.Sub" parent="TextAppearance.Title" />
+    <style name="TextAppearance.Car.Sub.Large" parent="TextAppearance.Title.Large" />
+    <style name="TextAppearance.Car.Sub.Medium" parent="TextAppearance.Title.Medium" />
+    <style name="TextAppearance.Car.Sub.Small" parent="TextAppearance.Title.Small" />
+
+    <style name="TextAppearance.Car.Subhead" parent="TextAppearance.Title" />
+    <style name="TextAppearance.Car.Subhead.Large" parent="TextAppearance.Title.Large" />
+    <style name="TextAppearance.Car.Subhead.Medium" parent="TextAppearance.Title.Medium" />
+    <style name="TextAppearance.Car.Subhead.Small" parent="TextAppearance.Title.Small" />
+
+    <style name="TextAppearance.Car.Button" parent ="TextAppearance.Label" />
+    <style name="TextAppearance.Car.Button.Large" parent ="TextAppearance.Label.Large" />
+    <style name="TextAppearance.Car.Button.Medium" parent ="TextAppearance.Label.Medium" />
+    <style name="TextAppearance.Car.Button.Small" parent ="TextAppearance.Label.Small" />
+
+    <style name="TextAppearance.Car.Toast" parent="TextAppearance.Car.Body.Medium">
+        <item name="android:textColorHighlight">@color/car_inverse_on_surface</item>
+        <item name="android:textColorHint">@color/car_inverse_on_surface</item>
+        <item name="android:textColorLink">@color/car_inverse_on_surface</item>
+        <item name="android:textStyle">normal</item>
+        <item name="android:lineHeight">40dp</item>
+        <item name="android:textFontWeight">400</item>
+        <item name="android:textColor">@color/car_inverse_on_surface</item>
+        <item name="android:maxLines">2</item>
+    </style>
+</resources>
diff --git a/car_product/rro/oem-design-tokens/readme.md b/car_product/rro/oem-design-tokens/readme.md
new file mode 100644
index 0000000000..067a69a93c
--- /dev/null
+++ b/car_product/rro/oem-design-tokens/readme.md
@@ -0,0 +1,64 @@
+This directory contains customizations to define and apply OEM Design Token to both the system and apps that reference the tokens.
+
+### OEMDesignTokenBase
+Android library that is a singular source of truth for the definition of token values. Set the values of color, text and shape tokens as resources in this library, which will be a dependency for RROs applying OEM Design Token values across the system.
+
+### OEMDesignTokenShim
+This library maps the resources (token values) from `OEMDesignTokenBase` to the resource names matching the resources defined in `car-resource-common`. This shim allows values defined in `OEMDesignTokenBase` to be easily substituted in modules that depend on `car-resource-common`.
+
+### OEMDesignTokenFrameworkResRRO
+This RRO applies the token values defined in `OEMDesignTokenBase` to `framework-res` by overlaying framework resources (themes, textAppearances, colors etc.).
+
+### OEMDesignTokenRRO
+This RRO applies the token values defined in `OEMDesignTokenBase` to the OEM Design Token Shared Library installed on the system. Apps that directly reference token values will resolve values defined in this RRO.
+
+### OEMDesignTokenCarUiPluginRRO
+This RRO overlays the resources of the Car UI Library plugin to reference OEM Design Token values where appropriate.
+
+```
+                          +----------------------+               +-----------------------------+            +-----------------+
+                          |                      |               |                             |            |                 |
+                          |                      |               |                             |            |                 |
+                          |                      |  Sets values  |                             | Customizes |                 |
+                          |  OEMDesignTokenShim  +---------------> Existing framework-res RROs +------------>  framework-res  |
+                          |                      |               |                             |            |                 |
+                          |                      |               |                             |            |                 |
+                          |                      |               |                             |            |                 |
+                          +------------^---------+               +-----------------------------+            +-----------------+
+                                       |
++----------------------+               |
+|                      |               |Renames resources
+|                      |               |
+|                      |               |
+|  OEMDesignTokenBase  +---------------+
+|                      |               |
+|                      |               |
+|                      |               |Sets values
++----------------------+               |
+                                       |
+                         +-------------v------------+            +---------------------------------+
+                         |                          |            |                                 |
+                         |                          |            |                                 |
+                         |                          |            |                                 |
+                         |     OEMDesignTokenRRO    +------------> OEM Design Token Shared Library |
+                         |                          | Customizes |                                 |
+                         |                          |            |                                 |
+                         |                          |            |                                 |
+                         +--------------------------+            +-----------------+---------------+
+                                                                                   |
+                                                                                   |
+                                                                                   |
+                                                                                   |References tokens
+                                                                                   |
+                                                                                   |
+                                                                                   |
+                                                                   +---------------v--------------+            +-----------------------+
+                                                                   |                              |            |                       |
+                                                                   |                              |            |                       |
+                                                                   |                              |            |                       |
+                                                                   | OEMDesignTokenCarUiPluginRRO +------------>  Car UI Proxy Plugin  |
+                                                                   |                              | Customizes |                       |
+                                                                   |                              |            |                       |
+                                                                   |                              |            |                       |
+                                                                   +------------------------------+            +-----------------------+
+```
diff --git a/car_product/rro/overlay-config/SettingsProviderRRO/res/values/defaults.xml b/car_product/rro/overlay-config/SettingsProviderRRO/res/values/defaults.xml
index a4377ca127..8a256ef7a7 100644
--- a/car_product/rro/overlay-config/SettingsProviderRRO/res/values/defaults.xml
+++ b/car_product/rro/overlay-config/SettingsProviderRRO/res/values/defaults.xml
@@ -30,6 +30,10 @@
     <!-- Default for UI touch sounds disabled -->
     <bool name="def_sound_effects_enabled">false</bool>
 
+    <!-- Allow users to use both the on-screen keyboard, as well as a real
+         keyboard -->
+    <bool name="def_show_ime_with_hard_keyboard">true</bool>
+
     <!-- Initial value for the Settings.Secure.IMMERSIVE_MODE_CONFIRMATIONS setting,
          which is a comma separated list of packages that no longer need confirmation
          for immersive mode.
diff --git a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/values/dimens.xml b/car_product/rro/overlay-config/androidRRO/res/values/config_telephony.xml
similarity index 68%
rename from car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/values/dimens.xml
rename to car_product/rro/overlay-config/androidRRO/res/values/config_telephony.xml
index f2a58a41e7..3a37dd06a2 100644
--- a/car_product/car_ui_portrait/apps/CarUiPortraitSettings/res/values/dimens.xml
+++ b/car_product/rro/overlay-config/androidRRO/res/values/config_telephony.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-    Copyright 2018 The Android Open Source Project
+    Copyright (C) 2024 The Android Open Source Project
 
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
@@ -14,10 +14,8 @@
     See the License for the specific language governing permissions and
     limitations under the License.
 -->
-
 <resources>
-    <!-- Top-level menu -->
-    <dimen name="top_level_menu_width">400dp</dimen>
-    <dimen name="top_level_recyclerview_margin_right">@*android:dimen/car_padding_2</dimen>
-    <dimen name="top_level_foreground_icon_inset">8dp</dimen>
+    <!-- Workaround for Bluetooth messages not working without telephony feature.
+         TODO(b/343938039): remove this workaround (also from framework code) -->
+    <bool name="config_force_phone_globals_creation">true</bool>
 </resources>
diff --git a/car_product/rro/overlay-visual/androidRRO/res/drawable/btn_borderless_car.xml b/car_product/rro/overlay-visual/androidRRO/res/drawable/btn_borderless_car.xml
index 4d5dc9799d..aa9b68dde5 100644
--- a/car_product/rro/overlay-visual/androidRRO/res/drawable/btn_borderless_car.xml
+++ b/car_product/rro/overlay-visual/androidRRO/res/drawable/btn_borderless_car.xml
@@ -14,44 +14,33 @@
      limitations under the License.
 -->
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <item android:state_focused="true" android:state_pressed="true">
+        <shape android:shape="rectangle">
+            <corners android:radius="?android:attr/buttonCornerRadius" />
+            <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width"
+                android:color="@color/car_rotary_focus_stroke_color"/>
+            <padding android:left="@*android:dimen/button_padding_horizontal_material"
+                android:top="@*android:dimen/button_padding_vertical_material"
+                android:right="@*android:dimen/button_padding_horizontal_material"
+                android:bottom="@*android:dimen/button_padding_vertical_material" />
+        </shape>
+    </item>
     <item android:state_focused="true">
-        <inset android:insetLeft="@*android:dimen/button_inset_horizontal_material"
-               android:insetTop="@*android:dimen/button_inset_vertical_material"
-               android:insetRight="@*android:dimen/button_inset_horizontal_material"
-               android:insetBottom="@*android:dimen/button_inset_vertical_material">
-            <selector>
-                <item android:state_focused="true" android:state_pressed="true">
-                    <shape android:shape="rectangle">
-                        <corners android:radius="?android:attr/buttonCornerRadius" />
-                        <solid android:color="@color/car_rotary_focus_pressed_fill_color"/>
-                        <stroke android:width="@dimen/car_rotary_focus_pressed_stroke_width"
-                                android:color="@color/car_rotary_focus_stroke_color"/>
-                        <padding android:left="@*android:dimen/button_padding_horizontal_material"
-                                 android:top="@*android:dimen/button_padding_vertical_material"
-                                 android:right="@*android:dimen/button_padding_horizontal_material"
-                                 android:bottom="@*android:dimen/button_padding_vertical_material" />
-                    </shape>
-                </item>
-                <item android:state_focused="true">
-                    <shape android:shape="rectangle">
-                        <corners android:radius="?android:attr/buttonCornerRadius" />
-                        <solid android:color="@color/car_rotary_focus_fill_color"/>
-                        <stroke android:width="@dimen/car_rotary_focus_stroke_width"
-                                android:color="@color/car_rotary_focus_stroke_color"/>
-                        <padding android:left="@*android:dimen/button_padding_horizontal_material"
-                                 android:top="@*android:dimen/button_padding_vertical_material"
-                                 android:right="@*android:dimen/button_padding_horizontal_material"
-                                 android:bottom="@*android:dimen/button_padding_vertical_material" />
-                    </shape>
-                </item>
-            </selector>
-        </inset>
+        <shape android:shape="rectangle">
+            <corners android:radius="?android:attr/buttonCornerRadius" />
+            <solid android:color="@color/car_rotary_focus_fill_color"/>
+            <stroke android:width="@dimen/car_rotary_focus_stroke_width"
+                android:color="@color/car_rotary_focus_stroke_color"/>
+            <padding android:left="@*android:dimen/button_padding_horizontal_material"
+                android:top="@*android:dimen/button_padding_vertical_material"
+                android:right="@*android:dimen/button_padding_horizontal_material"
+                android:bottom="@*android:dimen/button_padding_vertical_material" />
+        </shape>
     </item>
     <item>
         <ripple xmlns:android="http://schemas.android.com/apk/res/android"
-        android:color="?android:attr/colorControlHighlight">
-            <item android:id="@android:id/mask"
-                  android:drawable="@*android:drawable/btn_default_mtrl_shape" />
+            android:color="?android:attr/colorControlHighlight">
         </ripple>
     </item>
 </selector>
diff --git a/car_product/rro/overlay-visual/androidRRO/res/layout-car/car_alert_dialog.xml b/car_product/rro/overlay-visual/androidRRO/res/layout-car/car_alert_dialog.xml
index 9825a02e5a..9937c28b13 100644
--- a/car_product/rro/overlay-visual/androidRRO/res/layout-car/car_alert_dialog.xml
+++ b/car_product/rro/overlay-visual/androidRRO/res/layout-car/car_alert_dialog.xml
@@ -15,7 +15,7 @@
   ~ limitations under the License.
   -->
 
-<RelativeLayout
+<LinearLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:id="@*android:id/parentPanel"
     android:layout_width="match_parent"
@@ -23,25 +23,22 @@
     android:gravity="start|top"
     android:background="@drawable/car_alert_dialog_bg"
     android:padding="@dimen/car_alert_dialog_padding"
-    android:orientation="vertical">
+    android:orientation="horizontal">
     <ScrollView
-        android:layout_width="match_parent"
-        android:layout_height="wrap_content"
-        android:layout_alignParentTop="true"
-        android:layout_above="@*android:id/buttonPanel"
+        android:layout_width="0dp"
+        android:layout_height="match_parent"
+        android:layout_weight="1"
         android:fadeScrollbars="false"
         android:clipToPadding="false">
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:orientation="vertical">
-            <include layout="@layout/car_alert_dialog_title"
-                    android:layout_weight="0"/>
+            <include layout="@layout/car_alert_dialog_title" />
             <FrameLayout
                 android:id="@*android:id/contentPanel"
                 android:layout_width="match_parent"
                 android:layout_height="wrap_content"
-                android:layout_weight="1"
                 android:padding="@dimen/car_alert_dialog_padding"
                 android:minHeight="@dimen/car_alert_dialog_content_min_height">
                 <ScrollView
@@ -77,7 +74,6 @@
                 android:layout_width="match_parent"
                 android:layout_height="wrap_content"
                 android:layout_margin="@dimen/car_alert_dialog_padding"
-                android:layout_weight="1"
                 android:minHeight="@dimen/car_alert_dialog_content_min_height">
                 <FrameLayout
                     android:id="@android:id/custom"
@@ -88,10 +84,9 @@
     </ScrollView>
     <include
         android:id="@*android:id/buttonPanel"
-        android:layout_width="match_parent"
-        android:layout_height="wrap_content"
-        android:layout_alignParentBottom="true"
+        android:layout_width="wrap_content"
+        android:layout_height="match_parent"
         android:layout_marginTop="@dimen/car_alert_dialog_padding"
         android:layout_marginHorizontal="@dimen/car_alert_dialog_padding"
         layout="@layout/car_alert_dialog_button_bar"/>
-</RelativeLayout>
+</LinearLayout>
diff --git a/car_product/rro/overlay-visual/androidRRO/res/layout-port-car/car_alert_dialog.xml b/car_product/rro/overlay-visual/androidRRO/res/layout-port-car/car_alert_dialog.xml
new file mode 100644
index 0000000000..cecec31e69
--- /dev/null
+++ b/car_product/rro/overlay-visual/androidRRO/res/layout-port-car/car_alert_dialog.xml
@@ -0,0 +1,92 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@*android:id/parentPanel"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:gravity="start|top"
+    android:background="@drawable/car_alert_dialog_bg"
+    android:padding="@dimen/car_alert_dialog_padding"
+    android:orientation="vertical">
+    <ScrollView
+        android:layout_width="match_parent"
+        android:layout_height="0dp"
+        android:layout_weight="1"
+        android:fadeScrollbars="false"
+        android:clipToPadding="false">
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:orientation="vertical">
+            <include layout="@layout/car_alert_dialog_title" />
+            <FrameLayout
+                android:id="@*android:id/contentPanel"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:padding="@dimen/car_alert_dialog_padding"
+                android:minHeight="@dimen/car_alert_dialog_content_min_height">
+                <ScrollView
+                    android:id="@*android:id/scrollView"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content"
+                    android:clipToPadding="false">
+                    <LinearLayout
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:orientation="vertical">
+                        <Space
+                            android:id="@*android:id/textSpacerNoTitle"
+                            android:visibility="gone"
+                            android:layout_width="match_parent"
+                            android:layout_height="0dp" />
+                        <TextView
+                            android:id="@android:id/message"
+                            android:layout_width="match_parent"
+                            android:layout_height="wrap_content"
+                            style="@style/CarDialogMessageText"/>
+                        <!-- we don't need this spacer, but the id needs to be here for compatibility -->
+                        <Space
+                            android:id="@*android:id/textSpacerNoButtons"
+                            android:visibility="gone"
+                            android:layout_width="match_parent"
+                            android:layout_height="0dp" />
+                    </LinearLayout>
+                </ScrollView>
+            </FrameLayout>
+            <FrameLayout
+                android:id="@*android:id/customPanel"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_margin="@dimen/car_alert_dialog_padding"
+                android:minHeight="@dimen/car_alert_dialog_content_min_height">
+                <FrameLayout
+                    android:id="@android:id/custom"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content" />
+            </FrameLayout>
+        </LinearLayout>
+    </ScrollView>
+    <include
+        android:id="@*android:id/buttonPanel"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_marginTop="@dimen/car_alert_dialog_padding"
+        android:layout_marginHorizontal="@dimen/car_alert_dialog_padding"
+        layout="@layout/car_alert_dialog_button_bar"/>
+</LinearLayout>
\ No newline at end of file
diff --git a/car_product/rro/overlay-visual/androidRRO/res/values/dimens.xml b/car_product/rro/overlay-visual/androidRRO/res/values/dimens.xml
index 9b8e864ab8..5dda90bbda 100644
--- a/car_product/rro/overlay-visual/androidRRO/res/values/dimens.xml
+++ b/car_product/rro/overlay-visual/androidRRO/res/values/dimens.xml
@@ -215,4 +215,6 @@
     <dimen name="car_disabled_alpha">0.35</dimen>
 
     <dimen name="resolver_max_collapsed_height">400dp</dimen>
+
+    <dimen name="car_dialog_min_width_major">75%</dimen>
 </resources>
diff --git a/car_product/rro/overlay-visual/androidRRO/res/values/styles.xml b/car_product/rro/overlay-visual/androidRRO/res/values/styles.xml
index 717d8b5b6e..8d3858ecff 100644
--- a/car_product/rro/overlay-visual/androidRRO/res/values/styles.xml
+++ b/car_product/rro/overlay-visual/androidRRO/res/values/styles.xml
@@ -60,9 +60,13 @@
         <item name="android:gravity">center</item>
     </style>
 
-    <style name="CarDialogActionButton" parent="Widget.DeviceDefault.Button" />
+    <style name="CarDialogActionButton" parent="Widget.DeviceDefault.Button" >
+        <item name="android:minWidth">237dp</item>
+    </style>
 
-    <style name="CarDialogActionButton1" parent="Widget.DeviceDefault.Button.Colored" />
+    <style name="CarDialogActionButton1" parent="Widget.DeviceDefault.Button.Colored" >
+        <item name="android:minWidth">237dp</item>
+    </style>
 
     <style name="CarDialogMessageText" parent="TextAppearance.DeviceDefault.Medium">
         <item name="android:textStyle">normal</item>
diff --git a/car_product/rro/overlay-visual/androidRRO/res/values/themes_device_defaults.xml b/car_product/rro/overlay-visual/androidRRO/res/values/themes_device_defaults.xml
index 3d8b913a54..b5ee5db6c9 100644
--- a/car_product/rro/overlay-visual/androidRRO/res/values/themes_device_defaults.xml
+++ b/car_product/rro/overlay-visual/androidRRO/res/values/themes_device_defaults.xml
@@ -127,6 +127,7 @@
         <item name="android:textAppearanceListItemSmall">@*android:style/TextAppearance.DeviceDefault.Large</item>
         <item name="android:textAppearanceListItemSecondary">@*android:style/TextAppearance.DeviceDefault.Small</item>
         <item name="android:windowTitleStyle">?android:attr/textAppearanceLarge</item>
+        <item name="android:windowMinWidthMajor">@dimen/car_dialog_min_width_major</item>
     </style>
 
     <style name="Theme.DeviceDefault.Settings.Dialog" parent="android:Theme.DeviceDefault.Dialog.Alert">
diff --git a/car_product/sepolicy/private/carservice_app.te b/car_product/sepolicy/private/carservice_app.te
index f60a8a1c4f..fc5489d005 100644
--- a/car_product/sepolicy/private/carservice_app.te
+++ b/car_product/sepolicy/private/carservice_app.te
@@ -143,3 +143,5 @@ allow carservice_app evsmanagerd_service:service_manager find;
 
 # Allow reading car boot information
 get_prop(carservice_app, car_boot_prop);
+
+set_prop(carservice_app, hibernation_prop);
diff --git a/car_product/sepolicy/private/compat/34.0/34.0.cil b/car_product/sepolicy/private/compat/34.0/34.0.cil
new file mode 100644
index 0000000000..d9e79b64e3
--- /dev/null
+++ b/car_product/sepolicy/private/compat/34.0/34.0.cil
@@ -0,0 +1,3 @@
+(typeattributeset carpowerpolicyd_service_34_0 (carpowerpolicyd_service))
+(expandtypeattribute (carpowerpolicyd_service_34_0) true)
+(typeattribute carpowerpolicyd_service_34_0)
diff --git a/car_product/sepolicy/private/property.te b/car_product/sepolicy/private/property.te
index 2fa0aee675..6262d54c50 100644
--- a/car_product/sepolicy/private/property.te
+++ b/car_product/sepolicy/private/property.te
@@ -1,2 +1,11 @@
+system_internal_prop(hibernation_config_prop);
+system_internal_prop(hibernation_prop)
+
 # Only kernel, init, and vendor init can write to car_boot_prop properties
 neverallow { domain -kernel -init -vendor_init } car_boot_prop:property_service set;
+
+# Only allow init and carservice to set hibernation_prop
+neverallow { domain -init -carservice_app } hibernation_prop:property_service set;
+
+# never allow hibernation_config_prop to be set, should be set at build time
+neverallow { domain -init } hibernation_config_prop:property_service set;
diff --git a/car_product/sepolicy/private/property_contexts b/car_product/sepolicy/private/property_contexts
index 1853fc8ce2..fc41c20708 100644
--- a/car_product/sepolicy/private/property_contexts
+++ b/car_product/sepolicy/private/property_contexts
@@ -1,3 +1,6 @@
-boot.car_service_created   u:object_r:system_prop:s0
-boot.car_kernel_boot_time  u:object_r:car_boot_prop:s0 exact string
-boot.car_device_start_time u:object_r:car_boot_prop:s0 exact string
+boot.car_service_created          u:object_r:system_prop:s0
+boot.car_kernel_boot_time         u:object_r:car_boot_prop:s0 exact string
+boot.car_device_start_time        u:object_r:car_boot_prop:s0 exact string
+sys.hibernate                     u:object_r:hibernation_prop:s0
+ro.sys.hibernate_enabled          u:object_r:hibernation_config_prop:s0
+ro.sys.swap_storage_device        u:object_r:hibernation_config_prop:s0
diff --git a/cpp/bugreport/carbugreportd.rc b/cpp/bugreport/carbugreportd.rc
index 530fd8a5fa..dc2b4bdd1d 100644
--- a/cpp/bugreport/carbugreportd.rc
+++ b/cpp/bugreport/carbugreportd.rc
@@ -13,5 +13,6 @@ service carbugreportd /system/bin/carbugreportd
 service cardumpstatez /system/bin/dumpstate -S -d -z
     socket dumpstate stream 0660 shell log
     class main
+    user root
     disabled
     oneshot
diff --git a/cpp/car_binder_lib/largeParcelable/include/SharedMemory.h b/cpp/car_binder_lib/largeParcelable/include/SharedMemory.h
index 31f556e4ee..6cac82ef2d 100644
--- a/cpp/car_binder_lib/largeParcelable/include/SharedMemory.h
+++ b/cpp/car_binder_lib/largeParcelable/include/SharedMemory.h
@@ -72,7 +72,7 @@ public:
 
     inline unique_fd getDupFd() const {
         unique_fd fd(dup(getFd()));
-        return std::move(fd);
+        return fd;
     }
 
     inline std::unique_ptr<MappedFile> mapReadWrite() const {
diff --git a/cpp/displayproxy/src/CarDisplayProxy.cpp b/cpp/displayproxy/src/CarDisplayProxy.cpp
index dfedec0e88..ada21e8033 100644
--- a/cpp/displayproxy/src/CarDisplayProxy.cpp
+++ b/cpp/displayproxy/src/CarDisplayProxy.cpp
@@ -134,7 +134,7 @@ ScopedAStatus CarDisplayProxy::getDisplayInfo(int64_t id, DisplayDesc* _aidl_ret
         LOG(WARNING) << "Failed to read current state of the display " << id;
     }
 
-    return std::move(displayToken);
+    return displayToken;
 }
 
 ScopedAStatus CarDisplayProxy::getHGraphicBufferProducer(int64_t id, NativeHandle* _aidl_return) {
@@ -168,7 +168,7 @@ ScopedAStatus CarDisplayProxy::getHGraphicBufferProducer(int64_t id, NativeHandl
         return ScopedAStatus::fromStatus(STATUS_BAD_VALUE);
     }
 
-    *_aidl_return = std::move(::android::dupToAidl(handle));
+    *_aidl_return = ::android::dupToAidl(handle);
     return ScopedAStatus::ok();
 }
 
diff --git a/cpp/evs/apps/default/src/Utils.cpp b/cpp/evs/apps/default/src/Utils.cpp
index 47e7356394..d874f110ab 100644
--- a/cpp/evs/apps/default/src/Utils.cpp
+++ b/cpp/evs/apps/default/src/Utils.cpp
@@ -32,11 +32,11 @@ NativeHandle dupNativeHandle(const NativeHandle& handle) {
     dup.fds = std::vector<::ndk::ScopedFileDescriptor>(handle.fds.size());
     const size_t n = handle.fds.size();
     for (size_t i = 0; i < n; ++i) {
-        dup.fds[i] = std::move(handle.fds[i].dup());
+        dup.fds[i] = handle.fds[i].dup();
     }
     dup.ints = handle.ints;
 
-    return std::move(dup);
+    return dup;
 }
 
 HardwareBuffer dupHardwareBuffer(const HardwareBuffer& buffer) {
@@ -45,7 +45,7 @@ HardwareBuffer dupHardwareBuffer(const HardwareBuffer& buffer) {
             .handle = dupNativeHandle(buffer.handle),
     };
 
-    return std::move(dup);
+    return dup;
 }
 
 }  // namespace
@@ -60,7 +60,7 @@ BufferDesc dupBufferDesc(const BufferDesc& src) {
             .metadata = src.metadata,
     };
 
-    return std::move(dup);
+    return dup;
 }
 
 native_handle_t* getNativeHandle(const BufferDesc& buffer) {
diff --git a/cpp/evs/manager/1.1/Android.bp b/cpp/evs/manager/1.1/Android.bp
index dc2e1f2712..43fda86710 100644
--- a/cpp/evs/manager/1.1/Android.bp
+++ b/cpp/evs/manager/1.1/Android.bp
@@ -36,8 +36,6 @@ cc_defaults {
         "libutils",
     ],
 
-    static_libs: ["libc++fs"],
-
     cflags: [
         "-DLOG_TAG=\"EvsManagerV1_1\"",
         "-DGL_GLEXT_PROTOTYPES",
diff --git a/cpp/evs/manager/aidl/Android.bp b/cpp/evs/manager/aidl/Android.bp
index 1bf8729b4e..6def779320 100644
--- a/cpp/evs/manager/aidl/Android.bp
+++ b/cpp/evs/manager/aidl/Android.bp
@@ -39,7 +39,6 @@ cc_defaults {
         "android.hardware.automotive.evs-V2-ndk",
         "android.hardware.common-V2-ndk",
         "libaidlcommonsupport",
-        "libc++fs",
         "libcutils",
     ],
     header_libs: [
diff --git a/cpp/evs/manager/aidl/manifest_evsmanagerd.xml b/cpp/evs/manager/aidl/manifest_evsmanagerd.xml
index e202ed5e70..a53e95c288 100644
--- a/cpp/evs/manager/aidl/manifest_evsmanagerd.xml
+++ b/cpp/evs/manager/aidl/manifest_evsmanagerd.xml
@@ -16,6 +16,7 @@
 <manifest version="1.0" type="framework" >
     <hal format="aidl">
         <name>android.hardware.automotive.evs</name>
+        <version>2</version>
         <fqname>IEvsEnumerator/default</fqname>
     </hal>
     <hal format="hidl" max-level="8">
diff --git a/cpp/evs/manager/aidl/src/Enumerator.cpp b/cpp/evs/manager/aidl/src/Enumerator.cpp
index a1d38051e6..d3431f632f 100644
--- a/cpp/evs/manager/aidl/src/Enumerator.cpp
+++ b/cpp/evs/manager/aidl/src/Enumerator.cpp
@@ -69,7 +69,7 @@ constexpr int64_t kSleepTimeMilliseconds = 1000;
 constexpr int64_t kTimeoutMilliseconds = 30000;
 
 // UIDs allowed to use this service
-const std::set<uid_t> kAllowedUids = {AID_AUTOMOTIVE_EVS, AID_SYSTEM, AID_ROOT};
+const std::set<uid_t> kAllowedUids = {AID_AUTOMOTIVE_EVS, AID_SYSTEM, AID_ROOT, AID_GRAPHICS};
 
 }  // namespace
 
@@ -110,7 +110,7 @@ std::shared_ptr<IEvsEnumerator> Enumerator::connectToAidlHal(
         LOG(WARNING) << "Failed to register a device status callback";
     }
 
-    return std::move(service);
+    return service;
 }
 
 std::shared_ptr<IEvsEnumerator> Enumerator::connectToHidlHal(
@@ -122,7 +122,7 @@ std::shared_ptr<IEvsEnumerator> Enumerator::connectToHidlHal(
         return nullptr;
     }
 
-    return std::move(::ndk::SharedRefBase::make<AidlEnumerator>(service));
+    return ::ndk::SharedRefBase::make<AidlEnumerator>(service);
 }
 
 bool Enumerator::init(const std::string_view& hardwareServiceName) {
@@ -682,8 +682,8 @@ void Enumerator::cmdList(int fd, const char** args, uint32_t numArgs) {
         if (mCameraDevices.size() < 1) {
             // Camera devices may not be enumerated yet.  This may fail if the
             // user is not permitted to use EVS service.
-            std::vector<CameraDesc> temp;
-            (void)getCameraList(&temp);
+            std::vector<CameraDesc> unused;
+            (void)getCameraList(&unused);
         }
 
         for (auto& [id, desc] : mCameraDevices) {
@@ -892,6 +892,11 @@ void Enumerator::broadcastDeviceStatusChange(const std::vector<aidlevs::DeviceSt
 
 ScopedAStatus Enumerator::EvsDeviceStatusCallbackImpl::deviceStatusChanged(
         const std::vector<aidlevs::DeviceStatus>& list) {
+    {
+        // Refresh the list.
+        std::vector<CameraDesc> unused;
+        (void)mEnumerator->getCameraList(&unused);
+    }
     mEnumerator->broadcastDeviceStatusChange(list);
     return ScopedAStatus::ok();
 }
diff --git a/cpp/evs/manager/aidl/src/HalCamera.cpp b/cpp/evs/manager/aidl/src/HalCamera.cpp
index a47d241e48..c0b33977c8 100644
--- a/cpp/evs/manager/aidl/src/HalCamera.cpp
+++ b/cpp/evs/manager/aidl/src/HalCamera.cpp
@@ -49,7 +49,7 @@ std::shared_ptr<VirtualCamera> HalCamera::makeVirtualCamera() {
     // Create the client camera interface object
     std::vector<std::shared_ptr<HalCamera>> sourceCameras;
     sourceCameras.reserve(1);
-    sourceCameras.push_back(std::move(ref<HalCamera>()));
+    sourceCameras.push_back(ref<HalCamera>());
     std::shared_ptr<VirtualCamera> client =
             ::ndk::SharedRefBase::make<VirtualCamera>(sourceCameras);
     if (!client || !ownVirtualCamera(client)) {
@@ -57,7 +57,7 @@ std::shared_ptr<VirtualCamera> HalCamera::makeVirtualCamera() {
         return nullptr;
     }
 
-    return std::move(client);
+    return client;
 }
 
 bool HalCamera::ownVirtualCamera(const std::shared_ptr<VirtualCamera>& virtualCamera) {
@@ -583,7 +583,7 @@ std::string HalCamera::toString(Stream configuration, const char* indent) {
                   indent, double_indent.data(), configuration.id, double_indent.data(),
                   configuration.width, double_indent.data(), configuration.height,
                   double_indent.data(), static_cast<unsigned int>(configuration.format),
-                  double_indent.data(), static_cast<unsigned long>(configuration.usage),
+                  double_indent.data(), static_cast<int64_t>(configuration.usage),
                   double_indent.data(), static_cast<unsigned int>(configuration.rotation));
 
     return streamInfo;
diff --git a/cpp/evs/manager/aidl/src/VirtualCamera.cpp b/cpp/evs/manager/aidl/src/VirtualCamera.cpp
index 8e6a347edb..ce78046178 100644
--- a/cpp/evs/manager/aidl/src/VirtualCamera.cpp
+++ b/cpp/evs/manager/aidl/src/VirtualCamera.cpp
@@ -563,7 +563,7 @@ ScopedAStatus VirtualCamera::startVideoStream(const std::shared_ptr<IEvsCameraSt
                             : EvsEventType::TIMEOUT,
                     .payload = {static_cast<int32_t>(status)},
             };
-            if (!mStream->notify(std::move(event)).isOk()) {
+            if (!mStream->notify(event).isOk()) {
                 LOG(WARNING) << "Error delivering a stream event"
                              << static_cast<int32_t>(event.aType);
             }
@@ -607,8 +607,9 @@ ScopedAStatus VirtualCamera::startVideoStream(const std::shared_ptr<IEvsCameraSt
                 }
 
                 for (auto&& buffer : buffers) {
+                    const auto bufferId = buffer.bufferId;
                     if (!pHwCamera->doneWithFrame(std::move(buffer)).isOk()) {
-                        LOG(WARNING) << "Failed to return a buffer " << buffer.bufferId << " to "
+                        LOG(WARNING) << "Failed to return a buffer " << bufferId << " to "
                                      << hwCameraId;
                     }
                 }
@@ -809,8 +810,7 @@ bool VirtualCamera::deliverFrame(const BufferDesc& bufDesc) {
     }
 
     // Keep a record of this frame so we can clean up if we have to in case of client death
-    mFramesHeld[bufDesc.deviceId].push_back(
-            std::move(Utils::dupBufferDesc(bufDesc, /* doDup= */ true)));
+    mFramesHeld[bufDesc.deviceId].push_back(Utils::dupBufferDesc(bufDesc, /* doDup= */ true));
 
     // v1.0 client uses an old frame-delivery mechanism.
     if (mCaptureThread.joinable()) {
diff --git a/cpp/evs/manager/aidl/tests/unit/src/MockEvsHal.cpp b/cpp/evs/manager/aidl/tests/unit/src/MockEvsHal.cpp
index 1c27d1be41..cc25621489 100644
--- a/cpp/evs/manager/aidl/tests/unit/src/MockEvsHal.cpp
+++ b/cpp/evs/manager/aidl/tests/unit/src/MockEvsHal.cpp
@@ -78,12 +78,12 @@ NativeHandle copyNativeHandle(const NativeHandle& handle, bool doDup) {
         }
     } else {
         for (auto i = 0; i < handle.fds.size(); ++i) {
-            dup.fds[i] = std::move(handle.fds[i].dup());
+            dup.fds[i] = handle.fds[i].dup();
         }
     }
     dup.ints = handle.ints;
 
-    return std::move(dup);
+    return dup;
 }
 
 HardwareBuffer copyHardwareBuffer(const HardwareBuffer& buffer, bool doDup) {
@@ -92,7 +92,7 @@ HardwareBuffer copyHardwareBuffer(const HardwareBuffer& buffer, bool doDup) {
             .handle = copyNativeHandle(buffer.handle, doDup),
     };
 
-    return std::move(copied);
+    return copied;
 }
 
 BufferDesc copyBufferDesc(const BufferDesc& src, bool doDup) {
@@ -105,7 +105,7 @@ BufferDesc copyBufferDesc(const BufferDesc& src, bool doDup) {
             .metadata = src.metadata,
     };
 
-    return std::move(copied);
+    return copied;
 }
 
 }  // namespace
diff --git a/cpp/evs/manager/aidl/utils/src/Utils.cpp b/cpp/evs/manager/aidl/utils/src/Utils.cpp
index 1f7415610d..6b35f53fa3 100644
--- a/cpp/evs/manager/aidl/utils/src/Utils.cpp
+++ b/cpp/evs/manager/aidl/utils/src/Utils.cpp
@@ -105,7 +105,7 @@ HardwareBuffer Utils::makeHwBufferFromHidlBuffer(const hidlevs::V1_0::BufferDesc
             .handle = doDup ? ::android::dupToAidl(h) : ::android::makeToAidl(h),
     };
 
-    return std::move(hwBuffer);
+    return hwBuffer;
 }
 
 HardwareBufferDescription Utils::makeFromHidl(const HIDLHardwareBuffer& hidlBuffer) {
@@ -120,7 +120,7 @@ HardwareBufferDescription Utils::makeFromHidl(const HIDLHardwareBuffer& hidlBuff
             .stride = static_cast<int>(pSrc->stride),
     };
 
-    return std::move(desc);
+    return desc;
 }
 
 HardwareBuffer Utils::makeHwBufferFromHidlBuffer(const hidlevs::V1_1::BufferDesc& hidlBuffer,
@@ -137,7 +137,7 @@ HardwareBuffer Utils::makeHwBufferFromHidlBuffer(const hidlevs::V1_1::BufferDesc
                             : std::move(::android::makeToAidl(h)),
     };
 
-    return std::move(hwBuffer);
+    return hwBuffer;
 }
 
 BufferDesc Utils::makeFromHidl(const hidlevs::V1_0::BufferDesc& hidlBuffer, bool doDup) {
@@ -149,7 +149,7 @@ BufferDesc Utils::makeFromHidl(const hidlevs::V1_0::BufferDesc& hidlBuffer, bool
             // metadata.
     };
 
-    return std::move(aidlBuffer);
+    return aidlBuffer;
 }
 
 BufferDesc Utils::makeFromHidl(const hidlevs::V1_1::BufferDesc& hidlBuffer, bool doDup) {
@@ -162,7 +162,7 @@ BufferDesc Utils::makeFromHidl(const hidlevs::V1_1::BufferDesc& hidlBuffer, bool
             .metadata = hidlBuffer.metadata,
     };
 
-    return std::move(aidlBuffer);
+    return aidlBuffer;
 }
 
 HIDLHardwareBufferDescription Utils::makeToHidl(const HardwareBufferDescription& aidlDesc) {
@@ -175,7 +175,7 @@ HIDLHardwareBufferDescription Utils::makeToHidl(const HardwareBufferDescription&
     pDesc->usage = static_cast<uint64_t>(aidlDesc.usage);
     pDesc->stride = aidlDesc.stride;
 
-    return std::move(hidlDesc);
+    return hidlDesc;
 }
 
 HIDLHardwareBuffer Utils::makeToHidl(const HardwareBuffer& aidlBuffer, bool doDup) {
@@ -185,7 +185,7 @@ HIDLHardwareBuffer Utils::makeToHidl(const HardwareBuffer& aidlBuffer, bool doDu
                                   : ::android::makeFromAidl(aidlBuffer.handle),
     };
 
-    return std::move(hidlBuffer);
+    return hidlBuffer;
 }
 
 hidlevs::V1_0::BufferDesc Utils::makeToHidlV1_0(const BufferDesc& aidlBuffer, bool doDup) {
@@ -201,7 +201,7 @@ hidlevs::V1_0::BufferDesc Utils::makeToHidlV1_0(const BufferDesc& aidlBuffer, bo
                                : ::android::makeFromAidl(aidlBuffer.buffer.handle),
     };
 
-    return std::move(hidlBuffer);
+    return hidlBuffer;
 }
 
 hidlevs::V1_1::BufferDesc Utils::makeToHidlV1_1(const BufferDesc& aidlBuffer, bool doDup) {
@@ -214,7 +214,7 @@ hidlevs::V1_1::BufferDesc Utils::makeToHidlV1_1(const BufferDesc& aidlBuffer, bo
             .metadata = aidlBuffer.metadata,
     };
 
-    return std::move(hidlBuffer);
+    return hidlBuffer;
 }
 
 EvsResult Utils::makeFromHidl(hidlevs::V1_0::EvsResult result) {
@@ -261,7 +261,7 @@ CameraDesc Utils::makeFromHidl(const hidlevs::V1_0::CameraDesc& hidlDesc) {
             .vendorFlags = static_cast<int32_t>(hidlDesc.vendorFlags),
     };
 
-    return std::move(aidlDesc);
+    return aidlDesc;
 }
 
 CameraDesc Utils::makeFromHidl(const hidlevs::V1_1::CameraDesc& hidlDesc) {
@@ -271,7 +271,7 @@ CameraDesc Utils::makeFromHidl(const hidlevs::V1_1::CameraDesc& hidlDesc) {
             .metadata = hidlDesc.metadata,
     };
 
-    return std::move(aidlDesc);
+    return aidlDesc;
 }
 
 hidlevs::V1_0::CameraDesc Utils::makeToHidlV1_0(const CameraDesc& aidlDesc) {
@@ -280,7 +280,7 @@ hidlevs::V1_0::CameraDesc Utils::makeToHidlV1_0(const CameraDesc& aidlDesc) {
             .vendorFlags = static_cast<uint32_t>(aidlDesc.vendorFlags),
     };
 
-    return std::move(hidlDesc);
+    return hidlDesc;
 }
 
 hidlevs::V1_1::CameraDesc Utils::makeToHidlV1_1(const CameraDesc& aidlDesc) {
@@ -298,7 +298,7 @@ hidlevs::V1_1::CameraDesc Utils::makeToHidlV1_1(const CameraDesc& aidlDesc) {
         memcpy(hidlDesc.metadata.data(), aidlDesc.metadata.data(), n);
     }
 
-    return std::move(hidlDesc);
+    return hidlDesc;
 }
 
 hidlevs::V1_1::CameraParam Utils::makeToHidl(CameraParam id) {
@@ -365,7 +365,7 @@ DisplayDesc Utils::makeFromHidl(const hidlevs::V1_0::DisplayDesc& hidlDesc) {
             .vendorFlags = static_cast<int>(hidlDesc.vendorFlags),
     };
 
-    return std::move(aidlDesc);
+    return aidlDesc;
 }
 
 Stream Utils::makeFromHidl(const HIDLStream& config) {
@@ -379,7 +379,7 @@ Stream Utils::makeFromHidl(const HIDLStream& config) {
             .rotation = makeFromHidl(config.rotation),
     };
 
-    return std::move(aidlStreamConfig);
+    return aidlStreamConfig;
 }
 
 StreamType Utils::makeFromHidl(HIDLStreamType hidlType) {
@@ -439,7 +439,7 @@ HIDLStreamRotation Utils::makeToHidl(Rotation aidlRotation) {
             .rotation = makeToHidl(config.rotation),
     };
 
-    return std::move(hidlStreamConfig);
+    return hidlStreamConfig;
 }
 
 EvsEventType Utils::makeFromHidl(const hidlevs::V1_1::EvsEventType& hidlType) {
@@ -490,7 +490,7 @@ EvsEventDesc Utils::makeFromHidl(const hidlevs::V1_1::EvsEventDesc& hidlDesc) {
         aidlDesc.payload.push_back(hidlDesc.payload[i]);
     }
 
-    return std::move(aidlDesc);
+    return aidlDesc;
 }
 
 bool Utils::makeToHidl(const EvsEventDesc& in, hidlevs::V1_1::EvsEventDesc* out) {
@@ -527,12 +527,12 @@ NativeHandle Utils::dupNativeHandle(const NativeHandle& handle, bool doDup) {
         }
     } else {
         for (auto i = 0; i < handle.fds.size(); ++i) {
-            dup.fds[i] = std::move(handle.fds[i].dup());
+            dup.fds[i] = handle.fds[i].dup();
         }
     }
     dup.ints = handle.ints;
 
-    return std::move(dup);
+    return dup;
 }
 
 HardwareBuffer Utils::dupHardwareBuffer(const HardwareBuffer& buffer, bool doDup) {
@@ -541,7 +541,7 @@ HardwareBuffer Utils::dupHardwareBuffer(const HardwareBuffer& buffer, bool doDup
             .handle = dupNativeHandle(buffer.handle, doDup),
     };
 
-    return std::move(dup);
+    return dup;
 }
 
 BufferDesc Utils::dupBufferDesc(const BufferDesc& src, bool doDup) {
@@ -554,7 +554,7 @@ BufferDesc Utils::dupBufferDesc(const BufferDesc& src, bool doDup) {
             .metadata = src.metadata,
     };
 
-    return std::move(dup);
+    return dup;
 }
 
 ScopedAStatus Utils::buildScopedAStatusFromEvsResult(EvsResult result) {
diff --git a/cpp/evs/manager/aidl/wrappers/src/AidlCamera.cpp b/cpp/evs/manager/aidl/wrappers/src/AidlCamera.cpp
index cc37fa7508..a1ed9ae83a 100644
--- a/cpp/evs/manager/aidl/wrappers/src/AidlCamera.cpp
+++ b/cpp/evs/manager/aidl/wrappers/src/AidlCamera.cpp
@@ -412,7 +412,7 @@ ScopedAStatus AidlCamera::ImplV1::importExternalBuffers(const std::vector<Buffer
     hidl_vec<hidlevs::V1_1::BufferDesc> hidlBuffers;
     hidlBuffers.resize(buffers.size());
     for (auto i = 0; i < buffers.size(); ++i) {
-        hidlBuffers[i] = std::move(Utils::makeToHidlV1_1(buffers[i]));
+        hidlBuffers[i] = Utils::makeToHidlV1_1(buffers[i]);
     }
     hidlevs::V1_0::EvsResult hidlStatus = hidlevs::V1_0::EvsResult::OK;
     (void)mHidlCamera->importExternalBuffers(hidlBuffers,
diff --git a/cpp/evs/manager/aidl/wrappers/src/AidlCameraStream.cpp b/cpp/evs/manager/aidl/wrappers/src/AidlCameraStream.cpp
index baf1748ca7..8388f97377 100644
--- a/cpp/evs/manager/aidl/wrappers/src/AidlCameraStream.cpp
+++ b/cpp/evs/manager/aidl/wrappers/src/AidlCameraStream.cpp
@@ -77,7 +77,7 @@ ScopedAStatus AidlCameraStream::ImplV0::deliverFrame(const std::vector<BufferDes
     }
 
     auto hidlBuffer = Utils::makeToHidlV1_0(buffers[0], /* doDup= */ false);
-    mBuffers.push_back(std::move(Utils::dupBufferDesc(buffers[0], /* doDup= */ true)));
+    mBuffers.push_back(Utils::dupBufferDesc(buffers[0], /* doDup= */ true));
     if (auto status = mStream->deliverFrame(std::move(hidlBuffer)); !status.isOk()) {
         LOG(ERROR) << "Failed to forward a frame to HIDL v1.0 client";
         return ScopedAStatus::fromStatus(STATUS_FAILED_TRANSACTION);
@@ -117,8 +117,8 @@ ScopedAStatus AidlCameraStream::ImplV1::deliverFrame(const std::vector<BufferDes
     const auto n = buffers.size();
     ::android::hardware::hidl_vec<hidlevs::V1_1::BufferDesc> hidlBuffers(n);
     for (auto i = 0; i < n; ++i) {
-        BufferDesc buffer = std::move(Utils::dupBufferDesc(buffers[i], /* doDup= */ true));
-        hidlBuffers[i] = std::move(Utils::makeToHidlV1_1(buffer, /* doDup= */ false));
+        BufferDesc buffer = Utils::dupBufferDesc(buffers[i], /* doDup= */ true);
+        hidlBuffers[i] = Utils::makeToHidlV1_1(buffer, /* doDup= */ false);
         mBuffers.push_back(std::move(buffer));
     }
 
diff --git a/cpp/evs/manager/aidl/wrappers/src/AidlEnumerator.cpp b/cpp/evs/manager/aidl/wrappers/src/AidlEnumerator.cpp
index 8e221a1089..83599330b2 100644
--- a/cpp/evs/manager/aidl/wrappers/src/AidlEnumerator.cpp
+++ b/cpp/evs/manager/aidl/wrappers/src/AidlEnumerator.cpp
@@ -282,8 +282,7 @@ ScopedAStatus AidlEnumerator::ImplV0::openCamera(const std::string& id, const St
         return Utils::buildScopedAStatusFromEvsResult(EvsResult::INVALID_ARG);
     }
 
-    *_aidl_return =
-            std::move(::ndk::SharedRefBase::make<AidlCamera>(hidlCamera, /* forceV1_0= */ true));
+    *_aidl_return = ::ndk::SharedRefBase::make<AidlCamera>(hidlCamera, /* forceV1_0= */ true);
 
     return ScopedAStatus::ok();
 }
@@ -367,7 +366,7 @@ ScopedAStatus AidlEnumerator::ImplV1::openCamera(const std::string& id, const St
         return Utils::buildScopedAStatusFromEvsResult(EvsResult::RESOURCE_NOT_AVAILABLE);
     }
 
-    auto hidlStreamConfig = std::move(Utils::makeToHidl(cfg));
+    auto hidlStreamConfig = Utils::makeToHidl(cfg);
     ::android::sp<hidlevs::V1_1::IEvsCamera> hidlCamera =
             mHidlEnumerator->openCamera_1_1(id, hidlStreamConfig);
     if (!hidlCamera) {
@@ -375,7 +374,7 @@ ScopedAStatus AidlEnumerator::ImplV1::openCamera(const std::string& id, const St
         return Utils::buildScopedAStatusFromEvsResult(EvsResult::INVALID_ARG);
     }
 
-    *_aidl_return = std::move(::ndk::SharedRefBase::make<AidlCamera>(hidlCamera));
+    *_aidl_return = ::ndk::SharedRefBase::make<AidlCamera>(hidlCamera);
 
     return ScopedAStatus::ok();
 }
diff --git a/cpp/evs/manager/aidl/wrappers/src/HidlCamera.cpp b/cpp/evs/manager/aidl/wrappers/src/HidlCamera.cpp
index 48097205c3..ea1e260aac 100644
--- a/cpp/evs/manager/aidl/wrappers/src/HidlCamera.cpp
+++ b/cpp/evs/manager/aidl/wrappers/src/HidlCamera.cpp
@@ -414,7 +414,7 @@ Return<void> HidlCamera::importExternalBuffers(const hidl_vec<hidlevs::V1_1::Buf
 
     std::vector<BufferDesc> aidlBuffers(buffers.size());
     for (auto i = 0; i < buffers.size(); ++i) {
-        aidlBuffers[i] = std::move(Utils::makeFromHidl(buffers[i]));
+        aidlBuffers[i] = Utils::makeFromHidl(buffers[i]);
     }
 
     int32_t delta = 0;
diff --git a/cpp/evs/manager/aidl/wrappers/src/HidlEnumerator.cpp b/cpp/evs/manager/aidl/wrappers/src/HidlEnumerator.cpp
index 767e3aa386..b07007993d 100644
--- a/cpp/evs/manager/aidl/wrappers/src/HidlEnumerator.cpp
+++ b/cpp/evs/manager/aidl/wrappers/src/HidlEnumerator.cpp
@@ -207,7 +207,7 @@ Return<::android::sp<hidlevs::V1_1::IEvsCamera>> HidlEnumerator::openCamera_1_1(
         return nullptr;
     }
 
-    Stream cfg = std::move(Utils::makeFromHidl(hidlCfg));
+    Stream cfg = Utils::makeFromHidl(hidlCfg);
     std::shared_ptr<IEvsCamera> aidlCamera;
     if (auto status = mEnumerator->openCamera(cameraId, cfg, &aidlCamera); !status.isOk()) {
         LOG(ERROR) << "Failed to open a camera " << cameraId
diff --git a/cpp/evs/sampleDriver/aidl/include/EvsEnumerator.h b/cpp/evs/sampleDriver/aidl/include/EvsEnumerator.h
index 313ecb7e58..ac95acadb5 100644
--- a/cpp/evs/sampleDriver/aidl/include/EvsEnumerator.h
+++ b/cpp/evs/sampleDriver/aidl/include/EvsEnumerator.h
@@ -70,6 +70,10 @@ public:
     // Methods from ndk::ICInterface
     binder_status_t dump(int fd, const char** args, uint32_t numArgs) override;
 
+    // Handle a shell command.
+    binder_status_t handleShellCommand(int in, int out, int err, const char** args,
+                                       uint32_t numArgs) override;
+
     // Implementation details
     EvsEnumerator(const std::shared_ptr<
                   ::aidl::android::frameworks::automotive::display::ICarDisplayProxy>&
diff --git a/cpp/evs/sampleDriver/aidl/include/bufferCopy.h b/cpp/evs/sampleDriver/aidl/include/bufferCopy.h
index 21484cc885..ac03c96110 100644
--- a/cpp/evs/sampleDriver/aidl/include/bufferCopy.h
+++ b/cpp/evs/sampleDriver/aidl/include/bufferCopy.h
@@ -37,6 +37,9 @@ void fillYUYVFromYUYV(const ::aidl::android::hardware::automotive::evs::BufferDe
 void fillYUYVFromUYVY(const ::aidl::android::hardware::automotive::evs::BufferDesc& tgtBuff,
                       uint8_t* tgt, void* imgData, unsigned imgStride);
 
+void fillRGBAFromBGRA(const ::aidl::android::hardware::automotive::evs::BufferDesc& tgtBuff,
+                      uint8_t* tgt, void* imgData, unsigned imgStride);
+
 }  // namespace aidl::android::hardware::automotive::evs::implementation
 
 #endif  // CPP_EVS_SAMPLEDRIVER_AIDL_INCLUDE_BUFFERCOPY_H
diff --git a/cpp/evs/sampleDriver/aidl/manifest_android.hardware.automotive.evs-default.xml b/cpp/evs/sampleDriver/aidl/manifest_android.hardware.automotive.evs-default.xml
index ae37ad3f6b..78a32a6273 100644
--- a/cpp/evs/sampleDriver/aidl/manifest_android.hardware.automotive.evs-default.xml
+++ b/cpp/evs/sampleDriver/aidl/manifest_android.hardware.automotive.evs-default.xml
@@ -1,6 +1,7 @@
 <manifest version="1.0" type="device">
     <hal format="aidl">
         <name>android.hardware.automotive.evs</name>
+        <version>2</version>
         <fqname>IEvsEnumerator/hw/1</fqname>
     </hal>
 </manifest>
diff --git a/cpp/evs/sampleDriver/aidl/src/ConfigManager.cpp b/cpp/evs/sampleDriver/aidl/src/ConfigManager.cpp
index 1e31d2f65f..39104428b2 100644
--- a/cpp/evs/sampleDriver/aidl/src/ConfigManager.cpp
+++ b/cpp/evs/sampleDriver/aidl/src/ConfigManager.cpp
@@ -175,8 +175,7 @@ size_t ConfigManager::readCameraCapabilities(const XMLElement* const aCapElem, C
             CameraParam aParam;
             if (ConfigManagerUtil::convertToEvsCameraParam(nameAttr, aParam)) {
                 aCamera->controls.insert_or_assign(aParam,
-                                                   std::move(std::make_tuple(minVal, maxVal,
-                                                                             stepVal)));
+                                                   std::make_tuple(minVal, maxVal, stepVal));
             }
 
             ctrlElem = ctrlElem->NextSiblingElement("control");
@@ -551,8 +550,7 @@ bool ConfigManager::readConfigDataFromBinary() {
         for (size_t idx = 0; idx < sz; ++idx) {
             CameraCtrl temp = *ptr++;
             aCamera->controls.insert_or_assign(temp.cid,
-                                               std::move(std::make_tuple(temp.min, temp.max,
-                                                                         temp.step)));
+                                               std::make_tuple(temp.min, temp.max, temp.step));
         }
         p = reinterpret_cast<char*>(ptr);
 
@@ -657,8 +655,7 @@ bool ConfigManager::readConfigDataFromBinary() {
         for (size_t idx = 0; idx < sz; ++idx) {
             CameraCtrl temp = *ptr++;
             aCamera->controls.insert_or_assign(temp.cid,
-                                               std::move(std::make_tuple(temp.min, temp.max,
-                                                                         temp.step)));
+                                               std::make_tuple(temp.min, temp.max, temp.step));
         }
         p = reinterpret_cast<char*>(ptr);
 
diff --git a/cpp/evs/sampleDriver/aidl/src/EvsEnumerator.cpp b/cpp/evs/sampleDriver/aidl/src/EvsEnumerator.cpp
index b79ed101a6..6b7d4cfd59 100644
--- a/cpp/evs/sampleDriver/aidl/src/EvsEnumerator.cpp
+++ b/cpp/evs/sampleDriver/aidl/src/EvsEnumerator.cpp
@@ -34,7 +34,10 @@
 #include <dirent.h>
 #include <sys/inotify.h>
 
+#include <optional>
+#include <regex>
 #include <string_view>
+#include <variant>
 
 namespace {
 
@@ -55,8 +58,73 @@ constexpr std::string_view kDevicePath = "/dev/";
 constexpr std::string_view kPrefix = "video";
 constexpr size_t kEventBufferSize = 512;
 constexpr uint64_t kInvalidDisplayId = std::numeric_limits<uint64_t>::max();
+constexpr char kAddCameraCmd[] = "add_camera";
+constexpr char kEnumerateCamerasCmd[] = "enumerate_cameras";
+constexpr char kHelp[] = "help";
+constexpr char kShellCmdHelp[] = R"(
+Usage:
+    cmd android.hardware.automotive.evs.IEvsEnumerator/<instance name> command [--option=value]
+
+Available commands:
+  * add_camera
+  * enumerate_cameras
+  * help
+)";
 const std::set<uid_t> kAllowedUids = {AID_AUTOMOTIVE_EVS, AID_SYSTEM, AID_ROOT};
 
+enum class Command {
+    ADD_CAMERA,
+    ENUMERATE_CAMERAS,
+    HELP,
+};
+
+struct CommandWithOptions {
+    Command command;
+    std::map<std::string, std::string> optionToValueMap;
+};
+
+std::variant<CommandWithOptions, std::string> parseShellCommand(const char** args,
+                                                                const uint32_t numArgs) {
+    static const std::regex optionRegex("^--(\\w+)(?:=(.+))?$");
+    static const std::map<std::string, Command> strToCommand{{kHelp, Command::HELP},
+                                                             {kAddCameraCmd, Command::ADD_CAMERA},
+                                                             {kEnumerateCamerasCmd,
+                                                              Command::ENUMERATE_CAMERAS}};
+
+    if (numArgs < 1) {
+        return CommandWithOptions{.command = Command::HELP};
+    }
+
+    auto it = strToCommand.find(args[0]);
+    if (it == strToCommand.end()) {
+        return "Unknown command: " + std::string(args[0]);
+    }
+
+    CommandWithOptions cmd{.command = it->second};
+
+    for (auto i = 1u; i < numArgs; ++i) {
+        std::cmatch cm;
+        if (!std::regex_match(args[i], cm, optionRegex)) {
+            return "Invalid option: " + std::string(args[i]);
+        }
+
+        cmd.optionToValueMap[cm[1]] = cm[2];
+    }
+
+    return cmd;
+}
+
+std::string convertToFourccString(uint32_t fourcc) {
+    std::string result = "";
+
+    while (fourcc != 0) {
+        result += static_cast<uint8_t>(fourcc & 0xFF);
+        fourcc >>= 8;
+    }
+
+    return result;
+}
+
 }  // namespace
 
 namespace aidl::android::hardware::automotive::evs::implementation {
@@ -652,13 +720,18 @@ bool EvsEnumerator::qualifyCaptureDevice(const char* deviceName) {
                 case V4L2_PIX_FMT_XRGB32:
                     found = true;
                     break;
+                case V4L2_PIX_FMT_BGRX32:
+                    found = true;
+                    break;
 #endif  // V4L2_PIX_FMT_ARGB32
                 default:
-                    LOG(WARNING) << "Unsupported, " << std::hex << formatDescription.pixelformat;
+                    LOG(WARNING) << "Unsupported, "
+                                 << convertToFourccString(formatDescription.pixelformat);
                     break;
             }
         } else {
             // No more formats available.
+            LOG(ERROR) << "No format info is available; " << strerror(errno);
             break;
         }
     }
@@ -844,4 +917,62 @@ binder_status_t EvsEnumerator::cmdDump(int fd, const std::vector<std::string>& o
     return STATUS_OK;
 }
 
+binder_status_t EvsEnumerator::handleShellCommand([[maybe_unused]] int in, int out, int err,
+                                                  const char** args, uint32_t numArgs) {
+    if (numArgs < 1) {
+        dprintf(out, kShellCmdHelp);
+        fsync(out);
+        return STATUS_OK;
+    }
+
+    std::variant<CommandWithOptions, std::string> cmdOrErrorMsg = parseShellCommand(args, numArgs);
+
+    if (std::holds_alternative<std::string>(cmdOrErrorMsg)) {
+        dprintf(err, "Error: %s\n", std::get<std::string>(cmdOrErrorMsg).c_str());
+        return STATUS_BAD_VALUE;
+    }
+
+    const CommandWithOptions& cmd = std::get<CommandWithOptions>(cmdOrErrorMsg);
+    binder_status_t status = STATUS_OK;
+    switch (cmd.command) {
+        case Command::ADD_CAMERA: {
+            std::optional<std::string> cameraId;
+            auto it = cmd.optionToValueMap.find("camera_id");
+            if (it == cmd.optionToValueMap.end()) {
+                dprintf(err, "Required argument, \"camera_id\", is not given.");
+                return STATUS_BAD_VALUE;
+            }
+
+            cameraId = it->second;
+            if (!cameraId.has_value()) {
+                dprintf(err, "Invalid value,\"camera_id\": %s", it->second.c_str());
+                return STATUS_BAD_VALUE;
+            }
+
+            // TODO: add an option to skip a device validation.
+
+            if (addCaptureDevice(cameraId.value())) {
+                notifyDeviceStatusChange(cameraId.value(), DeviceStatusType::CAMERA_AVAILABLE);
+            }
+        } break;
+
+        case Command::ENUMERATE_CAMERAS: {
+            enumerateCameras();
+
+            std::lock_guard lock(sLock);
+            for (const auto& [key, value] : sCameraList) {
+                dprintf(out, "%s is added.\n", key.c_str());
+            }
+        } break;
+
+        case Command::HELP:
+            dprintf(out, kShellCmdHelp);
+            break;
+    }
+
+    fsync(err);
+    fsync(out);
+    return status;
+}
+
 }  // namespace aidl::android::hardware::automotive::evs::implementation
diff --git a/cpp/evs/sampleDriver/aidl/src/EvsGlDisplay.cpp b/cpp/evs/sampleDriver/aidl/src/EvsGlDisplay.cpp
index bef01f1600..588694c97c 100644
--- a/cpp/evs/sampleDriver/aidl/src/EvsGlDisplay.cpp
+++ b/cpp/evs/sampleDriver/aidl/src/EvsGlDisplay.cpp
@@ -357,7 +357,7 @@ ScopedAStatus EvsGlDisplay::getTargetBuffer(BufferDesc* _aidl_return) {
     BufferDesc bufferDescToSend = {
             .buffer =
                     {
-                            .handle = std::move(::android::dupToAidl(mBuffer.handle)),
+                            .handle = ::android::dupToAidl(mBuffer.handle),
                             .description = mBuffer.description,
                     },
             .pixelSizeBytes = 4,  // RGBA_8888 is 4-byte-per-pixel format
diff --git a/cpp/evs/sampleDriver/aidl/src/EvsV4lCamera.cpp b/cpp/evs/sampleDriver/aidl/src/EvsV4lCamera.cpp
index f9338c641b..5226e309c1 100644
--- a/cpp/evs/sampleDriver/aidl/src/EvsV4lCamera.cpp
+++ b/cpp/evs/sampleDriver/aidl/src/EvsV4lCamera.cpp
@@ -185,6 +185,9 @@ ScopedAStatus EvsV4lCamera::startVideoStream(const std::shared_ptr<IEvsCameraStr
                 case V4L2_PIX_FMT_YUYV:
                     mFillBufferFromVideo = fillRGBAFromYUYV;
                     break;
+                case V4L2_PIX_FMT_BGRX32:
+                    mFillBufferFromVideo = fillRGBAFromBGRA;
+                    break;
                 default:
                     LOG(ERROR) << "Unhandled camera source format " << (char*)&videoSrcFormat;
             }
@@ -436,7 +439,7 @@ ScopedAStatus EvsV4lCamera::importExternalBuffers(const std::vector<BufferDesc>&
 
             if (!stored) {
                 // Add a BufferRecord wrapping this handle to our set of available buffers
-                mBuffers.push_back(std::move(BufferRecord(memHandle)));
+                mBuffers.push_back(BufferRecord(memHandle));
             }
 
             ++mFramesAllowed;
@@ -614,7 +617,7 @@ unsigned EvsV4lCamera::increaseAvailableFrames_Locked(unsigned numToAdd) {
         }
         if (!stored) {
             // Add a BufferRecord wrapping this handle to our set of available buffers
-            mBuffers.push_back(std::move(BufferRecord(memHandle)));
+            mBuffers.push_back(BufferRecord(memHandle));
         }
 
         ++mFramesAllowed;
diff --git a/cpp/evs/sampleDriver/aidl/src/VideoCapture.cpp b/cpp/evs/sampleDriver/aidl/src/VideoCapture.cpp
index d0e9009be8..f12c2feed5 100644
--- a/cpp/evs/sampleDriver/aidl/src/VideoCapture.cpp
+++ b/cpp/evs/sampleDriver/aidl/src/VideoCapture.cpp
@@ -341,5 +341,5 @@ std::set<uint32_t> VideoCapture::enumerateCameraControls() {
         PLOG(WARNING) << "Failed to run VIDIOC_QUERYCTRL";
     }
 
-    return std::move(ctrlIDs);
+    return ctrlIDs;
 }
diff --git a/cpp/evs/sampleDriver/aidl/src/bufferCopy.cpp b/cpp/evs/sampleDriver/aidl/src/bufferCopy.cpp
index 8d70d6afd2..167ad6bd31 100644
--- a/cpp/evs/sampleDriver/aidl/src/bufferCopy.cpp
+++ b/cpp/evs/sampleDriver/aidl/src/bufferCopy.cpp
@@ -136,6 +136,16 @@ void fillRGBAFromYUYV(const BufferDesc& tgtBuff, uint8_t* tgt, void* imgData, un
     }
 }
 
+void fillRGBAFromBGRA(const BufferDesc& tgtBuff, uint8_t* tgt, void* imgData, unsigned imgStride) {
+    const AHardwareBuffer_Desc* pDesc =
+            reinterpret_cast<const AHardwareBuffer_Desc*>(&tgtBuff.buffer.description);
+    auto result = libyuv::ABGRToARGB((const uint8_t*)imgData, imgStride, tgt, imgStride,
+                                     pDesc->width, pDesc->height);
+    if (result) {
+        LOG(ERROR) << "Failed to convert BGRA to RGBA.";
+    }
+}
+
 void fillYUYVFromYUYV(const BufferDesc& tgtBuff, uint8_t* tgt, void* imgData, unsigned imgStride) {
     const AHardwareBuffer_Desc* pDesc =
             reinterpret_cast<const AHardwareBuffer_Desc*>(&tgtBuff.buffer.description);
diff --git a/cpp/evs/sampleDriver/hidl/VideoCapture.cpp b/cpp/evs/sampleDriver/hidl/VideoCapture.cpp
index ff2de962b2..71a4330220 100644
--- a/cpp/evs/sampleDriver/hidl/VideoCapture.cpp
+++ b/cpp/evs/sampleDriver/hidl/VideoCapture.cpp
@@ -341,5 +341,5 @@ std::set<uint32_t> VideoCapture::enumerateCameraControls() {
         PLOG(WARNING) << "Failed to run VIDIOC_QUERYCTRL";
     }
 
-    return std::move(ctrlIDs);
+    return ctrlIDs;
 }
diff --git a/cpp/packagemanagerproxy/OWNERS b/cpp/packagemanagerproxy/OWNERS
new file mode 100644
index 0000000000..e7e0caebf8
--- /dev/null
+++ b/cpp/packagemanagerproxy/OWNERS
@@ -0,0 +1,4 @@
+briandaniels@google.com
+radsaggi@google.com
+hnandagopal@google.com
+sgurun@google.com
diff --git a/cpp/packagemanagerproxy/service/Android.bp b/cpp/packagemanagerproxy/service/Android.bp
new file mode 100644
index 0000000000..2117158826
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/Android.bp
@@ -0,0 +1,49 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+package {
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+cc_binary {
+    name: "packagemanagerproxyd",
+    srcs: ["**/*.cpp"],
+    cflags: [
+        "-DLOG_TAG=\"packagemanagerproxyd\"",
+        "-Wall",
+        "-Wno-missing-field-initializers",
+        "-Werror",
+        "-Wno-unused-variable",
+        "-Wunused-parameter",
+    ],
+    local_include_dirs: ["include"],
+    shared_libs: [
+        "google.sdv.packagemanagerproxy-V1-ndk",
+        "libaconfig_storage_read_api_cc",
+        "libcutils",
+        "libbase",
+        "libbinder",
+        "libbinder_ndk",
+        "liblog",
+        "libutils",
+        "packagemanager_aidl-cpp",
+        "server_configurable_flags",
+    ],
+    static_libs: [
+        "android.car.feature-aconfig-cpp",
+    ],
+    init_rc: ["packagemanagerproxyd.rc"],
+    vintf_fragments: ["manifest_packagemanagerproxyd.xml"],
+    system_ext_specific: true,
+}
diff --git a/cpp/packagemanagerproxy/service/include/PackageManagerProxy.h b/cpp/packagemanagerproxy/service/include/PackageManagerProxy.h
new file mode 100644
index 0000000000..b9adeef605
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/include/PackageManagerProxy.h
@@ -0,0 +1,57 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+#pragma once
+
+#include <aidl/google/sdv/packagemanagerproxy/BnPackageManagerProxy.h>
+#include <aidl/google/sdv/packagemanagerproxy/IPackageManagerProxy.h>
+#include <android-base/result.h>
+#include <android/content/pm/IPackageManagerNative.h>
+
+#include <string>
+#include <vector>
+
+namespace google {
+namespace sdv {
+namespace packagemanagerproxy {
+
+/**
+ * This class implements the IPackageManagerProxy AIDL interface.
+ *
+ * Once binder is setup for the process, create an instance of this class
+ * and call init() on the object. This will wait for the IPackageManagerNative
+ * service, then reigster itself with service manager as a provider of the
+ * IPackageManagerProxy interface.
+ */
+class PackageManagerProxy : public aidl::google::sdv::packagemanagerproxy::BnPackageManagerProxy {
+public:
+    android::base::Result<void> init();
+
+    // Implements IPackageManagerProxy.aidl interfaces.
+    ndk::ScopedAStatus getNamesForUids(const std::vector<int32_t>& uids,
+                                       std::vector<std::string>* _aidl_return) override;
+    ndk::ScopedAStatus getPackageUid(const std::string& packageName, int64_t flags, int32_t userId,
+                                     int32_t* _aidl_return) override;
+    ndk::ScopedAStatus getVersionCodeForPackage(const std::string& packageName,
+                                                int64_t* _aidl_return) override;
+
+private:
+    android::sp<android::content::pm::IPackageManagerNative> mPackageManagerNativeService;
+};
+
+}  // namespace packagemanagerproxy
+}  // namespace sdv
+}  // namespace google
diff --git a/cpp/packagemanagerproxy/service/manifest_packagemanagerproxyd.xml b/cpp/packagemanagerproxy/service/manifest_packagemanagerproxyd.xml
new file mode 100644
index 0000000000..3dc950ef55
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/manifest_packagemanagerproxyd.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<manifest version="1.0" type="framework" >
+    <hal format="aidl">
+        <name>google.sdv.packagemanagerproxy</name>
+        <fqname>IPackageManagerProxy/default</fqname>
+        <version>1</version>
+    </hal>
+</manifest>
diff --git a/Android.mk b/cpp/packagemanagerproxy/service/packagemanagerproxyd.rc
similarity index 69%
rename from Android.mk
rename to cpp/packagemanagerproxy/service/packagemanagerproxyd.rc
index d3d308469a..27a8e4482c 100644
--- a/Android.mk
+++ b/cpp/packagemanagerproxy/service/packagemanagerproxyd.rc
@@ -1,4 +1,4 @@
-# Copyright (C) 2015 The Android Open Source Project
+# Copyright (C) 2024 The Android Open Source Project
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
@@ -11,12 +11,12 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-#
-LOCAL_PATH := $(call my-dir)
-
-$(eval $(call declare-1p-copy-files,packages/services/Car,))
 
-include $(CLEAR_VARS)
+service packagemanagerproxyd /system_ext/bin/packagemanagerproxyd
+    class core
+    user system
+    group system
+    disabled  # starts below on boot
 
-# Include the sub-makefiles
-include $(call all-makefiles-under,$(LOCAL_PATH))
+on boot
+    start packagemanagerproxyd
diff --git a/cpp/packagemanagerproxy/service/products/packagemanagerproxy.mk b/cpp/packagemanagerproxy/service/products/packagemanagerproxy.mk
new file mode 100644
index 0000000000..ea45ed9665
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/products/packagemanagerproxy.mk
@@ -0,0 +1,18 @@
+# Copyright (C) 2024 The Android Open Source Project
+
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#      http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+PRODUCT_PACKAGES += packagemanagerproxyd
+
+SYSTEM_EXT_PRIVATE_SEPOLICY_DIRS += packages/services/Car/cpp/packagemanagerproxy/service/sepolicy/private
+SYSTEM_EXT_PUBLIC_SEPOLICY_DIRS += packages/services/Car/cpp/packagemanagerproxy/service/sepolicy/public
diff --git a/cpp/packagemanagerproxy/service/sepolicy/private/file_contexts b/cpp/packagemanagerproxy/service/sepolicy/private/file_contexts
new file mode 100644
index 0000000000..3db8302cd4
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/sepolicy/private/file_contexts
@@ -0,0 +1 @@
+/(system_ext|system/system_ext)/bin/packagemanagerproxyd  u:object_r:packagemanagerproxyd_exec:s0
diff --git a/cpp/packagemanagerproxy/service/sepolicy/private/packagemanagerproxyd.te b/cpp/packagemanagerproxy/service/sepolicy/private/packagemanagerproxyd.te
new file mode 100644
index 0000000000..96de64b40f
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/sepolicy/private/packagemanagerproxyd.te
@@ -0,0 +1,34 @@
+# Define the packagemanagerpoxyd type
+type packagemanagerproxyd, domain;
+
+# Add to the coredomain since it lives in /system_ext
+typeattribute packagemanagerproxyd coredomain;
+
+typeattribute packagemanagerproxyd mlstrustedsubject;
+
+# Use the attribytes of packagemanagerproxy_server
+typeattribute packagemanagerproxyd packagemanagerproxy_server;
+
+# Declare the exec type
+type packagemanagerproxyd_exec, exec_type, system_file_type, file_type;
+
+# Allow packagemanagerproxyd to be launced by init
+init_daemon_domain(packagemanagerproxyd)
+
+# Allow use of Binder IPCs
+binder_use(packagemanagerproxyd)
+
+# The packagemanagerproxy server can call the system_server
+binder_call(packagemanagerproxy_server, system_server)
+
+# Allow the packagemanagerproxy server to find the package_native_service
+allow packagemanagerproxy_server package_native_service:service_manager find;
+
+# The packagemanagerproxy server can register the IPackageMangerProxy Binder IPC service.
+add_service(packagemanagerproxy_server, packagemanagerproxyd_service)
+
+# The packagemanagerproxy client can call the server via Binder IPC.
+binder_call(packagemanagerproxy_client, packagemanagerproxy_server)
+
+# The packagemanagerproxy client has access to the IPackageMangerProxy Binder IPC service.
+allow packagemanagerproxy_client packagemanagerproxyd_service:service_manager find;
diff --git a/cpp/packagemanagerproxy/service/sepolicy/private/service.te b/cpp/packagemanagerproxy/service/sepolicy/private/service.te
new file mode 100644
index 0000000000..f6b0840afb
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/sepolicy/private/service.te
@@ -0,0 +1 @@
+type packagemanagerproxyd_service, protected_service, service_manager_type;
diff --git a/cpp/packagemanagerproxy/service/sepolicy/private/service_contexts b/cpp/packagemanagerproxy/service/sepolicy/private/service_contexts
new file mode 100644
index 0000000000..371033cdfb
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/sepolicy/private/service_contexts
@@ -0,0 +1 @@
+google.sdv.packagemanagerproxy.IPackageManagerProxy/default u:object_r:packagemanagerproxyd_service:s0
diff --git a/cpp/packagemanagerproxy/service/sepolicy/public/attributes b/cpp/packagemanagerproxy/service/sepolicy/public/attributes
new file mode 100644
index 0000000000..43845774a1
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/sepolicy/public/attributes
@@ -0,0 +1,6 @@
+attribute packagemanagerproxy_client;
+attribute packagemanagerproxy_server;
+
+# Following the setup used for expansion options in the `hal_attribute()`.
+expandattribute packagemanagerproxy_client true;
+expandattribute packagemanagerproxy_server false;
diff --git a/cpp/packagemanagerproxy/service/src/PackageManagerProxy.cpp b/cpp/packagemanagerproxy/service/src/PackageManagerProxy.cpp
new file mode 100644
index 0000000000..dcf8f3b107
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/src/PackageManagerProxy.cpp
@@ -0,0 +1,122 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+#include "PackageManagerProxy.h"
+
+#include <android-base/properties.h>
+#include <android/binder_manager.h>
+#include <binder/IPCThreadState.h>
+#include <binder/IServiceManager.h>
+#include <log/log.h>
+#include <utils/Looper.h>
+
+#include <android_car_feature.h>
+
+#include <sstream>
+
+namespace google {
+namespace sdv {
+namespace packagemanagerproxy {
+
+namespace {
+
+using ::aidl::google::sdv::packagemanagerproxy::IPackageManagerProxy;
+using ::android::IBinder;
+using ::android::interface_cast;
+using ::android::IServiceManager;
+using ::android::sp;
+using ::android::String16;
+using ::android::base::Error;
+using ::android::base::GetProperty;
+using ::android::base::Result;
+using ::android::content::pm::IPackageManagerNative;
+using ::ndk::ScopedAStatus;
+
+}  // namespace
+
+Result<void> PackageManagerProxy::init() {
+    // If the feature flag is not enabled, do not initialize the service
+    if (!android::car::feature::package_manager_extensions_for_sdv()) {
+        ALOGI("Flag package_manager_extensions_for_sdv disabled, disabling service");
+        return {};
+    }
+
+    sp<IServiceManager> serviceManager = android::defaultServiceManager();
+    if (serviceManager.get() == nullptr) {
+        return Error() << __func__ << ": unable to access native ServiceManager";
+    }
+
+    sp<IBinder> binder = serviceManager->waitForService(String16("package_native"));
+    mPackageManagerNativeService = interface_cast<IPackageManagerNative>(binder);
+    if (mPackageManagerNativeService == nullptr) {
+        return Error() << __func__ << ": unable to access native PackageManager";
+    }
+
+    const auto instanceName = std::string(IPackageManagerProxy::descriptor) + "/default";
+    const binder_exception_t err =
+            AServiceManager_addService(this->asBinder().get(), instanceName.data());
+    if (err != EX_NONE) {
+        return Error(err) << "Failed to add IPackageManagerProxy to ServiceManager";
+    }
+
+    return {};
+}
+
+ndk::ScopedAStatus PackageManagerProxy::getNamesForUids(const std::vector<int32_t>& uids,
+                                                        std::vector<std::string>* _aidl_return) {
+    const auto result = mPackageManagerNativeService->getNamesForUids(uids, _aidl_return);
+
+    if (!result.isOk()) {
+        return ScopedAStatus::fromServiceSpecificErrorWithMessage(result.exceptionCode(),
+                                                                  result.exceptionMessage()
+                                                                          .c_str());
+    }
+
+    return ScopedAStatus::ok();
+}
+
+ndk::ScopedAStatus PackageManagerProxy::getPackageUid(const std::string& packageName, int64_t flags,
+                                                      int32_t userId, int32_t* _aidl_return) {
+    const auto result =
+            mPackageManagerNativeService->getPackageUid(packageName, flags, userId, _aidl_return);
+
+    if (!result.isOk()) {
+        return ScopedAStatus::fromServiceSpecificErrorWithMessage(result.exceptionCode(),
+                                                                  result.exceptionMessage()
+                                                                          .c_str());
+    }
+
+    return ScopedAStatus::ok();
+}
+
+ndk::ScopedAStatus PackageManagerProxy::getVersionCodeForPackage(const std::string& packageName,
+                                                                 int64_t* _aidl_return) {
+    const String16 packageNameString16(packageName.c_str(), packageName.length());
+    const auto result = mPackageManagerNativeService->getVersionCodeForPackage(packageNameString16,
+                                                                               _aidl_return);
+
+    if (!result.isOk()) {
+        return ScopedAStatus::fromServiceSpecificErrorWithMessage(result.exceptionCode(),
+                                                                  result.exceptionMessage()
+                                                                          .c_str());
+    }
+
+    return ScopedAStatus::ok();
+}
+
+}  // namespace packagemanagerproxy
+}  // namespace sdv
+}  // namespace google
diff --git a/cpp/packagemanagerproxy/service/src/main.cpp b/cpp/packagemanagerproxy/service/src/main.cpp
new file mode 100644
index 0000000000..724748b9a8
--- /dev/null
+++ b/cpp/packagemanagerproxy/service/src/main.cpp
@@ -0,0 +1,61 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+#include "PackageManagerProxy.h"
+
+#include <binder/ProcessState.h>
+#include <log/log.h>
+#include <utils/Looper.h>
+#include <utils/StrongPointer.h>
+
+namespace {
+
+using ::android::Looper;
+using ::android::ProcessState;
+using ::android::sp;
+using ::google::sdv::packagemanagerproxy::PackageManagerProxy;
+
+// Setting the maximum number of Binder threads to 2 was an arbitrary choice,
+// it can be modified if needed.
+constexpr size_t kMaxBinderThreadCount = 2;
+
+}  // namespace
+
+int main(int /*argc*/, char** /*argv*/) {
+    // Set up the binder
+    sp<ProcessState> ps(ProcessState::self());
+    ps->setThreadPoolMaxThreadCount(kMaxBinderThreadCount);
+    ps->startThreadPool();
+    ps->giveThreadPoolName();
+
+    sp<Looper> looper(Looper::prepare(/*opts=*/0));
+
+    // Start the PackageManagerProxy service
+    PackageManagerProxy service;
+    auto result = service.init();
+    if (!result.ok()) {
+        ALOGE("Failed to start service: %s", result.error().message().c_str());
+        exit(result.error().code());
+    }
+
+    ALOGI("packagemanagerproxyd server started.");
+
+    while (true) {
+        looper->pollAll(/*timeoutMillis=*/-1);
+    }
+
+    return 0;
+}
diff --git a/cpp/packagemanagerproxy/testclient/Android.bp b/cpp/packagemanagerproxy/testclient/Android.bp
new file mode 100644
index 0000000000..1d733c3197
--- /dev/null
+++ b/cpp/packagemanagerproxy/testclient/Android.bp
@@ -0,0 +1,31 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+package {
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+cc_binary {
+    name: "packagemanagerproxyd_testclient",
+    srcs: ["src/*.cpp"],
+    shared_libs: [
+        "libbinder_ndk",
+        "libbinder",
+        "liblog",
+        "libbase",
+        "libutils",
+        "google.sdv.packagemanagerproxy-V1-ndk",
+    ],
+    vendor: true,
+}
diff --git a/cpp/packagemanagerproxy/testclient/README.md b/cpp/packagemanagerproxy/testclient/README.md
new file mode 100644
index 0000000000..0c8c0d38f3
--- /dev/null
+++ b/cpp/packagemanagerproxy/testclient/README.md
@@ -0,0 +1,54 @@
+<!--
+  Copyright (C) 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License
+  -->
+
+# PackageManagerProxyd Test Client
+
+This client can be used to test the IPackageManagerProxy interface from the `/vendor` partition. To do so, build and start the VM:
+
+```
+lunch sdv_ivi_cf-trunk_staging-userdebug
+m
+cvd start
+```
+
+After the VM is started, launch a vendor shell:
+
+```
+abd shell /vendor/bin/sh
+```
+
+You will not get a shell prompt, so on the blank line that appears run the following command:
+
+```
+/vendor/bin/packagemanagerproxyd_testclient <package name>
+```
+
+`<package name>` should be replaced with a valid package name, for example:
+
+```
+/vendor/bin/packagemanagerproxyd_testclient com.google.android.car.evs
+```
+
+
+You should receive output similar to the following (the Uid and Version Code may diff from the example given):
+
+```
+Fetching package info for "com.google.android.car.evs"
+Uid: 10122
+Version Code: 35
+```
+
+If the output is incomplete, check logcat for selinux denials.
diff --git a/cpp/packagemanagerproxy/testclient/products/packagemanagerproxy.mk b/cpp/packagemanagerproxy/testclient/products/packagemanagerproxy.mk
new file mode 100644
index 0000000000..829fbb9787
--- /dev/null
+++ b/cpp/packagemanagerproxy/testclient/products/packagemanagerproxy.mk
@@ -0,0 +1,17 @@
+# Copyright (C) 2024 The Android Open Source Project
+
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#      http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+PRODUCT_PACKAGES += packagemanagerproxyd_testclient
+
+BOARD_VENDOR_SEPOLICY_DIRS += packages/services/Car/cpp/packagemanagerproxy/testclient/sepolicy
diff --git a/cpp/packagemanagerproxy/testclient/sepolicy/file_contexts b/cpp/packagemanagerproxy/testclient/sepolicy/file_contexts
new file mode 100644
index 0000000000..33660b81c3
--- /dev/null
+++ b/cpp/packagemanagerproxy/testclient/sepolicy/file_contexts
@@ -0,0 +1 @@
+/vendor/bin/packagemanagerproxyd_testclient  u:object_r:packagemanagerproxyd_testclient_exec:s0
diff --git a/cpp/packagemanagerproxy/testclient/sepolicy/packagemanagerd_testclient.te b/cpp/packagemanagerproxy/testclient/sepolicy/packagemanagerd_testclient.te
new file mode 100644
index 0000000000..6c91b16996
--- /dev/null
+++ b/cpp/packagemanagerproxy/testclient/sepolicy/packagemanagerd_testclient.te
@@ -0,0 +1,15 @@
+type packagemanagerproxyd_testclient, domain, packagemanagerproxy_client;
+
+type packagemanagerproxyd_testclient_exec, vendor_file_type, exec_type, file_type;
+
+# Allow use of Binder IPCs
+binder_use(packagemanagerproxyd_testclient)
+
+# Allow the sample to be launched from the vendor_shell, and make it transition to the
+# `packagemanagerproxyd_testclient` domain when launched.
+domain_auto_trans(vendor_shell, packagemanagerproxyd_testclient_exec, packagemanagerproxyd_testclient)
+allow packagemanagerproxyd_testclient vendor_shell:fd use;
+
+# Allow the use of socket file descriptors
+allow packagemanagerproxyd_testclient adbd:fd use;
+allow packagemanagerproxyd_testclient adbd:unix_stream_socket { getattr read write };
diff --git a/cpp/packagemanagerproxy/testclient/src/main.cpp b/cpp/packagemanagerproxy/testclient/src/main.cpp
new file mode 100644
index 0000000000..3878e1359b
--- /dev/null
+++ b/cpp/packagemanagerproxy/testclient/src/main.cpp
@@ -0,0 +1,98 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+#define LOG_TAG "PackageManagerProxyTest"
+
+#include <aidl/google/sdv/packagemanagerproxy/IPackageManagerProxy.h>
+#include <android/binder_manager.h>
+#include <log/log.h>
+
+#include <iostream>
+
+namespace {
+
+using ::aidl::google::sdv::packagemanagerproxy::IPackageManagerProxy;
+
+}  // namespace
+
+int main(int argc, char** argv) {
+    ALOGI("PackageManagerProxy Test Client started.");
+
+    std::string packageName;
+
+    if (argc == 2) {
+        packageName = argv[1];
+    } else {
+        std::cerr << "Usage: proxymanagerproxyd_testclient <package name>" << std::endl;
+        return 1;
+    }
+
+    auto myService =
+            IPackageManagerProxy::fromBinder(ndk::SpAIBinder(AServiceManager_waitForService(
+                    "google.sdv.packagemanagerproxy.IPackageManagerProxy/default")));
+
+    std::cout << "Fetching package info for \"" << packageName << "\"" << std::endl;
+
+    // Uid
+    int32_t uid = 0;
+    auto result = myService->getPackageUid(packageName, /*flags=*/0, /*userId=*/0, &uid);
+    if (!result.isOk()) {
+        ALOGE("getPackageUid failed: (%d, %d), %s", result.getExceptionCode(),
+              result.getServiceSpecificError(), result.getMessage());
+        return 1;
+    }
+
+    std::cout << "Uid: " << uid << std::endl;
+
+    // Version code
+    int64_t versionCode = 0;
+    result = myService->getVersionCodeForPackage(packageName, &versionCode);
+
+    if (!result.isOk()) {
+        ALOGE("getVersionCodeForPackage failed: (%d, %d), %s", result.getExceptionCode(),
+              result.getServiceSpecificError(), result.getMessage());
+        return 1;
+    }
+
+    std::cout << "Version Code: " << versionCode << std::endl;
+
+    // Validate getting package name by uid
+    std::vector<int32_t> uids = {uid};
+    std::vector<std::string> fetchedPackageNames;
+    result = myService->getNamesForUids(uids, &fetchedPackageNames);
+
+    if (!result.isOk()) {
+        ALOGE("getNamesForUids failed: (%d, %d), %s", result.getExceptionCode(),
+              result.getServiceSpecificError(), result.getMessage());
+        return 1;
+    }
+
+    if (fetchedPackageNames.size() != 1) {
+        ALOGE("Expected 1 returned package name, actually received %zu",
+              fetchedPackageNames.size());
+        return 1;
+    }
+
+    if (fetchedPackageNames[0] != packageName) {
+        ALOGE("Package names do not match. Received: \"%s\", expected: \"%s\"",
+              fetchedPackageNames[0].c_str(), packageName.c_str());
+        return 1;
+    }
+
+    std::cout << "Fetched package name from Uid: " << fetchedPackageNames[0] << std::endl;
+
+    return 0;
+}
diff --git a/cpp/powerpolicy/client/include/PowerPolicyClientBase.h b/cpp/powerpolicy/client/include/PowerPolicyClientBase.h
index 79fd646e4a..26c0d9d47a 100644
--- a/cpp/powerpolicy/client/include/PowerPolicyClientBase.h
+++ b/cpp/powerpolicy/client/include/PowerPolicyClientBase.h
@@ -21,7 +21,9 @@
 #include <aidl/android/frameworks/automotive/powerpolicy/BnCarPowerPolicyServer.h>
 #include <aidl/android/frameworks/automotive/powerpolicy/CarPowerPolicyFilter.h>
 #include <android-base/result.h>
+#include <android-base/thread_annotations.h>
 
+#include <condition_variable>  // NOLINT
 #include <shared_mutex>
 #include <thread>  // NOLINT(build/c++11)
 #include <vector>
@@ -61,7 +63,8 @@ class PowerPolicyClientBase :
 public:
     static void onBinderDied(void* cookie);
 
-    // When initialization fails, this callback is invoked from a thread other than the main thread.
+    // When initialization fails, this callback is invoked from a (connection) thread other than the
+    // main thread.
     virtual void onInitFailed() {}
 
     // Implement this method to specify components of interest.
@@ -74,6 +77,10 @@ public:
     // init makes connection to power policy daemon and registers to policy change in the
     // background. Call this method one time when you want to listen to power policy changes.
     void init();
+    // release unregisters client callback from power policy daemon.
+    // Call this method one time when you do not want to listen to power policy changes.
+    // It blocks caller's thread by awaiting for connection thread join.
+    void release();
 
     void handleBinderDeath();
 
@@ -84,11 +91,20 @@ protected:
 private:
     android::base::Result<void> connectToDaemon();
 
-    std::thread mConnectionThread;
-    mutable std::shared_mutex mRWMutex;
+    std::mutex mLock;
+    std::thread mConnectionThread GUARDED_BY(mLock);
     std::shared_ptr<::aidl::android::frameworks::automotive::powerpolicy::ICarPowerPolicyServer>
-            mPolicyServer = nullptr;  // GUARDED_BY(mRWMutext)
+            mPolicyServer;
+    std::shared_ptr<ICarPowerPolicyChangeCallback> mPolicyChangeCallback;
     ::ndk::ScopedAIBinder_DeathRecipient mDeathRecipient;
+    std::atomic<bool> mConnecting;
+    bool mDisconnecting GUARDED_BY(mLock);
+    std::condition_variable mDeathRecipientLinkedCv;
+    bool mDeathRecipientLinked GUARDED_BY(mLock) = false;
+
+    static void onDeathRecipientUnlinked(void* cookie);
+
+    void handleDeathRecipientUnlinked();
 };
 
 }  // namespace powerpolicy
diff --git a/cpp/powerpolicy/client/src/PowerPolicyClientBase.cpp b/cpp/powerpolicy/client/src/PowerPolicyClientBase.cpp
index 9f5d85d67a..9439f14940 100644
--- a/cpp/powerpolicy/client/src/PowerPolicyClientBase.cpp
+++ b/cpp/powerpolicy/client/src/PowerPolicyClientBase.cpp
@@ -48,7 +48,6 @@ constexpr const char* kPowerPolicyServerInterface =
         "android.frameworks.automotive.powerpolicy.ICarPowerPolicyServer/default";
 
 constexpr std::chrono::milliseconds kPowerPolicyDaemomFindMarginalTimeMs = 500ms;
-constexpr int32_t kMaxConnectionAttempt = 5;
 
 }  // namespace
 
@@ -59,17 +58,22 @@ bool hasComponent(const std::vector<PowerComponent>& components, PowerComponent
 }
 
 PowerPolicyClientBase::PowerPolicyClientBase() :
-      mDeathRecipient(AIBinder_DeathRecipient_new(PowerPolicyClientBase::onBinderDied)) {}
+      mPolicyServer(nullptr),
+      mPolicyChangeCallback(nullptr),
+      mDeathRecipient(AIBinder_DeathRecipient_new(PowerPolicyClientBase::onBinderDied)),
+      mConnecting(false),
+      mDisconnecting(false) {
+    AIBinder_DeathRecipient_setOnUnlinked(mDeathRecipient.get(),
+                                          &PowerPolicyClientBase::onDeathRecipientUnlinked);
+}
 
 PowerPolicyClientBase::~PowerPolicyClientBase() {
-    if (mPolicyServer != nullptr) {
-        auto status =
-                ScopedAStatus::fromStatus(AIBinder_unlinkToDeath(mPolicyServer->asBinder().get(),
-                                                                 mDeathRecipient.get(), nullptr));
-        if (!status.isOk()) {
-            LOG(WARNING) << "Unlinking from death recipient failed";
-        }
-    }
+    release();
+}
+
+void PowerPolicyClientBase::onDeathRecipientUnlinked(void* cookie) {
+    PowerPolicyClientBase* client = static_cast<PowerPolicyClientBase*>(cookie);
+    client->handleDeathRecipientUnlinked();
 }
 
 void PowerPolicyClientBase::onBinderDied(void* cookie) {
@@ -77,41 +81,107 @@ void PowerPolicyClientBase::onBinderDied(void* cookie) {
     client->handleBinderDeath();
 }
 
+void PowerPolicyClientBase::release() {
+    SpAIBinder binder;
+    std::shared_ptr<ICarPowerPolicyServer> policyServer;
+    std::shared_ptr<ICarPowerPolicyChangeCallback> policyChangeCallback;
+    {
+        std::lock_guard<std::mutex> lk(mLock);
+
+        if (std::this_thread::get_id() == mConnectionThread.get_id()) {
+            LOG(ERROR) << "Cannot release from callback, deadlock would happen";
+            return;
+        }
+
+        // wait for existing connection thread to finish
+        mConnecting = false;
+        if (mConnectionThread.joinable()) {
+            mConnectionThread.join();
+        }
+
+        if (mPolicyServer == nullptr || mDisconnecting == true) {
+            return;
+        }
+
+        mDisconnecting = true;
+        binder = mPolicyServer->asBinder();
+        policyServer = mPolicyServer;
+        policyChangeCallback = mPolicyChangeCallback;
+    }
+
+    if (binder.get() != nullptr && AIBinder_isAlive(binder.get())) {
+        auto status = policyServer->unregisterPowerPolicyChangeCallback(policyChangeCallback);
+        if (!status.isOk()) {
+            LOG(ERROR) << "Unregister power policy change callback failed";
+        }
+
+        status = ScopedAStatus::fromStatus(
+                AIBinder_unlinkToDeath(binder.get(), mDeathRecipient.get(), this));
+        if (!status.isOk()) {
+            LOG(WARNING) << "Unlinking from death recipient failed";
+        }
+
+        // Need to wait until onUnlinked to be called.
+        {
+            std::unique_lock lk(mLock);
+            mDeathRecipientLinkedCv.wait(lk, [this] { return !mDeathRecipientLinked; });
+        }
+    }
+
+    {
+        std::lock_guard<std::mutex> lk(mLock);
+        mPolicyServer = nullptr;
+        mPolicyChangeCallback = nullptr;
+        mDisconnecting = false;
+    }
+}
+
 void PowerPolicyClientBase::init() {
+    std::lock_guard<std::mutex> lk(mLock);
+
+    if (mConnecting) {
+        LOG(WARNING) << "Connecting in progress";
+        return;
+    }
+
+    if (mPolicyServer != nullptr) {
+        LOG(WARNING) << "Already connected";
+        return;
+    }
+
+    mConnecting = true;
+    // ensure already finished old connection thread is cleaned up before creating new one
+    if (mConnectionThread.joinable()) {
+        mConnectionThread.join();
+    }
     mConnectionThread = std::thread([this]() {
-        Result<void> ret;
-        int attemptCount = 1;
-        while (attemptCount <= kMaxConnectionAttempt) {
-            ret = connectToDaemon();
-            if (ret.ok()) {
-                return;
-            }
-            LOG(WARNING) << "Connection attempt #" << attemptCount << " failed: " << ret.error();
-            attemptCount++;
+        Result<void> ret = connectToDaemon();
+        mConnecting = false;
+        if (!ret.ok()) {
+            LOG(WARNING) << "Connecting to car power policy daemon failed: " << ret.error();
+            onInitFailed();
         }
-        onInitFailed();
     });
 }
 
 void PowerPolicyClientBase::handleBinderDeath() {
     LOG(INFO) << "Power policy daemon died. Reconnecting...";
-    {
-        std::unique_lock writeLock(mRWMutex);
-        mPolicyServer = nullptr;
-    }
+    release();
     init();
 }
 
-Result<void> PowerPolicyClientBase::connectToDaemon() {
+void PowerPolicyClientBase::handleDeathRecipientUnlinked() {
+    LOG(INFO) << "Power policy death recipient unlinked";
     {
-        std::shared_lock readLock(mRWMutex);
-        if (mPolicyServer.get() != nullptr) {
-            LOG(INFO) << "Power policy daemon is already connected";
-            return {};
-        }
+        std::lock_guard<std::mutex> lk(mLock);
+        mDeathRecipientLinked = false;
     }
+    mDeathRecipientLinkedCv.notify_all();
+}
+
+Result<void> PowerPolicyClientBase::connectToDaemon() {
     int64_t currentUptime = uptimeMillis();
-    SpAIBinder binder(AServiceManager_getService(kPowerPolicyServerInterface));
+    SpAIBinder binder(AServiceManager_waitForService(kPowerPolicyServerInterface));
     if (binder.get() == nullptr) {
         return Error() << "Failed to get car power policy daemon";
     }
@@ -127,6 +197,7 @@ Result<void> PowerPolicyClientBase::connectToDaemon() {
     if (binder.get() == nullptr) {
         return Error() << "Failed to get car power policy client binder object";
     }
+    mDeathRecipientLinked = true;
     auto status = ScopedAStatus::fromStatus(
             AIBinder_linkToDeath(server->asBinder().get(), mDeathRecipient.get(), this));
     if (!status.isOk()) {
@@ -142,18 +213,16 @@ Result<void> PowerPolicyClientBase::connectToDaemon() {
     filter.customComponents = customComponents;
     status = server->registerPowerPolicyChangeCallback(client, filter);
     if (!status.isOk()) {
-        status = ScopedAStatus::fromStatus(AIBinder_unlinkToDeath(server->asBinder().get(),
-                mDeathRecipient.get(), nullptr));
+        status = ScopedAStatus::fromStatus(
+                AIBinder_unlinkToDeath(server->asBinder().get(), mDeathRecipient.get(), this));
         if (!status.isOk()) {
             LOG(WARNING) << "Unlinking from death recipient failed";
         }
         return Error() << "Register power policy change challback failed";
     }
 
-    {
-        std::unique_lock writeLock(mRWMutex);
-        mPolicyServer = server;
-    }
+    mPolicyServer = server;
+    mPolicyChangeCallback = client;
 
     LOG(INFO) << "Connected to power policy daemon";
     return {};
diff --git a/cpp/powerpolicy/server/Android.bp b/cpp/powerpolicy/server/Android.bp
index 400c5220bb..d9352ed069 100644
--- a/cpp/powerpolicy/server/Android.bp
+++ b/cpp/powerpolicy/server/Android.bp
@@ -43,7 +43,6 @@ cc_defaults {
     ],
     static_libs: [
         "android.car.feature-aconfig-cpp",
-        "libc++fs",
         "libsysfsmonitor",
         "libvhalclient",
     ],
diff --git a/cpp/powerpolicy/server/src/CarPowerPolicyServer.cpp b/cpp/powerpolicy/server/src/CarPowerPolicyServer.cpp
index 7a62c956d8..e2a8820303 100644
--- a/cpp/powerpolicy/server/src/CarPowerPolicyServer.cpp
+++ b/cpp/powerpolicy/server/src/CarPowerPolicyServer.cpp
@@ -710,9 +710,9 @@ ScopedAStatus CarPowerPolicyServer::notifyCarServiceReadyInternal(
         return ScopedAStatus::fromServiceSpecificErrorWithMessage(EX_ILLEGAL_STATE, errorCause);
     }
 
-    aidlReturn->registeredCustomComponents = std::move(mPolicyManager.getCustomComponents());
+    aidlReturn->registeredCustomComponents = mPolicyManager.getCustomComponents();
     aidlReturn->currentPowerPolicy = *mCurrentPowerPolicyMeta.powerPolicy;
-    aidlReturn->registeredPolicies = std::move(mPolicyManager.getRegisteredPolicies());
+    aidlReturn->registeredPolicies = mPolicyManager.getRegisteredPolicies();
     ALOGI("CarService registers ICarPowerPolicyDelegateCallback");
     return ScopedAStatus::ok();
 }
diff --git a/cpp/security/vehicle_binding_util/tests/VehicleBindingUtilTest.cpp b/cpp/security/vehicle_binding_util/tests/VehicleBindingUtilTest.cpp
index 6142124267..b5e2db230a 100644
--- a/cpp/security/vehicle_binding_util/tests/VehicleBindingUtilTest.cpp
+++ b/cpp/security/vehicle_binding_util/tests/VehicleBindingUtilTest.cpp
@@ -128,7 +128,7 @@ protected:
                     std::vector<std::unique_ptr<IHalPropConfig>> configs;
                     VehiclePropConfig config;
                     configs.push_back(std::make_unique<AidlHalPropConfig>(std::move(config)));
-                    return std::move(configs);
+                    return configs;
                 });
     }
 
@@ -175,7 +175,7 @@ TEST_F(VehicleBindingUtilTests, VhalPropertyUnsupported) {
     EXPECT_CALL(*mMockVehicle, getPropConfigs(expectedProps))
             .WillOnce([](const std::vector<int32_t>&) {
                 std::vector<std::unique_ptr<IHalPropConfig>> configs;
-                return std::move(configs);
+                return configs;
             });
 
     EXPECT_EQ(BindingStatus::NOT_SUPPORTED,
diff --git a/cpp/telemetry/cartelemetryd/sampleclient/main.cpp b/cpp/telemetry/cartelemetryd/sampleclient/main.cpp
index 27cf1d6f3d..e2f74fdbd6 100644
--- a/cpp/telemetry/cartelemetryd/sampleclient/main.cpp
+++ b/cpp/telemetry/cartelemetryd/sampleclient/main.cpp
@@ -33,11 +33,18 @@
 #include <memory>
 #include <vector>
 
+namespace {
+
 using ::aidl::android::frameworks::automotive::telemetry::CallbackConfig;
 using ::aidl::android::frameworks::automotive::telemetry::CarData;
 using ::aidl::android::frameworks::automotive::telemetry::ICarTelemetry;
 using ::android::base::StringPrintf;
 
+constexpr int32_t GET_SERVICE_TIMEOUT_S = 5;
+constexpr int32_t GET_SERVICE_SLEEP_INTERVAL_MS = 100;
+
+}  // namespace
+
 class CarTelemetryCallbackImpl :
       public aidl::android::frameworks::automotive::telemetry::BnCarTelemetryCallback {
 public:
@@ -116,8 +123,17 @@ int main(int argc, char* argv[]) {
     // https://source.android.com/devices/architecture/aidl/aidl-hals#instance-names
     const std::string instance = StringPrintf("%s/default", ICarTelemetry::descriptor);
     std::cout << "Obtaining: " << instance << std::endl;
-    std::shared_ptr<ICarTelemetry> service = ICarTelemetry::fromBinder(
-            ndk::SpAIBinder(AServiceManager_getService(instance.c_str())));
+    std::shared_ptr<ICarTelemetry> service = nullptr;
+    const auto startTime = std::chrono::steady_clock::now();
+    while (std::chrono::steady_clock::now() - startTime <
+           std::chrono::seconds(GET_SERVICE_TIMEOUT_S)) {
+        service = ICarTelemetry::fromBinder(
+                ndk::SpAIBinder(AServiceManager_checkService(instance.c_str())));
+        if (!service) {
+            break;
+        }
+        usleep(GET_SERVICE_SLEEP_INTERVAL_MS * 1000);
+    }
     if (!service) {
         std::cerr << "ICarTelemetry service not found, may be still initializing?" << std::endl;
         return EX_UNAVAILABLE;
diff --git a/cpp/telemetry/cartelemetryd/src/TelemetryServer.cpp b/cpp/telemetry/cartelemetryd/src/TelemetryServer.cpp
index 47b29a5daa..7724574403 100644
--- a/cpp/telemetry/cartelemetryd/src/TelemetryServer.cpp
+++ b/cpp/telemetry/cartelemetryd/src/TelemetryServer.cpp
@@ -260,7 +260,7 @@ void TelemetryServer::pushCarDataToListeners() {
         // Push elements to pendingCarDataInternals in reverse order so we can send data
         // from the back of the pendingCarDataInternals vector.
         while (mRingBuffer.size() > 0) {
-            auto carData = std::move(mRingBuffer.popBack());
+            auto carData = mRingBuffer.popBack();
             CarDataInternal data;
             data.id = carData.mId;
             data.content = std::move(carData.mContent);
diff --git a/cpp/vhal/client/include/AidlVhalClient.h b/cpp/vhal/client/include/AidlVhalClient.h
index 35cbc65ddb..31a377235b 100644
--- a/cpp/vhal/client/include/AidlVhalClient.h
+++ b/cpp/vhal/client/include/AidlVhalClient.h
@@ -29,6 +29,7 @@
 #include <VehicleUtils.h>
 
 #include <atomic>
+#include <condition_variable>  // NOLINT
 #include <memory>
 #include <mutex>  // NOLINT
 #include <unordered_map>
@@ -119,16 +120,18 @@ private:
         virtual ~ILinkUnlinkToDeath() = default;
         virtual binder_status_t linkToDeath(AIBinder* binder, AIBinder_DeathRecipient* recipient,
                                             void* cookie) = 0;
-        virtual binder_status_t unlinkToDeath(AIBinder* binder, AIBinder_DeathRecipient* recipient,
-                                              void* cookie) = 0;
+        virtual void deleteDeathRecipient(AIBinder_DeathRecipient* recipient) = 0;
+        virtual void setOnUnlinked(AIBinder_DeathRecipient* recipient,
+                                   AIBinder_DeathRecipient_onBinderUnlinked onUnlinked) = 0;
     };
 
     class DefaultLinkUnlinkImpl final : public ILinkUnlinkToDeath {
     public:
         binder_status_t linkToDeath(AIBinder* binder, AIBinder_DeathRecipient* recipient,
                                     void* cookie) override;
-        binder_status_t unlinkToDeath(AIBinder* binder, AIBinder_DeathRecipient* recipient,
-                                      void* cookie) override;
+        void deleteDeathRecipient(AIBinder_DeathRecipient* recipient) override;
+        void setOnUnlinked(AIBinder_DeathRecipient* recipient,
+                           AIBinder_DeathRecipient_onBinderUnlinked onUnlinked) override;
     };
 
     std::atomic<int64_t> mRequestId = 0;
@@ -140,6 +143,8 @@ private:
     std::mutex mLock;
     std::unordered_set<std::shared_ptr<OnBinderDiedCallbackFunc>> mOnBinderDiedCallbacks
             GUARDED_BY(mLock);
+    std::condition_variable mDeathRecipientUnlinkedCv;
+    bool mDeathRecipientUnlinked GUARDED_BY(mLock) = false;
 
     static void onBinderDied(void* cookie);
     static void onBinderUnlinked(void* cookie);
diff --git a/cpp/vhal/client/src/AidlVhalClient.cpp b/cpp/vhal/client/src/AidlVhalClient.cpp
index 14c96ff923..0830476200 100644
--- a/cpp/vhal/client/src/AidlVhalClient.cpp
+++ b/cpp/vhal/client/src/AidlVhalClient.cpp
@@ -104,7 +104,7 @@ std::shared_ptr<IVhalClient> AidlVhalClient::tryCreate(const char* descriptor) {
         return nullptr;
     }
     std::shared_ptr<IVehicle> aidlVhal =
-            IVehicle::fromBinder(SpAIBinder(AServiceManager_getService(descriptor)));
+            IVehicle::fromBinder(SpAIBinder(AServiceManager_checkService(descriptor)));
     if (aidlVhal == nullptr) {
         ALOGW("AIDL VHAL service, descriptor: %s is not available", descriptor);
         return nullptr;
@@ -127,6 +127,8 @@ AidlVhalClient::AidlVhalClient(std::shared_ptr<IVehicle> hal, int64_t timeoutInM
     mDeathRecipient = ScopedAIBinder_DeathRecipient(
             AIBinder_DeathRecipient_new(&AidlVhalClient::onBinderDied));
     mLinkUnlinkImpl = std::move(linkUnlinkImpl);
+    // setOnUnlinked must be called before linkToDeath.
+    mLinkUnlinkImpl->setOnUnlinked(mDeathRecipient.get(), &AidlVhalClient::onBinderUnlinked);
     binder_status_t status =
             mLinkUnlinkImpl->linkToDeath(hal->asBinder().get(), mDeathRecipient.get(),
                                          static_cast<void*>(this));
@@ -136,8 +138,14 @@ AidlVhalClient::AidlVhalClient(std::shared_ptr<IVehicle> hal, int64_t timeoutInM
 }
 
 AidlVhalClient::~AidlVhalClient() {
-    mLinkUnlinkImpl->unlinkToDeath(mHal->asBinder().get(), mDeathRecipient.get(),
-                                   static_cast<void*>(this));
+    mLinkUnlinkImpl->deleteDeathRecipient(mDeathRecipient.release());
+
+    // Wait until onUnlinked is call. Now we are safe to cleanup cookie, which is the pointer to
+    // 'this'.
+    {
+        std::unique_lock lk(mLock);
+        mDeathRecipientUnlinkedCv.wait(lk, [this] { return mDeathRecipientUnlinked; });
+    }
 }
 
 bool AidlVhalClient::isAidlVhal() {
@@ -157,9 +165,14 @@ binder_status_t AidlVhalClient::DefaultLinkUnlinkImpl::linkToDeath(
     return AIBinder_linkToDeath(binder, recipient, cookie);
 }
 
-binder_status_t AidlVhalClient::DefaultLinkUnlinkImpl::unlinkToDeath(
-        AIBinder* binder, AIBinder_DeathRecipient* recipient, void* cookie) {
-    return AIBinder_unlinkToDeath(binder, recipient, cookie);
+void AidlVhalClient::DefaultLinkUnlinkImpl::setOnUnlinked(
+        AIBinder_DeathRecipient* recipient, AIBinder_DeathRecipient_onBinderUnlinked onUnlinked) {
+    AIBinder_DeathRecipient_setOnUnlinked(recipient, onUnlinked);
+}
+
+void AidlVhalClient::DefaultLinkUnlinkImpl::deleteDeathRecipient(
+        AIBinder_DeathRecipient* recipient) {
+    AIBinder_DeathRecipient_delete(recipient);
 }
 
 void AidlVhalClient::getValue(const IHalPropValue& requestValue,
@@ -248,8 +261,12 @@ void AidlVhalClient::onBinderDiedWithContext() {
 }
 
 void AidlVhalClient::onBinderUnlinkedWithContext() {
-    std::lock_guard<std::mutex> lk(mLock);
-    mOnBinderDiedCallbacks.clear();
+    {
+        std::lock_guard<std::mutex> lk(mLock);
+        mOnBinderDiedCallbacks.clear();
+        mDeathRecipientUnlinked = true;
+    }
+    mDeathRecipientUnlinkedCv.notify_all();
 }
 
 size_t AidlVhalClient::countOnBinderDiedCallbacks() {
diff --git a/cpp/vhal/client/test/AidlVhalClientTest.cpp b/cpp/vhal/client/test/AidlVhalClientTest.cpp
index fc48949ac7..2c5172fa98 100644
--- a/cpp/vhal/client/test/AidlVhalClientTest.cpp
+++ b/cpp/vhal/client/test/AidlVhalClientTest.cpp
@@ -249,18 +249,36 @@ protected:
                                     [[maybe_unused]] AIBinder_DeathRecipient* recipient,
                                     void* cookie) override {
             mCookie = cookie;
+            mDeathRecipient = recipient;
             return STATUS_OK;
         }
 
-        binder_status_t unlinkToDeath(AIBinder*, AIBinder_DeathRecipient*, void*) override {
-            // DO nothing.
-            return STATUS_OK;
+        void deleteDeathRecipient(AIBinder_DeathRecipient* recipient) override {
+            if (mDeathRecipient == recipient) {
+                triggerBinderUnlinked();
+            }
+        }
+
+        void setOnUnlinked([[maybe_unused]] AIBinder_DeathRecipient* recipient,
+                           AIBinder_DeathRecipient_onBinderUnlinked onUnlinked) override {
+            mOnUnlinked = onUnlinked;
         }
 
         void* getCookie() { return mCookie; }
 
+        void triggerBinderUnlinked() {
+            if (mDeathRecipient == nullptr) {
+                // Already unlinked, do nothing.
+                return;
+            }
+            (*mOnUnlinked)(mCookie);
+            mDeathRecipient = nullptr;
+        }
+
     private:
         void* mCookie;
+        AIBinder_DeathRecipient_onBinderUnlinked mOnUnlinked;
+        AIBinder_DeathRecipient* mDeathRecipient;
     };
 
     constexpr static int32_t TEST_PROP_ID = 1;
@@ -284,9 +302,10 @@ protected:
 
     MockVhal* getVhal() { return mVhal.get(); }
 
-    void triggerBinderDied() { AidlVhalClient::onBinderDied(mLinkUnlinkImpl->getCookie()); }
-
-    void triggerBinderUnlinked() { AidlVhalClient::onBinderUnlinked(mLinkUnlinkImpl->getCookie()); }
+    void triggerBinderDied() {
+        AidlVhalClient::onBinderDied(mLinkUnlinkImpl->getCookie());
+        mLinkUnlinkImpl->triggerBinderUnlinked();
+    }
 
     size_t countOnBinderDiedCallbacks() { return mVhalClient->countOnBinderDiedCallbacks(); }
 
@@ -774,8 +793,6 @@ TEST_F(AidlVhalClientTest, testAddOnBinderDiedCallback) {
     ASSERT_TRUE(result.callbackOneCalled);
     ASSERT_TRUE(result.callbackTwoCalled);
 
-    triggerBinderUnlinked();
-
     ASSERT_EQ(countOnBinderDiedCallbacks(), static_cast<size_t>(0));
 }
 
@@ -796,9 +813,6 @@ TEST_F(AidlVhalClientTest, testRemoveOnBinderDiedCallback) {
 
     ASSERT_FALSE(result.callbackOneCalled);
     ASSERT_TRUE(result.callbackTwoCalled);
-
-    triggerBinderUnlinked();
-
     ASSERT_EQ(countOnBinderDiedCallbacks(), static_cast<size_t>(0));
 }
 
diff --git a/cpp/watchdog/server/Android.bp b/cpp/watchdog/server/Android.bp
index ef8eca22fd..968f12df27 100644
--- a/cpp/watchdog/server/Android.bp
+++ b/cpp/watchdog/server/Android.bp
@@ -59,6 +59,7 @@ cc_defaults {
         "libgtest_prod_headers",
     ],
     defaults: [
+        "aconfig_lib_cc_shared_link.defaults",
         "vhalclient_defaults",
     ],
 }
diff --git a/cpp/watchdog/server/src/AIBinderDeathRegistrationWrapper.h b/cpp/watchdog/server/src/AIBinderDeathRegistrationWrapper.h
index df211ddef7..007813dc00 100644
--- a/cpp/watchdog/server/src/AIBinderDeathRegistrationWrapper.h
+++ b/cpp/watchdog/server/src/AIBinderDeathRegistrationWrapper.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_AIBINDERDEATHREGISTRATIONWRAPPER_H_
-#define CPP_WATCHDOG_SERVER_SRC_AIBINDERDEATHREGISTRATIONWRAPPER_H_
+#pragma once
 
 #include <android/binder_auto_utils.h>
 #include <utils/RefBase.h>
@@ -51,5 +50,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_AIBINDERDEATHREGISTRATIONWRAPPER_H_
diff --git a/cpp/watchdog/server/src/IoOveruseConfigs.h b/cpp/watchdog/server/src/IoOveruseConfigs.h
index aa5e0e6a8f..98188355f6 100644
--- a/cpp/watchdog/server/src/IoOveruseConfigs.h
+++ b/cpp/watchdog/server/src/IoOveruseConfigs.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_IOOVERUSECONFIGS_H_
-#define CPP_WATCHDOG_SERVER_SRC_IOOVERUSECONFIGS_H_
+#pragma once
 
 #include <aidl/android/automotive/watchdog/PerStateBytes.h>
 #include <aidl/android/automotive/watchdog/internal/ApplicationCategoryType.h>
@@ -296,5 +295,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_IOOVERUSECONFIGS_H_
diff --git a/cpp/watchdog/server/src/IoOveruseMonitor.cpp b/cpp/watchdog/server/src/IoOveruseMonitor.cpp
index 07c146fc08..b7bc3a0b04 100644
--- a/cpp/watchdog/server/src/IoOveruseMonitor.cpp
+++ b/cpp/watchdog/server/src/IoOveruseMonitor.cpp
@@ -73,10 +73,10 @@ using ::ndk::SpAIBinder;
 constexpr int64_t kMaxInt32 = std::numeric_limits<int32_t>::max();
 constexpr int64_t kMaxInt64 = std::numeric_limits<int64_t>::max();
 // Minimum written bytes to sync the stats with the Watchdog service.
-constexpr int64_t kMinSyncWrittenBytes = 100 * 1024;
+constexpr int64_t kMinSyncWrittenBytes = 10 * 1024;
 // Minimum percentage of threshold to warn killable applications.
 constexpr double kDefaultIoOveruseWarnPercentage = 80;
-// Maximum numer of system-wide stats (from periodic monitoring) to cache.
+// Maximum number of system-wide stats (from periodic monitoring) to cache.
 constexpr size_t kMaxPeriodicMonitorBufferSize = 1000;
 constexpr const char* kHelpText =
         "\n%s dump options:\n"
diff --git a/cpp/watchdog/server/src/IoOveruseMonitor.h b/cpp/watchdog/server/src/IoOveruseMonitor.h
index a14764029d..973a59aeb2 100644
--- a/cpp/watchdog/server/src/IoOveruseMonitor.h
+++ b/cpp/watchdog/server/src/IoOveruseMonitor.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_IOOVERUSEMONITOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_IOOVERUSEMONITOR_H_
+#pragma once
 
 #include "AIBinderDeathRegistrationWrapper.h"
 #include "IoOveruseConfigs.h"
@@ -340,5 +339,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_IOOVERUSEMONITOR_H_
diff --git a/cpp/watchdog/server/src/LooperWrapper.h b/cpp/watchdog/server/src/LooperWrapper.h
index 69102b4c8e..190d09269d 100644
--- a/cpp/watchdog/server/src/LooperWrapper.h
+++ b/cpp/watchdog/server/src/LooperWrapper.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_LOOPERWRAPPER_H_
-#define CPP_WATCHDOG_SERVER_SRC_LOOPERWRAPPER_H_
+#pragma once
 
 #include <utils/Looper.h>
 #include <utils/RefBase.h>
@@ -50,5 +49,3 @@ protected:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_LOOPERWRAPPER_H_
diff --git a/cpp/watchdog/server/src/OveruseConfigurationXmlHelper.h b/cpp/watchdog/server/src/OveruseConfigurationXmlHelper.h
index 49328f4c62..24d79e00c9 100644
--- a/cpp/watchdog/server/src/OveruseConfigurationXmlHelper.h
+++ b/cpp/watchdog/server/src/OveruseConfigurationXmlHelper.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_OVERUSECONFIGURATIONXMLHELPER_H_
-#define CPP_WATCHDOG_SERVER_SRC_OVERUSECONFIGURATIONXMLHELPER_H_
+#pragma once
 
 #include <aidl/android/automotive/watchdog/internal/ResourceOveruseConfiguration.h>
 #include <android-base/result.h>
@@ -42,5 +41,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_OVERUSECONFIGURATIONXMLHELPER_H_
diff --git a/cpp/watchdog/server/src/PackageInfoResolver.h b/cpp/watchdog/server/src/PackageInfoResolver.h
index d3b64d5e04..1bbabecd73 100644
--- a/cpp/watchdog/server/src/PackageInfoResolver.h
+++ b/cpp/watchdog/server/src/PackageInfoResolver.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_PACKAGEINFORESOLVER_H_
-#define CPP_WATCHDOG_SERVER_SRC_PACKAGEINFORESOLVER_H_
+#pragma once
 
 #include "LooperWrapper.h"
 #include "WatchdogServiceHelper.h"
@@ -198,5 +197,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_PACKAGEINFORESOLVER_H_
diff --git a/cpp/watchdog/server/src/PerformanceProfiler.cpp b/cpp/watchdog/server/src/PerformanceProfiler.cpp
index c8430d6db5..cc409e5582 100644
--- a/cpp/watchdog/server/src/PerformanceProfiler.cpp
+++ b/cpp/watchdog/server/src/PerformanceProfiler.cpp
@@ -108,6 +108,7 @@ constexpr const char kMemStatsHeader[] =
         "\n\tCommand, RSS (kb), PSS (kb), USS (kb), Swap PSS (kb)\n";
 constexpr const char kMemStatsSummary[] = "Total RSS (kb): %" PRIu64 "\n"
                                           "Total PSS (kb): %" PRIu64 "\n";
+constexpr const char kKernelStartTimeTitle[] = "Kernel start: <%s>\n";
 
 double percentage(uint64_t numer, uint64_t denom) {
     return denom == 0 ? 0.0 : (static_cast<double>(numer) / static_cast<double>(denom)) * 100.0;
@@ -180,29 +181,31 @@ int64_t calculateUidUptimeMillis(int64_t elapsedTimeSinceBootMillis,
 
 UidResourceUsageStats constructUidResourceUsageStats(
         PackageIdentifier packageIdentifier, int64_t uidUptimeMillis, int64_t totalCpuTimeMillis,
-        bool isGarageModeActive, const UserPackageStats::ProcCpuStatsView& procCpuStatsView,
-        const UserPackageStats::IoStatsView& ioReadsStatsView,
-        const UserPackageStats::IoStatsView& ioWritesStatsView) {
+        bool isGarageModeActive, const UserPackageStats::UidCpuStats& uidCpuStats,
+        const UserPackageStats::UidIoSingleOpStats& uidIoReadsStats,
+        const UserPackageStats::UidIoSingleOpStats& uidIoWritesStats) {
     std::vector<ProcessCpuUsageStats> processCpuUsageStats;
-    processCpuUsageStats.reserve(procCpuStatsView.topNProcesses.size());
-    for (const auto& processCpuValue : procCpuStatsView.topNProcesses) {
+    processCpuUsageStats.reserve(uidCpuStats.topNProcesses.size());
+    for (const auto& processCpuStats : uidCpuStats.topNProcesses) {
         processCpuUsageStats.push_back({
-                .pid = processCpuValue.pid,
-                .name = processCpuValue.comm,
-                .cpuTimeMillis = processCpuValue.cpuTimeMillis,
-                .cpuCycles = processCpuValue.cpuCycles,
+                .pid = processCpuStats.pid,
+                .name = processCpuStats.comm,
+                .cpuTimeMillis = processCpuStats.cpuTimeMillis,
+                .cpuCycles = processCpuStats.cpuCycles,
         });
     }
 
     UidIoUsageStats ioUsageStats = {};
     if (isGarageModeActive) {
-        ioUsageStats.readBytes.garageModeBytes = ioReadsStatsView.totalBytes();
-        ioUsageStats.writtenBytes.garageModeBytes = ioWritesStatsView.totalBytes();
+        ioUsageStats.readBytes.garageModeBytes = uidIoReadsStats.totalBytes();
+        ioUsageStats.writtenBytes.garageModeBytes = uidIoWritesStats.totalBytes();
     } else {
-        ioUsageStats.readBytes.foregroundBytes = ioReadsStatsView.bytes[UidState::FOREGROUND];
-        ioUsageStats.readBytes.backgroundBytes = ioReadsStatsView.bytes[UidState::BACKGROUND];
-        ioUsageStats.writtenBytes.foregroundBytes = ioWritesStatsView.bytes[UidState::FOREGROUND];
-        ioUsageStats.writtenBytes.backgroundBytes = ioWritesStatsView.bytes[UidState::BACKGROUND];
+        ioUsageStats.readBytes.foregroundBytes = uidIoReadsStats.bytes[UidState::FOREGROUND];
+        ioUsageStats.readBytes.backgroundBytes = uidIoReadsStats.bytes[UidState::BACKGROUND];
+        ioUsageStats.writtenBytes.foregroundBytes =
+            uidIoWritesStats.bytes[UidState::FOREGROUND];
+        ioUsageStats.writtenBytes.backgroundBytes =
+            uidIoWritesStats.bytes[UidState::BACKGROUND];
     }
 
     // clang-format off
@@ -210,10 +213,10 @@ UidResourceUsageStats constructUidResourceUsageStats(
             .packageIdentifier = std::move(packageIdentifier),
             .uidUptimeMillis = uidUptimeMillis,
             .cpuUsageStats = {
-                    .cpuTimeMillis = procCpuStatsView.cpuTimeMillis,
-                    .cpuCycles = procCpuStatsView.cpuCycles,
+                    .cpuTimeMillis = uidCpuStats.cpuTimeMillis,
+                    .cpuCycles = uidCpuStats.cpuCycles,
                     .cpuTimePercentage
-                            = percentage(procCpuStatsView.cpuTimeMillis, totalCpuTimeMillis),
+                            = percentage(uidCpuStats.cpuTimeMillis, totalCpuTimeMillis),
             },
             .processCpuUsageStats = std::move(processCpuUsageStats),
             .ioUsageStats = ioUsageStats,
@@ -278,7 +281,7 @@ std::string pressureLevelDurationMapToString(
                 static_cast<PressureMonitorInterface::PressureLevel>(i);
         if (const auto& it = pressureLevelDurations.find(pressureLevel);
             it != pressureLevelDurations.end()) {
-            StringAppendF(&buffer, "\tPressure level: %s, Duration: %" PRIi64 " ms\n",
+            StringAppendF(&buffer, "\tPressure level: %s, Duration: %lld ms\n",
                           PressureMonitorInterface::PressureLevelToString(pressureLevel).c_str(),
                           it->second.count());
         }
@@ -292,9 +295,9 @@ UserPackageStats::UserPackageStats(MetricType metricType, const UidStats& uidSta
     const UidIoStats& ioStats = uidStats.ioStats;
     uid = uidStats.uid();
     genericPackageName = uidStats.genericPackageName();
-    statsView = UserPackageStats::
-            IoStatsView{.bytes = {ioStats.metrics[metricType][UidState::FOREGROUND],
-                                  ioStats.metrics[metricType][UidState::BACKGROUND]},
+    statsVariant = UserPackageStats::
+            UidIoSingleOpStats{.bytes = {ioStats.metrics[metricType][UidState::FOREGROUND],
+                                     ioStats.metrics[metricType][UidState::BACKGROUND]},
                         .fsync = {ioStats.metrics[MetricType::FSYNC_COUNT][UidState::FOREGROUND],
                                   ioStats.metrics[MetricType::FSYNC_COUNT][UidState::BACKGROUND]}};
 }
@@ -305,13 +308,15 @@ UserPackageStats::UserPackageStats(ProcStatType procStatType, const UidStats& ui
     genericPackageName = uidStats.genericPackageName();
     switch (procStatType) {
         case CPU_TIME: {
-            statsView = UserPackageStats::ProcCpuStatsView{.cpuTimeMillis = static_cast<int64_t>(
+            statsVariant = UserPackageStats::UidCpuStats{.cpuTimeMillis = static_cast<int64_t>(
                                                                    uidStats.cpuTimeMillis),
                                                            .cpuCycles = static_cast<int64_t>(
                                                                    uidStats.procStats.cpuCycles)};
-            auto& procCpuStatsView = std::get<UserPackageStats::ProcCpuStatsView>(statsView);
-            procCpuStatsView.topNProcesses.resize(topNProcessCount);
-            cacheTopNProcessCpuStats(uidStats, topNProcessCount, &procCpuStatsView.topNProcesses);
+            auto& uidCpuStats = std::get<UserPackageStats::UidCpuStats>(statsVariant);
+            uidCpuStats.topNProcesses.resize(topNProcessCount);
+            cacheTopNProcessCpuStats(uidStats,
+                                     topNProcessCount,
+                                     &uidCpuStats.topNProcesses);
             break;
         }
         case MEMORY_STATS: {
@@ -323,7 +328,7 @@ UserPackageStats::UserPackageStats(ProcStatType procStatType, const UidStats& ui
                 totalUssKb += processStats.ussKb;
                 totalSwapPssKb += processStats.swapPssKb;
             }
-            statsView = UserPackageStats::UidMemoryStats{.memoryStats.rssKb =
+            statsVariant = UserPackageStats::UidMemoryStats{.memoryStats.rssKb =
                                                                  uidStats.procStats.totalRssKb,
                                                          .memoryStats.pssKb =
                                                                  uidStats.procStats.totalPssKb,
@@ -331,7 +336,7 @@ UserPackageStats::UserPackageStats(ProcStatType procStatType, const UidStats& ui
                                                          .memoryStats.swapPssKb = totalSwapPssKb,
                                                          .isSmapsRollupSupported =
                                                                  isSmapsRollupSupported};
-            auto& uidMemoryStats = std::get<UserPackageStats::UidMemoryStats>(statsView);
+            auto& uidMemoryStats = std::get<UserPackageStats::UidMemoryStats>(statsVariant);
             uidMemoryStats.topNProcesses.resize(topNProcessCount);
             cacheTopNProcessMemStats(uidStats, topNProcessCount,
                                      uidMemoryStats.isSmapsRollupSupported,
@@ -343,11 +348,11 @@ UserPackageStats::UserPackageStats(ProcStatType procStatType, const UidStats& ui
             uint64_t value = procStatType == IO_BLOCKED_TASKS_COUNT
                     ? uidStats.procStats.ioBlockedTasksCount
                     : uidStats.procStats.totalMajorFaults;
-            statsView = UserPackageStats::ProcSingleStatsView{.value = value};
-            auto& procStatsView = std::get<UserPackageStats::ProcSingleStatsView>(statsView);
-            procStatsView.topNProcesses.resize(topNProcessCount);
+            statsVariant = UserPackageStats::UidSingleStats{.value = value};
+            auto& uidSingleStats = std::get<UserPackageStats::UidSingleStats>(statsVariant);
+            uidSingleStats.topNProcesses.resize(topNProcessCount);
             cacheTopNProcessSingleStats(procStatType, uidStats, topNProcessCount,
-                                        &procStatsView.topNProcesses);
+                                        &uidSingleStats.topNProcesses);
             break;
         }
         default: {
@@ -361,23 +366,23 @@ uint64_t UserPackageStats::getValue() const {
     return std::visit(
             [](auto&& arg) -> uint64_t {
                 using T = std::decay_t<decltype(arg)>;
-                if constexpr (std::is_same_v<T, UserPackageStats::IoStatsView>) {
+                if constexpr (std::is_same_v<T, UserPackageStats::UidIoSingleOpStats>) {
                     return arg.totalBytes();
                 }
-                if constexpr (std::is_same_v<T, UserPackageStats::ProcSingleStatsView>) {
+                if constexpr (std::is_same_v<T, UserPackageStats::UidSingleStats>) {
                     return arg.value;
                 }
-                if constexpr (std::is_same_v<T, UserPackageStats::ProcCpuStatsView>) {
+                if constexpr (std::is_same_v<T, UserPackageStats::UidCpuStats>) {
                     return arg.cpuTimeMillis;
                 }
                 if constexpr (std::is_same_v<T, UserPackageStats::UidMemoryStats>) {
                     return arg.isSmapsRollupSupported ? arg.memoryStats.pssKb
                                                       : arg.memoryStats.rssKb;
                 }
-                // Unknown stats view
+                // Unknown uid stats
                 return 0;
             },
-            statsView);
+            statsVariant);
 }
 
 std::string UserPackageStats::toString(MetricType metricsType,
@@ -385,12 +390,15 @@ std::string UserPackageStats::toString(MetricType metricsType,
     std::string buffer;
     StringAppendF(&buffer, "%" PRIu32 ", %s", multiuser_get_user_id(uid),
                   genericPackageName.c_str());
-    const auto& ioStatsView = std::get<UserPackageStats::IoStatsView>(statsView);
+    const auto& uidIoSingleOpStats = std::get<UserPackageStats::UidIoSingleOpStats>(statsVariant);
     for (int i = 0; i < UID_STATES; ++i) {
-        StringAppendF(&buffer, ", %" PRIi64 ", %.2f%%, %" PRIi64 ", %.2f%%", ioStatsView.bytes[i],
-                      percentage(ioStatsView.bytes[i], totalIoStats[metricsType][i]),
-                      ioStatsView.fsync[i],
-                      percentage(ioStatsView.fsync[i], totalIoStats[FSYNC_COUNT][i]));
+        StringAppendF(&buffer, ", %" PRIi64 ", %.2f%%, %" PRIi64 ", %.2f%%",
+                      uidIoSingleOpStats.bytes[i],
+                      percentage(uidIoSingleOpStats.bytes[i],
+                                 totalIoStats[metricsType][i]),
+                      uidIoSingleOpStats.fsync[i],
+                      percentage(uidIoSingleOpStats.fsync[i],
+                                 totalIoStats[FSYNC_COUNT][i]));
     }
     StringAppendF(&buffer, "\n");
     return buffer;
@@ -398,36 +406,50 @@ std::string UserPackageStats::toString(MetricType metricsType,
 
 std::string UserPackageStats::toString(int64_t totalValue) const {
     std::string buffer;
-    auto procCpuStatsView = std::get_if<UserPackageStats::ProcCpuStatsView>(&statsView);
-    if (procCpuStatsView != nullptr) {
+    int64_t totalProcessTimeMillis = 0;
+    auto uidCpuStats = std::get_if<UserPackageStats::UidCpuStats>(&statsVariant);
+    if (uidCpuStats != nullptr) {
+        // Sometimes, the CPU time used by a specific process (reported in /proc/<pid>/stat) is
+        // higher than the total CPU time used by all processes belonging to the same UID (reported
+        // in /proc/uid_cputime/show_uid_stat). This can happen if the UID only has one process
+        // running. The reason is likely a difference in how the kernel calculates and reports CPU
+        // usage in these two places. To ensure accuracy, use the higher of the two reported total
+        // CPU times when calculating percentage.
+        for (const auto& processCpuStats : uidCpuStats->topNProcesses) {
+            totalProcessTimeMillis += processCpuStats.cpuTimeMillis;
+        }
+        totalProcessTimeMillis = std::max(totalProcessTimeMillis,
+                                          uidCpuStats->cpuTimeMillis);
         StringAppendF(&buffer, "%" PRIu32 ", %s, %" PRIu64 ", %.2f%%, %" PRIu64 "\n",
                       multiuser_get_user_id(uid), genericPackageName.c_str(),
-                      procCpuStatsView->cpuTimeMillis,
-                      percentage(procCpuStatsView->cpuTimeMillis, totalValue),
-                      procCpuStatsView->cpuCycles);
-        for (const auto& processCpuValue : procCpuStatsView->topNProcesses) {
+                      totalProcessTimeMillis,
+                      percentage(totalProcessTimeMillis, totalValue),
+                      uidCpuStats->cpuCycles);
+        for (const auto& processCpuStats : uidCpuStats->topNProcesses) {
             StringAppendF(&buffer, "\t%s, %" PRIu64 ", %.2f%%, %" PRIu64 "\n",
-                          processCpuValue.comm.c_str(), processCpuValue.cpuTimeMillis,
-                          percentage(processCpuValue.cpuTimeMillis,
-                                     procCpuStatsView->cpuTimeMillis),
-                          processCpuValue.cpuCycles);
+                          processCpuStats.comm.c_str(), processCpuStats.cpuTimeMillis,
+                          percentage(processCpuStats.cpuTimeMillis,
+                                     totalProcessTimeMillis),
+                          processCpuStats.cpuCycles);
         }
         return buffer;
     }
-    const auto& procStatsView = std::get<UserPackageStats::ProcSingleStatsView>(statsView);
+    const auto& uidSingleStats = std::get<UserPackageStats::UidSingleStats>(statsVariant);
     StringAppendF(&buffer, "%" PRIu32 ", %s, %" PRIu64 ", %.2f%%\n", multiuser_get_user_id(uid),
-                  genericPackageName.c_str(), procStatsView.value,
-                  percentage(procStatsView.value, totalValue));
-    for (const auto& processValue : procStatsView.topNProcesses) {
-        StringAppendF(&buffer, "\t%s, %" PRIu64 ", %.2f%%\n", processValue.comm.c_str(),
-                      processValue.value, percentage(processValue.value, procStatsView.value));
+                  genericPackageName.c_str(), uidSingleStats.value,
+                  percentage(uidSingleStats.value, totalValue));
+    for (const auto& processSingleStats : uidSingleStats.topNProcesses) {
+        StringAppendF(&buffer, "\t%s, %" PRIu64 ", %.2f%%\n", processSingleStats.comm.c_str(),
+                      processSingleStats.value,
+                      percentage(processSingleStats.value,
+                                 uidSingleStats.value));
     }
     return buffer;
 }
 
 std::string UserPackageStats::toString(int64_t totalRssKb, int64_t totalPssKb) const {
     std::string buffer;
-    const auto* uidMemoryStats = std::get_if<UserPackageStats::UidMemoryStats>(&statsView);
+    const auto* uidMemoryStats = std::get_if<UserPackageStats::UidMemoryStats>(&statsVariant);
     if (uidMemoryStats == nullptr) {
         return buffer;
     }
@@ -451,7 +473,7 @@ std::string UserPackageStats::toString(int64_t totalRssKb, int64_t totalPssKb) c
 
 void UserPackageStats::cacheTopNProcessSingleStats(
         ProcStatType procStatType, const UidStats& uidStats, int topNProcessCount,
-        std::vector<UserPackageStats::ProcSingleStatsView::ProcessValue>* topNProcesses) {
+        std::vector<UserPackageStats::UidSingleStats::ProcessSingleStats>* topNProcesses) {
     int cachedProcessCount = 0;
     for (const auto& [_, processStats] : uidStats.procStats.processStatsByPid) {
         uint64_t value = procStatType == IO_BLOCKED_TASKS_COUNT ? processStats.ioBlockedTasksCount
@@ -462,7 +484,7 @@ void UserPackageStats::cacheTopNProcessSingleStats(
         for (auto it = topNProcesses->begin(); it != topNProcesses->end(); ++it) {
             if (value > it->value) {
                 topNProcesses->insert(it,
-                                      UserPackageStats::ProcSingleStatsView::ProcessValue{
+                                      UserPackageStats::UidSingleStats::ProcessSingleStats{
                                               .comm = processStats.comm,
                                               .value = value,
                                       });
@@ -479,7 +501,7 @@ void UserPackageStats::cacheTopNProcessSingleStats(
 
 void UserPackageStats::cacheTopNProcessCpuStats(
         const UidStats& uidStats, int topNProcessCount,
-        std::vector<UserPackageStats::ProcCpuStatsView::ProcessCpuValue>* topNProcesses) {
+        std::vector<UserPackageStats::UidCpuStats::ProcessCpuStats>* topNProcesses) {
     int cachedProcessCount = 0;
     for (const auto& [pid, processStats] : uidStats.procStats.processStatsByPid) {
         int64_t cpuTimeMillis = processStats.cpuTimeMillis;
@@ -489,7 +511,7 @@ void UserPackageStats::cacheTopNProcessCpuStats(
         for (auto it = topNProcesses->begin(); it != topNProcesses->end(); ++it) {
             if (cpuTimeMillis > it->cpuTimeMillis) {
                 topNProcesses->insert(it,
-                                      UserPackageStats::ProcCpuStatsView::ProcessCpuValue{
+                                      UserPackageStats::UidCpuStats::ProcessCpuStats{
                                               .pid = pid,
                                               .comm = processStats.comm,
                                               .cpuTimeMillis = cpuTimeMillis,
@@ -672,6 +694,7 @@ Result<void> PerformanceProfiler::init() {
             .maxCacheSize = std::numeric_limits<std::size_t>::max(),
             .records = {},
     };
+    mKernelStartTimeEpochSeconds = 0;
     if (!mIsMemoryProfilingEnabled || !kPressureMonitor->isEnabled()) {
         return {};
     }
@@ -707,6 +730,13 @@ void PerformanceProfiler::terminate() {
 
 Result<void> PerformanceProfiler::onDump(int fd) const {
     Mutex::Autolock lock(mMutex);
+    std::stringstream kernelStartTimestamp;
+    if (mKernelStartTimeEpochSeconds != 0) {
+        kernelStartTimestamp << std::put_time(std::localtime(&mKernelStartTimeEpochSeconds),
+                                            "%c %Z");
+    } else {
+        kernelStartTimestamp << "Missing";
+    }
     if (!WriteStringToFd(StringPrintf("/proc/<pid>/smaps_rollup is %s\n",
                                       mIsSmapsRollupSupported
                                               ? "supported. So, using PSS to rank top memory "
@@ -717,6 +747,9 @@ Result<void> PerformanceProfiler::onDump(int fd) const {
         !WriteStringToFd(StringPrintf(kBootTimeCollectionTitle, std::string(75, '-').c_str(),
                                       std::string(33, '=').c_str()),
                          fd) ||
+        !WriteStringToFd(StringPrintf(kKernelStartTimeTitle,
+                                      kernelStartTimestamp.str().c_str()),
+                         fd) ||
         !WriteStringToFd(mBoottimeCollection.toString(), fd)) {
         return Error(FAILED_TRANSACTION) << "Failed to dump the boot-time collection report.";
     }
@@ -743,6 +776,7 @@ Result<void> PerformanceProfiler::onDumpProto(const CollectionIntervals& collect
     Mutex::Autolock lock(mMutex);
 
     uint64_t performanceStatsToken = outProto.start(PerformanceProfilerDump::PERFORMANCE_STATS);
+    outProto.write(PerformanceStats::KERNEL_START_TIME_EPOCH_SECONDS, mKernelStartTimeEpochSeconds);
 
     uint64_t bootTimeStatsToken = outProto.start(PerformanceStats::BOOT_TIME_STATS);
     outProto.write(StatsCollection::COLLECTION_INTERVAL_MILLIS,
@@ -869,8 +903,8 @@ void PerformanceProfiler::dumpPackageCpuStatsProto(
         const std::vector<UserPackageStats>& topNCpuTimes, ProtoOutputStream& outProto) const {
     for (const auto& userPackageStats : topNCpuTimes) {
         uint64_t packageCpuStatsToken = outProto.start(StatsRecord::PACKAGE_CPU_STATS);
-        const auto& procCpuStatsView =
-                std::get_if<UserPackageStats::ProcCpuStatsView>(&userPackageStats.statsView);
+        const auto& uidCpuStats =
+                std::get_if<UserPackageStats::UidCpuStats>(&userPackageStats.statsVariant);
 
         uint64_t userPackageInfoToken = outProto.start(PackageCpuStats::USER_PACKAGE_INFO);
         outProto.write(UserPackageInfo::USER_ID,
@@ -880,12 +914,12 @@ void PerformanceProfiler::dumpPackageCpuStatsProto(
 
         uint64_t cpuStatsToken = outProto.start(PackageCpuStats::CPU_STATS);
         outProto.write(PackageCpuStats::CpuStats::CPU_TIME_MILLIS,
-                       static_cast<int>(procCpuStatsView->cpuTimeMillis));
+                       static_cast<int>(uidCpuStats->cpuTimeMillis));
         outProto.write(PackageCpuStats::CpuStats::CPU_CYCLES,
-                       static_cast<int>(procCpuStatsView->cpuCycles));
+                       static_cast<int>(uidCpuStats->cpuCycles));
         outProto.end(cpuStatsToken);
 
-        for (const auto& processCpuStat : procCpuStatsView->topNProcesses) {
+        for (const auto& processCpuStat : uidCpuStats->topNProcesses) {
             uint64_t processCpuStatToken = outProto.start(PackageCpuStats::PROCESS_CPU_STATS);
             outProto.write(PackageCpuStats::ProcessCpuStats::COMMAND, processCpuStat.comm);
 
@@ -908,8 +942,8 @@ void PerformanceProfiler::dumpPackageStorageIoStatsProto(
         ProtoOutputStream& outProto) const {
     for (const auto& userPackageStats : userPackageStats) {
         uint64_t token = outProto.start(storageStatsFieldId);
-        const auto& ioStatsView =
-                std::get_if<UserPackageStats::IoStatsView>(&userPackageStats.statsView);
+        const auto& uidIoSingleOpStats =
+                std::get_if<UserPackageStats::UidIoSingleOpStats>(&userPackageStats.statsVariant);
 
         uint64_t userPackageInfoToken = outProto.start(PackageStorageIoStats::USER_PACKAGE_INFO);
         outProto.write(UserPackageInfo::USER_ID,
@@ -918,10 +952,14 @@ void PerformanceProfiler::dumpPackageStorageIoStatsProto(
         outProto.end(userPackageInfoToken);
 
         uint64_t storageIoStatsToken = outProto.start(PackageStorageIoStats::STORAGE_IO_STATS);
-        outProto.write(StorageIoStats::FG_BYTES, static_cast<int>(ioStatsView->bytes[FOREGROUND]));
-        outProto.write(StorageIoStats::FG_FSYNC, static_cast<int>(ioStatsView->fsync[FOREGROUND]));
-        outProto.write(StorageIoStats::BG_BYTES, static_cast<int>(ioStatsView->bytes[BACKGROUND]));
-        outProto.write(StorageIoStats::BG_FSYNC, static_cast<int>(ioStatsView->fsync[BACKGROUND]));
+        outProto.write(StorageIoStats::FG_BYTES,
+                       static_cast<int>(uidIoSingleOpStats->bytes[FOREGROUND]));
+        outProto.write(StorageIoStats::FG_FSYNC,
+                       static_cast<int>(uidIoSingleOpStats->fsync[FOREGROUND]));
+        outProto.write(StorageIoStats::BG_BYTES,
+                       static_cast<int>(uidIoSingleOpStats->bytes[BACKGROUND]));
+        outProto.write(StorageIoStats::BG_FSYNC,
+                       static_cast<int>(uidIoSingleOpStats->fsync[BACKGROUND]));
         outProto.end(storageIoStatsToken);
 
         outProto.end(token);
@@ -939,8 +977,8 @@ void PerformanceProfiler::dumpPackageTaskStateStatsProto(
         }
 
         uint64_t packageTaskStateStatsToken = outProto.start(StatsRecord::PACKAGE_TASK_STATE_STATS);
-        const auto& procSingleStatsView =
-                std::get_if<UserPackageStats::ProcSingleStatsView>(&userPackageStats.statsView);
+        const auto& uidSingleStats =
+                std::get_if<UserPackageStats::UidSingleStats>(&userPackageStats.statsVariant);
 
         uint64_t userPackageInfoToken = outProto.start(PackageTaskStateStats::USER_PACKAGE_INFO);
         outProto.write(UserPackageInfo::USER_ID,
@@ -949,17 +987,17 @@ void PerformanceProfiler::dumpPackageTaskStateStatsProto(
         outProto.end(userPackageInfoToken);
 
         outProto.write(PackageTaskStateStats::IO_BLOCKED_TASK_COUNT,
-                       static_cast<int>(procSingleStatsView->value));
+                       static_cast<int>(uidSingleStats->value));
         outProto.write(PackageTaskStateStats::TOTAL_TASK_COUNT,
                        static_cast<int>(taskCount->second));
 
-        for (const auto& processValue : procSingleStatsView->topNProcesses) {
+        for (const auto& processSingleStats : uidSingleStats->topNProcesses) {
             uint64_t processTaskStateStatsToken =
                     outProto.start(PackageTaskStateStats::PROCESS_TASK_STATE_STATS);
             outProto.write(PackageTaskStateStats::ProcessTaskStateStats::COMMAND,
-                           processValue.comm);
+                           processSingleStats.comm);
             outProto.write(PackageTaskStateStats::ProcessTaskStateStats::IO_BLOCKED_TASK_COUNT,
-                           static_cast<int>(processValue.value));
+                           static_cast<int>(processSingleStats.value));
             outProto.end(processTaskStateStatsToken);
         }
 
@@ -972,8 +1010,8 @@ void PerformanceProfiler::dumpPackageMajorPageFaultsProto(
     for (const auto& userPackageStats : topNMajorFaults) {
         uint64_t packageMajorPageFaultsToken =
                 outProto.start(StatsRecord::PACKAGE_MAJOR_PAGE_FAULTS);
-        const auto& procSingleStatsView =
-                std::get_if<UserPackageStats::ProcSingleStatsView>(&userPackageStats.statsView);
+        const auto& uidSingleStats =
+                std::get_if<UserPackageStats::UidSingleStats>(&userPackageStats.statsVariant);
 
         uint64_t userPackageInfoToken = outProto.start(PackageMajorPageFaults::USER_PACKAGE_INFO);
         outProto.write(UserPackageInfo::USER_ID,
@@ -982,7 +1020,7 @@ void PerformanceProfiler::dumpPackageMajorPageFaultsProto(
         outProto.end(userPackageInfoToken);
 
         outProto.write(PackageMajorPageFaults::MAJOR_PAGE_FAULTS_COUNT,
-                       static_cast<int>(procSingleStatsView->value));
+                       static_cast<int>(uidSingleStats->value));
 
         outProto.end(packageMajorPageFaultsToken);
     }
@@ -1135,6 +1173,9 @@ Result<void> PerformanceProfiler::processLocked(
     std::vector<UidResourceUsageStats>* uidResourceUsageStats =
             shouldSendResourceUsageStats ? new std::vector<UidResourceUsageStats>() : nullptr;
     processProcStatLocked(procStatCollector, &record.systemSummaryStats);
+    if (mKernelStartTimeEpochSeconds <= 0) {
+        mKernelStartTimeEpochSeconds = procStatCollector->getKernelStartTimeEpochSeconds();
+    }
     // The system-wide CPU time should be the same as CPU time aggregated here across all UID, so
     // reuse the total CPU time from SystemSummaryStat
     int64_t totalCpuTimeMillis = record.systemSummaryStats.totalCpuTimeMillis;
@@ -1198,7 +1239,7 @@ void PerformanceProfiler::processUidStatsLocked(
             userPackageSummaryStats->totalPssKb += curUidStats.procStats.totalPssKb;
         }
 
-        // Transform |UidStats| to |UserPackageStats| for each stats view.
+        // Transform |UidStats| to |UserPackageStats| for each stats variant.
         auto ioReadsPackageStats = UserPackageStats(MetricType::READ_BYTES, curUidStats);
         auto ioWritesPackageStats = UserPackageStats(MetricType::WRITE_BYTES, curUidStats);
         auto cpuTimePackageStats =
@@ -1252,18 +1293,18 @@ void PerformanceProfiler::processUidStatsLocked(
         int64_t uidUptimeMillis =
                 calculateUidUptimeMillis(elapsedTimeSinceBootMs, curUidStats.procStats);
 
-        const auto& procCpuStatsView =
-                std::get<UserPackageStats::ProcCpuStatsView>(cpuTimePackageStats.statsView);
-        const auto& ioReadsStatsView =
-                std::get<UserPackageStats::IoStatsView>(ioReadsPackageStats.statsView);
-        const auto& ioWritesStatsView =
-                std::get<UserPackageStats::IoStatsView>(ioWritesPackageStats.statsView);
+        const auto& uidCpuStats =
+                std::get<UserPackageStats::UidCpuStats>(cpuTimePackageStats.statsVariant);
+        const auto& uidIoReadsStats =
+                std::get<UserPackageStats::UidIoSingleOpStats>(ioReadsPackageStats.statsVariant);
+        const auto& uidIoWritesStats =
+                std::get<UserPackageStats::UidIoSingleOpStats>(ioWritesPackageStats.statsVariant);
 
         UidResourceUsageStats usageStats =
                 constructUidResourceUsageStats(std::move(packageIdentifier), uidUptimeMillis,
                                                totalCpuTimeMillis, isGarageModeActive,
-                                               procCpuStatsView, ioReadsStatsView,
-                                               ioWritesStatsView);
+                                               uidCpuStats, uidIoReadsStats,
+                                               uidIoWritesStats);
         uidResourceUsageStats->push_back(std::move(usageStats));
     }
     if (mLastMajorFaults != 0) {
@@ -1278,7 +1319,7 @@ void PerformanceProfiler::processUidStatsLocked(
             /* std::monostate is the first alternative in the variant. When the variant is
              * uninitialized, the index points to this alternative.
              */
-            if (it->statsView.index() == 0) {
+            if (it->statsVariant.index() == 0) {
                 userPackageStats.erase(it, userPackageStats.end());
                 break;
             }
diff --git a/cpp/watchdog/server/src/PerformanceProfiler.h b/cpp/watchdog/server/src/PerformanceProfiler.h
index 836c3af3ce..1272449dcf 100644
--- a/cpp/watchdog/server/src/PerformanceProfiler.h
+++ b/cpp/watchdog/server/src/PerformanceProfiler.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_PERFORMANCEPROFILER_H_
-#define CPP_WATCHDOG_SERVER_SRC_PERFORMANCEPROFILER_H_
+#pragma once
 
 #include "PressureMonitor.h"
 #include "ProcDiskStatsCollector.h"
@@ -69,10 +68,7 @@ enum ProcStatType {
 // UserPackageStats represents the user package performance stats.
 class UserPackageStats {
 public:
-    // TODO(b/332773702): Rename nested structs
-    //  first-level IoStatsView, ProcSingleStatsView, and ProcCpuStatsView renames to Uid*Stats
-    //  second-level ProcessValue and ProcessCpuValue renames to Process*Stats
-    struct IoStatsView {
+    struct UidIoSingleOpStats {
         int64_t bytes[UID_STATES] = {0};
         int64_t fsync[UID_STATES] = {0};
 
@@ -83,24 +79,24 @@ public:
                     : std::numeric_limits<int64_t>::max();
         }
     };
-    struct ProcSingleStatsView {
+    struct UidSingleStats {
         uint64_t value = 0;
-        struct ProcessValue {
+        struct ProcessSingleStats {
             std::string comm = "";
             uint64_t value = 0;
         };
-        std::vector<ProcessValue> topNProcesses = {};
+        std::vector<ProcessSingleStats> topNProcesses = {};
     };
-    struct ProcCpuStatsView {
+    struct UidCpuStats {
         int64_t cpuTimeMillis = 0;
         int64_t cpuCycles = 0;
-        struct ProcessCpuValue {
+        struct ProcessCpuStats {
             int32_t pid = -1;
             std::string comm = "";
             int64_t cpuTimeMillis = 0;
             int64_t cpuCycles = 0;
         };
-        std::vector<ProcessCpuValue> topNProcesses = {};
+        std::vector<ProcessCpuStats> topNProcesses = {};
     };
     struct MemoryStats {
         uint64_t rssKb = 0;
@@ -126,17 +122,17 @@ public:
     UserPackageStats() : uid(0), genericPackageName("") {}
     // For unit test case only
     UserPackageStats(uid_t uid, std::string genericPackageName,
-                     std::variant<std::monostate, IoStatsView, ProcSingleStatsView,
-                                  ProcCpuStatsView, UidMemoryStats>
-                             statsView) :
+                     std::variant<std::monostate, UidIoSingleOpStats, UidSingleStats,
+                                  UidCpuStats, UidMemoryStats>
+                             statsVariant) :
           uid(uid),
           genericPackageName(std::move(genericPackageName)),
-          statsView(std::move(statsView)) {}
+          statsVariant(std::move(statsVariant)) {}
 
-    // Returns the primary value of the current StatsView. If the variant has value
+    // Returns the primary value of the current UidStats. If the variant has value
     // |std::monostate|, returns 0.
     //
-    // This value should be used to sort the StatsViews.
+    // This value should be used to sort the UidStats.
     uint64_t getValue() const;
     std::string toString(MetricType metricsType, const int64_t totalIoStats[][UID_STATES]) const;
     std::string toString(int64_t totalValue) const;
@@ -144,16 +140,22 @@ public:
 
     uid_t uid;
     std::string genericPackageName;
-    std::variant<std::monostate, IoStatsView, ProcSingleStatsView, ProcCpuStatsView, UidMemoryStats>
-            statsView;
+    std::variant<std::monostate,
+                UidIoSingleOpStats,
+                UidSingleStats,
+                UidCpuStats,
+                UidMemoryStats>
+            statsVariant;
 
 private:
     void cacheTopNProcessSingleStats(
-            ProcStatType procStatType, const UidStats& uidStats, int topNProcessCount,
-            std::vector<UserPackageStats::ProcSingleStatsView::ProcessValue>* topNProcesses);
+          ProcStatType procStatType, const UidStats& uidStats, int topNProcessCount,
+          std::vector<UserPackageStats::UidSingleStats::ProcessSingleStats>*
+              topNProcesses);
     void cacheTopNProcessCpuStats(
             const UidStats& uidStats, int topNProcessCount,
-            std::vector<UserPackageStats::ProcCpuStatsView::ProcessCpuValue>* topNProcesses);
+            std::vector<UserPackageStats::UidCpuStats::ProcessCpuStats>*
+                topNProcesses);
     void cacheTopNProcessMemStats(
             const UidStats& uidStats, int topNProcessCount, bool isSmapsRollupSupported,
             std::vector<UserPackageStats::UidMemoryStats::ProcessMemoryStats>* topNProcesses);
@@ -185,7 +187,7 @@ struct UserPackageSummaryStats {
 };
 
 // TODO(b/268402964): Calculate the total CPU cycles using the per-UID BPF tool.
-// System performance stats collected from the `/proc/stats` file.
+// System performance stats collected from the `/proc/stat` file.
 struct SystemSummaryStats {
     int64_t cpuIoWaitTimeMillis = 0;
     int64_t cpuIdleTimeMillis = 0;
@@ -246,6 +248,7 @@ public:
           mWakeUpCollection({}),
           mCustomCollection({}),
           mLastMajorFaults(0),
+          mKernelStartTimeEpochSeconds(0),
           mDoSendResourceUsageStats(false),
           mMemoryPressureLevelDeltaInfo(PressureLevelDeltaInfo(getElapsedTimeSinceBootMillisFunc)) {
     }
@@ -364,7 +367,7 @@ private:
                     uidResourceUsageStats,
             UserPackageSummaryStats* userPackageSummaryStats);
 
-    // Processes system performance data from the `/proc/stats` file.
+    // Processes system performance data from the `/proc/stat` file.
     void processProcStatLocked(const android::sp<ProcStatCollectorInterface>& procStatCollector,
                                SystemSummaryStats* systemSummaryStats) const;
 
@@ -439,6 +442,9 @@ private:
     // major faults since last collection.
     uint64_t mLastMajorFaults GUARDED_BY(mMutex);
 
+    // Boot start time collected from /proc/stat.
+    time_t mKernelStartTimeEpochSeconds GUARDED_BY(mMutex);
+
     // Enables the sending of resource usage stats to CarService.
     bool mDoSendResourceUsageStats GUARDED_BY(mMutex);
 
@@ -454,5 +460,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_PERFORMANCEPROFILER_H_
diff --git a/cpp/watchdog/server/src/PressureMonitor.cpp b/cpp/watchdog/server/src/PressureMonitor.cpp
index 356a2577fd..ea705210f0 100644
--- a/cpp/watchdog/server/src/PressureMonitor.cpp
+++ b/cpp/watchdog/server/src/PressureMonitor.cpp
@@ -192,7 +192,7 @@ Result<void> PressureMonitor::start() {
         {
             Mutex::Autolock lock(mMutex);
             mHandlerLooper->setLooper(Looper::prepare(/*opts=*/0));
-            mLastPollUptimeNs = mHandlerLooper->now();
+            mLastPollElapsedRealTimeNs = mHandlerLooper->now();
             mHandlerLooper->sendMessage(sp<PressureMonitor>::fromExisting(this),
                                         LooperMessage::MONITOR_PRESSURE);
             isMonitorActive = mIsMonitorActive;
@@ -275,13 +275,15 @@ Result<void> PressureMonitor::monitorPressure() {
                                     LooperMessage::NOTIFY_PRESSURE_CHANGE);
     }
 
-    mLastPollUptimeNs +=
+    mLastPollElapsedRealTimeNs +=
             std::chrono::duration_cast<std::chrono::nanoseconds>(mPollingIntervalMillis).count();
     // The NOTIFY_PRESSURE_CHANGE message must be handled before MONITOR_PRESSURE message.
     // Otherwise, the callbacks won't be notified of the recent pressure level change. To avoid
-    // inserting MONITOR_PRESSURE message before NOTIFY_PRESSURE_CHANGE message, check the uptime.
+    // inserting MONITOR_PRESSURE message before NOTIFY_PRESSURE_CHANGE message,
+    // check the elapsed real time.
     nsecs_t now = mHandlerLooper->now();
-    mHandlerLooper->sendMessageAtTime(mLastPollUptimeNs > now ? mLastPollUptimeNs : now,
+    mHandlerLooper->sendMessageAtTime(mLastPollElapsedRealTimeNs > now ? mLastPollElapsedRealTimeNs
+                                                                       : now,
                                       sp<PressureMonitor>::fromExisting(this),
                                       LooperMessage::MONITOR_PRESSURE);
     return {};
diff --git a/cpp/watchdog/server/src/PressureMonitor.h b/cpp/watchdog/server/src/PressureMonitor.h
index 7894773860..6e85d0d835 100644
--- a/cpp/watchdog/server/src/PressureMonitor.h
+++ b/cpp/watchdog/server/src/PressureMonitor.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_PRESSUREMONITOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_PRESSUREMONITOR_H_
+#pragma once
 
 #include "LooperWrapper.h"
 
@@ -129,7 +128,7 @@ public:
           mIsEnabled(false),
           mIsMonitorActive(false),
           mPsiEpollFd(-1),
-          mLastPollUptimeNs(0),
+          mLastPollElapsedRealTimeNs(0),
           mLatestPressureLevel(PRESSURE_LEVEL_NONE) {}
 
     // Overrides PressureMonitorInterface methods.
@@ -223,8 +222,9 @@ private:
     // Epoll fd used to monitor the psi triggers.
     int mPsiEpollFd GUARDED_BY(mMutex);
 
-    // Uptime NS when the last poll was performed. Used to calculate the next poll uptime.
-    nsecs_t mLastPollUptimeNs GUARDED_BY(mMutex);
+    // Elapsed real time NS when the last poll was performed.
+    // Used to calculate the next poll uptime.
+    nsecs_t mLastPollElapsedRealTimeNs GUARDED_BY(mMutex);
 
     // Latest highest active pressure level since the previous polling.
     PressureLevel mLatestPressureLevel GUARDED_BY(mMutex);
@@ -241,5 +241,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_PRESSUREMONITOR_H_
diff --git a/cpp/watchdog/server/src/ProcDiskStatsCollector.h b/cpp/watchdog/server/src/ProcDiskStatsCollector.h
index d7f0d1621b..f4a680a4ab 100644
--- a/cpp/watchdog/server/src/ProcDiskStatsCollector.h
+++ b/cpp/watchdog/server/src/ProcDiskStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_PROCDISKSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_PROCDISKSTATSCOLLECTOR_H_
+#pragma once
 
 #include <android-base/result.h>
 #include <android-base/stringprintf.h>
@@ -154,5 +153,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_PROCDISKSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/src/ProcStatCollector.cpp b/cpp/watchdog/server/src/ProcStatCollector.cpp
index a2c0435d8b..b66fb1552a 100644
--- a/cpp/watchdog/server/src/ProcStatCollector.cpp
+++ b/cpp/watchdog/server/src/ProcStatCollector.cpp
@@ -94,6 +94,15 @@ bool parseProcsCount(const std::string& data, uint32_t* out) {
     return true;
 }
 
+bool parseBootTime(const std::string& data, time_t* out) {
+  std::vector<std::string> fields = Split(data, " ");
+  if (fields.size() != 2 || !StartsWith(fields[0], "btime") || !ParseInt(fields[1], out)) {
+    ALOGW("Invalid btime line: \"%s\"", data.c_str());
+    return false;
+  }
+  return true;
+}
+
 }  // namespace
 
 Result<void> ProcStatCollector::collect() {
@@ -125,6 +134,7 @@ Result<ProcStatInfo> ProcStatCollector::getProcStatLocked() const {
     bool didReadContextSwitches = false;
     bool didReadProcsRunning = false;
     bool didReadProcsBlocked = false;
+    bool didReadBootTime = false;
     for (size_t i = 0; i < lines.size(); i++) {
         if (lines[i].empty()) {
             continue;
@@ -165,10 +175,23 @@ Result<ProcStatInfo> ProcStatCollector::getProcStatLocked() const {
                 continue;
             }
             return Error() << "Unknown procs_ line `" << lines[i] << "` in " << kPath;
+        } else if (!lines[i].compare(0, 5, "btime")) {
+            if (didReadBootTime) {
+              return Error() << "Duplicate `btime .*` line in " << kPath;
+            }
+            if (mLatestStats.kernelStartTimeEpochSeconds > 0) {
+              didReadBootTime = true;
+              info.kernelStartTimeEpochSeconds = mLatestStats.kernelStartTimeEpochSeconds;
+              continue;
+            }
+            if (!parseBootTime(std::move(lines[i]), &info.kernelStartTimeEpochSeconds)) {
+              return Error() << "Failed to parse `ctxt .*` line in " << kPath;
+            }
+            didReadBootTime = true;
         }
     }
     if (info.totalCpuTimeMillis() == 0 || !didReadContextSwitches || !didReadProcsRunning ||
-        !didReadProcsBlocked) {
+        !didReadProcsBlocked || !didReadBootTime) {
         return Error() << kPath << " is incomplete";
     }
     return info;
diff --git a/cpp/watchdog/server/src/ProcStatCollector.h b/cpp/watchdog/server/src/ProcStatCollector.h
index 6296aefced..150bf7f761 100644
--- a/cpp/watchdog/server/src/ProcStatCollector.h
+++ b/cpp/watchdog/server/src/ProcStatCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_PROCSTATCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_PROCSTATCOLLECTOR_H_
+#pragma once
 
 #include <android-base/result.h>
 #include <utils/Mutex.h>
@@ -60,16 +59,19 @@ class ProcStatInfo {
 public:
     ProcStatInfo() :
           cpuStats({}),
+          kernelStartTimeEpochSeconds(0),
           contextSwitchesCount(0),
           runnableProcessCount(0),
           ioBlockedProcessCount(0) {}
     ProcStatInfo(CpuStats stats, uint64_t ctxtSwitches, uint32_t runnableCnt,
-                 uint32_t ioBlockedCnt) :
+                 uint32_t ioBlockedCnt, time_t kernelStartTimeEpochSeconds) :
           cpuStats(stats),
+          kernelStartTimeEpochSeconds(kernelStartTimeEpochSeconds),
           contextSwitchesCount(ctxtSwitches),
           runnableProcessCount(runnableCnt),
           ioBlockedProcessCount(ioBlockedCnt) {}
     CpuStats cpuStats;
+    time_t kernelStartTimeEpochSeconds;
     uint64_t contextSwitchesCount;
     uint32_t runnableProcessCount;
     uint32_t ioBlockedProcessCount;
@@ -84,12 +86,16 @@ public:
     bool operator==(const ProcStatInfo& info) const {
         return memcmp(&cpuStats, &info.cpuStats, sizeof(cpuStats)) == 0 &&
                 runnableProcessCount == info.runnableProcessCount &&
-                ioBlockedProcessCount == info.ioBlockedProcessCount;
+                ioBlockedProcessCount == info.ioBlockedProcessCount &&
+                contextSwitchesCount == info.contextSwitchesCount &&
+                kernelStartTimeEpochSeconds == info.kernelStartTimeEpochSeconds;
     }
     ProcStatInfo& operator-=(const ProcStatInfo& rhs) {
         cpuStats -= rhs.cpuStats;
-        /* Don't diff *ProcessCount as they are real-time values unlike |cpuStats|, which are
-         * aggregated values since system startup.
+        contextSwitchesCount -= rhs.contextSwitchesCount;
+        /* Don't diff kernelStartTimeEpochSeconds, runnableProcessCount, and
+         * ioBlockedProcessCount because they are real-time values unlike other
+         * stats, which are aggregated values since system startup.
          */
         return *this;
     }
@@ -115,6 +121,9 @@ public:
 
     // Returns the delta of stats from the latest collection.
     virtual const ProcStatInfo deltaStats() const = 0;
+
+    // Returns the Kernel start time.
+    virtual time_t getKernelStartTimeEpochSeconds() = 0;
 };
 
 // Collector/parser for `/proc/stat` file.
@@ -152,6 +161,10 @@ public:
         return mDeltaStats;
     }
 
+    time_t getKernelStartTimeEpochSeconds() {
+        return mLatestStats.kernelStartTimeEpochSeconds;
+    }
+
 private:
     // Reads the contents of |kPath|.
     android::base::Result<ProcStatInfo> getProcStatLocked() const;
@@ -178,5 +191,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_PROCSTATCOLLECTOR_H_
diff --git a/cpp/watchdog/server/src/ServiceManager.h b/cpp/watchdog/server/src/ServiceManager.h
index 2bca4e61be..a6c419658b 100644
--- a/cpp/watchdog/server/src/ServiceManager.h
+++ b/cpp/watchdog/server/src/ServiceManager.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_SERVICEMANAGER_H_
-#define CPP_WATCHDOG_SERVER_SRC_SERVICEMANAGER_H_
+#pragma once
 
 #include "IoOveruseMonitor.h"
 #include "PressureMonitor.h"
@@ -45,9 +44,9 @@ public:
           mPressureMonitor(nullptr) {}
 
     // Returns the singleton ServiceManager instance.
-    static android::sp<ServiceManager> getInstance() {
+    static std::shared_ptr<ServiceManager> getInstance() {
         if (sServiceManager == nullptr) {
-            sServiceManager = android::sp<ServiceManager>::make();
+            sServiceManager = std::make_shared<ServiceManager>();
         }
         return sServiceManager;
     }
@@ -58,7 +57,7 @@ public:
             return;
         }
         sServiceManager->terminateServices();
-        sServiceManager.clear();
+        sServiceManager.reset();
     }
 
     // Starts early-init services.
@@ -80,7 +79,7 @@ public:
     }
 
 private:
-    inline static android::sp<ServiceManager> sServiceManager = nullptr;
+    inline static std::shared_ptr<ServiceManager> sServiceManager = nullptr;
 
     void terminateServices();
     android::base::Result<void> startWatchdogProcessService(const android::sp<Looper>& mainLooper);
@@ -99,5 +98,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_SRC_SERVICEMANAGER_H_
diff --git a/cpp/watchdog/server/src/ThreadPriorityController.h b/cpp/watchdog/server/src/ThreadPriorityController.h
index 023559872d..6ff0011fb5 100644
--- a/cpp/watchdog/server/src/ThreadPriorityController.h
+++ b/cpp/watchdog/server/src/ThreadPriorityController.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_THREADPRIORITYCONTROLLER_H_
-#define CPP_WATCHDOG_SERVER_SRC_THREADPRIORITYCONTROLLER_H_
+#pragma once
 
 #include <aidl/android/automotive/watchdog/internal/ThreadPolicyWithPriority.h>
 #include <android-base/result.h>
@@ -78,5 +77,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_SRC_THREADPRIORITYCONTROLLER_H_
diff --git a/cpp/watchdog/server/src/UidCpuStatsCollector.h b/cpp/watchdog/server/src/UidCpuStatsCollector.h
index 5d4919654b..17fa5ac90b 100644
--- a/cpp/watchdog/server/src/UidCpuStatsCollector.h
+++ b/cpp/watchdog/server/src/UidCpuStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_UIDCPUSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_UIDCPUSTATSCOLLECTOR_H_
+#pragma once
 
 #include <android-base/result.h>
 #include <android-base/stringprintf.h>
@@ -103,5 +102,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_SRC_UIDCPUSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/src/UidIoStatsCollector.h b/cpp/watchdog/server/src/UidIoStatsCollector.h
index e83f7192f1..e3cd7c7c08 100644
--- a/cpp/watchdog/server/src/UidIoStatsCollector.h
+++ b/cpp/watchdog/server/src/UidIoStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_UIDIOSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_UIDIOSTATSCOLLECTOR_H_
+#pragma once
 
 #include <android-base/result.h>
 #include <android-base/stringprintf.h>
@@ -155,5 +154,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_UIDIOSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/src/UidProcStatsCollector.h b/cpp/watchdog/server/src/UidProcStatsCollector.h
index 0c69491f10..10e641f400 100644
--- a/cpp/watchdog/server/src/UidProcStatsCollector.h
+++ b/cpp/watchdog/server/src/UidProcStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_UIDPROCSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_UIDPROCSTATSCOLLECTOR_H_
+#pragma once
 
 #include <android-base/result.h>
 #include <android-base/stringprintf.h>
@@ -248,5 +247,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_UIDPROCSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/src/UidStatsCollector.h b/cpp/watchdog/server/src/UidStatsCollector.h
index 0ce5f648e1..7a41c2f0b5 100644
--- a/cpp/watchdog/server/src/UidStatsCollector.h
+++ b/cpp/watchdog/server/src/UidStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_UIDSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_UIDSTATSCOLLECTOR_H_
+#pragma once
 
 #include "PackageInfoResolver.h"
 #include "UidCpuStatsCollector.h"
@@ -129,5 +128,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_UIDSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/src/WatchdogBinderMediator.h b/cpp/watchdog/server/src/WatchdogBinderMediator.h
index 182f750f4c..a46c21c0b4 100644
--- a/cpp/watchdog/server/src/WatchdogBinderMediator.h
+++ b/cpp/watchdog/server/src/WatchdogBinderMediator.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_WATCHDOGBINDERMEDIATOR_H_
-#define CPP_WATCHDOG_SERVER_SRC_WATCHDOGBINDERMEDIATOR_H_
+#pragma once
 
 #include "IoOveruseMonitor.h"
 #include "WatchdogInternalHandler.h"
@@ -158,5 +157,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_SRC_WATCHDOGBINDERMEDIATOR_H_
diff --git a/cpp/watchdog/server/src/WatchdogInternalHandler.h b/cpp/watchdog/server/src/WatchdogInternalHandler.h
index 198ed0b4f6..efc5cdcca0 100644
--- a/cpp/watchdog/server/src/WatchdogInternalHandler.h
+++ b/cpp/watchdog/server/src/WatchdogInternalHandler.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_WATCHDOGINTERNALHANDLER_H_
-#define CPP_WATCHDOG_SERVER_SRC_WATCHDOGINTERNALHANDLER_H_
+#pragma once
 
 #include "IoOveruseMonitor.h"
 #include "ThreadPriorityController.h"
@@ -157,5 +156,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_SRC_WATCHDOGINTERNALHANDLER_H_
diff --git a/cpp/watchdog/server/src/WatchdogPerfService.cpp b/cpp/watchdog/server/src/WatchdogPerfService.cpp
index ef0eec738b..1a2c2f01ca 100644
--- a/cpp/watchdog/server/src/WatchdogPerfService.cpp
+++ b/cpp/watchdog/server/src/WatchdogPerfService.cpp
@@ -265,7 +265,7 @@ Result<void> WatchdogPerfService::start() {
             }
             notifySystemStartUpLocked();
             mCurrCollectionEvent = EventType::BOOT_TIME_COLLECTION;
-            mBoottimeCollection.lastPollUptimeNs = mHandlerLooper->now();
+            mBoottimeCollection.lastPollElapsedRealTimeNs = mHandlerLooper->now();
             mHandlerLooper->setLooper(Looper::prepare(/*opts=*/0));
             mHandlerLooper->sendMessage(sp<WatchdogPerfService>::fromExisting(this),
                                         EventType::BOOT_TIME_COLLECTION);
@@ -355,6 +355,10 @@ Result<void> WatchdogPerfService::onBootFinished() {
               toString(expected));
         return {};
     }
+
+    mBootCompletedTimeEpochSeconds = std::chrono::system_clock::to_time_t(
+          std::chrono::system_clock::now());
+
     mHandlerLooper->sendMessageAtTime(mHandlerLooper->now() + mPostSystemEventDurationNs.count(),
                                       sp<WatchdogPerfService>::fromExisting(this),
                                       SwitchMessage::END_BOOTTIME_COLLECTION);
@@ -445,7 +449,7 @@ Result<void> WatchdogPerfService::onUserStateChange(userid_t userId, const UserS
 Result<void> WatchdogPerfService::startUserSwitchCollection() {
     auto thiz = sp<WatchdogPerfService>::fromExisting(this);
     mHandlerLooper->removeMessages(thiz);
-    mUserSwitchCollection.lastPollUptimeNs = mHandlerLooper->now();
+    mUserSwitchCollection.lastPollElapsedRealTimeNs = mHandlerLooper->now();
     // End |EventType::USER_SWITCH_COLLECTION| after a timeout because the user switch end
     // signal won't be received within a few seconds when the switch is blocked due to a
     // keyguard event. Otherwise, polling beyond a few seconds will lead to unnecessary data
@@ -475,7 +479,7 @@ Result<void> WatchdogPerfService::onSuspendExit() {
     auto thiz = sp<WatchdogPerfService>::fromExisting(this);
     mHandlerLooper->removeMessages(thiz);
     nsecs_t now = mHandlerLooper->now();
-    mWakeUpCollection.lastPollUptimeNs = now;
+    mWakeUpCollection.lastPollElapsedRealTimeNs = now;
     mHandlerLooper->sendMessageAtTime(now + mWakeUpDurationNs.count(), thiz,
                                       SwitchMessage::END_WAKE_UP_COLLECTION);
     mCurrCollectionEvent = EventType::WAKE_UP_COLLECTION;
@@ -579,9 +583,23 @@ Result<void> WatchdogPerfService::onDump(int fd) const {
         return Error(FAILED_TRANSACTION) << result.error();
     }
 
-    if (!WriteStringToFd(StringPrintf("\n%s%s report:\n%sBoot-time collection information:\n%s\n",
+    std::stringstream bootCompletedTimestamp;
+    if (mBootCompletedTimeEpochSeconds != 0) {
+        bootCompletedTimestamp << std::put_time(std::localtime(&mBootCompletedTimeEpochSeconds),
+                                              "%c %Z");
+    } else {
+        bootCompletedTimestamp << "Missing";
+    }
+    if (!WriteStringToFd(StringPrintf("\n%s%s report:\n%sSystem information:\n%s\n"
+                                      "Boot completed time: <%s>\n",
                                       kDumpMajorDelimiter.c_str(), kServiceName,
-                                      kDumpMajorDelimiter.c_str(), std::string(33, '=').c_str()),
+                                      kDumpMajorDelimiter.c_str(),
+                                      std::string(33, '=').c_str(),
+                                      bootCompletedTimestamp.str().c_str()),
+                         fd) ||
+        !WriteStringToFd(StringPrintf("\nBoot-time collection "
+                      "information:\n%s\n",
+                      std::string(33, '=').c_str()),
                          fd) ||
         !WriteStringToFd(mBoottimeCollection.toString(), fd) ||
         !WriteStringToFd(StringPrintf("\nWake-up collection information:\n%s\n",
@@ -620,6 +638,8 @@ Result<void> WatchdogPerfService::onDumpProto(ProtoOutputStream& outProto) const
             outProto.start(CarWatchdogDaemonDump::PERFORMANCE_PROFILER_DUMP);
 
     outProto.write(PerformanceProfilerDump::CURRENT_EVENT, toProtoEventType(mCurrCollectionEvent));
+    outProto.write(PerformanceProfilerDump::BOOT_COMPLETED_TIME_EPOCH_SECONDS,
+                   mBootCompletedTimeEpochSeconds);
 
     DataProcessorInterface::CollectionIntervals collectionIntervals =
             {.mBoottimeIntervalMillis = std::chrono::duration_cast<std::chrono::milliseconds>(
@@ -689,7 +709,7 @@ Result<void> WatchdogPerfService::startCustomCollection(
     mCustomCollection = {
             .eventType = EventType::CUSTOM_COLLECTION,
             .pollingIntervalNs = interval,
-            .lastPollUptimeNs = now,
+            .lastPollElapsedRealTimeNs = now,
             .filterPackages = filterPackages,
     };
 
@@ -748,17 +768,18 @@ void WatchdogPerfService::switchToPeriodicLocked(bool startNow) {
     auto thiz = sp<WatchdogPerfService>::fromExisting(this);
     mHandlerLooper->removeMessages(thiz);
     mCurrCollectionEvent = EventType::PERIODIC_COLLECTION;
-    mPeriodicCollection.lastPollUptimeNs = mHandlerLooper->now();
+    mPeriodicCollection.lastPollElapsedRealTimeNs = mHandlerLooper->now();
     if (startNow) {
         mHandlerLooper->sendMessage(thiz, EventType::PERIODIC_COLLECTION);
     } else {
-        mPeriodicCollection.lastPollUptimeNs += mPeriodicCollection.pollingIntervalNs.count();
-        mHandlerLooper->sendMessageAtTime(mPeriodicCollection.lastPollUptimeNs, thiz,
+        mPeriodicCollection.lastPollElapsedRealTimeNs +=
+                mPeriodicCollection.pollingIntervalNs.count();
+        mHandlerLooper->sendMessageAtTime(mPeriodicCollection.lastPollElapsedRealTimeNs, thiz,
                                           EventType::PERIODIC_COLLECTION);
     }
-    mPeriodicMonitor.lastPollUptimeNs =
+    mPeriodicMonitor.lastPollElapsedRealTimeNs =
             mHandlerLooper->now() + mPeriodicMonitor.pollingIntervalNs.count();
-    mHandlerLooper->sendMessageAtTime(mPeriodicMonitor.lastPollUptimeNs, thiz,
+    mHandlerLooper->sendMessageAtTime(mPeriodicMonitor.lastPollElapsedRealTimeNs, thiz,
                                       EventType::PERIODIC_MONITOR);
     ALOGI("Switching to %s and %s", toString(mCurrCollectionEvent),
           toString(EventType::PERIODIC_MONITOR));
@@ -874,8 +895,8 @@ Result<void> WatchdogPerfService::processCollectionEvent(
     if (const auto result = collectLocked(metadata); !result.ok()) {
         return Error() << toString(metadata->eventType) << " collection failed: " << result.error();
     }
-    metadata->lastPollUptimeNs += metadata->pollingIntervalNs.count();
-    mHandlerLooper->sendMessageAtTime(metadata->lastPollUptimeNs,
+    metadata->lastPollElapsedRealTimeNs += metadata->pollingIntervalNs.count();
+    mHandlerLooper->sendMessageAtTime(metadata->lastPollElapsedRealTimeNs,
                                       sp<WatchdogPerfService>::fromExisting(this),
                                       metadata->eventType);
     return {};
@@ -1000,14 +1021,15 @@ Result<void> WatchdogPerfService::processMonitorEvent(
         if (requestedCollection) {
             return;
         }
-        const nsecs_t prevUptimeNs = currCollectionMetadata->lastPollUptimeNs -
+        const nsecs_t prevLastPollElapsedRealTimeNs =
+                currCollectionMetadata->lastPollElapsedRealTimeNs -
                 currCollectionMetadata->pollingIntervalNs.count();
-        nsecs_t uptimeNs = mHandlerLooper->now();
-        if (const auto delta = std::abs(uptimeNs - prevUptimeNs);
+        nsecs_t lastPollElapsedRealTimeNs = mHandlerLooper->now();
+        if (const auto delta = std::abs(lastPollElapsedRealTimeNs - prevLastPollElapsedRealTimeNs);
             delta < kMinEventInterval.count()) {
             return;
         }
-        currCollectionMetadata->lastPollUptimeNs = uptimeNs;
+        currCollectionMetadata->lastPollElapsedRealTimeNs = lastPollElapsedRealTimeNs;
         mHandlerLooper->removeMessages(thiz, currCollectionMetadata->eventType);
         mHandlerLooper->sendMessage(thiz, currCollectionMetadata->eventType);
         requestedCollection = true;
@@ -1020,15 +1042,16 @@ Result<void> WatchdogPerfService::processMonitorEvent(
                            << ": " << result.error();
         }
     }
-    metadata->lastPollUptimeNs += metadata->pollingIntervalNs.count();
-    if (metadata->lastPollUptimeNs == currCollectionMetadata->lastPollUptimeNs) {
+    metadata->lastPollElapsedRealTimeNs += metadata->pollingIntervalNs.count();
+    if (metadata->lastPollElapsedRealTimeNs == currCollectionMetadata->lastPollElapsedRealTimeNs) {
         /*
          * If the |PERIODIC_MONITOR| and  *_COLLECTION events overlap, skip the |PERIODIC_MONITOR|
          * event.
          */
-        metadata->lastPollUptimeNs += metadata->pollingIntervalNs.count();
+        metadata->lastPollElapsedRealTimeNs += metadata->pollingIntervalNs.count();
     }
-    mHandlerLooper->sendMessageAtTime(metadata->lastPollUptimeNs, thiz, metadata->eventType);
+    mHandlerLooper->sendMessageAtTime(metadata->lastPollElapsedRealTimeNs, thiz,
+                                      metadata->eventType);
     return {};
 }
 
diff --git a/cpp/watchdog/server/src/WatchdogPerfService.h b/cpp/watchdog/server/src/WatchdogPerfService.h
index 90405af778..d3aebc6961 100644
--- a/cpp/watchdog/server/src/WatchdogPerfService.h
+++ b/cpp/watchdog/server/src/WatchdogPerfService.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_WATCHDOGPERFSERVICE_H_
-#define CPP_WATCHDOG_SERVER_SRC_WATCHDOGPERFSERVICE_H_
+#pragma once
 
 #include "LooperWrapper.h"
 #include "ProcDiskStatsCollector.h"
@@ -277,6 +276,7 @@ public:
           mPeriodicMonitor({}),
           mUnsentResourceStats({}),
           mLastCollectionTimeMillis(0),
+          mBootCompletedTimeEpochSeconds(0),
           mCurrCollectionEvent(EventType::INIT),
           mUidStatsCollector(android::sp<UidStatsCollector>::make()),
           mProcStatCollector(android::sp<ProcStatCollector>::make()),
@@ -321,7 +321,7 @@ private:
         // Interval between subsequent events.
         std::chrono::nanoseconds pollingIntervalNs = 0ns;
         // Used to calculate the uptime for next event.
-        nsecs_t lastPollUptimeNs = 0;
+        nsecs_t lastPollElapsedRealTimeNs = 0;
         // Filter the results only to the specified packages.
         std::unordered_set<std::string> filterPackages;
 
@@ -445,6 +445,9 @@ private:
     // Tracks the latest collection time since boot in millis.
     int64_t mLastCollectionTimeMillis GUARDED_BY(mMutex);
 
+    // Time of receiving boot complete signal.
+    time_t mBootCompletedTimeEpochSeconds GUARDED_BY(mMutex);
+
     // Tracks either the WatchdogPerfService's state or current collection event. Updated on
     // |start|, |onBootFinished|, |onUserStateChange|, |startCustomCollection|,
     // |endCustomCollection|, and |terminate|.
@@ -473,5 +476,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_SRC_WATCHDOGPERFSERVICE_H_
diff --git a/cpp/watchdog/server/src/WatchdogProcessService.h b/cpp/watchdog/server/src/WatchdogProcessService.h
index 7f0fbfaa16..8af51cf408 100644
--- a/cpp/watchdog/server/src/WatchdogProcessService.h
+++ b/cpp/watchdog/server/src/WatchdogProcessService.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_WATCHDOGPROCESSSERVICE_H_
-#define CPP_WATCHDOG_SERVER_SRC_WATCHDOGPROCESSSERVICE_H_
+#pragma once
 
 #include "AIBinderDeathRegistrationWrapper.h"
 
@@ -345,5 +344,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_SRC_WATCHDOGPROCESSSERVICE_H_
diff --git a/cpp/watchdog/server/src/WatchdogServiceHelper.h b/cpp/watchdog/server/src/WatchdogServiceHelper.h
index bee75af2fe..3d6f737bfe 100644
--- a/cpp/watchdog/server/src/WatchdogServiceHelper.h
+++ b/cpp/watchdog/server/src/WatchdogServiceHelper.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_SRC_WATCHDOGSERVICEHELPER_H_
-#define CPP_WATCHDOG_SERVER_SRC_WATCHDOGSERVICEHELPER_H_
+#pragma once
 
 #include "AIBinderDeathRegistrationWrapper.h"
 #include "WatchdogProcessService.h"
@@ -154,5 +153,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_SRC_WATCHDOGSERVICEHELPER_H_
diff --git a/cpp/watchdog/server/tests/IoOveruseMonitorTest.cpp b/cpp/watchdog/server/tests/IoOveruseMonitorTest.cpp
index 0e6484c178..9d92e8c699 100644
--- a/cpp/watchdog/server/tests/IoOveruseMonitorTest.cpp
+++ b/cpp/watchdog/server/tests/IoOveruseMonitorTest.cpp
@@ -1013,8 +1013,7 @@ TEST_F(IoOveruseMonitorTest, TestRegisterResourceOveruseListener) {
     std::shared_ptr<MockResourceOveruseListener> mockResourceOveruseListener =
             SharedRefBase::make<MockResourceOveruseListener>();
 
-    expectLinkToDeath(mockResourceOveruseListener->asBinder().get(),
-                      std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(mockResourceOveruseListener->asBinder().get(), ScopedAStatus::ok());
 
     ASSERT_RESULT_OK(mIoOveruseMonitor->addIoOveruseListener(mockResourceOveruseListener));
 
@@ -1027,7 +1026,7 @@ TEST_F(IoOveruseMonitorTest, TestErrorsRegisterResourceOveruseListenerOnLinkToDe
 
     ASSERT_NO_FATAL_FAILURE(
             expectLinkToDeath(mockResourceOveruseListener->asBinder().get(),
-                              std::move(ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED))));
+                              ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED)));
 
     ASSERT_FALSE(mIoOveruseMonitor->addIoOveruseListener(mockResourceOveruseListener).ok());
 }
@@ -1038,8 +1037,7 @@ TEST_F(IoOveruseMonitorTest, TestDuplicateRemoveIoOveruseListener) {
 
     ASSERT_RESULT_OK(mIoOveruseMonitor->addIoOveruseListener(mockResourceOveruseListener));
 
-    expectUnlinkToDeath(mockResourceOveruseListener->asBinder().get(),
-                        std::move(ScopedAStatus::ok()));
+    expectUnlinkToDeath(mockResourceOveruseListener->asBinder().get(), ScopedAStatus::ok());
 
     ASSERT_RESULT_OK(mIoOveruseMonitor->removeIoOveruseListener(mockResourceOveruseListener));
 
@@ -1054,7 +1052,7 @@ TEST_F(IoOveruseMonitorTest, TestRemoveIoOveruseListenerOnUnlinkToDeathError) {
     ASSERT_RESULT_OK(mIoOveruseMonitor->addIoOveruseListener(mockResourceOveruseListener));
 
     expectUnlinkToDeath(mockResourceOveruseListener->asBinder().get(),
-                        std::move(ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED)));
+                        ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED));
 
     ASSERT_RESULT_OK(mIoOveruseMonitor->removeIoOveruseListener(mockResourceOveruseListener));
 }
diff --git a/cpp/watchdog/server/tests/LooperStub.h b/cpp/watchdog/server/tests/LooperStub.h
index 2456efe36d..4a06002815 100644
--- a/cpp/watchdog/server/tests/LooperStub.h
+++ b/cpp/watchdog/server/tests/LooperStub.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_LOOPERSTUB_H_
-#define CPP_WATCHDOG_SERVER_TESTS_LOOPERSTUB_H_
+#pragma once
 
 #include <android-base/chrono_utils.h>
 #include <android-base/result.h>
@@ -89,5 +88,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_TESTS_LOOPERSTUB_H_
diff --git a/cpp/watchdog/server/tests/MockAIBinderDeathRegistrationWrapper.h b/cpp/watchdog/server/tests/MockAIBinderDeathRegistrationWrapper.h
index 0fdb57288e..5487d58ec2 100644
--- a/cpp/watchdog/server/tests/MockAIBinderDeathRegistrationWrapper.h
+++ b/cpp/watchdog/server/tests/MockAIBinderDeathRegistrationWrapper.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKAIBINDERDEATHREGISTRATIONWRAPPER_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKAIBINDERDEATHREGISTRATIONWRAPPER_H_
+#pragma once
 
 #include "AIBinderDeathRegistrationWrapper.h"
 
@@ -43,5 +42,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKAIBINDERDEATHREGISTRATIONWRAPPER_H_
diff --git a/cpp/watchdog/server/tests/MockCarWatchdogServiceForSystem.h b/cpp/watchdog/server/tests/MockCarWatchdogServiceForSystem.h
index 1caa2baf11..7738c1594a 100644
--- a/cpp/watchdog/server/tests/MockCarWatchdogServiceForSystem.h
+++ b/cpp/watchdog/server/tests/MockCarWatchdogServiceForSystem.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKCARWATCHDOGSERVICEFORSYSTEM_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKCARWATCHDOGSERVICEFORSYSTEM_H_
+#pragma once
 
 #include <aidl/android/automotive/watchdog/internal/BnCarWatchdogServiceForSystem.h>
 #include <aidl/android/automotive/watchdog/internal/TimeoutLength.h>
@@ -58,5 +57,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKCARWATCHDOGSERVICEFORSYSTEM_H_
diff --git a/cpp/watchdog/server/tests/MockDataProcessor.h b/cpp/watchdog/server/tests/MockDataProcessor.h
index a98bdb8647..e960ea8d91 100644
--- a/cpp/watchdog/server/tests/MockDataProcessor.h
+++ b/cpp/watchdog/server/tests/MockDataProcessor.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKDATAPROCESSOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKDATAPROCESSOR_H_
+#pragma once
 
 #include "WatchdogPerfService.h"
 
@@ -71,5 +70,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKDATAPROCESSOR_H_
diff --git a/cpp/watchdog/server/tests/MockHidlServiceManager.h b/cpp/watchdog/server/tests/MockHidlServiceManager.h
index 869bff3d31..1bc02b9727 100644
--- a/cpp/watchdog/server/tests/MockHidlServiceManager.h
+++ b/cpp/watchdog/server/tests/MockHidlServiceManager.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKHIDLSERVICEMANAGER_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKHIDLSERVICEMANAGER_H_
+#pragma once
 
 #include <android/hidl/manager/1.0/IServiceManager.h>
 #include <gmock/gmock.h>
@@ -65,5 +64,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKHIDLSERVICEMANAGER_H_
diff --git a/cpp/watchdog/server/tests/MockIoOveruseConfigs.h b/cpp/watchdog/server/tests/MockIoOveruseConfigs.h
index 7da729be58..ec4a555783 100644
--- a/cpp/watchdog/server/tests/MockIoOveruseConfigs.h
+++ b/cpp/watchdog/server/tests/MockIoOveruseConfigs.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKIOOVERUSECONFIGS_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKIOOVERUSECONFIGS_H_
+#pragma once
 
 #include "IoOveruseConfigs.h"
 
@@ -103,5 +102,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKIOOVERUSECONFIGS_H_
diff --git a/cpp/watchdog/server/tests/MockIoOveruseMonitor.h b/cpp/watchdog/server/tests/MockIoOveruseMonitor.h
index fc98cf46b5..9a89e173e8 100644
--- a/cpp/watchdog/server/tests/MockIoOveruseMonitor.h
+++ b/cpp/watchdog/server/tests/MockIoOveruseMonitor.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKIOOVERUSEMONITOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKIOOVERUSEMONITOR_H_
+#pragma once
 
 #include "IoOveruseMonitor.h"
 #include "MockDataProcessor.h"
@@ -69,5 +68,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKIOOVERUSEMONITOR_H_
diff --git a/cpp/watchdog/server/tests/MockPackageInfoResolver.h b/cpp/watchdog/server/tests/MockPackageInfoResolver.h
index 2eb9cf30e8..8db9dd2973 100644
--- a/cpp/watchdog/server/tests/MockPackageInfoResolver.h
+++ b/cpp/watchdog/server/tests/MockPackageInfoResolver.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKPACKAGEINFORESOLVER_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKPACKAGEINFORESOLVER_H_
+#pragma once
 
 #include "PackageInfoResolver.h"
 
@@ -53,5 +52,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKPACKAGEINFORESOLVER_H_
diff --git a/cpp/watchdog/server/tests/MockPressureChangeCallback.h b/cpp/watchdog/server/tests/MockPressureChangeCallback.h
index fe9fd703a0..db4e519d1d 100644
--- a/cpp/watchdog/server/tests/MockPressureChangeCallback.h
+++ b/cpp/watchdog/server/tests/MockPressureChangeCallback.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKPRESSURECHANGECALLBACK_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKPRESSURECHANGECALLBACK_H_
+#pragma once
 
 #include "PressureMonitor.h"
 
@@ -34,5 +33,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKPRESSURECHANGECALLBACK_H_
diff --git a/cpp/watchdog/server/tests/MockPressureMonitor.h b/cpp/watchdog/server/tests/MockPressureMonitor.h
index 18e24a69d1..61cf7d452f 100644
--- a/cpp/watchdog/server/tests/MockPressureMonitor.h
+++ b/cpp/watchdog/server/tests/MockPressureMonitor.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKPRESSUREMONITOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKPRESSUREMONITOR_H_
+#pragma once
 
 #include "PressureMonitor.h"
 
@@ -50,5 +49,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKPRESSUREMONITOR_H_
diff --git a/cpp/watchdog/server/tests/MockProcDiskStatsCollector.h b/cpp/watchdog/server/tests/MockProcDiskStatsCollector.h
index f06ad376d9..dd6501e93e 100644
--- a/cpp/watchdog/server/tests/MockProcDiskStatsCollector.h
+++ b/cpp/watchdog/server/tests/MockProcDiskStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKPROCDISKSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKPROCDISKSTATSCOLLECTOR_H_
+#pragma once
 
 #include "ProcDiskStatsCollector.h"
 
@@ -44,5 +43,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKPROCDISKSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/tests/MockProcStatCollector.h b/cpp/watchdog/server/tests/MockProcStatCollector.h
index 77de55a15f..86c17a7f18 100644
--- a/cpp/watchdog/server/tests/MockProcStatCollector.h
+++ b/cpp/watchdog/server/tests/MockProcStatCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKPROCSTATCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKPROCSTATCOLLECTOR_H_
+#pragma once
 
 #include "ProcStatCollector.h"
 
@@ -37,10 +36,9 @@ public:
     MOCK_METHOD(const ProcStatInfo, latestStats, (), (const, override));
     MOCK_METHOD(const ProcStatInfo, deltaStats, (), (const, override));
     MOCK_METHOD(std::string, filePath, (), (override));
+    MOCK_METHOD(time_t, getKernelStartTimeEpochSeconds, (), (override));
 };
 
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKPROCSTATCOLLECTOR_H_
diff --git a/cpp/watchdog/server/tests/MockResourceOveruseListener.h b/cpp/watchdog/server/tests/MockResourceOveruseListener.h
index 1e537e5e73..81d43ee02a 100644
--- a/cpp/watchdog/server/tests/MockResourceOveruseListener.h
+++ b/cpp/watchdog/server/tests/MockResourceOveruseListener.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKRESOURCEOVERUSELISTENER_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKRESOURCEOVERUSELISTENER_H_
+#pragma once
 
 #include <aidl/android/automotive/watchdog/IResourceOveruseListener.h>
 #include <aidl/android/automotive/watchdog/ResourceOveruseStats.h>
@@ -40,5 +39,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKRESOURCEOVERUSELISTENER_H_
diff --git a/cpp/watchdog/server/tests/MockSubscriptionClient.h b/cpp/watchdog/server/tests/MockSubscriptionClient.h
index b4f7af11dd..199735742e 100644
--- a/cpp/watchdog/server/tests/MockSubscriptionClient.h
+++ b/cpp/watchdog/server/tests/MockSubscriptionClient.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKSUBSCRIPTIONCLIENT_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKSUBSCRIPTIONCLIENT_H_
+#pragma once
 
 #include "MockVehicle.h"
 
@@ -79,5 +78,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_TESTS_MOCKSUBSCRIPTIONCLIENT_H_
diff --git a/cpp/watchdog/server/tests/MockUidCpuStatsCollector.h b/cpp/watchdog/server/tests/MockUidCpuStatsCollector.h
index 3f42187cc9..f455959c72 100644
--- a/cpp/watchdog/server/tests/MockUidCpuStatsCollector.h
+++ b/cpp/watchdog/server/tests/MockUidCpuStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKUIDCPUSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKUIDCPUSTATSCOLLECTOR_H_
+#pragma once
 
 #include "UidCpuStatsCollector.h"
 
@@ -43,5 +42,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_TESTS_MOCKUIDCPUSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/tests/MockUidIoStatsCollector.h b/cpp/watchdog/server/tests/MockUidIoStatsCollector.h
index 466237fb25..3705a9c10b 100644
--- a/cpp/watchdog/server/tests/MockUidIoStatsCollector.h
+++ b/cpp/watchdog/server/tests/MockUidIoStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKUIDIOSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKUIDIOSTATSCOLLECTOR_H_
+#pragma once
 
 #include "UidIoStatsCollector.h"
 
@@ -43,5 +42,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKUIDIOSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/tests/MockUidProcStatsCollector.h b/cpp/watchdog/server/tests/MockUidProcStatsCollector.h
index b65dc10468..02af33d14c 100644
--- a/cpp/watchdog/server/tests/MockUidProcStatsCollector.h
+++ b/cpp/watchdog/server/tests/MockUidProcStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKUIDPROCSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKUIDPROCSTATSCOLLECTOR_H_
+#pragma once
 
 #include "UidProcStatsCollector.h"
 
@@ -46,5 +45,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKUIDPROCSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/tests/MockUidStatsCollector.h b/cpp/watchdog/server/tests/MockUidStatsCollector.h
index 402b043903..a79844dab6 100644
--- a/cpp/watchdog/server/tests/MockUidStatsCollector.h
+++ b/cpp/watchdog/server/tests/MockUidStatsCollector.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKUIDSTATSCOLLECTOR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKUIDSTATSCOLLECTOR_H_
+#pragma once
 
 #include "UidStatsCollector.h"
 
@@ -42,5 +41,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKUIDSTATSCOLLECTOR_H_
diff --git a/cpp/watchdog/server/tests/MockVehicle.h b/cpp/watchdog/server/tests/MockVehicle.h
index 0e08cb170a..cd68c8dfcd 100644
--- a/cpp/watchdog/server/tests/MockVehicle.h
+++ b/cpp/watchdog/server/tests/MockVehicle.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKVEHICLE_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKVEHICLE_H_
+#pragma once
 
 #include <aidl/android/hardware/automotive/vehicle/BnVehicle.h>
 #include <gmock/gmock.h>
@@ -69,5 +68,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_TESTS_MOCKVEHICLE_H_
diff --git a/cpp/watchdog/server/tests/MockVhalClient.h b/cpp/watchdog/server/tests/MockVhalClient.h
index ac209f4468..304e679155 100644
--- a/cpp/watchdog/server/tests/MockVhalClient.h
+++ b/cpp/watchdog/server/tests/MockVhalClient.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKVHALCLIENT_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKVHALCLIENT_H_
+#pragma once
 
 #include "MockSubscriptionClient.h"
 
@@ -81,5 +80,3 @@ private:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_TESTS_MOCKVHALCLIENT_H_
diff --git a/cpp/watchdog/server/tests/MockWatchdogInternalHandler.h b/cpp/watchdog/server/tests/MockWatchdogInternalHandler.h
index 20f258599a..21e1aea9c7 100644
--- a/cpp/watchdog/server/tests/MockWatchdogInternalHandler.h
+++ b/cpp/watchdog/server/tests/MockWatchdogInternalHandler.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGINTERNALHANDLER_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGINTERNALHANDLER_H_
+#pragma once
 
 #include "WatchdogInternalHandler.h"
 
@@ -91,5 +90,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGINTERNALHANDLER_H_
diff --git a/cpp/watchdog/server/tests/MockWatchdogPerfService.h b/cpp/watchdog/server/tests/MockWatchdogPerfService.h
index e9cd16f9d9..48349c58c3 100644
--- a/cpp/watchdog/server/tests/MockWatchdogPerfService.h
+++ b/cpp/watchdog/server/tests/MockWatchdogPerfService.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGPERFSERVICE_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGPERFSERVICE_H_
+#pragma once
 
 #include "WatchdogPerfService.h"
 #include "WatchdogServiceHelper.h"
@@ -59,5 +58,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGPERFSERVICE_H_
diff --git a/cpp/watchdog/server/tests/MockWatchdogProcessService.h b/cpp/watchdog/server/tests/MockWatchdogProcessService.h
index 8d8cb0d497..0eab711b23 100644
--- a/cpp/watchdog/server/tests/MockWatchdogProcessService.h
+++ b/cpp/watchdog/server/tests/MockWatchdogProcessService.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGPROCESSSERVICE_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGPROCESSSERVICE_H_
+#pragma once
 
 #include "WatchdogProcessService.h"
 #include "WatchdogServiceHelper.h"
@@ -91,5 +90,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGPROCESSSERVICE_H_
diff --git a/cpp/watchdog/server/tests/MockWatchdogServiceHelper.h b/cpp/watchdog/server/tests/MockWatchdogServiceHelper.h
index 3b114b1bcd..0c9cd35e7b 100644
--- a/cpp/watchdog/server/tests/MockWatchdogServiceHelper.h
+++ b/cpp/watchdog/server/tests/MockWatchdogServiceHelper.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGSERVICEHELPER_H_
-#define CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGSERVICEHELPER_H_
+#pragma once
 
 #include "WatchdogProcessService.h"
 #include "WatchdogServiceHelper.h"
@@ -79,5 +78,3 @@ public:
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_MOCKWATCHDOGSERVICEHELPER_H_
diff --git a/cpp/watchdog/server/tests/OveruseConfigurationTestUtils.h b/cpp/watchdog/server/tests/OveruseConfigurationTestUtils.h
index 3134bbf9e4..b9b94d63ad 100644
--- a/cpp/watchdog/server/tests/OveruseConfigurationTestUtils.h
+++ b/cpp/watchdog/server/tests/OveruseConfigurationTestUtils.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_OVERUSECONFIGURATIONTESTUTILS_H_
-#define CPP_WATCHDOG_SERVER_TESTS_OVERUSECONFIGURATIONTESTUTILS_H_
+#pragma once
 
 #include <aidl/android/automotive/watchdog/PerStateBytes.h>
 #include <aidl/android/automotive/watchdog/internal/ApplicationCategoryType.h>
@@ -92,5 +91,3 @@ ResourceOveruseConfigurationMatcher(
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_OVERUSECONFIGURATIONTESTUTILS_H_
diff --git a/cpp/watchdog/server/tests/PackageInfoTestUtils.h b/cpp/watchdog/server/tests/PackageInfoTestUtils.h
index 6db9a95ef3..43bd6759cc 100644
--- a/cpp/watchdog/server/tests/PackageInfoTestUtils.h
+++ b/cpp/watchdog/server/tests/PackageInfoTestUtils.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_PACKAGEINFOTESTUTILS_H_
-#define CPP_WATCHDOG_SERVER_TESTS_PACKAGEINFOTESTUTILS_H_
+#pragma once
 
 #include <aidl/android/automotive/watchdog/internal/ApplicationCategoryType.h>
 #include <aidl/android/automotive/watchdog/internal/ComponentType.h>
@@ -68,5 +67,3 @@ MATCHER_P(PackageInfoEq, expected, "") {
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_TESTS_PACKAGEINFOTESTUTILS_H_
diff --git a/cpp/watchdog/server/tests/PerformanceProfilerTest.cpp b/cpp/watchdog/server/tests/PerformanceProfilerTest.cpp
index 371cf9031d..b8bb587257 100644
--- a/cpp/watchdog/server/tests/PerformanceProfilerTest.cpp
+++ b/cpp/watchdog/server/tests/PerformanceProfilerTest.cpp
@@ -95,76 +95,80 @@ void applyFeatureFilter(UserPackageSummaryStats* userPackageSummaryStatsOut) {
     userPackageSummaryStatsOut->topNMemStats = {};
 }
 
-MATCHER_P(IoStatsViewEq, expected, "") {
-    return ExplainMatchResult(AllOf(Field("bytes", &UserPackageStats::IoStatsView::bytes,
+MATCHER_P(UidIoSingleOpStatsEq, expected, "") {
+    return ExplainMatchResult(AllOf(Field("bytes", &UserPackageStats::UidIoSingleOpStats::bytes,
                                           ElementsAreArray(expected.bytes)),
-                                    Field("fsync", &UserPackageStats::IoStatsView::fsync,
+                                    Field("fsync", &UserPackageStats::UidIoSingleOpStats::fsync,
                                           ElementsAreArray(expected.fsync))),
                               arg, result_listener);
 }
 
-MATCHER_P(ProcessValueEq, expected, "") {
-    return ExplainMatchResult(AllOf(Field("comm",
-                                          &UserPackageStats::ProcSingleStatsView::ProcessValue::
-                                                  comm,
-                                          Eq(expected.comm)),
-                                    Field("value",
-                                          &UserPackageStats::ProcSingleStatsView::ProcessValue::
-                                                  value,
-                                          Eq(expected.value))),
-                              arg, result_listener);
+MATCHER_P(ProcessSingleStatsEq, expected, "") {
+    return ExplainMatchResult(AllOf(
+              Field(
+                    "comm",
+                    &UserPackageStats::UidSingleStats::ProcessSingleStats::
+                            comm,
+                    Eq(expected.comm)),
+              Field("value",
+                    &UserPackageStats::UidSingleStats::ProcessSingleStats::
+                            value,
+                    Eq(expected.value))),
+        arg, result_listener);
 }
 
-MATCHER_P(ProcSingleStatsViewEq, expected, "") {
-    std::vector<Matcher<const UserPackageStats::ProcSingleStatsView::ProcessValue&>>
-            processValueMatchers;
-    processValueMatchers.reserve(expected.topNProcesses.size());
-    for (const auto& processValue : expected.topNProcesses) {
-        processValueMatchers.push_back(ProcessValueEq(processValue));
+MATCHER_P(UidSingleStatsEq, expected, "") {
+    std::vector<Matcher<const UserPackageStats::UidSingleStats::ProcessSingleStats&>>
+            processSingleStatsMatchers;
+    processSingleStatsMatchers.reserve(expected.topNProcesses.size());
+    for (const auto& processSingleStats : expected.topNProcesses) {
+        processSingleStatsMatchers.push_back(ProcessSingleStatsEq(processSingleStats));
     }
-    return ExplainMatchResult(AllOf(Field("value", &UserPackageStats::ProcSingleStatsView::value,
+    return ExplainMatchResult(AllOf(
+              Field("value", &UserPackageStats::UidSingleStats::value,
                                           Eq(expected.value)),
-                                    Field("topNProcesses",
-                                          &UserPackageStats::ProcSingleStatsView::topNProcesses,
-                                          ElementsAreArray(processValueMatchers))),
-                              arg, result_listener);
+              Field("topNProcesses",
+                    &UserPackageStats::UidSingleStats::topNProcesses,
+                    ElementsAreArray(processSingleStatsMatchers))),
+        arg, result_listener);
 }
 
-MATCHER_P(ProcessCpuValueEq, expected, "") {
-    return ExplainMatchResult(AllOf(Field("pid",
-                                          &UserPackageStats::ProcCpuStatsView::ProcessCpuValue::pid,
-                                          Eq(expected.pid)),
-                                    Field("comm",
-                                          &UserPackageStats::ProcCpuStatsView::ProcessCpuValue::
-                                                  comm,
-                                          Eq(expected.comm)),
-                                    Field("cpuTimeMillis",
-                                          &UserPackageStats::ProcCpuStatsView::ProcessCpuValue::
-                                                  cpuTimeMillis,
-                                          Eq(expected.cpuTimeMillis)),
-                                    Field("cpuCycles",
-                                          &UserPackageStats::ProcCpuStatsView::ProcessCpuValue::
-                                                  cpuCycles,
-                                          Eq(expected.cpuCycles))),
-                              arg, result_listener);
+MATCHER_P(ProcessCpuStatsEq, expected, "") {
+    return ExplainMatchResult(AllOf(
+              Field("pid",
+                    &UserPackageStats::UidCpuStats::ProcessCpuStats::pid,
+                    Eq(expected.pid)),
+              Field("comm",
+                    &UserPackageStats::UidCpuStats::ProcessCpuStats::
+                            comm,
+                    Eq(expected.comm)),
+              Field("cpuTimeMillis",
+                    &UserPackageStats::UidCpuStats::ProcessCpuStats::
+                            cpuTimeMillis,
+                    Eq(expected.cpuTimeMillis)),
+              Field("cpuCycles",
+                    &UserPackageStats::UidCpuStats::ProcessCpuStats::
+                            cpuCycles,
+                    Eq(expected.cpuCycles))),
+        arg, result_listener);
 }
 
-MATCHER_P(ProcCpuStatsViewEq, expected, "") {
-    std::vector<Matcher<const UserPackageStats::ProcCpuStatsView::ProcessCpuValue&>>
-            processValueMatchers;
-    processValueMatchers.reserve(expected.topNProcesses.size());
-    for (const auto& processValue : expected.topNProcesses) {
-        processValueMatchers.push_back(ProcessCpuValueEq(processValue));
+MATCHER_P(UidCpuStatsEq, expected, "") {
+    std::vector<Matcher<const UserPackageStats::UidCpuStats::ProcessCpuStats&>>
+            processSingleStatsMatchers;
+    processSingleStatsMatchers.reserve(expected.topNProcesses.size());
+    for (const auto& processSingleStats : expected.topNProcesses) {
+        processSingleStatsMatchers.push_back(ProcessCpuStatsEq(processSingleStats));
     }
     return ExplainMatchResult(AllOf(Field("cpuTimeMillis",
-                                          &UserPackageStats::ProcCpuStatsView::cpuTimeMillis,
+                                          &UserPackageStats::UidCpuStats::cpuTimeMillis,
                                           Eq(expected.cpuTimeMillis)),
                                     Field("cpuCycles",
-                                          &UserPackageStats::ProcCpuStatsView::cpuCycles,
+                                          &UserPackageStats::UidCpuStats::cpuCycles,
                                           Eq(expected.cpuCycles)),
                                     Field("topNProcesses",
-                                          &UserPackageStats::ProcCpuStatsView::topNProcesses,
-                                          ElementsAreArray(processValueMatchers))),
+                                          &UserPackageStats::UidCpuStats::topNProcesses,
+                                          ElementsAreArray(processSingleStatsMatchers))),
                               arg, result_listener);
 }
 
@@ -194,10 +198,10 @@ MATCHER_P(ProcessMemoryStatsEq, expected, "") {
 
 MATCHER_P(UidMemoryStatsEq, expected, "") {
     std::vector<Matcher<const UserPackageStats::UidMemoryStats::ProcessMemoryStats&>>
-            processValueMatchers;
-    processValueMatchers.reserve(expected.topNProcesses.size());
-    for (const auto& processValue : expected.topNProcesses) {
-        processValueMatchers.push_back(ProcessMemoryStatsEq(processValue));
+            processSingleStatsMatchers;
+    processSingleStatsMatchers.reserve(expected.topNProcesses.size());
+    for (const auto& processSingleStats : expected.topNProcesses) {
+        processSingleStatsMatchers.push_back(ProcessMemoryStatsEq(processSingleStats));
     }
     return ExplainMatchResult(AllOf(Field("memoryStats",
                                           &UserPackageStats::UidMemoryStats::memoryStats,
@@ -207,7 +211,7 @@ MATCHER_P(UidMemoryStatsEq, expected, "") {
                                           Eq(expected.isSmapsRollupSupported)),
                                     Field("topNProcesses",
                                           &UserPackageStats::UidMemoryStats::topNProcesses,
-                                          ElementsAreArray(processValueMatchers))),
+                                          ElementsAreArray(processSingleStatsMatchers))),
                               arg, result_listener);
 }
 
@@ -217,46 +221,51 @@ MATCHER_P(UserPackageStatsEq, expected, "") {
             Field("genericPackageName", &UserPackageStats::genericPackageName,
                   Eq(expected.genericPackageName));
     return std::visit(
-            [&](const auto& statsView) -> bool {
-                using T = std::decay_t<decltype(statsView)>;
-                if constexpr (std::is_same_v<T, UserPackageStats::IoStatsView>) {
-                    return ExplainMatchResult(AllOf(uidMatcher, packageNameMatcher,
-                                                    Field("statsView:IoStatsView",
-                                                          &UserPackageStats::statsView,
-                                                          VariantWith<
-                                                                  UserPackageStats::IoStatsView>(
-                                                                  IoStatsViewEq(statsView)))),
-                                              arg, result_listener);
-                } else if constexpr (std::is_same_v<T, UserPackageStats::ProcSingleStatsView>) {
-                    return ExplainMatchResult(AllOf(uidMatcher, packageNameMatcher,
-                                                    Field("statsView:ProcSingleStatsView",
-                                                          &UserPackageStats::statsView,
-                                                          VariantWith<UserPackageStats::
-                                                                              ProcSingleStatsView>(
-                                                                  ProcSingleStatsViewEq(
-                                                                          statsView)))),
-                                              arg, result_listener);
-                } else if constexpr (std::is_same_v<T, UserPackageStats::ProcCpuStatsView>) {
-                    return ExplainMatchResult(AllOf(uidMatcher, packageNameMatcher,
-                                                    Field("statsView:ProcCpuStatsView",
-                                                          &UserPackageStats::statsView,
-                                                          VariantWith<UserPackageStats::
-                                                                              ProcCpuStatsView>(
-                                                                  ProcCpuStatsViewEq(statsView)))),
-                                              arg, result_listener);
+            [&](const auto& statsVariant) -> bool {
+                using T = std::decay_t<decltype(statsVariant)>;
+                if constexpr (std::is_same_v<T, UserPackageStats::UidIoSingleOpStats>) {
+                    return ExplainMatchResult(
+                      AllOf(uidMatcher, packageNameMatcher,
+                            Field("statsVariant:UidIoSingleOpStats",
+                                  &UserPackageStats::statsVariant,
+                                  VariantWith<
+                                          UserPackageStats::UidIoSingleOpStats>(
+                                          UidIoSingleOpStatsEq(statsVariant)))),
+                      arg, result_listener);
+                } else if constexpr (std::is_same_v<T, UserPackageStats::UidSingleStats>) {
+                    return ExplainMatchResult(AllOf(
+                                  uidMatcher,
+                                  packageNameMatcher,
+                                  Field("statsVariant:UidSingleStats",
+                                        &UserPackageStats::statsVariant,
+                                        VariantWith<UserPackageStats::
+                                                            UidSingleStats>(
+                                                UidSingleStatsEq(
+                                                        statsVariant)))),
+                            arg, result_listener);
+                } else if constexpr (std::is_same_v<T, UserPackageStats::UidCpuStats>) {
+                    return ExplainMatchResult(AllOf(
+                                  uidMatcher,
+                                  packageNameMatcher,
+                                  Field("statsVariant:UidCpuStats",
+                                        &UserPackageStats::statsVariant,
+                                        VariantWith<UserPackageStats::
+                                                            UidCpuStats>(
+                                                UidCpuStatsEq(statsVariant)))),
+                            arg, result_listener);
                 } else if constexpr (std::is_same_v<T, UserPackageStats::UidMemoryStats>) {
                     return ExplainMatchResult(AllOf(uidMatcher, packageNameMatcher,
-                                                    Field("statsView:UidMemoryStats",
-                                                          &UserPackageStats::statsView,
+                                                    Field("statsVariant:UidMemoryStats",
+                                                          &UserPackageStats::statsVariant,
                                                           VariantWith<
                                                                   UserPackageStats::UidMemoryStats>(
-                                                                  UidMemoryStatsEq(statsView)))),
+                                                                  UidMemoryStatsEq(statsVariant)))),
                                               arg, result_listener);
                 }
                 *result_listener << "Unexpected variant in UserPackageStats::stats";
                 return false;
             },
-            expected.statsView);
+            expected.statsVariant);
 }
 
 MATCHER_P(UserPackageSummaryStatsEq, expected, "") {
@@ -566,62 +575,67 @@ std::tuple<std::vector<UidStats>, UserPackageSummaryStats> sampleUidStats(
                                                   /*ussKb=*/656, /*swapPssKb=*/200}}}}}};
     UserPackageSummaryStats userPackageSummaryStats{
             .topNCpuTimes = {{1012345, "1012345",
-                              UserPackageStats::ProcCpuStatsView{int64Multiplier(100),
+                              UserPackageStats::UidCpuStats{int64Multiplier(100),
                                                                  50'000,
                                                                  {{2345, "MapsApp",
                                                                    int64Multiplier(100), 50'000}}}},
                              {1002001, "com.google.android.car.kitchensink",
-                              UserPackageStats::ProcCpuStatsView{int64Multiplier(60),
+                              UserPackageStats::UidCpuStats{int64Multiplier(60),
                                                                  10'000,
                                                                  {{1001, "CTS", int64Multiplier(30),
                                                                    5000},
                                                                   {1000, "KitchenSinkApp",
                                                                    int64Multiplier(25), 4000}}}},
                              {1009, "mount",
-                              UserPackageStats::ProcCpuStatsView{int64Multiplier(50),
+                              UserPackageStats::UidCpuStats{int64Multiplier(50),
                                                                  4000,
                                                                  {{100, "disk I/O",
                                                                    int64Multiplier(50), 4000}}}}},
             .topNIoReads = {{1009, "mount",
-                             UserPackageStats::IoStatsView{{0, int64Multiplier(14'000)},
+                             UserPackageStats::UidIoSingleOpStats{{0, int64Multiplier(14'000)},
                                                            {0, int64Multiplier(100)}}},
                             {1012345, "1012345",
-                             UserPackageStats::IoStatsView{{int64Multiplier(1'000),
+                             UserPackageStats::UidIoSingleOpStats{{int64Multiplier(1'000),
                                                             int64Multiplier(4'200)},
                                                            {int64Multiplier(600),
                                                             int64Multiplier(300)}}},
                             {1002001, "com.google.android.car.kitchensink",
-                             UserPackageStats::IoStatsView{{0, int64Multiplier(3'400)},
+                             UserPackageStats::UidIoSingleOpStats{{0, int64Multiplier(3'400)},
                                                            {0, int64Multiplier(200)}}}},
             .topNIoWrites =
                     {{1009, "mount",
-                      UserPackageStats::IoStatsView{{0, int64Multiplier(16'000)},
+                      UserPackageStats::UidIoSingleOpStats{{0, int64Multiplier(16'000)},
                                                     {0, int64Multiplier(100)}}},
                      {1002001, "com.google.android.car.kitchensink",
-                      UserPackageStats::IoStatsView{{0, int64Multiplier(6'700)},
+                      UserPackageStats::UidIoSingleOpStats{{0, int64Multiplier(6'700)},
                                                     {0, int64Multiplier(200)}}},
                      {1012345, "1012345",
-                      UserPackageStats::IoStatsView{{int64Multiplier(300), int64Multiplier(5'600)},
-                                                    {int64Multiplier(600), int64Multiplier(300)}}}},
+                      UserPackageStats::UidIoSingleOpStats{{int64Multiplier(300),
+                                                        int64Multiplier(5'600)},
+                                                    {int64Multiplier(600),
+                                                     int64Multiplier(300)}}}},
             .topNIoBlocked =
                     {{1002001, "com.google.android.car.kitchensink",
-                      UserPackageStats::ProcSingleStatsView{3,
+                      UserPackageStats::UidSingleStats{3,
                                                             {{"CTS", 2}, {"KitchenSinkApp", 1}}}},
                      {1012345, "1012345",
-                      UserPackageStats::ProcSingleStatsView{2, {{"MapsApp", 2}}}},
-                     {1009, "mount", UserPackageStats::ProcSingleStatsView{1, {{"disk I/O", 1}}}}},
+                      UserPackageStats::UidSingleStats{2, {{"MapsApp", 2}}}},
+                     {1009,
+                      "mount",
+                      UserPackageStats::UidSingleStats{1, {{"disk I/O",
+                                                                1}}}}},
             .topNMajorFaults =
                     {{1012345, "1012345",
-                      UserPackageStats::ProcSingleStatsView{uint64Multiplier(50'900),
+                      UserPackageStats::UidSingleStats{uint64Multiplier(50'900),
                                                             {{"MapsApp",
                                                               uint64Multiplier(50'900)}}}},
                      {1002001, "com.google.android.car.kitchensink",
-                      UserPackageStats::ProcSingleStatsView{uint64Multiplier(22'445),
+                      UserPackageStats::UidSingleStats{uint64Multiplier(22'445),
                                                             {{"KitchenSinkApp",
                                                               uint64Multiplier(12'345)},
                                                              {"CTS", uint64Multiplier(10'100)}}}},
                      {1009, "mount",
-                      UserPackageStats::ProcSingleStatsView{uint64Multiplier(11'000),
+                      UserPackageStats::UidSingleStats{uint64Multiplier(11'000),
                                                             {{"disk I/O",
                                                               uint64Multiplier(11'000)}}}}},
             .topNMemStats =
@@ -651,7 +665,8 @@ std::tuple<ProcStatInfo, SystemSummaryStats> sampleProcStat(auto int64Multiplier
                                          int64Multiplier(2'930)},
                               /*ctxtSwitches=*/uint64Multiplier(500),
                               /*runnableCnt=*/uint32Multiplier(100),
-                              /*ioBlockedCnt=*/uint32Multiplier(57)};
+                              /*ioBlockedCnt=*/uint32Multiplier(57),
+                              /*kernelStartTimeEpochSeconds=*/0};
     SystemSummaryStats systemSummaryStats{/*cpuIoWaitTimeMillis=*/int64Multiplier(5'900),
                                           /*cpuIdleTimeMillis=*/int64Multiplier(8'900),
                                           /*totalCpuTimeMillis=*/int64Multiplier(48'376),
@@ -880,17 +895,17 @@ MATCHER_P(ProcessCpuStatsProtoEq, expected, "") {
 }
 
 MATCHER_P(PackageCpuStatsProtoEq, expected, "") {
-    const auto& procCpuStatsView =
-            std::get_if<UserPackageStats::ProcCpuStatsView>(&expected.statsView);
+    const auto& uidCpustatsVariant =
+            std::get_if<UserPackageStats::UidCpuStats>(&expected.statsVariant);
     std::vector<Matcher<const PackageCpuStats_ProcessCpuStats&>> processCpuStatsMatchers;
-    for (const auto& expectedProcessCpuValue : procCpuStatsView->topNProcesses) {
-        processCpuStatsMatchers.push_back(ProcessCpuStatsProtoEq(expectedProcessCpuValue));
+    for (const auto& expectedProcessCpuStats : uidCpustatsVariant->topNProcesses) {
+        processCpuStatsMatchers.push_back(ProcessCpuStatsProtoEq(expectedProcessCpuStats));
     }
     return ExplainMatchResult(AllOf(Property("user_package_info",
                                              &PackageCpuStats::user_package_info,
                                              UserPackageInfoProtoEq(expected)),
                                     Property("cpu_stats", &PackageCpuStats::cpu_stats,
-                                             CpuStatsProtoEq(*procCpuStatsView)),
+                                             CpuStatsProtoEq(*uidCpustatsVariant)),
                                     Property("process_cpu_stats",
                                              &PackageCpuStats::process_cpu_stats,
                                              ElementsAreArray(processCpuStatsMatchers))),
@@ -906,18 +921,20 @@ MATCHER_P4(StorageIoStatsProtoEq, fgBytes, fgFsync, bgBytes, byFsync, "") {
 }
 
 MATCHER_P(PackageStorageIoStatsProtoEq, expected, "") {
-    const auto& ioStatsView = std::get_if<UserPackageStats::IoStatsView>(&expected.statsView);
-    return ExplainMatchResult(AllOf(Property("user_package_info",
-                                             &PackageStorageIoStats::user_package_info,
-                                             UserPackageInfoProtoEq(expected)),
-                                    Property("storage_io_stats",
-                                             &PackageStorageIoStats::storage_io_stats,
-                                             StorageIoStatsProtoEq(ioStatsView->bytes[FOREGROUND],
-                                                                   ioStatsView->fsync[FOREGROUND],
-                                                                   ioStatsView->bytes[BACKGROUND],
-                                                                   ioStatsView
-                                                                           ->fsync[BACKGROUND]))),
-                              arg, result_listener);
+    const auto& uidIoSingleOpStats =
+        std::get_if<UserPackageStats::UidIoSingleOpStats>(&expected.statsVariant);
+    return ExplainMatchResult(AllOf(
+              Property("user_package_info",
+                       &PackageStorageIoStats::user_package_info,
+                       UserPackageInfoProtoEq(expected)),
+              Property("storage_io_stats",
+                       &PackageStorageIoStats::storage_io_stats,
+                       StorageIoStatsProtoEq(uidIoSingleOpStats->bytes[FOREGROUND],
+                                             uidIoSingleOpStats->fsync[FOREGROUND],
+                                             uidIoSingleOpStats->bytes[BACKGROUND],
+                                             uidIoSingleOpStats
+                                                     ->fsync[BACKGROUND]))),
+        arg, result_listener);
 }
 
 MATCHER_P(ProcessTaskStateStatsProtoEq, expected, "") {
@@ -932,19 +949,20 @@ MATCHER_P(ProcessTaskStateStatsProtoEq, expected, "") {
 }
 
 MATCHER_P2(PackageTaskStateStatsProtoEq, expected, taskCountByUid, "") {
-    const auto& procSingleStatsView =
-            std::get_if<UserPackageStats::ProcSingleStatsView>(&expected.statsView);
+    const auto& uidSingleStats =
+            std::get_if<UserPackageStats::UidSingleStats>(&expected.statsVariant);
     std::vector<Matcher<const PackageTaskStateStats_ProcessTaskStateStats&>>
             processTaskStateStatsMatchers;
-    for (const auto& expectedProcessValue : procSingleStatsView->topNProcesses) {
-        processTaskStateStatsMatchers.push_back(ProcessTaskStateStatsProtoEq(expectedProcessValue));
+    for (const auto& expectedProcessSingleStats : uidSingleStats->topNProcesses) {
+        processTaskStateStatsMatchers.push_back(
+            ProcessTaskStateStatsProtoEq(expectedProcessSingleStats));
     }
     return ExplainMatchResult(AllOf(Property("user_package_info",
                                              &PackageTaskStateStats::user_package_info,
                                              UserPackageInfoProtoEq(expected)),
                                     Property("io_blocked_task_count",
                                              &PackageTaskStateStats::io_blocked_task_count,
-                                             procSingleStatsView->value),
+                                             uidSingleStats->value),
                                     Property("total_task_count",
                                              &PackageTaskStateStats::total_task_count,
                                              taskCountByUid.at(expected.uid)),
@@ -955,14 +973,14 @@ MATCHER_P2(PackageTaskStateStatsProtoEq, expected, taskCountByUid, "") {
 }
 
 MATCHER_P(PackageMajorPageFaultsProtoEq, expected, "") {
-    const auto& procSingleStatsView =
-            std::get_if<UserPackageStats::ProcSingleStatsView>(&expected.statsView);
+    const auto& uidSingleStats =
+            std::get_if<UserPackageStats::UidSingleStats>(&expected.statsVariant);
     return ExplainMatchResult(AllOf(Property("user_package_info",
                                              &PackageMajorPageFaults::user_package_info,
                                              UserPackageInfoProtoEq(expected)),
                                     Property("major_page_faults_count",
                                              &PackageMajorPageFaults::major_page_faults_count,
-                                             procSingleStatsView->value)),
+                                             uidSingleStats->value)),
                               arg, result_listener);
 }
 
@@ -1032,8 +1050,8 @@ MATCHER_P3(StatsRecordProtoEq, userPackageSummaryStats, systemSummaryStats, nowM
     localtime_r(&dateTime, &timeinfo);
 
     std::vector<Matcher<const PackageCpuStats&>> packageCpuStatsMatchers;
-    for (const auto& expectedProcCpuStatsView : userPackageSummaryStats.topNCpuTimes) {
-        packageCpuStatsMatchers.push_back(PackageCpuStatsProtoEq(expectedProcCpuStatsView));
+    for (const auto& expectedUidCpuStats : userPackageSummaryStats.topNCpuTimes) {
+        packageCpuStatsMatchers.push_back(PackageCpuStatsProtoEq(expectedUidCpuStats));
     }
     std::vector<Matcher<const PackageStorageIoStats&>> packageStorageReadIoStatsMatchers;
     for (const auto& expectedPackageStorageReadIoStat : userPackageSummaryStats.topNIoReads) {
@@ -1115,21 +1133,28 @@ public:
         mCollector.clear();
     }
 
-    Result<void> init() { return mCollector->init(); }
-
-    void setTopNStatsPerCategory(int value) { mCollector->mTopNStatsPerCategory = value; }
-
-    void setTopNStatsPerSubcategory(int value) { mCollector->mTopNStatsPerSubcategory = value; }
+    Result<void> init(int topNStatsPerCategory, int topNStatsPerSubcategory,
+                      int maxUserSwitchEvents, std::chrono::seconds systemEventDataCacheDuration,
+                      size_t bufferSize, bool doSendResourceUsageStatsEnabled,
+                      bool isSmapsRollupSupported) {
+        if (auto result = mCollector->init(); !result.ok()) {
+            return result;
+        }
 
-    void setMaxUserSwitchEvents(int value) { mCollector->mMaxUserSwitchEvents = value; }
+        mCollector->mTopNStatsPerCategory = topNStatsPerCategory;
+        mCollector->mTopNStatsPerSubcategory = topNStatsPerSubcategory;
+        mCollector->mMaxUserSwitchEvents = maxUserSwitchEvents;
+        mCollector->mSystemEventDataCacheDurationSec = systemEventDataCacheDuration;
+        mCollector->mPeriodicCollection.maxCacheSize = bufferSize;
+        mCollector->mDoSendResourceUsageStats = doSendResourceUsageStatsEnabled;
+        mCollector->mIsSmapsRollupSupported = isSmapsRollupSupported;
 
-    void setSystemEventDataCacheDuration(std::chrono::seconds value) {
-        mCollector->mSystemEventDataCacheDurationSec = value;
+        return {};
     }
 
-    void setPeriodicCollectionBufferSize(size_t bufferSize) {
-        mCollector->mPeriodicCollection.maxCacheSize = bufferSize;
-    }
+    void setTopNStatsPerCategory(int value) { mCollector->mTopNStatsPerCategory = value; }
+
+    void setTopNStatsPerSubcategory(int value) { mCollector->mTopNStatsPerSubcategory = value; }
 
     void setSendResourceUsageStatsEnabled(bool enable) {
         mCollector->mDoSendResourceUsageStats = enable;
@@ -1189,15 +1214,12 @@ protected:
         EXPECT_CALL(*mMockPressureMonitor, registerPressureChangeCallback(Eq(mCollector)))
                 .Times(car_watchdog_memory_profiling() ? 1 : 0);
 
-        ASSERT_RESULT_OK(mCollectorPeer->init());
-
-        mCollectorPeer->setTopNStatsPerCategory(kTestTopNStatsPerCategory);
-        mCollectorPeer->setTopNStatsPerSubcategory(kTestTopNStatsPerSubcategory);
-        mCollectorPeer->setMaxUserSwitchEvents(kTestMaxUserSwitchEvents);
-        mCollectorPeer->setSystemEventDataCacheDuration(kTestSystemEventDataCacheDurationSec);
-        mCollectorPeer->setSendResourceUsageStatsEnabled(true);
-        mCollectorPeer->setSmapsRollupSupportedEnabled(true);
-        mCollectorPeer->setPeriodicCollectionBufferSize(kTestPeriodicCollectionBufferSize);
+        ASSERT_RESULT_OK(
+                mCollectorPeer->init(kTestTopNStatsPerCategory, kTestTopNStatsPerSubcategory,
+                                     kTestMaxUserSwitchEvents, kTestSystemEventDataCacheDurationSec,
+                                     kTestPeriodicCollectionBufferSize,
+                                     /*doSendResourceUsageStatsEnabled=*/true,
+                                     /*isSmapsRollupSupported=*/true));
     }
 
     void TearDown() override {
@@ -1487,12 +1509,16 @@ TEST_F(PerformanceProfilerTest, TestOnUserSwitchCollection) {
                                                    /*cpuCyclesByTid=*/{{100, 3'500}}}}}}}};
 
     UserPackageSummaryStats nextUserPackageSummaryStats = {
-            .topNIoReads = {{1009, "mount", UserPackageStats::IoStatsView{{0, 5'000}, {0, 50}}}},
-            .topNIoWrites = {{1009, "mount", UserPackageStats::IoStatsView{{0, 3'000}, {0, 50}}}},
+            .topNIoReads = {{1009, "mount",
+                             UserPackageStats::UidIoSingleOpStats{{0, 5'000},
+                                                              {0, 50}}}},
+            .topNIoWrites = {{1009, "mount",
+                              UserPackageStats::UidIoSingleOpStats{{0, 3'000},
+                                                               {0, 50}}}},
             .topNIoBlocked = {{1009, "mount",
-                               UserPackageStats::ProcSingleStatsView{2, {{"disk I/O", 2}}}}},
+                               UserPackageStats::UidSingleStats{2, {{"disk I/O", 2}}}}},
             .topNMajorFaults = {{1009, "mount",
-                                 UserPackageStats::ProcSingleStatsView{6'000,
+                                 UserPackageStats::UidSingleStats{6'000,
                                                                        {{"disk I/O", 6'000}}}}},
             .totalIoStats = {{0, 5'000}, {0, 3'000}, {0, 50}},
             .taskCountByUid = {{1009, 1}},
@@ -1680,31 +1706,35 @@ TEST_F(PerformanceProfilerTest, TestOnCustomCollectionWithPackageFilter) {
 
     UserPackageSummaryStats userPackageSummaryStats{
             .topNCpuTimes = {{1009, "mount",
-                              UserPackageStats::ProcCpuStatsView{50,
+                              UserPackageStats::UidCpuStats{50,
                                                                  4'000,
                                                                  {{100, "disk I/O", 50, 4'000}}}},
                              {1002001, "com.google.android.car.kitchensink",
-                              UserPackageStats::ProcCpuStatsView{60,
+                              UserPackageStats::UidCpuStats{60,
                                                                  10'000,
                                                                  {{1001, "CTS", 30, 5'000},
                                                                   {1000, "KitchenSinkApp", 25,
                                                                    4'000}}}}},
-            .topNIoReads = {{1009, "mount", UserPackageStats::IoStatsView{{0, 14'000}, {0, 100}}},
+            .topNIoReads = {{1009, "mount",
+                             UserPackageStats::UidIoSingleOpStats{{0, 14'000},
+                                                              {0, 100}}},
                             {1002001, "com.google.android.car.kitchensink",
-                             UserPackageStats::IoStatsView{{0, 3'400}, {0, 200}}}},
-            .topNIoWrites = {{1009, "mount", UserPackageStats::IoStatsView{{0, 16'000}, {0, 100}}},
+                             UserPackageStats::UidIoSingleOpStats{{0, 3'400}, {0, 200}}}},
+            .topNIoWrites = {{1009, "mount",
+                              UserPackageStats::UidIoSingleOpStats{{0, 16'000},
+                                                               {0, 100}}},
                              {1002001, "com.google.android.car.kitchensink",
-                              UserPackageStats::IoStatsView{{0, 6'700}, {0, 200}}}},
+                              UserPackageStats::UidIoSingleOpStats{{0, 6'700}, {0, 200}}}},
             .topNIoBlocked =
-                    {{1009, "mount", UserPackageStats::ProcSingleStatsView{1, {{"disk I/O", 1}}}},
+                    {{1009, "mount", UserPackageStats::UidSingleStats{1, {{"disk I/O", 1}}}},
                      {1002001, "com.google.android.car.kitchensink",
-                      UserPackageStats::ProcSingleStatsView{3,
+                      UserPackageStats::UidSingleStats{3,
                                                             {{"CTS", 2}, {"KitchenSinkApp", 1}}}}},
             .topNMajorFaults = {{1009, "mount",
-                                 UserPackageStats::ProcSingleStatsView{11'000,
+                                 UserPackageStats::UidSingleStats{11'000,
                                                                        {{"disk I/O", 11'000}}}},
                                 {1002001, "com.google.android.car.kitchensink",
-                                 UserPackageStats::ProcSingleStatsView{22'445,
+                                 UserPackageStats::UidSingleStats{22'445,
                                                                        {{"KitchenSinkApp", 12'345},
                                                                         {"CTS", 10'100}}}}},
             .topNMemStats =
@@ -1785,16 +1815,20 @@ TEST_F(PerformanceProfilerTest, TestOnPeriodicCollectionWithTrimmingStatsAfterTo
 
     UserPackageSummaryStats userPackageSummaryStats{
             .topNCpuTimes = {{1012345, "1012345",
-                              UserPackageStats::ProcCpuStatsView{100,
+                              UserPackageStats::UidCpuStats{100,
                                                                  50'000,
                                                                  {{2345, "MapsApp", 100,
                                                                    50'000}}}}},
-            .topNIoReads = {{1009, "mount", UserPackageStats::IoStatsView{{0, 14'000}, {0, 100}}}},
-            .topNIoWrites = {{1009, "mount", UserPackageStats::IoStatsView{{0, 16'000}, {0, 100}}}},
+            .topNIoReads = {{1009, "mount",
+                             UserPackageStats::UidIoSingleOpStats{{0, 14'000},
+                                                              {0, 100}}}},
+            .topNIoWrites = {{1009, "mount",
+                              UserPackageStats::UidIoSingleOpStats{{0, 16'000},
+                                                               {0, 100}}}},
             .topNIoBlocked = {{1002001, "com.google.android.car.kitchensink",
-                               UserPackageStats::ProcSingleStatsView{3, {{"CTS", 2}}}}},
+                               UserPackageStats::UidSingleStats{3, {{"CTS", 2}}}}},
             .topNMajorFaults = {{1012345, "1012345",
-                                 UserPackageStats::ProcSingleStatsView{50'900,
+                                 UserPackageStats::UidSingleStats{50'900,
                                                                        {{"MapsApp", 50'900}}}}},
             .topNMemStats = {{1002001, "com.google.android.car.kitchensink",
                               UserPackageStats::UidMemoryStats{{/*rssKb=*/2000, /*pssKb=*/1645,
diff --git a/cpp/watchdog/server/tests/ProcPidDir.h b/cpp/watchdog/server/tests/ProcPidDir.h
index 5d0d5b6c7e..6a9cd68879 100644
--- a/cpp/watchdog/server/tests/ProcPidDir.h
+++ b/cpp/watchdog/server/tests/ProcPidDir.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_PROCPIDDIR_H_
-#define CPP_WATCHDOG_SERVER_TESTS_PROCPIDDIR_H_
+#pragma once
 
 #include <android-base/result.h>
 #include <stdint.h>
@@ -43,5 +42,3 @@ android::base::Result<void> populateProcPidDir(
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  //  CPP_WATCHDOG_SERVER_TESTS_PROCPIDDIR_H_
diff --git a/cpp/watchdog/server/tests/ProcStatCollectorTest.cpp b/cpp/watchdog/server/tests/ProcStatCollectorTest.cpp
index f1d390c03b..cc31d196a7 100644
--- a/cpp/watchdog/server/tests/ProcStatCollectorTest.cpp
+++ b/cpp/watchdog/server/tests/ProcStatCollectorTest.cpp
@@ -41,18 +41,25 @@ int64_t clockTicksToMillis(int64_t ticks) {
 
 std::string toString(const ProcStatInfo& info) {
     const auto& cpuStats = info.cpuStats;
-    return StringPrintf("Cpu Stats:\nUserTimeMillis: %" PRIu64 " NiceTimeMillis: %" PRIu64
+    std::stringstream kernelStartTimeEpochSeconds;
+    kernelStartTimeEpochSeconds << info.kernelStartTimeEpochSeconds;
+    return StringPrintf("KernelStartTimeEpochSeconds: %s \nCpu Stats:\nUserTimeMillis: %" PRIu64
+                        " NiceTimeMillis: %" PRIu64
                         " SysTimeMillis: %" PRIu64 " IdleTimeMillis: %" PRIu64
                         " IoWaitTimeMillis: %" PRIu64 " IrqTimeMillis: %" PRIu64
                         " SoftIrqTimeMillis: %" PRIu64 " StealTimeMillis: %" PRIu64
                         " GuestTimeMillis: %" PRIu64 " GuestNiceTimeMillis: %" PRIu64
                         "\nNumber of running processes: %" PRIu32
-                        "\nNumber of blocked processes: %" PRIu32,
-                        cpuStats.userTimeMillis, cpuStats.niceTimeMillis, cpuStats.sysTimeMillis,
-                        cpuStats.idleTimeMillis, cpuStats.ioWaitTimeMillis, cpuStats.irqTimeMillis,
+                        "\nNumber of blocked processes: %" PRIu32
+                        "\nNumber of context switches: %" PRIu64,
+                        kernelStartTimeEpochSeconds.str().c_str(),
+                        cpuStats.userTimeMillis, cpuStats.niceTimeMillis,
+                        cpuStats.sysTimeMillis, cpuStats.idleTimeMillis,
+                        cpuStats.ioWaitTimeMillis, cpuStats.irqTimeMillis,
                         cpuStats.softIrqTimeMillis, cpuStats.stealTimeMillis,
                         cpuStats.guestTimeMillis, cpuStats.guestNiceTimeMillis,
-                        info.runnableProcessCount, info.ioBlockedProcessCount);
+                        info.runnableProcessCount, info.ioBlockedProcessCount,
+                        info.contextSwitchesCount);
 }
 
 }  // namespace
@@ -76,6 +83,7 @@ TEST(ProcStatCollectorTest, TestValidStatFile) {
             "procs_blocked 5\n"
             "softirq 33275060 934664 11958403 5111 516325 200333 0 341482 10651335 0 8667407\n";
     ProcStatInfo expectedFirstDelta;
+    expectedFirstDelta.kernelStartTimeEpochSeconds = 1579718450;
     expectedFirstDelta.cpuStats = {
             .userTimeMillis = clockTicksToMillis(6200),
             .niceTimeMillis = clockTicksToMillis(5700),
@@ -134,7 +142,8 @@ TEST(ProcStatCollectorTest, TestValidStatFile) {
             .guestTimeMillis = clockTicksToMillis(0),
             .guestNiceTimeMillis = clockTicksToMillis(0),
     };
-    expectedFirstDelta.contextSwitchesCount = 810020192;
+    expectedSecondDelta.kernelStartTimeEpochSeconds = 1579718450;
+    expectedSecondDelta.contextSwitchesCount = 231000024;
     expectedSecondDelta.runnableProcessCount = 10;
     expectedSecondDelta.ioBlockedProcessCount = 2;
 
@@ -309,13 +318,69 @@ TEST(ProcStatCollectorTest, TestProcStatContentsFromDevice) {
     ASSERT_RESULT_OK(collector.collect());
 
     const auto& info = collector.deltaStats();
-    /* The below checks should pass because the /proc/stats file should have the CPU time spent
-     * since bootup and there should be at least one running process.
+    /* The below checks should pass because the /proc/stats file should have
+     * 1. The Kernel start time.
+     * 2. The CPU time spent since bootup.
+     * 3. There should be at least one running process.
      */
+    EXPECT_GT(info.kernelStartTimeEpochSeconds, static_cast<time_t>(0));
     EXPECT_GT(info.totalCpuTimeMillis(), 0);
     EXPECT_GT(info.totalProcessCount(), static_cast<uint32_t>(0));
 }
 
+TEST(ProcStatCollectorTest, TestReadKernelStartTimeOnce) {
+    constexpr char contents[] =
+        "cpu  16200 8700 2000 4100 1250 6200 5900 0 0 0\n"
+        "cpu0 2400 2900 600 690 340 4300 2100 0 0 0\n"
+        "cpu1 1900 2380 510 760 51 370 1500 0 0 0\n"
+        "cpu2 900 400 400 1000 600 400 160 0 0 0\n"
+        "cpu3 1000 20 190 650 109 130 140 0 0 0\n"
+        "intr 694351583 0 0 0 297062868 0 5922464 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "
+        "0 0\n"
+        "ctxt 579020168\n"
+        "btime 1579718450\n"
+        "processes 113804\n"
+        "procs_running 17\n"
+        "procs_blocked 5\n"
+        "softirq 33275060 934664 11958403 5111 516325 200333 0 341482 10651335 0 8667407\n";
+    TemporaryFile tf;
+    ASSERT_NE(tf.fd, -1);
+    ASSERT_TRUE(WriteStringToFile(contents, tf.path));
+
+    ProcStatCollector collector(tf.path);
+    collector.init();
+
+    ASSERT_TRUE(collector.enabled()) << "Temporary file is inaccessible";
+    ASSERT_RESULT_OK(collector.collect());
+
+    const auto& firstLatestStats = collector.latestStats();
+
+    constexpr char contents_with_new_btime[] =
+        "cpu  16200 8700 2000 4100 1250 6200 5900 0 0 0\n"
+        "cpu0 2400 2900 600 690 340 4300 2100 0 0 0\n"
+        "cpu1 1900 2380 510 760 51 370 1500 0 0 0\n"
+        "cpu2 900 400 400 1000 600 400 160 0 0 0\n"
+        "cpu3 1000 20 190 650 109 130 140 0 0 0\n"
+        "intr 694351583 0 0 0 297062868 0 5922464 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "
+        "0 0\n"
+        "ctxt 579020168\n"
+        "btime 6482659380\n"
+        "processes 113804\n"
+        "procs_running 17\n"
+        "procs_blocked 5\n"
+        "softirq 33275060 934664 11958403 5111 516325 200333 0 341482 10651335 0 8667407\n";
+    ASSERT_TRUE(WriteStringToFile(contents_with_new_btime, tf.path));
+
+    ASSERT_TRUE(collector.enabled()) << "Temporary file is inaccessible";
+    ASSERT_RESULT_OK(collector.collect());
+
+    const auto& secondLatestStats = collector.latestStats();
+
+    ASSERT_TRUE(firstLatestStats.kernelStartTimeEpochSeconds ==
+                secondLatestStats.kernelStartTimeEpochSeconds)
+                << "kernel start time is read more than once";
+}
+
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
diff --git a/cpp/watchdog/server/tests/UidProcStatsCollectorTestUtils.h b/cpp/watchdog/server/tests/UidProcStatsCollectorTestUtils.h
index ae65a811c8..6b437554e6 100644
--- a/cpp/watchdog/server/tests/UidProcStatsCollectorTestUtils.h
+++ b/cpp/watchdog/server/tests/UidProcStatsCollectorTestUtils.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef CPP_WATCHDOG_SERVER_TESTS_UIDPROCSTATSCOLLECTORTESTUTILS_H_
-#define CPP_WATCHDOG_SERVER_TESTS_UIDPROCSTATSCOLLECTORTESTUTILS_H_
+#pragma once
 
 #include "UidProcStatsCollector.h"
 
@@ -75,5 +74,3 @@ MATCHER_P(UidProcStatsEq, expected, "") {
 }  // namespace watchdog
 }  // namespace automotive
 }  // namespace android
-
-#endif  // CPP_WATCHDOG_SERVER_TESTS_UIDPROCSTATSCOLLECTORTESTUTILS_H_
diff --git a/cpp/watchdog/server/tests/WatchdogProcessServiceTest.cpp b/cpp/watchdog/server/tests/WatchdogProcessServiceTest.cpp
index 4e6570a1b4..928c8c8e27 100644
--- a/cpp/watchdog/server/tests/WatchdogProcessServiceTest.cpp
+++ b/cpp/watchdog/server/tests/WatchdogProcessServiceTest.cpp
@@ -394,7 +394,7 @@ TEST_F(WatchdogProcessServiceTest, TestTerminate) {
     std::vector<int32_t> propIds = {static_cast<int32_t>(VehicleProperty::VHAL_HEARTBEAT)};
     EXPECT_CALL(*mMockVhalClient, removeOnBinderDiedCallback(_)).Times(1);
     EXPECT_CALL(*mMockVehicle, unsubscribe(_, propIds))
-            .WillOnce(Return(ByMove(std::move(ScopedAStatus::ok()))));
+            .WillOnce(Return(ByMove(ScopedAStatus::ok())));
     mWatchdogProcessService->terminate();
     // TODO(b/217405065): Verify looper removes all MSG_VHAL_HEALTH_CHECK messages.
 }
@@ -403,7 +403,7 @@ TEST_F(WatchdogProcessServiceTest, TestTerminate) {
 
 TEST_F(WatchdogProcessServiceTest, TestRegisterClient) {
     std::shared_ptr<ICarWatchdogClient> client = SharedRefBase::make<ICarWatchdogClientDefault>();
-    expectLinkToDeath(client->asBinder().get(), std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(client->asBinder().get(), ScopedAStatus::ok());
 
     auto status = mWatchdogProcessService->registerClient(client, TimeoutLength::TIMEOUT_CRITICAL);
 
@@ -417,13 +417,13 @@ TEST_F(WatchdogProcessServiceTest, TestRegisterClient) {
 TEST_F(WatchdogProcessServiceTest, TestUnregisterClient) {
     std::shared_ptr<ICarWatchdogClient> client = SharedRefBase::make<ICarWatchdogClientDefault>();
     AIBinder* aiBinder = client->asBinder().get();
-    expectLinkToDeath(aiBinder, std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(aiBinder, ScopedAStatus::ok());
 
     auto status = mWatchdogProcessService->registerClient(client, TimeoutLength::TIMEOUT_CRITICAL);
 
     ASSERT_TRUE(status.isOk()) << status.getMessage();
 
-    expectUnlinkToDeath(aiBinder, std::move(ScopedAStatus::ok()));
+    expectUnlinkToDeath(aiBinder, ScopedAStatus::ok());
 
     status = mWatchdogProcessService->unregisterClient(client);
 
@@ -435,7 +435,7 @@ TEST_F(WatchdogProcessServiceTest, TestUnregisterClient) {
 TEST_F(WatchdogProcessServiceTest, TestErrorOnRegisterClientWithDeadBinder) {
     std::shared_ptr<ICarWatchdogClient> client = SharedRefBase::make<ICarWatchdogClientDefault>();
     expectLinkToDeath(client->asBinder().get(),
-                      std::move(ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED)));
+                      ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED));
 
     ASSERT_FALSE(
             mWatchdogProcessService->registerClient(client, TimeoutLength::TIMEOUT_CRITICAL).isOk())
@@ -445,7 +445,7 @@ TEST_F(WatchdogProcessServiceTest, TestErrorOnRegisterClientWithDeadBinder) {
 TEST_F(WatchdogProcessServiceTest, TestHandleClientBinderDeath) {
     std::shared_ptr<ICarWatchdogClient> client = SharedRefBase::make<ICarWatchdogClientDefault>();
     AIBinder* aiBinder = client->asBinder().get();
-    expectLinkToDeath(aiBinder, std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(aiBinder, ScopedAStatus::ok());
 
     auto status = mWatchdogProcessService->registerClient(client, TimeoutLength::TIMEOUT_CRITICAL);
 
@@ -467,7 +467,7 @@ TEST_F(WatchdogProcessServiceTest, TestRegisterCarWatchdogService) {
     const auto binder = mockService->asBinder();
 
     EXPECT_CALL(*mockServiceHelper, requestAidlVhalPid())
-            .WillOnce(Return(ByMove(std::move(ScopedAStatus::ok()))));
+            .WillOnce(Return(ByMove(ScopedAStatus::ok())));
 
     auto status = mWatchdogProcessService->registerCarWatchdogService(binder, mockServiceHelper);
     ASSERT_TRUE(status.isOk()) << status.getMessage();
@@ -497,7 +497,7 @@ TEST_F(WatchdogProcessServiceTest,
 TEST_F(WatchdogProcessServiceTest, TestRegisterMonitor) {
     std::shared_ptr<ICarWatchdogMonitor> monitorOne =
             SharedRefBase::make<ICarWatchdogMonitorDefault>();
-    expectLinkToDeath(monitorOne->asBinder().get(), std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(monitorOne->asBinder().get(), ScopedAStatus::ok());
 
     auto status = mWatchdogProcessService->registerMonitor(monitorOne);
 
@@ -518,7 +518,7 @@ TEST_F(WatchdogProcessServiceTest, TestErrorOnRegisterMonitorWithDeadBinder) {
     std::shared_ptr<ICarWatchdogMonitor> monitor =
             SharedRefBase::make<ICarWatchdogMonitorDefault>();
     expectLinkToDeath(monitor->asBinder().get(),
-                      std::move(ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED)));
+                      ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED));
 
     ASSERT_FALSE(mWatchdogProcessService->registerMonitor(monitor).isOk())
             << "When linkToDeath fails, registerMonitor should return an error";
@@ -528,13 +528,13 @@ TEST_F(WatchdogProcessServiceTest, TestUnregisterMonitor) {
     std::shared_ptr<ICarWatchdogMonitor> monitor =
             SharedRefBase::make<ICarWatchdogMonitorDefault>();
     AIBinder* aiBinder = monitor->asBinder().get();
-    expectLinkToDeath(aiBinder, std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(aiBinder, ScopedAStatus::ok());
 
     auto status = mWatchdogProcessService->registerMonitor(monitor);
 
     ASSERT_TRUE(status.isOk()) << status.getMessage();
 
-    expectUnlinkToDeath(aiBinder, std::move(ScopedAStatus::ok()));
+    expectUnlinkToDeath(aiBinder, ScopedAStatus::ok());
 
     status = mWatchdogProcessService->unregisterMonitor(monitor);
 
@@ -547,7 +547,7 @@ TEST_F(WatchdogProcessServiceTest, TestHandleMonitorBinderDeath) {
     std::shared_ptr<ICarWatchdogMonitor> monitor =
             SharedRefBase::make<ICarWatchdogMonitorDefault>();
     AIBinder* aiBinder = monitor->asBinder().get();
-    expectLinkToDeath(aiBinder, std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(aiBinder, ScopedAStatus::ok());
 
     auto status = mWatchdogProcessService->registerMonitor(monitor);
 
@@ -563,7 +563,7 @@ TEST_F(WatchdogProcessServiceTest, TestHandleMonitorBinderDeath) {
 
 TEST_F(WatchdogProcessServiceTest, TestTellClientAlive) {
     std::shared_ptr<ICarWatchdogClient> client = SharedRefBase::make<ICarWatchdogClientDefault>();
-    expectLinkToDeath(client->asBinder().get(), std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(client->asBinder().get(), ScopedAStatus::ok());
 
     mWatchdogProcessService->registerClient(client, TimeoutLength::TIMEOUT_CRITICAL);
 
@@ -596,7 +596,7 @@ TEST_F(WatchdogProcessServiceTest, TestTellDumpFinished) {
                          .isOk())
             << "Unregistered monitor cannot call tellDumpFinished";
 
-    expectLinkToDeath(monitor->asBinder().get(), std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(monitor->asBinder().get(), ScopedAStatus::ok());
 
     mWatchdogProcessService->registerMonitor(monitor);
     auto status = mWatchdogProcessService
diff --git a/cpp/watchdog/server/tests/WatchdogServiceHelperTest.cpp b/cpp/watchdog/server/tests/WatchdogServiceHelperTest.cpp
index 1cc4a30cb6..822372bc8b 100644
--- a/cpp/watchdog/server/tests/WatchdogServiceHelperTest.cpp
+++ b/cpp/watchdog/server/tests/WatchdogServiceHelperTest.cpp
@@ -106,7 +106,7 @@ protected:
     virtual void TearDown() {
         if (mWatchdogServiceHelper->isServiceConnected()) {
             expectUnlinkToDeath(mMockCarWatchdogServiceForSystem->asBinder().get(),
-                                std::move(ScopedAStatus::ok()));
+                                ScopedAStatus::ok());
             EXPECT_CALL(*mMockWatchdogProcessService, unregisterCarWatchdogService(_)).Times(1);
         }
         mWatchdogServiceHelperPeer->terminate();
@@ -120,8 +120,7 @@ protected:
     }
 
     void registerCarWatchdogService() {
-        expectLinkToDeath(mMockCarWatchdogServiceForSystem->asBinder().get(),
-                          std::move(ScopedAStatus::ok()));
+        expectLinkToDeath(mMockCarWatchdogServiceForSystem->asBinder().get(), ScopedAStatus::ok());
         EXPECT_CALL(*mMockWatchdogProcessService, registerCarWatchdogService(_, _))
                 .WillOnce(Return(ByMove(ScopedAStatus::ok())));
 
@@ -185,8 +184,7 @@ TEST_F(WatchdogServiceHelperTest, TestErrorOnInitWithNullWatchdogProcessServiceI
 
 TEST_F(WatchdogServiceHelperTest, TestTerminate) {
     ASSERT_NO_FATAL_FAILURE(registerCarWatchdogService());
-    expectUnlinkToDeath(mMockCarWatchdogServiceForSystem->asBinder().get(),
-                        std::move(ScopedAStatus::ok()));
+    expectUnlinkToDeath(mMockCarWatchdogServiceForSystem->asBinder().get(), ScopedAStatus::ok());
 
     mWatchdogServiceHelper->terminate();
 
@@ -197,7 +195,7 @@ TEST_F(WatchdogServiceHelperTest, TestRegisterService) {
     auto binder = mMockCarWatchdogServiceForSystem->asBinder();
     auto serviceHelperInterface = sp<WatchdogServiceHelperInterface>(mWatchdogServiceHelper);
 
-    expectLinkToDeath(binder.get(), std::move(ScopedAStatus::ok()));
+    expectLinkToDeath(binder.get(), ScopedAStatus::ok());
     EXPECT_CALL(*mMockWatchdogProcessService,
                 registerCarWatchdogService(binder, serviceHelperInterface))
             .WillOnce(Return(ByMove(ScopedAStatus::ok())));
@@ -217,8 +215,7 @@ TEST_F(WatchdogServiceHelperTest, TestRegisterService) {
 TEST_F(WatchdogServiceHelperTest, TestErrorOnRegisterServiceWithBinderDied) {
     auto binder = mMockCarWatchdogServiceForSystem->asBinder();
     auto serviceHelperInterface = sp<WatchdogServiceHelperInterface>(mWatchdogServiceHelper);
-    expectLinkToDeath(binder.get(),
-                      std::move(ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED)));
+    expectLinkToDeath(binder.get(), ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED));
     EXPECT_CALL(*mMockWatchdogProcessService,
                 registerCarWatchdogService(binder, serviceHelperInterface))
             .WillOnce(Return(ByMove(ScopedAStatus::ok())));
@@ -246,8 +243,7 @@ TEST_F(WatchdogServiceHelperTest, TestErrorOnRegisterServiceWithWatchdogProcessS
 TEST_F(WatchdogServiceHelperTest, TestErrorOnRegisterServiceWithDeadBinder) {
     auto binder = mMockCarWatchdogServiceForSystem->asBinder();
     auto serviceHelperInterface = sp<WatchdogServiceHelperInterface>(mWatchdogServiceHelper);
-    expectLinkToDeath(binder.get(),
-                      std::move(ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED)));
+    expectLinkToDeath(binder.get(), ScopedAStatus::fromExceptionCode(EX_TRANSACTION_FAILED));
     EXPECT_CALL(*mMockWatchdogProcessService,
                 registerCarWatchdogService(binder, serviceHelperInterface))
             .WillOnce(Return(ByMove(ScopedAStatus::ok())));
@@ -262,7 +258,7 @@ TEST_F(WatchdogServiceHelperTest, TestUnregisterService) {
     ASSERT_NO_FATAL_FAILURE(registerCarWatchdogService());
 
     auto binder = mMockCarWatchdogServiceForSystem->asBinder();
-    expectUnlinkToDeath(binder.get(), std::move(ScopedAStatus::ok()));
+    expectUnlinkToDeath(binder.get(), ScopedAStatus::ok());
     EXPECT_CALL(*mMockWatchdogProcessService, unregisterCarWatchdogService(binder)).Times(1);
 
     auto status = mWatchdogServiceHelper->unregisterService(mMockCarWatchdogServiceForSystem);
diff --git a/cpp/watchdog/testclient/src/WatchdogClient.h b/cpp/watchdog/testclient/src/WatchdogClient.h
index 3174f98ab9..23a24c73b9 100644
--- a/cpp/watchdog/testclient/src/WatchdogClient.h
+++ b/cpp/watchdog/testclient/src/WatchdogClient.h
@@ -14,8 +14,7 @@
  * limitations under the License.
  */
 
-#ifndef WATCHDOG_TESTCLIENT_SRC_WATCHDOGCLIENT_H_
-#define WATCHDOG_TESTCLIENT_SRC_WATCHDOGCLIENT_H_
+#pragma once
 
 #include <aidl/android/automotive/watchdog/BnCarWatchdog.h>
 #include <aidl/android/automotive/watchdog/BnCarWatchdogClient.h>
@@ -89,5 +88,3 @@ private:
 }  // namespace automotive
 }  // namespace android
 }  // namespace aidl
-
-#endif  // WATCHDOG_TESTCLIENT_SRC_WATCHDOGCLIENT_H_
diff --git a/data/etc/Android.bp b/data/etc/Android.bp
index 77d763524d..094c372fd4 100644
--- a/data/etc/Android.bp
+++ b/data/etc/Android.bp
@@ -254,14 +254,6 @@ prebuilt_etc {
     filename_from_src: true,
 }
 
-prebuilt_etc {
-    name: "allowed_privapp_com.android.car.multidisplay",
-    sub_dir: "permissions",
-    src: "com.android.car.multidisplay.xml",
-    filename_from_src: true,
-    system_ext_specific: true,
-}
-
 prebuilt_etc {
     name: "allowed_privapp_com.android.car.multidisplay.controlcenter",
     sub_dir: "permissions",
@@ -269,13 +261,6 @@ prebuilt_etc {
     filename_from_src: true,
 }
 
-prebuilt_etc {
-    name: "allowed_privapp_com.android.car.multidisplay.passenger",
-    sub_dir: "permissions",
-    src: "com.android.car.multidisplay.passenger.xml",
-    filename_from_src: true,
-}
-
 prebuilt_etc {
     name: "allowed_privapp_com.google.android.car.multidisplaytest",
     sub_dir: "permissions",
diff --git a/data/etc/com.android.car.carlauncher.xml b/data/etc/com.android.car.carlauncher.xml
index 301ab1ada8..df5b959772 100644
--- a/data/etc/com.android.car.carlauncher.xml
+++ b/data/etc/com.android.car.carlauncher.xml
@@ -34,5 +34,7 @@
         <permission name="android.car.permission.BROADCAST_CLOSE_SYSTEM_DIALOGS"/>
         <!-- used for broadcasting dock events -->
         <permission name="com.android.car.docklib.permission.BROADCAST_SENDER"/>
+        <!-- Used for checking media notifications -->
+        <permission name="android.permission.ACCESS_NOTIFICATIONS"/>
     </privapp-permissions>
 </permissions>
diff --git a/data/etc/com.android.car.notification.xml b/data/etc/com.android.car.notification.xml
index 76a7e97e90..f8c16666e4 100644
--- a/data/etc/com.android.car.notification.xml
+++ b/data/etc/com.android.car.notification.xml
@@ -19,6 +19,7 @@
         <permission name="android.permission.INTERACT_ACROSS_USERS"/>
         <permission name="android.permission.MANAGE_USERS"/>
         <permission name="android.permission.MODIFY_PHONE_STATE"/>
+        <permission name="android.permission.READ_PRIVILEGED_PHONE_STATE"/>
         <permission name="android.permission.STATUS_BAR"/>
     </privapp-permissions>
 </permissions>
diff --git a/data/etc/com.android.car.shell.xml b/data/etc/com.android.car.shell.xml
index 3eb041bf87..31af433a10 100644
--- a/data/etc/com.android.car.shell.xml
+++ b/data/etc/com.android.car.shell.xml
@@ -24,6 +24,9 @@
         <permission name="android.permission.LOCATION_BYPASS" />
         <permission name="android.permission.MEDIA_CONTENT_CONTROL"/>
         <permission name="android.permission.MODIFY_AUDIO_ROUTING"/>
+        <permission name="android.permission.MANAGE_TIME_AND_ZONE_DETECTION"/>
+        <permission name="android.permission.NETWORK_SETTINGS"/>
+        <permission name="android.permission.MANAGE_ACTIVITY_TASKS" />
         <permission name="android.car.permission.ACCESS_PRIVATE_DISPLAY_ID"/>
         <permission name="android.car.permission.READ_DRIVER_MONITORING_SETTINGS"/>
         <permission name="android.car.permission.CONTROL_DRIVER_MONITORING_SETTINGS"/>
diff --git a/data/etc/com.android.carsystemui.xml b/data/etc/com.android.carsystemui.xml
index 858c191eb8..f8c7194f2f 100644
--- a/data/etc/com.android.carsystemui.xml
+++ b/data/etc/com.android.carsystemui.xml
@@ -43,5 +43,9 @@
         <permission name="android.car.permission.MANAGE_DISPLAY_COMPATIBILITY"/>
         <!-- used for receiving broadcasted dock events -->
         <permission name="com.android.car.docklib.permission.BROADCAST_RECEIVER"/>
+        <!-- used for interacting with the CarActivityService -->
+        <permission name="android.car.permission.CONTROL_CAR_APP_LAUNCH"/>
+        <!-- used for checking media notifications -->
+        <permission name="android.permission.ACCESS_NOTIFICATIONS"/>
     </privapp-permissions>
 </permissions>
diff --git a/experimental/tests/experimentalcarservice_unit_test/Android.bp b/experimental/tests/experimentalcarservice_unit_test/Android.bp
index 717eb85fd7..e126df78f2 100644
--- a/experimental/tests/experimentalcarservice_unit_test/Android.bp
+++ b/experimental/tests/experimentalcarservice_unit_test/Android.bp
@@ -29,9 +29,9 @@ android_test {
 
     libs: [
         "android.car",
-        "android.test.runner",
-        "android.test.base",
-        "android.test.mock",
+        "android.test.runner.stubs.system",
+        "android.test.base.stubs.system",
+        "android.test.mock.stubs.system",
     ],
 
     static_libs: [
diff --git a/libs/backported-car-property-helper-lib/tests/Android.bp b/libs/backported-car-property-helper-lib/tests/Android.bp
index 6f2f71bc07..95219e52c9 100644
--- a/libs/backported-car-property-helper-lib/tests/Android.bp
+++ b/libs/backported-car-property-helper-lib/tests/Android.bp
@@ -25,8 +25,8 @@ android_test {
 
     libs: [
         "android.car",
-        "android.test.base",
-        "android.test.runner",
+        "android.test.base.stubs.system",
+        "android.test.runner.stubs.system",
     ],
 
     static_libs: [
diff --git a/libs/car-internal-dep-lib/src/com/android/car/internal/dep/Trace.java b/libs/car-internal-dep-lib/src/com/android/car/internal/dep/Trace.java
index 7cd2e719ec..0d94bce799 100644
--- a/libs/car-internal-dep-lib/src/com/android/car/internal/dep/Trace.java
+++ b/libs/car-internal-dep-lib/src/com/android/car/internal/dep/Trace.java
@@ -42,4 +42,32 @@ public final class Trace {
     public static void endSection() {
         android.os.Trace.endSection();
     }
+
+    /**
+     * Begins async trace.
+     */
+    public static void asyncTraceBegin(long traceTag, String methodName, int cookie) {
+        android.os.Trace.asyncTraceBegin(traceTag, methodName, cookie);
+    }
+
+    /**
+     * Ends async trace.
+     */
+    public static void asyncTraceEnd(long traceTag, String methodName, int cookie) {
+        android.os.Trace.asyncTraceEnd(traceTag, methodName, cookie);
+    }
+
+    /**
+     * Begins trace.
+     */
+    public static void traceBegin(long traceTag, String methodName) {
+        android.os.Trace.traceBegin(traceTag, methodName);
+    }
+
+    /**
+     * Ends trace.
+     */
+    public static void traceEnd(long traceTag) {
+        android.os.Trace.traceEnd(traceTag);
+    }
 }
diff --git a/libs/car-test-lib/Android.bp b/libs/car-test-lib/Android.bp
index a8cd4ed249..7ac6042d6f 100644
--- a/libs/car-test-lib/Android.bp
+++ b/libs/car-test-lib/Android.bp
@@ -38,17 +38,15 @@ java_library {
 
 java_library {
     name: "android.car.test.utils",
+    defaults: ["vhal-interface-defaults"],
     srcs: [
         "src/android/car/test/**/*.java",
     ],
     libs: [
         "android.car",
-        "android.car.builtin",
-        "android.hardware.automotive.vehicle-V2.0-java",
-        "android.hardware.automotive.vehicle-V3-java",
-        "android.hardware.automotive.vehicle.property-V3-java",
+        "android.car.builtin.stubs.module_lib",
         "mockito-target-extended",
         "compatibility-device-util-axt",
-        "android.test.mock",
+        "android.test.mock.stubs.system",
     ],
 }
diff --git a/libs/car-test-lib/TEST_MAPPING b/libs/car-test-lib/TEST_MAPPING
new file mode 100644
index 0000000000..7a9e714883
--- /dev/null
+++ b/libs/car-test-lib/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarTestLibUnitTest"
+    }
+  ]
+}
diff --git a/libs/car-test-lib/src/android/car/test/util/DiskUtils.java b/libs/car-test-lib/src/android/car/test/util/DiskUtils.java
new file mode 100644
index 0000000000..53c9eeecd1
--- /dev/null
+++ b/libs/car-test-lib/src/android/car/test/util/DiskUtils.java
@@ -0,0 +1,107 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package android.car.test.util;
+
+import android.util.Log;
+
+import java.io.File;
+import java.io.FileNotFoundException;
+import java.io.FileOutputStream;
+import java.io.IOException;
+import java.io.InterruptedIOException;
+
+public final class DiskUtils {
+    private static final String TAG = DiskUtils.class.getSimpleName();
+    private static final int DISK_DELAY_MS = 4000;
+
+    /**
+     * Writes bytes to a given file
+     *
+     * @param uniqueFile             File
+     * @param size                   Number of bytes to be written
+     *
+     * @return number of bytes written
+     *
+     * @throws IOException           Thrown when file doesn't exist or when fos.write fails
+     * @throws InterruptedException  Thrown when the current thread is interrupted
+     */
+    public static long writeToDisk(File uniqueFile, long size)
+            throws IOException, InterruptedException {
+        if (!uniqueFile.exists()) {
+            throw new FileNotFoundException("file '"
+                    + uniqueFile.getAbsolutePath() + "' doesn't exist");
+        }
+
+        if (uniqueFile.isDirectory()) {
+            throw new FileNotFoundException(uniqueFile.getAbsolutePath()
+                    + " is a directory, not a file.");
+        }
+
+        long writtenBytes = 0;
+        try (FileOutputStream fos = new FileOutputStream(uniqueFile)) {
+            Log.d(TAG, "Attempting to write " + size + " bytes");
+            writtenBytes = writeToFos(fos, size);
+            fos.getFD().sync();
+            Thread.sleep(DISK_DELAY_MS);
+        }
+
+        return writtenBytes;
+    }
+
+    /**
+     * Writes bytes to a given filestream
+     *
+     * @param fos          Filestream
+     * @param maxSize      Number of bytes to be written
+     *
+     * @return number of bytes written
+     *
+     * @throws IOException Thrown when fos.write fails
+     */
+    private static long writeToFos(FileOutputStream fos, long maxSize) throws IOException {
+        Runtime runtime = Runtime.getRuntime();
+        long writtenBytes = 0;
+        while (maxSize != 0) {
+            // The total available free memory can be calculated by adding the currently allocated
+            // memory that is free plus the total memory available to the process which hasn't been
+            // allocated yet.
+            long totalFreeMemory =
+                    runtime.maxMemory() - runtime.totalMemory() + runtime.freeMemory();
+            int writeSize = Math.toIntExact(Math.min(totalFreeMemory, maxSize));
+            Log.i(TAG, "writeSize: " + writeSize);
+            if (writeSize == 0) {
+                Log.d(TAG,
+                        "Ran out of memory while writing, exiting early with writtenBytes: "
+                        + writtenBytes);
+                return writtenBytes;
+            }
+            try {
+                fos.write(new byte[writeSize]);
+            } catch (InterruptedIOException e) {
+                Thread.currentThread().interrupt();
+                continue;
+            }
+            maxSize -= writeSize;
+            writtenBytes += writeSize;
+            if (writeSize > 0 && maxSize > 0) {
+                Log.i(TAG, "Total bytes written: " + writtenBytes + "/"
+                        + (writtenBytes + maxSize));
+            }
+        }
+        return writtenBytes;
+    }
+}
diff --git a/cpp/watchdog/car-watchdog-lib/Android.bp b/libs/car-watchdog-lib/Android.bp
similarity index 96%
rename from cpp/watchdog/car-watchdog-lib/Android.bp
rename to libs/car-watchdog-lib/Android.bp
index 00635208e8..68887cc582 100644
--- a/cpp/watchdog/car-watchdog-lib/Android.bp
+++ b/libs/car-watchdog-lib/Android.bp
@@ -45,7 +45,7 @@ java_library {
     ],
 
     libs: [
-        "android.car.builtin",
+        "android.car.builtin.stubs.module_lib",
         "framework-annotations-lib",
     ],
     installable: true,
diff --git a/libs/car-watchdog-lib/TEST_MAPPING b/libs/car-watchdog-lib/TEST_MAPPING
new file mode 100644
index 0000000000..8432eb4483
--- /dev/null
+++ b/libs/car-watchdog-lib/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarWatchdogLibUnitTest"
+    }
+  ]
+}
diff --git a/cpp/watchdog/car-watchdog-lib/src/android/car/watchdoglib/CarWatchdogDaemonHelper.java b/libs/car-watchdog-lib/src/android/car/watchdoglib/CarWatchdogDaemonHelper.java
similarity index 100%
rename from cpp/watchdog/car-watchdog-lib/src/android/car/watchdoglib/CarWatchdogDaemonHelper.java
rename to libs/car-watchdog-lib/src/android/car/watchdoglib/CarWatchdogDaemonHelper.java
diff --git a/libs/procfs-inspector/client/Android.bp b/libs/procfs-inspector/client/Android.bp
index 6e28de53f8..c264b766b4 100644
--- a/libs/procfs-inspector/client/Android.bp
+++ b/libs/procfs-inspector/client/Android.bp
@@ -46,7 +46,7 @@ java_library {
     ],
 
     libs: [
-        "android.car.builtin",
+        "android.car.builtin.stubs.module_lib",
         "framework-annotations-lib",
     ],
 
diff --git a/libs/vehicle-hal-support-lib/Android.bp b/libs/vehicle-hal-support-lib/Android.bp
index fa953fe894..0441d0c3b3 100644
--- a/libs/vehicle-hal-support-lib/Android.bp
+++ b/libs/vehicle-hal-support-lib/Android.bp
@@ -27,10 +27,8 @@ java_test_helper_library {
 
     static_libs: [
         "android.hidl.base-V1.0-java",
-        "android.hardware.automotive.vehicle-V3-java",
-        "android.hardware.automotive.vehicle.property-V3-java",
-        "android.hardware.automotive.vehicle-V2.0-java",
     ],
+    defaults: ["vhal-interface-defaults"],
 
     libs: [
         "framework-annotations-lib",
diff --git a/packages/CarActivityResolver/res/drawable/resolver_list_background.xml b/packages/CarActivityResolver/res/drawable/resolver_list_background.xml
new file mode 100644
index 0000000000..ec700340e7
--- /dev/null
+++ b/packages/CarActivityResolver/res/drawable/resolver_list_background.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <solid android:color="?android:attr/colorBackgroundFloating" />
+    <corners android:radius="@*android:dimen/car_activity_resolver_corner_radius" />
+</shape>
diff --git a/packages/CarActivityResolver/res/layout/resolver_list.xml b/packages/CarActivityResolver/res/layout/resolver_list.xml
index 1bc599def2..f54959f36c 100644
--- a/packages/CarActivityResolver/res/layout/resolver_list.xml
+++ b/packages/CarActivityResolver/res/layout/resolver_list.xml
@@ -23,5 +23,119 @@
     <com.android.car.ui.FocusParkingView
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"/>
-    <include layout="@*android:layout/car_resolver_list"/>
+
+    <com.android.internal.widget.ResolverDrawerLayout
+        android:layout_width="@*android:dimen/car_activity_resolver_width"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:id="@*android:id/contentPanel">
+
+        <View android:id="@+id/top_spacer"
+            android:layout_width="match_parent"
+            android:layout_height="0dp"
+            android:background="@android:color/transparent" />
+
+        <LinearLayout
+            android:id="@+id/activity_resolver_content"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:orientation="vertical"
+            android:background="@drawable/resolver_list_background">
+
+            <LinearLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:background="@drawable/resolver_list_background"
+                android:orientation="horizontal"
+                android:paddingVertical="@*android:dimen/car_padding_4"
+                android:paddingHorizontal="@*android:dimen/car_padding_4" >
+                <TextView
+                    android:id="@*android:id/profile_button"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:visibility="gone" />
+
+                <TextView
+                    android:id="@*android:id/title"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:layout_gravity="start"
+                    android:textAppearance="@android:style/TextAppearance.DeviceDefault.DialogWindowTitle" />
+            </LinearLayout>
+
+            <FrameLayout
+                android:id="@*android:id/stub"
+                android:visibility="gone"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"/>
+
+            <TabHost
+                android:id="@*android:id/profile_tabhost"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_alignParentTop="true"
+                android:layout_centerHorizontal="true"
+                android:background="?android:attr/colorBackgroundFloating">
+                <LinearLayout
+                    android:orientation="vertical"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content">
+                    <TabWidget
+                        android:id="@android:id/tabs"
+                        android:visibility="gone"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content">
+                    </TabWidget>
+                    <View
+                        android:id="@*android:id/resolver_tab_divider"
+                        android:visibility="gone"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content" />
+                    <FrameLayout
+                        android:id="@android:id/tabcontent"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content">
+                        <com.android.internal.app.ResolverViewPager
+                            android:id="@*android:id/profile_pager"
+                            android:layout_width="match_parent"
+                            android:layout_height="wrap_content"/>
+                    </FrameLayout>
+                </LinearLayout>
+            </TabHost>
+
+            <LinearLayout
+                android:id="@*android:id/button_bar"
+                android:visibility="gone"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_marginVertical="@*android:dimen/car_padding_4"
+                android:layout_marginHorizontal="@*android:dimen/car_padding_4"
+                android:padding="0dp"
+                android:gravity="center"
+                android:background="@drawable/resolver_list_background"
+                android:orientation="vertical">
+
+                <Button
+                    android:id="@*android:id/button_once"
+                    android:layout_width="match_parent"
+                    android:layout_height="@*android:dimen/car_button_height"
+                    android:enabled="false"
+                    android:layout_gravity="center"
+                    android:layout_marginBottom="@*android:dimen/car_padding_2"
+                    android:text="@*android:string/activity_resolver_use_once"
+                    android:onClick="onButtonClick"/>
+
+                <Button
+                    android:id="@*android:id/button_always"
+                    android:layout_width="match_parent"
+                    android:layout_height="@*android:dimen/car_button_height"
+                    android:enabled="false"
+                    android:layout_gravity="center"
+                    android:text="@*android:string/activity_resolver_use_always"
+                    android:onClick="onButtonClick"/>
+            </LinearLayout>
+
+        </LinearLayout>
+
+    </com.android.internal.widget.ResolverDrawerLayout>
 </FrameLayout>
diff --git a/packages/CarActivityResolver/res/layout/resolver_list_with_default.xml b/packages/CarActivityResolver/res/layout/resolver_list_with_default.xml
index 5477f2ce4b..de3b234897 100644
--- a/packages/CarActivityResolver/res/layout/resolver_list_with_default.xml
+++ b/packages/CarActivityResolver/res/layout/resolver_list_with_default.xml
@@ -23,5 +23,150 @@
     <com.android.car.ui.FocusParkingView
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"/>
-    <include layout="@*android:layout/car_resolver_list_with_default"/>
+    <com.android.internal.widget.ResolverDrawerLayout
+        android:layout_width="@*android:dimen/car_activity_resolver_width"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center"
+        android:id="@*android:id/contentPanel">
+
+        <View android:id="@+id/top_spacer"
+            android:layout_width="match_parent"
+            android:layout_height="0dp"
+            android:background="@android:color/transparent" />
+
+        <LinearLayout
+            android:id="@+id/activity_resolver_content"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:orientation="vertical"
+            android:layout_gravity="center"
+            android:background="@drawable/resolver_list_background">
+
+            <FrameLayout
+                android:id="@*android:id/stub"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:background="@drawable/resolver_list_background"/>
+
+
+            <LinearLayout
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:minHeight="@dimen/resolver_list_item_height"
+                android:orientation="horizontal">
+
+                <RadioButton
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:focusable="false"
+                    android:clickable="false"
+                    android:layout_marginStart="?android:attr/listPreferredItemPaddingStart"
+                    android:layout_gravity="start|center_vertical"
+                    android:checked="true"/>
+
+                <ImageView
+                    android:id="@*android:id/icon"
+                    android:layout_width="@*android:dimen/car_icon_size"
+                    android:layout_height="@*android:dimen/car_icon_size"
+                    android:layout_gravity="start|center_vertical"
+                    android:layout_marginStart="@*android:dimen/car_padding_4"
+                    android:src="@*android:drawable/resolver_icon_placeholder"
+                    android:scaleType="fitCenter"/>
+
+                <TextView
+                    android:id="@*android:id/title"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content"
+                    android:layout_marginHorizontal="?android:attr/listPreferredItemPaddingStart"
+                    style="?android:attr/textAppearanceListItem"
+                    android:layout_gravity="start|center_vertical" />
+
+                <LinearLayout
+                    android:id="@*android:id/profile_button"
+                    android:visibility="gone"
+                    android:layout_width="wrap_content"
+                    android:layout_height="wrap_content">
+
+                    <ImageView
+                        android:id="@*android:id/icon"
+                        android:visibility="gone"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content" />
+
+                    <TextView
+                        android:id="@android:id/text1"
+                        android:visibility="gone"
+                        android:layout_width="wrap_content"
+                        android:layout_height="wrap_content" />
+                </LinearLayout>
+            </LinearLayout>
+
+            <TabHost
+                android:id="@*android:id/profile_tabhost"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_alignParentTop="true"
+                android:layout_centerHorizontal="true"
+                android:background="?attr/colorBackgroundFloating">
+                <LinearLayout
+                    android:orientation="vertical"
+                    android:layout_width="match_parent"
+                    android:layout_height="wrap_content">
+                    <TabWidget
+                        android:id="@android:id/tabs"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content"
+                        android:visibility="gone">
+                    </TabWidget>
+                    <View
+                        android:id="@*android:id/resolver_tab_divider"
+                        android:visibility="gone"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content" />
+                    <FrameLayout
+                        android:id="@android:id/tabcontent"
+                        android:layout_width="match_parent"
+                        android:layout_height="wrap_content">
+                        <com.android.internal.app.ResolverViewPager
+                            android:id="@*android:id/profile_pager"
+                            android:layout_width="match_parent"
+                            android:layout_height="wrap_content">
+                        </com.android.internal.app.ResolverViewPager>
+                    </FrameLayout>
+                </LinearLayout>
+            </TabHost>
+
+            <LinearLayout
+                android:id="@*android:id/button_bar"
+                android:visibility="gone"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:layout_marginVertical="@*android:dimen/car_padding_4"
+                android:layout_marginHorizontal="@*android:dimen/car_padding_4"
+                android:gravity="center"
+                android:background="@drawable/resolver_list_background"
+                android:orientation="vertical">
+
+                <Button
+                    android:id="@*android:id/button_once"
+                    android:layout_width="match_parent"
+                    android:layout_height="@*android:dimen/car_button_height"
+                    android:enabled="false"
+                    android:layout_gravity="center"
+                    android:layout_marginBottom="@*android:dimen/car_padding_2"
+                    android:text="@*android:string/activity_resolver_use_once"
+                    android:onClick="onButtonClick"/>
+
+                <Button
+                    android:id="@*android:id/button_always"
+                    android:layout_width="match_parent"
+                    android:layout_height="@*android:dimen/car_button_height"
+                    android:enabled="false"
+                    android:layout_gravity="center"
+                    android:text="@*android:string/activity_resolver_use_always"
+                    android:onClick="onButtonClick"/>
+            </LinearLayout>
+        </LinearLayout>
+
+    </com.android.internal.widget.ResolverDrawerLayout>
 </FrameLayout>
diff --git a/packages/CarActivityResolver/res/values/dimens.xml b/packages/CarActivityResolver/res/values/dimens.xml
index b6ff6600a4..53e646d35a 100644
--- a/packages/CarActivityResolver/res/values/dimens.xml
+++ b/packages/CarActivityResolver/res/values/dimens.xml
@@ -17,5 +17,8 @@
 -->
 <resources>
     <dimen name="background_blur_radius">14dp</dimen>
+
+    <!-- These values are copied from the framework so they may be referenced in this app -->
+    <dimen name="resolver_list_item_height">@*android:dimen/car_activity_resolver_list_item_height</dimen>
     <dimen name="resolver_list_max_height">@*android:dimen/car_activity_resolver_list_max_height</dimen>
 </resources>
diff --git a/packages/CarActivityResolver/src/com/android/car/activityresolver/CarResolverActivity.java b/packages/CarActivityResolver/src/com/android/car/activityresolver/CarResolverActivity.java
index b23b4079b8..bcba721be5 100644
--- a/packages/CarActivityResolver/src/com/android/car/activityresolver/CarResolverActivity.java
+++ b/packages/CarActivityResolver/src/com/android/car/activityresolver/CarResolverActivity.java
@@ -19,6 +19,7 @@ package com.android.car.activityresolver;
 import android.os.Bundle;
 import android.view.View;
 import android.view.ViewTreeObserver;
+import android.widget.LinearLayout;
 import android.widget.ListView;
 
 import androidx.core.graphics.Insets;
@@ -82,6 +83,12 @@ public final class CarResolverActivity extends ResolverActivity
 
     @Override
     public void onGlobalLayout() {
+        setupRotary();
+        setupAppListHeight();
+        setupTopSpacerHeight();
+    }
+
+    private void setupRotary() {
         ListView listView = findViewById(R.id.resolver_list);
         if (listView != null) {
             // Items must be focusable for rotary.
@@ -96,13 +103,37 @@ public final class CarResolverActivity extends ResolverActivity
                     listView.performItemClick(view, position, id);
                 });
             }
+        }
+    }
 
-            int resolverListMaxHeight = getResources().getDimensionPixelSize(
-                    com.android.car.activityresolver.R.dimen.resolver_list_max_height);
-            if (listView.getHeight() > resolverListMaxHeight) {
-                listView.getLayoutParams().height = resolverListMaxHeight;
-                listView.setLayoutParams(listView.getLayoutParams());
-            }
+    private void setupTopSpacerHeight() {
+        ResolverDrawerLayout resolverDrawerLayout =
+                ((ResolverDrawerLayout) findViewById(R.id.contentPanel));
+        LinearLayout activityResolverContent =
+                findViewById(com.android.car.activityresolver.R.id.activity_resolver_content);
+        View emptyTop = findViewById(com.android.car.activityresolver.R.id.top_spacer);
+
+        // Setup top spacer to be half the difference in the resolver drawer/content height
+        emptyTop.getLayoutParams().height =
+                (resolverDrawerLayout.getHeight() - activityResolverContent.getHeight()) / 2;
+        emptyTop.setLayoutParams(emptyTop.getLayoutParams());
+    }
+
+    private void setupAppListHeight() {
+        ListView listView = findViewById(R.id.resolver_list);
+        // Set a max height on the list of apps so that the list does not cut off the "Just
+        // Once"/"Always" buttons of the activity
+        int resolverListMaxHeight = getResources().getDimensionPixelSize(
+                com.android.car.activityresolver.R.dimen.resolver_list_max_height);
+        // The activity has a preselected default app option, so subract that height from max
+        // height which is applied to the list of app choices
+        if (useLayoutWithDefault()) {
+            resolverListMaxHeight -= getResources().getDimensionPixelSize(
+                    com.android.car.activityresolver.R.dimen.resolver_list_item_height);
+        }
+        if (listView.getHeight() > resolverListMaxHeight) {
+            listView.getLayoutParams().height = resolverListMaxHeight;
+            listView.setLayoutParams(listView.getLayoutParams());
         }
     }
 
diff --git a/packages/CarDeveloperOptions/AndroidManifest.xml b/packages/CarDeveloperOptions/AndroidManifest.xml
index 393bc822e0..5ae549860e 100644
--- a/packages/CarDeveloperOptions/AndroidManifest.xml
+++ b/packages/CarDeveloperOptions/AndroidManifest.xml
@@ -324,6 +324,15 @@
             <intent-filter tools:node="removeAll"/>
         </activity>
 
+        <activity
+            android:name="com.android.settings.Settings$CombinedBiometricSettingsActivity"
+            android:enabled="false"
+            android:exported="false"
+            tools:node="merge"
+            tools:replace="android:exported">
+            <intent-filter tools:node="removeAll"/>
+        </activity>
+
         <activity
             android:name="com.android.settings.bluetooth.DevicePickerActivity"
             android:enabled="false"
@@ -432,6 +441,15 @@
             <intent-filter tools:node="removeAll"/>
         </activity>
 
+        <activity
+            android:name="com.android.settings.Settings$ManageAdaptiveNotificationsActivity"
+            android:enabled="false"
+            android:exported="false"
+            tools:node="merge"
+            tools:replace="android:exported">
+            <intent-filter tools:node="removeAll"/>
+        </activity>
+
         <activity
             android:name="com.android.settings.Settings$LanguageSettingsActivity"
             android:enabled="false"
@@ -585,6 +603,24 @@
             <intent-filter tools:node="removeAll"/>
         </activity>
 
+        <activity
+            android:name="com.android.settings.Settings$ModesSettingsActivity"
+            android:enabled="false"
+            android:exported="false"
+            tools:node="merge"
+            tools:replace="android:exported">
+            <intent-filter tools:node="removeAll"/>
+        </activity>
+
+        <activity
+            android:name="com.android.settings.Settings$ModeSettingsActivity"
+            android:enabled="false"
+            android:exported="false"
+            tools:node="merge"
+            tools:replace="android:exported">
+            <intent-filter tools:node="removeAll"/>
+        </activity>
+
         <activity
             android:name="com.android.settings.Settings$WallpaperSettingsActivity"
             android:enabled="false"
@@ -1282,7 +1318,7 @@
             tools:replace="android:exported"/>
 
         <activity
-            android:name="com.android.settings.biometrics.fingerprint.FingerprintEnrollIntroduction"
+            android:name="com.android.settings.biometrics.fingerprint.FingerprintEnroll"
             android:enabled="false"
             android:exported="false"
             tools:node="merge"
@@ -1306,7 +1342,7 @@
             tools:replace="android:exported"/>
 
         <activity
-            android:name="com.android.settings.biometrics.fingerprint.SetupFingerprintEnrollIntroduction"
+            android:name="com.android.settings.biometrics.fingerprint.FingerprintEnroll$SetupActivity"
             android:enabled="false"
             android:exported="false"
             tools:node="merge"
@@ -1630,6 +1666,15 @@
             <intent-filter tools:node="removeAll"/>
         </activity>
 
+        <activity
+            android:name="com.android.settings.bluetooth.BluetoothKeyMissingDialog"
+            android:enabled="false"
+            android:exported="false"
+            tools:node="merge"
+            tools:replace="android:exported">
+            <intent-filter tools:node="removeAll"/>
+        </activity>
+
         <activity
             android:name="com.android.settings.bluetooth.BluetoothPairingDialog"
             android:enabled="false"
@@ -2953,6 +2998,15 @@
             <intent-filter tools:node="removeAll"/>
        </activity>
 
+        <activity
+            android:name="com.android.settings.spa.search.SpaSearchLandingActivity"
+            android:enabled="false"
+            android:exported="false"
+            tools:node="merge"
+            tools:replace="android:exported">
+            <intent-filter tools:node="removeAll"/>
+        </activity>
+
         <activity-alias
             android:name="com.android.settings.ConfirmDeviceCredentialActivity"
             android:enabled="false"
@@ -3087,6 +3141,15 @@
             <intent-filter tools:node="removeAll"/>
         </receiver>
 
+        <receiver
+            android:name="com.android.settings.bluetooth.BluetoothKeyMissingReceiver"
+            android:enabled="false"
+            android:exported="false"
+            tools:node="merge"
+            tools:replace="android:exported">
+            <intent-filter tools:node="removeAll"/>
+        </receiver>
+
         <receiver
             android:name="com.android.settings.bluetooth.BluetoothPermissionRequest"
             android:enabled="false"
@@ -3284,6 +3347,14 @@
             <intent-filter tools:node="removeAll"/>
         </receiver>
 
+        <receiver android:name="com.android.settings.shortcut.ShortcutsUpdateReceiver"
+            android:exported="false"
+            android:enabled="false"
+            tools:node="merge"
+            tools:replace="android:exported">
+            <intent-filter tools:node="removeAll"/>
+        </receiver>
+
         <service
             android:name="com.android.settings.wifi.tether.TetherService"
             android:enabled="false"
diff --git a/packages/CarDeveloperOptions/tests/unit/Android.bp b/packages/CarDeveloperOptions/tests/unit/Android.bp
index fec502751e..5051fc634e 100644
--- a/packages/CarDeveloperOptions/tests/unit/Android.bp
+++ b/packages/CarDeveloperOptions/tests/unit/Android.bp
@@ -11,8 +11,8 @@ android_test {
     srcs: ["src/**/*.java"],
 
     libs: [
-        "android.test.runner",
-        "android.test.base",
+        "android.test.runner.stubs.system",
+        "android.test.base.stubs.system",
     ],
 
     static_libs: [
diff --git a/packages/CarManagedProvisioning/res/values-be/strings.xml b/packages/CarManagedProvisioning/res/values-be/strings.xml
index 808aabec93..734a82123e 100644
--- a/packages/CarManagedProvisioning/res/values-be/strings.xml
+++ b/packages/CarManagedProvisioning/res/values-be/strings.xml
@@ -30,12 +30,12 @@
     <string name="fully_managed_device_provisioning_accept_header" msgid="8767138982035307813">"   "</string>
     <string name="fully_managed_device_provisioning_step_1_header" msgid="8704166635032524345">"   "</string>
     <string name="fully_managed_device_provisioning_step_1_description" msgid="5960961281295355254">"  - ..."</string>
-    <string name="fully_managed_device_provisioning_step_2_header" msgid="5888602026900289468">"-   \' "</string>
+    <string name="fully_managed_device_provisioning_step_2_header" msgid="5888602026900289468">"-    "</string>
     <string name="fully_managed_device_provisioning_step_2_subheader_title" msgid="1421575203782743214">"   "</string>
     <string name="fully_managed_device_provisioning_step_2_subheader" msgid="4881961368653838979">"            ."</string>
     <string name="fully_managed_device_provisioning_permissions_secondary_subheader" msgid="8955791361423166123">"         ,      ."</string>
-    <string name="fully_managed_device_with_permission_control_provisioning_summary" msgid="2503568673345133100">" -  ,        .    \' ,         .           ,      ."</string>
-    <string name="fully_managed_device_provisioning_summary" msgid="4323948058344613817">" -  ,        .    \' ,           ."</string>
+    <string name="fully_managed_device_with_permission_control_provisioning_summary" msgid="2503568673345133100">" -  ,        .     ,         .           ,      ."</string>
+    <string name="fully_managed_device_provisioning_summary" msgid="4323948058344613817">" -  ,        .     ,           ."</string>
     <string name="fully_managed_device_provisioning_progress_label" msgid="988594700479673633">"    "</string>
     <string name="fully_managed_device_provisioning_return_device_title" msgid="1578111657911434819">"    "</string>
     <string name="fully_managed_device_provisioning_return_device_subheader" msgid="5809488930429106172">"            ,   ."</string>
diff --git a/packages/CarManagedProvisioning/res/values-uk/strings.xml b/packages/CarManagedProvisioning/res/values-uk/strings.xml
index 2aeba69d52..2d55813790 100644
--- a/packages/CarManagedProvisioning/res/values-uk/strings.xml
+++ b/packages/CarManagedProvisioning/res/values-uk/strings.xml
@@ -31,7 +31,7 @@
     <string name="fully_managed_device_provisioning_step_1_header" msgid="8704166635032524345">"    "</string>
     <string name="fully_managed_device_provisioning_step_1_description" msgid="5960961281295355254">" - "</string>
     <string name="fully_managed_device_provisioning_step_2_header" msgid="5888602026900289468">" -   "</string>
-    <string name="fully_managed_device_provisioning_step_2_subheader_title" msgid="1421575203782743214">"   "</string>
+    <string name="fully_managed_device_provisioning_step_2_subheader_title" msgid="1421575203782743214">"   "</string>
     <string name="fully_managed_device_provisioning_step_2_subheader" msgid="4881961368653838979">"            ."</string>
     <string name="fully_managed_device_provisioning_permissions_secondary_subheader" msgid="8955791361423166123">"           (,      )."</string>
     <string name="fully_managed_device_with_permission_control_provisioning_summary" msgid="2503568673345133100">"       -    .    ,         .             (,      )."</string>
diff --git a/packages/CarShell/AndroidManifest.xml b/packages/CarShell/AndroidManifest.xml
index d9ff896a1d..048131628a 100644
--- a/packages/CarShell/AndroidManifest.xml
+++ b/packages/CarShell/AndroidManifest.xml
@@ -178,4 +178,10 @@
     <uses-permission android:name="android.car.permission.CAR_PROJECTION" />
     <!-- permissions required for CarWifiManagerTest -->
     <uses-permission android:name="android.car.permission.READ_PERSIST_TETHERING_SETTINGS" />
+    <!-- permissions required for DateTimeSettingTest -->
+    <uses-permission android:name="android.permission.MANAGE_TIME_AND_ZONE_DETECTION" />
+    <!-- permissions required for ATS aareceiverts test - AccessPointTests -->
+    <uses-permission android:name="android.permissions.NETWORK_SETTINGS" />
+    <!-- permissions required for AtsBlockinguiDeviceTest -->
+    <uses-permission android:name="android.permission.MANAGE_ACTIVITY_TASKS" />
 </manifest>
diff --git a/service-builtin/Android.bp b/service-builtin/Android.bp
index 9d5ce435e7..1b67e90fe9 100644
--- a/service-builtin/Android.bp
+++ b/service-builtin/Android.bp
@@ -49,7 +49,7 @@ android_app {
 
     libs: [
         "android.car",
-        "android.car.builtin",
+        "android.car.builtin.stubs.module_lib",
     ],
 
     static_libs: [
@@ -71,7 +71,7 @@ android_library {
 
     libs: [
         "android.car",
-        "android.car.builtin",
+        "android.car.builtin.stubs.module_lib",
     ],
 
     static_libs: [
diff --git a/service-builtin/res/values-mn/strings.xml b/service-builtin/res/values-mn/strings.xml
index 76b7c26eaf..a9da5fc4d9 100644
--- a/service-builtin/res/values-mn/strings.xml
+++ b/service-builtin/res/values-mn/strings.xml
@@ -31,7 +31,7 @@
     <string name="exit_button_go_back" msgid="6921595432375141935">""</string>
     <string name="importance_default" msgid="8017186728206153704">"  "</string>
     <string name="importance_high" msgid="3393374688015554727">"  "</string>
-    <string name="android_system_label" msgid="9209428539477894959">" "</string>
+    <string name="android_system_label" msgid="9209428539477894959">"Android "</string>
     <string name="factory_reset_notification_title" msgid="6177770995437355965">"   "</string>
     <string name="factory_reset_notification_text" msgid="6051393302193696102">"     .       ."</string>
     <string name="factory_reset_notification_button" msgid="6926734587145351076">""</string>
diff --git a/service/Android.bp b/service/Android.bp
index 78b00752a3..89a5e63dc1 100644
--- a/service/Android.bp
+++ b/service/Android.bp
@@ -158,6 +158,7 @@ java_defaults {
     defaults: [
         "car-framework-aconfig-libraries",
         "latest_android_hardware_automotive_audiocontrol_java_static",
+        "vhal-interface-defaults",
     ],
 
     srcs: [
@@ -191,15 +192,15 @@ java_defaults {
 
     libs: [
         "android.car-module.impl",
-        "android.car.builtin",
+        "android.car.builtin.stubs.module_lib",
         "framework-annotations-lib",
-        "framework-bluetooth",
-        "framework-connectivity",
+        "framework-bluetooth.stubs.module_lib",
+        "framework-connectivity.stubs.module_lib",
         "framework-connectivity-t.stubs.module_lib",
-        "framework-location",
-        "framework-statsd",
-        "framework-tethering",
-        "framework-wifi",
+        "framework-location.stubs.module_lib",
+        "framework-statsd.stubs.module_lib",
+        "framework-tethering.stubs.module_lib",
+        "framework-wifi.stubs.module_lib",
         "modules-utils-os",
         "modules-utils-preconditions",
         "modules-utils-shell-command-handler",
@@ -215,9 +216,6 @@ java_defaults {
         "android.hardware.automotive.audiocontrol-V1.0-java",
         "android.hardware.automotive.audiocontrol-V2.0-java",
         "android.hardware.automotive.remoteaccess-V2-java",
-        "android.hardware.automotive.vehicle-V3-java",
-        "android.hardware.automotive.vehicle.property-V3-java",
-        "android.hardware.automotive.vehicle-V2.0-java",
         "android.hardware.health-V1.0-java",
         "android.hardware.health-V2.0-java",
         "android.hardware.automotive.occupant_awareness-V1-java",
@@ -277,9 +275,10 @@ android_app {
 }
 
 java_library {
-
     name: "car-service-common-util-static-lib",
 
+    defaults: ["vhal-interface-defaults"],
+
     srcs: [
         "src/com/android/car/CarServiceBase.java",
         "src/com/android/car/CarServiceUtils.java",
@@ -289,14 +288,9 @@ java_library {
     ],
 
     libs: [
-        "android.car.builtin",
+        "android.car.builtin.stubs.module_lib",
         "android.car",
     ],
-
-    static_libs: [
-        "android.hardware.automotive.vehicle-V3-java",
-        "android.hardware.automotive.vehicle-V2.0-java",
-    ],
 }
 
 // Minimum code shared with carservice builtin.
@@ -343,3 +337,12 @@ filegroup {
     ],
     path: "src",
 }
+
+java_defaults {
+    name: "vhal-interface-defaults",
+    static_libs: [
+        "android.hardware.automotive.vehicle-V2.0-java",
+        "android.hardware.automotive.vehicle-V3-java",
+        "android.hardware.automotive.vehicle.property-V4-java",
+    ],
+}
diff --git a/service/OWNERS b/service/OWNERS
index 91f45d88a0..3a5e3bc7c0 100644
--- a/service/OWNERS
+++ b/service/OWNERS
@@ -59,6 +59,6 @@ per-file src/com/android/car/hal/VehicleHal.java = ericjeong@google.com
 per-file src/com/android/car/hal/fakevhal/*.java = ericjeong@google.com
 
 # Watchdog
-per-file proto/android/car/watchdog/* = lakshmana@google.com
-per-file src/com/android/car/os/* = lakshmana@google.com
-per-file src/com/android/car/watchdog/* = lakshmana@google.com
+per-file proto/android/car/watchdog/* = lakshmana@google.com, jahdiel@google.com
+per-file src/com/android/car/os/* = lakshmana@google.com, jahdiel@google.com
+per-file src/com/android/car/watchdog/* = lakshmana@google.com, jahdiel@google.com
diff --git a/service/jni/evs/EvsServiceContext.cpp b/service/jni/evs/EvsServiceContext.cpp
index 62c30b1ec0..782c30831b 100644
--- a/service/jni/evs/EvsServiceContext.cpp
+++ b/service/jni/evs/EvsServiceContext.cpp
@@ -271,8 +271,20 @@ bool EvsServiceContext::openCamera(const char* id) {
                                    return target == desc.id;
                                });
         if (it == mCameraList.end()) {
-            LOG(ERROR) << id << " is not available";
-            return false;
+            // Refresh a list of available cameras and try again.
+            if (!mServiceFactory->getService()->getCameraList(&mCameraList).isOk()) {
+                LOG(ERROR) << "Failed to update a camera list.";
+                return false;
+            }
+
+            it = std::find_if(mCameraList.begin(), mCameraList.end(),
+                              [target = std::string(id)](const CameraDesc& desc) {
+                                  return target == desc.id;
+                              });
+            if (it == mCameraList.end()) {
+                LOG(ERROR) << id << " is not available";
+                return false;
+            }
         }
 
         cameraToClose = mCamera;
diff --git a/service/jni/evs/StreamHandler.cpp b/service/jni/evs/StreamHandler.cpp
index 1b8acadbcc..66edc234aa 100644
--- a/service/jni/evs/StreamHandler.cpp
+++ b/service/jni/evs/StreamHandler.cpp
@@ -46,12 +46,12 @@ NativeHandle dupNativeHandle(const NativeHandle& handle, bool doDup) {
         }
     } else {
         for (auto i = 0; i < handle.fds.size(); ++i) {
-            dup.fds[i] = std::move(handle.fds[i].dup());
+            dup.fds[i] = handle.fds[i].dup();
         }
     }
     dup.ints = handle.ints;
 
-    return std::move(dup);
+    return dup;
 }
 
 HardwareBuffer dupHardwareBuffer(const HardwareBuffer& buffer, bool doDup) {
@@ -60,7 +60,7 @@ HardwareBuffer dupHardwareBuffer(const HardwareBuffer& buffer, bool doDup) {
             .handle = dupNativeHandle(buffer.handle, doDup),
     };
 
-    return std::move(dup);
+    return dup;
 }
 
 BufferDesc dupBufferDesc(const BufferDesc& src, bool doDup) {
@@ -73,7 +73,7 @@ BufferDesc dupBufferDesc(const BufferDesc& src, bool doDup) {
             .metadata = src.metadata,
     };
 
-    return std::move(dup);
+    return dup;
 }
 
 }  // namespace
diff --git a/service/proto/android/car/watchdog/carwatchdog_daemon_dump.proto b/service/proto/android/car/watchdog/carwatchdog_daemon_dump.proto
index 394f76d391..b706083415 100644
--- a/service/proto/android/car/watchdog/carwatchdog_daemon_dump.proto
+++ b/service/proto/android/car/watchdog/carwatchdog_daemon_dump.proto
@@ -42,6 +42,7 @@ message PerformanceProfilerDump {
   }
   optional EventType current_event = 1;
   optional PerformanceStats performance_stats = 2;
+  optional int64 boot_completed_time_epoch_seconds = 3;
 }
 
 message HealthCheckServiceDump {
diff --git a/service/proto/android/car/watchdog/performance_stats.proto b/service/proto/android/car/watchdog/performance_stats.proto
index e8e36e6fba..45e69738fe 100644
--- a/service/proto/android/car/watchdog/performance_stats.proto
+++ b/service/proto/android/car/watchdog/performance_stats.proto
@@ -25,6 +25,7 @@ message PerformanceStats {
   repeated UserSwitchStatsCollection user_switch_stats = 3;
   optional StatsCollection last_n_minutes_stats = 4;
   optional StatsCollection custom_collection_stats = 5;
+  optional int64 kernel_start_time_epoch_seconds = 6;
 }
 
 // Represents the performance stats captured during a single event as a record.
diff --git a/service/res/values-gu/strings.xml b/service/res/values-gu/strings.xml
index ee4e6286ac..40ff90133d 100644
--- a/service/res/values-gu/strings.xml
+++ b/service/res/values-gu/strings.xml
@@ -83,7 +83,7 @@
     <string name="car_permission_label_diag_clear" msgid="4783070510879698157">"   "</string>
     <string name="car_permission_desc_diag_clear" msgid="7453222114866042786">"    ."</string>
     <string name="car_permission_label_vms_publisher" msgid="3049934078926106641">"VMS  "</string>
-    <string name="car_permission_desc_vms_publisher" msgid="5589489298597386828">"VMS   "</string>
+    <string name="car_permission_desc_vms_publisher" msgid="5589489298597386828">"VMS   "</string>
     <string name="car_permission_label_vms_subscriber" msgid="5648841182059222299">"VMS "</string>
     <string name="car_permission_desc_vms_subscriber" msgid="7551009457847673620">"VMS   "</string>
     <string name="car_permission_label_read_ultrasonics_sensor_data" msgid="1097940233242534149">"    ."</string>
diff --git a/service/res/values/config.xml b/service/res/values/config.xml
index dd0ecca931..a3cccb4713 100644
--- a/service/res/values/config.xml
+++ b/service/res/values/config.xml
@@ -665,4 +665,7 @@
               will be stopped.
     -->
     <string name="config_suspend_to_disk_memory_savings" translatable="false">low</string>
+
+    <!-- Controls the use of bluetooth pairing when long pressing the voice assist button in CarInputService. -->
+    <bool name="config_enableLongPressBluetoothPairing">true</bool>
 </resources>
diff --git a/service/res/values/overlayable.xml b/service/res/values/overlayable.xml
index a7abc226ab..62a3883568 100644
--- a/service/res/values/overlayable.xml
+++ b/service/res/values/overlayable.xml
@@ -134,6 +134,7 @@
           <item type="bool" name="config_enablePersistTetheringCapabilities" />
           <item type="array" name="config_packages_not_to_stop_during_suspend" translatable="false"/>
           <item type="string" name="config_suspend_to_disk_memory_savings" translatable="false"/>
+          <item type="bool" name="config_enableLongPressBluetoothPairing" />
           <!-- Params from config.xml that can be overlaid -->
 
           <!-- XML files that can be overlaid -->
diff --git a/service/src/com/android/car/AidlVehicleStub.java b/service/src/com/android/car/AidlVehicleStub.java
index 74ab31a201..58df59bd29 100644
--- a/service/src/com/android/car/AidlVehicleStub.java
+++ b/service/src/com/android/car/AidlVehicleStub.java
@@ -423,7 +423,8 @@ final class AidlVehicleStub extends VehicleStub {
                         new ArrayMap<>();
                 for (int i = 0; i < vhalRequestIds.size(); i++) {
                     long vhalRequestId = vhalRequestIds.get(i);
-                    AsyncRequestInfo requestInfo = finishRequestIfFound(vhalRequestId);
+                    AsyncRequestInfo requestInfo = finishRequestIfFound(vhalRequestId,
+                            /* alreadyTimedOut= */ true);
                     if (requestInfo == null) {
                         // We already finished the request or the callback is already dead, ignore.
                         Slogf.w(TAG, "onRequestsTimeout: the request for VHAL request ID: %d is "
@@ -453,10 +454,11 @@ final class AidlVehicleStub extends VehicleStub {
             }
         }
 
-        @Nullable AsyncRequestInfo finishRequestIfFound(long vhalRequestId) {
+        @Nullable AsyncRequestInfo finishRequestIfFound(long vhalRequestId,
+                boolean alreadyTimedOut) {
             synchronized (mAsyncRequestPoolLock) {
                 AsyncRequestInfo requestInfo = mPendingRequestPool.getRequestIfFound(vhalRequestId);
-                mPendingRequestPool.removeRequest(vhalRequestId);
+                mPendingRequestPool.removeRequest(vhalRequestId, alreadyTimedOut);
                 return requestInfo;
             }
         }
@@ -695,7 +697,7 @@ final class AidlVehicleStub extends VehicleStub {
                 }
 
                 AsyncRequestInfo requestInfo = mPendingAsyncRequestPool.finishRequestIfFound(
-                        vhalRequestId);
+                        vhalRequestId, /* alreadyTimedOut= */ false);
                 if (requestInfo == null) {
                     Slogf.w(TAG,
                             "No pending request for ID: %s, possibly already timed out, "
@@ -1121,7 +1123,7 @@ final class AidlVehicleStub extends VehicleStub {
             for (int i = 0; i < requests.length; i++) {
                 long vhalRequestId = asyncRequestsHandler.getVhalRequestId(requests[i]);
                 AsyncRequestInfo requestInfo = mPendingAsyncRequestPool.finishRequestIfFound(
-                        vhalRequestId);
+                        vhalRequestId, /* alreadyTimedOut= */ false);
                 if (requestInfo == null) {
                     Slogf.w(TAG,
                             "No pending request for ID: %s, possibly already timed out or "
diff --git a/service/src/com/android/car/CarBugreportManagerService.java b/service/src/com/android/car/CarBugreportManagerService.java
index d19be2f7c6..b0ad508cdd 100644
--- a/service/src/com/android/car/CarBugreportManagerService.java
+++ b/service/src/com/android/car/CarBugreportManagerService.java
@@ -38,7 +38,6 @@ import android.os.Binder;
 import android.os.Handler;
 import android.os.HandlerThread;
 import android.os.ParcelFileDescriptor;
-import android.os.Process;
 import android.os.RemoteException;
 import android.os.SystemClock;
 import android.util.proto.ProtoOutputStream;
@@ -136,7 +135,6 @@ public class CarBugreportManagerService extends ICarBugreportService.Stub implem
             ICarBugreportCallback callback, boolean dumpstateDryRun) {
         mContext.enforceCallingOrSelfPermission(
                 android.Manifest.permission.DUMP, "requestBugreport");
-        ensureTheCallerIsSignedWithPlatformKeys();
         ensureTheCallerIsDesignatedBugReportApp();
         synchronized (mLock) {
             if (mIsServiceRunning.getAndSet(true)) {
@@ -153,7 +151,6 @@ public class CarBugreportManagerService extends ICarBugreportService.Stub implem
     public void cancelBugreport() {
         mContext.enforceCallingOrSelfPermission(
                 android.Manifest.permission.DUMP, "cancelBugreport");
-        ensureTheCallerIsSignedWithPlatformKeys();
         ensureTheCallerIsDesignatedBugReportApp();
         synchronized (mLock) {
             if (!mIsServiceRunning.getAndSet(false)) {
@@ -192,15 +189,6 @@ public class CarBugreportManagerService extends ICarBugreportService.Stub implem
         }
     }
 
-    private void ensureTheCallerIsSignedWithPlatformKeys() {
-        PackageManager pm = mContext.getPackageManager();
-        int callingUid = Binder.getCallingUid();
-        if (pm.checkSignatures(Process.myUid(), callingUid) != PackageManager.SIGNATURE_MATCH) {
-            throw new SecurityException("Caller " + pm.getNameForUid(callingUid)
-                            + " does not have the right signature");
-        }
-    }
-
     /** Checks only on user builds. */
     private void ensureTheCallerIsDesignatedBugReportApp() {
         if (!mIsUserBuild) {
diff --git a/service/src/com/android/car/CarFeatureController.java b/service/src/com/android/car/CarFeatureController.java
index 8fb2b819e4..877faca2b2 100644
--- a/service/src/com/android/car/CarFeatureController.java
+++ b/service/src/com/android/car/CarFeatureController.java
@@ -122,7 +122,6 @@ public final class CarFeatureController implements CarServiceBase {
             Car.CAR_OCCUPANT_CONNECTION_SERVICE,
             Car.CAR_REMOTE_DEVICE_SERVICE,
             Car.DIAGNOSTIC_SERVICE,
-            Car.EXPERIMENTAL_CAR_USER_SERVICE,
             Car.OCCUPANT_AWARENESS_SERVICE,
             Car.STORAGE_MONITORING_SERVICE,
             Car.VEHICLE_MAP_SERVICE,
diff --git a/service/src/com/android/car/CarInputService.java b/service/src/com/android/car/CarInputService.java
index 618630cd0c..473eb6c5eb 100644
--- a/service/src/com/android/car/CarInputService.java
+++ b/service/src/com/android/car/CarInputService.java
@@ -30,6 +30,8 @@ import static java.util.Objects.requireNonNull;
 
 import android.annotation.Nullable;
 import android.annotation.UserIdInt;
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothManager;
 import android.car.CarOccupantZoneManager;
 import android.car.CarOccupantZoneManager.OccupantZoneInfo;
 import android.car.CarProjectionManager;
@@ -40,11 +42,13 @@ import android.car.builtin.util.AssistUtilsHelper.VoiceInteractionSessionShowCal
 import android.car.builtin.util.Slogf;
 import android.car.builtin.view.InputEventHelper;
 import android.car.builtin.view.KeyEventHelper;
+import android.car.feature.Flags;
 import android.car.input.CarInputManager;
 import android.car.input.CustomInputEvent;
 import android.car.input.ICarInput;
 import android.car.input.ICarInputCallback;
 import android.car.input.RotaryEvent;
+import android.car.settings.CarSettings;
 import android.car.user.CarUserManager.UserLifecycleListener;
 import android.car.user.UserLifecycleEventFilter;
 import android.content.ContentResolver;
@@ -800,6 +804,10 @@ public class CarInputService extends ICarInput.Stub
         if (launchBluetoothVoiceRecognition()) {
             return;
         }
+        // TODO(b/352528459): - Add metric capture once refactored out of CarInputService.
+        if (launchBluetoothPairing()) {
+            return;
+        }
         // Finally, fallback to the default voice assist handling.
         launchDefaultVoiceAssistantHandler();
     }
@@ -974,6 +982,51 @@ public class CarInputService extends ICarInput.Stub
         return false;
     }
 
+    private boolean launchBluetoothPairing() {
+       //Check feature flag
+        if (!Flags.carInputStartBtpairingLptt()) {
+            Slogf.d(TAG, "Feature flags not enabled");
+            return false;
+        }
+
+        //Check configuration
+        if (!mContext.getResources().getBoolean(R.bool.config_enableLongPressBluetoothPairing)) {
+            Slogf.d(TAG, "config not enabled");
+            return false;
+        }
+
+        //Check setup wizard in session
+        if (Settings.Secure.getInt(getContentResolverForUser(mContext,
+                UserHandle.CURRENT.getIdentifier()),
+                CarSettings.Secure.KEY_SETUP_WIZARD_IN_PROGRESS, 0) == 1) {
+            Slogf.d(TAG, "Setup wizard in progress. Do not launch BT pairing");
+            return false;
+        }
+
+        //Check BT Connection
+        BluetoothAdapter btAdapter = mContext.
+            getSystemService(BluetoothManager.class).getAdapter();
+        if (btAdapter == null) {
+            Slogf.w(TAG, "Could not get BT adapter. Do not launch BT pairing");
+            return false;
+        }
+        if (btAdapter.getConnectionState() != BluetoothAdapter.STATE_DISCONNECTED) {
+            Slogf.d(TAG, "BT device connected. Do not launch BT pairing");
+            return false;
+        }
+        /*
+         * Do not checking driving state here. If the OEM allows Bluetooth pairing
+         * while driving, their BluetoothSettingsActivity should be optimized for
+         * distraction. If they do not allow it, the BluetoothSettingsActivity should
+         * display a notification informing the driver that Bluetooth pairing
+         * is not allowed while driving.
+         */
+        Slogf.d(TAG, "Voice Assist key long press. Attempting to start Bluetooth Pairing.");
+        Intent intent = new Intent(Settings.ACTION_BLUETOOTH_SETTINGS);
+        mContext.startActivityAsUser(intent, UserHandle.CURRENT);
+        return true;
+    }
+
     private void launchDefaultVoiceAssistantHandler() {
         Slogf.d(TAG, "voice key, invoke AssistUtilsHelper");
 
diff --git a/service/src/com/android/car/CarMediaService.java b/service/src/com/android/car/CarMediaService.java
index 88a470040e..c35286cf23 100644
--- a/service/src/com/android/car/CarMediaService.java
+++ b/service/src/com/android/car/CarMediaService.java
@@ -1134,6 +1134,18 @@ public final class CarMediaService extends ICarMedia.Stub implements CarServiceB
         public void onPlaybackStateChanged(PlaybackState state) {
             savePlaybackState(state, mUserId);
         }
+
+        // Media Controller should be cleared for the active media source,
+        // allowing for its recreation during the next session.
+        @Override
+        public void onSessionDestroyed() {
+            synchronized (mLock) {
+                UserMediaPlayContext userMediaPlayContext = mUserMediaPlayContexts.get(
+                        mUserId, null
+                );
+                clearActiveMediaControllerLocked(userMediaPlayContext);
+            }
+        }
     }
 
     private class SessionChangedListener implements OnActiveSessionsChangedListener {
@@ -1250,7 +1262,10 @@ public final class CarMediaService extends ICarMedia.Stub implements CarServiceB
 
             for (MediaSession.Token token : mCallbacks.keySet()) {
                 if (!updatedCallbacks.containsKey(token)) {
-                    mCallbacks.get(token).unregister();
+                    MediaControllerCallback callback = mCallbacks.get(token);
+                    if (callback != null) {
+                        callback.unregister();
+                    }
                 }
             }
 
@@ -1630,11 +1645,7 @@ public final class CarMediaService extends ICarMedia.Stub implements CarServiceB
         if (userMediaPlayContext.mPrimaryMediaComponents[MEDIA_SOURCE_MODE_PLAYBACK] == null) {
             return;
         }
-        if (userMediaPlayContext.mActiveMediaController != null) {
-            userMediaPlayContext.mActiveMediaController.unregisterCallback(
-                    userMediaPlayContext.mMediaControllerCallback);
-            userMediaPlayContext.mActiveMediaController = null;
-        }
+        clearActiveMediaControllerLocked(userMediaPlayContext);
         for (MediaController controller : mediaControllers) {
             if (matchPrimaryMediaSource(controller.getPackageName(), getClassName(controller),
                     MEDIA_SOURCE_MODE_PLAYBACK, userId)) {
@@ -1652,6 +1663,22 @@ public final class CarMediaService extends ICarMedia.Stub implements CarServiceB
         }
     }
 
+    @GuardedBy("mLock")
+    private void clearActiveMediaControllerLocked(
+            @Nullable UserMediaPlayContext userMediaPlayContext) {
+        if (userMediaPlayContext == null) {
+            Slogf.w(TAG, "Can't clear active media controller, media context is null");
+            return;
+        }
+        if (userMediaPlayContext.mActiveMediaController == null) {
+            Slogf.w(TAG, "Can't clear active media controller, it is null");
+            return;
+        }
+        userMediaPlayContext.mActiveMediaController.unregisterCallback(
+                userMediaPlayContext.mMediaControllerCallback);
+        userMediaPlayContext.mActiveMediaController = null;
+    }
+
     /**
      * Returns whether we should autoplay the current media source
      */
diff --git a/service/src/com/android/car/CarOccupantZoneService.java b/service/src/com/android/car/CarOccupantZoneService.java
index 729055e765..dacba61353 100644
--- a/service/src/com/android/car/CarOccupantZoneService.java
+++ b/service/src/com/android/car/CarOccupantZoneService.java
@@ -19,6 +19,7 @@ package com.android.car;
 import static android.car.builtin.view.DisplayHelper.INVALID_PORT;
 import static android.car.user.CarUserManager.USER_LIFECYCLE_EVENT_TYPE_STOPPING;
 import static android.car.user.CarUserManager.USER_LIFECYCLE_EVENT_TYPE_SWITCHING;
+import static android.view.Display.INVALID_DISPLAY;
 import static android.view.Display.STATE_ON;
 
 import static com.android.car.CarServiceUtils.getHandlerThread;
@@ -73,8 +74,6 @@ import com.android.car.occupantzone.CarOccupantZoneDumpProto.DisplayPortConfigsP
 import com.android.car.occupantzone.CarOccupantZoneDumpProto.DisplayUniqueIdConfigsProto;
 import com.android.car.occupantzone.CarOccupantZoneDumpProto.DisplayUniqueIdConfigsProto.DisplayConfigUniqueIdProto;
 import com.android.car.user.CarUserService;
-import com.android.car.user.ExperimentalCarUserService;
-import com.android.car.user.ExperimentalCarUserService.ZoneUserBindingHelper;
 import com.android.car.user.UserHandleHelper;
 import com.android.internal.annotations.GuardedBy;
 import com.android.internal.annotations.VisibleForTesting;
@@ -224,30 +223,17 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
         handleUserChange();
     };
 
-    final ExperimentalCarUserService.PassengerCallback mPassengerCallback =
-            new ExperimentalCarUserService.PassengerCallback() {
-                @Override
-                public void onPassengerStarted(@UserIdInt int passengerId, int zoneId) {
-                    handlePassengerStarted();
-                }
-
-                @Override
-                public void onPassengerStopped(@UserIdInt int passengerId) {
-                    handlePassengerStopped();
-                }
-            };
-
     @VisibleForTesting
     final DisplayManager.DisplayListener mDisplayListener =
             new DisplayManager.DisplayListener() {
                 @Override
                 public void onDisplayAdded(int displayId) {
-                    handleDisplayChange();
+                    handleDisplayChange(displayId);
                 }
 
                 @Override
                 public void onDisplayRemoved(int displayId) {
-                    handleDisplayChange();
+                    handleDisplayChange(displayId);
                 }
 
                 @Override
@@ -306,80 +292,8 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
                 .addEventType(USER_LIFECYCLE_EVENT_TYPE_SWITCHING).addEventType(
                         USER_LIFECYCLE_EVENT_TYPE_STOPPING).build();
         mCarUserService.addUserLifecycleListener(userEventFilter, mUserLifecycleListener);
-        ExperimentalCarUserService experimentalUserService =
-                CarLocalServices.getService(ExperimentalCarUserService.class);
-        if (experimentalUserService != null) {
-            experimentalUserService.addPassengerCallback(mPassengerCallback);
-        }
         mDisplayManager.registerDisplayListener(mDisplayListener,
                 new Handler(Looper.getMainLooper()));
-        ZoneUserBindingHelper helper = new ZoneUserBindingHelper() {
-            @Override
-            @NonNull
-            public List<OccupantZoneInfo> getOccupantZones(@OccupantTypeEnum int occupantType) {
-                List<OccupantZoneInfo> zones = new ArrayList<OccupantZoneInfo>();
-                for (OccupantZoneInfo ozi : getAllOccupantZones()) {
-                    if (ozi.occupantType == occupantType) {
-                        zones.add(ozi);
-                    }
-                }
-                return zones;
-            }
-
-            @Override
-            public boolean assignUserToOccupantZone(@UserIdInt int userId, int zoneId) {
-                // Check if the user is already assigned to the other zone.
-                synchronized (mLock) {
-                    int userZoneId = getZoneIdForUserIdLocked(userId);
-                    if (userZoneId != OccupantZoneInfo.INVALID_ZONE_ID
-                            && mActiveOccupantConfigs.keyAt(userZoneId) != zoneId) {
-                        Slogf.w(TAG, "Cannot assign user to two different zones simultaneously");
-                        return false;
-                    }
-                    OccupantConfig zoneConfig = mActiveOccupantConfigs.get(zoneId);
-                    if (zoneConfig == null) {
-                        Slogf.w(TAG, "cannot find the zone(%d)", zoneId);
-                        return false;
-                    }
-                    if (zoneConfig.userId != CarOccupantZoneManager.INVALID_USER_ID
-                            && zoneConfig.userId != userId) {
-                        Slogf.w(TAG, "other user already occupies the zone(%d)", zoneId);
-                        return false;
-                    }
-                    zoneConfig.userId = userId;
-                    return true;
-                }
-            }
-
-            @Override
-            public boolean unassignUserFromOccupantZone(@UserIdInt int userId) {
-                synchronized (mLock) {
-                    for (int i = 0; i < mActiveOccupantConfigs.size(); ++i) {
-                        OccupantConfig config = mActiveOccupantConfigs.valueAt(i);
-                        if (config.userId == userId) {
-                            config.userId = CarOccupantZoneManager.INVALID_USER_ID;
-                            break;
-                        }
-                    }
-                    return true;
-                }
-            }
-
-            @Override
-            public boolean isPassengerDisplayAvailable() {
-                for (OccupantZoneInfo ozi : getAllOccupantZones()) {
-                    if (getDisplayForOccupant(ozi.zoneId,
-                            CarOccupantZoneManager.DISPLAY_TYPE_MAIN) != Display.INVALID_DISPLAY
-                            && ozi.occupantType != CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER) {
-                        return true;
-                    }
-                }
-                return false;
-            }
-        };
-        if (experimentalUserService != null) {
-            experimentalUserService.setZoneUserBindingHelper(helper);
-        }
 
         CarServiceHelperWrapper.getInstance().runOnConnection(() -> doSyncWithCarServiceHelper(
                 /* updateDisplay= */ true, /* updateUser= */ true));
@@ -389,11 +303,6 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
     public void release() {
         mDisplayManager.unregisterDisplayListener(mDisplayListener);
         mCarUserService.removeUserLifecycleListener(mUserLifecycleListener);
-        ExperimentalCarUserService experimentalUserService =
-                CarLocalServices.getService(ExperimentalCarUserService.class);
-        if (experimentalUserService != null) {
-            experimentalUserService.removePassengerCallback(mPassengerCallback);
-        }
         synchronized (mLock) {
             mOccupantsConfig.clear();
             mDisplayPortConfigs.clear();
@@ -403,8 +312,15 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
         }
     }
 
-    /** Return cloned mOccupantsConfig for testing */
-    @VisibleForTesting
+    /**
+     * Returns the cloned occupant zone configs as read from the config_occupant_zones RRO config.
+     *
+     * <p><b>Note:</b> If the config_occupant_zones string value is empty, an occupant zone info
+     * will be automatically created for the driver and added to the occupant zone configs as the
+     * sole occupant zone info.
+     *
+     * @return cloned occupant zone configs mapped from occupant zone id to occupant zone info
+     */
     @NonNull
     public SparseArray<OccupantZoneInfo> getOccupantsConfig() {
         synchronized (mLock) {
@@ -825,7 +741,7 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
             //If there are any active displays for the zone send change event
             handleAudioZoneChangesLocked();
         }
-        sendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_AUDIO);
+        syncStateAndSendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_AUDIO);
     }
 
     @GuardedBy("mLock")
@@ -946,7 +862,7 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
             config.userId = userId;
         }
 
-        sendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
+        syncStateAndSendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
         return CarOccupantZoneManager.USER_ASSIGNMENT_RESULT_OK;
     }
 
@@ -998,7 +914,7 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
             if (DBG) Slogf.d(TAG, "Unassigned zone:%d", occupantZoneId);
             config.userId = CarOccupantZoneManager.INVALID_USER_ID;
         }
-        sendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
+        syncStateAndSendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
 
         return CarOccupantZoneManager.USER_ASSIGNMENT_RESULT_OK;
     }
@@ -1641,7 +1557,13 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
         }
     }
 
-    private void sendConfigChangeEvent(int changeFlags) {
+    private void syncStateAndSendConfigChangeEvent(int changeFlags) {
+        // INVALID_DISPLAY is used to indicate that the displayId is not relevant to the change
+        // event.
+        syncStateAndSendConfigChangeEvent(changeFlags, INVALID_DISPLAY);
+    }
+
+    private void syncStateAndSendConfigChangeEvent(int changeFlags, int displayId) {
         boolean updateDisplay = false;
         boolean updateUser = false;
         if ((changeFlags & CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_DISPLAY) != 0) {
@@ -1659,7 +1581,10 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
             for (int i = 0; i < n; i++) {
                 ICarOccupantZoneCallback callback = mClientCallbacks.getBroadcastItem(i);
                 try {
-                    callback.onOccupantZoneConfigChanged(changeFlags);
+                    if (displayId == INVALID_DISPLAY
+                            || getOccupantZoneForDisplayId(displayId) != null) {
+                        callback.onOccupantZoneConfigChanged(changeFlags);
+                    }
                 } catch (RemoteException ignores) {
                     // ignore
                 }
@@ -1674,19 +1599,11 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
             changed = handleUserChangesLocked();
         }
         if (changed) {
-            sendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
+            syncStateAndSendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
         }
     }
 
-    private void handlePassengerStarted() {
-        sendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
-    }
-
-    private void handlePassengerStopped() {
-        sendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
-    }
-
-    private void handleDisplayChange() {
+    private void handleDisplayChange(int displayId) {
         synchronized (mLock) {
             handleActiveDisplaysLocked();
             // Audio zones should be re-checked for changed display
@@ -1694,7 +1611,8 @@ public final class CarOccupantZoneService extends ICarOccupantZone.Stub
             // User should be re-checked for changed displays
             handleUserChangesLocked();
         }
-        sendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_DISPLAY);
+        syncStateAndSendConfigChangeEvent(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_DISPLAY,
+                displayId);
     }
 
     private void enforcePermission(String permissionName) {
diff --git a/service/src/com/android/car/CarProjectionService.java b/service/src/com/android/car/CarProjectionService.java
index 91450cf85e..5a066d95cf 100644
--- a/service/src/com/android/car/CarProjectionService.java
+++ b/service/src/com/android/car/CarProjectionService.java
@@ -18,6 +18,7 @@ package com.android.car;
 import static android.car.CarProjectionManager.ProjectionAccessPointCallback.ERROR_GENERIC;
 import static android.car.projection.ProjectionStatus.PROJECTION_STATE_INACTIVE;
 import static android.car.projection.ProjectionStatus.PROJECTION_STATE_READY_TO_PROJECT;
+import static android.net.wifi.WifiAvailableChannel.OP_MODE_SAP;
 import static android.net.wifi.WifiManager.EXTRA_PREVIOUS_WIFI_AP_STATE;
 import static android.net.wifi.WifiManager.EXTRA_WIFI_AP_FAILURE_REASON;
 import static android.net.wifi.WifiManager.EXTRA_WIFI_AP_INTERFACE_NAME;
@@ -40,6 +41,8 @@ import android.car.ICarProjectionKeyEventHandler;
 import android.car.ICarProjectionStatusListener;
 import android.car.builtin.content.pm.PackageManagerHelper;
 import android.car.builtin.util.Slogf;
+import android.car.feature.FeatureFlags;
+import android.car.feature.FeatureFlagsImpl;
 import android.car.projection.ProjectionOptions;
 import android.car.projection.ProjectionStatus;
 import android.car.projection.ProjectionStatus.ProjectionState;
@@ -71,6 +74,7 @@ import android.os.UserHandle;
 import android.text.TextUtils;
 import android.util.SparseIntArray;
 import android.util.proto.ProtoOutputStream;
+import android.net.wifi.WifiAvailableChannel;
 
 import com.android.car.BinderInterfaceContainer.BinderInterface;
 import com.android.car.bluetooth.CarBluetoothService;
@@ -145,6 +149,8 @@ class CarProjectionService extends ICarProjection.Stub implements CarServiceBase
     @GuardedBy("mLock")
     private @Nullable SoftApConfiguration mApConfiguration;
 
+    private FeatureFlags mFeatureFlags = new FeatureFlagsImpl();
+
     private static final String SHARED_PREF_NAME = "com.android.car.car_projection_service";
     private static final String KEY_AP_CONFIG_SSID = "ap_config_ssid";
     private static final String KEY_AP_CONFIG_BSSID = "ap_config_bssid";
@@ -323,22 +329,37 @@ class CarProjectionService extends ICarProjection.Stub implements CarServiceBase
     @Override
     public int[] getAvailableWifiChannels(int band) {
         CarServiceUtils.assertProjectionPermission(mContext);
-        WifiScanner scanner;
-        synchronized (mLock) {
-            // Lazy initialization
-            if (mWifiScanner == null) {
-                mWifiScanner = mContext.getSystemService(WifiScanner.class);
+        List<Integer> channels;
+
+        // Use {@link WifiManager} to get channels as {@link WifiScanner} fails to retrieve
+        // channels when wifi is off.
+        if (mFeatureFlags.useWifiManagerForAvailableChannels()) {
+            channels = new ArrayList<>();
+            List<WifiAvailableChannel> availableChannels =
+                    mWifiManager.getUsableChannels(band, OP_MODE_SAP);
+            for (int i = 0; i < availableChannels.size(); i++) {
+                WifiAvailableChannel channel = availableChannels.get(i);
+                channels.add(channel.getFrequencyMhz());
             }
-            scanner = mWifiScanner;
-        }
-        if (scanner == null) {
-            Slogf.w(TAG, "Unable to get WifiScanner");
-            return EMPTY_INT_ARRAY;
+        } else {
+            WifiScanner scanner;
+            synchronized (mLock) {
+                // Lazy initialization
+                if (mWifiScanner == null) {
+                    mWifiScanner = mContext.getSystemService(WifiScanner.class);
+                }
+                scanner = mWifiScanner;
+            }
+            if (scanner == null) {
+                Slogf.w(TAG, "Unable to get WifiScanner");
+                return EMPTY_INT_ARRAY;
+            }
+
+            channels = scanner.getAvailableChannels(band);
         }
 
-        List<Integer> channels = scanner.getAvailableChannels(band);
         if (channels == null || channels.isEmpty()) {
-            Slogf.w(TAG, "WifiScanner reported no available channels");
+            Slogf.w(TAG, "No available channels reported");
             return EMPTY_INT_ARRAY;
         }
 
@@ -1082,6 +1103,14 @@ class CarProjectionService extends ICarProjection.Stub implements CarServiceBase
         }
     }
 
+    /**
+     * Sets fake feature flag for unit testing.
+     */
+    @VisibleForTesting
+    public void setFeatureFlags(FeatureFlags fakeFeatureFlags) {
+        mFeatureFlags = fakeFeatureFlags;
+    }
+
     private class ProjectionSoftApCallback implements WifiManager.SoftApCallback {
         private boolean mCurrentStateCall = true;
 
diff --git a/service/src/com/android/car/CarServiceHelperWrapper.java b/service/src/com/android/car/CarServiceHelperWrapper.java
index 1068dd37f6..aba701b693 100644
--- a/service/src/com/android/car/CarServiceHelperWrapper.java
+++ b/service/src/com/android/car/CarServiceHelperWrapper.java
@@ -254,6 +254,30 @@ public final class CarServiceHelperWrapper {
         return UserManagerHelper.USER_NULL;
     }
 
+    /**
+     * See {@code ICarServiceHelper}.
+     */
+    public boolean assignUserToExtraDisplay(int userId, int displayId) {
+        try {
+            return waitForCarServiceHelper().assignUserToExtraDisplay(userId, displayId);
+        } catch (RemoteException e) {
+            Slogf.e(TAG, REMOTE_EXCEPTION_STR, e);
+        }
+        return false;
+    }
+
+    /**
+     * See {@code ICarServiceHelper}.
+     */
+    public boolean unassignUserFromExtraDisplay(int userId, int displayId) {
+        try {
+            return waitForCarServiceHelper().unassignUserFromExtraDisplay(userId, displayId);
+        } catch (RemoteException e) {
+            Slogf.e(TAG, REMOTE_EXCEPTION_STR, e);
+        }
+        return false;
+    }
+
     /**
      * See {@code ICarServiceHelper}.
      */
diff --git a/service/src/com/android/car/CarShellCommand.java b/service/src/com/android/car/CarShellCommand.java
index a2732a501b..f1b73bb8cd 100644
--- a/service/src/com/android/car/CarShellCommand.java
+++ b/service/src/com/android/car/CarShellCommand.java
@@ -62,6 +62,7 @@ import android.car.builtin.widget.LockPatternHelper;
 import android.car.content.pm.CarPackageManager;
 import android.car.drivingstate.CarUxRestrictions;
 import android.car.feature.Flags;
+import android.car.hardware.power.CarPowerPolicy;
 import android.car.input.CarInputManager;
 import android.car.input.CustomInputEvent;
 import android.car.input.RotaryEvent;
@@ -79,6 +80,7 @@ import android.car.user.UserSwitchResult;
 import android.car.util.concurrent.AsyncFuture;
 import android.car.watchdog.CarWatchdogManager;
 import android.car.watchdog.IoOveruseConfiguration;
+import android.car.watchdog.PackageKillableState;
 import android.car.watchdog.PerStateBytes;
 import android.car.watchdog.ResourceOveruseConfiguration;
 import android.content.ComponentName;
@@ -249,6 +251,7 @@ final class CarShellCommand extends BasicShellCommandHandler {
     private static final String COMMAND_APPLY_POWER_POLICY = "apply-power-policy";
     private static final String COMMAND_DEFINE_POWER_POLICY_GROUP = "define-power-policy-group";
     private static final String COMMAND_SET_POWER_POLICY_GROUP = "set-power-policy-group";
+    private static final String COMMAND_GET_CURRENT_POWER_POLICY = "get-current-power-policy";
     private static final String COMMAND_APPLY_CTS_VERIFIER_POWER_OFF_POLICY =
             "apply-cts-verifier-power-off-policy";
     private static final String COMMAND_APPLY_CTS_VERIFIER_POWER_ON_POLICY =
@@ -310,6 +313,8 @@ final class CarShellCommand extends BasicShellCommandHandler {
 
     private static final String COMMAND_GET_DISPLAY_BY_USER = "get-display-by-user";
     private static final String COMMAND_GET_USER_BY_DISPLAY = "get-user-by-display";
+    private static final String COMMAND_ASSIGN_EXTRA_DISPLAY = "assign-extra-display";
+    private static final String COMMAND_UNASSIGN_EXTRA_DISPLAY = "unassign-extra-display";
     private static final String COMMAND_GENERATE_TEST_VENDOR_CONFIGS = "gen-test-vendor-configs";
     private static final String COMMAND_RESTORE_TEST_VENDOR_CONFIGS = "restore-vendor-configs";
 
@@ -365,6 +370,10 @@ final class CarShellCommand extends BasicShellCommandHandler {
                 CREATE_OR_MANAGE_OR_QUERY_USERS_PERMISSIONS);
         USER_BUILD_COMMAND_TO_PERMISSIONS_MAP.put(COMMAND_GET_USER_BY_DISPLAY,
                 CREATE_OR_MANAGE_OR_QUERY_USERS_PERMISSIONS);
+        USER_BUILD_COMMAND_TO_PERMISSIONS_MAP.put(COMMAND_ASSIGN_EXTRA_DISPLAY,
+                CREATE_OR_MANAGE_USERS_PERMISSIONS);
+        USER_BUILD_COMMAND_TO_PERMISSIONS_MAP.put(COMMAND_UNASSIGN_EXTRA_DISPLAY,
+                CREATE_OR_MANAGE_USERS_PERMISSIONS);
     }
 
     // List of commands allowed in user build. All these command should be protected with
@@ -821,7 +830,7 @@ final class CarShellCommand extends BasicShellCommandHandler {
                 COMMAND_GET_USER_AUTH_ASSOCIATION);
         pw.println("\t  Gets the N user authentication values for the N types for the given user");
         pw.println("\t  (or current user when not specified).");
-        pw.println("\t  By defautt it calls CarUserManager, but using --hal-only will call just "
+        pw.println("\t  By default it calls CarUserManager, but using --hal-only will call just "
                 + "UserHalService.");
 
         pw.printf("\t%s [--hal-only] [--user USER_ID] TYPE1 VALUE1 [..TYPE_N VALUE_N]\n",
@@ -876,6 +885,9 @@ final class CarShellCommand extends BasicShellCommandHandler {
         pw.println("\t  Define and apply the cts_verifier_on power policy with "
                 + "--enable WIFI,LOCATION,BLUETOOTH");
 
+        pw.printf("\t%s\n", COMMAND_GET_CURRENT_POWER_POLICY);
+        pw.println("\t  Gets the current power policy.");
+
         pw.printf("\t%s [%s] [%s]\n", COMMAND_POWER_OFF, PARAM_SKIP_GARAGEMODE, PARAM_REBOOT);
         pw.println("\t  Powers off the car.");
 
@@ -968,6 +980,10 @@ final class CarShellCommand extends BasicShellCommandHandler {
         pw.println("\t Gets the display associated to the given user");
         pw.printf("\t%s <DISPLAY>", COMMAND_GET_USER_BY_DISPLAY);
         pw.println("\t Gets the user associated with the given display");
+        pw.printf("\t%s <USER_ID> <DISPLAY_ID>", COMMAND_ASSIGN_EXTRA_DISPLAY);
+        pw.println("\t Assigns the user to the extra display.");
+        pw.printf("\t%s <USER_ID> <DISPLAY_ID>", COMMAND_UNASSIGN_EXTRA_DISPLAY);
+        pw.println("\t Unassigns the user from the extra display.");
 
         pw.printf("\t%s <DISPLAY>", COMMAND_GET_CURRENT_UX_RESTRICTIONS);
         pw.println("\t Gets the current UX restriction on given display. If no display is "
@@ -1450,6 +1466,9 @@ final class CarShellCommand extends BasicShellCommandHandler {
                 return definePowerPolicyGroup(args, writer);
             case COMMAND_SET_POWER_POLICY_GROUP:
                 return setPowerPolicyGroup(args, writer);
+            case COMMAND_GET_CURRENT_POWER_POLICY:
+                getCurrentPowerPolicy(writer);
+                break;
             case COMMAND_APPLY_CTS_VERIFIER_POWER_OFF_POLICY:
                 return applyCtsVerifierPowerOffPolicy(args, writer);
             case COMMAND_APPLY_CTS_VERIFIER_POWER_ON_POLICY:
@@ -1533,6 +1552,12 @@ final class CarShellCommand extends BasicShellCommandHandler {
             case COMMAND_GET_USER_BY_DISPLAY:
                 getUserByDisplay(args, writer);
                 break;
+            case COMMAND_ASSIGN_EXTRA_DISPLAY:
+                assignExtraDisplay(args, writer);
+                break;
+            case COMMAND_UNASSIGN_EXTRA_DISPLAY:
+                unassignExtraDisplay(args, writer);
+                break;
             case COMMAND_GET_CURRENT_UX_RESTRICTIONS:
                 getCurrentUxRestrictions(args, writer);
                 break;
@@ -3216,6 +3241,11 @@ final class CarShellCommand extends BasicShellCommandHandler {
         return RESULT_ERROR;
     }
 
+    private void getCurrentPowerPolicy(IndentingPrintWriter writer) {
+        CarPowerPolicy powerPolicy = mCarPowerManagementService.getCurrentPowerPolicy();
+        writer.printf("Current power policy is: %s", powerPolicy);
+    }
+
     private int applyCtsVerifierPowerPolicy(String policyId, String ops, String cmdName,
             IndentingPrintWriter writer) {
         String[] defArgs = {"define-power-policy", policyId, ops, "WIFI,BLUETOOTH,LOCATION"};
@@ -3653,10 +3683,30 @@ final class CarShellCommand extends BasicShellCommandHandler {
         } else {
             userId = ActivityManager.getCurrentUser();
         }
+
         boolean isKilled = mCarWatchdogService.performResourceOveruseKill(packageName, userId);
         if (isKilled) {
             writer.printf("Successfully killed package '%s' for user %d\n", packageName, userId);
         } else {
+            UserHandle userHandle = UserHandle.of(userId);
+            List<PackageKillableState> packageKillableStates =
+                    mCarWatchdogService.getPackageKillableStatesAsUser(userHandle);
+
+            for (int i = 0; i < packageKillableStates.size(); i++) {
+                PackageKillableState state = packageKillableStates.get(i);
+                if (packageName.equals(state.getPackageName())) {
+                    int killableState = state.getKillableState();
+                    if (killableState != PackageKillableState.KILLABLE_STATE_YES) {
+                        String stateName =
+                                PackageKillableState.killableStateToString(killableState);
+                        writer.printf("Failed to kill package '%s' for user %d because the "
+                                + "package has state '%s'\n", packageName, userId, stateName);
+                        return;
+                    }
+                    break;
+                }
+            }
+
             writer.printf("Failed to kill package '%s' for user %d\n", packageName, userId);
         }
     }
@@ -4380,6 +4430,58 @@ final class CarShellCommand extends BasicShellCommandHandler {
         writer.println(userId);
     }
 
+    private void assignExtraDisplay(String[] args, IndentingPrintWriter writer) {
+        assignOrUnassignExtraDisplay(args, writer, true);
+    }
+
+    private void unassignExtraDisplay(String[] args, IndentingPrintWriter writer) {
+        assignOrUnassignExtraDisplay(args, writer, false);
+    }
+
+    private void assignOrUnassignExtraDisplay(
+            String[] args, IndentingPrintWriter writer, boolean assign) {
+        if (args.length != 3) {
+            showInvalidArguments(writer);
+            return;
+        }
+
+        int userId;
+        if (Objects.equals(args[1], "current") || Objects.equals(args[1], "cur")) {
+            userId = ActivityManager.getCurrentUser();
+        } else {
+            try {
+                userId = Integer.parseInt(args[1]);
+            } catch (NumberFormatException e) {
+                writer.printf("Invalid userId provided: %s\n", args[1]);
+                return;
+            }
+        }
+        int displayId;
+        try {
+            displayId = Integer.parseInt(args[2]);
+        } catch (NumberFormatException e) {
+            writer.printf("Invalid displayId provided: %s\n", args[2]);
+            return;
+        }
+
+        boolean success;
+        if (assign) {
+            success = CarServiceHelperWrapper.getInstance()
+                    .assignUserToExtraDisplay(userId, displayId);
+        } else {
+            success = CarServiceHelperWrapper.getInstance()
+                    .unassignUserFromExtraDisplay(userId, displayId);
+        }
+        if (success) {
+            writer.printf("Successfully %sassigned user %d %s display %d.\n",
+                    (assign ? "" : "un"), userId, (assign ? "to" : "from"), displayId);
+        } else {
+            writer.printf("Failed to %sassign user %d %s display %d.\n",
+                    (assign ? "" : "un"), userId, (assign ? "to" : "from"), displayId);
+
+        }
+    }
+
     private static boolean isPropertyAreaTypeGlobal(int propertyId) {
         return (propertyId & VehicleArea.MASK) == VehicleArea.GLOBAL;
     }
diff --git a/service/src/com/android/car/CarStorageMonitoringService.java b/service/src/com/android/car/CarStorageMonitoringService.java
index aa32ccef5f..8a5d440503 100644
--- a/service/src/com/android/car/CarStorageMonitoringService.java
+++ b/service/src/com/android/car/CarStorageMonitoringService.java
@@ -55,6 +55,7 @@ import com.android.car.systeminterface.SystemInterface;
 import com.android.car.util.SlidingWindow;
 import com.android.car.util.SparseArrayStream;
 import com.android.internal.annotations.GuardedBy;
+import com.android.internal.annotations.VisibleForTesting;
 
 import org.json.JSONArray;
 import org.json.JSONException;
@@ -96,9 +97,15 @@ public class CarStorageMonitoringService extends ICarStorageMonitoring.Stub
 
     private static final int MIN_WEAR_ESTIMATE_OF_CONCERN = 80;
 
-    static final String UPTIME_TRACKER_FILENAME = "service_uptime";
-    static final String WEAR_INFO_FILENAME = "wear_info";
-    static final String LIFETIME_WRITES_FILENAME = "lifetime_write";
+    // uptime tracker filename.
+    @VisibleForTesting
+    public static final String UPTIME_TRACKER_FILENAME = "service_uptime";
+    // wear info filename.
+    @VisibleForTesting
+    public static final String WEAR_INFO_FILENAME = "wear_info";
+    // lifetime writes filename.
+    @VisibleForTesting
+    public static final String LIFETIME_WRITES_FILENAME = "lifetime_write";
 
     private final WearInformationProvider[] mWearInformationProviders;
     private final Context mContext;
diff --git a/service/src/com/android/car/ICarImpl.java b/service/src/com/android/car/ICarImpl.java
index 463f34ca65..867daa6b9c 100644
--- a/service/src/com/android/car/ICarImpl.java
+++ b/service/src/com/android/car/ICarImpl.java
@@ -94,7 +94,6 @@ import com.android.car.systemui.keyguard.ExperimentalCarKeyguardService;
 import com.android.car.telemetry.CarTelemetryService;
 import com.android.car.user.CarUserNoticeService;
 import com.android.car.user.CarUserService;
-import com.android.car.user.ExperimentalCarUserService;
 import com.android.car.vms.VmsBrokerService;
 import com.android.car.watchdog.CarWatchdogService;
 import com.android.car.wifi.CarWifiService;
@@ -158,8 +157,6 @@ public class ICarImpl extends ICar.Stub {
     private final CarMediaService mCarMediaService;
     private final CarUserService mCarUserService;
     @Nullable
-    private final ExperimentalCarUserService mExperimentalCarUserService;
-    @Nullable
     private final ExperimentalCarKeyguardService mExperimentalCarKeyguardService;
     private final CarOccupantZoneService mCarOccupantZoneService;
     private final CarUserNoticeService mCarUserNoticeService;
@@ -279,13 +276,6 @@ public class ICarImpl extends ICar.Stub {
             priorityInit();
         }
 
-        if (mFeatureController.isFeatureEnabled(Car.EXPERIMENTAL_CAR_USER_SERVICE)) {
-            mExperimentalCarUserService = constructWithTrace(t, ExperimentalCarUserService.class,
-                    () -> new ExperimentalCarUserService(mContext, mCarUserService,
-                            userManager), allServices);
-        } else {
-            mExperimentalCarUserService = null;
-        }
         if (mFeatureController.isFeatureEnabled(Car.EXPERIMENTAL_CAR_KEYGUARD_SERVICE)) {
             mExperimentalCarKeyguardService = constructWithTrace(t,
                         ExperimentalCarKeyguardService.class,
@@ -669,8 +659,6 @@ public class ICarImpl extends ICar.Stub {
                 return mCarBugreportManagerService;
             case Car.CAR_USER_SERVICE:
                 return mCarUserService;
-            case Car.EXPERIMENTAL_CAR_USER_SERVICE:
-                return mExperimentalCarUserService;
             case Car.EXPERIMENTAL_CAR_KEYGUARD_SERVICE:
                 return mExperimentalCarKeyguardService;
             case Car.CAR_WATCHDOG_SERVICE:
diff --git a/service/src/com/android/car/admin/CarDevicePolicyService.java b/service/src/com/android/car/admin/CarDevicePolicyService.java
index 94ffe39aa7..a9062f4c52 100644
--- a/service/src/com/android/car/admin/CarDevicePolicyService.java
+++ b/service/src/com/android/car/admin/CarDevicePolicyService.java
@@ -231,6 +231,7 @@ public final class CarDevicePolicyService extends ICarDevicePolicyService.Stub
      */
     @Override
     public void setUserDisclaimerAcknowledged(int userId) {
+        enforcePermission();
         setUserDisclaimerStatus(userId, NEW_USER_DISCLAIMER_STATUS_ACKED);
         UserHandle user = UserHandle.of(userId);
         BuiltinPackageDependency.createNotificationHelper(mCarServiceBuiltinPackageContext)
@@ -276,4 +277,16 @@ public final class CarDevicePolicyService extends ICarDevicePolicyService.Stub
         return DebugUtils.constantToString(CarDevicePolicyService.class,
                 PREFIX_NEW_USER_DISCLAIMER_STATUS, status);
     }
+
+    private void enforcePermission() {
+        if (mContext.checkCallingOrSelfPermission(android.Manifest.permission.MANAGE_USERS)
+                != PackageManager.PERMISSION_GRANTED
+                &&
+                mContext.checkCallingOrSelfPermission(
+                    android.Manifest.permission.INTERACT_ACROSS_USERS)
+                != PackageManager.PERMISSION_GRANTED) {
+            throw new SecurityException(
+                "Requires MANAGE_USERS or INTERACT_ACROSS_USERS permissions");
+        }
+    }
 }
diff --git a/service/src/com/android/car/am/CarActivityService.java b/service/src/com/android/car/am/CarActivityService.java
index b036d4e082..b1ab2ad525 100644
--- a/service/src/com/android/car/am/CarActivityService.java
+++ b/service/src/com/android/car/am/CarActivityService.java
@@ -67,6 +67,7 @@ import com.android.car.CarServiceHelperWrapper;
 import com.android.car.CarServiceUtils;
 import com.android.car.R;
 import com.android.car.SystemActivityMonitoringService;
+import com.android.car.internal.dep.Trace;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.util.IndentingPrintWriter;
 import com.android.internal.annotations.GuardedBy;
@@ -131,11 +132,11 @@ public final class CarActivityService extends ICarActivityService.Stub
         void onActivityCameOnTop(TaskInfo topTask);
 
         /**
-         * Notify change or vanish of an activity in the backstack.
+         * Notify vanish of an activity or task in the backstack.
          *
-         * @param taskInfo task information for what is currently changed or vanished.
+         * @param taskInfo task information for what is currently vanished.
          */
-        void onActivityChangedInBackstack(TaskInfo taskInfo);
+        void onTaskVanished(TaskInfo taskInfo);
     }
 
     @GuardedBy("mLock")
@@ -169,14 +170,20 @@ public final class CarActivityService extends ICarActivityService.Stub
     @Override
     public int setPersistentActivity(ComponentName activity, int displayId, int featureId) throws
             RemoteException {
-        ensurePermission(Car.PERMISSION_CONTROL_CAR_APP_LAUNCH);
-        int caller = getCaller();
-        if (caller != UserManagerHelper.USER_SYSTEM && caller != ActivityManager.getCurrentUser()) {
-            return CarActivityManager.RESULT_INVALID_USER;
-        }
+        try {
+            Trace.beginSection("CarActivityService-setPersistentActivityOnDisplay: " + displayId);
+            ensurePermission(Car.PERMISSION_CONTROL_CAR_APP_LAUNCH);
+            int caller = getCaller();
+            if (caller != UserManagerHelper.USER_SYSTEM
+                    && caller != ActivityManager.getCurrentUser()) {
+                return CarActivityManager.RESULT_INVALID_USER;
+            }
 
-        return CarServiceHelperWrapper.getInstance().setPersistentActivity(activity, displayId,
-                featureId);
+            return CarServiceHelperWrapper.getInstance()
+                    .setPersistentActivity(activity, displayId, featureId);
+        } finally {
+            Trace.endSection();
+        }
     }
 
     @Override
@@ -218,6 +225,7 @@ public final class CarActivityService extends ICarActivityService.Stub
     public void registerTaskMonitor(IBinder token) {
         if (DBG) Slogf.d(TAG, "registerTaskMonitor: %s", token);
         ensureManageActivityTasksPermission();
+        Trace.beginSection("CarActivityService-registerTaskMonitorByToken: " + token);
 
         IBinder.DeathRecipient deathRecipient = new IBinder.DeathRecipient() {
             @Override
@@ -231,6 +239,7 @@ public final class CarActivityService extends ICarActivityService.Stub
             } catch (RemoteException e) {
                 // 'token' owner might be dead already.
                 Slogf.e(TAG, "failed to linkToDeath: %s", token);
+                Trace.endSection();
                 return;
             }
             mMonitorTokens.put(token, deathRecipient);
@@ -239,6 +248,7 @@ public final class CarActivityService extends ICarActivityService.Stub
             // in the system again. So drops the old status.
             mTasks.clear();
         }
+        Trace.endSection();
     }
 
     /** Ensure permission is granted. */
@@ -254,6 +264,7 @@ public final class CarActivityService extends ICarActivityService.Stub
     }
 
     private void cleanUpMonitorToken(IBinder token) {
+        Trace.beginSection("CarActivityService-cleanUpMonitorToken: " + token);
         synchronized (mLock) {
             if (mCurrentMonitor == token) {
                 mCurrentMonitor = null;
@@ -263,17 +274,20 @@ public final class CarActivityService extends ICarActivityService.Stub
                 token.unlinkToDeath(deathRecipient, /* flags= */ 0);
             }
         }
+        Trace.endSection();
     }
 
     @Override
     public void onTaskAppeared(IBinder token,
             ActivityManager.RunningTaskInfo taskInfo, SurfaceControl leash) {
+        Trace.beginSection("CarActivityService-onTaskAppeared: " + taskInfo.taskId);
         if (DBG) {
             Slogf.d(TAG, "onTaskAppeared: %s, %s", token, TaskInfoHelper.toString(taskInfo));
         }
         ensureManageActivityTasksPermission();
         synchronized (mLock) {
             if (!isAllowedToUpdateLocked(token)) {
+                Trace.endSection();
                 return;
             }
             mTasks.put(taskInfo.taskId, taskInfo);
@@ -284,22 +298,27 @@ public final class CarActivityService extends ICarActivityService.Stub
         if (TaskInfoHelper.isVisible(taskInfo)) {
             mHandler.post(() -> notifyActivityCameOnTop(taskInfo));
         }
+        Trace.endSection();
     }
 
     private void notifyActivityCameOnTop(TaskInfo taskInfo) {
+        Trace.beginSection("CarActivityService-notifyActivityCameOnTop: " + taskInfo.taskId);
         synchronized (mLock) {
             for (int i = 0, size = mActivityListeners.size(); i < size; ++i) {
                 mActivityListeners.get(i).onActivityCameOnTop(taskInfo);
             }
         }
+        Trace.endSection();
     }
 
-    private void notifyActivityChangedInBackStack(TaskInfo taskInfo) {
+    private void notifyTaskVanished(TaskInfo taskInfo) {
+        Trace.beginSection("CarActivityService-notifyTaskVanished: " + taskInfo.taskId);
         synchronized (mLock) {
             for (int i = 0, size = mActivityListeners.size(); i < size; ++i) {
-                mActivityListeners.get(i).onActivityChangedInBackstack(taskInfo);
+                mActivityListeners.get(i).onTaskVanished(taskInfo);
             }
         }
+        Trace.endSection();
     }
 
     @GuardedBy("mLock")
@@ -321,8 +340,11 @@ public final class CarActivityService extends ICarActivityService.Stub
             Slogf.d(TAG, "onTaskVanished: %s, %s", token, TaskInfoHelper.toString(taskInfo));
         }
         ensureManageActivityTasksPermission();
+        Trace.beginSection(
+                "CarActivityService-onTaskVanished: " + taskInfo.taskId + "-byToken: " + token);
         synchronized (mLock) {
             if (!isAllowedToUpdateLocked(token)) {
+                Trace.endSection();
                 return;
             }
             // Do not remove the taskInfo from the mLastKnownDisplayIdForTask array since when
@@ -331,8 +353,9 @@ public final class CarActivityService extends ICarActivityService.Stub
             // mLastKnownDisplayIdForTask come in sync when the blocking ui is finished.
             mTasks.remove(taskInfo.taskId);
             mTaskToSurfaceMap.remove(taskInfo.taskId);
-            mHandler.post(() -> notifyActivityChangedInBackStack(taskInfo));
+            mHandler.post(() -> notifyTaskVanished(taskInfo));
         }
+        Trace.endSection();
     }
 
     @Override
@@ -341,8 +364,11 @@ public final class CarActivityService extends ICarActivityService.Stub
             Slogf.d(TAG, "onTaskInfoChanged: %s, %s", token, TaskInfoHelper.toString(taskInfo));
         }
         ensureManageActivityTasksPermission();
+        Trace.beginSection(
+                "CarActivityService-onTaskInfoChanged: " + taskInfo.taskId + "-byToken: " + token);
         synchronized (mLock) {
             if (!isAllowedToUpdateLocked(token)) {
+                Trace.endSection();
                 return;
             }
             // The key should be removed and added again so that it jumps to the front of the
@@ -353,10 +379,9 @@ public final class CarActivityService extends ICarActivityService.Stub
                     || !Objects.equals(oldTaskInfo.topActivity, taskInfo.topActivity))
                     && TaskInfoHelper.isVisible(taskInfo)) {
                 mHandler.post(() -> notifyActivityCameOnTop(taskInfo));
-            } else {
-                mHandler.post(() -> notifyActivityChangedInBackStack(taskInfo));
             }
         }
+        Trace.endSection();
     }
 
     @Override
@@ -400,16 +425,21 @@ public final class CarActivityService extends ICarActivityService.Stub
 
     @Override
     public void startUserPickerOnDisplay(int displayId) {
-        CarServiceUtils.assertAnyPermission(mContext, INTERACT_ACROSS_USERS);
-        Preconditions.checkArgument(displayId != Display.INVALID_DISPLAY, "Invalid display");
-        String userPickerName = mContext.getResources().getString(
-                R.string.config_userPickerActivity);
-        if (userPickerName.isEmpty()) {
-            Slogf.w(TAG, "Cannot launch user picker to display %d, component not specified",
-                    displayId);
-            return;
+        try {
+            Trace.beginSection("CarActivityService-startUserPickerOnDisplay: " + displayId);
+            CarServiceUtils.assertAnyPermission(mContext, INTERACT_ACROSS_USERS);
+            Preconditions.checkArgument(displayId != Display.INVALID_DISPLAY, "Invalid display");
+            String userPickerName =
+                    mContext.getResources().getString(R.string.config_userPickerActivity);
+            if (userPickerName.isEmpty()) {
+                Slogf.w(TAG, "Cannot launch user picker to display %d, component not specified",
+                        displayId);
+                return;
+            }
+            CarServiceUtils.startUserPickerOnDisplay(mContext, displayId, userPickerName);
+        } finally {
+            Trace.endSection();
         }
-        CarServiceUtils.startUserPickerOnDisplay(mContext, displayId, userPickerName);
     }
 
     private abstract class MirroringToken extends Binder {
@@ -490,13 +520,18 @@ public final class CarActivityService extends ICarActivityService.Stub
 
     @Override
     public IBinder createTaskMirroringToken(int taskId) {
-        ensureManageActivityTasksPermission();
-        synchronized (mLock) {
-            if (!mTaskToSurfaceMap.contains(taskId)) {
-                throw new IllegalArgumentException("Non-existent Task#" + taskId);
+        try {
+            Trace.beginSection("CarActivityService-createMirroringTokenForTask: " + taskId);
+            ensureManageActivityTasksPermission();
+            synchronized (mLock) {
+                if (!mTaskToSurfaceMap.contains(taskId)) {
+                    throw new IllegalArgumentException("Non-existent Task#" + taskId);
+                }
             }
+            return new TaskMirroringToken(taskId);
+        } finally {
+            Trace.endSection();
         }
-        return new TaskMirroringToken(taskId);
     }
 
     @Override
@@ -527,8 +562,10 @@ public final class CarActivityService extends ICarActivityService.Stub
             Slogf.d(TAG, "registerCarSystemUIProxy %s", carSystemUIProxy.toString());
         }
         ensurePermission(PERMISSION_REGISTER_CAR_SYSTEM_UI_PROXY);
+        Trace.beginSection("CarActivityService-registerCarSystemUIProxy");
         synchronized (mLock) {
             if (mCarSystemUIProxy != null) {
+                Trace.endSection();
                 throw new UnsupportedOperationException("Car system UI proxy is already "
                         + "registered");
             }
@@ -548,6 +585,7 @@ public final class CarActivityService extends ICarActivityService.Stub
                 }, /* flags= */0);
             } catch (RemoteException remoteException) {
                 mCarSystemUIProxy = null;
+                Trace.endSection();
                 throw new IllegalStateException("Linking to binder death failed for "
                         + "ICarSystemUIProxy, the System UI might already died", remoteException);
             }
@@ -571,6 +609,7 @@ public final class CarActivityService extends ICarActivityService.Stub
             }
             mCarSystemUIProxyCallbacks.finishBroadcast();
         }
+        Trace.endSection();
     }
 
     @Override
@@ -586,6 +625,7 @@ public final class CarActivityService extends ICarActivityService.Stub
             Slogf.d(TAG, "addCarSystemUIProxyCallback %s", callback.toString());
         }
         ensurePermission(PERMISSION_MANAGE_CAR_SYSTEM_UI);
+        Trace.beginSection("CarActivityService-addCarSystemUIProxyCallback");
         synchronized (mLock) {
             boolean alreadyExists = mCarSystemUIProxyCallbacks.unregister(callback);
             mCarSystemUIProxyCallbacks.register(callback);
@@ -594,6 +634,7 @@ public final class CarActivityService extends ICarActivityService.Stub
                 // Do not trigger onConnected() if the callback already exists because it is either
                 // already called or will be called when the mCarSystemUIProxy is registered.
                 Slogf.d(TAG, "Callback exists already, skip calling onConnected()");
+                Trace.endSection();
                 return;
             }
 
@@ -603,6 +644,7 @@ public final class CarActivityService extends ICarActivityService.Stub
                     Slogf.d(TAG, "Callback stored locally, car system ui proxy not "
                             + "registered.");
                 }
+                Trace.endSection();
                 return;
             }
             try {
@@ -611,6 +653,7 @@ public final class CarActivityService extends ICarActivityService.Stub
                 Slogf.e(TAG, "Error when dispatching onConnected", remoteException);
             }
         }
+        Trace.endSection();
     }
 
     @Override
@@ -634,30 +677,35 @@ public final class CarActivityService extends ICarActivityService.Stub
      * @param taskId id of task to be restarted.
      */
     public void restartTask(int taskId) {
-        TaskInfo task;
-        synchronized (mLock) {
-            task = mTasks.get(taskId);
-        }
-        if (task == null) {
-            Slogf.e(CarLog.TAG_AM, "Could not find root activity with task id " + taskId);
-            return;
-        }
-
-        Intent intent = (Intent) task.baseIntent.clone();
-        // Remove the task the root activity is running in and start it in a new task.
-        // This effectively leads to restarting of the root activity and removal all the other
-        // activities in the task.
-        // FLAG_ACTIVITY_CLEAR_TASK was being used earlier, but it has the side effect where the
-        // last activity in the existing task is visible for a moment until the root activity is
-        // started again.
-        ActivityManagerHelper.removeTask(taskId);
-        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
+        try {
+            Trace.beginSection("CarActivityService-restartTask: " + taskId);
+            TaskInfo task;
+            synchronized (mLock) {
+                task = mTasks.get(taskId);
+            }
+            if (task == null) {
+                Slogf.e(CarLog.TAG_AM, "Could not find root activity with task id " + taskId);
+                return;
+            }
 
-        int userId = TaskInfoHelper.getUserId(task);
-        if (Slogf.isLoggable(CarLog.TAG_AM, Log.INFO)) {
-            Slogf.i(CarLog.TAG_AM, "restarting root activity with user id " + userId);
+            Intent intent = (Intent) task.baseIntent.clone();
+            // Remove the task the root activity is running in and start it in a new task.
+            // This effectively leads to restarting of the root activity and removal all the other
+            // activities in the task.
+            // FLAG_ACTIVITY_CLEAR_TASK was being used earlier, but it has the side effect where the
+            // last activity in the existing task is visible for a moment until the root activity is
+            // started again.
+            ActivityManagerHelper.removeTask(taskId);
+            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
+
+            int userId = TaskInfoHelper.getUserId(task);
+            if (Slogf.isLoggable(CarLog.TAG_AM, Log.INFO)) {
+                Slogf.i(CarLog.TAG_AM, "restarting root activity with user id " + userId);
+            }
+            mContext.startActivityAsUser(intent, UserHandle.of(userId));
+        } finally {
+            Trace.endSection();
         }
-        mContext.startActivityAsUser(intent, UserHandle.of(userId));
     }
 
     public TaskInfo getTaskInfoForTopActivity(ComponentName activity) {
@@ -687,6 +735,8 @@ public final class CarActivityService extends ICarActivityService.Stub
     private void handleBlockActivity(TaskInfo currentTask, Intent newActivityIntent) {
         int displayId = newActivityIntent.getIntExtra(BLOCKING_INTENT_EXTRA_DISPLAY_ID,
                 Display.DEFAULT_DISPLAY);
+        Trace.beginSection(
+                "CarActivityService-blockTask: " + currentTask.taskId + "-onDisplay: " + displayId);
         if (Slogf.isLoggable(CarLog.TAG_AM, Log.DEBUG)) {
             Slogf.d(CarLog.TAG_AM, "Launching blocking activity on display: " + displayId);
         }
@@ -696,9 +746,14 @@ public final class CarActivityService extends ICarActivityService.Stub
         // Starts ABA as User 0 consistenly since the target apps can be any users (User 0 -
         // UserPicker, Driver/Passegners - general NDO apps) and launching ABA as passengers
         // have some issue (b/294447050).
-        mContext.startActivity(newActivityIntent, options.toBundle());
-        // Now make stack with new activity focused.
-        findTaskAndGrantFocus(newActivityIntent.getComponent());
+        try {
+             mContext.startActivity(newActivityIntent, options.toBundle());
+            // Now make stack with new activity focused.
+            findTaskAndGrantFocus(newActivityIntent.getComponent());
+        } catch (SecurityException e) {
+            Slogf.e(CarLog.TAG_AM, "cannot start the activity on display(" + displayId + ")", e);
+        }
+        Trace.endSection();
     }
 
     private void findTaskAndGrantFocus(ComponentName activity) {
diff --git a/service/src/com/android/car/audio/AudioManagerWrapper.java b/service/src/com/android/car/audio/AudioManagerWrapper.java
index 43b14a1f48..5989683da3 100644
--- a/service/src/com/android/car/audio/AudioManagerWrapper.java
+++ b/service/src/com/android/car/audio/AudioManagerWrapper.java
@@ -187,6 +187,10 @@ public final class AudioManagerWrapper {
         return mAudioManager.getStreamVolume(stream);
     }
 
+    boolean isStreamMute(int stream) {
+        return mAudioManager.isStreamMute(stream);
+    }
+
     void setParameters(String parameters) {
         mAudioManager.setParameters(parameters);
     }
@@ -195,6 +199,10 @@ public final class AudioManagerWrapper {
         return mAudioManager.getDevices(flags);
     }
 
+    List<AudioDeviceInfo> getAudioDevicesForAttributes(AudioAttributes attributes) {
+        return mAudioManager.getAudioDevicesForAttributes(attributes);
+    }
+
     void registerAudioPlaybackCallback(AudioPlaybackCallback callback, @Nullable Handler handler) {
         mAudioManager.registerAudioPlaybackCallback(callback, handler);
     }
diff --git a/service/src/com/android/car/audio/CarAudioService.java b/service/src/com/android/car/audio/CarAudioService.java
index cf5876f617..9e5ce4d202 100644
--- a/service/src/com/android/car/audio/CarAudioService.java
+++ b/service/src/com/android/car/audio/CarAudioService.java
@@ -169,6 +169,7 @@ import java.util.Map;
 import java.util.Objects;
 import java.util.Set;
 import java.util.concurrent.Executor;
+import java.util.stream.Collectors;
 
 /**
  * Service responsible for interaction with car's audio system.
@@ -218,11 +219,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     private final TelephonyManager mTelephonyManager;
     private final AudioManagerWrapper mAudioManagerWrapper;
     private final boolean mUseDynamicRouting;
-    private final boolean mUseCoreAudioVolume;
-    private final boolean mUseCoreAudioRouting;
     private final boolean mUseCarVolumeGroupEvents;
-    private final boolean mUseCarVolumeGroupMuting;
-    private final boolean mUseHalDuckingSignals;
     private final boolean mUseMinMaxActivationVolume;
     private final boolean mUseIsolatedFocusForDynamicDevices;
     private final boolean mUseKeyEventsForDynamicDevices;
@@ -258,6 +255,14 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     private @Nullable CarAudioPlaybackMonitor mCarAudioPlaybackMonitor;
     @GuardedBy("mImplLock")
     private boolean mIsAudioServerDown;
+    @GuardedBy("mImplLock")
+    private boolean mUseCoreAudioVolume;
+    @GuardedBy("mImplLock")
+    private boolean mUseCoreAudioRouting;
+    @GuardedBy("mImplLock")
+    private boolean mUseCarVolumeGroupMuting;
+    @GuardedBy("mImplLock")
+    private boolean mUseHalDuckingSignals;
 
 
     /**
@@ -438,7 +443,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
         mUseCarVolumeGroupEvents = !runInLegacyMode() && mContext.getResources().getBoolean(
                 R.bool.audioUseCarVolumeGroupEvent);
         mUseCarVolumeGroupMuting = useCarVolumeGroupMuting;
-        mPersistMasterMuteState = !mUseCarVolumeGroupMuting && mContext.getResources().getBoolean(
+        mPersistMasterMuteState = mContext.getResources().getBoolean(
                 R.bool.audioPersistMasterMuteState);
         mUseFadeManagerConfiguration = enableFadeManagerConfiguration()
                 && carAudioFadeManagerConfiguration()
@@ -530,11 +535,11 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     }
 
     private void restoreMasterMuteState() {
-        if (mUseCarVolumeGroupMuting) {
+        if (useCarVolumeGroupMuting()) {
             return;
         }
         // Restore master mute state if applicable
-        if (mPersistMasterMuteState) {
+        if (persistMasterMuteState()) {
             boolean storedMasterMute = mCarAudioSettings.isMasterMute();
             setMasterMute(storedMasterMute, 0);
         }
@@ -707,7 +712,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
             writer.printf("Rely on core audio for volume? %b\n", mUseCoreAudioVolume);
             writer.printf("Rely on core audio for routing? %b\n",  mUseCoreAudioRouting);
             writer.printf("Audio Patch APIs enabled? %b\n", areAudioPatchAPIsEnabled());
-            writer.printf("Persist master mute state? %b\n", mPersistMasterMuteState);
+            writer.printf("Persist master mute state? %b\n", persistMasterMuteState());
             writer.printf("Use hal ducking signals? %b\n", mUseHalDuckingSignals);
             writer.printf("Volume key event timeout ms: %d\n", mKeyEventTimeoutMs);
             if (mCarAudioConfigurationPath != null) {
@@ -832,7 +837,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
             proto.write(CarAudioConfiguration.USE_CORE_AUDIO_VOLUME, mUseCoreAudioVolume);
             proto.write(CarAudioConfiguration.USE_CORE_AUDIO_ROUTING, mUseCoreAudioRouting);
             proto.write(CarAudioConfiguration.PATCH_API_ENABLED, areAudioPatchAPIsEnabled());
-            proto.write(CarAudioConfiguration.PERSIST_MASTER_MUTE_STATE, mPersistMasterMuteState);
+            proto.write(CarAudioConfiguration.PERSIST_MASTER_MUTE_STATE, persistMasterMuteState());
             proto.write(CarAudioConfiguration.USE_HAL_DUCKING_SIGNALS, mUseHalDuckingSignals);
             proto.write(CarAudioConfiguration.KEY_EVENT_TIMEOUT_MS, mKeyEventTimeoutMs);
             if (mCarAudioConfigurationPath != null) {
@@ -916,7 +921,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
             case AUDIO_FEATURE_DYNAMIC_ROUTING:
                 return !runInLegacyMode();
             case AUDIO_FEATURE_VOLUME_GROUP_MUTING:
-                return mUseCarVolumeGroupMuting;
+                return useCarVolumeGroupMuting();
             case AUDIO_FEATURE_OEM_AUDIO_SERVICE:
                 return isAnyOemFeatureEnabled();
             case AUDIO_FEATURE_VOLUME_GROUP_EVENTS:
@@ -931,6 +936,16 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
         }
     }
 
+    private boolean useCarVolumeGroupMuting() {
+        synchronized (mImplLock) {
+            return mUseCarVolumeGroupMuting;
+        }
+    }
+
+    private boolean persistMasterMuteState() {
+        return !useCarVolumeGroupMuting() && mPersistMasterMuteState;
+    }
+
     private boolean isAnyOemFeatureEnabled() {
         CarOemProxyService proxy = CarLocalServices.getService(CarOemProxyService.class);
 
@@ -1023,7 +1038,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     }
 
     private void handleMuteChanged(int zoneId, int groupId, int flags) {
-        if (!mUseCarVolumeGroupMuting) {
+        if (!useCarVolumeGroupMuting()) {
             return;
         }
         callbackGroupMuteChanged(zoneId, groupId, flags);
@@ -1053,7 +1068,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
         mCarVolumeCallbackHandler.onMasterMuteChanged(zoneId, flags);
 
         // Persists master mute state if applicable
-        if (mPersistMasterMuteState) {
+        if (persistMasterMuteState()) {
             mCarAudioSettings.storeMasterMute(mAudioManagerWrapper.isMasterMuted());
         }
     }
@@ -1848,17 +1863,52 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
                     mServiceEventLogger, mUseCarVolumeGroupMuting, mUseCoreAudioVolume,
                     mUseCoreAudioRouting, mUseFadeManagerConfiguration,
                     mCarAudioFadeConfigurationHelper);
-            mAudioZoneIdToOccupantZoneIdMapping =
-                    zonesHelper.getCarAudioZoneIdToOccupantZoneIdMapping();
             SparseArray<CarAudioZone> zones = zonesHelper.loadAudioZones();
+            mAudioZoneIdToOccupantZoneIdMapping = getValidAudioZoneIdToOccupantZoneId(
+                    zonesHelper.getCarAudioZoneIdToOccupantZoneIdMapping());
             mCarAudioMirrorRequestHandler.setMirrorDeviceInfos(zonesHelper.getMirrorDeviceInfos());
-            mCarAudioContext = zonesHelper.getCarAudioContext();
+            updateConfigValueFromZoneHelperLocked(zonesHelper);
             return zones;
         } catch (IOException | XmlPullParserException e) {
             throw new RuntimeException("Failed to parse audio zone configuration", e);
         }
     }
 
+
+    private SparseIntArray getValidAudioZoneIdToOccupantZoneId(
+            SparseIntArray carAudioZoneIdToOccupantZoneIdMapping) {
+        if (!Flags.audioVendorFreezeImprovements()) {
+            return carAudioZoneIdToOccupantZoneIdMapping;
+        }
+
+        SparseArray<CarOccupantZoneManager.OccupantZoneInfo> occupants =
+                getCarOccupantZoneService().getOccupantsConfig();
+
+        SparseIntArray validAudioZoneIdToOccupantZoneId = new SparseIntArray();
+        for (int index = 0; index < carAudioZoneIdToOccupantZoneIdMapping.size(); index++) {
+            int occupantZoneId = carAudioZoneIdToOccupantZoneIdMapping.valueAt(index);
+            int audioZoneId = carAudioZoneIdToOccupantZoneIdMapping.keyAt(index);
+            if (!occupants.contains(occupantZoneId)) {
+                mServiceEventLogger.log("Occupant zone id " + occupantZoneId
+                        + " is assigned to audio zone id " + audioZoneId
+                        + " but the occupant zone id does not exist,"
+                        + " skipping audio zone configuration.");
+                continue;
+            }
+            validAudioZoneIdToOccupantZoneId.put(audioZoneId, occupantZoneId);
+        }
+        return validAudioZoneIdToOccupantZoneId;
+    }
+
+    @GuardedBy("mImplLock")
+    private void updateConfigValueFromZoneHelperLocked(CarAudioZonesHelper zonesHelper) {
+        mCarAudioContext = zonesHelper.getCarAudioContext();
+        mUseCoreAudioRouting = zonesHelper.useCoreAudioRouting();
+        mUseCoreAudioVolume = zonesHelper.useCoreAudioVolume();
+        mUseCarVolumeGroupMuting = zonesHelper.useVolumeGroupMuting();
+        mUseHalDuckingSignals = zonesHelper.useHalDuckingSignalOrDefault(mUseHalDuckingSignals);
+    }
+
     @GuardedBy("mImplLock")
     private CarAudioFadeConfigurationHelper loadCarAudioFadeConfigurationLocked() {
         if (mCarAudioFadeConfigurationPath == null) {
@@ -2010,7 +2060,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
                 new AudioPolicyVolumeCallbackInternal() {
                     @Override
                     public void onMuteChange(boolean mute, int zoneId, int groupId, int flags) {
-                        if (mUseCarVolumeGroupMuting) {
+                        if (useCarVolumeGroupMuting()) {
                             setVolumeGroupMute(zoneId, groupId, mute, flags);
                             return;
                         }
@@ -2458,7 +2508,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     public CarVolumeGroupInfo getVolumeGroupInfo(int zoneId, int groupId) {
         enforcePermission(Car.PERMISSION_CAR_CONTROL_AUDIO_VOLUME);
         if (runInLegacyMode()) {
-            return null;
+            return getVolumeGroupInfoForLegacyMode(zoneId, groupId);
         }
         synchronized (mImplLock) {
             return getCarVolumeGroupLocked(zoneId, groupId).getCarVolumeGroupInfo();
@@ -2469,7 +2519,11 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     public List<CarVolumeGroupInfo> getVolumeGroupInfosForZone(int zoneId) {
         enforcePermission(Car.PERMISSION_CAR_CONTROL_AUDIO_VOLUME);
         if (runInLegacyMode()) {
-            return EMPTY_LIST;
+            List<CarVolumeGroupInfo> infos = new ArrayList<CarVolumeGroupInfo>();
+            for (int groupId = 0; groupId < getVolumeGroupCount(zoneId); groupId++) {
+                infos.add(getVolumeGroupInfoForLegacyMode(zoneId, groupId));
+            }
+            return infos;
         }
         synchronized (mImplLock) {
             return getVolumeGroupInfosForZoneLocked(zoneId);
@@ -2481,7 +2535,8 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
         Objects.requireNonNull(groupInfo, "Car volume group info can not be null");
         enforcePermission(Car.PERMISSION_CAR_CONTROL_AUDIO_VOLUME);
         if (runInLegacyMode()) {
-            return EMPTY_LIST;
+            return getVolumeGroupInfoForLegacyMode(groupInfo.getZoneId(), groupInfo.getId())
+                    .getAudioAttributes();
         }
 
         synchronized (mImplLock) {
@@ -2490,6 +2545,33 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
         }
     }
 
+    private CarVolumeGroupInfo getVolumeGroupInfoForLegacyMode(int zoneId, int groupId) {
+        int maxIndex = getGroupMaxVolume(zoneId, groupId);
+        int minIndex = getGroupMinVolume(zoneId, groupId);
+        AudioAttributes audioAttributes = CarAudioContext.getAudioAttributeFromUsage(
+                CarAudioDynamicRouting.STREAM_TYPE_USAGES[groupId]);
+
+        List<AudioDeviceAttributes> deviceAttributesList = mAudioManagerWrapper
+                .getAudioDevicesForAttributes(audioAttributes)
+                .stream()
+                .map(AudioDeviceAttributes::new)
+                .collect(Collectors.toList());
+
+        return new CarVolumeGroupInfo.Builder("legacy_zone" + zoneId, zoneId, groupId)
+                .setVolumeGainIndex(getGroupVolume(zoneId, groupId))
+                .setMaxVolumeGainIndex(maxIndex)
+                .setMinVolumeGainIndex(minIndex)
+                .setAudioAttributes(Arrays.asList(audioAttributes))
+                .setAudioDeviceAttributes(deviceAttributesList)
+                .setMuted(mAudioManagerWrapper.isStreamMute(
+                        CarAudioDynamicRouting.STREAM_TYPES[groupId]))
+                .setBlocked(false)
+                .setAttenuated(false)
+                .setMaxActivationVolumeGainIndex(maxIndex)
+                .setMinActivationVolumeGainIndex(minIndex)
+                .setMutedBySystem(false).build();
+    }
+
     @GuardedBy("mImplLock")
     private int getVolumeGroupIdForAudioAttributeLocked(int zoneId,
             AudioAttributes audioAttributes) {
@@ -3031,7 +3113,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     public boolean isVolumeGroupMuted(int zoneId, int groupId) {
         enforcePermission(Car.PERMISSION_CAR_CONTROL_AUDIO_VOLUME);
         requireNonLegacyRouting();
-        if (!mUseCarVolumeGroupMuting) {
+        if (!useCarVolumeGroupMuting()) {
             return false;
         }
         synchronized (mImplLock) {
@@ -3383,7 +3465,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
         Slogf.i(TAG, "Setting isAudioEnabled to %b", isAudioEnabled);
 
         mFocusHandler.setRestrictFocus(/* isFocusRestricted= */ !isAudioEnabled);
-        if (mUseCarVolumeGroupMuting) {
+        if (useCarVolumeGroupMuting()) {
             mCarVolumeGroupMuting.setRestrictMuting(/* isMutingRestricted= */ !isAudioEnabled);
         }
         // TODO(b/176258537) if not using group volume, then set master mute accordingly
@@ -3406,7 +3488,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     }
 
     private void requireVolumeGroupMuting() {
-        Preconditions.checkState(mUseCarVolumeGroupMuting,
+        Preconditions.checkState(useCarVolumeGroupMuting(),
                 "Car Volume Group Muting is required");
     }
 
@@ -3508,7 +3590,7 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     }
 
     private void restoreVolumeGroupMuteState() {
-        if (!mUseCarVolumeGroupMuting) {
+        if (!useCarVolumeGroupMuting()) {
             return;
         }
         mCarVolumeGroupMuting.carMuteChanged();
@@ -3885,13 +3967,15 @@ public final class CarAudioService extends ICarAudio.Stub implements CarServiceB
     }
 
     private boolean runInLegacyMode() {
-        return !mUseDynamicRouting && !mUseCoreAudioRouting;
+        synchronized (mImplLock) {
+            return !mUseDynamicRouting && !mUseCoreAudioRouting;
+        }
     }
 
     List<CarVolumeGroupInfo> getMutedVolumeGroups(int zoneId) {
         List<CarVolumeGroupInfo> mutedGroups = new ArrayList<>();
 
-        if (!mUseCarVolumeGroupMuting || !isAudioZoneIdValid(zoneId)) {
+        if (!useCarVolumeGroupMuting() || !isAudioZoneIdValid(zoneId)) {
             return mutedGroups;
         }
 
diff --git a/service/src/com/android/car/audio/CarAudioZone.java b/service/src/com/android/car/audio/CarAudioZone.java
index 381a8a84b8..a8114c03c5 100644
--- a/service/src/com/android/car/audio/CarAudioZone.java
+++ b/service/src/com/android/car/audio/CarAudioZone.java
@@ -218,24 +218,28 @@ public class CarAudioZone {
             mCurrentConfigId = configInfoSwitchedTo.getConfigId();
             CarAudioZoneConfig current = mCarAudioZoneConfigs.get(mCurrentConfigId);
             current.setIsSelected(true);
+            current.synchronizeCurrentGainIndex();
             current.updateVolumeDevices(mCarAudioContext.useCoreAudioRouting());
         }
     }
 
     void init() {
+        int defaultConfig = -1;
         for (int index = 0; index < mCarAudioZoneConfigs.size(); index++) {
             CarAudioZoneConfig config = mCarAudioZoneConfigs.valueAt(index);
-            config.synchronizeCurrentGainIndex();
             // mCurrentConfigId should be the default config, but this may change in the future
             // The configuration could be loaded from audio settings instead
             if (!config.isDefault()) {
                 continue;
             }
-            synchronized (mLock) {
-                mCurrentConfigId = config.getZoneConfigId();
-            }
+            defaultConfig = config.getZoneConfigId();
             config.setIsSelected(true);
+            config.synchronizeCurrentGainIndex();
             config.updateVolumeDevices(mCarAudioContext.useCoreAudioRouting());
+            break;
+        }
+        synchronized (mLock) {
+            mCurrentConfigId = defaultConfig;
         }
     }
 
diff --git a/service/src/com/android/car/audio/CarAudioZonesHelper.java b/service/src/com/android/car/audio/CarAudioZonesHelper.java
index dc09f03cd2..6b9efbdfeb 100644
--- a/service/src/com/android/car/audio/CarAudioZonesHelper.java
+++ b/service/src/com/android/car/audio/CarAudioZonesHelper.java
@@ -67,6 +67,7 @@ import java.util.List;
 import java.util.Map;
 import java.util.MissingResourceException;
 import java.util.Objects;
+import java.util.Optional;
 import java.util.Set;
 
 /**
@@ -80,6 +81,15 @@ import java.util.Set;
     private static final String TAG_OEM_CONTEXT = "oemContext";
     private static final String OEM_CONTEXT_NAME = "name";
 
+    private static final String TAG_DEVICE_CONFIGURATIONS = "deviceConfigurations";
+    private static final String TAG_DEVICE_CONFIG = "deviceConfiguration";
+    private static final String TAG_DEVICE_CONFIG_NAME = "name";
+    private static final String TAG_DEVICE_CONFIG_VALUE = "value";
+    private static final String DEVICE_CONFIG_CORE_VOLUME = "useCoreAudioVolume";
+    private static final String DEVICE_CONFIG_CORE_ROUTING = "useCoreAudioRouting";
+    private static final String DEVICE_CONFIG_DUCKING_SIGNALS = "useHalDuckingSignals";
+    private static final String DEVICE_CONFIG_GROUP_MUTING = "useCarVolumeGroupMuting";
+
     private static final String TAG_AUDIO_ZONES = "zones";
     private static final String TAG_AUDIO_ZONE = "zone";
     private static final String TAG_AUDIO_ZONE_CONFIGS = "zoneConfigs";
@@ -154,15 +164,17 @@ import java.util.Set;
     private final Set<Integer> mAudioZoneIds;
     private final Set<String> mAssignedInputAudioDevices;
     private final Set<String> mAudioZoneConfigNames;
-    private final boolean mUseCarVolumeGroupMute;
-    private final boolean mUseCoreAudioVolume;
-    private final boolean mUseCoreAudioRouting;
     private final boolean mUseFadeManagerConfiguration;
     private final CarAudioFadeConfigurationHelper mCarAudioFadeConfigurationHelper;
     private final List<CarAudioDeviceInfo> mMirroringDevices = new ArrayList<>();
     private final Map<String, CarActivationVolumeConfig> mConfigNameToActivationVolumeConfig =
             new ArrayMap<>();
 
+    private final ArrayMap<String, String> mDeviceConfigNameToValue = new ArrayMap<>();
+    private boolean mUseCoreAudioVolume;
+    private boolean mUseCoreAudioRouting;
+    private boolean mUseCarVolumeGroupMute;
+    private Optional<Boolean> mUseHalDuckingSignals = Optional.empty();
     private final ArrayMap<String, Integer> mContextNameToId = new ArrayMap<>();
     private final LocalLog mCarServiceLocalLog;
     private CarAudioContext mCarAudioContext;
@@ -211,6 +223,65 @@ import java.util.Set;
         return parseCarAudioZones(mInputStream);
     }
 
+    /**
+     * Returns the updated use core volume device configuration
+     *
+     * <p><b>Note</b> The value will depend on the device configuration obtained from the car audio
+     * configuration file. With value obtained from the configuration file having higher priority
+     * over the passed in value (which was obtained from the legacy RRO). If the value is not
+     * defined in the audio configuration file, the original passed in value will be returned.
+     *
+     * @return {@code true} if core volume management should be used, {@code false} otherwise.
+     */
+    boolean useCoreAudioVolume() {
+        return mUseCoreAudioVolume;
+    }
+
+    /**
+     * Returns the updated use core routing device configuration
+     *
+     * <p><b>Note</b> The value will depend on the device configuration obtained from the car audio
+     * configuration file. With value obtained from the configuration file having higher priority
+     * over the passed in value (which was obtained from the legacy RRO). If the value is not
+     * defined in the audio configuration file, the original passed in value will be returned.
+     *
+     * @return {@code true} if core routing management should be used, {@code false} otherwise.
+     */
+    boolean useCoreAudioRouting() {
+        return mUseCoreAudioRouting;
+    }
+
+    /**
+     * Returns the updated use volume group muting device configuration
+     *
+     * <p><b>Note</b> The value will depend on the device configuration obtained from the car audio
+     * configuration file. With value obtained from the configuration file having higher priority
+     * over the passed in value (which was obtained from the legacy RRO). If the value is not
+     * defined in the audio configuration file, the original passed in value will be returned.
+     *
+     * @return {@code true} if volume group muting should be used, {@code false} otherwise.
+     */
+    public boolean useVolumeGroupMuting() {
+        return mUseCarVolumeGroupMute;
+    }
+
+    /**
+     * Returns the updated use HAL ducking device configuration
+     *
+     * <p><b>Note</b> The value will depend on the device configuration obtained from the car audio
+     * configuration file. With value obtained from the configuration file having higher priority
+     * over the passed in default value (which was obtained from the legacy RRO). If the value is
+     * not defined in the audio configuration file, the passed in value will be returned.
+     *
+     * @param defaultUseHalDuckingSignal default value that should be returned if the config was
+     *                                   not present in the audio configuration file.
+     *
+     * @return {@code true} if volume group muting should be used, {@code false} otherwise.
+     */
+    public boolean useHalDuckingSignalOrDefault(boolean defaultUseHalDuckingSignal) {
+        return mUseHalDuckingSignals.orElse(defaultUseHalDuckingSignal);
+    }
+
     private static Map<String, CarAudioDeviceInfo> generateAddressToInfoMap(
             List<CarAudioDeviceInfo> carAudioDeviceInfos) {
         Map<String, CarAudioDeviceInfo> addressToInfoMap = new ArrayMap<>();
@@ -259,7 +330,10 @@ import java.util.Set;
         // Get all zones configured under <zones> tag
         while (parser.next() != XmlPullParser.END_TAG) {
             if (parser.getEventType() != XmlPullParser.START_TAG) continue;
-            if (Objects.equals(parser.getName(), TAG_OEM_CONTEXTS)) {
+            if (Flags.audioVendorFreezeImprovements()
+                    && Objects.equals(parser.getName(), TAG_DEVICE_CONFIGURATIONS)) {
+                parseDeviceConfigurations(parser);
+            } else if (Objects.equals(parser.getName(), TAG_OEM_CONTEXTS)) {
                 parseCarAudioContexts(parser);
             } else if (Objects.equals(parser.getName(), TAG_MIRRORING_DEVICES)) {
                 parseMirroringDevices(parser);
@@ -381,6 +455,91 @@ import java.util.Set;
         }
     }
 
+    private void parseDeviceConfigurations(XmlPullParser parser)
+            throws XmlPullParserException, IOException {
+        while (parser.next() != XmlPullParser.END_TAG) {
+            if (parser.getEventType() != XmlPullParser.START_TAG) continue;
+            if (Objects.equals(parser.getName(), TAG_DEVICE_CONFIG)) {
+                parseAudioConfig(parser);
+            } else {
+                CarAudioParserUtils.skip(parser);
+            }
+        }
+        mUseCoreAudioVolume = parseUseCoreAudioVolume();
+        mUseCoreAudioRouting = parseUseCoreAudioRouting();
+        mUseCarVolumeGroupMute = parseUseCarVolumeGroupMuting();
+        mUseHalDuckingSignals = parseUseHalDuckingSignals();
+    }
+
+    private void parseAudioConfig(XmlPullParser parser)
+            throws XmlPullParserException, IOException {
+        String name = parser.getAttributeValue(NAMESPACE, TAG_DEVICE_CONFIG_NAME);
+        String value = parser.getAttributeValue(NAMESPACE, TAG_DEVICE_CONFIG_VALUE);
+        if (!TextUtils.isEmpty(name) && !TextUtils.isEmpty(value)
+                && !mDeviceConfigNameToValue.containsKey(name)) {
+            mDeviceConfigNameToValue.put(name, value);
+        } else if (mDeviceConfigNameToValue.containsKey(name)) {
+            // If the name already exist consistently keep the previous value
+            mCarServiceLocalLog.log("Device configuration " + name
+                    + " has a duplicate definition with a new value of " + value
+                    + ", keeping the previously assigned value of "
+                    + mDeviceConfigNameToValue.get(name));
+        } else {
+            Slogf.w(TAG, "Device configuration with empty name or value was encountered: [name="
+                    + name + ", value= " + value + "]");
+        }
+        while (parser.next() != XmlPullParser.END_TAG) {
+            if (parser.getEventType() != XmlPullParser.START_TAG) continue;
+            CarAudioParserUtils.skip(parser);
+        }
+    }
+
+    private Optional<Boolean> parseUseHalDuckingSignals() {
+        String useHalDuckingSignals = mDeviceConfigNameToValue.get(DEVICE_CONFIG_DUCKING_SIGNALS);
+        return parseOptionalBoolean(useHalDuckingSignals, DEVICE_CONFIG_DUCKING_SIGNALS);
+    }
+
+    private boolean parseUseCarVolumeGroupMuting() {
+        String useHalGroupMuting = mDeviceConfigNameToValue.get(DEVICE_CONFIG_GROUP_MUTING);
+        return parseBoolean(useHalGroupMuting, DEVICE_CONFIG_GROUP_MUTING, mUseCarVolumeGroupMute);
+    }
+
+    private boolean parseUseCoreAudioVolume() {
+        String useCoreVolumeString = mDeviceConfigNameToValue.get(DEVICE_CONFIG_CORE_VOLUME);
+        return parseBoolean(useCoreVolumeString, DEVICE_CONFIG_CORE_VOLUME, mUseCoreAudioVolume);
+    }
+
+    private boolean parseUseCoreAudioRouting() {
+        String useCoreVolumeString = mDeviceConfigNameToValue.get(DEVICE_CONFIG_CORE_ROUTING);
+        return parseBoolean(useCoreVolumeString, DEVICE_CONFIG_CORE_ROUTING,
+                mUseCoreAudioRouting);
+    }
+
+    private boolean parseBoolean(String booleanString, String configName, boolean defaultValue) {
+        Optional<Boolean> parsedValue = parseOptionalBoolean(booleanString, configName);
+
+        return parsedValue.orElse(defaultValue);
+    }
+
+    private Optional<Boolean> parseOptionalBoolean(String booleanString, String configName) {
+        if (TextUtils.isEmpty(booleanString)) {
+            return Optional.empty();
+        }
+
+        // Need to check for "true" or "false", since Boolean parse will return false for anything
+        // not "true" and we are specifically checking for "true" or "false".
+        if (!booleanString.equalsIgnoreCase("true")
+                && !booleanString.equalsIgnoreCase("false")) {
+            mCarServiceLocalLog.log(configName + " was declared with the value of "
+                    + booleanString + " but should be either true or false");
+            return Optional.empty();
+        }
+
+        mCarServiceLocalLog.log("Found " + configName + " = " + booleanString
+                + " in car_audio_configuration.xml file");
+        return Optional.of(Boolean.parseBoolean(booleanString));
+    }
+
     private SparseArray<CarAudioZone> parseAudioZones(XmlPullParser parser)
             throws XmlPullParserException, IOException {
         SparseArray<CarAudioZone> carAudioZones = new SparseArray<>();
@@ -600,7 +759,7 @@ import java.util.Set;
                 CarAudioParserUtils.skip(parser);
             }
         }
-        // If the configuration is not valid we can the config
+        // If the configuration is not valid we can skip the config
         if (!valid) {
             String message = "Skipped configuration " + zoneConfigName + " in zone " + zone.getId();
             Slogf.e(TAG, message);
@@ -632,14 +791,7 @@ import java.util.Set;
             if (parser.getEventType() != XmlPullParser.START_TAG) continue;
             if (Objects.equals(parser.getName(), TAG_VOLUME_GROUP)) {
                 String groupName = parser.getAttributeValue(NAMESPACE, VOLUME_GROUP_NAME);
-                Preconditions.checkArgument(!mUseCoreAudioVolume || groupName != null,
-                        "%s %s attribute can not be empty when relying on core volume groups",
-                        TAG_VOLUME_GROUP, VOLUME_GROUP_NAME);
-                if (groupName == null) {
-                    groupName = new StringBuilder().append("config ")
-                            .append(zoneConfigBuilder.getZoneConfigId()).append(" group ")
-                            .append(groupId).toString();
-                }
+                groupName = verifyGroupNameAndCreateIfNeeded(zoneConfigBuilder, groupName, groupId);
 
                 CarActivationVolumeConfig activationVolumeConfig =
                         getActivationVolumeConfig(parser);
@@ -664,6 +816,31 @@ import java.util.Set;
         return valid;
     }
 
+    private String verifyGroupNameAndCreateIfNeeded(
+            CarAudioZoneConfig.Builder zoneConfigBuilder, String groupName, int groupId) {
+        verifyGroupName(groupName);
+        if (groupName == null) {
+            groupName = "config " + zoneConfigBuilder.getZoneConfigId() + " group " + groupId;
+        }
+        return groupName;
+    }
+
+    private void verifyGroupName(String groupName) {
+        if (!Flags.audioVendorFreezeImprovements()) {
+            Preconditions.checkArgument(!mUseCoreAudioVolume || groupName != null,
+                    "%s %s attribute can not be empty when relying on core volume groups",
+                    TAG_VOLUME_GROUP, VOLUME_GROUP_NAME);
+            return;
+        }
+        if (!mUseCoreAudioVolume || groupName != null) {
+            return;
+        }
+        mCarServiceLocalLog.log("Found " + TAG_VOLUME_GROUP + " " + VOLUME_GROUP_NAME
+                + " empty while relying on core volume groups,"
+                + " resetting use core volume to false");
+        mUseCoreAudioVolume = false;
+    }
+
     private CarActivationVolumeConfig getActivationVolumeConfig(XmlPullParser parser) {
         String activationVolumeConfigName = parser.getAttributeValue(NAMESPACE,
                 ATTR_ACTIVATION_VOLUME_CONFIG);
@@ -965,6 +1142,13 @@ import java.util.Set;
             throw new IllegalStateException("Output device address " + address
                     + " does not belong to any configured output device.");
         }
+        if (CarAudioUtils.isDynamicDeviceType(type) && !mUseCoreAudioVolume) {
+            mCarServiceLocalLog.log("Found invalid device setup,"
+                    + " dynamic device " + DebugUtils.constantToString(AudioDeviceInfo.class,
+                    /* prefix= */ "TYPE_", type) + " requires core audio volume management"
+                    + " but audioUseCoreVolume is false.");
+            return false;
+        }
         return true;
     }
 
diff --git a/service/src/com/android/car/bluetooth/BluetoothPowerPolicy.java b/service/src/com/android/car/bluetooth/BluetoothPowerPolicy.java
index f401e1a47a..5b2dc77642 100644
--- a/service/src/com/android/car/bluetooth/BluetoothPowerPolicy.java
+++ b/service/src/com/android/car/bluetooth/BluetoothPowerPolicy.java
@@ -17,6 +17,7 @@
 package com.android.car.bluetooth;
 
 import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DUMP_INFO;
+import static com.android.car.internal.common.CommonConstants.USER_LIFECYCLE_EVENT_TYPE_UNLOCKED;
 
 import android.bluetooth.BluetoothAdapter;
 import android.bluetooth.BluetoothManager;
@@ -25,7 +26,10 @@ import android.car.hardware.power.CarPowerPolicy;
 import android.car.hardware.power.CarPowerPolicyFilter;
 import android.car.hardware.power.ICarPowerPolicyListener;
 import android.car.hardware.power.PowerComponent;
+import android.car.user.CarUserManager;
+import android.car.user.UserLifecycleEventFilter;
 import android.content.Context;
+import android.os.RemoteException;
 import android.os.UserHandle;
 import android.os.UserManager;
 import android.provider.Settings;
@@ -36,6 +40,7 @@ import com.android.car.CarLog;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.util.IndentingPrintWriter;
 import com.android.car.power.CarPowerManagementService;
+import com.android.car.user.CarUserService;
 import com.android.internal.annotations.VisibleForTesting;
 
 import java.util.Objects;
@@ -52,10 +57,12 @@ public final class BluetoothPowerPolicy {
     private static final int BLUETOOTH_OFF = 0;
     private static final int BLUETOOTH_ON = 1;
 
-    private final int mUserId;
+    private int mUserId;
     private final Context mContext;
     private final BluetoothAdapter mBluetoothAdapter;
+    private CarUserService mCarUserService;
     private final UserManager mUserManager;
+    private CarPowerManagementService mCarPowerManagementService;
 
     private final ICarPowerPolicyListener mPowerPolicyListener =
             new ICarPowerPolicyListener.Stub() {
@@ -86,6 +93,15 @@ public final class BluetoothPowerPolicy {
                 }
     };
 
+    private final CarUserManager.UserLifecycleListener mUserLifecycleListener = event -> {
+        try {
+            mPowerPolicyListener.onPolicyChanged(/* appliedPolicy= */ null,
+                    mCarPowerManagementService.getCurrentPowerPolicy());
+        } catch (RemoteException e) {
+            Slogf.e(TAG, "Could not apply current power policy", e);
+        }
+    };
+
     @VisibleForTesting
     public ICarPowerPolicyListener getPowerPolicyListener() {
         return mPowerPolicyListener;
@@ -133,12 +149,18 @@ public final class BluetoothPowerPolicy {
         if (DBG) {
             Slogf.d(TAG, "init()");
         }
-        CarPowerManagementService cpms = CarLocalServices.getService(
+        mCarPowerManagementService = CarLocalServices.getService(
                 CarPowerManagementService.class);
-        if (cpms != null) {
+        mCarUserService = CarLocalServices.getService(CarUserService.class);
+        UserLifecycleEventFilter userSwitchingEventFilter = new UserLifecycleEventFilter.Builder()
+                .addEventType(USER_LIFECYCLE_EVENT_TYPE_UNLOCKED)
+                .addUser(UserHandle.of(mUserId))
+                .build();
+        mCarUserService.addUserLifecycleListener(userSwitchingEventFilter, mUserLifecycleListener);
+        if (mCarPowerManagementService != null) {
             CarPowerPolicyFilter filter = new CarPowerPolicyFilter.Builder()
                     .setComponents(PowerComponent.BLUETOOTH).build();
-            cpms.addPowerPolicyListener(filter, mPowerPolicyListener);
+            mCarPowerManagementService.addPowerPolicyListener(filter, mPowerPolicyListener);
         } else {
             Slogf.w(TAG, "Cannot find CarPowerManagementService");
         }
@@ -157,6 +179,7 @@ public final class BluetoothPowerPolicy {
         if (cpms != null) {
             cpms.removePowerPolicyListener(mPowerPolicyListener);
         }
+        mCarUserService.removeUserLifecycleListener(mUserLifecycleListener);
     }
 
     /**
diff --git a/service/src/com/android/car/cluster/ClusterHomeService.java b/service/src/com/android/car/cluster/ClusterHomeService.java
index a76be42b23..3271825fce 100644
--- a/service/src/com/android/car/cluster/ClusterHomeService.java
+++ b/service/src/com/android/car/cluster/ClusterHomeService.java
@@ -173,6 +173,8 @@ public final class ClusterHomeService extends IClusterHomeService.Stub
                 .setLaunchDisplayId(clusterDisplayId);
         mFixedActivityService.startFixedActivityModeForDisplayAndUser(
                 mLastIntent, activityOptions, clusterDisplayId, mLastIntentUserId);
+
+        Slogf.i(TAG, "Initialized cluster display %d", clusterDisplayId);
     }
 
     private final ICarOccupantZoneCallback mOccupantZoneCallback =
diff --git a/service/src/com/android/car/evs/CarEvsService.java b/service/src/com/android/car/evs/CarEvsService.java
index 1430582a14..08d27e6fcc 100644
--- a/service/src/com/android/car/evs/CarEvsService.java
+++ b/service/src/com/android/car/evs/CarEvsService.java
@@ -18,6 +18,7 @@ package com.android.car.evs;
 
 import static android.car.evs.CarEvsManager.ERROR_NONE;
 import static android.car.evs.CarEvsManager.ERROR_UNAVAILABLE;
+import static android.car.user.CarUserManager.USER_LIFECYCLE_EVENT_TYPE_UNLOCKED;
 
 import static com.android.car.CarLog.TAG_EVS;
 import static com.android.car.evs.StateMachine.REQUEST_PRIORITY_NORMAL;
@@ -42,6 +43,8 @@ import android.car.evs.ICarEvsStreamCallback;
 import android.car.hardware.CarPropertyValue;
 import android.car.hardware.property.CarPropertyEvent;
 import android.car.hardware.property.ICarPropertyEventListener;
+import android.car.user.CarUserManager.UserLifecycleListener;
+import android.car.user.UserLifecycleEventFilter;
 import android.content.ComponentName;
 import android.content.Context;
 import android.content.pm.PackageManager.NameNotFoundException;
@@ -64,6 +67,7 @@ import android.util.SparseArray;
 import android.util.proto.ProtoOutputStream;
 import android.view.Display;
 
+import com.android.car.CarLocalServices;
 import com.android.car.CarPropertyService;
 import com.android.car.CarServiceBase;
 import com.android.car.CarServiceUtils;
@@ -72,6 +76,7 @@ import com.android.car.hal.EvsHalService;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.evs.CarEvsUtils;
 import com.android.car.internal.util.IndentingPrintWriter;
+import com.android.car.user.CarUserService;
 import com.android.internal.annotations.GuardedBy;
 import com.android.internal.annotations.VisibleForTesting;
 
@@ -263,6 +268,8 @@ public final class CarEvsService extends android.car.evs.ICarEvsService.Stub
             }
         };
 
+    private final UserLifecycleListener mUserLifecycleListener;
+
     // Service instances per each type.
     private final SparseArray<StateMachine> mServiceInstances;
 
@@ -286,6 +293,8 @@ public final class CarEvsService extends android.car.evs.ICarEvsService.Stub
     private EvsHalEvent mLastEvsHalEvent = new EvsHalEvent(/* timestamp= */ 0,
             CarEvsManager.SERVICE_TYPE_REARVIEW, /* on= */ false);
 
+    private CarUserService mCarUserService;
+
     /** Creates an Extended View System service instance given a {@link Context}. */
     public CarEvsService(Context context, Context builtinContext, EvsHalService halService,
             CarPropertyService propertyService) {
@@ -311,6 +320,7 @@ public final class CarEvsService extends android.car.evs.ICarEvsService.Stub
             mEvsHalService = null;
             mServiceInstances = new SparseArray<>();
             mDisplayManager = null;
+            mUserLifecycleListener = null;
 
             return;
         }
@@ -335,6 +345,7 @@ public final class CarEvsService extends android.car.evs.ICarEvsService.Stub
                 Slogf.e(TAG_EVS, "No valid configuration has been found. " +
                         "CarEvsService won't be available.");
                 mDisplayManager = null;
+                mUserLifecycleListener = null;
                 return;
             }
         } else {
@@ -361,6 +372,24 @@ public final class CarEvsService extends android.car.evs.ICarEvsService.Stub
 
         mDisplayManager = context.getSystemService(DisplayManager.class);
         mDisplayManager.registerDisplayListener(mDisplayListener, mHandler);
+
+        mUserLifecycleListener = event -> {
+            synchronized (mLock) {
+                if (!needToStartActivityLocked()) {
+                    // No action required.
+                    return;
+                }
+
+                StateMachine instance = mServiceInstances.get(CarEvsManager.SERVICE_TYPE_REARVIEW);
+                if (instance == null) {
+                    // No action required if SERVICE_TYPE_REARVIEW is not activated.
+                    return;
+                }
+
+                // Ensure a registered activity at the top of the back stack.
+                instance.bringActivityToForeground();
+            }
+        };
     }
 
     @VisibleForTesting
@@ -465,6 +494,13 @@ public final class CarEvsService extends android.car.evs.ICarEvsService.Stub
         }
 
         instance.connectToHalServiceIfNecessary();
+
+        mCarUserService = CarLocalServices.getService(CarUserService.class);
+        if (mCarUserService != null) {
+            UserLifecycleEventFilter userEventFilter = new UserLifecycleEventFilter.Builder()
+                    .addEventType(USER_LIFECYCLE_EVENT_TYPE_UNLOCKED).build();
+            mCarUserService.addUserLifecycleListener(userEventFilter, mUserLifecycleListener);
+        }
     }
 
     @Override
@@ -474,6 +510,9 @@ public final class CarEvsService extends android.car.evs.ICarEvsService.Stub
         }
 
         mDisplayManager.unregisterDisplayListener(mDisplayListener);
+        if (mCarUserService != null) {
+            mCarUserService.removeUserLifecycleListener(mUserLifecycleListener);
+        }
 
         if (mUseGearSelection && mPropertyService != null) {
             if (DBG) {
@@ -1006,10 +1045,15 @@ public final class CarEvsService extends android.car.evs.ICarEvsService.Stub
     /** Tells whether or not the latest EVS HAL event was requesting to start an activity. */
     boolean needToStartActivity() {
         synchronized (mLock) {
-            return mLastEvsHalEvent != null && mLastEvsHalEvent.isRequestingToStartActivity();
+            return needToStartActivityLocked();
         }
     }
 
+    @GuardedBy("mLock")
+    boolean needToStartActivityLocked() {
+        return mLastEvsHalEvent != null && mLastEvsHalEvent.isRequestingToStartActivity();
+    }
+
     /**
      * Manually sets a current service state.
      */
diff --git a/service/src/com/android/car/evs/CarEvsServiceUtils.java b/service/src/com/android/car/evs/CarEvsServiceUtils.java
index 8e850ce9ad..44c3d0f5ae 100644
--- a/service/src/com/android/car/evs/CarEvsServiceUtils.java
+++ b/service/src/com/android/car/evs/CarEvsServiceUtils.java
@@ -24,6 +24,7 @@ import static android.car.evs.CarEvsManager.SERVICE_TYPE_DRIVERVIEW;
 import static android.car.evs.CarEvsManager.SERVICE_TYPE_FRONT_PASSENGERSVIEW;
 import static android.car.evs.CarEvsManager.SERVICE_TYPE_REAR_PASSENGERSVIEW;
 import static android.car.evs.CarEvsManager.SERVICE_TYPE_USER_DEFINED;
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DUMP_INFO;
 
 import android.annotation.SystemApi;
 import android.content.ComponentName;
@@ -32,6 +33,7 @@ import android.car.evs.CarEvsManager;
 import android.car.evs.CarEvsManager.CarEvsServiceType;
 import android.car.evs.CarEvsManager.CarEvsStreamEvent;
 
+import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.evs.CarEvsUtils;
 
 /**
@@ -108,10 +110,10 @@ public final class CarEvsServiceUtils {
 
         @CarEvsServiceType int getType() { return mServiceType; }
         String getCameraId() { return mCameraId; }
-        void setCameraId(String cameraId) { mCameraId = cameraId; }
         ComponentName getActivityComponentName() { return mActivityName; }
 
         @Override
+        @ExcludeFromCodeCoverageGeneratedReport(reason = DUMP_INFO)
         public String toString() {
             return "Parameter serviceType=" + CarEvsUtils.convertToString(mServiceType) +
                    ", cameraId=" + mCameraId + ", activityName=" + mActivityName;
diff --git a/service/src/com/android/car/evs/StateMachine.java b/service/src/com/android/car/evs/StateMachine.java
index d305a46459..792e83437b 100644
--- a/service/src/com/android/car/evs/StateMachine.java
+++ b/service/src/com/android/car/evs/StateMachine.java
@@ -198,10 +198,6 @@ final class StateMachine {
             return mCallbacks.getRegisteredCallbackCount() == 0;
         }
 
-        RemoteCallbackList get() {
-            return mCallbacks;
-        }
-
         int size() {
             return mCallbacks.getRegisteredCallbackCount();
         }
@@ -651,7 +647,7 @@ final class StateMachine {
         if (result == ERROR_NONE) {
             if (previousState != newState) {
                 Slogf.i(mLogTag, "Transition completed: %s", stateToString(destination));
-                mService.broadcastStateTransition(CarEvsManager.SERVICE_TYPE_REARVIEW, newState);
+                mService.broadcastStateTransition(mServiceType, newState);
 
                 // Log a successful state transition.
                 synchronized (mLock) {
@@ -1008,7 +1004,6 @@ final class StateMachine {
                 .setComponent(mActivityName)
                 .addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
                 .addFlags(Intent.FLAG_ACTIVITY_NEW_DOCUMENT)
-                .addFlags(Intent.FLAG_ACTIVITY_MULTIPLE_TASK)
                 .addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
 
         // Stores a token and arms the timer for the high-priority request.
@@ -1029,6 +1024,33 @@ final class StateMachine {
         return ERROR_NONE;
     }
 
+    /**
+     * Attempt to bring a registered activity to the foreground by sending the Intent with existing
+     * session token.
+     *
+     * {@link CarEvsService} uses this method to bring the activity to the top when the active user
+     * is switched.
+     */
+    public void bringActivityToForeground() {
+        synchronized (mLock) {
+            Intent evsIntent = new Intent(Intent.ACTION_MAIN)
+                    .setComponent(mActivityName)
+                    .addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
+                    .addFlags(Intent.FLAG_ACTIVITY_NEW_DOCUMENT)
+                    .addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
+
+            Bundle bundle = new Bundle();
+            bundle.putBinder(CarEvsManager.EXTRA_SESSION_TOKEN, mSessionToken);
+
+            // Temporary, we use CarEvsManager.SERVICE_TYPE_REARVIEW as the key for a service type
+            // value.
+            bundle.putShort(Integer.toString(CarEvsManager.SERVICE_TYPE_REARVIEW),
+                    (short) mServiceType);
+            evsIntent.replaceExtras(bundle);
+            mContext.startActivity(evsIntent);
+        }
+    }
+
     /**
      * Handle a transition from current state to ACTIVE state.
      *
diff --git a/service/src/com/android/car/hal/PowerHalService.java b/service/src/com/android/car/hal/PowerHalService.java
index 9cbca71aba..0ce40c404d 100644
--- a/service/src/com/android/car/hal/PowerHalService.java
+++ b/service/src/com/android/car/hal/PowerHalService.java
@@ -40,13 +40,17 @@ import android.hardware.automotive.vehicle.VehicleApPowerStateShutdownParam;
 import android.hardware.automotive.vehicle.VehicleProperty;
 import android.hardware.automotive.vehicle.VehiclePropertyStatus;
 import android.hardware.display.DisplayManager;
+import android.os.Handler;
+import android.os.HandlerThread;
 import android.os.ServiceSpecificException;
 import android.util.SparseArray;
 import android.util.SparseIntArray;
 import android.view.Display;
 
 import com.android.car.CarLog;
+import com.android.car.CarServiceUtils;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
+import com.android.car.systeminterface.DisplayHelperInterface;
 import com.android.internal.annotations.GuardedBy;
 import com.android.internal.annotations.VisibleForTesting;
 import com.android.internal.util.Preconditions;
@@ -56,6 +60,7 @@ import java.lang.annotation.Retention;
 import java.lang.annotation.RetentionPolicy;
 import java.util.ArrayList;
 import java.util.Collection;
+import java.util.LinkedList;
 import java.util.List;
 import java.util.Objects;
 
@@ -69,6 +74,12 @@ public class PowerHalService extends HalServiceBase {
     // TODO(b/337307388): replace this with VehicleProperty.PER_DISPLAY_MAX_BRIGHTNESS once we use
     // property V4.
     private static final int PER_DISPLAY_MAX_BRIGHTNESS = 0x11410F4E;
+    // In order to prevent flickering caused by
+    // set_vhal_brightness_1 -> set_vhal_brightness_2 -> vhal_report_1 -> set_vhal_brightness_1
+    // -> vhal_report_2 -> set_vhal_brightness_2 -> ...
+    // We set a time window to ignore the value update event for the requests we have sent.
+    private static final int PREVENT_LOOP_REQUEST_TIME_WINDOW_MS = 1000;
+    private static final int GLOBAL_PORT = -1;
 
     private record PropertyInfo(boolean needSubscription) {}
 
@@ -318,11 +329,20 @@ public class PowerHalService extends HalServiceBase {
         }
     }
 
+    private record BrightnessForDisplayPort(int brightness, int displayPort) {}
+
     @GuardedBy("mLock")
     private final SparseArray<HalPropConfig> mProperties = new SparseArray<>();
     private final Context mContext;
     private final VehicleHal mHal;
     private final FeatureFlags mFeatureFlags;
+    private final HandlerThread mHandlerThread;
+    private final Handler mHandler;
+    // A FIFO queue that stores the brightness value we previously set to VHAL in a short time
+    // window.
+    @GuardedBy("mLock")
+    private final LinkedList<BrightnessForDisplayPort> mRecentlySetBrightness = new LinkedList<>();
+    private final DisplayHelperInterface mDisplayHelper;
     @Nullable
     @GuardedBy("mLock")
     private ArrayList<HalPropValue> mQueuedEvents;
@@ -335,10 +355,14 @@ public class PowerHalService extends HalServiceBase {
     @GuardedBy("mLock")
     private boolean mPerDisplayBrightnessSupported;
 
-    public PowerHalService(Context context, FeatureFlags featureFlags, VehicleHal hal) {
+    public PowerHalService(Context context, FeatureFlags featureFlags, VehicleHal hal,
+            DisplayHelperInterface displayHelper) {
         mContext = context;
         mFeatureFlags = featureFlags;
         mHal = hal;
+        mHandlerThread = CarServiceUtils.getHandlerThread(getClass().getSimpleName());
+        mHandler = new Handler(mHandlerThread.getLooper());
+        mDisplayHelper = displayHelper;
     }
 
     /**
@@ -450,27 +474,26 @@ public class PowerHalService extends HalServiceBase {
      * Sets the display brightness for the vehicle.
      * @param brightness value from 0 to 100.
      */
-    public void sendDisplayBrightness(int brightness) {
+    public void sendDisplayBrightnessLegacy(int brightness) {
+        // This method should not be called if multiDisplayBrightnessControl is enabled.
+        Slogf.i(CarLog.TAG_POWER, "brightness from system: " + brightness);
+
         int brightnessToSet = adjustBrightness(brightness, /* minBrightness= */ 0,
-                /* maxBrightness= */ 100);
+                /* maxBrightness= */ MAX_BRIGHTNESS);
 
         synchronized (mLock) {
             if (mProperties.get(DISPLAY_BRIGHTNESS) == null) {
                 return;
             }
             if (mPerDisplayBrightnessSupported) {
-                Slogf.w(CarLog.TAG_POWER, "PER_DISPLAY_BRIGHTNESS is supported and "
+                Slogf.e(CarLog.TAG_POWER, "PER_DISPLAY_BRIGHTNESS is supported and "
                         + "sendDisplayBrightness(int displayId, int brightness) should be used "
-                        + "instead of DISPLAY_BRIGHTNESS");
+                        + "instead of sendDisplayBrightnessLegacy");
                 return;
             }
         }
-        try {
-            mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, 0).to(brightnessToSet);
-            Slogf.i(CarLog.TAG_POWER, "send display brightness = " + brightnessToSet);
-        } catch (ServiceSpecificException | IllegalArgumentException e) {
-            Slogf.e(CarLog.TAG_POWER, "cannot set DISPLAY_BRIGHTNESS", e);
-        }
+
+        setGlobalBrightness(Display.DEFAULT_DISPLAY, brightnessToSet);
     }
 
     /**
@@ -479,32 +502,85 @@ public class PowerHalService extends HalServiceBase {
      * @param brightness in percentile. 100% full.
      */
     public void sendDisplayBrightness(int displayId, int brightness) {
+        Slogf.i(CarLog.TAG_POWER, "brightness from system: " + brightness
+                + ", displayId: " + displayId);
         int brightnessToSet = adjustBrightness(brightness, /* minBrightness= */ 0,
                 /* maxBrightness= */ 100);
-
+        boolean perDisplayBrightnessSupported;
         synchronized (mLock) {
-            if (!mPerDisplayBrightnessSupported) {
-                Slogf.w(CarLog.TAG_POWER, "PER_DISPLAY_BRIGHTNESS is not supported");
+            perDisplayBrightnessSupported = mPerDisplayBrightnessSupported;
+        }
+
+        if (!perDisplayBrightnessSupported) {
+            if (!mFeatureFlags.multiDisplayBrightnessControl()) {
+                Slogf.w(CarLog.TAG_POWER, "PER_DISPLAY_BRIGHTNESS is not supported, trying to set"
+                        + " individual display's brightness does nothing in legacy mode");
                 return;
             }
+            Slogf.w(CarLog.TAG_POWER, "PER_DISPLAY_BRIGHTNESS is not supported, always set the"
+                    + " default display brightness");
+            setGlobalBrightness(displayId, brightnessToSet);
+            return;
         }
+
+        setBrightnessForDisplayId(displayId, brightnessToSet);
+    }
+
+    private void setBrightnessForDisplayId(int displayId, int brightness) {
         int displayPort = getDisplayPort(displayId);
         if (displayPort == DisplayHelper.INVALID_PORT) {
             return;
         }
+
+        synchronized (mLock) {
+            // Adjust brightness back from 0-100 back to 0-maxDisplayBrightness scale.
+            int maxDisplayBrightnessForPort = getMaxPerDisplayBrightnessLocked(displayPort);
+            brightness = brightness * maxDisplayBrightnessForPort / MAX_BRIGHTNESS;
+            addRecentlySetBrightnessChangeLocked(brightness, displayPort);
+        }
+
+        Slogf.i(CarLog.TAG_POWER, "brightness to VHAL: " + brightness
+                + ", displayPort: " + displayPort);
         try {
             HalPropValue value = mHal.getHalPropValueBuilder()
                     .build(PER_DISPLAY_BRIGHTNESS, /* areaId= */ 0,
-                            new int[]{displayPort, brightnessToSet});
+                            new int[]{displayPort, brightness});
             mHal.set(value);
-            Slogf.i(CarLog.TAG_POWER, "send display brightness = %d, port = %d",
-                    brightnessToSet, displayPort);
-        } catch (ServiceSpecificException e) {
+            Slogf.i(CarLog.TAG_POWER, "sent display brightness = %d, port = %d",
+                    brightness, displayPort);
+        } catch (ServiceSpecificException | IllegalArgumentException e) {
             Slogf.e(CarLog.TAG_POWER, e, "cannot set PER_DISPLAY_BRIGHTNESS port = %d",
                     displayPort);
         }
     }
 
+    // The brightness is in 0-100 scale.
+    // fromDisplayId represents which display this request is sent from, even though in reality,
+    // because VHAL only supports global brightness.
+    private void setGlobalBrightness(int fromDisplayId, int brightness) {
+        // Adjust brightness back from 0-100 back to 0-maxDisplayBrightness scale.
+        synchronized (mLock) {
+            brightness = brightness * mMaxDisplayBrightness / MAX_BRIGHTNESS;
+        }
+
+        int displayPort = getDisplayPort(fromDisplayId);
+        if (displayPort == DisplayHelper.INVALID_PORT) {
+            return;
+        }
+
+        Slogf.i(CarLog.TAG_POWER, "brightness to VHAL: " + brightness);
+        synchronized (mLock) {
+            addRecentlySetBrightnessChangeLocked(brightness, displayPort);
+        }
+
+        try {
+            mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0).to(brightness);
+            Slogf.i(CarLog.TAG_POWER, "sent global display brightness = %d", brightness);
+        } catch (ServiceSpecificException | IllegalArgumentException e) {
+            Slogf.e(CarLog.TAG_POWER, e, "cannot set DISPLAY_BRIGHTNESS");
+        }
+    }
+
     /**
      * Sends {@code SHUTDOWN_REQUEST} to the VHAL.
      */
@@ -730,7 +806,7 @@ public class PowerHalService extends HalServiceBase {
                 if (maxDisplayBrightness <= 0) {
                     Slogf.w(CarLog.TAG_POWER,
                             "Max display brightness from vehicle HAL for display port: %d is "
-                            + "invalid:  %d", displayPort, maxDisplayBrightness);
+                            + "invalid: %d", displayPort, maxDisplayBrightness);
                     maxDisplayBrightness = 1;
                 }
                 mMaxPerDisplayBrightness.put(displayPort, maxDisplayBrightness);
@@ -752,6 +828,7 @@ public class PowerHalService extends HalServiceBase {
             }
             mProperties.clear();
         }
+        mHandlerThread.quitSafely();
     }
 
     @Override
@@ -832,17 +909,28 @@ public class PowerHalService extends HalServiceBase {
                                 + v.dumpInt32Values(), e);
                         break;
                     }
-                    if (brightness < 0) {
-                        Slogf.e(CarLog.TAG_POWER, "invalid brightness: " + brightness
-                                + ", set to 0");
-                        brightness = 0;
-                    } else if (brightness > MAX_BRIGHTNESS) {
-                        Slogf.e(CarLog.TAG_POWER, "invalid brightness: " + brightness + ", set to "
-                                + MAX_BRIGHTNESS);
-                        brightness = MAX_BRIGHTNESS;
-                    }
                     Slogf.i(CarLog.TAG_POWER, "Received DISPLAY_BRIGHTNESS=" + brightness);
-                    listener.onDisplayBrightnessChange(brightness);
+
+                    brightness = adjustBrightness(brightness, /* minBrightness= */ 0,
+                            MAX_BRIGHTNESS);
+                    Slogf.i(CarLog.TAG_POWER, "brightness to system: " + brightness);
+                    if (mFeatureFlags.multiDisplayBrightnessControl()) {
+                        // DISPLAY_BRIGHNTESS represents the brightness for all displays.
+                        onDisplayBrightnessChangeForAllDisplays(listener, brightness);
+                    } else {
+                        // If we have recently sent the same brightness to VHAL. This request is
+                        // likely caused by that change and is duplicate. Ignore to prevent loop.
+                        synchronized (mLock) {
+                            if (hasRecentlySetBrightnessChangeLocked(brightness,
+                                    getDisplayPort(Display.DEFAULT_DISPLAY))) {
+                                return;
+                            }
+                        }
+
+                        // In legacy mode without per display brightness control, DISPLAY_BRIGHTNESS
+                        // is assumed to control the default display's brightness.
+                        listener.onDisplayBrightnessChange(brightness);
+                    }
                     break;
                 }
                 case PER_DISPLAY_BRIGHTNESS:
@@ -857,22 +945,24 @@ public class PowerHalService extends HalServiceBase {
                                 + v.dumpInt32Values(), e);
                         break;
                     }
-                    int maxBrightness;
+                    Slogf.i(CarLog.TAG_POWER, "Received PER_DISPLAY_BRIGHTNESS=" + brightness
+                            + ", displayPort=" + displayPort);
+
+                    // If we have recently sent the same brightness to VHAL. This request is likely
+                    // caused by that change and is duplicate. Ignore to prevent loop.
                     synchronized (mLock) {
-                        if (!mFeatureFlags.perDisplayMaxBrightness()
-                                || mMaxPerDisplayBrightness.size() == 0) {
-                            maxBrightness = mMaxDisplayBrightness;
-                        } else {
-                            maxBrightness = mMaxPerDisplayBrightness.get(displayPort,
-                                    /* valueIfKeyNotFound= */ 1);
+                        if (hasRecentlySetBrightnessChangeLocked(brightness, displayPort)) {
+                            return;
                         }
                     }
+
+                    int maxBrightness = getMaxPerDisplayBrightness(displayPort);
                     brightness = brightness * MAX_BRIGHTNESS / maxBrightness;
                     brightness = adjustBrightness(brightness, /* minBrightness= */ 0,
                             MAX_BRIGHTNESS);
-                    Slogf.i(CarLog.TAG_POWER, "Received PER_DISPLAY_BRIGHTNESS=" + brightness
-                            + ", displayPort=" + displayPort);
                     int displayId = getDisplayId(displayPort);
+                    Slogf.i(CarLog.TAG_POWER, "brightness to system: " + brightness
+                            + ", displayId=" + displayId);
                     listener.onDisplayBrightnessChange(displayId, brightness);
                     break;
                 }
@@ -884,11 +974,81 @@ public class PowerHalService extends HalServiceBase {
         }
     }
 
+    @GuardedBy("mLock")
+    private boolean hasRecentlySetBrightnessChangeLocked(int brightness, int displayPort) {
+        for (int i = 0; i < mRecentlySetBrightness.size(); i++) {
+            if (isSameBrightnessForDisplayPort(mRecentlySetBrightness.get(i), brightness,
+                    displayPort)) {
+                Slogf.v(CarLog.TAG_POWER, "Ignore brightness change from VHAL, brightness="
+                        + brightness + ", displayPort=" + displayPort
+                        + ", same as recently sent brightness to VHAL");
+                return true;
+            }
+        }
+        return false;
+    }
+
+    @GuardedBy("mLock")
+    private void addRecentlySetBrightnessChangeLocked(int brightness, int displayPort) {
+        mRecentlySetBrightness.add(new BrightnessForDisplayPort(brightness, displayPort));
+        mHandler.postDelayed(() -> {
+            synchronized (mLock) {
+                mRecentlySetBrightness.removeFirst();
+            }
+        }, PREVENT_LOOP_REQUEST_TIME_WINDOW_MS);
+    }
+
+    private boolean isSameBrightnessForDisplayPort(BrightnessForDisplayPort toCheck,
+            int brightness, int displayPort) {
+        return toCheck.brightness() == brightness && toCheck.displayPort() == displayPort;
+    }
+
+    private int getMaxPerDisplayBrightness(int displayPort) {
+        synchronized (mLock) {
+            return getMaxPerDisplayBrightnessLocked(displayPort);
+        }
+    }
+
+    @GuardedBy("mLock")
+    private int getMaxPerDisplayBrightnessLocked(int displayPort) {
+        int maxBrightness;
+        if (!mFeatureFlags.perDisplayMaxBrightness()
+                || mMaxPerDisplayBrightness.size() == 0) {
+            maxBrightness = mMaxDisplayBrightness;
+        } else {
+            maxBrightness = mMaxPerDisplayBrightness.get(displayPort,
+                    /* valueIfKeyNotFound= */ 1);
+        }
+        return maxBrightness;
+    }
+
+    private void onDisplayBrightnessChangeForAllDisplays(PowerEventListener listener,
+            int brightness) {
+        DisplayManager displayManager = mContext.getSystemService(DisplayManager.class);
+        for (Display display : displayManager.getDisplays()) {
+            int displayId = display.getDisplayId();
+            int displayType = mDisplayHelper.getType(display);
+            if (displayType == DisplayHelper.TYPE_VIRTUAL
+                    || displayType == DisplayHelper.TYPE_OVERLAY) {
+                continue;
+            }
+            // If we have recently sent the same brightness to VHAL. This request is likely
+            // caused by that change and is duplicate. Ignore to prevent loop.
+            synchronized (mLock) {
+                if (hasRecentlySetBrightnessChangeLocked(brightness,
+                        mDisplayHelper.getPhysicalPort(display))) {
+                    continue;
+                }
+            }
+            listener.onDisplayBrightnessChange(displayId, brightness);
+        }
+    }
+
     private int getDisplayId(int displayPort) {
         DisplayManager displayManager = mContext.getSystemService(DisplayManager.class);
         int displayId = Display.DEFAULT_DISPLAY;
         for (Display display : displayManager.getDisplays()) {
-            if (displayPort == DisplayHelper.getPhysicalPort(display)) {
+            if (displayPort == mDisplayHelper.getPhysicalPort(display)) {
                 displayId = display.getDisplayId();
                 break;
             }
@@ -900,7 +1060,7 @@ public class PowerHalService extends HalServiceBase {
         DisplayManager displayManager = mContext.getSystemService(DisplayManager.class);
         Display display = displayManager.getDisplay(displayId);
         if (display != null) {
-            int displayPort = DisplayHelper.getPhysicalPort(display);
+            int displayPort = mDisplayHelper.getPhysicalPort(display);
             if (displayPort != DisplayHelper.INVALID_PORT) {
                 return displayPort;
             }
diff --git a/service/src/com/android/car/hal/PropertyHalService.java b/service/src/com/android/car/hal/PropertyHalService.java
index e995f3755c..91e6b118fc 100644
--- a/service/src/com/android/car/hal/PropertyHalService.java
+++ b/service/src/com/android/car/hal/PropertyHalService.java
@@ -32,10 +32,11 @@ import static android.car.hardware.property.VehicleHalStatusCode.STATUS_NOT_AVAI
 import static android.car.hardware.property.VehicleHalStatusCode.STATUS_NOT_AVAILABLE_SPEED_LOW;
 import static android.car.hardware.property.VehicleHalStatusCode.STATUS_TRY_AGAIN;
 
-import static com.android.car.internal.common.CommonConstants.EMPTY_INT_ARRAY;
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DEBUGGING_CODE;
 import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DUMP_INFO;
-import static com.android.car.internal.property.CarPropertyErrorCodes.convertVhalStatusCodeToCarPropertyManagerErrorCodes;
+import static com.android.car.internal.common.CommonConstants.EMPTY_INT_ARRAY;
 import static com.android.car.internal.property.CarPropertyErrorCodes.STATUS_OK;
+import static com.android.car.internal.property.CarPropertyErrorCodes.convertVhalStatusCodeToCarPropertyManagerErrorCodes;
 import static com.android.car.internal.property.CarPropertyHelper.isSystemProperty;
 import static com.android.car.internal.property.GetSetValueResult.newGetValueResult;
 import static com.android.car.internal.property.InputSanitizationUtils.sanitizeUpdateRateHz;
@@ -155,6 +156,7 @@ public class PropertyHalService extends HalServiceBase {
 
     public record ClientType(Integer requestId) {
         @Override
+        @ExcludeFromCodeCoverageGeneratedReport(reason = DEBUGGING_CODE)
         public String toString() {
             if (requestId == CAR_PROP_SVC_REQUEST_ID) {
                 return "PropertyHalService.subscribeProperty";
@@ -433,7 +435,7 @@ public class PropertyHalService extends HalServiceBase {
                     AsyncPropRequestInfo requestInfo =
                             getPendingAsyncPropRequestInfoLocked(serviceRequestId);
                     if (requestInfo == null) {
-                        Slogf.w(TAG, "The pending request: %d finished before timeout handler",
+                        Slogf.i(TAG, "The pending request: %d finished before timeout handler",
                                 serviceRequestId);
                         continue;
                     }
@@ -445,7 +447,8 @@ public class PropertyHalService extends HalServiceBase {
                 }
             }
             for (int i = 0; i < callbackToRequestIds.size(); i++) {
-                callbackToRequestIds.keyAt(i).onRequestsTimeout(callbackToRequestIds.valueAt(i));
+                callbackToRequestIds.keyAt(i).onRequestsTimeout(
+                        callbackToRequestIds.valueAt(i), /* fromVhal= */ false);
             }
         }
     }
@@ -851,17 +854,29 @@ public class PropertyHalService extends HalServiceBase {
 
         @Override
         public void onRequestsTimeout(List<Integer> serviceRequestIds) {
+            onRequestsTimeout(serviceRequestIds, /* fromVhal= */ true);
+        }
+
+        private void onRequestsTimeout(List<Integer> serviceRequestIds, boolean fromVhal) {
+            if (fromVhal) {
+                Slogf.w(TAG, "Requests timeout from VHAL, service Request IDs: %s",
+                        serviceRequestIds);
+            } else {
+                Slogf.w(TAG, "Requests timeout internally, service Request IDs: %s",
+                        serviceRequestIds);
+            }
             List<GetSetValueResultWrapper> timeoutGetResults = new ArrayList<>();
             List<GetSetValueResultWrapper> timeoutSetResults = new ArrayList<>();
             synchronized (mLock) {
                 for (int i = 0; i < serviceRequestIds.size(); i++) {
                     int serviceRequestId = serviceRequestIds.get(i);
                     AsyncPropRequestInfo requestInfo =
-                            getAndRemovePendingAsyncPropRequestInfoLocked(serviceRequestId);
+                            getAndRemovePendingAsyncPropRequestInfoLocked(serviceRequestId,
+                                    /* alreadyTimedOut= */ true);
                     if (requestInfo == null) {
-                        Slogf.w(TAG, "Service request ID %d time out but no "
+                        Slogf.i(TAG, "Service request ID %d time out but no "
                                 + "pending request is found. The request may have already been "
-                                + "cancelled or finished", serviceRequestId);
+                                + "cancelled, timeout or finished", serviceRequestId);
                         continue;
                     }
                     if (DBG) {
@@ -942,7 +957,7 @@ public class PropertyHalService extends HalServiceBase {
         AsyncPropRequestInfo requestInfo =
                 mPendingAsyncRequests.getRequestIfFound(serviceRequestId);
         if (requestInfo == null) {
-            Slogf.w(TAG, "the request for propertyHalService request "
+            Slogf.i(TAG, "the request for propertyHalService request "
                     + "ID: %d already timed out or already completed", serviceRequestId);
         }
         return requestInfo;
@@ -951,13 +966,18 @@ public class PropertyHalService extends HalServiceBase {
     @GuardedBy("mLock")
     @Nullable private AsyncPropRequestInfo getAndRemovePendingAsyncPropRequestInfoLocked(
             int serviceRequestId) {
+        return getAndRemovePendingAsyncPropRequestInfoLocked(serviceRequestId,
+                /* alreadyTimedOut= */ false);
+    }
+
+    @GuardedBy("mLock")
+    @Nullable private AsyncPropRequestInfo getAndRemovePendingAsyncPropRequestInfoLocked(
+            int serviceRequestId, boolean alreadyTimedOut) {
         AsyncPropRequestInfo requestInfo = getPendingAsyncPropRequestInfoLocked(serviceRequestId);
         if (requestInfo == null) {
-            Slogf.w(TAG, "the request for propertyHalService request "
-                    + "ID: %d already timed out or already completed", serviceRequestId);
             return null;
         }
-        removePendingAsyncPropRequestInfoLocked(requestInfo);
+        removePendingAsyncPropRequestInfoLocked(requestInfo, alreadyTimedOut);
         return requestInfo;
     }
 
@@ -974,8 +994,25 @@ public class PropertyHalService extends HalServiceBase {
      */
     @GuardedBy("mLock")
     private void removePendingAsyncPropRequestInfoLocked(AsyncPropRequestInfo pendingRequest) {
+        removePendingAsyncPropRequestInfoLocked(pendingRequest, /* alreadyTimedOut= */ false);
+    }
+
+    /**
+     * Remove the pending async request from the pool.
+     *
+     * If the request to remove is an async set request, also remove it from the
+     * {@code mHalPropIdToWaitingUpdateRequestInfo} map. This will cause the subscription rate to
+     * be updated for the specific property because we no longer need to monitor this property
+     * any more internally.
+     *
+     * The {@code updatedAreaIdsByHalPropIds} will store the affected area Ids and property IDs if
+     * their subscription rate need to be recalculated.
+     */
+    @GuardedBy("mLock")
+    private void removePendingAsyncPropRequestInfoLocked(AsyncPropRequestInfo pendingRequest,
+            boolean alreadyTimedOut) {
         int serviceRequestId = pendingRequest.getServiceRequestId();
-        mPendingAsyncRequests.removeRequest(serviceRequestId);
+        mPendingAsyncRequests.removeRequest(serviceRequestId, alreadyTimedOut);
         if (pendingRequest.getRequestType() == SET) {
             cleanupPendingAsyncSetRequestLocked(pendingRequest);
         }
diff --git a/service/src/com/android/car/hal/VehicleHal.java b/service/src/com/android/car/hal/VehicleHal.java
index ec0b30e648..051dc6e927 100644
--- a/service/src/com/android/car/hal/VehicleHal.java
+++ b/service/src/com/android/car/hal/VehicleHal.java
@@ -64,6 +64,7 @@ import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.util.IndentingPrintWriter;
 import com.android.car.internal.util.Lists;
 import com.android.car.internal.util.PairSparseArray;
+import com.android.car.systeminterface.DisplayHelperInterface;
 import com.android.internal.annotations.GuardedBy;
 import com.android.internal.annotations.VisibleForTesting;
 
@@ -270,7 +271,8 @@ public class VehicleHal implements VehicleHalCallback, CarSystemService {
         mPropValueBuilder = vehicle.getHalPropValueBuilder();
         mHandlerThread = handlerThread;
         mHandler = new Handler(mHandlerThread.getLooper());
-        mPowerHal = powerHal != null ? powerHal : new PowerHalService(context, mFeatureFlags, this);
+        mPowerHal = powerHal != null ? powerHal : new PowerHalService(context, mFeatureFlags, this,
+                new DisplayHelperInterface.DefaultImpl());
         mPropertyHal = propertyHal != null ? propertyHal : new PropertyHalService(this);
         mInputHal = inputHal != null ? inputHal : new InputHalService(this);
         mVmsHal = vmsHal != null ? vmsHal : new VmsHalService(context, this);
diff --git a/service/src/com/android/car/hal/property/HalPropertyDebugUtils.java b/service/src/com/android/car/hal/property/HalPropertyDebugUtils.java
index 6010534353..9ade77e7a4 100644
--- a/service/src/com/android/car/hal/property/HalPropertyDebugUtils.java
+++ b/service/src/com/android/car/hal/property/HalPropertyDebugUtils.java
@@ -16,6 +16,7 @@
 
 package com.android.car.hal.property;
 
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.PRIVATE_CONSTRUCTOR;
 import static com.android.car.internal.util.ConstantDebugUtils.toName;
 
 import static java.lang.Integer.toHexString;
@@ -40,6 +41,7 @@ import android.util.ArrayMap;
 import android.util.Slog;
 
 import com.android.car.hal.HalPropValue;
+import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.property.CarPropertyHelper;
 import com.android.car.internal.util.ConstantDebugUtils;
 
@@ -66,6 +68,7 @@ public final class HalPropertyDebugUtils {
      * HalPropertyDebugUtils only contains static fields and methods and must never be
      * instantiated.
      */
+    @ExcludeFromCodeCoverageGeneratedReport(reason = PRIVATE_CONSTRUCTOR)
     private HalPropertyDebugUtils() {
         throw new UnsupportedOperationException("Must never be called");
     }
diff --git a/service/src/com/android/car/hal/property/HalValueDebugUtils.java b/service/src/com/android/car/hal/property/HalValueDebugUtils.java
index 9847fb5be1..4610699275 100644
--- a/service/src/com/android/car/hal/property/HalValueDebugUtils.java
+++ b/service/src/com/android/car/hal/property/HalValueDebugUtils.java
@@ -16,8 +16,11 @@
 
 package com.android.car.hal.property;
 
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.PRIVATE_CONSTRUCTOR;
+
 import android.hardware.automotive.vehicle.EnumForVehicleProperty;
 
+import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.util.ConstantDebugUtils;
 
 /**
@@ -28,6 +31,7 @@ public final class HalValueDebugUtils {
      * HalValueDebugUtils only contains static fields and methods and must never be
      * instantiated.
      */
+    @ExcludeFromCodeCoverageGeneratedReport(reason = PRIVATE_CONSTRUCTOR)
     private HalValueDebugUtils() {
         throw new UnsupportedOperationException("Must never be called");
     }
diff --git a/service/src/com/android/car/hal/property/PropertyHalServiceConfigs.java b/service/src/com/android/car/hal/property/PropertyHalServiceConfigs.java
index 37d4aa5a11..89865969ed 100644
--- a/service/src/com/android/car/hal/property/PropertyHalServiceConfigs.java
+++ b/service/src/com/android/car/hal/property/PropertyHalServiceConfigs.java
@@ -18,6 +18,8 @@ package com.android.car.hal.property;
 
 import static android.car.Car.PERMISSION_VENDOR_EXTENSION;
 
+import static java.util.Objects.requireNonNull;
+
 import android.annotation.Nullable;
 import android.car.VehiclePropertyIds;
 import android.car.builtin.os.TraceHelper;
@@ -39,6 +41,7 @@ import com.android.car.hal.property.PropertyPermissionInfo.AllOfPermissions;
 import com.android.car.hal.property.PropertyPermissionInfo.AnyOfPermissions;
 import com.android.car.hal.property.PropertyPermissionInfo.PermissionCondition;
 import com.android.car.hal.property.PropertyPermissionInfo.PropertyPermissions;
+import com.android.car.hal.property.PropertyPermissionInfo.PropertyPermissionsBuilder;
 import com.android.car.hal.property.PropertyPermissionInfo.SinglePermission;
 import com.android.car.internal.property.CarPropertyHelper;
 import com.android.internal.annotations.GuardedBy;
@@ -50,7 +53,6 @@ import java.io.InputStreamReader;
 import java.util.ArrayList;
 import java.util.Collections;
 import java.util.List;
-import java.util.Objects;
 import java.util.Set;
 
 /**
@@ -77,58 +79,16 @@ public class PropertyHalServiceConfigs {
      * listed in {@code validBitFlag}.
      */
     @VisibleForTesting
-    /* package */ static final class CarSvcPropertyConfig {
-        public int propertyId;
-        public int halPropId;
-        public String propertyName;
-        public String description;
-        public PropertyPermissions permissions;
-        public Set<Integer> dataEnums;
-        public Integer validBitFlag;
-
-        @Override
-        public boolean equals(Object object) {
-            if (object == this) {
-                return true;
-            }
-            // instanceof will return false if object is null.
-            if (!(object instanceof CarSvcPropertyConfig)) {
-                return false;
-            }
-            CarSvcPropertyConfig other = (CarSvcPropertyConfig) object;
-            return (propertyId == other.propertyId
-                    && halPropId == other.halPropId
-                    && Objects.equals(propertyName, other.propertyName)
-                    && Objects.equals(description, other.description)
-                    && Objects.equals(permissions, other.permissions)
-                    && Objects.equals(dataEnums, other.dataEnums)
-                    && Objects.equals(validBitFlag, other.validBitFlag));
-        }
-
-        @Override
-        public int hashCode() {
-            return propertyId + halPropId + Objects.hashCode(propertyName)
-                    + Objects.hashCode(description) + Objects.hashCode(permissions)
-                    + Objects.hashCode(dataEnums) + Objects.hashCode(validBitFlag);
-        }
-
-        @Override
-        public String toString() {
-            StringBuilder stringBuffer = new StringBuilder().append("CarSvcPropertyConfig{");
-            stringBuffer.append("propertyId: ").append(propertyId)
-                    .append(", halPropId: ").append(halPropId)
-                    .append(", propertyName: ").append(propertyName)
-                    .append(", description: ").append(description)
-                    .append(", permissions: ").append(permissions);
-            if (dataEnums != null) {
-                stringBuffer.append(", dataEnums: ").append(dataEnums);
-            }
-            if (validBitFlag != null) {
-                stringBuffer.append(", validBitFlag: ").append(validBitFlag);
-            }
-            return stringBuffer.append("}").toString();
+    /* package */ record CarSvcPropertyConfig(
+            int propertyId, int halPropId, String propertyName, String description,
+            PropertyPermissions permissions, @Nullable Set<Integer> dataEnums,
+            @Nullable Integer validBitFlag) {
+        public CarSvcPropertyConfig {
+            requireNonNull(propertyName);
+            requireNonNull(description);
+            requireNonNull(permissions);
         }
-    };
+    }
 
     private static final String CONFIG_RESOURCE_NAME = "CarSvcProps.json";
     private static final String JSON_FIELD_NAME_PROPERTIES = "properties";
@@ -172,9 +132,9 @@ public class PropertyHalServiceConfigs {
         List<Integer> halPropIdMgrIds = new ArrayList<>();
         for (int i = 0; i < mHalPropIdToCarSvcConfig.size(); i++) {
             CarSvcPropertyConfig config = mHalPropIdToCarSvcConfig.valueAt(i);
-            if (config.halPropId != config.propertyId) {
-                halPropIdMgrIds.add(config.propertyId);
-                halPropIdMgrIds.add(config.halPropId);
+            if (config.halPropId() != config.propertyId()) {
+                halPropIdMgrIds.add(config.propertyId());
+                halPropIdMgrIds.add(config.halPropId());
             }
         }
         int[] halPropIdMgrIdArray = new int[halPropIdMgrIds.size()];
@@ -265,11 +225,11 @@ public class PropertyHalServiceConfigs {
             // This is not a system property.
             return true;
         }
-        if (carSvcPropertyConfig.dataEnums != null) {
-            return checkDataEnum(propValue, carSvcPropertyConfig.dataEnums);
+        if (carSvcPropertyConfig.dataEnums() != null) {
+            return checkDataEnum(propValue, carSvcPropertyConfig.dataEnums());
         }
-        if (carSvcPropertyConfig.validBitFlag != null) {
-            return checkValidBitFlag(propValue, carSvcPropertyConfig.validBitFlag);
+        if (carSvcPropertyConfig.validBitFlag() != null) {
+            return checkValidBitFlag(propValue, carSvcPropertyConfig.validBitFlag());
         }
         return true;
     }
@@ -292,7 +252,7 @@ public class PropertyHalServiceConfigs {
                     + " no read permission");
             return null;
         }
-        return carSvcPropertyConfig.permissions.getReadPermission();
+        return carSvcPropertyConfig.permissions().readPermission();
     }
 
     @Nullable
@@ -305,7 +265,7 @@ public class PropertyHalServiceConfigs {
                         + ", default to PERMISSION_VENDOR_EXTENSION");
                 return SINGLE_PERMISSION_VENDOR_EXTENSION;
             }
-            PermissionCondition readPermission = propertyPermissions.getReadPermission();
+            PermissionCondition readPermission = propertyPermissions.readPermission();
             if (readPermission == null) {
                 Slogf.v(TAG, "vendor propId is not available for reading: " + halPropIdName);
             }
@@ -331,7 +291,7 @@ public class PropertyHalServiceConfigs {
                     + " no write permission");
             return null;
         }
-        return carSvcPropertyConfig.permissions.getWritePermission();
+        return carSvcPropertyConfig.permissions().writePermission();
     }
 
     @Nullable
@@ -344,7 +304,7 @@ public class PropertyHalServiceConfigs {
                         + ", default to PERMISSION_VENDOR_EXTENSION");
                 return SINGLE_PERMISSION_VENDOR_EXTENSION;
             }
-            PermissionCondition writePermission = propertyPermissions.getWritePermission();
+            PermissionCondition writePermission = propertyPermissions.writePermission();
             if (writePermission == null) {
                 Slogf.v(TAG, "vendor propId is not available for writing: " + halPropIdName);
             }
@@ -424,8 +384,8 @@ public class PropertyHalServiceConfigs {
                     continue;
                 }
 
-                PropertyPermissions.Builder propertyPermissionBuilder =
-                        new PropertyPermissions.Builder();
+                PropertyPermissionsBuilder propertyPermissionBuilder =
+                        new PropertyPermissionsBuilder();
                 if (readPermissionStr != null) {
                     propertyPermissionBuilder.setReadPermission(
                             new SinglePermission(readPermissionStr));
@@ -500,7 +460,7 @@ public class PropertyHalServiceConfigs {
                         if (config == null) {
                             return;
                         }
-                        configs.put(config.halPropId, config);
+                        configs.put(config.halPropId(), config);
                     });
                 });
             }
@@ -597,42 +557,41 @@ public class PropertyHalServiceConfigs {
                         + featureFlag + " for property: " + propertyName);
             }
         }
-        CarSvcPropertyConfig config = new CarSvcPropertyConfig();
-        config.propertyName = propertyName;
         if (description == null) {
             throw new IllegalArgumentException("Missing required description field for property: "
                     + propertyName);
         }
-        config.description = description;
         if (propertyId == 0) {
             throw new IllegalArgumentException("Missing required propertyId field for property: "
                     + propertyName);
         }
-        config.propertyId = propertyId;
+        int halPropId;
         if (vhalPropertyId != 0) {
-            config.halPropId = vhalPropertyId;
+            halPropId = vhalPropertyId;
         } else {
-            config.halPropId = propertyId;
+            halPropId = propertyId;
         }
-        if (!dataEnums.isEmpty()) {
-            config.dataEnums = dataEnums;
+        if (dataEnums.isEmpty()) {
+            dataEnums = null;
         }
+        Integer validBitFlag = null;
         if (!dataFlags.isEmpty()) {
-            config.validBitFlag = generateAllCombination(dataFlags);
+            validBitFlag = generateAllCombination(dataFlags);
         }
         if (readPermission == null && writePermission == null) {
             throw new IllegalArgumentException(
                     "No read or write permission specified for: " + propertyName);
         }
-        var builder = new PropertyPermissions.Builder();
+        var builder = new PropertyPermissionsBuilder();
         if (readPermission != null) {
             builder.setReadPermission(readPermission);
         }
         if (writePermission != null) {
             builder.setWritePermission(writePermission);
         }
-        config.permissions = builder.build();
-        return config;
+        PropertyPermissions permissions = builder.build();
+        return new CarSvcPropertyConfig(propertyId, halPropId, propertyName, description,
+                permissions, dataEnums, validBitFlag);
     }
 
     private interface RunanbleWithException {
diff --git a/service/src/com/android/car/hal/property/PropertyPermissionInfo.java b/service/src/com/android/car/hal/property/PropertyPermissionInfo.java
index 8965150462..942316c23e 100644
--- a/service/src/com/android/car/hal/property/PropertyPermissionInfo.java
+++ b/service/src/com/android/car/hal/property/PropertyPermissionInfo.java
@@ -72,95 +72,49 @@ import java.util.Objects;
  */
 public class PropertyPermissionInfo {
     /**
-     * Class to hold {@code readPermission} and {@code writePermission} in a single object.
+     * The builder for {@link PropertyPermissions}.
      */
-    public static final class PropertyPermissions {
+    public static final class PropertyPermissionsBuilder {
         @Nullable
-        private final PermissionCondition mReadPermission;
+        private PermissionCondition mReadPermission;
         @Nullable
-        private final PermissionCondition mWritePermission;
+        private PermissionCondition mWritePermission;
 
-        private PropertyPermissions(@Nullable PermissionCondition readPermission,
-                @Nullable PermissionCondition writePermission) {
+        /**
+         * Sets the read permission.
+         */
+        public PropertyPermissionsBuilder setReadPermission(PermissionCondition readPermission) {
             mReadPermission = readPermission;
-            mWritePermission = writePermission;
-        }
-
-        @Nullable
-        public PermissionCondition getReadPermission() {
-            return mReadPermission;
-        }
-
-        @Nullable
-        public PermissionCondition getWritePermission() {
-            return mWritePermission;
+            return this;
         }
 
         /**
-         * The builder for {@link PropertyPermissions}.
+         * Sets the write permission.
          */
-        public static final class Builder {
-            @Nullable
-            private PermissionCondition mReadPermission;
-            @Nullable
-            private PermissionCondition mWritePermission;
-
-            /**
-             * Sets the read permission.
-             */
-            public Builder setReadPermission(PermissionCondition readPermission) {
-                mReadPermission = readPermission;
-                return this;
-            }
-
-            /**
-             * Sets the write permission.
-             */
-            public Builder setWritePermission(PermissionCondition writePermission) {
-                mWritePermission = writePermission;
-                return this;
-            }
-
-            /**
-             * Builds the permission.
-             */
-            public PropertyPermissions build() {
-                if (mReadPermission == null && mWritePermission == null) {
-                    throw new IllegalStateException("Both read and write permissions have not been "
-                        + "set");
-                }
-                return new PropertyPermissions(mReadPermission, mWritePermission);
-            }
+        public PropertyPermissionsBuilder setWritePermission(PermissionCondition writePermission) {
+            mWritePermission = writePermission;
+            return this;
         }
 
-        @Override
-        public boolean equals(Object object) {
-            if (this == object) {
-                return true;
-            }
-            // instanceof will return false if object is null.
-            if (!(object instanceof PropertyPermissions)) {
-                return false;
+        /**
+         * Builds the permission.
+         */
+        public PropertyPermissions build() {
+            if (mReadPermission == null && mWritePermission == null) {
+                throw new IllegalStateException("Both read and write permissions have not been "
+                    + "set");
             }
-            PropertyPermissions other = (PropertyPermissions) object;
-            return Objects.equals(mReadPermission, other.getReadPermission())
-                    && Objects.equals(mWritePermission, other.getWritePermission());
-        }
-
-        @Override
-        public int hashCode() {
-            return Objects.hashCode(mReadPermission) + Objects.hashCode(mWritePermission);
-        }
-
-        @Override
-        public String toString() {
-            return new StringBuilder().append("{")
-                    .append("readPermission: ").append(mReadPermission)
-                    .append("writePermission: ").append(mWritePermission)
-                    .append("}").toString();
+            return new PropertyPermissions(mReadPermission, mWritePermission);
         }
     }
 
+    /**
+     * Class to hold {@code readPermission} and {@code writePermission} in a single object.
+     */
+    /* package */ record PropertyPermissions(
+            @Nullable PermissionCondition readPermission,
+            @Nullable PermissionCondition writePermission) {}
+
     /**
      * An interface for representing the read and write permissions required for each property.
      * <p>
diff --git a/service/src/com/android/car/pm/CarPackageManagerService.java b/service/src/com/android/car/pm/CarPackageManagerService.java
index 854229a149..d95ee17ed3 100644
--- a/service/src/com/android/car/pm/CarPackageManagerService.java
+++ b/service/src/com/android/car/pm/CarPackageManagerService.java
@@ -210,7 +210,7 @@ public final class CarPackageManagerService extends ICarPackageManager.Stub
 
     private final ComponentName mActivityBlockingActivity;
     // Memorize the target of ABA to defend bypassing it with launching two Activities continuously.
-    private final SparseArray<ComponentName> mBlockingActivityTargets = new SparseArray<>();
+    private final SparseArray<TaskInfo> mBlockingActivityTargets = new SparseArray<>();
     private final SparseLongArray mBlockingActivityLaunchTimes = new SparseLongArray();
     private final boolean mPreventTemplatedAppsFromShowingDialog;
     private final String mTemplateActivityClassName;
@@ -1497,12 +1497,7 @@ public final class CarPackageManagerService extends ICarPackageManager.Stub
      * @return {@code true} if the {@code topTask} was blocked, {@code false} otherwise.
      */
     private boolean doBlockTopActivityIfNotAllowed(int displayId, TaskInfo topTask) {
-        if (topTask.topActivity == null) {
-            return false;
-        }
-        if (topTask.topActivity.equals(mActivityBlockingActivity)) {
-            mBlockingActivityLaunchTimes.put(displayId, 0);
-            mBlockingActivityTargets.put(displayId, null);
+        if (isBlockingUiTask(topTask)) {
             // If topTask is already ActivityBlockingActivity, treat it as already blocked.
             return true;
         }
@@ -1526,8 +1521,8 @@ public final class CarPackageManagerService extends ICarPackageManager.Stub
         // (TaskStackChangeListener reflects the internal state of ActivityTaskManagerService)
         // So it takes some time to recognize the ActivityBlockingActivity is shown.
         // This guard is to prevent from launching ABA repeatedly until it is shown.
-        ComponentName blockingActivityTarget = mBlockingActivityTargets.get(displayId);
-        if (topTask.topActivity.equals(blockingActivityTarget)) {
+        TaskInfo blockingActivityTarget = mBlockingActivityTargets.get(displayId);
+        if (blockingActivityTarget != null && topTask.taskId == blockingActivityTarget.taskId) {
             long blockingActivityLaunchTime = mBlockingActivityLaunchTimes.get(displayId);
             if (SystemClock.uptimeMillis() - blockingActivityLaunchTime < ABA_LAUNCH_TIMEOUT_MS) {
                 Slogf.d(TAG, "Waiting for BlockingActivity to be shown: displayId=%d", displayId);
@@ -1556,7 +1551,7 @@ public final class CarPackageManagerService extends ICarPackageManager.Stub
         }
         mBlockedActivityLogs.log(log);
         mBlockingActivityLaunchTimes.put(displayId, SystemClock.uptimeMillis());
-        mBlockingActivityTargets.put(displayId, topTask.topActivity);
+        mBlockingActivityTargets.put(displayId, topTask);
         mActivityService.blockActivity(topTask, newActivityIntent);
         return true;
     }
@@ -1952,8 +1947,10 @@ public final class CarPackageManagerService extends ICarPackageManager.Stub
             blockTopActivityIfNecessary(topTask);
         }
 
+        // TODO(b/358905871): Verify if onTaskInfoChanged required to trigger finishing of
+        //  blocking ui.
         @Override
-        public void onActivityChangedInBackstack(TaskInfo taskInfo) {
+        public void onTaskVanished(TaskInfo taskInfo) {
             if (taskInfo == null) {
                 Slogf.e(TAG, "Received callback with null task info.");
                 return;
@@ -1968,23 +1965,52 @@ public final class CarPackageManagerService extends ICarPackageManager.Stub
                 }
                 lastKnownDisplayId = mLastKnownDisplayIdForTask.get(taskInfo.taskId);
             }
-            if (DBG) {
-                Slogf.i(TAG, "Callback for task %s on display id %d.", taskInfo.taskId,
-                        lastKnownDisplayId);
-            }
-            // Only finish the blocking ui if it is visible and there is some change in the
-            // backstack for the activity that is being blocked. This is because the blocked
-            // activity could have crashed due to which there is a need for blocking ui to finish.
+            // Only finish the blocking ui if it is visible and the activity that is being
+            // blocked has vanished which could have crashed due to which there is a need for
+            // blocking ui to finish.
             if (isBlockingUiVisible(lastKnownDisplayId) && isBlockedActivityTarget(
                     lastKnownDisplayId, taskInfo)) {
+                if (DBG) {
+                    Slogf.d(TAG,
+                            "Finish blocking ui callback due to task %s which was blocked on "
+                                    + "display id %d.", taskInfo.taskId, lastKnownDisplayId);
+                }
                 mHandler.post(() -> finishBlockingUi(taskInfo));
                 synchronized (mLock) {
                     mBlockingUiTaskInfoPerDisplay.delete(lastKnownDisplayId);
                 }
+                cleanUpBlockingUiInformation(lastKnownDisplayId);
+            } else if (isBlockingUiTask(taskInfo)) {
+                if (DBG) {
+                    Slogf.d(TAG, "Blocking ui has vanished on display id %d.", lastKnownDisplayId);
+                }
+                cleanUpBlockingUiInformation(lastKnownDisplayId);
             }
         }
     }
 
+    /**
+     * Cleans up blocking ui information since either the blocking ui itself finished or the task
+     * that was being blocked by the blocking ui finished. In both the cases, the blocking ui will
+     * be finishing itself, so clean up the information.
+     */
+    private void cleanUpBlockingUiInformation(int lastKnownDisplayId) {
+        if (mBlockingActivityTargets.contains(lastKnownDisplayId)) {
+            mBlockingActivityLaunchTimes.put(lastKnownDisplayId, 0);
+            mBlockingActivityTargets.delete(lastKnownDisplayId);
+        }
+    }
+
+    /**
+     * Checks if the {@link TaskInfo} is the blocking ui.
+     *
+     * @return {@code true} if blocking ui is the {@link TaskInfo}, {@code false} otherwise.
+     */
+    private boolean isBlockingUiTask(TaskInfo taskInfo) {
+        return taskInfo.topActivity != null && taskInfo.topActivity.equals(
+                mActivityBlockingActivity);
+    }
+
     /**
      * Checks if blocking ui is visible on that {@code displayId}.
      *
@@ -2009,7 +2035,7 @@ public final class CarPackageManagerService extends ICarPackageManager.Stub
      * {@code displayId}, {@code false} otherwise.
      */
     private boolean isBlockedActivityTarget(int displayId, TaskInfo taskInfo) {
-        return mBlockingActivityTargets.get(displayId) == taskInfo.topActivity;
+        return mBlockingActivityTargets.get(displayId).taskId == taskInfo.taskId;
     }
 
     /**
diff --git a/service/src/com/android/car/pm/TEST_MAPPING b/service/src/com/android/car/pm/TEST_MAPPING
index 667c89a440..1526fe5dff 100644
--- a/service/src/com/android/car/pm/TEST_MAPPING
+++ b/service/src/com/android/car/pm/TEST_MAPPING
@@ -1,15 +1,7 @@
 {
   "auto-postsubmit": [
     {
-      "name": "CarServiceTest",
-      "options" : [
-        {
-          "include-filter": "com.android.car.pm.CarPackageManagerServiceTest"
-        },
-        {
-          "include-filter": "com.android.car.CarPackageManagerTest"
-        }
-      ]
+      "name": "CarServicePmTest"
     },
     {
       "name": "CarServiceUnitTest",
diff --git a/service/src/com/android/car/pm/VendorServiceController.java b/service/src/com/android/car/pm/VendorServiceController.java
index e721b6e24a..09fdb67a90 100644
--- a/service/src/com/android/car/pm/VendorServiceController.java
+++ b/service/src/com/android/car/pm/VendorServiceController.java
@@ -30,7 +30,6 @@ import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DU
 import android.annotation.Nullable;
 import android.annotation.SuppressLint;
 import android.annotation.UserIdInt;
-import android.app.ActivityManager;
 import android.car.builtin.util.Slogf;
 import android.car.hardware.power.CarPowerManager;
 import android.car.hardware.power.ICarPowerStateListener;
@@ -60,7 +59,9 @@ import com.android.car.R;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.util.IndentingPrintWriter;
 import com.android.car.power.CarPowerManagementService;
+import com.android.car.user.ActivityManagerCurrentUserFetcher;
 import com.android.car.user.CarUserService;
+import com.android.car.user.CurrentUserFetcher;
 import com.android.internal.annotations.VisibleForTesting;
 
 import java.io.PrintWriter;
@@ -97,6 +98,7 @@ final class VendorServiceController implements UserLifecycleListener {
     private final Handler mHandler;
     private CarUserService mCarUserService;
     private CarPowerManagementService mPowerManagementService;
+    private CurrentUserFetcher mCurrentUserFetcher;
 
     private final BroadcastReceiver mPackageChangeReceiver = new BroadcastReceiver() {
         @Override
@@ -152,9 +154,16 @@ final class VendorServiceController implements UserLifecycleListener {
             };
 
     VendorServiceController(Context context, Looper looper) {
+        this(context, looper, new ActivityManagerCurrentUserFetcher());
+    }
+
+    @VisibleForTesting
+    VendorServiceController(Context context, Looper looper,
+            CurrentUserFetcher currentUserFetcher) {
         mContext = context;
         mUserManager = context.getSystemService(UserManager.class);
         mHandler = new Handler(looper);
+        mCurrentUserFetcher = currentUserFetcher;
     }
 
     void init() {
@@ -289,7 +298,7 @@ final class VendorServiceController implements UserLifecycleListener {
                     packageName, userId);
         }
 
-        int currentUserId = ActivityManager.getCurrentUser();
+        int currentUserId = mCurrentUserFetcher.getCurrentUser();
         int size = mVendorServiceInfos.size();
         for (int i = 0; i < size; i++) {
             VendorServiceInfo serviceInfo = mVendorServiceInfos.get(i);
@@ -317,7 +326,7 @@ final class VendorServiceController implements UserLifecycleListener {
     private void handleOnUserSwitching(@UserIdInt int userId) {
         // The user switch notification is obsolete if userId is different from the current
         // foreground user. Ignore it.
-        int currentUserId = ActivityManager.getCurrentUser();
+        int currentUserId = mCurrentUserFetcher.getCurrentUser();
         if (currentUserId != userId) {
             Slogf.w(TAG, "Received userSwitch event for user " + userId
                     + " while current foreground user is " + currentUserId + "."
@@ -375,7 +384,7 @@ final class VendorServiceController implements UserLifecycleListener {
 
     private void startOrBindServicesForUser(UserHandle user, @Nullable Boolean forPostUnlock) {
         boolean unlocked = mUserManager.isUserUnlockingOrUnlocked(user);
-        int currentUserId = ActivityManager.getCurrentUser();
+        int currentUserId = mCurrentUserFetcher.getCurrentUser();
         int userId = user.getIdentifier();
         for (VendorServiceInfo service: mVendorServiceInfos) {
             if (forPostUnlock != null
@@ -443,7 +452,7 @@ final class VendorServiceController implements UserLifecycleListener {
         VendorServiceConnection connection = mConnections.get(key);
         if (connection == null) {
             connection = new VendorServiceConnection(mContext, mHandler, key.mVendorServiceInfo,
-                    key.mUserHandle);
+                    key.mUserHandle, mCurrentUserFetcher);
             mConnections.put(key, connection);
         }
 
@@ -489,14 +498,17 @@ final class VendorServiceController implements UserLifecycleListener {
         private final Context mUserContext;
         private final Handler mHandler;
         private final Handler mFailureHandler;
+        private final CurrentUserFetcher mCurrentUserFetcher;
 
         VendorServiceConnection(Context context, Handler handler,
-                VendorServiceInfo vendorServiceInfo, UserHandle user) {
+                VendorServiceInfo vendorServiceInfo, UserHandle user,
+                CurrentUserFetcher currentUserFetcher) {
             mHandler = handler;
             mVendorServiceInfo = vendorServiceInfo;
             mUser = user;
             mUserContext = context.createContextAsUser(mUser, /* flags= */ 0);
             mCarUserService = CarLocalServices.getService(CarUserService.class);
+            mCurrentUserFetcher = currentUserFetcher;
 
             mFailureHandler = new Handler(handler.getLooper()) {
                 @Override
@@ -540,7 +552,13 @@ final class VendorServiceController implements UserLifecycleListener {
                         /* executor= */ this, /* conn= */ this);
                 if (!canBind) {
                     // Still need to unbind when an attempt to bind fails.
-                    unbindService();
+                    try {
+                        unbindService();
+                    } catch (Exception e) {
+                        // When binding already failed, log and ignore an exception from unbind.
+                        Slogf.w(TAG, "After bindService() failed, unbindService() threw "
+                                + "an exception:", e);
+                    }
                 }
                 return canBind;
             } else if (mVendorServiceInfo.shouldBeStartedInForeground()) {
@@ -628,7 +646,7 @@ final class VendorServiceController implements UserLifecycleListener {
                 return;
             }
 
-            int currentUserId = ActivityManager.getCurrentUser();
+            int currentUserId = mCurrentUserFetcher.getCurrentUser();
             if (isUserInScope(mUser.getIdentifier(), mVendorServiceInfo, mCarUserService,
                     currentUserId)) {
                 // Double the delay after each failure.
diff --git a/service/src/com/android/car/power/CarPowerManagementService.java b/service/src/com/android/car/power/CarPowerManagementService.java
index 23a43f8de6..63e304c98e 100644
--- a/service/src/com/android/car/power/CarPowerManagementService.java
+++ b/service/src/com/android/car/power/CarPowerManagementService.java
@@ -40,6 +40,8 @@ import android.car.builtin.content.pm.PackageManagerHelper;
 import android.car.builtin.os.BuildHelper;
 import android.car.builtin.os.HandlerHelper;
 import android.car.builtin.os.ServiceManagerHelper;
+import android.car.builtin.os.SystemPropertiesHelper;
+import android.car.builtin.os.TraceHelper;
 import android.car.builtin.os.UserManagerHelper;
 import android.car.builtin.util.EventLogHelper;
 import android.car.builtin.util.Slogf;
@@ -99,6 +101,7 @@ import com.android.car.hal.PowerHalService;
 import com.android.car.hal.PowerHalService.BootupReason;
 import com.android.car.hal.PowerHalService.PowerState;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
+import com.android.car.internal.dep.Trace;
 import com.android.car.internal.util.DebugUtils;
 import com.android.car.internal.util.IndentingPrintWriter;
 import com.android.car.internal.util.Lists;
@@ -243,6 +246,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
     private final AtomicFile mWifiStateFile;
     private final AtomicFile mTetheringStateFile;
     private final boolean mWifiAdjustmentForSuspend;
+    private boolean mShouldChangeSwap = true;
 
     // This is a temp work-around to reduce user switching delay after wake-up.
     private final boolean mSwitchGuestUserBeforeSleep;
@@ -603,6 +607,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
 
     @Override
     public void init() {
+        Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "init");
         mPolicyReader.init(mFeatureFlags);
         mPowerComponentHandler.init(mPolicyReader.getCustomComponents());
         mHal.setListener(this);
@@ -617,6 +622,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
         }
         mSystemInterface.startDisplayStateMonitoring();
         connectToPowerPolicyDaemon();
+        Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
     }
 
     @Override
@@ -676,6 +682,9 @@ public class CarPowerManagementService extends ICarPower.Stub implements
                     mSystemInterface.isSystemSupportingHibernation());
             writer.printf("mLastShutdownState: %d\n", mLastShutdownState);
             writer.printf("mReadyForCallback: %b\n", mReadyForCallback.get());
+            if (mFeatureFlags.stopProcessBeforeSuspendToDisk()) {
+                writer.printf("Suspend to disk importance level: %d\n", getS2dImportanceLevel());
+            }
         }
 
         synchronized (mSimulationWaitObject) {
@@ -754,12 +763,14 @@ public class CarPowerManagementService extends ICarPower.Stub implements
 
     @Override
     public void onApPowerStateChange(PowerState state) {
+        Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "onApPowerStateChange");
         EventLogHelper.writeCarPowerManagerStateRequest(state.mState, state.mParam);
         synchronized (mLock) {
             mPendingPowerStates.addFirst(new CpmsState(state));
             mLock.notifyAll();
         }
         mHandler.handlePowerStateChange();
+        Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
     }
 
     @VisibleForTesting
@@ -781,6 +792,8 @@ public class CarPowerManagementService extends ICarPower.Stub implements
      */
     private void onApPowerStateChange(int apState,
             @CarPowerManager.CarPowerState int carPowerStateListenerState) {
+        Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE,
+                "onApPowerStateChange_internally_triggered");
         CpmsState newState = new CpmsState(apState, carPowerStateListenerState,
                 /* canPostpone= */ false);
         BiFunction<CpmsState, CpmsState, Boolean> eventFilter = null;
@@ -813,6 +826,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
                 for (int idx = 0; idx < mPendingPowerStates.size(); idx++) {
                     CpmsState pendingState = mPendingPowerStates.get(idx);
                     if (eventFilter.apply(newState, pendingState)) {
+                        Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                         return;
                     }
                 }
@@ -821,6 +835,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
             mLock.notifyAll();
         }
         mHandler.handlePowerStateChange();
+        Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
     }
 
     private void doHandlePowerStateChange() {
@@ -1148,6 +1163,10 @@ public class CarPowerManagementService extends ICarPower.Stub implements
     }
 
     private void handleShutdownPrepare(CpmsState currentState, CpmsState prevState) {
+        boolean areListenersEmpty;
+        synchronized (mLock) {
+            areListenersEmpty = mListenersWeAreWaitingFor.isEmpty();
+        }
         switch (currentState.mCarPowerStateListenerState) {
             case CarPowerManager.STATE_PRE_SHUTDOWN_PREPARE:
                 updateShutdownPrepareStatus(currentState);
@@ -1159,17 +1178,25 @@ public class CarPowerManagementService extends ICarPower.Stub implements
                     synchronized (mLock) {
                         mCurrentState = currentState;
                     }
-                    clearWaitingForCompletion(/*clearQueue=*/true);
+                    if (!areListenersEmpty) {
+                        Slogf.e(TAG, "Received 2nd shutdown request. Waiting for listeners.");
+                    } else {
+                        // new shutdown prepare request can interrupt completion of shutdown prepare
+                        // call handler to complete it - this may result in 2nd call
+                        // to finishShutdownPrepare()
+                        Slogf.e(TAG,
+                                "Received 2nd shutdown request after listeners were completed");
+                        finishShutdownPrepare();
+                    }
                 } else if (prevState.mCarPowerStateListenerState == STATE_PRE_SHUTDOWN_PREPARE) {
                     // Update of state occurred while in PRE_SHUTDOWN_PREPARE
-                    boolean areListenersEmpty;
-                    synchronized (mLock) {
-                        areListenersEmpty = mListenersWeAreWaitingFor.isEmpty();
-                    }
                     if (areListenersEmpty) {
                         handleCoreShutdownPrepare();
                     } else {
                         // PRE_SHUTDOWN_PREPARE is still being processed, no actions required
+                        Slogf.e(TAG,
+                                "Received 2nd shutdown request. Waiting for listener"
+                            + " to complete");
                         return;
                     }
                 } else {
@@ -1855,7 +1882,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
     }
 
     private void doHandleDisplayBrightnessChange(int displayId, int brightness) {
-        mSystemInterface.setDisplayBrightness(displayId, brightness);
+        mSystemInterface.onDisplayBrightnessChangeFromVhal(displayId, brightness);
     }
 
     private void doHandleDisplayStateChange(int displayId, boolean on) {
@@ -1904,8 +1931,8 @@ public class CarPowerManagementService extends ICarPower.Stub implements
      * Sends display brightness to VHAL.
      * @param brightness value 0-100%
      */
-    public void sendDisplayBrightness(int brightness) {
-        mHal.sendDisplayBrightness(brightness);
+    public void sendDisplayBrightnessLegacy(int brightness) {
+        mHal.sendDisplayBrightnessLegacy(brightness);
     }
 
     /**
@@ -2548,6 +2575,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
     private int applyPowerPolicy(@Nullable String policyId, boolean delayNotification,
             boolean upToDaemon, boolean force) {
         if (mFeatureFlags.carPowerPolicyRefactoring()) {
+            Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "applyPowerPolicy");
             AsyncPolicyRequest request = generateAsyncPolicyRequest(
                     DEFAULT_POWER_POLICY_REQUEST_TIMEOUT_MS);
             int requestId = request.getRequestId();
@@ -2559,11 +2587,13 @@ public class CarPowerManagementService extends ICarPower.Stub implements
             if (daemon == null) {
                 Slogf.w(TAG, "Cannot call applyPowerPolicyAsync(requestId=%d, policyId=%s) to CPPD:"
                         + " CPPD is not available", requestId, policyId);
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return PolicyOperationStatus.ERROR_APPLY_POWER_POLICY;
             }
             if (!mReadyForCallback.get()) {
                 Slogf.w(TAG, "Cannot call applyPowerPolicyAsync(requestId=%d, policyId=%s) to CPPD:"
                         + " not ready for calling to CPPD", requestId, policyId);
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return PolicyOperationStatus.ERROR_APPLY_POWER_POLICY;
             }
             try {
@@ -2574,25 +2604,31 @@ public class CarPowerManagementService extends ICarPower.Stub implements
                 if (!policyRequestServed) {
                     Slogf.w(TAG, "Power policy request (ID: %d) successful application timed out"
                             + " after %d ms", requestId, DEFAULT_POWER_POLICY_REQUEST_TIMEOUT_MS);
+                    Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                     return PolicyOperationStatus.ERROR_APPLY_POWER_POLICY;
                 }
             } catch (IllegalArgumentException e) {
                 int error = PolicyOperationStatus.ERROR_INVALID_POWER_POLICY_ID;
                 Slogf.w(TAG, PolicyOperationStatus.errorCodeToString(error, policyId));
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return error;
             } catch (IllegalStateException e) {
                 int error = PolicyOperationStatus.ERROR_APPLY_POWER_POLICY;
                 Slogf.w(TAG, PolicyOperationStatus.errorCodeToString(error, policyId));
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return error;
             } catch (SecurityException e) {
                 Slogf.w(TAG, e, "Failed to apply power policy, insufficient permissions");
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return PolicyOperationStatus.ERROR_APPLY_POWER_POLICY;
             } catch (InterruptedException e) {
                 Slogf.w(TAG, e, "Wait for power policy change request interrupted");
                 Thread.currentThread().interrupt();
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return PolicyOperationStatus.ERROR_APPLY_POWER_POLICY;
             } catch (RemoteException e) {
                 Slogf.w(TAG, e, "Failed to apply power policy, connection issue");
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return PolicyOperationStatus.ERROR_APPLY_POWER_POLICY;
             } finally {
                 synchronized (mLock) {
@@ -2602,10 +2638,12 @@ public class CarPowerManagementService extends ICarPower.Stub implements
             if (!request.isSuccessful()) {
                 Slogf.w(TAG, "Failed to apply power policy, failure reason = %d",
                         request.getFailureReason());
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return getPolicyRequestError(requestId, request.getFailureReason());
             }
             if (request.isDeferred()) {
                 Slogf.i(TAG, "Applying power policy(%s) is deferred", policyId);
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 return PolicyOperationStatus.OK;
             }
             CarPowerPolicy accumulatedPolicy = request.getAccumulatedPolicy();
@@ -2617,6 +2655,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
             } else {
                 notifyPowerPolicyChange(accumulatedPolicy);
             }
+            Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
         } else {
             CarPowerPolicy policy = mPolicyReader.getPowerPolicy(policyId);
             if (policy == null) {
@@ -2769,6 +2808,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
         }
         Slogf.i(TAG, "Power policy change to %s is notified to apps", policyId);
         mBroadcastHandler.post(() -> {
+            Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "notifyPowerPolicyChange");
             int idx = mPowerPolicyListeners.beginBroadcast();
 
             while (idx-- > 0) {
@@ -2786,6 +2826,7 @@ public class CarPowerManagementService extends ICarPower.Stub implements
                 }
             }
             mPowerPolicyListeners.finishBroadcast();
+            Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
         });
     }
 
@@ -2814,9 +2855,13 @@ public class CarPowerManagementService extends ICarPower.Stub implements
     }
 
     private void connectToPowerPolicyDaemon() {
+        Trace.asyncTraceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "connectToPowerPolicyDaemon",
+                /* cookie= */ 0);
         synchronized (mLock) {
             android.os.IInterface powerPolicyDaemon = getPowerPolicyDaemonLocked();
             if (powerPolicyDaemon != null || mConnectionInProgress) {
+                Trace.asyncTraceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE,
+                        "connectToPowerPolicyDaemon", /* cookie= */ 0);
                 return;
             }
             mConnectionInProgress = true;
@@ -2831,11 +2876,15 @@ public class CarPowerManagementService extends ICarPower.Stub implements
             }
             Slogf.e(TAG, "Cannot reconnect to car power policyd daemon after retrying %d times",
                     CAR_POWER_POLICY_DAEMON_BIND_MAX_RETRY);
+            Trace.asyncTraceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE, "connectToPowerPolicyDaemon",
+                    /* cookie= */ 0);
             return;
         }
         if (makeBinderConnection()) {
             Slogf.i(TAG, "Connected to car power policy daemon");
             initializePowerPolicy();
+            Trace.asyncTraceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE, "connectToPowerPolicyDaemon",
+                    /* cookie= */ 0);
             return;
         }
         final int numRetry = retryCount - 1;
@@ -3110,11 +3159,18 @@ public class CarPowerManagementService extends ICarPower.Stub implements
             Slogf.i(TAG, "Entering %s", suspendTarget);
             if (isSuspendToDisk) {
                 freeMemory();
+                if (mFeatureFlags.changeSwapsDuringSuspendToDisk() && mShouldChangeSwap) {
+                    SystemPropertiesHelper.set("sys.hibernate", "1");
+                }
             }
             boolean suspendSucceeded = isSuspendToDisk ? mSystemInterface.enterHibernation()
                     : mSystemInterface.enterDeepSleep();
 
             if (suspendSucceeded) {
+                if (isSuspendToDisk && mFeatureFlags.changeSwapsDuringSuspendToDisk()
+                        && mShouldChangeSwap) {
+                    SystemPropertiesHelper.set("sys.hibernate", "0");
+                }
                 return true;
             }
             if (totalWaitDurationMs >= mMaxSuspendWaitDurationMs) {
@@ -3925,42 +3981,55 @@ public class CarPowerManagementService extends ICarPower.Stub implements
      * Utility method to help with memory freeing before entering Suspend-To-Disk
      */
     private void freeMemory() {
-        ActivityManagerHelper.killAllBackgroundProcesses();
-        if (!mFeatureFlags.stopProcessBeforeSuspendToDisk()) {
-            return;
-        }
-        List<ActivityManager.RunningAppProcessInfo> allRunningAppProcesses =
-                ActivityManagerHelper.getRunningAppProcesses();
-        ArraySet<Integer> safeUids = new ArraySet<>();
-        ArraySet<String> suspendToDiskAllowList = getS2dAllowList();
-        int suspendToDiskImportanceLevel = getS2dImportanceLevel();
-        for (int i = 0; i < allRunningAppProcesses.size(); i++) {
-            ActivityManager.RunningAppProcessInfo info = allRunningAppProcesses.get(i);
-            boolean isCarServiceOrMyPid = ICarImpl.class.getPackage().getName()
-                    .equals(info.processName)
-                    || info.pid == android.os.Process.myPid();
-            boolean isSystemOrShellUid = info.uid == Process.SYSTEM_UID
-                    || info.uid == Process.SHELL_UID;
-            boolean isProcessPersistent = (ActivityManagerHelper
-                    .getFlagsForRunningAppProcessInfo(info)
-                    & ActivityManagerHelper.PROCESS_INFO_PERSISTENT_FLAG) != 0;
-            boolean isWithinConfig = suspendToDiskImportanceLevel > info.importance;
-            boolean isProcessAllowListed = suspendToDiskAllowList.contains(info.processName);
-            if (isCarServiceOrMyPid || isSystemOrShellUid || isProcessPersistent
-                    || isWithinConfig || isProcessAllowListed) {
-                safeUids.add(info.uid);
-            }
-        }
-
-        for (int i = 0; i < allRunningAppProcesses.size(); i++) {
-            ActivityManager.RunningAppProcessInfo info = allRunningAppProcesses.get(i);
-            if (!safeUids.contains(info.uid)) {
-                for (int j = 0; j < info.pkgList.length; j++) {
-                    String pkgToStop = info.pkgList[j];
-                    PackageManagerHelper.forceStopPackageAsUser(mContext, pkgToStop,
-                            UserManagerHelper.USER_ALL);
+        try {
+            Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "freeMemory");
+            if (!mFeatureFlags.stopProcessBeforeSuspendToDisk()) {
+                ActivityManagerHelper.killAllBackgroundProcesses();
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
+                return;
+            }
+            int suspendToDiskImportanceLevel = getS2dImportanceLevel();
+            switch (suspendToDiskImportanceLevel) {
+                case ActivityManager.RunningAppProcessInfo.IMPORTANCE_GONE:
+                    return;
+                case ActivityManager.RunningAppProcessInfo.IMPORTANCE_CACHED:
+                    ActivityManagerHelper.killAllBackgroundProcesses();
+                    return;
+            }
+            List<ActivityManager.RunningAppProcessInfo> allRunningAppProcesses =
+                    ActivityManagerHelper.getRunningAppProcesses();
+            ArraySet<Integer> safeUids = new ArraySet<>();
+            ArraySet<String> suspendToDiskAllowList = getS2dAllowList();
+            for (int i = 0; i < allRunningAppProcesses.size(); i++) {
+                ActivityManager.RunningAppProcessInfo info = allRunningAppProcesses.get(i);
+                boolean isCarServiceOrMyPid = ICarImpl.class.getPackage().getName()
+                        .equals(info.processName)
+                        || info.pid == android.os.Process.myPid();
+                boolean isSystemOrShellUid = info.uid == Process.SYSTEM_UID
+                        || info.uid == Process.SHELL_UID;
+                boolean isProcessPersistent = (ActivityManagerHelper
+                        .getFlagsForRunningAppProcessInfo(info)
+                        & ActivityManagerHelper.PROCESS_INFO_PERSISTENT_FLAG) != 0;
+                boolean isWithinConfig = suspendToDiskImportanceLevel > info.importance;
+                boolean isProcessAllowListed = suspendToDiskAllowList.contains(info.processName);
+                if (isCarServiceOrMyPid || isSystemOrShellUid || isProcessPersistent
+                        || isWithinConfig || isProcessAllowListed) {
+                    safeUids.add(info.uid);
+                }
+            }
+
+            for (int i = 0; i < allRunningAppProcesses.size(); i++) {
+                ActivityManager.RunningAppProcessInfo info = allRunningAppProcesses.get(i);
+                if (!safeUids.contains(info.uid)) {
+                    for (int j = 0; j < info.pkgList.length; j++) {
+                        String pkgToStop = info.pkgList[j];
+                        PackageManagerHelper.forceStopPackageAsUser(mContext, pkgToStop,
+                                UserManagerHelper.USER_ALL);
+                    }
                 }
             }
+        } finally {
+            Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
         }
     }
 
@@ -3985,4 +4054,9 @@ public class CarPowerManagementService extends ICarPower.Stub implements
             default -> ActivityManager.RunningAppProcessInfo.IMPORTANCE_GONE;
         };
     }
+
+    @VisibleForTesting
+    void changeShouldChangeSwap(boolean value) {
+        mShouldChangeSwap = value;
+    }
 }
diff --git a/service/src/com/android/car/power/PowerComponentHandler.java b/service/src/com/android/car/power/PowerComponentHandler.java
index ff551008c5..8c26ae0f26 100644
--- a/service/src/com/android/car/power/PowerComponentHandler.java
+++ b/service/src/com/android/car/power/PowerComponentHandler.java
@@ -127,6 +127,7 @@ public final class PowerComponentHandler {
                     // We don't not associate a mediator with the component.
                     continue;
                 }
+                mComponentStates.put(component, mediator.isEnabled());
                 mPowerComponentMediators.put(component, mediator);
             }
             if (customComponents != null) {
diff --git a/service/src/com/android/car/power/ScreenOffHandler.java b/service/src/com/android/car/power/ScreenOffHandler.java
index 0f70daea4b..e5c5509d3a 100644
--- a/service/src/com/android/car/power/ScreenOffHandler.java
+++ b/service/src/com/android/car/power/ScreenOffHandler.java
@@ -123,6 +123,8 @@ class ScreenOffHandler {
     private final Object mLock = new Object();
     @GuardedBy("mLock")
     private final SparseArray<DisplayPowerInfo> mDisplayPowerInfos = new SparseArray<>();
+    @GuardedBy("mLock")
+    private SparseIntArray mPowerModeForDisplayPort = new SparseIntArray();
 
     @GuardedBy("mLock")
     private boolean mBootCompleted;
@@ -149,15 +151,16 @@ class ScreenOffHandler {
         if (!mIsAutoPowerSaving) {
             return;
         }
-        initializeDisplayPowerInfos();
-        initializeDefaultSettings();
         mOccupantZoneService.registerCallback(mOccupantZoneCallback);
         mContext.getContentResolver().registerContentObserver(
                 DISPLAY_POWER_MODE_URI, /* notifyForDescendants= */ false, mSettingsObserver);
         mSystemInterface.scheduleActionForBootCompleted(() -> {
+            List<OccupantZoneInfo> occupantZoneInfos = mOccupantZoneService.getAllOccupantZones();
+            initializePowerModeSettings(occupantZoneInfos);
+            refreshDisplayPowerInfos(occupantZoneInfos);
+
             synchronized (mLock) {
                 mBootCompleted = true;
-                updateSettingsLocked();
                 long eventTime = mClock.uptimeMillis();
                 for (int i = 0; i < mDisplayPowerInfos.size(); i++) {
                     int displayId = mDisplayPowerInfos.keyAt(i);
@@ -186,6 +189,7 @@ class ScreenOffHandler {
 
     @GuardedBy("mLock")
     private void updateUserActivityLocked(int displayId, long eventTime) {
+        Slogf.d(TAG, "updateUserActivity, displayId=" + displayId + ", eventTime=" + eventTime);
         if (!mIsAutoPowerSaving) {
             return;
         }
@@ -201,12 +205,6 @@ class ScreenOffHandler {
         updateDisplayPowerStateLocked(info);
     }
 
-    @GuardedBy("mLock")
-    private void handleSettingsChangedLocked() {
-        updateSettingsLocked();
-        updateAllDisplayPowerStateLocked();
-    }
-
     boolean canTurnOnDisplay(int displayId) {
         if (!mIsAutoPowerSaving) {
             return true;
@@ -229,24 +227,36 @@ class ScreenOffHandler {
         return true;
     }
 
-    private void initializeDefaultSettings() {
+    // Fetch power mode settings. If empty, populate the default power mode settings and store it.
+    private void initializePowerModeSettings(List<OccupantZoneInfo> occupantZoneInfos) {
         String setting = Settings.Global.getString(mContext.getContentResolver(),
                 DISPLAY_POWER_MODE_SETTING);
         if (!TextUtils.isEmpty(setting)) {
             Slogf.d(TAG, "stored value of %s: %s", DISPLAY_POWER_MODE_SETTING, setting);
-            return;
+            synchronized (mLock) {
+                mPowerModeForDisplayPort = parseModeAssignmentSettingValue(setting);
+                if (mPowerModeForDisplayPort != null) {
+                    return;
+                }
+            }
+            Slogf.w(TAG, "Failed to parse [%s], overwrite with default settings", setting);
         }
+        Slogf.d(TAG, "No power mode settings, use default settings");
         // At first boot, initialize default setting value
         StringBuilder sb = new StringBuilder();
         synchronized (mLock) {
-            for (int i = 0; i < mDisplayPowerInfos.size(); i++) {
-                int displayId = mDisplayPowerInfos.keyAt(i);
-                DisplayPowerInfo info = mDisplayPowerInfos.valueAt(i);
-                if (info == null) {
+            for (int i = 0; i < occupantZoneInfos.size(); i++) {
+                OccupantZoneInfo zoneInfo = occupantZoneInfos.get(i);
+                int zoneId = zoneInfo.zoneId;
+                // TODO(b/359326993): Support non-main display.
+                int displayId = getMainTypeDisplayId(zoneId);
+                if (displayId == Display.INVALID_DISPLAY) {
+                    Slogf.w(TAG, "No main display associated with occupant zone(id: %d)", zoneId);
                     continue;
                 }
                 int displayPort = getDisplayPort(displayId);
                 if (displayPort == DisplayHelper.INVALID_PORT) {
+                    Slogf.w(TAG, "Invalid display port for displayId: " + displayId);
                     continue;
                 }
                 if (i > 0) {
@@ -254,54 +264,24 @@ class ScreenOffHandler {
                 }
                 sb.append(displayPort);
                 sb.append(':');
-                if (info.isDriverDisplay()) {
+                @DisplayPowerMode int mode;
+                if (zoneInfo.occupantType == CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER) {
                     // for driver display
-                    info.setMode(DISPLAY_POWER_MODE_ALWAYS_ON);
-                    sb.append(DISPLAY_POWER_MODE_ALWAYS_ON);
+                    mode = DISPLAY_POWER_MODE_ALWAYS_ON;
+                    sb.append(mode);
                 } else {
                     // TODO(b/274050716): Restore passenger displays to ON.
                     // for passenger display
-                    info.setMode(DISPLAY_POWER_MODE_ALWAYS_ON);
-                    sb.append(DISPLAY_POWER_MODE_ALWAYS_ON);
+                    mode = DISPLAY_POWER_MODE_ALWAYS_ON;
+                    sb.append(mode);
                 }
+                mPowerModeForDisplayPort.put(displayPort, mode);
             }
         }
         Settings.Global.putString(
                 mContext.getContentResolver(), DISPLAY_POWER_MODE_SETTING, sb.toString());
     }
 
-    @GuardedBy("mLock")
-    private void updateSettingsLocked() {
-        String setting = Settings.Global.getString(mContext.getContentResolver(),
-                DISPLAY_POWER_MODE_SETTING);
-        SparseIntArray mapping = parseModeAssignmentSettingValue(setting);
-        if (mapping == null) {
-            Slogf.d(TAG, "Failed to parse [%s]", setting);
-            initializeDefaultSettings();
-            return;
-        }
-        for (int i = 0; i < mapping.size(); i++) {
-            int displayId = mapping.keyAt(i);
-            @DisplayPowerMode int mode = mapping.valueAt(i);
-            DisplayPowerInfo info = mDisplayPowerInfos.get(displayId);
-            if (info != null) {
-                // Check if the mode in the corresponding display power info is the same as current
-                // setting value.
-                if (info.getMode() != mode) {
-                    info.setMode(mode);
-                    boolean on = mode != DISPLAY_POWER_MODE_OFF;
-                    // Update last user activity time due to mode change by driver
-                    info.setLastUserActivityTime(mClock.uptimeMillis());
-                    mEventHandler.post(() -> {
-                        handleSetDisplayState(displayId, on);
-                    });
-                }
-            } else {
-                Slogf.d(TAG, "No matching DisplayPowerInfo(display=%d)", displayId);
-            }
-        }
-    }
-
     @GuardedBy("mLock")
     private void updateAllDisplayPowerStateLocked() {
         for (int i = 0; i < mDisplayPowerInfos.size(); i++) {
@@ -327,6 +307,7 @@ class ScreenOffHandler {
     }
 
     private void checkUserActivityTimeout(DisplayPowerInfo info) {
+        Slogf.w(TAG, "checkUserActivityTimeout");
         long now = mClock.uptimeMillis();
         long nextTimeout = info.getLastUserActivityTime() + mNoUserScreenOffTimeoutMs;
         if (now < nextTimeout) {
@@ -335,9 +316,8 @@ class ScreenOffHandler {
     }
 
     private void handleSetDisplayState(int displayId, boolean on) {
-        if (on != mSystemInterface.isDisplayEnabled(displayId)) {
-            mSystemInterface.setDisplayState(displayId, on);
-        }
+        Slogf.i(TAG, "Setting display state for displaId: " + displayId + " to " + on);
+        mSystemInterface.setDisplayState(displayId, on);
     }
 
     private final ICarOccupantZoneCallback mOccupantZoneCallback =
@@ -361,9 +341,9 @@ class ScreenOffHandler {
 
         @Override
         public void onChange(boolean selfChange, Uri uri) {
-            synchronized (mLock) {
-                handleSettingsChangedLocked();
-            }
+            List<OccupantZoneInfo> occupantZoneInfos = mOccupantZoneService.getAllOccupantZones();
+            initializePowerModeSettings(occupantZoneInfos);
+            refreshDisplayPowerInfos(occupantZoneInfos);
         }
     }
 
@@ -376,6 +356,7 @@ class ScreenOffHandler {
         for (int i = 0; i < occupantZoneInfos.size(); i++) {
             OccupantZoneInfo zoneInfo = occupantZoneInfos.get(i);
             int zoneId = zoneInfo.zoneId;
+            // TODO(b/359326993): Support non-main display.
             int displayId = getMainTypeDisplayId(zoneId);
             if (displayId == Display.INVALID_DISPLAY) {
                 Slogf.w(TAG, "No main display associated with occupant zone(id: %d)", zoneId);
@@ -403,6 +384,13 @@ class ScreenOffHandler {
                     // Display added
                     int userId = mOccupantZoneService.getUserForOccupant(zoneId);
                     info.setUserId(userId);
+                    int displayPort = getDisplayPort(displayId);
+                    if (displayPort == DisplayHelper.INVALID_PORT) {
+                        Slogf.w(TAG, "Invalid display port for displayId: " + displayId);
+                        continue;
+                    }
+                    info.setLastUserActivityTime(mClock.uptimeMillis());
+                    setPowerModeLocked(info, displayPort, displayId);
                 }
             }
         }
@@ -419,14 +407,38 @@ class ScreenOffHandler {
         }
     }
 
-    private void initializeDisplayPowerInfos() {
-        List<OccupantZoneInfo> occupantZoneInfos = mOccupantZoneService.getAllOccupantZones();
+    @GuardedBy("mLock")
+    private void setPowerModeLocked(DisplayPowerInfo info, int displayPort, int displayId) {
+        @DisplayPowerMode int powerMode = mPowerModeForDisplayPort.get(displayPort,
+                DISPLAY_POWER_MODE_NONE);
+        if (powerMode == DISPLAY_POWER_MODE_NONE) {
+            Slogf.w(TAG, "No power mode specified for display port: " + displayPort
+                    + ", default to POWER_MODE_ON");
+            powerMode = DISPLAY_POWER_MODE_ON;
+        }
+        info.setMode(powerMode);
+        Slogf.i(TAG, "Set displayPort=" + displayPort + ", powerMode=" + powerMode);
+
+        boolean on = (info.getMode() != DISPLAY_POWER_MODE_OFF);
+        mEventHandler.post(() -> {
+            handleSetDisplayState(displayId, on);
+        });
+    }
+
+    private void refreshDisplayPowerInfos(List<OccupantZoneInfo> occupantZoneInfos) {
         synchronized (mLock) {
             for (int i = 0; i < occupantZoneInfos.size(); i++) {
                 OccupantZoneInfo zoneInfo = occupantZoneInfos.get(i);
                 int zoneId = zoneInfo.zoneId;
+                // TODO(b/359326993): Support non-main display.
                 int displayId = getMainTypeDisplayId(zoneId);
                 if (displayId == Display.INVALID_DISPLAY) {
+                    Slogf.w(TAG, "No main display associated with occupant zone(id: %d)", zoneId);
+                    continue;
+                }
+                int displayPort = getDisplayPort(displayId);
+                if (displayPort == DisplayHelper.INVALID_PORT) {
+                    Slogf.w(TAG, "Invalid display port for displayId: " + displayId);
                     continue;
                 }
                 DisplayPowerInfo info = createDisplayPowerInfoLocked(displayId);
@@ -435,7 +447,11 @@ class ScreenOffHandler {
                 if (zoneInfo.occupantType == CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER) {
                     info.setDriverDisplay(true);
                 }
+                info.setLastUserActivityTime(mClock.uptimeMillis());
+                setPowerModeLocked(info, displayPort, displayId);
             }
+            // Check for user activity timeout.
+            updateAllDisplayPowerStateLocked();
         }
     }
 
@@ -479,7 +495,7 @@ class ScreenOffHandler {
                             mode, DisplayPowerInfo.displayPowerModeToString(mode));
                     return null;
                 }
-                mapping.append(displayId, mode);
+                mapping.append(displayPort, mode);
             }
         } catch (Exception e) {
             Slogf.w(TAG, e, "Setting %s has invalid value: ", value);
diff --git a/service/src/com/android/car/provider/Settings.java b/service/src/com/android/car/provider/Settings.java
new file mode 100644
index 0000000000..c6732ef79c
--- /dev/null
+++ b/service/src/com/android/car/provider/Settings.java
@@ -0,0 +1,101 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.provider;
+
+import android.content.ContentResolver;
+import android.net.Uri;
+import android.provider.Settings.SettingNotFoundException;
+
+/**
+ * An interface to stub methods from {@link android.provider.Settings}.
+ */
+public interface Settings {
+    /**
+     * @see android.provider.Settings.System#getInt
+     */
+    int getIntSystem(ContentResolver cr, String name) throws SettingNotFoundException;
+
+    /**
+     * @see android.provider.Settings.System#putInt
+     */
+    void putIntSystem(ContentResolver cr, String name, int value);
+
+    /**
+     * @see android.provider.Settings.System#getUriFor
+     */
+    Uri getUriForSystem(String name);
+
+    /**
+     * @see android.provider.Settings.System#putString
+     */
+    boolean putStringSystem(ContentResolver resolver, String name, String value);
+
+    /**
+     * @see android.provider.Settings.Global.getString
+     */
+    String getStringGlobal(ContentResolver resolver, String name);
+
+    /**
+     * @see android.provider.Settings.Global.getInt
+     */
+    int getIntGlobal(ContentResolver cr, String name, int def);
+
+    /**
+     * @see android.provider.Settings.Global.putInt
+     */
+    boolean putIntGlobal(ContentResolver cr, String name, int value);
+
+    /**
+     * The default real implementation.
+     */
+    class DefaultImpl implements Settings {
+        @Override
+        public int getIntSystem(ContentResolver cr, String name) throws SettingNotFoundException {
+            return android.provider.Settings.System.getInt(cr, name);
+        }
+
+        @Override
+        public void putIntSystem(ContentResolver cr, String name, int value) {
+            android.provider.Settings.System.putInt(cr, name, value);
+        }
+
+        @Override
+        public Uri getUriForSystem(String name) {
+            return android.provider.Settings.System.getUriFor(name);
+        }
+
+        @Override
+        public boolean putStringSystem(ContentResolver resolver, String name, String value) {
+            return android.provider.Settings.System.putString(resolver, name, value);
+        }
+
+        @Override
+        public String getStringGlobal(ContentResolver resolver, String name) {
+            return android.provider.Settings.Global.getString(resolver, name);
+        }
+
+        @Override
+        public int getIntGlobal(ContentResolver cr, String name, int def) {
+            return android.provider.Settings.Global.getInt(cr, name, def);
+        }
+
+        @Override
+        public boolean putIntGlobal(ContentResolver cr, String name, int value) {
+            return android.provider.Settings.Global.putInt(cr, name, value);
+        }
+    }
+}
diff --git a/service/src/com/android/car/storagemonitoring/TEST_MAPPING b/service/src/com/android/car/storagemonitoring/TEST_MAPPING
index a43eed06e8..9922e507ad 100644
--- a/service/src/com/android/car/storagemonitoring/TEST_MAPPING
+++ b/service/src/com/android/car/storagemonitoring/TEST_MAPPING
@@ -1,13 +1,5 @@
 {
   "auto-postsubmit": [
-    {
-      "name": "CarServiceTest",
-      "options" : [
-        {
-          "include-filter": "com.android.car.CarStorageMonitoringTest"
-        }
-      ]
-    },
     {
       "name": "CarServiceUnitTest",
       "options" : [
diff --git a/service/src/com/android/car/systeminterface/DisplayHelperInterface.java b/service/src/com/android/car/systeminterface/DisplayHelperInterface.java
new file mode 100644
index 0000000000..8c4c350331
--- /dev/null
+++ b/service/src/com/android/car/systeminterface/DisplayHelperInterface.java
@@ -0,0 +1,63 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.systeminterface;
+
+import android.car.builtin.view.DisplayHelper;
+import android.view.Display;
+
+/**
+ * An interface to wrap {@link DisplayHelper} methods.
+ *
+ * This allows faking the implementation for tests.
+ */
+public interface DisplayHelperInterface {
+    /**
+     * @return the physical port number of the display, or {@code INVALID_PORT} if the display isn't
+     *         the physical one.
+     */
+    int getPhysicalPort(Display display);
+
+    /**
+     * @return the uniqueId of the given display.
+     */
+    String getUniqueId(Display display);
+
+    /**
+     * Gets the display type.
+     */
+    int getType(Display display);
+
+    /**
+     * A real implementation.
+     */
+    final class DefaultImpl implements DisplayHelperInterface {
+        @Override
+        public int getPhysicalPort(Display display) {
+            return DisplayHelper.getPhysicalPort(display);
+        }
+
+        @Override
+        public String getUniqueId(Display display) {
+            return DisplayHelper.getUniqueId(display);
+        }
+
+        @Override
+        public int getType(Display display) {
+            return DisplayHelper.getType(display);
+        }
+    }
+}
diff --git a/service/src/com/android/car/systeminterface/DisplayInterface.java b/service/src/com/android/car/systeminterface/DisplayInterface.java
index 8aa4bf9f2e..802201c94a 100644
--- a/service/src/com/android/car/systeminterface/DisplayInterface.java
+++ b/service/src/com/android/car/systeminterface/DisplayInterface.java
@@ -29,6 +29,8 @@ import android.car.builtin.display.DisplayManagerHelper;
 import android.car.builtin.os.UserManagerHelper;
 import android.car.builtin.power.PowerManagerHelper;
 import android.car.builtin.util.Slogf;
+import android.car.builtin.view.DisplayHelper;
+import android.car.feature.Flags;
 import android.car.user.CarUserManager.UserLifecycleListener;
 import android.car.user.UserLifecycleEventFilter;
 import android.content.Context;
@@ -44,16 +46,19 @@ import android.provider.Settings.SettingNotFoundException;
 import android.provider.Settings.System;
 import android.util.Log;
 import android.util.SparseBooleanArray;
-import android.util.SparseIntArray;
 import android.view.Display;
 
 import com.android.car.CarLog;
 import com.android.car.internal.util.IntArray;
 import com.android.car.power.CarPowerManagementService;
+import com.android.car.provider.Settings;
 import com.android.car.user.CarUserService;
+import com.android.car.user.CurrentUserFetcher;
 import com.android.car.util.BrightnessUtils;
 import com.android.internal.annotations.GuardedBy;
 
+import java.util.LinkedList;
+
 /**
  * Interface that abstracts display operations
  */
@@ -70,19 +75,14 @@ public interface DisplayInterface {
     void init(CarPowerManagementService carPowerManagementService, CarUserService carUserService);
 
     /**
-     * Sets display brightness.
+     * Sets display brightness with the given displayId according to brightness change from VHAL.
      *
-     * @param brightness Level from 0 to 100%
-     */
-    void setDisplayBrightness(int brightness);
-
-    /**
-     * Sets display brightness with the given displayId.
+     * This is used to sync the system settings with VHAL.
      *
      * @param displayId ID of a display.
      * @param brightness Level from 0 to 100.
      */
-    void setDisplayBrightness(int displayId, int brightness);
+    void onDisplayBrightnessChangeFromVhal(int displayId, int brightness);
 
     /**
      * Turns on or off display with the given displayId.
@@ -125,9 +125,9 @@ public interface DisplayInterface {
     boolean isDisplayEnabled(int displayId);
 
     /**
-     * Refreshing display brightness. Used when user is switching and car turned on.
+     * Refreshing default display brightness. Used when user is switching and car turned on.
      */
-    void refreshDisplayBrightness();
+    void refreshDefaultDisplayBrightness();
 
     /**
      * Refreshing display brightness with the given displayId.
@@ -143,7 +143,17 @@ public interface DisplayInterface {
     class DefaultImpl implements DisplayInterface {
         private static final String TAG = DisplayInterface.class.getSimpleName();
         private static final boolean DEBUG = Slogf.isLoggable(TAG, Log.DEBUG);
-        private static final int INVALID_DISPLAY_BRIGHTNESS = -1;
+
+        // In order to prevent flickering caused by
+        // vhal_report_brightness_1 -> vhal_report_brightness_2 -> set_1_to_display_manager
+        // -> set_2_to_display_manager -> on_display_change_1 -> set_vhal_to_1
+        // -> on_display_change_2 -> set_vhal_to_2 -> vhal_report_brightness_1 -> ...
+        // We ignore the display brightness change event from DisplayManager if the value matches
+        // a request we have sent to Displaymanager in a short period. This change is likely caused
+        // by our request (caused by VHAL), rather than user inputs.
+        private static final int PREVENT_LOOP_REQUEST_TIME_WINDOW_MS = 1000;
+
+        private record BrightnessForDisplayId(float brightness, int displayId) {}
 
         private final Context mContext;
         private final DisplayManager mDisplayManager;
@@ -151,6 +161,10 @@ public interface DisplayInterface {
         private final int mMaximumBacklight;
         private final int mMinimumBacklight;
         private final WakeLockInterface mWakeLockInterface;
+        private final Settings mSettings;
+        private final Handler mHandler = new Handler(Looper.getMainLooper());
+        private final DisplayHelperInterface mDisplayHelper;
+        private final CurrentUserFetcher mCurrentUserFetcher;
         @GuardedBy("mLock")
         private CarPowerManagementService mCarPowerManagementService;
         @GuardedBy("mLock")
@@ -158,79 +172,106 @@ public interface DisplayInterface {
         @GuardedBy("mLock")
         private final SparseBooleanArray mDisplayStateSet = new SparseBooleanArray();
         @GuardedBy("mLock")
-        private final SparseIntArray mDisplayBrightnessSet = new SparseIntArray();
+        private boolean mDisplayStateInitiated;
         private final UserManager mUserManager;
+        // A FIFO queue that stores the brightness value we recently set to DisplayManagerHelper in
+        // a short time frame.
+        @GuardedBy("mLock")
+        private final LinkedList<BrightnessForDisplayId> mRecentlySetBrightnessForDisplayId =
+                new LinkedList<>();
+        // A FIFO queue that stores the brightness value we recently set to System Settings in a
+        // short time frame.
+        @GuardedBy("mLock")
+        private final LinkedList<Integer> mRecentlySetGlobalBrightness = new LinkedList<>();
+        private final UserLifecycleListener mUserLifecycleListener;
 
         private final ContentObserver mBrightnessObserver =
-                new ContentObserver(new Handler(Looper.getMainLooper())) {
+                new ContentObserver(mHandler) {
                     @Override
                     public void onChange(boolean selfChange) {
                         Slogf.i(TAG, "Brightness change from Settings: selfChange=%b", selfChange);
-                        refreshDisplayBrightness();
+                        refreshDefaultDisplayBrightness();
                     }
                 };
 
         private final DisplayManager.DisplayListener mDisplayListener = new DisplayListener() {
             @Override
             public void onDisplayAdded(int displayId) {
+                // If in rare case, this is called before initDisplayStateOnce is called, init here.
+                if (initDisplayStateOnce()) {
+                    return;
+                }
+
                 Slogf.i(TAG, "onDisplayAdded: displayId=%d", displayId);
                 synchronized (mLock) {
-                    mDisplayStateSet.put(displayId, isDisplayOn(displayId));
-                    mDisplayBrightnessSet.put(displayId, INVALID_DISPLAY_BRIGHTNESS);
+                    boolean isDisplayOn = isDisplayOn(displayId);
+                    mDisplayStateSet.put(displayId, isDisplayOn);
                 }
             }
 
             @Override
             public void onDisplayRemoved(int displayId) {
+                // If in rare case, this is called before initDisplayStateOnce is called, init here.
+                if (initDisplayStateOnce()) {
+                    return;
+                }
+
                 Slogf.i(TAG, "onDisplayRemoved: displayId=%d", displayId);
                 synchronized (mLock) {
                     mDisplayStateSet.delete(displayId);
-                    mDisplayBrightnessSet.delete(displayId);
                 }
             }
 
             @Override
             public void onDisplayChanged(int displayId) {
+                // If in rare case, this is called before initDisplayStateOnce is called, init here.
+                if (initDisplayStateOnce()) {
+                    return;
+                }
+
                 Slogf.i(TAG, "onDisplayChanged: displayId=%d", displayId);
                 handleDisplayChanged(displayId);
             }
         };
 
-        DefaultImpl(Context context, WakeLockInterface wakeLockInterface) {
+        public DefaultImpl(Context context, WakeLockInterface wakeLockInterface, Settings settings,
+                DisplayHelperInterface displayHelper, CurrentUserFetcher currentUserFetcher) {
             mContext = context;
             mDisplayManager = context.getSystemService(DisplayManager.class);
             mMaximumBacklight = PowerManagerHelper.getMaximumScreenBrightnessSetting(context);
             mMinimumBacklight = PowerManagerHelper.getMinimumScreenBrightnessSetting(context);
             mWakeLockInterface = wakeLockInterface;
-            synchronized (mLock) {
-                for (Display display : mDisplayManager.getDisplays()) {
-                    int displayId = display.getDisplayId();
-                    mDisplayStateSet.put(displayId, isDisplayOn(displayId));
-                    mDisplayBrightnessSet.put(displayId, INVALID_DISPLAY_BRIGHTNESS);
-                }
-            }
+            mSettings = settings;
+            mDisplayHelper = displayHelper;
+            mCurrentUserFetcher = currentUserFetcher;
             mUserManager = context.getSystemService(UserManager.class);
+            mUserLifecycleListener = event -> {
+                if (!isEventOfType(TAG, event, USER_LIFECYCLE_EVENT_TYPE_SWITCHING)) {
+                    return;
+                }
+                if (DEBUG) {
+                    Slogf.d(TAG, "DisplayInterface.DefaultImpl.onEvent(%s)", event);
+                }
+                if (Flags.multiDisplayBrightnessControl()) {
+                    if (event.getUserId() != mCurrentUserFetcher.getCurrentUser()) {
+                        Slogf.w(TAG, "The switched user is not the driver user, "
+                                + "ignore refreshing display brightness");
+                        return;
+                    }
+                }
+                onDriverUserUpdate();
+            };
         }
 
-        private final UserLifecycleListener mUserLifecycleListener = event -> {
-            if (!isEventOfType(TAG, event, USER_LIFECYCLE_EVENT_TYPE_SWITCHING)) {
-                return;
-            }
-            if (DEBUG) {
-                Slogf.d(TAG, "DisplayInterface.DefaultImpl.onEvent(%s)", event);
-            }
-
-            onUsersUpdate();
-        };
-
         @Override
-        public void refreshDisplayBrightness() {
+        public void refreshDefaultDisplayBrightness() {
             refreshDisplayBrightness(DEFAULT_DISPLAY);
         }
 
         @Override
         public void refreshDisplayBrightness(int displayId) {
             CarPowerManagementService carPowerManagementService = null;
+            int mainDisplayIdForDriver;
             synchronized (mLock) {
                 carPowerManagementService = mCarPowerManagementService;
             }
@@ -239,37 +280,47 @@ public interface DisplayInterface {
                         + "no CarPowerManagementService");
                 return;
             }
-            if (UserManagerHelper.isVisibleBackgroundUsersSupported(mUserManager)) {
-                refreshDisplayBrightnessFromDisplay(carPowerManagementService, displayId);
+            if (Flags.multiDisplayBrightnessControl()
+                    || UserManagerHelper.isVisibleBackgroundUsersSupported(mUserManager)) {
+                setDisplayBrightnessThroughVhal(carPowerManagementService, displayId);
             } else {
-                refreshDisplayBrigtnessFromSetting(carPowerManagementService);
+                setDisplayBrightnessThroughVhalLegacy(carPowerManagementService);
             }
         }
 
-        private void refreshDisplayBrightnessFromDisplay(
+        private void setDisplayBrightnessThroughVhal(
                 CarPowerManagementService carPowerManagementService, int displayId) {
-            int linear = BrightnessUtils.brightnessFloatToInt(
-                    DisplayManagerHelper.getBrightness(mContext, displayId));
+            float displayManagerBrightness = DisplayManagerHelper.getBrightness(
+                    mContext, displayId);
+            if (hasRecentlySetBrightness(displayManagerBrightness, displayId)) {
+                return;
+            }
+            int linear = BrightnessUtils.brightnessFloatToInt(displayManagerBrightness);
             int gamma = convertLinearToGamma(linear, mMinimumBacklight, mMaximumBacklight);
             int percentBright = convertGammaToPercentBright(gamma);
+
             Slogf.i(TAG, "Refreshing percent brightness(from display %d) to %d", displayId,
                     percentBright);
             carPowerManagementService.sendDisplayBrightness(displayId, percentBright);
         }
 
-        private void refreshDisplayBrigtnessFromSetting(
+        private void setDisplayBrightnessThroughVhalLegacy(
                 CarPowerManagementService carPowerManagementService) {
             int gamma = GAMMA_SPACE_MAX;
             try {
-                int linear = System.getInt(getContentResolverForUser(mContext,
+                int linear = mSettings.getIntSystem(getContentResolverForUser(mContext,
                         UserHandle.CURRENT.getIdentifier()), System.SCREEN_BRIGHTNESS);
+                if (hasRecentlySetBrightness(linear)) {
+                    return;
+                }
                 gamma = convertLinearToGamma(linear, mMinimumBacklight, mMaximumBacklight);
             } catch (SettingNotFoundException e) {
                 Slogf.e(CarLog.TAG_POWER, "Could not get SCREEN_BRIGHTNESS: ", e);
             }
             int percentBright = convertGammaToPercentBright(gamma);
+
             Slogf.i(TAG, "Refreshing percent brightness(from Setting) to %d", percentBright);
-            carPowerManagementService.sendDisplayBrightness(percentBright);
+            carPowerManagementService.sendDisplayBrightnessLegacy(percentBright);
         }
 
         private static int convertGammaToPercentBright(int gamma) {
@@ -299,26 +350,18 @@ public interface DisplayInterface {
         }
 
         @Override
-        public void setDisplayBrightness(int percentBright) {
-            setDisplayBrightness(DEFAULT_DISPLAY, percentBright);
-        }
-
-        @Override
-        public void setDisplayBrightness(int displayId, int percentBright) {
-            synchronized (mLock) {
-                if (percentBright == mDisplayBrightnessSet.get(displayId)) {
-                    // We have already set the value last time. Skipping
-                    return;
-                }
-                mDisplayBrightnessSet.put(displayId, percentBright);
-            }
+        public void onDisplayBrightnessChangeFromVhal(int displayId, int percentBright) {
             int gamma = (percentBright * GAMMA_SPACE_MAX + 50) / 100;
             int linear = convertGammaToLinear(gamma, mMinimumBacklight, mMaximumBacklight);
-            if (UserManagerHelper.isVisibleBackgroundUsersSupported(mUserManager)) {
-                DisplayManagerHelper.setBrightness(mContext, displayId,
-                        BrightnessUtils.brightnessIntToFloat(linear));
+            if (Flags.multiDisplayBrightnessControl()
+                    || UserManagerHelper.isVisibleBackgroundUsersSupported(mUserManager)) {
+                Slogf.i(TAG, "set brightness: %d", percentBright);
+                float displayManagerBrightness = BrightnessUtils.brightnessIntToFloat(linear);
+                addRecentlySetBrightness(displayManagerBrightness, displayId);
+                DisplayManagerHelper.setBrightness(mContext, displayId, displayManagerBrightness);
             } else {
-                System.putInt(
+                addRecentlySetBrightness(linear);
+                mSettings.putIntSystem(
                         getContentResolverForUser(mContext, UserHandle.CURRENT.getIdentifier()),
                         System.SCREEN_BRIGHTNESS,
                         linear);
@@ -348,7 +391,8 @@ public interface DisplayInterface {
                             .addEventType(USER_LIFECYCLE_EVENT_TYPE_SWITCHING).build();
             carUserService.addUserLifecycleListener(userSwitchingEventFilter,
                     mUserLifecycleListener);
-            if (UserManagerHelper.isVisibleBackgroundUsersSupported(mUserManager)) {
+            if (Flags.multiDisplayBrightnessControl()
+                    || UserManagerHelper.isVisibleBackgroundUsersSupported(mUserManager)) {
                 DisplayManagerHelper.registerDisplayListener(mContext, mDisplayListener,
                         carPowerManagementService.getHandler(),
                         DisplayManagerHelper.EVENT_FLAG_DISPLAY_ADDED
@@ -357,15 +401,12 @@ public interface DisplayInterface {
                                 | DisplayManagerHelper.EVENT_FLAG_DISPLAY_BRIGHTNESS);
             } else {
                 getContentResolverForUser(mContext, UserHandle.ALL.getIdentifier())
-                        .registerContentObserver(System.getUriFor(System.SCREEN_BRIGHTNESS),
-                                false,
-                                mBrightnessObserver);
+                        .registerContentObserver(mSettings.getUriForSystem(
+                                System.SCREEN_BRIGHTNESS), false, mBrightnessObserver);
             }
 
-            for (Display display : mDisplayManager.getDisplays()) {
-                int displayId = display.getDisplayId();
-                refreshDisplayBrightness(displayId);
-            }
+            initDisplayStateOnce();
+            refreshAllDisplaysBrightness();
         }
 
         @Override
@@ -375,7 +416,8 @@ public interface DisplayInterface {
                 carUserService = mCarUserService;
             }
             carUserService.removeUserLifecycleListener(mUserLifecycleListener);
-            if (UserManagerHelper.isVisibleBackgroundUsersSupported(mUserManager)) {
+            if (Flags.multiDisplayBrightnessControl()
+                    || UserManagerHelper.isVisibleBackgroundUsersSupported(mUserManager)) {
                 mDisplayManager.unregisterDisplayListener(mDisplayListener);
             } else {
                 getContentResolverForUser(mContext, UserHandle.ALL.getIdentifier())
@@ -398,10 +440,10 @@ public interface DisplayInterface {
             }
             if (on) {
                 mWakeLockInterface.switchToFullWakeLock(displayId);
-                Slogf.i(CarLog.TAG_POWER, "on display %d", displayId);
+                Slogf.i(CarLog.TAG_POWER, "on display %d, obtain full wake lock", displayId);
             } else {
                 mWakeLockInterface.switchToPartialWakeLock(displayId);
-                Slogf.i(CarLog.TAG_POWER, "off display %d", displayId);
+                Slogf.i(CarLog.TAG_POWER, "off display %d, obtain partial wake lock", displayId);
                 PowerManagerHelper.goToSleep(mContext, displayId, SystemClock.uptimeMillis());
             }
             if (carPowerManagementService != null) {
@@ -411,11 +453,9 @@ public interface DisplayInterface {
 
         @Override
         public void setAllDisplayState(boolean on) {
-            IntArray displayIds = new IntArray();
+            IntArray displayIds;
             synchronized (mLock) {
-                for (int i = 0; i < mDisplayStateSet.size(); i++) {
-                    displayIds.add(mDisplayStateSet.keyAt(i));
-                }
+                displayIds = getDisplayIdsLocked();
             }
             // setDisplayState has a binder call to system_server. Should not wrap setDisplayState
             // with a lock.
@@ -432,8 +472,9 @@ public interface DisplayInterface {
         @Override
         public boolean isAnyDisplayEnabled() {
             synchronized (mLock) {
-                for (int i = 0; i < mDisplayStateSet.size(); i++) {
-                    if (isDisplayEnabled(mDisplayStateSet.keyAt(i))) {
+                IntArray displayIds = getDisplayIdsLocked();
+                for (int i = 0; i < displayIds.size(); i++) {
+                    if (isDisplayEnabled(displayIds.get(i))) {
                         return true;
                     }
                 }
@@ -446,16 +487,130 @@ public interface DisplayInterface {
             return isDisplayOn(displayId);
         }
 
-        private void onUsersUpdate() {
+        // Gets the initial display state (on/off) if not already initiated.
+        // Returns true if this is the first init.
+        private boolean initDisplayStateOnce() {
+            synchronized (mLock) {
+                if (mDisplayStateInitiated) {
+                    return false;
+                }
+                for (Display display : mDisplayManager.getDisplays()) {
+                    int displayId = display.getDisplayId();
+                    boolean isDisplayOn = isDisplayOn(displayId);
+                    mDisplayStateSet.put(displayId, isDisplayOn);
+                    Slogf.d(TAG, "Initial display state: " + displayId + "=" + isDisplayOn);
+                }
+                mDisplayStateInitiated = true;
+            }
+            return true;
+        }
+
+        @GuardedBy("mLock")
+        private IntArray getDisplayIdsLocked() {
+            IntArray displayIds = new IntArray();
+            if (mDisplayStateInitiated) {
+                for (int i = 0; i < mDisplayStateSet.size(); i++) {
+                    displayIds.add(mDisplayStateSet.keyAt(i));
+                }
+                return displayIds;
+            }
+            Slogf.d(TAG, "Display state not initiated yet, use displayManager");
+            for (Display display : mDisplayManager.getDisplays()) {
+                int displayId = display.getDisplayId();
+                displayIds.add(displayId);
+            }
+            return displayIds;
+        }
+
+        // When the driver users is updated, the brightness settings associated with the driver
+        // user changes. As a result, all display's brightness should be refreshed to represent
+        // the new driver user's settings.
+        private void onDriverUserUpdate() {
             synchronized (mLock) {
                 if (mCarPowerManagementService == null) {
                     // CarPowerManagementService is not connected yet
                     return;
                 }
-                // We need to reset last value
-                mDisplayBrightnessSet.put(DEFAULT_DISPLAY, INVALID_DISPLAY_BRIGHTNESS);
             }
-            refreshDisplayBrightness();
+            if (Flags.multiDisplayBrightnessControl()) {
+                refreshAllDisplaysBrightness();
+            } else {
+                refreshDefaultDisplayBrightness();
+            }
+        }
+
+        private void refreshAllDisplaysBrightness() {
+            for (Display display : mDisplayManager.getDisplays()) {
+                int displayId = display.getDisplayId();
+                int displayType = mDisplayHelper.getType(display);
+                if (displayType == DisplayHelper.TYPE_VIRTUAL
+                        || displayType == DisplayHelper.TYPE_OVERLAY) {
+                    Slogf.i(TAG,
+                            "Ignore refreshDisplayBrightness for virtual or overlay display: "
+                            + displayId);
+                    continue;
+                }
+                refreshDisplayBrightness(displayId);
+            }
+        }
+
+        private boolean hasRecentlySetBrightness(float brightness, int displayId) {
+            synchronized (mLock) {
+                for (int i = 0; i < mRecentlySetBrightnessForDisplayId.size(); i++) {
+                    if (isSameBrightnessForDisplayId(mRecentlySetBrightnessForDisplayId.get(i),
+                            brightness, displayId)) {
+                        Slogf.v(TAG,
+                                "Ignore brightness change from DisplayManager, brightness=%f, "
+                                + "displayId=%d, same as recently change set to DisplayManager",
+                                brightness, displayId);
+                        return true;
+                    }
+                }
+            }
+            return false;
+        }
+
+        private void addRecentlySetBrightness(float brightness, int displayId) {
+            synchronized (mLock) {
+                mRecentlySetBrightnessForDisplayId.add(
+                        new BrightnessForDisplayId(brightness, displayId));
+                mHandler.postDelayed(() -> {
+                    synchronized (mLock) {
+                        mRecentlySetBrightnessForDisplayId.removeFirst();
+                    }
+                }, PREVENT_LOOP_REQUEST_TIME_WINDOW_MS);
+            }
+        }
+
+        private boolean hasRecentlySetBrightness(int brightness) {
+            synchronized (mLock) {
+                for (int i = 0; i < mRecentlySetGlobalBrightness.size(); i++) {
+                    if (mRecentlySetGlobalBrightness.get(i) == brightness) {
+                        Slogf.v(TAG,
+                                "Ignore brightness change from System Settings, brightness=%d"
+                                + ", same as recently change set to System Settings", brightness);
+                        return true;
+                    }
+                }
+                return false;
+            }
+        }
+
+        @GuardedBy("mLock")
+        private void addRecentlySetBrightness(int brightness) {
+            synchronized (mLock) {
+                mRecentlySetGlobalBrightness.add(brightness);
+                mHandler.postDelayed(() -> {
+                    synchronized (mLock) {
+                        mRecentlySetGlobalBrightness.removeFirst();
+                    }
+                }, PREVENT_LOOP_REQUEST_TIME_WINDOW_MS);
+            }
+        }
+
+        private boolean isSameBrightnessForDisplayId(BrightnessForDisplayId toCheck,
+                float brightness, int displayId) {
+            return toCheck.brightness() == brightness && toCheck.displayId() == displayId;
         }
     }
 }
diff --git a/service/src/com/android/car/systeminterface/SystemInterface.java b/service/src/com/android/car/systeminterface/SystemInterface.java
index 0ae94f17ef..eb09060368 100644
--- a/service/src/com/android/car/systeminterface/SystemInterface.java
+++ b/service/src/com/android/car/systeminterface/SystemInterface.java
@@ -22,10 +22,13 @@ import android.os.UserHandle;
 
 import com.android.car.power.CarPowerManagementService;
 import com.android.car.procfsinspector.ProcessInfo;
+import com.android.car.provider.Settings;
 import com.android.car.storagemonitoring.LifetimeWriteInfoProvider;
 import com.android.car.storagemonitoring.UidIoStatsProvider;
 import com.android.car.storagemonitoring.WearInformationProvider;
+import com.android.car.user.ActivityManagerCurrentUserFetcher;
 import com.android.car.user.CarUserService;
+import com.android.internal.annotations.VisibleForTesting;
 
 import java.io.File;
 import java.time.Duration;
@@ -54,7 +57,8 @@ public class SystemInterface implements ActivityManagerInterface,
             StorageMonitoringInterface storageMonitoringInterface,
             SystemStateInterface systemStateInterface,
             TimeInterface timeInterface,
-            WakeLockInterface wakeLockInterface) {
+            WakeLockInterface wakeLockInterface,
+            Settings settings) {
         mActivityManagerInterface = activityManagerInterface;
         mDisplayInterface = displayInterface;
         mIOInterface = ioInterface;
@@ -128,13 +132,8 @@ public class SystemInterface implements ActivityManagerInterface,
     }
 
     @Override
-    public void setDisplayBrightness(int brightness) {
-        mDisplayInterface.setDisplayBrightness(brightness);
-    }
-
-    @Override
-    public void setDisplayBrightness(int displayId, int brightness) {
-        mDisplayInterface.setDisplayBrightness(displayId, brightness);
+    public void onDisplayBrightnessChangeFromVhal(int displayId, int brightness) {
+        mDisplayInterface.onDisplayBrightnessChangeFromVhal(displayId, brightness);
     }
 
     @Override
@@ -232,8 +231,8 @@ public class SystemInterface implements ActivityManagerInterface,
     }
 
     @Override
-    public void refreshDisplayBrightness() {
-        mDisplayInterface.refreshDisplayBrightness();
+    public void refreshDefaultDisplayBrightness() {
+        mDisplayInterface.refreshDefaultDisplayBrightness();
     }
 
     @Override
@@ -249,6 +248,7 @@ public class SystemInterface implements ActivityManagerInterface,
         private SystemStateInterface mSystemStateInterface;
         private TimeInterface mTimeInterface;
         private WakeLockInterface mWakeLockInterface;
+        private Settings mSettings;
 
         private Builder() {}
 
@@ -257,12 +257,26 @@ public class SystemInterface implements ActivityManagerInterface,
         }
 
         public static Builder defaultSystemInterface(Context context) {
+            return defaultSystemInterface(context, new WakeLockInterface.DefaultImpl(context));
+        }
+
+        /**
+         * Creates a system interface with injected WakeLockInterface.
+         *
+         * WakeLockInterface will be used during DisplayInterface constructor.
+         */
+        @VisibleForTesting
+        public static Builder defaultSystemInterface(Context context,
+                WakeLockInterface wakeLockInterface) {
             Objects.requireNonNull(context);
             Builder builder = newSystemInterface();
             builder.withActivityManagerInterface(new ActivityManagerInterface.DefaultImpl(context));
-            builder.withWakeLockInterface(new WakeLockInterface.DefaultImpl(context));
+            builder.withWakeLockInterface(wakeLockInterface);
+            builder.withSettings(new Settings.DefaultImpl());
             builder.withDisplayInterface(new DisplayInterface.DefaultImpl(context,
-                    builder.mWakeLockInterface));
+                    wakeLockInterface, builder.mSettings,
+                    new DisplayHelperInterface.DefaultImpl(),
+                    new ActivityManagerCurrentUserFetcher()));
             builder.withIOInterface(new IOInterface.DefaultImpl());
             builder.withStorageMonitoringInterface(new StorageMonitoringInterface.DefaultImpl());
             builder.withSystemStateInterface(new SystemStateInterface.DefaultImpl(context));
@@ -277,7 +291,8 @@ public class SystemInterface implements ActivityManagerInterface,
                     .withStorageMonitoringInterface(otherBuilder.mStorageMonitoringInterface)
                     .withSystemStateInterface(otherBuilder.mSystemStateInterface)
                     .withTimeInterface(otherBuilder.mTimeInterface)
-                    .withWakeLockInterface(otherBuilder.mWakeLockInterface);
+                    .withWakeLockInterface(otherBuilder.mWakeLockInterface)
+                    .withSettings(otherBuilder.mSettings);
         }
 
         public Builder withActivityManagerInterface(ActivityManagerInterface
@@ -317,6 +332,14 @@ public class SystemInterface implements ActivityManagerInterface,
             return this;
         }
 
+        /**
+         * Sets the {@link Settings}.
+         */
+        public Builder withSettings(Settings settings) {
+            mSettings = settings;
+            return this;
+        }
+
         public SystemInterface build() {
             return new SystemInterface(Objects.requireNonNull(mActivityManagerInterface),
                     Objects.requireNonNull(mDisplayInterface),
@@ -324,7 +347,8 @@ public class SystemInterface implements ActivityManagerInterface,
                     Objects.requireNonNull(mStorageMonitoringInterface),
                     Objects.requireNonNull(mSystemStateInterface),
                     Objects.requireNonNull(mTimeInterface),
-                    Objects.requireNonNull(mWakeLockInterface));
+                    Objects.requireNonNull(mWakeLockInterface),
+                    Objects.requireNonNull(mSettings));
         }
     }
 }
diff --git a/service/src/com/android/car/systeminterface/test/DisplayInterfaceEmptyImpl.java b/service/src/com/android/car/systeminterface/test/DisplayInterfaceEmptyImpl.java
new file mode 100644
index 0000000000..c6631ff0a1
--- /dev/null
+++ b/service/src/com/android/car/systeminterface/test/DisplayInterfaceEmptyImpl.java
@@ -0,0 +1,67 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.systeminterface.test;
+
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.BOILERPLATE_CODE;
+
+import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
+import com.android.car.power.CarPowerManagementService;
+import com.android.car.systeminterface.DisplayInterface;
+import com.android.car.user.CarUserService;
+import com.android.internal.annotations.VisibleForTesting;
+
+/**
+ * An empty implementation used for testing.
+ */
+@ExcludeFromCodeCoverageGeneratedReport(reason = BOILERPLATE_CODE)
+@VisibleForTesting
+public class DisplayInterfaceEmptyImpl implements DisplayInterface {
+    @Override
+    public void init(CarPowerManagementService carPowerManagementService,
+            CarUserService carUserService) {}
+
+    @Override
+    public void onDisplayBrightnessChangeFromVhal(int displayId, int brightness) {}
+
+    @Override
+    public void setDisplayState(int displayId, boolean on) {}
+
+    @Override
+    public void setAllDisplayState(boolean on) {}
+
+    @Override
+    public void startDisplayStateMonitoring() {}
+
+    @Override
+    public void stopDisplayStateMonitoring() {}
+
+    @Override
+    public void refreshDefaultDisplayBrightness() {}
+
+    @Override
+    public void refreshDisplayBrightness(int displayid) {}
+
+    @Override
+    public boolean isAnyDisplayEnabled() {
+        return false;
+    }
+
+    @Override
+    public boolean isDisplayEnabled(int displayId) {
+        return false;
+    }
+}
diff --git a/service/src/com/android/car/user/ActivityManagerCurrentUserFetcher.java b/service/src/com/android/car/user/ActivityManagerCurrentUserFetcher.java
new file mode 100644
index 0000000000..97d36c2378
--- /dev/null
+++ b/service/src/com/android/car/user/ActivityManagerCurrentUserFetcher.java
@@ -0,0 +1,32 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.user;
+
+import android.app.ActivityManager;
+
+/**
+ * An implementation for {@link CurrentUserFetcher} using {@link ActivityManager};
+ */
+public final class ActivityManagerCurrentUserFetcher implements CurrentUserFetcher {
+    /**
+     * See {@link android.app.ActivityManager.getCurrentUser}.
+     */
+    @Override
+    public int getCurrentUser() {
+        return ActivityManager.getCurrentUser();
+    }
+}
diff --git a/service/src/com/android/car/user/CarUserService.java b/service/src/com/android/car/user/CarUserService.java
index 7d320103d4..ff0ffdafba 100644
--- a/service/src/com/android/car/user/CarUserService.java
+++ b/service/src/com/android/car/user/CarUserService.java
@@ -46,13 +46,16 @@ import android.car.ICarUserService;
 import android.car.VehicleAreaSeat;
 import android.car.builtin.app.ActivityManagerHelper;
 import android.car.builtin.content.pm.PackageManagerHelper;
+import android.car.builtin.devicepolicy.DevicePolicyManagerHelper;
 import android.car.builtin.os.TraceHelper;
 import android.car.builtin.os.UserManagerHelper;
 import android.car.builtin.util.EventLogHelper;
 import android.car.builtin.util.Slogf;
 import android.car.builtin.util.TimingsTraceLog;
+import android.car.builtin.widget.LockPatternHelper;
 import android.car.drivingstate.CarUxRestrictions;
 import android.car.drivingstate.ICarUxRestrictionsChangeListener;
+import android.car.feature.Flags;
 import android.car.settings.CarSettings;
 import android.car.user.CarUserManager;
 import android.car.user.CarUserManager.UserIdentificationAssociationSetValue;
@@ -101,7 +104,6 @@ import android.os.Process;
 import android.os.RemoteException;
 import android.os.UserHandle;
 import android.os.UserManager;
-import android.provider.Settings;
 import android.text.TextUtils;
 import android.util.ArrayMap;
 import android.util.Log;
@@ -125,6 +127,7 @@ import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.ResultCallbackImpl;
 import com.android.car.internal.common.CommonConstants.UserLifecycleEventType;
 import com.android.car.internal.common.UserHelperLite;
+import com.android.car.internal.dep.Trace;
 import com.android.car.internal.os.CarSystemProperties;
 import com.android.car.internal.util.ArrayUtils;
 import com.android.car.internal.util.DebugUtils;
@@ -132,6 +135,7 @@ import com.android.car.internal.util.FunctionalUtils;
 import com.android.car.internal.util.IndentingPrintWriter;
 import com.android.car.pm.CarPackageManagerService;
 import com.android.car.power.CarPowerManagementService;
+import com.android.car.provider.Settings;
 import com.android.car.user.InitialUserSetter.InitialUserInfo;
 import com.android.internal.annotations.GuardedBy;
 import com.android.internal.annotations.VisibleForTesting;
@@ -189,6 +193,15 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
 
     public static final String HANDLER_THREAD_NAME = "UserService";
 
+    /** List of user restrictions that will be set on a visible background user. */
+    private static final String[] VISIBLE_BACKGROUND_USER_RESTRICTIONS = new String[] {
+            UserManager.DISALLOW_CONFIG_BLUETOOTH,
+            UserManager.DISALLOW_CONFIG_DATE_TIME,
+            UserManager.DISALLOW_CONFIG_LOCALE,
+            UserManager.DISALLOW_MICROPHONE_TOGGLE,
+            UserManager.DISALLOW_CAMERA_TOGGLE,
+    };
+
     // Constants below must match value of same constants defined by ActivityManager
     public static final int USER_OP_SUCCESS = 0;
     public static final int USER_OP_UNKNOWN_USER = -1;
@@ -214,6 +227,8 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
 
     private static final String BG_HANDLER_THREAD_NAME = "UserService.BG";
 
+    private final Settings mSettings;
+    private final CurrentUserFetcher mCurrentUserFetcher;
     private final Context mContext;
     private final ActivityManager mAm;
     private final UserManager mUserManager;
@@ -320,6 +335,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
      */
     @GuardedBy("mLockUser")
     private boolean mStartBackgroundUsersOnGarageMode = true;
+    private String mUserPickerName;
 
     // Whether visible background users are supported on the default display, a.k.a. passenger only
     // systems.
@@ -345,37 +361,57 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
             @NonNull CarUxRestrictionsManagerService uxRestrictionService,
             @NonNull CarPackageManagerService carPackageManagerService,
             @NonNull CarOccupantZoneService carOccupantZoneService) {
-        this(context, hal, userManager, new UserHandleHelper(context, userManager),
-                context.getSystemService(DevicePolicyManager.class),
-                context.getSystemService(ActivityManager.class), maxRunningUsers,
-                /* initialUserSetter= */ null, uxRestrictionService, /* handler= */ null,
-                carPackageManagerService, carOccupantZoneService);
+        this(context, hal, userManager, maxRunningUsers, uxRestrictionService,
+                carPackageManagerService, carOccupantZoneService,
+                new Deps(
+                        new UserHandleHelper(context, userManager),
+                        context.getSystemService(DevicePolicyManager.class),
+                        context.getSystemService(ActivityManager.class),
+                        // The default initial user setter requires access to CarUserService
+                        // reference, so we cannot create it here before the constructor.
+                        /* initialUserSetter= */ null,
+                        // The handler constructor requires mHandlerThread which cannot be
+                        // accessed before the constructor.
+                        /* handler= */ null,
+                        new ActivityManagerCurrentUserFetcher(),
+                        new Settings.DefaultImpl()));
     }
 
     @VisibleForTesting
-    CarUserService(@NonNull Context context, @NonNull UserHalService hal,
+    public record Deps(UserHandleHelper userHandleHelper,
+            DevicePolicyManager dpm,
+            ActivityManager am,
+            @Nullable InitialUserSetter initialUserSetter,
+            Handler handler,
+            CurrentUserFetcher currentUserFetcher,
+            Settings settings) {}
+
+    @VisibleForTesting
+    public CarUserService(
+            @NonNull Context context, @NonNull UserHalService hal,
             @NonNull UserManager userManager,
-            @NonNull UserHandleHelper userHandleHelper,
-            @NonNull DevicePolicyManager dpm,
-            @NonNull ActivityManager am,
             int maxRunningUsers,
-            @Nullable InitialUserSetter initialUserSetter,
             @NonNull CarUxRestrictionsManagerService uxRestrictionService,
-            @Nullable Handler handler,
             @NonNull CarPackageManagerService carPackageManagerService,
-            @NonNull CarOccupantZoneService carOccupantZoneService) {
+            @NonNull CarOccupantZoneService carOccupantZoneService,
+            @NonNull Deps deps) {
         Slogf.d(TAG, "CarUserService(): DBG=%b, user=%s", DBG, context.getUser());
         mContext = context;
         mHal = hal;
-        mAm = am;
         mMaxRunningUsers = maxRunningUsers;
         mUserManager = userManager;
-        mDpm = dpm;
-        mUserHandleHelper = userHandleHelper;
-        mHandler = handler == null ? new Handler(mHandlerThread.getLooper()) : handler;
-        mInitialUserSetter =
-                initialUserSetter == null ? new InitialUserSetter(context, this,
-                        (u) -> setInitialUser(u), mUserHandleHelper) : initialUserSetter;
+
+        mAm = deps.am();
+        mDpm = deps.dpm();
+        mUserHandleHelper = deps.userHandleHelper();
+        mHandler = deps.handler() != null ? deps.handler() :
+                new Handler(mHandlerThread.getLooper());
+        mInitialUserSetter = deps.initialUserSetter() != null ? deps.initialUserSetter() :
+                new InitialUserSetter(context, this, (u) -> setInitialUser(u), mUserHandleHelper,
+                        deps);
+        mCurrentUserFetcher = deps.currentUserFetcher();
+        mSettings = deps.settings();
+
         Resources resources = context.getResources();
         mSwitchGuestUserBeforeSleep = resources.getBoolean(
                 R.bool.config_switchGuestUserBeforeGoingSleep);
@@ -388,6 +424,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
         // from a running user.
         mCreateUserQueue = new ArrayDeque<>(UserManagerHelper.getMaxRunningUsers(context));
         mCarOccupantZoneService = carOccupantZoneService;
+        mUserPickerName = mContext.getResources().getString(R.string.config_userPickerActivity);
     }
 
     /**
@@ -400,6 +437,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
 
     @Override
     public void init() {
+        Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "CarUserService.init");
         if (DBG) {
             Slogf.d(TAG, "init()");
         }
@@ -415,6 +453,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
         }
         CarServiceHelperWrapper.getInstance().runOnConnection(() ->
                 setUxRestrictions(mCarUxRestrictionService.getCurrentUxRestrictions()));
+        Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
     }
 
     private final ICarOccupantZoneCallback mOccupantZoneCallback =
@@ -524,7 +563,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
     }
 
     private void dumpGlobalProperty(IndentingPrintWriter writer, String property) {
-        String value = Settings.Global.getString(mContext.getContentResolver(), property);
+        String value = mSettings.getStringGlobal(mContext.getContentResolver(), property);
         writer.printf("%s=%s\n", property, value);
     }
 
@@ -701,7 +740,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
     }
 
     private void initResumeReplaceGuest() {
-        int currentUserId = ActivityManager.getCurrentUser();
+        int currentUserId = mCurrentUserFetcher.getCurrentUser();
         UserHandle currentUser = mUserHandleHelper.getExistingUserHandle(currentUserId);
 
         if (currentUser == null) {
@@ -748,6 +787,8 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
     }
 
     private void initBootUser(int requestType) {
+        Trace.asyncTraceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "initBootUser",
+                requestType);
         boolean replaceGuest =
                 requestType == InitialUserInfoRequestType.RESUME && !mSwitchGuestUserBeforeSleep;
         checkManageUsersPermission("startInitialUser");
@@ -757,6 +798,8 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
             fallbackToDefaultInitialUserBehavior(/* userLocales= */ null, replaceGuest,
                     /* supportsOverrideUserIdProperty= */ true, requestType);
             EventLogHelper.writeCarUserServiceInitialUserInfoReqComplete(requestType);
+            Trace.asyncTraceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE, "initBootUser",
+                    requestType);
             return;
         }
 
@@ -822,6 +865,8 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
                         /* supportsOverrideUserIdProperty= */ false, requestType);
             }
             EventLogHelper.writeCarUserServiceInitialUserInfoReqComplete(requestType);
+            Trace.asyncTraceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE, "initBootUser",
+                    requestType);
         });
     }
 
@@ -953,7 +998,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
     private void handleSwitchUser(@NonNull UserHandle targetUser, int timeoutMs,
             @NonNull ResultCallbackImpl<UserSwitchResult> callback, boolean isLogout,
             boolean ignoreUxRestriction) {
-        int currentUser = ActivityManager.getCurrentUser();
+        int currentUser = mCurrentUserFetcher.getCurrentUser();
         int targetUserId = targetUser.getIdentifier();
         if (currentUser == targetUserId) {
             if (DBG) {
@@ -1016,7 +1061,12 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
         if (DBG) {
             Slogf.d(TAG, "calling mHal.switchUser(%s)", request);
         }
+
+        Trace.asyncTraceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "switchUser.HalResponse",
+                targetUserId);
         mHal.switchUser(request, timeoutMs, (halCallbackStatus, resp) -> {
+            Trace.asyncTraceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE, "switchUser.HalResponse",
+                    targetUserId);
             if (DBG) {
                 Slogf.d(TAG, "switch response: status=%s, resp=%s",
                         Integer.toString(halCallbackStatus), resp);
@@ -1328,8 +1378,15 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
         // will not work here because handleCreateUser() calls UserHalService#createUser(),
         // which is an asynchronous call. Two consecutive createUser requests would result in
         // STATUS_CONCURRENT_OPERATION error from UserHalService.
-        enqueueCreateUser(() -> handleCreateUser(name, userType, flags, timeoutMs, callback,
-                callingUser, hasCallerRestrictions));
+        enqueueCreateUser(() -> {
+            try {
+                Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "handleCreateUser");
+                handleCreateUser(name, userType, flags, timeoutMs, callback,
+                        callingUser, hasCallerRestrictions);
+            } finally {
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
+            }
+        });
     }
 
     private void enqueueCreateUser(Runnable runnable) {
@@ -1479,7 +1536,11 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
         }
 
         try {
+            Trace.asyncTraceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "createUser.HalResponse",
+                    newUser.getIdentifier());
             mHal.createUser(request, timeoutMs, (status, resp) -> {
+                Trace.asyncTraceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE, "createUser.HalResponse",
+                        newUser.getIdentifier());
                 String errorMessage = resp != null ? resp.errorMessage : null;
                 int resultStatus = UserCreationResult.STATUS_HAL_INTERNAL_FAILURE;
                 if (DBG) {
@@ -1834,7 +1895,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
     private void updateDefaultUserRestriction() {
         // We want to set restrictions on system and guest users only once. These are persisted
         // onto disk, so it's sufficient to do it once + we minimize the number of disk writes.
-        if (Settings.Global.getInt(mContext.getContentResolver(),
+        if (mSettings.getIntGlobal(mContext.getContentResolver(),
                 CarSettings.Global.DEFAULT_USER_RESTRICTIONS_SET, /* default= */ 0) != 0) {
             return;
         }
@@ -1842,7 +1903,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
         if (UserManager.isHeadlessSystemUserMode()) {
             setSystemUserRestrictions();
         }
-        Settings.Global.putInt(mContext.getContentResolver(),
+        mSettings.putIntGlobal(mContext.getContentResolver(),
                 CarSettings.Global.DEFAULT_USER_RESTRICTIONS_SET, 1);
     }
 
@@ -1890,7 +1951,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
                 Integer user = userId;
                 if (isPersistentUser(userId)) {
                     // current foreground user should stay in top priority.
-                    if (userId == ActivityManager.getCurrentUser()) {
+                    if (userId == mCurrentUserFetcher.getCurrentUser()) {
                         mBackgroundUsersToRestart.remove(user);
                         mBackgroundUsersToRestart.add(0, user);
                     }
@@ -1930,7 +1991,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
 
         // Non-current user only
         // TODO(b/270719791): Keep track of the current user to avoid IPC to AM.
-        if (userId == ActivityManager.getCurrentUser()) {
+        if (userId == mCurrentUserFetcher.getCurrentUser()) {
             if (DBG) {
                 Slogf.d(TAG, "onUserStarting: user %d is the current user, skipping", userId);
             }
@@ -1986,7 +2047,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
 
         // Non-current user only
         // TODO(b/270719791): Keep track of the current user to avoid IPC to AM.
-        if (userId == ActivityManager.getCurrentUser()) {
+        if (userId == mCurrentUserFetcher.getCurrentUser()) {
             if (DBG) {
                 Slogf.d(TAG, "onUserVisible: user %d is the current user, skipping", userId);
             }
@@ -2043,6 +2104,47 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
 
         stopSystemUiForUser(mContext, userId);
         unassignInvisibleUserFromZone(userId);
+        if (Flags.visibleBackgroundUserRestrictions()) {
+            // Clear the visible background user restrictions, set by onUserVisible().
+            clearVisibleBackgroundUserRestrictions(userId);
+        }
+    }
+
+    private void setVisibleBackgroundUserRestrictions(@UserIdInt int userId) {
+        int displayId = getMainDisplayAssignedToUser(userId);
+        if (mCarOccupantZoneService.getDisplayIdForDriver(CarOccupantZoneManager.DISPLAY_TYPE_MAIN)
+                == displayId) {
+            if (DBG) {
+                Slogf.d(TAG, "Skip setting restrictions on visible user %d"
+                        + ", because it is visible on the driver display %d", userId, displayId);
+            }
+            return;
+        }
+        if (DBG) {
+            Slogf.d(TAG, "Setting user restrictions for a visible background user %d", userId);
+        }
+        synchronized (mLockUser) {
+            UserHandle userHandle = UserHandle.of(userId);
+            for (int i = 0; i < VISIBLE_BACKGROUND_USER_RESTRICTIONS.length; i++) {
+                String restrictionKey = VISIBLE_BACKGROUND_USER_RESTRICTIONS[i];
+                DevicePolicyManagerHelper.addUserRestriction(
+                        mDpm, mContext.getPackageName(), restrictionKey, userHandle);
+            }
+        }
+    }
+
+    private void clearVisibleBackgroundUserRestrictions(@UserIdInt int userId) {
+        if (DBG) {
+            Slogf.d(TAG, "Clearing user restrictions for a visible background user %d", userId);
+        }
+        synchronized (mLockUser) {
+            UserHandle userHandle = UserHandle.of(userId);
+            for (int i = 0; i < VISIBLE_BACKGROUND_USER_RESTRICTIONS.length; i++) {
+                String restrictionKey = VISIBLE_BACKGROUND_USER_RESTRICTIONS[i];
+                DevicePolicyManagerHelper.clearUserRestriction(
+                        mDpm, mContext.getPackageName(), restrictionKey, userHandle);
+            }
+        }
     }
 
     private void startUsersOrHomeOnSecondaryDisplays(@UserIdInt int userId) {
@@ -2054,7 +2156,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
         }
 
         // Run from here only when CMUMD is supported.
-        if (userId == ActivityManager.getCurrentUser()) {
+        if (userId == mCurrentUserFetcher.getCurrentUser()) {
             mBgHandler.post(() -> startUserPickerOnOtherDisplays(/* currentUserId= */ userId));
         } else {
             mBgHandler.post(() -> startLauncherForVisibleUser(userId));
@@ -2082,8 +2184,10 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
 
     private void handleStartUser(@UserIdInt int userId, int displayId,
             ResultCallbackImpl<UserStartResponse> callback) {
+        Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "handleStartUser. UserId: " + userId);
         @UserStartResponse.Status int userStartStatus = startUserInternal(userId, displayId);
         sendUserStartUserResponse(userId, displayId, userStartStatus, callback);
+        Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
     }
 
     private void sendUserStartUserResponse(@UserIdInt int userId, int displayId,
@@ -2112,6 +2216,12 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
             return UserStartResponse.STATUS_USER_DOES_NOT_EXIST;
         }
 
+        if (!Flags.supportsSecurePassengerUsers() && LockPatternHelper.isSecure(mContext, userId)) {
+            // Passenger lock screen not currently supported - reject user start
+            Slogf.w(TAG, "Secure user %d cannot be started as a passenger", userId);
+            return UserStartResponse.STATUS_UNSUPPORTED_PLATFORM_FAILURE;
+        }
+
         // If the specified display is not a valid display for assigning user to.
         // Note: In passenger only system, users will be allowed on the DEFAULT_DISPLAY.
         if (displayId == Display.DEFAULT_DISPLAY) {
@@ -2141,8 +2251,15 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
             return UserStartResponse.STATUS_USER_ASSIGNED_TO_ANOTHER_DISPLAY;
         }
 
-        return ActivityManagerHelper.startUserInBackgroundVisibleOnDisplay(userId, displayId)
-                ? UserStartResponse.STATUS_SUCCESSFUL : UserStartResponse.STATUS_ANDROID_FAILURE;
+        if (ActivityManagerHelper.startUserInBackgroundVisibleOnDisplay(userId, displayId)) {
+            if (Flags.visibleBackgroundUserRestrictions()) {
+                // Set user restrictions for a visible background user that just started.
+                setVisibleBackgroundUserRestrictions(userId);
+            }
+            return UserStartResponse.STATUS_SUCCESSFUL;
+        }
+
+        return UserStartResponse.STATUS_ANDROID_FAILURE;
     }
 
     /**
@@ -2161,13 +2278,16 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
 
     private void handleStartUserInBackground(@UserIdInt int userId,
             AndroidFuture<UserStartResult> receiver) {
+        Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE,
+                "handleStartUserInBackground. UserId: " + userId);
         int result = startUserInBackgroundInternal(userId);
         sendUserStartResult(userId, result, receiver);
+        Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
     }
 
     private @UserStartResult.Status int startUserInBackgroundInternal(@UserIdInt int userId) {
         // If the requested user is the current user, do nothing and return success.
-        if (ActivityManager.getCurrentUser() == userId) {
+        if (mCurrentUserFetcher.getCurrentUser() == userId) {
             return UserStartResult.STATUS_SUCCESSFUL_USER_IS_CURRENT_USER;
         }
         // If requested user does not exist, return error.
@@ -2216,7 +2336,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
         }
         ArrayList<Integer> startedUsers = new ArrayList<>();
         for (Integer user : users) {
-            if (user == ActivityManager.getCurrentUser()) {
+            if (user == mCurrentUserFetcher.getCurrentUser()) {
                 continue;
             }
             if (ActivityManagerHelper.startUserInBackground(user)) {
@@ -2482,11 +2602,31 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
                 Slogf.e(TAG, "No main display for occupant zone:%d", zoneId);
                 continue;
             }
-            CarLocalServices.getService(CarActivityService.class)
-                    .startUserPickerOnDisplay(displayId);
+            // TODO(b/368612643): Add unit tests for this behavior
+            if (!isUserPickerVisible(displayId)) {
+                CarLocalServices.getService(CarActivityService.class).startUserPickerOnDisplay(
+                        displayId);
+            }
         }
     }
 
+    private boolean isUserPickerVisible(int displayId) {
+        List<ActivityManager.RunningTaskInfo> tasks = CarLocalServices.getService(
+                CarActivityService.class).getVisibleTasksInternal(displayId);
+        for (int i = tasks.size() - 1; i >= 0; i--) {
+            ActivityManager.RunningTaskInfo taskInfo = tasks.get(i);
+            if (taskInfo.topActivity == null) {
+                continue;
+            }
+            if (Objects.equals(taskInfo.topActivity.flattenToString(), mUserPickerName)) {
+                // UserPicker activity found in the visible activities
+                return true;
+            }
+        }
+        // UserPicker activity not visible
+        return false;
+    }
+
     @VisibleForTesting
     void startUserPickerOnOtherDisplays(@UserIdInt int currentUserId) {
         if (!isMultipleUsersOnMultipleDisplaysSupported(mUserManager)) {
@@ -2554,7 +2694,7 @@ public final class CarUserService extends ICarUserService.Stub implements CarSer
             return;
         }
         if (userId == UserHandle.SYSTEM.getIdentifier()
-                || userId == ActivityManager.getCurrentUser()) {
+                || userId == mCurrentUserFetcher.getCurrentUser()) {
             Slogf.w(TAG, "Cannot start SystemUI for current or system user (userId=%d)", userId);
             return;
         }
diff --git a/service/src/com/android/car/user/CurrentUserFetcher.java b/service/src/com/android/car/user/CurrentUserFetcher.java
new file mode 100644
index 0000000000..8b0acb197a
--- /dev/null
+++ b/service/src/com/android/car/user/CurrentUserFetcher.java
@@ -0,0 +1,27 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.user;
+
+/**
+ * An interface to get current user. Designed to be faked for unit testing.
+ */
+public interface CurrentUserFetcher {
+    /**
+     * See {@link android.app.ActivityManager.getCurrentUser}.
+     */
+    int getCurrentUser();
+}
diff --git a/service/src/com/android/car/user/ExperimentalCarUserService.java b/service/src/com/android/car/user/ExperimentalCarUserService.java
deleted file mode 100644
index 1f66e6e150..0000000000
--- a/service/src/com/android/car/user/ExperimentalCarUserService.java
+++ /dev/null
@@ -1,600 +0,0 @@
-/*
- * Copyright (C) 2021 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.car.user;
-
-import static android.car.user.CarUserManager.USER_LIFECYCLE_EVENT_TYPE_SWITCHING;
-
-import static com.android.car.CarServiceUtils.isEventOfType;
-import static com.android.car.PermissionHelper.checkHasAtLeastOnePermissionGranted;
-import static com.android.car.PermissionHelper.checkHasDumpPermissionGranted;
-import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DUMP_INFO;
-import static com.android.car.user.CarUserService.checkManageUsersPermission;
-import static com.android.car.user.CarUserService.sendUserSwitchResult;
-
-import android.annotation.Nullable;
-import android.annotation.UserIdInt;
-import android.app.ActivityManager;
-import android.car.CarOccupantZoneManager;
-import android.car.CarOccupantZoneManager.OccupantTypeEnum;
-import android.car.CarOccupantZoneManager.OccupantZoneInfo;
-import android.car.IExperimentalCarUserService;
-import android.car.SyncResultCallback;
-import android.car.builtin.app.ActivityManagerHelper;
-import android.car.builtin.os.TraceHelper;
-import android.car.builtin.os.UserManagerHelper;
-import android.car.builtin.util.Slogf;
-import android.car.builtin.util.TimingsTraceLog;
-import android.car.user.CarUserManager.UserLifecycleListener;
-import android.car.user.UserCreationResult;
-import android.car.user.UserLifecycleEventFilter;
-import android.car.user.UserSwitchResult;
-import android.car.util.concurrent.AndroidFuture;
-import android.content.Context;
-import android.content.res.Resources;
-import android.os.UserHandle;
-import android.os.UserManager;
-import android.util.proto.ProtoOutputStream;
-
-import com.android.car.CarLog;
-import com.android.car.CarServiceBase;
-import com.android.car.R;
-import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
-import com.android.car.internal.ResultCallbackImpl;
-import com.android.car.internal.common.UserHelperLite;
-import com.android.car.internal.os.CarSystemProperties;
-import com.android.car.internal.util.IndentingPrintWriter;
-import com.android.internal.annotations.GuardedBy;
-import com.android.internal.annotations.VisibleForTesting;
-
-import java.util.ArrayList;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Objects;
-import java.util.concurrent.CopyOnWriteArrayList;
-
-/**
- * Experimental User Service for Car. Including:
- *  <ul>
- *    <li> Creates a user used as driver.
- *    <li> Creates a user used as passenger.
- *    <li> Switch drivers.
- *  <ul/>
- */
-public final class ExperimentalCarUserService extends IExperimentalCarUserService.Stub
-        implements CarServiceBase {
-
-    @VisibleForTesting
-    static final String TAG = CarLog.tagFor(ExperimentalCarUserService.class);
-
-    private final int mHalTimeoutMs = CarSystemProperties.getUserHalTimeout().orElse(5_000);
-
-    private final CopyOnWriteArrayList<PassengerCallback> mPassengerCallbacks =
-            new CopyOnWriteArrayList<>();
-
-    private final Context mContext;
-    private final CarUserService mCarUserService;
-    private final UserManager mUserManager;
-    private final boolean mEnablePassengerSupport;
-    private final UserHandleHelper mUserHandleHelper;
-
-    private final Object mLock = new Object();
-    // Only one passenger is supported.
-    @GuardedBy("mLock")
-    private @UserIdInt int mLastPassengerId = UserManagerHelper.USER_NULL;
-
-    @GuardedBy("mLock")
-    private ZoneUserBindingHelper mZoneUserBindingHelper;
-
-    private final UserLifecycleListener mUserLifecycleListener = event -> {
-        if (!isEventOfType(TAG, event, USER_LIFECYCLE_EVENT_TYPE_SWITCHING)) {
-            return;
-        }
-        Slogf.d(TAG, "ExperimentalCarUserService.onEvent: %s", event);
-
-        onUserSwitching(event.getPreviousUserId(), event.getUserId());
-    };
-
-    /** Interface for callbacks related to passenger activities. */
-    public interface PassengerCallback {
-        /** Called when passenger is started at a certain zone. */
-        void onPassengerStarted(@UserIdInt int passengerId, int zoneId);
-        /** Called when passenger is stopped. */
-        void onPassengerStopped(@UserIdInt int passengerId);
-    }
-
-    /** Interface for delegating zone-related implementation to CarOccupantZoneService. */
-    public interface ZoneUserBindingHelper {
-        /** Gets occupant zones corresponding to the occupant type. */
-        List<OccupantZoneInfo> getOccupantZones(@OccupantTypeEnum int occupantType);
-        /** Assigns the user to the occupant zone. */
-        boolean assignUserToOccupantZone(@UserIdInt int userId, int zoneId);
-        /** Makes the occupant zone unoccupied. */
-        boolean unassignUserFromOccupantZone(@UserIdInt int userId);
-        /** Returns whether there is a passenger display. */
-        boolean isPassengerDisplayAvailable();
-    }
-
-    public ExperimentalCarUserService(Context context, CarUserService carUserService,
-            UserManager userManager) {
-        this(context, carUserService, userManager, new UserHandleHelper(context, userManager));
-    }
-
-    @VisibleForTesting
-    public ExperimentalCarUserService(Context context, CarUserService carUserService,
-            UserManager userManager, UserHandleHelper userHandleHelper) {
-        mContext = context;
-        mUserManager = userManager;
-        mCarUserService = carUserService;
-        Resources resources = context.getResources();
-        mEnablePassengerSupport = resources.getBoolean(R.bool.enablePassengerSupport);
-        mUserHandleHelper = userHandleHelper;
-    }
-
-    @Override
-    public void init() {
-        Slogf.d(TAG, "init()");
-
-        UserLifecycleEventFilter userSwitchingEventFilter = new UserLifecycleEventFilter.Builder()
-                .addEventType(USER_LIFECYCLE_EVENT_TYPE_SWITCHING).build();
-        mCarUserService.addUserLifecycleListener(userSwitchingEventFilter, mUserLifecycleListener);
-    }
-
-    @Override
-    public void release() {
-        Slogf.d(TAG, "release()");
-
-        mCarUserService.removeUserLifecycleListener(mUserLifecycleListener);
-    }
-
-    @Override
-    @ExcludeFromCodeCoverageGeneratedReport(reason = DUMP_INFO)
-    public void dump(IndentingPrintWriter writer) {
-        checkHasDumpPermissionGranted(mContext, "dump()");
-
-        writer.println("*ExperimentalCarUserService*");
-
-        List<UserHandle> allDrivers = getAllDrivers();
-        int driversSize = allDrivers.size();
-        writer.println("NumberOfDrivers: " + driversSize);
-        writer.increaseIndent();
-        for (int i = 0; i < driversSize; i++) {
-            int driverId = allDrivers.get(i).getIdentifier();
-            writer.printf("#%d: id=%d", i, driverId);
-            List<UserHandle> passengers = getPassengers(driverId);
-            int passengersSize = passengers.size();
-            writer.print(" NumberPassengers: " + passengersSize);
-            if (passengersSize > 0) {
-                writer.print(" [");
-                for (int j = 0; j < passengersSize; j++) {
-                    writer.print(passengers.get(j).getIdentifier());
-                    if (j < passengersSize - 1) {
-                        writer.print(" ");
-                    }
-                }
-                writer.print("]");
-            }
-            writer.println();
-        }
-        writer.decreaseIndent();
-        writer.printf("EnablePassengerSupport: %s\n", mEnablePassengerSupport);
-        synchronized (mLock) {
-            writer.printf("LastPassengerId: %d\n", mLastPassengerId);
-        }
-
-        writer.printf("User HAL timeout: %dms\n",  mHalTimeoutMs);
-    }
-
-    @Override
-    @ExcludeFromCodeCoverageGeneratedReport(reason = DUMP_INFO)
-    public void dumpProto(ProtoOutputStream proto) {}
-
-    @Override
-    public AndroidFuture<UserCreationResult> createDriver(String name, boolean admin) {
-        checkManageUsersPermission("createDriver");
-        Objects.requireNonNull(name, "name cannot be null");
-
-        AndroidFuture<UserCreationResult> future = new AndroidFuture<>();
-
-        ResultCallbackImpl<UserCreationResult> resultResultCallbackImpl = new ResultCallbackImpl<>(
-                Runnable::run, new SyncResultCallback<>()) {
-            @Override
-            protected void onCompleted(UserCreationResult result) {
-                if (result == null) {
-                    Slogf.w(TAG, "createDriver(%s, %s) failed", name, admin);
-                }
-                future.complete(result);
-                super.onCompleted(result);
-            }
-        };
-        int flags = 0;
-
-        if (admin) {
-            if (!(mUserManager.isAdminUser() || mUserManager.isSystemUser())) {
-                String internalErrorMsg =
-                        "Only admin users and system user can create other admins.";
-                Slogf.e(TAG, internalErrorMsg);
-                mCarUserService.sendUserCreationFailure(resultResultCallbackImpl,
-                        UserCreationResult.STATUS_INVALID_REQUEST,
-                        internalErrorMsg);
-                return future;
-            }
-            flags = UserManagerHelper.FLAG_ADMIN;
-        }
-
-        mCarUserService.createUser(name,
-                UserManagerHelper.getDefaultUserTypeForUserInfoFlags(flags), flags, mHalTimeoutMs,
-                resultResultCallbackImpl, false);
-        return future;
-    }
-
-    @Override
-    @Nullable
-    public UserHandle createPassenger(String name, @UserIdInt int driverId) {
-        checkManageUsersPermission("createPassenger");
-        Objects.requireNonNull(name, "name cannot be null");
-
-        UserHandle driver = mUserHandleHelper.getExistingUserHandle(driverId);
-        if (driver == null) {
-            Slogf.w(TAG, "the driver is invalid for driverId: %d", driverId);
-            return null;
-        }
-        if (mUserHandleHelper.isGuestUser(driver)) {
-            Slogf.w(TAG, "a guest driver with id %d cannot create a passenger", driverId);
-            return null;
-        }
-        // createPassenger doesn't use user HAL because user HAL doesn't support profile user yet.
-        UserManager userManager = mContext.createContextAsUser(driver, /* flags= */ 0)
-                .getSystemService(UserManager.class);
-        UserHandle user = userManager.createProfile(name, UserManager.USER_TYPE_PROFILE_MANAGED,
-                /* disallowedPackages= */ null);
-
-        if (user == null) {
-            // Couldn't create user, most likely because there are too many.
-            Slogf.w(TAG, "can't create a profile for user %d", driverId);
-            return null;
-        }
-        return user;
-    }
-
-    @Override
-    public void switchDriver(@UserIdInt int driverId, AndroidFuture<UserSwitchResult> receiver) {
-        checkManageUsersPermission("switchDriver");
-        ResultCallbackImpl<UserSwitchResult> resultCallbackImpl = new ResultCallbackImpl<>(
-                Runnable::run, new SyncResultCallback<>()) {
-            @Override
-            protected void onCompleted(UserSwitchResult result) {
-                receiver.complete(result);
-                super.onCompleted(result);
-            }
-        };
-
-        if (UserHelperLite.isHeadlessSystemUser(driverId)) {
-            // System user doesn't associate with real person, can not be switched to.
-            Slogf.w(TAG, "switching to system user in headless system user mode is not allowed");
-            sendUserSwitchResult(resultCallbackImpl, /* isLogout= */ false,
-                    UserSwitchResult.STATUS_INVALID_REQUEST);
-            return;
-        }
-        int userSwitchable = mUserManager.getUserSwitchability();
-        if (userSwitchable != UserManager.SWITCHABILITY_STATUS_OK) {
-            Slogf.w(TAG, "current process is not allowed to switch user");
-            sendUserSwitchResult(resultCallbackImpl, /* isLogout= */ false,
-                    UserSwitchResult.STATUS_INVALID_REQUEST);
-            return;
-        }
-        mCarUserService.switchUser(driverId, mHalTimeoutMs, resultCallbackImpl,
-                /* ignoreUxRestriction= */ false);
-    }
-
-    /**
-     * Returns all drivers who can occupy the driving zone. Guest users are included in the list.
-     *
-     * @return the list of {@link UserHandle} who can be a driver on the device.
-     */
-    @Override
-    public List<UserHandle> getAllDrivers() {
-        checkManageUsersOrDumpPermission("getAllDrivers");
-
-        return getUsersHandle(
-                (user) -> !UserHelperLite.isHeadlessSystemUser(user.getIdentifier())
-                        && mUserHandleHelper.isEnabledUser(user)
-                        && !mUserHandleHelper.isManagedProfile(user)
-                        && !mUserHandleHelper.isEphemeralUser(user));
-    }
-
-    /**
-     * Returns all passengers under the given driver.
-     *
-     * @param driverId User id of a driver.
-     * @return the list of {@link UserHandle} who is a passenger under the given driver.
-     */
-    @Override
-    public List<UserHandle> getPassengers(@UserIdInt int driverId) {
-        checkManageUsersOrDumpPermission("getPassengers");
-
-        return getUsersHandle((user) -> {
-            return !UserHelperLite.isHeadlessSystemUser(user.getIdentifier())
-                    && mUserHandleHelper.isEnabledUser(user)
-                    && mUserHandleHelper.isManagedProfile(user)
-                    && mUserManager.isSameProfileGroup(user, UserHandle.of(driverId));
-        });
-    }
-
-    @Override
-    public boolean startPassenger(@UserIdInt int passengerId, int zoneId) {
-        checkManageUsersPermission("startPassenger");
-
-        synchronized (mLock) {
-            if (!ActivityManagerHelper.startUserInBackground(passengerId)) {
-                Slogf.w(TAG, "could not start passenger");
-                return false;
-            }
-            if (!assignUserToOccupantZone(passengerId, zoneId)) {
-                Slogf.w(TAG, "could not assign passenger to zone");
-                return false;
-            }
-            mLastPassengerId = passengerId;
-        }
-        for (PassengerCallback callback : mPassengerCallbacks) {
-            callback.onPassengerStarted(passengerId, zoneId);
-        }
-        return true;
-    }
-
-    @Override
-    public boolean stopPassenger(@UserIdInt int passengerId) {
-        checkManageUsersPermission("stopPassenger");
-
-        return stopPassengerInternal(passengerId, true);
-    }
-
-    /** Adds callback to listen to passenger activity events. */
-    public void addPassengerCallback(PassengerCallback callback) {
-        Objects.requireNonNull(callback, "callback cannot be null");
-        mPassengerCallbacks.add(callback);
-    }
-
-    /** Removes previously added callback to listen passenger events. */
-    public void removePassengerCallback(PassengerCallback callback) {
-        Objects.requireNonNull(callback, "callback cannot be null");
-        mPassengerCallbacks.remove(callback);
-    }
-
-    /** Sets the implementation of ZoneUserBindingHelper. */
-    public void setZoneUserBindingHelper(ZoneUserBindingHelper helper) {
-        synchronized (mLock) {
-            mZoneUserBindingHelper = helper;
-        }
-    }
-
-    private boolean stopPassengerInternal(@UserIdInt int passengerId, boolean checkCurrentDriver) {
-        synchronized (mLock) {
-            // NULL passengerId means the last passenger.
-            // This is to avoid accessing mPassengerId without obtaining mLock.
-            if (passengerId == UserManagerHelper.USER_NULL) {
-                passengerId = mLastPassengerId;
-            }
-            UserHandle passenger = mUserHandleHelper.getExistingUserHandle(passengerId);
-            if (passenger == null) {
-                Slogf.w(TAG, "passenger %d doesn't exist", passengerId);
-                return false;
-            }
-            if (mLastPassengerId != passengerId) {
-                Slogf.w(TAG, "passenger %d hasn't been started", passengerId);
-                return true;
-            }
-            if (checkCurrentDriver) {
-                int currentUserId = ActivityManager.getCurrentUser();
-                if (!mUserManager.isSameProfileGroup(passenger, UserHandle.of(currentUserId))) {
-                    Slogf.w(TAG, "passenger %d is not a profile of the current user %d",
-                            passengerId, currentUserId);
-                    return false;
-                }
-            }
-            // Passenger is a profile, so cannot be stopped through activity manager.
-            // Instead, activities started by the passenger are stopped and the passenger is
-            // unassigned from the zone.
-            ActivityManagerHelper.stopAllTasksForUser(passengerId);
-            if (!unassignUserFromOccupantZone(passengerId)) {
-                Slogf.w(TAG, "could not unassign user %d from occupant zone", passengerId);
-                return false;
-            }
-            mLastPassengerId = UserManagerHelper.USER_NULL;
-        }
-        for (PassengerCallback callback : mPassengerCallbacks) {
-            callback.onPassengerStopped(passengerId);
-        }
-        return true;
-    }
-
-    private void onUserSwitching(@UserIdInt int fromUserId, @UserIdInt int toUserId) {
-        Slogf.d(TAG, "onUserSwitching() callback from user %d to user %d", fromUserId, toUserId);
-        TimingsTraceLog t = new TimingsTraceLog(TAG, TraceHelper.TRACE_TAG_CAR_SERVICE);
-        t.traceBegin("onUserSwitching-" + toUserId);
-
-        stopPassengerInternal(/* passengerId= */ UserManagerHelper.USER_NULL, false);
-
-        if (mEnablePassengerSupport && isPassengerDisplayAvailable()) {
-            setupPassengerUser();
-            startFirstPassenger(toUserId);
-        }
-        t.traceEnd();
-    }
-
-    interface UserFilter {
-        boolean isEligibleUser(UserHandle user);
-    }
-
-    /** Returns all users who are matched by the given filter. */
-    private List<UserHandle> getUsersHandle(UserFilter filter) {
-        List<UserHandle> users = UserManagerHelper.getUserHandles(mUserManager,
-                /* excludeDying= */ false);
-        List<UserHandle> usersFiltered = new ArrayList<UserHandle>();
-
-        for (Iterator<UserHandle> iterator = users.iterator(); iterator.hasNext(); ) {
-            UserHandle user = iterator.next();
-            if (filter.isEligibleUser(user)) {
-                usersFiltered.add(user);
-            }
-        }
-
-        return usersFiltered;
-    }
-
-    private void checkManageUsersOrDumpPermission(String message) {
-        checkHasAtLeastOnePermissionGranted(mContext, message,
-                android.Manifest.permission.MANAGE_USERS,
-                android.Manifest.permission.DUMP);
-    }
-
-    private int getNumberOfManagedProfiles(@UserIdInt int userId) {
-        List<UserHandle> users = UserManagerHelper.getUserHandles(mUserManager,
-                /* excludeDying= */ false);
-        // Count all users that are managed profiles of the given user.
-        int managedProfilesCount = 0;
-        for (UserHandle user : users) {
-            if (mUserHandleHelper.isManagedProfile(user)
-                    && mUserManager.isSameProfileGroup(user, UserHandle.of(userId))) {
-                managedProfilesCount++;
-            }
-        }
-        return managedProfilesCount;
-    }
-
-    /**
-     * Starts the first passenger of the given driver and assigns the passenger to the front
-     * passenger zone.
-     *
-     * @param driverId User id of the driver.
-     * @return whether it succeeds.
-     */
-    private boolean startFirstPassenger(@UserIdInt int driverId) {
-        int zoneId = getAvailablePassengerZone();
-        if (zoneId == CarOccupantZoneManager.OccupantZoneInfo.INVALID_ZONE_ID) {
-            Slogf.w(TAG, "passenger occupant zone is not found");
-            return false;
-        }
-        List<UserHandle> passengers = getPassengers(driverId);
-        if (passengers.size() < 1) {
-            Slogf.w(TAG, "passenger is not found for driver %d", driverId);
-            return false;
-        }
-        // Only one passenger is supported. If there are two or more passengers, the first passenger
-        // is chosen.
-        int passengerId = passengers.get(0).getIdentifier();
-        if (!startPassenger(passengerId, zoneId)) {
-            Slogf.w(TAG, "cannot start passenger %d", passengerId);
-            return false;
-        }
-        return true;
-    }
-
-    private int getAvailablePassengerZone() {
-        int[] occupantTypes = new int[] {CarOccupantZoneManager.OCCUPANT_TYPE_FRONT_PASSENGER,
-                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER};
-        for (int occupantType : occupantTypes) {
-            int zoneId = getZoneId(occupantType);
-            if (zoneId != CarOccupantZoneManager.OccupantZoneInfo.INVALID_ZONE_ID) {
-                return zoneId;
-            }
-        }
-        return CarOccupantZoneManager.OccupantZoneInfo.INVALID_ZONE_ID;
-    }
-
-    /**
-     * Creates a new passenger user when there is no passenger user.
-     */
-    private void setupPassengerUser() {
-        int currentUser = ActivityManager.getCurrentUser();
-        int profileCount = getNumberOfManagedProfiles(currentUser);
-        if (profileCount > 0) {
-            Slogf.w(TAG, "max profile of user %d is exceeded: current profile count is %d",
-                    currentUser, profileCount);
-            return;
-        }
-        // TODO(b/140311342): Use resource string for the default passenger name.
-        UserHandle passenger = createPassenger("Passenger", currentUser);
-        if (passenger == null) {
-            // Couldn't create user, most likely because there are too many.
-            Slogf.w(TAG, "cannot create a passenger user");
-            return;
-        }
-    }
-
-    private List<OccupantZoneInfo> getOccupantZones(@OccupantTypeEnum int occupantType) {
-        ZoneUserBindingHelper helper = null;
-        synchronized (mLock) {
-            if (mZoneUserBindingHelper == null) {
-                Slogf.w(TAG, "implementation is not delegated");
-                return new ArrayList<OccupantZoneInfo>();
-            }
-            helper = mZoneUserBindingHelper;
-        }
-        return helper.getOccupantZones(occupantType);
-    }
-
-    private boolean assignUserToOccupantZone(@UserIdInt int userId, int zoneId) {
-        ZoneUserBindingHelper helper = null;
-        synchronized (mLock) {
-            if (mZoneUserBindingHelper == null) {
-                Slogf.w(TAG, "implementation is not delegated");
-                return false;
-            }
-            helper = mZoneUserBindingHelper;
-        }
-        return helper.assignUserToOccupantZone(userId, zoneId);
-    }
-
-    private boolean unassignUserFromOccupantZone(@UserIdInt int userId) {
-        ZoneUserBindingHelper helper = null;
-        synchronized (mLock) {
-            if (mZoneUserBindingHelper == null) {
-                Slogf.w(TAG, "implementation is not delegated");
-                return false;
-            }
-            helper = mZoneUserBindingHelper;
-        }
-        return helper.unassignUserFromOccupantZone(userId);
-    }
-
-    private boolean isPassengerDisplayAvailable() {
-        ZoneUserBindingHelper helper = null;
-        synchronized (mLock) {
-            if (mZoneUserBindingHelper == null) {
-                Slogf.w(TAG, "implementation is not delegated");
-                return false;
-            }
-            helper = mZoneUserBindingHelper;
-        }
-        return helper.isPassengerDisplayAvailable();
-    }
-
-    /**
-     * Gets the zone id of the given occupant type.
-     *
-     * @param occupantType The type of an occupant.
-     * @return The zone id of the given occupant type.
-     *         the first found zone, if there are two or more zones.
-     *         {@link CarOccupantZoneManager.OccupantZoneInfo.INVALID_ZONE_ID}, if not found.
-     */
-    private int getZoneId(@CarOccupantZoneManager.OccupantTypeEnum int occupantType) {
-        List<CarOccupantZoneManager.OccupantZoneInfo> zoneInfos = getOccupantZones(occupantType);
-        return (zoneInfos.size() > 0)
-                ? zoneInfos.get(0).zoneId
-                : CarOccupantZoneManager.OccupantZoneInfo.INVALID_ZONE_ID;
-    }
-}
diff --git a/service/src/com/android/car/user/InitialUserSetter.java b/service/src/com/android/car/user/InitialUserSetter.java
index 76ef9f1268..ac7eb512e3 100644
--- a/service/src/com/android/car/user/InitialUserSetter.java
+++ b/service/src/com/android/car/user/InitialUserSetter.java
@@ -25,8 +25,8 @@ import android.annotation.IntDef;
 import android.annotation.NonNull;
 import android.annotation.Nullable;
 import android.annotation.UserIdInt;
-import android.app.ActivityManager;
 import android.car.builtin.app.ActivityManagerHelper;
+import android.car.builtin.os.TraceHelper;
 import android.car.builtin.os.UserManagerHelper;
 import android.car.builtin.provider.SettingsHelper;
 import android.car.builtin.util.EventLogHelper;
@@ -38,7 +38,6 @@ import android.hardware.automotive.vehicle.InitialUserInfoRequestType;
 import android.hardware.automotive.vehicle.UserInfo;
 import android.os.UserHandle;
 import android.os.UserManager;
-import android.provider.Settings;
 import android.util.Log;
 import android.util.Pair;
 
@@ -47,7 +46,9 @@ import com.android.car.R;
 import com.android.car.hal.UserHalHelper;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.common.UserHelperLite;
+import com.android.car.internal.dep.Trace;
 import com.android.car.internal.os.CarSystemProperties;
+import com.android.car.provider.Settings;
 import com.android.internal.annotations.VisibleForTesting;
 import com.android.internal.util.Preconditions;
 
@@ -58,6 +59,7 @@ import java.util.ArrayList;
 import java.util.Collections;
 import java.util.Iterator;
 import java.util.List;
+import java.util.Optional;
 import java.util.function.Consumer;
 
 /**
@@ -122,6 +124,21 @@ final class InitialUserSetter {
     public @interface InitialUserInfoType {
     }
 
+    @VisibleForTesting
+    interface ActivityManagerHelperIntf {
+        boolean startUserInForeground(@UserIdInt int userId);
+    }
+
+    @VisibleForTesting
+    interface CarSystemPropertiesIntf {
+        Optional<Integer> getBootUserOverrideId();
+    }
+
+    @VisibleForTesting
+    interface LockPatternHelperIntf {
+        boolean isSecure(@NonNull Context context, @UserIdInt int userId);
+    }
+
     private final Context mContext;
 
     // TODO(b/150413304): abstract AM / UM into interfaces, then provide local and remote
@@ -135,34 +152,63 @@ final class InitialUserSetter {
     private final Consumer<UserHandle> mListener;
 
     private final UserHandleHelper mUserHandleHelper;
+    private final Settings mSettings;
+    private final CurrentUserFetcher mCurrentUserFetcher;
+    private final boolean mIsHeadlessSystemUserMode;
+    private final ActivityManagerHelperIntf mActivityManagerHelper;
+    private final CarSystemPropertiesIntf mCarSystemProperties;
+    private final LockPatternHelperIntf mLockPatternHelper;
 
     private final boolean mIsVisibleBackgroundUsersOnDefaultDisplaySupported;
 
-    InitialUserSetter(@NonNull Context context, @NonNull CarUserService carUserService,
-            @NonNull Consumer<UserHandle> listener, @NonNull UserHandleHelper userHandleHelper) {
-        this(context, carUserService, listener, userHandleHelper,
-                context.getString(R.string.default_guest_name));
-    }
+    @VisibleForTesting
+    record Deps(
+            UserManager userManager,
+            String newUserName,
+            String newGuestName,
+            boolean isHeadlessSystemUserMode,
+            ActivityManagerHelperIntf activityManagerHelper,
+            CarSystemPropertiesIntf carSystemProperties,
+            LockPatternHelperIntf lockPatternHelper,
+            CurrentUserFetcher currentUserFetcher,
+            Settings settings) {}
 
     InitialUserSetter(@NonNull Context context, @NonNull CarUserService carUserService,
             @NonNull Consumer<UserHandle> listener, @NonNull UserHandleHelper userHandleHelper,
-            @Nullable String newGuestName) {
-        this(context, context.getSystemService(UserManager.class), carUserService, listener,
-                userHandleHelper, UserManagerHelper.getDefaultUserName(context), newGuestName);
+            CarUserService.Deps carUserServiceDeps) {
+        this(context, carUserService, listener, userHandleHelper,
+                new Deps(
+                        context.getSystemService(UserManager.class),
+                        UserManagerHelper.getDefaultUserName(context),
+                        context.getString(R.string.default_guest_name),
+                        UserManager.isHeadlessSystemUserMode(),
+                        (userId) -> ActivityManagerHelper.startUserInForeground(userId),
+                        () -> CarSystemProperties.getBootUserOverrideId(),
+                        (ctx, userId) -> LockPatternHelper.isSecure(ctx, userId),
+                        carUserServiceDeps.currentUserFetcher(),
+                        carUserServiceDeps.settings()
+                ));
     }
 
     @VisibleForTesting
-    InitialUserSetter(@NonNull Context context, @NonNull UserManager um,
-            @NonNull CarUserService carUserService, @NonNull Consumer<UserHandle> listener,
-            @NonNull UserHandleHelper userHandleHelper, @Nullable String newUserName,
-            @Nullable String newGuestName) {
+    InitialUserSetter(@NonNull Context context, @NonNull CarUserService carUserService,
+            @NonNull Consumer<UserHandle> listener, @NonNull UserHandleHelper userHandleHelper,
+            @NonNull Deps deps) {
         mContext = context;
-        mUm = um;
         mCarUserService = carUserService;
         mListener = listener;
         mUserHandleHelper = userHandleHelper;
-        mNewUserName = newUserName;
-        mNewGuestName = newGuestName;
+
+        mUm = deps.userManager();
+        mNewUserName = deps.newUserName();
+        mNewGuestName = deps.newGuestName();
+        mIsHeadlessSystemUserMode = deps.isHeadlessSystemUserMode();
+        mActivityManagerHelper = deps.activityManagerHelper();
+        mCarSystemProperties = deps.carSystemProperties();
+        mLockPatternHelper = deps.lockPatternHelper();
+        mCurrentUserFetcher = deps.currentUserFetcher();
+        mSettings = deps.settings();
+
         mIsVisibleBackgroundUsersOnDefaultDisplaySupported =
                 isVisibleBackgroundUsersOnDefaultDisplaySupported(mUm);
     }
@@ -349,6 +395,8 @@ final class InitialUserSetter {
     public void set(@NonNull InitialUserInfo info) {
         Preconditions.checkArgument(info != null, "info cannot be null");
 
+        Trace.traceBegin(TraceHelper.TRACE_TAG_CAR_SERVICE, "InitialuserSetter.set");
+
         EventLogHelper.writeCarInitialUserInfo(info.type, info.replaceGuest, info.switchUserId,
                 info.newUserName, info.newUserFlags,
                 info.supportsOverrideUserIdProperty, info.userLocales);
@@ -385,12 +433,14 @@ final class InitialUserSetter {
                 }
                 break;
             default:
+                Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
                 throw new IllegalArgumentException("invalid InitialUserInfo type: " + info.type);
         }
+        Trace.traceEnd(TraceHelper.TRACE_TAG_CAR_SERVICE);
     }
 
     private void replaceUser(InitialUserInfo info, boolean fallback) {
-        int currentUserId = ActivityManager.getCurrentUser();
+        int currentUserId = mCurrentUserFetcher.getCurrentUser();
         UserHandle currentUser = mUserHandleHelper.getExistingUserHandle(currentUserId);
 
         if (currentUser == null) {
@@ -494,7 +544,7 @@ final class InitialUserSetter {
 
         int actualUserId = actualUser.getIdentifier();
 
-        int currentUserId = ActivityManager.getCurrentUser();
+        int currentUserId = mCurrentUserFetcher.getCurrentUser();
 
         if (DBG) {
             Slogf.d(TAG, "switchUser: currentUserId = %d, actualUserId = %d",
@@ -527,7 +577,7 @@ final class InitialUserSetter {
             return false;
         }
 
-        if (LockPatternHelper.isSecure(mContext, user.getIdentifier())) {
+        if (mLockPatternHelper.isSecure(mContext, user.getIdentifier())) {
             if (DBG) {
                 Slogf.d(TAG, "replaceGuestIfNeeded(), skipped, since user "
                         + user.getIdentifier() + " has secure lock pattern");
@@ -662,7 +712,7 @@ final class InitialUserSetter {
                 Slogf.d(TAG, "setting locale for user " + user.getIdentifier() + " to "
                         + info.userLocales);
             }
-            Settings.System.putString(
+            mSettings.putStringSystem(
                     getContentResolverForUser(mContext, user.getIdentifier()),
                     SettingsHelper.SYSTEM_LOCALES, info.userLocales);
         }
@@ -674,7 +724,7 @@ final class InitialUserSetter {
     boolean startForegroundUser(InitialUserInfo info, @UserIdInt int userId) {
         EventLogHelper.writeCarInitialUserStartFgUser(userId);
 
-        if (UserHelperLite.isHeadlessSystemUser(userId)) {
+        if (UserHelperLite.isHeadlessSystemUser(userId, mIsHeadlessSystemUserMode)) {
             if (!mIsVisibleBackgroundUsersOnDefaultDisplaySupported) {
                 // System User is not associated with real person, can not be switched to.
                 // But in Multi User No Driver mode, we'll need to put system user to foreground as
@@ -689,7 +739,7 @@ final class InitialUserSetter {
         }
 
         if (info.requestType == InitialUserInfoRequestType.RESUME) {
-            return ActivityManagerHelper.startUserInForeground(userId);
+            return mActivityManagerHelper.startUserInForeground(userId);
         } else {
             Slogf.i(TAG, "Setting boot user to: %d", userId);
             mUm.setBootUser(UserHandle.of(userId));
@@ -721,7 +771,7 @@ final class InitialUserSetter {
     public void setLastActiveUser(@UserIdInt int userId) {
         EventLogHelper.writeCarInitialUserSetLastActive(userId);
 
-        if (UserHelperLite.isHeadlessSystemUser(userId)) {
+        if (UserHelperLite.isHeadlessSystemUser(userId, mIsHeadlessSystemUserMode)) {
             if (DBG) {
                 Slogf.d(TAG, "setLastActiveUser(): ignoring headless system user " + userId);
             }
@@ -744,7 +794,7 @@ final class InitialUserSetter {
             Slogf.d(TAG, "setting global property " + name + " to " + userId);
         }
 
-        Settings.Global.putInt(mContext.getContentResolver(), name, userId);
+        mSettings.putIntGlobal(mContext.getContentResolver(), name, userId);
     }
 
     /**
@@ -773,7 +823,7 @@ final class InitialUserSetter {
 
         // TODO(b/150416512): Check if it is still supported, if not remove it.
         if (usesOverrideUserIdProperty) {
-            int bootUserOverride = CarSystemProperties.getBootUserOverrideId()
+            int bootUserOverride = mCarSystemProperties.getBootUserOverrideId()
                     .orElse(BOOT_USER_NOT_FOUND);
 
             // If an override user is present and a real user, return it
@@ -818,7 +868,7 @@ final class InitialUserSetter {
      * @return List of {@code UserHandle} for users that associated with a real person.
      */
     private List<UserHandle> getAllUsers() {
-        if (UserManager.isHeadlessSystemUserMode()) {
+        if (mIsHeadlessSystemUserMode) {
             return getAllUsersExceptSystemUserAndSpecifiedUser(UserHandle.SYSTEM.getIdentifier());
         }
 
@@ -894,11 +944,11 @@ final class InitialUserSetter {
     private void resetUserIdGlobalProperty(@NonNull String name) {
         EventLogHelper.writeCarInitialUserResetGlobalProperty(name);
 
-        Settings.Global.putInt(mContext.getContentResolver(), name, UserManagerHelper.USER_NULL);
+        mSettings.putIntGlobal(mContext.getContentResolver(), name, UserManagerHelper.USER_NULL);
     }
 
     private int getUserIdGlobalProperty(@NonNull String name) {
-        int userId = Settings.Global.getInt(mContext.getContentResolver(), name,
+        int userId = mSettings.getIntGlobal(mContext.getContentResolver(), name,
                 UserManagerHelper.USER_NULL);
         if (DBG) {
             Slogf.d(TAG, "getting global property " + name + ": " + userId);
diff --git a/service/src/com/android/car/watchdog/CarWatchdogService.java b/service/src/com/android/car/watchdog/CarWatchdogService.java
index 5424f0a7fa..8387655fb1 100644
--- a/service/src/com/android/car/watchdog/CarWatchdogService.java
+++ b/service/src/com/android/car/watchdog/CarWatchdogService.java
@@ -135,6 +135,8 @@ public final class CarWatchdogService extends ICarWatchdogService.Stub implement
 
     private CarWatchdogDaemonHelper mCarWatchdogDaemonHelper;
 
+    private boolean mIsPowerShutdownHandled;
+
     /*
      * TODO(b/192481350): Listen for GarageMode change notification rather than depending on the
      *  system_server broadcast when the CarService internal API for listening GarageMode change is
@@ -172,17 +174,7 @@ public final class CarWatchdogService extends ICarWatchdogService.Stub implement
                     if ((intent.getFlags() & Intent.FLAG_RECEIVER_FOREGROUND) == 0) {
                         break;
                     }
-                    int powerCycle = PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER;
-                    try {
-                        mCarWatchdogDaemonHelper.notifySystemStateChange(StateType.POWER_CYCLE,
-                                powerCycle, /* arg2= */ 0);
-                        if (DEBUG) {
-                            Slogf.d(TAG, "Notified car watchdog daemon of power cycle(%d)",
-                                    powerCycle);
-                        }
-                    } catch (Exception e) {
-                        Slogf.w(TAG, e, "Notifying power cycle state change failed");
-                    }
+                    notifyPowerCycleChange(PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER);
                     break;
                 case ACTION_USER_REMOVED: {
                     UserHandle userHandle = intent.getParcelableExtra(Intent.EXTRA_USER);
@@ -218,7 +210,10 @@ public final class CarWatchdogService extends ICarWatchdogService.Stub implement
         public void onStateChanged(int state, long expirationTimeMs) {
             CarPowerManagementService powerService =
                     CarLocalServices.getService(CarPowerManagementService.class);
-            if (powerService == null) {
+            if (powerService == null
+                || state == CarPowerManager.STATE_POST_SHUTDOWN_ENTER
+                || state == CarPowerManager.STATE_POST_SUSPEND_ENTER
+                || state == CarPowerManager.STATE_POST_HIBERNATION_ENTER) {
                 return;
             }
             int powerState = powerService.getPowerState();
@@ -346,6 +341,9 @@ public final class CarWatchdogService extends ICarWatchdogService.Stub implement
         subscribeBroadcastReceiver();
         mCarWatchdogDaemonHelper.addOnConnectionChangeListener(mConnectionListener);
         mCarWatchdogDaemonHelper.connect();
+        synchronized (mLock) {
+            mIsPowerShutdownHandled = false;
+        }
         // To make sure the main handler is ready for responding to car watchdog daemon, registering
         // to the daemon is done through the main handler. Once the registration is completed, we
         // can assume that the main handler is not too busy handling other stuffs.
@@ -375,6 +373,7 @@ public final class CarWatchdogService extends ICarWatchdogService.Stub implement
         writer.increaseIndent();
         synchronized (mLock) {
             writer.println("Current garage mode: " + toGarageModeString(mCurrentGarageMode));
+            writer.println("Is power shutdown handled: " + mIsPowerShutdownHandled);
         }
         mWatchdogProcessHandler.dump(writer);
         mWatchdogPerfHandler.dump(writer);
@@ -557,6 +556,25 @@ public final class CarWatchdogService extends ICarWatchdogService.Stub implement
      */
     public boolean performResourceOveruseKill(String packageName, @UserIdInt int userId) {
         assertPermission(mContext, Car.PERMISSION_USE_CAR_WATCHDOG);
+
+        UserHandle userHandle = UserHandle.of(userId);
+        List<PackageKillableState> packageKillableStates =
+                getPackageKillableStatesAsUser(userHandle);
+
+        for (int i = 0; i < packageKillableStates.size(); i++) {
+            PackageKillableState state = packageKillableStates.get(i);
+            if (packageName.equals(state.getPackageName())) {
+                int killableState = state.getKillableState();
+                if (killableState != PackageKillableState.KILLABLE_STATE_YES) {
+                    String stateName = PackageKillableState.killableStateToString(killableState);
+                    Slogf.d(TAG, "Failed to kill package '%s' for user %d because the "
+                            + "package has state '%s'\n", packageName, userId, stateName);
+                    return false;
+                }
+                break;
+            }
+        }
+
         return mWatchdogPerfHandler.disablePackageForUser(packageName, userId);
     }
 
@@ -641,6 +659,17 @@ public final class CarWatchdogService extends ICarWatchdogService.Stub implement
 
     private void notifyPowerCycleChange(@PowerCycle int powerCycle) {
         try {
+            // There are two signals sent during power off, ACTION_SHUTDOWN (from the broadcast
+            // receiver) and SHUTDOWN_ENTER (from the ICarPowerStateListener). This checks
+            // if one signal has already been sent and avoids doing shutdown twice.
+            synchronized (mLock) {
+                if (powerCycle == PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER) {
+                    if (mIsPowerShutdownHandled) {
+                        return;
+                    }
+                    mIsPowerShutdownHandled = true;
+                }
+            }
             mCarWatchdogDaemonHelper.notifySystemStateChange(
                     StateType.POWER_CYCLE, powerCycle, MISSING_ARG_VALUE);
             if (DEBUG) {
diff --git a/service/src/com/android/car/watchdog/WatchdogPerfHandler.java b/service/src/com/android/car/watchdog/WatchdogPerfHandler.java
index a30f0b707c..1681f76c6f 100644
--- a/service/src/com/android/car/watchdog/WatchdogPerfHandler.java
+++ b/service/src/com/android/car/watchdog/WatchdogPerfHandler.java
@@ -128,6 +128,7 @@ import com.android.car.CarUxRestrictionsManagerService;
 import com.android.car.R;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
 import com.android.car.internal.NotificationHelperBase;
+import com.android.car.internal.dep.Trace;
 import com.android.car.internal.util.ConcurrentUtils;
 import com.android.car.internal.util.IndentingPrintWriter;
 import com.android.internal.annotations.GuardedBy;
@@ -349,11 +350,13 @@ public final class WatchdogPerfHandler {
             // Set atom pull callbacks only after the internal datastructures are updated. When the
             // pull happens, the service is already initialized and ready to populate the pulled
             // atoms.
+            Trace.beginSection("WatchdogPerfHandler-setting-atoms");
             StatsManager statsManager = mContext.getSystemService(StatsManager.class);
             statsManager.setPullAtomCallback(CAR_WATCHDOG_SYSTEM_IO_USAGE_SUMMARY,
                     PULL_ATOM_METADATA, ConcurrentUtils.DIRECT_EXECUTOR, this::onPullAtom);
             statsManager.setPullAtomCallback(CAR_WATCHDOG_UID_IO_USAGE_SUMMARY,
                     PULL_ATOM_METADATA, ConcurrentUtils.DIRECT_EXECUTOR, this::onPullAtom);
+            Trace.endSection();
         });
 
         CarUxRestrictionsManagerService carUxRestrictionsManagerService =
@@ -487,37 +490,43 @@ public final class WatchdogPerfHandler {
         }
     }
 
-
     /** Retries any pending requests on re-connecting to the daemon */
     public void onDaemonConnectionChange(boolean isConnected) {
+        Trace.beginSection("WatchdogPerfHandler-daemonConnectionChanged-" + isConnected);
         boolean hasPendingRequest;
         synchronized (mLock) {
             mIsConnectedToDaemon = isConnected;
             hasPendingRequest = mPendingSetResourceOveruseConfigurationsRequest != null;
-        }
-        if (isConnected) {
-            if (hasPendingRequest) {
-                /*
-                 * Retry pending set resource overuse configuration request before processing any
-                 * new set/get requests. Thus notify the waiting requests only after the retry
-                 * completes.
-                 */
-                retryPendingSetResourceOveruseConfigurations();
-            } else {
-                /* Start fetch/sync configs only when there are no pending set requests because the
-                 * above retry starts fetch/sync configs on success. If the retry fails, the daemon
-                 * has crashed and shouldn't start fetchAndSyncResourceOveruseConfigurations.
-                 */
-                mMainHandler.post(this::fetchAndSyncResourceOveruseConfigurations);
+            if (isConnected) {
+                if (hasPendingRequest) {
+                    /*
+                     * Retry pending set resource overuse configuration request before processing
+                     * any new set/get requests. Thus notify the waiting requests only after the
+                     * retry completes.
+                     *
+                     * Note: Binder call to CarWatchdog daemon being made while holding the lock.
+                     * It is necessary to avoid isConnectedToDaemon() method from early exiting
+                     * because of interrupts or spurious wakeups.
+                     */
+                    retryPendingSetResourceOveruseConfigurations();
+                } else {
+                    /*
+                     * Start fetch/sync configs only when there are no pending set requests because
+                     * the above retry starts fetch/sync configs on success. If the retry fails,
+                     * the daemon has crashed and shouldn't start
+                     * fetchAndSyncResourceOveruseConfigurations.
+                     */
+                    mMainHandler.post(this::fetchAndSyncResourceOveruseConfigurations);
+                }
             }
-        }
-        synchronized (mLock) {
             mLock.notifyAll();
         }
+        Trace.endSection();
     }
 
     /** Updates the current UX state based on the display state. */
     public void onDisplayStateChanged(boolean isEnabled) {
+        Trace.beginSection("WatchdogPerfHandler-displayStateChanged-" + isEnabled);
         synchronized (mLock) {
             if (isEnabled) {
                 mCurrentUxState = UX_STATE_NO_DISTRACTION;
@@ -527,10 +536,12 @@ public final class WatchdogPerfHandler {
                 performOveruseHandlingLocked();
             }
         }
+        Trace.endSection();
     }
 
     /** Handles garage mode change. */
     public void onGarageModeChange(@GarageMode int garageMode) {
+        Trace.beginSection("WatchdogPerfHandler-garageModeChanged-" + garageMode);
         synchronized (mLock) {
             mCurrentGarageMode = garageMode;
             if (mCurrentGarageMode == GarageMode.GARAGE_MODE_ON) {
@@ -538,6 +549,7 @@ public final class WatchdogPerfHandler {
                 performOveruseHandlingLocked();
             }
         }
+        Trace.endSection();
     }
 
     /** Returns resource overuse stats for the calling package. */
@@ -694,7 +706,10 @@ public final class WatchdogPerfHandler {
         }
         int userId = userHandle.getIdentifier();
         String genericPackageName = mPackageInfoHandler.getNameForUserPackage(packageName, userId);
+        Trace.beginSection("WatchdogPerfHandler-setKillable: " + packageName + ":" + userId + " : "
+                + isKillable);
         if (genericPackageName == null) {
+            Trace.endSection();
             throw new IllegalArgumentException("Package '" + packageName + "' not found");
         }
         String key = getUserPackageUniqueId(userId, genericPackageName);
@@ -716,6 +731,7 @@ public final class WatchdogPerfHandler {
             if (!usage.verifyAndSetKillableState(isKillable, mTimeSource.getCurrentDate())) {
                 Slogf.e(TAG, "User %d cannot set killable state for package '%s'",
                         userHandle.getIdentifier(), genericPackageName);
+                Trace.endSection();
                 throw new IllegalArgumentException("Package killable state is not updatable");
             }
             mUsageByUserPackage.put(key, usage);
@@ -728,9 +744,12 @@ public final class WatchdogPerfHandler {
         if (DEBUG) {
             Slogf.d(TAG, "Successfully set killable package state for user %d", userId);
         }
+        Trace.endSection();
     }
 
     private void setPackageKillableStateForAllUsers(String packageName, boolean isKillable) {
+        Trace.beginSection(
+                "WatchdogPerfHandler-setKillableForAllUsers: " + packageName + " : " + isKillable);
         int[] userIds = getAliveUserIds();
         String genericPackageName = null;
         List<PackageResourceUsage> updatedUsages = new ArrayList<>(userIds.length);
@@ -749,6 +768,7 @@ public final class WatchdogPerfHandler {
                 }
                 if (!usage.verifyAndSetKillableState(isKillable, mTimeSource.getCurrentDate())) {
                     Slogf.e(TAG, "Cannot set killable state for package '%s'", packageName);
+                    Trace.endSection();
                     throw new IllegalArgumentException(
                             "Package killable state is not updatable");
                 }
@@ -776,6 +796,7 @@ public final class WatchdogPerfHandler {
         if (DEBUG) {
             Slogf.d(TAG, "Successfully set killable package state for all users");
         }
+        Trace.endSection();
     }
 
     /** Returns the list of package killable states on resource overuse for the user. */
@@ -928,6 +949,7 @@ public final class WatchdogPerfHandler {
     }
 
     private void latestIoOveruseStatsInternal(List<PackageIoOveruseStats> packageIoOveruseStats) {
+        Trace.beginSection("WatchdogPerfHandler.latestIoOveruseStatsInternal");
         int[] uids = new int[packageIoOveruseStats.size()];
         for (int i = 0; i < packageIoOveruseStats.size(); ++i) {
             uids[i] = packageIoOveruseStats.get(i).uid;
@@ -990,11 +1012,13 @@ public final class WatchdogPerfHandler {
         if (DEBUG) {
             Slogf.d(TAG, "Processed latest I/O overuse stats");
         }
+        Trace.endSection();
     }
 
     /** Resets the resource overuse settings and stats for the given generic package names. */
     public void resetResourceOveruseStats(Set<String> genericPackageNames) {
         mServiceHandler.post(() -> {
+            Trace.beginSection("WatchdogPerfHandler.resetResourceOveruseStats");
             synchronized (mLock) {
                 mIsHeadsUpNotificationSent = false;
                 for (int i = 0; i < mUsageByUserPackage.size(); ++i) {
@@ -1022,6 +1046,7 @@ public final class WatchdogPerfHandler {
                     enablePackageForUser(usage.getUid(), usage.genericPackageName);
                 }
             }
+            Trace.endSection();
         });
     }
 
@@ -1031,17 +1056,20 @@ public final class WatchdogPerfHandler {
      */
     public void asyncFetchTodayIoUsageStats() {
         mServiceHandler.post(() -> {
+            Trace.beginSection("WatchdogPerfHandler.asyncFetchTodayIoUsageStats");
             List<UserPackageIoUsageStats> todayIoUsageStats = getTodayIoUsageStats();
             try {
                 mCarWatchdogDaemonHelper.onTodayIoUsageStatsFetched(todayIoUsageStats);
             } catch (RemoteException e) {
                 Slogf.w(TAG, e, "Failed to send today's I/O usage stats to daemon.");
             }
+            Trace.endSection();
         });
     }
 
     /** Returns today's I/O usage stats for all packages collected during the previous boot. */
     public List<UserPackageIoUsageStats> getTodayIoUsageStats() {
+        Trace.beginSection("WatchdogPerfHandler.getTodayIoUsageStats");
         List<UserPackageIoUsageStats> userPackageIoUsageStats = new ArrayList<>();
         List<WatchdogStorage.IoUsageStatsEntry> entries = mWatchdogStorage.getTodayIoUsageStats();
         for (int i = 0; i < entries.size(); ++i) {
@@ -1057,6 +1085,7 @@ public final class WatchdogPerfHandler {
             stats.ioUsageStats.totalOveruses = internalIoUsage.totalOveruses;
             userPackageIoUsageStats.add(stats);
         }
+        Trace.endSection();
         return userPackageIoUsageStats;
     }
 
@@ -1087,6 +1116,7 @@ public final class WatchdogPerfHandler {
                     packageName, userHandle);
             return;
         }
+        Trace.beginSection("WatchdogPerfHandler-userNotification-" + action);
         switch (action) {
             case CAR_WATCHDOG_ACTION_RESOURCE_OVERUSE_DISABLE_APP:
                 disablePackageForUser(packageName, userHandle.getIdentifier());
@@ -1110,11 +1140,13 @@ public final class WatchdogPerfHandler {
                 break;
             default:
                 Slogf.e(TAG, "Skipping invalid user notification intent action: %s", action);
+                Trace.endSection();
                 return;
         }
 
         if (notificationId == -1) {
             Slogf.e(TAG, "Didn't received user notification id in action %s", action);
+            Trace.endSection();
             return;
         }
 
@@ -1124,6 +1156,7 @@ public final class WatchdogPerfHandler {
                 || notificationId > maxNotificationId) {
             Slogf.e(TAG, "Notification id (%d) outside of reserved IDs (%d - %d) for car watchdog.",
                     notificationId, mResourceOveruseNotificationBaseId, maxNotificationId);
+            Trace.endSection();
             return;
         }
 
@@ -1143,6 +1176,7 @@ public final class WatchdogPerfHandler {
             Slogf.d(TAG, "Successfully canceled notification id %d for user %s and package %s",
                     notificationId, userHandle, packageName);
         }
+        Trace.endSection();
     }
 
     /** Handles when system broadcast package changed action */
@@ -1153,9 +1187,11 @@ public final class WatchdogPerfHandler {
             return;
         }
         String packageName = intent.getData().getSchemeSpecificPart();
+        Trace.beginSection("WatchdogPerfHandler-packageChanged: " + packageName);
         try {
             if (PackageManagerHelper.getApplicationEnabledSettingForUser(packageName, userId)
                     != COMPONENT_ENABLED_STATE_ENABLED) {
+                Trace.endSection();
                 return;
             }
         } catch (Exception e) {
@@ -1166,11 +1202,13 @@ public final class WatchdogPerfHandler {
             Slogf.e(TAG, e,
                     "Failed to verify enabled setting for user %d, package '%s'",
                     userId, packageName);
+            Trace.endSection();
             return;
         }
         synchronized (mLock) {
             ArraySet<String> disabledPackages = mDisabledUserPackagesByUserId.get(userId);
             if (disabledPackages == null || !disabledPackages.contains(packageName)) {
+                Trace.endSection();
                 return;
             }
             removeFromDisabledPackagesSettingsStringLocked(packageName, userId);
@@ -1182,13 +1220,16 @@ public final class WatchdogPerfHandler {
         if (DEBUG) {
             Slogf.d(TAG, "Successfully enabled package due to package changed action");
         }
+        Trace.endSection();
     }
 
     /** Disables a package for specific user until used. */
     public boolean disablePackageForUser(String packageName, @UserIdInt int userId) {
+        Trace.beginSection("WatchdogPerfHandler-disablePackage: " + packageName);
         synchronized (mLock) {
             ArraySet<String> disabledPackages = mDisabledUserPackagesByUserId.get(userId);
             if (disabledPackages != null && disabledPackages.contains(packageName)) {
+                Trace.endSection();
                 return true;
             }
         }
@@ -1202,6 +1243,7 @@ public final class WatchdogPerfHandler {
                     Slogf.w(TAG, "Unable to disable application for user %d, package '%s' as the "
                             + "current enabled state is %s", userId, packageName,
                             toEnabledStateString(currentEnabledState));
+                    Trace.endSection();
                     return false;
                 default:
                     // COMPONENT_ENABLED_STATE_DEFAULT or other non-disabled states.
@@ -1224,8 +1266,10 @@ public final class WatchdogPerfHandler {
         } catch (Exception e) {
             Slogf.e(TAG, e, "Failed to disable application for user %d, package '%s'", userId,
                     packageName);
+            Trace.endSection();
             return false;
         }
+        Trace.endSection();
         return true;
     }
 
@@ -1250,6 +1294,7 @@ public final class WatchdogPerfHandler {
             systemIoUsageSummaryReportDate = mLastSystemIoUsageSummaryReportedDate;
             uidIoUsageSummaryReportDate = mLastUidIoUsageSummaryReportedDate;
         }
+        Trace.beginSection("WatchdogPerfHandler.writeMetadataFile");
         File file = getWatchdogMetadataFile();
         AtomicFile atomicFile = new AtomicFile(file);
         FileOutputStream fos = null;
@@ -1278,20 +1323,25 @@ public final class WatchdogPerfHandler {
         } catch (IOException e) {
             Slogf.e(TAG, e, "Failed to write watchdog metadata file '%s'", file.getAbsoluteFile());
             atomicFile.failWrite(fos);
+        } finally {
+            Trace.endSection();
         }
     }
 
     /** Fetches and syncs the resource overuse configurations from watchdog daemon. */
     private void fetchAndSyncResourceOveruseConfigurations() {
+        Trace.beginSection("WatchdogPerfHandler.fetchAndSyncResourceOveruseConfigurations");
         List<android.automotive.watchdog.internal.ResourceOveruseConfiguration> internalConfigs;
         try {
             internalConfigs = mCarWatchdogDaemonHelper.getResourceOveruseConfigurations();
         } catch (RemoteException | RuntimeException e) {
             Slogf.w(TAG, e, "Failed to fetch resource overuse configurations");
+            Trace.endSection();
             return;
         }
         if (internalConfigs.isEmpty()) {
             Slogf.e(TAG, "Fetched resource overuse configurations are empty");
+            Trace.endSection();
             return;
         }
         mOveruseConfigurationCache.set(internalConfigs);
@@ -1300,9 +1350,11 @@ public final class WatchdogPerfHandler {
         if (DEBUG) {
             Slogf.d(TAG, "Fetched and synced resource overuse configs.");
         }
+        Trace.endSection();
     }
 
     private void readFromDatabase() {
+        Trace.beginSection("WatchdogPerfHandler.readFromDatabase");
         mWatchdogStorage.syncUsers(getAliveUserIds());
         List<WatchdogStorage.UserPackageSettingsEntry> settingsEntries =
                 mWatchdogStorage.getUserPackageSettings();
@@ -1364,6 +1416,7 @@ public final class WatchdogPerfHandler {
             mLatestStatsReportDate = curReportDate;
         }
         syncHistoricalNotForgivenOveruses();
+        Trace.endSection();
     }
 
     /** Fetches all historical not forgiven overuses and syncs them with package I/O usages. */
@@ -1395,6 +1448,7 @@ public final class WatchdogPerfHandler {
         if (!mWatchdogStorage.startWrite()) {
             return;
         }
+        Trace.beginSection("WatchdogPerfHandler.writeToDatabase");
         try {
             List<WatchdogStorage.UserPackageSettingsEntry> userPackageSettingsEntries =
                     new ArrayList<>();
@@ -1444,6 +1498,7 @@ public final class WatchdogPerfHandler {
             }
         } finally {
             mWatchdogStorage.endWrite();
+            Trace.endSection();
         }
     }
 
@@ -1455,6 +1510,7 @@ public final class WatchdogPerfHandler {
 
     private boolean writeStats(List<WatchdogStorage.IoUsageStatsEntry> ioUsageStatsEntries,
             SparseArray<List<String>> forgivePackagesByUserId) {
+        Trace.beginSection("WatchdogPerfHandler.writeStats");
         // Forgive historical overuses before writing the latest stats to disk to avoid forgiving
         // the latest stats when the write is triggered after date change.
         if (forgivePackagesByUserId.size() != 0) {
@@ -1464,6 +1520,7 @@ public final class WatchdogPerfHandler {
                     forgivePackagesByUserId.size());
         }
         if (ioUsageStatsEntries.isEmpty()) {
+            Trace.endSection();
             return true;
         }
         int result = mWatchdogStorage.saveIoUsageStats(ioUsageStatsEntries);
@@ -1474,6 +1531,7 @@ public final class WatchdogPerfHandler {
             Slogf.i(TAG, "Successfully saved %d/%d I/O overuse stats to database",
                     result, ioUsageStatsEntries.size());
         }
+        Trace.endSection();
         return result != WatchdogStorage.FAILED_TRANSACTION;
     }
 
@@ -1748,6 +1806,7 @@ public final class WatchdogPerfHandler {
     private int setResourceOveruseConfigurationsInternal(
             List<android.automotive.watchdog.internal.ResourceOveruseConfiguration> configs,
             boolean isPendingRequest) throws RemoteException {
+        Trace.beginSection("WatchdogPerfHandler.setResourceOveruseConfigurationsInternal");
         boolean doClearPendingRequest = isPendingRequest;
         try {
             mCarWatchdogDaemonHelper.updateResourceOveruseConfigurations(configs);
@@ -1761,6 +1820,7 @@ public final class WatchdogPerfHandler {
                 setPendingSetResourceOveruseConfigurationsRequestLocked(configs);
             }
             doClearPendingRequest = false;
+            Trace.endSection();
             return CarWatchdogManager.RETURN_CODE_SUCCESS;
         } finally {
             if (doClearPendingRequest) {
@@ -1772,6 +1832,7 @@ public final class WatchdogPerfHandler {
         if (DEBUG) {
             Slogf.d(TAG, "Set the resource overuse configuration successfully");
         }
+        Trace.endSection();
         return CarWatchdogManager.RETURN_CODE_SUCCESS;
     }
 
@@ -1784,17 +1845,16 @@ public final class WatchdogPerfHandler {
                     mLock.wait(MAX_WAIT_TIME_MILLS - sleptDurationMillis);
                 } catch (InterruptedException e) {
                     Thread.currentThread().interrupt();
-                    continue;
                 } finally {
                     sleptDurationMillis = SystemClock.uptimeMillis() - startTimeMillis;
                 }
-                break;
             }
             return mIsConnectedToDaemon;
         }
     }
 
     private int[] getAliveUserIds() {
+        Trace.beginSection("WatchdogPerfHandler.getAliveUserIds");
         UserManager userManager = mContext.getSystemService(UserManager.class);
         List<UserHandle> aliveUsers = userManager.getUserHandles(/* excludeDying= */ true);
         int userSize = aliveUsers.size();
@@ -1802,6 +1862,7 @@ public final class WatchdogPerfHandler {
         for (int i = 0; i < userSize; ++i) {
             userIds[i] = aliveUsers.get(i).getIdentifier();
         }
+        Trace.endSection();
         return userIds;
     }
 
@@ -1818,6 +1879,7 @@ public final class WatchdogPerfHandler {
         if (mActionableUserPackages.isEmpty() || mCurrentUxState != UX_STATE_NO_INTERACTION) {
             return;
         }
+        Trace.beginSection("WatchdogPerfHandler.performOveruseHandlingLocked");
         ArraySet<String> killedUserPackageKeys = new ArraySet<>();
         for (int i = 0; i < mActionableUserPackages.size(); ++i) {
             PackageResourceUsage usage =
@@ -1851,9 +1913,11 @@ public final class WatchdogPerfHandler {
         }
         pushIoOveruseKillMetrics(killedUserPackageKeys);
         mActionableUserPackages.clear();
+        Trace.endSection();
     }
 
     private void notifyUserOnOveruse() {
+        Trace.beginSection("WatchdogPerfHandler.notifyUserOnOveruse");
         SparseArray<String> headsUpNotificationPackagesByNotificationId = new SparseArray<>();
         SparseArray<String> notificationCenterPackagesByNotificationId = new SparseArray<>();
         int currentUserId = ActivityManager.getCurrentUser();
@@ -1917,6 +1981,7 @@ public final class WatchdogPerfHandler {
                     headsUpNotificationPackagesByNotificationId.size()
                             + notificationCenterPackagesByNotificationId.size());
         }
+        Trace.endSection();
     }
 
     private void enablePackageForUser(int uid, String genericPackageName) {
@@ -1927,6 +1992,8 @@ public final class WatchdogPerfHandler {
                 return;
             }
         }
+        Trace.beginSection(
+                "WatchdogPerfHandler-enablePackage: " + genericPackageName + " : " + userId);
         List<String> packages;
         if (isSharedPackage(genericPackageName)) {
             packages = mPackageInfoHandler.getPackagesForUid(uid, genericPackageName);
@@ -1960,6 +2027,7 @@ public final class WatchdogPerfHandler {
                         packageName);
             }
         }
+        Trace.endSection();
     }
 
     private void sendResourceOveruseNotificationsAsUser(@UserIdInt int userId,
diff --git a/service/src/com/android/car/watchdog/WatchdogProcessHandler.java b/service/src/com/android/car/watchdog/WatchdogProcessHandler.java
index 67a9812b4f..178f8431ed 100644
--- a/service/src/com/android/car/watchdog/WatchdogProcessHandler.java
+++ b/service/src/com/android/car/watchdog/WatchdogProcessHandler.java
@@ -19,6 +19,7 @@ package com.android.car.watchdog;
 import static android.car.watchdog.CarWatchdogManager.TIMEOUT_CRITICAL;
 import static android.car.watchdog.CarWatchdogManager.TIMEOUT_MODERATE;
 import static android.car.watchdog.CarWatchdogManager.TIMEOUT_NORMAL;
+import static android.car.watchdog.CarWatchdogManager.TimeoutLengthEnum;
 
 import static com.android.car.CarServiceUtils.getHandlerThread;
 import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DUMP_INFO;
@@ -43,6 +44,7 @@ import android.util.proto.ProtoOutputStream;
 
 import com.android.car.CarServiceHelperWrapper;
 import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
+import com.android.car.internal.dep.Trace;
 import com.android.car.internal.util.IndentingPrintWriter;
 import com.android.internal.annotations.GuardedBy;
 
@@ -190,7 +192,7 @@ public final class WatchdogProcessHandler {
     }
 
     /** Registers the client callback */
-    public void registerClient(ICarWatchdogServiceCallback client, int timeout) {
+    public void registerClient(ICarWatchdogServiceCallback client, @TimeoutLengthEnum int timeout) {
         synchronized (mLock) {
             ArrayList<ClientInfo> clients = mClientMap.get(timeout);
             if (clients == null) {
@@ -314,7 +316,7 @@ public final class WatchdogProcessHandler {
     }
 
     /** Returns the registered and alive client count. */
-    public int getClientCount(int timeout) {
+    public int getClientCount(@TimeoutLengthEnum int timeout) {
         synchronized (mLock) {
             ArrayList<ClientInfo> clients = mClientMap.get(timeout);
             return clients != null ? clients.size() : 0;
@@ -338,10 +340,12 @@ public final class WatchdogProcessHandler {
      */
     public void asyncFetchAidlVhalPid() {
         mServiceHandler.post(() -> {
+            Trace.beginSection("WatchdogProcessHandler.asyncFetchAidlVhalPid");
             int pid = CarServiceHelperWrapper.getInstance().fetchAidlVhalPid();
             if (pid < 0) {
                 Slogf.e(CarWatchdogService.TAG, "Failed to fetch AIDL VHAL pid from"
                         + " CarServiceHelperService");
+                Trace.endSection();
                 return;
             }
             try {
@@ -350,20 +354,23 @@ public final class WatchdogProcessHandler {
                 Slogf.e(CarWatchdogService.TAG,
                         "Failed to notify car watchdog daemon of the AIDL VHAL pid");
             }
+            Trace.endSection();
         });
     }
 
     /** Enables/disables the watchdog daemon client health check process. */
     void controlProcessHealthCheck(boolean enable) {
+        Trace.beginSection("WatchdogProcessHandler-healthCheckEnabled-" + enable);
         try {
             mCarWatchdogDaemonHelper.controlProcessHealthCheck(enable);
         } catch (RemoteException e) {
             Slogf.w(CarWatchdogService.TAG,
                     "Cannot enable/disable the car watchdog daemon health check process: %s", e);
         }
+        Trace.endSection();
     }
 
-    private void onClientDeath(ICarWatchdogServiceCallback client, int timeout) {
+    private void onClientDeath(ICarWatchdogServiceCallback client, @TimeoutLengthEnum int timeout) {
         synchronized (mLock) {
             removeClientLocked(client.asBinder(), timeout);
         }
@@ -373,16 +380,19 @@ public final class WatchdogProcessHandler {
         // For critical clients, the response status are checked just before reporting to car
         // watchdog daemon. For moderate and normal clients, the status are checked after allowed
         // delay per timeout.
+        Trace.beginSection("WatchdogProcessHandler.doHealthCheck");
         analyzeClientResponse(TIMEOUT_CRITICAL);
         reportHealthCheckResult(sessionId);
         sendPingToClients(TIMEOUT_CRITICAL);
         sendPingToClientsAndCheck(TIMEOUT_MODERATE);
         sendPingToClientsAndCheck(TIMEOUT_NORMAL);
+        Trace.endSection();
     }
 
-    private void analyzeClientResponse(int timeout) {
+    private void analyzeClientResponse(@TimeoutLengthEnum int timeout) {
         // Clients which are not responding are stored in mClientsNotResponding, and will be dumped
         // and killed at the next response of CarWatchdogService to car watchdog daemon.
+        Trace.beginSection("WatchdogProcessHandler.analyzeClientResponse");
         synchronized (mLock) {
             SparseArray<ClientInfo> pingedClients = mPingedClientMap.get(timeout);
             for (int i = 0; i < pingedClients.size(); i++) {
@@ -395,9 +405,11 @@ public final class WatchdogProcessHandler {
             }
             mClientCheckInProgress.setValueAt(timeout, false);
         }
+        Trace.endSection();
     }
 
-    private void sendPingToClients(int timeout) {
+    private void sendPingToClients(@TimeoutLengthEnum int timeout) {
+        Trace.beginSection("WatchdogProcessHandler.sendPingToClients");
         ArrayList<ClientInfo> clientsToCheck;
         synchronized (mLock) {
             SparseArray<ClientInfo> pingedClients = mPingedClientMap.get(timeout);
@@ -428,9 +440,10 @@ public final class WatchdogProcessHandler {
                 }
             }
         }
+        Trace.endSection();
     }
 
-    private void sendPingToClientsAndCheck(int timeout) {
+    private void sendPingToClientsAndCheck(@TimeoutLengthEnum int timeout) {
         synchronized (mLock) {
             if (mClientCheckInProgress.get(timeout)) {
                 return;
@@ -451,7 +464,7 @@ public final class WatchdogProcessHandler {
     }
 
     @GuardedBy("mLock")
-    private void removeClientLocked(IBinder clientBinder, int timeout) {
+    private void removeClientLocked(IBinder clientBinder, @TimeoutLengthEnum int timeout) {
         ArrayList<ClientInfo> clients = mClientMap.get(timeout);
         for (int i = 0; i < clients.size(); i++) {
             ClientInfo clientInfo = clients.get(i);
@@ -463,6 +476,7 @@ public final class WatchdogProcessHandler {
     }
 
     private void reportHealthCheckResult(int sessionId) {
+        Trace.beginSection("WatchdogProcessHandler.reportHealthCheckResult");
         List<ProcessIdentifier> clientsNotResponding;
         ArrayList<ClientInfo> clientsToNotify;
         synchronized (mLock) {
@@ -488,6 +502,7 @@ public final class WatchdogProcessHandler {
             Slogf.w(CarWatchdogService.TAG,
                     "Cannot respond to car watchdog daemon (sessionId=%d): %s", sessionId, e);
         }
+        Trace.endSection();
     }
 
     @NonNull
@@ -504,7 +519,7 @@ public final class WatchdogProcessHandler {
         return processIdentifiers;
     }
 
-    private String timeoutToString(int timeout) {
+    private String timeoutToString(@TimeoutLengthEnum int timeout) {
         switch (timeout) {
             case TIMEOUT_CRITICAL:
                 return "critical";
@@ -518,7 +533,7 @@ public final class WatchdogProcessHandler {
         }
     }
 
-    private long getTimeoutDurationMs(int timeout) {
+    private long getTimeoutDurationMs(@TimeoutLengthEnum int timeout) {
         if (mOverriddenClientHealthCheckWindowMs != MISSING_INT_PROPERTY_VALUE) {
             return mOverriddenClientHealthCheckWindowMs;
         }
@@ -540,12 +555,12 @@ public final class WatchdogProcessHandler {
         public final int pid;
         public final long startTimeMillis;
         @UserIdInt public final int userId;
-        public final int timeout;
+        @TimeoutLengthEnum public final int timeout;
         public volatile int sessionId;
         public String packageName;
 
         ClientInfo(ICarWatchdogServiceCallback client, int pid, @UserIdInt int userId,
-                int timeout) {
+                @TimeoutLengthEnum int timeout) {
             this.client = client;
             this.pid = pid;
             // CarService doesn't have sepolicy access to read per-pid proc files, so it cannot
diff --git a/service/src/com/android/car/watchdog/WatchdogStorage.java b/service/src/com/android/car/watchdog/WatchdogStorage.java
index 183d014e4b..fd51928330 100644
--- a/service/src/com/android/car/watchdog/WatchdogStorage.java
+++ b/service/src/com/android/car/watchdog/WatchdogStorage.java
@@ -40,6 +40,7 @@ import android.util.ArraySet;
 import android.util.SparseArray;
 
 import com.android.car.CarLog;
+import com.android.car.internal.dep.Trace;
 import com.android.car.internal.util.IntArray;
 import com.android.internal.annotations.GuardedBy;
 import com.android.internal.annotations.VisibleForTesting;
@@ -200,6 +201,7 @@ public final class WatchdogStorage {
 
     /** Saves the given user package settings entries and returns whether the change succeeded. */
     public boolean saveUserPackageSettings(List<UserPackageSettingsEntry> entries) {
+        Trace.beginSection("WatchdogStorage.saveUserPackageSettings");
         ArraySet<Integer> usersWithMissingIds = new ArraySet<>();
         boolean isWriteSuccessful = false;
         SQLiteDatabase db = getDatabase(/* isWritable= */ true);
@@ -217,6 +219,7 @@ public final class WatchdogStorage {
                 }
                 usersWithMissingIds.add(entry.userId);
                 if (!UserPackageSettingsTable.replaceEntry(db, entry)) {
+                    Trace.endSection();
                     return false;
                 }
             }
@@ -226,6 +229,7 @@ public final class WatchdogStorage {
             db.endTransaction();
         }
         populateUserPackages(db, usersWithMissingIds);
+        Trace.endSection();
         return isWriteSuccessful;
     }
 
@@ -424,6 +428,7 @@ public final class WatchdogStorage {
             Slogf.w(TAG, "No I/O usage stats provided to forgive historical overuses.");
             return;
         }
+        Trace.beginSection("WatchdogStorage.forgiveHistoricalOveruses");
         ZonedDateTime currentDate =
                 mTimeSource.now().atZone(ZONE_OFFSET).truncatedTo(STATS_TEMPORAL_UNIT);
         long includingStartEpochSeconds = currentDate.minusDays(numDaysAgo).toEpochSecond();
@@ -444,6 +449,7 @@ public final class WatchdogStorage {
         }
         IoUsageStatsTable.forgiveHistoricalOverusesForPackage(getDatabase(/* isWritable= */ true),
                 userPackageIds, includingStartEpochSeconds, excludingEndEpochSeconds);
+        Trace.endSection();
     }
 
     /**
@@ -452,6 +458,7 @@ public final class WatchdogStorage {
      * @param aliveUserIds Array of alive user ids.
      */
     public void syncUsers(int[] aliveUserIds) {
+        Trace.beginSection("WatchdogStorage.syncUsers");
         IntArray aliveUsers = IntArray.wrap(aliveUserIds);
         for (int i = mUserPackagesByKey.size() - 1; i >= 0; --i) {
             UserPackage userPackage = mUserPackagesByKey.valueAt(i);
@@ -462,35 +469,41 @@ public final class WatchdogStorage {
         }
         UserPackageSettingsTable.syncUserPackagesWithAliveUsers(getDatabase(/* isWritable= */ true),
                     aliveUsers);
+        Trace.endSection();
     }
 
     @VisibleForTesting
     int saveIoUsageStats(List<IoUsageStatsEntry> entries, boolean shouldCheckRetention) {
         ZonedDateTime currentDate = mTimeSource.getCurrentDate();
         List<ContentValues> rows = new ArrayList<>(entries.size());
-        for (int i = 0; i < entries.size(); ++i) {
-            IoUsageStatsEntry entry = entries.get(i);
-            UserPackage userPackage = mUserPackagesByKey.get(
-                    UserPackage.getKey(entry.userId, entry.packageName));
-            if (userPackage == null) {
-                Slogf.e(TAG, "Failed to find user package id for user id '%d' and package '%s",
-                        entry.userId, entry.packageName);
-                continue;
-            }
-            android.automotive.watchdog.IoOveruseStats ioOveruseStats =
-                    entry.ioUsage.getInternalIoOveruseStats();
-            ZonedDateTime statsDate = Instant.ofEpochSecond(ioOveruseStats.startTime)
-                    .atZone(ZONE_OFFSET).truncatedTo(STATS_TEMPORAL_UNIT);
-            if (shouldCheckRetention && STATS_TEMPORAL_UNIT.between(statsDate, currentDate)
-                    >= RETENTION_PERIOD.get(STATS_TEMPORAL_UNIT)) {
-                continue;
+        try {
+            Trace.beginSection("WatchdogStorage.saveIoUsageStats");
+            for (int i = 0; i < entries.size(); ++i) {
+                IoUsageStatsEntry entry = entries.get(i);
+                UserPackage userPackage = mUserPackagesByKey.get(
+                        UserPackage.getKey(entry.userId, entry.packageName));
+                if (userPackage == null) {
+                    Slogf.e(TAG, "Failed to find user package id for user id '%d' and package '%s",
+                            entry.userId, entry.packageName);
+                    continue;
+                }
+                android.automotive.watchdog.IoOveruseStats ioOveruseStats =
+                        entry.ioUsage.getInternalIoOveruseStats();
+                ZonedDateTime statsDate = Instant.ofEpochSecond(ioOveruseStats.startTime)
+                        .atZone(ZONE_OFFSET).truncatedTo(STATS_TEMPORAL_UNIT);
+                if (shouldCheckRetention && STATS_TEMPORAL_UNIT.between(statsDate, currentDate)
+                        >= RETENTION_PERIOD.get(STATS_TEMPORAL_UNIT)) {
+                    continue;
+                }
+                long statsDateEpochSeconds = statsDate.toEpochSecond();
+                rows.add(IoUsageStatsTable.getContentValues(
+                        userPackage.userPackageId, entry, statsDateEpochSeconds));
             }
-            long statsDateEpochSeconds = statsDate.toEpochSecond();
-            rows.add(IoUsageStatsTable.getContentValues(
-                    userPackage.userPackageId, entry, statsDateEpochSeconds));
-        }
-        return atomicReplaceEntries(getDatabase(/*isWritable=*/ true),
+            return atomicReplaceEntries(getDatabase(/*isWritable=*/ true),
                     IoUsageStatsTable.TABLE_NAME, rows);
+        } finally {
+            Trace.endSection();
+        }
     }
 
     @VisibleForTesting
@@ -796,11 +809,13 @@ public final class WatchdogStorage {
 
         public static void deleteUserPackage(SQLiteDatabase db, @UserIdInt int userId,
                 String packageName) {
+            Trace.beginSection("WatchdogStorage-deletePackage: " + packageName + " : " + userId);
             String whereClause = COLUMN_USER_ID + "= ? and " + COLUMN_PACKAGE_NAME + "= ?";
             String[] whereArgs = new String[]{String.valueOf(userId), packageName};
             int deletedRows = db.delete(TABLE_NAME, whereClause, whereArgs);
             Slogf.i(TAG, "Deleted %d user package settings db rows for user %d and package %s",
                     deletedRows, userId, packageName);
+            Trace.endSection();
         }
 
         public static void syncUserPackagesWithAliveUsers(SQLiteDatabase db, IntArray aliveUsers) {
diff --git a/tests/AdasLocationTestApp/AndroidManifest.xml b/tests/AdasLocationTestApp/AndroidManifest.xml
index 481f11ad0c..9089a3e978 100644
--- a/tests/AdasLocationTestApp/AndroidManifest.xml
+++ b/tests/AdasLocationTestApp/AndroidManifest.xml
@@ -36,5 +36,19 @@
                 <category android:name="android.intent.category.LAUNCHER"/>
             </intent-filter>
         </activity>
+
+        <!-- the activity is for provding a fake policy url for Geo GSR-ISA app. -->
+        <activity
+            android:name=".PrivacyPolicyActivity"
+            android:exported="true">
+            <intent-filter>
+                <action android:name="android.intent.action.VIEW" />
+                <category android:name="android.intent.category.DEFAULT" />
+                <category android:name="android.intent.category.BROWSABLE" />
+
+                <data android:scheme="gsr" />
+                <data android:host="privacy_policy" />
+            </intent-filter>
+        </activity>
     </application>
 </manifest>
\ No newline at end of file
diff --git a/tests/AdasLocationTestApp/OWNERS b/tests/AdasLocationTestApp/OWNERS
new file mode 100644
index 0000000000..cd87fc268c
--- /dev/null
+++ b/tests/AdasLocationTestApp/OWNERS
@@ -0,0 +1,2 @@
+gracemc@google.com
+aaqibismail@google.com
diff --git a/tests/AdasLocationTestApp/src/com/google/android/car/adaslocation/PrivacyPolicyActivity.java b/tests/AdasLocationTestApp/src/com/google/android/car/adaslocation/PrivacyPolicyActivity.java
new file mode 100644
index 0000000000..94c5321b9e
--- /dev/null
+++ b/tests/AdasLocationTestApp/src/com/google/android/car/adaslocation/PrivacyPolicyActivity.java
@@ -0,0 +1,55 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.google.android.car.adaslocation;
+
+import android.app.Activity;
+import android.content.Intent;
+import android.net.Uri;
+import android.os.Bundle;
+import android.provider.Settings;
+
+// Geo GSR-ISA app is pre-installed in AAOS internal builds for testing purpose. The app doesn't
+// provide a privacy policy but a deep link so that OEMs can provide the privacy policy. This simple
+// activity is to handle Geo GSR-ISA app's privacy policy uri (gsr://privacy_policy) and provide a
+// fake privacy policy url for testing purpose.
+public final class PrivacyPolicyActivity extends Activity {
+    private static final String URL =
+            "https://source.android.com/devices/automotive/location_bypass_policy";
+
+    // Indicates whether the user is navigating back from QR code page.
+    private boolean mIsNavigatingBack;
+
+    @Override
+    public void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+    }
+
+    @Override
+    public void onStart() {
+        super.onStart();
+
+        if (!mIsNavigatingBack) {
+            Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(URL));
+            this.startActivity(intent);
+            mIsNavigatingBack = true;
+        } else {
+            super.onDestroy();
+            Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
+            this.startActivity(intent);
+        }
+    }
+}
diff --git a/tests/BugReportApp/res/layout/bug_report_info_activity.xml b/tests/BugReportApp/res/layout/bug_report_info_activity.xml
index 4cc6fbff5a..ff6b83d3e2 100644
--- a/tests/BugReportApp/res/layout/bug_report_info_activity.xml
+++ b/tests/BugReportApp/res/layout/bug_report_info_activity.xml
@@ -15,6 +15,7 @@
      limitations under the License.
 -->
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/info_root"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:orientation="vertical"
diff --git a/tests/BugReportApp/res/values-gu/strings.xml b/tests/BugReportApp/res/values-gu/strings.xml
index b6899452e5..edf333fc8c 100644
--- a/tests/BugReportApp/res/values-gu/strings.xml
+++ b/tests/BugReportApp/res/values-gu/strings.xml
@@ -30,7 +30,7 @@
     <string name="bugreport_dialog_show_bugreports" msgid="6964385141627170297">"  "</string>
     <string name="bugreport_dialog_close" msgid="289925437277364266">" "</string>
     <string name="bugreport_dialog_title" msgid="3315160684205929910">"    "</string>
-    <string name="bugreport_dialog_add_audio_to_existing" msgid="4958460267276935700">"%s      "</string>
+    <string name="bugreport_dialog_add_audio_to_existing" msgid="4958460267276935700">"%s        "</string>
     <string name="bugreport_dialog_recording_finished" msgid="3982335902169398758">"   "</string>
     <string name="bugreport_dialog_in_progress_title" msgid="1663500052146177338">"    "</string>
     <string name="bugreport_dialog_in_progress_title_finished" msgid="1610236990020413471">"     "</string>
diff --git a/tests/BugReportApp/res/values-nb/strings.xml b/tests/BugReportApp/res/values-nb/strings.xml
index a66ef8be15..b1f92776a2 100644
--- a/tests/BugReportApp/res/values-nb/strings.xml
+++ b/tests/BugReportApp/res/values-nb/strings.xml
@@ -46,12 +46,12 @@
     <string name="toast_status_failed" msgid="6365384202315043395">"Feilrapporten mislyktes"</string>
     <string name="toast_status_screencap_failed" msgid="2187083897594745149">"Skjermdumpen mislyktes"</string>
     <string name="toast_status_dump_state_failed" msgid="3496460783060512078">"Dumptilstand mislyktes"</string>
-    <string name="toast_screenshot_finished" msgid="539313383958984557">"Lagrede skjermdumper"</string>
+    <string name="toast_screenshot_finished" msgid="539313383958984557">"Lagrede skjermbilder"</string>
     <string name="notification_bugreport_in_progress" msgid="8486454116357963238">"En feilrapport pgr"</string>
     <string name="notification_bugreport_finished_title" msgid="1188447311929693472">"En feilrapport er samlet inn"</string>
     <string name="notification_bugreport_channel_name" msgid="776902295433824255">"Statuskanal for feilrapport"</string>
-    <string name="notification_screenshot_message" msgid="4334354123333893911">"Ta skjermdumper"</string>
-    <string name="notification_screenshot_channel_name" msgid="147055389545365419">"Kanal for skjermdump av feilrapport"</string>
+    <string name="notification_screenshot_message" msgid="4334354123333893911">"Ta skjermbilder"</string>
+    <string name="notification_screenshot_channel_name" msgid="147055389545365419">"Kanal for skjermbilde av feilrapport"</string>
     <string name="choice_dialog_title" msgid="2105355715733829907">"Beskrivelse av feil knyttet til klarhet for  snakke"</string>
     <string name="choice_dialog_begin_now" msgid="7326462054665389346">"Begynn n"</string>
     <string name="choice_dialog_speak_later" msgid="1297471567273228307">"Snakk senere"</string>
diff --git a/tests/BugReportApp/src/com/android/car/bugreport/BugReportInfoActivity.java b/tests/BugReportApp/src/com/android/car/bugreport/BugReportInfoActivity.java
index 3a66ba2d5a..a2e77fad1b 100644
--- a/tests/BugReportApp/src/com/android/car/bugreport/BugReportInfoActivity.java
+++ b/tests/BugReportApp/src/com/android/car/bugreport/BugReportInfoActivity.java
@@ -34,6 +34,9 @@ import android.util.Log;
 import android.view.View;
 import android.widget.TextView;
 
+import androidx.core.graphics.Insets;
+import androidx.core.view.ViewCompat;
+import androidx.core.view.WindowInsetsCompat;
 import androidx.recyclerview.widget.DividerItemDecoration;
 import androidx.recyclerview.widget.LinearLayoutManager;
 import androidx.recyclerview.widget.RecyclerView;
@@ -84,6 +87,13 @@ public class BugReportInfoActivity extends Activity {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.bug_report_info_activity);
 
+        View infoRootView = findViewById(R.id.info_root);
+        ViewCompat.setOnApplyWindowInsetsListener(infoRootView, (view, windowInsets) -> {
+            final Insets insets = windowInsets.getInsets(WindowInsetsCompat.Type.systemBars());
+            view.setPadding(insets.left, insets.top, insets.right, insets.bottom);
+            return WindowInsetsCompat.CONSUMED;
+        });
+
         mNotificationManager = getSystemService(NotificationManager.class);
 
         mRecyclerView = findViewById(R.id.rv_bug_report_info);
diff --git a/tests/BugReportApp/tests/Android.bp b/tests/BugReportApp/tests/Android.bp
index f925f25e1c..719b61c6ba 100644
--- a/tests/BugReportApp/tests/Android.bp
+++ b/tests/BugReportApp/tests/Android.bp
@@ -32,9 +32,9 @@ android_test {
 
     libs: [
         "android.car",
-        "android.test.base",
-        "android.test.mock",
-        "android.test.runner",
+        "android.test.base.stubs.system",
+        "android.test.mock.stubs.system",
+        "android.test.runner.stubs.system",
     ],
 
     static_libs: [
diff --git a/tests/CarBuiltinLibUnitTest/Android.bp b/tests/CarBuiltinLibUnitTest/Android.bp
new file mode 100644
index 0000000000..603fd57057
--- /dev/null
+++ b/tests/CarBuiltinLibUnitTest/Android.bp
@@ -0,0 +1,57 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+package {
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+android_test {
+    name: "CarBuiltinLibUnitTest",
+    team: "trendy_team_aaos_framework",
+    srcs: [
+        "src/**/*",
+    ],
+    libs: [
+        "android.car.builtin.impl",
+        // The following three lines are needed for tests that build against framework-bluetooth's
+        // @hide APIs. Order matters for the first two: classes in framework-bluetooth are
+        // resolved before framework, meaning @hide APIs in framework-bluetooth are resolved
+        // before @SystemApi stubs in framework. If sdk_version="", then the third line would get
+        // automatically included; since it isn't, it needs to be manually added here.
+        // (Ref: "framework-bluetooth-tests-defaults" in packages/modules/Bluetooth/framework/Android.bp)
+        "framework-bluetooth.impl",
+        "framework",
+        "framework-res",
+    ],
+    static_libs: [
+        "androidx.test.core",
+        "androidx.test.runner",
+        "junit",
+        "mockito-target-inline",
+        "truth",
+    ],
+    // mockito-target-inline dependency
+    jni_libs: [
+        "libdexmakerjvmtiagent",
+    ],
+    sdk_version: "core_platform",
+    platform_apis: true,
+    // Signed with platform certificate to use shared user ID and access platform APIs.
+    certificate: "platform",
+    test_suites: [
+        "automotive-tests",
+        "device-tests",
+    ],
+    test_config: "AndroidTest.xml",
+}
diff --git a/tests/CarBuiltinLibUnitTest/AndroidManifest.xml b/tests/CarBuiltinLibUnitTest/AndroidManifest.xml
new file mode 100644
index 0000000000..77d09b9bd8
--- /dev/null
+++ b/tests/CarBuiltinLibUnitTest/AndroidManifest.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+        xmlns:androidprv="http://schemas.android.com/apk/prv/res/android"
+        android:sharedUserId="com.google.android.car.uid.kitchensink"
+        package="android.car.builtin.test">
+    <uses-permission android:name="android.permission.BLUETOOTH_ADVERTISE"/>
+    <application android:debuggable="true" android:testOnly="true">
+        <uses-library android:name="android.test.runner" />
+    </application>
+    <instrumentation android:name="androidx.test.runner.AndroidJUnitRunner"
+            android:targetPackage="android.car.builtin.test"
+            android:label="Unit Tests for android.car.builtin"/>
+</manifest>
diff --git a/tests/CarBuiltinLibUnitTest/AndroidTest.xml b/tests/CarBuiltinLibUnitTest/AndroidTest.xml
new file mode 100644
index 0000000000..8e83ae2dad
--- /dev/null
+++ b/tests/CarBuiltinLibUnitTest/AndroidTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Builtin Lib Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarBuiltinLibUnitTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="android.car.builtin.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarBuiltinLibUnitTest/TEST_MAPPING b/tests/CarBuiltinLibUnitTest/TEST_MAPPING
new file mode 100644
index 0000000000..52137bfc44
--- /dev/null
+++ b/tests/CarBuiltinLibUnitTest/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarBuiltinLibUnitTest"
+    }
+  ]
+}
diff --git a/tests/carservice_unit_test/src/android/car/builtin/bluetooth/le/AdvertisingSetCallbackHelperTest.java b/tests/CarBuiltinLibUnitTest/src/android/car/builtin/bluetooth/le/AdvertisingSetCallbackHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/builtin/bluetooth/le/AdvertisingSetCallbackHelperTest.java
rename to tests/CarBuiltinLibUnitTest/src/android/car/builtin/bluetooth/le/AdvertisingSetCallbackHelperTest.java
diff --git a/tests/carservice_unit_test/src/android/car/builtin/bluetooth/le/AdvertisingSetHelperTest.java b/tests/CarBuiltinLibUnitTest/src/android/car/builtin/bluetooth/le/AdvertisingSetHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/builtin/bluetooth/le/AdvertisingSetHelperTest.java
rename to tests/CarBuiltinLibUnitTest/src/android/car/builtin/bluetooth/le/AdvertisingSetHelperTest.java
diff --git a/tests/carservice_unit_test/src/android/car/builtin/input/InputManagerHelperTest.java b/tests/CarBuiltinLibUnitTest/src/android/car/builtin/input/InputManagerHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/builtin/input/InputManagerHelperTest.java
rename to tests/CarBuiltinLibUnitTest/src/android/car/builtin/input/InputManagerHelperTest.java
diff --git a/tests/carservice_unit_test/src/android/car/builtin/view/InputEventHelperTest.java b/tests/CarBuiltinLibUnitTest/src/android/car/builtin/view/InputEventHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/builtin/view/InputEventHelperTest.java
rename to tests/CarBuiltinLibUnitTest/src/android/car/builtin/view/InputEventHelperTest.java
diff --git a/tests/carservice_unit_test/src/android/car/builtin/view/KeyEventHelperTest.java b/tests/CarBuiltinLibUnitTest/src/android/car/builtin/view/KeyEventHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/builtin/view/KeyEventHelperTest.java
rename to tests/CarBuiltinLibUnitTest/src/android/car/builtin/view/KeyEventHelperTest.java
diff --git a/tests/CarEvsCameraPreviewApp/src/com/google/android/car/evs/CarEvsCameraPreviewActivity.java b/tests/CarEvsCameraPreviewApp/src/com/google/android/car/evs/CarEvsCameraPreviewActivity.java
index f9b93f4fc4..22090f82a5 100644
--- a/tests/CarEvsCameraPreviewApp/src/com/google/android/car/evs/CarEvsCameraPreviewActivity.java
+++ b/tests/CarEvsCameraPreviewApp/src/com/google/android/car/evs/CarEvsCameraPreviewActivity.java
@@ -486,6 +486,14 @@ public class CarEvsCameraPreviewActivity extends Activity
         }
     }
 
+    @Override
+    public void onTopResumedActivityChanged(boolean topResumed) {
+        // Log here for easier debugging in split screen mode. We will receive this instead of
+        // onResume because in split screen both activities are always in the resumed state.
+        Log.i(TAG, "onTopResumedActivityChanged(" + topResumed + ")");
+        super.onTopResumedActivityChanged(topResumed);
+    }
+
     @GuardedBy("mLock")
     private void doneWithBufferLocked(CarEvsBufferDescriptor buffer) {
         try {
diff --git a/tests/CarFrameworkPackageStubsTest/Android.bp b/tests/CarFrameworkPackageStubsTest/Android.bp
index 141a68621d..e5adca71be 100644
--- a/tests/CarFrameworkPackageStubsTest/Android.bp
+++ b/tests/CarFrameworkPackageStubsTest/Android.bp
@@ -36,8 +36,8 @@ android_test {
     ],
 
     libs: [
-        "android.test.base",
-        "android.test.runner",
+        "android.test.base.stubs.system",
+        "android.test.runner.stubs.system",
     ],
 
     test_suites: ["general-tests"],
diff --git a/tests/CarLibHostUnitTest/lint-baseline.xml b/tests/CarLibHostUnitTest/lint-baseline.xml
new file mode 100644
index 0000000000..3143d69873
--- /dev/null
+++ b/tests/CarLibHostUnitTest/lint-baseline.xml
@@ -0,0 +1,664 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<issues format="6" by="lint 8.4.0-alpha08" type="baseline" client="" dependencies="true" name="" variant="all" version="8.4.0-alpha08">
+
+    <issue
+        id="FlaggedApi"
+        message="Class `ClusterHomeManager` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="        CAR_SERVICE_NAMES.put(ClusterHomeManager.class, CLUSTER_HOME_SERVICE);"
+        errorLine2="                              ~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="1724"
+            column="31"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `ClusterHomeManager()` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `createCarManagerLocked` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="                manager = new ClusterHomeManager(this, binder);"
+        errorLine2="                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="2633"
+            column="27"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onAudioZoneConfigurationsChanged()` is a flagged API and should be inside an `if (Flags.carAudioDynamicDevices())` check (or annotate the surrounding method `onAudioZoneConfigurationsChanged` with `@FlaggedApi(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES) to transfer requirement to caller`)"
+        errorLine1="                mExecutor.execute(() -> mCallback.onAudioZoneConfigurationsChanged(configs,"
+        errorLine2="                                        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/media/CarAudioManager.java"
+            line="2249"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `CarEvsBufferDescriptor()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `CarEvsBufferDescriptor` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="        this(id, Flags.carEvsStreamManagement() ?"
+        errorLine2="        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsBufferDescriptor.java"
+            line="79"
+            column="9"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1228"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1259"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1290"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of(subscription), /* callbackExecutor= */ null,"
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1348"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getPropertyId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.propertyId = clientOption.getPropertyId();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1484"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getAreaIds()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.areaIds = clientOption.getAreaIds();"
+        errorLine2="                                     ~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1485"
+            column="38"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.updateRateHz = clientOption.getUpdateRateHz();"
+        errorLine2="                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1486"
+            column="43"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateEnabled()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="            internalOption.enableVariableUpdateRate = clientOption.isVariableUpdateRateEnabled();"
+        errorLine2="                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1487"
+            column="55"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getResolution()` is a flagged API and should be inside an `if (Flags.subscriptionWithResolution())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_SUBSCRIPTION_WITH_RESOLUTION) to transfer requirement to caller`)"
+        errorLine1="            internalOption.resolution = clientOption.getResolution();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1488"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `InVehicleTaskScheduler()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="    private final InVehicleTaskScheduler mInVehicleTaskScheduler = new InVehicleTaskScheduler();"
+        errorLine2="                                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="102"
+            column="68"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onServerlessClientRegistered()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `onServerlessClientRegistered` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="                executor.execute(() -> callback.onServerlessClientRegistered());"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="224"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateSupported()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `sanitizeEnableVariableUpdateRate` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="                if (carPropertyConfig.getAreaIdConfig(areaId)"
+        errorLine2="                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java"
+            line="159"
+            column="21"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Class `ClusterHomeManager` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="        CAR_SERVICE_NAMES.put(ClusterHomeManager.class, CLUSTER_HOME_SERVICE);"
+        errorLine2="                              ~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="1724"
+            column="31"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `ClusterHomeManager()` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `createCarManagerLocked` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="                manager = new ClusterHomeManager(this, binder);"
+        errorLine2="                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="2633"
+            column="27"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onAudioZoneConfigurationsChanged()` is a flagged API and should be inside an `if (Flags.carAudioDynamicDevices())` check (or annotate the surrounding method `onAudioZoneConfigurationsChanged` with `@FlaggedApi(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES) to transfer requirement to caller`)"
+        errorLine1="                mExecutor.execute(() -> mCallback.onAudioZoneConfigurationsChanged(configs,"
+        errorLine2="                                        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/media/CarAudioManager.java"
+            line="2249"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `CarEvsBufferDescriptor()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `CarEvsBufferDescriptor` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="        this(id, Flags.carEvsStreamManagement() ?"
+        errorLine2="        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsBufferDescriptor.java"
+            line="79"
+            column="9"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1228"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1229"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1259"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1260"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1290"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1291"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1346"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of(subscription), /* callbackExecutor= */ null,"
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1348"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getPropertyId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.propertyId = clientOption.getPropertyId();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1484"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getAreaIds()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.areaIds = clientOption.getAreaIds();"
+        errorLine2="                                     ~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1485"
+            column="38"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.updateRateHz = clientOption.getUpdateRateHz();"
+        errorLine2="                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1486"
+            column="43"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateEnabled()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="            internalOption.enableVariableUpdateRate = clientOption.isVariableUpdateRateEnabled();"
+        errorLine2="                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1487"
+            column="55"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getResolution()` is a flagged API and should be inside an `if (Flags.subscriptionWithResolution())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_SUBSCRIPTION_WITH_RESOLUTION) to transfer requirement to caller`)"
+        errorLine1="            internalOption.resolution = clientOption.getResolution();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1488"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `InVehicleTaskScheduler()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="    private final InVehicleTaskScheduler mInVehicleTaskScheduler = new InVehicleTaskScheduler();"
+        errorLine2="                                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="102"
+            column="68"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onServerlessClientRegistered()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `onServerlessClientRegistered` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="                executor.execute(() -> callback.onServerlessClientRegistered());"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="224"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateSupported()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `sanitizeEnableVariableUpdateRate` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="                if (carPropertyConfig.getAreaIdConfig(areaId)"
+        errorLine2="                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java"
+            line="159"
+            column="21"/>
+    </issue>
+
+</issues>
diff --git a/tests/CarLibUnitTest/Android.bp b/tests/CarLibUnitTest/Android.bp
index e12c73bff0..82d95f7387 100644
--- a/tests/CarLibUnitTest/Android.bp
+++ b/tests/CarLibUnitTest/Android.bp
@@ -31,6 +31,9 @@ java_library {
         "fake.com.android.car.internal.dep",
     ],
     sdk_version: "module_current",
+    lint: {
+        baseline_filename: "lint-baseline.xml",
+    },
 }
 
 java_defaults {
@@ -39,38 +42,29 @@ java_defaults {
         "android.car-no-dep",
         "android.car.test.utils",
         "androidx.annotation_annotation",
+        "androidx.test.core",
+        "androidx.test.ext.junit",
         "androidx.test.rules",
         "flag-junit",
         "platform-test-annotations",
         "truth",
         "vehicle-hal-support-lib",
     ],
-    srcs: [
-        "src/**/*.java",
-    ],
     libs: [
-        "android.test.base",
+        "android.test.base.stubs.system",
         "framework-annotations-lib",
     ],
 }
 
-android_ravenwood_test {
-    name: "CarLibHostUnitTest",
-    static_libs: [
-        "android.car.builtin.testonly",
-    ],
-    defaults: [
-        "CarLibUnitTestDefault",
-    ],
-    auto_gen_config: true,
-}
-
-android_test {
-    name: "CarLibDeviceUnitTest",
+java_defaults {
+    name: "CarLibDeviceUnitTestDefault",
     static_libs: [
         "mockito-target-extended",
         "ravenwood-junit",
     ],
+    libs: [
+        "android.car.builtin.stubs.module_lib",
+    ],
     defaults: [
         "CarLibUnitTestDefault",
     ],
@@ -86,3 +80,229 @@ android_test {
     ],
     platform_apis: true,
 }
+
+android_ravenwood_test {
+    name: "CarLibHostUnitTest",
+    static_libs: [
+        "android.car.builtin.testonly",
+    ],
+    defaults: [
+        "CarLibUnitTestDefault",
+    ],
+    auto_gen_config: true,
+    srcs: [
+        "src/**/*.java",
+        "src/**/*.aidl",
+    ],
+    aidl: {
+        include_dirs: [
+            "packages/services/Car/car-lib/src",
+        ],
+    },
+    exclude_srcs: [
+        // TODO(b/354795535): Enable CarLibAdminUnitTest on host.
+        "src/android/car/admin/**/*.java",
+        // TODO(b/354785409): Enable CarLibAppUnitTest on host.
+        "src/android/car/app/**/*.java",
+        // TODO(b/354796364): Enable cluster renderer test on host.
+        "src/android/car/cluster/renderer/*.java",
+        // The following cannot be enabled because AudioAttributes is
+        // not supported on host.
+        "src/android/car/media/CarAudioZoneConfigInfoUnitTest.java",
+        "src/android/car/media/CarVolumeGroupEventUnitTest.java",
+        "src/android/car/media/CarVolumeGroupInfoUnitTest.java",
+        "src/android/car/oem/AudioFocusEntryUnitTest.java",
+        "src/android/car/oem/OemCarAudio*.java",
+        // The following cannot be enabled because FadeManagerConfiguration
+        // is not supported on host.
+        "src/android/car/oem/CarAudioFadeConfigurationUnitTest.java",
+    ],
+}
+
+android_test {
+    name: "CarLibAdminUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/admin/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibAppUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/app/*.java",
+    ],
+    manifest: "AndroidManifest_AppUnitTest.xml",
+}
+
+android_test {
+    name: "CarLibCarUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/CarUnitTest.java",
+    ],
+}
+
+android_test {
+    name: "CarLibClusterUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/cluster/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibPmUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/content/pm/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibEvsUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/evs/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibPropertyUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/hardware/property/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibMediaUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/media/*.java",
+        "src/com/android/car/audio/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibNavigationUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/navigation/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibOccupantConnectionUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/occupantconnection/*",
+    ],
+    aidl: {
+        include_dirs: [
+            "packages/services/Car/car-lib/src",
+        ],
+    },
+    manifest: "AndroidManifest_OccupantConnectionUnitTest.xml",
+}
+
+android_test {
+    name: "CarLibOemUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/oem/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibOsUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/os/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibRemoteAccessUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/remoteaccess/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibUserUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/user/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibUtilConcurrentUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/util/concurrent/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibVmsUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/vms/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibWifiUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/android/car/wifi/*.java",
+    ],
+}
+
+android_test {
+    name: "CarLibInternalUnitTest",
+    defaults: [
+        "CarLibDeviceUnitTestDefault",
+    ],
+    srcs: [
+        "src/com/android/car/internal/**/*.java",
+    ],
+}
diff --git a/tests/CarLibUnitTest/AndroidManifest_AppUnitTest.xml b/tests/CarLibUnitTest/AndroidManifest_AppUnitTest.xml
new file mode 100644
index 0000000000..556a20bf9a
--- /dev/null
+++ b/tests/CarLibUnitTest/AndroidManifest_AppUnitTest.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+        xmlns:androidprv="http://schemas.android.com/apk/prv/res/android"
+        package="com.android.car.car_lib_unit_test">
+    <application android:debuggable="true">
+        <uses-library android:name="android.test.runner" />
+        <activity android:name="android.car.app.CarTaskViewControllerHostLifecycleFactoryTest$TestActivity"/>
+    </application>
+    <instrumentation android:name="androidx.test.runner.AndroidJUnitRunner"
+            android:targetPackage="com.android.car.car_lib_unit_test"
+            android:label="Unit Tests for Car Lib APIs"/>
+</manifest>
diff --git a/tests/CarLibUnitTest/AndroidManifest_OccupantConnectionUnitTest.xml b/tests/CarLibUnitTest/AndroidManifest_OccupantConnectionUnitTest.xml
new file mode 100644
index 0000000000..869bbc590b
--- /dev/null
+++ b/tests/CarLibUnitTest/AndroidManifest_OccupantConnectionUnitTest.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+        xmlns:androidprv="http://schemas.android.com/apk/prv/res/android"
+        package="com.android.car.car_lib_unit_test">
+    <application android:debuggable="true">
+          <uses-library android:name="android.test.runner" />
+          <service android:name="android.car.occupantconnection.PayloadTestBinderService"
+                 android:exported="true"/>
+    </application>
+    <instrumentation android:name="androidx.test.runner.AndroidJUnitRunner"
+            android:targetPackage="com.android.car.car_lib_unit_test"
+            android:label="Unit Tests for Car Lib APIs"/>
+</manifest>
diff --git a/tests/CarLibUnitTest/fake_dep/src/com/android/car/internal/dep/Trace.java b/tests/CarLibUnitTest/fake_dep/src/com/android/car/internal/dep/Trace.java
index 0493d37b2a..e9a4cc0c8f 100644
--- a/tests/CarLibUnitTest/fake_dep/src/com/android/car/internal/dep/Trace.java
+++ b/tests/CarLibUnitTest/fake_dep/src/com/android/car/internal/dep/Trace.java
@@ -44,4 +44,40 @@ public final class Trace {
     public static void endSection() {
         // Do nothing.
     }
+
+    /**
+     * Begins async trace.
+     *
+     * Do nothing in the fake implementation.
+     */
+    public static void asyncTraceBegin(long traceTag, String methodName, int cookie) {
+        // Do nothing.
+    }
+
+    /**
+     * Ends async trace.
+     *
+     * Do nothing in the fake implementation.
+     */
+    public static void asyncTraceEnd(long traceTag, String methodName, int cookie) {
+        // Do nothing.
+    }
+
+    /**
+     * Begins trace.
+     *
+     * Do nothing in the fake implementation.
+     */
+    public static void traceBegin(long traceTag, String methodName) {
+        // Do nothing.
+    }
+
+    /**
+     * Ends trace.
+     *
+     * Do nothing in the fake implementation.
+     */
+    public static void traceEnd(long traceTag) {
+        // Do nothing.
+    }
 }
diff --git a/tests/CarLibUnitTest/lint-baseline.xml b/tests/CarLibUnitTest/lint-baseline.xml
new file mode 100644
index 0000000000..a88195d97a
--- /dev/null
+++ b/tests/CarLibUnitTest/lint-baseline.xml
@@ -0,0 +1,367 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<issues format="6" by="lint 8.4.0-alpha08" type="baseline" client="" dependencies="true" name="" variant="all" version="8.4.0-alpha08">
+
+    <issue
+        id="FlaggedApi"
+        message="Class `ClusterHomeManager` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="        CAR_SERVICE_NAMES.put(ClusterHomeManager.class, CLUSTER_HOME_SERVICE);"
+        errorLine2="                              ~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="1741"
+            column="31"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `ClusterHomeManager()` is a flagged API and should be inside an `if (Flags.clusterHealthMonitoring())` check (or annotate the surrounding method `createCarManagerLocked` with `@FlaggedApi(Flags.FLAG_CLUSTER_HEALTH_MONITORING) to transfer requirement to caller`)"
+        errorLine1="                manager = new ClusterHomeManager(this, binder);"
+        errorLine2="                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/Car.java"
+            line="2713"
+            column="27"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onAudioZoneConfigurationsChanged()` is a flagged API and should be inside an `if (Flags.carAudioDynamicDevices())` check (or annotate the surrounding method `onAudioZoneConfigurationsChanged` with `@FlaggedApi(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES) to transfer requirement to caller`)"
+        errorLine1="                mExecutor.execute(() -> mCallback.onAudioZoneConfigurationsChanged(configs,"
+        errorLine2="                                        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/media/CarAudioManager.java"
+            line="2252"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `CarEvsBufferDescriptor()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `CarEvsBufferDescriptor` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="        this(id, Flags.carEvsStreamManagement() ?"
+        errorLine2="        ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsBufferDescriptor.java"
+            line="79"
+            column="9"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onStreamEvent()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `handleStreamEventLocked` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="            executor.execute(() -> cb.onStreamEvent(origin, event));"
+        errorLine2="                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="595"
+            column="36"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getType()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `handleNewFrame` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="                buffer.getType() : CarEvsUtils.getTag(buffer.getId());"
+        errorLine2="                ~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="610"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getType()` is a flagged API and should be inside an `if (Flags.carEvsStreamManagement())` check (or annotate the surrounding method `returnFrameBuffer` with `@FlaggedApi(Flags.FLAG_CAR_EVS_STREAM_MANAGEMENT) to transfer requirement to caller`)"
+        errorLine1="                buffer.getType() : CarEvsUtils.getTag(buffer.getId());"
+        errorLine2="                ~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/evs/CarEvsManager.java"
+            line="719"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1243"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(DEFAULT_UPDATE_RATE_HZ)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1244"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1274"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).setUpdateRateHz(updateRateHz).build()),"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1275"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of("
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1305"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="                new Subscription.Builder(propertyId).addAreaId(areaId).setUpdateRateHz(1f)"
+        errorLine2="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1306"
+            column="17"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `Builder()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `addAreaId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `build()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `setUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        Subscription subscription = new Subscription.Builder(propertyId).addAreaId(areaId)"
+        errorLine2="                                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1361"
+            column="37"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `subscribePropertyEvents()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `subscribePropertyEvents` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="        return subscribePropertyEvents(List.of(subscription), /* callbackExecutor= */ null,"
+        errorLine2="               ^">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1363"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getPropertyId()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.propertyId = clientOption.getPropertyId();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1499"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getAreaIds()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.areaIds = clientOption.getAreaIds();"
+        errorLine2="                                     ~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1500"
+            column="38"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getUpdateRateHz()` is a flagged API and should be inside an `if (Flags.batchedSubscriptions())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_BATCHED_SUBSCRIPTIONS) to transfer requirement to caller`)"
+        errorLine1="            internalOption.updateRateHz = clientOption.getUpdateRateHz();"
+        errorLine2="                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1501"
+            column="43"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateEnabled()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="            internalOption.enableVariableUpdateRate = clientOption.isVariableUpdateRateEnabled();"
+        errorLine2="                                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1502"
+            column="55"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getResolution()` is a flagged API and should be inside an `if (Flags.subscriptionWithResolution())` check (or annotate the surrounding method `convertToCarSubscribeOptions` with `@FlaggedApi(Flags.FLAG_SUBSCRIPTION_WITH_RESOLUTION) to transfer requirement to caller`)"
+        errorLine1="            internalOption.resolution = clientOption.getResolution();"
+        errorLine2="                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/hardware/property/CarPropertyManager.java"
+            line="1503"
+            column="41"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `InVehicleTaskScheduler()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `?` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="    private final InVehicleTaskScheduler mInVehicleTaskScheduler = new InVehicleTaskScheduler();"
+        errorLine2="                                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="102"
+            column="68"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onServerlessClientRegistered()` is a flagged API and should be inside an `if (Flags.serverlessRemoteAccess())` check (or annotate the surrounding method `onServerlessClientRegistered` with `@FlaggedApi(Flags.FLAG_SERVERLESS_REMOTE_ACCESS) to transfer requirement to caller`)"
+        errorLine1="                executor.execute(() -> callback.onServerlessClientRegistered());"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/services/Car/car-lib/src/android/car/remoteaccess/CarRemoteAccessManager.java"
+            line="224"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `isVariableUpdateRateSupported()` is a flagged API and should be inside an `if (Flags.variableUpdateRate())` check (or annotate the surrounding method `sanitizeEnableVariableUpdateRate` with `@FlaggedApi(Flags.FLAG_VARIABLE_UPDATE_RATE) to transfer requirement to caller`)"
+        errorLine1="                if (carPropertyConfig.getAreaIdConfig(areaId)"
+        errorLine2="                    ^">
+        <location
+            file="packages/services/Car/car-lib/src/com/android/car/internal/property/InputSanitizationUtils.java"
+            line="160"
+            column="21"/>
+    </issue>
+
+</issues>
diff --git a/tests/CarLibUnitTest/src/android/car/CarUnitTest.java b/tests/CarLibUnitTest/src/android/car/CarUnitTest.java
index b81add2475..3a9e0ca6a9 100644
--- a/tests/CarLibUnitTest/src/android/car/CarUnitTest.java
+++ b/tests/CarLibUnitTest/src/android/car/CarUnitTest.java
@@ -19,24 +19,31 @@ package android.car;
 import static android.car.Car.CAR_SERVICE_BINDER_SERVICE_NAME;
 import static android.car.feature.Flags.FLAG_DISPLAY_COMPATIBILITY;
 import static android.car.feature.Flags.FLAG_PERSIST_AP_SETTINGS;
+import static android.car.feature.Flags.FLAG_CREATE_CAR_USE_NOTIFICATIONS;
 
 import static com.google.common.truth.Truth.assertThat;
+import static com.google.common.truth.Truth.assertWithMessage;
 
 import static org.junit.Assert.assertThrows;
 import static org.mockito.ArgumentMatchers.any;
 import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
 import static org.mockito.Mockito.after;
 import static org.mockito.Mockito.clearInvocations;
 import static org.mockito.Mockito.doAnswer;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
 import static org.mockito.Mockito.timeout;
-import static org.mockito.Mockito.times;
 import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.when;
 
 import static java.util.concurrent.TimeUnit.MILLISECONDS;
 
+import android.app.Activity;
+import android.app.Service;
 import android.car.Car.CarBuilder;
-import android.car.Car.CarBuilder.ServiceManager;
+import android.car.Car.Deps;
+import android.car.builtin.os.ServiceManagerHelper.IServiceRegistrationCallback;
 import android.car.hardware.property.CarPropertyManager;
 import android.car.hardware.property.ICarProperty;
 import android.content.ComponentName;
@@ -51,12 +58,15 @@ import android.os.IBinder;
 import android.os.Looper;
 import android.os.RemoteException;
 import android.os.SystemClock;
+import android.platform.test.annotations.DisableFlags;
 import android.platform.test.annotations.EnableFlags;
 import android.platform.test.flag.junit.SetFlagsRule;
 import android.platform.test.ravenwood.RavenwoodRule;
 import android.util.Pair;
 
 import com.android.car.internal.ICarServiceHelper;
+import com.android.car.internal.os.Process;
+import com.android.car.internal.os.ServiceManager;
 import com.android.internal.annotations.GuardedBy;
 
 import org.junit.After;
@@ -81,7 +91,9 @@ public final class CarUnitTest {
 
     private static final String TAG = CarUnitTest.class.getSimpleName();
     private static final String PKG_NAME = "Bond.James.Bond";
-    private static final int DEFAULT_TIMEOUT_MS = 1000;
+    private static final int DEFAULT_TIMEOUT_MS = 10_000;
+    private static final int DEFAULT_SLEEP_MS = 1_000;
+    private static final int MY_PID = 1234;
 
     @Rule
     public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
@@ -100,6 +112,8 @@ public final class CarUnitTest {
     @Mock
     private ServiceManager mServiceManager;
     @Mock
+    private Process mFakeProcess;
+    @Mock
     private ICarProperty.Stub mICarProperty;
     @Mock
     private ApplicationInfo mApplicationInfo;
@@ -107,13 +121,19 @@ public final class CarUnitTest {
     private HandlerThread mEventHandlerThread;
     private Handler mEventHandler;
     private Handler mMainHandler;
+    private HandlerThread mServiceManagerHandlerThread;
+    private Handler mServiceManagerHandler;
     private CarBuilder mCarBuilder;
 
     private final Object mLock = new Object();
     @GuardedBy("mLock")
     private final List<ServiceConnection> mBindServiceConnections = new ArrayList<>();
     @GuardedBy("mLock")
+    private final List<IServiceRegistrationCallback> mServiceCallbacks = new ArrayList<>();
+    @GuardedBy("mLock")
     private boolean mCarServiceRegistered;
+    @GuardedBy("mLock")
+    private IBinder.DeathRecipient mDeathRecipient;
 
     // It is tricky to mock this. So create placeholder version instead.
     private final class FakeService extends ICar.Stub {
@@ -170,6 +190,13 @@ public final class CarUnitTest {
         public int getCarConnectionType() {
             return 0;
         }
+
+        @Override
+        public void linkToDeath(IBinder.DeathRecipient deathRecipient, int flags) {
+            synchronized (mLock) {
+                mDeathRecipient = deathRecipient;
+            }
+        }
     };
 
     private final FakeService mService = new FakeService();
@@ -213,13 +240,19 @@ public final class CarUnitTest {
     private final LifecycleListener mLifecycleListener = new LifecycleListener();
 
     @Before
-    public void setUp() {
+    public void setUp() throws Exception {
         mEventHandlerThread = new HandlerThread("CarTestEvent");
         mEventHandlerThread.start();
         mEventHandler = new Handler(mEventHandlerThread.getLooper());
+        mServiceManagerHandlerThread = new HandlerThread("CarTestEvent");
+        mServiceManagerHandlerThread.start();
+        mServiceManagerHandler = new Handler(mServiceManagerHandlerThread.getLooper());
         mMainHandler = new Handler(Looper.getMainLooper());
-        // Inject mServiceManager as a dependency for creating Car.
-        mCarBuilder = new CarBuilder().setServiceManager(mServiceManager);
+        // Inject fake dependencies.
+        mCarBuilder = new CarBuilder().setFakeDeps(new Deps(
+                mServiceManager, mFakeProcess, /* carServiceBindRetryIntervalMs= */ 10,
+                /* carServiceBindMaxRetry= */ 2));
+        when(mFakeProcess.myPid()).thenReturn(MY_PID);
 
         when(mContext.getPackageName()).thenReturn(PKG_NAME);
         when(mContext.getPackageManager()).thenReturn(mPackageManager);
@@ -234,10 +267,15 @@ public final class CarUnitTest {
     @After
     public void tearDown() {
         mEventHandlerThread.quitSafely();
+        mServiceManagerHandlerThread.quitSafely();
+    }
+
+    private void setupFakeServiceManager() throws Exception {
+        setupFakeServiceManager(mContext);
     }
 
-    private void setupFakeServiceManager() {
-        when(mContext.bindService(any(), any(), anyInt())).thenAnswer((inv) -> {
+    private void setupFakeServiceManager(Context context) throws Exception {
+        when(context.bindService(any(), any(), anyInt())).thenAnswer((inv) -> {
             ServiceConnection serviceConnection = inv.getArgument(1);
 
             synchronized (mLock) {
@@ -250,6 +288,7 @@ public final class CarUnitTest {
 
             return true;
         });
+
         doAnswer((inv) -> {
             ServiceConnection serviceConnection = inv.getArgument(0);
 
@@ -257,7 +296,19 @@ public final class CarUnitTest {
                 mBindServiceConnections.remove(serviceConnection);
             }
             return null;
-        }).when(mContext).unbindService(any());
+        }).when(context).unbindService(any());
+
+        doAnswer((inv) -> {
+            synchronized (mLock) {
+                if (mCarServiceRegistered) {
+                    ((IServiceRegistrationCallback) inv.getArgument(1))
+                            .onRegistration(CAR_SERVICE_BINDER_SERVICE_NAME, mService);
+                }
+                mServiceCallbacks.add(inv.getArgument(1));
+            }
+            return null;
+        }).when(mServiceManager).registerForNotifications(
+                eq(CAR_SERVICE_BINDER_SERVICE_NAME), any());
 
         when(mServiceManager.getService(CAR_SERVICE_BINDER_SERVICE_NAME))
                 .thenAnswer((inv) -> {
@@ -278,6 +329,11 @@ public final class CarUnitTest {
                 mMainHandler.post(() -> serviceConnection.onServiceConnected(
                         mCarServiceComponentName, mService));
             }
+            for (int i = 0; i < mServiceCallbacks.size(); i++) {
+                IServiceRegistrationCallback callback = mServiceCallbacks.get(i);
+                mServiceManagerHandler.post(() -> callback.onRegistration(
+                        CAR_SERVICE_BINDER_SERVICE_NAME, mService));
+            }
         }
     }
 
@@ -289,12 +345,28 @@ public final class CarUnitTest {
                 mMainHandler.post(() -> serviceConnection.onServiceDisconnected(
                         mCarServiceComponentName));
             }
+            if (mDeathRecipient != null) {
+                // Copy mDeathRecipient to be catpured outside of the lock.
+                IBinder.DeathRecipient deathRecipient = mDeathRecipient;
+                mServiceManagerHandler.post(() -> deathRecipient.binderDied());
+            }
         }
     }
 
     @Test
-    public void testCreateCar_Context_ServiceConnection_Handler() {
-        Car car = Car.createCar(mContext, mServiceConnectionListener, mEventHandler);
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_ServiceConnection_Handler_oldLogic() {
+        createCar_Context_ServiceConnection_Handler();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_ServiceConnection_Handler_newLogic() {
+        createCar_Context_ServiceConnection_Handler();
+    }
+
+    private void createCar_Context_ServiceConnection_Handler() {
+        Car car = mCarBuilder.createCar(mContext, mServiceConnectionListener, mEventHandler);
 
         assertThat(car).isNotNull();
 
@@ -306,7 +378,7 @@ public final class CarUnitTest {
         setCarServiceRegistered();
 
         verify(mServiceConnectionListener, timeout(DEFAULT_TIMEOUT_MS)).onServiceConnected(
-                mCarServiceComponentName, mService);
+                any(), eq(mService));
         assertThat(car.isConnected()).isTrue();
 
         car.disconnect();
@@ -314,8 +386,19 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_ServiceConnection_DefaultHandler() {
-        Car car = Car.createCar(mContext, mServiceConnectionListener);
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_ServiceConnection_DefaultHandler_oldLogic() {
+        createCar_Context_ServiceConnection_DefaultHandler();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_ServiceConnection_DefaultHandler_newLogic() {
+        createCar_Context_ServiceConnection_DefaultHandler();
+    }
+
+    private void createCar_Context_ServiceConnection_DefaultHandler() {
+        Car car = mCarBuilder.createCar(mContext, mServiceConnectionListener);
 
         assertThat(car).isNotNull();
 
@@ -327,7 +410,7 @@ public final class CarUnitTest {
         setCarServiceRegistered();
 
         verify(mServiceConnectionListener, timeout(DEFAULT_TIMEOUT_MS)).onServiceConnected(
-                mCarServiceComponentName, mService);
+                any(), eq(mService));
         assertThat(car.isConnected()).isTrue();
 
         car.disconnect();
@@ -335,17 +418,59 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_ServiceConnection_Handler_CarServiceRegistered() {
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_NullServiceConnection_DefaultHandler_oldLogic()
+            throws Exception {
+        createCar_Context_NullServiceConnection_DefaultHandler();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_NullServiceConnection_DefaultHandler_newLogic()
+            throws Exception {
+        createCar_Context_NullServiceConnection_DefaultHandler();
+    }
+
+    private void createCar_Context_NullServiceConnection_DefaultHandler() throws Exception {
+        Car car = mCarBuilder.createCar(mContext, (ServiceConnection) null);
+
+        assertThat(car).isNotNull();
+
+        car.connect();
+
+        assertThat(car.isConnecting()).isTrue();
+        assertThat(car.isConnected()).isFalse();
+
+        setCarServiceRegistered();
+
+        pollingLoopForCarConnected(car);
+
+        assertThat(car.isConnected()).isTrue();
+    }
+
+    @Test
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_ServiceConnection_Handler_CarServiceRegistered_oldLogic() {
+        createCar_Context_ServiceConnection_Handler_CarServiceRegistered();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_ServiceConnection_Handler_CarServiceRegistered_newLogic() {
+        createCar_Context_ServiceConnection_Handler_CarServiceRegistered();
+    }
+
+    private void createCar_Context_ServiceConnection_Handler_CarServiceRegistered() {
         setCarServiceRegistered();
 
-        Car car = Car.createCar(mContext, mServiceConnectionListener, mEventHandler);
+        Car car = mCarBuilder.createCar(mContext, mServiceConnectionListener, mEventHandler);
 
         assertThat(car).isNotNull();
 
         car.connect();
 
         verify(mServiceConnectionListener, timeout(DEFAULT_TIMEOUT_MS)).onServiceConnected(
-                mCarServiceComponentName, mService);
+                any(), eq(mService));
         assertThat(car.isConnected()).isTrue();
 
         car.disconnect();
@@ -353,26 +478,48 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_ServiceConnection_Handler_Disconnect_Reconnect() {
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_ServiceConnection_Handler_Disconnect_Reconnect_oldLogic() {
+        createCar_Context_ServiceConnection_Handler_Disconnect_Reconnect();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_ServiceConnection_Handler_Disconnect_Reconnect_newLogic() {
+        createCar_Context_ServiceConnection_Handler_Disconnect_Reconnect();
+    }
+
+    private void createCar_Context_ServiceConnection_Handler_Disconnect_Reconnect() {
         setCarServiceRegistered();
 
-        Car car = Car.createCar(mContext, mServiceConnectionListener, mEventHandler);
+        Car car = mCarBuilder.createCar(mContext, mServiceConnectionListener, mEventHandler);
         car.connect();
 
         verify(mServiceConnectionListener, timeout(DEFAULT_TIMEOUT_MS)).onServiceConnected(
-                mCarServiceComponentName, mService);
+                any(), eq(mService));
         clearInvocations(mServiceConnectionListener);
 
         car.disconnect();
         car.connect();
 
         verify(mServiceConnectionListener, timeout(DEFAULT_TIMEOUT_MS)).onServiceConnected(
-                mCarServiceComponentName, mService);
+                any(), eq(mService));
     }
 
     @Test
-    public void testCreateCar_Context_ServiceConnection_Handler_Disconnect_IgnoreCallback() {
-        Car car = Car.createCar(mContext, mServiceConnectionListener, mEventHandler);
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_SC_Handler_Disconnect_IgnoreCallback_oldLogic() {
+        createCar_Context_ServiceConnection_Handler_Disconnect_IgnoreCallback();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_SC_Handler_Disconnect_IgnoreCallback_newLogic() {
+        createCar_Context_ServiceConnection_Handler_Disconnect_IgnoreCallback();
+    }
+
+    private void createCar_Context_ServiceConnection_Handler_Disconnect_IgnoreCallback() {
+        Car car = mCarBuilder.createCar(mContext, mServiceConnectionListener, mEventHandler);
         car.connect();
         car.disconnect();
 
@@ -380,18 +527,18 @@ public final class CarUnitTest {
 
         // Callback must not be invoked while car is disconnected.
         verify(mServiceConnectionListener, after(DEFAULT_TIMEOUT_MS).never()).onServiceConnected(
-                mCarServiceComponentName, mService);
+                any(), eq(mService));
 
         car.connect();
 
         // Callback should be invoked after connect again.
         verify(mServiceConnectionListener, timeout(DEFAULT_TIMEOUT_MS)).onServiceConnected(
-                mCarServiceComponentName, mService);
+                any(), eq(mService));
     }
 
     @Test
     public void testCreateCar_Context_ServiceConnection_Handler_ContextIsNull() {
-        assertThrows(NullPointerException.class, () -> Car.createCar(
+        assertThrows(NullPointerException.class, () -> mCarBuilder.createCar(
                 /* context= */ null, mServiceConnectionListener, mEventHandler));
     }
 
@@ -399,13 +546,24 @@ public final class CarUnitTest {
     public void testCreateCar_Context_ServiceConnection_Handler_NoAutoFeature() {
         when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_AUTOMOTIVE)).thenReturn(false);
 
-        Car car = Car.createCar(mContext, mServiceConnectionListener, mEventHandler);
+        Car car = mCarBuilder.createCar(mContext, mServiceConnectionListener, mEventHandler);
 
         assertThat(car).isNull();
     }
 
     @Test
-    public void testCreateCar_Context_CarServiceRegistered() throws Exception {
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceRegistered_oldLogic() throws Exception {
+        createCar_Context_CarServiceRegistered();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceRegistered_newLogic() throws Exception {
+        createCar_Context_CarServiceRegistered();
+    }
+
+    private void createCar_Context_CarServiceRegistered() throws Exception {
         setCarServiceRegistered();
 
         Car car = mCarBuilder.createCar(mContext);
@@ -423,7 +581,20 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_CarServiceRegistered_DisconnectReconnect() throws Exception {
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceRegistered_DisconnectReconnect_oldLogic()
+            throws Exception {
+        createCar_Context_CarServiceRegistered_DisconnectReconnect();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceRegistered_DisconnectReconnect_newLogic()
+            throws Exception {
+        createCar_Context_CarServiceRegistered_DisconnectReconnect();
+    }
+
+    private void createCar_Context_CarServiceRegistered_DisconnectReconnect() throws Exception {
         setCarServiceRegistered();
 
         Car car = mCarBuilder.createCar(mContext);
@@ -440,17 +611,24 @@ public final class CarUnitTest {
         car.connect();
 
         // It takes a while for the callback to set connection state to connected.
-        long currentTimeMs = SystemClock.elapsedRealtime();
-        long timeout = currentTimeMs + DEFAULT_TIMEOUT_MS;
-        while (!car.isConnected() && SystemClock.elapsedRealtime() < timeout) {
-            Thread.sleep(100);
-        }
+        pollingLoopForCarConnected(car);
 
         assertThat(car.isConnected()).isTrue();
     }
 
     @Test
-    public void testCreateCar_Context_CarServiceNeverRegistered_Timeout() {
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceNeverRegistered_Timeout_oldLogic() {
+        createCar_Context_CarServiceNeverRegistered_Timeout();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceNeverRegistered_Timeout_newLogic() {
+        createCar_Context_CarServiceNeverRegistered_Timeout();
+    }
+
+    private void createCar_Context_CarServiceNeverRegistered_Timeout() {
         // This should timeout.
         Car car = mCarBuilder.createCar(mContext);
 
@@ -458,7 +636,20 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_CarServiceRegisteredLater_BeforeTimeout() throws Exception {
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceRegisteredLater_BeforeTimeout_oldLogic()
+            throws Exception {
+        createCar_Context_CarServiceRegisteredLater_BeforeTimeout();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceRegisteredLater_BeforeTimeout_newLogic()
+            throws Exception {
+        createCar_Context_CarServiceRegisteredLater_BeforeTimeout();
+    }
+
+    private void createCar_Context_CarServiceRegisteredLater_BeforeTimeout() throws Exception {
         // Car service is registered after 200ms.
         mEventHandler.postDelayed(() -> setCarServiceRegistered(), 200);
 
@@ -467,7 +658,6 @@ public final class CarUnitTest {
 
         assertThat(car).isNotNull();
         assertThat(car.isConnected()).isTrue();
-        verify(mContext).bindService(any(), any(), anyInt());
 
         // In the legacy implementation, createCar will bind to car service and cause an
         // onServiceConnected callback to be invoked later. We must make sure this callback is
@@ -479,7 +669,18 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_InvokeFromMain() throws Exception {
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_InvokeFromMain_oldLogic() throws Exception {
+        createCar_Context_InvokeFromMain();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_InvokeFromMain_newLogic() throws Exception {
+        createCar_Context_InvokeFromMain();
+    }
+
+    private void createCar_Context_InvokeFromMain() throws Exception {
         // Car service is registered after 200ms.
         mEventHandler.postDelayed(() -> setCarServiceRegistered(), 200);
 
@@ -489,7 +690,6 @@ public final class CarUnitTest {
 
             assertThat(car).isNotNull();
             assertThat(car.isConnected()).isTrue();
-            verify(mContext).bindService(any(), any(), anyInt());
 
             car.disconnect();
             assertThat(car.isConnected()).isFalse();
@@ -497,8 +697,147 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_WaitForever_Lclistener_CarServiceRegisteredLater()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceCrash_killClient_oldLogic() throws Exception {
+        createCar_Context_CarServiceCrash_killClient();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceCrash_killClient_newLogic() throws Exception {
+        createCar_Context_CarServiceCrash_killClient();
+    }
+
+    private void createCar_Context_CarServiceCrash_killClient() throws Exception {
+        setCarServiceRegistered();
+        mCarBuilder.createCar(mContext);
+
+        // Simulate car service crash.
+        setCarServiceDisconnected();
+
+        verify(mFakeProcess, timeout(DEFAULT_TIMEOUT_MS)).killProcess(MY_PID);
+    }
+
+    @Test
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceCrash_killClientService_oldLogic()
+            throws Exception {
+        createCar_Context_CarServiceCrash_killClientService();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceCrash_killClientService_newLogic()
             throws Exception {
+        createCar_Context_CarServiceCrash_killClientService();
+    }
+
+    private void createCar_Context_CarServiceCrash_killClientService() throws Exception {
+        Service serviceContext = mock(Service.class);
+        setupFakeServiceManager(serviceContext);
+        setCarServiceRegistered();
+        when(serviceContext.getBaseContext()).thenReturn(mContext);
+        when(serviceContext.getPackageName()).thenReturn("package");
+        mCarBuilder.createCar(serviceContext);
+
+        // Simulate car service crash.
+        setCarServiceDisconnected();
+
+        verify(mFakeProcess, timeout(DEFAULT_TIMEOUT_MS)).killProcess(MY_PID);
+    }
+
+    @Test
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceCrash_stopClientActivity_oldLogic()
+            throws Exception {
+        createCar_Context_CarServiceCrash_stopClientActivity();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceCrash_stopClientActivity_newLogic()
+            throws Exception {
+        createCar_Context_CarServiceCrash_stopClientActivity();
+    }
+
+    private void createCar_Context_CarServiceCrash_stopClientActivity() throws Exception {
+        Activity activityContext = mock(Activity.class);
+        setupFakeServiceManager(activityContext);
+        setCarServiceRegistered();
+        when(activityContext.getBaseContext()).thenReturn(mContext);
+        when(activityContext.isFinishing()).thenReturn(false);
+        mCarBuilder.createCar(activityContext);
+
+        // Simulate car service crash.
+        setCarServiceDisconnected();
+
+        verify(activityContext, timeout(DEFAULT_TIMEOUT_MS)).finish();
+        verify(mFakeProcess, never()).killProcess(anyInt());
+    }
+
+    @Test
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_NullBaseContext_oldLogic() throws Exception {
+        createCar_Context_NullBaseContext();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_NullBaseContext_newLogic() throws Exception {
+        createCar_Context_NullBaseContext();
+    }
+
+    private void createCar_Context_NullBaseContext() throws Exception {
+        // Base context is null.
+        Service serviceContext = mock(Service.class);
+
+        assertThrows(NullPointerException.class, () -> mCarBuilder.createCar(serviceContext));
+    }
+
+    @Test
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceCrashAfterDisconnect_oldLogic() throws Exception {
+        createCar_Context_CarServiceCrashAfterDisconnect();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_CarServiceCrashAfterDisconnect_newLogic() throws Exception {
+        createCar_Context_CarServiceCrashAfterDisconnect();
+    }
+
+    private void createCar_Context_CarServiceCrashAfterDisconnect() throws Exception {
+        setCarServiceRegistered();
+        Car car = mCarBuilder.createCar(mContext);
+
+        // In the legacy implementation, createCar will bind to car service and cause an
+        // onServiceConnected callback to be invoked later. We must make sure this callback is
+        // invoked before disconnect, otherwise, the callback will set isConnected to true again.
+        finishTasksOnMain();
+        car.disconnect();
+
+        setCarServiceDisconnected();
+        finishTasksOnMain();
+
+        verify(mFakeProcess, never()).killProcess(anyInt());
+    }
+
+    @Test
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_Lclistener_CarServiceRegisteredLater_oldLogic()
+            throws Exception {
+        createCar_Context_WaitForever_Lclistener_CarServiceRegisteredLater(false);
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_Lclistener_CarServiceRegisteredLater_newLogic()
+            throws Exception {
+        createCar_Context_WaitForever_Lclistener_CarServiceRegisteredLater(true);
+    }
+
+    private void createCar_Context_WaitForever_Lclistener_CarServiceRegisteredLater(
+            boolean flagCreateCarUseNotifications) throws Exception {
         // Car service is registered after 200ms.
         mEventHandler.postDelayed(() -> setCarServiceRegistered(), 200);
 
@@ -507,9 +846,19 @@ public final class CarUnitTest {
 
         assertThat(car).isNotNull();
         assertThat(car.isConnected()).isTrue();
-        verify(mContext).bindService(any(), any(), anyInt());
+        if (!flagCreateCarUseNotifications) {
+            verify(mContext).bindService(any(), any(), anyInt());
+        }
+        // The callback will be called from the main thread, so it is not guaranteed to be called
+        // after createCar returns.
+        mLifecycleListener.waitForEvent(1, DEFAULT_TIMEOUT_MS);
         mLifecycleListener.assertOneListenerCallAndClear(car, true);
 
+        if (flagCreateCarUseNotifications) {
+            // The rest of the test is for the old logic.
+            return;
+        }
+
         // Just call these to guarantee that nothing crashes with these call.
         ServiceConnection serviceConnection;
         synchronized (mLock) {
@@ -522,7 +871,20 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_WaitForever_Lclistener_ConnectCrashRestart()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_Lclistener_ConnectCrashRestart_oldLogic()
+            throws Exception {
+        createCar_Context_WaitForever_Lclistener_ConnectCrashRestart();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_Lclistener_ConnectCrashRestart_newLogic()
+            throws Exception {
+        createCar_Context_WaitForever_Lclistener_ConnectCrashRestart();
+    }
+
+    private void createCar_Context_WaitForever_Lclistener_ConnectCrashRestart()
             throws Exception {
         // Car service is registered after 100ms.
         mEventHandler.postDelayed(() -> setCarServiceRegistered(), 100);
@@ -553,7 +915,20 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_WaitForever_Lclistener_CarServiceAlreadyRegistered()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_Lclistener_CSAlreadyRegistered_oldLogic()
+            throws Exception {
+        createCar_Context_WaitForever_Lclistener_CarServiceAlreadyRegistered();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_Lclistener_CSAlreadyRegistered_newLogic()
+            throws Exception {
+        createCar_Context_WaitForever_Lclistener_CarServiceAlreadyRegistered();
+    }
+
+    private void createCar_Context_WaitForever_Lclistener_CarServiceAlreadyRegistered()
             throws Exception {
         setCarServiceRegistered();
 
@@ -563,7 +938,6 @@ public final class CarUnitTest {
 
             assertThat(car).isNotNull();
             assertThat(car.isConnected()).isTrue();
-            verify(mContext, times(1)).bindService(any(), any(), anyInt());
 
             // mLifecycleListener should have been called as this is main thread.
             mLifecycleListener.assertOneListenerCallAndClear(car, true);
@@ -571,7 +945,20 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_WaitForever_Lclistener_ManagerNotTheSameAfterReconnect()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_Lclistener_MgrNotTheSameAfterReconnect_oldLogic()
+            throws Exception {
+        createCar_Context_WaitForever_Lclistener_ManagerNotTheSameAfterReconnect();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_Lclistener_MgrNotTheSameAfterReconnect_newLogic()
+            throws Exception {
+        createCar_Context_WaitForever_Lclistener_ManagerNotTheSameAfterReconnect();
+    }
+
+    private void createCar_Context_WaitForever_Lclistener_ManagerNotTheSameAfterReconnect()
             throws Exception {
         setCarServiceRegistered();
 
@@ -600,7 +987,20 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_DoNotWait_CarServiceRegistered()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_CarServiceRegistered_oldLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_CarServiceRegistered();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_CarServiceRegistered_newLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_CarServiceRegistered();
+    }
+
+    private void createCar_Context_DoNotWait_CarServiceRegistered()
             throws Exception {
         setCarServiceRegistered();
 
@@ -609,14 +1009,26 @@ public final class CarUnitTest {
 
         assertThat(car).isNotNull();
         assertThat(car.isConnected()).isTrue();
-        verify(mContext).bindService(any(), any(), anyInt());
 
         mLifecycleListener.waitForEvent(1, DEFAULT_TIMEOUT_MS);
         mLifecycleListener.assertOneListenerCallAndClear(car, true);
     }
 
     @Test
-    public void testCreateCar_Context_DoNotWait_CarServiceCrash_Restore()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_CarServiceCrash_Restore_oldLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_CarServiceCrash_Restore();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_CarServiceCrash_Restore_newLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_CarServiceCrash_Restore();
+    }
+
+    private void createCar_Context_DoNotWait_CarServiceCrash_Restore()
             throws Exception {
         setCarServiceRegistered();
 
@@ -642,7 +1054,20 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_DoNotWait_InvokeFromMain_CarServiceRegistered()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_InvokeFromMain_CarSvcRegistered_oldLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_InvokeFromMain_CarServiceRegistered();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_InvokeFromMain_CarSvcRegistered_newLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_InvokeFromMain_CarServiceRegistered();
+    }
+
+    private void createCar_Context_DoNotWait_InvokeFromMain_CarServiceRegistered()
             throws Exception {
         setCarServiceRegistered();
 
@@ -652,21 +1077,32 @@ public final class CarUnitTest {
 
             assertThat(car).isNotNull();
             assertThat(car.isConnected()).isTrue();
-            verify(mContext).bindService(any(), any(), anyInt());
             // createCar is called from main handler, so callback must have already been called.
             mLifecycleListener.assertOneListenerCallAndClear(car, true);
         });
     }
 
     @Test
-    public void testCreateCar_Context_DoNotWait_CarServiceRegisteredLater()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_CarServiceRegisteredLater_oldLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_CarServiceRegisteredLater();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_CarServiceRegisteredLater_newLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_CarServiceRegisteredLater();
+    }
+
+    private void createCar_Context_DoNotWait_CarServiceRegisteredLater()
             throws Exception {
         Car car = mCarBuilder.createCar(mContext, null,
                 Car.CAR_WAIT_TIMEOUT_DO_NOT_WAIT, mLifecycleListener);
 
         assertThat(car).isNotNull();
         assertThat(car.isConnected()).isFalse();
-        verify(mContext).bindService(any(), any(), anyInt());
 
         setCarServiceRegistered();
 
@@ -675,21 +1111,33 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_DoNotWait_CarServiceRegisteredAfterDisconnect()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_CarSvcRegisteredAfterDisconnect_oldLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_CarServiceRegisteredAfterDisconnect();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_CarSvcRegisteredAfterDisconnect_newLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_CarServiceRegisteredAfterDisconnect();
+    }
+
+    private void createCar_Context_DoNotWait_CarServiceRegisteredAfterDisconnect()
             throws Exception {
         Car car = mCarBuilder.createCar(mContext, null,
                 Car.CAR_WAIT_TIMEOUT_DO_NOT_WAIT, mLifecycleListener);
 
         assertThat(car).isNotNull();
         assertThat(car.isConnected()).isFalse();
-        verify(mContext).bindService(any(), any(), anyInt());
 
         car.disconnect();
 
         // Car service is registered after disconnect, must not invoke callback.
         setCarServiceRegistered();
 
-        Thread.sleep(DEFAULT_TIMEOUT_MS);
+        Thread.sleep(DEFAULT_SLEEP_MS);
         mLifecycleListener.assertNoEvent();
 
         // After connect, the callback must be invoked.
@@ -700,7 +1148,20 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_DoNotWait_InvokeFromMain_CarServiceRegisteredLater()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_InvokeFromMain_CarSvcRegisteredLater_oldLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_InvokeFromMain_CarServiceRegisteredLater();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_DoNotWait_InvokeFromMain_CarSvcRegisteredLater_newLogic()
+            throws Exception {
+        createCar_Context_DoNotWait_InvokeFromMain_CarServiceRegisteredLater();
+    }
+
+    private void createCar_Context_DoNotWait_InvokeFromMain_CarServiceRegisteredLater()
             throws Exception {
         setCarServiceRegistered();
 
@@ -710,14 +1171,26 @@ public final class CarUnitTest {
 
             assertThat(car).isNotNull();
             assertThat(car.isConnected()).isTrue();
-            verify(mContext).bindService(any(), any(), anyInt());
             // createCar is called from main handler, so callback must have already been called.
             mLifecycleListener.assertOneListenerCallAndClear(car, true);
         });
     }
 
     @Test
-    public void testCreateCar_Context_WithTimeout_InvokeFromMain_CarServiceRegisteredLater()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WithTimeout_InvokeFromMain_CarSvcRegisteredLater_oldLogic()
+            throws Exception {
+        createCar_Context_WithTimeout_InvokeFromMain_CarServiceRegisteredLater();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WithTimeout_InvokeFromMain_CarSvcRegisteredLater_newLogic()
+            throws Exception {
+        createCar_Context_WithTimeout_InvokeFromMain_CarServiceRegisteredLater();
+    }
+
+    private void createCar_Context_WithTimeout_InvokeFromMain_CarServiceRegisteredLater()
             throws Exception {
         // Car service is registered after 200ms.
         mEventHandler.postDelayed(() -> setCarServiceRegistered(), 200);
@@ -727,22 +1200,32 @@ public final class CarUnitTest {
 
             assertThat(car).isNotNull();
             assertThat(car.isConnected()).isTrue();
-            verify(mContext).bindService(any(), any(), anyInt());
             // createCar is called from main handler, so callback must have already been called.
             mLifecycleListener.assertOneListenerCallAndClear(car, true);
         });
     }
 
     @Test
-    public void testCreateCar_Context_WithTimeout_CarServiceRegisteredAfterTimeout()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WithTimeout_CarSvcRegisteredAfterTimeout_oldLogic()
+            throws Exception {
+        createCar_Context_WithTimeout_CarServiceRegisteredAfterTimeout();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WithTimeout_CarSvcRegisteredAfterTimeout_newLogic()
+            throws Exception {
+        createCar_Context_WithTimeout_CarServiceRegisteredAfterTimeout();
+    }
+
+    private void createCar_Context_WithTimeout_CarServiceRegisteredAfterTimeout()
             throws Exception {
         // Car service is registered after 200ms.
         mEventHandler.postDelayed(() -> setCarServiceRegistered(), 200);
 
-        Car car = mCarBuilder.createCar(mContext, null, 50, mLifecycleListener);
+        Car car = mCarBuilder.createCar(mContext, null, /* waitTimeoutMs= */50, mLifecycleListener);
         assertThat(car).isNotNull();
-        assertThat(car.isConnected()).isFalse();
-        verify(mContext).bindService(any(), any(), anyInt());
 
         // The callback should be invoked after 200ms.
         mLifecycleListener.waitForEvent(1, DEFAULT_TIMEOUT_MS);
@@ -751,7 +1234,49 @@ public final class CarUnitTest {
     }
 
     @Test
-    public void testCreateCar_Context_WaitForever_InvokeFromMain_CarServiceRegisteredLater()
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_InvokeFromMain_CarSvcRegisteredLater_oldLogic()
+            throws Exception {
+        createCar_Context_WaitForever_InvokeFromMain_CarServiceRegisteredLater();
+    }
+
+    @Test
+    @EnableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_WaitForever_InvokeFromMain_CarSvcRegisteredLater_newLogic()
+            throws Exception {
+        createCar_Context_WaitForever_InvokeFromMain_CarServiceRegisteredLater();
+    }
+
+    /**
+     * The following test cases are for old logic only.
+     */
+    @Test
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_bindServiceFailed() throws Exception {
+        when(mContext.bindService(any(), any(), anyInt())).thenReturn(false);
+        when(mServiceManager.getService(CAR_SERVICE_BINDER_SERVICE_NAME))
+                .thenReturn(mService);
+
+        mCarBuilder.createCar(mContext);
+
+        // bindService failures will cause onServiceDisconnected which will kill the client.
+        verify(mFakeProcess, timeout(DEFAULT_TIMEOUT_MS)).killProcess(MY_PID);
+    }
+
+    @Test
+    @DisableFlags(FLAG_CREATE_CAR_USE_NOTIFICATIONS)
+    public void testCreateCar_Context_bindService_retry_success() throws Exception {
+        when(mContext.bindService(any(), any(), anyInt())).thenReturn(false).thenReturn(true);
+        when(mServiceManager.getService(CAR_SERVICE_BINDER_SERVICE_NAME))
+                .thenReturn(mService);
+
+        mCarBuilder.createCar(mContext);
+
+        Thread.sleep(DEFAULT_SLEEP_MS);
+        verify(mFakeProcess, never()).killProcess(anyInt());
+    }
+
+    private void createCar_Context_WaitForever_InvokeFromMain_CarServiceRegisteredLater()
             throws Exception {
         // Car service is registered after 200ms.
         mEventHandler.postDelayed(() -> setCarServiceRegistered(), 200);
@@ -762,7 +1287,6 @@ public final class CarUnitTest {
 
             assertThat(car).isNotNull();
             assertThat(car.isConnected()).isTrue();
-            verify(mContext, times(1)).bindService(any(), any(), anyInt());
 
             // mLifecycleListener should have been called as this is main thread.
             mLifecycleListener.assertOneListenerCallAndClear(car, true);
@@ -771,15 +1295,41 @@ public final class CarUnitTest {
 
     private void runOnMain(Runnable runnable) throws InterruptedException {
         var cdLatch = new CountDownLatch(1);
+        // Use a list to be effectively final. We only store one exception.
+        List<RuntimeException> exceptions = new ArrayList<>();
+        List<AssertionError> assertionErrors = new ArrayList<>();
         mMainHandler.post(() -> {
-            runnable.run();
-            cdLatch.countDown();
+            try {
+                runnable.run();
+            } catch (RuntimeException e) {
+                exceptions.add(e);
+            } catch (AssertionError e) {
+                assertionErrors.add(e);
+            } finally {
+                cdLatch.countDown();
+            }
         });
-        cdLatch.await(DEFAULT_TIMEOUT_MS, MILLISECONDS);
+        assertWithMessage("Main thread not finish before: " + DEFAULT_TIMEOUT_MS + " ms").that(
+                cdLatch.await(DEFAULT_TIMEOUT_MS, MILLISECONDS)).isTrue();
+        // Rethrow the caught errors to fail the test, if any.
+        if (!exceptions.isEmpty()) {
+            throw exceptions.get(0);
+        }
+        if (!assertionErrors.isEmpty()) {
+            throw assertionErrors.get(0);
+        }
     }
 
     private void finishTasksOnMain() throws InterruptedException {
         // Do nothing on main just to make sure main finished handling the callbacks.
         runOnMain(() -> {});
     }
+
+    private void pollingLoopForCarConnected(Car car) throws InterruptedException {
+        long currentTimeMs = SystemClock.elapsedRealtime();
+        long timeout = currentTimeMs + DEFAULT_TIMEOUT_MS;
+        while (!car.isConnected() && SystemClock.elapsedRealtime() < timeout) {
+            Thread.sleep(100);
+        }
+    }
 }
diff --git a/tests/carservice_unit_test/src/android/car/admin/CarDevicePolicyManagerUnitTest.java b/tests/CarLibUnitTest/src/android/car/admin/CarDevicePolicyManagerUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/admin/CarDevicePolicyManagerUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/admin/CarDevicePolicyManagerUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/admin/CreateUserResultTest.java b/tests/CarLibUnitTest/src/android/car/admin/CreateUserResultTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/admin/CreateUserResultTest.java
rename to tests/CarLibUnitTest/src/android/car/admin/CreateUserResultTest.java
diff --git a/tests/carservice_unit_test/src/android/car/admin/RemoveUserResultTest.java b/tests/CarLibUnitTest/src/android/car/admin/RemoveUserResultTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/admin/RemoveUserResultTest.java
rename to tests/CarLibUnitTest/src/android/car/admin/RemoveUserResultTest.java
diff --git a/tests/carservice_unit_test/src/android/car/admin/StartUserInBackgroundResultTest.java b/tests/CarLibUnitTest/src/android/car/admin/StartUserInBackgroundResultTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/admin/StartUserInBackgroundResultTest.java
rename to tests/CarLibUnitTest/src/android/car/admin/StartUserInBackgroundResultTest.java
diff --git a/tests/carservice_unit_test/src/android/car/admin/StopUserResultTest.java b/tests/CarLibUnitTest/src/android/car/admin/StopUserResultTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/admin/StopUserResultTest.java
rename to tests/CarLibUnitTest/src/android/car/admin/StopUserResultTest.java
diff --git a/tests/carservice_unit_test/src/android/car/app/CarTaskViewControllerHostLifecycleFactoryTest.java b/tests/CarLibUnitTest/src/android/car/app/CarTaskViewControllerHostLifecycleFactoryTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/app/CarTaskViewControllerHostLifecycleFactoryTest.java
rename to tests/CarLibUnitTest/src/android/car/app/CarTaskViewControllerHostLifecycleFactoryTest.java
diff --git a/tests/carservice_unit_test/src/android/car/app/CarTaskViewControllerHostLifecycleTest.java b/tests/CarLibUnitTest/src/android/car/app/CarTaskViewControllerHostLifecycleTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/app/CarTaskViewControllerHostLifecycleTest.java
rename to tests/CarLibUnitTest/src/android/car/app/CarTaskViewControllerHostLifecycleTest.java
diff --git a/tests/carservice_unit_test/src/android/car/app/FakeCarTaskViewControllerHostLifecycleObserver.java b/tests/CarLibUnitTest/src/android/car/app/FakeCarTaskViewControllerHostLifecycleObserver.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/app/FakeCarTaskViewControllerHostLifecycleObserver.java
rename to tests/CarLibUnitTest/src/android/car/app/FakeCarTaskViewControllerHostLifecycleObserver.java
diff --git a/tests/carservice_unit_test/src/android/car/cluster/ClusterStateTest.java b/tests/CarLibUnitTest/src/android/car/cluster/ClusterStateTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/cluster/ClusterStateTest.java
rename to tests/CarLibUnitTest/src/android/car/cluster/ClusterStateTest.java
diff --git a/tests/carservice_unit_test/src/android/car/cluster/renderer/InstrumentClusterRenderingServiceTest.java b/tests/CarLibUnitTest/src/android/car/cluster/renderer/InstrumentClusterRenderingServiceTest.java
similarity index 99%
rename from tests/carservice_unit_test/src/android/car/cluster/renderer/InstrumentClusterRenderingServiceTest.java
rename to tests/CarLibUnitTest/src/android/car/cluster/renderer/InstrumentClusterRenderingServiceTest.java
index af8490fe77..bb68be6f40 100644
--- a/tests/carservice_unit_test/src/android/car/cluster/renderer/InstrumentClusterRenderingServiceTest.java
+++ b/tests/CarLibUnitTest/src/android/car/cluster/renderer/InstrumentClusterRenderingServiceTest.java
@@ -170,7 +170,7 @@ public final class InstrumentClusterRenderingServiceTest extends AbstractExtende
                 .when(mService.mSpyPackageManager).getPackagesForUid(userId);
         doReturn(PERMISSION_GRANTED)
                 .when(mService.mSpyPackageManager).checkPermission(
-                PERMISSION_CAR_DISPLAY_IN_CLUSTER, packageName);
+                        PERMISSION_CAR_DISPLAY_IN_CLUSTER, packageName);
         doReturn(createActivityResolveInfo(packageName)).when(mService.mSpyPackageManager)
                 .queryIntentActivitiesAsUser(any(), eq(GET_RESOLVED_FILTER),
                         eq(UserHandle.of(userId)));
@@ -229,7 +229,7 @@ public final class InstrumentClusterRenderingServiceTest extends AbstractExtende
                 .when(mService.mSpyPackageManager).getPackagesForUid(userId);
         doReturn(PERMISSION_DENIED)
                 .when(mService.mSpyPackageManager).checkPermission(
-                PERMISSION_CAR_DISPLAY_IN_CLUSTER, packageName);
+                        PERMISSION_CAR_DISPLAY_IN_CLUSTER, packageName);
 
         mRendererBinder.setNavigationContextOwner(userId, 123);
         InstrumentationRegistry.getInstrumentation().waitForIdleSync();
@@ -298,7 +298,7 @@ public final class InstrumentClusterRenderingServiceTest extends AbstractExtende
                 .when(mService.mSpyPackageManager).getPackagesForUid(userId);
         doReturn(PERMISSION_GRANTED)
                 .when(mService.mSpyPackageManager).checkPermission(
-                PERMISSION_CAR_DISPLAY_IN_CLUSTER, packageName);
+                        PERMISSION_CAR_DISPLAY_IN_CLUSTER, packageName);
         doReturn(createActivityResolveInfo(packageName)).when(mService.mSpyPackageManager)
                 .queryIntentActivitiesAsUser(any(), eq(GET_RESOLVED_FILTER),
                         eq(UserHandle.of(userId)));
diff --git a/tests/CarLibUnitTest/src/android/car/hardware/property/CarPropertyManagerUnitTest.java b/tests/CarLibUnitTest/src/android/car/hardware/property/CarPropertyManagerUnitTest.java
index 408466348d..cc1512ed9f 100644
--- a/tests/CarLibUnitTest/src/android/car/hardware/property/CarPropertyManagerUnitTest.java
+++ b/tests/CarLibUnitTest/src/android/car/hardware/property/CarPropertyManagerUnitTest.java
@@ -54,6 +54,7 @@ import android.car.VehicleAreaSeat;
 import android.car.VehicleAreaType;
 import android.car.VehiclePropertyIds;
 import android.car.feature.FeatureFlags;
+import android.car.feature.Flags;
 import android.car.hardware.CarPropertyConfig;
 import android.car.hardware.CarPropertyValue;
 import android.content.Context;
@@ -64,7 +65,9 @@ import android.os.Handler;
 import android.os.Looper;
 import android.os.RemoteException;
 import android.os.ServiceSpecificException;
+import android.platform.test.annotations.EnableFlags;
 import android.platform.test.annotations.IgnoreUnderRavenwood;
+import android.platform.test.flag.junit.SetFlagsRule;
 import android.platform.test.ravenwood.RavenwoodRule;
 import android.util.ArraySet;
 import android.util.SparseArray;
@@ -109,6 +112,8 @@ public final class CarPropertyManagerUnitTest {
             .setProvideMainThread(true)
             .build();
 
+    @Rule public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+
     // Defined as vendor property.
     private static final int VENDOR_CONTINUOUS_PROPERTY = 0x21100111;
     private static final int VENDOR_ON_CHANGE_PROPERTY = 0x21100222;
@@ -296,6 +301,8 @@ public final class CarPropertyManagerUnitTest {
         mCarPropertyManager = new CarPropertyManager(mCar, mICarProperty);
         // Enable the features.
         when(mFeatureFlags.variableUpdateRate()).thenReturn(true);
+        when(mFeatureFlags.handlePropertyEventsInBinderThread()).thenReturn(true);
+
         mCarPropertyManager.setFeatureFlags(mFeatureFlags);
     }
 
@@ -1203,9 +1210,9 @@ public final class CarPropertyManagerUnitTest {
     public void testOnGetValueResult_onFailure() throws RemoteException {
         doAnswer((invocation) -> {
             Object[] args = invocation.getArguments();
-            AsyncPropertyServiceRequestList asyncPropertyServiceREquestList =
+            AsyncPropertyServiceRequestList asyncPropertyServiceRequestList =
                     (AsyncPropertyServiceRequestList) args[0];
-            List getPropertyServiceList = asyncPropertyServiceREquestList.getList();
+            List getPropertyServiceList = asyncPropertyServiceRequestList.getList();
             AsyncPropertyServiceRequest getPropertyServiceRequest =
                     (AsyncPropertyServiceRequest) getPropertyServiceList.get(0);
             IAsyncPropertyResultCallback getAsyncPropertyResultCallback =
@@ -1215,7 +1222,7 @@ public final class CarPropertyManagerUnitTest {
             assertThat(getPropertyServiceRequest.getPropertyId()).isEqualTo(HVAC_TEMPERATURE_SET);
 
             GetSetValueResult getValueResult = GetSetValueResult.newErrorResult(
-                    0,
+                     /* requestId= */ 0,
                     new CarPropertyErrorCodes(
                             CarPropertyManager.STATUS_ERROR_INTERNAL_ERROR, VENDOR_ERROR_CODE, 0));
 
@@ -1238,6 +1245,35 @@ public final class CarPropertyManagerUnitTest {
         assertThat(error.getVendorErrorCode()).isEqualTo(VENDOR_ERROR_CODE);
     }
 
+    @Test
+    @EnableFlags(Flags.FLAG_CAR_PROPERTY_DETAILED_ERROR_CODES)
+    public void testPropertyAsyncError_GetDetailedErrorCode() throws RemoteException {
+        doAnswer((invocation) -> {
+            Object[] args = invocation.getArguments();
+            IAsyncPropertyResultCallback getAsyncPropertyResultCallback =
+                    (IAsyncPropertyResultCallback) args[1];
+
+            GetSetValueResult getValueResult = GetSetValueResult.newErrorResult(
+                    /* requestId= */ 0,
+                    new CarPropertyErrorCodes(
+                            CarPropertyManager.STATUS_ERROR_INTERNAL_ERROR,
+                            /* vendorErrorCode= */ 0,
+                            VehicleHalStatusCode.STATUS_NOT_AVAILABLE_SPEED_HIGH));
+
+            getAsyncPropertyResultCallback.onGetValueResults(
+                    new GetSetValueResultList(List.of(getValueResult)));
+            return null;
+        }).when(mICarProperty).getPropertiesAsync(any(), any(), anyLong());
+
+        mCarPropertyManager.getPropertiesAsync(List.of(createGetPropertyRequest()), null, null,
+                mGetPropertyCallback);
+
+        verify(mGetPropertyCallback, timeout(1000)).onFailure(mPropertyAsyncErrorCaptor.capture());
+        PropertyAsyncError error = mPropertyAsyncErrorCaptor.getValue();
+        assertThat(error.getDetailedErrorCode()).isEqualTo(
+                DetailedErrorCode.NOT_AVAILABLE_SPEED_HIGH);
+    }
+
     @Test
     public void testSetProperty_setsValue() throws RemoteException {
         mCarPropertyManager.setProperty(Float.class, HVAC_TEMPERATURE_SET, 0, 17.0f);
@@ -2094,7 +2130,7 @@ public final class CarPropertyManagerUnitTest {
 
         verify(mICarProperty).registerListener(eq(List.of(
                         createCarSubscriptionOption(VENDOR_CONTINUOUS_PROPERTY, new int[]{0},
-                                CarPropertyManager.SENSOR_RATE_FAST, /* enableVur= */ false))),
+                                CarPropertyManager.SENSOR_RATE_FAST, /* enableVur= */ true))),
                 any(ICarPropertyEventListener.class));
     }
 
diff --git a/tests/carservice_unit_test/src/android/car/hardware/property/SubscriptionTest.java b/tests/CarLibUnitTest/src/android/car/hardware/property/SubscriptionUnitTest.java
similarity index 91%
rename from tests/carservice_unit_test/src/android/car/hardware/property/SubscriptionTest.java
rename to tests/CarLibUnitTest/src/android/car/hardware/property/SubscriptionUnitTest.java
index b6c302a213..471922560a 100644
--- a/tests/carservice_unit_test/src/android/car/hardware/property/SubscriptionTest.java
+++ b/tests/CarLibUnitTest/src/android/car/hardware/property/SubscriptionUnitTest.java
@@ -16,6 +16,7 @@
 
 package android.car.hardware.property;
 
+import static com.google.common.truth.Truth.assertThat;
 import static com.google.common.truth.Truth.assertWithMessage;
 
 import static org.junit.Assert.assertThrows;
@@ -26,7 +27,22 @@ import org.junit.Test;
 import org.junit.runner.RunWith;
 
 @RunWith(AndroidJUnit4.class)
-public final class SubscriptionTest {
+public final class SubscriptionUnitTest {
+
+    @Test
+    public void testGetUpdateRateConstants() {
+        Subscription subscription = new Subscription.Builder(/* propertyId= */0).build();
+
+        assertThat(subscription.getUpdateRateUi()).isEqualTo(
+                CarPropertyManager.SENSOR_RATE_UI);
+        assertThat(subscription.getUpdateRateNormal()).isEqualTo(
+                CarPropertyManager.SENSOR_RATE_NORMAL);
+        assertThat(subscription.getUpdateRateFast()).isEqualTo(
+                CarPropertyManager.SENSOR_RATE_FAST);
+        assertThat(subscription.getUpdateRateFastest()).isEqualTo(
+                CarPropertyManager.SENSOR_RATE_FASTEST);
+    }
+
     @Test
     public void testBuilder_noUpdateRateSet() {
         Subscription.Builder builder = new Subscription.Builder(/* propertyId= */ 52);
diff --git a/tests/carservice_unit_test/src/android/car/media/CarAudioPatchHandleUnitTest.java b/tests/CarLibUnitTest/src/android/car/media/CarAudioPatchHandleUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/media/CarAudioPatchHandleUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/media/CarAudioPatchHandleUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/media/CarAudioZoneConfigInfoUnitTest.java b/tests/CarLibUnitTest/src/android/car/media/CarAudioZoneConfigInfoUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/media/CarAudioZoneConfigInfoUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/media/CarAudioZoneConfigInfoUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/media/CarVolumeGroupEventUnitTest.java b/tests/CarLibUnitTest/src/android/car/media/CarVolumeGroupEventUnitTest.java
similarity index 99%
rename from tests/carservice_unit_test/src/android/car/media/CarVolumeGroupEventUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/media/CarVolumeGroupEventUnitTest.java
index 8cd91bda99..c53a0426a0 100644
--- a/tests/carservice_unit_test/src/android/car/media/CarVolumeGroupEventUnitTest.java
+++ b/tests/CarLibUnitTest/src/android/car/media/CarVolumeGroupEventUnitTest.java
@@ -33,6 +33,7 @@ import java.util.List;
 
 @RunWith(JUnit4.class)
 public final class CarVolumeGroupEventUnitTest extends AbstractExpectableTestCase {
+
     private static final String TEST_GROUP_NAME_MEDIA = "MEDIA";
     private static final int TEST_ZONE_ID = 1;
     private static final int TEST_ID = 1;
diff --git a/tests/carservice_unit_test/src/android/car/media/CarVolumeGroupInfoUnitTest.java b/tests/CarLibUnitTest/src/android/car/media/CarVolumeGroupInfoUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/media/CarVolumeGroupInfoUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/media/CarVolumeGroupInfoUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/navigation/CarNavigationInstrumentClusterTest.java b/tests/CarLibUnitTest/src/android/car/navigation/CarNavigationInstrumentClusterTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/navigation/CarNavigationInstrumentClusterTest.java
rename to tests/CarLibUnitTest/src/android/car/navigation/CarNavigationInstrumentClusterTest.java
diff --git a/tests/carservice_unit_test/src/android/car/occupantconnection/AbstractReceiverServiceUnitTest.java b/tests/CarLibUnitTest/src/android/car/occupantconnection/AbstractReceiverServiceUnitTest.java
similarity index 95%
rename from tests/carservice_unit_test/src/android/car/occupantconnection/AbstractReceiverServiceUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/occupantconnection/AbstractReceiverServiceUnitTest.java
index 329fe1b9af..029d23e058 100644
--- a/tests/carservice_unit_test/src/android/car/occupantconnection/AbstractReceiverServiceUnitTest.java
+++ b/tests/CarLibUnitTest/src/android/car/occupantconnection/AbstractReceiverServiceUnitTest.java
@@ -29,9 +29,12 @@ import android.content.Intent;
 import android.content.pm.SigningInfo;
 import android.os.IBinder;
 import android.os.RemoteException;
+import android.platform.test.annotations.DisabledOnRavenwood;
+import android.platform.test.ravenwood.RavenwoodClassRule;
 import android.util.Pair;
 
 import org.junit.Before;
+import org.junit.ClassRule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.mockito.Mock;
@@ -40,7 +43,10 @@ import org.mockito.junit.MockitoJUnitRunner;
 import java.util.Set;
 
 @RunWith(MockitoJUnitRunner.class)
+@DisabledOnRavenwood(blockedBy = android.app.Service.class)
 public final class AbstractReceiverServiceUnitTest {
+    @ClassRule
+    public static final RavenwoodClassRule sRavenwood = new RavenwoodClassRule();
 
     private static final String RECEIVER_ENDPOINT_ID = "test_receiver_endpoint";
 
diff --git a/tests/carservice_unit_test/src/android/car/occupantconnection/IPayloadTestBinder.aidl b/tests/CarLibUnitTest/src/android/car/occupantconnection/IPayloadTestBinder.aidl
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/occupantconnection/IPayloadTestBinder.aidl
rename to tests/CarLibUnitTest/src/android/car/occupantconnection/IPayloadTestBinder.aidl
diff --git a/tests/carservice_unit_test/src/android/car/occupantconnection/PayloadTestBinderService.java b/tests/CarLibUnitTest/src/android/car/occupantconnection/PayloadTestBinderService.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/occupantconnection/PayloadTestBinderService.java
rename to tests/CarLibUnitTest/src/android/car/occupantconnection/PayloadTestBinderService.java
diff --git a/tests/carservice_unit_test/src/android/car/occupantconnection/PayloadUnitTest.java b/tests/CarLibUnitTest/src/android/car/occupantconnection/PayloadUnitTest.java
similarity index 94%
rename from tests/carservice_unit_test/src/android/car/occupantconnection/PayloadUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/occupantconnection/PayloadUnitTest.java
index 742f22b4a4..0344758635 100644
--- a/tests/carservice_unit_test/src/android/car/occupantconnection/PayloadUnitTest.java
+++ b/tests/CarLibUnitTest/src/android/car/occupantconnection/PayloadUnitTest.java
@@ -29,17 +29,23 @@ import android.os.Binder;
 import android.os.IBinder;
 import android.os.Parcel;
 import android.os.RemoteException;
+import android.platform.test.annotations.DisabledOnRavenwood;
+import android.platform.test.ravenwood.RavenwoodClassRule;
 
 import androidx.test.filters.SmallTest;
 import androidx.test.platform.app.InstrumentationRegistry;
 
 import org.junit.Before;
+import org.junit.ClassRule;
 import org.junit.Test;
 
 import java.util.concurrent.CountDownLatch;
 
 @SmallTest
+@DisabledOnRavenwood(blockedBy = InstrumentationRegistry.class)
 public final class PayloadUnitTest {
+    @ClassRule
+    public static final RavenwoodClassRule sRavenwood = new RavenwoodClassRule();
 
     private static final int ARRAY_LENGTH_SMALL = MAX_DIRECT_PAYLOAD_SIZE - 1;
     private static final int ARRAY_LENGTH_BIG = MAX_DIRECT_PAYLOAD_SIZE + 1;
diff --git a/tests/carservice_unit_test/src/android/car/occupantconnection/TestReceiverService.java b/tests/CarLibUnitTest/src/android/car/occupantconnection/TestReceiverService.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/occupantconnection/TestReceiverService.java
rename to tests/CarLibUnitTest/src/android/car/occupantconnection/TestReceiverService.java
diff --git a/tests/carservice_unit_test/src/android/car/oem/AudioFocusEntryUnitTest.java b/tests/CarLibUnitTest/src/android/car/oem/AudioFocusEntryUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/oem/AudioFocusEntryUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/oem/AudioFocusEntryUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/oem/CarAudioFadeConfigurationUnitTest.java b/tests/CarLibUnitTest/src/android/car/oem/CarAudioFadeConfigurationUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/oem/CarAudioFadeConfigurationUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/oem/CarAudioFadeConfigurationUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/oem/CarAudioFeaturesInfoUnitTest.java b/tests/CarLibUnitTest/src/android/car/oem/CarAudioFeaturesInfoUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/oem/CarAudioFeaturesInfoUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/oem/CarAudioFeaturesInfoUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/oem/OemCarAudioFocusEvaluationRequestUnitTest.java b/tests/CarLibUnitTest/src/android/car/oem/OemCarAudioFocusEvaluationRequestUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/oem/OemCarAudioFocusEvaluationRequestUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/oem/OemCarAudioFocusEvaluationRequestUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/oem/OemCarAudioFocusResultUnitTest.java b/tests/CarLibUnitTest/src/android/car/oem/OemCarAudioFocusResultUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/oem/OemCarAudioFocusResultUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/oem/OemCarAudioFocusResultUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/oem/OemCarAudioVolumeRequestUnitTest.java b/tests/CarLibUnitTest/src/android/car/oem/OemCarAudioVolumeRequestUnitTest.java
similarity index 96%
rename from tests/carservice_unit_test/src/android/car/oem/OemCarAudioVolumeRequestUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/oem/OemCarAudioVolumeRequestUnitTest.java
index 1eda20c8d5..e89c4ad3d0 100644
--- a/tests/carservice_unit_test/src/android/car/oem/OemCarAudioVolumeRequestUnitTest.java
+++ b/tests/CarLibUnitTest/src/android/car/oem/OemCarAudioVolumeRequestUnitTest.java
@@ -29,8 +29,6 @@ import android.media.AudioAttributes;
 import android.os.Parcel;
 import android.telephony.TelephonyManager;
 
-import com.android.car.audio.CarAudioContext;
-
 import org.junit.Test;
 
 import java.util.List;
@@ -60,11 +58,11 @@ public final class OemCarAudioVolumeRequestUnitTest extends AbstractExpectableTe
                     .setMinActivationVolumeGainIndex(TEST_MIN_ACTIVATION_GAIN_INDEX).build();
 
     private static final AudioAttributes TEST_MEDIA_ATTRIBUTE =
-            CarAudioContext.getAudioAttributeFromUsage(USAGE_MEDIA);
+            new AudioAttributes.Builder().setUsage(USAGE_MEDIA).build();
     private static final AudioAttributes TEST_NAVIGATION_ATTRIBUTE =
-            CarAudioContext.getAudioAttributeFromUsage(USAGE_ASSISTANCE_NAVIGATION_GUIDANCE);
+            new AudioAttributes.Builder().setUsage(USAGE_ASSISTANCE_NAVIGATION_GUIDANCE).build();
     private static final AudioAttributes TEST_ASSISTANT_ATTRIBUTE =
-            CarAudioContext.getAudioAttributeFromUsage(USAGE_ASSISTANT);
+            new AudioAttributes.Builder().setUsage(USAGE_ASSISTANT).build();
 
     private static final OemCarAudioVolumeRequest TEST_VOLUME_REQUEST =
             new OemCarAudioVolumeRequest.Builder(PRIMARY_AUDIO_ZONE)
diff --git a/tests/carservice_unit_test/src/android/car/oem/OemCarServiceTest.java b/tests/CarLibUnitTest/src/android/car/oem/OemCarServiceTest.java
similarity index 94%
rename from tests/carservice_unit_test/src/android/car/oem/OemCarServiceTest.java
rename to tests/CarLibUnitTest/src/android/car/oem/OemCarServiceTest.java
index 24169b9506..262bf8ece7 100644
--- a/tests/carservice_unit_test/src/android/car/oem/OemCarServiceTest.java
+++ b/tests/CarLibUnitTest/src/android/car/oem/OemCarServiceTest.java
@@ -22,17 +22,25 @@ import static com.google.common.truth.Truth.assertWithMessage;
 import static org.junit.Assert.assertThrows;
 
 import android.car.CarVersion;
-import android.car.test.mocks.AbstractExtendedMockitoTestCase;
 import android.content.pm.PackageManager;
+import android.platform.test.annotations.DisabledOnRavenwood;
+import android.platform.test.ravenwood.RavenwoodClassRule;
 
 import androidx.annotation.NonNull;
 
 import com.android.internal.annotations.GuardedBy;
 
+import org.junit.ClassRule;
 import org.junit.Test;
+import org.junit.runner.RunWith;
 import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnitRunner;
 
-public final class OemCarServiceTest extends AbstractExtendedMockitoTestCase {
+@DisabledOnRavenwood(blockedBy = android.app.Service.class)
+@RunWith(MockitoJUnitRunner.class)
+public final class OemCarServiceTest {
+    @ClassRule
+    public static final RavenwoodClassRule sRavenwood = new RavenwoodClassRule();
 
     private final CarVersion mCarVersionForTesting = CarVersion.VERSION_CODES.UPSIDE_DOWN_CAKE_0;
 
diff --git a/tests/carservice_unit_test/src/android/car/oem/OemCarVolumeChangeInfoUnitTest.java b/tests/CarLibUnitTest/src/android/car/oem/OemCarVolumeChangeInfoUnitTest.java
similarity index 74%
rename from tests/carservice_unit_test/src/android/car/oem/OemCarVolumeChangeInfoUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/oem/OemCarVolumeChangeInfoUnitTest.java
index 4dd1877321..e3b4598a6c 100644
--- a/tests/carservice_unit_test/src/android/car/oem/OemCarVolumeChangeInfoUnitTest.java
+++ b/tests/CarLibUnitTest/src/android/car/oem/OemCarVolumeChangeInfoUnitTest.java
@@ -18,23 +18,39 @@ package android.car.oem;
 
 import static org.junit.Assert.assertThrows;
 
+import android.car.feature.Flags;
 import android.car.media.CarVolumeGroupInfo;
 import android.car.test.AbstractExpectableTestCase;
 import android.os.Parcel;
+import android.platform.test.annotations.EnableFlags;
+import android.platform.test.flag.junit.SetFlagsRule;
 
+import org.junit.ClassRule;
+import org.junit.Rule;
 import org.junit.Test;
 
+@EnableFlags({
+        Flags.FLAG_CAR_AUDIO_MIN_MAX_ACTIVATION_VOLUME,
+        Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES,
+        Flags.FLAG_CAR_AUDIO_MUTE_AMBIGUITY
+})
 public final class OemCarVolumeChangeInfoUnitTest extends AbstractExpectableTestCase {
+    @ClassRule public static final SetFlagsRule.ClassRule mClassRule = new SetFlagsRule.ClassRule();
+    @Rule public final SetFlagsRule mSetFlagsRule = mClassRule.createSetFlagsRule();
 
     private static final int TEST_ZONE_ID = 8;
     private static final int TEST_PRIMARY_GROUP_ID = 7;
     private static final String TEST_GROUP_NAME = "3";
 
-    private static final CarVolumeGroupInfo TEST_VOLUME_INFO =
-            new CarVolumeGroupInfo.Builder(TEST_GROUP_NAME, TEST_ZONE_ID, TEST_PRIMARY_GROUP_ID)
-                    .setMaxVolumeGainIndex(9_000).setMinVolumeGainIndex(0)
-                    .setMaxActivationVolumeGainIndex(8_000).setMinActivationVolumeGainIndex(100)
-                    .build();
+    private final CarVolumeGroupInfo mTestVolumeInfo;
+
+    public OemCarVolumeChangeInfoUnitTest() {
+        mTestVolumeInfo = new CarVolumeGroupInfo.Builder(TEST_GROUP_NAME, TEST_ZONE_ID,
+                TEST_PRIMARY_GROUP_ID)
+                .setMaxVolumeGainIndex(9_000).setMinVolumeGainIndex(0)
+                .setMaxActivationVolumeGainIndex(8_000).setMinActivationVolumeGainIndex(100)
+                .build();
+    }
 
     @Test
     public void build() {
@@ -49,10 +65,10 @@ public final class OemCarVolumeChangeInfoUnitTest extends AbstractExpectableTest
     public void setChangedVolumeGroup() {
         OemCarVolumeChangeInfo info =
                 new OemCarVolumeChangeInfo.Builder(/* volumeChanged= */ false)
-                        .setChangedVolumeGroup(TEST_VOLUME_INFO).build();
+                        .setChangedVolumeGroup(mTestVolumeInfo).build();
 
         expectWithMessage("Car volume change build changed volume")
-                .that(info.getChangedVolumeGroup()).isEqualTo(TEST_VOLUME_INFO);
+                .that(info.getChangedVolumeGroup()).isEqualTo(mTestVolumeInfo);
     }
 
 
@@ -94,10 +110,10 @@ public final class OemCarVolumeChangeInfoUnitTest extends AbstractExpectableTest
     public void equals_forSameContent() {
         OemCarVolumeChangeInfo info =
                 new OemCarVolumeChangeInfo.Builder(/* volumeChanged= */ false)
-                        .setChangedVolumeGroup(TEST_VOLUME_INFO).build();
+                        .setChangedVolumeGroup(mTestVolumeInfo).build();
         OemCarVolumeChangeInfo info2 =
                 new OemCarVolumeChangeInfo.Builder(/* volumeChanged= */ false)
-                        .setChangedVolumeGroup(TEST_VOLUME_INFO).build();
+                        .setChangedVolumeGroup(mTestVolumeInfo).build();
 
         expectWithMessage("Car volume change with same content").that(info2).isEqualTo(info);
     }
@@ -106,10 +122,10 @@ public final class OemCarVolumeChangeInfoUnitTest extends AbstractExpectableTest
     public void equals_forDifferentContent() {
         OemCarVolumeChangeInfo info =
                 new OemCarVolumeChangeInfo.Builder(/* volumeChanged= */ true)
-                        .setChangedVolumeGroup(TEST_VOLUME_INFO).build();
+                        .setChangedVolumeGroup(mTestVolumeInfo).build();
         OemCarVolumeChangeInfo info2 =
                 new OemCarVolumeChangeInfo.Builder(/* volumeChanged= */ false)
-                        .setChangedVolumeGroup(TEST_VOLUME_INFO).build();
+                        .setChangedVolumeGroup(mTestVolumeInfo).build();
 
         expectWithMessage("Car volume change with different content").that(info2)
                 .isNotEqualTo(info);
@@ -119,7 +135,7 @@ public final class OemCarVolumeChangeInfoUnitTest extends AbstractExpectableTest
     public void equals_forNull() {
         OemCarVolumeChangeInfo info =
                 new OemCarVolumeChangeInfo.Builder(/* volumeChanged= */ false)
-                        .setChangedVolumeGroup(TEST_VOLUME_INFO).build();
+                        .setChangedVolumeGroup(mTestVolumeInfo).build();
 
         expectWithMessage("Car volume change equal for null").that(info.equals(null)).isFalse();
     }
@@ -128,10 +144,10 @@ public final class OemCarVolumeChangeInfoUnitTest extends AbstractExpectableTest
     public void hashCode_forSameContent() {
         OemCarVolumeChangeInfo info =
                 new OemCarVolumeChangeInfo.Builder(/* volumeChanged= */ false)
-                        .setChangedVolumeGroup(TEST_VOLUME_INFO).build();
+                        .setChangedVolumeGroup(mTestVolumeInfo).build();
         OemCarVolumeChangeInfo info2 =
                 new OemCarVolumeChangeInfo.Builder(/* volumeChanged= */ false)
-                        .setChangedVolumeGroup(TEST_VOLUME_INFO).build();
+                        .setChangedVolumeGroup(mTestVolumeInfo).build();
 
         expectWithMessage("Car volume change hash with same content")
                 .that(info2.hashCode()).isEqualTo(info.hashCode());
diff --git a/tests/carservice_unit_test/src/android/car/oem/OemFocusUtils.java b/tests/CarLibUnitTest/src/android/car/oem/OemFocusUtils.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/oem/OemFocusUtils.java
rename to tests/CarLibUnitTest/src/android/car/oem/OemFocusUtils.java
diff --git a/tests/carservice_unit_test/src/android/car/os/CarPerformanceManagerUnitTest.java b/tests/CarLibUnitTest/src/android/car/os/CarPerformanceManagerUnitTest.java
similarity index 92%
rename from tests/carservice_unit_test/src/android/car/os/CarPerformanceManagerUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/os/CarPerformanceManagerUnitTest.java
index 3c85a5355d..6896398d9e 100644
--- a/tests/carservice_unit_test/src/android/car/os/CarPerformanceManagerUnitTest.java
+++ b/tests/CarLibUnitTest/src/android/car/os/CarPerformanceManagerUnitTest.java
@@ -34,17 +34,23 @@ import android.os.IBinder;
 import android.os.Looper;
 import android.os.RemoteException;
 import android.os.ServiceSpecificException;
+import android.platform.test.ravenwood.RavenwoodRule;
 
 import org.junit.Before;
+import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.mockito.Mock;
 import org.mockito.junit.MockitoJUnitRunner;
 
-@RunWith(MockitoJUnitRunner.class)
+@RunWith(MockitoJUnitRunner.Silent.class)
 public final class CarPerformanceManagerUnitTest {
 
-    private final Handler mMainHandler = new Handler(Looper.getMainLooper());
+    @Rule
+    public final RavenwoodRule mRavenwood = new RavenwoodRule.Builder().setProvideMainThread(true)
+            .build();
+
+    private Handler mMainHandler;
 
     @Mock private Context mContext;
     @Mock private Car mCar;
@@ -55,6 +61,8 @@ public final class CarPerformanceManagerUnitTest {
 
     @Before
     public void setUp() {
+        mMainHandler = new Handler(Looper.getMainLooper());
+
         when(mCar.getContext()).thenReturn(mContext);
         when(mCar.getEventHandler()).thenReturn(mMainHandler);
         when(mCar.handleRemoteExceptionFromCarService(any(RemoteException.class), any()))
diff --git a/tests/carservice_unit_test/src/android/car/os/ThreadPolicyWithPriorityUnitTest.java b/tests/CarLibUnitTest/src/android/car/os/ThreadPolicyWithPriorityUnitTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/os/ThreadPolicyWithPriorityUnitTest.java
rename to tests/CarLibUnitTest/src/android/car/os/ThreadPolicyWithPriorityUnitTest.java
diff --git a/tests/carservice_unit_test/src/android/car/util/concurrent/AndroidAsyncFutureTest.java b/tests/CarLibUnitTest/src/android/car/util/concurrent/AndroidAsyncFutureTest.java
similarity index 76%
rename from tests/carservice_unit_test/src/android/car/util/concurrent/AndroidAsyncFutureTest.java
rename to tests/CarLibUnitTest/src/android/car/util/concurrent/AndroidAsyncFutureTest.java
index e2722cae33..bd27cdf073 100644
--- a/tests/carservice_unit_test/src/android/car/util/concurrent/AndroidAsyncFutureTest.java
+++ b/tests/CarLibUnitTest/src/android/car/util/concurrent/AndroidAsyncFutureTest.java
@@ -15,25 +15,23 @@
  */
 package android.car.util.concurrent;
 
-import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
-
 import static com.google.common.truth.Truth.assertThat;
 
 import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.when;
 
-import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
 import org.mockito.Mock;
-import org.mockito.Mockito;
 import org.mockito.MockitoSession;
-import org.mockito.quality.Strictness;
+import org.mockito.junit.MockitoJUnitRunner;
 
 import java.util.concurrent.Executor;
 import java.util.concurrent.TimeUnit;
 import java.util.function.BiConsumer;
 
+@RunWith(MockitoJUnitRunner.class)
 public final class AndroidAsyncFutureTest {
 
     @Mock
@@ -44,25 +42,10 @@ public final class AndroidAsyncFutureTest {
     private AndroidAsyncFuture<Integer> mAndroidAsyncFuture;
 
     @Before
-    public void setupMocks() {
-        mMockSession = mockitoSession()
-                .initMocks(this)
-                .strictness(Strictness.LENIENT)
-                .startMocking();
+    public void setup() {
         mAndroidAsyncFuture = new AndroidAsyncFuture<Integer>(mFuture);
     }
 
-    @After
-    public void tearDown() {
-        try {
-            mMockSession.finishMocking();
-        } finally {
-            // When using inline mock maker, clean up inline mocks to prevent OutOfMemory errors.
-            // See https://github.com/mockito/mockito/issues/1614 and b/259280359.
-            Mockito.framework().clearInlineMocks();
-        }
-    }
-
     @Test
     public void testGet() throws Exception {
         Integer input = 0;
diff --git a/tests/carservice_unit_test/src/android/car/util/concurrent/AndroidFutureTest.java b/tests/CarLibUnitTest/src/android/car/util/concurrent/AndroidFutureTest.java
similarity index 94%
rename from tests/carservice_unit_test/src/android/car/util/concurrent/AndroidFutureTest.java
rename to tests/CarLibUnitTest/src/android/car/util/concurrent/AndroidFutureTest.java
index 5935d3e1b6..d30eaec361 100644
--- a/tests/carservice_unit_test/src/android/car/util/concurrent/AndroidFutureTest.java
+++ b/tests/CarLibUnitTest/src/android/car/util/concurrent/AndroidFutureTest.java
@@ -23,7 +23,11 @@ import static org.junit.Assert.assertThrows;
 import static java.util.concurrent.TimeUnit.MILLISECONDS;
 
 import android.os.Parcel;
+import android.platform.test.annotations.DisabledOnRavenwood;
+import android.platform.test.ravenwood.RavenwoodRule;
 
+import org.junit.Before;
+import org.junit.Rule;
 import org.junit.Test;
 
 import java.util.concurrent.CountDownLatch;
@@ -32,17 +36,26 @@ import java.util.concurrent.TimeoutException;
 import java.util.function.BiFunction;
 
 public final class AndroidFutureTest {
+    @Rule
+    public final RavenwoodRule mRavenwood = new RavenwoodRule.Builder().setProvideMainThread(true)
+            .build();
 
     private static final String STRING_VALUE = "test-future-string";
     private static final String EXCEPTION_MESSAGE = "An exception was thrown!";
     private static final long TIMEOUT_MS = 100;
 
-    private AndroidFuture<String> mUncompletedFuture = new AndroidFuture<>();
-    private AndroidFuture<String> mCompletedFuture = AndroidFuture.completedFuture(STRING_VALUE);
+    private AndroidFuture<String> mUncompletedFuture;
+    private AndroidFuture<String> mCompletedFuture;
 
     private CountDownLatch mLatch = new CountDownLatch(1);
     private Parcel mParcel = Parcel.obtain();
 
+    @Before
+    public void setup() {
+        mUncompletedFuture = new AndroidFuture<>();
+        mCompletedFuture = AndroidFuture.completedFuture(STRING_VALUE);
+    }
+
     @Test
     public void testComplete_uncompleted() throws Exception {
         boolean changed = mUncompletedFuture.complete(STRING_VALUE);
@@ -206,6 +219,7 @@ public final class AndroidFutureTest {
         assertThat(thrown.getMessage()).contains(EXCEPTION_MESSAGE);
     }
 
+    @DisabledOnRavenwood(reason = "android.os.Parcel.writeStronBinder not supported")
     @Test
     public void testWriteToParcel_uncompleted() throws Exception {
         mUncompletedFuture.writeToParcel(mParcel, /* flags= */0);
@@ -217,6 +231,7 @@ public final class AndroidFutureTest {
         assertThat(mUncompletedFuture.get()).isEqualTo(STRING_VALUE);
     }
 
+    @DisabledOnRavenwood(reason = "android.os.Parcel.writeStronBinder not supported")
     @Test
     public void testWriteToParcel_uncompleted_Exception() throws Exception {
         mUncompletedFuture.writeToParcel(mParcel, /* flags= */0);
diff --git a/tests/carservice_unit_test/src/android/car/vms/VmsSubscriptionHelperTest.java b/tests/CarLibUnitTest/src/android/car/vms/VmsSubscriptionHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/vms/VmsSubscriptionHelperTest.java
rename to tests/CarLibUnitTest/src/android/car/vms/VmsSubscriptionHelperTest.java
diff --git a/tests/carservice_unit_test/src/android/car/userlib/UserHelperLiteTest.java b/tests/CarLibUnitTest/src/com/android/car/internal/common/UserHelperLiteTest.java
similarity index 64%
rename from tests/carservice_unit_test/src/android/car/userlib/UserHelperLiteTest.java
rename to tests/CarLibUnitTest/src/com/android/car/internal/common/UserHelperLiteTest.java
index 5fce76b6f8..e1d910d11c 100644
--- a/tests/carservice_unit_test/src/android/car/userlib/UserHelperLiteTest.java
+++ b/tests/CarLibUnitTest/src/com/android/car/internal/common/UserHelperLiteTest.java
@@ -14,28 +14,18 @@
  * limitations under the License.
  */
 
-package android.car.userlib;
+package com.android.car.internal.common;
 
 import static com.google.common.truth.Truth.assertThat;
 
-import android.car.test.mocks.AbstractExtendedMockitoTestCase;
 import android.os.UserHandle;
-import android.os.UserManager;
-
-import com.android.car.internal.common.UserHelperLite;
 
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.junit.MockitoJUnitRunner;
 
-public final class UserHelperLiteTest extends AbstractExtendedMockitoTestCase {
-
-    public UserHelperLiteTest() {
-        super(NO_LOG_TAGS);
-    }
-
-    @Override
-    protected void onSessionBuilder(CustomMockitoSessionBuilder session) {
-        session.spyStatic(UserManager.class);
-    }
+@RunWith(MockitoJUnitRunner.class)
+public final class UserHelperLiteTest {
 
     @Test
     public void testSafeName_nullCheck() {
@@ -52,29 +42,21 @@ public final class UserHelperLiteTest extends AbstractExtendedMockitoTestCase {
 
     @Test
     public void testIsHeadlessSystemUser_system_headlessMode() {
-        mockIsHeadlessSystemUserMode(true);
-
-        assertThat(UserHelperLite.isHeadlessSystemUser(UserHandle.USER_SYSTEM)).isTrue();
+        assertThat(UserHelperLite.isHeadlessSystemUser(UserHandle.USER_SYSTEM, true)).isTrue();
     }
 
     @Test
     public void testIsHeadlessSystemUser_system_nonHeadlessMode() {
-        mockIsHeadlessSystemUserMode(false);
-
-        assertThat(UserHelperLite.isHeadlessSystemUser(UserHandle.USER_SYSTEM)).isFalse();
+        assertThat(UserHelperLite.isHeadlessSystemUser(UserHandle.USER_SYSTEM, false)).isFalse();
     }
 
     @Test
     public void testIsHeadlessSystemUser_nonSystem_headlessMode() {
-        mockIsHeadlessSystemUserMode(true);
-
-        assertThat(UserHelperLite.isHeadlessSystemUser(10)).isFalse();
+        assertThat(UserHelperLite.isHeadlessSystemUser(10, true)).isFalse();
     }
 
     @Test
     public void testIsHeadlessSystemUser_nonSystem_nonHeadlessMode() {
-        mockIsHeadlessSystemUserMode(false);
-
-        assertThat(UserHelperLite.isHeadlessSystemUser(10)).isFalse();
+        assertThat(UserHelperLite.isHeadlessSystemUser(10, false)).isFalse();
     }
 }
diff --git a/tests/CarServiceTest/Android.bp b/tests/CarServiceTest/Android.bp
new file mode 100644
index 0000000000..614c4e07ca
--- /dev/null
+++ b/tests/CarServiceTest/Android.bp
@@ -0,0 +1,336 @@
+// Copyright (C) 2015 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+//
+//
+
+package {
+    default_team: "trendy_team_aaos_framework",
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+java_defaults {
+    name: "CarServiceTestDefaults",
+
+    resource_dirs: ["res"],
+
+    srcs: ["dep/src/**/*.java"],
+
+    aaptflags: [
+        "--extra-packages com.android.car",
+        "--auto-add-overlay",
+    ],
+
+    platform_apis: true,
+
+    // for system|privileged permission.
+    certificate: "platform",
+
+    // When built explicitly put it in the data partition
+
+    optimize: {
+        enabled: false,
+    },
+
+    static_libs: [
+        "junit",
+        "android.car.test.utils",
+        "android.car.testapi",
+        "androidx.test.ext.junit",
+        "androidx.test.rules",
+        "android.frameworks.automotive.powerpolicy-V3-java",
+        "android.hardware.automotive.vehicle-V2.0-java",
+        "car-service-test-static-lib",
+        "car-service-builtin-test-static-lib",
+        "com.android.car.test.lib",
+        "mockito-target-extended",
+        "truth",
+        "compatibility-device-util-axt",
+        "vehicle-hal-support-lib",
+    ],
+
+    libs: [
+        "android.car",
+        "android.car.watchdoglib",
+        "android.test.runner.stubs.system",
+        "android.test.base.stubs.system",
+    ],
+
+    // mockito-target-inline dependency
+    jni_libs: [
+        "libdexmakerjvmtiagent",
+        "libstaticjvmtiagent",
+        "libcarservicejni",
+    ],
+
+    test_suites: [
+        "device-tests",
+        "automotive-tests",
+    ],
+    // TODO(b/319708040): re-enable use_resource_processor
+    use_resource_processor: false,
+}
+
+android_test {
+    name: "CarServiceCarTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/ICarImplTest.java",
+        "src/com/android/car/CarFeatureControllerTest.java",
+        "src/com/android/car/AppFocusTest.java",
+        "src/com/android/car/CarAppFocusManagerTest.java",
+        "src/com/android/car/CarProjectionManagerTest.java",
+        "src/com/android/car/CarVendorExtensionManagerTest.java",
+    ],
+
+    test_config: "AndroidTest_CarTest.xml",
+}
+
+android_test {
+    name: "CarServiceDrivingStateTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/drivingstate/*.java",
+    ],
+
+    test_config: "AndroidTest_DrivingStateTest.xml",
+}
+
+android_test {
+    name: "CarServicePropertyTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/CarCabinManagerTest.java",
+        "src/com/android/car/CarHvacManagerTest.java",
+        "src/com/android/car/CarInfoManagerTest.java",
+        "src/com/android/car/CarPropertyEventTest.java",
+        "src/com/android/car/CarPropertyManagerTest.java",
+        "src/com/android/car/CarPropertyServiceTest.java",
+        "src/com/android/car/CarSensorManagerTest.java",
+    ],
+
+    test_config: "AndroidTest_PropertyTest.xml",
+}
+
+android_test {
+    name: "CarServiceDiagnosticTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/diagnostic/*.java",
+    ],
+
+    test_config: "AndroidTest_DiagnosticTest.xml",
+}
+
+android_test {
+    name: "CarServiceStorageMonitoringTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/storagemonitoring/*.java",
+    ],
+
+    test_config: "AndroidTest_StorageMonitoringTest.xml",
+
+    manifest: "AndroidManifest_StorageMonitoringTest.xml",
+}
+
+android_test {
+    name: "CarServiceVmsTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/vms/*.java",
+    ],
+
+    test_config: "AndroidTest_VmsTest.xml",
+}
+
+android_test {
+    name: "CarServiceTelemetryTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/telemetry/*.java",
+    ],
+
+    test_config: "AndroidTest_TelemetryTest.xml",
+}
+
+android_test {
+    name: "CarServiceAudioTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/audio/*.java",
+    ],
+
+    test_config: "AndroidTest_AudioTest.xml",
+}
+
+android_test {
+    name: "CarServicePowerTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/power/*.java",
+    ],
+
+    test_config: "AndroidTest_PowerTest.xml",
+}
+
+android_test {
+    name: "CarServiceInputTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/input/*.java",
+    ],
+
+    test_config: "AndroidTest_InputTest.xml",
+}
+
+android_test {
+    name: "CarServiceRemoteAccessTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/remoteaccess/*.java",
+    ],
+
+    test_config: "AndroidTest_RemoteAccessTest.xml",
+}
+
+android_test {
+    name: "CarServiceGarageModeTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/garagemode/*.java",
+    ],
+
+    test_config: "AndroidTest_GarageModeTest.xml",
+}
+
+android_test {
+    name: "CarServiceOsTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/os/*.java",
+    ],
+
+    test_config: "AndroidTest_OsTest.xml",
+}
+
+android_test {
+    name: "CarServiceClusterTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/cluster/*.java",
+    ],
+
+    test_config: "AndroidTest_ClusterTest.xml",
+}
+
+android_test {
+    name: "CarServiceWatchdogTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/watchdog/*.java",
+    ],
+
+    test_config: "AndroidTest_WatchdogTest.xml",
+}
+
+android_test {
+    name: "CarServicePmTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "dep/CarAppActivity/**/*.java",
+        "src/com/android/car/pm/*.java",
+    ],
+
+    test_config: "AndroidTest_PmTest.xml",
+
+    manifest: "AndroidManifest_PmTest.xml",
+}
+
+android_test {
+    name: "CarServiceEvsTest",
+
+    defaults: [
+        "CarServiceTestDefaults",
+    ],
+
+    srcs: [
+        "src/com/android/car/evs/*.java",
+    ],
+
+    test_config: "AndroidTest_EvsTest.xml",
+}
diff --git a/tests/CarServiceTest/AndroidManifest.xml b/tests/CarServiceTest/AndroidManifest.xml
new file mode 100644
index 0000000000..543a2991fa
--- /dev/null
+++ b/tests/CarServiceTest/AndroidManifest.xml
@@ -0,0 +1,54 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2015 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+     package="com.android.car.test"
+     android:sharedUserId="com.google.android.car.uid.kitchensink">
+    <uses-permission android:name="android.Manifest.permission.MODIFY_AUDIO_ROUTING"/>
+    <uses-permission android:name="android.car.permission.ACCESS_PRIVATE_DISPLAY_ID"/>
+    <uses-permission android:name="android.car.permission.MANAGE_THREAD_PRIORITY"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_CLIMATE"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_DOORS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_WINDOWS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_MIRRORS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_SEATS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_ENERGY_PORTS"/>
+    <uses-permission android:name="android.car.permission.CAR_ENERGY"/>
+    <uses-permission android:name="android.car.permission.CAR_EPOCH_TIME"/>
+    <uses-permission android:name="android.car.permission.CAR_SPEED"/>
+    <uses-permission android:name="android.car.permission.CONTROL_APP_BLOCKING"/>
+    <uses-permission android:name="android.car.permission.CAR_CONTROL_AUDIO_VOLUME"/>
+    <uses-permission android:name="android.car.permission.CAR_CONTROL_AUDIO_SETTINGS"/>
+    <uses-permission android:name="android.car.permission.CAR_MONITOR_INPUT"/>
+    <uses-permission android:name="android.car.permission.STORAGE_MONITORING"/>
+    <uses-permission android:name="android.car.permission.READ_CAR_OCCUPANT_AWARENESS_STATE"/>
+    <uses-permission android:name="android.car.permission.READ_CAR_POWER_POLICY"/>
+    <uses-permission android:name="android.car.permission.CONTROL_SHUTDOWN_PROCESS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_POWER_POLICY"/>
+    <uses-permission android:name="android.car.permission.GET_CAR_VENDOR_CATEGORY_1"/>
+    <uses-permission android:name="android.car.permission.SET_CAR_VENDOR_CATEGORY_1"/>
+    <uses-permission android:name="android.car.permission.CAR_TIRES"/>
+
+    <instrumentation android:name="androidx.test.runner.AndroidJUnitRunner"
+         android:targetPackage="com.android.car.test"
+         android:label="Tests for Car APIs"/>
+
+    <application android:label="@string/app_title"
+        android:debuggable="true"
+        android:testOnly="true">
+        <uses-library android:name="android.test.runner"/>
+    </application>
+</manifest>
diff --git a/tests/carservice_test/AndroidManifest.xml b/tests/CarServiceTest/AndroidManifest_PmTest.xml
similarity index 91%
rename from tests/carservice_test/AndroidManifest.xml
rename to tests/CarServiceTest/AndroidManifest_PmTest.xml
index 6101a623e8..00d209774c 100644
--- a/tests/carservice_test/AndroidManifest.xml
+++ b/tests/CarServiceTest/AndroidManifest_PmTest.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2015 The Android Open Source Project
+<!-- Copyright (C) 2024 The Android Open Source Project
 
      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
@@ -67,6 +67,12 @@
             <meta-data android:name="distractionOptimized"
                  android:value="true"/>
         </activity>
+        <activity android:name="com.android.car.pm.CarPackageManagerServiceTest$DoTranslucentActivity"
+            android:theme="@android:style/Theme.Translucent.NoTitleBar"
+            android:label="DoTranslucentActivity">
+            <meta-data android:name="distractionOptimized"
+                android:value="true"/>
+        </activity>
         <activity android:name="androidx.car.app.activity.CarAppActivity"
             android:label="CarAppActivity">
             <meta-data android:name="distractionOptimized"
diff --git a/tests/CarServiceTest/AndroidManifest_StorageMonitoringTest.xml b/tests/CarServiceTest/AndroidManifest_StorageMonitoringTest.xml
new file mode 100644
index 0000000000..2b35c95bb5
--- /dev/null
+++ b/tests/CarServiceTest/AndroidManifest_StorageMonitoringTest.xml
@@ -0,0 +1,61 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+     package="com.android.car.test"
+     android:sharedUserId="com.google.android.car.uid.kitchensink">
+    <uses-permission android:name="android.Manifest.permission.MODIFY_AUDIO_ROUTING"/>
+    <uses-permission android:name="android.car.permission.ACCESS_PRIVATE_DISPLAY_ID"/>
+    <uses-permission android:name="android.car.permission.MANAGE_THREAD_PRIORITY"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_CLIMATE"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_DOORS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_WINDOWS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_MIRRORS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_SEATS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_ENERGY_PORTS"/>
+    <uses-permission android:name="android.car.permission.CAR_ENERGY"/>
+    <uses-permission android:name="android.car.permission.CAR_EPOCH_TIME"/>
+    <uses-permission android:name="android.car.permission.CAR_SPEED"/>
+    <uses-permission android:name="android.car.permission.CONTROL_APP_BLOCKING"/>
+    <uses-permission android:name="android.car.permission.CAR_CONTROL_AUDIO_VOLUME"/>
+    <uses-permission android:name="android.car.permission.CAR_CONTROL_AUDIO_SETTINGS"/>
+    <uses-permission android:name="android.car.permission.CAR_MONITOR_INPUT"/>
+    <uses-permission android:name="android.car.permission.STORAGE_MONITORING"/>
+    <uses-permission android:name="android.car.permission.READ_CAR_OCCUPANT_AWARENESS_STATE"/>
+    <uses-permission android:name="android.car.permission.READ_CAR_POWER_POLICY"/>
+    <uses-permission android:name="android.car.permission.CONTROL_SHUTDOWN_PROCESS"/>
+    <uses-permission android:name="android.car.permission.CONTROL_CAR_POWER_POLICY"/>
+    <uses-permission android:name="android.car.permission.GET_CAR_VENDOR_CATEGORY_1"/>
+    <uses-permission android:name="android.car.permission.SET_CAR_VENDOR_CATEGORY_1"/>
+    <uses-permission android:name="android.car.permission.CAR_TIRES"/>
+
+    <instrumentation android:name="androidx.test.runner.AndroidJUnitRunner"
+         android:targetPackage="com.android.car.test"
+         android:label="Tests for Car APIs"/>
+
+    <application android:label="@string/app_title"
+        android:debuggable="true"
+        android:testOnly="true">
+        <uses-library android:name="android.test.runner"/>
+        <receiver android:name="com.android.car.CarStorageMonitoringBroadcastReceiver"
+            android:exported="true"
+            android:permission="android.car.permission.STORAGE_MONITORING">
+            <intent-filter>
+                <action android:name="android.car.storagemonitoring.EXCESSIVE_IO"/>
+            </intent-filter>
+        </receiver>
+    </application>
+</manifest>
diff --git a/tests/CarServiceTest/AndroidTest_AudioTest.xml b/tests/CarServiceTest/AndroidTest_AudioTest.xml
new file mode 100644
index 0000000000..24fcd6f476
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_AudioTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceAudioTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_CarTest.xml b/tests/CarServiceTest/AndroidTest_CarTest.xml
new file mode 100644
index 0000000000..57640dbc3a
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_CarTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceCarTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_ClusterTest.xml b/tests/CarServiceTest/AndroidTest_ClusterTest.xml
new file mode 100644
index 0000000000..2d704d2cb9
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_ClusterTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceClusterTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_DiagnosticTest.xml b/tests/CarServiceTest/AndroidTest_DiagnosticTest.xml
new file mode 100644
index 0000000000..89a3d7d658
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_DiagnosticTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceDiagnosticTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_DrivingStateTest.xml b/tests/CarServiceTest/AndroidTest_DrivingStateTest.xml
new file mode 100644
index 0000000000..45169436ba
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_DrivingStateTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceDrivingStateTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_EvsTest.xml b/tests/CarServiceTest/AndroidTest_EvsTest.xml
new file mode 100644
index 0000000000..28ffe6a9d7
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_EvsTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceEvsTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_GarageModeTest.xml b/tests/CarServiceTest/AndroidTest_GarageModeTest.xml
new file mode 100644
index 0000000000..61688af337
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_GarageModeTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceGarageModeTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_InputTest.xml b/tests/CarServiceTest/AndroidTest_InputTest.xml
new file mode 100644
index 0000000000..bdb853d5c1
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_InputTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceInputTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/carservice_test/AndroidTest.xml b/tests/CarServiceTest/AndroidTest_OsTest.xml
similarity index 94%
rename from tests/carservice_test/AndroidTest.xml
rename to tests/CarServiceTest/AndroidTest_OsTest.xml
index 75b815fec9..e3d8d61fa2 100644
--- a/tests/carservice_test/AndroidTest.xml
+++ b/tests/CarServiceTest/AndroidTest_OsTest.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2022 The Android Open Source Project
+  ~ Copyright (C) 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
@@ -26,7 +26,7 @@
     <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
         <option name="cleanup-apks" value="true" />
         <option name="install-arg" value="-t" />
-        <option name="test-file-name" value="CarServiceTest.apk" />
+        <option name="test-file-name" value="CarServiceOsTest.apk" />
     </target_preparer>
     <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
         <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
diff --git a/tests/CarServiceTest/AndroidTest_PmTest.xml b/tests/CarServiceTest/AndroidTest_PmTest.xml
new file mode 100644
index 0000000000..850a6bd1f4
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_PmTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServicePmTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_PowerTest.xml b/tests/CarServiceTest/AndroidTest_PowerTest.xml
new file mode 100644
index 0000000000..51df8bf564
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_PowerTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServicePowerTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_PropertyTest.xml b/tests/CarServiceTest/AndroidTest_PropertyTest.xml
new file mode 100644
index 0000000000..23cfa5a2d9
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_PropertyTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServicePropertyTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_RemoteAccessTest.xml b/tests/CarServiceTest/AndroidTest_RemoteAccessTest.xml
new file mode 100644
index 0000000000..ec833e30fb
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_RemoteAccessTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceRemoteAccessTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_StorageMonitoringTest.xml b/tests/CarServiceTest/AndroidTest_StorageMonitoringTest.xml
new file mode 100644
index 0000000000..b430ee4391
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_StorageMonitoringTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceStorageMonitoringTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_TelemetryTest.xml b/tests/CarServiceTest/AndroidTest_TelemetryTest.xml
new file mode 100644
index 0000000000..2db69bc966
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_TelemetryTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceTelemetryTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_VmsTest.xml b/tests/CarServiceTest/AndroidTest_VmsTest.xml
new file mode 100644
index 0000000000..6ee31c50d3
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_VmsTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceVmsTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/CarServiceTest/AndroidTest_WatchdogTest.xml b/tests/CarServiceTest/AndroidTest_WatchdogTest.xml
new file mode 100644
index 0000000000..cb534a53a7
--- /dev/null
+++ b/tests/CarServiceTest/AndroidTest_WatchdogTest.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<configuration description="Car Service Tests">
+    <option name="config-descriptor:metadata" key="component" value="auto" />
+    <!-- Instant app do not have INTERNET permission. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_instant_app" />
+    <!-- Feature is not backed by native code. -->
+    <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
+    <!-- Allow running this against a secondary user. -->
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="cleanup-apks" value="true" />
+        <option name="install-arg" value="-t" />
+        <option name="test-file-name" value="CarServiceWatchdogTest.apk" />
+    </target_preparer>
+    <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
+        <option name="run-command" value="setprop log.tag.CAR.TEST VERBOSE" />
+        <!-- Can't find the way to specify the empty string in 'value', so set the highest level -->
+        <option name="teardown-command" value="setprop log.tag.CAR.TEST ASSERT" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.test" />
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner" />
+        <option name="hidden-api-checks" value="false" />
+    </test>
+</configuration>
diff --git a/tests/carservice_test/OWNERS b/tests/CarServiceTest/OWNERS
similarity index 100%
rename from tests/carservice_test/OWNERS
rename to tests/CarServiceTest/OWNERS
diff --git a/tests/carservice_test/src/androidx/car/app/activity/CarAppActivity.java b/tests/CarServiceTest/dep/CarAppActivity/androidx/car/app/activity/CarAppActivity.java
similarity index 100%
rename from tests/carservice_test/src/androidx/car/app/activity/CarAppActivity.java
rename to tests/CarServiceTest/dep/CarAppActivity/androidx/car/app/activity/CarAppActivity.java
diff --git a/tests/carservice_test/src/com/android/car/MockedCarTestBase.java b/tests/CarServiceTest/dep/src/com/android/car/MockedCarTestBase.java
similarity index 97%
rename from tests/carservice_test/src/com/android/car/MockedCarTestBase.java
rename to tests/CarServiceTest/dep/src/com/android/car/MockedCarTestBase.java
index 386018e193..371a97568c 100644
--- a/tests/carservice_test/src/com/android/car/MockedCarTestBase.java
+++ b/tests/CarServiceTest/dep/src/com/android/car/MockedCarTestBase.java
@@ -28,6 +28,7 @@ import static org.mockito.Mockito.mock;
 
 import android.automotive.powerpolicy.internal.ICarPowerPolicyDelegate;
 import android.car.Car;
+import android.car.ICarResultReceiver;
 import android.car.feature.Flags;
 import android.car.test.CarTestManager;
 import android.car.testapi.FakeRefactoredCarPowerPolicyDaemon;
@@ -42,6 +43,7 @@ import android.frameworks.automotive.powerpolicy.internal.ICarPowerPolicySystemN
 import android.hardware.automotive.vehicle.VehiclePropertyAccess;
 import android.hardware.automotive.vehicle.VehiclePropertyChangeMode;
 import android.os.Binder;
+import android.os.Bundle;
 import android.os.Handler;
 import android.os.IBinder;
 import android.os.IInterface;
@@ -65,14 +67,15 @@ import com.android.car.internal.ICarServiceHelper;
 import com.android.car.internal.StaticBinderInterface;
 import com.android.car.os.CarPerformanceService;
 import com.android.car.power.CarPowerManagementService;
+import com.android.car.provider.Settings;
 import com.android.car.systeminterface.ActivityManagerInterface;
-import com.android.car.systeminterface.DisplayInterface;
 import com.android.car.systeminterface.IOInterface;
 import com.android.car.systeminterface.StorageMonitoringInterface;
 import com.android.car.systeminterface.SystemInterface;
 import com.android.car.systeminterface.SystemStateInterface;
 import com.android.car.systeminterface.TimeInterface;
 import com.android.car.systeminterface.WakeLockInterface;
+import com.android.car.systeminterface.test.DisplayInterfaceEmptyImpl;
 import com.android.car.telemetry.CarTelemetryService;
 import com.android.car.test.utils.TemporaryDirectory;
 import com.android.car.user.CarUserService;
@@ -260,7 +263,8 @@ public class MockedCarTestBase {
                 .withIOInterface(mMockIOInterface)
                 .withStorageMonitoringInterface(new MockStorageMonitoringInterface())
                 .withTimeInterface(new MockTimeInterface())
-                .withWakeLockInterface(new MockWakeLockInterface());
+                .withWakeLockInterface(new MockWakeLockInterface())
+                .withSettings(new Settings.DefaultImpl());
     }
 
     protected SystemStateInterface createMockSystemStateInterface() {
@@ -309,6 +313,13 @@ public class MockedCarTestBase {
                 .startMocking();
     }
 
+    private static final class CarServiceConnectedCallback extends ICarResultReceiver.Stub {
+        @Override
+        public void send(int resultCode, Bundle resultData) {
+            Log.i(TAG, "CarServiceConnectedCallback.send(int resultCode, Bundle resultData)");
+        }
+    }
+
     @Before
     @UiThreadTest
     public void setUp() throws Exception {
@@ -402,7 +413,7 @@ public class MockedCarTestBase {
                 .build();
 
         carImpl.setSystemServerConnections(mICarServiceHelper,
-                new ICarImplTest.CarServiceConnectedCallback());
+                new CarServiceConnectedCallback());
         spyOnBeforeCarImplInit(carImpl);
         carImpl.init();
         mCarImpl = carImpl;
@@ -639,35 +650,7 @@ public class MockedCarTestBase {
         }
     }
 
-    static final class MockDisplayInterface implements DisplayInterface {
-
-        @Override
-        public void init(CarPowerManagementService carPowerManagementService,
-                CarUserService carUserService) {}
-
-        @Override
-        public void setDisplayBrightness(int brightness) {}
-
-        @Override
-        public void setDisplayBrightness(int displayId, int brightness) {}
-
-        @Override
-        public void setDisplayState(int displayId, boolean on) {}
-
-        @Override
-        public void setAllDisplayState(boolean on) {}
-
-        @Override
-        public void startDisplayStateMonitoring() {}
-
-        @Override
-        public void stopDisplayStateMonitoring() {}
-
-        @Override
-        public void refreshDisplayBrightness() {}
-
-        @Override
-        public void refreshDisplayBrightness(int displayid) {}
+    static final class MockDisplayInterface extends DisplayInterfaceEmptyImpl {
 
         @Override
         public boolean isAnyDisplayEnabled() {
diff --git a/tests/carservice_test/src/com/android/car/TestAppBlockingPolicyService.java b/tests/CarServiceTest/dep/src/com/android/car/TestAppBlockingPolicyService.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/TestAppBlockingPolicyService.java
rename to tests/CarServiceTest/dep/src/com/android/car/TestAppBlockingPolicyService.java
diff --git a/tests/carservice_test/src/com/android/car/hal/test/AidlMockedVehicleHal.java b/tests/CarServiceTest/dep/src/com/android/car/hal/test/AidlMockedVehicleHal.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/hal/test/AidlMockedVehicleHal.java
rename to tests/CarServiceTest/dep/src/com/android/car/hal/test/AidlMockedVehicleHal.java
diff --git a/tests/carservice_test/src/com/android/car/hal/test/HidlMockedVehicleHal.java b/tests/CarServiceTest/dep/src/com/android/car/hal/test/HidlMockedVehicleHal.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/hal/test/HidlMockedVehicleHal.java
rename to tests/CarServiceTest/dep/src/com/android/car/hal/test/HidlMockedVehicleHal.java
diff --git a/tests/carservice_test/src/com/android/car/test/CarServiceTestApp.java b/tests/CarServiceTest/dep/src/com/android/car/test/CarServiceTestApp.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/test/CarServiceTestApp.java
rename to tests/CarServiceTest/dep/src/com/android/car/test/CarServiceTestApp.java
diff --git a/tests/carservice_test/res/values/strings.xml b/tests/CarServiceTest/res/values/strings.xml
similarity index 100%
rename from tests/carservice_test/res/values/strings.xml
rename to tests/CarServiceTest/res/values/strings.xml
diff --git a/tests/carservice_test/src/com/android/car/AppFocusTest.java b/tests/CarServiceTest/src/com/android/car/AppFocusTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/AppFocusTest.java
rename to tests/CarServiceTest/src/com/android/car/AppFocusTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarAppFocusManagerTest.java b/tests/CarServiceTest/src/com/android/car/CarAppFocusManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarAppFocusManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarAppFocusManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarCabinManagerTest.java b/tests/CarServiceTest/src/com/android/car/CarCabinManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarCabinManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarCabinManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarFeatureControllerTest.java b/tests/CarServiceTest/src/com/android/car/CarFeatureControllerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarFeatureControllerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarFeatureControllerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarHvacManagerTest.java b/tests/CarServiceTest/src/com/android/car/CarHvacManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarHvacManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarHvacManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarInfoManagerTest.java b/tests/CarServiceTest/src/com/android/car/CarInfoManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarInfoManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarInfoManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarProjectionManagerTest.java b/tests/CarServiceTest/src/com/android/car/CarProjectionManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarProjectionManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarProjectionManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarPropertyEventTest.java b/tests/CarServiceTest/src/com/android/car/CarPropertyEventTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarPropertyEventTest.java
rename to tests/CarServiceTest/src/com/android/car/CarPropertyEventTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarPropertyManagerTest.java b/tests/CarServiceTest/src/com/android/car/CarPropertyManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarPropertyManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarPropertyManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarPropertyServiceTest.java b/tests/CarServiceTest/src/com/android/car/CarPropertyServiceTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarPropertyServiceTest.java
rename to tests/CarServiceTest/src/com/android/car/CarPropertyServiceTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarSensorManagerTest.java b/tests/CarServiceTest/src/com/android/car/CarSensorManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarSensorManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarSensorManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarVendorExtensionManagerTest.java b/tests/CarServiceTest/src/com/android/car/CarVendorExtensionManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/CarVendorExtensionManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/CarVendorExtensionManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/ICarImplTest.java b/tests/CarServiceTest/src/com/android/car/ICarImplTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/ICarImplTest.java
rename to tests/CarServiceTest/src/com/android/car/ICarImplTest.java
index 436e450943..02dd2279e6 100644
--- a/tests/carservice_test/src/com/android/car/ICarImplTest.java
+++ b/tests/CarServiceTest/src/com/android/car/ICarImplTest.java
@@ -50,6 +50,7 @@ import com.android.car.hal.PowerHalService;
 import com.android.car.internal.ICarServiceHelper;
 import com.android.car.internal.StaticBinderInterface;
 import com.android.car.os.CarPerformanceService;
+import com.android.car.provider.Settings;
 import com.android.car.remoteaccess.CarRemoteAccessService;
 import com.android.car.systeminterface.ActivityManagerInterface;
 import com.android.car.systeminterface.DisplayInterface;
@@ -154,6 +155,7 @@ public final class ICarImplTest {
                 .withIOInterface(mMockIOInterface)
                 .withStorageMonitoringInterface(mMockStorageMonitoringInterface)
                 .withTimeInterface(mMockTimeInterface)
+                .withSettings(new Settings.DefaultImpl())
                 .withWakeLockInterface(mMockWakeLockInterface).build();
         // ICarImpl will register new CarLocalServices services.
         // This prevents one test failure in tearDown from triggering assertion failure for single
diff --git a/tests/carservice_test/src/com/android/car/audio/AudioPolicyTest.java b/tests/CarServiceTest/src/com/android/car/audio/AudioPolicyTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/AudioPolicyTest.java
rename to tests/CarServiceTest/src/com/android/car/audio/AudioPolicyTest.java
diff --git a/tests/carservice_test/src/com/android/car/audio/CoreAudioRoutingUtils.java b/tests/CarServiceTest/src/com/android/car/audio/CoreAudioRoutingUtils.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CoreAudioRoutingUtils.java
rename to tests/CarServiceTest/src/com/android/car/audio/CoreAudioRoutingUtils.java
diff --git a/tests/carservice_test/src/com/android/car/cluster/ClusterHomeManagerTest.java b/tests/CarServiceTest/src/com/android/car/cluster/ClusterHomeManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/cluster/ClusterHomeManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/cluster/ClusterHomeManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarDiagnosticConstantsTest.java b/tests/CarServiceTest/src/com/android/car/diagnostic/CarDiagnosticConstantsTest.java
similarity index 98%
rename from tests/carservice_test/src/com/android/car/CarDiagnosticConstantsTest.java
rename to tests/CarServiceTest/src/com/android/car/diagnostic/CarDiagnosticConstantsTest.java
index fd4eeeb6b4..419f5fd218 100644
--- a/tests/carservice_test/src/com/android/car/CarDiagnosticConstantsTest.java
+++ b/tests/CarServiceTest/src/com/android/car/diagnostic/CarDiagnosticConstantsTest.java
@@ -14,13 +14,15 @@
  * limitations under the License.
  */
 
-package com.android.car;
+package com.android.car.diagnostic;
 
 import android.util.Log;
 
 import androidx.test.ext.junit.runners.AndroidJUnit4;
 import androidx.test.filters.MediumTest;
 
+import com.android.car.MockedCarTestBase;
+
 import org.junit.Test;
 import org.junit.runner.RunWith;
 
diff --git a/tests/carservice_test/src/com/android/car/CarDiagnosticManagerTest.java b/tests/CarServiceTest/src/com/android/car/diagnostic/CarDiagnosticManagerTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/CarDiagnosticManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/diagnostic/CarDiagnosticManagerTest.java
index 868923ce67..725995fc0a 100644
--- a/tests/carservice_test/src/com/android/car/CarDiagnosticManagerTest.java
+++ b/tests/CarServiceTest/src/com/android/car/diagnostic/CarDiagnosticManagerTest.java
@@ -14,7 +14,7 @@
  * limitations under the License.
  */
 
-package com.android.car;
+package com.android.car.diagnostic;
 
 import static android.car.test.mocks.JavaMockitoHelper.silentAwait;
 
@@ -50,6 +50,7 @@ import androidx.test.ext.junit.runners.AndroidJUnit4;
 import androidx.test.filters.FlakyTest;
 import androidx.test.filters.MediumTest;
 
+import com.android.car.MockedCarTestBase;
 import com.android.car.hal.test.AidlMockedVehicleHal.ErrorCodeHandler;
 import com.android.car.hal.test.AidlMockedVehicleHal.VehicleHalPropertyHandler;
 import com.android.car.hal.test.AidlVehiclePropValueBuilder;
diff --git a/tests/carservice_test/src/com/android/car/CarDrivingRestrictionsTest.java b/tests/CarServiceTest/src/com/android/car/drivingstate/CarDrivingRestrictionsTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/CarDrivingRestrictionsTest.java
rename to tests/CarServiceTest/src/com/android/car/drivingstate/CarDrivingRestrictionsTest.java
index 6851e27a7f..24d4cf208e 100644
--- a/tests/carservice_test/src/com/android/car/CarDrivingRestrictionsTest.java
+++ b/tests/CarServiceTest/src/com/android/car/drivingstate/CarDrivingRestrictionsTest.java
@@ -13,7 +13,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package com.android.car;
+package com.android.car.drivingstate;
 
 import static com.google.common.truth.Truth.assertThat;
 
@@ -36,6 +36,7 @@ import android.util.Log;
 import androidx.test.ext.junit.runners.AndroidJUnit4;
 import androidx.test.filters.SmallTest;
 
+import com.android.car.MockedCarTestBase;
 import com.android.car.hal.test.AidlVehiclePropValueBuilder;
 import com.android.internal.annotations.GuardedBy;
 
diff --git a/tests/carservice_test/src/com/android/car/CarEvsManagerTest.java b/tests/CarServiceTest/src/com/android/car/evs/CarEvsManagerTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/CarEvsManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/evs/CarEvsManagerTest.java
index fef9fd5558..0fbbbc2de8 100644
--- a/tests/carservice_test/src/com/android/car/CarEvsManagerTest.java
+++ b/tests/CarServiceTest/src/com/android/car/evs/CarEvsManagerTest.java
@@ -14,7 +14,7 @@
  * limitations under the License.
  */
 
-package com.android.car;
+package com.android.car.evs;
 
 import static com.google.common.truth.Truth.assertThat;
 
@@ -32,6 +32,8 @@ import androidx.test.core.app.ApplicationProvider;
 import androidx.test.filters.MediumTest;
 import androidx.test.runner.AndroidJUnit4;
 
+import com.android.car.MockedCarTestBase;
+
 import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
diff --git a/tests/carservice_test/src/com/android/car/garagemode/GarageModeControllerTest.java b/tests/CarServiceTest/src/com/android/car/garagemode/GarageModeControllerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/garagemode/GarageModeControllerTest.java
rename to tests/CarServiceTest/src/com/android/car/garagemode/GarageModeControllerTest.java
diff --git a/tests/carservice_test/src/com/android/car/garagemode/GarageModeServiceTest.java b/tests/CarServiceTest/src/com/android/car/garagemode/GarageModeServiceTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/garagemode/GarageModeServiceTest.java
rename to tests/CarServiceTest/src/com/android/car/garagemode/GarageModeServiceTest.java
diff --git a/tests/carservice_test/src/com/android/car/garagemode/GarageModeTest.java b/tests/CarServiceTest/src/com/android/car/garagemode/GarageModeTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/garagemode/GarageModeTest.java
rename to tests/CarServiceTest/src/com/android/car/garagemode/GarageModeTest.java
diff --git a/tests/carservice_test/src/com/android/car/input/CarInputManagerTest.java b/tests/CarServiceTest/src/com/android/car/input/CarInputManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/input/CarInputManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/input/CarInputManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/input/CustomInputEventTest.java b/tests/CarServiceTest/src/com/android/car/input/CustomInputEventTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/input/CustomInputEventTest.java
rename to tests/CarServiceTest/src/com/android/car/input/CustomInputEventTest.java
diff --git a/tests/carservice_test/src/com/android/car/input/RotaryEventTest.java b/tests/CarServiceTest/src/com/android/car/input/RotaryEventTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/input/RotaryEventTest.java
rename to tests/CarServiceTest/src/com/android/car/input/RotaryEventTest.java
diff --git a/tests/carservice_test/src/com/android/car/os/CarPerformanceManagerTest.java b/tests/CarServiceTest/src/com/android/car/os/CarPerformanceManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/os/CarPerformanceManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/os/CarPerformanceManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/pm/CarPackageManagerServiceTest.java b/tests/CarServiceTest/src/com/android/car/pm/CarPackageManagerServiceTest.java
similarity index 93%
rename from tests/carservice_test/src/com/android/car/pm/CarPackageManagerServiceTest.java
rename to tests/CarServiceTest/src/com/android/car/pm/CarPackageManagerServiceTest.java
index 2353de8f14..3f063e585d 100644
--- a/tests/carservice_test/src/com/android/car/pm/CarPackageManagerServiceTest.java
+++ b/tests/CarServiceTest/src/com/android/car/pm/CarPackageManagerServiceTest.java
@@ -46,7 +46,6 @@ import android.view.Display;
 
 import androidx.car.app.activity.CarAppActivity;
 import androidx.test.ext.junit.runners.AndroidJUnit4;
-import androidx.test.filters.FlakyTest;
 import androidx.test.filters.MediumTest;
 import androidx.test.platform.app.InstrumentationRegistry;
 
@@ -210,7 +209,6 @@ public class CarPackageManagerServiceTest {
                 UI_TIMEOUT_MS)).isNotNull();
     }
 
-    @FlakyTest(bugId = 338646912)
     @Test
     public void testBlockingActivity_DoLaunchesNonDo_nonDoIsKilled_noBlockingActivity()
             throws Exception {
@@ -229,7 +227,6 @@ public class CarPackageManagerServiceTest {
         assertActivityLaunched(DoActivity.class.getSimpleName());
     }
 
-    @FlakyTest(bugId = 338646912)
     @Test
     public void testBlockingActivity_DoLaunchesNonDo_DoIsKilled_isBlocked()
             throws Exception {
@@ -246,6 +243,21 @@ public class CarPackageManagerServiceTest {
         assertBlockingActivityFound();
     }
 
+    @Test
+    public void testBlockingActivity_nonDoActivity_translucentDoOnTopOfBlockingActivityRemoved_nonDoRemainsBlocked() {
+        startNonDoActivity(NonDoActivity.EXTRA_DO_NOTHING);
+        waitForBlockingActivityFound();
+
+        startDoActivity(DoTranslucentActivity.EXTRA_ONRESUME_FINISH_IMMEDIATELY,
+                DoTranslucentActivity.class);
+
+        /*
+            Expected task stack:
+            NonDoActivity (not visible) -> ActivityBlockingActivity (visible)
+        */
+        assertBlockingActivityFound();
+    }
+
     @Test
     public void testBlockingActivity_nonDoFinishesOnCreate_noBlockingActivity()
             throws Exception {
@@ -327,8 +339,12 @@ public class CarPackageManagerServiceTest {
     }
 
     private void assertBlockingActivityFound() {
-        assertThat(mDevice.wait(Until.findObject(By.res(ACTIVITY_BLOCKING_ACTIVITY_TEXTVIEW_ID)),
-                UI_TIMEOUT_MS)).isNotNull();
+        assertThat(waitForBlockingActivityFound()).isNotNull();
+    }
+
+    private UiObject2 waitForBlockingActivityFound() {
+        return mDevice.wait(Until.findObject(By.res(ACTIVITY_BLOCKING_ACTIVITY_TEXTVIEW_ID)),
+                UI_TIMEOUT_MS);
     }
 
     private void assertBlockingActivityFoundAndExit(String exitLabel) {
@@ -371,8 +387,12 @@ public class CarPackageManagerServiceTest {
     }
 
     private void startDoActivity(String extra) {
+        startDoActivity(extra, DoActivity.class);
+    }
+
+    private void startDoActivity(String extra, Class<?> cls) {
         Intent intent = new Intent()
-                .setComponent(toComponentName(getTestContext(), DoActivity.class))
+                .setComponent(toComponentName(getTestContext(), cls))
                 .setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
         if (extra != null) {
             intent.putExtra(extra, true);
@@ -406,6 +426,18 @@ public class CarPackageManagerServiceTest {
         return ComponentName.createRelative(ctx, cls.getName());
     }
 
+    public static class DoTranslucentActivity extends TempActivity {
+        public static final String EXTRA_ONRESUME_FINISH_IMMEDIATELY = "ONRESUME_FINISH";
+
+        @Override
+        protected void onResume() {
+            super.onResume();
+            if (getIntent().getBooleanExtra(EXTRA_ONRESUME_FINISH_IMMEDIATELY, false)) {
+                finish();
+            }
+        }
+    }
+
     public static class NonDoActivity extends TempActivity {
 
         static final String EXTRA_FIRST_ACTION = "first_action";
diff --git a/tests/carservice_test/src/com/android/car/CarPackageManagerTest.java b/tests/CarServiceTest/src/com/android/car/pm/CarPackageManagerTest.java
similarity index 97%
rename from tests/carservice_test/src/com/android/car/CarPackageManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/pm/CarPackageManagerTest.java
index 6728069d61..283b068917 100644
--- a/tests/carservice_test/src/com/android/car/CarPackageManagerTest.java
+++ b/tests/CarServiceTest/src/com/android/car/pm/CarPackageManagerTest.java
@@ -13,7 +13,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package com.android.car;
+package com.android.car.pm;
 
 import static com.google.common.truth.Truth.assertThat;
 
@@ -28,7 +28,9 @@ import androidx.test.filters.FlakyTest;
 import androidx.test.filters.SmallTest;
 import androidx.test.filters.Suppress;
 
-import com.android.car.pm.CarPackageManagerService;
+import com.android.car.CarLocalServices;
+import com.android.car.MockedCarTestBase;
+import com.android.car.TestAppBlockingPolicyService;
 
 import org.junit.Test;
 import org.junit.runner.RunWith;
diff --git a/tests/carservice_test/src/com/android/car/power/CarPowerManagementTest.java b/tests/CarServiceTest/src/com/android/car/power/CarPowerManagementTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/power/CarPowerManagementTest.java
rename to tests/CarServiceTest/src/com/android/car/power/CarPowerManagementTest.java
index 872a9cbccb..8171cc3bd6 100644
--- a/tests/carservice_test/src/com/android/car/power/CarPowerManagementTest.java
+++ b/tests/CarServiceTest/src/com/android/car/power/CarPowerManagementTest.java
@@ -53,9 +53,9 @@ import androidx.test.filters.MediumTest;
 import com.android.car.MockedCarTestBase;
 import com.android.car.hal.test.AidlMockedVehicleHal.VehicleHalPropertyHandler;
 import com.android.car.hal.test.AidlVehiclePropValueBuilder;
-import com.android.car.systeminterface.DisplayInterface;
 import com.android.car.systeminterface.SystemInterface;
 import com.android.car.systeminterface.SystemStateInterface;
+import com.android.car.systeminterface.test.DisplayInterfaceEmptyImpl;
 import com.android.car.user.CarUserService;
 import com.android.internal.annotations.GuardedBy;
 
@@ -735,7 +735,7 @@ public class CarPowerManagementTest extends MockedCarTestBase {
         return cpms;
     }
 
-    private static final class MockDisplayInterface implements DisplayInterface {
+    private static final class MockDisplayInterface extends DisplayInterfaceEmptyImpl {
         private final Object mLock = new Object();
         @GuardedBy("mLock")
         private final SparseBooleanArray mDisplayOn = new SparseBooleanArray();
@@ -751,12 +751,6 @@ public class CarPowerManagementTest extends MockedCarTestBase {
             }
         }
 
-        @Override
-        public void setDisplayBrightness(int brightness) {}
-
-        @Override
-        public void setDisplayBrightness(int displayId, int brightness) {}
-
         @Override
         public void setDisplayState(int displayId, boolean on) {
             synchronized (mLock) {
@@ -811,7 +805,7 @@ public class CarPowerManagementTest extends MockedCarTestBase {
         public void stopDisplayStateMonitoring() {}
 
         @Override
-        public void refreshDisplayBrightness() {}
+        public void refreshDefaultDisplayBrightness() {}
 
         @Override
         public void refreshDisplayBrightness(int displayId) {}
diff --git a/tests/CarServiceTest/src/com/android/car/power/DisplayBrightnessTest.java b/tests/CarServiceTest/src/com/android/car/power/DisplayBrightnessTest.java
new file mode 100644
index 0000000000..779426ca36
--- /dev/null
+++ b/tests/CarServiceTest/src/com/android/car/power/DisplayBrightnessTest.java
@@ -0,0 +1,303 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.power;
+
+import static android.car.feature.Flags.FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL;
+
+import static com.google.common.truth.Truth.assertThat;
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.Mockito.anyFloat;
+import static org.mockito.Mockito.anyLong;
+import static org.mockito.Mockito.clearInvocations;
+import static org.mockito.Mockito.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.timeout;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.builtin.view.DisplayHelper;
+import android.content.Context;
+import android.hardware.automotive.vehicle.RawPropValues;
+import android.hardware.automotive.vehicle.VehiclePropValue;
+import android.hardware.automotive.vehicle.VehicleProperty;
+import android.hardware.display.DisplayManager;
+import android.hardware.display.DisplayManager.DisplayListener;
+import android.os.Handler;
+import android.os.PowerManager;
+import android.os.SystemClock;
+import android.platform.test.annotations.EnableFlags;
+import android.platform.test.flag.junit.SetFlagsRule;
+import android.util.SparseIntArray;
+import android.view.Display;
+import android.view.DisplayAddress;
+
+import androidx.test.filters.MediumTest;
+import androidx.test.runner.AndroidJUnit4;
+
+import com.android.car.MockedCarTestBase;
+import com.android.car.hal.test.AidlMockedVehicleHal.VehicleHalPropertyHandler;
+import com.android.car.provider.Settings;
+import com.android.car.systeminterface.DisplayHelperInterface;
+import com.android.car.systeminterface.DisplayInterface;
+import com.android.car.systeminterface.SystemInterface;
+import com.android.car.systeminterface.WakeLockInterface;
+import com.android.car.user.CurrentUserFetcher;
+import com.android.internal.annotations.GuardedBy;
+
+import org.junit.ClassRule;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+
+@RunWith(AndroidJUnit4.class)
+@MediumTest
+@EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+public class DisplayBrightnessTest extends MockedCarTestBase {
+
+    @ClassRule public static final SetFlagsRule.ClassRule mClassRule = new SetFlagsRule.ClassRule();
+    @Rule public final SetFlagsRule mSetFlagsRule = mClassRule.createSetFlagsRule();
+
+    // This is the default display
+    private static final int DISPLAY_ID_1 = 0;
+    private static final int DISPLAY_PORT_1 = 2;
+    private static final int DISPLAY_ID_2 = 3;
+    private static final int DISPLAY_PORT_2 = 4;
+    private static final int DISPLAY_ID_3 = 5;
+    private static final int DISPLAY_PORT_3 = 6;
+    private static final int MAX_BRIGHTNESS = 100;
+    private static final float DISPLAY_MANAGER_BRIGHTNESS_1 = 0.2f;
+    private static final float DISPLAY_MANAGER_BRIGHTNESS_2 = 0.3f;
+    private static final int VHAL_BRIGHTNESS_1 = 32;
+    private static final int VHAL_BRIGHTNESS_2 = 56;
+    private static final int POWER_MGR_MAX_SCREEN_BRIGHTNESS = 255;
+    private static final int POWER_MGR_MIN_SCREEN_BRIGHTNESS = 1;
+
+    private static final int PER_DISPLAY_MAX_BRIGHTNESS = 0x11410F4E;
+
+    private static final int DEFAULT_TIMEOUT_MS = 5_000;
+
+    @Mock
+    private WakeLockInterface mWakeLock;
+
+    @Mock
+    private Settings mSettings;
+
+    @Mock
+    private CurrentUserFetcher mCurrentUserFetcher;
+
+    @Mock
+    private DisplayManager mDisplayManager;
+
+    @Mock
+    private PowerManager mPowerManager;
+
+    private final class MockedContext extends MockedCarTestContext {
+        MockedContext(Context base) {
+            super(base);
+        }
+
+        @Override
+        public Object getSystemService(String name) {
+            if (Context.DISPLAY_SERVICE.equals(name)) {
+                return mDisplayManager;
+            }
+            if (Context.POWER_SERVICE.equals(name)) {
+                return mPowerManager;
+            }
+            return super.getSystemService(name);
+        }
+    }
+
+    @Override
+    protected MockedCarTestContext createMockedCarTestContext(Context context) {
+        return new MockedContext(context);
+    }
+
+    @Override
+    protected SystemInterface.Builder getSystemInterfaceBuilder() {
+        SystemInterface.Builder builder = super.getSystemInterfaceBuilder();
+        DisplayInterface displayInterface = new DisplayInterface.DefaultImpl(
+                getContext(), mWakeLock, mSettings,
+                new DisplayHelperInterface.DefaultImpl(), mCurrentUserFetcher);
+        return builder.withDisplayInterface(displayInterface).withSettings(mSettings);
+    }
+
+    private static final class BrightnessPropertyHandler implements VehicleHalPropertyHandler {
+
+        private final Object mLock = new Object();
+        @GuardedBy("mLock")
+        private final SparseIntArray mBrightnessByPort = new SparseIntArray();
+        @GuardedBy("mLock")
+        private boolean mPropertySet;
+
+        @Override
+        public void onPropertySet(VehiclePropValue value) {
+            synchronized (mLock) {
+                mBrightnessByPort.put(value.value.int32Values[0], value.value.int32Values[1]);
+                mPropertySet = true;
+                mLock.notify();
+            }
+        }
+
+        @Override
+        public VehiclePropValue onPropertyGet(VehiclePropValue value) {
+            synchronized (mLock) {
+                int displayPort = value.value.int32Values[0];
+                int brightness = mBrightnessByPort.get(displayPort);
+                value.value.int32Values[1] = brightness;
+                value.timestamp = SystemClock.elapsedRealtimeNanos();
+                return value;
+            }
+        }
+
+        int getBrightness(int displayPort) {
+            synchronized (mLock) {
+                return mBrightnessByPort.get(displayPort);
+            }
+        }
+
+        void resetPropertySet() {
+            synchronized (mLock) {
+                mPropertySet = false;
+            }
+        }
+
+        void waitForPropertySet(int timeoutInMs) throws InterruptedException {
+            synchronized (mLock) {
+                while (!mPropertySet) {
+                    mLock.wait(timeoutInMs);
+                }
+            }
+        }
+    }
+
+    private final BrightnessPropertyHandler mBrightnessPropertyHandler =
+            new BrightnessPropertyHandler();
+
+    @Override
+    protected void configureMockedHal() {
+        // Simulate two displays with port 1, 2.
+        // The max brightness is 100.
+        addAidlProperty(VehicleProperty.PER_DISPLAY_BRIGHTNESS, mBrightnessPropertyHandler);
+        VehiclePropValue value = new VehiclePropValue();
+        value.prop = PER_DISPLAY_MAX_BRIGHTNESS;
+        value.areaId = 0;
+        value.value = new RawPropValues();
+        value.value.int32Values = new int[]{
+                DISPLAY_PORT_1, MAX_BRIGHTNESS, DISPLAY_PORT_2, MAX_BRIGHTNESS};
+        addAidlStaticProperty(PER_DISPLAY_MAX_BRIGHTNESS, value);
+
+        Display physicalDisplay1 = createMockDisplay(DISPLAY_ID_1, DISPLAY_PORT_1,
+                DisplayHelper.TYPE_INTERNAL);
+        Display physicalDisplay2 = createMockDisplay(DISPLAY_ID_2, DISPLAY_PORT_2,
+                DisplayHelper.TYPE_INTERNAL);
+        Display virtualDisplay = createMockDisplay(DISPLAY_ID_3, DISPLAY_PORT_3,
+                DisplayHelper.TYPE_VIRTUAL);
+
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{physicalDisplay1,
+                physicalDisplay2, virtualDisplay});
+        when(mDisplayManager.getDisplay(DISPLAY_ID_1)).thenReturn(physicalDisplay1);
+        when(mDisplayManager.getDisplay(DISPLAY_ID_2)).thenReturn(physicalDisplay2);
+        when(mDisplayManager.getDisplay(DISPLAY_ID_3)).thenReturn(virtualDisplay);
+
+        when(mDisplayManager.getBrightness(DISPLAY_ID_1)).thenReturn(DISPLAY_MANAGER_BRIGHTNESS_1);
+        when(mDisplayManager.getBrightness(DISPLAY_ID_2)).thenReturn(DISPLAY_MANAGER_BRIGHTNESS_2);
+
+        when(mPowerManager.getMaximumScreenBrightnessSetting()).thenReturn(
+                POWER_MGR_MAX_SCREEN_BRIGHTNESS);
+        when(mPowerManager.getMinimumScreenBrightnessSetting()).thenReturn(
+                POWER_MGR_MIN_SCREEN_BRIGHTNESS);
+    }
+
+    @Test
+    public void testRefreshDisplayBrightnessOnInit() {
+        int brightnessForDisplay1 = mBrightnessPropertyHandler.getBrightness(DISPLAY_PORT_1);
+        int brightnessForDisplay2 = mBrightnessPropertyHandler.getBrightness(DISPLAY_PORT_2);
+
+        assertWithMessage("Virtual display brightness must not be set").that(
+                mBrightnessPropertyHandler.getBrightness(DISPLAY_ID_3)).isEqualTo(0);
+        assertWithMessage("display 1 brightness must be set").that(brightnessForDisplay1)
+                .isGreaterThan(0);
+        assertWithMessage("display 2 brightness must be set").that(brightnessForDisplay2)
+                .isGreaterThan(0);
+        assertWithMessage("display 1 and 2 must have different brightness")
+                .that(brightnessForDisplay1).isNotEqualTo(brightnessForDisplay2);
+    }
+
+    @Test
+    public void testDisplayBrightnessChangeFromVhal() {
+        clearInvocations(mDisplayManager);
+
+        getAidlMockedVehicleHal().injectEvent(createPerDisplayBrightnessValue(
+                DISPLAY_PORT_1, VHAL_BRIGHTNESS_1), /* setProperty= */ true);
+
+        verify(mDisplayManager, timeout(DEFAULT_TIMEOUT_MS)).setBrightness(
+                eq(DISPLAY_ID_1), anyFloat());
+
+        clearInvocations(mDisplayManager);
+
+        getAidlMockedVehicleHal().injectEvent(createPerDisplayBrightnessValue(
+                DISPLAY_PORT_2, VHAL_BRIGHTNESS_2), /* setProperty= */ true);
+
+        verify(mDisplayManager, timeout(DEFAULT_TIMEOUT_MS)).setBrightness(
+                eq(DISPLAY_ID_2), anyFloat());
+    }
+
+    @Test
+    public void testBrightnessChangeFromDisplayManager() throws Exception {
+        int brightnessForDisplay2 = mBrightnessPropertyHandler.getBrightness(DISPLAY_PORT_2);
+
+        var listenerCaptor = ArgumentCaptor.forClass(DisplayListener.class);
+        var handlerCaptor = ArgumentCaptor.forClass(Handler.class);
+        verify(mDisplayManager).registerDisplayListener(listenerCaptor.capture(),
+                handlerCaptor.capture(), anyLong());
+
+        mBrightnessPropertyHandler.resetPropertySet();
+
+        when(mDisplayManager.getBrightness(DISPLAY_ID_1)).thenReturn(DISPLAY_MANAGER_BRIGHTNESS_2);
+        var handler = handlerCaptor.getValue();
+        handler.post(() -> {
+            listenerCaptor.getValue().onDisplayChanged(DISPLAY_ID_1);
+        });
+
+        mBrightnessPropertyHandler.waitForPropertySet(DEFAULT_TIMEOUT_MS);
+        assertThat(mBrightnessPropertyHandler.getBrightness(DISPLAY_PORT_1))
+                .isEqualTo(brightnessForDisplay2);
+    }
+
+    private VehiclePropValue createPerDisplayBrightnessValue(int displayPort, int brightness) {
+        var value = new VehiclePropValue();
+        value.prop = VehicleProperty.PER_DISPLAY_BRIGHTNESS;
+        value.areaId = 0;
+        value.value = new RawPropValues();
+        value.value.int32Values = new int[]{displayPort, brightness};
+        return value;
+    }
+
+    private Display createMockDisplay(int displayId, int displayPort, int type) {
+        Display display = mock(Display.class);
+        DisplayAddress.Physical displayAddress = mock(DisplayAddress.Physical.class);
+        when(displayAddress.getPort()).thenReturn(displayPort);
+        when(display.getDisplayId()).thenReturn(displayId);
+        when(display.getAddress()).thenReturn(displayAddress);
+        when(display.getType()).thenReturn(type);
+        return display;
+    }
+}
diff --git a/tests/carservice_test/src/com/android/car/power/PowerComponentValidityTest.java b/tests/CarServiceTest/src/com/android/car/power/PowerComponentValidityTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/power/PowerComponentValidityTest.java
rename to tests/CarServiceTest/src/com/android/car/power/PowerComponentValidityTest.java
diff --git a/tests/carservice_test/src/com/android/car/remoteaccess/CarRemoteAccessManagerTest.java b/tests/CarServiceTest/src/com/android/car/remoteaccess/CarRemoteAccessManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/remoteaccess/CarRemoteAccessManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/remoteaccess/CarRemoteAccessManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/CarStorageMonitoringTest.java b/tests/CarServiceTest/src/com/android/car/storagemonitoring/CarStorageMonitoringTest.java
similarity index 98%
rename from tests/carservice_test/src/com/android/car/CarStorageMonitoringTest.java
rename to tests/CarServiceTest/src/com/android/car/storagemonitoring/CarStorageMonitoringTest.java
index a13576a6a4..f14ceb9dae 100644
--- a/tests/carservice_test/src/com/android/car/CarStorageMonitoringTest.java
+++ b/tests/CarServiceTest/src/com/android/car/storagemonitoring/CarStorageMonitoringTest.java
@@ -14,7 +14,7 @@
  * limitations under the License.
  */
 
-package com.android.car;
+package com.android.car.storagemonitoring;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
@@ -44,13 +44,10 @@ import android.util.SparseArray;
 import androidx.test.ext.junit.runners.AndroidJUnit4;
 import androidx.test.filters.MediumTest;
 
+import com.android.car.CarStorageMonitoringService;
+import com.android.car.MockedCarTestBase;
+import com.android.car.R;
 import com.android.car.procfsinspector.ProcessInfo;
-import com.android.car.storagemonitoring.LifetimeWriteInfoProvider;
-import com.android.car.storagemonitoring.UidIoStatsProvider;
-import com.android.car.storagemonitoring.WearEstimateRecord;
-import com.android.car.storagemonitoring.WearHistory;
-import com.android.car.storagemonitoring.WearInformation;
-import com.android.car.storagemonitoring.WearInformationProvider;
 import com.android.car.systeminterface.StorageMonitoringInterface;
 import com.android.car.systeminterface.SystemInterface;
 import com.android.car.systeminterface.SystemStateInterface;
diff --git a/tests/carservice_test/src/com/android/car/telemetry/CarTelemetryManagerSpyServiceTest.java b/tests/CarServiceTest/src/com/android/car/telemetry/CarTelemetryManagerSpyServiceTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/telemetry/CarTelemetryManagerSpyServiceTest.java
rename to tests/CarServiceTest/src/com/android/car/telemetry/CarTelemetryManagerSpyServiceTest.java
diff --git a/tests/carservice_test/src/com/android/car/telemetry/CarTelemetryManagerTest.java b/tests/CarServiceTest/src/com/android/car/telemetry/CarTelemetryManagerTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/telemetry/CarTelemetryManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/telemetry/CarTelemetryManagerTest.java
diff --git a/tests/carservice_test/src/com/android/car/MockedVmsTestBase.java b/tests/CarServiceTest/src/com/android/car/vms/MockedVmsTestBase.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/MockedVmsTestBase.java
rename to tests/CarServiceTest/src/com/android/car/vms/MockedVmsTestBase.java
index d91d003bd4..ce2d2f15a7 100644
--- a/tests/carservice_test/src/com/android/car/MockedVmsTestBase.java
+++ b/tests/CarServiceTest/src/com/android/car/vms/MockedVmsTestBase.java
@@ -13,7 +13,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package com.android.car;
+package com.android.car.vms;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
@@ -36,6 +36,7 @@ import android.hardware.automotive.vehicle.VmsStartSessionMessageIntegerValuesIn
 import android.util.Log;
 import android.util.Pair;
 
+import com.android.car.MockedCarTestBase;
 import com.android.car.hal.test.AidlMockedVehicleHal;
 import com.android.car.hal.test.AidlVehiclePropValueBuilder;
 
diff --git a/tests/carservice_test/src/com/android/car/vms/VmsClientTest.java b/tests/CarServiceTest/src/com/android/car/vms/VmsClientTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/vms/VmsClientTest.java
rename to tests/CarServiceTest/src/com/android/car/vms/VmsClientTest.java
diff --git a/tests/carservice_test/src/com/android/car/VmsHalServiceSubscriptionEventTest.java b/tests/CarServiceTest/src/com/android/car/vms/VmsHalServiceSubscriptionEventTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/VmsHalServiceSubscriptionEventTest.java
rename to tests/CarServiceTest/src/com/android/car/vms/VmsHalServiceSubscriptionEventTest.java
index 83adfef297..98262efd49 100644
--- a/tests/carservice_test/src/com/android/car/VmsHalServiceSubscriptionEventTest.java
+++ b/tests/CarServiceTest/src/com/android/car/vms/VmsHalServiceSubscriptionEventTest.java
@@ -14,7 +14,7 @@
  * limitations under the License.
  */
 
-package com.android.car;
+package com.android.car.vms;
 
 import static org.junit.Assert.assertEquals;
 
diff --git a/tests/carservice_test/src/com/android/car/VmsOperationRecorderTest.java b/tests/CarServiceTest/src/com/android/car/vms/VmsOperationRecorderTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/VmsOperationRecorderTest.java
rename to tests/CarServiceTest/src/com/android/car/vms/VmsOperationRecorderTest.java
index d48802ee06..bbd3f88b2c 100644
--- a/tests/carservice_test/src/com/android/car/VmsOperationRecorderTest.java
+++ b/tests/CarServiceTest/src/com/android/car/vms/VmsOperationRecorderTest.java
@@ -14,7 +14,7 @@
  * limitations under the License.
  */
 
-package com.android.car;
+package com.android.car.vms;
 
 import static org.junit.Assert.assertTrue;
 
diff --git a/tests/carservice_test/src/com/android/car/VmsPublisherSubscriberTest.java b/tests/CarServiceTest/src/com/android/car/vms/VmsPublisherSubscriberTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/VmsPublisherSubscriberTest.java
rename to tests/CarServiceTest/src/com/android/car/vms/VmsPublisherSubscriberTest.java
index a95a45a280..a1338c6a46 100644
--- a/tests/carservice_test/src/com/android/car/VmsPublisherSubscriberTest.java
+++ b/tests/CarServiceTest/src/com/android/car/vms/VmsPublisherSubscriberTest.java
@@ -14,7 +14,7 @@
  * limitations under the License.
  */
 
-package com.android.car;
+package com.android.car.vms;
 
 import static org.junit.Assert.assertArrayEquals;
 import static org.junit.Assert.assertEquals;
diff --git a/tests/carservice_test/src/com/android/car/VmsSubscriberManagerTest.java b/tests/CarServiceTest/src/com/android/car/vms/VmsSubscriberManagerTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/VmsSubscriberManagerTest.java
rename to tests/CarServiceTest/src/com/android/car/vms/VmsSubscriberManagerTest.java
index a771972589..4e4c86d523 100644
--- a/tests/carservice_test/src/com/android/car/VmsSubscriberManagerTest.java
+++ b/tests/CarServiceTest/src/com/android/car/vms/VmsSubscriberManagerTest.java
@@ -14,7 +14,7 @@
  * limitations under the License.
  */
 
-package com.android.car;
+package com.android.car.vms;
 
 import static org.junit.Assert.assertArrayEquals;
 import static org.junit.Assert.assertEquals;
diff --git a/tests/carservice_test/src/com/android/car/watchdog/CarWatchdogServiceTest.java b/tests/CarServiceTest/src/com/android/car/watchdog/CarWatchdogServiceTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/watchdog/CarWatchdogServiceTest.java
rename to tests/CarServiceTest/src/com/android/car/watchdog/CarWatchdogServiceTest.java
diff --git a/tests/CarTelemetryApp/tests/Android.bp b/tests/CarTelemetryApp/tests/Android.bp
index 620689ba5c..8ce2d84b21 100644
--- a/tests/CarTelemetryApp/tests/Android.bp
+++ b/tests/CarTelemetryApp/tests/Android.bp
@@ -34,9 +34,9 @@ android_test {
     platform_apis: true,
 
     libs: [
-        "android.test.base",
-        "android.test.mock",
-        "android.test.runner",
+        "android.test.base.stubs.system",
+        "android.test.mock.stubs.system",
+        "android.test.runner.stubs.system",
     ],
 
     static_libs: [
diff --git a/tests/CarTestLibUnitTest/Android.bp b/tests/CarTestLibUnitTest/Android.bp
new file mode 100644
index 0000000000..47379d7d1c
--- /dev/null
+++ b/tests/CarTestLibUnitTest/Android.bp
@@ -0,0 +1,38 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+android_test {
+    name: "CarTestLibUnitTest",
+    srcs: [
+        "src/**/*.java",
+    ],
+    static_libs: [
+        "android.car",
+        "android.car.testapi",
+        "android.car.test.utils",
+        "androidx.test.runner",
+        "mockito-target-extended",
+        "truth",
+    ],
+    // mockito-target-extended dependency
+    jni_libs: [
+        "libdexmakerjvmtiagent",
+        "libstaticjvmtiagent",
+    ],
+    platform_apis: true,
+    test_suites: [
+        "automotive-general-tests",
+        "general-tests",
+    ],
+}
diff --git a/tests/CarTestLibUnitTest/AndroidManifest.xml b/tests/CarTestLibUnitTest/AndroidManifest.xml
new file mode 100644
index 0000000000..42ae0c714e
--- /dev/null
+++ b/tests/CarTestLibUnitTest/AndroidManifest.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+        xmlns:androidprv="http://schemas.android.com/apk/prv/res/android"
+        package="android.car.test.test">
+    <application android:debuggable="true">
+        <uses-library android:name="android.test.runner" />
+    </application>
+    <instrumentation android:name="androidx.test.runner.AndroidJUnitRunner"
+            android:targetPackage="android.car.test.test"
+            android:label="Unit Tests for android.car.test"/>
+</manifest>
diff --git a/tests/CarTestLibUnitTest/TEST_MAPPING b/tests/CarTestLibUnitTest/TEST_MAPPING
new file mode 100644
index 0000000000..7a9e714883
--- /dev/null
+++ b/tests/CarTestLibUnitTest/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarTestLibUnitTest"
+    }
+  ]
+}
diff --git a/tests/carservice_unit_test/src/android/car/test/ApiHelperTest.java b/tests/CarTestLibUnitTest/src/android/car/test/ApiHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/ApiHelperTest.java
rename to tests/CarTestLibUnitTest/src/android/car/test/ApiHelperTest.java
diff --git a/tests/carservice_unit_test/src/android/car/test/JUnitHelper.java b/tests/CarTestLibUnitTest/src/android/car/test/JUnitHelper.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/JUnitHelper.java
rename to tests/CarTestLibUnitTest/src/android/car/test/JUnitHelper.java
diff --git a/tests/carservice_unit_test/src/android/car/test/PermissionsCheckerRuleTest.java b/tests/CarTestLibUnitTest/src/android/car/test/PermissionsCheckerRuleTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/PermissionsCheckerRuleTest.java
rename to tests/CarTestLibUnitTest/src/android/car/test/PermissionsCheckerRuleTest.java
diff --git a/tests/carservice_unit_test/src/android/car/test/mocks/AndroidMockitoHelperTest.java b/tests/CarTestLibUnitTest/src/android/car/test/mocks/AndroidMockitoHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/mocks/AndroidMockitoHelperTest.java
rename to tests/CarTestLibUnitTest/src/android/car/test/mocks/AndroidMockitoHelperTest.java
diff --git a/tests/carservice_unit_test/src/android/car/test/mocks/BlockingAnswerTest.java b/tests/CarTestLibUnitTest/src/android/car/test/mocks/BlockingAnswerTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/mocks/BlockingAnswerTest.java
rename to tests/CarTestLibUnitTest/src/android/car/test/mocks/BlockingAnswerTest.java
diff --git a/tests/carservice_unit_test/src/android/car/test/mocks/CarArgumentMatchersTest.java b/tests/CarTestLibUnitTest/src/android/car/test/mocks/CarArgumentMatchersTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/mocks/CarArgumentMatchersTest.java
rename to tests/CarTestLibUnitTest/src/android/car/test/mocks/CarArgumentMatchersTest.java
diff --git a/tests/carservice_unit_test/src/android/car/test/mocks/JavaMockitoHelperTest.java b/tests/CarTestLibUnitTest/src/android/car/test/mocks/JavaMockitoHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/mocks/JavaMockitoHelperTest.java
rename to tests/CarTestLibUnitTest/src/android/car/test/mocks/JavaMockitoHelperTest.java
diff --git a/tests/carservice_unit_test/src/android/car/test/mocks/SyncAnswerTest.java b/tests/CarTestLibUnitTest/src/android/car/test/mocks/SyncAnswerTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/mocks/SyncAnswerTest.java
rename to tests/CarTestLibUnitTest/src/android/car/test/mocks/SyncAnswerTest.java
diff --git a/tests/carservice_unit_test/src/android/car/test/util/BlockingResultReceiverTest.java b/tests/CarTestLibUnitTest/src/android/car/test/util/BlockingResultReceiverTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/test/util/BlockingResultReceiverTest.java
rename to tests/CarTestLibUnitTest/src/android/car/test/util/BlockingResultReceiverTest.java
diff --git a/tests/CarWatchdogLibUnitTest/Android.bp b/tests/CarWatchdogLibUnitTest/Android.bp
new file mode 100644
index 0000000000..e454ff2a30
--- /dev/null
+++ b/tests/CarWatchdogLibUnitTest/Android.bp
@@ -0,0 +1,38 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+android_test {
+    name: "CarWatchdogLibUnitTest",
+    srcs: [
+        "src/**/*.java",
+    ],
+    static_libs: [
+        "android.car",
+        "android.car.test.utils",
+        "android.car.watchdoglib",
+        "androidx.test.runner",
+        "mockito-target-extended",
+        "truth",
+    ],
+    // mockito-target-inline dependency
+    jni_libs: [
+        "libdexmakerjvmtiagent",
+        "libstaticjvmtiagent",
+    ],
+    test_suites: [
+        "automotive-general-tests",
+        "general-tests",
+    ],
+    platform_apis: true,
+}
diff --git a/tests/CarWatchdogLibUnitTest/AndroidManifest.xml b/tests/CarWatchdogLibUnitTest/AndroidManifest.xml
new file mode 100644
index 0000000000..401313dc96
--- /dev/null
+++ b/tests/CarWatchdogLibUnitTest/AndroidManifest.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+        xmlns:androidprv="http://schemas.android.com/apk/prv/res/android"
+        package="android.car.watchdoglib.test">
+    <application android:debuggable="true">
+        <uses-library android:name="android.test.runner" />
+    </application>
+    <instrumentation android:name="androidx.test.runner.AndroidJUnitRunner"
+            android:targetPackage="android.car.watchdoglib.test"
+            android:label="Unit Tests for android.car.watchdoglib"/>
+</manifest>
diff --git a/tests/CarWatchdogLibUnitTest/TEST_MAPPING b/tests/CarWatchdogLibUnitTest/TEST_MAPPING
new file mode 100644
index 0000000000..8432eb4483
--- /dev/null
+++ b/tests/CarWatchdogLibUnitTest/TEST_MAPPING
@@ -0,0 +1,7 @@
+{
+  "auto-presubmit": [
+    {
+      "name": "CarWatchdogLibUnitTest"
+    }
+  ]
+}
diff --git a/tests/carservice_unit_test/src/android/car/watchdoglib/CarWatchdogDaemonHelperTest.java b/tests/CarWatchdogLibUnitTest/src/android/car/watchdoglib/CarWatchdogDaemonHelperTest.java
similarity index 100%
rename from tests/carservice_unit_test/src/android/car/watchdoglib/CarWatchdogDaemonHelperTest.java
rename to tests/CarWatchdogLibUnitTest/src/android/car/watchdoglib/CarWatchdogDaemonHelperTest.java
diff --git a/tests/CustomizationTool/Android.bp b/tests/CustomizationTool/Android.bp
index e7f143a89c..740caba877 100644
--- a/tests/CustomizationTool/Android.bp
+++ b/tests/CustomizationTool/Android.bp
@@ -47,6 +47,7 @@ android_app {
     static_libs: [
         "androidx.recyclerview_recyclerview",
         "androidx-constraintlayout_constraintlayout",
+        "androidx.core_core-ktx",
         "dagger2",
         "jsr330",
     ],
diff --git a/tests/CustomizationTool/src/com/android/car/customization/tool/features/rro/systemui/themepresets/ThemePresetsItem.kt b/tests/CustomizationTool/src/com/android/car/customization/tool/features/rro/systemui/themepresets/ThemePresetsItem.kt
index b3fb6eec8a..99b400456d 100644
--- a/tests/CustomizationTool/src/com/android/car/customization/tool/features/rro/systemui/themepresets/ThemePresetsItem.kt
+++ b/tests/CustomizationTool/src/com/android/car/customization/tool/features/rro/systemui/themepresets/ThemePresetsItem.kt
@@ -59,7 +59,11 @@ internal fun rroThemePresetsDropDownItem(overlayManager: OverlayManager): MenuIt
             systemPackages = getSystemRroPackages(theme = "orange"),
             userPackages = getUserRroPackages(theme = "orange")
         )
-    ).mapValues { (_, themeRros) -> themeRros.filterInstalled(overlayManager) }
+    )
+    .mapValues { (_, themeRros) -> themeRros.filterInstalled(overlayManager) }
+    .filter { (_, themeRros) ->
+      themeRros.systemPackages.isNotEmpty() || themeRros.userPackages.isNotEmpty()
+    }
 
     themes
         .forEach { (title, theme) ->
diff --git a/tests/EmbeddedKitchenSinkApp/Android.bp b/tests/EmbeddedKitchenSinkApp/Android.bp
index f0861c266e..641de5fdb5 100644
--- a/tests/EmbeddedKitchenSinkApp/Android.bp
+++ b/tests/EmbeddedKitchenSinkApp/Android.bp
@@ -31,6 +31,7 @@ android_app {
 
     srcs: [
         "src/**/*.java",
+        "src/**/*.kt",
         ":cartelemetryservice-proto-srcs",
     ],
 
@@ -56,6 +57,7 @@ android_app {
         "com.google.android.material_material",
         "androidx.appcompat_appcompat",
         "car-admin-ui-lib",
+        "car-data-subscription-lib",
         "car-ui-lib",
         "car-qc-lib",
         "android.hidl.base-V1.0-java",
diff --git a/tests/EmbeddedKitchenSinkApp/AndroidManifest.xml b/tests/EmbeddedKitchenSinkApp/AndroidManifest.xml
index 922e3f06aa..dab71de29b 100644
--- a/tests/EmbeddedKitchenSinkApp/AndroidManifest.xml
+++ b/tests/EmbeddedKitchenSinkApp/AndroidManifest.xml
@@ -455,6 +455,18 @@
             </intent-filter>
         </activity>
 
+        <activity
+            android:name=".cluster.ResponsiveClusterActivity"
+            android:launchMode="singleInstance"
+            android:theme="@style/KSDayNightTheme"
+            android:documentLaunchMode="always"
+            android:exported="true"
+            android:label="ResponsiveClusterActivity">
+            <intent-filter>
+                <action android:name="android.intent.action.MAIN"/>
+            </intent-filter>
+        </activity>
+
         <service android:name=".bluetooth.InCallServiceImpl"
                  android:exported="false"
                  android:permission="android.permission.BIND_INCALL_SERVICE">
diff --git a/tests/EmbeddedKitchenSinkApp/res/drawable/progressbar_bg.xml b/tests/EmbeddedKitchenSinkApp/res/drawable/progressbar_bg.xml
new file mode 100644
index 0000000000..7117220150
--- /dev/null
+++ b/tests/EmbeddedKitchenSinkApp/res/drawable/progressbar_bg.xml
@@ -0,0 +1,44 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
+<item android:id="@android:id/background">
+    <shape
+        android:innerRadiusRatio="3"
+        android:shape="ring"
+        android:thicknessRatio="20.0"
+        android:useLevel="false">
+        <solid android:color="#114D4D4D" />
+    </shape>
+</item>
+<item android:id="@android:id/progress">
+    <rotate
+        android:fromDegrees="270"
+        android:pivotX="50%"
+        android:pivotY="50%"
+        android:toDegrees="270">
+        <shape
+            android:innerRadiusRatio="3"
+            android:thickness="12dp"
+            android:shape="ring"
+            android:thicknessRatio="30.0"
+            android:useLevel="true">
+            <solid android:color="@android:color/holo_green_dark" />
+        </shape>
+    </rotate>
+</item>
+
+</layer-list>
\ No newline at end of file
diff --git a/tests/EmbeddedKitchenSinkApp/res/layout/activity_responsive_cluster.xml b/tests/EmbeddedKitchenSinkApp/res/layout/activity_responsive_cluster.xml
new file mode 100644
index 0000000000..1818a800f3
--- /dev/null
+++ b/tests/EmbeddedKitchenSinkApp/res/layout/activity_responsive_cluster.xml
@@ -0,0 +1,57 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:id="@+id/main"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    tools:context=".MainActivity">
+
+    <FrameLayout
+        android:id="@+id/root"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent">
+
+        <LinearLayout
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:orientation="vertical"
+            android:layout_gravity="center"
+            >
+        <TextView
+            android:layout_width="wrap_content"
+
+            android:layout_height="wrap_content"
+            android:textSize="36sp"
+            android:text="Dynamic Driver UI" />
+
+        <ProgressBar
+            android:id="@+id/progressBar"
+            android:layout_gravity="center"
+            android:layout_width="150dp"
+            android:indeterminateOnly="false"
+            android:layout_height="150dp"
+            android:progressDrawable="@drawable/progressbar_bg"
+            android:max="100"
+            android:progress="1" />
+        </LinearLayout>
+
+
+    </FrameLayout>
+</FrameLayout>
\ No newline at end of file
diff --git a/tests/EmbeddedKitchenSinkApp/res/layout/assign_user_to_primary_audio_zone.xml b/tests/EmbeddedKitchenSinkApp/res/layout/assign_user_to_primary_audio_zone.xml
index 3cd7ff4b65..0b1098e4b5 100644
--- a/tests/EmbeddedKitchenSinkApp/res/layout/assign_user_to_primary_audio_zone.xml
+++ b/tests/EmbeddedKitchenSinkApp/res/layout/assign_user_to_primary_audio_zone.xml
@@ -57,14 +57,6 @@
         <Space
             android:layout_width="3dp"
             android:layout_height="match_parent" />
-        <TextView
-            android:id="@+id/user_assign_focus_info"
-            android:layout_width="wrap_content"
-            android:layout_height="wrap_content"
-            android:text="@string/user_focus_unknown" />
-        <Space
-            android:layout_width="3dp"
-            android:layout_height="match_parent" />
     </LinearLayout>
     <RadioGroup
         android:layout_width="match_parent"
diff --git a/tests/EmbeddedKitchenSinkApp/res/layout/data_subscription_fragment.xml b/tests/EmbeddedKitchenSinkApp/res/layout/data_subscription_fragment.xml
new file mode 100644
index 0000000000..ba2ccf2581
--- /dev/null
+++ b/tests/EmbeddedKitchenSinkApp/res/layout/data_subscription_fragment.xml
@@ -0,0 +1,45 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:layout_marginTop="40dp"
+    android:gravity="top|center"
+    android:orientation="vertical">
+
+    <Button android:id="@+id/inactive"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="@string/data_subscription_inactive" />
+
+    <Button android:id="@+id/trial"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="@string/data_subscription_trial" />
+
+    <Button android:id="@+id/paid"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:text="@string/data_subscription_paid" />
+
+    <TextView
+        android:id="@+id/message"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:inputType="textMultiLine" />
+
+</LinearLayout>
diff --git a/tests/EmbeddedKitchenSinkApp/res/layout/notification_fragment.xml b/tests/EmbeddedKitchenSinkApp/res/layout/notification_fragment.xml
index 8d6f77d7d5..b7b49120a5 100644
--- a/tests/EmbeddedKitchenSinkApp/res/layout/notification_fragment.xml
+++ b/tests/EmbeddedKitchenSinkApp/res/layout/notification_fragment.xml
@@ -346,5 +346,18 @@
                 android:text="Car Information"
                 android:textSize="30sp"/>
         </LinearLayout>
+
+        <LinearLayout
+            android:layout_height="wrap_content"
+            android:layout_width="match_parent"
+            android:background="#663333">
+            <TextView
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Some space added to the bottom to allow buttons to be touchable
+                while heads up notification(s) are active."
+                android:layout_marginTop="100dp"
+                android:layout_marginBottom="100dp"/>
+        </LinearLayout>
     </LinearLayout>
 </ScrollView>
\ No newline at end of file
diff --git a/tests/EmbeddedKitchenSinkApp/res/values/strings.xml b/tests/EmbeddedKitchenSinkApp/res/values/strings.xml
index e934c18cdf..7c72f28991 100644
--- a/tests/EmbeddedKitchenSinkApp/res/values/strings.xml
+++ b/tests/EmbeddedKitchenSinkApp/res/values/strings.xml
@@ -159,9 +159,6 @@
     <string name="reset_user" translatable="false">Reset User</string>
     <string name="assign_user" translatable="false">Assign User</string>
     <string name="unassign_user" translatable="false">Unassign User</string>
-    <string name="user_focus_unknown" translatable="false">Audio Focus Unknown</string>
-    <string name="user_has_focus" translatable="false">User Has Audio Focus</string>
-    <string name="user_does_not_have_focus" translatable="false">User Does Not Have Audio Focus</string>
     <string name="allow_passenger_playback_confirmation" translatable="false">Allow Passenger %1$s To Play Audio In Main Cabin?</string>
     <string name="request_result_message" translatable="false">Passenger %1$s %2$s To Play Audio In Main Cabin.</string>
     <string name="accept" translatable="false">Accept</string>
@@ -549,4 +546,9 @@
     <!-- Customization Switch -->
     <string name="customization_tool_switch" translatable="false">Enable the Customization Tool</string>
 
+    <!-- Data Subscription -->
+    <string name="data_subscription_inactive" translatable="false">Inactive</string>
+    <string name="data_subscription_trial" translatable="false">Trial</string>
+    <string name="data_subscription_paid" translatable="false">Paid</string>
+    <string name="data_subscription_message" translatable="false">"Data subscription status is %s</string>
 </resources>
diff --git a/tests/EmbeddedKitchenSinkApp/res/values/styles.xml b/tests/EmbeddedKitchenSinkApp/res/values/styles.xml
index d857a5c00a..2cc7fff3cc 100644
--- a/tests/EmbeddedKitchenSinkApp/res/values/styles.xml
+++ b/tests/EmbeddedKitchenSinkApp/res/values/styles.xml
@@ -59,4 +59,12 @@
         <item name="android:checkboxStyle">@style/CheckBoxStyle</item>
         <item name="android:spinnerStyle">@style/SpinnerStyle</item>
     </style>
+
+    <style name="KSDayNightTheme" parent="Theme.AppCompat.DayNight.NoActionBar">
+        <item name="android:textSize">24sp</item>
+        <item name="android:buttonStyle">@style/ButtonStyle</item>
+        <item name="android:radioButtonStyle">@style/RadioButtonStyle</item>
+        <item name="android:checkboxStyle">@style/CheckBoxStyle</item>
+        <item name="android:spinnerStyle">@style/SpinnerStyle</item>
+    </style>
 </resources>
diff --git a/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/KitchenSinkActivity.java b/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/KitchenSinkActivity.java
index e5d59ad727..216cb5c32a 100644
--- a/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/KitchenSinkActivity.java
+++ b/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/KitchenSinkActivity.java
@@ -68,6 +68,7 @@ import com.google.android.car.kitchensink.camera2.Camera2TestFragment;
 import com.google.android.car.kitchensink.carboard.KeyboardTestFragment;
 import com.google.android.car.kitchensink.cluster.InstrumentClusterFragment;
 import com.google.android.car.kitchensink.connectivity.ConnectivityFragment;
+import com.google.android.car.kitchensink.connectivity.datasubscription.DataSubscriptionTestFragment;
 import com.google.android.car.kitchensink.cube.CubesTestFragment;
 import com.google.android.car.kitchensink.customizationtool.CustomizationToolFragment;
 import com.google.android.car.kitchensink.diagnostic.DiagnosticTestFragment;
@@ -321,6 +322,7 @@ public class KitchenSinkActivity extends FragmentActivity implements KitchenSink
             new Pair<>("connectivity", ConnectivityFragment.class),
             new Pair<>("cubes test", CubesTestFragment.class),
             new Pair<>("customization tool", CustomizationToolFragment.class),
+            new Pair<>("data subscription", DataSubscriptionTestFragment.class),
             new Pair<>("device policy", DevicePolicyFragment.class),
             new Pair<>("diagnostic", DiagnosticTestFragment.class),
             new Pair<>("display info", DisplayInfoFragment.class),
diff --git a/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/cluster/ResponsiveClusterActivity.kt b/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/cluster/ResponsiveClusterActivity.kt
new file mode 100644
index 0000000000..08dd276f30
--- /dev/null
+++ b/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/cluster/ResponsiveClusterActivity.kt
@@ -0,0 +1,53 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.google.android.car.kitchensink.cluster
+
+import android.os.Bundle
+import android.view.View
+import android.view.WindowInsets
+import android.widget.FrameLayout
+import android.widget.ProgressBar
+import androidx.activity.enableEdgeToEdge
+import androidx.appcompat.app.AppCompatActivity
+import com.google.android.car.kitchensink.R
+
+class ResponsiveClusterActivity : AppCompatActivity() {
+    override fun onCreate(savedInstanceState: Bundle?) {
+        super.onCreate(savedInstanceState)
+        enableEdgeToEdge()
+        setContentView(R.layout.activity_responsive_cluster)
+        val availableWidth = resources.displayMetrics.widthPixels
+        val bar = findViewById<ProgressBar>(R.id.progressBar)!!
+
+        window.decorView.findViewById<View>(R.id.root)!!
+            .setOnApplyWindowInsetsListener { v, insets ->
+                val systemBars = insets.getInsets(WindowInsets.Type.systemOverlays())
+                var params = v.layoutParams as FrameLayout.LayoutParams
+                params.setMargins(
+                    systemBars.left,
+                    systemBars.top,
+                    systemBars.right,
+                    systemBars.bottom
+                )
+                v.layoutParams = params
+                val widthAfterInsets = availableWidth - systemBars.right - systemBars.left
+                val progress = 100 * (widthAfterInsets.toFloat()) / availableWidth
+                bar.setProgress(progress.toInt())
+                insets
+            }
+    }
+}
diff --git a/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/connectivity/datasubscription/DataSubscriptionTestFragment.java b/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/connectivity/datasubscription/DataSubscriptionTestFragment.java
new file mode 100644
index 0000000000..fa34d3dec7
--- /dev/null
+++ b/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/connectivity/datasubscription/DataSubscriptionTestFragment.java
@@ -0,0 +1,86 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.google.android.car.kitchensink.connectivity.datasubscription;
+
+import android.os.Bundle;
+import android.provider.Settings;
+import android.util.Log;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.Button;
+import android.widget.TextView;
+
+import androidx.annotation.Nullable;
+import androidx.fragment.app.Fragment;
+
+import com.android.car.datasubscription.DataSubscriptionStatus;
+
+import com.google.android.car.kitchensink.R;
+
+public class DataSubscriptionTestFragment extends Fragment {
+    private static final String TAG = DataSubscriptionTestFragment.class.getSimpleName();
+
+    public static final String FRAGMENT_NAME = "DataSubscription";
+
+    public static final String CAR_DATA_SUBSCRIPTION_STATUS = "car_data_subscription_status";
+
+    private TextView mMessage;
+
+    @Override
+    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container,
+            @Nullable Bundle savedInstanceState) {
+        View view = inflater.inflate(R.layout.data_subscription_fragment, container, false);
+        mMessage = view.findViewById(R.id.message);
+        Button inactiveButton = view.findViewById(R.id.inactive);
+        inactiveButton.setOnClickListener(v -> {
+            setDataSubscriptionStatus(DataSubscriptionStatus.INACTIVE);
+        });
+
+        Button trialButton = view.findViewById(R.id.trial);
+        trialButton.setOnClickListener(v -> {
+            setDataSubscriptionStatus(DataSubscriptionStatus.TRIAL);
+        });
+
+        Button paidButton = view.findViewById(R.id.paid);
+        paidButton.setOnClickListener(v -> {
+            setDataSubscriptionStatus(DataSubscriptionStatus.PAID);
+        });
+        return view;
+    }
+
+    private void setDataSubscriptionStatus(@DataSubscriptionStatus int dataSubscription) {
+        Settings.Global.putInt(getContext().getContentResolver(), CAR_DATA_SUBSCRIPTION_STATUS,
+                dataSubscription);
+        setMessage(getDataSubscriptionStatus());
+    }
+
+    private int getDataSubscriptionStatus() {
+        try {
+            return Settings.Global.getInt(getContext().getContentResolver(),
+                    CAR_DATA_SUBSCRIPTION_STATUS);
+        } catch (Settings.SettingNotFoundException e) {
+            Log.e(TAG, "Can't get Data Subscription status");
+        }
+        return -1;
+    }
+
+    private void setMessage(@DataSubscriptionStatus int dataSubscription) {
+        mMessage.setText(getContext().getResources().getString(R.string.data_subscription_message,
+                dataSubscription));
+    }
+}
diff --git a/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/users/ProfileUserFragment.java b/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/users/ProfileUserFragment.java
index 8552f4d039..8b2d33fb60 100644
--- a/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/users/ProfileUserFragment.java
+++ b/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink/users/ProfileUserFragment.java
@@ -494,7 +494,6 @@ public class ProfileUserFragment extends Fragment {
     private ArrayList<String> getApps() {
         ArrayList<String> apps = new ArrayList<>();
         apps.add("com.google.android.car.kitchensink/.KitchenSinkActivity");
-        apps.add("com.android.car.multidisplay/.launcher.LauncherActivity");
         apps.add("com.google.android.car.multidisplaytest/.MDTest");
         return apps;
     }
diff --git a/tests/MultiDisplaySecondaryHomeTestLauncher/Android.bp b/tests/MultiDisplaySecondaryHomeTestLauncher/Android.bp
index ebd445ac31..49a8a5ad2a 100644
--- a/tests/MultiDisplaySecondaryHomeTestLauncher/Android.bp
+++ b/tests/MultiDisplaySecondaryHomeTestLauncher/Android.bp
@@ -35,6 +35,5 @@ android_app {
 
     platform_apis: true,
     privileged: true,
-    required: ["allowed_privapp_com.android.car.multidisplay"],
     system_ext_specific: true,
 }
diff --git a/tests/OccupantAwareness/Android.bp b/tests/OccupantAwareness/Android.bp
index 2aadc4aff9..1580caeb25 100644
--- a/tests/OccupantAwareness/Android.bp
+++ b/tests/OccupantAwareness/Android.bp
@@ -34,9 +34,9 @@ android_test {
 
     libs: [
         "android.car",
-        "android.test.base",
-        "android.test.mock",
-        "android.test.runner",
+        "android.test.base.stubs.system",
+        "android.test.mock.stubs.system",
+        "android.test.runner.stubs.system",
         // After here
         "android.car-test-stubs",
         "android.car.testapi",
diff --git a/tests/SampleCustomInputService/Android.bp b/tests/SampleCustomInputService/Android.bp
index 15a0709576..82046aefe0 100644
--- a/tests/SampleCustomInputService/Android.bp
+++ b/tests/SampleCustomInputService/Android.bp
@@ -67,9 +67,9 @@ android_test {
     ],
     libs: [
         "android.car-system-stubs",
-        "android.test.mock",
-        "android.test.base",
-        "android.test.runner",
+        "android.test.mock.stubs.system",
+        "android.test.base.stubs.system",
+        "android.test.runner.stubs.system",
     ],
 
     // Required by mockito-target-extended (lib used to mock final classes).
diff --git a/tests/SampleCustomInputService/src/com/android/car/custominput/sample/CustomInputEventListener.java b/tests/SampleCustomInputService/src/com/android/car/custominput/sample/CustomInputEventListener.java
index b9ed208a91..4a3b342ecb 100644
--- a/tests/SampleCustomInputService/src/com/android/car/custominput/sample/CustomInputEventListener.java
+++ b/tests/SampleCustomInputService/src/com/android/car/custominput/sample/CustomInputEventListener.java
@@ -48,6 +48,7 @@ public final class CustomInputEventListener {
             "com.android.car.custominput.sample.driverui.action";
     private static final String NOTIFY_DRIVER_UI_EXTRA_KEY = "NOTIFY_DRIVER_UI_EXTRA_KEY";
     private static final String NOTIFY_DRIVER_UI_MOVE_NAV_VIEW = "MOVE_NAV_VIEW";
+    private static final String NOTIFY_DRIVER_UI_WIDGET_MODE = "WIDGET_MODE";
 
     private final SampleCustomInputService mService;
     private final Context mContext;
@@ -90,6 +91,9 @@ public final class CustomInputEventListener {
 
         /** Notify DriverUi to move the navigation view */
         int DRIVER_UI_MOVE_NAVIGATION_VIEW = 1011;
+
+        /** Notify DriverUi to update widget mode */
+        int DRIVER_UI_UPDATE_WIDGET_MODE = 1012;
     }
 
     public CustomInputEventListener(
@@ -145,6 +149,8 @@ public final class CustomInputEventListener {
             case EventAction.DRIVER_UI_MOVE_NAVIGATION_VIEW:
                 notifyDriverUi(NOTIFY_DRIVER_UI_MOVE_NAV_VIEW);
                 break;
+            case EventAction.DRIVER_UI_UPDATE_WIDGET_MODE:
+                notifyDriverUi(NOTIFY_DRIVER_UI_WIDGET_MODE);
             default:
                 Log.e(TAG, "Ignoring event [" + action + "]");
         }
@@ -183,7 +189,6 @@ public final class CustomInputEventListener {
         }
         Intent driveUiIntent = new Intent(NOTIFY_DRIVER_UI_ACTION);
         driveUiIntent.putExtra(NOTIFY_DRIVER_UI_EXTRA_KEY, action);
-        driveUiIntent.addFlags(Intent.FLAG_INCLUDE_STOPPED_PACKAGES);
         mService.sendBroadcast(driveUiIntent);
     }
 
diff --git a/tests/SampleCustomInputService/tests/src/com/android/car/custominput/sample/unittest/CustomInputEventListenerTest.java b/tests/SampleCustomInputService/tests/src/com/android/car/custominput/sample/unittest/CustomInputEventListenerTest.java
index 12085e6ab6..0edd0d160c 100644
--- a/tests/SampleCustomInputService/tests/src/com/android/car/custominput/sample/unittest/CustomInputEventListenerTest.java
+++ b/tests/SampleCustomInputService/tests/src/com/android/car/custominput/sample/unittest/CustomInputEventListenerTest.java
@@ -22,6 +22,8 @@ import static android.media.AudioAttributes.AttributeUsage;
 
 import static com.android.car.custominput.sample.CustomInputEventListener.EventAction.INJECT_VOICE_ASSIST_ACTION_DOWN;
 import static com.android.car.custominput.sample.CustomInputEventListener.EventAction.INJECT_VOICE_ASSIST_ACTION_UP;
+import static com.android.car.custominput.sample.CustomInputEventListener.EventAction.DRIVER_UI_MOVE_NAVIGATION_VIEW;
+import static com.android.car.custominput.sample.CustomInputEventListener.EventAction.DRIVER_UI_UPDATE_WIDGET_MODE;
 
 import static com.google.common.truth.Truth.assertThat;
 
@@ -76,6 +78,12 @@ public class CustomInputEventListenerTest {
     // Minimum volume for alert and media
     private static final int MIN_VOLUME = 0;
 
+    private static final String NOTIFY_DRIVER_UI_ACTION =
+            "com.android.car.custominput.sample.driverui.action";
+    private static final String NOTIFY_DRIVER_UI_EXTRA_KEY = "NOTIFY_DRIVER_UI_EXTRA_KEY";
+    private static final String NOTIFY_DRIVER_UI_MOVE_NAV_VIEW = "MOVE_NAV_VIEW";
+    private static final String NOTIFY_DRIVER_UI_WIDGET_MODE = "WIDGET_MODE";
+
     private CustomInputEventListener mEventHandler;
 
     @Mock
@@ -363,6 +371,50 @@ public class CustomInputEventListenerTest {
                 new KeyEvent(KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_VOICE_ASSIST));
     }
 
+    @Test
+    public void testHandleEvent_injectDriverUINavigationViewAction() {
+        // Arrange
+        CustomInputEvent event = new CustomInputEvent(
+                /* inputCode= */ DRIVER_UI_MOVE_NAVIGATION_VIEW,
+                /* targetDisplayType= */ SOME_DISPLAY_TYPE,
+                /* repeatCounter= */ 1);
+
+        // Act
+        mEventHandler.handle(SOME_DISPLAY_TYPE, event);
+
+        // Assert
+        ArgumentCaptor<Intent> intentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mService).sendBroadcast(intentCaptor.capture());
+
+        // Assert intent parameter
+        Intent actualIntent = intentCaptor.getValue();
+        assertThat(actualIntent.getAction()).isEqualTo(NOTIFY_DRIVER_UI_ACTION);
+        assertThat(actualIntent.getStringExtra(NOTIFY_DRIVER_UI_EXTRA_KEY)).isEqualTo(
+                NOTIFY_DRIVER_UI_MOVE_NAV_VIEW);
+    }
+
+    @Test
+    public void testHandleEvent_injectDriverUIWidgetModeAction() {
+        // Arrange
+        CustomInputEvent event = new CustomInputEvent(
+                /* inputCode= */ DRIVER_UI_UPDATE_WIDGET_MODE,
+                /* targetDisplayType= */ SOME_DISPLAY_TYPE,
+                /* repeatCounter= */ 1);
+
+        // Act
+        mEventHandler.handle(SOME_DISPLAY_TYPE, event);
+
+        // Assert
+        ArgumentCaptor<Intent> intentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mService).sendBroadcast(intentCaptor.capture());
+
+        // Assert intent parameter
+        Intent actualIntent = intentCaptor.getValue();
+        assertThat(actualIntent.getAction()).isEqualTo(NOTIFY_DRIVER_UI_ACTION);
+        assertThat(actualIntent.getStringExtra(NOTIFY_DRIVER_UI_EXTRA_KEY)).isEqualTo(
+                NOTIFY_DRIVER_UI_WIDGET_MODE);
+    }
+
     private void assertKeyEvents(int expectedDisplayType, KeyEvent... events) {
         ArgumentCaptor<KeyEvent> keyEventCaptor = ArgumentCaptor.forClass(KeyEvent.class);
         ArgumentCaptor<Integer> displayTypeCaptor = ArgumentCaptor.forClass(Integer.class);
diff --git a/tests/SampleVoiceAssistInputService/Android.bp b/tests/SampleVoiceAssistInputService/Android.bp
index a1254f572f..98c25d0d31 100644
--- a/tests/SampleVoiceAssistInputService/Android.bp
+++ b/tests/SampleVoiceAssistInputService/Android.bp
@@ -65,9 +65,9 @@ android_test {
     ],
     libs: [
         "android.car-system-stubs",
-        "android.test.mock",
-        "android.test.base",
-        "android.test.runner",
+        "android.test.mock.stubs.system",
+        "android.test.base.stubs.system",
+        "android.test.runner.stubs.system",
     ],
 
     // Required by mockito-target-extended (lib used to mock final classes).
diff --git a/tests/android_car_api_test/Android.bp b/tests/android_car_api_test/Android.bp
index 7954bbb70c..1af4488735 100644
--- a/tests/android_car_api_test/Android.bp
+++ b/tests/android_car_api_test/Android.bp
@@ -61,8 +61,8 @@ android_test {
 
     libs: [
         "android.car",
-        "android.test.runner",
-        "android.test.base",
+        "android.test.runner.stubs.system",
+        "android.test.base.stubs.system",
     ],
 
     // mockito-target-inline dependency
diff --git a/tests/android_car_api_test/AndroidManifest.xml b/tests/android_car_api_test/AndroidManifest.xml
index 55292c207b..f839101282 100644
--- a/tests/android_car_api_test/AndroidManifest.xml
+++ b/tests/android_car_api_test/AndroidManifest.xml
@@ -229,6 +229,7 @@
         <activity android:name=".TestDrivingSafetyRegionNoMetadataActivity"
                   android:exported="true">
         </activity>
+        <activity android:name=".CarDisplayInputLockTest$TestActivity" />
         <service android:name=".CarProjectionManagerTest$TestService"
              android:exported="true"/>
         <service android:name="com.android.car.internal.test.LargeParcelableTestService"
diff --git a/tests/android_car_api_test/src/android/car/apitest/CarDisplayInputLockTest.java b/tests/android_car_api_test/src/android/car/apitest/CarDisplayInputLockTest.java
new file mode 100644
index 0000000000..7ef38eac10
--- /dev/null
+++ b/tests/android_car_api_test/src/android/car/apitest/CarDisplayInputLockTest.java
@@ -0,0 +1,262 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package android.car.apitest;
+
+import static com.android.compatibility.common.util.ShellUtils.runShellCommand;
+
+import static com.google.common.truth.Truth.assertThat;
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.junit.Assume.assumeTrue;
+
+import android.app.Activity;
+import android.app.Instrumentation;
+import android.car.settings.CarSettings;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.graphics.Color;
+import android.hardware.display.DisplayManager;
+import android.os.Bundle;
+import android.os.ConditionVariable;
+import android.os.SystemClock;
+import android.os.UserManager;
+import android.provider.Settings;
+import android.view.Display;
+import android.view.InputDevice;
+import android.view.MotionEvent;
+import android.view.View;
+import android.widget.TextView;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.test.core.app.ActivityScenario;
+import androidx.test.filters.SmallTest;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.runner.AndroidJUnit4;
+
+import com.android.bedstead.harrier.DeviceState;
+import com.android.bedstead.harrier.annotations.RequireRunNotOnVisibleBackgroundNonProfileUser;
+import com.android.bedstead.harrier.annotations.RequireRunOnVisibleBackgroundNonProfileUser;
+import com.android.compatibility.common.util.PollingCheck;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.ClassRule;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@SmallTest
+@RunWith(AndroidJUnit4.class)
+public class CarDisplayInputLockTest {
+    private static final long INPUT_LOCK_UPDATE_WAIT_TIME_MS = 10_000L;
+    private static final long ACTIVITY_WAIT_TIME_OUT_MS = 10_000L;
+    private static final String EMPTY_SETTING_VALUE = "";
+
+    @Rule
+    @ClassRule
+    public static final DeviceState sDeviceState = new DeviceState();
+
+    private Context mContext;
+    private DisplayManager mDisplayManager;
+    private Instrumentation mInstrumentation;
+    private ContentResolver mContentResolver;
+    private String mInitialSettingValue;
+    private TestActivity mActivity;
+
+    @Before
+    public void setUp() throws Exception {
+        mContext = InstrumentationRegistry.getInstrumentation().getTargetContext();
+        UserManager userManager = mContext.getSystemService(UserManager.class);
+        assumeTrue("This test is enabled only in multi-user/multi-display devices",
+                userManager.isVisibleBackgroundUsersSupported());
+
+        mDisplayManager = mContext.getSystemService(DisplayManager.class);
+        mInstrumentation = InstrumentationRegistry.getInstrumentation();
+        mContentResolver = mContext.getContentResolver();
+        mInitialSettingValue = getDisplayInputLockSetting(mContentResolver);
+        unlockInputForAllDisplays();
+    }
+
+    @After
+    public void tearDown() {
+        if (mContentResolver != null) {
+            writeDisplayInputLockSetting(mContentResolver, mInitialSettingValue);
+        }
+    }
+
+    @Test
+    @RequireRunNotOnVisibleBackgroundNonProfileUser
+    public void testDisplayInputLockForDriverDisplay() {
+        try (ActivityScenario<TestActivity> scenario =
+                ActivityScenario.launch(TestActivity.class)) {
+            waitForActivityStart(scenario);
+            int displayId = mActivity.getDisplayId();
+            Display display = mDisplayManager.getDisplay(displayId);
+            assertThat(display).isNotNull();
+            String displayUniqueId = display.getUniqueId();
+
+            // Try to lock the driver display
+            lockInputForDisplays(displayUniqueId);
+
+            // Verify that DisplayInputLock ignores the trial to lock the driver display.
+            assertDisplayInputSinkCreated(displayId, /* created= */ false);
+            doTestDisplayInputLock(displayId, /* touchReceived= */ true);
+        }
+    }
+
+    @Test
+    @RequireRunOnVisibleBackgroundNonProfileUser
+    public void testDisplayInputLockForPassengerDisplay() {
+        try (ActivityScenario<TestActivity> scenario =
+                ActivityScenario.launch(TestActivity.class)) {
+            waitForActivityStart(scenario);
+            int displayId = mActivity.getDisplayId();
+            Display display = mDisplayManager.getDisplay(displayId);
+            assertThat(display).isNotNull();
+            String displayUniqueId = display.getUniqueId();
+
+            doTestDisplayInputLock(displayId, /* touchReceived= */ true);
+
+            lockInputForDisplays(displayUniqueId);
+            assertDisplayInputSinkCreated(displayId, /* created= */ true);
+            doTestDisplayInputLock(displayId, /* touchReceived= */ false);
+
+            unlockInputForAllDisplays();
+            assertAllDisplayInputSinksRemoved();
+            doTestDisplayInputLock(displayId, /* touchReceived= */ true);
+        }
+    }
+
+    private void waitForActivityStart(ActivityScenario<TestActivity> scenario) {
+        ConditionVariable activityReferenceObtained = new ConditionVariable();
+        scenario.onActivity(activity -> {
+            mActivity = activity;
+            activityReferenceObtained.open();
+        });
+        activityReferenceObtained.block(ACTIVITY_WAIT_TIME_OUT_MS);
+        assertWithMessage("Failed to acquire activity reference.").that(mActivity).isNotNull();
+    }
+
+    private void doTestDisplayInputLock(int displayId, boolean touchReceived) {
+        tapOnDisplay(displayId);
+        PollingCheck.waitFor(() -> mActivity.mIsTouchesReceived == touchReceived);
+        mActivity.resetTouchesReceived();
+
+        mouseClickOnDisplay(displayId);
+        PollingCheck.waitFor(() -> mActivity.mIsTouchesReceived == touchReceived);
+        mActivity.resetTouchesReceived();
+    }
+
+    private void assertDisplayInputSinkCreated(int displayId, boolean created) {
+        PollingCheck.waitFor(INPUT_LOCK_UPDATE_WAIT_TIME_MS, () -> {
+            String cmdOut = runShellCommand("dumpsys input");
+            return cmdOut.contains("DisplayInputSink-" + displayId) == created;
+        });
+    }
+
+    private void assertAllDisplayInputSinksRemoved() {
+        PollingCheck.waitFor(INPUT_LOCK_UPDATE_WAIT_TIME_MS, () -> {
+            String cmdOut = runShellCommand("dumpsys input");
+            return !cmdOut.contains("DisplayInputSink");
+        });
+    }
+
+    @Nullable
+    private String getDisplayInputLockSetting(@NonNull ContentResolver resolver) {
+        return Settings.Global.getString(resolver,
+                CarSettings.Global.DISPLAY_INPUT_LOCK);
+    }
+
+    private void lockInputForDisplays(String displayUniqueIds) {
+        writeDisplayInputLockSetting(mContentResolver, displayUniqueIds);
+    }
+
+    private void unlockInputForAllDisplays() {
+        writeDisplayInputLockSetting(mContentResolver, EMPTY_SETTING_VALUE);
+    }
+
+    private void writeDisplayInputLockSetting(@NonNull ContentResolver resolver,
+            @NonNull String value) {
+        Settings.Global.putString(resolver, CarSettings.Global.DISPLAY_INPUT_LOCK, value);
+    }
+
+    private void tapOnDisplay(int displayId) {
+        injectMotionEvent(obtainMotionEvent(InputDevice.SOURCE_TOUCHSCREEN,
+                mActivity.mView, MotionEvent.ACTION_DOWN, displayId));
+        injectMotionEvent(obtainMotionEvent(InputDevice.SOURCE_TOUCHSCREEN,
+                mActivity.mView, MotionEvent.ACTION_UP, displayId));
+    }
+
+    private void mouseClickOnDisplay(int displayId) {
+        injectMotionEvent(obtainMouseEvent(
+                mActivity.mView, MotionEvent.ACTION_DOWN, displayId));
+        injectMotionEvent(obtainMouseEvent(
+                mActivity.mView, MotionEvent.ACTION_BUTTON_PRESS, displayId));
+        injectMotionEvent(obtainMouseEvent(
+                mActivity.mView, MotionEvent.ACTION_BUTTON_RELEASE, displayId));
+        injectMotionEvent(obtainMouseEvent(
+                mActivity.mView, MotionEvent.ACTION_UP, displayId));
+    }
+
+    private void injectMotionEvent(MotionEvent event) {
+        mInstrumentation.getUiAutomation().injectInputEvent(event,
+                /* sync= */ true, /* waitAnimations= */ true);
+    }
+
+    private static MotionEvent obtainMouseEvent(View target, int action, int displayId) {
+        return obtainMotionEvent(InputDevice.SOURCE_MOUSE, target, action, displayId);
+    }
+
+    private static MotionEvent obtainMotionEvent(int source, View target, int action,
+            int displayId) {
+        long eventTime = SystemClock.uptimeMillis();
+        int[] xy = new int[2];
+        target.getLocationOnScreen(xy);
+        MotionEvent event = MotionEvent.obtain(eventTime, eventTime, action,
+                xy[0] + target.getWidth() / 2, xy[1] + target.getHeight() / 2,
+                /* metaState= */ 0);
+        event.setSource(source);
+        event.setDisplayId(displayId);
+        return event;
+    }
+
+    public static class TestActivity extends Activity {
+        public boolean mIsTouchesReceived;
+        public TextView mView;
+
+        @Override
+        protected void onCreate(@Nullable Bundle savedInstanceState) {
+            super.onCreate(savedInstanceState);
+            mView = new TextView(this);
+            mView.setText("Display Input Lock");
+            mView.setBackgroundColor(Color.GREEN);
+            mView.setOnClickListener(this::onClick);
+
+            setContentView(mView);
+        }
+
+        /** Reset the touches received field */
+        public void resetTouchesReceived() {
+            mIsTouchesReceived = false;
+        }
+
+        private void onClick(View view) {
+            mIsTouchesReceived = true;
+        }
+    }
+}
diff --git a/tests/android_car_api_test/src/android/car/apitest/CarFeatureTest.java b/tests/android_car_api_test/src/android/car/apitest/CarFeatureTest.java
index 23bf1765ab..a14ac0398f 100644
--- a/tests/android_car_api_test/src/android/car/apitest/CarFeatureTest.java
+++ b/tests/android_car_api_test/src/android/car/apitest/CarFeatureTest.java
@@ -87,7 +87,6 @@ public final class CarFeatureTest extends CarApiTestBase {
             Car.CAR_OCCUPANT_CONNECTION_SERVICE,
             Car.CAR_REMOTE_DEVICE_SERVICE,
             Car.DIAGNOSTIC_SERVICE,
-            Car.EXPERIMENTAL_CAR_USER_SERVICE,
             Car.OCCUPANT_AWARENESS_SERVICE,
             Car.STORAGE_MONITORING_SERVICE,
             Car.VEHICLE_MAP_SERVICE,
diff --git a/tests/android_car_api_test/src/android/car/apitest/CarGetCarManagerTest.java b/tests/android_car_api_test/src/android/car/apitest/CarGetCarManagerTest.java
index a2ff3dbb51..c71073c7ad 100644
--- a/tests/android_car_api_test/src/android/car/apitest/CarGetCarManagerTest.java
+++ b/tests/android_car_api_test/src/android/car/apitest/CarGetCarManagerTest.java
@@ -51,7 +51,6 @@ import android.car.storagemonitoring.CarStorageMonitoringManager;
 import android.car.telemetry.CarTelemetryManager;
 import android.car.test.CarTestManager;
 import android.car.user.CarUserManager;
-import android.car.user.ExperimentalCarUserManager;
 import android.car.vms.VmsClientManager;
 import android.car.vms.VmsSubscriberManager;
 import android.car.watchdog.CarWatchdogManager;
@@ -113,7 +112,6 @@ public final class CarGetCarManagerTest extends CarLessApiTestBase {
             {CarTestManager.class, Car.TEST_SERVICE},
             {CarEvsManager.class, Car.CAR_EVS_SERVICE},
             {CarTelemetryManager.class, Car.CAR_TELEMETRY_SERVICE},
-            {ExperimentalCarUserManager.class, Car.EXPERIMENTAL_CAR_USER_SERVICE},
             {CarInstrumentClusterManager.class, Car.CAR_INSTRUMENT_CLUSTER_SERVICE},
             {OccupantAwarenessManager.class, Car.OCCUPANT_AWARENESS_SERVICE},
             {CarActivityManager.class, Car.CAR_ACTIVITY_SERVICE}
diff --git a/tests/android_car_api_test/src/android/car/apitest/CarMultiUserTestBase.java b/tests/android_car_api_test/src/android/car/apitest/CarMultiUserTestBase.java
index 7d4d98b2ae..47070fe0d8 100644
--- a/tests/android_car_api_test/src/android/car/apitest/CarMultiUserTestBase.java
+++ b/tests/android_car_api_test/src/android/car/apitest/CarMultiUserTestBase.java
@@ -126,7 +126,7 @@ abstract class CarMultiUserTestBase extends CarApiTestBase {
                 break;
             }
         }
-        assertWithMessage("user for currentId %s").that(mInitialUser).isNotNull();
+        assertWithMessage("user for currentId %s", currentUserId).that(mInitialUser).isNotNull();
 
         // Make sure current user is not a left-over from previous test
         if (isUserCreatedByTheseTests(mInitialUser)) {
diff --git a/tests/android_car_api_test/src/android/car/apitest/CarUserManagerTest.java b/tests/android_car_api_test/src/android/car/apitest/CarUserManagerTest.java
index cb568ed6cd..6ae7f20235 100644
--- a/tests/android_car_api_test/src/android/car/apitest/CarUserManagerTest.java
+++ b/tests/android_car_api_test/src/android/car/apitest/CarUserManagerTest.java
@@ -44,6 +44,8 @@ import android.os.UserHandle;
 import android.os.UserManager;
 import android.util.Log;
 
+import androidx.test.filters.FlakyTest;
+
 import com.android.compatibility.common.util.ApiTest;
 
 import org.junit.AfterClass;
@@ -276,6 +278,7 @@ public final class CarUserManagerTest extends CarMultiUserTestBase {
      * Tests resume behavior when current user is guest but with secured lock screen,
      * resume to same guest user.
      */
+    @FlakyTest(bugId = 357135725)
     @Test
     @ApiTest(apis = {
             "android.car.user.CarUserManager#USER_LIFECYCLE_EVENT_TYPE_UNLOCKED",
@@ -320,6 +323,7 @@ public final class CarUserManagerTest extends CarMultiUserTestBase {
     /**
      * Tests resume behavior when current user is persistent user.
      */
+    @FlakyTest(bugId = 357135725)
     @Test
     @ApiTest(apis = {
             "android.car.user.CarUserManager#USER_LIFECYCLE_EVENT_TYPE_UNLOCKED",
diff --git a/tests/android_car_api_test/src/android/car/apitest/GrammaticalInflectionManagerTest.java b/tests/android_car_api_test/src/android/car/apitest/GrammaticalInflectionManagerTest.java
new file mode 100644
index 0000000000..a4874d9739
--- /dev/null
+++ b/tests/android_car_api_test/src/android/car/apitest/GrammaticalInflectionManagerTest.java
@@ -0,0 +1,90 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package android.car.apitest;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assert.assertThrows;
+
+import android.Manifest;
+import android.app.GrammaticalInflectionManager;
+import android.app.Instrumentation;
+import android.app.UiAutomation;
+import android.content.Context;
+import android.content.res.Configuration;
+
+import androidx.test.InstrumentationRegistry;
+
+import com.android.bedstead.harrier.DeviceState;
+import com.android.bedstead.harrier.annotations.RequireRunOnVisibleBackgroundNonProfileUser;
+import com.android.bedstead.harrier.annotations.RequireVisibleBackgroundUsers;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.ClassRule;
+import org.junit.Rule;
+import org.junit.Test;
+
+// TODO(b/353837838): Move to CTS once GrammaticalInflection APIs are test APIs.
+public class GrammaticalInflectionManagerTest extends CarApiTestBase {
+
+    private static final String TAG = GrammaticalInflectionManagerTest.class.getSimpleName();
+
+    private final Instrumentation mInstrumentation =
+            InstrumentationRegistry.getInstrumentation();
+    private final Context mContext = mInstrumentation.getContext();
+    private final UiAutomation mUiAutomation = mInstrumentation.getUiAutomation();
+    private final GrammaticalInflectionManager mGrammaticalInflectionManager =
+            mContext.getSystemService(GrammaticalInflectionManager.class);
+    int mPreviousGrammaticalGender;
+
+    @Rule
+    @ClassRule
+    public static final DeviceState sDeviceState = new DeviceState();
+
+    @Before
+    public void setUp() {
+        mUiAutomation.adoptShellPermissionIdentity(
+                Manifest.permission.READ_SYSTEM_GRAMMATICAL_GENDER);
+        mPreviousGrammaticalGender = mGrammaticalInflectionManager.getSystemGrammaticalGender();
+    }
+
+    @After
+    public void cleanUp() {
+        // Reset the System Grammatical Gender
+        try {
+            mGrammaticalInflectionManager.setSystemWideGrammaticalGender(
+                    mPreviousGrammaticalGender);
+        } catch (Exception e) {
+            // Ignore
+        }
+        mUiAutomation.dropShellPermissionIdentity();
+    }
+
+    @Test
+    @RequireVisibleBackgroundUsers(reason = "Passengers are not allowed to change "
+            + "GrammaticalInflection.")
+    @RequireRunOnVisibleBackgroundNonProfileUser
+    public void testPassengerCantChangeGrammaticalInflection() {
+        Exception e = assertThrows(SecurityException.class,
+                () -> mGrammaticalInflectionManager.setSystemWideGrammaticalGender(
+                        Configuration.GRAMMATICAL_GENDER_MASCULINE));
+
+        assertThat(e).hasMessageThat().contains(
+                "Only current user is allowed to update GrammaticalInflection.");
+    }
+}
diff --git a/tests/android_car_api_test/src/android/car/apitest/PreInstalledPackagesTest.java b/tests/android_car_api_test/src/android/car/apitest/PreInstalledPackagesTest.java
index 95b3aae727..22c7ce9cd0 100644
--- a/tests/android_car_api_test/src/android/car/apitest/PreInstalledPackagesTest.java
+++ b/tests/android_car_api_test/src/android/car/apitest/PreInstalledPackagesTest.java
@@ -22,6 +22,8 @@ import static org.junit.Assert.fail;
 import android.platform.test.annotations.Presubmit;
 import android.text.TextUtils;
 
+import androidx.test.filters.FlakyTest;
+
 import com.android.compatibility.common.util.NonApiTest;
 
 import org.junit.Test;
@@ -37,6 +39,7 @@ public final class PreInstalledPackagesTest extends CarLessApiTestBase {
         assertNoCriticalErrors(/* enforceMode= */ false);
     }
 
+    @FlakyTest(bugId = 330923013)
     @Test
     @NonApiTest(exemptionReasons = {}, justification = "Testing package allowlist, which is not "
             + "an API or CDD requirement")
diff --git a/tests/android_car_api_test/src/android/car/apitest/VehiclePropertyIdsTest.java b/tests/android_car_api_test/src/android/car/apitest/VehiclePropertyIdsTest.java
index 74a7b68e19..176e521a5b 100644
--- a/tests/android_car_api_test/src/android/car/apitest/VehiclePropertyIdsTest.java
+++ b/tests/android_car_api_test/src/android/car/apitest/VehiclePropertyIdsTest.java
@@ -57,7 +57,8 @@ public final class VehiclePropertyIdsTest extends CarLessApiTestBase {
                     "SUPPORTED_PROPERTY_IDS",
                     "STORAGE_ENCRYPTION_BINDING_SEED",
                     "SHUTDOWN_REQUEST",
-                    "VEHICLE_IN_USE");
+                    "VEHICLE_IN_USE",
+                    "PER_DISPLAY_MAX_BRIGHTNESS");
 
     @Test
     @NonApiTest(exemptionReasons = {}, justification = "Large number of constant fields")
diff --git a/tests/carservice_test/Android.bp b/tests/carservice_test/Android.bp
deleted file mode 100644
index 5c72f49c4a..0000000000
--- a/tests/carservice_test/Android.bp
+++ /dev/null
@@ -1,82 +0,0 @@
-// Copyright (C) 2015 The Android Open Source Project
-//
-// Licensed under the Apache License, Version 2.0 (the "License");
-// you may not use this file except in compliance with the License.
-// You may obtain a copy of the License at
-//
-//      http://www.apache.org/licenses/LICENSE-2.0
-//
-// Unless required by applicable law or agreed to in writing, software
-// distributed under the License is distributed on an "AS IS" BASIS,
-// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-// See the License for the specific language governing permissions and
-// limitations under the License.
-//
-//
-
-package {
-    default_team: "trendy_team_aaos_framework",
-    default_applicable_licenses: ["Android-Apache-2.0"],
-}
-
-android_test {
-    name: "CarServiceTest",
-
-    srcs: ["src/**/*.java"],
-
-    resource_dirs: ["res"],
-
-    aaptflags: [
-        "--extra-packages com.android.car",
-        "--auto-add-overlay",
-    ],
-
-    platform_apis: true,
-
-    // for system|privileged permission.
-    certificate: "platform",
-
-    // When built explicitly put it in the data partition
-
-    optimize: {
-        enabled: false,
-    },
-
-    static_libs: [
-        "junit",
-        "android.car.test.utils",
-        "android.car.testapi",
-        "androidx.test.ext.junit",
-        "androidx.test.rules",
-        "android.frameworks.automotive.powerpolicy-V3-java",
-        "android.hardware.automotive.vehicle-V2.0-java",
-        "car-service-test-static-lib",
-        "car-service-builtin-test-static-lib",
-        "com.android.car.test.lib",
-        "mockito-target-extended",
-        "truth",
-        "compatibility-device-util-axt",
-        "vehicle-hal-support-lib",
-    ],
-
-    libs: [
-        "android.car",
-        "android.car.watchdoglib",
-        "android.test.runner",
-        "android.test.base",
-    ],
-
-    // mockito-target-inline dependency
-    jni_libs: [
-        "libdexmakerjvmtiagent",
-        "libstaticjvmtiagent",
-        "libcarservicejni",
-    ],
-
-    test_suites: [
-        "device-tests",
-        "automotive-tests",
-    ],
-    // TODO(b/319708040): re-enable use_resource_processor
-    use_resource_processor: false,
-}
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_V3_missing_output_address.xml b/tests/carservice_test/res/raw/car_audio_configuration_V3_missing_output_address.xml
deleted file mode 100644
index d59e4bdd9d..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_V3_missing_output_address.xml
+++ /dev/null
@@ -1,44 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2024 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioConfiguration version="3">
-    <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
-            <zoneConfigs>
-                <zoneConfig name="primary zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group>
-                            <device address="bus0_media_out">
-                                <context context="music"/>
-                            </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
-                            </device>
-                        </group>
-                        <group>
-                            <device>
-                                <context context="navigation"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_ports.xml b/tests/carservice_test/res/raw/car_audio_configuration_duplicate_ports.xml
deleted file mode 100644
index 08b461dbd4..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_ports.xml
+++ /dev/null
@@ -1,40 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2023 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioConfiguration version="3">
-    <zones>
-        <zone name="primary zone" isPrimary="true">
-            <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group>
-                            <device address="bus0_media_out">
-                                <context context="music"/>
-                            </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
-                            </device>
-                        </group>
-                        <group>
-                            <device address="bus1_navigation_out">
-                                <context context="navigation"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_invalid_version.xml b/tests/carservice_test/res/raw/car_audio_configuration_invalid_version.xml
deleted file mode 100644
index e640a3aef9..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_invalid_version.xml
+++ /dev/null
@@ -1,38 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-  ~ Copyright (C) 2024 The Android Open Source Project
-  ~
-  ~ Licensed under the Apache License, Version 2.0 (the "License");
-  ~ you may not use this file except in compliance with the License.
-  ~ You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<carAudioConfiguration version="0">
-    <zones>
-        <zone name="primary zone" isPrimary="true">
-            <volumeGroups>
-                <group>
-                    <device address="bus0_media_out">
-                        <context context="music"/>
-                    </device>
-                    <device address="bus3_call_ring_out">
-                        <context context="call_ring"/>
-                    </device>
-                </group>
-                <group>
-                    <device address="bus1_navigation_out">
-                        <context context="navigation"/>
-                    </device>
-                </group>
-            </volumeGroups>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_no_audio_zone_id_for_primary_zone.xml b/tests/carservice_test/res/raw/car_audio_configuration_no_audio_zone_id_for_primary_zone.xml
deleted file mode 100644
index 1ff7168895..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_no_audio_zone_id_for_primary_zone.xml
+++ /dev/null
@@ -1,70 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-  ~ Copyright (C) 2020 The Android Open Source Project
-  ~
-  ~ Licensed under the Apache License, Version 2.0 (the "License");
-  ~ you may not use this file except in compliance with the License.
-  ~ You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<carAudioConfiguration version="3">
-    <zones>
-        <zone name="primary zone" isPrimary="true">
-            <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group>
-                            <device address="bus0_media_out">
-                                <context context="music"/>
-                            </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
-                            </device>
-                        </group>
-                        <group>
-                            <device address="bus1_navigation_out">
-                                <context context="navigation"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-        <zone name="rear seat zone" audioZoneId="2" occupantZoneId="1">
-            <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
-                <volumeGroups>
-                    <group>
-                        <device address="bus100_rear_seat">
-                            <context context="music"/>
-                            <context context="navigation"/>
-                            <context context="voice_command"/>
-                            <context context="call_ring"/>
-                            <context context="call"/>
-                            <context context="alarm"/>
-                            <context context="notification"/>
-                            <context context="system_sound"/>
-                            <context context="emergency"/>
-                            <context context="safety"/>
-                            <context context="vehicle_status"/>
-                            <context context="announcement"/>
-                        </device>
-                    </group>
-                </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_non_numerical_port.xml b/tests/carservice_test/res/raw/car_audio_configuration_non_numerical_port.xml
deleted file mode 100644
index ed9dcbef0a..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_non_numerical_port.xml
+++ /dev/null
@@ -1,44 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2023 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioConfiguration version="3">
-    <zones>
-        <zone name="primary zone" isPrimary="true">
-            <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group>
-                            <device address="bus0_media_out">
-                                <context context="music"/>
-                            </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
-                            </device>
-                        </group>
-                        <group>
-                            <device address="bus1_navigation_out">
-                                <context context="navigation"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_non_primary_zone_with_primary_audio_zone_id.xml b/tests/carservice_test/res/raw/car_audio_configuration_non_primary_zone_with_primary_audio_zone_id.xml
deleted file mode 100644
index 6a3b9af2b8..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_non_primary_zone_with_primary_audio_zone_id.xml
+++ /dev/null
@@ -1,66 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-  ~ Copyright (C) 2020 The Android Open Source Project
-  ~
-  ~ Licensed under the Apache License, Version 2.0 (the "License");
-  ~ you may not use this file except in compliance with the License.
-  ~ You may obtain a copy of the License at
-  ~
-  ~      http://www.apache.org/licenses/LICENSE-2.0
-  ~
-  ~ Unless required by applicable law or agreed to in writing, software
-  ~ distributed under the License is distributed on an "AS IS" BASIS,
-  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-  ~ See the License for the specific language governing permissions and
-  ~ limitations under the License.
-  -->
-
-<carAudioConfiguration version="3">
-    <zones>
-        <zone name="primary zone" isPrimary="true" occupantZoneId="1">
-            <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group>
-                            <device address="bus0_media_out">
-                                <context context="music"/>
-                            </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
-                            </device>
-                        </group>
-                        <group>
-                            <device address="bus1_navigation_out">
-                                <context context="navigation"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-        <zone name="rear seat zone" audioZoneId="0">
-            <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group>
-                            <device address="bus100_rear_seat">
-                                <context context="music"/>
-                                <context context="navigation"/>
-                                <context context="voice_command"/>
-                                <context context="call_ring"/>
-                                <context context="call"/>
-                                <context context="alarm"/>
-                                <context context="notification"/>
-                                <context context="system_sound"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_oem_defined_context.xml b/tests/carservice_test/res/raw/car_audio_configuration_using_oem_defined_context.xml
deleted file mode 100644
index 9ba506a0a4..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_oem_defined_context.xml
+++ /dev/null
@@ -1,111 +0,0 @@
-<?xml version="1.0" ?>
-<!-- Copyright (C) 2023 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioConfiguration version="3">
-    <oemContexts>
-        <oemContext name="OEM_MUSIC">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_UNKNOWN" />
-                <usage value="AUDIO_USAGE_MEDIA" />
-                <usage value="AUDIO_USAGE_GAME" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_NAVIGATION">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_VOICE_COMMAND">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                <usage value="AUDIO_USAGE_ASSISTANT" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_CALL_RING">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_CALL">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
-                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
-                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_ALARM">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_ALARM" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_NOTIFICATION">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_NOTIFICATION" />
-                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_SYSTEM_SOUND">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_EMERGENCY">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_EMERGENCY" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_SAFETY">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_SAFETY" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_VEHICLE_STATUS">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
-            </audioAttributes>
-        </oemContext>
-        <oemContext name="OEM_ANNOUNCEMENT">
-            <audioAttributes>
-                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
-            </audioAttributes>
-        </oemContext>
-    </oemContexts>
-    <zones>
-        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
-            <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group name="OEM_VOLUME_GROUP">
-                            <device address="bus0_media_out">
-                                <context context="OEM_MUSIC"/>
-                                <context context="OEM_NAVIGATION"/>
-                                <context context="OEM_VOICE_COMMAND"/>
-                                <context context="OEM_CALL_RING"/>
-                                <context context="OEM_CALL"/>
-                                <context context="OEM_ALARM"/>
-                                <context context="OEM_NOTIFICATION"/>
-                                <context context="OEM_SYSTEM_SOUND"/>
-                                <context context="OEM_EMERGENCY"/>
-                                <context context="OEM_SAFETY"/>
-                                <context context="OEM_VEHICLE_STATUS"/>
-                                <context context="OEM_ANNOUNCEMENT"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone.xml b/tests/carservice_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone.xml
deleted file mode 100644
index 3d4de2f68e..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone.xml
+++ /dev/null
@@ -1,91 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2023 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioConfiguration version="4">
-    <mirroringDevices>
-        <mirroringDevice address="mirror_bus_device_1"/>
-        <mirroringDevice address="mirror_bus_device_2"/>
-    </mirroringDevices>
-    <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
-            <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group name="media">
-                            <device address="bus0_media_out">
-                                <context context="music"/>
-                            </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
-                            </device>
-                        </group>
-                        <group name="navigation">
-                            <device address="bus1_navigation_out">
-                                <context context="navigation"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-                <zoneConfig  name="primary zone config BT media">
-                    <volumeGroups>
-                        <group name="media">
-                            <device type="TYPE_BLUETOOTH_A2DP">
-                                <context context="music"/>
-                            </device>
-                        </group>
-                        <group name="call">
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
-                            </device>
-                        </group>
-                        <group name="navigation">
-                            <device address="bus1_navigation_out">
-                                <context context="navigation"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-                <zoneConfig  name="primary zone config BT all">
-                    <volumeGroups>
-                        <group name="all">
-                            <device type="TYPE_BLUETOOTH_A2DP">
-                                <context context="music"/>
-                                <context context="navigation"/>
-                                <context context="voice_command"/>
-                                <context context="call_ring"/>
-                                <context context="call"/>
-                                <context context="alarm"/>
-                                <context context="system_sound"/>
-                                <context context="notification"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume.xml b/tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume.xml
deleted file mode 100644
index 7cb0115c58..0000000000
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume.xml
+++ /dev/null
@@ -1,50 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2024 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioConfiguration version="4">
-    <activationVolumeConfigs>
-        <activationVolumeConfig name="activation_volume_on_boot_config">
-            <activationVolumeConfigEntry minActivationVolumePercentage="40"
-                maxActivationVolumePercentage="60" invocationType="onBoot" />
-        </activationVolumeConfig>
-    </activationVolumeConfigs>
-    <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
-            <zoneConfigs>
-                <zoneConfig name="primary_zone_config_1" isDefault="true">
-                    <volumeGroups>
-                        <group activationConfig="activation_volume_on_boot_config">
-                            <device address="bus0_media_out">
-                                <context context="music"/>
-                            </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
-                            </device>
-                        </group>
-                        <group>
-                            <device address="bus1_navigation_out">
-                                <context context="navigation"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
-</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_fade_configuration.xml b/tests/carservice_test/res/raw/car_audio_fade_configuration.xml
deleted file mode 100644
index e18f71d654..0000000000
--- a/tests/carservice_test/res/raw/car_audio_fade_configuration.xml
+++ /dev/null
@@ -1,121 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2024 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioFadeConfiguration version="1">
-     <configs>
-          <config name="relaxed fading" defaultFadeOutDurationInMillis="800"
-              defaultFadeInDurationInMillis="500">
-               <fadeState value="1" />
-               <fadeableUsages>
-                    <usage value="AUDIO_USAGE_MEDIA" />
-                    <usage value="AUDIO_USAGE_GAME" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                    <usage value="AUDIO_USAGE_ASSISTANT" />
-                    <usage value="AUDIO_USAGE_NOTIFICATION" />
-                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-               </fadeableUsages>
-               <unfadeableContentTypes>
-                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH" />
-               </unfadeableContentTypes>
-               <unfadeableAudioAttributes>
-                    <audioAttributes>
-                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1" />
-                    </audioAttributes>
-               </unfadeableAudioAttributes>
-               <fadeOutDurations>
-                    <fadeDuration valueInMillis="1500">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT" tags="oem_specific_tag2" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="1000">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeOutDurations>
-               <fadeInDurations>
-                    <fadeDuration valueInMillis="1000">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT" tags="oem_specific_tag2" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="800">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeInDurations>
-          </config>
-          <config name="aggressive fading">
-               <fadeState value="1" />
-               <fadeableUsages>
-                    <usage value="AUDIO_USAGE_MEDIA" />
-                    <usage value="AUDIO_USAGE_GAME" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                    <usage value="AUDIO_USAGE_ASSISTANT" />
-                    <usage value="AUDIO_USAGE_NOTIFICATION" />
-                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-               </fadeableUsages>
-               <unfadeableContentTypes>
-                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH" />
-               </unfadeableContentTypes>
-               <unfadeableAudioAttributes>
-                    <audioAttributes>
-                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
-                             tags="oem_projection_service" />
-                    </audioAttributes>
-               </unfadeableAudioAttributes>
-               <fadeOutDurations>
-                    <fadeDuration valueInMillis="800">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="700">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeOutDurations>
-               <fadeInDurations>
-                    <fadeDuration valueInMillis="600">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="450">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeInDurations>
-          </config>
-          <config name="disabled fading">
-               <fadeState value="0" />
-          </config>
-     </configs>
-</carAudioFadeConfiguration>
\ No newline at end of file
diff --git a/tests/carservice_test/res/raw/car_audio_fade_configuration_withEmptyConfigName.xml b/tests/carservice_test/res/raw/car_audio_fade_configuration_withEmptyConfigName.xml
deleted file mode 100644
index a06891e473..0000000000
--- a/tests/carservice_test/res/raw/car_audio_fade_configuration_withEmptyConfigName.xml
+++ /dev/null
@@ -1,120 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2024 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioFadeConfiguration version="1">
-     <configs>
-          <config name="" defaultFadeOutDurationInMillis="800" defaultFadeInDurationInMillis="500">
-               <fadeState value="1" />
-               <fadeableUsages>
-                    <usage value="AUDIO_USAGE_MEDIA" />
-                    <usage value="AUDIO_USAGE_GAME" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                    <usage value="AUDIO_USAGE_ASSISTANT" />
-                    <usage value="AUDIO_USAGE_NOTIFICATION" />
-                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-               </fadeableUsages>
-               <unfadeableContentTypes>
-                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH" />
-               </unfadeableContentTypes>
-               <unfadeableAudioAttributes>
-                    <audioAttributes>
-                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1" />
-                    </audioAttributes>
-               </unfadeableAudioAttributes>
-               <fadeOutDurations>
-                    <fadeDuration valueInMillis="1500">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT" tags="oem_specific_tag2" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="1000">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeOutDurations>
-               <fadeInDurations>
-                    <fadeDuration valueInMillis="1000">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT" tags="oem_specific_tag2" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="800">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeInDurations>
-          </config>
-          <config name="aggressive fading">
-               <fadeState value="1" />
-               <fadeableUsages>
-                    <usage value="AUDIO_USAGE_MEDIA" />
-                    <usage value="AUDIO_USAGE_GAME" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                    <usage value="AUDIO_USAGE_ASSISTANT" />
-                    <usage value="AUDIO_USAGE_NOTIFICATION" />
-                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-               </fadeableUsages>
-               <unfadeableContentTypes>
-                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH" />
-               </unfadeableContentTypes>
-               <unfadeableAudioAttributes>
-                    <audioAttributes>
-                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
-                             tags="oem_projection_service" />
-                    </audioAttributes>
-               </unfadeableAudioAttributes>
-               <fadeOutDurations>
-                    <fadeDuration valueInMillis="800">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="700">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeOutDurations>
-               <fadeInDurations>
-                    <fadeDuration valueInMillis="600">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="450">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeInDurations>
-          </config>
-          <config name="disabled fading">
-               <fadeState value="0" />
-          </config>
-     </configs>
-</carAudioFadeConfiguration>
\ No newline at end of file
diff --git a/tests/carservice_test/res/raw/car_audio_fade_configuration_withNullConfigName.xml b/tests/carservice_test/res/raw/car_audio_fade_configuration_withNullConfigName.xml
deleted file mode 100644
index a2fd409298..0000000000
--- a/tests/carservice_test/res/raw/car_audio_fade_configuration_withNullConfigName.xml
+++ /dev/null
@@ -1,120 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2024 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<carAudioFadeConfiguration version="1">
-     <configs>
-          <config defaultFadeOutDurationInMillis="800" defaultFadeInDurationInMillis="500">
-               <fadeState value="1" />
-               <fadeableUsages>
-                    <usage value="AUDIO_USAGE_MEDIA" />
-                    <usage value="AUDIO_USAGE_GAME" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                    <usage value="AUDIO_USAGE_ASSISTANT" />
-                    <usage value="AUDIO_USAGE_NOTIFICATION" />
-                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-               </fadeableUsages>
-               <unfadeableContentTypes>
-                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH" />
-               </unfadeableContentTypes>
-               <unfadeableAudioAttributes>
-                    <audioAttributes>
-                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1" />
-                    </audioAttributes>
-               </unfadeableAudioAttributes>
-               <fadeOutDurations>
-                    <fadeDuration valueInMillis="1500">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT" tags="oem_specific_tag2" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="1000">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeOutDurations>
-               <fadeInDurations>
-                    <fadeDuration valueInMillis="1000">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT" tags="oem_specific_tag2" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="800">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeInDurations>
-          </config>
-          <config name="aggressive fading">
-               <fadeState value="1" />
-               <fadeableUsages>
-                    <usage value="AUDIO_USAGE_MEDIA" />
-                    <usage value="AUDIO_USAGE_GAME" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                    <usage value="AUDIO_USAGE_ASSISTANT" />
-                    <usage value="AUDIO_USAGE_NOTIFICATION" />
-                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-               </fadeableUsages>
-               <unfadeableContentTypes>
-                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH" />
-               </unfadeableContentTypes>
-               <unfadeableAudioAttributes>
-                    <audioAttributes>
-                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1" />
-                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
-                             tags="oem_projection_service" />
-                    </audioAttributes>
-               </unfadeableAudioAttributes>
-               <fadeOutDurations>
-                    <fadeDuration valueInMillis="800">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="700">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeOutDurations>
-               <fadeInDurations>
-                    <fadeDuration valueInMillis="600">
-                         <usage value="AUDIO_USAGE_MEDIA" />
-                         <usage value="AUDIO_USAGE_GAME" />
-                    </fadeDuration>
-                    <fadeDuration valueInMillis="450">
-                         <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY" />
-                         <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
-                         <usage value="AUDIO_USAGE_ASSISTANT" />
-                         <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
-                    </fadeDuration>
-               </fadeInDurations>
-          </config>
-          <config name="disabled fading">
-               <fadeState value="0" />
-          </config>
-     </configs>
-</carAudioFadeConfiguration>
\ No newline at end of file
diff --git a/tests/carservice_unit_test/Android.bp b/tests/carservice_unit_test/Android.bp
index e6b0ba11ec..4963741f03 100644
--- a/tests/carservice_unit_test/Android.bp
+++ b/tests/carservice_unit_test/Android.bp
@@ -58,16 +58,9 @@ android_test {
         "android.car",
         "android.car.builtin.impl",
         "android.car.watchdoglib",
-        "android.test.runner",
-        "android.test.base",
-        "android.test.mock",
-        // The following three lines are needed for tests that build against framework-bluetooth's
-        // @hide APIs. Order matters for the first two: classes in framework-bluetooth are
-        // resolved before framework, meaning @hide APIs in framework-bluetooth are resolved
-        // before @SystemApi stubs in framework. If sdk_version="", then the third line would get
-        // automatically included; since it isn't, it needs to be manually added here.
-        // (Ref: "framework-bluetooth-tests-defaults" in packages/modules/Bluetooth/framework/Android.bp)
-        "framework-bluetooth.impl",
+        "android.test.runner.stubs",
+        "android.test.base.stubs",
+        "android.test.mock.stubs",
         "framework",
         "framework-res",
     ],
@@ -77,6 +70,7 @@ android_test {
     ],
 
     static_libs: [
+        "android.car.feature-aconfig-java",
         "android.car.testapi",
         "android.car.test.utils",
         "androidx.test.core",
@@ -91,6 +85,7 @@ android_test {
         "flag-junit",
         "ravenwood-junit",
         "mockito-target-extended",
+        "platform-test-annotations",
         "ravenwood-junit",
         "SettingsLib",
         "servicestests-utils",
@@ -119,13 +114,16 @@ android_ravenwood_test {
     name: "CarServiceHostUnitTest",
 
     srcs: [
-        "src/android/car/test/JUnitHelper.java",
-        "src/android/car/test/PermissionsCheckerRuleTest.java",
         "src/com/android/car/CarPropertyServiceUnitTest.java",
+        "src/com/android/car/internal/PendingRequestPoolUnitTest.java",
         "src/com/android/car/hal/VehicleHalTest.java",
         "src/com/android/car/hal/fakevhal/FakeVhalConfigParserUnitTest.java",
         "src/com/android/car/hal/fakevhal/FakeVehicleStubUnitTest.java",
         "src/com/android/car/hal/property/PropertyHalServiceConfigsUnitTest.java",
+        "src/com/android/car/hal/property/PropertyPermissionInfoTest.java",
+        "src/com/android/car/systeminterface/DisplayInterfaceTest.java",
+        "src/com/android/car/user/InitialUserSetterTest.java",
+        "src/com/android/car/user/MockedUserHandleBuilder.java",
         // Don't depends on "com.android.car.test" because it uses
         // "mockito-target-extended" which might not be the same mockito
         // library used on host.
@@ -142,7 +140,7 @@ android_ravenwood_test {
     ],
 
     libs: [
-        "android.test.base",
+        "android.test.base.stubs.system",
         "framework-annotations-lib",
     ],
 
diff --git a/tests/carservice_unit_test/AndroidManifest.xml b/tests/carservice_unit_test/AndroidManifest.xml
index 13ac1fd80e..be94adbb40 100644
--- a/tests/carservice_unit_test/AndroidManifest.xml
+++ b/tests/carservice_unit_test/AndroidManifest.xml
@@ -36,7 +36,6 @@
     <application android:label="@string/app_title"
             android:debuggable="true" android:testOnly="true">
         <uses-library android:name="android.test.runner" />
-        <activity android:name="android.car.app.CarTaskViewControllerHostLifecycleFactoryTest$TestActivity"/>
         <activity android:name="com.android.car.SystemActivityMonitoringServiceTest$ActivityA"/>
         <activity android:name="com.android.car.SystemActivityMonitoringServiceTest$ActivityB"/>
         <activity android:name="com.android.car.SystemActivityMonitoringServiceTest$ActivityC"/>
@@ -53,8 +52,5 @@
 
         <service android:name="android.car.cluster.renderer.InstrumentClusterRenderingServiceTest$TestableInstrumentClusterRenderingService"/>
 
-        <service android:name="android.car.occupantconnection.PayloadTestBinderService"
-                 android:exported="true"/>
-
     </application>
 </manifest>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration.xml
index 089389a440..4d7684cdad 100644
--- a/tests/carservice_unit_test/res/raw/car_audio_configuration.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration.xml
@@ -104,7 +104,6 @@
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_V1.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_V1.xml
similarity index 62%
rename from tests/carservice_test/res/raw/car_audio_configuration_V1.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_V1.xml
index 26b1c08692..fe5242da10 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_V1.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_V1.xml
@@ -20,24 +20,43 @@
         <zone name="primary zone" isPrimary="true">
             <volumeGroups>
                 <group>
-                    <device address="bus0_media_out">
+                    <device address="media_bus_device">
                         <context context="music"/>
                     </device>
-                    <device address="bus3_call_ring_out">
-                        <context context="call_ring"/>
+                    <device address="notification_bus_device">
+                        <context context="notification"/>
                     </device>
                 </group>
                 <group>
-                    <device address="bus1_navigation_out">
+                    <device address="navigation_bus_device">
                         <context context="navigation"/>
                     </device>
+                    <device address="voice_bus_device">
+                        <context context="voice_command"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="call_bus_device">
+                        <context context="call"/>
+                    </device>
+                    <device address="ring_bus_device">
+                        <context context="call_ring"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="alarm_bus_device">
+                        <context context="alarm"/>
+                    </device>
+                    <device address="system_bus_device">
+                        <context context="system_sound"/>
+                    </device>
                 </group>
             </volumeGroups>
         </zone>
-        <zone name="rear seat zone">
+        <zone name="secondary zone">
             <volumeGroups>
                 <group>
-                    <device address="bus100_rear_seat">
+                    <device address="secondary_zone_bus_100">
                         <context context="music"/>
                         <context context="navigation"/>
                         <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_V1_with_audio_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_audio_zone_id.xml
similarity index 58%
rename from tests/carservice_test/res/raw/car_audio_configuration_V1_with_audio_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_audio_zone_id.xml
index 5793ab7a71..6f8ada9c38 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_V1_with_audio_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_audio_zone_id.xml
@@ -20,24 +20,47 @@
         <zone name="primary zone" isPrimary="true" audioZoneId="0">
             <volumeGroups>
                 <group>
-                    <device address="bus0_media_out">
+                    <device address="media_bus_device">
                         <context context="music"/>
+                        <context context="announcement"/>
                     </device>
-                    <device address="bus3_call_ring_out">
-                        <context context="call_ring"/>
+                    <device address="notification_bus_device">
+                        <context context="notification"/>
                     </device>
                 </group>
                 <group>
-                    <device address="bus1_navigation_out">
+                    <device address="navigation_bus_device">
                         <context context="navigation"/>
                     </device>
+                    <device address="voice_bus_device">
+                        <context context="voice_command"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="call_bus_device">
+                        <context context="call"/>
+                    </device>
+                    <device address="ring_bus_device">
+                        <context context="call_ring"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="alarm_bus_device">
+                        <context context="alarm"/>
+                    </device>
+                    <device address="system_bus_device">
+                        <context context="system_sound"/>
+                        <context context="emergency"/>
+                        <context context="safety"/>
+                        <context context="vehicle_status"/>
+                    </device>
                 </group>
             </volumeGroups>
         </zone>
-        <zone name="rear seat zone">
+        <zone name="secondary zone">
             <volumeGroups>
                 <group>
-                    <device address="bus100_rear_seat">
+                    <device address="secondary_zone_bus_100">
                         <context context="music"/>
                         <context context="navigation"/>
                         <context context="voice_command"/>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_non_legacy_contexts.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_non_legacy_contexts.xml
new file mode 100644
index 0000000000..d9879001cc
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_non_legacy_contexts.xml
@@ -0,0 +1,79 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2020 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<carAudioConfiguration version="1">
+    <zones>
+        <zone name="primary zone" isPrimary="true">
+            <volumeGroups>
+                <group>
+                    <device address="media_bus_device">
+                        <context context="music"/>
+                        <context context="announcement"/>
+                    </device>
+                    <device address="notification_bus_device">
+                        <context context="notification"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="navigation_bus_device">
+                        <context context="navigation"/>
+                    </device>
+                    <device address="voice_bus_device">
+                        <context context="voice_command"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="call_bus_device">
+                        <context context="call"/>
+                    </device>
+                    <device address="ring_bus_device">
+                        <context context="call_ring"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="alarm_bus_device">
+                        <context context="alarm"/>
+                    </device>
+                    <device address="system_bus_device">
+                        <context context="system_sound"/>
+                        <context context="emergency"/>
+                        <context context="safety"/>
+                        <context context="vehicle_status"/>
+                    </device>
+                </group>
+            </volumeGroups>
+        </zone>
+        <zone name="secondary zone">
+            <volumeGroups>
+                <group>
+                    <device address="secondary_zone_bus_100">
+                        <context context="music"/>
+                        <context context="navigation"/>
+                        <context context="voice_command"/>
+                        <context context="call_ring"/>
+                        <context context="call"/>
+                        <context context="alarm"/>
+                        <context context="notification"/>
+                        <context context="system_sound"/>
+                        <!-- Non-legacy context in a V1 configuration -->
+                        <context context="emergency"/>
+                    </device>
+                </group>
+            </volumeGroups>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_V1_with_occupant_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_occupant_zone_id.xml
similarity index 58%
rename from tests/carservice_test/res/raw/car_audio_configuration_V1_with_occupant_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_occupant_zone_id.xml
index 564a13cc15..0f37fb6fa0 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_V1_with_occupant_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_V1_with_occupant_zone_id.xml
@@ -20,24 +20,47 @@
         <zone name="primary zone" isPrimary="true" occupantZoneId="1">
             <volumeGroups>
                 <group>
-                    <device address="bus0_media_out">
+                    <device address="media_bus_device">
                         <context context="music"/>
+                        <context context="announcement"/>
                     </device>
-                    <device address="bus3_call_ring_out">
-                        <context context="call_ring"/>
+                    <device address="notification_bus_device">
+                        <context context="notification"/>
                     </device>
                 </group>
                 <group>
-                    <device address="bus1_navigation_out">
+                    <device address="navigation_bus_device">
                         <context context="navigation"/>
                     </device>
+                    <device address="voice_bus_device">
+                        <context context="voice_command"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="call_bus_device">
+                        <context context="call"/>
+                    </device>
+                    <device address="ring_bus_device">
+                        <context context="call_ring"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="alarm_bus_device">
+                        <context context="alarm"/>
+                    </device>
+                    <device address="system_bus_device">
+                        <context context="system_sound"/>
+                        <context context="emergency"/>
+                        <context context="safety"/>
+                        <context context="vehicle_status"/>
+                    </device>
                 </group>
             </volumeGroups>
         </zone>
-        <zone name="rear seat zone">
+        <zone name="secondary zone">
             <volumeGroups>
                 <group>
-                    <device address="bus100_rear_seat">
+                    <device address="secondary_zone_bus_100">
                         <context context="music"/>
                         <context context="navigation"/>
                         <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_V2.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_V2.xml
similarity index 67%
rename from tests/carservice_test/res/raw/car_audio_configuration_V2.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_V2.xml
index e4ccede737..61f1564124 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_V2.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_V2.xml
@@ -19,28 +19,47 @@
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <volumeGroups>
                 <group>
-                    <device address="bus0_media_out">
+                    <device address="media_bus_device">
                         <context context="music"/>
+                        <context context="announcement"/>
                     </device>
-                    <device address="bus3_call_ring_out">
-                        <context context="call_ring"/>
+                    <device address="notification_bus_device">
+                        <context context="notification"/>
                     </device>
                 </group>
                 <group>
-                    <device address="bus1_navigation_out">
+                    <device address="navigation_bus_device">
                         <context context="navigation"/>
+                    </device>
+                    <device address="voice_bus_device">
+                        <context context="voice_command"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="call_bus_device">
+                        <context context="call"/>
+                    </device>
+                    <device address="ring_bus_device">
+                        <context context="call_ring"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="alarm_bus_device">
+                        <context context="alarm"/>
+                    </device>
+                    <device address="system_bus_device">
+                        <context context="system_sound"/>
                         <context context="emergency"/>
                         <context context="safety"/>
                         <context context="vehicle_status"/>
-                        <context context="announcement"/>
                     </device>
                 </group>
             </volumeGroups>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <volumeGroups>
                 <group>
-                    <device address="bus100_rear_seat">
+                    <device address="secondary_zone_bus_100">
                         <context context="music"/>
                         <context context="navigation"/>
                         <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_invalid_device_type.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_V3_missing_output_address.xml
similarity index 66%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_invalid_device_type.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_V3_missing_output_address.xml
index 09226f073b..e7945c79dd 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_invalid_device_type.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_V3_missing_output_address.xml
@@ -13,47 +13,46 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<carAudioConfiguration version="4">
+<carAudioConfiguration version="3">
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
                 <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
-                        <group name="media">
-                            <device address="bus0_media_out">
+                        <group>
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
-                        <group name="navigation">
-                            <device address="bus1_navigation_out">
+                        <group>
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-                <zoneConfig name="primary zone config with invalid device type">
-                    <volumeGroups>
-                        <group name="all">
-                            <device type="TYPE_IP">
-                                <context context="music"/>
-                                <context context="navigation"/>
+                            <device address="voice_bus_device">
                                 <context context="voice_command"/>
-                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
                                 <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
                                 <context context="alarm"/>
+                            </device>
+                            <device>
                                 <context context="system_sound"/>
-                                <context context="notification"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_V4_missing_output_address.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_V4_missing_output_address.xml
similarity index 77%
rename from tests/carservice_test/res/raw/car_audio_configuration_V4_missing_output_address.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_V4_missing_output_address.xml
index 1d6b2458b0..c2f1508e53 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_V4_missing_output_address.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_V4_missing_output_address.xml
@@ -19,21 +19,40 @@
             <zoneConfigs>
                 <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
-                        <group name="media">
-                            <device address="bus0_media_out">
+                        <group>
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="navigation_bus_device">
+                                <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
                                 <context context="call_ring"/>
                             </device>
                         </group>
-                        <group name="navigation">
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
                             <device>
-                                <context context="navigation"/>
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs.xml
similarity index 77%
rename from tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs.xml
index d1a589a621..6aae96c29f 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs.xml
@@ -17,23 +17,42 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -51,12 +70,12 @@
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -82,10 +101,10 @@
                         </fadeConfig>
                     </applyFadeConfigs>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig name="secondary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_in_v3.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_in_v3.xml
similarity index 77%
rename from tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_in_v3.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_in_v3.xml
index 97f6cdc59c..29a3c00189 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_in_v3.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_in_v3.xml
@@ -17,23 +17,42 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -51,12 +70,12 @@
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -82,10 +101,10 @@
                         </fadeConfig>
                     </applyFadeConfigs>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig name="secondary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_empty_address.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_empty_address.xml
similarity index 77%
rename from tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_empty_address.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_empty_address.xml
index 59715a413c..d0fb14d2eb 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_empty_address.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_empty_address.xml
@@ -17,23 +17,42 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -51,12 +70,12 @@
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -82,10 +101,10 @@
                         </fadeConfig>
                     </applyFadeConfigs>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig name="secondary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_neitherDefaultNorTransient.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_neither_default_nor_transient.xm
similarity index 75%
rename from tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_neitherDefaultNorTransient.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_neither_default_nor_transient.xm
index 26b0e37f26..6f07a689b9 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_neitherDefaultNorTransient.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_neither_default_nor_transient.xm
@@ -17,23 +17,42 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -44,12 +63,12 @@
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -75,10 +94,10 @@
                         </fadeConfig>
                     </applyFadeConfigs>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig name="secondary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_unavailable_config.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_unavailable_config.xml
similarity index 75%
rename from tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_unavailable_config.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_unavailable_config.xml
index 0410a85dca..3d18f8bf90 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_apply_fade_configs_with_unavailable_config.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_apply_fade_configs_with_unavailable_config.xml
@@ -17,46 +17,54 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
-                    <applyFadeConfigs>
-                        <fadeConfig name="relaxed fading" isDefault="true">
-                        </fadeConfig>
-                        <fadeConfig name="aggressive fading">
-                            <audioAttributes>
-                                <usage value="AUDIO_USAGE_MEDIA" />
-                                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
-                                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
-                            </audioAttributes>
-                        </fadeConfig>
-                    </applyFadeConfigs>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -82,10 +90,10 @@
                         </fadeConfig>
                     </applyFadeConfigs>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig name="secondary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_audio_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_audio_zone_id.xml
similarity index 72%
rename from tests/carservice_test/res/raw/car_audio_configuration_duplicate_audio_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_audio_zone_id.xml
index 7cac5ff3ad..606e68e1ab 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_audio_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_audio_zone_id.xml
@@ -22,32 +22,51 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="1" occupantZoneId="2">
+        <zone name="secondary zone" audioZoneId="1" occupantZoneId="2">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -66,9 +85,9 @@
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone 2" audioZoneId="1" occupantZoneId="3">
+        <zone name="secondary zone 2" audioZoneId="1" occupantZoneId="3">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone 2 config 1" isDefault="true">
+                <zoneConfig name="secondary zone 2 config 1" isDefault="true">
                     <volumeGroups>
                         <group>
                             <device address="bus200_rear_seat">
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_mirror_devices.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_mirror_devices.xml
similarity index 70%
rename from tests/carservice_test/res/raw/car_audio_configuration_duplicate_mirror_devices.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_mirror_devices.xml
index 8a7babac41..a38428f8b6 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_mirror_devices.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_mirror_devices.xml
@@ -15,9 +15,8 @@
 -->
 <carAudioConfiguration version="3">
     <mirroringDevices>
-        <mirroringDevice address="mirror_bus_device_1"/>
-        <mirroringDevice address="mirror_bus_device_2"/>
-        <mirroringDevice address="mirror_bus_device_2"/>
+        <mirroringDevice address="mirror_bus_device"/>
+        <mirroringDevice address="mirror_bus_device"/>
     </mirroringDevices>
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
@@ -25,32 +24,51 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -67,10 +85,10 @@
                         </group>
                     </volumeGroups>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig name="secondary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_occupant_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_occupant_zone_id.xml
new file mode 100644
index 0000000000..bd02a887bf
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_occupant_zone_id.xml
@@ -0,0 +1,89 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2020 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<carAudioConfiguration version="3">
+    <zones>
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+            <zoneConfigs>
+                <zoneConfig name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="media_bus_device">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                            </device>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="navigation_bus_device">
+                                <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="secondary zone" audioZoneId="1" occupantZoneId="1">
+            <zoneConfigs>
+                <zoneConfig name="secondary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="notification"/>
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_zone_config_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_zone_config_name.xml
similarity index 70%
rename from tests/carservice_test/res/raw/car_audio_configuration_duplicate_zone_config_name.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_zone_config_name.xml
index 74dbc242e8..01900cdb81 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_zone_config_name.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_duplicate_zone_config_name.xml
@@ -18,35 +18,54 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -63,10 +82,10 @@
                         </group>
                     </volumeGroups>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 1">
+                <zoneConfig name="secondary zone config 1">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_empty_input_device.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_empty_input_device.xml
similarity index 69%
rename from tests/carservice_test/res/raw/car_audio_configuration_empty_input_device.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_empty_input_device.xml
index 1f6e8d8b27..ac7e8ba71d 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_empty_input_device.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_empty_input_device.xml
@@ -22,20 +22,39 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -46,12 +65,12 @@
                 <inputDevice address="Built-In Mic"/>
             </inputDevices>
         </zone>
-        <zone name="rear seat zone" audioZoneId="1">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_empty_occupant_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_empty_occupant_zone_id.xml
similarity index 67%
rename from tests/carservice_test/res/raw/car_audio_configuration_empty_occupant_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_empty_occupant_zone_id.xml
index 4105b65b5b..0c362cfc75 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_empty_occupant_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_empty_occupant_zone_id.xml
@@ -22,32 +22,51 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_empty_zone_config_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_empty_zone_config_name.xml
similarity index 71%
rename from tests/carservice_test/res/raw/car_audio_configuration_empty_zone_config_name.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_empty_zone_config_name.xml
index c54b74ed63..2c4f0ec96f 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_empty_zone_config_name.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_empty_zone_config_name.xml
@@ -18,35 +18,54 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -66,7 +85,7 @@
                 <zoneConfig name="">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_V1_with_non_legacy_contexts.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_invalid_version.xml
similarity index 63%
rename from tests/carservice_test/res/raw/car_audio_configuration_V1_with_non_legacy_contexts.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_invalid_version.xml
index 5c39cebb60..3b75406b23 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_V1_with_non_legacy_contexts.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_invalid_version.xml
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
-  ~ Copyright (C) 2020 The Android Open Source Project
+  ~ Copyright (C) 2024 The Android Open Source Project
   ~
   ~ Licensed under the Apache License, Version 2.0 (the "License");
   ~ you may not use this file except in compliance with the License.
@@ -15,39 +15,44 @@
   ~ limitations under the License.
   -->
 
-<carAudioConfiguration version="1">
+<carAudioConfiguration version="0">
     <zones>
         <zone name="primary zone" isPrimary="true">
             <volumeGroups>
                 <group>
-                    <device address="bus0_media_out">
+                    <device address="media_bus_device">
                         <context context="music"/>
+                        <context context="announcement"/>
                     </device>
-                    <device address="bus3_call_ring_out">
-                        <context context="call_ring"/>
+                    <device address="notification_bus_device">
+                        <context context="notification"/>
                     </device>
                 </group>
                 <group>
-                    <device address="bus1_navigation_out">
+                    <device address="navigation_bus_device">
                         <context context="navigation"/>
                     </device>
+                    <device address="voice_bus_device">
+                        <context context="voice_command"/>
+                    </device>
                 </group>
-            </volumeGroups>
-        </zone>
-        <zone name="rear seat zone">
-            <volumeGroups>
                 <group>
-                    <device address="bus100_rear_seat">
-                        <context context="music"/>
-                        <context context="navigation"/>
-                        <context context="voice_command"/>
-                        <context context="call_ring"/>
+                    <device address="call_bus_device">
                         <context context="call"/>
+                    </device>
+                    <device address="ring_bus_device">
+                        <context context="call_ring"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="alarm_bus_device">
                         <context context="alarm"/>
-                        <context context="notification"/>
+                    </device>
+                    <device address="system_bus_device">
                         <context context="system_sound"/>
-                        <!-- Non-legacy context in a V1 configuration -->
                         <context context="emergency"/>
+                        <context context="safety"/>
+                        <context context="vehicle_status"/>
                     </device>
                 </group>
             </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_without_activation_volume_config_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_activation_volume_config_name.xml
similarity index 66%
rename from tests/carservice_test/res/raw/car_audio_configuration_without_activation_volume_config_name.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_missing_activation_volume_config_name.xml
index b062056f56..8f0a7cdc40 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_without_activation_volume_config_name.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_activation_volume_config_name.xml
@@ -25,25 +25,44 @@
         </activationVolumeConfig>
     </activationVolumeConfigs>
     <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="0">
             <zoneConfigs>
                 <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
                         <group activationConfig="activation_volume_on_boot_config">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_missing_address.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_address.xml
similarity index 68%
rename from tests/carservice_test/res/raw/car_audio_configuration_missing_address.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_missing_address.xml
index 00f88807a2..f32956a295 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_missing_address.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_address.xml
@@ -19,23 +19,42 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -46,12 +65,12 @@
                 <inputDevice/>
             </inputDevices>
         </zone>
-        <zone name="rear seat zone" audioZoneId="1">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_audio_zone_id_for_primary_zone.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_audio_zone_id_for_primary_zone.xml
new file mode 100644
index 0000000000..ea9689ed9c
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_audio_zone_id_for_primary_zone.xml
@@ -0,0 +1,113 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2020 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<carAudioConfiguration version="3">
+    <zones>
+        <zone name="primary zone" isPrimary="true" occupantZoneId="1">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="media_bus_device">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                            </device>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="navigation_bus_device">
+                                <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="secondary zone" audioZoneId="1" occupantZoneId="2">
+            <zoneConfigs>
+                <zoneConfig  name="secondary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="secondary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                                <context context="notification"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="secondary_zone_bus_201">
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_without_primary_zone.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_primary_zone.xml
similarity index 90%
rename from tests/carservice_test/res/raw/car_audio_configuration_without_primary_zone.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_missing_primary_zone.xml
index 9055bba089..f1c4b5513f 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_without_primary_zone.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_primary_zone.xml
@@ -15,12 +15,12 @@
 -->
 <carAudioConfiguration version="4">
     <zones>
-        <zone name="rear seat zone" audioZoneId="1">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_missing_zone_config_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_zone_config_name.xml
similarity index 71%
rename from tests/carservice_test/res/raw/car_audio_configuration_missing_zone_config_name.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_missing_zone_config_name.xml
index f26578f7ac..b7d83f3807 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_missing_zone_config_name.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_zone_config_name.xml
@@ -18,35 +18,54 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
                 <zoneConfig isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -63,10 +82,10 @@
                         </group>
                     </volumeGroups>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig name="secondary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_without_zones.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_missing_zones.xml
similarity index 100%
rename from tests/carservice_test/res/raw/car_audio_configuration_without_zones.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_missing_zones.xml
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_negative_audio_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_negative_audio_zone_id.xml
similarity index 67%
rename from tests/carservice_test/res/raw/car_audio_configuration_negative_audio_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_negative_audio_zone_id.xml
index 65282f13b3..702c5cd5c8 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_negative_audio_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_negative_audio_zone_id.xml
@@ -22,32 +22,51 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_negative_occupant_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_negative_occupant_zone_id.xml
similarity index 66%
rename from tests/carservice_test/res/raw/car_audio_configuration_negative_occupant_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_negative_occupant_zone_id.xml
index f122859a36..b8ed5682bb 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_negative_occupant_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_negative_occupant_zone_id.xml
@@ -19,35 +19,54 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="-1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_non_existent_input_device.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_non_existent_input_device.xml
similarity index 68%
rename from tests/carservice_test/res/raw/car_audio_configuration_non_existent_input_device.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_non_existent_input_device.xml
index c62551f486..c75ccd5776 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_non_existent_input_device.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_non_existent_input_device.xml
@@ -19,23 +19,42 @@
     <zones>
         <zone name="primary zone" isPrimary="true">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -46,12 +65,12 @@
                 <inputDevice address="Built-In Mic"/>
             </inputDevices>
         </zone>
-        <zone name="rear seat zone" audioZoneId="1">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_non_numerical_audio_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_non_numerical_audio_zone_id.xml
similarity index 67%
rename from tests/carservice_test/res/raw/car_audio_configuration_non_numerical_audio_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_non_numerical_audio_zone_id.xml
index 9e2f96af86..988bcb3a92 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_non_numerical_audio_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_non_numerical_audio_zone_id.xml
@@ -22,32 +22,51 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_non_numerical_occupant_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_non_numerical_occupant_zone_id.xml
similarity index 66%
rename from tests/carservice_test/res/raw/car_audio_configuration_non_numerical_occupant_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_non_numerical_occupant_zone_id.xml
index dbebce60e4..2823ff8454 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_non_numerical_occupant_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_non_numerical_occupant_zone_id.xml
@@ -19,35 +19,54 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="one">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_occupant_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_non_primary_zone_with_primary_audio_zone_id.xml
similarity index 65%
rename from tests/carservice_test/res/raw/car_audio_configuration_duplicate_occupant_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_non_primary_zone_with_primary_audio_zone_id.xml
index 881ce32ee1..54ba8a21c7 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_duplicate_occupant_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_non_primary_zone_with_primary_audio_zone_id.xml
@@ -17,37 +17,56 @@
 
 <carAudioConfiguration version="3">
     <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+        <zone name="primary zone" isPrimary="true" occupantZoneId="1">
             <zoneConfigs>
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2" occupantZoneId="1">
+        <zone name="secondary zone" audioZoneId="0">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_output_address_does_not_exist.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_output_address_does_not_exist.xml
similarity index 69%
rename from tests/carservice_test/res/raw/car_audio_configuration_output_address_does_not_exist.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_output_address_does_not_exist.xml
index c1f0d2e96d..a484d07706 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_output_address_does_not_exist.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_output_address_does_not_exist.xml
@@ -22,29 +22,48 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
                             <device address="bus1000_does_not_exist">
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_primary_zone_with_multiple_configs.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_primary_zone_with_multiple_configs.xml
similarity index 71%
rename from tests/carservice_test/res/raw/car_audio_configuration_primary_zone_with_multiple_configs.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_primary_zone_with_multiple_configs.xml
index 19223e6aad..7389293dec 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_primary_zone_with_multiple_configs.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_primary_zone_with_multiple_configs.xml
@@ -18,23 +18,42 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -42,7 +61,7 @@
                 <zoneConfig name="primary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -61,12 +80,12 @@
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_primary_zone_with_non_zero_audio_zone_id.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_primary_zone_with_non_zero_audio_zone_id.xml
similarity index 65%
rename from tests/carservice_test/res/raw/car_audio_configuration_primary_zone_with_non_zero_audio_zone_id.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_primary_zone_with_non_zero_audio_zone_id.xml
index 84a1e73082..eab86a6da8 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_primary_zone_with_non_zero_audio_zone_id.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_primary_zone_with_non_zero_audio_zone_id.xml
@@ -19,35 +19,54 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="1" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_repeat_input_device.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_repeat_input_device.xml
similarity index 69%
rename from tests/carservice_test/res/raw/car_audio_configuration_repeat_input_device.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_repeat_input_device.xml
index f0f849a385..bd33f87f61 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_repeat_input_device.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_repeat_input_device.xml
@@ -22,20 +22,39 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -46,12 +65,12 @@
                 <inputDevice address="Built-In Mic"/>
             </inputDevices>
         </zone>
-        <zone name="rear seat zone" audioZoneId="1">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing.xml
new file mode 100644
index 0000000000..7cc61548fa
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing.xml
@@ -0,0 +1,83 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCoreAudioRouting" value="true"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="OEM_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume.xml
new file mode 100644
index 0000000000..4d0a682bbb
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume.xml
@@ -0,0 +1,80 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2023 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="3">
+<oemContexts>
+    <oemContext name="OEM_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                tags="oem=extension_1979" />
+        </audioAttributes>
+    </oemContext>
+    <oemContext name="MUSIC_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+            <usage value="AUDIO_USAGE_NOTIFICATION" />
+            <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+            <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+            <usage value="AUDIO_USAGE_ALARM" />
+            <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+            <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+            <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+            <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+            <usage value="AUDIO_USAGE_MEDIA" />
+            <usage value="AUDIO_USAGE_GAME" />
+            <usage value="AUDIO_USAGE_UNKNOWN"/>
+            <usage value="AUDIO_USAGE_ASSISTANT"/>
+            <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+            <usage value="AUDIO_USAGE_EMERGENCY" />
+            <usage value="AUDIO_USAGE_SAFETY" />
+            <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+            <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+        </audioAttributes>
+    </oemContext>
+    <oemContext name="NAV_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+            <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+        </audioAttributes>
+    </oemContext>
+</oemContexts>
+<zones>
+    <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+        <zoneConfigs>
+            <zoneConfig  name="primary zone config 1" isDefault="true">
+                <volumeGroups>
+                    <group name="MUSIC_GROUP">
+                        <device address="media_bus_device">
+                            <context context="MUSIC_CONTEXT"/>
+                        </device>
+                    </group>
+                    <group name="NAV_GROUP">
+                        <device address="navigation_bus_device">
+                            <context context="NAV_CONTEXT"/>
+                        </device>
+                    </group>
+                    <group name="OEM_GROUP">
+                        <device address="oem_bus_device">
+                            <context context="OEM_CONTEXT"/>
+                        </device>
+                    </group>
+                </volumeGroups>
+            </zoneConfig>
+        </zoneConfigs>
+    </zone>
+</zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_empty_group_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_empty_group_name.xml
new file mode 100644
index 0000000000..e585f1ebdf
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_empty_group_name.xml
@@ -0,0 +1,80 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2023 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="3">
+<oemContexts>
+    <oemContext name="OEM_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                tags="oem=extension_1979" />
+        </audioAttributes>
+    </oemContext>
+    <oemContext name="MUSIC_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+            <usage value="AUDIO_USAGE_NOTIFICATION" />
+            <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+            <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+            <usage value="AUDIO_USAGE_ALARM" />
+            <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+            <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+            <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+            <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+            <usage value="AUDIO_USAGE_MEDIA" />
+            <usage value="AUDIO_USAGE_GAME" />
+            <usage value="AUDIO_USAGE_UNKNOWN"/>
+            <usage value="AUDIO_USAGE_ASSISTANT"/>
+            <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+            <usage value="AUDIO_USAGE_EMERGENCY" />
+            <usage value="AUDIO_USAGE_SAFETY" />
+            <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+            <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+        </audioAttributes>
+    </oemContext>
+    <oemContext name="NAV_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+            <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+        </audioAttributes>
+    </oemContext>
+</oemContexts>
+<zones>
+    <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+        <zoneConfigs>
+            <zoneConfig name="primary zone config 1" isDefault="true">
+                <volumeGroups>
+                    <group>
+                        <device address="media_bus_device">
+                            <context context="MUSIC_CONTEXT"/>
+                        </device>
+                    </group>
+                    <group name="NAV_GROUP">
+                        <device address="navigation_bus_device">
+                            <context context="NAV_CONTEXT"/>
+                        </device>
+                    </group>
+                    <group name="OEM_GROUP">
+                        <device address="oem_bus_device">
+                            <context context="OEM_CONTEXT"/>
+                        </device>
+                    </group>
+                </volumeGroups>
+            </zoneConfig>
+        </zoneConfigs>
+    </zone>
+</zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_context_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_context_name.xml
similarity index 95%
rename from tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_context_name.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_context_name.xml
index 4bf34563c8..686d4faa44 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_context_name.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_context_name.xml
@@ -62,17 +62,17 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group name="MUSIC_GROUP">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="MUSIC_CONTEXT"/>
                             </device>
                         </group>
                         <group name="NAV_GROUP">
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="NAV_CONTEXT"/>
                             </device>
                         </group>
                         <group name="OEM_GROUP">
-                            <device address="bus3_call_ring_out">
+                            <device address="oem_bus_device">
                                 <context context="OEM_CONTEXT"/>
                             </device>
                         </group>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_order.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_order.xml
new file mode 100644
index 0000000000..c79289d5ed
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_order.xml
@@ -0,0 +1,80 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2023 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="3">
+<zones>
+    <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+        <zoneConfigs>
+            <zoneConfig  name="primary zone config 1" isDefault="true">
+                <volumeGroups>
+                    <group name="MUSIC_GROUP">
+                        <device address="media_bus_device">
+                            <context context="MUSIC_CONTEXT"/>
+                        </device>
+                    </group>
+                    <group name="NAV_GROUP">
+                        <device address="navigation_bus_device">
+                            <context context="NAV_CONTEXT"/>
+                        </device>
+                    </group>
+                    <group name="OEM_GROUP">
+                        <device address="oem_bus_device">
+                            <context context="OEM_CONTEXT"/>
+                        </device>
+                    </group>
+                </volumeGroups>
+            </zoneConfig>
+        </zoneConfigs>
+    </zone>
+</zones>
+<oemContexts>
+    <oemContext name="OEM_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                tags="oem=extension_1979" />
+        </audioAttributes>
+    </oemContext>
+    <oemContext name="MUSIC_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+            <usage value="AUDIO_USAGE_NOTIFICATION" />
+            <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+            <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+            <usage value="AUDIO_USAGE_ALARM" />
+            <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+            <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+            <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+            <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+            <usage value="AUDIO_USAGE_MEDIA" />
+            <usage value="AUDIO_USAGE_GAME" />
+            <usage value="AUDIO_USAGE_UNKNOWN"/>
+            <usage value="AUDIO_USAGE_ASSISTANT"/>
+            <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+            <usage value="AUDIO_USAGE_EMERGENCY" />
+            <usage value="AUDIO_USAGE_SAFETY" />
+            <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+            <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+        </audioAttributes>
+    </oemContext>
+    <oemContext name="NAV_CONTEXT">
+        <audioAttributes>
+            <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+            <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+        </audioAttributes>
+    </oemContext>
+</oemContexts>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy.xml
similarity index 94%
rename from tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy.xml
index df94d7d508..d22d1f7c70 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy.xml
@@ -58,17 +58,17 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group name="MUSIC_GROUP">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="MUSIC_CONTEXT"/>
                             </device>
                         </group>
                         <group name="NAV_GROUP">
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="NAV_CONTEXT"/>
                             </device>
                         </group>
                         <group name="OEM_GROUP">
-                            <device address="bus3_call_ring_out">
+                            <device address="oem_bus_device">
                                 <context context="OEM_CONTEXT"/>
                             </device>
                         </group>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy_2.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy_2.xml
similarity index 94%
rename from tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy_2.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy_2.xml
index 75db8e3cc7..06e06ab2f8 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy_2.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_strategy_2.xml
@@ -58,17 +58,17 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group name="MUSIC_GROUP">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="MUSIC_CONTEXT"/>
                             </device>
                         </group>
                         <group name="NAV_GROUP">
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="NAV_CONTEXT"/>
                             </device>
                         </group>
                         <group name="OEM_GROUP">
-                            <device address="bus3_call_ring_out">
+                            <device address="oem_bus_device">
                                 <context context="OEM_CONTEXT"/>
                             </device>
                         </group>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_attr_invalid_empty_fields.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_attr_invalid_empty_fields.xml
similarity index 95%
rename from tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_attr_invalid_empty_fields.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_attr_invalid_empty_fields.xml
index 446d8e1cad..3dafff10f7 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_attr_invalid_empty_fields.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_attr_invalid_empty_fields.xml
@@ -27,7 +27,7 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group name="MUSIC_GROUP">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="MUSIC_CONTEXT"/>
                             </device>
                         </group>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_attr_valid_optional_fields.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_attr_valid_optional_fields.xml
similarity index 96%
rename from tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_attr_valid_optional_fields.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_attr_valid_optional_fields.xml
index fddd7087f6..f6d5415e5b 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_attr_valid_optional_fields.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_routing_attr_valid_optional_fields.xml
@@ -33,7 +33,7 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group name="MUSIC_GROUP">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="MUSIC_CONTEXT"/>
                             </device>
                         </group>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_empty_group_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_volume_config_and_missing_group_names.xml
similarity index 87%
rename from tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_empty_group_name.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_volume_config_and_missing_group_names.xml
index de0675ad4a..21faa16c1d 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_empty_group_name.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_volume_config_and_missing_group_names.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" ?>
-<!-- Copyright (C) 2023 The Android Open Source Project
+<!-- Copyright (C) 2024 The Android Open Source Project
 
      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
@@ -18,8 +18,8 @@
         <oemContext name="OEM_CONTEXT">
             <audioAttributes>
                 <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
-                        contentType="AUDIO_CONTENT_TYPE_SPEECH"
-                        tags="oem=extension_1979" />
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
             </audioAttributes>
         </oemContext>
         <oemContext name="MUSIC_CONTEXT">
@@ -58,17 +58,17 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="MUSIC_CONTEXT"/>
                             </device>
                         </group>
-                        <group name="NAV_GROUP">
-                            <device address="bus1_navigation_out">
+                        <group>
+                            <device address="navigation_bus_device">
                                 <context context="NAV_CONTEXT"/>
                             </device>
                         </group>
-                        <group name="OEM_GROUP">
-                            <device address="bus3_call_ring_out">
+                        <group>
+                            <device address="oem_bus_device">
                                 <context context="OEM_CONTEXT"/>
                             </device>
                         </group>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_HAL_ducking_config_disabled.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_HAL_ducking_config_disabled.xml
new file mode 100644
index 0000000000..7682d39802
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_HAL_ducking_config_disabled.xml
@@ -0,0 +1,207 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="3">
+    <deviceConfigurations>
+        <deviceConfiguration name="useHalDuckingSignals" value="false"/>
+    </deviceConfigurations>
+    <zones>
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="media_bus_device">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                            </device>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="navigation_bus_device">
+                                <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="secondary zone" audioZoneId="1" occupantZoneId="2">
+            <zoneConfigs>
+                <zoneConfig  name="secondary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="secondary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                                <context context="notification"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="secondary_zone_bus_201">
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="tertiary zone" audioZoneId="2" occupantZoneId="3">
+            <zoneConfigs>
+                <zoneConfig  name="tertiary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="tertiary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="tertiary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="tertiary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="quaternary zone" audioZoneId="3" occupantZoneId="4">
+            <zoneConfigs>
+                <zoneConfig  name="quaternary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="quaternary_zone_bus_1">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="rear row three zone" audioZoneId="4" occupantZoneId="5">
+            <zoneConfigs>
+                <zoneConfig  name="rear row three zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="rear_row_three_zone_bus_1">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_HAL_ducking_config_enabled.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_HAL_ducking_config_enabled.xml
new file mode 100644
index 0000000000..1813c49e83
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_HAL_ducking_config_enabled.xml
@@ -0,0 +1,207 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="3">
+    <deviceConfigurations>
+        <deviceConfiguration name="useHalDuckingSignals" value="true"/>
+    </deviceConfigurations>
+    <zones>
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="media_bus_device">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                            </device>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="navigation_bus_device">
+                                <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="secondary zone" audioZoneId="1" occupantZoneId="2">
+            <zoneConfigs>
+                <zoneConfig  name="secondary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="secondary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                                <context context="notification"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="secondary_zone_bus_201">
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="tertiary zone" audioZoneId="2" occupantZoneId="3">
+            <zoneConfigs>
+                <zoneConfig  name="tertiary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="tertiary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="tertiary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="tertiary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="quaternary zone" audioZoneId="3" occupantZoneId="4">
+            <zoneConfigs>
+                <zoneConfig  name="quaternary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="quaternary_zone_bus_1">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="rear row three zone" audioZoneId="4" occupantZoneId="5">
+            <zoneConfigs>
+                <zoneConfig  name="rear row three zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="rear_row_three_zone_bus_1">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_activation_volume_multiple_entries.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_activation_volume_multiple_entries.xml
similarity index 63%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_activation_volume_multiple_entries.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_activation_volume_multiple_entries.xml
index bebe03aacf..6c9e88c741 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_activation_volume_multiple_entries.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_activation_volume_multiple_entries.xml
@@ -23,25 +23,44 @@
         </activationVolumeConfig>
     </activationVolumeConfigs>
     <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="0">
             <zoneConfigs>
-                <zoneConfig  name="primary_zone_config_1" isDefault="true">
+                <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
                         <group activationConfig="multi_entries_activation_volume_config">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_activation_volume_repeated_config_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_activation_volume_repeated_config_name.xml
similarity index 66%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_activation_volume_repeated_config_name.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_activation_volume_repeated_config_name.xml
index f97a9f6b19..96852447c6 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_activation_volume_repeated_config_name.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_activation_volume_repeated_config_name.xml
@@ -25,25 +25,44 @@
         </activationVolumeConfig>
     </activationVolumeConfigs>
     <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="0">
             <zoneConfigs>
                 <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
                         <group activationConfig="repeated_activation_volume_config">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_core_audio_routing_and_volume_configs_disabled.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_core_audio_routing_and_volume_configs_disabled.xml
new file mode 100644
index 0000000000..566a38f3c2
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_core_audio_routing_and_volume_configs_disabled.xml
@@ -0,0 +1,72 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCoreAudioRouting" value="false"/>
+        <deviceConfiguration name="useCoreAudioVolume" value="false"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_audio_routing_and_volume.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_core_audio_routing_and_volume_configs_enabled.xml
similarity index 92%
rename from tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_audio_routing_and_volume.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_core_audio_routing_and_volume_configs_enabled.xml
index 3f93611af6..1d6ad97941 100644
--- a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_core_audio_routing_and_volume.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_core_audio_routing_and_volume_configs_enabled.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" ?>
-<!-- Copyright (C) 2023 The Android Open Source Project
+<!-- Copyright (C) 2024 The Android Open Source Project
 
      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
@@ -13,7 +13,11 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<carAudioConfiguration version="3">
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCoreAudioRouting" value="true" />
+        <deviceConfiguration name="useCoreAudioVolume" value="true" />
+    </deviceConfigurations>
     <oemContexts>
         <oemContext name="OEM_CONTEXT">
             <audioAttributes>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_dynamic_devices.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone.xml
similarity index 100%
rename from tests/carservice_unit_test/res/raw/car_audio_configuration_using_dynamic_devices.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone.xml
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone_in_v3.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone_in_v3.xml
similarity index 62%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone_in_v3.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone_in_v3.xml
index 9545adf06d..ae913475c5 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone_in_v3.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_dynamic_devices_for_primary_zone_in_v3.xml
@@ -15,8 +15,7 @@
 -->
 <carAudioConfiguration version="3">
     <mirroringDevices>
-        <mirroringDevice address="mirror_bus_device_1"/>
-        <mirroringDevice address="mirror_bus_device_2"/>
+        <mirroringDevice address="mirror_bus_device"/>
     </mirroringDevices>
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
@@ -26,18 +25,37 @@
                         <group>
                             <device type="TYPE_BLUETOOTH_A2DP">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_order.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_empty_use_core_volume_config.xml
similarity index 86%
rename from tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_order.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_empty_use_core_volume_config.xml
index b712851f40..c1018739e6 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume_invalid_order.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_empty_use_core_volume_config.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" ?>
-<!-- Copyright (C) 2023 The Android Open Source Project
+<!-- Copyright (C) 2024 The Android Open Source Project
 
      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
@@ -13,38 +13,16 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<carAudioConfiguration version="3">
-    <zones>
-        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
-            <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
-                    <volumeGroups>
-                        <group name="MUSIC_GROUP">
-                            <device address="bus0_media_out">
-                                <context context="MUSIC_CONTEXT"/>
-                            </device>
-                        </group>
-                        <group name="NAV_GROUP">
-                            <device address="bus1_navigation_out">
-                                <context context="NAV_CONTEXT"/>
-                            </device>
-                        </group>
-                        <group name="OEM_GROUP">
-                            <device address="bus3_call_ring_out">
-                                <context context="OEM_CONTEXT"/>
-                            </device>
-                        </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-    </zones>
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCoreAudioVolume" value=""/>
+    </deviceConfigurations>
     <oemContexts>
         <oemContext name="OEM_CONTEXT">
             <audioAttributes>
                 <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
-                        contentType="AUDIO_CONTENT_TYPE_SPEECH"
-                        tags="oem=extension_1979" />
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
             </audioAttributes>
         </oemContext>
         <oemContext name="MUSIC_CONTEXT">
@@ -77,4 +55,29 @@
             </audioAttributes>
         </oemContext>
     </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
 </carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_group_muting_config_disabled.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_group_muting_config_disabled.xml
new file mode 100644
index 0000000000..5b6bb88f53
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_group_muting_config_disabled.xml
@@ -0,0 +1,207 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="3">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCarVolumeGroupMuting" value="false"/>
+    </deviceConfigurations>
+    <zones>
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="media_bus_device">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                            </device>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="navigation_bus_device">
+                                <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="secondary zone" audioZoneId="1" occupantZoneId="2">
+            <zoneConfigs>
+                <zoneConfig  name="secondary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="secondary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                                <context context="notification"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="secondary_zone_bus_201">
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="tertiary zone" audioZoneId="2" occupantZoneId="3">
+            <zoneConfigs>
+                <zoneConfig  name="tertiary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="tertiary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="tertiary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="tertiary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="quaternary zone" audioZoneId="3" occupantZoneId="4">
+            <zoneConfigs>
+                <zoneConfig  name="quaternary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="quaternary_zone_bus_1">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="rear row three zone" audioZoneId="4" occupantZoneId="5">
+            <zoneConfigs>
+                <zoneConfig  name="rear row three zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="rear_row_three_zone_bus_1">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_group_muting_config_enabled.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_group_muting_config_enabled.xml
new file mode 100644
index 0000000000..d86265b371
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_group_muting_config_enabled.xml
@@ -0,0 +1,207 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="3">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCarVolumeGroupMuting" value="true"/>
+    </deviceConfigurations>
+    <zones>
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="media_bus_device">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                            </device>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="navigation_bus_device">
+                                <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="secondary zone" audioZoneId="1" occupantZoneId="2">
+            <zoneConfigs>
+                <zoneConfig  name="secondary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="secondary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="secondary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="announcement"/>
+                                <context context="notification"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="secondary_zone_bus_201">
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="tertiary zone" audioZoneId="2" occupantZoneId="3">
+            <zoneConfigs>
+                <zoneConfig  name="tertiary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="tertiary_zone_bus_100">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+                <zoneConfig  name="tertiary zone config 2">
+                    <volumeGroups>
+                        <group>
+                            <device address="tertiary_zone_bus_200">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="quaternary zone" audioZoneId="3" occupantZoneId="4">
+            <zoneConfigs>
+                <zoneConfig  name="quaternary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="quaternary_zone_bus_1">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+        <zone name="rear row three zone" audioZoneId="4" occupantZoneId="5">
+            <zoneConfigs>
+                <zoneConfig  name="rear row three zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group>
+                            <device address="rear_row_three_zone_bus_1">
+                                <context context="music"/>
+                                <context context="navigation"/>
+                                <context context="voice_command"/>
+                                <context context="call_ring"/>
+                                <context context="call"/>
+                                <context context="alarm"/>
+                                <context context="system_sound"/>
+                                <context context="notification"/>
+                                <context context="emergency"/>
+                                <context context="safety"/>
+                                <context context="vehicle_status"/>
+                                <context context="announcement"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_input_devices.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_input_devices.xml
similarity index 68%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_input_devices.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_input_devices.xml
index 91ed132786..7f77eb07b7 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_input_devices.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_input_devices.xml
@@ -19,23 +19,42 @@
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
@@ -46,12 +65,12 @@
                 <inputDevice address="Built-In Mic"/>
             </inputDevices>
         </zone>
-        <zone name="rear seat zone" audioZoneId="1">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_invalid_activation_volume_config_name.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_activation_volume_config_name.xml
similarity index 64%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_invalid_activation_volume_config_name.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_activation_volume_config_name.xml
index 12ca284024..ab5f3024ea 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_invalid_activation_volume_config_name.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_activation_volume_config_name.xml
@@ -21,25 +21,44 @@
         </activationVolumeConfig>
     </activationVolumeConfigs>
     <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="0">
             <zoneConfigs>
                 <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
                         <group activationConfig="activation_volume_invalid_config">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_invalid_activation_volume_type.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_activation_volume_type.xml
similarity index 64%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_invalid_activation_volume_type.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_activation_volume_type.xml
index af396fa046..6780a8b98b 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_invalid_activation_volume_type.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_activation_volume_type.xml
@@ -21,25 +21,44 @@
         </activationVolumeConfig>
     </activationVolumeConfigs>
     <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="0">
             <zoneConfigs>
                 <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
                         <group activationConfig="invalid_type_activation_volume_config">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_device_config.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_device_config.xml
new file mode 100644
index 0000000000..c789a67452
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_device_config.xml
@@ -0,0 +1,83 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCoreAudioVolume" value="wrong"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="OEM_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_without_mirroring.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_device_type.xml
similarity index 69%
rename from tests/carservice_test/res/raw/car_audio_configuration_without_mirroring.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_device_type.xml
index 2088ac1608..ff4d1c7e9c 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_without_mirroring.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_device_type.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" encoding="utf-8"?>
-<!-- Copyright (C) 2023 The Android Open Source Project
+<!-- Copyright (C) 2024 The Android Open Source Project
 
      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
@@ -13,59 +13,54 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<carAudioConfiguration version="3">
+<carAudioConfiguration version="4">
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <zoneConfigs>
-                <zoneConfig  name="primary zone config 1" isDefault="true">
+                <zoneConfig name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
-                                <context context="emergency"/>
-                                <context context="safety"/>
-                                <context context="vehicle_status"/>
-                                <context context="announcement"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
                             </device>
                         </group>
-                    </volumeGroups>
-                </zoneConfig>
-            </zoneConfigs>
-        </zone>
-        <zone name="rear seat zone" audioZoneId="2">
-            <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
-                    <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
-                                <context context="music"/>
-                                <context context="navigation"/>
-                                <context context="voice_command"/>
-                                <context context="call_ring"/>
+                            <device address="call_bus_device">
                                 <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
                                 <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
                                 <context context="system_sound"/>
-                                <context context="notification"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig name="primary zone config with invalid device type">
                     <volumeGroups>
-                        <group>
-                            <device address="bus101_rear_seat">
+                        <group name="all">
+                            <device type="TYPE_IP">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_core_routing.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_core_routing.xml
new file mode 100644
index 0000000000..8d9ecc4cd8
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_core_routing.xml
@@ -0,0 +1,83 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCoreAudioRouting" value="wrong"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="OEM_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_group_muting_config.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_group_muting_config.xml
new file mode 100644
index 0000000000..bb38e36d5f
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_group_muting_config.xml
@@ -0,0 +1,83 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCarVolumeGroupMuting" value="wrong"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="OEM_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_hal_ducking_config.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_hal_ducking_config.xml
new file mode 100644
index 0000000000..ec7b22961a
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_invalid_use_hal_ducking_config.xml
@@ -0,0 +1,83 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useHalDuckingSignals" value="yes"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="OEM_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_min_greater_than_max_activation_volume.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_greater_than_max_activation_volume.xml
similarity index 64%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_min_greater_than_max_activation_volume.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_greater_than_max_activation_volume.xml
index e4ee8d8bfe..612551fbe1 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_min_greater_than_max_activation_volume.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_greater_than_max_activation_volume.xml
@@ -25,21 +25,40 @@
             <zoneConfigs>
                 <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
-                        <group>
-                            <device address="bus0_media_out">
+                        <group activationConfig="invalid_activation_volume_config">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
-                        <group activationConfig="invalid_activation_volume_config">
-                            <device address="bus1_navigation_out" >
+                        <group>
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_activation_volumes.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume.xml
similarity index 98%
rename from tests/carservice_unit_test/res/raw/car_audio_configuration_using_activation_volumes.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume.xml
index c7c22e01de..97550b2852 100644
--- a/tests/carservice_unit_test/res/raw/car_audio_configuration_using_activation_volumes.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume.xml
@@ -58,7 +58,7 @@
                                 <context context="call_ring"/>
                             </device>
                         </group>
-                        <group activationConfig="activation_volume_on_playback_changed_config">
+                        <group>
                             <device address="alarm_bus_device">
                                 <context context="alarm"/>
                             </device>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume_in_v3.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume_in_v3.xml
similarity index 61%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume_in_v3.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume_in_v3.xml
index 0793eb379e..e6ac3415fd 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume_in_v3.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume_in_v3.xml
@@ -16,30 +16,49 @@
 <carAudioConfiguration version="3">
     <activationVolumeConfigs>
         <activationVolumeConfig name="activation_volume_on_boot_config">
-            <activationVolumeConfigEntry minActivationVolumePercentage="10"
-                maxActivationVolumePercentage="90" />
+            <activationVolumeConfigEntry minActivationVolumePercentage="30"
+                maxActivationVolumePercentage="70" invocationType="onBoot" />
         </activationVolumeConfig>
     </activationVolumeConfigs>
     <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="0">
             <zoneConfigs>
                 <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
-                        <group>
-                            <device address="bus0_media_out">
+                        <group activationConfig="activation_volume_on_boot_config">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
-                        <group activationConfig="activation_volume_on_boot_config">
-                            <device address="bus1_navigation_out">
+                        <group>
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume_out_of_range.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume_out_of_range.xml
similarity index 62%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume_out_of_range.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume_out_of_range.xml
index f3c1f8b66c..c20883329a 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_min_max_activation_volume_out_of_range.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_min_max_activation_volume_out_of_range.xml
@@ -21,25 +21,44 @@
         </activationVolumeConfig>
     </activationVolumeConfigs>
     <zones>
-        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
+        <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="0">
             <zoneConfigs>
                 <zoneConfig name="primary_zone_config_1" isDefault="true">
                     <volumeGroups>
-                        <group>
-                            <device address="bus0_media_out">
+                        <group activationConfig="invalid_activation_volume_config">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group activationConfig="invalid_activation_volume_config">
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group activationConfig="invalid_activation_volume_config">
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_with_mirroring_V2.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_mirroring_V2.xml
similarity index 68%
rename from tests/carservice_test/res/raw/car_audio_configuration_with_mirroring_V2.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_mirroring_V2.xml
index 77d9a54f37..87d861cb3d 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_with_mirroring_V2.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_mirroring_V2.xml
@@ -21,28 +21,47 @@
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
             <volumeGroups>
                 <group>
-                    <device address="bus0_media_out">
+                    <device address="media_bus_device">
                         <context context="music"/>
+                        <context context="announcement"/>
                     </device>
-                    <device address="bus3_call_ring_out">
-                        <context context="call_ring"/>
+                    <device address="notification_bus_device">
+                        <context context="notification"/>
                     </device>
                 </group>
                 <group>
-                    <device address="bus1_navigation_out">
+                    <device address="navigation_bus_device">
                         <context context="navigation"/>
+                    </device>
+                    <device address="voice_bus_device">
+                        <context context="voice_command"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="call_bus_device">
+                        <context context="call"/>
+                    </device>
+                    <device address="ring_bus_device">
+                        <context context="call_ring"/>
+                    </device>
+                </group>
+                <group>
+                    <device address="alarm_bus_device">
+                        <context context="alarm"/>
+                    </device>
+                    <device address="system_bus_device">
+                        <context context="system_sound"/>
                         <context context="emergency"/>
                         <context context="safety"/>
                         <context context="vehicle_status"/>
-                        <context context="announcement"/>
                     </device>
                 </group>
             </volumeGroups>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <volumeGroups>
                 <group>
-                    <device address="bus100_rear_seat">
+                    <device address="secondary_zone_bus_100">
                         <context context="music"/>
                         <context context="navigation"/>
                         <context context="voice_command"/>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_multiple_use_core_volume_config.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_multiple_use_core_volume_config.xml
new file mode 100644
index 0000000000..32e43ab117
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_multiple_use_core_volume_config.xml
@@ -0,0 +1,84 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCoreAudioVolume" value="true"/>
+        <deviceConfiguration name="useCoreAudioVolume" value="false"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="OEM_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_repeated_dynamic_devices_in_config.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_repeated_dynamic_devices_in_config.xml
similarity index 100%
rename from tests/carservice_unit_test/res/raw/car_audio_configuration_repeated_dynamic_devices_in_config.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_repeated_dynamic_devices_in_config.xml
diff --git a/tests/carservice_test/res/raw/car_audio_configuration.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_two_zones.xml
similarity index 68%
rename from tests/carservice_test/res/raw/car_audio_configuration.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_two_zones.xml
index edcfcde574..de03b65962 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_two_zones.xml
@@ -15,8 +15,7 @@
 -->
 <carAudioConfiguration version="3">
     <mirroringDevices>
-        <mirroringDevice address="mirror_bus_device_1"/>
-        <mirroringDevice address="mirror_bus_device_2"/>
+        <mirroringDevice address="mirror_bus_device"/>
     </mirroringDevices>
     <zones>
         <zone name="primary zone" isPrimary="true" audioZoneId="0" occupantZoneId="1">
@@ -24,32 +23,51 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="music"/>
+                                <context context="announcement"/>
                             </device>
-                            <device address="bus3_call_ring_out">
-                                <context context="call_ring"/>
+                            <device address="notification_bus_device">
+                                <context context="notification"/>
                             </device>
                         </group>
                         <group>
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="navigation"/>
+                            </device>
+                            <device address="voice_bus_device">
+                                <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="call_bus_device">
+                                <context context="call"/>
+                            </device>
+                            <device address="ring_bus_device">
+                                <context context="call_ring"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="alarm_bus_device">
+                                <context context="alarm"/>
+                            </device>
+                            <device address="system_bus_device">
+                                <context context="system_sound"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
                 </zoneConfig>
             </zoneConfigs>
         </zone>
-        <zone name="rear seat zone" audioZoneId="2">
+        <zone name="secondary zone" audioZoneId="1">
             <zoneConfigs>
-                <zoneConfig name="rear seat zone config 1" isDefault="true">
+                <zoneConfig  name="secondary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group>
-                            <device address="bus100_rear_seat">
+                            <device address="secondary_zone_bus_100">
                                 <context context="music"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
@@ -66,22 +84,26 @@
                         </group>
                     </volumeGroups>
                 </zoneConfig>
-                <zoneConfig name="rear seat zone config 2">
+                <zoneConfig  name="secondary zone config 2">
                     <volumeGroups>
                         <group>
-                            <device address="bus101_rear_seat">
+                            <device address="secondary_zone_bus_200">
                                 <context context="music"/>
+                                <context context="announcement"/>
+                                <context context="notification"/>
                                 <context context="navigation"/>
                                 <context context="voice_command"/>
+                            </device>
+                        </group>
+                        <group>
+                            <device address="secondary_zone_bus_201">
                                 <context context="call_ring"/>
                                 <context context="call"/>
                                 <context context="alarm"/>
                                 <context context="system_sound"/>
-                                <context context="notification"/>
                                 <context context="emergency"/>
                                 <context context="safety"/>
                                 <context context="vehicle_status"/>
-                                <context context="announcement"/>
                             </device>
                         </group>
                     </volumeGroups>
diff --git a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_use_core_volume.xml
similarity index 86%
rename from tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume.xml
rename to tests/carservice_unit_test/res/raw/car_audio_configuration_with_use_core_volume.xml
index 5396faa292..d0fa0a844f 100644
--- a/tests/carservice_test/res/raw/car_audio_configuration_using_core_routing_and_volume.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_use_core_volume.xml
@@ -1,5 +1,5 @@
 <?xml version="1.0" ?>
-<!-- Copyright (C) 2023 The Android Open Source Project
+<!-- Copyright (C) 2024 The Android Open Source Project
 
      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
@@ -13,13 +13,16 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<carAudioConfiguration version="3">
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCoreAudioVolume" value="true"/>
+    </deviceConfigurations>
     <oemContexts>
         <oemContext name="OEM_CONTEXT">
             <audioAttributes>
                 <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
-                        contentType="AUDIO_CONTENT_TYPE_SPEECH"
-                        tags="oem=extension_1979" />
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
             </audioAttributes>
         </oemContext>
         <oemContext name="MUSIC_CONTEXT">
@@ -58,17 +61,17 @@
                 <zoneConfig  name="primary zone config 1" isDefault="true">
                     <volumeGroups>
                         <group name="MUSIC_GROUP">
-                            <device address="bus0_media_out">
+                            <device address="media_bus_device">
                                 <context context="MUSIC_CONTEXT"/>
                             </device>
                         </group>
                         <group name="NAV_GROUP">
-                            <device address="bus1_navigation_out">
+                            <device address="navigation_bus_device">
                                 <context context="NAV_CONTEXT"/>
                             </device>
                         </group>
                         <group name="OEM_GROUP">
-                            <device address="bus3_call_ring_out">
+                            <device address="oem_bus_device">
                                 <context context="OEM_CONTEXT"/>
                             </device>
                         </group>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_valid_use_group_muting_config.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_valid_use_group_muting_config.xml
new file mode 100644
index 0000000000..5eac0ba5ce
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_valid_use_group_muting_config.xml
@@ -0,0 +1,83 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useCarVolumeGroupMuting" value="true"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="OEM_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_configuration_with_valid_use_hal_ducking_config.xml b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_valid_use_hal_ducking_config.xml
new file mode 100644
index 0000000000..b3476a49a3
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_configuration_with_valid_use_hal_ducking_config.xml
@@ -0,0 +1,83 @@
+<?xml version="1.0" ?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioConfiguration version="4">
+    <deviceConfigurations>
+        <deviceConfiguration name="useHalDuckingSignals" value="true"/>
+    </deviceConfigurations>
+    <oemContexts>
+        <oemContext name="OEM_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH"
+                    tags="oem=extension_1979" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="MUSIC_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_MEDIA"  contentType="AUDIO_CONTENT_TYPE_MUSIC" />
+                <usage value="AUDIO_USAGE_NOTIFICATION" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_EVENT" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION" />
+                <usage value="AUDIO_USAGE_ALARM" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION" />
+                <usage value="AUDIO_USAGE_VOICE_COMMUNICATION_SIGNALLING" />
+                <usage value="AUDIO_USAGE_CALL_ASSISTANT" />
+                <usage value="AUDIO_USAGE_NOTIFICATION_TELEPHONY_RINGTONE"/>
+                <usage value="AUDIO_USAGE_MEDIA" />
+                <usage value="AUDIO_USAGE_GAME" />
+                <usage value="AUDIO_USAGE_UNKNOWN"/>
+                <usage value="AUDIO_USAGE_ASSISTANT"/>
+                <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                <usage value="AUDIO_USAGE_EMERGENCY" />
+                <usage value="AUDIO_USAGE_SAFETY" />
+                <usage value="AUDIO_USAGE_VEHICLE_STATUS" />
+                <usage value="AUDIO_USAGE_ANNOUNCEMENT" />
+            </audioAttributes>
+        </oemContext>
+        <oemContext name="NAV_CONTEXT">
+            <audioAttributes>
+                <audioAttribute usage="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"
+                    contentType="AUDIO_CONTENT_TYPE_SPEECH" />
+                <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE" />
+            </audioAttributes>
+        </oemContext>
+    </oemContexts>
+    <zones>
+        <zone isPrimary="true" name="primary zone" audioZoneId="0" occupantZoneId="0">
+            <zoneConfigs>
+                <zoneConfig  name="primary zone config 1" isDefault="true">
+                    <volumeGroups>
+                        <group name="MUSIC_GROUP">
+                            <device address="media_bus_device">
+                                <context context="MUSIC_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="NAV_GROUP">
+                            <device address="navigation_bus_device">
+                                <context context="NAV_CONTEXT"/>
+                            </device>
+                        </group>
+                        <group name="OEM_GROUP">
+                            <device address="oem_bus_device">
+                                <context context="OEM_CONTEXT"/>
+                            </device>
+                        </group>
+                    </volumeGroups>
+                </zoneConfig>
+            </zoneConfigs>
+        </zone>
+    </zones>
+</carAudioConfiguration>
diff --git a/tests/carservice_test/res/raw/car_audio_fade_configuration_withNoConfigs.xml b/tests/carservice_unit_test/res/raw/car_audio_fade_configuration_missing_configs.xml
similarity index 96%
rename from tests/carservice_test/res/raw/car_audio_fade_configuration_withNoConfigs.xml
rename to tests/carservice_unit_test/res/raw/car_audio_fade_configuration_missing_configs.xml
index 3068f8331b..1c9e8b41e5 100644
--- a/tests/carservice_test/res/raw/car_audio_fade_configuration_withNoConfigs.xml
+++ b/tests/carservice_unit_test/res/raw/car_audio_fade_configuration_missing_configs.xml
@@ -16,4 +16,4 @@
 <carAudioFadeConfiguration version="1">
      <configs>
      </configs>
-</carAudioFadeConfiguration>
\ No newline at end of file
+</carAudioFadeConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_fade_configuration_with_empty_config_name.xml b/tests/carservice_unit_test/res/raw/car_audio_fade_configuration_with_empty_config_name.xml
new file mode 100644
index 0000000000..ebb99876c0
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_fade_configuration_with_empty_config_name.xml
@@ -0,0 +1,139 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioFadeConfiguration version="1">
+     <configs>
+          <config name="" defaultFadeOutDurationInMillis="800"
+              defaultFadeInDurationInMillis="500">
+               <fadeState value="1"/>
+               <fadeableUsages>
+                    <usage value="AUDIO_USAGE_MEDIA"/>
+                    <usage value="AUDIO_USAGE_GAME"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                    <usage value="AUDIO_USAGE_ASSISTANT"/>
+                    <usage value="AUDIO_USAGE_NOTIFICATION"/>
+                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+               </fadeableUsages>
+               <unfadeableContentTypes>
+                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH"/>
+               </unfadeableContentTypes>
+               <unfadeableAudioAttributes>
+                    <audioAttributes>
+                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1"/>
+                    </audioAttributes>
+               </unfadeableAudioAttributes>
+               <fadeOutConfigurations>
+                    <fadeConfiguration fadeDurationMillis="1500">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_MEDIA"/>
+                              <usage value="AUDIO_USAGE_GAME"/>
+                              <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
+                                  tags="oem_specific_tag2"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+                    <fadeConfiguration fadeDurationMillis="1000">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                              <usage value="AUDIO_USAGE_ASSISTANT"/>
+                              <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+               </fadeOutConfigurations>
+               <fadeInConfigurations>
+                    <fadeConfiguration fadeDurationMillis="1000">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_MEDIA"/>
+                              <usage value="AUDIO_USAGE_GAME"/>
+                              <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
+                                  tags="oem_specific_tag2"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+                    <fadeConfiguration fadeDurationMillis="800">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                              <usage value="AUDIO_USAGE_ASSISTANT"/>
+                              <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+               </fadeInConfigurations>
+          </config>
+          <config name="aggressive fading">
+               <fadeState value="1"/>
+               <fadeableUsages>
+                    <usage value="AUDIO_USAGE_MEDIA"/>
+                    <usage value="AUDIO_USAGE_GAME"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                    <usage value="AUDIO_USAGE_ASSISTANT"/>
+                    <usage value="AUDIO_USAGE_NOTIFICATION"/>
+                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+               </fadeableUsages>
+               <unfadeableContentTypes>
+                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH"/>
+               </unfadeableContentTypes>
+               <unfadeableAudioAttributes>
+                    <audioAttributes>
+                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1"/>
+                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
+                             tags="oem_projection_service"/>
+                    </audioAttributes>
+               </unfadeableAudioAttributes>
+               <fadeOutConfigurations>
+                    <fadeConfiguration fadeDurationMillis="800">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_MEDIA"/>
+                              <usage value="AUDIO_USAGE_GAME"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+                    <fadeConfiguration fadeDurationMillis="700">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                              <usage value="AUDIO_USAGE_ASSISTANT"/>
+                              <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+               </fadeOutConfigurations>
+               <fadeInConfigurations>
+                    <fadeConfiguration fadeDurationMillis="600">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_MEDIA"/>
+                              <usage value="AUDIO_USAGE_GAME"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+                    <fadeConfiguration fadeDurationMillis="450">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                              <usage value="AUDIO_USAGE_ASSISTANT"/>
+                              <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+               </fadeInConfigurations>
+          </config>
+          <config name="disabled fading">
+               <fadeState value="0"/>
+          </config>
+     </configs>
+</carAudioFadeConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_audio_fade_configuration_with_null_config_name.xml b/tests/carservice_unit_test/res/raw/car_audio_fade_configuration_with_null_config_name.xml
new file mode 100644
index 0000000000..40d8a138da
--- /dev/null
+++ b/tests/carservice_unit_test/res/raw/car_audio_fade_configuration_with_null_config_name.xml
@@ -0,0 +1,138 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<carAudioFadeConfiguration version="1">
+     <configs>
+          <config defaultFadeOutDurationInMillis="800" defaultFadeInDurationInMillis="500">
+               <fadeState value="1"/>
+               <fadeableUsages>
+                    <usage value="AUDIO_USAGE_MEDIA"/>
+                    <usage value="AUDIO_USAGE_GAME"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                    <usage value="AUDIO_USAGE_ASSISTANT"/>
+                    <usage value="AUDIO_USAGE_NOTIFICATION"/>
+                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+               </fadeableUsages>
+               <unfadeableContentTypes>
+                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH"/>
+               </unfadeableContentTypes>
+               <unfadeableAudioAttributes>
+                    <audioAttributes>
+                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1"/>
+                    </audioAttributes>
+               </unfadeableAudioAttributes>
+               <fadeOutConfigurations>
+                    <fadeConfiguration fadeDurationMillis="1500">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_MEDIA"/>
+                              <usage value="AUDIO_USAGE_GAME"/>
+                              <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
+                                  tags="oem_specific_tag2"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+                    <fadeConfiguration fadeDurationMillis="1000">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                              <usage value="AUDIO_USAGE_ASSISTANT"/>
+                              <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+               </fadeOutConfigurations>
+               <fadeInConfigurations>
+                    <fadeConfiguration fadeDurationMillis="1000">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_MEDIA"/>
+                              <usage value="AUDIO_USAGE_GAME"/>
+                              <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
+                                  tags="oem_specific_tag2"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+                    <fadeConfiguration fadeDurationMillis="800">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                              <usage value="AUDIO_USAGE_ASSISTANT"/>
+                              <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+               </fadeInConfigurations>
+          </config>
+          <config name="aggressive fading">
+               <fadeState value="1"/>
+               <fadeableUsages>
+                    <usage value="AUDIO_USAGE_MEDIA"/>
+                    <usage value="AUDIO_USAGE_GAME"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                    <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                    <usage value="AUDIO_USAGE_ASSISTANT"/>
+                    <usage value="AUDIO_USAGE_NOTIFICATION"/>
+                    <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+               </fadeableUsages>
+               <unfadeableContentTypes>
+                    <contentType value="AUDIO_CONTENT_TYPE_SPEECH"/>
+               </unfadeableContentTypes>
+               <unfadeableAudioAttributes>
+                    <audioAttributes>
+                         <audioAttribute usage="AUDIO_USAGE_MEDIA" tags="oem_specific_tag1"/>
+                         <audioAttribute usage="AUDIO_USAGE_ASSISTANT"
+                             tags="oem_projection_service"/>
+                    </audioAttributes>
+               </unfadeableAudioAttributes>
+               <fadeOutConfigurations>
+                    <fadeConfiguration fadeDurationMillis="800">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_MEDIA"/>
+                              <usage value="AUDIO_USAGE_GAME"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+                    <fadeConfiguration fadeDurationMillis="700">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                              <usage value="AUDIO_USAGE_ASSISTANT"/>
+                              <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+               </fadeOutConfigurations>
+               <fadeInConfigurations>
+                    <fadeConfiguration fadeDurationMillis="600">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_MEDIA"/>
+                              <usage value="AUDIO_USAGE_GAME"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+                    <fadeConfiguration fadeDurationMillis="450">
+                         <audioAttributes>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_SONIFICATION"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_ACCESSIBILITY"/>
+                              <usage value="AUDIO_USAGE_ASSISTANCE_NAVIGATION_GUIDANCE"/>
+                              <usage value="AUDIO_USAGE_ASSISTANT"/>
+                              <usage value="AUDIO_USAGE_ANNOUNCEMENT"/>
+                         </audioAttributes>
+                    </fadeConfiguration>
+               </fadeInConfigurations>
+          </config>
+          <config name="disabled fading">
+               <fadeState value="0"/>
+          </config>
+     </configs>
+</carAudioFadeConfiguration>
diff --git a/tests/carservice_unit_test/res/raw/car_hidden_apis.txt b/tests/carservice_unit_test/res/raw/car_hidden_apis.txt
index 94b66f498a..b12c1b531d 100644
--- a/tests/carservice_unit_test/res/raw/car_hidden_apis.txt
+++ b/tests/carservice_unit_test/res/raw/car_hidden_apis.txt
@@ -20,7 +20,6 @@ android.car Car String CAR_SERVICE_INTERFACE_NAME
 android.car Car String CAR_TEMPLATE_HOST_RENDERER_SERVICE
 android.car Car String CLUSTER_HOME_SERVICE
 android.car Car String EXPERIMENTAL_CAR_KEYGUARD_SERVICE
-android.car Car String EXPERIMENTAL_CAR_USER_SERVICE
 android.car Car String PERMISSION_BIND_VMS_CLIENT
 android.car Car String PERMISSION_CAR_DISPLAY_IN_CLUSTER
 android.car Car String PERMISSION_COLLECT_CAR_CPU_INFO
@@ -28,12 +27,15 @@ android.car Car String PROPERTY_EMULATED_PLATFORM_VERSION_MAJOR
 android.car Car String PROPERTY_EMULATED_PLATFORM_VERSION_MINOR
 android.car Car T handleRemoteExceptionFromCarService(RemoteException e, T returnValue)
 android.car Car T handleRemoteExceptionFromCarService(Service service, RemoteException e, T returnValue)
+android.car Car record Deps(ServiceManager serviceManager, Process process, long carServiceBindRetryIntervalMs, long carServiceBindMaxRetry)
 android.car Car void handleRemoteExceptionFromCarService(RemoteException e)
 android.car Car void handleRemoteExceptionFromCarService(Service service, RemoteException e)
 android.car Car.CarBuilder Car createCar(Context context)
 android.car Car.CarBuilder Car createCar(Context context, Handler handler)
 android.car Car.CarBuilder Car createCar(Context context, Handler handler, long waitTimeoutMs, CarServiceLifecycleListener statusChangeListener)
-android.car Car.CarBuilder CarBuilder setServiceManager(ServiceManager serviceManager)
+android.car Car.CarBuilder Car createCar(Context context, ServiceConnection serviceConnectionListener)
+android.car Car.CarBuilder Car createCar(Context context, ServiceConnection serviceConnectionListener, Handler handler)
+android.car Car.CarBuilder CarBuilder setFakeDeps(Deps deps)
 android.car CarAppFocusManager int APP_FOCUS_MAX
 android.car CarAppFocusManager int[] getActiveAppTypes()
 android.car CarAppFocusManager void onCarDisconnected()
@@ -708,15 +710,6 @@ android.car.user CarUserManager void updatePreCreatedUsers()
 android.car.user CarUserManager.UserLifecycleEvent int getPreviousUserId()
 android.car.user CarUserManager.UserLifecycleEvent int getUserId()
 android.car.user CarUserManager.UserSwitchUiCallback void showUserSwitchDialog(int userId)
-android.car.user ExperimentalCarUserManager AndroidFuture<UserCreationResult> createDriver(String name, boolean admin)
-android.car.user ExperimentalCarUserManager AndroidFuture<UserSwitchResult> switchDriver(int driverId)
-android.car.user ExperimentalCarUserManager List<Integer> getAllDrivers()
-android.car.user ExperimentalCarUserManager List<Integer> getPassengers(int driverId)
-android.car.user ExperimentalCarUserManager String TAG
-android.car.user ExperimentalCarUserManager boolean startPassenger(int passengerId, int zoneId)
-android.car.user ExperimentalCarUserManager boolean stopPassenger(int passengerId)
-android.car.user ExperimentalCarUserManager int createPassenger(String name, int driverId)
-android.car.user ExperimentalCarUserManager void onCarDisconnected()
 android.car.user OperationResult boolean isSuccess()
 android.car.user UserIdentificationAssociationResponse Parcelable.Creator<UserIdentificationAssociationResponse> CREATOR
 android.car.user UserIdentificationAssociationResponse String getErrorMessage()
diff --git a/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.1.txt b/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.1.txt
deleted file mode 100644
index 66cfb79e60..0000000000
--- a/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.1.txt
+++ /dev/null
@@ -1,756 +0,0 @@
-android.car AoapService int MSG_NEW_DEVICE_ATTACHED
-android.car AoapService int MSG_NEW_DEVICE_ATTACHED_RESPONSE
-android.car AoapService int MSG_CAN_SWITCH_TO_AOAP
-android.car AoapService int MSG_CAN_SWITCH_TO_AOAP_RESPONSE
-android.car AoapService String KEY_DEVICE
-android.car AoapService String KEY_RESULT
-android.car ApiVersion boolean equals(Object obj)
-android.car ApiVersion int hashCode()
-android.car ApiVersion String toString()
-android.car ApiVersion void writeToParcel(Parcel dest)
-android.car ApiVersion T readFromParcel(Parcel source, ApiVersionFactory<T> factory)
-android.car Car String PROPERTY_EMULATED_PLATFORM_VERSION_MAJOR
-android.car Car String PROPERTY_EMULATED_PLATFORM_VERSION_MINOR
-android.car Car String CAR_SERVICE_BINDER_SERVICE_NAME
-android.car Car String EXPERIMENTAL_CAR_USER_SERVICE
-android.car Car String CAR_INSTRUMENT_CLUSTER_SERVICE
-android.car Car String CLUSTER_HOME_SERVICE
-android.car Car String PERMISSION_CAR_MONITOR_CLUSTER_NAVIGATION_STATE
-android.car Car String PERMISSION_CAR_DISPLAY_IN_CLUSTER
-android.car Car String PERMISSION_BIND_VMS_CLIENT
-android.car Car String PERMISSION_COLLECT_CAR_CPU_INFO
-android.car Car String CAR_TEMPLATE_HOST_RENDERER_SERVICE
-android.car Car String CAR_SERVICE_INTERFACE_NAME
-android.car Car String CAR_CATEGORY_NAVIGATION
-android.car Car ServiceConnection getServiceConnectionListener()
-android.car Car Context getContext()
-android.car Car Handler getEventHandler()
-android.car Car T handleRemoteExceptionFromCarService(RemoteException e, T returnValue)
-android.car Car void handleRemoteExceptionFromCarService(RemoteException e)
-android.car Car T handleRemoteExceptionFromCarService(Service service, RemoteException e, T returnValue)
-android.car Car void handleRemoteExceptionFromCarService(Service service, RemoteException e)
-android.car CarAppFocusManager int APP_FOCUS_MAX
-android.car CarAppFocusManager int[] getActiveAppTypes()
-android.car CarAppFocusManager List<String> getAppTypeOwner(int appType)
-android.car CarAppFocusManager void onCarDisconnected()
-android.car CarBugreportManager void requestBugreportForTesting(ParcelFileDescriptor output, ParcelFileDescriptor extraOutput, CarBugreportManagerCallback callback)
-android.car CarBugreportManager void onCarDisconnected()
-android.car CarFeatures String FEATURE_CAR_USER_NOTICE_SERVICE
-android.car CarInfoManager int BASIC_INFO_KEY_MANUFACTURER
-android.car CarInfoManager int BASIC_INFO_KEY_MODEL
-android.car CarInfoManager int BASIC_INFO_KEY_MODEL_YEAR
-android.car CarInfoManager String BASIC_INFO_KEY_VEHICLE_ID
-android.car CarInfoManager String INFO_KEY_PRODUCT_CONFIGURATION
-android.car CarInfoManager int BASIC_INFO_DRIVER_SEAT
-android.car CarInfoManager int BASIC_INFO_EV_PORT_LOCATION
-android.car CarInfoManager int BASIC_INFO_FUEL_DOOR_LOCATION
-android.car CarInfoManager int BASIC_INFO_FUEL_CAPACITY
-android.car CarInfoManager int BASIC_INFO_FUEL_TYPES
-android.car CarInfoManager int BASIC_INFO_EV_BATTERY_CAPACITY
-android.car CarInfoManager int BASIC_INFO_EV_CONNECTOR_TYPES
-android.car CarInfoManager void onCarDisconnected()
-android.car CarLibLog String TAG_CAR
-android.car CarLibLog String TAG_CLUSTER
-android.car CarLibLog String TAG_INPUT
-android.car CarLibLog String TAG_NAV
-android.car CarLibLog String TAG_SENSOR
-android.car CarLibLog String TAG_DIAGNOSTIC
-android.car CarManagerBase Car mCar
-android.car CarManagerBase Context getContext()
-android.car CarManagerBase Handler getEventHandler()
-android.car CarManagerBase T handleRemoteExceptionFromCarService(RemoteException e, T returnValue)
-android.car CarManagerBase void handleRemoteExceptionFromCarService(RemoteException e)
-android.car CarManagerBase T handleExceptionFromCarService(Exception e, T returnValue)
-android.car CarManagerBase void onCarDisconnected()
-android.car CarManagerBase T addDumpable(Object container, Supplier<T> dumpableSupplier)
-android.car CarOccupantZoneManager int OCCUPANT_TYPE_INVALID
-android.car CarOccupantZoneManager boolean assignProfileUserToOccupantZone(OccupantZoneInfo occupantZone, int userId)
-android.car CarOccupantZoneManager void onCarDisconnected()
-android.car CarOccupantZoneManager.OccupantZoneInfo int INVALID_ZONE_ID
-android.car CarProjectionManager int NUM_KEY_EVENTS
-android.car CarProjectionManager int PROJECTION_AP_STARTED
-android.car CarProjectionManager int PROJECTION_AP_STOPPED
-android.car CarProjectionManager int PROJECTION_AP_FAILED
-android.car CarProjectionManager void regsiterProjectionListener(CarProjectionListener listener, int voiceSearchFilter)
-android.car CarProjectionManager void unregsiterProjectionListener()
-android.car CarProjectionManager void onCarDisconnected()
-android.car VehicleAreaSeat int SIDE_LEFT
-android.car VehicleAreaSeat int SIDE_CENTER
-android.car VehicleAreaSeat int SIDE_RIGHT
-android.car VehicleAreaSeat int fromRowAndSide(int rowNumber, int side)
-android.car VehicleHvacFanDirection int FACE
-android.car VehicleHvacFanDirection int FLOOR
-android.car VehicleHvacFanDirection int DEFROST
-android.car VehicleLightState int OFF
-android.car VehicleLightState int ON
-android.car VehicleLightState int DAYTIME_RUNNING
-android.car VehicleLightSwitch int OFF
-android.car VehicleLightSwitch int ON
-android.car VehicleLightSwitch int DAYTIME_RUNNING
-android.car VehicleLightSwitch int AUTOMATIC
-android.car VehicleOilLevel int CRITICALLY_LOW
-android.car VehicleOilLevel int LOW
-android.car VehicleOilLevel int NORMAL
-android.car VehicleOilLevel int HIGH
-android.car VehicleOilLevel int ERROR
-android.car VehiclePropertyIds int INITIAL_USER_INFO
-android.car VehiclePropertyIds int SWITCH_USER
-android.car VehiclePropertyIds int CREATE_USER
-android.car VehiclePropertyIds int REMOVE_USER
-android.car VehiclePropertyIds int USER_IDENTIFICATION_ASSOCIATION
-android.car VehiclePropertyIds int POWER_POLICY_REQ
-android.car VehiclePropertyIds int POWER_POLICY_GROUP_REQ
-android.car VehiclePropertyIds int CURRENT_POWER_POLICY
-android.car VehiclePropertyIds int WATCHDOG_ALIVE
-android.car VehiclePropertyIds int WATCHDOG_TERMINATED_PROCESS
-android.car VehiclePropertyIds int VHAL_HEARTBEAT
-android.car VehiclePropertyIds int CLUSTER_SWITCH_UI
-android.car VehiclePropertyIds int CLUSTER_DISPLAY_STATE
-android.car VehiclePropertyIds int CLUSTER_REPORT_STATE
-android.car VehiclePropertyIds int CLUSTER_REQUEST_DISPLAY
-android.car VehiclePropertyIds int CLUSTER_NAVIGATION_STATE
-android.car VehiclePropertyType int STRING
-android.car VehiclePropertyType int BOOLEAN
-android.car VehiclePropertyType int INT32
-android.car VehiclePropertyType int INT32_VEC
-android.car VehiclePropertyType int INT64
-android.car VehiclePropertyType int INT64_VEC
-android.car VehiclePropertyType int FLOAT
-android.car VehiclePropertyType int FLOAT_VEC
-android.car VehiclePropertyType int BYTES
-android.car VehiclePropertyType int MIXED
-android.car VehiclePropertyType int MASK
-android.car VehicleSeatOccupancyState int UNKNOWN
-android.car VehicleSeatOccupancyState int VACANT
-android.car VehicleSeatOccupancyState int OCCUPIED
-android.car.admin CarDevicePolicyManager String TAG
-android.car.admin CarDevicePolicyManager int FIRST_USER_TYPE
-android.car.admin CarDevicePolicyManager int LAST_USER_TYPE
-android.car.admin CarDevicePolicyManager StartUserInBackgroundResult startUserInBackground(UserHandle user)
-android.car.admin CarDevicePolicyManager StopUserResult stopUser(UserHandle user)
-android.car.admin CarDevicePolicyManager void setUserDisclaimerShown(UserHandle user)
-android.car.admin CarDevicePolicyManager void setUserDisclaimerAcknowledged(UserHandle user)
-android.car.admin CarDevicePolicyManager void onCarDisconnected()
-android.car.admin CreateUserResult CreateUserResult forGenericError()
-android.car.admin RemoveUserResult String statusToString(int status)
-android.car.admin StartUserInBackgroundResult int STATUS_SUCCESS
-android.car.admin StartUserInBackgroundResult int STATUS_SUCCESS_CURRENT_USER
-android.car.admin StartUserInBackgroundResult int STATUS_FAILURE_USER_DOES_NOT_EXIST
-android.car.admin StartUserInBackgroundResult int STATUS_FAILURE_GENERIC
-android.car.admin StartUserInBackgroundResult int getStatus()
-android.car.admin StartUserInBackgroundResult boolean isSuccess()
-android.car.admin StartUserInBackgroundResult String toString()
-android.car.admin StopUserResult int STATUS_SUCCESS
-android.car.admin StopUserResult int STATUS_FAILURE_CURRENT_USER
-android.car.admin StopUserResult int STATUS_FAILURE_SYSTEM_USER
-android.car.admin StopUserResult int STATUS_FAILURE_USER_DOES_NOT_EXIST
-android.car.admin StopUserResult int STATUS_FAILURE_GENERIC
-android.car.admin StopUserResult int getStatus()
-android.car.admin StopUserResult boolean isSuccess()
-android.car.admin StopUserResult String toString()
-android.car.app CarActivityManager int ERROR_CODE_ACTIVITY_NOT_FOUND
-android.car.app CarActivityManager void onCarDisconnected()
-android.car.app CarActivityManager boolean registerTaskMonitor()
-android.car.app CarActivityManager void onTaskAppeared(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void onTaskVanished(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void onTaskInfoChanged(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void unregisterTaskMonitor()
-android.car.app CarActivityManager List<ActivityManager.RunningTaskInfo> getVisibleTasks()
-android.car.cluster CarInstrumentClusterManager void onCarDisconnected()
-android.car.cluster ClusterHomeManager int UI_TYPE_CLUSTER_NONE
-android.car.cluster ClusterHomeManager int UI_TYPE_CLUSTER_HOME
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_ON_OFF
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_BOUNDS
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_INSETS
-android.car.cluster ClusterHomeManager int CONFIG_UI_TYPE
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_ID
-android.car.cluster ClusterHomeManager void registerClusterStateListener(Executor executor, ClusterStateListener callback)
-android.car.cluster ClusterHomeManager void registerClusterNavigationStateListener(Executor executor, ClusterNavigationStateListener callback)
-android.car.cluster ClusterHomeManager void unregisterClusterStateListener(ClusterStateListener callback)
-android.car.cluster ClusterHomeManager void unregisterClusterNavigationStateListener(ClusterNavigationStateListener callback)
-android.car.cluster ClusterHomeManager void reportState(int uiTypeMain, int uiTypeSub, byte[] uiAvailability)
-android.car.cluster ClusterHomeManager void requestDisplay(int uiType)
-android.car.cluster ClusterHomeManager ClusterState getClusterState()
-android.car.cluster ClusterHomeManager boolean startFixedActivityModeAsUser(Intent intent, Bundle options, int userId)
-android.car.cluster ClusterHomeManager void stopFixedActivityMode()
-android.car.cluster ClusterHomeManager void onCarDisconnected()
-android.car.cluster.renderer InstrumentClusterRenderingService String EXTRA_BUNDLE_KEY_FOR_INSTRUMENT_CLUSTER_HELPER
-android.car.cluster.renderer InstrumentClusterRenderingService ComponentName getComponentFromPackage(String packageName)
-android.car.cluster.renderer InstrumentClusterRenderingService void setClusterActivityLaunchOptions(String category, ActivityOptions activityOptions)
-android.car.cluster.renderer InstrumentClusterRenderingService void setClusterActivityState(String category, Bundle state)
-android.car.content.pm AppBlockingPackageInfo void verify()
-android.car.content.pm AppBlockingPackageInfo boolean isActivityCovered(String className)
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_BLOCKED_ACTIVITY_NAME
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_BLOCKED_TASK_ID
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_ROOT_ACTIVITY_NAME
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_IS_ROOT_ACTIVITY_DO
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_DISPLAY_ID
-android.car.content.pm CarPackageManager String DRIVING_SAFETY_REGION_ALL
-android.car.content.pm CarPackageManager String DRIVING_SAFETY_ACTIVITY_METADATA_REGIONS
-android.car.content.pm CarPackageManager int ERROR_CODE_NO_PACKAGE
-android.car.content.pm CarPackageManager void onCarDisconnected()
-android.car.content.pm CarPackageManager void restartTask(int taskId)
-android.car.content.pm CarPackageManager void setEnableActivityBlocking(boolean enable)
-android.car.content.pm CarPackageManager String getCurrentDrivingSafetyRegion()
-android.car.content.pm CarPackageManager void controlTemporaryActivityBlockingBypassingAsUser(String packageName, String activityClassName, boolean bypass, int userId)
-android.car.content.pm CarPackageManager List<String> getSupportedDrivingSafetyRegionsForActivityAsUser(String packageName, String activityClassName, int userId)
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent withVendorSensorsRemoved()
-android.car.diagnostic CarDiagnosticEvent boolean isEmptyFrame()
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent checkLiveFrame()
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent checkFreezeFrame()
-android.car.diagnostic CarDiagnosticEvent boolean isEarlierThan(CarDiagnosticEvent otherEvent)
-android.car.diagnostic CarDiagnosticEvent.IgnitionMonitor.Decoder IgnitionMonitor fromValue(int value)
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int COMPONENTS_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int COMPONENTS_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int FUEL_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int FUEL_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int MISFIRE_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int MISFIRE_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EGR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EGR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_HEATER_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_HEATER_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int AC_REFRIGERANT_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int AC_REFRIGERANT_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int SECONDARY_AIR_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int SECONDARY_AIR_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EVAPORATIVE_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EVAPORATIVE_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int HEATED_CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int HEATED_CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EGR_OR_VVT_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EGR_OR_VVT_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int PM_FILTER_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int PM_FILTER_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EXHAUST_GAS_SENSOR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EXHAUST_GAS_SENSOR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int BOOST_PRESSURE_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int BOOST_PRESSURE_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NOx_SCR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NOx_SCR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NMHC_CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NMHC_CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticManager int[] FRAME_TYPES
-android.car.drivingstate CarDrivingStateManager void onCarDisconnected()
-android.car.drivingstate CarDrivingStateManager void injectDrivingState(int drivingState)
-android.car.drivingstate CarUxRestrictions long getTimeStamp()
-android.car.drivingstate CarUxRestrictionsConfiguration void writeJson(JsonWriter writer)
-android.car.drivingstate CarUxRestrictionsConfiguration CarUxRestrictionsConfiguration readJson(JsonReader reader, int schemaVersion)
-android.car.drivingstate CarUxRestrictionsConfiguration boolean hasSameParameters(CarUxRestrictionsConfiguration other)
-android.car.drivingstate CarUxRestrictionsConfiguration void dump(PrintWriter writer)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Map<String,RestrictionModeContainer> mRestrictionModes
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder int validatePort(int port)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setPhysicalPort(int port)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, boolean requiresOptimization, int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, SpeedRange speedRange, boolean requiresOptimization, int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, DrivingStateRestrictions drivingStateRestrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxStringLength(int maxStringLength)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxCumulativeContentItems(int maxCumulativeContentItems)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxContentDepth(int maxContentDepth)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder CarUxRestrictionsConfiguration build()
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setDistractionOptimizationRequired(boolean distractionOptimizationRequired)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setRestrictions(int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setMode(String mode)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setSpeedRange(Builder.SpeedRange speedRange)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions String toString()
-android.car.drivingstate CarUxRestrictionsManager void registerListener(OnUxRestrictionsChangedListener listener, int displayId)
-android.car.evs CarEvsManager void onCarDisconnected()
-android.car.hardware CarPropertyConfig String getConfigString()
-android.car.hardware CarPropertyConfig int getAreaCount()
-android.car.hardware CarPropertyConfig int getFirstAndOnlyAreaId()
-android.car.hardware CarPropertyConfig boolean hasArea(int areaId)
-android.car.hardware CarPropertyConfig String toString()
-android.car.hardware CarPropertyConfig Builder<T> newBuilder(Class<T> type, int propertyId, int areaType)
-android.car.hardware CarPropertyConfig.AreaConfig Parcelable.Creator<AreaConfig<Object>> CREATOR
-android.car.hardware CarPropertyConfig.AreaConfig T getMinValue()
-android.car.hardware CarPropertyConfig.AreaConfig T getMaxValue()
-android.car.hardware CarPropertyConfig.AreaConfig int describeContents()
-android.car.hardware CarPropertyConfig.AreaConfig void writeToParcel(Parcel dest, int flags)
-android.car.hardware CarPropertyConfig.AreaConfig String toString()
-android.car.hardware CarPropertyValue String toString()
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_SUPPORTED_WHEELS
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_FRONT_LEFT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_FRONT_RIGHT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_REAR_RIGHT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_REAR_LEFT_UM_PER_TICK
-android.car.hardware CarSensorConfig Parcelable.Creator<CarSensorConfig> CREATOR
-android.car.hardware CarSensorConfig int describeContents()
-android.car.hardware CarSensorConfig void writeToParcel(Parcel dest, int flags)
-android.car.hardware CarSensorConfig Bundle getBundle()
-android.car.hardware CarSensorConfig int getInt(String key)
-android.car.hardware CarSensorConfig int getType()
-android.car.hardware CarSensorConfig String toString()
-android.car.hardware CarSensorEvent EnvironmentData getEnvironmentData(EnvironmentData data)
-android.car.hardware CarSensorEvent IgnitionStateData getIgnitionStateData(IgnitionStateData data)
-android.car.hardware CarSensorEvent NightData getNightData(NightData data)
-android.car.hardware CarSensorEvent GearData getGearData(GearData data)
-android.car.hardware CarSensorEvent ParkingBrakeData getParkingBrakeData(ParkingBrakeData data)
-android.car.hardware CarSensorEvent FuelLevelData getFuelLevelData(FuelLevelData data)
-android.car.hardware CarSensorEvent OdometerData getOdometerData(OdometerData data)
-android.car.hardware CarSensorEvent RpmData getRpmData(RpmData data)
-android.car.hardware CarSensorEvent CarSpeedData getCarSpeedData(CarSpeedData data)
-android.car.hardware CarSensorEvent CarWheelTickDistanceData getCarWheelTickDistanceData(CarWheelTickDistanceData data)
-android.car.hardware CarSensorEvent CarAbsActiveData getCarAbsActiveData(CarAbsActiveData data)
-android.car.hardware CarSensorEvent CarTractionControlActiveData getCarTractionControlActiveData(CarTractionControlActiveData data)
-android.car.hardware CarSensorEvent CarFuelDoorOpenData getCarFuelDoorOpenData(CarFuelDoorOpenData data)
-android.car.hardware CarSensorEvent CarEvBatteryLevelData getCarEvBatteryLevelData(CarEvBatteryLevelData data)
-android.car.hardware CarSensorEvent CarEvChargePortOpenData getCarEvChargePortOpenData(CarEvChargePortOpenData data)
-android.car.hardware CarSensorEvent CarEvChargePortConnectedData getCarEvChargePortConnectedData(CarEvChargePortConnectedData data)
-android.car.hardware CarSensorEvent CarEvBatteryChargeRateData getCarEvBatteryChargeRateData(CarEvBatteryChargeRateData data)
-android.car.hardware CarSensorEvent CarEngineOilLevelData getCarEngineOilLevelData(CarEngineOilLevelData data)
-android.car.hardware CarSensorEvent String toString()
-android.car.hardware CarSensorEvent.IgnitionStateData long timestamp
-android.car.hardware CarSensorEvent.IgnitionStateData int ignitionState
-android.car.hardware CarSensorEvent.NightData long timestamp
-android.car.hardware CarSensorEvent.NightData boolean isNightMode
-android.car.hardware CarSensorEvent.GearData long timestamp
-android.car.hardware CarSensorEvent.GearData int gear
-android.car.hardware CarSensorEvent.ParkingBrakeData long timestamp
-android.car.hardware CarSensorEvent.ParkingBrakeData boolean isEngaged
-android.car.hardware CarSensorEvent.FuelLevelData long timestamp
-android.car.hardware CarSensorEvent.FuelLevelData float level
-android.car.hardware CarSensorEvent.OdometerData long timestamp
-android.car.hardware CarSensorEvent.OdometerData float kms
-android.car.hardware CarSensorEvent.RpmData long timestamp
-android.car.hardware CarSensorEvent.RpmData float rpm
-android.car.hardware CarSensorEvent.CarSpeedData long timestamp
-android.car.hardware CarSensorEvent.CarSpeedData float carSpeed
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long timestamp
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long sensorResetCount
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long frontLeftWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long frontRightWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long rearRightWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long rearLeftWheelDistanceMm
-android.car.hardware CarSensorEvent.CarAbsActiveData long timestamp
-android.car.hardware CarSensorEvent.CarAbsActiveData boolean absIsActive
-android.car.hardware CarSensorEvent.CarTractionControlActiveData long timestamp
-android.car.hardware CarSensorEvent.CarTractionControlActiveData boolean tractionControlIsActive
-android.car.hardware CarSensorEvent.CarFuelDoorOpenData long timestamp
-android.car.hardware CarSensorEvent.CarFuelDoorOpenData boolean fuelDoorIsOpen
-android.car.hardware CarSensorEvent.CarEvBatteryLevelData long timestamp
-android.car.hardware CarSensorEvent.CarEvBatteryLevelData float evBatteryLevel
-android.car.hardware CarSensorEvent.CarEvChargePortOpenData long timestamp
-android.car.hardware CarSensorEvent.CarEvChargePortOpenData boolean evChargePortIsOpen
-android.car.hardware CarSensorEvent.CarEvChargePortConnectedData long timestamp
-android.car.hardware CarSensorEvent.CarEvChargePortConnectedData boolean evChargePortIsConnected
-android.car.hardware CarSensorEvent.CarEvBatteryChargeRateData long timestamp
-android.car.hardware CarSensorEvent.CarEvBatteryChargeRateData float evChargeRate
-android.car.hardware CarSensorEvent.CarEngineOilLevelData long timestamp
-android.car.hardware CarSensorEvent.CarEngineOilLevelData int engineOilLevel
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED1
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED8
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED10
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED11
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED12
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED13
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED14
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED15
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED16
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED17
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED18
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED19
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED20
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED21
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED26
-android.car.hardware CarSensorManager void onCarDisconnected()
-android.car.hardware CarSensorManager boolean isSensorSupported(int[] sensorList, int sensorType)
-android.car.hardware CarSensorManager CarSensorConfig getSensorConfig(int type)
-android.car.hardware CarVendorExtensionManager void onCarDisconnected()
-android.car.hardware.cabin CarCabinManager void onCarDisconnected()
-android.car.hardware.hvac CarHvacManager void onCarDisconnected()
-android.car.hardware.power CarPowerManager String TAG
-android.car.hardware.power CarPowerManager void requestShutdownOnNextSuspend()
-android.car.hardware.power CarPowerManager void scheduleNextWakeupTime(int seconds)
-android.car.hardware.power CarPowerManager boolean isCompletionAllowed(int state)
-android.car.hardware.power CarPowerManager void onCarDisconnected()
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_ENABLED
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_DISABLED
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_UNTOUCHED
-android.car.hardware.power PowerComponentUtil int INVALID_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil int FIRST_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil int LAST_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil boolean isValidPowerComponent(int component)
-android.car.hardware.power PowerComponentUtil boolean hasComponents(CarPowerPolicy policy, CarPowerPolicyFilter filter)
-android.car.hardware.power PowerComponentUtil int toPowerComponent(String component, boolean prefix)
-android.car.hardware.power PowerComponentUtil String powerComponentToString(int component)
-android.car.hardware.property CarPropertyEvent int PROPERTY_EVENT_PROPERTY_CHANGE
-android.car.hardware.property CarPropertyEvent int PROPERTY_EVENT_ERROR
-android.car.hardware.property CarPropertyEvent Parcelable.Creator<CarPropertyEvent> CREATOR
-android.car.hardware.property CarPropertyEvent int getEventType()
-android.car.hardware.property CarPropertyEvent CarPropertyValue<?> getCarPropertyValue()
-android.car.hardware.property CarPropertyEvent int describeContents()
-android.car.hardware.property CarPropertyEvent void writeToParcel(Parcel dest, int flags)
-android.car.hardware.property CarPropertyEvent CarPropertyEvent createErrorEventWithErrorCode(int propertyId, int areaId, int errorCode)
-android.car.hardware.property CarPropertyEvent int getErrorCode()
-android.car.hardware.property CarPropertyEvent String toString()
-android.car.hardware.property CarPropertyManager String getReadPermission(int propId)
-android.car.hardware.property CarPropertyManager String getWritePermission(int propId)
-android.car.hardware.property CarPropertyManager void onCarDisconnected()
-android.car.hardware.property VehicleHalStatusCode int STATUS_OK
-android.car.hardware.property VehicleHalStatusCode int STATUS_TRY_AGAIN
-android.car.hardware.property VehicleHalStatusCode int STATUS_INVALID_ARG
-android.car.hardware.property VehicleHalStatusCode int STATUS_NOT_AVAILABLE
-android.car.hardware.property VehicleHalStatusCode int STATUS_ACCESS_DENIED
-android.car.hardware.property VehicleHalStatusCode int STATUS_INTERNAL_ERROR
-android.car.input CarInputManager void onCarDisconnected()
-android.car.media CarAudioManager int INVALID_VOLUME_GROUP_ID
-android.car.media CarAudioManager String AUDIOFOCUS_EXTRA_REQUEST_ZONE_ID
-android.car.media CarAudioManager boolean isDynamicRoutingEnabled()
-android.car.media CarAudioManager int getZoneIdForUid(int uid)
-android.car.media CarAudioManager boolean setZoneIdForUid(int zoneId, int uid)
-android.car.media CarAudioManager boolean clearZoneIdForUid(int uid)
-android.car.media CarAudioManager void onCarDisconnected()
-android.car.media CarAudioPatchHandle String getSourceAddress()
-android.car.media CarAudioPatchHandle String getSinkAddress()
-android.car.media CarAudioPatchHandle int getHandleId()
-android.car.media CarMediaManager void onCarDisconnected()
-android.car.media CarMediaManager boolean isIndependentPlaybackConfig()
-android.car.media CarMediaManager void setIndependentPlaybackConfig(boolean independent)
-android.car.navigation CarNavigationInstrumentCluster Bundle getExtra()
-android.car.navigation CarNavigationStatusManager void onCarDisconnected()
-android.car.occupantawareness DriverMonitoringDetection int confidenceLevel
-android.car.occupantawareness DriverMonitoringDetection boolean isLookingOnRoad
-android.car.occupantawareness DriverMonitoringDetection long gazeDurationMillis
-android.car.occupantawareness DriverMonitoringDetection Parcelable.Creator<DriverMonitoringDetection> CREATOR
-android.car.occupantawareness DriverMonitoringDetection int describeContents()
-android.car.occupantawareness DriverMonitoringDetection String toString()
-android.car.occupantawareness DriverMonitoringDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_UNKNOWN
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_CENTER_INSTRUMENT_CLUSTER
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_REAR_VIEW_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_LEFT_SIDE_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_RIGHT_SIDE_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_FORWARD_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_LEFT_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_RIGHT_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_HEAD_UNIT_DISPLAY
-android.car.occupantawareness GazeDetection int confidenceLevel
-android.car.occupantawareness GazeDetection Point3D leftEyePosition
-android.car.occupantawareness GazeDetection Point3D rightEyePosition
-android.car.occupantawareness GazeDetection Point3D headAngleUnitVector
-android.car.occupantawareness GazeDetection Point3D gazeAngleUnitVector
-android.car.occupantawareness GazeDetection int gazeTarget
-android.car.occupantawareness GazeDetection long durationOnTargetMillis
-android.car.occupantawareness GazeDetection Parcelable.Creator<GazeDetection> CREATOR
-android.car.occupantawareness GazeDetection int describeContents()
-android.car.occupantawareness GazeDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness GazeDetection String toString()
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_NONE
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_DRIVER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_FRONT_PASSENGER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_LEFT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_CENTER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_RIGHT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_LEFT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_CENTER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_RIGHT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_FRONT_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_ROW_2_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_ROW_3_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_NONE
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_LOW
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_HIGH
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_MAX
-android.car.occupantawareness OccupantAwarenessDetection int role
-android.car.occupantawareness OccupantAwarenessDetection long timestampMillis
-android.car.occupantawareness OccupantAwarenessDetection boolean isPresent
-android.car.occupantawareness OccupantAwarenessDetection GazeDetection gazeDetection
-android.car.occupantawareness OccupantAwarenessDetection DriverMonitoringDetection driverMonitoringDetection
-android.car.occupantawareness OccupantAwarenessDetection Parcelable.Creator<OccupantAwarenessDetection> CREATOR
-android.car.occupantawareness OccupantAwarenessDetection int describeContents()
-android.car.occupantawareness OccupantAwarenessDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness OccupantAwarenessDetection String toString()
-android.car.occupantawareness OccupantAwarenessManager void onCarDisconnected()
-android.car.occupantawareness OccupantAwarenessManager int getCapabilityForRole(int role)
-android.car.occupantawareness OccupantAwarenessManager void registerChangeCallback(ChangeCallback callback)
-android.car.occupantawareness OccupantAwarenessManager void unregisterChangeCallback()
-android.car.occupantawareness Point3D double x
-android.car.occupantawareness Point3D double y
-android.car.occupantawareness Point3D double z
-android.car.occupantawareness Point3D Parcelable.Creator<Point3D> CREATOR
-android.car.occupantawareness Point3D int describeContents()
-android.car.occupantawareness Point3D void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness Point3D String toString()
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_READY
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_NOT_SUPPORTED
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_NOT_READY
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_SYSTEM_FAILURE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_NONE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_PRESENCE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_GAZE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_DRIVER_MONITORING
-android.car.occupantawareness SystemStatusEvent int systemStatus
-android.car.occupantawareness SystemStatusEvent int detectionType
-android.car.occupantawareness SystemStatusEvent Parcelable.Creator<SystemStatusEvent> CREATOR
-android.car.occupantawareness SystemStatusEvent int describeContents()
-android.car.occupantawareness SystemStatusEvent void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness SystemStatusEvent String toString()
-android.car.os CarPerformanceManager void onCarDisconnected()
-android.car.os CarPerformanceManager void addCpuAvailabilityChangeListener(Executor executor, CpuAvailabilityMonitoringConfig config, CpuAvailabilityChangeListener listener)
-android.car.os CarPerformanceManager void removeCpuAvailabilityChangeListener(Executor executor, CpuAvailabilityChangeListener listener)
-android.car.os CpuAvailabilityInfo Parcelable.Creator<CpuAvailabilityInfo> CREATOR
-android.car.os CpuAvailabilityInfo int getCpuset()
-android.car.os CpuAvailabilityInfo int getAverageAvailabilityPercent()
-android.car.os CpuAvailabilityInfo boolean isTimeout()
-android.car.os CpuAvailabilityInfo String toString()
-android.car.os CpuAvailabilityInfo void writeToParcel(android.os.Parcel dest, int flags)
-android.car.os CpuAvailabilityInfo int describeContents()
-android.car.os CpuAvailabilityInfo.Builder Builder setCpuset(int value)
-android.car.os CpuAvailabilityInfo.Builder Builder setAverageAvailabilityPercent(int value)
-android.car.os CpuAvailabilityInfo.Builder Builder setTimeout(boolean value)
-android.car.os CpuAvailabilityInfo.Builder CpuAvailabilityInfo build()
-android.car.os CpuAvailabilityMonitoringConfig int CPUSET_ALL
-android.car.os CpuAvailabilityMonitoringConfig int CPUSET_BACKGROUND
-android.car.os CpuAvailabilityMonitoringConfig int IGNORE_PERCENT_LOWER_BOUND
-android.car.os CpuAvailabilityMonitoringConfig int IGNORE_PERCENT_UPPER_BOUND
-android.car.os CpuAvailabilityMonitoringConfig int MONITORING_TIMEOUT_NEVER
-android.car.os CpuAvailabilityMonitoringConfig int TIMEOUT_ACTION_NOTIFICATION
-android.car.os CpuAvailabilityMonitoringConfig int TIMEOUT_ACTION_REMOVE
-android.car.os CpuAvailabilityMonitoringConfig Parcelable.Creator<CpuAvailabilityMonitoringConfig> CREATOR
-android.car.os CpuAvailabilityMonitoringConfig String cpusetToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig String ignorePercentToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig String timeoutActionToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig int getCpuset()
-android.car.os CpuAvailabilityMonitoringConfig int getLowerBoundPercent()
-android.car.os CpuAvailabilityMonitoringConfig int getUpperBoundPercent()
-android.car.os CpuAvailabilityMonitoringConfig long getTimeoutInSeconds()
-android.car.os CpuAvailabilityMonitoringConfig int getTimeoutAction()
-android.car.os CpuAvailabilityMonitoringConfig String toString()
-android.car.os CpuAvailabilityMonitoringConfig void writeToParcel(android.os.Parcel dest, int flags)
-android.car.os CpuAvailabilityMonitoringConfig int describeContents()
-android.car.os ThreadPolicyWithPriority String priorityToString(int value)
-android.car.os ThreadPolicyWithPriority String schedToString(int value)
-android.car.projection ProjectionOptions Builder builder()
-android.car.projection ProjectionOptions String toString()
-android.car.projection ProjectionOptions.Builder Builder setProjectionActivityOptions(ActivityOptions activityOptions)
-android.car.projection ProjectionOptions.Builder Builder setUiMode(int uiMode)
-android.car.projection ProjectionOptions.Builder Builder setConsentActivity(ComponentName consentActivity)
-android.car.projection ProjectionOptions.Builder Builder setAccessPointMode(int accessPointMode)
-android.car.projection ProjectionOptions.Builder ProjectionOptions build()
-android.car.settings CarSettings int[] DEFAULT_GARAGE_MODE_WAKE_UP_TIME
-android.car.settings CarSettings int DEFAULT_GARAGE_MODE_MAINTENANCE_WINDOW
-android.car.settings CarSettings.Global String DEFAULT_USER_RESTRICTIONS_SET
-android.car.settings CarSettings.Global String DISABLE_INSTRUMENTATION_SERVICE
-android.car.settings CarSettings.Global String ENABLE_USER_SWITCH_DEVELOPER_MESSAGE
-android.car.settings CarSettings.Global String LAST_ACTIVE_USER_ID
-android.car.settings CarSettings.Global String LAST_ACTIVE_PERSISTENT_USER_ID
-android.car.settings CarSettings.Global String SYSTEM_BAR_VISIBILITY_OVERRIDE
-android.car.settings CarSettings.Secure String KEY_BLUETOOTH_DEVICES
-android.car.settings CarSettings.Secure String KEY_BLUETOOTH_PROFILES_INHIBITED
-android.car.storagemonitoring CarStorageMonitoringManager void onCarDisconnected()
-android.car.storagemonitoring IoStats void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry IoStatsEntry delta(IoStatsEntry other)
-android.car.storagemonitoring IoStatsEntry boolean representsSameMetrics(UidIoRecord record)
-android.car.storagemonitoring IoStatsEntry.Metrics void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry.Metrics Metrics delta(Metrics other)
-android.car.storagemonitoring LifetimeWriteInfo void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring UidIoRecord UidIoRecord delta(IoStatsEntry other)
-android.car.storagemonitoring UidIoRecord UidIoRecord delta(UidIoRecord other)
-android.car.storagemonitoring WearEstimate WearEstimate UNKNOWN_ESTIMATE
-android.car.storagemonitoring WearEstimate void writeToJson(JsonWriter jsonWriter)
-android.car.telemetry CarTelemetryManager void onCarDisconnected()
-android.car.test CarLocationTestHelper boolean injectLocation(Location location, Context context)
-android.car.test CarTestManager void onCarDisconnected()
-android.car.test CarTestManager void stopCarService(IBinder token)
-android.car.test CarTestManager void startCarService(IBinder token)
-android.car.user CarUserManager String TAG
-android.car.user CarUserManager int USER_LIFECYCLE_EVENT_TYPE_POST_UNLOCKED
-android.car.user CarUserManager String BUNDLE_PARAM_ACTION
-android.car.user CarUserManager String BUNDLE_PARAM_PREVIOUS_USER_ID
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_KEY_FOB
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_1
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_2
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_3
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_4
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_ASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_DISASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_DISASSOCIATE_ALL_USERS
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_UNKNOWN
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_ASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_ASSOCIATED_ANOTHER_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_NOT_ASSOCIATED_ANY_USER
-android.car.user CarUserManager AsyncFuture<UserSwitchResult> switchUser(int targetUserId)
-android.car.user CarUserManager AsyncFuture<UserSwitchResult> logoutUser()
-android.car.user CarUserManager AsyncFuture<UserCreationResult> createGuest(String name)
-android.car.user CarUserManager AsyncFuture<UserCreationResult> createUser(String name, int flags)
-android.car.user CarUserManager void updatePreCreatedUsers()
-android.car.user CarUserManager UserRemovalResult removeUser(int userId)
-android.car.user CarUserManager boolean isUserHalUserAssociationSupported()
-android.car.user CarUserManager UserIdentificationAssociationResponse getUserIdentificationAssociation(int types)
-android.car.user CarUserManager AsyncFuture<UserIdentificationAssociationResponse> setUserIdentificationAssociation(int[] types, int[] values)
-android.car.user CarUserManager void setUserSwitchUiCallback(UserSwitchUiCallback callback)
-android.car.user CarUserManager void onCarDisconnected()
-android.car.user CarUserManager String lifecycleEventTypeToString(int type)
-android.car.user CarUserManager boolean isValidUser(int userId)
-android.car.user CarUserManager.UserLifecycleEvent int getUserId()
-android.car.user CarUserManager.UserLifecycleEvent int getPreviousUserId()
-android.car.user ExperimentalCarUserManager String TAG
-android.car.user ExperimentalCarUserManager AndroidFuture<UserCreationResult> createDriver(String name, boolean admin)
-android.car.user ExperimentalCarUserManager int createPassenger(String name, int driverId)
-android.car.user ExperimentalCarUserManager AndroidFuture<UserSwitchResult> switchDriver(int driverId)
-android.car.user ExperimentalCarUserManager List<Integer> getAllDrivers()
-android.car.user ExperimentalCarUserManager List<Integer> getPassengers(int driverId)
-android.car.user ExperimentalCarUserManager boolean startPassenger(int passengerId, int zoneId)
-android.car.user ExperimentalCarUserManager boolean stopPassenger(int passengerId)
-android.car.user ExperimentalCarUserManager void onCarDisconnected()
-android.car.user UserCreationResult int STATUS_SUCCESSFUL
-android.car.user UserCreationResult int STATUS_ANDROID_FAILURE
-android.car.user UserCreationResult int STATUS_HAL_FAILURE
-android.car.user UserCreationResult int STATUS_HAL_INTERNAL_FAILURE
-android.car.user UserCreationResult int STATUS_INVALID_REQUEST
-android.car.user UserCreationResult Parcelable.Creator<UserCreationResult> CREATOR
-android.car.user UserCreationResult boolean isSuccess()
-android.car.user UserCreationResult int describeContents()
-android.car.user UserCreationResult String statusToString(int value)
-android.car.user UserCreationResult int getStatus()
-android.car.user UserCreationResult Integer getAndroidFailureStatus()
-android.car.user UserCreationResult UserHandle getUser()
-android.car.user UserCreationResult String getErrorMessage()
-android.car.user UserCreationResult String getInternalErrorMessage()
-android.car.user UserCreationResult String toString()
-android.car.user UserCreationResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserIdentificationAssociationResponse Parcelable.Creator<UserIdentificationAssociationResponse> CREATOR
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forFailure()
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forFailure(String errorMessage)
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forSuccess(int[] values)
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forSuccess(int[] values, String errorMessage)
-android.car.user UserIdentificationAssociationResponse boolean isSuccess()
-android.car.user UserIdentificationAssociationResponse String getErrorMessage()
-android.car.user UserIdentificationAssociationResponse int[] getValues()
-android.car.user UserIdentificationAssociationResponse String toString()
-android.car.user UserIdentificationAssociationResponse void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserIdentificationAssociationResponse int describeContents()
-android.car.user UserLifecycleEventFilter int[] getEventTypes()
-android.car.user UserLifecycleEventFilter int[] getUserIds()
-android.car.user UserLifecycleEventFilter.Builder Builder addEventType(int eventType)
-android.car.user UserLifecycleEventFilter.Builder Builder addUser(UserHandle userHandle)
-android.car.user UserLifecycleEventFilter.Builder UserLifecycleEventFilter build()
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL
-android.car.user UserRemovalResult int STATUS_ANDROID_FAILURE
-android.car.user UserRemovalResult int STATUS_INVALID_REQUEST
-android.car.user UserRemovalResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_LAST_ADMIN_REMOVED
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_SET_EPHEMERAL
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_LAST_ADMIN_SET_EPHEMERAL
-android.car.user UserRemovalResult Parcelable.Creator<UserRemovalResult> CREATOR
-android.car.user UserRemovalResult boolean isSuccess()
-android.car.user UserRemovalResult String statusToString(int value)
-android.car.user UserRemovalResult int getStatus()
-android.car.user UserRemovalResult String toString()
-android.car.user UserRemovalResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserRemovalResult int describeContents()
-android.car.user UserStartResult int STATUS_SUCCESSFUL
-android.car.user UserStartResult int STATUS_ANDROID_FAILURE
-android.car.user UserStartResult int STATUS_SUCCESSFUL_USER_IS_CURRENT_USER
-android.car.user UserStartResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserStartResult Parcelable.Creator<UserStartResult> CREATOR
-android.car.user UserStartResult boolean isSuccess()
-android.car.user UserStartResult String statusToString(int value)
-android.car.user UserStartResult int getStatus()
-android.car.user UserStartResult String toString()
-android.car.user UserStartResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserStartResult int describeContents()
-android.car.user UserStopResult int STATUS_SUCCESSFUL
-android.car.user UserStopResult int STATUS_ANDROID_FAILURE
-android.car.user UserStopResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserStopResult int STATUS_FAILURE_SYSTEM_USER
-android.car.user UserStopResult int STATUS_FAILURE_CURRENT_USER
-android.car.user UserStopResult Parcelable.Creator<UserStopResult> CREATOR
-android.car.user UserStopResult boolean isSuccess(int status)
-android.car.user UserStopResult boolean isSuccess()
-android.car.user UserStopResult String statusToString(int value)
-android.car.user UserStopResult int getStatus()
-android.car.user UserStopResult String toString()
-android.car.user UserStopResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserStopResult int describeContents()
-android.car.user UserSwitchResult int STATUS_SUCCESSFUL
-android.car.user UserSwitchResult int STATUS_ANDROID_FAILURE
-android.car.user UserSwitchResult int STATUS_HAL_FAILURE
-android.car.user UserSwitchResult int STATUS_HAL_INTERNAL_FAILURE
-android.car.user UserSwitchResult int STATUS_INVALID_REQUEST
-android.car.user UserSwitchResult int STATUS_UX_RESTRICTION_FAILURE
-android.car.user UserSwitchResult int STATUS_OK_USER_ALREADY_IN_FOREGROUND
-android.car.user UserSwitchResult int STATUS_TARGET_USER_ALREADY_BEING_SWITCHED_TO
-android.car.user UserSwitchResult int STATUS_TARGET_USER_ABANDONED_DUE_TO_A_NEW_REQUEST
-android.car.user UserSwitchResult int STATUS_NOT_SWITCHABLE
-android.car.user UserSwitchResult int STATUS_NOT_LOGGED_IN
-android.car.user UserSwitchResult Parcelable.Creator<UserSwitchResult> CREATOR
-android.car.user UserSwitchResult boolean isSuccess()
-android.car.user UserSwitchResult int describeContents()
-android.car.user UserSwitchResult String statusToString(int value)
-android.car.user UserSwitchResult int getStatus()
-android.car.user UserSwitchResult Integer getAndroidFailureStatus()
-android.car.user UserSwitchResult String getErrorMessage()
-android.car.user UserSwitchResult String toString()
-android.car.user UserSwitchResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.util.concurrent AndroidAsyncFuture T get()
-android.car.util.concurrent AndroidAsyncFuture T get(long timeout, TimeUnit unit)
-android.car.util.concurrent AndroidAsyncFuture AsyncFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor)
-android.car.util.concurrent AndroidFuture Parcelable.Creator<AndroidFuture> CREATOR
-android.car.util.concurrent AndroidFuture AndroidFuture<U> completedFuture(U value)
-android.car.util.concurrent AndroidFuture boolean complete(T value)
-android.car.util.concurrent AndroidFuture boolean completeExceptionally(Throwable ex)
-android.car.util.concurrent AndroidFuture boolean cancel(boolean mayInterruptIfRunning)
-android.car.util.concurrent AndroidFuture void onCompleted(T res, Throwable err)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> whenComplete(BiConsumer<? super T,? super Throwable> action)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> orTimeout(long timeout, TimeUnit unit)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> cancelTimeout()
-android.car.util.concurrent AndroidFuture AndroidFuture<T> setTimeoutHandler(Handler h)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenCompose(Function<? super T,? extends CompletionStage<U>> fn)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenComposeAsync(Function<? super T,? extends CompletionStage<U>> fn, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenApply(Function<? super T,? extends U> fn)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenApplyAsync(Function<? super T,? extends U> fn, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<V> thenCombine(CompletionStage<? extends U> other, BiFunction<? super T,? super U,? extends V> combineResults)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> thenCombine(CompletionStage<Void> other)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> supply(Supplier<T> supplier)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> supplyAsync(Supplier<T> supplier, Executor executor)
-android.car.util.concurrent AndroidFuture void writeToParcel(Parcel dest, int flags)
-android.car.util.concurrent AndroidFuture int describeContents()
-android.car.vms VmsClient void register()
-android.car.vms VmsClient void unregister()
-android.car.vms VmsClientManager void onCarDisconnected()
-android.car.vms VmsOperationRecorder.Writer boolean isEnabled()
-android.car.vms VmsOperationRecorder.Writer void write(String msg)
-android.car.vms VmsProviderInfo Parcelable.Creator<VmsProviderInfo> CREATOR
-android.car.vms VmsProviderInfo byte[] getDescription()
-android.car.vms VmsProviderInfo boolean equals(Object o)
-android.car.vms VmsProviderInfo int hashCode()
-android.car.vms VmsProviderInfo void writeToParcel(Parcel dest, int flags)
-android.car.vms VmsProviderInfo int describeContents()
-android.car.vms VmsPublisherClientService void onCarLifecycleChanged(Car car, boolean ready)
-android.car.vms VmsRegistrationInfo Parcelable.Creator<VmsRegistrationInfo> CREATOR
-android.car.vms VmsRegistrationInfo VmsAvailableLayers getAvailableLayers()
-android.car.vms VmsRegistrationInfo VmsSubscriptionState getSubscriptionState()
-android.car.vms VmsRegistrationInfo boolean equals(Object o)
-android.car.vms VmsRegistrationInfo int hashCode()
-android.car.vms VmsRegistrationInfo void writeToParcel(Parcel dest, int flags)
-android.car.vms VmsRegistrationInfo int describeContents()
-android.car.vms VmsSubscriberManager VmsSubscriberManager wrap(Car car, VmsClientManager clientManager)
-android.car.vms VmsSubscriberManager void onCarDisconnected()
-android.car.vms VmsSubscriptionHelper void subscribe(VmsLayer layer)
-android.car.vms VmsSubscriptionHelper void subscribe(VmsLayer layer, int providerId)
-android.car.vms VmsSubscriptionHelper void unsubscribe(VmsLayer layer)
-android.car.vms VmsSubscriptionHelper void unsubscribe(VmsLayer layer, int providerId)
-android.car.vms VmsSubscriptionHelper Set<VmsAssociatedLayer> getSubscriptions()
-android.car.watchdog CarWatchdogManager void onCarDisconnected()
-android.car.watchdog IoOveruseStats.Builder Builder setStartTime(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setDurationInSeconds(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalOveruses(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalTimesKilled(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalBytesWritten(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setKillableOnOveruse(boolean value)
-android.car.watchdog IoOveruseStats.Builder Builder setRemainingWriteBytes(PerStateBytes value)
-android.car.watchdog IoOveruseStats.Builder IoOveruseStats build()
-android.car.watchdog PackageKillableState String killableStateToString(int value)
-android.car.watchdog ResourceOveruseConfiguration String componentTypeToString(int value)
-android.car.watchdog ResourceOveruseStats.Builder Builder setPackageName(String value)
-android.car.watchdog ResourceOveruseStats.Builder Builder setUserHandle(UserHandle value)
-android.car.watchdog ResourceOveruseStats.Builder Builder setIoOveruseStats(IoOveruseStats value)
-android.car.watchdog ResourceOveruseStats.Builder ResourceOveruseStats build()
diff --git a/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.2.txt b/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.2.txt
deleted file mode 100644
index a2fc706b12..0000000000
--- a/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.2.txt
+++ /dev/null
@@ -1,765 +0,0 @@
-android.car AoapService int MSG_NEW_DEVICE_ATTACHED
-android.car AoapService int MSG_NEW_DEVICE_ATTACHED_RESPONSE
-android.car AoapService int MSG_CAN_SWITCH_TO_AOAP
-android.car AoapService int MSG_CAN_SWITCH_TO_AOAP_RESPONSE
-android.car AoapService String KEY_DEVICE
-android.car AoapService String KEY_RESULT
-android.car ApiVersion boolean equals(Object obj)
-android.car ApiVersion int hashCode()
-android.car ApiVersion String toString()
-android.car ApiVersion void writeToParcel(Parcel dest)
-android.car ApiVersion T readFromParcel(Parcel source, ApiVersionFactory<T> factory)
-android.car Car String PROPERTY_EMULATED_PLATFORM_VERSION_MAJOR
-android.car Car String PROPERTY_EMULATED_PLATFORM_VERSION_MINOR
-android.car Car String CAR_SERVICE_BINDER_SERVICE_NAME
-android.car Car String EXPERIMENTAL_CAR_USER_SERVICE
-android.car Car String CAR_INSTRUMENT_CLUSTER_SERVICE
-android.car Car String CLUSTER_HOME_SERVICE
-android.car Car String PERMISSION_CAR_MONITOR_CLUSTER_NAVIGATION_STATE
-android.car Car String PERMISSION_CAR_DISPLAY_IN_CLUSTER
-android.car Car String PERMISSION_BIND_VMS_CLIENT
-android.car Car String PERMISSION_COLLECT_CAR_CPU_INFO
-android.car Car String CAR_TEMPLATE_HOST_RENDERER_SERVICE
-android.car Car String CAR_SERVICE_INTERFACE_NAME
-android.car Car String CAR_CATEGORY_NAVIGATION
-android.car Car ServiceConnection getServiceConnectionListener()
-android.car Car Context getContext()
-android.car Car Handler getEventHandler()
-android.car Car T handleRemoteExceptionFromCarService(RemoteException e, T returnValue)
-android.car Car void handleRemoteExceptionFromCarService(RemoteException e)
-android.car Car T handleRemoteExceptionFromCarService(Service service, RemoteException e, T returnValue)
-android.car Car void handleRemoteExceptionFromCarService(Service service, RemoteException e)
-android.car CarAppFocusManager int APP_FOCUS_MAX
-android.car CarAppFocusManager int[] getActiveAppTypes()
-android.car CarAppFocusManager List<String> getAppTypeOwner(int appType)
-android.car CarAppFocusManager void onCarDisconnected()
-android.car CarBugreportManager void requestBugreportForTesting(ParcelFileDescriptor output, ParcelFileDescriptor extraOutput, CarBugreportManagerCallback callback)
-android.car CarBugreportManager void onCarDisconnected()
-android.car CarFeatures String FEATURE_CAR_USER_NOTICE_SERVICE
-android.car CarInfoManager int BASIC_INFO_KEY_MANUFACTURER
-android.car CarInfoManager int BASIC_INFO_KEY_MODEL
-android.car CarInfoManager int BASIC_INFO_KEY_MODEL_YEAR
-android.car CarInfoManager String BASIC_INFO_KEY_VEHICLE_ID
-android.car CarInfoManager String INFO_KEY_PRODUCT_CONFIGURATION
-android.car CarInfoManager int BASIC_INFO_DRIVER_SEAT
-android.car CarInfoManager int BASIC_INFO_EV_PORT_LOCATION
-android.car CarInfoManager int BASIC_INFO_FUEL_DOOR_LOCATION
-android.car CarInfoManager int BASIC_INFO_FUEL_CAPACITY
-android.car CarInfoManager int BASIC_INFO_FUEL_TYPES
-android.car CarInfoManager int BASIC_INFO_EV_BATTERY_CAPACITY
-android.car CarInfoManager int BASIC_INFO_EV_CONNECTOR_TYPES
-android.car CarInfoManager void onCarDisconnected()
-android.car CarLibLog String TAG_CAR
-android.car CarLibLog String TAG_CLUSTER
-android.car CarLibLog String TAG_INPUT
-android.car CarLibLog String TAG_NAV
-android.car CarLibLog String TAG_SENSOR
-android.car CarLibLog String TAG_DIAGNOSTIC
-android.car CarManagerBase Car mCar
-android.car CarManagerBase Context getContext()
-android.car CarManagerBase Handler getEventHandler()
-android.car CarManagerBase T handleRemoteExceptionFromCarService(RemoteException e, T returnValue)
-android.car CarManagerBase void handleRemoteExceptionFromCarService(RemoteException e)
-android.car CarManagerBase T handleExceptionFromCarService(Exception e, T returnValue)
-android.car CarManagerBase void onCarDisconnected()
-android.car CarManagerBase T addDumpable(Object container, Supplier<T> dumpableSupplier)
-android.car CarOccupantZoneManager int OCCUPANT_TYPE_INVALID
-android.car CarOccupantZoneManager boolean assignProfileUserToOccupantZone(OccupantZoneInfo occupantZone, int userId)
-android.car CarOccupantZoneManager void onCarDisconnected()
-android.car CarOccupantZoneManager.OccupantZoneInfo int INVALID_ZONE_ID
-android.car CarProjectionManager int NUM_KEY_EVENTS
-android.car CarProjectionManager int PROJECTION_AP_STARTED
-android.car CarProjectionManager int PROJECTION_AP_STOPPED
-android.car CarProjectionManager int PROJECTION_AP_FAILED
-android.car CarProjectionManager void regsiterProjectionListener(CarProjectionListener listener, int voiceSearchFilter)
-android.car CarProjectionManager void unregsiterProjectionListener()
-android.car CarProjectionManager void onCarDisconnected()
-android.car VehicleAreaSeat int SIDE_LEFT
-android.car VehicleAreaSeat int SIDE_CENTER
-android.car VehicleAreaSeat int SIDE_RIGHT
-android.car VehicleAreaSeat int fromRowAndSide(int rowNumber, int side)
-android.car VehicleHvacFanDirection int FACE
-android.car VehicleHvacFanDirection int FLOOR
-android.car VehicleHvacFanDirection int DEFROST
-android.car VehicleLightState int OFF
-android.car VehicleLightState int ON
-android.car VehicleLightState int DAYTIME_RUNNING
-android.car VehicleLightSwitch int OFF
-android.car VehicleLightSwitch int ON
-android.car VehicleLightSwitch int DAYTIME_RUNNING
-android.car VehicleLightSwitch int AUTOMATIC
-android.car VehicleOilLevel int CRITICALLY_LOW
-android.car VehicleOilLevel int LOW
-android.car VehicleOilLevel int NORMAL
-android.car VehicleOilLevel int HIGH
-android.car VehicleOilLevel int ERROR
-android.car VehiclePropertyIds int INITIAL_USER_INFO
-android.car VehiclePropertyIds int SWITCH_USER
-android.car VehiclePropertyIds int CREATE_USER
-android.car VehiclePropertyIds int REMOVE_USER
-android.car VehiclePropertyIds int USER_IDENTIFICATION_ASSOCIATION
-android.car VehiclePropertyIds int POWER_POLICY_REQ
-android.car VehiclePropertyIds int POWER_POLICY_GROUP_REQ
-android.car VehiclePropertyIds int CURRENT_POWER_POLICY
-android.car VehiclePropertyIds int WATCHDOG_ALIVE
-android.car VehiclePropertyIds int WATCHDOG_TERMINATED_PROCESS
-android.car VehiclePropertyIds int VHAL_HEARTBEAT
-android.car VehiclePropertyIds int CLUSTER_SWITCH_UI
-android.car VehiclePropertyIds int CLUSTER_DISPLAY_STATE
-android.car VehiclePropertyIds int CLUSTER_REPORT_STATE
-android.car VehiclePropertyIds int CLUSTER_REQUEST_DISPLAY
-android.car VehiclePropertyIds int CLUSTER_NAVIGATION_STATE
-android.car VehiclePropertyType int STRING
-android.car VehiclePropertyType int BOOLEAN
-android.car VehiclePropertyType int INT32
-android.car VehiclePropertyType int INT32_VEC
-android.car VehiclePropertyType int INT64
-android.car VehiclePropertyType int INT64_VEC
-android.car VehiclePropertyType int FLOAT
-android.car VehiclePropertyType int FLOAT_VEC
-android.car VehiclePropertyType int BYTES
-android.car VehiclePropertyType int MIXED
-android.car VehiclePropertyType int MASK
-android.car VehicleSeatOccupancyState int UNKNOWN
-android.car VehicleSeatOccupancyState int VACANT
-android.car VehicleSeatOccupancyState int OCCUPIED
-android.car.admin CarDevicePolicyManager String TAG
-android.car.admin CarDevicePolicyManager int FIRST_USER_TYPE
-android.car.admin CarDevicePolicyManager int LAST_USER_TYPE
-android.car.admin CarDevicePolicyManager StartUserInBackgroundResult startUserInBackground(UserHandle user)
-android.car.admin CarDevicePolicyManager StopUserResult stopUser(UserHandle user)
-android.car.admin CarDevicePolicyManager void setUserDisclaimerShown(UserHandle user)
-android.car.admin CarDevicePolicyManager void setUserDisclaimerAcknowledged(UserHandle user)
-android.car.admin CarDevicePolicyManager void onCarDisconnected()
-android.car.admin CreateUserResult CreateUserResult forGenericError()
-android.car.admin RemoveUserResult String statusToString(int status)
-android.car.admin StartUserInBackgroundResult int STATUS_SUCCESS
-android.car.admin StartUserInBackgroundResult int STATUS_SUCCESS_CURRENT_USER
-android.car.admin StartUserInBackgroundResult int STATUS_FAILURE_USER_DOES_NOT_EXIST
-android.car.admin StartUserInBackgroundResult int STATUS_FAILURE_GENERIC
-android.car.admin StartUserInBackgroundResult int getStatus()
-android.car.admin StartUserInBackgroundResult boolean isSuccess()
-android.car.admin StartUserInBackgroundResult String toString()
-android.car.admin StopUserResult int STATUS_SUCCESS
-android.car.admin StopUserResult int STATUS_FAILURE_CURRENT_USER
-android.car.admin StopUserResult int STATUS_FAILURE_SYSTEM_USER
-android.car.admin StopUserResult int STATUS_FAILURE_USER_DOES_NOT_EXIST
-android.car.admin StopUserResult int STATUS_FAILURE_GENERIC
-android.car.admin StopUserResult int getStatus()
-android.car.admin StopUserResult boolean isSuccess()
-android.car.admin StopUserResult String toString()
-android.car.app CarActivityManager int ERROR_CODE_ACTIVITY_NOT_FOUND
-android.car.app CarActivityManager void onCarDisconnected()
-android.car.app CarActivityManager boolean registerTaskMonitor()
-android.car.app CarActivityManager void onTaskAppeared(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void onTaskVanished(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void onTaskInfoChanged(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void unregisterTaskMonitor()
-android.car.app CarActivityManager List<ActivityManager.RunningTaskInfo> getVisibleTasks()
-android.car.cluster CarInstrumentClusterManager void onCarDisconnected()
-android.car.cluster ClusterHomeManager int UI_TYPE_CLUSTER_NONE
-android.car.cluster ClusterHomeManager int UI_TYPE_CLUSTER_HOME
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_ON_OFF
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_BOUNDS
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_INSETS
-android.car.cluster ClusterHomeManager int CONFIG_UI_TYPE
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_ID
-android.car.cluster ClusterHomeManager void registerClusterStateListener(Executor executor, ClusterStateListener callback)
-android.car.cluster ClusterHomeManager void registerClusterNavigationStateListener(Executor executor, ClusterNavigationStateListener callback)
-android.car.cluster ClusterHomeManager void unregisterClusterStateListener(ClusterStateListener callback)
-android.car.cluster ClusterHomeManager void unregisterClusterNavigationStateListener(ClusterNavigationStateListener callback)
-android.car.cluster ClusterHomeManager void reportState(int uiTypeMain, int uiTypeSub, byte[] uiAvailability)
-android.car.cluster ClusterHomeManager void requestDisplay(int uiType)
-android.car.cluster ClusterHomeManager ClusterState getClusterState()
-android.car.cluster ClusterHomeManager boolean startFixedActivityModeAsUser(Intent intent, Bundle options, int userId)
-android.car.cluster ClusterHomeManager void stopFixedActivityMode()
-android.car.cluster ClusterHomeManager void onCarDisconnected()
-android.car.cluster.renderer InstrumentClusterRenderingService String EXTRA_BUNDLE_KEY_FOR_INSTRUMENT_CLUSTER_HELPER
-android.car.cluster.renderer InstrumentClusterRenderingService ComponentName getComponentFromPackage(String packageName)
-android.car.cluster.renderer InstrumentClusterRenderingService void setClusterActivityLaunchOptions(String category, ActivityOptions activityOptions)
-android.car.cluster.renderer InstrumentClusterRenderingService void setClusterActivityState(String category, Bundle state)
-android.car.content.pm AppBlockingPackageInfo void verify()
-android.car.content.pm AppBlockingPackageInfo boolean isActivityCovered(String className)
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_BLOCKED_ACTIVITY_NAME
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_BLOCKED_TASK_ID
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_ROOT_ACTIVITY_NAME
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_IS_ROOT_ACTIVITY_DO
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_DISPLAY_ID
-android.car.content.pm CarPackageManager String DRIVING_SAFETY_REGION_ALL
-android.car.content.pm CarPackageManager String DRIVING_SAFETY_ACTIVITY_METADATA_REGIONS
-android.car.content.pm CarPackageManager int ERROR_CODE_NO_PACKAGE
-android.car.content.pm CarPackageManager void onCarDisconnected()
-android.car.content.pm CarPackageManager void restartTask(int taskId)
-android.car.content.pm CarPackageManager void setEnableActivityBlocking(boolean enable)
-android.car.content.pm CarPackageManager String getCurrentDrivingSafetyRegion()
-android.car.content.pm CarPackageManager void controlTemporaryActivityBlockingBypassingAsUser(String packageName, String activityClassName, boolean bypass, int userId)
-android.car.content.pm CarPackageManager List<String> getSupportedDrivingSafetyRegionsForActivityAsUser(String packageName, String activityClassName, int userId)
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent withVendorSensorsRemoved()
-android.car.diagnostic CarDiagnosticEvent boolean isEmptyFrame()
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent checkLiveFrame()
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent checkFreezeFrame()
-android.car.diagnostic CarDiagnosticEvent boolean isEarlierThan(CarDiagnosticEvent otherEvent)
-android.car.diagnostic CarDiagnosticEvent.IgnitionMonitor.Decoder IgnitionMonitor fromValue(int value)
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int COMPONENTS_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int COMPONENTS_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int FUEL_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int FUEL_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int MISFIRE_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int MISFIRE_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EGR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EGR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_HEATER_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_HEATER_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int AC_REFRIGERANT_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int AC_REFRIGERANT_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int SECONDARY_AIR_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int SECONDARY_AIR_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EVAPORATIVE_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EVAPORATIVE_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int HEATED_CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int HEATED_CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EGR_OR_VVT_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EGR_OR_VVT_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int PM_FILTER_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int PM_FILTER_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EXHAUST_GAS_SENSOR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EXHAUST_GAS_SENSOR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int BOOST_PRESSURE_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int BOOST_PRESSURE_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NOx_SCR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NOx_SCR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NMHC_CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NMHC_CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticManager int[] FRAME_TYPES
-android.car.drivingstate CarDrivingStateManager void onCarDisconnected()
-android.car.drivingstate CarDrivingStateManager void injectDrivingState(int drivingState)
-android.car.drivingstate CarUxRestrictions long getTimeStamp()
-android.car.drivingstate CarUxRestrictionsConfiguration void writeJson(JsonWriter writer)
-android.car.drivingstate CarUxRestrictionsConfiguration CarUxRestrictionsConfiguration readJson(JsonReader reader, int schemaVersion)
-android.car.drivingstate CarUxRestrictionsConfiguration boolean hasSameParameters(CarUxRestrictionsConfiguration other)
-android.car.drivingstate CarUxRestrictionsConfiguration void dump(PrintWriter writer)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Map<String,RestrictionModeContainer> mRestrictionModes
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder int validatePort(int port)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setPhysicalPort(int port)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, boolean requiresOptimization, int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, SpeedRange speedRange, boolean requiresOptimization, int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, DrivingStateRestrictions drivingStateRestrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxStringLength(int maxStringLength)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxCumulativeContentItems(int maxCumulativeContentItems)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxContentDepth(int maxContentDepth)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder CarUxRestrictionsConfiguration build()
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setDistractionOptimizationRequired(boolean distractionOptimizationRequired)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setRestrictions(int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setMode(String mode)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setSpeedRange(Builder.SpeedRange speedRange)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions String toString()
-android.car.drivingstate CarUxRestrictionsManager void registerListener(OnUxRestrictionsChangedListener listener, int displayId)
-android.car.evs CarEvsManager void onCarDisconnected()
-android.car.hardware CarPropertyConfig String getConfigString()
-android.car.hardware CarPropertyConfig int getAreaCount()
-android.car.hardware CarPropertyConfig int getFirstAndOnlyAreaId()
-android.car.hardware CarPropertyConfig boolean hasArea(int areaId)
-android.car.hardware CarPropertyConfig String toString()
-android.car.hardware CarPropertyConfig Builder<T> newBuilder(Class<T> type, int propertyId, int areaType)
-android.car.hardware CarPropertyConfig.AreaConfig Parcelable.Creator<AreaConfig<Object>> CREATOR
-android.car.hardware CarPropertyConfig.AreaConfig T getMinValue()
-android.car.hardware CarPropertyConfig.AreaConfig T getMaxValue()
-android.car.hardware CarPropertyConfig.AreaConfig int describeContents()
-android.car.hardware CarPropertyConfig.AreaConfig void writeToParcel(Parcel dest, int flags)
-android.car.hardware CarPropertyConfig.AreaConfig String toString()
-android.car.hardware CarPropertyValue String toString()
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_SUPPORTED_WHEELS
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_FRONT_LEFT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_FRONT_RIGHT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_REAR_RIGHT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_REAR_LEFT_UM_PER_TICK
-android.car.hardware CarSensorConfig Parcelable.Creator<CarSensorConfig> CREATOR
-android.car.hardware CarSensorConfig int describeContents()
-android.car.hardware CarSensorConfig void writeToParcel(Parcel dest, int flags)
-android.car.hardware CarSensorConfig Bundle getBundle()
-android.car.hardware CarSensorConfig int getInt(String key)
-android.car.hardware CarSensorConfig int getType()
-android.car.hardware CarSensorConfig String toString()
-android.car.hardware CarSensorEvent EnvironmentData getEnvironmentData(EnvironmentData data)
-android.car.hardware CarSensorEvent IgnitionStateData getIgnitionStateData(IgnitionStateData data)
-android.car.hardware CarSensorEvent NightData getNightData(NightData data)
-android.car.hardware CarSensorEvent GearData getGearData(GearData data)
-android.car.hardware CarSensorEvent ParkingBrakeData getParkingBrakeData(ParkingBrakeData data)
-android.car.hardware CarSensorEvent FuelLevelData getFuelLevelData(FuelLevelData data)
-android.car.hardware CarSensorEvent OdometerData getOdometerData(OdometerData data)
-android.car.hardware CarSensorEvent RpmData getRpmData(RpmData data)
-android.car.hardware CarSensorEvent CarSpeedData getCarSpeedData(CarSpeedData data)
-android.car.hardware CarSensorEvent CarWheelTickDistanceData getCarWheelTickDistanceData(CarWheelTickDistanceData data)
-android.car.hardware CarSensorEvent CarAbsActiveData getCarAbsActiveData(CarAbsActiveData data)
-android.car.hardware CarSensorEvent CarTractionControlActiveData getCarTractionControlActiveData(CarTractionControlActiveData data)
-android.car.hardware CarSensorEvent CarFuelDoorOpenData getCarFuelDoorOpenData(CarFuelDoorOpenData data)
-android.car.hardware CarSensorEvent CarEvBatteryLevelData getCarEvBatteryLevelData(CarEvBatteryLevelData data)
-android.car.hardware CarSensorEvent CarEvChargePortOpenData getCarEvChargePortOpenData(CarEvChargePortOpenData data)
-android.car.hardware CarSensorEvent CarEvChargePortConnectedData getCarEvChargePortConnectedData(CarEvChargePortConnectedData data)
-android.car.hardware CarSensorEvent CarEvBatteryChargeRateData getCarEvBatteryChargeRateData(CarEvBatteryChargeRateData data)
-android.car.hardware CarSensorEvent CarEngineOilLevelData getCarEngineOilLevelData(CarEngineOilLevelData data)
-android.car.hardware CarSensorEvent String toString()
-android.car.hardware CarSensorEvent.IgnitionStateData long timestamp
-android.car.hardware CarSensorEvent.IgnitionStateData int ignitionState
-android.car.hardware CarSensorEvent.NightData long timestamp
-android.car.hardware CarSensorEvent.NightData boolean isNightMode
-android.car.hardware CarSensorEvent.GearData long timestamp
-android.car.hardware CarSensorEvent.GearData int gear
-android.car.hardware CarSensorEvent.ParkingBrakeData long timestamp
-android.car.hardware CarSensorEvent.ParkingBrakeData boolean isEngaged
-android.car.hardware CarSensorEvent.FuelLevelData long timestamp
-android.car.hardware CarSensorEvent.FuelLevelData float level
-android.car.hardware CarSensorEvent.OdometerData long timestamp
-android.car.hardware CarSensorEvent.OdometerData float kms
-android.car.hardware CarSensorEvent.RpmData long timestamp
-android.car.hardware CarSensorEvent.RpmData float rpm
-android.car.hardware CarSensorEvent.CarSpeedData long timestamp
-android.car.hardware CarSensorEvent.CarSpeedData float carSpeed
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long timestamp
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long sensorResetCount
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long frontLeftWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long frontRightWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long rearRightWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long rearLeftWheelDistanceMm
-android.car.hardware CarSensorEvent.CarAbsActiveData long timestamp
-android.car.hardware CarSensorEvent.CarAbsActiveData boolean absIsActive
-android.car.hardware CarSensorEvent.CarTractionControlActiveData long timestamp
-android.car.hardware CarSensorEvent.CarTractionControlActiveData boolean tractionControlIsActive
-android.car.hardware CarSensorEvent.CarFuelDoorOpenData long timestamp
-android.car.hardware CarSensorEvent.CarFuelDoorOpenData boolean fuelDoorIsOpen
-android.car.hardware CarSensorEvent.CarEvBatteryLevelData long timestamp
-android.car.hardware CarSensorEvent.CarEvBatteryLevelData float evBatteryLevel
-android.car.hardware CarSensorEvent.CarEvChargePortOpenData long timestamp
-android.car.hardware CarSensorEvent.CarEvChargePortOpenData boolean evChargePortIsOpen
-android.car.hardware CarSensorEvent.CarEvChargePortConnectedData long timestamp
-android.car.hardware CarSensorEvent.CarEvChargePortConnectedData boolean evChargePortIsConnected
-android.car.hardware CarSensorEvent.CarEvBatteryChargeRateData long timestamp
-android.car.hardware CarSensorEvent.CarEvBatteryChargeRateData float evChargeRate
-android.car.hardware CarSensorEvent.CarEngineOilLevelData long timestamp
-android.car.hardware CarSensorEvent.CarEngineOilLevelData int engineOilLevel
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED1
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED8
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED10
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED11
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED12
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED13
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED14
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED15
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED16
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED17
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED18
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED19
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED20
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED21
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED26
-android.car.hardware CarSensorManager void onCarDisconnected()
-android.car.hardware CarSensorManager boolean isSensorSupported(int[] sensorList, int sensorType)
-android.car.hardware CarSensorManager CarSensorConfig getSensorConfig(int type)
-android.car.hardware CarVendorExtensionManager void onCarDisconnected()
-android.car.hardware.cabin CarCabinManager void onCarDisconnected()
-android.car.hardware.hvac CarHvacManager void onCarDisconnected()
-android.car.hardware.power CarPowerManager String TAG
-android.car.hardware.power CarPowerManager void requestShutdownOnNextSuspend()
-android.car.hardware.power CarPowerManager void scheduleNextWakeupTime(int seconds)
-android.car.hardware.power CarPowerManager boolean isCompletionAllowed(int state)
-android.car.hardware.power CarPowerManager void onCarDisconnected()
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_ENABLED
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_DISABLED
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_UNTOUCHED
-android.car.hardware.power PowerComponentUtil int INVALID_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil int FIRST_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil int LAST_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil boolean isValidPowerComponent(int component)
-android.car.hardware.power PowerComponentUtil boolean hasComponents(CarPowerPolicy policy, CarPowerPolicyFilter filter)
-android.car.hardware.power PowerComponentUtil int toPowerComponent(String component, boolean prefix)
-android.car.hardware.power PowerComponentUtil String powerComponentToString(int component)
-android.car.hardware.property CarPropertyEvent int PROPERTY_EVENT_PROPERTY_CHANGE
-android.car.hardware.property CarPropertyEvent int PROPERTY_EVENT_ERROR
-android.car.hardware.property CarPropertyEvent Parcelable.Creator<CarPropertyEvent> CREATOR
-android.car.hardware.property CarPropertyEvent int getEventType()
-android.car.hardware.property CarPropertyEvent CarPropertyValue<?> getCarPropertyValue()
-android.car.hardware.property CarPropertyEvent int describeContents()
-android.car.hardware.property CarPropertyEvent void writeToParcel(Parcel dest, int flags)
-android.car.hardware.property CarPropertyEvent CarPropertyEvent createErrorEventWithErrorCode(int propertyId, int areaId, int errorCode)
-android.car.hardware.property CarPropertyEvent int getErrorCode()
-android.car.hardware.property CarPropertyEvent String toString()
-android.car.hardware.property CarPropertyManager String getReadPermission(int propId)
-android.car.hardware.property CarPropertyManager String getWritePermission(int propId)
-android.car.hardware.property CarPropertyManager void onCarDisconnected()
-android.car.hardware.property VehicleHalStatusCode int STATUS_OK
-android.car.hardware.property VehicleHalStatusCode int STATUS_TRY_AGAIN
-android.car.hardware.property VehicleHalStatusCode int STATUS_INVALID_ARG
-android.car.hardware.property VehicleHalStatusCode int STATUS_NOT_AVAILABLE
-android.car.hardware.property VehicleHalStatusCode int STATUS_ACCESS_DENIED
-android.car.hardware.property VehicleHalStatusCode int STATUS_INTERNAL_ERROR
-android.car.input CarInputManager void onCarDisconnected()
-android.car.media CarAudioManager int INVALID_VOLUME_GROUP_ID
-android.car.media CarAudioManager String AUDIOFOCUS_EXTRA_REQUEST_ZONE_ID
-android.car.media CarAudioManager boolean isDynamicRoutingEnabled()
-android.car.media CarAudioManager int getZoneIdForUid(int uid)
-android.car.media CarAudioManager boolean setZoneIdForUid(int zoneId, int uid)
-android.car.media CarAudioManager boolean clearZoneIdForUid(int uid)
-android.car.media CarAudioManager void onCarDisconnected()
-android.car.media CarAudioPatchHandle String getSourceAddress()
-android.car.media CarAudioPatchHandle String getSinkAddress()
-android.car.media CarAudioPatchHandle int getHandleId()
-android.car.media CarMediaManager void onCarDisconnected()
-android.car.media CarMediaManager boolean isIndependentPlaybackConfig()
-android.car.media CarMediaManager void setIndependentPlaybackConfig(boolean independent)
-android.car.navigation CarNavigationInstrumentCluster Bundle getExtra()
-android.car.navigation CarNavigationStatusManager void onCarDisconnected()
-android.car.occupantawareness DriverMonitoringDetection int confidenceLevel
-android.car.occupantawareness DriverMonitoringDetection boolean isLookingOnRoad
-android.car.occupantawareness DriverMonitoringDetection long gazeDurationMillis
-android.car.occupantawareness DriverMonitoringDetection Parcelable.Creator<DriverMonitoringDetection> CREATOR
-android.car.occupantawareness DriverMonitoringDetection int describeContents()
-android.car.occupantawareness DriverMonitoringDetection String toString()
-android.car.occupantawareness DriverMonitoringDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_UNKNOWN
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_CENTER_INSTRUMENT_CLUSTER
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_REAR_VIEW_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_LEFT_SIDE_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_RIGHT_SIDE_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_FORWARD_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_LEFT_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_RIGHT_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_HEAD_UNIT_DISPLAY
-android.car.occupantawareness GazeDetection int confidenceLevel
-android.car.occupantawareness GazeDetection Point3D leftEyePosition
-android.car.occupantawareness GazeDetection Point3D rightEyePosition
-android.car.occupantawareness GazeDetection Point3D headAngleUnitVector
-android.car.occupantawareness GazeDetection Point3D gazeAngleUnitVector
-android.car.occupantawareness GazeDetection int gazeTarget
-android.car.occupantawareness GazeDetection long durationOnTargetMillis
-android.car.occupantawareness GazeDetection Parcelable.Creator<GazeDetection> CREATOR
-android.car.occupantawareness GazeDetection int describeContents()
-android.car.occupantawareness GazeDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness GazeDetection String toString()
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_NONE
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_DRIVER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_FRONT_PASSENGER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_LEFT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_CENTER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_RIGHT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_LEFT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_CENTER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_RIGHT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_FRONT_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_ROW_2_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_ROW_3_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_NONE
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_LOW
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_HIGH
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_MAX
-android.car.occupantawareness OccupantAwarenessDetection int role
-android.car.occupantawareness OccupantAwarenessDetection long timestampMillis
-android.car.occupantawareness OccupantAwarenessDetection boolean isPresent
-android.car.occupantawareness OccupantAwarenessDetection GazeDetection gazeDetection
-android.car.occupantawareness OccupantAwarenessDetection DriverMonitoringDetection driverMonitoringDetection
-android.car.occupantawareness OccupantAwarenessDetection Parcelable.Creator<OccupantAwarenessDetection> CREATOR
-android.car.occupantawareness OccupantAwarenessDetection int describeContents()
-android.car.occupantawareness OccupantAwarenessDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness OccupantAwarenessDetection String toString()
-android.car.occupantawareness OccupantAwarenessManager void onCarDisconnected()
-android.car.occupantawareness OccupantAwarenessManager int getCapabilityForRole(int role)
-android.car.occupantawareness OccupantAwarenessManager void registerChangeCallback(ChangeCallback callback)
-android.car.occupantawareness OccupantAwarenessManager void unregisterChangeCallback()
-android.car.occupantawareness Point3D double x
-android.car.occupantawareness Point3D double y
-android.car.occupantawareness Point3D double z
-android.car.occupantawareness Point3D Parcelable.Creator<Point3D> CREATOR
-android.car.occupantawareness Point3D int describeContents()
-android.car.occupantawareness Point3D void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness Point3D String toString()
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_READY
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_NOT_SUPPORTED
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_NOT_READY
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_SYSTEM_FAILURE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_NONE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_PRESENCE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_GAZE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_DRIVER_MONITORING
-android.car.occupantawareness SystemStatusEvent int systemStatus
-android.car.occupantawareness SystemStatusEvent int detectionType
-android.car.occupantawareness SystemStatusEvent Parcelable.Creator<SystemStatusEvent> CREATOR
-android.car.occupantawareness SystemStatusEvent int describeContents()
-android.car.occupantawareness SystemStatusEvent void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness SystemStatusEvent String toString()
-android.car.oem OemCarService void onCreate()
-android.car.oem OemCarService void onDestroy()
-android.car.oem OemCarService int onStartCommand(Intent intent, int flags, int startId)
-android.car.oem OemCarService IBinder onBind(Intent intent)
-android.car.oem OemCarService OemCarAudioFocusService getOemAudioFocusService()
-android.car.oem OemCarService void dump(FileDescriptor fd, PrintWriter writer, String[] args)
-android.car.oem OemCarService CarVersion getSupportedCarVersion()
-android.car.oem OemCarService void onCarServiceReady()
-android.car.os CarPerformanceManager void onCarDisconnected()
-android.car.os CarPerformanceManager void addCpuAvailabilityChangeListener(Executor executor, CpuAvailabilityMonitoringConfig config, CpuAvailabilityChangeListener listener)
-android.car.os CarPerformanceManager void removeCpuAvailabilityChangeListener(Executor executor, CpuAvailabilityChangeListener listener)
-android.car.os CpuAvailabilityInfo Parcelable.Creator<CpuAvailabilityInfo> CREATOR
-android.car.os CpuAvailabilityInfo int getCpuset()
-android.car.os CpuAvailabilityInfo int getAverageAvailabilityPercent()
-android.car.os CpuAvailabilityInfo boolean isTimeout()
-android.car.os CpuAvailabilityInfo String toString()
-android.car.os CpuAvailabilityInfo void writeToParcel(android.os.Parcel dest, int flags)
-android.car.os CpuAvailabilityInfo int describeContents()
-android.car.os CpuAvailabilityInfo.Builder Builder setCpuset(int value)
-android.car.os CpuAvailabilityInfo.Builder Builder setAverageAvailabilityPercent(int value)
-android.car.os CpuAvailabilityInfo.Builder Builder setTimeout(boolean value)
-android.car.os CpuAvailabilityInfo.Builder CpuAvailabilityInfo build()
-android.car.os CpuAvailabilityMonitoringConfig int CPUSET_ALL
-android.car.os CpuAvailabilityMonitoringConfig int CPUSET_BACKGROUND
-android.car.os CpuAvailabilityMonitoringConfig int IGNORE_PERCENT_LOWER_BOUND
-android.car.os CpuAvailabilityMonitoringConfig int IGNORE_PERCENT_UPPER_BOUND
-android.car.os CpuAvailabilityMonitoringConfig int MONITORING_TIMEOUT_NEVER
-android.car.os CpuAvailabilityMonitoringConfig int TIMEOUT_ACTION_NOTIFICATION
-android.car.os CpuAvailabilityMonitoringConfig int TIMEOUT_ACTION_REMOVE
-android.car.os CpuAvailabilityMonitoringConfig Parcelable.Creator<CpuAvailabilityMonitoringConfig> CREATOR
-android.car.os CpuAvailabilityMonitoringConfig String cpusetToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig String ignorePercentToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig String timeoutActionToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig int getCpuset()
-android.car.os CpuAvailabilityMonitoringConfig int getLowerBoundPercent()
-android.car.os CpuAvailabilityMonitoringConfig int getUpperBoundPercent()
-android.car.os CpuAvailabilityMonitoringConfig long getTimeoutInSeconds()
-android.car.os CpuAvailabilityMonitoringConfig int getTimeoutAction()
-android.car.os CpuAvailabilityMonitoringConfig String toString()
-android.car.os CpuAvailabilityMonitoringConfig void writeToParcel(android.os.Parcel dest, int flags)
-android.car.os CpuAvailabilityMonitoringConfig int describeContents()
-android.car.os ThreadPolicyWithPriority String priorityToString(int value)
-android.car.os ThreadPolicyWithPriority String schedToString(int value)
-android.car.projection ProjectionOptions Builder builder()
-android.car.projection ProjectionOptions String toString()
-android.car.projection ProjectionOptions.Builder Builder setProjectionActivityOptions(ActivityOptions activityOptions)
-android.car.projection ProjectionOptions.Builder Builder setUiMode(int uiMode)
-android.car.projection ProjectionOptions.Builder Builder setConsentActivity(ComponentName consentActivity)
-android.car.projection ProjectionOptions.Builder Builder setAccessPointMode(int accessPointMode)
-android.car.projection ProjectionOptions.Builder ProjectionOptions build()
-android.car.settings CarSettings int[] DEFAULT_GARAGE_MODE_WAKE_UP_TIME
-android.car.settings CarSettings int DEFAULT_GARAGE_MODE_MAINTENANCE_WINDOW
-android.car.settings CarSettings.Global String DEFAULT_USER_RESTRICTIONS_SET
-android.car.settings CarSettings.Global String DISABLE_INSTRUMENTATION_SERVICE
-android.car.settings CarSettings.Global String ENABLE_USER_SWITCH_DEVELOPER_MESSAGE
-android.car.settings CarSettings.Global String LAST_ACTIVE_USER_ID
-android.car.settings CarSettings.Global String LAST_ACTIVE_PERSISTENT_USER_ID
-android.car.settings CarSettings.Global String SYSTEM_BAR_VISIBILITY_OVERRIDE
-android.car.settings CarSettings.Secure String KEY_BLUETOOTH_DEVICES
-android.car.settings CarSettings.Secure String KEY_BLUETOOTH_PROFILES_INHIBITED
-android.car.storagemonitoring CarStorageMonitoringManager void onCarDisconnected()
-android.car.storagemonitoring IoStats void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry IoStatsEntry delta(IoStatsEntry other)
-android.car.storagemonitoring IoStatsEntry boolean representsSameMetrics(UidIoRecord record)
-android.car.storagemonitoring IoStatsEntry.Metrics void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry.Metrics Metrics delta(Metrics other)
-android.car.storagemonitoring LifetimeWriteInfo void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring UidIoRecord UidIoRecord delta(IoStatsEntry other)
-android.car.storagemonitoring UidIoRecord UidIoRecord delta(UidIoRecord other)
-android.car.storagemonitoring WearEstimate WearEstimate UNKNOWN_ESTIMATE
-android.car.storagemonitoring WearEstimate void writeToJson(JsonWriter jsonWriter)
-android.car.telemetry CarTelemetryManager void onCarDisconnected()
-android.car.test CarLocationTestHelper boolean injectLocation(Location location, Context context)
-android.car.test CarTestManager void onCarDisconnected()
-android.car.test CarTestManager void stopCarService(IBinder token)
-android.car.test CarTestManager void startCarService(IBinder token)
-android.car.test CarTestManager String getOemServiceName()
-android.car.user CarUserManager String TAG
-android.car.user CarUserManager int USER_LIFECYCLE_EVENT_TYPE_POST_UNLOCKED
-android.car.user CarUserManager String BUNDLE_PARAM_ACTION
-android.car.user CarUserManager String BUNDLE_PARAM_PREVIOUS_USER_ID
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_KEY_FOB
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_1
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_2
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_3
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_4
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_ASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_DISASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_DISASSOCIATE_ALL_USERS
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_UNKNOWN
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_ASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_ASSOCIATED_ANOTHER_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_NOT_ASSOCIATED_ANY_USER
-android.car.user CarUserManager AsyncFuture<UserSwitchResult> switchUser(int targetUserId)
-android.car.user CarUserManager AsyncFuture<UserSwitchResult> logoutUser()
-android.car.user CarUserManager AsyncFuture<UserCreationResult> createGuest(String name)
-android.car.user CarUserManager AsyncFuture<UserCreationResult> createUser(String name, int flags)
-android.car.user CarUserManager void updatePreCreatedUsers()
-android.car.user CarUserManager UserRemovalResult removeUser(int userId)
-android.car.user CarUserManager boolean isUserHalUserAssociationSupported()
-android.car.user CarUserManager UserIdentificationAssociationResponse getUserIdentificationAssociation(int types)
-android.car.user CarUserManager AsyncFuture<UserIdentificationAssociationResponse> setUserIdentificationAssociation(int[] types, int[] values)
-android.car.user CarUserManager void setUserSwitchUiCallback(UserSwitchUiCallback callback)
-android.car.user CarUserManager void onCarDisconnected()
-android.car.user CarUserManager String lifecycleEventTypeToString(int type)
-android.car.user CarUserManager boolean isValidUser(int userId)
-android.car.user CarUserManager.UserLifecycleEvent int getUserId()
-android.car.user CarUserManager.UserLifecycleEvent int getPreviousUserId()
-android.car.user ExperimentalCarUserManager String TAG
-android.car.user ExperimentalCarUserManager AndroidFuture<UserCreationResult> createDriver(String name, boolean admin)
-android.car.user ExperimentalCarUserManager int createPassenger(String name, int driverId)
-android.car.user ExperimentalCarUserManager AndroidFuture<UserSwitchResult> switchDriver(int driverId)
-android.car.user ExperimentalCarUserManager List<Integer> getAllDrivers()
-android.car.user ExperimentalCarUserManager List<Integer> getPassengers(int driverId)
-android.car.user ExperimentalCarUserManager boolean startPassenger(int passengerId, int zoneId)
-android.car.user ExperimentalCarUserManager boolean stopPassenger(int passengerId)
-android.car.user ExperimentalCarUserManager void onCarDisconnected()
-android.car.user UserCreationResult int STATUS_SUCCESSFUL
-android.car.user UserCreationResult int STATUS_ANDROID_FAILURE
-android.car.user UserCreationResult int STATUS_HAL_FAILURE
-android.car.user UserCreationResult int STATUS_HAL_INTERNAL_FAILURE
-android.car.user UserCreationResult int STATUS_INVALID_REQUEST
-android.car.user UserCreationResult Parcelable.Creator<UserCreationResult> CREATOR
-android.car.user UserCreationResult boolean isSuccess()
-android.car.user UserCreationResult int describeContents()
-android.car.user UserCreationResult String statusToString(int value)
-android.car.user UserCreationResult int getStatus()
-android.car.user UserCreationResult Integer getAndroidFailureStatus()
-android.car.user UserCreationResult UserHandle getUser()
-android.car.user UserCreationResult String getErrorMessage()
-android.car.user UserCreationResult String getInternalErrorMessage()
-android.car.user UserCreationResult String toString()
-android.car.user UserCreationResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserIdentificationAssociationResponse Parcelable.Creator<UserIdentificationAssociationResponse> CREATOR
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forFailure()
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forFailure(String errorMessage)
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forSuccess(int[] values)
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forSuccess(int[] values, String errorMessage)
-android.car.user UserIdentificationAssociationResponse boolean isSuccess()
-android.car.user UserIdentificationAssociationResponse String getErrorMessage()
-android.car.user UserIdentificationAssociationResponse int[] getValues()
-android.car.user UserIdentificationAssociationResponse String toString()
-android.car.user UserIdentificationAssociationResponse void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserIdentificationAssociationResponse int describeContents()
-android.car.user UserLifecycleEventFilter int[] getEventTypes()
-android.car.user UserLifecycleEventFilter int[] getUserIds()
-android.car.user UserLifecycleEventFilter.Builder Builder addEventType(int eventType)
-android.car.user UserLifecycleEventFilter.Builder Builder addUser(UserHandle userHandle)
-android.car.user UserLifecycleEventFilter.Builder UserLifecycleEventFilter build()
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL
-android.car.user UserRemovalResult int STATUS_ANDROID_FAILURE
-android.car.user UserRemovalResult int STATUS_INVALID_REQUEST
-android.car.user UserRemovalResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_LAST_ADMIN_REMOVED
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_SET_EPHEMERAL
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_LAST_ADMIN_SET_EPHEMERAL
-android.car.user UserRemovalResult Parcelable.Creator<UserRemovalResult> CREATOR
-android.car.user UserRemovalResult boolean isSuccess()
-android.car.user UserRemovalResult String statusToString(int value)
-android.car.user UserRemovalResult int getStatus()
-android.car.user UserRemovalResult String toString()
-android.car.user UserRemovalResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserRemovalResult int describeContents()
-android.car.user UserStartResult int STATUS_SUCCESSFUL
-android.car.user UserStartResult int STATUS_ANDROID_FAILURE
-android.car.user UserStartResult int STATUS_SUCCESSFUL_USER_IS_CURRENT_USER
-android.car.user UserStartResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserStartResult Parcelable.Creator<UserStartResult> CREATOR
-android.car.user UserStartResult boolean isSuccess()
-android.car.user UserStartResult String statusToString(int value)
-android.car.user UserStartResult int getStatus()
-android.car.user UserStartResult String toString()
-android.car.user UserStartResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserStartResult int describeContents()
-android.car.user UserStopResult int STATUS_SUCCESSFUL
-android.car.user UserStopResult int STATUS_ANDROID_FAILURE
-android.car.user UserStopResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserStopResult int STATUS_FAILURE_SYSTEM_USER
-android.car.user UserStopResult int STATUS_FAILURE_CURRENT_USER
-android.car.user UserStopResult Parcelable.Creator<UserStopResult> CREATOR
-android.car.user UserStopResult boolean isSuccess(int status)
-android.car.user UserStopResult boolean isSuccess()
-android.car.user UserStopResult String statusToString(int value)
-android.car.user UserStopResult int getStatus()
-android.car.user UserStopResult String toString()
-android.car.user UserStopResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserStopResult int describeContents()
-android.car.user UserSwitchResult int STATUS_SUCCESSFUL
-android.car.user UserSwitchResult int STATUS_ANDROID_FAILURE
-android.car.user UserSwitchResult int STATUS_HAL_FAILURE
-android.car.user UserSwitchResult int STATUS_HAL_INTERNAL_FAILURE
-android.car.user UserSwitchResult int STATUS_INVALID_REQUEST
-android.car.user UserSwitchResult int STATUS_UX_RESTRICTION_FAILURE
-android.car.user UserSwitchResult int STATUS_OK_USER_ALREADY_IN_FOREGROUND
-android.car.user UserSwitchResult int STATUS_TARGET_USER_ALREADY_BEING_SWITCHED_TO
-android.car.user UserSwitchResult int STATUS_TARGET_USER_ABANDONED_DUE_TO_A_NEW_REQUEST
-android.car.user UserSwitchResult int STATUS_NOT_SWITCHABLE
-android.car.user UserSwitchResult int STATUS_NOT_LOGGED_IN
-android.car.user UserSwitchResult Parcelable.Creator<UserSwitchResult> CREATOR
-android.car.user UserSwitchResult boolean isSuccess()
-android.car.user UserSwitchResult int describeContents()
-android.car.user UserSwitchResult String statusToString(int value)
-android.car.user UserSwitchResult int getStatus()
-android.car.user UserSwitchResult Integer getAndroidFailureStatus()
-android.car.user UserSwitchResult String getErrorMessage()
-android.car.user UserSwitchResult String toString()
-android.car.user UserSwitchResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.util.concurrent AndroidAsyncFuture T get()
-android.car.util.concurrent AndroidAsyncFuture T get(long timeout, TimeUnit unit)
-android.car.util.concurrent AndroidAsyncFuture AsyncFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor)
-android.car.util.concurrent AndroidFuture Parcelable.Creator<AndroidFuture> CREATOR
-android.car.util.concurrent AndroidFuture AndroidFuture<U> completedFuture(U value)
-android.car.util.concurrent AndroidFuture boolean complete(T value)
-android.car.util.concurrent AndroidFuture boolean completeExceptionally(Throwable ex)
-android.car.util.concurrent AndroidFuture boolean cancel(boolean mayInterruptIfRunning)
-android.car.util.concurrent AndroidFuture void onCompleted(T res, Throwable err)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> whenComplete(BiConsumer<? super T,? super Throwable> action)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> orTimeout(long timeout, TimeUnit unit)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> cancelTimeout()
-android.car.util.concurrent AndroidFuture AndroidFuture<T> setTimeoutHandler(Handler h)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenCompose(Function<? super T,? extends CompletionStage<U>> fn)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenComposeAsync(Function<? super T,? extends CompletionStage<U>> fn, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenApply(Function<? super T,? extends U> fn)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenApplyAsync(Function<? super T,? extends U> fn, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<V> thenCombine(CompletionStage<? extends U> other, BiFunction<? super T,? super U,? extends V> combineResults)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> thenCombine(CompletionStage<Void> other)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> supply(Supplier<T> supplier)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> supplyAsync(Supplier<T> supplier, Executor executor)
-android.car.util.concurrent AndroidFuture void writeToParcel(Parcel dest, int flags)
-android.car.util.concurrent AndroidFuture int describeContents()
-android.car.vms VmsClient void register()
-android.car.vms VmsClient void unregister()
-android.car.vms VmsClientManager void onCarDisconnected()
-android.car.vms VmsOperationRecorder.Writer boolean isEnabled()
-android.car.vms VmsOperationRecorder.Writer void write(String msg)
-android.car.vms VmsProviderInfo Parcelable.Creator<VmsProviderInfo> CREATOR
-android.car.vms VmsProviderInfo byte[] getDescription()
-android.car.vms VmsProviderInfo boolean equals(Object o)
-android.car.vms VmsProviderInfo int hashCode()
-android.car.vms VmsProviderInfo void writeToParcel(Parcel dest, int flags)
-android.car.vms VmsProviderInfo int describeContents()
-android.car.vms VmsPublisherClientService void onCarLifecycleChanged(Car car, boolean ready)
-android.car.vms VmsRegistrationInfo Parcelable.Creator<VmsRegistrationInfo> CREATOR
-android.car.vms VmsRegistrationInfo VmsAvailableLayers getAvailableLayers()
-android.car.vms VmsRegistrationInfo VmsSubscriptionState getSubscriptionState()
-android.car.vms VmsRegistrationInfo boolean equals(Object o)
-android.car.vms VmsRegistrationInfo int hashCode()
-android.car.vms VmsRegistrationInfo void writeToParcel(Parcel dest, int flags)
-android.car.vms VmsRegistrationInfo int describeContents()
-android.car.vms VmsSubscriberManager VmsSubscriberManager wrap(Car car, VmsClientManager clientManager)
-android.car.vms VmsSubscriberManager void onCarDisconnected()
-android.car.vms VmsSubscriptionHelper void subscribe(VmsLayer layer)
-android.car.vms VmsSubscriptionHelper void subscribe(VmsLayer layer, int providerId)
-android.car.vms VmsSubscriptionHelper void unsubscribe(VmsLayer layer)
-android.car.vms VmsSubscriptionHelper void unsubscribe(VmsLayer layer, int providerId)
-android.car.vms VmsSubscriptionHelper Set<VmsAssociatedLayer> getSubscriptions()
-android.car.watchdog CarWatchdogManager void onCarDisconnected()
-android.car.watchdog IoOveruseStats.Builder Builder setStartTime(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setDurationInSeconds(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalOveruses(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalTimesKilled(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalBytesWritten(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setKillableOnOveruse(boolean value)
-android.car.watchdog IoOveruseStats.Builder Builder setRemainingWriteBytes(PerStateBytes value)
-android.car.watchdog IoOveruseStats.Builder IoOveruseStats build()
-android.car.watchdog PackageKillableState String killableStateToString(int value)
-android.car.watchdog ResourceOveruseConfiguration String componentTypeToString(int value)
-android.car.watchdog ResourceOveruseStats.Builder Builder setPackageName(String value)
-android.car.watchdog ResourceOveruseStats.Builder Builder setUserHandle(UserHandle value)
-android.car.watchdog ResourceOveruseStats.Builder Builder setIoOveruseStats(IoOveruseStats value)
-android.car.watchdog ResourceOveruseStats.Builder ResourceOveruseStats build()
diff --git a/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.3.txt b/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.3.txt
deleted file mode 100644
index 82ff75e4e9..0000000000
--- a/tests/carservice_unit_test/res/raw/car_hidden_apis_release_33.3.txt
+++ /dev/null
@@ -1,867 +0,0 @@
-android.car AoapService int MSG_NEW_DEVICE_ATTACHED
-android.car AoapService int MSG_NEW_DEVICE_ATTACHED_RESPONSE
-android.car AoapService int MSG_CAN_SWITCH_TO_AOAP
-android.car AoapService int MSG_CAN_SWITCH_TO_AOAP_RESPONSE
-android.car AoapService String KEY_DEVICE
-android.car AoapService String KEY_RESULT
-android.car ApiVersion boolean equals(Object obj)
-android.car ApiVersion int hashCode()
-android.car ApiVersion String toString()
-android.car ApiVersion void writeToParcel(Parcel dest)
-android.car ApiVersion T readFromParcel(Parcel source, ApiVersionFactory<T> factory)
-android.car Car String PROPERTY_EMULATED_PLATFORM_VERSION_MAJOR
-android.car Car String PROPERTY_EMULATED_PLATFORM_VERSION_MINOR
-android.car Car String CAR_SERVICE_BINDER_SERVICE_NAME
-android.car Car String EXPERIMENTAL_CAR_USER_SERVICE
-android.car Car String CAR_INSTRUMENT_CLUSTER_SERVICE
-android.car Car String CLUSTER_HOME_SERVICE
-android.car Car String PERMISSION_CAR_MONITOR_CLUSTER_NAVIGATION_STATE
-android.car Car String PERMISSION_CAR_DISPLAY_IN_CLUSTER
-android.car Car String PERMISSION_BIND_VMS_CLIENT
-android.car Car String PERMISSION_COLLECT_CAR_CPU_INFO
-android.car Car String CAR_TEMPLATE_HOST_RENDERER_SERVICE
-android.car Car String CAR_SERVICE_INTERFACE_NAME
-android.car Car String CAR_CATEGORY_NAVIGATION
-android.car Car Car Car(Context context, ICar service, Handler handler)
-android.car Car ServiceConnection getServiceConnectionListener()
-android.car Car Context getContext()
-android.car Car Handler getEventHandler()
-android.car Car T handleRemoteExceptionFromCarService(RemoteException e, T returnValue)
-android.car Car void handleRemoteExceptionFromCarService(RemoteException e)
-android.car Car T handleRemoteExceptionFromCarService(Service service, RemoteException e, T returnValue)
-android.car Car void handleRemoteExceptionFromCarService(Service service, RemoteException e)
-android.car CarAppFocusManager int APP_FOCUS_MAX
-android.car CarAppFocusManager CarAppFocusManager CarAppFocusManager(Car car, IBinder service)
-android.car CarAppFocusManager int[] getActiveAppTypes()
-android.car CarAppFocusManager List<String> getAppTypeOwner(int appType)
-android.car CarAppFocusManager void onCarDisconnected()
-android.car CarBugreportManager CarBugreportManager CarBugreportManager(Car car, IBinder service)
-android.car CarBugreportManager void requestBugreportForTesting(ParcelFileDescriptor output, ParcelFileDescriptor extraOutput, CarBugreportManagerCallback callback)
-android.car CarBugreportManager void onCarDisconnected()
-android.car CarFeatures String FEATURE_CAR_USER_NOTICE_SERVICE
-android.car CarInfoManager int BASIC_INFO_KEY_MANUFACTURER
-android.car CarInfoManager int BASIC_INFO_KEY_MODEL
-android.car CarInfoManager int BASIC_INFO_KEY_MODEL_YEAR
-android.car CarInfoManager String BASIC_INFO_KEY_VEHICLE_ID
-android.car CarInfoManager String INFO_KEY_PRODUCT_CONFIGURATION
-android.car CarInfoManager int BASIC_INFO_DRIVER_SEAT
-android.car CarInfoManager int BASIC_INFO_EV_PORT_LOCATION
-android.car CarInfoManager int BASIC_INFO_FUEL_DOOR_LOCATION
-android.car CarInfoManager int BASIC_INFO_FUEL_CAPACITY
-android.car CarInfoManager int BASIC_INFO_FUEL_TYPES
-android.car CarInfoManager int BASIC_INFO_EV_BATTERY_CAPACITY
-android.car CarInfoManager int BASIC_INFO_EV_CONNECTOR_TYPES
-android.car CarInfoManager CarInfoManager CarInfoManager(Car car, IBinder service)
-android.car CarInfoManager void onCarDisconnected()
-android.car CarLibLog String TAG_CAR
-android.car CarLibLog String TAG_CLUSTER
-android.car CarLibLog String TAG_INPUT
-android.car CarLibLog String TAG_NAV
-android.car CarLibLog String TAG_SENSOR
-android.car CarLibLog String TAG_DIAGNOSTIC
-android.car CarManagerBase Car mCar
-android.car CarManagerBase CarManagerBase CarManagerBase(Car car)
-android.car CarManagerBase Context getContext()
-android.car CarManagerBase Handler getEventHandler()
-android.car CarManagerBase T handleRemoteExceptionFromCarService(RemoteException e, T returnValue)
-android.car CarManagerBase void handleRemoteExceptionFromCarService(RemoteException e)
-android.car CarManagerBase T handleExceptionFromCarService(Exception e, T returnValue)
-android.car CarManagerBase void onCarDisconnected()
-android.car CarManagerBase T addDumpable(Object container, Supplier<T> dumpableSupplier)
-android.car CarOccupantZoneManager int OCCUPANT_TYPE_INVALID
-android.car CarOccupantZoneManager CarOccupantZoneManager CarOccupantZoneManager(Car car, IBinder service)
-android.car CarOccupantZoneManager boolean assignProfileUserToOccupantZone(OccupantZoneInfo occupantZone, int userId)
-android.car CarOccupantZoneManager void onCarDisconnected()
-android.car CarOccupantZoneManager.OccupantZoneInfo int INVALID_ZONE_ID
-android.car CarOccupantZoneManager.OccupantZoneInfo OccupantZoneInfo OccupantZoneInfo(int zoneId, int occupantType, int seat)
-android.car CarOccupantZoneManager.OccupantZoneInfo OccupantZoneInfo OccupantZoneInfo(Parcel in)
-android.car CarProjectionManager int NUM_KEY_EVENTS
-android.car CarProjectionManager int PROJECTION_AP_STARTED
-android.car CarProjectionManager int PROJECTION_AP_STOPPED
-android.car CarProjectionManager int PROJECTION_AP_FAILED
-android.car CarProjectionManager CarProjectionManager CarProjectionManager(Car car, IBinder service)
-android.car CarProjectionManager void regsiterProjectionListener(CarProjectionListener listener, int voiceSearchFilter)
-android.car CarProjectionManager void unregsiterProjectionListener()
-android.car CarProjectionManager void onCarDisconnected()
-android.car VehicleAreaSeat int SIDE_LEFT
-android.car VehicleAreaSeat int SIDE_CENTER
-android.car VehicleAreaSeat int SIDE_RIGHT
-android.car VehicleAreaSeat int fromRowAndSide(int rowNumber, int side)
-android.car VehicleHvacFanDirection int FACE
-android.car VehicleHvacFanDirection int FLOOR
-android.car VehicleHvacFanDirection int DEFROST
-android.car VehicleLightState int OFF
-android.car VehicleLightState int ON
-android.car VehicleLightState int DAYTIME_RUNNING
-android.car VehicleLightSwitch int OFF
-android.car VehicleLightSwitch int ON
-android.car VehicleLightSwitch int DAYTIME_RUNNING
-android.car VehicleLightSwitch int AUTOMATIC
-android.car VehicleOilLevel int CRITICALLY_LOW
-android.car VehicleOilLevel int LOW
-android.car VehicleOilLevel int NORMAL
-android.car VehicleOilLevel int HIGH
-android.car VehicleOilLevel int ERROR
-android.car VehiclePropertyIds int INITIAL_USER_INFO
-android.car VehiclePropertyIds int SWITCH_USER
-android.car VehiclePropertyIds int CREATE_USER
-android.car VehiclePropertyIds int REMOVE_USER
-android.car VehiclePropertyIds int USER_IDENTIFICATION_ASSOCIATION
-android.car VehiclePropertyIds int POWER_POLICY_REQ
-android.car VehiclePropertyIds int POWER_POLICY_GROUP_REQ
-android.car VehiclePropertyIds int CURRENT_POWER_POLICY
-android.car VehiclePropertyIds int WATCHDOG_ALIVE
-android.car VehiclePropertyIds int WATCHDOG_TERMINATED_PROCESS
-android.car VehiclePropertyIds int VHAL_HEARTBEAT
-android.car VehiclePropertyIds int CLUSTER_SWITCH_UI
-android.car VehiclePropertyIds int CLUSTER_DISPLAY_STATE
-android.car VehiclePropertyIds int CLUSTER_REPORT_STATE
-android.car VehiclePropertyIds int CLUSTER_REQUEST_DISPLAY
-android.car VehiclePropertyIds int CLUSTER_NAVIGATION_STATE
-android.car VehiclePropertyType int STRING
-android.car VehiclePropertyType int BOOLEAN
-android.car VehiclePropertyType int INT32
-android.car VehiclePropertyType int INT32_VEC
-android.car VehiclePropertyType int INT64
-android.car VehiclePropertyType int INT64_VEC
-android.car VehiclePropertyType int FLOAT
-android.car VehiclePropertyType int FLOAT_VEC
-android.car VehiclePropertyType int BYTES
-android.car VehiclePropertyType int MIXED
-android.car VehiclePropertyType int MASK
-android.car VehicleSeatOccupancyState int UNKNOWN
-android.car VehicleSeatOccupancyState int VACANT
-android.car VehicleSeatOccupancyState int OCCUPIED
-android.car.admin CarDevicePolicyManager String TAG
-android.car.admin CarDevicePolicyManager int FIRST_USER_TYPE
-android.car.admin CarDevicePolicyManager int LAST_USER_TYPE
-android.car.admin CarDevicePolicyManager CarDevicePolicyManager CarDevicePolicyManager(Car car, IBinder service)
-android.car.admin CarDevicePolicyManager CarDevicePolicyManager CarDevicePolicyManager(Car car, ICarDevicePolicyService service)
-android.car.admin CarDevicePolicyManager StartUserInBackgroundResult startUserInBackground(UserHandle user)
-android.car.admin CarDevicePolicyManager StopUserResult stopUser(UserHandle user)
-android.car.admin CarDevicePolicyManager void setUserDisclaimerShown(UserHandle user)
-android.car.admin CarDevicePolicyManager void setUserDisclaimerAcknowledged(UserHandle user)
-android.car.admin CarDevicePolicyManager void onCarDisconnected()
-android.car.admin CreateUserResult CreateUserResult CreateUserResult(UserCreationResult result)
-android.car.admin CreateUserResult CreateUserResult forGenericError()
-android.car.admin RemoveUserResult RemoveUserResult RemoveUserResult(int status)
-android.car.admin RemoveUserResult String statusToString(int status)
-android.car.admin StartUserInBackgroundResult int STATUS_SUCCESS
-android.car.admin StartUserInBackgroundResult int STATUS_SUCCESS_CURRENT_USER
-android.car.admin StartUserInBackgroundResult int STATUS_FAILURE_USER_DOES_NOT_EXIST
-android.car.admin StartUserInBackgroundResult int STATUS_FAILURE_GENERIC
-android.car.admin StartUserInBackgroundResult StartUserInBackgroundResult StartUserInBackgroundResult(int status)
-android.car.admin StartUserInBackgroundResult int getStatus()
-android.car.admin StartUserInBackgroundResult boolean isSuccess()
-android.car.admin StartUserInBackgroundResult String toString()
-android.car.admin StopUserResult int STATUS_SUCCESS
-android.car.admin StopUserResult int STATUS_FAILURE_CURRENT_USER
-android.car.admin StopUserResult int STATUS_FAILURE_SYSTEM_USER
-android.car.admin StopUserResult int STATUS_FAILURE_USER_DOES_NOT_EXIST
-android.car.admin StopUserResult int STATUS_FAILURE_GENERIC
-android.car.admin StopUserResult StopUserResult StopUserResult(int status)
-android.car.admin StopUserResult int getStatus()
-android.car.admin StopUserResult boolean isSuccess()
-android.car.admin StopUserResult String toString()
-android.car.app CarActivityManager int ERROR_CODE_ACTIVITY_NOT_FOUND
-android.car.app CarActivityManager CarActivityManager CarActivityManager(Car car, IBinder service)
-android.car.app CarActivityManager CarActivityManager CarActivityManager(Car car, ICarActivityService service)
-android.car.app CarActivityManager void onCarDisconnected()
-android.car.app CarActivityManager boolean registerTaskMonitor()
-android.car.app CarActivityManager void onTaskAppeared(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void onTaskVanished(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void onTaskInfoChanged(ActivityManager.RunningTaskInfo taskInfo)
-android.car.app CarActivityManager void unregisterTaskMonitor()
-android.car.app CarActivityManager List<ActivityManager.RunningTaskInfo> getVisibleTasks()
-android.car.cluster CarInstrumentClusterManager CarInstrumentClusterManager CarInstrumentClusterManager(Car car, IBinder service)
-android.car.cluster CarInstrumentClusterManager void onCarDisconnected()
-android.car.cluster ClusterHomeManager int UI_TYPE_CLUSTER_NONE
-android.car.cluster ClusterHomeManager int UI_TYPE_CLUSTER_HOME
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_ON_OFF
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_BOUNDS
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_INSETS
-android.car.cluster ClusterHomeManager int CONFIG_UI_TYPE
-android.car.cluster ClusterHomeManager int CONFIG_DISPLAY_ID
-android.car.cluster ClusterHomeManager ClusterHomeManager ClusterHomeManager(Car car, IBinder service)
-android.car.cluster ClusterHomeManager void registerClusterStateListener(Executor executor, ClusterStateListener callback)
-android.car.cluster ClusterHomeManager void registerClusterNavigationStateListener(Executor executor, ClusterNavigationStateListener callback)
-android.car.cluster ClusterHomeManager void unregisterClusterStateListener(ClusterStateListener callback)
-android.car.cluster ClusterHomeManager void unregisterClusterNavigationStateListener(ClusterNavigationStateListener callback)
-android.car.cluster ClusterHomeManager void reportState(int uiTypeMain, int uiTypeSub, byte[] uiAvailability)
-android.car.cluster ClusterHomeManager void requestDisplay(int uiType)
-android.car.cluster ClusterHomeManager ClusterState getClusterState()
-android.car.cluster ClusterHomeManager boolean startFixedActivityModeAsUser(Intent intent, Bundle options, int userId)
-android.car.cluster ClusterHomeManager void stopFixedActivityMode()
-android.car.cluster ClusterHomeManager void onCarDisconnected()
-android.car.cluster.renderer InstrumentClusterRenderingService String EXTRA_BUNDLE_KEY_FOR_INSTRUMENT_CLUSTER_HELPER
-android.car.cluster.renderer InstrumentClusterRenderingService ComponentName getComponentFromPackage(String packageName)
-android.car.cluster.renderer InstrumentClusterRenderingService void setClusterActivityLaunchOptions(String category, ActivityOptions activityOptions)
-android.car.cluster.renderer InstrumentClusterRenderingService void setClusterActivityState(String category, Bundle state)
-android.car.content.pm AppBlockingPackageInfo void verify()
-android.car.content.pm AppBlockingPackageInfo boolean isActivityCovered(String className)
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_BLOCKED_ACTIVITY_NAME
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_BLOCKED_TASK_ID
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_ROOT_ACTIVITY_NAME
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_IS_ROOT_ACTIVITY_DO
-android.car.content.pm CarPackageManager String BLOCKING_INTENT_EXTRA_DISPLAY_ID
-android.car.content.pm CarPackageManager String DRIVING_SAFETY_REGION_ALL
-android.car.content.pm CarPackageManager String DRIVING_SAFETY_ACTIVITY_METADATA_REGIONS
-android.car.content.pm CarPackageManager int ERROR_CODE_NO_PACKAGE
-android.car.content.pm CarPackageManager CarPackageManager CarPackageManager(Car car, IBinder service)
-android.car.content.pm CarPackageManager CarPackageManager CarPackageManager(Car car, ICarPackageManager service)
-android.car.content.pm CarPackageManager void onCarDisconnected()
-android.car.content.pm CarPackageManager void restartTask(int taskId)
-android.car.content.pm CarPackageManager void setEnableActivityBlocking(boolean enable)
-android.car.content.pm CarPackageManager String getCurrentDrivingSafetyRegion()
-android.car.content.pm CarPackageManager void controlTemporaryActivityBlockingBypassingAsUser(String packageName, String activityClassName, boolean bypass, int userId)
-android.car.content.pm CarPackageManager List<String> getSupportedDrivingSafetyRegionsForActivityAsUser(String packageName, String activityClassName, int userId)
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent withVendorSensorsRemoved()
-android.car.diagnostic CarDiagnosticEvent boolean isEmptyFrame()
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent checkLiveFrame()
-android.car.diagnostic CarDiagnosticEvent CarDiagnosticEvent checkFreezeFrame()
-android.car.diagnostic CarDiagnosticEvent boolean isEarlierThan(CarDiagnosticEvent otherEvent)
-android.car.diagnostic CarDiagnosticEvent.IgnitionMonitor.Decoder IgnitionMonitor fromValue(int value)
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int COMPONENTS_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int COMPONENTS_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int FUEL_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int FUEL_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int MISFIRE_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CommonIgnitionMonitors int MISFIRE_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EGR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EGR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_HEATER_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_HEATER_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int OXYGEN_SENSOR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int AC_REFRIGERANT_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int AC_REFRIGERANT_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int SECONDARY_AIR_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int SECONDARY_AIR_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EVAPORATIVE_SYSTEM_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int EVAPORATIVE_SYSTEM_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int HEATED_CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int HEATED_CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.SparkIgnitionMonitors int CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EGR_OR_VVT_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EGR_OR_VVT_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int PM_FILTER_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int PM_FILTER_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EXHAUST_GAS_SENSOR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int EXHAUST_GAS_SENSOR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int BOOST_PRESSURE_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int BOOST_PRESSURE_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NOx_SCR_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NOx_SCR_INCOMPLETE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NMHC_CATALYST_AVAILABLE
-android.car.diagnostic CarDiagnosticEvent.CompressionIgnitionMonitors int NMHC_CATALYST_INCOMPLETE
-android.car.diagnostic CarDiagnosticManager int[] FRAME_TYPES
-android.car.diagnostic CarDiagnosticManager CarDiagnosticManager CarDiagnosticManager(Car car, IBinder service)
-android.car.drivingstate CarDrivingStateManager CarDrivingStateManager CarDrivingStateManager(Car car, IBinder service)
-android.car.drivingstate CarDrivingStateManager void onCarDisconnected()
-android.car.drivingstate CarDrivingStateManager void injectDrivingState(int drivingState)
-android.car.drivingstate CarUxRestrictions long getTimeStamp()
-android.car.drivingstate CarUxRestrictionsConfiguration void writeJson(JsonWriter writer)
-android.car.drivingstate CarUxRestrictionsConfiguration CarUxRestrictionsConfiguration readJson(JsonReader reader, int schemaVersion)
-android.car.drivingstate CarUxRestrictionsConfiguration boolean hasSameParameters(CarUxRestrictionsConfiguration other)
-android.car.drivingstate CarUxRestrictionsConfiguration void dump(PrintWriter writer)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Map<String,RestrictionModeContainer> mRestrictionModes
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder Builder()
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder int validatePort(int port)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setPhysicalPort(int port)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, boolean requiresOptimization, int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, SpeedRange speedRange, boolean requiresOptimization, int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setUxRestrictions(int drivingState, DrivingStateRestrictions drivingStateRestrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxStringLength(int maxStringLength)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxCumulativeContentItems(int maxCumulativeContentItems)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder Builder setMaxContentDepth(int maxContentDepth)
-android.car.drivingstate CarUxRestrictionsConfiguration.Builder CarUxRestrictionsConfiguration build()
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setDistractionOptimizationRequired(boolean distractionOptimizationRequired)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setRestrictions(int restrictions)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setMode(String mode)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions DrivingStateRestrictions setSpeedRange(Builder.SpeedRange speedRange)
-android.car.drivingstate CarUxRestrictionsConfiguration.DrivingStateRestrictions String toString()
-android.car.drivingstate CarUxRestrictionsManager CarUxRestrictionsManager CarUxRestrictionsManager(Car car, IBinder service)
-android.car.drivingstate CarUxRestrictionsManager void registerListener(OnUxRestrictionsChangedListener listener, int displayId)
-android.car.evs CarEvsManager CarEvsManager CarEvsManager(Car car, IBinder service)
-android.car.evs CarEvsManager void onCarDisconnected()
-android.car.hardware CarPropertyConfig String getConfigString()
-android.car.hardware CarPropertyConfig int getAreaCount()
-android.car.hardware CarPropertyConfig int getFirstAndOnlyAreaId()
-android.car.hardware CarPropertyConfig boolean hasArea(int areaId)
-android.car.hardware CarPropertyConfig String toString()
-android.car.hardware CarPropertyConfig Builder<T> newBuilder(Class<T> type, int propertyId, int areaType)
-android.car.hardware CarPropertyConfig.AreaConfig Parcelable.Creator<AreaConfig<Object>> CREATOR
-android.car.hardware CarPropertyConfig.AreaConfig T getMinValue()
-android.car.hardware CarPropertyConfig.AreaConfig T getMaxValue()
-android.car.hardware CarPropertyConfig.AreaConfig int describeContents()
-android.car.hardware CarPropertyConfig.AreaConfig void writeToParcel(Parcel dest, int flags)
-android.car.hardware CarPropertyConfig.AreaConfig String toString()
-android.car.hardware CarPropertyValue CarPropertyValue CarPropertyValue(int propertyId, int areaId, T value)
-android.car.hardware CarPropertyValue CarPropertyValue CarPropertyValue(int propertyId, int areaId, int status, long timestamp, T value)
-android.car.hardware CarPropertyValue CarPropertyValue CarPropertyValue(Parcel in)
-android.car.hardware CarPropertyValue String toString()
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_SUPPORTED_WHEELS
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_FRONT_LEFT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_FRONT_RIGHT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_REAR_RIGHT_UM_PER_TICK
-android.car.hardware CarSensorConfig String WHEEL_TICK_DISTANCE_REAR_LEFT_UM_PER_TICK
-android.car.hardware CarSensorConfig Parcelable.Creator<CarSensorConfig> CREATOR
-android.car.hardware CarSensorConfig CarSensorConfig CarSensorConfig(Parcel in)
-android.car.hardware CarSensorConfig CarSensorConfig CarSensorConfig(int type, Bundle b)
-android.car.hardware CarSensorConfig int describeContents()
-android.car.hardware CarSensorConfig void writeToParcel(Parcel dest, int flags)
-android.car.hardware CarSensorConfig Bundle getBundle()
-android.car.hardware CarSensorConfig int getInt(String key)
-android.car.hardware CarSensorConfig int getType()
-android.car.hardware CarSensorConfig String toString()
-android.car.hardware CarSensorEvent CarSensorEvent CarSensorEvent(Parcel in)
-android.car.hardware CarSensorEvent CarSensorEvent CarSensorEvent(int sensorType, long timestamp, int floatValueSize, int intValueSize, int longValueSize)
-android.car.hardware CarSensorEvent EnvironmentData getEnvironmentData(EnvironmentData data)
-android.car.hardware CarSensorEvent IgnitionStateData getIgnitionStateData(IgnitionStateData data)
-android.car.hardware CarSensorEvent NightData getNightData(NightData data)
-android.car.hardware CarSensorEvent GearData getGearData(GearData data)
-android.car.hardware CarSensorEvent ParkingBrakeData getParkingBrakeData(ParkingBrakeData data)
-android.car.hardware CarSensorEvent FuelLevelData getFuelLevelData(FuelLevelData data)
-android.car.hardware CarSensorEvent OdometerData getOdometerData(OdometerData data)
-android.car.hardware CarSensorEvent RpmData getRpmData(RpmData data)
-android.car.hardware CarSensorEvent CarSpeedData getCarSpeedData(CarSpeedData data)
-android.car.hardware CarSensorEvent CarWheelTickDistanceData getCarWheelTickDistanceData(CarWheelTickDistanceData data)
-android.car.hardware CarSensorEvent CarAbsActiveData getCarAbsActiveData(CarAbsActiveData data)
-android.car.hardware CarSensorEvent CarTractionControlActiveData getCarTractionControlActiveData(CarTractionControlActiveData data)
-android.car.hardware CarSensorEvent CarFuelDoorOpenData getCarFuelDoorOpenData(CarFuelDoorOpenData data)
-android.car.hardware CarSensorEvent CarEvBatteryLevelData getCarEvBatteryLevelData(CarEvBatteryLevelData data)
-android.car.hardware CarSensorEvent CarEvChargePortOpenData getCarEvChargePortOpenData(CarEvChargePortOpenData data)
-android.car.hardware CarSensorEvent CarEvChargePortConnectedData getCarEvChargePortConnectedData(CarEvChargePortConnectedData data)
-android.car.hardware CarSensorEvent CarEvBatteryChargeRateData getCarEvBatteryChargeRateData(CarEvBatteryChargeRateData data)
-android.car.hardware CarSensorEvent CarEngineOilLevelData getCarEngineOilLevelData(CarEngineOilLevelData data)
-android.car.hardware CarSensorEvent String toString()
-android.car.hardware CarSensorEvent.IgnitionStateData long timestamp
-android.car.hardware CarSensorEvent.IgnitionStateData int ignitionState
-android.car.hardware CarSensorEvent.NightData long timestamp
-android.car.hardware CarSensorEvent.NightData boolean isNightMode
-android.car.hardware CarSensorEvent.GearData long timestamp
-android.car.hardware CarSensorEvent.GearData int gear
-android.car.hardware CarSensorEvent.ParkingBrakeData long timestamp
-android.car.hardware CarSensorEvent.ParkingBrakeData boolean isEngaged
-android.car.hardware CarSensorEvent.FuelLevelData long timestamp
-android.car.hardware CarSensorEvent.FuelLevelData float level
-android.car.hardware CarSensorEvent.OdometerData long timestamp
-android.car.hardware CarSensorEvent.OdometerData float kms
-android.car.hardware CarSensorEvent.RpmData long timestamp
-android.car.hardware CarSensorEvent.RpmData float rpm
-android.car.hardware CarSensorEvent.CarSpeedData long timestamp
-android.car.hardware CarSensorEvent.CarSpeedData float carSpeed
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long timestamp
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long sensorResetCount
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long frontLeftWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long frontRightWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long rearRightWheelDistanceMm
-android.car.hardware CarSensorEvent.CarWheelTickDistanceData long rearLeftWheelDistanceMm
-android.car.hardware CarSensorEvent.CarAbsActiveData long timestamp
-android.car.hardware CarSensorEvent.CarAbsActiveData boolean absIsActive
-android.car.hardware CarSensorEvent.CarTractionControlActiveData long timestamp
-android.car.hardware CarSensorEvent.CarTractionControlActiveData boolean tractionControlIsActive
-android.car.hardware CarSensorEvent.CarFuelDoorOpenData long timestamp
-android.car.hardware CarSensorEvent.CarFuelDoorOpenData boolean fuelDoorIsOpen
-android.car.hardware CarSensorEvent.CarEvBatteryLevelData long timestamp
-android.car.hardware CarSensorEvent.CarEvBatteryLevelData float evBatteryLevel
-android.car.hardware CarSensorEvent.CarEvChargePortOpenData long timestamp
-android.car.hardware CarSensorEvent.CarEvChargePortOpenData boolean evChargePortIsOpen
-android.car.hardware CarSensorEvent.CarEvChargePortConnectedData long timestamp
-android.car.hardware CarSensorEvent.CarEvChargePortConnectedData boolean evChargePortIsConnected
-android.car.hardware CarSensorEvent.CarEvBatteryChargeRateData long timestamp
-android.car.hardware CarSensorEvent.CarEvBatteryChargeRateData float evChargeRate
-android.car.hardware CarSensorEvent.CarEngineOilLevelData long timestamp
-android.car.hardware CarSensorEvent.CarEngineOilLevelData int engineOilLevel
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED1
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED8
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED10
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED11
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED12
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED13
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED14
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED15
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED16
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED17
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED18
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED19
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED20
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED21
-android.car.hardware CarSensorManager int SENSOR_TYPE_RESERVED26
-android.car.hardware CarSensorManager CarSensorManager CarSensorManager(Car car, IBinder service)
-android.car.hardware CarSensorManager void onCarDisconnected()
-android.car.hardware CarSensorManager boolean isSensorSupported(int[] sensorList, int sensorType)
-android.car.hardware CarSensorManager CarSensorConfig getSensorConfig(int type)
-android.car.hardware CarVendorExtensionManager CarVendorExtensionManager CarVendorExtensionManager(Car car, IBinder service)
-android.car.hardware CarVendorExtensionManager void onCarDisconnected()
-android.car.hardware.cabin CarCabinManager CarCabinManager CarCabinManager(Car car, IBinder service)
-android.car.hardware.cabin CarCabinManager void onCarDisconnected()
-android.car.hardware.hvac CarHvacManager CarHvacManager CarHvacManager(Car car, IBinder service)
-android.car.hardware.hvac CarHvacManager void onCarDisconnected()
-android.car.hardware.power CarPowerManager String TAG
-android.car.hardware.power CarPowerManager CarPowerManager CarPowerManager(Car car, IBinder service)
-android.car.hardware.power CarPowerManager void requestShutdownOnNextSuspend()
-android.car.hardware.power CarPowerManager void scheduleNextWakeupTime(int seconds)
-android.car.hardware.power CarPowerManager boolean isCompletionAllowed(int state)
-android.car.hardware.power CarPowerManager void onCarDisconnected()
-android.car.hardware.power CarPowerPolicy CarPowerPolicy CarPowerPolicy(String policyId, int[] enabledComponents, int[] disabledComponents)
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_ENABLED
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_DISABLED
-android.car.hardware.power PowerComponentUtil int COMPONENT_STATE_UNTOUCHED
-android.car.hardware.power PowerComponentUtil int INVALID_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil int FIRST_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil int LAST_POWER_COMPONENT
-android.car.hardware.power PowerComponentUtil boolean isValidPowerComponent(int component)
-android.car.hardware.power PowerComponentUtil boolean hasComponents(CarPowerPolicy policy, CarPowerPolicyFilter filter)
-android.car.hardware.power PowerComponentUtil int toPowerComponent(String component, boolean prefix)
-android.car.hardware.power PowerComponentUtil String powerComponentToString(int component)
-android.car.hardware.property CarPropertyEvent int PROPERTY_EVENT_PROPERTY_CHANGE
-android.car.hardware.property CarPropertyEvent int PROPERTY_EVENT_ERROR
-android.car.hardware.property CarPropertyEvent Parcelable.Creator<CarPropertyEvent> CREATOR
-android.car.hardware.property CarPropertyEvent CarPropertyEvent CarPropertyEvent(int eventType, CarPropertyValue<?> carPropertyValue)
-android.car.hardware.property CarPropertyEvent CarPropertyEvent CarPropertyEvent(int eventType, CarPropertyValue<?> carPropertyValue, int errorCode)
-android.car.hardware.property CarPropertyEvent int getEventType()
-android.car.hardware.property CarPropertyEvent CarPropertyValue<?> getCarPropertyValue()
-android.car.hardware.property CarPropertyEvent int describeContents()
-android.car.hardware.property CarPropertyEvent void writeToParcel(Parcel dest, int flags)
-android.car.hardware.property CarPropertyEvent CarPropertyEvent createErrorEventWithErrorCode(int propertyId, int areaId, int errorCode)
-android.car.hardware.property CarPropertyEvent int getErrorCode()
-android.car.hardware.property CarPropertyEvent String toString()
-android.car.hardware.property CarPropertyManager CarPropertyManager CarPropertyManager(Car car, ICarProperty service)
-android.car.hardware.property CarPropertyManager String getReadPermission(int propId)
-android.car.hardware.property CarPropertyManager String getWritePermission(int propId)
-android.car.hardware.property CarPropertyManager void onCarDisconnected()
-android.car.hardware.property VehicleHalStatusCode int STATUS_OK
-android.car.hardware.property VehicleHalStatusCode int STATUS_TRY_AGAIN
-android.car.hardware.property VehicleHalStatusCode int STATUS_INVALID_ARG
-android.car.hardware.property VehicleHalStatusCode int STATUS_NOT_AVAILABLE
-android.car.hardware.property VehicleHalStatusCode int STATUS_ACCESS_DENIED
-android.car.hardware.property VehicleHalStatusCode int STATUS_INTERNAL_ERROR
-android.car.input CarInputManager CarInputManager CarInputManager(Car car, IBinder service)
-android.car.input CarInputManager void onCarDisconnected()
-android.car.media CarAudioManager int INVALID_VOLUME_GROUP_ID
-android.car.media CarAudioManager String AUDIOFOCUS_EXTRA_REQUEST_ZONE_ID
-android.car.media CarAudioManager CarAudioManager CarAudioManager(Car car, IBinder service)
-android.car.media CarAudioManager boolean isDynamicRoutingEnabled()
-android.car.media CarAudioManager int getZoneIdForUid(int uid)
-android.car.media CarAudioManager boolean setZoneIdForUid(int zoneId, int uid)
-android.car.media CarAudioManager boolean clearZoneIdForUid(int uid)
-android.car.media CarAudioManager void onCarDisconnected()
-android.car.media CarAudioPatchHandle CarAudioPatchHandle CarAudioPatchHandle(int patchId, String sourceAddress, String sinkAddress)
-android.car.media CarAudioPatchHandle String getSourceAddress()
-android.car.media CarAudioPatchHandle String getSinkAddress()
-android.car.media CarAudioPatchHandle int getHandleId()
-android.car.media CarMediaManager CarMediaManager CarMediaManager(Car car, IBinder service)
-android.car.media CarMediaManager void onCarDisconnected()
-android.car.media CarMediaManager boolean isIndependentPlaybackConfig()
-android.car.media CarMediaManager void setIndependentPlaybackConfig(boolean independent)
-android.car.media CarVolumeGroupInfo CarVolumeGroupInfo CarVolumeGroupInfo(Parcel in)
-android.car.navigation CarNavigationInstrumentCluster Bundle getExtra()
-android.car.navigation CarNavigationStatusManager CarNavigationStatusManager CarNavigationStatusManager(Car car, IBinder service)
-android.car.navigation CarNavigationStatusManager void onCarDisconnected()
-android.car.occupantawareness DriverMonitoringDetection int confidenceLevel
-android.car.occupantawareness DriverMonitoringDetection boolean isLookingOnRoad
-android.car.occupantawareness DriverMonitoringDetection long gazeDurationMillis
-android.car.occupantawareness DriverMonitoringDetection Parcelable.Creator<DriverMonitoringDetection> CREATOR
-android.car.occupantawareness DriverMonitoringDetection DriverMonitoringDetection DriverMonitoringDetection()
-android.car.occupantawareness DriverMonitoringDetection DriverMonitoringDetection DriverMonitoringDetection(int confidenceLevel, boolean isLookingOnRoad, long gazeDurationMillis)
-android.car.occupantawareness DriverMonitoringDetection int describeContents()
-android.car.occupantawareness DriverMonitoringDetection String toString()
-android.car.occupantawareness DriverMonitoringDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_UNKNOWN
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_CENTER_INSTRUMENT_CLUSTER
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_REAR_VIEW_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_LEFT_SIDE_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_RIGHT_SIDE_MIRROR
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_FORWARD_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_LEFT_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_RIGHT_ROADWAY
-android.car.occupantawareness GazeDetection int VEHICLE_REGION_HEAD_UNIT_DISPLAY
-android.car.occupantawareness GazeDetection int confidenceLevel
-android.car.occupantawareness GazeDetection Point3D leftEyePosition
-android.car.occupantawareness GazeDetection Point3D rightEyePosition
-android.car.occupantawareness GazeDetection Point3D headAngleUnitVector
-android.car.occupantawareness GazeDetection Point3D gazeAngleUnitVector
-android.car.occupantawareness GazeDetection int gazeTarget
-android.car.occupantawareness GazeDetection long durationOnTargetMillis
-android.car.occupantawareness GazeDetection Parcelable.Creator<GazeDetection> CREATOR
-android.car.occupantawareness GazeDetection GazeDetection GazeDetection(int confidenceLevel, Point3D leftEyePosition, Point3D rightEyePosition, Point3D headAngleUnitVector, Point3D gazeAngleUnitVector, int gazeTarget, long durationOnTargetMillis)
-android.car.occupantawareness GazeDetection int describeContents()
-android.car.occupantawareness GazeDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness GazeDetection String toString()
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_NONE
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_DRIVER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_FRONT_PASSENGER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_LEFT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_CENTER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_2_PASSENGER_RIGHT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_LEFT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_CENTER
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ROW_3_PASSENGER_RIGHT
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_FRONT_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_ROW_2_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_ROW_3_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int VEHICLE_OCCUPANT_ALL_OCCUPANTS
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_NONE
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_LOW
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_HIGH
-android.car.occupantawareness OccupantAwarenessDetection int CONFIDENCE_LEVEL_MAX
-android.car.occupantawareness OccupantAwarenessDetection int role
-android.car.occupantawareness OccupantAwarenessDetection long timestampMillis
-android.car.occupantawareness OccupantAwarenessDetection boolean isPresent
-android.car.occupantawareness OccupantAwarenessDetection GazeDetection gazeDetection
-android.car.occupantawareness OccupantAwarenessDetection DriverMonitoringDetection driverMonitoringDetection
-android.car.occupantawareness OccupantAwarenessDetection Parcelable.Creator<OccupantAwarenessDetection> CREATOR
-android.car.occupantawareness OccupantAwarenessDetection OccupantAwarenessDetection OccupantAwarenessDetection(int role, long timestampMillis, boolean isPresent, GazeDetection gazeDetection, DriverMonitoringDetection driverMonitoringDetection)
-android.car.occupantawareness OccupantAwarenessDetection int describeContents()
-android.car.occupantawareness OccupantAwarenessDetection void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness OccupantAwarenessDetection String toString()
-android.car.occupantawareness OccupantAwarenessManager OccupantAwarenessManager OccupantAwarenessManager(Car car, IBinder service)
-android.car.occupantawareness OccupantAwarenessManager void onCarDisconnected()
-android.car.occupantawareness OccupantAwarenessManager int getCapabilityForRole(int role)
-android.car.occupantawareness OccupantAwarenessManager void registerChangeCallback(ChangeCallback callback)
-android.car.occupantawareness OccupantAwarenessManager void unregisterChangeCallback()
-android.car.occupantawareness Point3D double x
-android.car.occupantawareness Point3D double y
-android.car.occupantawareness Point3D double z
-android.car.occupantawareness Point3D Parcelable.Creator<Point3D> CREATOR
-android.car.occupantawareness Point3D Point3D Point3D(double valueX, double valueY, double valueZ)
-android.car.occupantawareness Point3D int describeContents()
-android.car.occupantawareness Point3D void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness Point3D String toString()
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_READY
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_NOT_SUPPORTED
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_NOT_READY
-android.car.occupantawareness SystemStatusEvent int SYSTEM_STATUS_SYSTEM_FAILURE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_NONE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_PRESENCE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_GAZE
-android.car.occupantawareness SystemStatusEvent int DETECTION_TYPE_DRIVER_MONITORING
-android.car.occupantawareness SystemStatusEvent int systemStatus
-android.car.occupantawareness SystemStatusEvent int detectionType
-android.car.occupantawareness SystemStatusEvent Parcelable.Creator<SystemStatusEvent> CREATOR
-android.car.occupantawareness SystemStatusEvent SystemStatusEvent SystemStatusEvent(int status, int type)
-android.car.occupantawareness SystemStatusEvent SystemStatusEvent SystemStatusEvent()
-android.car.occupantawareness SystemStatusEvent int describeContents()
-android.car.occupantawareness SystemStatusEvent void writeToParcel(Parcel dest, int flags)
-android.car.occupantawareness SystemStatusEvent String toString()
-android.car.oem AudioFocusEntry AudioFocusEntry AudioFocusEntry(android.os.Parcel in)
-android.car.oem OemCarAudioFocusEvaluationRequest OemCarAudioFocusEvaluationRequest OemCarAudioFocusEvaluationRequest(Parcel in)
-android.car.oem OemCarAudioFocusEvaluationRequest OemCarAudioFocusEvaluationRequest OemCarAudioFocusEvaluationRequest(AudioFocusEntry audioFocusEntry, List<CarVolumeGroupInfo> mutedVolumeGroups, List<AudioFocusEntry> focusHolders, List<AudioFocusEntry> focusLosers, int audioZoneId)
-android.car.oem OemCarAudioFocusResult OemCarAudioFocusResult OemCarAudioFocusResult(Parcel in)
-android.car.oem OemCarAudioVolumeRequest OemCarAudioVolumeRequest OemCarAudioVolumeRequest(int audioZoneId, int callState, List<AudioAttributes> activePlaybackAttributes, List<AudioAttributes> duckedAudioAttributes, List<CarVolumeGroupInfo> carVolumeGroupInfos)
-android.car.oem OemCarAudioVolumeRequest.Builder Builder Builder(int audioZoneId)
-android.car.oem OemCarAudioVolumeRequest.Builder Builder Builder(OemCarAudioVolumeRequest volumeRequest)
-android.car.oem OemCarVolumeChangeInfo OemCarVolumeChangeInfo OemCarVolumeChangeInfo(boolean volumeChanged, CarVolumeGroupInfo changedVolumeGroup)
-android.car.os CarPerformanceManager CarPerformanceManager CarPerformanceManager(Car car, IBinder service)
-android.car.os CarPerformanceManager void onCarDisconnected()
-android.car.os CarPerformanceManager void addCpuAvailabilityChangeListener(Executor executor, CpuAvailabilityMonitoringConfig config, CpuAvailabilityChangeListener listener)
-android.car.os CarPerformanceManager void removeCpuAvailabilityChangeListener(Executor executor, CpuAvailabilityChangeListener listener)
-android.car.os CarPerformanceManager.CpuAvailabilityChangeListener void onCpuAvailabilityChange(CpuAvailabilityInfo info)
-android.car.os CpuAvailabilityInfo Parcelable.Creator<CpuAvailabilityInfo> CREATOR
-android.car.os CpuAvailabilityInfo int getCpuset()
-android.car.os CpuAvailabilityInfo int getAverageAvailabilityPercent()
-android.car.os CpuAvailabilityInfo boolean isTimeout()
-android.car.os CpuAvailabilityInfo String toString()
-android.car.os CpuAvailabilityInfo void writeToParcel(android.os.Parcel dest, int flags)
-android.car.os CpuAvailabilityInfo int describeContents()
-android.car.os CpuAvailabilityInfo.Builder Builder Builder(int cpuset, int averageAvailabilityPercent)
-android.car.os CpuAvailabilityInfo.Builder Builder setCpuset(int value)
-android.car.os CpuAvailabilityInfo.Builder Builder setAverageAvailabilityPercent(int value)
-android.car.os CpuAvailabilityInfo.Builder Builder setTimeout(boolean value)
-android.car.os CpuAvailabilityInfo.Builder CpuAvailabilityInfo build()
-android.car.os CpuAvailabilityMonitoringConfig int CPUSET_ALL
-android.car.os CpuAvailabilityMonitoringConfig int CPUSET_BACKGROUND
-android.car.os CpuAvailabilityMonitoringConfig int IGNORE_PERCENT_LOWER_BOUND
-android.car.os CpuAvailabilityMonitoringConfig int IGNORE_PERCENT_UPPER_BOUND
-android.car.os CpuAvailabilityMonitoringConfig int MONITORING_TIMEOUT_NEVER
-android.car.os CpuAvailabilityMonitoringConfig int TIMEOUT_ACTION_NOTIFICATION
-android.car.os CpuAvailabilityMonitoringConfig int TIMEOUT_ACTION_REMOVE
-android.car.os CpuAvailabilityMonitoringConfig Parcelable.Creator<CpuAvailabilityMonitoringConfig> CREATOR
-android.car.os CpuAvailabilityMonitoringConfig String cpusetToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig String ignorePercentToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig String timeoutActionToString(int value)
-android.car.os CpuAvailabilityMonitoringConfig int getCpuset()
-android.car.os CpuAvailabilityMonitoringConfig int getLowerBoundPercent()
-android.car.os CpuAvailabilityMonitoringConfig int getUpperBoundPercent()
-android.car.os CpuAvailabilityMonitoringConfig long getTimeoutInSeconds()
-android.car.os CpuAvailabilityMonitoringConfig int getTimeoutAction()
-android.car.os CpuAvailabilityMonitoringConfig String toString()
-android.car.os CpuAvailabilityMonitoringConfig void writeToParcel(android.os.Parcel dest, int flags)
-android.car.os CpuAvailabilityMonitoringConfig int describeContents()
-android.car.os ThreadPolicyWithPriority String priorityToString(int value)
-android.car.os ThreadPolicyWithPriority String schedToString(int value)
-android.car.projection ProjectionOptions Builder builder()
-android.car.projection ProjectionOptions String toString()
-android.car.projection ProjectionOptions.Builder Builder setProjectionActivityOptions(ActivityOptions activityOptions)
-android.car.projection ProjectionOptions.Builder Builder setUiMode(int uiMode)
-android.car.projection ProjectionOptions.Builder Builder setConsentActivity(ComponentName consentActivity)
-android.car.projection ProjectionOptions.Builder Builder setAccessPointMode(int accessPointMode)
-android.car.projection ProjectionOptions.Builder ProjectionOptions build()
-android.car.settings CarSettings int[] DEFAULT_GARAGE_MODE_WAKE_UP_TIME
-android.car.settings CarSettings int DEFAULT_GARAGE_MODE_MAINTENANCE_WINDOW
-android.car.settings CarSettings.Global String DEFAULT_USER_RESTRICTIONS_SET
-android.car.settings CarSettings.Global String DISABLE_INSTRUMENTATION_SERVICE
-android.car.settings CarSettings.Global String ENABLE_USER_SWITCH_DEVELOPER_MESSAGE
-android.car.settings CarSettings.Global String LAST_ACTIVE_USER_ID
-android.car.settings CarSettings.Global String LAST_ACTIVE_PERSISTENT_USER_ID
-android.car.settings CarSettings.Global String SYSTEM_BAR_VISIBILITY_OVERRIDE
-android.car.settings CarSettings.Secure String KEY_BLUETOOTH_DEVICES
-android.car.settings CarSettings.Secure String KEY_BLUETOOTH_PROFILES_INHIBITED
-android.car.storagemonitoring CarStorageMonitoringManager CarStorageMonitoringManager CarStorageMonitoringManager(Car car, IBinder service)
-android.car.storagemonitoring CarStorageMonitoringManager void onCarDisconnected()
-android.car.storagemonitoring IoStats IoStats IoStats(JSONObject in)
-android.car.storagemonitoring IoStats void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry IoStatsEntry IoStatsEntry(JSONObject in)
-android.car.storagemonitoring IoStatsEntry void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry IoStatsEntry delta(IoStatsEntry other)
-android.car.storagemonitoring IoStatsEntry boolean representsSameMetrics(UidIoRecord record)
-android.car.storagemonitoring IoStatsEntry.Metrics Metrics Metrics(JSONObject in)
-android.car.storagemonitoring IoStatsEntry.Metrics void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring IoStatsEntry.Metrics Metrics delta(Metrics other)
-android.car.storagemonitoring LifetimeWriteInfo LifetimeWriteInfo LifetimeWriteInfo(JSONObject in)
-android.car.storagemonitoring LifetimeWriteInfo void writeToJson(JsonWriter jsonWriter)
-android.car.storagemonitoring UidIoRecord UidIoRecord delta(IoStatsEntry other)
-android.car.storagemonitoring UidIoRecord UidIoRecord delta(UidIoRecord other)
-android.car.storagemonitoring WearEstimate WearEstimate UNKNOWN_ESTIMATE
-android.car.storagemonitoring WearEstimate WearEstimate WearEstimate(JsonReader in)
-android.car.storagemonitoring WearEstimate WearEstimate WearEstimate(JSONObject in)
-android.car.storagemonitoring WearEstimate void writeToJson(JsonWriter jsonWriter)
-android.car.telemetry CarTelemetryManager CarTelemetryManager CarTelemetryManager(Car car, IBinder service)
-android.car.telemetry CarTelemetryManager void onCarDisconnected()
-android.car.test CarLocationTestHelper boolean injectLocation(Location location, Context context)
-android.car.test CarTestManager CarTestManager CarTestManager(Car car, IBinder carServiceBinder)
-android.car.test CarTestManager void onCarDisconnected()
-android.car.test CarTestManager void stopCarService(IBinder token)
-android.car.test CarTestManager void startCarService(IBinder token)
-android.car.test CarTestManager String getOemServiceName()
-android.car.user CarUserManager String TAG
-android.car.user CarUserManager int USER_LIFECYCLE_EVENT_TYPE_POST_UNLOCKED
-android.car.user CarUserManager String BUNDLE_PARAM_ACTION
-android.car.user CarUserManager String BUNDLE_PARAM_PREVIOUS_USER_ID
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_KEY_FOB
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_1
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_2
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_3
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_4
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_ASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_DISASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_DISASSOCIATE_ALL_USERS
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_UNKNOWN
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_ASSOCIATE_CURRENT_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_ASSOCIATED_ANOTHER_USER
-android.car.user CarUserManager int USER_IDENTIFICATION_ASSOCIATION_VALUE_NOT_ASSOCIATED_ANY_USER
-android.car.user CarUserManager CarUserManager CarUserManager(Car car, IBinder service)
-android.car.user CarUserManager CarUserManager CarUserManager(Car car, ICarUserService service, UserManager userManager)
-android.car.user CarUserManager AsyncFuture<UserSwitchResult> switchUser(int targetUserId)
-android.car.user CarUserManager AsyncFuture<UserSwitchResult> logoutUser()
-android.car.user CarUserManager AsyncFuture<UserCreationResult> createGuest(String name)
-android.car.user CarUserManager AsyncFuture<UserCreationResult> createUser(String name, int flags)
-android.car.user CarUserManager void updatePreCreatedUsers()
-android.car.user CarUserManager UserRemovalResult removeUser(int userId)
-android.car.user CarUserManager boolean isUserHalUserAssociationSupported()
-android.car.user CarUserManager UserIdentificationAssociationResponse getUserIdentificationAssociation(int types)
-android.car.user CarUserManager AsyncFuture<UserIdentificationAssociationResponse> setUserIdentificationAssociation(int[] types, int[] values)
-android.car.user CarUserManager void setUserSwitchUiCallback(UserSwitchUiCallback callback)
-android.car.user CarUserManager void onCarDisconnected()
-android.car.user CarUserManager String lifecycleEventTypeToString(int type)
-android.car.user CarUserManager boolean isValidUser(int userId)
-android.car.user CarUserManager.UserLifecycleEvent UserLifecycleEvent UserLifecycleEvent(int eventType, int from, int to)
-android.car.user CarUserManager.UserLifecycleEvent UserLifecycleEvent UserLifecycleEvent(int eventType, int to)
-android.car.user CarUserManager.UserLifecycleEvent int getUserId()
-android.car.user CarUserManager.UserLifecycleEvent int getPreviousUserId()
-android.car.user CarUserManager.UserSwitchUiCallback void showUserSwitchDialog(int userId)
-android.car.user ExperimentalCarUserManager String TAG
-android.car.user ExperimentalCarUserManager ExperimentalCarUserManager ExperimentalCarUserManager(Car car, IBinder service)
-android.car.user ExperimentalCarUserManager ExperimentalCarUserManager ExperimentalCarUserManager(Car car, IExperimentalCarUserService service)
-android.car.user ExperimentalCarUserManager AndroidFuture<UserCreationResult> createDriver(String name, boolean admin)
-android.car.user ExperimentalCarUserManager int createPassenger(String name, int driverId)
-android.car.user ExperimentalCarUserManager AndroidFuture<UserSwitchResult> switchDriver(int driverId)
-android.car.user ExperimentalCarUserManager List<Integer> getAllDrivers()
-android.car.user ExperimentalCarUserManager List<Integer> getPassengers(int driverId)
-android.car.user ExperimentalCarUserManager boolean startPassenger(int passengerId, int zoneId)
-android.car.user ExperimentalCarUserManager boolean stopPassenger(int passengerId)
-android.car.user ExperimentalCarUserManager void onCarDisconnected()
-android.car.user OperationResult boolean isSuccess()
-android.car.user UserCreationResult int STATUS_SUCCESSFUL
-android.car.user UserCreationResult int STATUS_ANDROID_FAILURE
-android.car.user UserCreationResult int STATUS_HAL_FAILURE
-android.car.user UserCreationResult int STATUS_HAL_INTERNAL_FAILURE
-android.car.user UserCreationResult int STATUS_INVALID_REQUEST
-android.car.user UserCreationResult Parcelable.Creator<UserCreationResult> CREATOR
-android.car.user UserCreationResult UserCreationResult UserCreationResult(int status)
-android.car.user UserCreationResult UserCreationResult UserCreationResult(int status, UserHandle user)
-android.car.user UserCreationResult UserCreationResult UserCreationResult(int status, Integer androidFailureStatus, UserHandle user, String errorMessage, String internalErrorMessage)
-android.car.user UserCreationResult boolean isSuccess()
-android.car.user UserCreationResult int describeContents()
-android.car.user UserCreationResult String statusToString(int value)
-android.car.user UserCreationResult int getStatus()
-android.car.user UserCreationResult Integer getAndroidFailureStatus()
-android.car.user UserCreationResult UserHandle getUser()
-android.car.user UserCreationResult String getErrorMessage()
-android.car.user UserCreationResult String getInternalErrorMessage()
-android.car.user UserCreationResult String toString()
-android.car.user UserCreationResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserIdentificationAssociationResponse Parcelable.Creator<UserIdentificationAssociationResponse> CREATOR
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forFailure()
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forFailure(String errorMessage)
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forSuccess(int[] values)
-android.car.user UserIdentificationAssociationResponse UserIdentificationAssociationResponse forSuccess(int[] values, String errorMessage)
-android.car.user UserIdentificationAssociationResponse boolean isSuccess()
-android.car.user UserIdentificationAssociationResponse String getErrorMessage()
-android.car.user UserIdentificationAssociationResponse int[] getValues()
-android.car.user UserIdentificationAssociationResponse String toString()
-android.car.user UserIdentificationAssociationResponse void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserIdentificationAssociationResponse int describeContents()
-android.car.user UserLifecycleEventFilter int[] getEventTypes()
-android.car.user UserLifecycleEventFilter int[] getUserIds()
-android.car.user UserLifecycleEventFilter.Builder Builder addEventType(int eventType)
-android.car.user UserLifecycleEventFilter.Builder Builder addUser(UserHandle userHandle)
-android.car.user UserLifecycleEventFilter.Builder UserLifecycleEventFilter build()
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL
-android.car.user UserRemovalResult int STATUS_ANDROID_FAILURE
-android.car.user UserRemovalResult int STATUS_INVALID_REQUEST
-android.car.user UserRemovalResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_LAST_ADMIN_REMOVED
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_SET_EPHEMERAL
-android.car.user UserRemovalResult int STATUS_SUCCESSFUL_LAST_ADMIN_SET_EPHEMERAL
-android.car.user UserRemovalResult Parcelable.Creator<UserRemovalResult> CREATOR
-android.car.user UserRemovalResult UserRemovalResult UserRemovalResult(int status)
-android.car.user UserRemovalResult boolean isSuccess()
-android.car.user UserRemovalResult String statusToString(int value)
-android.car.user UserRemovalResult int getStatus()
-android.car.user UserRemovalResult String toString()
-android.car.user UserRemovalResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserRemovalResult int describeContents()
-android.car.user UserStartResult int STATUS_SUCCESSFUL
-android.car.user UserStartResult int STATUS_ANDROID_FAILURE
-android.car.user UserStartResult int STATUS_SUCCESSFUL_USER_IS_CURRENT_USER
-android.car.user UserStartResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserStartResult Parcelable.Creator<UserStartResult> CREATOR
-android.car.user UserStartResult UserStartResult UserStartResult(int status)
-android.car.user UserStartResult boolean isSuccess()
-android.car.user UserStartResult String statusToString(int value)
-android.car.user UserStartResult int getStatus()
-android.car.user UserStartResult String toString()
-android.car.user UserStartResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserStartResult int describeContents()
-android.car.user UserStopResult int STATUS_SUCCESSFUL
-android.car.user UserStopResult int STATUS_ANDROID_FAILURE
-android.car.user UserStopResult int STATUS_USER_DOES_NOT_EXIST
-android.car.user UserStopResult int STATUS_FAILURE_SYSTEM_USER
-android.car.user UserStopResult int STATUS_FAILURE_CURRENT_USER
-android.car.user UserStopResult Parcelable.Creator<UserStopResult> CREATOR
-android.car.user UserStopResult UserStopResult UserStopResult(int status)
-android.car.user UserStopResult boolean isSuccess(int status)
-android.car.user UserStopResult boolean isSuccess()
-android.car.user UserStopResult String statusToString(int value)
-android.car.user UserStopResult int getStatus()
-android.car.user UserStopResult String toString()
-android.car.user UserStopResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.user UserStopResult int describeContents()
-android.car.user UserSwitchResult int STATUS_SUCCESSFUL
-android.car.user UserSwitchResult int STATUS_ANDROID_FAILURE
-android.car.user UserSwitchResult int STATUS_HAL_FAILURE
-android.car.user UserSwitchResult int STATUS_HAL_INTERNAL_FAILURE
-android.car.user UserSwitchResult int STATUS_INVALID_REQUEST
-android.car.user UserSwitchResult int STATUS_UX_RESTRICTION_FAILURE
-android.car.user UserSwitchResult int STATUS_OK_USER_ALREADY_IN_FOREGROUND
-android.car.user UserSwitchResult int STATUS_TARGET_USER_ALREADY_BEING_SWITCHED_TO
-android.car.user UserSwitchResult int STATUS_TARGET_USER_ABANDONED_DUE_TO_A_NEW_REQUEST
-android.car.user UserSwitchResult int STATUS_NOT_SWITCHABLE
-android.car.user UserSwitchResult int STATUS_NOT_LOGGED_IN
-android.car.user UserSwitchResult Parcelable.Creator<UserSwitchResult> CREATOR
-android.car.user UserSwitchResult UserSwitchResult UserSwitchResult(int status, String errorMessage)
-android.car.user UserSwitchResult UserSwitchResult UserSwitchResult(int status, Integer androidFailureStatus, String errorMessage)
-android.car.user UserSwitchResult boolean isSuccess()
-android.car.user UserSwitchResult int describeContents()
-android.car.user UserSwitchResult String statusToString(int value)
-android.car.user UserSwitchResult int getStatus()
-android.car.user UserSwitchResult Integer getAndroidFailureStatus()
-android.car.user UserSwitchResult String getErrorMessage()
-android.car.user UserSwitchResult String toString()
-android.car.user UserSwitchResult void writeToParcel(android.os.Parcel dest, int flags)
-android.car.util.concurrent AndroidAsyncFuture AndroidAsyncFuture AndroidAsyncFuture(AndroidFuture<T> future)
-android.car.util.concurrent AndroidAsyncFuture T get()
-android.car.util.concurrent AndroidAsyncFuture T get(long timeout, TimeUnit unit)
-android.car.util.concurrent AndroidAsyncFuture AsyncFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor)
-android.car.util.concurrent AndroidFuture Parcelable.Creator<AndroidFuture> CREATOR
-android.car.util.concurrent AndroidFuture AndroidFuture AndroidFuture()
-android.car.util.concurrent AndroidFuture AndroidFuture<U> completedFuture(U value)
-android.car.util.concurrent AndroidFuture boolean complete(T value)
-android.car.util.concurrent AndroidFuture boolean completeExceptionally(Throwable ex)
-android.car.util.concurrent AndroidFuture boolean cancel(boolean mayInterruptIfRunning)
-android.car.util.concurrent AndroidFuture void onCompleted(T res, Throwable err)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> whenComplete(BiConsumer<? super T,? super Throwable> action)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> orTimeout(long timeout, TimeUnit unit)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> cancelTimeout()
-android.car.util.concurrent AndroidFuture AndroidFuture<T> setTimeoutHandler(Handler h)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenCompose(Function<? super T,? extends CompletionStage<U>> fn)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenComposeAsync(Function<? super T,? extends CompletionStage<U>> fn, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenApply(Function<? super T,? extends U> fn)
-android.car.util.concurrent AndroidFuture AndroidFuture<U> thenApplyAsync(Function<? super T,? extends U> fn, Executor executor)
-android.car.util.concurrent AndroidFuture AndroidFuture<V> thenCombine(CompletionStage<? extends U> other, BiFunction<? super T,? super U,? extends V> combineResults)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> thenCombine(CompletionStage<Void> other)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> supply(Supplier<T> supplier)
-android.car.util.concurrent AndroidFuture AndroidFuture<T> supplyAsync(Supplier<T> supplier, Executor executor)
-android.car.util.concurrent AndroidFuture void writeToParcel(Parcel dest, int flags)
-android.car.util.concurrent AndroidFuture int describeContents()
-android.car.util.concurrent AsyncFuture T get()
-android.car.util.concurrent AsyncFuture T get(long timeout, TimeUnit unit)
-android.car.util.concurrent AsyncFuture AsyncFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor)
-android.car.vms VmsClient VmsClient VmsClient(IVmsBrokerService service, Executor executor, VmsClientCallback callback, boolean legacyClient, boolean autoCloseMemory, Consumer<RemoteException> exceptionHandler)
-android.car.vms VmsClient void register()
-android.car.vms VmsClient void unregister()
-android.car.vms VmsClientManager VmsClientManager VmsClientManager(Car car, IBinder service)
-android.car.vms VmsClientManager void onCarDisconnected()
-android.car.vms VmsOperationRecorder VmsOperationRecorder VmsOperationRecorder(Writer writer)
-android.car.vms VmsOperationRecorder.Writer boolean isEnabled()
-android.car.vms VmsOperationRecorder.Writer void write(String msg)
-android.car.vms VmsProviderInfo Parcelable.Creator<VmsProviderInfo> CREATOR
-android.car.vms VmsProviderInfo VmsProviderInfo VmsProviderInfo(byte[] description)
-android.car.vms VmsProviderInfo VmsProviderInfo VmsProviderInfo(Parcel in)
-android.car.vms VmsProviderInfo byte[] getDescription()
-android.car.vms VmsProviderInfo boolean equals(Object o)
-android.car.vms VmsProviderInfo int hashCode()
-android.car.vms VmsProviderInfo void writeToParcel(Parcel dest, int flags)
-android.car.vms VmsProviderInfo int describeContents()
-android.car.vms VmsPublisherClientService void onCarLifecycleChanged(Car car, boolean ready)
-android.car.vms VmsRegistrationInfo Parcelable.Creator<VmsRegistrationInfo> CREATOR
-android.car.vms VmsRegistrationInfo VmsRegistrationInfo VmsRegistrationInfo(VmsAvailableLayers availableLayers, VmsSubscriptionState subscriptionState)
-android.car.vms VmsRegistrationInfo VmsRegistrationInfo VmsRegistrationInfo(Parcel in)
-android.car.vms VmsRegistrationInfo VmsAvailableLayers getAvailableLayers()
-android.car.vms VmsRegistrationInfo VmsSubscriptionState getSubscriptionState()
-android.car.vms VmsRegistrationInfo boolean equals(Object o)
-android.car.vms VmsRegistrationInfo int hashCode()
-android.car.vms VmsRegistrationInfo void writeToParcel(Parcel dest, int flags)
-android.car.vms VmsRegistrationInfo int describeContents()
-android.car.vms VmsSubscriberManager VmsSubscriberManager wrap(Car car, VmsClientManager clientManager)
-android.car.vms VmsSubscriberManager void onCarDisconnected()
-android.car.vms VmsSubscriptionHelper VmsSubscriptionHelper VmsSubscriptionHelper(Consumer<Set<VmsAssociatedLayer>> updateHandler)
-android.car.vms VmsSubscriptionHelper void subscribe(VmsLayer layer)
-android.car.vms VmsSubscriptionHelper void subscribe(VmsLayer layer, int providerId)
-android.car.vms VmsSubscriptionHelper void unsubscribe(VmsLayer layer)
-android.car.vms VmsSubscriptionHelper void unsubscribe(VmsLayer layer, int providerId)
-android.car.vms VmsSubscriptionHelper Set<VmsAssociatedLayer> getSubscriptions()
-android.car.watchdog CarWatchdogManager CarWatchdogManager CarWatchdogManager(Car car, IBinder service)
-android.car.watchdog CarWatchdogManager void onCarDisconnected()
-android.car.watchdog IoOveruseAlertThreshold IoOveruseAlertThreshold IoOveruseAlertThreshold(long durationInSeconds, long writtenBytesPerSecond)
-android.car.watchdog IoOveruseStats.Builder Builder Builder(long startTime, long durationInSeconds)
-android.car.watchdog IoOveruseStats.Builder Builder setStartTime(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setDurationInSeconds(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalOveruses(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalTimesKilled(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setTotalBytesWritten(long value)
-android.car.watchdog IoOveruseStats.Builder Builder setKillableOnOveruse(boolean value)
-android.car.watchdog IoOveruseStats.Builder Builder setRemainingWriteBytes(PerStateBytes value)
-android.car.watchdog IoOveruseStats.Builder IoOveruseStats build()
-android.car.watchdog PackageKillableState PackageKillableState PackageKillableState(String packageName, int userId, int killableState)
-android.car.watchdog PackageKillableState String killableStateToString(int value)
-android.car.watchdog ResourceOveruseConfiguration String componentTypeToString(int value)
-android.car.watchdog ResourceOveruseStats.Builder Builder Builder(String packageName, UserHandle userHandle)
-android.car.watchdog ResourceOveruseStats.Builder Builder setPackageName(String value)
-android.car.watchdog ResourceOveruseStats.Builder Builder setUserHandle(UserHandle value)
-android.car.watchdog ResourceOveruseStats.Builder Builder setIoOveruseStats(IoOveruseStats value)
-android.car.watchdog ResourceOveruseStats.Builder ResourceOveruseStats build()
diff --git a/tests/carservice_test/res/xml/test_car_volume_groups.xml b/tests/carservice_unit_test/res/xml/test_car_volume_groups.xml
similarity index 100%
rename from tests/carservice_test/res/xml/test_car_volume_groups.xml
rename to tests/carservice_unit_test/res/xml/test_car_volume_groups.xml
diff --git a/tests/carservice_unit_test/src/com/android/car/AbstractICarServiceHelperStub.java b/tests/carservice_unit_test/src/com/android/car/AbstractICarServiceHelperStub.java
index e57a67c6f8..87ff4ca714 100644
--- a/tests/carservice_unit_test/src/com/android/car/AbstractICarServiceHelperStub.java
+++ b/tests/carservice_unit_test/src/com/android/car/AbstractICarServiceHelperStub.java
@@ -114,9 +114,25 @@ abstract class AbstractICarServiceHelperStub extends ICarServiceHelper.Stub {
         return UserHandle.USER_NULL;
     }
 
+    @Override
+    public boolean assignUserToExtraDisplay(int userId, int displayId) {
+        Log.d(TAG, "assignUserToExtraDisplay(userId=" + userId
+                + ", displayId=" + displayId + ")");
+
+        return false;
+    }
+
+    @Override
+    public boolean unassignUserFromExtraDisplay(int userId, int displayId) {
+        Log.d(TAG, "unassignUserFromExtraDisplay(userId=" + userId
+                + ", displayId=" + displayId + ")");
+
+        return false;
+    }
+
     @Override
     public boolean startUserInBackgroundVisibleOnDisplay(int userId, int displayId) {
-        Log.d(TAG, "startUserInBackgroundVisibleOnDisplay(" + userId + ",displaId" + displayId
+        Log.d(TAG, "startUserInBackgroundVisibleOnDisplay(" + userId + ",displayId" + displayId
                 + ")");
 
         return false;
diff --git a/tests/carservice_unit_test/src/android/car/BinderInterfaceContainerTest.java b/tests/carservice_unit_test/src/com/android/car/BinderInterfaceContainerTest.java
similarity index 96%
rename from tests/carservice_unit_test/src/android/car/BinderInterfaceContainerTest.java
rename to tests/carservice_unit_test/src/com/android/car/BinderInterfaceContainerTest.java
index 130229216a..863059de30 100644
--- a/tests/carservice_unit_test/src/android/car/BinderInterfaceContainerTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/BinderInterfaceContainerTest.java
@@ -14,7 +14,7 @@
  * limitations under the License.
  */
 
-package android.car;
+package com.android.car;
 
 import static com.google.common.truth.Truth.assertThat;
 
@@ -23,7 +23,6 @@ import android.os.IInterface;
 
 import androidx.test.ext.junit.runners.AndroidJUnit4;
 
-import com.android.car.BinderInterfaceContainer;
 import com.android.car.BinderInterfaceContainer.BinderInterface;
 
 import org.junit.Test;
diff --git a/tests/carservice_unit_test/src/com/android/car/CarBugreportManagerServiceTest.java b/tests/carservice_unit_test/src/com/android/car/CarBugreportManagerServiceTest.java
index cd3ee29ae8..33666c9999 100644
--- a/tests/carservice_unit_test/src/com/android/car/CarBugreportManagerServiceTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/CarBugreportManagerServiceTest.java
@@ -236,38 +236,6 @@ public class CarBugreportManagerServiceTest {
         verify(() -> SystemPropertiesHelper.set("ctl.stop", DUMPSTATEZ_SERVICE));
     }
 
-    @Test
-    public void test_requestBugreport_failsIfNotSignedWithPlatformKeys() {
-        mService = new CarBugreportManagerService(mMockContext);
-        mService.init();
-        when(mMockPackageManager.checkSignatures(anyInt(), anyInt()))
-                .thenReturn(PackageManager.SIGNATURE_NO_MATCH);
-        when(mMockPackageManager.getNameForUid(anyInt())).thenReturn("current_app_name");
-
-        SecurityException expected =
-                assertThrows(SecurityException.class,
-                        () -> mService.requestBugreport(mMockOutput, mMockExtraOutput,
-                                mMockCallback, DUMPSTATE_DRY_RUN));
-
-        assertThat(expected).hasMessageThat().contains(
-                "Caller current_app_name does not have the right signature");
-    }
-
-    @Test
-    public void testCancelBugreport_failsIfNotSignedWithPlatformKeys() {
-        mService = new CarBugreportManagerService(mMockContext);
-        mService.init();
-        when(mMockPackageManager.checkSignatures(anyInt(), anyInt()))
-                .thenReturn(PackageManager.SIGNATURE_NO_MATCH);
-        when(mMockPackageManager.getNameForUid(anyInt())).thenReturn("current_app_name");
-
-        SecurityException expected =
-                assertThrows(SecurityException.class, () -> mService.cancelBugreport());
-
-        assertThat(expected).hasMessageThat().contains(
-                "Caller current_app_name does not have the right signature");
-    }
-
     private void mockDesignatedBugReportApp() {
         when(mMockPackageManager.checkSignatures(anyInt(), anyInt()))
                 .thenReturn(PackageManager.SIGNATURE_MATCH);
diff --git a/tests/carservice_unit_test/src/com/android/car/CarInputServiceTest.java b/tests/carservice_unit_test/src/com/android/car/CarInputServiceTest.java
index 0f4f7d243a..3e117be871 100644
--- a/tests/carservice_unit_test/src/com/android/car/CarInputServiceTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/CarInputServiceTest.java
@@ -42,12 +42,16 @@ import static org.mockito.Mockito.never;
 import static org.mockito.Mockito.times;
 import static org.mockito.Mockito.when;
 
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothManager;
 import android.car.CarOccupantZoneManager;
 import android.car.CarOccupantZoneManager.OccupantZoneInfo;
 import android.car.CarProjectionManager;
 import android.car.VehicleAreaSeat;
 import android.car.builtin.util.AssistUtilsHelper;
 import android.car.builtin.util.AssistUtilsHelper.VoiceInteractionSessionShowCallbackHelper;
+import android.car.drivingstate.CarDrivingStateEvent;
+import android.car.feature.Flags;
 import android.car.input.CarInputManager;
 import android.car.input.CustomInputEvent;
 import android.car.input.ICarInputCallback;
@@ -63,6 +67,9 @@ import android.os.Looper;
 import android.os.Message;
 import android.os.SystemClock;
 import android.os.UserHandle;
+import android.platform.test.annotations.RequiresFlagsEnabled;
+import android.platform.test.flag.junit.CheckFlagsRule;
+import android.platform.test.flag.junit.DeviceFlagsValueProvider;
 import android.provider.Settings;
 import android.telecom.TelecomManager;
 import android.view.KeyEvent;
@@ -82,6 +89,7 @@ import com.google.common.collect.Range;
 import org.junit.After;
 import org.junit.Assert;
 import org.junit.Before;
+import org.junit.Rule;
 import org.junit.Test;
 import org.mockito.ArgumentCaptor;
 import org.mockito.Mock;
@@ -107,10 +115,13 @@ public final class CarInputServiceTest extends AbstractExtendedMockitoTestCase {
     @Mock InputCaptureClientController mCaptureController;
     @Mock CarOccupantZoneService mCarOccupantZoneService;
     @Mock CarBluetoothService mCarBluetoothService;
+    @Mock CarDrivingStateService mMockCarDrivingStateService;
     @Mock CarPowerManagementService mCarPowerManagementService;
     @Mock SystemInterface mSystemInterface;
     @Mock CarAudioService mCarAudioService;
     @Mock CarMediaService mCarMediaService;
+    @Mock BluetoothManager mMockBluetoothManager;
+    @Mock BluetoothAdapter mMockBluetoothAdapter;
 
     @Spy Context mContext = ApplicationProvider.getApplicationContext();
     @Mock private Resources mMockResources;
@@ -132,6 +143,9 @@ public final class CarInputServiceTest extends AbstractExtendedMockitoTestCase {
     private static final int DRIVER_SEAT = VehicleAreaSeat.SEAT_ROW_1_LEFT;
     private static final int PASSENGER_SEAT = VehicleAreaSeat.SEAT_ROW_1_RIGHT;
 
+    @Rule
+    public final CheckFlagsRule mCheckFlagsRule = DeviceFlagsValueProvider.createCheckFlagsRule();
+
     // CarInputService#sDefaultShowCallback() prints out some Slog message which can be conflicted
     // with AbstractExtendedMockitoTestCase#interceptWtfCalls (b/294138315).
     private static final VoiceInteractionSessionShowCallbackHelper sShowCallback =
@@ -168,6 +182,8 @@ public final class CarInputServiceTest extends AbstractExtendedMockitoTestCase {
 
         when(mContext.getResources()).thenReturn(mMockResources);
 
+        mockEnableLongPressBluetoothPairingProperty(false);
+
         setUpCarOccupantZoneService();
         setUpService();
         mCarInputService.init();
@@ -203,6 +219,9 @@ public final class CarInputServiceTest extends AbstractExtendedMockitoTestCase {
         CarLocalServices.addService(CarAudioService.class, mCarAudioService);
         CarLocalServices.removeServiceForTest(CarMediaService.class);
         CarLocalServices.addService(CarMediaService.class, mCarMediaService);
+        CarLocalServices.removeServiceForTest(CarDrivingStateService.class);
+        CarLocalServices.addService(CarDrivingStateService.class, mMockCarDrivingStateService);
+
     }
 
     @After
@@ -213,6 +232,7 @@ public final class CarInputServiceTest extends AbstractExtendedMockitoTestCase {
 
         CarLocalServices.removeServiceForTest(CarAudioService.class);
         CarLocalServices.removeServiceForTest(CarMediaService.class);
+        CarLocalServices.removeServiceForTest(CarDrivingStateService.class);
     }
 
     @Test
@@ -629,6 +649,96 @@ public final class CarInputServiceTest extends AbstractExtendedMockitoTestCase {
         verify(mCarBluetoothService, times(1)).startBluetoothVoiceRecognition();
     }
 
+    /**
+     * Testing long press triggers Bluetooth pairing flow.
+     *
+     * Based on current implementation of {@link CarInputService#handleVoiceAssistLongPress},
+     * long press of the button should trigger Bluetooth pairing flow if:
+     *   (a) {@link CarProjectionManager.ProjectionKeyEventHandler} did not subscribe for the
+     *       event, or if the key event handler does not exit; and
+     *   (b) Bluetooth voice recognition is disabled.
+     *   (c) enableLongPressBluetoothPairing is enabled.
+     *   (d) No Bluetooth devices are connected.
+     *
+     * Preconditions:
+     *     - enableLongPressBluetoothPairing is enabled.
+     *     - No {@link CarProjectionManager.ProjectionKeyEventHandler} registered for the key event.
+     *     - Bluetooth voice recognition is disabled.
+     *     - No Bluetooth devices are connected.
+     * Action:
+     *     - Long press the voice assistant key.
+     * Results:
+     *     - A intent with ACTION_BLUETOOTH_SETTINGS is sent.
+     */
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_CAR_INPUT_START_BTPAIRING_LPTT)
+    public void voiceKey_longPress_bluetoothPairingIsEnabled_triggersBluetoothPairing() {
+
+        ArgumentCaptor<Intent> intentCaptor = ArgumentCaptor.forClass(Intent.class);
+
+        mockEnableLongPressBluetoothVoiceRecognitionProperty(false);
+        mockEnableLongPressBluetoothPairingProperty(true);
+
+        when(mContext.getSystemService(BluetoothManager.class)).thenReturn(mMockBluetoothManager);
+        when(mMockBluetoothManager.getAdapter()).thenReturn(mMockBluetoothAdapter);
+        when(mMockBluetoothAdapter.getConnectionState()).thenReturn(
+                BluetoothAdapter.STATE_DISCONNECTED);
+
+        doNothing().when(mContext).startActivityAsUser(any(), any());
+
+        send(Key.DOWN, KeyEvent.KEYCODE_VOICE_ASSIST, Display.MAIN);
+        flushHandler();
+        send(Key.UP, KeyEvent.KEYCODE_VOICE_ASSIST, Display.MAIN);
+
+        verify(mContext).startActivityAsUser(
+                intentCaptor.capture(), eq(UserHandle.CURRENT));
+        assertThat(intentCaptor.getValue().getAction())
+                .isEqualTo(Settings.ACTION_BLUETOOTH_SETTINGS);
+    }
+
+    /**
+     * Testing long press not triggers pairing flow if there are Bluetooth device connected.
+     *
+     * Based on current implementation of {@link CarInputService#handleVoiceAssistLongPress},
+     * long press of the button should not trigger Bluetooth pairing flow if:
+     *   (a) {@link CarProjectionManager.ProjectionKeyEventHandler} did not subscribe for the
+     *       event, or if the key event handler does not exit; and
+     *   (b) Bluetooth voice recognition is disabled.
+     *   (c) enableLongPressBluetoothPairing is enabled.
+     *   (d) If there are Bluetooth device connected
+     *
+     * Preconditions:
+     *     - enableLongPressBluetoothPairing is enabled.
+     *     - No {@link CarProjectionManager.ProjectionKeyEventHandler} registered for the key event.
+     *     - Bluetooth voice recognition is disabled.
+     *     - Bluetooth devices are connected.
+     * Action:
+     *     - Long press the voice assistant key.
+     * Results:
+     *     - No intent sent.
+     */
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_CAR_INPUT_START_BTPAIRING_LPTT)
+    public void voiceKey_longPress_bluetoothPairingIsEnabled_not_triggersBluetoothPairing() {
+
+        mockEnableLongPressBluetoothVoiceRecognitionProperty(false);
+        mockEnableLongPressBluetoothPairingProperty(true);
+
+        when(mContext.getSystemService(BluetoothManager.class)).thenReturn(mMockBluetoothManager);
+        when(mMockBluetoothManager.getAdapter()).thenReturn(mMockBluetoothAdapter);
+        when(mMockBluetoothAdapter.getConnectionState()).thenReturn(
+                BluetoothAdapter.STATE_CONNECTED);
+
+        doNothing().when(mContext).startActivityAsUser(any(), any());
+
+        send(Key.DOWN, KeyEvent.KEYCODE_VOICE_ASSIST, Display.MAIN);
+        flushHandler();
+        send(Key.UP, KeyEvent.KEYCODE_VOICE_ASSIST, Display.MAIN);
+
+        verify(mContext, never()).startActivityAsUser(any(), any());
+    }
+
+
     /**
      * Testing short press does not trigger Bluetooth voice recognition.
      *
@@ -1366,4 +1476,9 @@ public final class CarInputServiceTest extends AbstractExtendedMockitoTestCase {
         when(mMockResources.getBoolean(R.bool.enableLongPressBluetoothVoiceRecognition))
                 .thenReturn(enabledOrNot);
     }
+
+    private void mockEnableLongPressBluetoothPairingProperty(boolean enabledOrNot) {
+        when(mMockResources.getBoolean(R.bool.config_enableLongPressBluetoothPairing))
+                .thenReturn(enabledOrNot);
+    }
 }
diff --git a/tests/carservice_unit_test/src/com/android/car/CarProjectionServiceTest.java b/tests/carservice_unit_test/src/com/android/car/CarProjectionServiceTest.java
index 1f3f9def67..c588180c96 100644
--- a/tests/carservice_unit_test/src/com/android/car/CarProjectionServiceTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/CarProjectionServiceTest.java
@@ -22,6 +22,7 @@ import static android.car.projection.ProjectionStatus.PROJECTION_STATE_ACTIVE_FO
 import static android.car.projection.ProjectionStatus.PROJECTION_STATE_INACTIVE;
 import static android.car.projection.ProjectionStatus.PROJECTION_TRANSPORT_USB;
 import static android.car.projection.ProjectionStatus.PROJECTION_TRANSPORT_WIFI;
+import static android.net.wifi.WifiAvailableChannel.OP_MODE_SAP;
 
 import static com.google.common.truth.Truth.assertThat;
 
@@ -38,6 +39,7 @@ import android.bluetooth.BluetoothDevice;
 import android.car.CarProjectionManager;
 import android.car.ICarProjectionKeyEventHandler;
 import android.car.ICarProjectionStatusListener;
+import android.car.feature.FeatureFlags;
 import android.car.projection.ProjectionOptions;
 import android.car.projection.ProjectionStatus;
 import android.car.projection.ProjectionStatus.MobileDevice;
@@ -47,6 +49,7 @@ import android.content.res.Resources;
 import android.graphics.Rect;
 import android.net.MacAddress;
 import android.net.wifi.SoftApConfiguration;
+import android.net.wifi.WifiAvailableChannel;
 import android.net.wifi.WifiManager;
 import android.net.wifi.WifiScanner;
 import android.os.Binder;
@@ -72,6 +75,7 @@ import org.mockito.Mockito;
 import org.mockito.Spy;
 import org.mockito.junit.MockitoJUnitRunner;
 
+import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.BitSet;
 import java.util.List;
@@ -126,6 +130,9 @@ public class CarProjectionServiceTest {
     @Mock
     private Messenger mMessenger;
 
+    @Mock
+    private FeatureFlags mFeatureFlags;
+
     @Before
     public void setUp() {
         when(mContext.getSystemService(eq(WifiManager.class)))
@@ -145,9 +152,11 @@ public class CarProjectionServiceTest {
                 .thenReturn(false);
         when(mResources.getBoolean(com.android.car.R.bool.config_projectionAccessPointTethering))
                 .thenReturn(false);
+        when(mFeatureFlags.useWifiManagerForAvailableChannels()).thenReturn(false);
 
         mService = new CarProjectionService(mContext, mHandler, mCarInputService,
                 mCarBluetoothService);
+        mService.setFeatureFlags(mFeatureFlags);
 
         when(mLohsReservation.getSoftApConfiguration()).thenReturn(AP_CONFIG);
         mService.setAccessPointBssid(AP_CONFIG.getBssid());
@@ -405,6 +414,24 @@ public class CarProjectionServiceTest {
         assertThat(wifiChannels).asList().containsExactlyElementsIn(expectedWifiChannels);
     }
 
+    @Test
+    public void getWifiChannels_wifiManagerFeatureOn_useWifiManager() {
+        when(mFeatureFlags.useWifiManagerForAvailableChannels()).thenReturn(true);
+
+        List<Integer> expectedWifiChannels = Arrays.asList(2400, 5600);
+        List<WifiAvailableChannel> wifiAvailableChannels = new ArrayList<>();
+        for (int i = 0; i < expectedWifiChannels.size(); i++) {
+            int freq = expectedWifiChannels.get(i);
+            wifiAvailableChannels.add(new WifiAvailableChannel(freq, OP_MODE_SAP));
+        }
+        when(mWifiManager.getUsableChannels(anyInt(), anyInt())).thenReturn(wifiAvailableChannels);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mWifiManager);
+
+        int[] wifiChannels = mService.getAvailableWifiChannels(WifiScanner.WIFI_BAND_BOTH_WITH_DFS);
+        assertThat(wifiChannels).isNotNull();
+        assertThat(wifiChannels).asList().containsExactlyElementsIn(expectedWifiChannels);
+    }
+
     @Test
     public void addedKeyEventHandler_getsDispatchedEvents() throws RemoteException {
         ICarProjectionKeyEventHandler eventHandler = createMockKeyEventHandler();
diff --git a/tests/carservice_unit_test/src/com/android/car/OccupantZoneHelper.java b/tests/carservice_unit_test/src/com/android/car/OccupantZoneHelper.java
index d682f0cc77..2eaca05356 100644
--- a/tests/carservice_unit_test/src/com/android/car/OccupantZoneHelper.java
+++ b/tests/carservice_unit_test/src/com/android/car/OccupantZoneHelper.java
@@ -61,6 +61,8 @@ public final class OccupantZoneHelper {
 
     private final List<CarOccupantZoneManager.OccupantZoneInfo> mZones = new ArrayList<>();
     private final SparseIntArray mZoneToUser = new SparseIntArray(); // key: zone, value: user id
+    // Default driver user ID is 10.
+    private int mDriverUserId = 10;
 
     public void setUpOccupantZones(@Mock CarOccupantZoneService service, boolean hasDriver,
             boolean hasFrontPassenger, int numRearPassengers) {
@@ -178,6 +180,9 @@ public final class OccupantZoneHelper {
         when(service.getUserForOccupant(anyInt())).thenAnswer(
                 inv -> {
                     int zoneId = (int) inv.getArgument(0);
+                    if (mZones.contains(zoneDriverLHD) && zoneDriverLHD.zoneId == zoneId) {
+                        return mDriverUserId;
+                    }
                     int existingIndex = mZoneToUser.indexOfKey(zoneId);
                     if (existingIndex >= 0) {
                         return mZoneToUser.valueAt(existingIndex);
@@ -191,6 +196,10 @@ public final class OccupantZoneHelper {
         return zone.zoneId; // For simplicity, use the same id with zone.
     }
 
+    public void setDriverUserId(int userId) {
+        mDriverUserId = userId;
+    }
+
     private boolean hasZone(int zoneId) {
         for (OccupantZoneInfo zone : mZones) {
             if (zoneId == zone.zoneId) {
diff --git a/tests/carservice_unit_test/src/com/android/car/am/CarActivityServiceTaskMonitorUnitTest.java b/tests/carservice_unit_test/src/com/android/car/am/CarActivityServiceTaskMonitorUnitTest.java
index a67b918aea..a03a5c8335 100644
--- a/tests/carservice_unit_test/src/com/android/car/am/CarActivityServiceTaskMonitorUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/am/CarActivityServiceTaskMonitorUnitTest.java
@@ -54,11 +54,12 @@ import android.view.SurfaceControl;
 import androidx.test.filters.MediumTest;
 
 import com.android.compatibility.common.util.PollingCheck;
+import com.android.internal.protolog.ProtoLog;
 import com.android.wm.shell.ShellTaskOrganizer;
 import com.android.wm.shell.common.HandlerExecutor;
 import com.android.wm.shell.common.SyncTransactionQueue;
-import com.android.wm.shell.common.TransactionPool;
 import com.android.wm.shell.fullscreen.FullscreenTaskListener;
+import com.android.wm.shell.shared.TransactionPool;
 
 import com.google.common.truth.Expect;
 
@@ -114,6 +115,9 @@ public class CarActivityServiceTaskMonitorUnitTest {
 
     @Before
     public void setUp() throws Exception {
+        // The test doesn't have access to the ProtoLog viewer config files
+        ProtoLog.REQUIRE_PROTOLOGTOOL = false;
+
         long timeOutMs = DEFAULT_TIMEOUT_MS;
         if (mTestName.getMethodName().contains("ExpiredToken")) {
             timeOutMs = SHORT_MIRRORING_TOKEN_TIMEOUT_MS;
@@ -185,26 +189,6 @@ public class CarActivityServiceTaskMonitorUnitTest {
         startActivityAndAssertCameOnTop(mActivityB);
     }
 
-    @Test
-    public void testActivityChangedInBackstackOnTaskInfoChanged() throws Exception {
-        FilteredListener listener = startActivityAndAssertCameOnTop(mActivityA);
-
-        // When some activity is launched from another, the baseIntent of the activity becomes
-        // the launching activity due to which an onActivityLaunched callback is received. The
-        // purpose of launching home here is that the baseIntent is not set and the correct
-        // onActivityChanged callback is received.
-        launchHomeScreenUsingIntent();
-
-        listener.assertTopTaskActivityChangedInBackstack();
-    }
-
-    private void launchHomeScreenUsingIntent() {
-        Intent intent = new Intent(Intent.ACTION_MAIN)
-                .addCategory(Intent.CATEGORY_HOME)
-                .setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
-        getTestContext().startActivity(intent);
-    }
-
     @Test
     public void testMultipleActivityListeners() throws Exception {
         FilteredListener listener1 = new FilteredListener(mActivityA);
@@ -281,7 +265,7 @@ public class CarActivityServiceTaskMonitorUnitTest {
         assertTrue(topTasksHasComponent(mActivityA));
 
         getInstrumentation().runOnMainSync(launchedActivity::finish);
-        listenerA.assertTopTaskActivityChangedInBackstack();
+        listenerA.assertTopTaskVanished();
     }
 
     @Test
@@ -511,7 +495,7 @@ public class CarActivityServiceTaskMonitorUnitTest {
     private static final class FilteredListener implements CarActivityService.ActivityListener {
         private final ComponentName mDesiredComponent;
         private final CountDownLatch mActivityCameOnTop = new CountDownLatch(1);
-        private final CountDownLatch mActivityChangedInBackstack = new CountDownLatch(1);
+        private final CountDownLatch mTaskVanished = new CountDownLatch(1);
         private TaskInfo mTopTask;
 
         /**
@@ -540,17 +524,17 @@ public class CarActivityServiceTaskMonitorUnitTest {
         }
 
         @Override
-        public void onActivityChangedInBackstack(TaskInfo taskInfo) {
+        public void onTaskVanished(TaskInfo taskInfo) {
             if (isActivityOutsideTestPackage(taskInfo)) {
                 return;
             }
             if (!taskInfo.baseIntent.getComponent().equals(mDesiredComponent)) {
                 Log.d(TAG, String.format(
-                        "onActivityChangedInBackstack#Unexpected component: %s. Expected: %s",
+                        "onTaskVanished#Unexpected component: %s. Expected: %s",
                         taskInfo.baseIntent.getComponent(), mDesiredComponent));
                 return;
             }
-            mActivityChangedInBackstack.countDown();
+            mTaskVanished.countDown();
         }
 
         private boolean isActivityOutsideTestPackage(TaskInfo taskInfo) {
@@ -572,13 +556,13 @@ public class CarActivityServiceTaskMonitorUnitTest {
             return mActivityCameOnTop.await(timeoutMs, TimeUnit.MILLISECONDS);
         }
 
-        private void assertTopTaskActivityChangedInBackstack() throws InterruptedException {
-            assertThat(waitForTopTaskActivityChangedInBackstack(DEFAULT_TIMEOUT_MS)).isTrue();
+        private void assertTopTaskVanished() throws InterruptedException {
+            assertThat(waitForTopTaskVanished(DEFAULT_TIMEOUT_MS)).isTrue();
         }
 
-        private boolean waitForTopTaskActivityChangedInBackstack(long timeoutMs)
+        private boolean waitForTopTaskVanished(long timeoutMs)
                 throws InterruptedException {
-            return mActivityChangedInBackstack.await(timeoutMs, TimeUnit.MILLISECONDS);
+            return mTaskVanished.await(timeoutMs, TimeUnit.MILLISECONDS);
         }
     }
 }
diff --git a/tests/carservice_test/src/com/android/car/audio/AudioFocusInfoBuilder.java b/tests/carservice_unit_test/src/com/android/car/audio/AudioFocusInfoBuilder.java
similarity index 84%
rename from tests/carservice_test/src/com/android/car/audio/AudioFocusInfoBuilder.java
rename to tests/carservice_unit_test/src/com/android/car/audio/AudioFocusInfoBuilder.java
index 3758fe705b..fef368e449 100644
--- a/tests/carservice_test/src/com/android/car/audio/AudioFocusInfoBuilder.java
+++ b/tests/carservice_unit_test/src/com/android/car/audio/AudioFocusInfoBuilder.java
@@ -39,57 +39,90 @@ public final class AudioFocusInfoBuilder {
     private boolean mDelayedFocusRequestEnabled;
     private boolean mPausesOnDuckRequestEnabled;
 
+    /**
+     * Set audio focus info usage
+     */
     public AudioFocusInfoBuilder setUsage(int usage) {
         mUsage = usage;
         return this;
     }
 
+    /**
+     * Set client UID info usage
+     */
     public AudioFocusInfoBuilder setClientUid(int clientUid) {
         mClientUid = clientUid;
         return this;
     }
 
+    /**
+     * Set audio focus info client ID
+     */
     public AudioFocusInfoBuilder setClientId(String clientId) {
         mClientId = clientId;
         return this;
     }
 
+    /**
+     * Set audio focus info package name
+     */
     public AudioFocusInfoBuilder setPackageName(String packageName) {
         mPackageName = packageName;
         return this;
     }
 
+    /**
+     * Set audio focus info gain request
+     */
     public AudioFocusInfoBuilder setGainRequest(int gainRequest) {
         mGainRequest = gainRequest;
         return this;
     }
 
+    /**
+     * Set audio focus info loss request
+     */
     public AudioFocusInfoBuilder setLossReceived(int lossReceived) {
         mLossReceived = lossReceived;
         return this;
     }
 
+    /**
+     * Set audio focus info sdk
+     */
     public AudioFocusInfoBuilder setSdk(int sdk) {
         mSdk = sdk;
         return this;
     }
 
+    /**
+     * Set audio focus info bundle
+     */
     public AudioFocusInfoBuilder setBundle(Bundle bundle) {
         mBundle = bundle;
         return this;
     }
 
+    /**
+     * Set whether delayed focus request should be enabled in audio focus info
+     */
     public AudioFocusInfoBuilder setDelayedFocusRequestEnable(boolean delayedFocusRequestEnabled) {
         mDelayedFocusRequestEnabled = delayedFocusRequestEnabled;
         return this;
     }
 
+    /**
+     * Set whether pause on duck should be enabled in audio focus info
+     */
     public AudioFocusInfoBuilder setPausesOnDuckRequestEnable(boolean pausesOnDuckRequestEnabled) {
         mPausesOnDuckRequestEnabled = pausesOnDuckRequestEnabled;
         return this;
     }
 
 
+    /**
+     * Build audio focus info
+     */
     public AudioFocusInfo createAudioFocusInfo() {
         AudioAttributes.Builder builder = new AudioAttributes.Builder();
         if (AudioAttributes.isSystemUsage(mUsage)) {
diff --git a/tests/carservice_unit_test/src/com/android/car/audio/AudioManagerWrapperTest.java b/tests/carservice_unit_test/src/com/android/car/audio/AudioManagerWrapperTest.java
index d3744f5682..b6b92f37b3 100644
--- a/tests/carservice_unit_test/src/com/android/car/audio/AudioManagerWrapperTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/audio/AudioManagerWrapperTest.java
@@ -186,9 +186,9 @@ public final class AudioManagerWrapperTest extends AbstractExtendedMockitoTestCa
 
     @Test
     public void setAudioDeviceGain() {
-        expectWithMessage("Volume gain set state")
-                .that(mAudioManagerWrapper
-                        .setAudioDeviceGain(TEST_ADDRESS, TEST_GAIN, TEST_IS_OUTPUT));
+        expectWithMessage("Volume gain set state").that(mAudioManagerWrapper
+                        .setAudioDeviceGain(TEST_ADDRESS, TEST_GAIN, TEST_IS_OUTPUT))
+                .isEqualTo(TEST_GAIN_SET_STATE);
     }
 
     @Test
@@ -405,6 +405,15 @@ public final class AudioManagerWrapperTest extends AbstractExtendedMockitoTestCa
                 mAudioManagerWrapper.getStreamVolume(stream)).isEqualTo(index);
     }
 
+    @Test
+    public void isStreamMute() {
+        int stream = AudioManager.STREAM_MUSIC;
+        when(mAudioManager.isStreamMute(stream)).thenReturn(true);
+
+        expectWithMessage("Music stream mute state").that(
+                mAudioManagerWrapper.isStreamMute(stream)).isEqualTo(true);
+    }
+
     @Test
     public void setParameter() {
         String parameter = "test_parameter:key";
@@ -424,6 +433,18 @@ public final class AudioManagerWrapperTest extends AbstractExtendedMockitoTestCa
                 mAudioManagerWrapper.getDevices(GET_DEVICES_OUTPUTS)).isEqualTo(infos);
     }
 
+    @Test
+    public void getAudioDevicesForAttributes() {
+        AudioDeviceInfo info1 = Mockito.mock(AudioDeviceInfo.class);
+        AudioDeviceInfo info2 = Mockito.mock(AudioDeviceInfo.class);
+        List<AudioDeviceInfo> infos = List.of(info1, info2);
+        when(mAudioManager.getAudioDevicesForAttributes(mTestAudioAttributes)).thenReturn(infos);
+
+        expectWithMessage("Audio devices for attributes").that(
+                mAudioManagerWrapper.getAudioDevicesForAttributes(mTestAudioAttributes))
+                .isEqualTo(infos);
+    }
+
     @Test
     public void registerAudioPlaybackCallback() {
         AudioPlaybackCallback callback = Mockito.mock(AudioPlaybackCallback.class);
diff --git a/tests/carservice_test/src/com/android/car/audio/CarAudioContextToAudioAttributeValidityTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioContextToAudioAttributeValidityTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CarAudioContextToAudioAttributeValidityTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarAudioContextToAudioAttributeValidityTest.java
diff --git a/tests/carservice_test/src/com/android/car/audio/CarAudioDynamicRoutingTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioDynamicRoutingTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CarAudioDynamicRoutingTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarAudioDynamicRoutingTest.java
diff --git a/tests/carservice_test/src/com/android/car/audio/CarAudioFadeConfigurationHelperTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioFadeConfigurationHelperUnitTest.java
similarity index 90%
rename from tests/carservice_test/src/com/android/car/audio/CarAudioFadeConfigurationHelperTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarAudioFadeConfigurationHelperUnitTest.java
index ba47d42ba1..2bce708bba 100644
--- a/tests/carservice_test/src/com/android/car/audio/CarAudioFadeConfigurationHelperTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioFadeConfigurationHelperUnitTest.java
@@ -33,7 +33,7 @@ import java.io.InputStream;
 import java.util.MissingResourceException;
 
 @RunWith(MockitoJUnitRunner.class)
-public class CarAudioFadeConfigurationHelperTest extends AbstractExtendedMockitoTestCase {
+public class CarAudioFadeConfigurationHelperUnitTest extends AbstractExtendedMockitoTestCase {
 
     private static final String TEST_RELAXED_FADING = "relaxed fading";
     private static final String TEST_AGGRESSIVE_FADING = "aggressive fading";
@@ -65,9 +65,9 @@ public class CarAudioFadeConfigurationHelperTest extends AbstractExtendedMockito
     }
 
     @Test
-    public void constructor_withNoConfigs_fails() throws Exception {
+    public void constructor_withoutConfigs_fails() throws Exception {
         try (InputStream inputStream = mContext.getResources().openRawResource(
-                R.raw.car_audio_fade_configuration_withNoConfigs)) {
+                R.raw.car_audio_fade_configuration_missing_configs)) {
 
             MissingResourceException thrown = assertThrows(MissingResourceException.class,
                     () -> new CarAudioFadeConfigurationHelper(inputStream));
@@ -80,7 +80,7 @@ public class CarAudioFadeConfigurationHelperTest extends AbstractExtendedMockito
     @Test
     public void constructor_configWithNoName_fails() throws Exception {
         try (InputStream inputStream = mContext.getResources().openRawResource(
-                R.raw.car_audio_fade_configuration_withNullConfigName)) {
+                R.raw.car_audio_fade_configuration_with_null_config_name)) {
 
             NullPointerException thrown = assertThrows(NullPointerException.class,
                     () -> new CarAudioFadeConfigurationHelper(inputStream));
@@ -93,7 +93,7 @@ public class CarAudioFadeConfigurationHelperTest extends AbstractExtendedMockito
     @Test
     public void constructor_configWithEmptyName_fails() throws Exception {
         try (InputStream inputStream = mContext.getResources().openRawResource(
-                R.raw.car_audio_fade_configuration_withEmptyConfigName)) {
+                R.raw.car_audio_fade_configuration_with_empty_config_name)) {
 
             IllegalArgumentException thrown = assertThrows(IllegalArgumentException.class,
                     () -> new CarAudioFadeConfigurationHelper(inputStream));
diff --git a/tests/carservice_unit_test/src/com/android/car/audio/CarAudioServiceUnitTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioServiceUnitTest.java
index 9986499cfe..2ae248e133 100644
--- a/tests/carservice_unit_test/src/com/android/car/audio/CarAudioServiceUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioServiceUnitTest.java
@@ -180,6 +180,8 @@ import android.os.RemoteException;
 import android.os.ServiceManager;
 import android.os.SystemProperties;
 import android.os.UserHandle;
+import android.platform.test.annotations.DisableFlags;
+import android.platform.test.annotations.EnableFlags;
 import android.platform.test.flag.junit.SetFlagsRule;
 import android.provider.Settings;
 import android.telephony.SubscriptionManager;
@@ -187,6 +189,8 @@ import android.telephony.TelephonyCallback;
 import android.telephony.TelephonyManager;
 import android.util.Log;
 import android.util.NoSuchPropertyException;
+import android.util.SparseArray;
+import android.util.SparseIntArray;
 import android.view.KeyEvent;
 
 import androidx.test.core.app.ApplicationProvider;
@@ -302,6 +306,11 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
     private static final int TEST_GAIN_DEFAULT_VALUE = -2000;
     private static final int TEST_GAIN_STEP_VALUE = 2;
 
+    private static final String TEST_LEGACY_VOLUME_GROUP_NAME = "legacy_zone0";
+    private static final int TEST_STREAM_MIN_VOLUME = 0;
+    private static final int TEST_STREAM_MAX_VOLUME = 25;
+    private static final int TEST_STREAM_VOLUME = 10;
+
     private static final int TEST_PLAYBACK_UID = 10101;
 
     private static final CarOccupantZoneManager.OccupantZoneInfo TEST_DRIVER_OCCUPANT =
@@ -650,12 +659,19 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
                 .thenReturn(TEST_FRONT_PASSENGER_OCCUPANT);
         when(mMockOccupantZoneService.getOccupantForAudioZoneId(TEST_REAR_LEFT_ZONE_ID))
                 .thenReturn(TEST_REAR_LEFT_PASSENGER_OCCUPANT);
-        when(mMockOccupantZoneService.getOccupantForAudioZoneId(TEST_REAR_ROW_3_ZONE_ID))
-                .thenReturn(TEST_REAR_ROW_3_PASSENGER_OCCUPANT);
 
         // Initially set occupant zone service at uninitialized
         when(mMockOccupantZoneService.getDriverUserId()).thenReturn(UserHandle.USER_SYSTEM);
 
+        SparseArray<CarOccupantZoneManager.OccupantZoneInfo> configs = new SparseArray<>();
+        configs.put(TEST_DRIVER_OCCUPANT_ZONE_ID, TEST_DRIVER_OCCUPANT);
+        configs.put(TEST_FRONT_OCCUPANT_ZONE_ID, TEST_FRONT_PASSENGER_OCCUPANT);
+        configs.put(TEST_REAR_RIGHT_OCCUPANT_ZONE_ID, TEST_REAR_RIGHT_PASSENGER_OCCUPANT);
+        configs.put(TEST_REAR_LEFT_OCCUPANT_ZONE_ID, TEST_REAR_LEFT_PASSENGER_OCCUPANT);
+        configs.put(TEST_REAR_ROW_3_OCCUPANT_ZONE_ID, TEST_REAR_ROW_3_PASSENGER_OCCUPANT);
+
+        when(mMockOccupantZoneService.getOccupantsConfig()).thenReturn(configs);
+
         CarLocalServices.removeServiceForTest(CarOccupantZoneService.class);
         CarLocalServices.addService(CarOccupantZoneService.class, mMockOccupantZoneService);
         CarLocalServices.removeServiceForTest(CarInputService.class);
@@ -763,6 +779,10 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
                     ? SUCCESS : mAudioPolicyRegistrationStatus.get(mRegistrationCount++);
         });
 
+        when(mAudioManager.getStreamMinVolume(anyInt())).thenReturn(TEST_STREAM_MIN_VOLUME);
+        when(mAudioManager.getStreamMaxVolume(anyInt())).thenReturn(TEST_STREAM_MAX_VOLUME);
+        when(mAudioManager.getStreamVolume(anyInt())).thenReturn(TEST_STREAM_VOLUME);
+
         when(mAudioManager.isAudioServerRunning()).thenReturn(true);
 
         // Needed by audio policy when setting UID device affinity
@@ -860,7 +880,7 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
     @Test
     public void init_withRepeatedDynamicDevicesInConfig_fails() throws Exception {
         setUpTempFileForAudioConfiguration(
-                R.raw.car_audio_configuration_repeated_dynamic_devices_in_config);
+                R.raw.car_audio_configuration_with_repeated_dynamic_devices_in_config);
         setUpTempFileForAudioFadeConfiguration(R.raw.car_audio_fade_configuration);
         CarAudioService service = setUpAudioServiceWithDynamicDevices(mTempCarAudioConfigFile,
                 mTempCarAudioFadeConfigFile);
@@ -972,6 +992,69 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
         verify(mAudioManager, never()).registerAudioDeviceCallback(any(), any());
     }
 
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void init_withCoreVolumeMisconfigured() throws Exception {
+        when(mMockResources.getBoolean(audioUseCoreVolume)).thenReturn(true);
+        CarAudioService service = setUpAudioServiceWithoutInit();
+
+        service.init();
+
+        verify(mAudioManager).setAudioServerStateCallback(any(), any());
+        verify(mAudioManager).registerAudioDeviceCallback(any(), any());
+    }
+
+    @Test
+    @DisableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void init_withCoreVolumeMisconfigured_failsOnInit() throws Exception {
+        when(mMockResources.getBoolean(audioUseCoreVolume)).thenReturn(true);
+        CarAudioService service = setUpAudioServiceWithoutInit();
+
+        IllegalArgumentException thrown =
+                assertThrows(IllegalArgumentException.class, service::init);
+
+        expectWithMessage("Exception on service init with empty group and using core volume")
+                .that(thrown).hasMessageThat().contains("group name attribute can not be empty when"
+                        + " relying on core volume groups");
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void init_withMissingOccupantZones_captureActiveZonesOnly() throws Exception {
+        SparseArray<CarOccupantZoneManager.OccupantZoneInfo> configs = new SparseArray<>();
+        configs.put(TEST_DRIVER_OCCUPANT_ZONE_ID, TEST_DRIVER_OCCUPANT);
+        when(mMockOccupantZoneService.getOccupantsConfig()).thenReturn(configs);
+        CarAudioService service = setUpAudioServiceWithoutInit();
+
+        service.init();
+
+        ArgumentCaptor<SparseIntArray> captor =
+                ArgumentCaptor.forClass(SparseIntArray.class);
+        verify(mMockOccupantZoneService).setAudioZoneIdsForOccupantZoneIds(captor.capture());
+        int[] audioZoneZones = captor.getValue().copyKeys();
+        expectWithMessage("Configured audio zones with missing occupant zones")
+                .that(audioZoneZones).asList().containsExactly(PRIMARY_AUDIO_ZONE);
+    }
+
+    @Test
+    @DisableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void init_withMissingOccupantZones_captureActiveAllZones() throws Exception {
+        SparseArray<CarOccupantZoneManager.OccupantZoneInfo> configs = new SparseArray<>();
+        configs.put(TEST_DRIVER_OCCUPANT_ZONE_ID, TEST_DRIVER_OCCUPANT);
+        when(mMockOccupantZoneService.getOccupantsConfig()).thenReturn(configs);
+        CarAudioService service = setUpAudioServiceWithoutInit();
+
+        service.init();
+
+        ArgumentCaptor<SparseIntArray> captor =
+                ArgumentCaptor.forClass(SparseIntArray.class);
+        verify(mMockOccupantZoneService).setAudioZoneIdsForOccupantZoneIds(captor.capture());
+        int[] audioZoneZones = captor.getValue().copyKeys();
+        expectWithMessage("Configured audio zones with all audio zones").that(audioZoneZones)
+                .asList().containsExactly(PRIMARY_AUDIO_ZONE, TEST_REAR_LEFT_ZONE_ID,
+                        TEST_REAR_RIGHT_ZONE_ID, TEST_FRONT_ZONE_ID, TEST_REAR_ROW_3_ZONE_ID);
+    }
+
     @Test
     public void release_releasesAudioServiceCallbacks() throws Exception {
         mSetFlagsRule.disableFlags(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES);
@@ -2372,6 +2455,58 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
         verify(mAudioControlWrapperAidl).onDevicesToMuteChange(any());
     }
 
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void setAudioEnabled_forEnabledVolumeGroupMutingFromConfigFileWithMatchedRRO()
+            throws Exception {
+        CarAudioService service = setUpCarAudioServiceWithVolumeGroupMutingConfiguredInFile(
+                        R.raw.car_audio_configuration_with_group_muting_config_enabled,
+                        /* useGroupMuting= */ true);
+
+        service.setAudioEnabled(/* isAudioEnabled= */ true);
+
+        verify(mAudioControlWrapperAidl).onDevicesToMuteChange(any());
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void setAudioEnabled_forEnabledVolumeGroupMutingFromConfigFileWithUnmatchedRRO()
+            throws Exception {
+        CarAudioService service = setUpCarAudioServiceWithVolumeGroupMutingConfiguredInFile(
+                        R.raw.car_audio_configuration_with_group_muting_config_enabled,
+                        /* useGroupMuting= */ false);
+
+        service.setAudioEnabled(/* isAudioEnabled= */ true);
+
+        verify(mAudioControlWrapperAidl).onDevicesToMuteChange(any());
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void setAudioEnabled_forDisabledVolumeGroupMutingFromConfigFileWithMatchedRRO()
+            throws Exception {
+        CarAudioService service = setUpCarAudioServiceWithVolumeGroupMutingConfiguredInFile(
+                R.raw.car_audio_configuration_with_group_muting_config_disabled,
+                /* useGroupMuting= */ false);
+
+        service.setAudioEnabled(/* isAudioEnabled= */ true);
+
+        verify(mAudioControlWrapperAidl, never()).onDevicesToMuteChange(any());
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void setAudioEnabled_forDisabledVolumeGroupMutingFromConfigFileWithUnmatchedRRO()
+            throws Exception {
+        CarAudioService service = setUpCarAudioServiceWithVolumeGroupMutingConfiguredInFile(
+                R.raw.car_audio_configuration_with_group_muting_config_disabled,
+                /* useGroupMuting= */ true);
+
+        service.setAudioEnabled(/* isAudioEnabled= */ true);
+
+        verify(mAudioControlWrapperAidl, never()).onDevicesToMuteChange(any());
+    }
+
     @Test
     public void setAudioEnabled_forDisabledVolumeGroupMuting() throws Exception {
         CarAudioService nonVolumeGroupMutingAudioService =
@@ -2746,12 +2881,30 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
     @Test
     public void getVolumeGroupInfosForZone_forDynamicRoutingDisabled() throws Exception {
         CarAudioService nonDynamicAudioService = setUpAudioServiceWithoutDynamicRouting();
+        List<AudioDeviceInfo> deviceInfos = List.of(mMediaOutputDevice);
+        when(mAudioManager.getAudioDevicesForAttributes(ATTRIBUTES_MEDIA)).thenReturn(deviceInfos);
+        when(mAudioManager.isStreamMute(AudioManager.STREAM_MUSIC)).thenReturn(true);
+        CarVolumeGroupInfo expectedVolumeGroupInfo = new CarVolumeGroupInfo.Builder(
+                TEST_LEGACY_VOLUME_GROUP_NAME, PRIMARY_OCCUPANT_ZONE, MEDIA_VOLUME_GROUP_ID)
+                .setVolumeGainIndex(TEST_STREAM_VOLUME)
+                .setMaxVolumeGainIndex(TEST_STREAM_MAX_VOLUME)
+                .setMinVolumeGainIndex(TEST_STREAM_MIN_VOLUME)
+                .setAudioAttributes(Arrays.asList(ATTRIBUTES_MEDIA))
+                .setAudioDeviceAttributes(List.of(new AudioDeviceAttributes(mMediaOutputDevice)))
+                .setMuted(true)
+                .setBlocked(false)
+                .setAttenuated(false)
+                .setMaxActivationVolumeGainIndex(TEST_STREAM_MAX_VOLUME)
+                .setMinActivationVolumeGainIndex(TEST_STREAM_MIN_VOLUME)
+                .setMutedBySystem(false).build();
 
         List<CarVolumeGroupInfo> infos =
                 nonDynamicAudioService.getVolumeGroupInfosForZone(PRIMARY_AUDIO_ZONE);
 
-        expectWithMessage("Car volume group infos with dynamic routing disabled")
-                .that(infos).isEmpty();
+        expectWithMessage("Car volume group infos size with dynamic routing disabled")
+                .that(infos).hasSize(CarAudioDynamicRouting.STREAM_TYPES.length);
+        expectWithMessage("Car volume group info name with dynamic routing disabled")
+                .that(infos.get(0)).isEqualTo(expectedVolumeGroupInfo);
     }
 
     @Test
@@ -2847,10 +3000,29 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
     @Test
     public void getVolumeGroupInfo_withLegacyMode() throws Exception {
         CarAudioService service = setUpAudioServiceWithoutDynamicRouting();
+        List<AudioDeviceInfo> deviceInfos = List.of(mMediaOutputDevice);
+        when(mAudioManager.getAudioDevicesForAttributes(ATTRIBUTES_MEDIA)).thenReturn(deviceInfos);
+        when(mAudioManager.isStreamMute(AudioManager.STREAM_MUSIC)).thenReturn(true);
+        CarVolumeGroupInfo expectedVolumeGroupInfo = new CarVolumeGroupInfo.Builder(
+                TEST_LEGACY_VOLUME_GROUP_NAME, PRIMARY_OCCUPANT_ZONE, MEDIA_VOLUME_GROUP_ID)
+                .setVolumeGainIndex(TEST_STREAM_VOLUME)
+                .setMaxVolumeGainIndex(TEST_STREAM_MAX_VOLUME)
+                .setMinVolumeGainIndex(TEST_STREAM_MIN_VOLUME)
+                .setAudioAttributes(Arrays.asList(ATTRIBUTES_MEDIA))
+                .setAudioDeviceAttributes(List.of(new AudioDeviceAttributes(mMediaOutputDevice)))
+                .setMuted(true)
+                .setBlocked(false)
+                .setAttenuated(false)
+                .setMaxActivationVolumeGainIndex(TEST_STREAM_MAX_VOLUME)
+                .setMinActivationVolumeGainIndex(TEST_STREAM_MIN_VOLUME)
+                .setMutedBySystem(false).build();
+
+        CarVolumeGroupInfo testVolumeGroupInfo =
+                service.getVolumeGroupInfo(PRIMARY_OCCUPANT_ZONE, TEST_PRIMARY_ZONE_GROUP_0);
 
         expectWithMessage("Volume group info in legacy mode")
-                .that(service.getVolumeGroupInfo(PRIMARY_OCCUPANT_ZONE, TEST_PRIMARY_ZONE_GROUP_0))
-                .isNull();
+                .that(testVolumeGroupInfo)
+                .isEqualTo(expectedVolumeGroupInfo);
     }
 
     @Test
@@ -3484,7 +3656,8 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
                 .getAudioAttributesForVolumeGroup(mTestPrimaryZoneVolumeInfo0);
 
         expectWithMessage("Volume group audio attributes with dynamic routing disabled")
-                .that(audioAttributes).isEmpty();
+                .that(audioAttributes)
+                .containsExactly(CarAudioContext.getAudioAttributeFromUsage(USAGE_MEDIA));
     }
 
     @Test
@@ -4143,6 +4316,98 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
                         CoreAudioRoutingUtils.OEM_STRATEGY_ID);
     }
 
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void getVolumeGroupAndContextCount_withCoreVolumeAndRoutingFromConfigConflictRRO()
+            throws Exception {
+        when(mMockResources.getBoolean(audioUseCoreVolume)).thenReturn(false);
+        when(mMockResources.getBoolean(audioUseCoreRouting)).thenReturn(false);
+        CarAudioService useCoreAudioCarAudioService =
+                setUpCarAudioServiceUsingCoreAudioRoutingAndVolumeInConfigFile();
+
+        verify(mAudioManager).registerVolumeGroupCallback(any(), any());
+        expectWithMessage("Primary zone car volume group count with core configs in file and "
+                + "conflict RRO")
+                .that(useCoreAudioCarAudioService.getVolumeGroupCount(PRIMARY_AUDIO_ZONE))
+                .isEqualTo(CoreAudioRoutingUtils.getVolumeGroups().size());
+        expectWithMessage("Number of contexts with core configs in and "
+                + "conflict RRO")
+                .that(useCoreAudioCarAudioService.getCarAudioContext().getAllContextsIds().size())
+                .isEqualTo(CoreAudioRoutingUtils.getProductStrategies().size());
+        expectWithMessage("Car Audio Contexts with core configs in and "
+                + "conflict RRO")
+                .that(useCoreAudioCarAudioService.getCarAudioContext().getAllContextsIds())
+                .containsExactly(CoreAudioRoutingUtils.NAV_STRATEGY_ID,
+                        CoreAudioRoutingUtils.MUSIC_STRATEGY_ID,
+                        CoreAudioRoutingUtils.OEM_STRATEGY_ID);
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void getVolumeGroupAndContextCount_withCoreVolumeAndRoutingFromConfigNonConflictRRO()
+            throws Exception {
+        when(mMockResources.getBoolean(audioUseCoreVolume)).thenReturn(true);
+        when(mMockResources.getBoolean(audioUseCoreRouting)).thenReturn(true);
+        CarAudioService useCoreAudioCarAudioService =
+                setUpCarAudioServiceUsingCoreAudioRoutingAndVolumeInConfigFile();
+
+        verify(mAudioManager).registerVolumeGroupCallback(any(), any());
+        expectWithMessage("Primary zone car volume group count with core configs in file and "
+                + "non conflict RRO")
+                .that(useCoreAudioCarAudioService.getVolumeGroupCount(PRIMARY_AUDIO_ZONE))
+                .isEqualTo(CoreAudioRoutingUtils.getVolumeGroups().size());
+        expectWithMessage("Number of contexts with core configs in file and "
+                + "non conflict RRO")
+                .that(useCoreAudioCarAudioService.getCarAudioContext().getAllContextsIds().size())
+                .isEqualTo(CoreAudioRoutingUtils.getProductStrategies().size());
+        expectWithMessage("Car Audio Contexts with core configs in file and "
+                + "non conflict RRO")
+                .that(useCoreAudioCarAudioService.getCarAudioContext().getAllContextsIds())
+                .containsExactly(CoreAudioRoutingUtils.NAV_STRATEGY_ID,
+                        CoreAudioRoutingUtils.MUSIC_STRATEGY_ID,
+                        CoreAudioRoutingUtils.OEM_STRATEGY_ID);
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void
+            getVolumeGroupAndContextCount_withDisabledCoreVolumeAndRoutingFromConfigAndConflictRRO()
+            throws Exception {
+        when(mMockResources.getBoolean(audioUseCoreVolume)).thenReturn(true);
+        when(mMockResources.getBoolean(audioUseCoreRouting)).thenReturn(true);
+        CarAudioService useCoreAudioCarAudioService =
+                setUpCarAudioServiceWithCoreAudioRoutingAndVolumeDisabledInConfigFile();
+
+        expectWithMessage("Primary zone car volume group count with core config disabled in and "
+                + "conflict RRO")
+                .that(useCoreAudioCarAudioService.getVolumeGroupCount(PRIMARY_AUDIO_ZONE))
+                .isEqualTo(2);
+        expectWithMessage("Number of contexts with core config disabled in and "
+                + "conflict RRO")
+                .that(useCoreAudioCarAudioService.getCarAudioContext().getAllContextsIds().size())
+                .isEqualTo(2);
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void
+            getVolumeGroupAndContextCount_withDisCoreVolumeAndRoutingFromConfigAndNonConflictRRO()
+            throws Exception {
+        when(mMockResources.getBoolean(audioUseCoreVolume)).thenReturn(false);
+        when(mMockResources.getBoolean(audioUseCoreRouting)).thenReturn(false);
+        CarAudioService useCoreAudioCarAudioService =
+                setUpCarAudioServiceWithCoreAudioRoutingAndVolumeDisabledInConfigFile();
+
+        expectWithMessage("Primary zone car volume group count with core config disabled in and "
+                + "non conflict RRO")
+                .that(useCoreAudioCarAudioService.getVolumeGroupCount(PRIMARY_AUDIO_ZONE))
+                .isEqualTo(2);
+        expectWithMessage("Number of contexts with core config disabled in and "
+                + "non conflict RRO")
+                .that(useCoreAudioCarAudioService.getCarAudioContext().getAllContextsIds().size())
+                .isEqualTo(2);
+    }
+
     @Test
     public void registerAudioZonesMirrorStatusCallback() throws Exception {
         CarAudioService service = setUpAudioService();
@@ -4735,7 +5000,8 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
     @Test
     public void switchZoneToConfig_toDynamicConfig_withDynamicDevicesInMultipleZones()
             throws Exception {
-        setUpTempFileForAudioConfiguration(R.raw.car_audio_configuration_using_dynamic_devices);
+        setUpTempFileForAudioConfiguration(
+                R.raw.car_audio_configuration_with_dynamic_devices_for_primary_zone);
         setUpTempFileForAudioFadeConfiguration(R.raw.car_audio_fade_configuration);
         CarAudioService dynamicDeviceService =
                 setUpAudioServiceWithDynamicDevices(mTempCarAudioConfigFile,
@@ -4769,7 +5035,8 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
     @Test
     public void switchZoneToConfig_backFromDynamicConfig_withDynamicDevicesInMultipleZones()
             throws Exception {
-        setUpTempFileForAudioConfiguration(R.raw.car_audio_configuration_using_dynamic_devices);
+        setUpTempFileForAudioConfiguration(
+                R.raw.car_audio_configuration_with_dynamic_devices_for_primary_zone);
         setUpTempFileForAudioFadeConfiguration(R.raw.car_audio_fade_configuration);
         CarAudioService dynamicDeviceService =
                 setUpAudioServiceWithDynamicDevices(mTempCarAudioConfigFile,
@@ -6240,6 +6507,73 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
         expectWithMessage("Volume event callback reception status with callback unregistered")
                 .that(volumeEventCallback.waitForCallback()).isFalse();
     }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void onDevicesToDuckChange_withDuckingConfigEnabledAndMatchedRRO() throws Exception {
+        boolean useHALDucking = true;
+        CarAudioService service = setUpCarAudioServiceWithDuckingConfiguredInFile(
+                R.raw.car_audio_configuration_with_HAL_ducking_config_enabled,
+                useHALDucking);
+        assignOccupantToAudioZones();
+        AudioFocusInfo audioFocusInfo = createAudioFocusInfoForMedia(TEST_REAR_RIGHT_UID);
+        service.requestAudioFocusForTest(audioFocusInfo, AUDIOFOCUS_REQUEST_GRANTED);
+        ArgumentCaptor<List<CarDuckingInfo>> carDuckingInfosCaptor =
+                ArgumentCaptor.forClass(List.class);
+
+        verify(mAudioControlWrapperAidl).onDevicesToDuckChange(carDuckingInfosCaptor.capture());
+
+        verifyMediaDuckingInfoInZone(carDuckingInfosCaptor, TEST_REAR_RIGHT_ZONE_ID,
+                " with HAL ducking config enabled and matched RRO");
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void onDevicesToDuckChange_withDuckingConfigEnabledAndUnmatchedRRO() throws Exception {
+        boolean useHALDucking = false;
+        CarAudioService service = setUpCarAudioServiceWithDuckingConfiguredInFile(
+                R.raw.car_audio_configuration_with_HAL_ducking_config_enabled,
+                useHALDucking);
+        assignOccupantToAudioZones();
+        AudioFocusInfo audioFocusInfo = createAudioFocusInfoForMedia(TEST_REAR_RIGHT_UID);
+        service.requestAudioFocusForTest(audioFocusInfo, AUDIOFOCUS_REQUEST_GRANTED);
+        ArgumentCaptor<List<CarDuckingInfo>> carDuckingInfosCaptor =
+                ArgumentCaptor.forClass(List.class);
+
+        verify(mAudioControlWrapperAidl).onDevicesToDuckChange(carDuckingInfosCaptor.capture());
+
+        verifyMediaDuckingInfoInZone(carDuckingInfosCaptor, TEST_REAR_RIGHT_ZONE_ID,
+                " with HAL ducking config enabled and unmatched RRO");
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void onDevicesToDuckChange_withDuckingConfigDisabledAndMatchedRRO() throws Exception {
+        boolean useHALDucking = false;
+        CarAudioService service = setUpCarAudioServiceWithDuckingConfiguredInFile(
+                        R.raw.car_audio_configuration_with_HAL_ducking_config_disabled,
+                        useHALDucking);
+        assignOccupantToAudioZones();
+        AudioFocusInfo audioFocusInfo = createAudioFocusInfoForMedia(TEST_REAR_RIGHT_UID);
+        service.requestAudioFocusForTest(audioFocusInfo, AUDIOFOCUS_REQUEST_GRANTED);
+
+        verify(mAudioControlWrapperAidl, never()).onDevicesToDuckChange(any());
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void onDevicesToDuckChange_withDuckingConfigDisabledAndUnmatchedRRO() throws Exception {
+        boolean useHALDucking = true;
+        CarAudioService service = setUpCarAudioServiceWithDuckingConfiguredInFile(
+                        R.raw.car_audio_configuration_with_HAL_ducking_config_disabled,
+                        useHALDucking);
+        assignOccupantToAudioZones();
+        AudioFocusInfo audioFocusInfo = createAudioFocusInfoForMedia(TEST_REAR_RIGHT_UID);
+        service.requestAudioFocusForTest(audioFocusInfo, AUDIOFOCUS_REQUEST_GRANTED);
+
+        verify(mAudioControlWrapperAidl, never()).onDevicesToDuckChange(any());
+    }
+
     private void waitForInternalCallback() throws Exception {
         CountDownLatch latch = new CountDownLatch(1);
         mHandler.post(latch::countDown);
@@ -6334,7 +6668,8 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
 
     private CarAudioService setUpAudioServiceWithMinMaxActivationVolume(boolean enabled)
             throws Exception {
-        setUpTempFileForAudioConfiguration(R.raw.car_audio_configuration_using_activation_volumes);
+        setUpTempFileForAudioConfiguration(
+                R.raw.car_audio_configuration_with_min_max_activation_volume);
         setUpTempFileForAudioFadeConfiguration(R.raw.car_audio_fade_configuration);
         when(mMockResources.getBoolean(audioUseMinMaxActivationVolume)).thenReturn(enabled);
         CarAudioService service = new CarAudioService(mMockContext, mAudioManager,
@@ -6558,7 +6893,21 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
         when(mMockResources.getBoolean(audioUseCoreVolume)).thenReturn(true);
         when(mMockResources.getBoolean(audioUseCoreRouting)).thenReturn(true);
         setUpTempFileForAudioConfiguration(
-                R.raw.car_audio_configuration_using_core_audio_routing_and_volume);
+                R.raw.car_audio_configuration_using_core_routing_and_volume);
+        setUpTempFileForAudioFadeConfiguration(R.raw.car_audio_fade_configuration);
+
+        CarAudioService useCoreAudioCarAudioService = new CarAudioService(mMockContext,
+                mAudioManager,
+                mTempCarAudioConfigFile.getFile().getAbsolutePath(), mCarVolumeCallbackHandler,
+                /* audioFadeConfigurationPath= */ null);
+        useCoreAudioCarAudioService.init();
+        return useCoreAudioCarAudioService;
+    }
+
+    private CarAudioService setUpCarAudioServiceUsingCoreAudioRoutingAndVolumeInConfigFile()
+            throws Exception {
+        setUpTempFileForAudioConfiguration(
+                R.raw.car_audio_configuration_with_core_audio_routing_and_volume_configs_enabled);
         setUpTempFileForAudioFadeConfiguration(R.raw.car_audio_fade_configuration);
 
         CarAudioService useCoreAudioCarAudioService = new CarAudioService(mMockContext,
@@ -6569,6 +6918,45 @@ public final class CarAudioServiceUnitTest extends AbstractExtendedMockitoTestCa
         return useCoreAudioCarAudioService;
     }
 
+    private CarAudioService setUpCarAudioServiceWithCoreAudioRoutingAndVolumeDisabledInConfigFile()
+            throws Exception {
+        setUpTempFileForAudioConfiguration(
+                R.raw.car_audio_configuration_with_core_audio_routing_and_volume_configs_disabled);
+        setUpTempFileForAudioFadeConfiguration(R.raw.car_audio_fade_configuration);
+
+        CarAudioService useCoreAudioCarAudioService = new CarAudioService(mMockContext,
+                mAudioManager,
+                mTempCarAudioConfigFile.getFile().getAbsolutePath(), mCarVolumeCallbackHandler,
+                /* audioFadeConfigurationPath= */ null);
+        useCoreAudioCarAudioService.init();
+        return useCoreAudioCarAudioService;
+    }
+
+    private CarAudioService setUpCarAudioServiceWithVolumeGroupMutingConfiguredInFile(
+            int resourceId, boolean useGroupMuting)
+            throws Exception {
+        setUpTempFileForAudioConfiguration(resourceId);
+        when(mMockResources.getBoolean(audioUseCarVolumeGroupMuting)).thenReturn(useGroupMuting);
+
+        CarAudioService audioCarAudioService = new CarAudioService(mMockContext, mAudioManager,
+                mTempCarAudioConfigFile.getFile().getAbsolutePath(), mCarVolumeCallbackHandler,
+                /* audioFadeConfigurationPath= */ null);
+        audioCarAudioService.init();
+        return audioCarAudioService;
+    }
+
+    private CarAudioService setUpCarAudioServiceWithDuckingConfiguredInFile(int resourceId,
+            boolean useHALDucking) throws Exception {
+        setUpTempFileForAudioConfiguration(resourceId);
+        when(mMockResources.getBoolean(audioUseHalDuckingSignals)).thenReturn(useHALDucking);
+
+        CarAudioService audioCarAudioService = new CarAudioService(mMockContext, mAudioManager,
+                mTempCarAudioConfigFile.getFile().getAbsolutePath(), mCarVolumeCallbackHandler,
+                /* audioFadeConfigurationPath= */ null);
+        audioCarAudioService.init();
+        return audioCarAudioService;
+    }
+
     private void mockGrantCarControlAudioSettingsPermission() {
         mockContextCheckCallingOrSelfPermission(mMockContext,
                 PERMISSION_CAR_CONTROL_AUDIO_SETTINGS, PERMISSION_GRANTED);
diff --git a/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZoneUnitTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZoneUnitTest.java
index 89a876f742..fce743439c 100644
--- a/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZoneUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZoneUnitTest.java
@@ -182,7 +182,7 @@ public final class CarAudioZoneUnitTest extends AbstractExpectableTestCase {
         expectWithMessage("Default configuration on init")
                 .that(mTestAudioZone.getCurrentCarAudioZoneConfig()).isEqualTo(mMockZoneConfig0);
         verify(mMockZoneConfig0).synchronizeCurrentGainIndex();
-        verify(mMockZoneConfig1).synchronizeCurrentGainIndex();
+        verify(mMockZoneConfig1, never()).synchronizeCurrentGainIndex();
     }
 
     @Test
diff --git a/tests/carservice_test/src/com/android/car/audio/CarAudioZonesHelperLegacyTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesHelperLegacyUnitTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/audio/CarAudioZonesHelperLegacyTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesHelperLegacyUnitTest.java
index 37b792b3dc..fd21cd5fb5 100644
--- a/tests/carservice_test/src/com/android/car/audio/CarAudioZonesHelperLegacyTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesHelperLegacyUnitTest.java
@@ -65,7 +65,7 @@ import java.util.stream.Collectors;
 import java.util.stream.IntStream;
 
 @RunWith(AndroidJUnit4.class)
-public class CarAudioZonesHelperLegacyTest {
+public class CarAudioZonesHelperLegacyUnitTest {
 
     private static final int INVALID_BUS = -1;
 
diff --git a/tests/carservice_test/src/com/android/car/audio/CarAudioZonesHelperTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesHelperUnitTest.java
similarity index 81%
rename from tests/carservice_test/src/com/android/car/audio/CarAudioZonesHelperTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesHelperUnitTest.java
index fea38cf325..fc1a5df2b0 100644
--- a/tests/carservice_test/src/com/android/car/audio/CarAudioZonesHelperTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesHelperUnitTest.java
@@ -40,11 +40,14 @@ import static org.mockito.Mockito.when;
 
 import android.car.Car;
 import android.car.feature.Flags;
+import android.car.media.CarAudioZoneConfigInfo;
 import android.car.test.AbstractExpectableTestCase;
 import android.content.Context;
 import android.media.AudioAttributes;
 import android.media.AudioDeviceAttributes;
 import android.media.AudioDeviceInfo;
+import android.platform.test.annotations.DisableFlags;
+import android.platform.test.annotations.EnableFlags;
 import android.platform.test.flag.junit.SetFlagsRule;
 import android.util.SparseArray;
 import android.util.SparseIntArray;
@@ -76,7 +79,7 @@ import java.util.MissingResourceException;
 import java.util.stream.Collectors;
 
 @RunWith(MockitoJUnitRunner.class)
-public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
+public final class CarAudioZonesHelperUnitTest extends AbstractExpectableTestCase {
 
     private static final CarAudioContextInfo OEM_CONTEXT_INFO_MUSIC =
             new CarAudioContextInfo(new AudioAttributes[] {
@@ -166,25 +169,36 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
     public static final int TEST_ANNOUNCEMENT_CONTEXT_ID = TEST_CAR_AUDIO_CONTEXT
             .getContextForAudioAttribute(CarAudioContext
                     .getAudioAttributeFromUsage(USAGE_ANNOUNCEMENT));
-    private static final String BUS_MIRROR_DEVICE_1 = "mirror_bus_device_1";
-    private static final String BUS_MIRROR_DEVICE_2 = "mirror_bus_device_2";
+    private static final String MIRROR_TEST_DEVICE = "mirror_bus_device";;
     private static final String PRIMARY_ZONE_NAME = "primary zone";
     private static final String PRIMARY_ZONE_CONFIG_NAME = "primary zone config 1";
-    private static final String REAR_ZONE_CONFIG_NAME_1 = "rear seat zone config 1";
-    private static final String REAR_ZONE_CONFIG_NAME_2 = "rear seat zone config 2";
-
-    private static final String BUS_0_ADDRESS = "bus0_media_out";
-    private static final String BUS_1_ADDRESS = "bus1_navigation_out";
-    private static final String BUS_3_ADDRESS = "bus3_call_ring_out";
-    private static final String BUS_100_ADDRESS = "bus100_rear_seat";
-    private static final String BUS_101_ADDRESS = "bus101_rear_seat";
-    private static final String BUS_1000_ADDRESS_DOES_NOT_EXIST = "bus1000_does_not_exist";
+    private static final String SECONDARY_ZONE_CONFIG_NAME_1 = "secondary zone config 1";
+    private static final String SECONDARY_ZONE_CONFIG_NAME_2 = "secondary zone config 2";
+
+    private static final String MEDIA_TEST_DEVICE = "media_bus_device";
+    private static final String NAVIGATION_TEST_DEVICE = "navigation_bus_device";
+    private static final String CALL_TEST_DEVICE = "call_bus_device";
+    private static final String NOTIFICATION_TEST_DEVICE = "notification_bus_device";
+    private static final String VOICE_TEST_DEVICE = "voice_bus_device";
+    private static final String RING_TEST_DEVICE = "ring_bus_device";
+    private static final String ALARM_TEST_DEVICE = "alarm_bus_device";
+    private static final String SYSTEM_BUS_DEVICE = "system_bus_device";
+    private static final String SECONDARY_TEST_DEVICE_CONFIG_0 = "secondary_zone_bus_100";
+    private static final String SECONDARY_TEST_DEVICE_CONFIG_1_0 = "secondary_zone_bus_200";
+    private static final String SECONDARY_TEST_DEVICE_CONFIG_1_1 = "secondary_zone_bus_201";
+    private static final String TERTIARY_TEST_DEVICE_1 = "tertiary_zone_bus_100";
+    private static final String TERTIARY_TEST_DEVICE_2 = "tertiary_zone_bus_200";
+    private static final String QUATERNARY_TEST_DEVICE_1 = "quaternary_zone_bus_1";
+    private static final String TEST_REAR_ROW_3_DEVICE = "rear_row_three_zone_bus_1";
+    private static final String OEM_TEST_DEVICE = "oem_bus_device";
+    private static final String ADDRESS_DOES_NOT_EXIST_DEVICE = "bus1000_does_not_exist";
 
     private static final String PRIMARY_ZONE_MICROPHONE_ADDRESS = "Built-In Mic";
     private static final String PRIMARY_ZONE_FM_TUNER_ADDRESS = "fm_tuner";
     private static final String SECONDARY_ZONE_BACK_MICROPHONE_ADDRESS = "Built-In Back Mic";
     private static final String SECONDARY_ZONE_BUS_1000_INPUT_ADDRESS = "bus_1000_input";
 
+    private static final int PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME = 3;
     private static final int PRIMARY_ZONE_GROUP_0_ACTIVATION_VOLUME_TYPE =
             CarActivationVolumeConfig.ACTIVATION_VOLUME_ON_BOOT;
     private static final int PRIMARY_ZONE_DEFAULT_ACTIVATION_VOLUME_TYPE =
@@ -193,7 +207,8 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
                     | CarActivationVolumeConfig.ACTIVATION_VOLUME_ON_PLAYBACK_CHANGED;
 
     private static final int PRIMARY_OCCUPANT_ID = 1;
-    private static final int SECONDARY_ZONE_ID = 2;
+    private static final int SECONDARY_ZONE_ID = 1;
+    private static final int ZONE_NUM = 2;
     private List<CarAudioDeviceInfo> mCarAudioOutputDeviceInfos;
     private AudioDeviceInfo[] mInputAudioDeviceInfos;
     private InputStream mInputStream;
@@ -203,9 +218,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
     private AudioManagerWrapper mAudioManagerWrapper;
 
     @Mock
-    private CarAudioDeviceInfo mTestCarMirrorDeviceOne;
-    @Mock
-    private CarAudioDeviceInfo mTestCarMirrorDeviceTwo;
+    private CarAudioDeviceInfo mTestCarMirrorDevice;
     @Mock
     private LocalLog mServiceEventLogger;
 
@@ -229,7 +242,8 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         mCarAudioOutputDeviceInfos = generateCarDeviceInfos();
         mInputAudioDeviceInfos = generateInputDeviceInfos();
         mContext = ApplicationProvider.getApplicationContext();
-        mInputStream = mContext.getResources().openRawResource(R.raw.car_audio_configuration);
+        mInputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_two_zones);
         mCarAudioSettings = mock(CarAudioSettings.class);
         mockCarGetPlatformVersion(UPSIDE_DOWN_CAKE_0);
     }
@@ -243,20 +257,29 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
     }
 
     private List<CarAudioDeviceInfo> generateCarDeviceInfos() {
-        mTestCarMirrorDeviceOne = generateCarAudioDeviceInfo(BUS_MIRROR_DEVICE_1);
-        mTestCarMirrorDeviceTwo = generateCarAudioDeviceInfo(BUS_MIRROR_DEVICE_2);
+        mTestCarMirrorDevice = generateCarAudioDeviceInfo(MIRROR_TEST_DEVICE);
         return ImmutableList.of(
-                generateCarAudioDeviceInfo(BUS_0_ADDRESS),
-                generateCarAudioDeviceInfo(BUS_1_ADDRESS),
-                generateCarAudioDeviceInfo(BUS_3_ADDRESS),
-                generateCarAudioDeviceInfo(BUS_100_ADDRESS),
-                generateCarAudioDeviceInfo(BUS_101_ADDRESS),
+                generateCarAudioDeviceInfo(MEDIA_TEST_DEVICE),
+                generateCarAudioDeviceInfo(NAVIGATION_TEST_DEVICE),
+                generateCarAudioDeviceInfo(CALL_TEST_DEVICE),
+                generateCarAudioDeviceInfo(NOTIFICATION_TEST_DEVICE),
+                generateCarAudioDeviceInfo(VOICE_TEST_DEVICE),
+                generateCarAudioDeviceInfo(RING_TEST_DEVICE),
+                generateCarAudioDeviceInfo(ALARM_TEST_DEVICE),
+                generateCarAudioDeviceInfo(SYSTEM_BUS_DEVICE),
+                generateCarAudioDeviceInfo(SECONDARY_TEST_DEVICE_CONFIG_0),
+                generateCarAudioDeviceInfo(SECONDARY_TEST_DEVICE_CONFIG_1_0),
+                generateCarAudioDeviceInfo(SECONDARY_TEST_DEVICE_CONFIG_1_1),
+                generateCarAudioDeviceInfo(TERTIARY_TEST_DEVICE_1),
+                generateCarAudioDeviceInfo(QUATERNARY_TEST_DEVICE_1),
+                generateCarAudioDeviceInfo(TERTIARY_TEST_DEVICE_2),
+                generateCarAudioDeviceInfo(TEST_REAR_ROW_3_DEVICE),
+                generateCarAudioDeviceInfo(OEM_TEST_DEVICE),
                 generateCarAudioDeviceInfo(""),
                 generateCarAudioDeviceInfo(""),
                 generateCarAudioDeviceInfo(null),
                 generateCarAudioDeviceInfo(null),
-                mTestCarMirrorDeviceOne,
-                mTestCarMirrorDeviceTwo
+                mTestCarMirrorDevice
         );
     }
 
@@ -302,7 +325,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
 
         SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
-        expectWithMessage("Zones parsed").that(zones.size()).isEqualTo(2);
+        expectWithMessage("Zones parsed").that(zones.size()).isEqualTo(ZONE_NUM);
     }
 
     @Test
@@ -319,7 +342,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
             SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
             expectWithMessage("Zones parsed for version-two configuration")
-                    .that(zones.size()).isEqualTo(2);
+                    .that(zones.size()).isEqualTo(ZONE_NUM);
         }
     }
 
@@ -336,7 +359,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
 
             SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
-            assertThat(zones.size()).isEqualTo(2);
+            assertThat(zones.size()).isEqualTo(ZONE_NUM);
         }
     }
 
@@ -469,7 +492,8 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
         expectWithMessage("Primary zone").that(zones.get(0).isPrimaryZone()).isTrue();
-        expectWithMessage("Primary secondary zone").that(zones.get(2).isPrimaryZone()).isFalse();
+        expectWithMessage("Primary secondary zone").that(zones.get(SECONDARY_ZONE_ID)
+                .isPrimaryZone()).isFalse();
     }
 
     @Test
@@ -488,7 +512,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
             expectWithMessage("Primary zone in version-two configuration")
                     .that(zones.get(0).isPrimaryZone()).isTrue();
             expectWithMessage("Primary secondary zone in version-two configuration")
-                    .that(zones.get(2).isPrimaryZone()).isFalse();
+                    .that(zones.get(SECONDARY_ZONE_ID).isPrimaryZone()).isFalse();
         }
     }
 
@@ -509,13 +533,14 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
                 .that(primaryZoneConfigs.get(0).getName()).isEqualTo(PRIMARY_ZONE_CONFIG_NAME);
         expectWithMessage("Primary zone default config")
                 .that(primaryZoneConfigs.get(0).isDefault()).isTrue();
-        List<CarAudioZoneConfig> secondaryZoneConfigs = zones.get(2).getAllCarAudioZoneConfigs();
+        List<CarAudioZoneConfig> secondaryZoneConfigs = zones.get(SECONDARY_ZONE_ID)
+                .getAllCarAudioZoneConfigs();
         expectWithMessage("Secondary zone configs")
                 .that(secondaryZoneConfigs.size()).isEqualTo(2);
         expectWithMessage("Secondary zone config names")
                 .that(List.of(secondaryZoneConfigs.get(0).getName(),
                         secondaryZoneConfigs.get(1).getName()))
-                .containsExactly(REAR_ZONE_CONFIG_NAME_1, REAR_ZONE_CONFIG_NAME_2);
+                .containsExactly(SECONDARY_ZONE_CONFIG_NAME_1, SECONDARY_ZONE_CONFIG_NAME_2);
     }
 
     @Test
@@ -532,9 +557,10 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         CarAudioZoneConfig primaryZoneConfig = zones.get(0).getCurrentCarAudioZoneConfig();
         expectWithMessage("Default primary zone config name")
                 .that(primaryZoneConfig.getName()).isEqualTo(PRIMARY_ZONE_CONFIG_NAME);
-        CarAudioZoneConfig secondaryZoneConfig = zones.get(2).getCurrentCarAudioZoneConfig();
+        CarAudioZoneConfig secondaryZoneConfig = zones.get(SECONDARY_ZONE_ID)
+                .getCurrentCarAudioZoneConfig();
         expectWithMessage("Default secondary zone config name")
-                .that(secondaryZoneConfig.getName()).isEqualTo(REAR_ZONE_CONFIG_NAME_1);
+                .that(secondaryZoneConfig.getName()).isEqualTo(SECONDARY_ZONE_CONFIG_NAME_1);
     }
 
     @Test
@@ -549,9 +575,9 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
         CarAudioZone primaryZone = zones.get(0);
-        CarAudioZone secondaryZone = zones.get(2);
+        CarAudioZone secondaryZone = zones.get(SECONDARY_ZONE_ID);
         expectWithMessage("Volume group count for primary zone")
-                .that(primaryZone.getCurrentVolumeGroupCount()).isEqualTo(2);
+                .that(primaryZone.getCurrentVolumeGroupCount()).isEqualTo(4);
         expectWithMessage("Volume group count for secondary zone")
                 .that(secondaryZone.getCurrentVolumeGroupCount()).isEqualTo(1);
     }
@@ -571,7 +597,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
 
             CarAudioZone primaryZone = zones.get(0);
             expectWithMessage("Volume group count for primary zone in version-two configuration")
-                    .that(primaryZone.getCurrentVolumeGroupCount()).isEqualTo(2);
+                    .that(primaryZone.getCurrentVolumeGroupCount()).isEqualTo(4);
         }
     }
 
@@ -589,13 +615,13 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         CarAudioZone primaryZone = zones.get(0);
         CarVolumeGroup primaryVolumeGroup = primaryZone.getCurrentVolumeGroups()[0];
         List<String> primaryAddresses = primaryVolumeGroup.getAddresses();
-        expectWithMessage("Primary zone addresses")
-                .that(primaryAddresses).containsExactly(BUS_0_ADDRESS, BUS_3_ADDRESS);
-        CarAudioZone secondaryZone = zones.get(2);
+        expectWithMessage("Primary zone addresses").that(primaryAddresses)
+                .containsExactly(MEDIA_TEST_DEVICE, NOTIFICATION_TEST_DEVICE);
+        CarAudioZone secondaryZone = zones.get(SECONDARY_ZONE_ID);
         CarVolumeGroup secondaryVolumeGroup = secondaryZone.getCurrentVolumeGroups()[0];
         List<String> secondaryAddresses = secondaryVolumeGroup.getAddresses();
         expectWithMessage("Secondary zone addresses")
-                .that(secondaryAddresses).containsExactly(BUS_100_ADDRESS);
+                .that(secondaryAddresses).containsExactly(SECONDARY_TEST_DEVICE_CONFIG_0);
     }
 
     @Test
@@ -615,7 +641,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
             CarVolumeGroup volumeGroup = primaryZone.getCurrentVolumeGroups()[0];
             List<String> addresses = volumeGroup.getAddresses();
             expectWithMessage("Primary zone addresses")
-                    .that(addresses).containsExactly(BUS_0_ADDRESS, BUS_3_ADDRESS);
+                    .that(addresses).containsExactly(MEDIA_TEST_DEVICE, NOTIFICATION_TEST_DEVICE);
         }
     }
 
@@ -631,13 +657,16 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
         CarVolumeGroup volumeGroup = zones.get(0).getCurrentVolumeGroups()[0];
-        expectWithMessage("Contexts of primary zone address " + BUS_0_ADDRESS)
-                .that(volumeGroup.getContextsForAddress(BUS_0_ADDRESS))
+        expectWithMessage("Contexts of primary zone address " + MEDIA_TEST_DEVICE)
+                .that(volumeGroup.getContextsForAddress(MEDIA_TEST_DEVICE))
                 .containsExactly(TEST_CAR_AUDIO_CONTEXT.getContextForAttributes(CarAudioContext
-                        .getAudioAttributeFromUsage(AudioAttributes.USAGE_MEDIA)));
-        CarVolumeGroup rseVolumeGroup = zones.get(2).getCurrentVolumeGroups()[0];
-        List<Integer> contextForBusList = rseVolumeGroup.getContextsForAddress(BUS_100_ADDRESS);
-        expectWithMessage("Contexts of secondary zone address" + BUS_100_ADDRESS)
+                        .getAudioAttributeFromUsage(AudioAttributes.USAGE_MEDIA)),
+                        TEST_CAR_AUDIO_CONTEXT.getContextForAttributes(CarAudioContext
+                                .getAudioAttributeFromUsage(AudioAttributes.USAGE_ANNOUNCEMENT)));
+        CarVolumeGroup rseVolumeGroup = zones.get(SECONDARY_ZONE_ID).getCurrentVolumeGroups()[0];
+        List<Integer> contextForBusList = rseVolumeGroup.getContextsForAddress(
+                SECONDARY_TEST_DEVICE_CONFIG_0);
+        expectWithMessage("Contexts of secondary zone address" + SECONDARY_TEST_DEVICE_CONFIG_0)
                 .that(contextForBusList).containsExactlyElementsIn(TEST_CAR_AUDIO_CONTEXT
                 .getAllContextsIds());
     }
@@ -682,14 +711,18 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
 
             CarVolumeGroup volumeGroup = zones.get(0).getCurrentVolumeGroups()[0];
             expectWithMessage("Contexts of primary zone address in version-two configuration"
-                    + BUS_0_ADDRESS).that(volumeGroup.getContextsForAddress(BUS_0_ADDRESS))
+                    + MEDIA_TEST_DEVICE).that(volumeGroup.getContextsForAddress(MEDIA_TEST_DEVICE))
                     .containsExactly(TEST_CAR_AUDIO_CONTEXT.getContextForAttributes(CarAudioContext
-                            .getAudioAttributeFromUsage(AudioAttributes.USAGE_MEDIA)));
-            CarVolumeGroup rseVolumeGroup = zones.get(2).getCurrentVolumeGroups()[0];
+                            .getAudioAttributeFromUsage(AudioAttributes.USAGE_MEDIA)),
+                            TEST_CAR_AUDIO_CONTEXT.getContextForAttributes(CarAudioContext
+                                    .getAudioAttributeFromUsage(
+                                            AudioAttributes.USAGE_ANNOUNCEMENT)));
+            CarVolumeGroup rseVolumeGroup = zones.get(SECONDARY_ZONE_ID)
+                    .getCurrentVolumeGroups()[0];
             List<Integer> contextForBus100List =
-                    rseVolumeGroup.getContextsForAddress(BUS_100_ADDRESS);
+                    rseVolumeGroup.getContextsForAddress(SECONDARY_TEST_DEVICE_CONFIG_0);
             expectWithMessage("Contexts of secondary zone address in version-two configuration"
-                    + BUS_100_ADDRESS).that(contextForBus100List)
+                    + SECONDARY_TEST_DEVICE_CONFIG_0).that(contextForBus100List)
                     .containsExactlyElementsIn(TEST_CAR_AUDIO_CONTEXT.getAllContextsIds());
         }
     }
@@ -744,7 +777,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
     @Test
     public void loadAudioZones_passesOnMissingAudioZoneIdForPrimary() throws Exception {
         try (InputStream missingAudioZoneIdStream = mContext.getResources().openRawResource(
-                R.raw.car_audio_configuration_no_audio_zone_id_for_primary_zone)) {
+                R.raw.car_audio_configuration_missing_audio_zone_id_for_primary_zone)) {
             CarAudioZonesHelper cazh =
                     new CarAudioZonesHelper(mAudioManagerWrapper,
                             mCarAudioSettings, missingAudioZoneIdStream,
@@ -756,7 +789,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
 
             SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
-            assertThat(zones.size()).isEqualTo(2);
+            assertThat(zones.size()).isEqualTo(ZONE_NUM);
             assertThat(zones.contains(PRIMARY_AUDIO_ZONE)).isTrue();
             assertThat(zones.contains(SECONDARY_ZONE_ID)).isTrue();
         }
@@ -897,7 +930,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
             assertThat(primaryZoneInputAddresses).containsExactly(PRIMARY_ZONE_FM_TUNER_ADDRESS,
                     PRIMARY_ZONE_MICROPHONE_ADDRESS).inOrder();
 
-            CarAudioZone secondaryZone = zones.get(1);
+            CarAudioZone secondaryZone = zones.get(SECONDARY_ZONE_ID);
             List<AudioDeviceAttributes> secondaryZoneInputDevices =
                     secondaryZone.getInputAudioDevices();
             List<String> secondaryZoneInputAddresses =
@@ -1257,7 +1290,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
             IllegalStateException thrown =
                     assertThrows(IllegalStateException.class,
                             () -> cazh.loadAudioZones());
-            assertThat(thrown).hasMessageThat().contains(BUS_1000_ADDRESS_DOES_NOT_EXIST);
+            assertThat(thrown).hasMessageThat().contains(ADDRESS_DOES_NOT_EXIST_DEVICE);
         }
     }
 
@@ -1347,6 +1380,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
     }
 
     @Test
+    @DisableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
     public void loadAudioZones_usingCoreAudioVersionThree_failsOnEmptyGroupName()
             throws Exception {
         try (InputStream versionOneStream = mContext.getResources().openRawResource(
@@ -1366,6 +1400,27 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         }
     }
 
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_usingCoreVolumeAndWithoutVolumeGroupNames()
+            throws Exception {
+        try (InputStream versionOneStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_using_core_volume_config_and_missing_group_names)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, versionOneStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioVolume= */ true, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Parsed zones with wrong use volume group config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use core volume config").that(cazh.useCoreAudioVolume()).isFalse();
+        }
+    }
+
     @Test
     public void loadAudioZones_usingCoreAudioVersionThree_failsOnInvalidOrder()
             throws Exception {
@@ -1435,7 +1490,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         cazh.loadAudioZones();
 
         expectWithMessage("Mirror devices").that(cazh.getMirrorDeviceInfos())
-                .containsExactly(mTestCarMirrorDeviceOne, mTestCarMirrorDeviceTwo);
+                .containsExactly(mTestCarMirrorDevice);
     }
 
     @Test
@@ -1494,36 +1549,66 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
     }
 
     @Test
-    public void loadAudioZones_withPrimaryZoneAndDynamicAudioDevices() throws Exception {
-        mSetFlagsRule.enableFlags(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES);
+    @EnableFlags({Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES})
+    public void loadAudioZones_withPrimaryZoneAndDynamicAudioDevicesAndCoreVolumeEnabled()
+            throws Exception {
         try (InputStream versionFourStream = mContext.getResources().openRawResource(
                 R.raw.car_audio_configuration_with_dynamic_devices_for_primary_zone)) {
             CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
                     mCarAudioSettings, versionFourStream, mCarAudioOutputDeviceInfos,
                     mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
-                    /* useCoreAudioVolume= */ false, /* useCoreAudioRouting= */ false,
+                    /* useCoreAudioVolume= */ true, /* useCoreAudioRouting= */ false,
                     /* useFadeManagerConfiguration= */ false,
                     /* carAudioFadeConfigurationHelper= */ null);
 
             SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
             expectWithMessage("Primary zone with dynamic device configurations")
-                    .that(zones.size()).isEqualTo(1);
+                    .that(zones.size()).isAtLeast(1);
             CarAudioZone zone = zones.get(0);
             List<CarAudioZoneConfig> configs = zone.getAllCarAudioZoneConfigs();
             expectWithMessage("Configurations for primary zone with dynamic devices")
                     .that(configs).hasSize(3);
             CarAudioZoneConfig configBTMedia = configs.get(1);
-            CarVolumeGroup mediaVolumeGroup = configBTMedia.getVolumeGroup("media");
+            CarVolumeGroup mediaBTVolumeGroup = configBTMedia.getVolumeGroup("MUSIC_GROUP");
             expectWithMessage("Media BT dynamic device").that(
-                    mediaVolumeGroup.getAudioDeviceForContext(OEM_CONTEXT_INFO_MUSIC.getId())
+                    mediaBTVolumeGroup.getAudioDeviceForContext(OEM_CONTEXT_INFO_MUSIC.getId())
                             .getType()).isEqualTo(AudioDeviceInfo.TYPE_BLUETOOTH_A2DP);
-            CarAudioZoneConfig configBTAll = configs.get(2);
-            List<AudioDeviceAttributes> allDevices = configBTAll.getAudioDevice();
-            expectWithMessage("BT all audio config devices").that(allDevices).hasSize(1);
-            AudioDeviceAttributes btDevice = allDevices.get(0);
-            expectWithMessage("BT all audio config type").that(btDevice.getType())
-                    .isEqualTo(AudioDeviceInfo.TYPE_BLUETOOTH_A2DP);
+            CarAudioZoneConfig configHeadphoneMedia = configs.get(2);
+            CarVolumeGroup mediaHeadphoneVolumeGroup = configHeadphoneMedia
+                    .getVolumeGroup("MUSIC_GROUP");
+            expectWithMessage("Media BT dynamic device").that(
+                    mediaHeadphoneVolumeGroup.getAudioDeviceForContext(OEM_CONTEXT_INFO_MUSIC
+                                    .getId()).getType())
+                    .isEqualTo(AudioDeviceInfo.TYPE_WIRED_HEADPHONES);
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES})
+    public void loadAudioZones_withPrimaryZoneAndDynamicAudioDevicesAndCoreVolumeDisabled()
+            throws Exception {
+        try (InputStream versionFourStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_dynamic_devices_for_primary_zone)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, versionFourStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioVolume= */ false, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone without dynamic device configurations")
+                    .that(zones.size()).isAtLeast(1);
+            CarAudioZone zone = zones.get(0);
+            List<CarAudioZoneConfig> configs = zone.getAllCarAudioZoneConfigs();
+            expectWithMessage("Configurations for primary zone without dynamic devices")
+                    .that(configs).hasSize(1);
+            CarAudioZoneConfigInfo defaultConfig = configs.get(0).getCarAudioZoneConfigInfo();
+            expectWithMessage("Default config after failing to load dynamic configurations")
+                    .that(CarAudioUtils.getDynamicDevicesInConfig(defaultConfig,
+                            mAudioManagerWrapper)).isEmpty();
         }
     }
 
@@ -1563,7 +1648,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
             SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
 
             expectWithMessage("Primary zone with dynamic device configurations"
-                    + " and dynamic flag disabled").that(zones.size()).isEqualTo(1);
+                    + " and dynamic flag disabled").that(zones.size()).isAtLeast(1);
             CarAudioZone zone = zones.get(0);
             List<CarAudioZoneConfig> configs = zone.getAllCarAudioZoneConfigs();
             expectWithMessage("Configurations for primary zone with dynamic devices"
@@ -1599,14 +1684,18 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
                     "Primary zone volume group 0 max activation volume with disabled flag")
                     .that(volumeGroups[0].getMaxActivationGainIndex())
                     .isEqualTo(volumeGroups[0].getMaxGainIndex());
-            expectWithMessage(
-                    "Primary zone volume group 1 min activation volume with disabled flag")
-                    .that(volumeGroups[1].getMinActivationGainIndex())
-                    .isEqualTo(volumeGroups[1].getMinGainIndex());
-            expectWithMessage(
-                    "Primary zone volume group 1 max activation volume with disabled flag")
-                    .that(volumeGroups[1].getMaxActivationGainIndex())
-                    .isEqualTo(volumeGroups[1].getMaxGainIndex());
+            expectWithMessage("Primary zone volume group min activation volume with disabled flag"
+                            + " and without activation config")
+                    .that(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getMinActivationGainIndex())
+                    .isEqualTo(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getMinGainIndex());
+            expectWithMessage("Primary zone volume group max activation volume with disabled flag"
+                    + " and without activation config")
+                    .that(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getMaxActivationGainIndex())
+                    .isEqualTo(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getMaxGainIndex());
         }
     }
 
@@ -1635,14 +1724,20 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
             expectWithMessage("Primary zone volume group 0 activation volume invocation types")
                     .that(volumeGroups[0].getActivationVolumeInvocationType())
                     .isEqualTo(PRIMARY_ZONE_GROUP_0_ACTIVATION_VOLUME_TYPE);
-            expectWithMessage("Primary zone volume group 1 min activation volume")
-                    .that(volumeGroups[1].getMinActivationGainIndex())
-                    .isEqualTo(volumeGroups[1].getMinGainIndex());
-            expectWithMessage("Primary zone volume group 1 max activation volume")
-                    .that(volumeGroups[1].getMaxActivationGainIndex())
-                    .isEqualTo(volumeGroups[1].getMaxGainIndex());
-            expectWithMessage("Primary zone volume group 1 activation volume invocation types")
-                    .that(volumeGroups[1].getActivationVolumeInvocationType())
+            expectWithMessage("Primary zone volume group min activation volume with activation"
+                    + " config").that(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getMinActivationGainIndex())
+                    .isEqualTo(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getMinGainIndex());
+            expectWithMessage("Primary zone volume group max activation volume with activation"
+                    + " config").that(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getMaxActivationGainIndex())
+                    .isEqualTo(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getMaxGainIndex());
+            expectWithMessage("Primary zone volume group activation volume invocation types with"
+                    + " activation config")
+                    .that(volumeGroups[PRIMARY_ZONE_GROUP_ID_WITHOUT_ACTIVATION_VOLUME]
+                            .getActivationVolumeInvocationType())
                     .isEqualTo(PRIMARY_ZONE_DEFAULT_ACTIVATION_VOLUME_TYPE);
         }
     }
@@ -1777,7 +1872,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
             throws Exception {
         mSetFlagsRule.enableFlags(Flags.FLAG_CAR_AUDIO_MIN_MAX_ACTIVATION_VOLUME);
         try (InputStream versionFourStream = mContext.getResources().openRawResource(
-                R.raw.car_audio_configuration_without_activation_volume_config_name)) {
+                R.raw.car_audio_configuration_missing_activation_volume_config_name)) {
             CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
                     mCarAudioSettings, versionFourStream, mCarAudioOutputDeviceInfos,
                     mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
@@ -1887,8 +1982,8 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         mSetFlagsRule.enableFlags(Flags.FLAG_CAR_AUDIO_FADE_MANAGER_CONFIGURATION);
         CarAudioFadeConfigurationHelper fadeConfiguration = getCarAudioFadeConfigurationHelper(
                 R.raw.car_audio_fade_configuration);
-        try (InputStream versionFourStream = mContext.getResources().openRawResource(
-                R.raw.car_audio_configuration_apply_fade_configs_with_neitherDefaultNorTransient)) {
+        try (InputStream versionFourStream = mContext.getResources().openRawResource(R.raw
+                .car_audio_configuration_apply_fade_configs_with_neither_default_nor_transient)) {
             CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
                     mCarAudioSettings, versionFourStream, mCarAudioOutputDeviceInfos,
                     mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
@@ -1949,7 +2044,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
     @Test
     public void loadAudioZones_withoutZones_fails() throws Exception {
         try (InputStream v1NonLegacyContextStream = mContext.getResources().openRawResource(
-                R.raw.car_audio_configuration_without_zones)) {
+                R.raw.car_audio_configuration_missing_zones)) {
 
             CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
                     mCarAudioSettings, v1NonLegacyContextStream, mCarAudioOutputDeviceInfos,
@@ -1969,7 +2064,7 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
     @Test
     public void loadAudioZones_withoutPrimaryZone_fails() throws Exception {
         try (InputStream v1NonLegacyContextStream = mContext.getResources().openRawResource(
-                R.raw.car_audio_configuration_without_primary_zone)) {
+                R.raw.car_audio_configuration_missing_primary_zone)) {
 
             CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
                     mCarAudioSettings, v1NonLegacyContextStream, mCarAudioOutputDeviceInfos,
@@ -2080,6 +2175,256 @@ public final class CarAudioZonesHelperTest extends AbstractExpectableTestCase {
         }
     }
 
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withInvalidDeviceConfig()
+            throws Exception {
+        boolean useCoreVolume = true;
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_invalid_device_config)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    useCoreVolume, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with invalid device config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use core volume config with invalid device config")
+                    .that(cazh.useCoreAudioVolume()).isEqualTo(useCoreVolume);
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withUseCoreVolumeDeviceConfig()
+            throws Exception {
+        boolean useCoreVolume = false;
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_use_core_volume)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    useCoreVolume, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with invalid device config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use core volume config with use core volume device config")
+                    .that(cazh.useCoreAudioVolume()).isTrue();
+        }
+    }
+
+    @Test
+    @DisableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withUseCoreVolumeDeviceConfigAndVendorFreezeFlagDisabled()
+            throws Exception {
+        boolean useCoreVolume = false;
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_use_core_volume)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    useCoreVolume, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with invalid device config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use core volume config with invalid use core volume device config")
+                    .that(cazh.useCoreAudioVolume()).isEqualTo(useCoreVolume);
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withEmptyUseCoreVolumeDeviceConfig()
+            throws Exception {
+        boolean useCoreVolume = true;
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_empty_use_core_volume_config)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    useCoreVolume, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with empty use core volume config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use core volume config with empty use core volume device config")
+                    .that(cazh.useCoreAudioVolume()).isEqualTo(useCoreVolume);
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withMultipleDefinitionsOfUseCoreVolumeDeviceConfig()
+            throws Exception {
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_multiple_use_core_volume_config)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioRouting= */ false, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with multiple use core volume config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use core volume config with multiple use core volume device config")
+                    .that(cazh.useCoreAudioVolume()).isTrue();
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withUseCoreRoutingDeviceConfig()
+            throws Exception {
+        boolean useCoreRouting = false;
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_using_core_routing)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioVolume= */ true, useCoreRouting,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with use core routing enabled")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use core volume config with use core routing enabled")
+                    .that(cazh.useCoreAudioRouting()).isTrue();
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withInvalidUseCoreRoutingDeviceConfig()
+            throws Exception {
+        boolean useCoreRouting = false;
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_invalid_use_core_routing)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioRouting= */ true, useCoreRouting,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with invalid use core routing enabled")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use core volume config with invalid use core routing enabled")
+                    .that(cazh.useCoreAudioRouting()).isEqualTo(useCoreRouting);
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withUseCarVolumeGroupMutingConfig()
+            throws Exception {
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_valid_use_group_muting_config)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioVolume= */ true, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with valid use group muting config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use group muting config with valid use group muting config")
+                    .that(cazh.useVolumeGroupMuting()).isTrue();
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withInvalidUseCarVolumeGroupMutingConfig()
+            throws Exception {
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_invalid_use_group_muting_config)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioVolume= */ true, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with invalid use group muting config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use group muting config with invalid use group muting config")
+                    .that(cazh.useVolumeGroupMuting()).isFalse();
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withUseHalDuckingSignalsConfig()
+            throws Exception {
+        boolean defaultUseHalDuckingSignal = false;
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_valid_use_hal_ducking_config)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioVolume= */ false, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with valid use HAL ducking config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use HAL ducking config with valid use HAL ducking config")
+                    .that(cazh.useHalDuckingSignalOrDefault(defaultUseHalDuckingSignal)).isTrue();
+        }
+    }
+
+    @Test
+    @EnableFlags({Flags.FLAG_AUDIO_VENDOR_FREEZE_IMPROVEMENTS})
+    public void loadAudioZones_withInvalidUseHalDuckingSignalsConfig()
+            throws Exception {
+        boolean defaultUseHalDuckingSignal = false;
+        try (InputStream inputStream = mContext.getResources().openRawResource(
+                R.raw.car_audio_configuration_with_invalid_use_hal_ducking_config)) {
+            CarAudioZonesHelper cazh = new CarAudioZonesHelper(mAudioManagerWrapper,
+                    mCarAudioSettings, inputStream, mCarAudioOutputDeviceInfos,
+                    mInputAudioDeviceInfos, mServiceEventLogger, /* useCarVolumeGroupMute= */ false,
+                    /* useCoreAudioVolume= */ false, /* useCoreAudioRouting= */ false,
+                    /* useFadeManagerConfiguration= */ false,
+                    /* carAudioFadeConfigurationHelper= */ null);
+
+            SparseArray<CarAudioZone> zones = cazh.loadAudioZones();
+
+            expectWithMessage("Primary zone with invalid use HAL ducking config")
+                    .that(zones.size()).isEqualTo(1);
+            expectWithMessage("Use HAL ducking config with invalid use HAL ducking config")
+                    .that(cazh.useHalDuckingSignalOrDefault(defaultUseHalDuckingSignal)).isFalse();
+        }
+    }
+
     private CarAudioFadeConfigurationHelper getCarAudioFadeConfigurationHelper(int resource) {
         try (InputStream inputStream = mContext.getResources().openRawResource(resource)) {
             return new CarAudioFadeConfigurationHelper(inputStream);
diff --git a/tests/carservice_test/src/com/android/car/audio/CarAudioZonesValidatorTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesValidatorUnitTest.java
similarity index 99%
rename from tests/carservice_test/src/com/android/car/audio/CarAudioZonesValidatorTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesValidatorUnitTest.java
index fa96b699bb..8373cd640b 100644
--- a/tests/carservice_test/src/com/android/car/audio/CarAudioZonesValidatorTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/audio/CarAudioZonesValidatorUnitTest.java
@@ -38,7 +38,7 @@ import java.util.ArrayList;
 import java.util.List;
 
 @RunWith(AndroidJUnit4.class)
-public class CarAudioZonesValidatorTest extends AbstractExpectableTestCase {
+public class CarAudioZonesValidatorUnitTest extends AbstractExpectableTestCase {
 
     @Test
     public void validate_thereIsAtLeastOneZone() {
diff --git a/tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusConcurrentTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusConcurrentTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusConcurrentTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusConcurrentTest.java
diff --git a/tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusExclusiveTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusExclusiveTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusExclusiveTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusExclusiveTest.java
diff --git a/tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusRejectedTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusRejectedTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusRejectedTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusRejectedTest.java
diff --git a/tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusTest.java
diff --git a/tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusTestBase.java b/tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusTestBase.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusTestBase.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusTestBase.java
diff --git a/tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusUsageTest.java b/tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusUsageTest.java
similarity index 100%
rename from tests/carservice_test/src/com/android/car/audio/CarZonesAudioFocusUsageTest.java
rename to tests/carservice_unit_test/src/com/android/car/audio/CarZonesAudioFocusUsageTest.java
diff --git a/tests/carservice_unit_test/src/com/android/car/bluetooth/CarBluetoothServiceTest.java b/tests/carservice_unit_test/src/com/android/car/bluetooth/CarBluetoothServiceTest.java
index c572b79955..f04146fcf5 100644
--- a/tests/carservice_unit_test/src/com/android/car/bluetooth/CarBluetoothServiceTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/bluetooth/CarBluetoothServiceTest.java
@@ -44,6 +44,7 @@ import com.android.car.CarLocalServices;
 import com.android.car.CarPerUserServiceHelper;
 import com.android.car.R;
 import com.android.car.power.CarPowerManagementService;
+import com.android.car.user.CarUserService;
 
 import org.junit.After;
 import org.junit.Assert;
@@ -83,6 +84,7 @@ public class CarBluetoothServiceTest {
     @Mock private ICarPerUserService mMockCarPerUserService;
     @Mock private CarBluetoothUserService mMockBluetoothUserService;
     @Mock private CarPowerManagementService mMockCarPowerManagementService;
+    @Mock private CarUserService mMockCarUserService;
     private CarPerUserServiceHelper.ServiceCallback mUserSwitchCallback;
 
     private IBinder mToken = new Binder();
@@ -132,6 +134,8 @@ public class CarBluetoothServiceTest {
         }
         CarLocalServices.addService(CarPowerManagementService.class,
                 mMockCarPowerManagementService);
+        CarLocalServices.addService(CarUserService.class,
+                mMockCarUserService);
     }
 
     @After
@@ -141,6 +145,7 @@ public class CarBluetoothServiceTest {
             mCarBluetoothService = null;
         }
         CarLocalServices.removeServiceForTest(CarPowerManagementService.class);
+        CarLocalServices.removeServiceForTest(CarUserService.class);
     }
 
     //--------------------------------------------------------------------------------------------//
diff --git a/tests/carservice_unit_test/src/com/android/car/evs/CarEvsServiceUnitTest.java b/tests/carservice_unit_test/src/com/android/car/evs/CarEvsServiceUnitTest.java
index eedc7f9300..d389445749 100644
--- a/tests/carservice_unit_test/src/com/android/car/evs/CarEvsServiceUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/evs/CarEvsServiceUnitTest.java
@@ -31,6 +31,7 @@ import static android.car.hardware.property.CarPropertyEvent.PROPERTY_EVENT_ERRO
 import static android.car.hardware.property.CarPropertyEvent.PROPERTY_EVENT_PROPERTY_CHANGE;
 
 import static com.android.car.CarLog.TAG_EVS;
+import static com.android.car.internal.common.CommonConstants.USER_LIFECYCLE_EVENT_TYPE_UNLOCKED;
 import static com.android.dx.mockito.inline.extended.ExtendedMockito.doNothing;
 import static com.android.dx.mockito.inline.extended.ExtendedMockito.doReturn;
 import static com.android.dx.mockito.inline.extended.ExtendedMockito.verify;
@@ -63,6 +64,8 @@ import android.car.hardware.property.CarPropertyEvent;
 import android.car.hardware.property.ICarPropertyEventListener;
 import android.car.test.mocks.AbstractExtendedMockitoTestCase;
 import android.car.test.mocks.JavaMockitoHelper;
+import android.car.user.CarUserManager.UserLifecycleEvent;
+import android.car.user.CarUserManager.UserLifecycleListener;
 import android.content.ComponentName;
 import android.content.Context;
 import android.content.Intent;
@@ -86,9 +89,11 @@ import android.util.SparseIntArray;
 import android.view.Display;
 
 import com.android.car.BuiltinPackageDependency;
+import com.android.car.CarLocalServices;
 import com.android.car.CarPropertyService;
 import com.android.car.CarServiceUtils;
 import com.android.car.hal.EvsHalService;
+import com.android.car.user.CarUserService;
 
 import org.junit.After;
 import org.junit.Before;
@@ -174,12 +179,14 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
     @Mock private PackageManager mMockPackageManager;
     @Mock private Resources mMockResources;
     @Mock private Display mMockDisplay;
+    @Mock private CarUserService mMockCarUserService;
 
     @Captor private ArgumentCaptor<DisplayManager.DisplayListener> mDisplayListenerCaptor;
     @Captor private ArgumentCaptor<IBinder.DeathRecipient> mDeathRecipientCaptor;
     @Captor private ArgumentCaptor<ICarPropertyEventListener> mGearSelectionListenerCaptor;
     @Captor private ArgumentCaptor<Intent> mIntentCaptor;
     @Captor private ArgumentCaptor<StateMachine.HalCallback> mHalCallbackCaptor;
+    @Captor private ArgumentCaptor<UserLifecycleListener> mUserLifecycleListenerCaptor;
 
     private CarEvsService mCarEvsService;
     private Random mRandom = new Random();
@@ -193,6 +200,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         builder
             .spyStatic(ServiceManager.class)
             .spyStatic(Binder.class)
+            .spyStatic(CarLocalServices.class)
             .spyStatic(CarServiceUtils.class)
             .spyStatic(CarEvsService.class)
             .spyStatic(StateMachine.class)
@@ -211,6 +219,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         when(mMockContext.getSystemService(DisplayManager.class)).thenReturn(mMockDisplayManager);
         when(mMockContext.getPackageManager()).thenReturn(mMockPackageManager);
         doNothing().when(mMockContext).startActivity(mIntentCaptor.capture());
+        doReturn(mMockCarUserService).when(() -> CarLocalServices.getService(CarUserService.class));
 
         when(mMockResources.getString(
                 com.android.internal.R.string.config_systemUIServiceComponent))
@@ -245,6 +254,10 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
                 .registerListenerSafe(anyInt(), anyFloat(),
                         mGearSelectionListenerCaptor.capture())).thenReturn(true);
 
+        // Get the user lifecycle listener.
+        doNothing().when(mMockCarUserService).addUserLifecycleListener(any(),
+                mUserLifecycleListenerCaptor.capture());
+
         mCarEvsService = new CarEvsService(mMockContext, mMockBuiltinPackageContext,
                         mMockEvsHalService, mMockCarPropertyService,
                                 /* checkDependencies= */ false);
@@ -358,17 +371,18 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         // Request stopping a current activity. CarEvsService should give us a callback with
         // STREAM_STOPPED event and ehter INACTIVE state.
         mCarEvsService.mEvsTriggerListener.onEvent(SERVICE_TYPE_REARVIEW, /* on= */ false);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
         assertThat(spiedCallback.waitForEvent(SERVICE_TYPE_REARVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
         assertThat(mCarEvsService.getCurrentStatus(SERVICE_TYPE_REARVIEW).getState())
                 .isEqualTo(SERVICE_STATE_INACTIVE);
 
-
         // Request an unsupported service. CarEvsService should decline a request and stay at the
         // same state.
         mCarEvsService.mEvsTriggerListener.onEvent(SERVICE_TYPE_SURROUNDVIEW, /* on= */ true);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_REQUESTED)).isFalse();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_SURROUNDVIEW, SERVICE_STATE_REQUESTED))
+                .isFalse();
     }
 
     @Test
@@ -406,7 +420,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         for (int type : SERVICE_TYPES) {
             mCarEvsService.setServiceState(type, SERVICE_STATE_UNAVAILABLE);
             mCarEvsService.stopActivity();
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_INACTIVE)).isFalse();
             assertThat(mCarEvsService.getCurrentStatus(type).getState())
                     .isEqualTo(SERVICE_STATE_UNAVAILABLE);
             verify(mMockEvsHalWrapper).connectToHalServiceIfNecessary();
@@ -415,7 +429,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             mCarEvsService.addStreamCallback(type, null);
             when(mMockEvsHalWrapper.connectToHalServiceIfNecessary()).thenReturn(false);
             mCarEvsService.mEvsTriggerListener.onEvent(type, /* on= */ false);
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_ACTIVE)).isFalse();
             verify(mMockEvsHalWrapper, atLeastOnce()).connectToHalServiceIfNecessary();
             assertThat(mCarEvsService.getCurrentStatus(type).getState())
                     .isEqualTo(SERVICE_STATE_UNAVAILABLE);
@@ -423,7 +437,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             mCarEvsService.setServiceState(type, SERVICE_STATE_UNAVAILABLE);
             mCarEvsService.addStreamCallback(type, spiedCallback);
             mCarEvsService.stopVideoStream(spiedCallback);
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_INACTIVE)).isFalse();
             assertThat(mCarEvsService.getCurrentStatus(type).getState())
                     .isEqualTo(SERVICE_STATE_UNAVAILABLE);
 
@@ -431,13 +445,13 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             when(spiedCallback.asBinder()).thenReturn(null);
             assertThrows(NullPointerException.class,
                     () -> mCarEvsService.addStreamCallback(type, spiedCallback));
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_INACTIVE)).isFalse();
             assertThat(mCarEvsService.getCurrentStatus(type).getState())
                     .isEqualTo(SERVICE_STATE_UNAVAILABLE);
 
             mCarEvsService.setServiceState(type, SERVICE_STATE_UNAVAILABLE);
             mCarEvsService.stopActivity();
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_INACTIVE)).isFalse();
             assertThat(mCarEvsService.getCurrentStatus(type).getState())
                     .isEqualTo(SERVICE_STATE_UNAVAILABLE);
         }
@@ -485,7 +499,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             mCarEvsService.setServiceState(type, SERVICE_STATE_UNAVAILABLE);
             assertThat(mCarEvsService.startVideoStream(type, /* token= */ null, streamCallback))
                     .isEqualTo(ERROR_NONE);
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isTrue();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_ACTIVE)).isTrue();
             assertThat(mCarEvsService.getCurrentStatus(type).getState())
                     .isEqualTo(SERVICE_STATE_ACTIVE);
         }
@@ -501,7 +515,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             mCarEvsService.setServiceState(type, SERVICE_STATE_INACTIVE);
             assertThat(mCarEvsService.startVideoStream(type, null, streamCallback))
                     .isEqualTo(ERROR_NONE);
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isTrue();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_ACTIVE)).isTrue();
             verify(spiedStatusListener).onStatusChanged(argThat(
                     received -> received.getState() == SERVICE_STATE_ACTIVE));
 
@@ -509,7 +523,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             mCarEvsService.setServiceState(type, SERVICE_STATE_INACTIVE);
             assertThat(mCarEvsService.startVideoStream(type, null, streamCallback))
                     .isEqualTo(ERROR_UNAVAILABLE);
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_ACTIVE)).isFalse();
             assertThat(mCarEvsService.getCurrentStatus(0).getState())
                     .isEqualTo(SERVICE_STATE_INACTIVE);
 
@@ -517,7 +531,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             mCarEvsService.setServiceState(type, SERVICE_STATE_INACTIVE);
             assertThat(mCarEvsService.startVideoStream(type, null, streamCallback))
                     .isEqualTo(ERROR_UNAVAILABLE);
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_ACTIVE)).isFalse();
             assertThat(mCarEvsService.getCurrentStatus(0).getState())
                     .isEqualTo(SERVICE_STATE_INACTIVE);
 
@@ -566,7 +580,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             mCarEvsService.registerStatusListener(spiedStatusListener);
             assertThat(mCarEvsService.startVideoStream(type, null, streamCallback))
                     .isEqualTo(ERROR_NONE);
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_ACTIVE)).isFalse();
             assertThat(mCarEvsService.getCurrentStatus(type).getState())
                     .isEqualTo(SERVICE_STATE_ACTIVE);
 
@@ -574,7 +588,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
             mCarEvsService.setServiceState(type, SERVICE_STATE_UNKNOWN);
             IllegalStateException thrown = assertThrows(IllegalStateException.class,
                     () -> mCarEvsService.startActivity(type));
-            assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isFalse();
+            assertThat(spiedStatusListener.waitFor(type, SERVICE_STATE_ACTIVE)).isFalse();
             assertWithMessage("Verify current status of CarEvsService")
                     .that(thrown).hasMessageThat()
                     .contains("CarEvsService is in the unknown state.");
@@ -599,7 +613,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         assertThat(mCarEvsService.getCurrentStatus(0).getState())
                 .isEqualTo(SERVICE_STATE_REQUESTED);
 
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_REQUESTED)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED))
+                .isTrue();
         verify(spiedStatusListener).onStatusChanged(argThat(
                 received -> received.getState() == SERVICE_STATE_REQUESTED));
     }
@@ -700,9 +715,11 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mDisplayListenerCaptor.getValue().onDisplayChanged(Display.DEFAULT_DISPLAY);
 
         // Confirm that we have received onStatusChanged() callback only once.
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_REQUESTED)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED))
+                .isTrue();
         verify(spiedStatusListener).onStatusChanged(argThat(
-                received -> received.getState() == SERVICE_STATE_REQUESTED));
+                received -> received.getServiceType() == SERVICE_TYPE_REARVIEW &&
+                        received.getState() == SERVICE_STATE_REQUESTED));
         verify(mMockContext).startActivity(any());
 
         // Also, verify that we have received an intent for a camera activity.
@@ -787,12 +804,14 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.registerStatusListener(spiedStatusListener);
 
         mCarEvsService.startActivity(SERVICE_TYPE_REARVIEW);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_REQUESTED)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED))
+                .isTrue();
 
         assertThat(mCarEvsService
                 .startVideoStream(SERVICE_TYPE_REARVIEW, null, spiedCallback))
                 .isEqualTo(ERROR_NONE);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_ACTIVE))
+                .isTrue();
 
         mHalCallbackCaptor.getValue().onFrameEvent(bufferId, buffer);
         assertThat(spiedCallback.waitForFrames(/* from= */ SERVICE_TYPE_REARVIEW,
@@ -828,7 +847,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.setServiceState(SERVICE_TYPE_REARVIEW, SERVICE_STATE_ACTIVE);
 
         mCarEvsService.startActivity(SERVICE_TYPE_REARVIEW);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_REQUESTED)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED))
+                .isTrue();
         assertThat(mCarEvsService.getCurrentStatus(0).getState())
                 .isEqualTo(SERVICE_STATE_REQUESTED);
     }
@@ -843,7 +863,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.setServiceState(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED);
 
         mCarEvsService.startActivity(SERVICE_TYPE_REARVIEW);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_REQUESTED)).isFalse();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED))
+                .isFalse();
         assertThat(mCarEvsService.getCurrentStatus(0).getState())
                 .isEqualTo(SERVICE_STATE_REQUESTED);
     }
@@ -857,7 +878,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.registerStatusListener(spiedStatusListener);
         mCarEvsService.setServiceState(SERVICE_TYPE_REARVIEW, SERVICE_STATE_ACTIVE);
         mCarEvsService.startActivity(SERVICE_TYPE_REARVIEW);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_REQUESTED)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED))
+                .isTrue();
         assertThat(mCarEvsService.getCurrentStatus(0).getState())
                 .isEqualTo(SERVICE_STATE_REQUESTED);
 
@@ -884,7 +906,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
 
         // Request starting an activity. CarEvsService should enter REQUESTED state.
         mCarEvsService.startActivity(SERVICE_TYPE_REARVIEW);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_REQUESTED)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED))
+                .isTrue();
         assertThat(mCarEvsService.getCurrentStatus(0).getState())
                 .isEqualTo(SERVICE_STATE_REQUESTED);
         assertThat(mCarEvsService.getCurrentStatus(0).getServiceType())
@@ -898,7 +921,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         int type = extras.getShort(Integer.toString(SERVICE_TYPE_REARVIEW));
         assertThat(mCarEvsService.startVideoStream(type, /* token= */ null, spiedStreamCallback))
                 .isEqualTo(ERROR_NONE);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_ACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_ACTIVE))
+                .isTrue();
 
         mHalCallbackCaptor.getValue().onFrameEvent(bufferId, buffer);
         assertThat(spiedStreamCallback.waitForFrames(/* from= */ SERVICE_TYPE_REARVIEW,
@@ -907,7 +931,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         // Request stopping a current activity. CarEvsService should give us a callback with
         // STREAM_STOPPED event and ehter INACTIVE state.
         mCarEvsService.stopVideoStream(spiedStreamCallback);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
         assertThat(spiedStreamCallback.waitForEvent(SERVICE_TYPE_REARVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
         assertThat(mCarEvsService.getCurrentStatus(0).getState())
@@ -1203,12 +1228,14 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.stopVideoStream(spiedStreamCallback1);
         assertThat(spiedStreamCallback1.waitForEvent(SERVICE_TYPE_REARVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isFalse();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isFalse();
 
         mCarEvsService.stopVideoStream(spiedStreamCallback0);
         assertThat(spiedStreamCallback0.waitForEvent(SERVICE_TYPE_REARVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
     }
 
     @Test
@@ -1237,7 +1264,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
 
         // Verify that the service entered the active state.
         verify(spiedStatusListener).onStatusChanged(argThat(
-                received -> received.getState() == CarEvsManager.SERVICE_STATE_ACTIVE));
+                received -> received.getServiceType() == SERVICE_TYPE_REARVIEW &&
+                        received.getState() == CarEvsManager.SERVICE_STATE_ACTIVE));
 
         // Send a buffer.
         mHalCallbackCaptor.getValue().onFrameEvent(bufferId, buffer);
@@ -1253,7 +1281,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.stopVideoStream(spiedCallback0);
         assertThat(spiedCallback0.waitForEvent(SERVICE_TYPE_REARVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isFalse();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isFalse();
         assertThat(mCarEvsService.getCurrentStatus(0).getState()).isEqualTo(SERVICE_STATE_ACTIVE);
 
         // Stop a video stream for the second client and verify that the service entered the
@@ -1261,7 +1290,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.stopVideoStream(spiedCallback1);
         assertThat(spiedCallback1.waitForEvent(SERVICE_TYPE_REARVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
         assertThat(mCarEvsService.getCurrentStatus(0).getState()).isEqualTo(SERVICE_STATE_INACTIVE);
         verify(spiedStatusListener, times(2)).onStatusChanged(argThat(
                 received -> received.getState() == SERVICE_STATE_ACTIVE ||
@@ -1336,12 +1366,14 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.stopVideoStream(spiedRearviewCallback);
         assertThat(spiedRearviewCallback.waitForEvent(SERVICE_TYPE_REARVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
 
         // Stop a video stream for the frontview client and verify that the service is stopped
         // properly.
         mCarEvsService.stopVideoStream(spiedFrontviewCallback);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_FRONTVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
         assertThat(spiedFrontviewCallback.waitForEvent(SERVICE_TYPE_FRONTVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
         verify(spiedStatusListener, times(2)).onStatusChanged(argThat(
@@ -1386,7 +1418,7 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         verify(spiedStatusListener, times(2)).onStatusChanged(argThat(
                 received -> received.getState() == CarEvsManager.SERVICE_STATE_ACTIVE &&
                         (received.getServiceType() == SERVICE_TYPE_REARVIEW ||
-                                received.getServiceType() == SERVICE_TYPE_FRONTVIEW)));
+                                received.getServiceType() == SERVICE_TYPE_LEFTVIEW)));
 
         // Send buffers in separate thread.
         mHandler.post(() -> {
@@ -1421,7 +1453,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.stopVideoStream(spiedLeftviewCallback0);
         assertThat(spiedLeftviewCallback0.waitForEvent(SERVICE_TYPE_LEFTVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isFalse();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_LEFTVIEW, SERVICE_STATE_INACTIVE))
+                .isFalse();
 
         // Stop a video stream for the second clients and verify that the services entered the
         // inactive state.
@@ -1431,7 +1464,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.stopVideoStream(spiedLeftviewCallback1);
         assertThat(spiedLeftviewCallback1.waitForEvent(SERVICE_TYPE_LEFTVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_LEFTVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
         verify(spiedStatusListener, times(2)).onStatusChanged(argThat(
                 received -> received.getState() == CarEvsManager.SERVICE_STATE_INACTIVE &&
                         (received.getServiceType() == SERVICE_TYPE_REARVIEW ||
@@ -1526,12 +1560,14 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
         mCarEvsService.stopVideoStreamFrom(SERVICE_TYPE_REARVIEW, spiedCallback);
         assertThat(spiedCallback.waitForEvent(SERVICE_TYPE_REARVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
 
         // Stop a video stream for the frontview client and verify that the service is stopped
         // properly.
         mCarEvsService.stopVideoStreamFrom(SERVICE_TYPE_FRONTVIEW, spiedCallback);
-        assertThat(spiedStatusListener.waitFor(SERVICE_STATE_INACTIVE)).isTrue();
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_FRONTVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
         assertThat(spiedCallback.waitForEvent(SERVICE_TYPE_FRONTVIEW,
                 CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
         verify(spiedStatusListener, times(2)).onStatusChanged(argThat(
@@ -1541,6 +1577,80 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
                                         SERVICE_TYPE_FRONTVIEW)));
     }
 
+    @Test
+    public void testUserSwitchedWhileBackingEventInProgress() throws Exception {
+        // Create a buffer to circulate
+        HardwareBuffer buffer =
+                HardwareBuffer.create(/* width= */ 64, /* height= */ 32,
+                                      /* format= */ HardwareBuffer.RGBA_8888,
+                                      /* layers= */ 1,
+                                      /* usage= */ HardwareBuffer.USAGE_CPU_READ_OFTEN);
+        int bufferId = mRandom.nextInt();
+        EvsStreamCallbackImpl spiedCallback = spy(new EvsStreamCallbackImpl());
+        EvsStatusListenerImpl spiedStatusListener = spy(new EvsStatusListenerImpl());
+        mCarEvsService.registerStatusListener(spiedStatusListener);
+
+        // Request a REARVIEW via HAL Event. CarEvsService should enter REQUESTED state.
+        mCarEvsService.mEvsTriggerListener.onEvent(SERVICE_TYPE_REARVIEW, /* on= */ true);
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_REQUESTED))
+                .isTrue();
+        assertThat(mCarEvsService.getCurrentStatus(SERVICE_TYPE_REARVIEW).getState())
+                .isEqualTo(SERVICE_STATE_REQUESTED);
+
+        // Request a video stream with a given token. CarEvsService should enter ACTIVE state and
+        // gives a callback upon the frame event.
+        Bundle extras = mIntentCaptor.getValue().getExtras();
+        assertThat(extras).isNotNull();
+        IBinder token = extras.getBinder(CarEvsManager.EXTRA_SESSION_TOKEN);
+        assertThat(mCarEvsService.startVideoStream(SERVICE_TYPE_REARVIEW, token, spiedCallback))
+                .isEqualTo(ERROR_NONE);
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_ACTIVE))
+                .isTrue();
+
+        mHalCallbackCaptor.getValue().onFrameEvent(bufferId, buffer);
+        assertThat(spiedCallback.waitForFrames(/* from= */ SERVICE_TYPE_REARVIEW,
+                /* expected= */ 1)).isTrue();
+
+        // Notify that a new user profile is unlocked.
+        mUserLifecycleListenerCaptor.getValue().onEvent(
+                new UserLifecycleEvent(USER_LIFECYCLE_EVENT_TYPE_UNLOCKED, /* to= */ 11));
+        Bundle anotherExtras = mIntentCaptor.getValue().getExtras();
+        assertThat(anotherExtras).isNotNull();
+        assertThat(mIntentCaptor.getAllValues().size()).isGreaterThan(1);
+        assertThat(token).isEqualTo(extras.getBinder(CarEvsManager.EXTRA_SESSION_TOKEN));
+
+        // Request stopping a current activity. CarEvsService should give us a callback with
+        // STREAM_STOPPED event and ehter INACTIVE state.
+        mCarEvsService.mEvsTriggerListener.onEvent(SERVICE_TYPE_REARVIEW, /* on= */ false);
+        assertThat(spiedStatusListener.waitFor(SERVICE_TYPE_REARVIEW, SERVICE_STATE_INACTIVE))
+                .isTrue();
+        assertThat(spiedCallback.waitForEvent(SERVICE_TYPE_REARVIEW,
+                CarEvsManager.STREAM_EVENT_STREAM_STOPPED)).isTrue();
+        assertThat(mCarEvsService.getCurrentStatus(SERVICE_TYPE_REARVIEW).getState())
+                .isEqualTo(SERVICE_STATE_INACTIVE);
+    }
+
+    @Test
+    public void testEvsEventTypeConversion() throws Exception {
+        int expected[] = {
+            CarEvsManager.STREAM_EVENT_STREAM_STARTED,
+            CarEvsManager.STREAM_EVENT_STREAM_STOPPED,
+            CarEvsManager.STREAM_EVENT_FRAME_DROPPED,
+            CarEvsManager.STREAM_EVENT_TIMEOUT,
+            CarEvsManager.STREAM_EVENT_PARAMETER_CHANGED,
+            CarEvsManager.STREAM_EVENT_PRIMARY_OWNER_CHANGED,
+            CarEvsManager.STREAM_EVENT_OTHER_ERRORS,
+
+            // Default value for any unknown event type.
+            CarEvsManager.STREAM_EVENT_NONE
+        };
+
+        for (int i = 0; i < expected.length; i++) {
+            assertEquals(CarEvsServiceUtils.convertToStreamEvent(i),
+                    expected[i]);
+        }
+    }
+
     private void mockEvsHalService() throws Exception {
         when(mMockEvsHalService.isEvsServiceRequestSupported())
                 .thenReturn(true);
@@ -1565,7 +1675,8 @@ public final class CarEvsServiceUnitTest extends AbstractExtendedMockitoTestCase
 
         @Override
         public void onStatusChanged(CarEvsStatus status) {
-            Log.i(TAG, "Received a status change notification: " + status.getState());
+            Log.i(TAG, "Received a status change notification: " + status.getState() + " from " +
+                    status.getServiceType());
             mLastUpdate = status;
             mSemaphore.release();
         }
diff --git a/tests/carservice_unit_test/src/com/android/car/hal/MockedPowerHalService.java b/tests/carservice_unit_test/src/com/android/car/hal/MockedPowerHalService.java
index 4c8d13f0a5..a86c3b8a88 100644
--- a/tests/carservice_unit_test/src/com/android/car/hal/MockedPowerHalService.java
+++ b/tests/carservice_unit_test/src/com/android/car/hal/MockedPowerHalService.java
@@ -15,6 +15,8 @@
  */
 package com.android.car.hal;
 
+import static com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport.DEBUGGING_CODE;
+
 import static org.mockito.Mockito.mock;
 import static org.mockito.Mockito.when;
 
@@ -28,12 +30,15 @@ import android.view.Display;
 
 import com.android.car.CarServiceUtils;
 import com.android.car.VehicleStub;
+import com.android.car.internal.ExcludeFromCodeCoverageGeneratedReport;
+import com.android.car.systeminterface.DisplayHelperInterface;
 import com.android.internal.annotations.GuardedBy;
 
 import java.util.LinkedList;
 import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.TimeoutException;
 
+@ExcludeFromCodeCoverageGeneratedReport(reason = DEBUGGING_CODE)
 public class MockedPowerHalService extends PowerHalService {
     private static final String TAG = MockedPowerHalService.class.getSimpleName();
 
@@ -90,7 +95,7 @@ public class MockedPowerHalService extends PowerHalService {
     public MockedPowerHalService(boolean isPowerStateSupported, boolean isDeepSleepAllowed,
             boolean isHibernationAllowed, boolean isTimedWakeupAllowed) {
         super(mock(Context.class), new FeatureFlagsImpl(),
-                createVehicleHalWithMockedServices());
+                createVehicleHalWithMockedServices(), new DisplayHelperInterface.DefaultImpl());
         mIsPowerStateSupported = isPowerStateSupported;
         mIsDeepSleepAllowed = isDeepSleepAllowed;
         mIsHibernationAllowed = isHibernationAllowed;
@@ -172,7 +177,7 @@ public class MockedPowerHalService extends PowerHalService {
     }
 
     @Override
-    public void sendDisplayBrightness(int brightness) {
+    public void sendDisplayBrightnessLegacy(int brightness) {
         sendDisplayBrightness(Display.DEFAULT_DISPLAY, brightness);
     }
 
diff --git a/tests/carservice_unit_test/src/com/android/car/hal/PowerHalServiceUnitTest.java b/tests/carservice_unit_test/src/com/android/car/hal/PowerHalServiceUnitTest.java
index cb0cb98fcf..c4596b7044 100644
--- a/tests/carservice_unit_test/src/com/android/car/hal/PowerHalServiceUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/hal/PowerHalServiceUnitTest.java
@@ -32,6 +32,7 @@ import static android.hardware.automotive.vehicle.VehicleProperty.AP_POWER_STATE
 import static android.hardware.automotive.vehicle.VehicleProperty.AP_POWER_STATE_REQ;
 import static android.hardware.automotive.vehicle.VehicleProperty.DISPLAY_BRIGHTNESS;
 import static android.hardware.automotive.vehicle.VehicleProperty.PER_DISPLAY_BRIGHTNESS;
+import static android.hardware.automotive.vehicle.VehicleProperty.SHUTDOWN_REQUEST;
 import static android.hardware.automotive.vehicle.VehicleProperty.VEHICLE_IN_USE;
 
 import static com.android.car.hal.PowerHalService.PowerState.SHUTDOWN_TYPE_DEEP_SLEEP;
@@ -52,11 +53,13 @@ import static org.mockito.Mockito.never;
 import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.when;
 
+import android.car.builtin.view.DisplayHelper;
 import android.car.feature.FakeFeatureFlagsImpl;
 import android.car.feature.Flags;
 import android.car.test.util.FakeContext;
 import android.hardware.automotive.vehicle.StatusCode;
 import android.hardware.automotive.vehicle.VehicleApPowerBootupReason;
+import android.hardware.automotive.vehicle.VehicleApPowerStateReport;
 import android.hardware.automotive.vehicle.VehicleApPowerStateShutdownParam;
 import android.hardware.automotive.vehicle.VehicleProperty;
 import android.hardware.display.DisplayManager;
@@ -70,7 +73,9 @@ import android.view.Display;
 import android.view.DisplayAddress;
 
 import com.android.car.hal.PowerHalService.PowerState;
+import com.android.car.hal.VehicleHal.HalPropValueSetter;
 import com.android.car.hal.test.AidlVehiclePropConfigBuilder;
+import com.android.car.systeminterface.DisplayHelperInterface;
 
 import org.junit.Before;
 import org.junit.Test;
@@ -129,6 +134,8 @@ public final class PowerHalServiceUnitTest {
     private VehicleHal mHal;
     @Mock
     private DisplayManager mDisplayManager;
+    @Mock
+    private DisplayHelperInterface mDisplayHelper;
     private PowerHalService mPowerHalService;
 
     private FakeFeatureFlagsImpl mFakeFeatureFlags = new FakeFeatureFlagsImpl();
@@ -137,8 +144,10 @@ public final class PowerHalServiceUnitTest {
     public void setUp() {
         mFakeContext.setSystemService(DisplayManager.class, mDisplayManager);
         mFakeFeatureFlags.setFlag(Flags.FLAG_PER_DISPLAY_MAX_BRIGHTNESS, false);
+        mFakeFeatureFlags.setFlag(Flags.FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL, false);
 
-        mPowerHalService = new PowerHalService(mFakeContext, mFakeFeatureFlags, mHal);
+        mPowerHalService = new PowerHalService(mFakeContext, mFakeFeatureFlags, mHal,
+                mDisplayHelper);
         mPowerHalService.setListener(mEventListener);
     }
 
@@ -264,22 +273,76 @@ public final class PowerHalServiceUnitTest {
 
     @Test
     public void testHalEventListenerDisplayBrightnessChange() {
-        AidlHalPropConfig config = new AidlHalPropConfig(
-                AidlVehiclePropConfigBuilder.newBuilder(DISPLAY_BRIGHTNESS)
-                .addAreaConfig(/* areaId= */ 0, /* minValue= */ 0, /* maxValue= */ 100).build());
-        mPowerHalService.takeProperties(List.of(config));
-        mPowerHalService.init();
-        mPowerHalService.setListener(mEventListener);
+        setupVhalSupportGlobalBrightnessOnly();
 
         int expectedBrightness = 73;
         HalPropValue value = mPropValueBuilder.build(DISPLAY_BRIGHTNESS, /* areaId= */ 0,
                 expectedBrightness);
+
         mPowerHalService.onHalEvents(List.of(value));
 
         assertWithMessage("Display brightness").that(mEventListener.getDisplayBrightness())
                 .isEqualTo(expectedBrightness);
     }
 
+    @Test
+    public void testHalEventListenerDisplayBrightnessChange_ignoreRecentlySet() {
+        addDefaultDisplay();
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0))
+                .thenReturn(propValueSetter);
+        setupVhalSupportGlobalBrightnessOnly();
+
+        int brightness1 = 73;
+        int brightness2 = 68;
+        HalPropValue value1 = mPropValueBuilder.build(DISPLAY_BRIGHTNESS, /* areaId= */ 0,
+                brightness1);
+        HalPropValue value2 = mPropValueBuilder.build(DISPLAY_BRIGHTNESS, /* areaId= */ 0,
+                brightness2);
+
+        mPowerHalService.sendDisplayBrightnessLegacy(brightness1);
+        mPowerHalService.onHalEvents(List.of(value2));
+        // This must be ignored.
+        mPowerHalService.onHalEvents(List.of(value1));
+
+        assertWithMessage("Display brightness").that(mEventListener.getDisplayBrightness())
+                .isEqualTo(brightness2);
+    }
+
+    @Test
+    public void testHalEventListenerDisplayBrightnessChange_ignoreRecentlySetForDisplayPort() {
+        mFakeFeatureFlags.setFlag(Flags.FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL, true);
+
+        int displayId1 = 0;
+        int displayPort1 = 1;
+        int displayId2 = 2;
+        int displayPort2 = 3;
+        Display display1 = createMockDisplay(displayId1, displayPort1);
+        Display display2 = createMockDisplay(displayId2, displayPort2);
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{display1, display2});
+        when(mDisplayManager.getDisplay(displayId1)).thenReturn(display1);
+        when(mDisplayManager.getDisplay(displayId2)).thenReturn(display2);
+
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0))
+                .thenReturn(propValueSetter);
+        setupVhalSupportGlobalBrightnessOnly();
+
+        int brightness1 = 73;
+        HalPropValue value1 = mPropValueBuilder.build(DISPLAY_BRIGHTNESS, /* areaId= */ 0,
+                brightness1);
+
+        mPowerHalService.sendDisplayBrightness(displayId1, brightness1);
+        mPowerHalService.onHalEvents(List.of(value1));
+
+        // Must not receive onDisplayBrightnessChange event for the display that sent the request.
+        assertWithMessage("Display brightness").that(
+                mEventListener.getDisplayBrightness(displayId1)).isEqualTo(0);
+        // Must receive onDisplayBrightnessChange event for the other display.
+        assertWithMessage("Display brightness").that(
+                mEventListener.getDisplayBrightness(displayId2)).isEqualTo(brightness1);
+    }
+
     @Test
     public void testHalEventListenerDisplayBrightnessChange_non100MaxBrightness() {
         AidlHalPropConfig config = new AidlHalPropConfig(
@@ -301,14 +364,37 @@ public final class PowerHalServiceUnitTest {
                 .isEqualTo(expectedBrightness);
     }
 
+    @Test
+    public void testHalEventListenerDisplayBrightnessChange_multiDisplaySupport() {
+        // If multi display is supported and VHAL only supports global DISPLAY_BRIGHTNESS, we treat
+        // it as the brightness for all displays.
+        mFakeFeatureFlags.setFlag(Flags.FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL, true);
+        setupVhalSupportGlobalBrightnessOnly();
+
+        int displayId1 = 2;
+        int displayPort1 = 3;
+        int displayId2 = 4;
+        int displayPort2 = 5;
+        Display display1 = createMockDisplay(displayId1, displayPort1);
+        Display display2 = createMockDisplay(displayId2, displayPort2);
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{display1, display2});
+
+        int expectedBrightness = 73;
+        HalPropValue value = mPropValueBuilder.build(DISPLAY_BRIGHTNESS, /* areaId= */ 0,
+                expectedBrightness);
+        mPowerHalService.onHalEvents(List.of(value));
+
+        assertWithMessage("Display brightness for display 1")
+                .that(mEventListener.getDisplayBrightness(displayId1))
+                .isEqualTo(expectedBrightness);
+        assertWithMessage("Display brightness for display 2")
+                .that(mEventListener.getDisplayBrightness(displayId2))
+                .isEqualTo(expectedBrightness);
+    }
+
     @Test
     public void testPerDisplayBrightnessChange_perDisplayMaxNotSupported() {
-        AidlHalPropConfig config = new AidlHalPropConfig(
-                AidlVehiclePropConfigBuilder.newBuilder(PER_DISPLAY_BRIGHTNESS)
-                .addAreaConfig(/* areaId= */ 0, /* minValue= */ 0, /* maxValue= */ 100).build());
-        mPowerHalService.takeProperties(List.of(config));
-        mPowerHalService.init();
-        mPowerHalService.setListener(mEventListener);
+        setupVhalSupportPerDisplayBrightnessOnly();
 
         int displayId, displayPort;
         displayPort = displayId = 11;
@@ -322,7 +408,7 @@ public final class PowerHalServiceUnitTest {
         mPowerHalService.onHalEvents(List.of(value));
 
         assertWithMessage("Display brightness")
-                .that(mEventListener.getDisplayBrightness(displayPort))
+                .that(mEventListener.getDisplayBrightness(displayId))
                 .isEqualTo(expectedBrightness);
     }
 
@@ -350,7 +436,7 @@ public final class PowerHalServiceUnitTest {
         mPowerHalService.onHalEvents(List.of(value));
 
         assertWithMessage("Display brightness")
-                .that(mEventListener.getDisplayBrightness(displayPort))
+                .that(mEventListener.getDisplayBrightness(displayId))
                 .isEqualTo(expectedBrightness);
     }
 
@@ -387,10 +473,54 @@ public final class PowerHalServiceUnitTest {
         mPowerHalService.onHalEvents(List.of(value));
 
         assertWithMessage("Display brightness")
-                .that(mEventListener.getDisplayBrightness(displayPort))
+                .that(mEventListener.getDisplayBrightness(displayId))
                 .isEqualTo(expectedBrightness);
     }
 
+    @Test
+    public void testPerDisplayBrightnessChange_perDisplayMaxSupported_ignoreRecentlySet() {
+        mFakeFeatureFlags.setFlag(Flags.FLAG_PER_DISPLAY_MAX_BRIGHTNESS, true);
+
+        when(mHal.getHalPropValueBuilder()).thenReturn(mPropValueBuilder);
+        var config1 = new AidlHalPropConfig(
+                AidlVehiclePropConfigBuilder.newBuilder(PER_DISPLAY_BRIGHTNESS)
+                .build());
+        var config2 = new AidlHalPropConfig(
+                AidlVehiclePropConfigBuilder.newBuilder(PER_DISPLAY_MAX_BRIGHTNESS)
+                .build());
+        mPowerHalService.takeProperties(List.of(config1, config2));
+
+        int displayId = 11;
+        int displayPort = 11;
+        int displayPort2 = 12;
+        // Set the max display brightness for display port to be 100.
+        when(mHal.get(PER_DISPLAY_MAX_BRIGHTNESS)).thenReturn(mPropValueBuilder.build(
+                PER_DISPLAY_MAX_BRIGHTNESS, /* areaId= */ 0,
+                new int[] {displayPort, 100, displayPort2, 50}));
+
+        mPowerHalService.init();
+        mPowerHalService.setListener(mEventListener);
+
+        Display display = createMockDisplay(displayId, displayPort);
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{display});
+        when(mDisplayManager.getDisplay(displayId)).thenReturn(display);
+
+        int brightness1 = 73;
+        int brightness2 = 68;
+        HalPropValue value1 = mPropValueBuilder.build(PER_DISPLAY_BRIGHTNESS, /* areaId= */ 0,
+                new int[]{displayPort, brightness1});
+        HalPropValue value2 = mPropValueBuilder.build(PER_DISPLAY_BRIGHTNESS, /* areaId= */ 0,
+                new int[]{displayPort, brightness2});
+        mPowerHalService.sendDisplayBrightness(displayId, brightness2);
+        mPowerHalService.onHalEvents(List.of(value1));
+        // Must ignore this event.
+        mPowerHalService.onHalEvents(List.of(value2));
+
+        assertWithMessage("Display brightness")
+                .that(mEventListener.getDisplayBrightness(displayPort))
+                .isEqualTo(brightness1);
+    }
+
     @Test
     public void testPerDisplayBrightnessChange_non100MaxBrightness_perDisplaySupported() {
         mFakeFeatureFlags.setFlag(Flags.FLAG_PER_DISPLAY_MAX_BRIGHTNESS, true);
@@ -427,33 +557,51 @@ public final class PowerHalServiceUnitTest {
         mPowerHalService.onHalEvents(List.of(value));
 
         assertWithMessage("Display brightness")
-                .that(mEventListener.getDisplayBrightness(displayPort))
+                .that(mEventListener.getDisplayBrightness(displayId))
                 .isEqualTo(expectedBrightness);
     }
 
     @Test
-    public void testSendDisplayBrightness() {
-        VehicleHal.HalPropValueSetter propValueSetter = mock(VehicleHal.HalPropValueSetter.class);
+    public void testSendDisplayBrightnessLegacy() {
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
         when(mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0))
                 .thenReturn(propValueSetter);
 
+        setupVhalSupportGlobalBrightnessOnly();
+        addDefaultDisplay();
+        int brightnessToSet = 77;
+
+        mPowerHalService.sendDisplayBrightnessLegacy(brightnessToSet);
+
+        verify(propValueSetter).to(brightnessToSet);
+    }
+
+    @Test
+    public void testSendDisplayBrightnessLegacy_non100MaxBrightness() {
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0))
+                .thenReturn(propValueSetter);
+        int maxBrightness = 255;
+        addDefaultDisplay();
+
         AidlHalPropConfig config = new AidlHalPropConfig(
                 AidlVehiclePropConfigBuilder.newBuilder(DISPLAY_BRIGHTNESS)
-                .addAreaConfig(/* areaId= */ 0, /* minValue= */ 0, /* maxValue= */ 100).build());
+                .addAreaConfig(/* areaId= */ 0, /* minValue= */ 0, /* maxValue= */ 255).build());
         mPowerHalService.takeProperties(List.of(config));
         mPowerHalService.init();
 
         int brightnessToSet = 77;
-        mPowerHalService.sendDisplayBrightness(brightnessToSet);
+        mPowerHalService.sendDisplayBrightnessLegacy(brightnessToSet);
 
-        verify(propValueSetter).to(brightnessToSet);
+        verify(propValueSetter).to(77 * maxBrightness / 100);
     }
 
     @Test
-    public void testSendDisplayBrightness_perDisplayBrightnessSupported() {
-        VehicleHal.HalPropValueSetter propValueSetter = mock(VehicleHal.HalPropValueSetter.class);
+    public void testSendDisplayBrightnessLegacy_perDisplayBrightnessSupported() {
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
         when(mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0))
                 .thenReturn(propValueSetter);
+        addDefaultDisplay();
 
         AidlHalPropConfig configDisplayBrightness = new AidlHalPropConfig(
                 AidlVehiclePropConfigBuilder.newBuilder(DISPLAY_BRIGHTNESS)
@@ -465,17 +613,13 @@ public final class PowerHalServiceUnitTest {
                 List.of(configDisplayBrightness, configPerDisplayBrightness));
         mPowerHalService.init();
 
-        mPowerHalService.sendDisplayBrightness(10);
+        mPowerHalService.sendDisplayBrightnessLegacy(10);
 
         verify(propValueSetter, never()).to(anyInt());
     }
 
     @Test
     public void testSendDisplayBrightnessPerDisplay() {
-        VehicleHal.HalPropValueSetter propValueSetter = mock(VehicleHal.HalPropValueSetter.class);
-        when(mHal.set(VehicleProperty.PER_DISPLAY_BRIGHTNESS, /* areaId= */ 0))
-                .thenReturn(propValueSetter);
-
         int displayId, displayPort;
         displayId = displayPort = 2;
         Display display = createMockDisplay(displayId, displayPort);
@@ -488,17 +632,133 @@ public final class PowerHalServiceUnitTest {
                 /* areaId= */ 0, new int[]{displayPort, brightnessToSet});
         when(mHal.getHalPropValueBuilder()).thenReturn(propValueBuilder);
 
-        AidlHalPropConfig config = new AidlHalPropConfig(
-                AidlVehiclePropConfigBuilder.newBuilder(PER_DISPLAY_BRIGHTNESS)
-                .addAreaConfig(/* areaId= */ 0, /* minValue= */ 0, /* maxValue= */ 100).build());
-        mPowerHalService.takeProperties(List.of(config));
+        setupVhalSupportPerDisplayBrightnessOnly();
+
+        mPowerHalService.sendDisplayBrightness(displayId, brightnessToSet);
+
+        verify(mHal).set(eq(message));
+    }
+
+    @Test
+    public void testSendDisplayBrightnessPerDisplay_outOfRange() {
+        int displayId, displayPort;
+        displayId = displayPort = 2;
+        Display display = createMockDisplay(displayId, displayPort);
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{display});
+        when(mDisplayManager.getDisplay(displayId)).thenReturn(display);
+
+        int brightnessToSet = 101;
+        HalPropValueBuilder propValueBuilder = new HalPropValueBuilder(/*isAidl=*/true);
+        HalPropValue message = propValueBuilder.build(VehicleProperty.PER_DISPLAY_BRIGHTNESS,
+                /* areaId= */ 0, new int[]{displayPort, 100});
+        when(mHal.getHalPropValueBuilder()).thenReturn(propValueBuilder);
+
+        setupVhalSupportPerDisplayBrightnessOnly();
+
+        mPowerHalService.sendDisplayBrightness(displayId, brightnessToSet);
+
+        verify(mHal).set(eq(message));
+    }
+
+    @Test
+    public void testSendDisplayBrightnessPerDisplay_non100MaxBrightness() {
+        mFakeFeatureFlags.setFlag(Flags.FLAG_PER_DISPLAY_MAX_BRIGHTNESS, true);
+
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(VehicleProperty.PER_DISPLAY_BRIGHTNESS, /* areaId= */ 0))
+                .thenReturn(propValueSetter);
+
+        int displayId, displayPort;
+        displayId = displayPort = 2;
+        Display display = createMockDisplay(displayId, displayPort);
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{display});
+        when(mDisplayManager.getDisplay(displayId)).thenReturn(display);
+
+        int maxBrightness = 255;
+        // Set the max display brightness for display port to be maxBrightness.
+        when(mHal.get(PER_DISPLAY_MAX_BRIGHTNESS)).thenReturn(mPropValueBuilder.build(
+                PER_DISPLAY_MAX_BRIGHTNESS, /* areaId= */ 0,
+                new int[] {displayPort, maxBrightness}));
+
+        HalPropValueBuilder propValueBuilder = new HalPropValueBuilder(/*isAidl=*/true);
+        when(mHal.getHalPropValueBuilder()).thenReturn(propValueBuilder);
+
+        var config1 = new AidlHalPropConfig(
+                AidlVehiclePropConfigBuilder.newBuilder(PER_DISPLAY_BRIGHTNESS).build());
+        var config2 = new AidlHalPropConfig(
+                AidlVehiclePropConfigBuilder.newBuilder(PER_DISPLAY_MAX_BRIGHTNESS).build());
+        mPowerHalService.takeProperties(List.of(config1, config2));
         mPowerHalService.init();
 
+        int brightnessToSet = 41;
         mPowerHalService.sendDisplayBrightness(displayId, brightnessToSet);
 
+        // Must be scaled to [0, maxBrightness] from [0, 100]
+        int brightnessSet = brightnessToSet * maxBrightness / 100;
+
+        HalPropValue message = propValueBuilder.build(VehicleProperty.PER_DISPLAY_BRIGHTNESS,
+                /* areaId= */ 0, new int[]{displayPort, brightnessSet});
+
         verify(mHal).set(eq(message));
     }
 
+    @Test
+    public void testSendDisplayBrightnessPerDisplay_perDisplayBrightnessNotSupported() {
+        mFakeFeatureFlags.setFlag(Flags.FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL, true);
+        setupVhalSupportGlobalBrightnessOnly();
+        int displayId = 2;
+        int displayPort = 2;
+        addDisplay(displayId, displayPort);
+
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0))
+                .thenReturn(propValueSetter);
+        int brightnessToSet = 41;
+
+        mPowerHalService.sendDisplayBrightness(displayId, brightnessToSet);
+
+        // If only global brightness is supported, any set request will set the global brightness.
+        verify(propValueSetter).to(41);
+    }
+
+    @Test
+    public void testSendDisplayBrightnessPerDisplay_perDisplayBrightnessNotSupported_non100Max() {
+        mFakeFeatureFlags.setFlag(Flags.FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL, true);
+        setupVhalSupportGlobalBrightnessOnly(/* maxValue= */ 200);
+        int displayId = 2;
+        int displayPort = 2;
+        addDisplay(displayId, displayPort);
+
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0))
+                .thenReturn(propValueSetter);
+        int brightnessToSet = 41;
+
+        mPowerHalService.sendDisplayBrightness(displayId, brightnessToSet);
+
+        // If only global brightness is supported, any set request will set the global brightness.
+        verify(propValueSetter).to(82);
+    }
+
+    @Test
+    public void testSendDisplayBrightnessPerDisplay_perDisplayBrightnessNotSupported_outOfRange() {
+        mFakeFeatureFlags.setFlag(Flags.FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL, true);
+        setupVhalSupportGlobalBrightnessOnly(/* maxValue= */ 100);
+        int displayId = 2;
+        int displayPort = 2;
+        addDisplay(displayId, displayPort);
+
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(VehicleProperty.DISPLAY_BRIGHTNESS, /* areaId= */ 0))
+                .thenReturn(propValueSetter);
+        int brightnessToSet = 101;
+
+        mPowerHalService.sendDisplayBrightness(displayId, brightnessToSet);
+
+        // If only global brightness is supported, any set request will set the global brightness.
+        verify(propValueSetter).to(100);
+    }
+
     @Test
     public void testIsDeepSleepAllowed() {
         AidlHalPropConfig config = new AidlHalPropConfig(
@@ -552,8 +812,8 @@ public final class PowerHalServiceUnitTest {
 
     @Test
     public void testRequestShutdownAp() {
-        VehicleHal.HalPropValueSetter propValueSetter = mock(VehicleHal.HalPropValueSetter.class);
-        when(mHal.set(VehicleProperty.SHUTDOWN_REQUEST, /* areaId= */ 0))
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(SHUTDOWN_REQUEST, /* areaId= */ 0))
                 .thenReturn(propValueSetter);
         ArrayMap<Pair<Integer, Boolean>, Integer> testCases = new ArrayMap<>();
         testCases.put(new Pair<>(PowerState.SHUTDOWN_TYPE_POWER_OFF, true),
@@ -582,8 +842,8 @@ public final class PowerHalServiceUnitTest {
 
     @Test
     public void testRequestShutdownAp_invalidInput() {
-        VehicleHal.HalPropValueSetter propValueSetter = mock(VehicleHal.HalPropValueSetter.class);
-        when(mHal.set(VehicleProperty.SHUTDOWN_REQUEST, /* areaId= */ 0))
+        HalPropValueSetter propValueSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(SHUTDOWN_REQUEST, /* areaId= */ 0))
                 .thenReturn(propValueSetter);
 
         mPowerHalService.requestShutdownAp(/* powerState= */ 99999, /* runGarageMode= */ true);
@@ -688,6 +948,119 @@ public final class PowerHalServiceUnitTest {
                 PowerHalService.BOOTUP_REASON_UNKNOWN);
     }
 
+    @Test
+    public void testIsShutdownRequestSupported_true() {
+        when(mHal.getPropConfig(SHUTDOWN_REQUEST)).thenReturn(new AidlHalPropConfig(
+                AidlVehiclePropConfigBuilder.newBuilder(SHUTDOWN_REQUEST)
+                .build()));
+
+        assertThat(mPowerHalService.isShutdownRequestSupported()).isTrue();
+    }
+
+    @Test
+    public void testIsShutdownRequestSupported_false() {
+        when(mHal.getPropConfig(SHUTDOWN_REQUEST)).thenReturn(null);
+
+        assertThat(mPowerHalService.isShutdownRequestSupported()).isFalse();
+    }
+
+    @Test
+    public void testIsVehicleInUse_true() {
+        when(mHal.get(VEHICLE_IN_USE)).thenReturn(mPropValueBuilder.build(VEHICLE_IN_USE,
+                /* areaId= */ 0, new int[]{1}));
+
+        assertThat(mPowerHalService.isVehicleInUse()).isTrue();
+    }
+
+    @Test
+    public void testIsVehicleInUse_false() {
+        when(mHal.get(VEHICLE_IN_USE)).thenReturn(mPropValueBuilder.build(VEHICLE_IN_USE,
+                /* areaId= */ 0, new int[]{0}));
+
+        assertThat(mPowerHalService.isVehicleInUse()).isFalse();
+    }
+
+    @Test
+    public void testIsVehicleInUse_exception() {
+        when(mHal.get(VEHICLE_IN_USE)).thenThrow(new IllegalArgumentException());
+
+        // In error cases, we assume vehicle is in use.
+        assertThat(mPowerHalService.isVehicleInUse()).isTrue();
+    }
+
+    @Test
+    public void testSendHibernationExit() {
+        initPowerHal();
+
+        HalPropValueSetter mockSetter = mock(HalPropValueSetter.class);
+        when(mHal.set(AP_POWER_STATE_REPORT, 0)).thenReturn(mockSetter);
+
+        mPowerHalService.sendHibernationExit();
+
+        verify(mockSetter).to(new int[]{VehicleApPowerStateReport.HIBERNATION_EXIT, 0});
+    }
+
+    @Test
+    public void testPowerState_equal() {
+        assertThat(new PowerHalService.PowerState(1, 1))
+                .isEqualTo(new PowerHalService.PowerState(1, 1));
+        assertThat(new PowerHalService.PowerState(1, 1))
+                .isNotEqualTo(new PowerHalService.PowerState(1, 0));
+        assertThat(new PowerHalService.PowerState(1, 1))
+                .isNotEqualTo(new PowerHalService.PowerState(0, 1));
+    }
+
+    @Test
+    public void testPowerState_hashCode() {
+        var state1 = new PowerHalService.PowerState(1, 1);
+        var state2 = new PowerHalService.PowerState(1, 1);
+        var state3 = new PowerHalService.PowerState(1, 0);
+        var state4 = new PowerHalService.PowerState(0, 1);
+
+        assertThat(state1.hashCode()).isEqualTo(state2.hashCode());
+        assertThat(state3.hashCode()).isNotEqualTo(state4.hashCode());
+    }
+
+    @Test
+    public void testPowerState_toString() {
+        var powerStateStr = new PowerHalService.PowerState(1, 2).toString();
+
+        assertThat(powerStateStr).contains("1");
+        assertThat(powerStateStr).contains("2");
+    }
+
+    private void addDisplay(int displayId, int displayPort) {
+        Display display = createMockDisplay(displayId, displayPort);
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{display});
+        when(mDisplayManager.getDisplay(displayId)).thenReturn(display);
+    }
+
+    private void addDefaultDisplay() {
+        addDisplay(0, 0);
+    }
+
+    private void setupVhalSupportGlobalBrightnessOnly() {
+        setupVhalSupportGlobalBrightnessOnly(/* maxValue= */ 100);
+    }
+
+    private void setupVhalSupportGlobalBrightnessOnly(int maxValue) {
+        AidlHalPropConfig config = new AidlHalPropConfig(
+                AidlVehiclePropConfigBuilder.newBuilder(DISPLAY_BRIGHTNESS)
+                .addAreaConfig(/* areaId= */ 0, /* minValue= */ 0, maxValue).build());
+        mPowerHalService.takeProperties(List.of(config));
+        mPowerHalService.init();
+        mPowerHalService.setListener(mEventListener);
+    }
+
+    private void setupVhalSupportPerDisplayBrightnessOnly() {
+        AidlHalPropConfig config = new AidlHalPropConfig(
+                AidlVehiclePropConfigBuilder.newBuilder(PER_DISPLAY_BRIGHTNESS)
+                .addAreaConfig(/* areaId= */ 0, /* minValue= */ 0, /* maxValue= */ 100).build());
+        mPowerHalService.takeProperties(List.of(config));
+        mPowerHalService.init();
+        mPowerHalService.setListener(mEventListener);
+    }
+
     private PowerHalService.PowerState createShutdownPrepare(int flag) {
         return new PowerHalService.PowerState(SHUTDOWN_PREPARE, flag);
     }
@@ -717,6 +1090,8 @@ public final class PowerHalServiceUnitTest {
         when(displayAddress.getPort()).thenReturn(displayPort);
         when(display.getDisplayId()).thenReturn(displayId);
         when(display.getAddress()).thenReturn(displayAddress);
+        when(mDisplayHelper.getPhysicalPort(display)).thenReturn(displayPort);
+        when(mDisplayHelper.getType(display)).thenReturn(DisplayHelper.TYPE_INTERNAL);
         return display;
     }
 
diff --git a/tests/carservice_unit_test/src/com/android/car/hal/fakevhal/FakeVehicleStubUnitTest.java b/tests/carservice_unit_test/src/com/android/car/hal/fakevhal/FakeVehicleStubUnitTest.java
index 0d0b2d7227..6154e503b3 100644
--- a/tests/carservice_unit_test/src/com/android/car/hal/fakevhal/FakeVehicleStubUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/hal/fakevhal/FakeVehicleStubUnitTest.java
@@ -54,6 +54,7 @@ import android.util.SparseArray;
 
 import androidx.test.filters.SmallTest;
 
+import com.android.car.CarServiceUtils;
 import com.android.car.IVehicleDeathRecipient;
 import com.android.car.VehicleStub;
 import com.android.car.VehicleStub.AsyncGetSetRequest;
@@ -70,6 +71,7 @@ import com.android.car.internal.property.CarPropertyErrorCodes;
 
 import com.google.common.truth.Expect;
 
+import org.junit.After;
 import org.junit.Before;
 import org.junit.Rule;
 import org.junit.Test;
@@ -89,6 +91,7 @@ import java.util.List;
 @SmallTest
 @RunWith(MockitoJUnitRunner.class)
 public class FakeVehicleStubUnitTest {
+    private static final int FLAKY_RETRY_COUNT = 10;
 
     private static final int DOOR_1_LEFT = VehicleAreaDoor.ROW_1_LEFT;
     private static final int WINDOW_1_LEFT = VehicleAreaWindow.ROW_1_LEFT;
@@ -157,7 +160,6 @@ public class FakeVehicleStubUnitTest {
     public final Expect expect = Expect.create();
     @Rule
     public final RavenwoodRule mRavenwood = new RavenwoodRule.Builder()
-            .setProvideMainThread(true)
             .build();
 
     @Before
@@ -166,6 +168,11 @@ public class FakeVehicleStubUnitTest {
         when(mMockRealVehicleStub.getAllPropConfigs()).thenReturn(new HalPropConfig[0]);
     }
 
+    @After
+    public void teardown() throws Exception {
+        CarServiceUtils.quitHandlerThreads();
+    }
+
     @Test
     public void testGetAllPropConfigsWithoutCustomConfig() throws Exception {
         FakeVehicleStub fakeVehicleStub = new FakeVehicleStub(mMockRealVehicleStub,
@@ -1283,13 +1290,17 @@ public class FakeVehicleStubUnitTest {
                 new FakeVhalConfigParser(), customFileList);
 
         VehicleStub.SubscriptionClient client = fakeVehicleStub.newSubscriptionClient(callback);
-        try {
-            client.subscribe(options);
-
-            verify(callback, timeout(100).atLeast(5)).onPropertyEvent(any(ArrayList.class));
-        } finally {
-            client.unsubscribe(VehicleProperty.FUEL_LEVEL);
-        }
+        testWithRetry(() -> {
+            try {
+                client.subscribe(options);
+
+                // 200ms should generate 20 events, check for 5 events to be safe.
+                verify(callback, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+            } finally {
+                client.unsubscribe(VehicleProperty.FUEL_LEVEL);
+                clearInvocations(callback);
+            }
+        });
     }
 
     @Test
@@ -1311,18 +1322,23 @@ public class FakeVehicleStubUnitTest {
                 new FakeVhalConfigParser(), customFileList);
 
         VehicleStub.SubscriptionClient client = fakeVehicleStub.newSubscriptionClient(callback);
-        try {
-            client.subscribe(options1);
+        testWithRetry(() -> {
+            try {
+                client.subscribe(options1);
 
-            verify(callback, timeout(100).atLeast(5)).onPropertyEvent(any(ArrayList.class));
-            clearInvocations(callback);
+                // 200ms should generate 20 events, check for 5 events to be safe.
+                verify(callback, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+                clearInvocations(callback);
 
-            client.subscribe(options2);
+                client.subscribe(options2);
 
-            verify(callback, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
-        } finally {
-            client.unsubscribe(VehicleProperty.FUEL_LEVEL);
-        }
+                // 400ms should generate 20 events, check for 5 events to be safe.
+                verify(callback, timeout(400).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+            } finally {
+                client.unsubscribe(VehicleProperty.FUEL_LEVEL);
+                clearInvocations(callback);
+            }
+        });
     }
 
     @Test
@@ -1333,6 +1349,7 @@ public class FakeVehicleStubUnitTest {
         // Create subscribe options
         SubscribeOptions option = new SubscribeOptions();
         option.propId = VehicleProperty.FUEL_LEVEL;
+        // Sample rate will fit to 100f.
         option.sampleRate = 200f;
         SubscribeOptions[] options = new SubscribeOptions[]{option};
 
@@ -1340,13 +1357,17 @@ public class FakeVehicleStubUnitTest {
         FakeVehicleStub fakeVehicleStub = new FakeVehicleStub(mMockRealVehicleStub,
                 new FakeVhalConfigParser(), customFileList);
         VehicleStub.SubscriptionClient client = fakeVehicleStub.newSubscriptionClient(callback);
-        try {
-            client.subscribe(options);
-
-            verify(callback, timeout(100).atLeast(5)).onPropertyEvent(any(ArrayList.class));
-        } finally {
-            client.unsubscribe(VehicleProperty.FUEL_LEVEL);
-        }
+        testWithRetry(() -> {
+            try {
+                client.subscribe(options);
+
+                // 200ms should generate 20 events, check for 5 events to be safe.
+                verify(callback, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+            } finally {
+                client.unsubscribe(VehicleProperty.FUEL_LEVEL);
+                clearInvocations(callback);
+            }
+        });
     }
 
     @Test
@@ -1357,6 +1378,7 @@ public class FakeVehicleStubUnitTest {
         // Create subscribe options
         SubscribeOptions option = new SubscribeOptions();
         option.propId = VehicleProperty.FUEL_LEVEL;
+        // Sample rate will fit to 1f.
         option.sampleRate = -50f;
         SubscribeOptions[] options = new SubscribeOptions[]{option};
         VehicleHalCallback callback = mock(VehicleHalCallback.class);
@@ -1364,13 +1386,17 @@ public class FakeVehicleStubUnitTest {
                 new FakeVhalConfigParser(), customFileList);
 
         VehicleStub.SubscriptionClient client = fakeVehicleStub.newSubscriptionClient(callback);
-        try {
-            client.subscribe(options);
-
-            verify(callback, timeout(100).atLeast(1)).onPropertyEvent(any(ArrayList.class));
-        } finally {
-            client.unsubscribe(VehicleProperty.FUEL_LEVEL);
-        }
+        testWithRetry(() -> {
+            try {
+                client.subscribe(options);
+
+                // 2000ms should generate 2 events, check for 1 event to be safe.
+                verify(callback, timeout(2000).atLeast(1)).onPropertyEvent(any(ArrayList.class));
+            } finally {
+                client.unsubscribe(VehicleProperty.FUEL_LEVEL);
+                clearInvocations(callback);
+            }
+        });
     }
 
     @Test
@@ -1524,14 +1550,22 @@ public class FakeVehicleStubUnitTest {
                 new FakeVhalConfigParser(), customFileList);
 
         VehicleStub.SubscriptionClient client = fakeVehicleStub.newSubscriptionClient(callback);
-        client.subscribe(options);
 
-        verify(callback, timeout(100).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+        testWithRetry(() -> {
+            try {
+                client.subscribe(options);
 
-        client.unsubscribe(VehicleProperty.FUEL_LEVEL);
-        clearInvocations(callback);
+                // 200ms should generate 20 events, check for 5 events to be safe.
+                verify(callback, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+
+                client.unsubscribe(VehicleProperty.FUEL_LEVEL);
+                clearInvocations(callback);
 
-        verify(callback, after(200).atMost(1)).onPropertyEvent(any(ArrayList.class));
+                verify(callback, after(200).atMost(1)).onPropertyEvent(any(ArrayList.class));
+            } finally {
+                clearInvocations(callback);
+            }
+        });
     }
 
     @Test
@@ -1551,22 +1585,28 @@ public class FakeVehicleStubUnitTest {
 
         VehicleStub.SubscriptionClient client1 = fakeVehicleStub.newSubscriptionClient(callback1);
         VehicleStub.SubscriptionClient client2 = fakeVehicleStub.newSubscriptionClient(callback2);
-        try {
-            client1.subscribe(options);
-            client2.subscribe(options);
 
-            verify(callback1, timeout(100).atLeast(5)).onPropertyEvent(any(ArrayList.class));
-            verify(callback2, timeout(100).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+        testWithRetry(() -> {
+            try {
+                client1.subscribe(options);
+                client2.subscribe(options);
+
+                // 200ms should generate 20 events, check for 5 events to be safe.
+                verify(callback1, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+                verify(callback2, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+
+                client1.unsubscribe(VehicleProperty.FUEL_LEVEL);
+                clearInvocations(callback1);
+                clearInvocations(callback2);
 
-            client1.unsubscribe(VehicleProperty.FUEL_LEVEL);
+                verify(callback1, after(200).atMost(1)).onPropertyEvent(any(ArrayList.class));
+                verify(callback2, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+            } finally {
+                client2.unsubscribe(VehicleProperty.FUEL_LEVEL);
+            }
             clearInvocations(callback1);
             clearInvocations(callback2);
-
-            verify(callback1, after(200).atMost(1)).onPropertyEvent(any(ArrayList.class));
-            verify(callback2, timeout(100).atLeast(5)).onPropertyEvent(any(ArrayList.class));
-        } finally {
-            client2.unsubscribe(VehicleProperty.FUEL_LEVEL);
-        }
+        });
     }
 
     @Test
@@ -1588,14 +1628,23 @@ public class FakeVehicleStubUnitTest {
                 new FakeVhalConfigParser(), customFileList);
 
         VehicleStub.SubscriptionClient client = fakeVehicleStub.newSubscriptionClient(callback);
-        client.subscribe(options);
 
-        verify(callback, timeout(100).atLeast(10)).onPropertyEvent(any(ArrayList.class));
+        testWithRetry(() -> {
+            try {
+                client.subscribe(options);
 
-        client.unsubscribe(VehicleProperty.FUEL_LEVEL);
-        clearInvocations(callback);
+                // 200ms should generate 2 * 20 = 40 events, check for 10 events to be safe.
+                verify(callback, timeout(200).atLeast(10)).onPropertyEvent(any(ArrayList.class));
 
-        verify(callback, timeout(100).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+                client.unsubscribe(VehicleProperty.FUEL_LEVEL);
+                clearInvocations(callback);
+
+                // 200ms should generate 20 events, check for 5 events to be safe.
+                verify(callback, timeout(200).atLeast(5)).onPropertyEvent(any(ArrayList.class));
+            } finally {
+                clearInvocations(callback);
+            }
+        });
     }
 
     @Test
@@ -1766,4 +1815,23 @@ public class FakeVehicleStubUnitTest {
                 mSetVehicleStubAsyncResultCaptor.capture());
         return mSetVehicleStubAsyncResultCaptor.getValue();
     }
+
+    private interface RunnableWithException {
+        void run() throws Exception;
+    }
+
+    private void testWithRetry(RunnableWithException runnable) throws Exception {
+        int retryCount = 0;
+        Exception lastException = null;
+        while (retryCount < FLAKY_RETRY_COUNT) {
+            retryCount++;
+            try {
+                runnable.run();
+                return;
+            } catch (Exception e) {
+                lastException = e;
+            }
+        }
+        throw lastException;
+    }
 }
diff --git a/tests/carservice_unit_test/src/com/android/car/hal/property/PropertyHalServiceConfigsUnitTest.java b/tests/carservice_unit_test/src/com/android/car/hal/property/PropertyHalServiceConfigsUnitTest.java
index 841b030dca..3bb2529888 100644
--- a/tests/carservice_unit_test/src/com/android/car/hal/property/PropertyHalServiceConfigsUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/hal/property/PropertyHalServiceConfigsUnitTest.java
@@ -49,6 +49,7 @@ import com.android.car.hal.property.PropertyPermissionInfo.AllOfPermissions;
 import com.android.car.hal.property.PropertyPermissionInfo.AnyOfPermissions;
 import com.android.car.hal.property.PropertyPermissionInfo.PermissionCondition;
 import com.android.car.hal.property.PropertyPermissionInfo.PropertyPermissions;
+import com.android.car.hal.property.PropertyPermissionInfo.PropertyPermissionsBuilder;
 import com.android.car.hal.property.PropertyPermissionInfo.SinglePermission;
 
 import org.junit.Before;
@@ -462,12 +463,11 @@ public final class PropertyHalServiceConfigsUnitTest extends AbstractExpectableT
             }
         }
                 """);
-        CarSvcPropertyConfig expectedConfig = new CarSvcPropertyConfig();
-        expectedConfig.propertyId = 1234;
-        expectedConfig.halPropId = 2345;
-        expectedConfig.propertyName = "PROP_NAME";
-        expectedConfig.description = "DESCRIPTION";
-        expectedConfig.permissions =  new PropertyPermissions.Builder()
+        int propertyId = 1234;
+        int halPropId = 2345;
+        String propertyName = "PROP_NAME";
+        String description = "DESCRIPTION";
+        var permissions =  new PropertyPermissionsBuilder()
                 .setReadPermission(new AnyOfPermissions(
                         new SinglePermission("PERM1"),
                         new SinglePermission("PERM2")
@@ -477,7 +477,10 @@ public final class PropertyHalServiceConfigsUnitTest extends AbstractExpectableT
                         new SinglePermission("PERM2")
                 ))
                 .build();
-        expectedConfig.dataEnums = new ArraySet<>(Set.of(0, 1, 2));
+        var dataEnums = new ArraySet<>(Set.of(0, 1, 2));
+
+        CarSvcPropertyConfig expectedConfig = new CarSvcPropertyConfig(propertyId, halPropId,
+                propertyName, description, permissions, dataEnums, /* validBitFlag= */ null);
 
         SparseArray<CarSvcPropertyConfig> configs = mPropertyHalServiceConfigs.parseJsonConfig(
                 is, /* path= */ "test");
@@ -506,15 +509,18 @@ public final class PropertyHalServiceConfigsUnitTest extends AbstractExpectableT
             }
         }
                 """);
-        CarSvcPropertyConfig expectedConfig = new CarSvcPropertyConfig();
-        expectedConfig.propertyId = 1234;
-        expectedConfig.halPropId = 1234;
-        expectedConfig.propertyName = "PROP_NAME";
-        expectedConfig.description = "DESCRIPTION";
-        expectedConfig.permissions =  new PropertyPermissions.Builder()
+        int propertyId = 1234;
+        int halPropId = 1234;
+        String propertyName = "PROP_NAME";
+        String description = "DESCRIPTION";
+        PropertyPermissions permissions =  new PropertyPermissionsBuilder()
                 .setReadPermission(new SinglePermission("PERM1"))
                 .build();
 
+        var expectedConfig = new CarSvcPropertyConfig(propertyId, halPropId,
+                propertyName, description, permissions, /* dataEnums= */ null,
+                /* validBitFlag= */ null);
+
         SparseArray<CarSvcPropertyConfig> configs = mPropertyHalServiceConfigs.parseJsonConfig(
                 is, /* path= */ "test");
         CarSvcPropertyConfig config = configs.get(1234);
@@ -541,16 +547,19 @@ public final class PropertyHalServiceConfigsUnitTest extends AbstractExpectableT
             }
         }
                 """);
-        CarSvcPropertyConfig expectedConfig = new CarSvcPropertyConfig();
-        expectedConfig.propertyId = 1234;
-        expectedConfig.halPropId = 1234;
-        expectedConfig.propertyName = "PROP_NAME";
-        expectedConfig.description = "DESCRIPTION";
-        expectedConfig.permissions =  new PropertyPermissions.Builder()
+        int propertyId = 1234;
+        int halPropId = 1234;
+        String propertyName = "PROP_NAME";
+        String description = "DESCRIPTION";
+        PropertyPermissions permissions =  new PropertyPermissionsBuilder()
                 .setReadPermission(new SinglePermission("PERM1"))
                 .build();
         // Bit: 1111
-        expectedConfig.validBitFlag = 15;
+        int validBitFlag = 15;
+
+        var expectedConfig = new CarSvcPropertyConfig(propertyId, halPropId,
+                propertyName, description, permissions, /* dataEnums= */ null,
+                validBitFlag);
 
         SparseArray<CarSvcPropertyConfig> configs = mPropertyHalServiceConfigs.parseJsonConfig(
                 is, /* path= */ "test");
diff --git a/tests/carservice_unit_test/src/com/android/car/hal/property/PropertyPermissionInfoTest.java b/tests/carservice_unit_test/src/com/android/car/hal/property/PropertyPermissionInfoTest.java
index 903422bdfc..dc87400d6b 100644
--- a/tests/carservice_unit_test/src/com/android/car/hal/property/PropertyPermissionInfoTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/hal/property/PropertyPermissionInfoTest.java
@@ -28,6 +28,7 @@ import com.android.car.hal.property.PropertyPermissionInfo.AllOfPermissions;
 import com.android.car.hal.property.PropertyPermissionInfo.AnyOfPermissions;
 import com.android.car.hal.property.PropertyPermissionInfo.PermissionCondition;
 import com.android.car.hal.property.PropertyPermissionInfo.PropertyPermissions;
+import com.android.car.hal.property.PropertyPermissionInfo.PropertyPermissionsBuilder;
 import com.android.car.hal.property.PropertyPermissionInfo.SinglePermission;
 // import com.google.common.testing.EqualsTester;
 
@@ -146,18 +147,18 @@ public class PropertyPermissionInfoTest {
 
     @Test
     public void tesPropertyPermissionsHash() {
-        PropertyPermissions p1 = new PropertyPermissions.Builder()
+        PropertyPermissions p1 = new PropertyPermissionsBuilder()
                 .setReadPermission(new SinglePermission("abc"))
                 .setWritePermission(new SinglePermission("bcd"))
                 .build();
-        PropertyPermissions p2 = new PropertyPermissions.Builder()
+        PropertyPermissions p2 = new PropertyPermissionsBuilder()
                 .setReadPermission(new SinglePermission("abc"))
                 .setWritePermission(new SinglePermission("bcd"))
                 .build();
-        PropertyPermissions p3 = new PropertyPermissions.Builder()
+        PropertyPermissions p3 = new PropertyPermissionsBuilder()
                 .setReadPermission(new SinglePermission("abc"))
                 .build();
-        PropertyPermissions p4 = new PropertyPermissions.Builder()
+        PropertyPermissions p4 = new PropertyPermissionsBuilder()
                 .setWritePermission(new SinglePermission("bcd"))
                 .build();
 
@@ -217,18 +218,18 @@ public class PropertyPermissionInfoTest {
 
     @Test
     public void testPropertyPermissionsEqual() {
-        PropertyPermissions p1 = new PropertyPermissions.Builder()
+        PropertyPermissions p1 = new PropertyPermissionsBuilder()
                 .setReadPermission(new SinglePermission("abc"))
                 .setWritePermission(new SinglePermission("bcd"))
                 .build();
-        PropertyPermissions p2 = new PropertyPermissions.Builder()
+        PropertyPermissions p2 = new PropertyPermissionsBuilder()
                 .setReadPermission(new SinglePermission("abc"))
                 .setWritePermission(new SinglePermission("bcd"))
                 .build();
-        PropertyPermissions p3 = new PropertyPermissions.Builder()
+        PropertyPermissions p3 = new PropertyPermissionsBuilder()
                 .setReadPermission(new SinglePermission("abc"))
                 .build();
-        PropertyPermissions p4 = new PropertyPermissions.Builder()
+        PropertyPermissions p4 = new PropertyPermissionsBuilder()
                 .setWritePermission(new SinglePermission("bcd"))
                 .build();
 
diff --git a/tests/carservice_unit_test/src/com/android/car/hardware/power/CarPowerManagerUnitTest.java b/tests/carservice_unit_test/src/com/android/car/hardware/power/CarPowerManagerUnitTest.java
index 56bda1034c..776dc443fe 100644
--- a/tests/carservice_unit_test/src/com/android/car/hardware/power/CarPowerManagerUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/hardware/power/CarPowerManagerUnitTest.java
@@ -74,9 +74,10 @@ import com.android.car.hal.PowerHalService;
 import com.android.car.hal.PowerHalService.PowerState;
 import com.android.car.power.CarPowerManagementService;
 import com.android.car.power.PowerComponentHandler;
-import com.android.car.systeminterface.DisplayInterface;
 import com.android.car.systeminterface.SystemInterface;
 import com.android.car.systeminterface.SystemStateInterface;
+import com.android.car.systeminterface.WakeLockInterface;
+import com.android.car.systeminterface.test.DisplayInterfaceEmptyImpl;
 import com.android.car.user.CarUserService;
 import com.android.compatibility.common.util.PollingCheck;
 import com.android.internal.annotations.GuardedBy;
@@ -137,6 +138,8 @@ public final class CarPowerManagerUnitTest extends AbstractExtendedMockitoTestCa
     @Mock
     private UserManager mUserManager;
     @Mock
+    private WakeLockInterface mWakeLockInterface;
+    @Mock
     private CarUserService mCarUserService;
     //TODO(286303350): replace this with refactored power policy daemon once refactor is complete
     @Mock
@@ -153,7 +156,8 @@ public final class CarPowerManagerUnitTest extends AbstractExtendedMockitoTestCa
                 /*isDeepSleepAllowed=*/true,
                 /*isHibernationAllowed=*/true,
                 /*isTimedWakeupAllowed=*/true);
-        mSystemInterface = SystemInterface.Builder.defaultSystemInterface(mContext)
+        mSystemInterface = SystemInterface.Builder.defaultSystemInterface(mContext,
+                mWakeLockInterface)
                 .withDisplayInterface(mDisplayInterface)
                 .withSystemStateInterface(mSystemStateInterface)
                 .build();
@@ -561,21 +565,11 @@ public final class CarPowerManagerUnitTest extends AbstractExtendedMockitoTestCa
         }
     }
 
-    private static final class MockDisplayInterface implements DisplayInterface {
+    private static final class MockDisplayInterface extends DisplayInterfaceEmptyImpl {
         @GuardedBy("sLock")
         private final SparseBooleanArray mDisplayOn = new SparseBooleanArray();
         private final Semaphore mDisplayStateWait = new Semaphore(0);
 
-        @Override
-        public void init(CarPowerManagementService carPowerManagementService,
-                CarUserService carUserService) {}
-
-        @Override
-        public void setDisplayBrightness(int brightness) {}
-
-        @Override
-        public void setDisplayBrightness(int displayId, int brightness) {}
-
         @Override
         public void setDisplayState(int displayId, boolean on) {
             synchronized (sLock) {
@@ -594,18 +588,6 @@ public final class CarPowerManagerUnitTest extends AbstractExtendedMockitoTestCa
             }
         }
 
-        @Override
-        public void startDisplayStateMonitoring() {}
-
-        @Override
-        public void stopDisplayStateMonitoring() {}
-
-        @Override
-        public void refreshDisplayBrightness() {}
-
-        @Override
-        public void refreshDisplayBrightness(int displayId) {}
-
         @Override
         public boolean isAnyDisplayEnabled() {
             synchronized (sLock) {
diff --git a/tests/carservice_unit_test/src/com/android/car/internal/PendingRequestPoolUnitTest.java b/tests/carservice_unit_test/src/com/android/car/internal/PendingRequestPoolUnitTest.java
index b67bae3d93..025e677291 100644
--- a/tests/carservice_unit_test/src/com/android/car/internal/PendingRequestPoolUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/internal/PendingRequestPoolUnitTest.java
@@ -21,11 +21,13 @@ import static com.google.common.truth.Truth.assertWithMessage;
 import android.os.HandlerThread;
 import android.os.Looper;
 import android.os.SystemClock;
+import android.platform.test.ravenwood.RavenwoodRule;
 
 import com.android.internal.annotations.GuardedBy;
 
 import org.junit.After;
 import org.junit.Before;
+import org.junit.Rule;
 import org.junit.Test;
 
 import java.util.ArrayList;
@@ -36,6 +38,10 @@ import java.util.List;
  */
 public final class PendingRequestPoolUnitTest {
 
+    @Rule
+    public final RavenwoodRule mRavenwood = new RavenwoodRule.Builder()
+            .setProvideMainThread(true).build();
+
     private static final class LongTestRequest implements LongRequestIdWithTimeout {
         private final long mRequestId;
         private final long mTimeoutUptimeMs;
@@ -161,14 +167,14 @@ public final class PendingRequestPoolUnitTest {
                 new Long[]{testRequestId1, testRequestId2});
 
         // Must remove the timeout request explicitly.
-        mLongPendingRequestPool.removeRequest(testRequestId1);
-        mLongPendingRequestPool.removeRequest(testRequestId2);
+        mLongPendingRequestPool.removeRequest(testRequestId1, /* alreadyTimedOut= */ true);
+        mLongPendingRequestPool.removeRequest(testRequestId2, /* alreadyTimedOut= */ true);
         assertWithMessage("Expect request pool to be empty after the test").that(
                 mLongPendingRequestPool.isEmpty()).isTrue();
     }
 
     @Test
-    public void testRequestsAlreadyTimeoutNoDuplicateCallbacksCalled() throws Exception {
+    public void testRequestsAlreadyTimedOutNoDuplicateCallbacksCalled() throws Exception {
         long testRequestId1 = 123;
         long testRequestId2 = 234;
         long testRequestId3 = 345;
@@ -199,9 +205,9 @@ public final class PendingRequestPoolUnitTest {
                 new Long[]{testRequestId1, testRequestId2, testRequestId3});
 
         // Clean up the requests.
-        mLongPendingRequestPool.removeRequest(testRequestId1);
-        mLongPendingRequestPool.removeRequest(testRequestId2);
-        mLongPendingRequestPool.removeRequest(testRequestId3);
+        mLongPendingRequestPool.removeRequest(testRequestId1, /* alreadyTimedOut= */ true);
+        mLongPendingRequestPool.removeRequest(testRequestId2, /* alreadyTimedOut= */ true);
+        mLongPendingRequestPool.removeRequest(testRequestId3, /* alreadyTimedOut= */ true);
         assertWithMessage("Expect request pool to be empty after the test").that(
                 mLongPendingRequestPool.isEmpty()).isTrue();
     }
diff --git a/tests/carservice_unit_test/src/com/android/car/pm/VendorServiceControllerTest.java b/tests/carservice_unit_test/src/com/android/car/pm/VendorServiceControllerTest.java
index 8339968934..1a9a25a11d 100644
--- a/tests/carservice_unit_test/src/com/android/car/pm/VendorServiceControllerTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/pm/VendorServiceControllerTest.java
@@ -16,21 +16,18 @@
 
 package com.android.car.pm;
 
-import static android.car.test.mocks.CarArgumentMatchers.isUserHandle;
-
-import static com.android.dx.mockito.inline.extended.ExtendedMockito.spyOn;
-
 import static org.junit.Assert.fail;
 import static org.mockito.ArgumentMatchers.anyInt;
-import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.any;
 import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.when;
 
 import android.annotation.UserIdInt;
 import android.app.ActivityManager;
+import android.app.admin.DevicePolicyManager;
 import android.car.hardware.power.CarPowerManager;
 import android.car.hardware.power.ICarPowerStateListener;
-import android.car.test.mocks.AbstractExtendedMockitoTestCase;
+import android.car.test.AbstractExpectableTestCase;
 import android.car.testapi.BlockingUserLifecycleListener;
 import android.car.user.CarUserManager;
 import android.content.BroadcastReceiver;
@@ -42,15 +39,16 @@ import android.content.IntentFilter;
 import android.content.ServiceConnection;
 import android.content.pm.UserInfo;
 import android.content.res.Resources;
+import android.location.LocationManager;
 import android.net.Uri;
 import android.os.Handler;
 import android.os.Looper;
 import android.os.UserHandle;
 import android.os.UserManager;
+import android.util.ArraySet;
 import android.util.Log;
 
 import androidx.annotation.Nullable;
-import androidx.test.core.app.ApplicationProvider;
 
 import com.android.car.CarLocalServices;
 import com.android.car.CarOccupantZoneService;
@@ -58,28 +56,37 @@ import com.android.car.CarUxRestrictionsManagerService;
 import com.android.car.hal.UserHalService;
 import com.android.car.internal.common.CommonConstants.UserLifecycleEventType;
 import com.android.car.power.CarPowerManagementService;
+import com.android.car.provider.Settings;
 import com.android.car.user.CarUserService;
+import com.android.car.user.CurrentUserFetcher;
+import com.android.car.user.UserHandleHelper;
 import com.android.internal.annotations.GuardedBy;
 import com.android.internal.util.Preconditions;
 
 import org.junit.After;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
 import org.mockito.ArgumentCaptor;
 import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnitRunner;
 
 import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
+import java.util.Set;
 import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.Executor;
 import java.util.concurrent.TimeUnit;
 import java.util.function.BiFunction;
 import java.util.stream.Collectors;
 
-public final class VendorServiceControllerTest extends AbstractExtendedMockitoTestCase {
+// TODO(b/348680063): Enable this on host once we can mock LocationManager on host. Currently it
+// throws ClassNotFound error possibly due to some static methods using unsupported APIs.
+@RunWith(MockitoJUnitRunner.class)
+public final class VendorServiceControllerTest extends AbstractExpectableTestCase {
     private static final String TAG = VendorServiceControllerTest.class.getSimpleName();
 
     // TODO(b/152069895): decrease value once refactored. In fact, it should not even use
@@ -118,54 +125,93 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
 
     @Mock
     private Resources mResources;
-
     @Mock
     private UserManager mUserManager;
-
     @Mock
     private UserHalService mUserHal;
-
     @Mock
     private CarUxRestrictionsManagerService mUxRestrictionService;
-
     @Mock
     private CarPackageManagerService mCarPackageManagerService;
-
     @Mock
     private CarPowerManagementService mCarPowerManagementService;
-
     @Mock
     private CarOccupantZoneService mCarOccupantZoneService;
+    @Mock
+    private CurrentUserFetcher mCurrentUserFetcher;
+    @Mock
+    private DevicePolicyManager mDevicePolicyManager;
+    @Mock
+    private ActivityManager mActivityManager;
+    @Mock
+    private LocationManager mLocationManager;
+    @Mock
+    private Context mBaseContext;
+    @Mock
+    private Settings mSettings;
 
     private ServiceLauncherContext mContext;
     private CarUserService mCarUserService;
     private VendorServiceController mController;
 
-    public VendorServiceControllerTest() {
-        super(VendorServiceController.TAG);
-    }
-
-    @Override
-    protected void onSessionBuilder(CustomMockitoSessionBuilder session) {
-        session.spyStatic(ActivityManager.class);
-    }
+    private final Object mLock = new Object();
+    @GuardedBy("mLock")
+    private int mUnlockingOrUnlockedUserId;
+    @GuardedBy("mLock")
+    private Set<UserHandle> mVisibleUsers = new ArraySet<UserHandle>();
 
     @Before
     public void setUp() throws Exception {
-        mContext = new ServiceLauncherContext(ApplicationProvider.getApplicationContext());
+        mContext = new ServiceLauncherContext(mBaseContext);
+
+        // Required for getting/setting user ID in InitialUserSetter.
+        when(mSettings.getIntGlobal(any(), any(), anyInt())).thenAnswer((inv) -> {
+            // Return the default value.
+            return inv.getArgument(2);
+        });
+
+        // No visible users by default.
+        synchronized (mLock) {
+            mVisibleUsers.clear();
+        }
+        when(mUserManager.getVisibleUsers()).thenAnswer((inv) -> {
+            synchronized (mLock) {
+                return new ArraySet<UserHandle>(mVisibleUsers);
+            }
+        });
+
+        synchronized (mLock) {
+            // Reset unlocking or unlocked user Id for each test case.
+            mUnlockingOrUnlockedUserId = 123456;
+        }
+        when(mUserManager.isUserUnlockingOrUnlocked(anyInt())).thenAnswer((inv) -> {
+            int userId = inv.getArgument(0);
+            synchronized (mLock) {
+                return userId == mUnlockingOrUnlockedUserId;
+            }
+        });
+        when(mUserManager.isUserUnlockingOrUnlocked(any(UserHandle.class))).thenAnswer((inv) -> {
+            UserHandle userHandle = inv.getArgument(0);
+            synchronized (mLock) {
+                return userHandle.getIdentifier() == mUnlockingOrUnlockedUserId;
+            }
+        });
 
         mCarUserService = new CarUserService(mContext, mUserHal, mUserManager,
                 /* maxRunningUsers= */ 2, mUxRestrictionService, mCarPackageManagerService,
-                mCarOccupantZoneService);
-        spyOn(mCarUserService);
+                mCarOccupantZoneService,
+                new CarUserService.Deps(new UserHandleHelper(mContext, mUserManager),
+                        mDevicePolicyManager, mActivityManager,
+                        /* initialUserSetter= */ null, /* handler= */ null,
+                        mCurrentUserFetcher, mSettings));
+
         CarLocalServices.removeServiceForTest(CarUserService.class);
         CarLocalServices.addService(CarUserService.class, mCarUserService);
         CarLocalServices.removeServiceForTest(CarPowerManagementService.class);
         CarLocalServices.addService(CarPowerManagementService.class, mCarPowerManagementService);
-        // No visible users by default.
-        doReturn(false).when(mCarUserService).isUserVisible(anyInt());
 
-        mController = new VendorServiceController(mContext, Looper.getMainLooper());
+        mController = new VendorServiceController(mContext, Looper.getMainLooper(),
+                mCurrentUserFetcher);
 
         UserInfo persistentFgUser = new UserInfo(FG_USER_ID, "persistent user", /* flags= */ 0);
         when(mUserManager.getUserInfo(FG_USER_ID)).thenReturn(persistentFgUser);
@@ -180,6 +226,10 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
         CarLocalServices.removeServiceForTest(CarPowerManagementService.class);
     }
 
+    private void mockGetCurrentUser(int userHandle) {
+        when(mCurrentUserFetcher.getCurrentUser()).thenReturn(userHandle);
+    }
+
     @Test
     public void init_nothingConfigured() {
         when(mResources.getStringArray(com.android.car.R.array.config_earlyStartupServices))
@@ -235,6 +285,8 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
         mContext.reset();
         mContext.expectServices(SERVICE_START_SYSTEM_UNLOCKED, SERVICE_BIND_SYSTEM_USER_RESUME);
 
+        // Current user is a regular user.
+        mockGetCurrentUser(10);
         // Unlock system user
         mockUserUnlock(UserHandle.USER_SYSTEM);
         sendUserLifecycleEvent(CarUserManager.USER_LIFECYCLE_EVENT_TYPE_UNLOCKED,
@@ -277,6 +329,16 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
         mContext.expectNoMoreServiceLaunches();
     }
 
+    private void setVisibleUsers(Set<Integer> visibleUserIds) {
+        Set<UserHandle> userHandles = new ArraySet<>();
+        for (int userId : visibleUserIds) {
+            userHandles.add(UserHandle.of(userId));
+        }
+        synchronized (mLock) {
+            mVisibleUsers = userHandles;
+        }
+    }
+
     @Test
     public void testVisibleUsers() throws Exception {
         // No visible users yet.
@@ -287,7 +349,7 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
         // A background user becomes visible.
         mContext.expectServices(SERVICE_BIND_ALL_USERS_ASAP, SERVICE_BIND_BG_VISIBLE_USER_ASAP,
                 SERVICE_START_VISIBLE_USER_ASAP);
-        mockIsUserVisible(VISIBLE_BG_USER1_ID, true);
+        setVisibleUsers(Set.of(VISIBLE_BG_USER1_ID));
         sendUserLifecycleEvent(CarUserManager.USER_LIFECYCLE_EVENT_TYPE_VISIBLE,
                 VISIBLE_BG_USER1_ID);
 
@@ -299,7 +361,7 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
         // Unlock another visible background user.
         mContext.expectServices(SERVICE_BIND_ALL_USERS_ASAP, SERVICE_BIND_BG_VISIBLE_USER_ASAP,
                 SERVICE_START_VISIBLE_USER_ASAP, SERVICE_START_VISIBLE_USER_UNLOCKED);
-        mockIsUserVisible(VISIBLE_BG_USER2_ID, true);
+        setVisibleUsers(Set.of(VISIBLE_BG_USER1_ID, VISIBLE_BG_USER2_ID));
         mockUserUnlock(VISIBLE_BG_USER2_ID);
         sendUserLifecycleEvent(CarUserManager.USER_LIFECYCLE_EVENT_TYPE_UNLOCKED,
                 VISIBLE_BG_USER2_ID);
@@ -323,7 +385,7 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
         // Unlock foreground user. This triggers "visible", but not "backgroundVisible".
         mContext.expectServices(SERVICE_BIND_FG_USER_UNLOCKED, SERVICE_START_VISIBLE_USER_ASAP,
                 SERVICE_START_VISIBLE_USER_UNLOCKED);
-        mockIsUserVisible(FG_USER_ID, true);
+        setVisibleUsers(Set.of(VISIBLE_BG_USER1_ID, VISIBLE_BG_USER2_ID, FG_USER_ID));
         mockUserUnlock(FG_USER_ID);
         sendUserLifecycleEvent(CarUserManager.USER_LIFECYCLE_EVENT_TYPE_UNLOCKED, FG_USER_ID);
 
@@ -336,7 +398,7 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
         // A background user becomes invisible.
         mContext.expectServicesToUnbindOrStop(SERVICE_BIND_BG_VISIBLE_USER_ASAP,
                 SERVICE_START_VISIBLE_USER_ASAP, SERVICE_START_VISIBLE_USER_UNLOCKED);
-        mockIsUserVisible(VISIBLE_BG_USER2_ID, false);
+        setVisibleUsers(Set.of(VISIBLE_BG_USER1_ID, FG_USER_ID));
         sendUserLifecycleEvent(CarUserManager.USER_LIFECYCLE_EVENT_TYPE_INVISIBLE,
                 VISIBLE_BG_USER2_ID);
 
@@ -440,15 +502,10 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
         listener.onStateChanged(state, /* expirationTimeMs= */ 3000L);
     }
 
-    // TODO: Replace this with AndroidMockitoHelper#mockUmIsUserUnlockingOrUnlocked
-    // We need to figure out why we get WrongTypeOfReturnValue error with when()..thenReturn().
     private void mockUserUnlock(@UserIdInt int userId) {
-        doReturn(true).when(mUserManager).isUserUnlockingOrUnlocked(isUserHandle(userId));
-        doReturn(true).when(mUserManager).isUserUnlockingOrUnlocked(userId);
-    }
-
-    private void mockIsUserVisible(@UserIdInt int userId, boolean visible) throws Exception {
-        doReturn(visible).when(mCarUserService).isUserVisible(userId);
+        synchronized (mLock) {
+            mUnlockingOrUnlockedUserId = userId;
+        }
     }
 
     private static void runOnMainThreadAndWaitForIdle(Runnable r) {
@@ -680,7 +737,22 @@ public final class VendorServiceControllerTest extends AbstractExtendedMockitoTe
             if (Context.USER_SERVICE.equals(name)) {
                 return mUserManager;
             }
-            return super.getSystemService(name);
+            // Used in CarUserService.setSystemUserRestrictions
+            if (Context.LOCATION_SERVICE.equals(name)) {
+                return mLocationManager;
+            }
+            return null;
+        }
+
+        @Override
+        public String getSystemServiceName(Class<?> clazz) {
+            if (clazz.equals(UserManager.class)) {
+                return Context.USER_SERVICE;
+            }
+            if (clazz.equals(LocationManager.class)) {
+                return Context.LOCATION_SERVICE;
+            }
+            return "";
         }
 
         @Nullable
diff --git a/tests/carservice_unit_test/src/com/android/car/power/CarPowerManagementServiceUnitTest.java b/tests/carservice_unit_test/src/com/android/car/power/CarPowerManagementServiceUnitTest.java
index b88dfd5ba1..fdd86c4f54 100644
--- a/tests/carservice_unit_test/src/com/android/car/power/CarPowerManagementServiceUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/power/CarPowerManagementServiceUnitTest.java
@@ -104,11 +104,12 @@ import com.android.car.hal.PowerHalService;
 import com.android.car.hal.PowerHalService.PowerState;
 import com.android.car.hal.VehicleHal;
 import com.android.car.internal.util.IndentingPrintWriter;
-import com.android.car.systeminterface.DisplayInterface;
+import com.android.car.systeminterface.DisplayHelperInterface;
 import com.android.car.systeminterface.IOInterface;
 import com.android.car.systeminterface.SystemInterface;
 import com.android.car.systeminterface.SystemStateInterface;
 import com.android.car.systeminterface.WakeLockInterface;
+import com.android.car.systeminterface.test.DisplayInterfaceEmptyImpl;
 import com.android.car.test.utils.TemporaryDirectory;
 import com.android.car.user.CarUserService;
 import com.android.compatibility.common.util.PollingCheck;
@@ -255,6 +256,8 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
     private ActivityManager.RunningAppProcessInfo mRunningProcess1;
     @Mock
     private ActivityManager.RunningAppProcessInfo mRunningProcess2;
+    @Mock
+    private DisplayHelperInterface mDisplayHelper;
 
     public CarPowerManagementServiceUnitTest() throws Exception {
         super(CarPowerManagementService.TAG);
@@ -275,10 +278,10 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
                 /*isDeepSleepAllowed=*/true,
                 /*isHibernationAllowed=*/true,
                 /*isTimedWakeupAllowed=*/true);
-        mSystemInterface = SystemInterface.Builder.defaultSystemInterface(mContext)
+        mSystemInterface = SystemInterface.Builder.defaultSystemInterface(mContext,
+                mWakeLockInterface)
             .withDisplayInterface(mDisplayInterface)
             .withSystemStateInterface(mSystemStateInterface)
-            .withWakeLockInterface(mWakeLockInterface)
             .withIOInterface(mIOInterface).build();
         HandlerThread handlerThread = CarServiceUtils.getHandlerThread(TAG);
         mScreenOffHandler = new FakeScreenOffHandler(
@@ -287,6 +290,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         setCurrentUser(CURRENT_USER_ID, /* isGuest= */ false);
         setService();
         setCarPowerCancelShellCommand(true);
+        mService.changeShouldChangeSwap(false);
     }
 
     @After
@@ -294,6 +298,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         if (mService != null) {
             mService.release();
         }
+        mService.changeShouldChangeSwap(true);
         CarServiceUtils.quitHandlerThreads();
         CarLocalServices.removeServiceForTest(CarPowerManagementService.class);
         mIOInterface.tearDown();
@@ -334,6 +339,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
     @Test
     public void testCanHibernate() throws Exception {
         setStopProcessBeforeSuspendToDisk(false);
+        setChangeSwapDuringSuspendToDiskToFalse();
         mPowerSignalListener.addEventListener(PowerHalService.SET_ON);
         mPowerSignalListener.addEventListener(PowerHalService.SET_HIBERNATION_ENTRY);
         mPowerSignalListener.addEventListener(PowerHalService.SET_HIBERNATION_EXIT);
@@ -358,6 +364,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
     @Test
     public void testHibernateImmediately() throws Exception {
         setStopProcessBeforeSuspendToDisk(true);
+        setChangeSwapDuringSuspendToDiskToFalse();
         when(mResources.getString(R.string.config_suspend_to_disk_memory_savings))
                 .thenReturn("none");
         hibernateImmediately();
@@ -370,6 +377,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         doReturn(List.of(mRunningProcess1)).when(
                 () -> ActivityManagerHelper.getRunningAppProcesses());
         setStopProcessBeforeSuspendToDisk(true);
+        setChangeSwapDuringSuspendToDiskToFalse();
         mRunningProcess1.pkgList = new String[]{PROCESS_TEST_NAME_1};
         mRunningProcess1.importance = ActivityManager.RunningAppProcessInfo
                 .IMPORTANCE_FOREGROUND_SERVICE;
@@ -387,6 +395,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         doReturn(List.of(mRunningProcess1, mRunningProcess2)).when(
                 () -> ActivityManagerHelper.getRunningAppProcesses());
         setStopProcessBeforeSuspendToDisk(true);
+        setChangeSwapDuringSuspendToDiskToFalse();
         mRunningProcess1.pkgList = new String[]{PROCESS_TEST_NAME_1};
         mRunningProcess1.importance = ActivityManager.RunningAppProcessInfo
                 .IMPORTANCE_FOREGROUND_SERVICE;
@@ -412,6 +421,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         doReturn(List.of(mRunningProcess1, mRunningProcess2)).when(
                 () -> ActivityManagerHelper.getRunningAppProcesses());
         setStopProcessBeforeSuspendToDisk(true);
+        setChangeSwapDuringSuspendToDiskToFalse();
         mRunningProcess1.pkgList = new String[]{PROCESS_TEST_NAME_1};
         mRunningProcess1.importance = ActivityManager.RunningAppProcessInfo
                 .IMPORTANCE_FOREGROUND_SERVICE;
@@ -439,6 +449,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         doReturn(List.of(mRunningProcess1, mRunningProcess2)).when(
                 () -> ActivityManagerHelper.getRunningAppProcesses());
         setStopProcessBeforeSuspendToDisk(true);
+        setChangeSwapDuringSuspendToDiskToFalse();
         mRunningProcess1.pkgList = new String[]{PROCESS_TEST_NAME_1};
         mRunningProcess1.importance = ActivityManager.RunningAppProcessInfo
                 .IMPORTANCE_FOREGROUND_SERVICE;
@@ -468,6 +479,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         doReturn(List.of(mRunningProcess1, mRunningProcess2)).when(
                 () -> ActivityManagerHelper.getRunningAppProcesses());
         setStopProcessBeforeSuspendToDisk(true);
+        setChangeSwapDuringSuspendToDiskToFalse();
         mRunningProcess1.pkgList = new String[]{PROCESS_TEST_NAME_1};
         mRunningProcess1.importance = ActivityManager.RunningAppProcessInfo
                 .IMPORTANCE_FOREGROUND_SERVICE;
@@ -495,6 +507,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         doReturn(List.of(mRunningProcess1, mRunningProcess2)).when(
                 () -> ActivityManagerHelper.getRunningAppProcesses());
         setStopProcessBeforeSuspendToDisk(true);
+        setChangeSwapDuringSuspendToDiskToFalse();
         mRunningProcess1.pkgList = new String[]{PROCESS_TEST_NAME_1};
         mRunningProcess1.importance = ActivityManager.RunningAppProcessInfo
                 .IMPORTANCE_FOREGROUND_SERVICE;
@@ -1771,6 +1784,26 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         waitForPowerPolicy(SYSTEM_POWER_POLICY_ALL_ON);
     }
 
+    @Test
+    public void testSuspendImmediately() throws Exception {
+        mPowerSignalListener.addEventListener(PowerHalService.SET_ON);
+        mPowerSignalListener.addEventListener(PowerHalService.SET_DEEP_SLEEP_ENTRY);
+        // Start in the ON state
+        mPowerHal.setCurrentPowerState(new PowerState(VehicleApPowerStateReq.ON, 0));
+        mPowerSignalListener.waitFor(PowerHalService.SET_ON, WAIT_TIMEOUT_MS);
+        // Request suspend
+        mPowerHal.setCurrentPowerState(
+                new PowerState(
+                        VehicleApPowerStateReq.SHUTDOWN_PREPARE,
+                        VehicleApPowerStateShutdownParam.CAN_SLEEP));
+        mPowerHal.setCurrentPowerState(
+                new PowerState(
+                        VehicleApPowerStateReq.SHUTDOWN_PREPARE,
+                        VehicleApPowerStateShutdownParam.SLEEP_IMMEDIATELY));
+        // Verify suspend
+        mPowerSignalListener.waitFor(PowerHalService.SET_DEEP_SLEEP_ENTRY, WAIT_TIMEOUT_LONG_MS);
+    }
+
     @Test
     public void testPowerPolicyAfterShutdownCancel_powerPolicyRefactorFlagEnabled()
             throws Exception {
@@ -2064,7 +2097,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         int brightness = 25;
         int displayId = Display.DEFAULT_DISPLAY;
 
-        mService.sendDisplayBrightness(brightness);
+        mService.sendDisplayBrightnessLegacy(brightness);
 
         mPowerHal.waitForBrightnessSent(displayId, brightness, WAIT_TIMEOUT_MS);
         assertWithMessage("Display " + displayId + " brightness sent with no display ID").that(
@@ -2394,7 +2427,8 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         var vehicleHal = new VehicleHal(mContext, mockVehicleStub);
         var service = new CarPowerManagementService.Builder()
                 .setContext(mContext).setResources(mResources)
-                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal))
+                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal,
+                        mDisplayHelper))
                 .setSystemInterface(mSystemInterface).setUserManager(mUserManager)
                 .setCarUserService(mUserService).setPowerPolicyDaemon(mRefactoredPowerPolicyDaemon)
                 .setPowerComponentHandler(mPowerComponentHandler).setFeatureFlags(mFeatureFlags)
@@ -2434,7 +2468,8 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         var vehicleHal = new VehicleHal(mContext, mockVehicleStub);
         var service = new CarPowerManagementService.Builder()
                 .setContext(mContext).setResources(mResources)
-                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal))
+                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal,
+                        mDisplayHelper))
                 .setSystemInterface(mSystemInterface).setUserManager(mUserManager)
                 .setCarUserService(mUserService).setPowerPolicyDaemon(mRefactoredPowerPolicyDaemon)
                 .setPowerComponentHandler(mPowerComponentHandler).setFeatureFlags(mFeatureFlags)
@@ -2458,7 +2493,8 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         var vehicleHal = new VehicleHal(mContext, mockVehicleStub);
         var service = new CarPowerManagementService.Builder()
                 .setContext(mContext).setResources(mResources)
-                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal))
+                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal,
+                        mDisplayHelper))
                 .setSystemInterface(mSystemInterface).setUserManager(mUserManager)
                 .setCarUserService(mUserService).setPowerPolicyDaemon(mRefactoredPowerPolicyDaemon)
                 .setPowerComponentHandler(mPowerComponentHandler).setFeatureFlags(mFeatureFlags)
@@ -2491,7 +2527,8 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         var vehicleHal = new VehicleHal(mContext, mockVehicleStub);
         var service = new CarPowerManagementService.Builder()
                 .setContext(mContext).setResources(mResources)
-                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal))
+                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal,
+                        mDisplayHelper))
                 .setSystemInterface(mSystemInterface).setUserManager(mUserManager)
                 .setCarUserService(mUserService).setPowerPolicyDaemon(mRefactoredPowerPolicyDaemon)
                 .setPowerComponentHandler(mPowerComponentHandler).setFeatureFlags(mFeatureFlags)
@@ -2531,7 +2568,8 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         var vehicleHal = new VehicleHal(mContext, mockVehicleStub);
         var service = new CarPowerManagementService.Builder()
                 .setContext(mContext).setResources(mResources)
-                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal))
+                .setPowerHalService(new PowerHalService(mContext, mFeatureFlags, vehicleHal,
+                        mDisplayHelper))
                 .setSystemInterface(mSystemInterface).setUserManager(mUserManager)
                 .setCarUserService(mUserService).setPowerPolicyDaemon(mRefactoredPowerPolicyDaemon)
                 .setPowerComponentHandler(mPowerComponentHandler).setFeatureFlags(mFeatureFlags)
@@ -2592,6 +2630,10 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         mFeatureFlags.setFlag(Flags.FLAG_STOP_PROCESS_BEFORE_SUSPEND_TO_DISK, flagValue);
     }
 
+    private void setChangeSwapDuringSuspendToDiskToFalse() {
+        mFeatureFlags.setFlag(Flags.FLAG_CHANGE_SWAPS_DURING_SUSPEND_TO_DISK, false);
+    }
+
     /**
      * Helper method to create mService and initialize a test case
      */
@@ -3097,7 +3139,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
                 .checkCallingOrSelfPermission(Car.PERMISSION_CONTROL_SHUTDOWN_PROCESS);
     }
 
-    private static final class MockDisplayInterface implements DisplayInterface {
+    private static final class MockDisplayInterface extends DisplayInterfaceEmptyImpl {
         private static final int WAIT_FOR_DISPLAY_BRIGHTNESS_RETRIES = 5;
         @GuardedBy("sLock")
         private final SparseBooleanArray mDisplayOn = new SparseBooleanArray();
@@ -3115,12 +3157,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         }
 
         @Override
-        public void setDisplayBrightness(int brightness) {
-            setDisplayBrightness(Display.DEFAULT_DISPLAY, brightness);
-        }
-
-        @Override
-        public void setDisplayBrightness(int displayId, int percentBright) {
+        public void onDisplayBrightnessChangeFromVhal(int displayId, int percentBright) {
             synchronized (sLock) {
                 if (percentBright == mDisplayBrightnessSet.get(displayId)) {
                     return;
@@ -3225,7 +3262,7 @@ public final class CarPowerManagementServiceUnitTest extends AbstractExtendedMoc
         public void stopDisplayStateMonitoring() {}
 
         @Override
-        public void refreshDisplayBrightness() {}
+        public void refreshDefaultDisplayBrightness() {}
 
         @Override
         public void refreshDisplayBrightness(int displayId) {}
diff --git a/tests/carservice_unit_test/src/com/android/car/power/PowerComponentHandlerUnitTest.java b/tests/carservice_unit_test/src/com/android/car/power/PowerComponentHandlerUnitTest.java
index 120338f0cf..0e64ea757c 100644
--- a/tests/carservice_unit_test/src/com/android/car/power/PowerComponentHandlerUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/power/PowerComponentHandlerUnitTest.java
@@ -38,13 +38,15 @@ import static com.android.car.test.power.CarPowerPolicyUtil.assertPolicyIdentica
 
 import static com.google.common.truth.Truth.assertWithMessage;
 
+import static org.mockito.Mockito.when;
+
+import android.app.AppOpsManager;
 import android.car.hardware.power.CarPowerPolicy;
 import android.car.test.util.TemporaryFile;
 import android.content.Context;
+import android.content.pm.PackageManager;
 import android.util.AtomicFile;
 
-import androidx.test.platform.app.InstrumentationRegistry;
-
 import com.android.car.systeminterface.SystemInterface;
 
 import org.junit.Before;
@@ -58,16 +60,22 @@ import org.mockito.junit.MockitoJUnitRunner;
  */
 @RunWith(MockitoJUnitRunner.class)
 public final class PowerComponentHandlerUnitTest {
-    private final Context mContext = InstrumentationRegistry.getInstrumentation().getContext();
-
     @Mock
     private SystemInterface mSystemInterface;
+    @Mock
+    private Context mContext;
+    @Mock
+    private AppOpsManager mAppOpsManager;
+    @Mock
+    private PackageManager mPackageManager;
     private PowerComponentHandler mHandler;
     private TemporaryFile mComponentStateFile;
 
     @Before
     public void setUp() throws Exception {
         mComponentStateFile = new TemporaryFile("COMPONENT_STATE_FILE");
+        when(mContext.getSystemService(AppOpsManager.class)).thenReturn(mAppOpsManager);
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
         mHandler = new PowerComponentHandler(mContext, mSystemInterface,
                 new AtomicFile(mComponentStateFile.getFile()));
         mHandler.init(/* customComponents = */ null);
@@ -76,10 +84,10 @@ public final class PowerComponentHandlerUnitTest {
     @Test
     public void testGetAccumulatedPolicy_firstTime() throws Exception {
         CarPowerPolicy policy = mHandler.getAccumulatedPolicy();
-        CarPowerPolicy expected = new CarPowerPolicy("", new int[]{},
+        CarPowerPolicy expected = new CarPowerPolicy("", new int[]{VOICE_INTERACTION},
                 new int[]{AUDIO, BLUETOOTH, CELLULAR, CPU, DISPLAY, ETHERNET, INPUT, LOCATION,
                         MEDIA, MICROPHONE, NFC, PROJECTION, TRUSTED_DEVICE_DETECTION,
-                        VISUAL_INTERACTION, VOICE_INTERACTION, WIFI});
+                        VISUAL_INTERACTION, WIFI});
 
         assertPolicyIdentical(expected, policy);
     }
@@ -106,9 +114,9 @@ public final class PowerComponentHandlerUnitTest {
                 new CarPowerPolicy("test_policy3", new int[]{CPU, INPUT}, new int[]{WIFI}),
                 new CarPowerPolicy("test_policy4", new int[]{MEDIA, AUDIO}, new int[]{})};
         CarPowerPolicy expected = new CarPowerPolicy("test_policy4",
-                new int[]{AUDIO, MEDIA, DISPLAY, INPUT, CPU},
+                new int[]{AUDIO, MEDIA, DISPLAY, INPUT, CPU, VOICE_INTERACTION},
                 new int[]{BLUETOOTH, CELLULAR, ETHERNET, LOCATION, MICROPHONE, NFC, PROJECTION,
-                        TRUSTED_DEVICE_DETECTION, VISUAL_INTERACTION, VOICE_INTERACTION, WIFI});
+                        TRUSTED_DEVICE_DETECTION, VISUAL_INTERACTION, WIFI});
 
         for (CarPowerPolicy policy : policies) {
             mHandler.applyPowerPolicy(policy);
@@ -130,10 +138,10 @@ public final class PowerComponentHandlerUnitTest {
         mHandler.applyPowerPolicy(policy2);
 
         CarPowerPolicy expected = new CarPowerPolicy("test_policy2",
-                new int[]{DISPLAY, WIFI, customComponentId},
+                new int[]{DISPLAY, WIFI, VOICE_INTERACTION, customComponentId},
                 new int[]{INPUT, MEDIA, AUDIO, BLUETOOTH, CELLULAR, ETHERNET, LOCATION, MICROPHONE,
                         NFC, PROJECTION,
-                        TRUSTED_DEVICE_DETECTION, VISUAL_INTERACTION, VOICE_INTERACTION, CPU});
+                        TRUSTED_DEVICE_DETECTION, VISUAL_INTERACTION, CPU});
         assertPolicyIdentical(expected, mHandler.getAccumulatedPolicy());
 
         CarPowerPolicy policy3 = new CarPowerPolicy("test_policy3", new int[]{WIFI, AUDIO},
@@ -145,11 +153,10 @@ public final class PowerComponentHandlerUnitTest {
         mHandler.applyPowerPolicy(policy4);
 
         expected = new CarPowerPolicy("test_policy4",
-                new int[]{WIFI, AUDIO},
+                new int[]{WIFI, AUDIO, VOICE_INTERACTION},
                 new int[]{DISPLAY, INPUT, MEDIA, BLUETOOTH, CELLULAR, ETHERNET, LOCATION,
-                        MICROPHONE, NFC, PROJECTION,
-                        TRUSTED_DEVICE_DETECTION, VISUAL_INTERACTION, VOICE_INTERACTION, CPU,
-                        customComponentId});
+                        MICROPHONE, NFC, PROJECTION, TRUSTED_DEVICE_DETECTION, VISUAL_INTERACTION,
+                        CPU, customComponentId});
         assertPolicyIdentical(expected, mHandler.getAccumulatedPolicy());
     }
 
diff --git a/tests/carservice_unit_test/src/com/android/car/power/ScreenOffHandlerUnitTest.java b/tests/carservice_unit_test/src/com/android/car/power/ScreenOffHandlerUnitTest.java
index e802fe752a..9254e06734 100644
--- a/tests/carservice_unit_test/src/com/android/car/power/ScreenOffHandlerUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/power/ScreenOffHandlerUnitTest.java
@@ -22,6 +22,7 @@ import static com.google.common.truth.Truth.assertWithMessage;
 import static org.mockito.ArgumentMatchers.any;
 import static org.mockito.ArgumentMatchers.anyBoolean;
 import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.clearInvocations;
 import static org.mockito.Mockito.doAnswer;
 import static org.mockito.Mockito.mock;
 import static org.mockito.Mockito.never;
@@ -44,7 +45,7 @@ import android.hardware.display.DisplayManager;
 import android.os.UserHandle;
 import android.os.test.TestLooper;
 import android.provider.Settings;
-import android.util.ArrayMap;
+import android.util.Pair;
 import android.util.SparseIntArray;
 import android.view.Display;
 import android.view.DisplayAddress;
@@ -64,7 +65,6 @@ import org.mockito.Mock;
 
 import java.util.ArrayList;
 import java.util.List;
-import java.util.Map;
 
 public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestCase {
     private static final String TAG = ScreenOffHandlerUnitTest.class.getSimpleName();
@@ -105,7 +105,7 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
                 /* hasFrontPassenger= */ false, /* numRearPassengers= */ 2);
         CarLocalServices.removeServiceForTest(CarOccupantZoneService.class);
         CarLocalServices.addService(CarOccupantZoneService.class, mCarOccupantZoneService);
-        mClock = new OffsettableClock.Stopped();
+        mClock = new OffsettableClock();
         mTestLooper = new TestLooper(mClock::now);
         setService();
     }
@@ -116,144 +116,245 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
     }
 
     @Test
-    public void testParseSetting_valid_returnNonNull() throws Exception {
+    public void testParseSetting_valid_returnNonNull_1() throws Exception {
         bootComplete();
 
         String expectedModeString = "10:0,11:0,21:1";
         DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
-        builder.setDisplayMode(createMockDisplay(/* displayId= */ 10, /* displayPort= */10),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 11, /* displayPort= */11),
-                                /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 21, /* displayPort= */21),
-                                /* mode= */ 1);
+        var display1 = createMockDisplay(/* displayId= */ 10, /* displayPort= */10);
+        var display2 = createMockDisplay(/* displayId= */ 11, /* displayPort= */11);
+        var display3 = createMockDisplay(/* displayId= */ 21, /* displayPort= */21);
+        builder.setDisplayMode(display1, /* mode= */ 0)
+                .setDisplayMode(display2, /* mode= */ 0)
+                .setDisplayMode(display3, /* mode= */ 1);
+        new MockDisplays(mDisplayManager).addDisplay(display1).addDisplay(display2)
+                .addDisplay(display3).create();
 
         String actualModeString = builder.build();
         assertThat(actualModeString).isEqualTo(expectedModeString);
         SparseIntArray result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
         assertThat(result).isNotNull();
         assertThat(result.size()).isEqualTo(3);
+    }
+
+    @Test
+    public void testParseSetting_valid_returnNonNull_2() throws Exception {
+        bootComplete();
+
+        String expectedModeString = "0:0,1:0,2:1,3:2,4:1,5:0";
+        var builder = new DisplayPowerModeBuilder(mDisplayManager);
+        var display0 = createMockDisplay(/* displayId= */ 0, /* displayPort= */ 0);
+        var display1 = createMockDisplay(/* displayId= */ 1, /* displayPort= */ 1);
+        var display2 = createMockDisplay(/* displayId= */ 2, /* displayPort= */ 2);
+        var display3 = createMockDisplay(/* displayId= */ 3, /* displayPort= */ 3);
+        var display4 = createMockDisplay(/* displayId= */ 4, /* displayPort= */ 4);
+        var display5 = createMockDisplay(/* displayId= */ 5, /* displayPort= */ 5);
+        builder.setDisplayMode(display0, /* mode= */ 0)
+                .setDisplayMode(display1, /* mode= */ 0)
+                .setDisplayMode(display2, /* mode= */ 1)
+                .setDisplayMode(display3, /* mode= */ 2)
+                .setDisplayMode(display4, /* mode= */ 1)
+                .setDisplayMode(display5, /* mode= */ 0);
+        new MockDisplays(mDisplayManager).addDisplay(display0).addDisplay(display1)
+                .addDisplay(display2).addDisplay(display3).addDisplay(display4)
+                .addDisplay(display5).create();
 
-        expectedModeString = "0:0,1:0,2:1,3:2,4:1,5:0";
-        builder = new DisplayPowerModeBuilder(mDisplayManager);
-        builder.setDisplayMode(createMockDisplay(/* displayId= */ 0, /* displayPort= */ 0),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 1, /* displayPort= */ 1),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 2, /* displayPort= */ 2),
-                        /* mode= */ 1)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 3, /* displayPort= */ 3),
-                        /* mode= */ 2)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 4, /* displayPort= */ 4),
-                        /* mode= */ 1)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 5, /* displayPort= */ 5),
-                        /* mode= */ 0);
-
-        actualModeString = builder.build();
+        String actualModeString = builder.build();
         assertThat(actualModeString).isEqualTo(expectedModeString);
-        result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
+        SparseIntArray result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
         assertThat(result).isNotNull();
         assertThat(result.size()).isEqualTo(6);
+    }
 
-        expectedModeString = "0:0,1:0,2:1";
-        builder = new DisplayPowerModeBuilder(mDisplayManager);
-        builder.setDisplayMode(createMockDisplay(/* displayId= */ 99, /* displayPort= */ 0),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 2, /* displayPort= */ 1),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 5, /* displayPort= */ 2),
-                        /* mode= */ 1);
+    @Test
+    public void testParseSetting_valid_returnNonNull_3() throws Exception {
+        bootComplete();
 
-        actualModeString = builder.build();
+        String expectedModeString = "0:0,1:0,2:1";
+        var builder = new DisplayPowerModeBuilder(mDisplayManager);
+        var display1 = createMockDisplay(/* displayId= */ 99, /* displayPort= */ 0);
+        var display2 = createMockDisplay(/* displayId= */ 2, /* displayPort= */ 1);
+        var display3 = createMockDisplay(/* displayId= */ 5, /* displayPort= */ 2);
+        builder.setDisplayMode(display1, /* mode= */ 0)
+                .setDisplayMode(display2, /* mode= */ 0)
+                .setDisplayMode(display3, /* mode= */ 1);
+        new MockDisplays(mDisplayManager).addDisplay(display1).addDisplay(display2)
+                .addDisplay(display3).create();
+
+        String actualModeString = builder.build();
         assertThat(actualModeString).isEqualTo(expectedModeString);
-        result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
+        SparseIntArray result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
         assertThat(result).isNotNull();
         assertThat(result.size()).isEqualTo(3);
+    }
 
-        expectedModeString = "11:0,52:2";
-        builder = new DisplayPowerModeBuilder(mDisplayManager);
-        builder.setDisplayMode(createMockDisplay(/* displayId= */ 22, /* displayPort= */ 11),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 420, /* displayPort= */ 52),
-                        /* mode= */ 2);
+    @Test
+    public void testParseSetting_valid_returnNonNull_4() throws Exception {
+        bootComplete();
+
+        String expectedModeString = "11:0,52:2";
+        var builder = new DisplayPowerModeBuilder(mDisplayManager);
+        var display1 = createMockDisplay(/* displayId= */ 22, /* displayPort= */ 11);
+        var display2 = createMockDisplay(/* displayId= */ 420, /* displayPort= */ 52);
+        builder.setDisplayMode(display1, /* mode= */ 0)
+                .setDisplayMode(display2, /* mode= */ 2);
+        new MockDisplays(mDisplayManager).addDisplay(display1).addDisplay(display2).create();
 
-        actualModeString = builder.build();
+        String actualModeString = builder.build();
         assertThat(actualModeString).isEqualTo(expectedModeString);
-        result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
+        SparseIntArray result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
         assertThat(result).isNotNull();
         assertThat(result.size()).isEqualTo(2);
+    }
 
-        expectedModeString = "99:0";
-        builder = new DisplayPowerModeBuilder(mDisplayManager);
-        builder.setDisplayMode(createMockDisplay(/* displayId= */ 99, /* displayPort= */ 99),
-                /* mode= */ 0);
+    @Test
+    public void testParseSetting_valid_returnNonNull_5() throws Exception {
+        bootComplete();
 
-        actualModeString = builder.build();
+        String expectedModeString = "99:0";
+        var builder = new DisplayPowerModeBuilder(mDisplayManager);
+        var display = createMockDisplay(/* displayId= */ 99, /* displayPort= */ 99);
+        builder.setDisplayMode(display, /* mode= */ 0);
+        new MockDisplays(mDisplayManager).addDisplay(display).create();
+
+        String actualModeString = builder.build();
         assertThat(actualModeString).isEqualTo(expectedModeString);
-        result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
+        SparseIntArray result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
         assertThat(result).isNotNull();
         assertThat(result.size()).isEqualTo(1);
     }
 
     @Test
-    public void testParseSetting_invalid_returnNull() throws Exception {
+    public void testParseSetting_duplicate_returnNull() throws Exception {
         bootComplete();
 
         // Duplicate displayId
         String expectedModeString = "0:0,0:1,2:1";
         DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
-        builder.setDisplayMode(createMockDisplay(/* displayId= */ 0, /* displayPort= */0),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 0, /* displayPort= */0),
-                        /* mode= */ 1)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 2, /* displayPort= */2),
-                        /* mode= */ 1);
+        var display1 = createMockDisplay(/* displayId= */ 0, /* displayPort= */0);
+        var display2 = createMockDisplay(/* displayId= */ 2, /* displayPort= */2);
+        builder.setDisplayMode(display1, /* mode= */ 0)
+                .setDisplayMode(display1, /* mode= */ 1)
+                .setDisplayMode(display2, /* mode= */ 1);
+        new MockDisplays(mDisplayManager).addDisplay(display1).addDisplay(display2).create();
 
         String actualModeString = builder.build();
         assertThat(actualModeString).isEqualTo(expectedModeString);
         SparseIntArray result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
         assertThat(result).isNull();
+    }
+
+    @Test
+    public void testParseSetting_invalidMode_returnNull() throws Exception {
+        bootComplete();
 
         // Mode out of range
-        expectedModeString = "0:0,1:0,2:1,3:2,4:1,5:11";
-        builder = new DisplayPowerModeBuilder(mDisplayManager);
-        builder.setDisplayMode(createMockDisplay(/* displayId= */ 0, /* displayPort= */0),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 1, /* displayPort= */1),
-                        /* mode= */ 0)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 2, /* displayPort= */2),
-                        /* mode= */ 1)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 3, /* displayPort= */3),
-                        /* mode= */ 2)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 4, /* displayPort= */4),
-                        /* mode= */ 1)
-                .setDisplayMode(createMockDisplay(/* displayId= */ 5, /* displayPort= */5),
-                        /* mode= */ 11);
-
-        actualModeString = builder.build();
+        String expectedModeString = "0:0,1:0,2:1,3:2,4:1,5:11";
+        var builder = new DisplayPowerModeBuilder(mDisplayManager);
+        var display0 = createMockDisplay(/* displayId= */ 0, /* displayPort= */ 0);
+        var display1 = createMockDisplay(/* displayId= */ 1, /* displayPort= */ 1);
+        var display2 = createMockDisplay(/* displayId= */ 2, /* displayPort= */ 2);
+        var display3 = createMockDisplay(/* displayId= */ 3, /* displayPort= */ 3);
+        var display4 = createMockDisplay(/* displayId= */ 4, /* displayPort= */ 4);
+        var display5 = createMockDisplay(/* displayId= */ 5, /* displayPort= */ 5);
+        builder.setDisplayMode(display0, /* mode= */ 0)
+                .setDisplayMode(display1, /* mode= */ 0)
+                .setDisplayMode(display2, /* mode= */ 1)
+                .setDisplayMode(display3, /* mode= */ 2)
+                .setDisplayMode(display4, /* mode= */ 1)
+                .setDisplayMode(display5, /* mode= */ 11);
+        new MockDisplays(mDisplayManager).addDisplay(display0).addDisplay(display1)
+                .addDisplay(display2).addDisplay(display3).addDisplay(display4)
+                .addDisplay(display5).create();
+
+        String actualModeString = builder.build();
         assertThat(actualModeString).isEqualTo(expectedModeString);
-        result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
+        SparseIntArray result = mScreenOffHandler.parseModeAssignmentSettingValue(actualModeString);
         assertThat(result).isNull();
+    }
 
-        // "" - empty
-        builder = new DisplayPowerModeBuilder(mDisplayManager);
-        builder.setDisplayMode(createMockDisplay(/* displayId= */ 99, /* displayPort= */ 99),
-                /* mode= */ 0)
-                .build();
+    @Test
+    public void testParseString_empty_returnNull() throws Exception {
+        var result = mScreenOffHandler.parseModeAssignmentSettingValue("");
 
-        result = mScreenOffHandler.parseModeAssignmentSettingValue("");
         assertThat(result).isNull();
     }
 
     @Test
-    public void testUpdateUserActivity_noUserAssignedInModeOn_shouldTurnOffDisplay()
+    public void testSetDisplayStateAfterBoot_powerModeOn()
             throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
+                VehicleAreaSeat.SEAT_ROW_2_LEFT);
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
+
+        Display mockDisplay = createMockDisplay(displayId);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+        DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
+        builder.setDisplayMode(mockDisplay, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
+        Settings.Global.putString(mContentResolver, CarSettings.Global.DISPLAY_POWER_MODE,
+                builder.build());
+
         bootComplete();
+
+        mTestLooper.dispatchAll();
+        verify(mSystemInterface).setDisplayState(displayId, true);
+    }
+
+    @Test
+    public void testSetDisplayStateAfterBoot_powerModeAlwaysOn()
+            throws Exception {
         OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
                 CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
                 VehicleAreaSeat.SEAT_ROW_2_LEFT);
-        assertThat(zoneInfo).isNotNull();
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
 
+        Display mockDisplay = createMockDisplay(displayId);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+        DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
+        builder.setDisplayMode(mockDisplay, ScreenOffHandler.DISPLAY_POWER_MODE_ALWAYS_ON);
+        Settings.Global.putString(mContentResolver, CarSettings.Global.DISPLAY_POWER_MODE,
+                builder.build());
+
+        bootComplete();
+
+        mTestLooper.dispatchAll();
+        verify(mSystemInterface).setDisplayState(displayId, true);
+    }
+
+    @Test
+    public void testSetDisplayStateAfterBoot_powerModeOff()
+            throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
+                VehicleAreaSeat.SEAT_ROW_2_LEFT);
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
+
+        Display mockDisplay = createMockDisplay(displayId);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+        DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
+        builder.setDisplayMode(mockDisplay, ScreenOffHandler.DISPLAY_POWER_MODE_OFF);
+        Settings.Global.putString(mContentResolver, CarSettings.Global.DISPLAY_POWER_MODE,
+                builder.build());
+
+        bootComplete();
+
+        mTestLooper.dispatchAll();
+        verify(mSystemInterface).setDisplayState(displayId, false);
+    }
+
+    // Test that if a zone does not have user logged in, for ON mode, the display should be
+    // turned off after timeout.
+    @Test
+    public void testUpdateUserActivity_noUserAssignedInModeOn_shouldTurnOffDisplay()
+            throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
+                VehicleAreaSeat.SEAT_ROW_2_LEFT);
+        assertThat(zoneInfo).isNotNull();
         int displayId = mCarOccupantZoneService.getDisplayForOccupant(
                 zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
         assertThat(displayId).isNotEqualTo(Display.INVALID_DISPLAY);
@@ -261,16 +362,29 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
                 .that((mCarOccupantZoneService.getUserForOccupant(zoneInfo.zoneId)))
                 .isEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
 
+        Display mockDisplay = createMockDisplay(displayId);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+
+        bootComplete();
+
+        mTestLooper.dispatchAll();
+        verify(mSystemInterface).setDisplayState(displayId, true);
+        clearInvocations(mSystemInterface);
+
         updateDisplayPowerModeSetting(displayId, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
         mScreenOffHandler.updateUserActivity(displayId, mClock.now());
 
+        mTestLooper.dispatchAll();
+        verify(mSystemInterface).setDisplayState(displayId, true);
+        clearInvocations(mSystemInterface);
+
         advanceTime(SCREEN_OFF_TIMEOUT + 1);
         verify(mSystemInterface).setDisplayState(displayId, false);
     }
 
+    // Test that if a user is currently logged in, the display must not be turned off.
     @Test
     public void testUpdateUserActivity_userAssignedInModeOn_shouldKeepScreenOn() throws Exception {
-        bootComplete();
         OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
                 CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
                 VehicleAreaSeat.SEAT_ROW_2_LEFT);
@@ -285,6 +399,14 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
                 mCarOccupantZoneService.assignVisibleUserToOccupantZone(
                 zoneInfo.zoneId, UserHandle.of(userId))).isEqualTo(
                         CarOccupantZoneManager.USER_ASSIGNMENT_RESULT_OK);
+        Display mockDisplay = createMockDisplay(displayId);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+
+        bootComplete();
+
+        mTestLooper.dispatchAll();
+        verify(mSystemInterface).setDisplayState(displayId, true);
+        clearInvocations(mSystemInterface);
 
         ICarOccupantZoneCallback callback = getOccupantZoneCallback();
         callback.onOccupantZoneConfigChanged(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
@@ -292,26 +414,63 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
         updateDisplayPowerModeSetting(displayId, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
         mScreenOffHandler.updateUserActivity(displayId, mClock.now());
 
+        mTestLooper.dispatchAll();
+        verify(mSystemInterface).setDisplayState(displayId, true);
+        clearInvocations(mSystemInterface);
+
         advanceTime(SCREEN_OFF_TIMEOUT + 1);
         verify(mSystemInterface, never()).setDisplayState(displayId, false);
     }
 
+    // Test that for power mode on
     @Test
-    public void testUserActivity_bootIncomplete() throws Exception {
+    public void testUpdateUserActivity_canExtendTimeoutMultipleTimes()
+            throws Exception {
         OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
                 CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
                 VehicleAreaSeat.SEAT_ROW_2_LEFT);
         assertThat(zoneInfo).isNotNull();
 
-        assertWithMessage("User for occupant zone(%s)", zoneInfo.zoneId)
-                .that((mCarOccupantZoneService.getUserForOccupant(zoneInfo.zoneId)))
-                .isEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
-
+        int displayPort = 22;
         int displayId = mCarOccupantZoneService.getDisplayForOccupant(
                 zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
         assertThat(displayId).isNotEqualTo(Display.INVALID_DISPLAY);
+        var mockDisplay = createMockDisplay(displayId, displayPort);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
 
-        updateDisplayPowerModeSetting(displayId, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
+        DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
+        // Initial power mode is always on.
+        builder.setDisplayMode(mockDisplay, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
+        Settings.Global.putString(mContentResolver, CarSettings.Global.DISPLAY_POWER_MODE,
+                builder.build());
+
+        bootComplete();
+
+        for (int i = 0; i < 10; i++) {
+            // Advance half screen-off time.
+            advanceTime(SCREEN_OFF_TIMEOUT / 2);
+
+            // Update user activity.
+            mScreenOffHandler.updateUserActivity(displayId, mClock.now());
+        }
+
+        verify(mSystemInterface, never()).setDisplayState(displayId, false);
+
+        // SCREEN_OFF_TIMEOUT after no user activity, the display should be turned off.
+        advanceTime(SCREEN_OFF_TIMEOUT);
+        verify(mSystemInterface).setDisplayState(displayId, false);
+    }
+
+
+    @Test
+    public void testUserActivity_bootIncomplete() throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
+                VehicleAreaSeat.SEAT_ROW_2_LEFT);
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
+
+        // Before boot complete, this must cause nothing.
         mScreenOffHandler.updateUserActivity(displayId, mClock.now());
 
         advanceTime(SCREEN_OFF_TIMEOUT + 1);
@@ -320,7 +479,6 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
 
     @Test
     public void testCanTurnOnDisplay() throws Exception {
-        bootComplete();
         OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
                 CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
                 VehicleAreaSeat.SEAT_ROW_2_LEFT);
@@ -330,6 +488,10 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
         int displayId = mCarOccupantZoneService.getDisplayForOccupant(
                 zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
         assertThat(displayId).isNotEqualTo(Display.INVALID_DISPLAY);
+        new MockDisplays(mDisplayManager).addDisplay(createMockDisplay(displayId, displayPort))
+                .create();
+
+        bootComplete();
 
         updateDisplayPowerModeSetting(displayId, displayPort,
                 ScreenOffHandler.DISPLAY_POWER_MODE_OFF);
@@ -342,9 +504,51 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
                 .that(mScreenOffHandler.canTurnOnDisplay(displayId)).isTrue();
     }
 
+    // Test that for power mode settings change from always on to on must start a new
+    // timeout timer and must not turn off display before the new timeout.
     @Test
-    public void testHandleDisplayStateChange_modeOn() throws Exception {
+    public void testDisplayPowerModeSettingsChange_alwaysOnToOn_mustNotTurnOffDisplay()
+            throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
+                VehicleAreaSeat.SEAT_ROW_2_LEFT);
+        assertThat(zoneInfo).isNotNull();
+
+        int displayPort = 22;
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
+        assertThat(displayId).isNotEqualTo(Display.INVALID_DISPLAY);
+        var mockDisplay = createMockDisplay(displayId, displayPort);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+
+        DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
+        // Initial power mode is always on.
+        builder.setDisplayMode(mockDisplay, ScreenOffHandler.DISPLAY_POWER_MODE_ALWAYS_ON);
+        Settings.Global.putString(mContentResolver, CarSettings.Global.DISPLAY_POWER_MODE,
+                builder.build());
+
         bootComplete();
+
+        // Advance half screen-off time.
+        advanceTime(SCREEN_OFF_TIMEOUT / 2);
+        clearInvocations(mSystemInterface);
+
+        // Power mode is changed to on.
+        updateDisplayPowerModeSetting(displayId, displayPort,
+                ScreenOffHandler.DISPLAY_POWER_MODE_ON);
+
+        // Then advance half screen-off time.
+        advanceTime(SCREEN_OFF_TIMEOUT / 2 + 1);
+        verify(mSystemInterface, never()).setDisplayState(displayId, false);
+
+        // SCREEN_OFF_TIMEOUT after we change the power state to on, the display should be turned
+        // off.
+        advanceTime(SCREEN_OFF_TIMEOUT / 2 + 1);
+        verify(mSystemInterface).setDisplayState(displayId, false);
+    }
+
+    @Test
+    public void testHandleDisplayStateChange_modeOn() throws Exception {
         OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
                 CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
                 VehicleAreaSeat.SEAT_ROW_2_LEFT);
@@ -356,6 +560,9 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
         assertWithMessage("User for occupant zone(%s)", zoneInfo.zoneId)
                 .that((mCarOccupantZoneService.getUserForOccupant(zoneInfo.zoneId)))
                 .isEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
+        new MockDisplays(mDisplayManager).addDisplay(createMockDisplay(displayId)).create();
+
+        bootComplete();
 
         updateDisplayPowerModeSetting(displayId, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
         mScreenOffHandler.handleDisplayStateChange(displayId, /* on= */ true);
@@ -366,7 +573,6 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
 
     @Test
     public void testHandleDisplayStateChange_modeAlwaysOn() throws Exception {
-        bootComplete();
         OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
                 CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
                 VehicleAreaSeat.SEAT_ROW_2_LEFT);
@@ -378,6 +584,9 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
         assertWithMessage("User for occupant zone(%s)", zoneInfo.zoneId)
                 .that((mCarOccupantZoneService.getUserForOccupant(zoneInfo.zoneId)))
                 .isEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
+        new MockDisplays(mDisplayManager).addDisplay(createMockDisplay(displayId)).create();
+
+        bootComplete();
 
         updateDisplayPowerModeSetting(displayId, ScreenOffHandler.DISPLAY_POWER_MODE_ALWAYS_ON);
         mScreenOffHandler.handleDisplayStateChange(displayId, /* on= */ true);
@@ -387,8 +596,32 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
     }
 
     @Test
-    public void testHandleDisplayStateChange_modeOff() throws Exception {
+    public void testHandleDisplayStateChange_driver_modeOn() throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER,
+                VehicleAreaSeat.SEAT_ROW_1_LEFT);
+        assertThat(zoneInfo).isNotNull();
+
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneInfo.zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
+        assertThat(displayId).isNotEqualTo(Display.INVALID_DISPLAY);
+        assertWithMessage("User for occupant zone(%s)", zoneInfo.zoneId)
+                .that((mCarOccupantZoneService.getUserForOccupant(zoneInfo.zoneId)))
+                .isNotEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
+        new MockDisplays(mDisplayManager).addDisplay(createMockDisplay(displayId)).create();
+
         bootComplete();
+
+        updateDisplayPowerModeSetting(displayId, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
+        mScreenOffHandler.handleDisplayStateChange(displayId, /* on= */ true);
+
+        advanceTime(SCREEN_OFF_TIMEOUT + 1);
+        // Driver display must never be turned off even though power mode is on.
+        verify(mSystemInterface, never()).setDisplayState(displayId, false);
+    }
+
+    @Test
+    public void testHandleDisplayStateChange_modeOff() throws Exception {
         // TODO(b/279041525): Replace OccupantZoneHelper with mocking logics.
         OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
                 CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
@@ -401,14 +634,136 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
         assertWithMessage("User for occupant zone(%s)", zoneInfo.zoneId)
                 .that((mCarOccupantZoneService.getUserForOccupant(zoneInfo.zoneId)))
                 .isEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
+        new MockDisplays(mDisplayManager).addDisplay(createMockDisplay(displayId)).create();
+
+        bootComplete();
 
         updateDisplayPowerModeSetting(displayId, ScreenOffHandler.DISPLAY_POWER_MODE_OFF);
         mScreenOffHandler.handleDisplayStateChange(displayId, /* on= */ true);
 
+        mTestLooper.dispatchAll();
+        verify(mSystemInterface).setDisplayState(displayId, false);
+    }
+
+    // Test that for power mode always on, user logging out will off display after timeout.
+    @Test
+    public void testOnOccupantZoneConfigChange_powerModeOn_userLogOut() throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
+                VehicleAreaSeat.SEAT_ROW_2_LEFT);
+        int zoneId = zoneInfo.zoneId;
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
+        var mockDisplay = createMockDisplay(displayId);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+        int userId = 99;
+        assertWithMessage("User assignment").that(
+                mCarOccupantZoneService.assignVisibleUserToOccupantZone(
+                zoneId, UserHandle.of(userId))).isEqualTo(
+                        CarOccupantZoneManager.USER_ASSIGNMENT_RESULT_OK);
+        DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
+        builder.setDisplayMode(mockDisplay, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
+        Settings.Global.putString(mContentResolver, CarSettings.Global.DISPLAY_POWER_MODE,
+                builder.build());
+
+        bootComplete();
+        mTestLooper.dispatchAll();
+        clearInvocations(mSystemInterface);
+
+        // Simulate user logging out. The display power mode is set to ON.
+        mCarOccupantZoneService.unassignOccupantZone(zoneId);
+        assertThat(mCarOccupantZoneService.getUserForOccupant(zoneId))
+                .isEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
+        ICarOccupantZoneCallback callback = getOccupantZoneCallback();
+        callback.onOccupantZoneConfigChanged(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
+
+        // After SCREEN_OFF_TIMEOUT, the display should be turned off.
         advanceTime(SCREEN_OFF_TIMEOUT + 1);
         verify(mSystemInterface).setDisplayState(displayId, false);
     }
 
+    // Test that for power mode always on, user logging out will not turn off display.
+    @Test
+    public void testOnOccupantZoneConfigChange_powerModeAlwaysOn_userLogOut() throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
+                VehicleAreaSeat.SEAT_ROW_2_LEFT);
+        int zoneId = zoneInfo.zoneId;
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
+        var mockDisplay = createMockDisplay(displayId);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+        int userId = 99;
+        assertWithMessage("User assignment").that(
+                mCarOccupantZoneService.assignVisibleUserToOccupantZone(
+                zoneId, UserHandle.of(userId))).isEqualTo(
+                        CarOccupantZoneManager.USER_ASSIGNMENT_RESULT_OK);
+        DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
+        builder.setDisplayMode(mockDisplay, ScreenOffHandler.DISPLAY_POWER_MODE_ALWAYS_ON);
+        Settings.Global.putString(mContentResolver, CarSettings.Global.DISPLAY_POWER_MODE,
+                builder.build());
+
+        bootComplete();
+        mTestLooper.dispatchAll();
+        clearInvocations(mSystemInterface);
+
+        // Simulate user logging out. The display power mode is set to ALWAYS_ON.
+        mCarOccupantZoneService.unassignOccupantZone(zoneId);
+        assertThat(mCarOccupantZoneService.getUserForOccupant(zoneId))
+                .isEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
+        ICarOccupantZoneCallback callback = getOccupantZoneCallback();
+        callback.onOccupantZoneConfigChanged(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
+
+        // After SCREEN_OFF_TIMEOUT, the display should still be on.
+        advanceTime(SCREEN_OFF_TIMEOUT + 1);
+        verify(mSystemInterface, never()).setDisplayState(displayId, false);
+    }
+
+    @Test
+    public void testOnOccupantZoneConfigChange_powerModeOn_userLogOut_thenLogIn()
+            throws Exception {
+        OccupantZoneInfo zoneInfo = mCarOccupantZoneService.getOccupantZone(
+                CarOccupantZoneManager.OCCUPANT_TYPE_REAR_PASSENGER,
+                VehicleAreaSeat.SEAT_ROW_2_LEFT);
+        int zoneId = zoneInfo.zoneId;
+        int displayId = mCarOccupantZoneService.getDisplayForOccupant(
+                zoneId, CarOccupantZoneManager.DISPLAY_TYPE_MAIN);
+        var mockDisplay = createMockDisplay(displayId);
+        new MockDisplays(mDisplayManager).addDisplay(mockDisplay).create();
+        int userId = 99;
+        assertWithMessage("User assignment").that(
+                mCarOccupantZoneService.assignVisibleUserToOccupantZone(
+                zoneId, UserHandle.of(userId))).isEqualTo(
+                        CarOccupantZoneManager.USER_ASSIGNMENT_RESULT_OK);
+        DisplayPowerModeBuilder builder = new DisplayPowerModeBuilder(mDisplayManager);
+        builder.setDisplayMode(mockDisplay, ScreenOffHandler.DISPLAY_POWER_MODE_ON);
+        Settings.Global.putString(mContentResolver, CarSettings.Global.DISPLAY_POWER_MODE,
+                builder.build());
+
+        bootComplete();
+        mTestLooper.dispatchAll();
+        clearInvocations(mSystemInterface);
+
+        // Simulate user logging out. The display power mode is set to ON.
+        mCarOccupantZoneService.unassignOccupantZone(zoneId);
+        assertThat(mCarOccupantZoneService.getUserForOccupant(zoneId))
+                .isEqualTo(CarOccupantZoneManager.INVALID_USER_ID);
+        ICarOccupantZoneCallback callback = getOccupantZoneCallback();
+        callback.onOccupantZoneConfigChanged(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
+
+        // After half SCREEN_OFF_TIMEOUT, a new user log in.
+        advanceTime(SCREEN_OFF_TIMEOUT / 2);
+        assertWithMessage("User assignment").that(
+                mCarOccupantZoneService.assignVisibleUserToOccupantZone(
+                zoneId, UserHandle.of(userId))).isEqualTo(
+                        CarOccupantZoneManager.USER_ASSIGNMENT_RESULT_OK);
+        callback.onOccupantZoneConfigChanged(CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
+
+        advanceTime(SCREEN_OFF_TIMEOUT);
+
+        verify(mSystemInterface, never()).setDisplayState(displayId, false);
+    }
+
     private void setService() {
         when(mResources.getBoolean(R.bool.config_enablePassengerDisplayPowerSaving))
                 .thenReturn(true);
@@ -492,35 +847,30 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
     }
 
     private static final class DisplayPowerModeBuilder {
-        private final Map<Display, Integer> mDisplayPowerModeMap;
-        private final List<Display> mDisplays;
+        private final ArrayList<Pair<Display, Integer>> mDisplayPowerModeMap;
         private final DisplayManager mDisplayManager;
 
         private DisplayPowerModeBuilder(DisplayManager displayManager) {
-            mDisplayPowerModeMap = new ArrayMap<>();
-            mDisplays = new ArrayList<>();
+            mDisplayPowerModeMap = new ArrayList<>();
             mDisplayManager = displayManager;
         }
 
         private DisplayPowerModeBuilder setDisplayMode(Display display, int mode) {
-            mDisplays.add(display);
-            mDisplayPowerModeMap.put(display, mode);
+            mDisplayPowerModeMap.add(new Pair<>(display, mode));
             return this;
         }
 
         private String build() {
             StringBuilder sb = new StringBuilder();
-            for (int i = 0; i < mDisplays.size(); i++) {
+            for (int i = 0; i < mDisplayPowerModeMap.size(); i++) {
                 if (sb.length() != 0) {
                     sb.append(",");
                 }
-                Display display = mDisplays.get(i);
+                Display display = mDisplayPowerModeMap.get(i).first;
                 int displayPort = getDisplayPort(display);
-                int mode = mDisplayPowerModeMap.get(display);
+                int mode = mDisplayPowerModeMap.get(i).second;
                 sb.append(displayPort).append(":").append(mode);
             }
-            when(mDisplayManager.getDisplays())
-                    .thenReturn(mDisplays.toArray(new Display[mDisplays.size()]));
             return sb.toString();
         }
 
@@ -529,4 +879,28 @@ public final class ScreenOffHandlerUnitTest extends AbstractExtendedMockitoTestC
             return address.getPort();
         }
     }
+
+    private static final class MockDisplays {
+        private final List<Display> mDisplays;
+        private final DisplayManager mDisplayManager;
+
+        private MockDisplays(DisplayManager displayManager) {
+            mDisplays = new ArrayList<>();
+            mDisplayManager = displayManager;
+        }
+
+        private MockDisplays addDisplay(Display display) {
+            mDisplays.add(display);
+            return this;
+        }
+
+        private void create() {
+            for (int i = 0; i < mDisplays.size(); i++) {
+                var display = mDisplays.get(i);
+                when(mDisplayManager.getDisplay(display.getDisplayId())).thenReturn(display);
+            }
+            when(mDisplayManager.getDisplays())
+                    .thenReturn(mDisplays.toArray(new Display[mDisplays.size()]));
+        }
+    }
 }
diff --git a/tests/carservice_unit_test/src/com/android/car/systeminterface/DisplayInterfaceTest.java b/tests/carservice_unit_test/src/com/android/car/systeminterface/DisplayInterfaceTest.java
index a8f54baff3..86b91f1341 100644
--- a/tests/carservice_unit_test/src/com/android/car/systeminterface/DisplayInterfaceTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/systeminterface/DisplayInterfaceTest.java
@@ -16,37 +16,81 @@
 
 package com.android.car.systeminterface;
 
-import static com.android.dx.mockito.inline.extended.ExtendedMockito.doReturn;
+import static android.car.feature.Flags.FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL;
+import static android.car.user.CarUserManager.USER_LIFECYCLE_EVENT_TYPE_SWITCHING;
+import static android.car.user.CarUserManager.USER_LIFECYCLE_EVENT_TYPE_UNLOCKED;
 
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.AdditionalMatchers.or;
 import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyFloat;
 import static org.mockito.ArgumentMatchers.anyInt;
 import static org.mockito.ArgumentMatchers.anyLong;
+import static org.mockito.ArgumentMatchers.anyString;
 import static org.mockito.ArgumentMatchers.eq;
 import static org.mockito.ArgumentMatchers.isNull;
+import static org.mockito.Mockito.clearInvocations;
+import static org.mockito.Mockito.doAnswer;
 import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.times;
 import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.when;
 
-import android.car.builtin.os.UserManagerHelper;
-import android.car.test.mocks.AbstractExtendedMockitoTestCase;
+import android.car.builtin.view.DisplayHelper;
+import android.car.user.CarUserManager.UserLifecycleEvent;
+import android.car.user.CarUserManager.UserLifecycleListener;
 import android.content.ContentResolver;
 import android.content.Context;
+import android.database.ContentObserver;
 import android.hardware.display.DisplayManager;
+import android.hardware.display.DisplayManager.DisplayListener;
+import android.net.Uri;
 import android.os.PowerManager;
 import android.os.UserManager;
+import android.platform.test.annotations.DisableFlags;
+import android.platform.test.annotations.EnableFlags;
+import android.platform.test.flag.junit.SetFlagsRule;
+import android.platform.test.ravenwood.RavenwoodRule;
 import android.view.Display;
 
 import com.android.car.power.CarPowerManagementService;
+import com.android.car.provider.Settings;
 import com.android.car.user.CarUserService;
+import com.android.car.user.CurrentUserFetcher;
 
 import org.junit.Before;
+import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
 import org.mockito.Mock;
 import org.mockito.junit.MockitoJUnitRunner;
 
-@RunWith(MockitoJUnitRunner.class)
-public final class DisplayInterfaceTest extends AbstractExtendedMockitoTestCase {
+import java.util.ArrayList;
+
+@RunWith(MockitoJUnitRunner.Silent.class)
+public final class DisplayInterfaceTest {
+
+    private static final int MAIN_DISPLAY_ID = Display.DEFAULT_DISPLAY;
+    private static final int DISTANT_DISPLAY_ID = 2;
+    private static final int VIRTUAL_DISPLAY_ID = 3;
+    private static final int OVERLAY_DISPLAY_ID = 4;
+
+    private static final int GLOBAL_BRIGHTNESS = 125;
+    private static final int GLOBAL_BRIGHTNESS_2 = 130;
+    private static final float DISPLAY_MANAGER_BRIGHTNESS_1 = 0.5f;
+    private static final float DISPLAY_MANAGER_BRIGHTNESS_2 = 0.6f;
+
+    private static final int MIN_SCREEN_BRIGHTNESS_SETTING = 1;
+    private static final int MAX_SCREEN_BRIGHTNESS_SETTING = 255;
+
+    @Rule
+    public final RavenwoodRule mRavenwood = new RavenwoodRule.Builder()
+            .setProvideMainThread(true)
+            .setSystemPropertyImmutable("android.car.user_hal_timeout", 0).build();
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
 
     @Mock
     private Context mContext;
@@ -72,88 +116,409 @@ public final class DisplayInterfaceTest extends AbstractExtendedMockitoTestCase
     @Mock
     private UserManager mUserManager;
 
+    @Mock
+    private DisplayHelperInterface mDisplayHelper;
+
+    @Mock
+    private Settings mSettings;
+
     @Mock
     private Display mDisplay;
 
+    @Mock
+    private CurrentUserFetcher mCurrentUserFetcher;
+
+    @Mock
+    private Display mDistantDisplay;
+    @Mock
+    private Display mVirtualDisplay;
+    @Mock
+    private Display mOverlayDisplay;
+
     private DisplayInterface.DefaultImpl mDisplayInterface;
 
-    @Override
-    protected void onSessionBuilder(CustomMockitoSessionBuilder session) {
-        session.spyStatic(UserManagerHelper.class);
+    private void addDisplay(Display display, int displayId, int displayType) {
+        when(display.getDisplayId()).thenReturn(displayId);
+        when(mDisplayManager.getDisplay(displayId)).thenReturn(display);
+        when(mDisplayHelper.getType(display)).thenReturn(displayType);
+        when(mCurrentUserFetcher.getCurrentUser()).thenReturn(0);
     }
 
     @Before
-    public void setUp() {
+    public void setUp() throws Exception {
+        when(mSettings.getIntSystem(eq(mContentResolver), anyString())).thenReturn(
+                GLOBAL_BRIGHTNESS);
+        when(mSettings.getUriForSystem(anyString())).thenReturn(Uri.parse(""));
         when(mContext.createContextAsUser(any(), anyInt())).thenReturn(mContext);
         when(mContext.getContentResolver()).thenReturn(mContentResolver);
         when(mContext.getSystemService(DisplayManager.class)).thenReturn(mDisplayManager);
         when(mContext.getSystemService(PowerManager.class)).thenReturn(mPowerManager);
         when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
-        when(mDisplayManager.getDisplay(Display.DEFAULT_DISPLAY)).thenReturn(mDisplay);
-        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay});
+        when(mPowerManager.getMinimumScreenBrightnessSetting()).thenReturn(
+                MIN_SCREEN_BRIGHTNESS_SETTING);
+        when(mPowerManager.getMaximumScreenBrightnessSetting()).thenReturn(
+                MAX_SCREEN_BRIGHTNESS_SETTING);
+
+        addDisplay(mDisplay, MAIN_DISPLAY_ID, DisplayHelper.TYPE_INTERNAL);
+        addDisplay(mDistantDisplay, DISTANT_DISPLAY_ID, DisplayHelper.TYPE_INTERNAL);
+        addDisplay(mVirtualDisplay, VIRTUAL_DISPLAY_ID, DisplayHelper.TYPE_VIRTUAL);
+        addDisplay(mOverlayDisplay, OVERLAY_DISPLAY_ID, DisplayHelper.TYPE_OVERLAY);
     }
 
     @Test
-    public void testStartDisplayStateMonitoring_perDisplayBrightnessSupported() {
-        when(mDisplayManager.getDisplay(anyInt())).thenReturn(mDisplay);
+    @DisableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testStartDisplayStateMonitoring_visibleBgUsersSupported() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{
+                mDisplay, mDistantDisplay, mVirtualDisplay, mOverlayDisplay});
         when(mDisplay.getState()).thenReturn(Display.STATE_ON);
-        createDisplayInterface(/* perDisplayBrightnessSupported= */ true);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_ON);
+        when(mDisplayManager.getBrightness(MAIN_DISPLAY_ID)).thenReturn(
+                DISPLAY_MANAGER_BRIGHTNESS_1);
+        when(mDisplayManager.getBrightness(DISTANT_DISPLAY_ID)).thenReturn(
+                DISPLAY_MANAGER_BRIGHTNESS_2);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ true);
 
         mDisplayInterface.startDisplayStateMonitoring();
 
-        verify(mContentResolver, never()).registerContentObserver(any(), eq(false), any());
         verify(mDisplayManager).registerDisplayListener(any(), isNull(), anyLong());
         verify(mCarUserService).addUserLifecycleListener(any(), any());
+        var intCaptor = ArgumentCaptor.forClass(Integer.class);
+        verify(mCarPowerManagementService, times(2)).sendDisplayBrightness(
+                or(eq(MAIN_DISPLAY_ID), eq(DISTANT_DISPLAY_ID)), intCaptor.capture());
+        int brightness1 = intCaptor.getAllValues().get(0);
+        int brightness2 = intCaptor.getAllValues().get(1);
+        assertThat(brightness1).isNotEqualTo(0);
+        assertThat(brightness2).isNotEqualTo(0);
+        assertThat(brightness1).isNotEqualTo(brightness2);
     }
 
     @Test
-    public void testStartDisplayStateMonitoring_perDisplayBrightnessNotSupported() {
-        when(mDisplayManager.getDisplay(anyInt())).thenReturn(mDisplay);
+    @DisableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testStartDisplayStateMonitoring_visibleBgUsersNotSupported() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
         when(mDisplay.getState()).thenReturn(Display.STATE_ON);
-        createDisplayInterface(/* perDisplayBrightnessSupported= */ false);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_ON);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
 
         mDisplayInterface.startDisplayStateMonitoring();
 
         verify(mContentResolver).registerContentObserver(any(), eq(false), any());
-        verify(mDisplayManager, never()).registerDisplayListener(any(), isNull(), anyLong());
         verify(mCarUserService).addUserLifecycleListener(any(), any());
+        verify(mCarPowerManagementService, times(2)).sendDisplayBrightnessLegacy(anyInt());
     }
 
     @Test
-    public void testStopDisplayStateMonitoring_perDisplayBrightnessSupported() {
-        createDisplayInterface(/* perDisplayBrightnessSupported= */ true);
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testStartDisplayStateMonitoring_multiDisplayControlSupported() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
+        when(mDisplay.getState()).thenReturn(Display.STATE_ON);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_ON);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+
+        mDisplayInterface.startDisplayStateMonitoring();
+
+        verify(mDisplayManager).registerDisplayListener(any(), isNull(), anyLong());
+        verify(mCarUserService).addUserLifecycleListener(any(), any());
+        // If multi display brightness is supported, even if MUMD is not enabled, we must refresh
+        // all display's brightness.
+        verify(mCarPowerManagementService, times(2)).sendDisplayBrightness(
+                or(eq(MAIN_DISPLAY_ID), eq(DISTANT_DISPLAY_ID)), anyInt());
+    }
+
+    @Test
+    @DisableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testStopDisplayStateMonitoring_visibleBgUsersSupported() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay});
+        when(mDisplayManager.getBrightness(anyInt())).thenReturn(DISPLAY_MANAGER_BRIGHTNESS_1);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ true);
         mDisplayInterface.startDisplayStateMonitoring();
         mDisplayInterface.stopDisplayStateMonitoring();
 
         verify(mDisplayManager).unregisterDisplayListener(any());
-        verify(mContentResolver, never()).unregisterContentObserver(any());
         verify(mCarUserService).removeUserLifecycleListener(any());
     }
 
     @Test
-    public void testStopDisplayStateMonitoring_perDisplayBrightnessNoSupported() {
-        createDisplayInterface(/* perDisplayBrightnessSupported= */ false);
+    @DisableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testStopDisplayStateMonitoring_visibleBgUsersNoSupported() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay});
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
         mDisplayInterface.startDisplayStateMonitoring();
         mDisplayInterface.stopDisplayStateMonitoring();
 
-        verify(mDisplayManager, never()).unregisterDisplayListener(any());
         verify(mContentResolver).unregisterContentObserver(any());
         verify(mCarUserService).removeUserLifecycleListener(any());
     }
 
-    private void createDisplayInterface(boolean perDisplayBrightnessSupported) {
-        doReturn(perDisplayBrightnessSupported)
-                .when(() -> UserManagerHelper.isVisibleBackgroundUsersSupported(any()));
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testOnUserSwitchEvent_notUserSwitchingEvent() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay});
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+        mDisplayInterface.startDisplayStateMonitoring();
+        var userLifecycleListenerCaptor = ArgumentCaptor.forClass(UserLifecycleListener.class);
+
+        verify(mCarUserService).addUserLifecycleListener(any(),
+                userLifecycleListenerCaptor.capture());
+        clearInvocations(mCarPowerManagementService);
+
+        userLifecycleListenerCaptor.getValue().onEvent(
+                new UserLifecycleEvent(USER_LIFECYCLE_EVENT_TYPE_UNLOCKED, /* to= */ 0));
+
+        verify(mCarPowerManagementService, never()).sendDisplayBrightness(anyInt(), anyInt());
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testOnUserSwitchEvent_newUserNotDriver() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay});
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+        mDisplayInterface.startDisplayStateMonitoring();
+        var userLifecycleListenerCaptor = ArgumentCaptor.forClass(UserLifecycleListener.class);
+
+        verify(mCarUserService).addUserLifecycleListener(any(),
+                userLifecycleListenerCaptor.capture());
+        clearInvocations(mCarPowerManagementService);
+
+        userLifecycleListenerCaptor.getValue().onEvent(
+                new UserLifecycleEvent(USER_LIFECYCLE_EVENT_TYPE_SWITCHING, /* to= */ 1));
+
+        verify(mCarPowerManagementService, never()).sendDisplayBrightness(anyInt(), anyInt());
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testOnUserSwitchEvent() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+        mDisplayInterface.startDisplayStateMonitoring();
+
+        var userLifecycleListenerCaptor = ArgumentCaptor.forClass(UserLifecycleListener.class);
+        verify(mCarUserService).addUserLifecycleListener(any(),
+                userLifecycleListenerCaptor.capture());
+        clearInvocations(mCarPowerManagementService);
+
+        userLifecycleListenerCaptor.getValue().onEvent(
+                new UserLifecycleEvent(USER_LIFECYCLE_EVENT_TYPE_SWITCHING, /* to= */ 0));
+
+        verify(mCarPowerManagementService, times(2)).sendDisplayBrightness(
+                or(eq(MAIN_DISPLAY_ID), eq(DISTANT_DISPLAY_ID)), anyInt());
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testOnDisplayBrightnessChangeFromVhal_ForMainDisplay() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+        mDisplayInterface.onDisplayBrightnessChangeFromVhal(MAIN_DISPLAY_ID,
+                /* percentBright= */ 50);
+
+        verify(mDisplayManager).setBrightness(eq(MAIN_DISPLAY_ID), anyFloat());
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testOnDisplayBrightnessChangeFromVhal_ForDistantDisplay() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+        mDisplayInterface.onDisplayBrightnessChangeFromVhal(DISTANT_DISPLAY_ID,
+                /* percentBright= */ 50);
+
+        verify(mDisplayManager).setBrightness(eq(DISTANT_DISPLAY_ID), anyFloat());
+    }
+
+    @Test
+    @DisableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testDisplayBrightnessChangeFromSettings() throws Exception {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
+        when(mDisplay.getState()).thenReturn(Display.STATE_ON);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_ON);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+
+        mDisplayInterface.startDisplayStateMonitoring();
+
+        var observerCaptor = ArgumentCaptor.forClass(ContentObserver.class);
+        verify(mContentResolver).registerContentObserver(any(), eq(false),
+                observerCaptor.capture());
+        clearInvocations(mCarPowerManagementService);
+
+        // Simulate user changes the global brightness setting to GLOBAL_BRIGHTNESS_2.
+        when(mSettings.getIntSystem(eq(mContentResolver), anyString())).thenReturn(
+                GLOBAL_BRIGHTNESS_2);
+
+        observerCaptor.getValue().onChange(true);
+
+        verify(mCarPowerManagementService).sendDisplayBrightnessLegacy(anyInt());
+    }
+
+    @Test
+    @DisableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testDisplayBrightnessChangeFromSettings_ignoreRecentChange() throws Exception {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
+        when(mDisplay.getState()).thenReturn(Display.STATE_ON);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_ON);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+
+        mDisplayInterface.startDisplayStateMonitoring();
+
+        var observerCaptor = ArgumentCaptor.forClass(ContentObserver.class);
+        verify(mContentResolver).registerContentObserver(any(), eq(false),
+                observerCaptor.capture());
+        clearInvocations(mCarPowerManagementService);
+
+        // This variable stores the global brightness settings. Need to use a list to be
+        // effective final.
+        ArrayList<Integer> brightness = new ArrayList<>();
+
+        doAnswer((inv) -> {
+            brightness.add(inv.getArgument(2));
+            return null;
+        }).when(mSettings).putIntSystem(eq(mContentResolver), anyString(), anyInt());
+        when(mSettings.getIntSystem(eq(mContentResolver), anyString())).thenAnswer((inv) -> {
+            return brightness.get(0);
+        });
+
+        // Simulate a brightness change from VHAL.
+        mDisplayInterface.onDisplayBrightnessChangeFromVhal(MAIN_DISPLAY_ID,
+                /* percentBright= */ 50);
+        // This should trigger an onChange event.
+        observerCaptor.getValue().onChange(true);
+
+        // Because the brightness event is caused by VHAL, so we must ignore it
+        // and not report back to VHAL again.
+        verify(mCarPowerManagementService, never()).sendDisplayBrightnessLegacy(anyInt());
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testDisplayBrightnessChangeFromDisplayManager() throws Exception {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
+        when(mDisplay.getState()).thenReturn(Display.STATE_ON);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_ON);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+
+        mDisplayInterface.startDisplayStateMonitoring();
+
+        var displayListenerCaptor = ArgumentCaptor.forClass(DisplayListener.class);
+        verify(mDisplayManager).registerDisplayListener(displayListenerCaptor.capture(), isNull(),
+                anyLong());
+        clearInvocations(mCarPowerManagementService);
+
+        // Simulate user changes the global brightness setting to GLOBAL_BRIGHTNESS_2.
+        when(mDisplayManager.getBrightness(anyInt())).thenReturn(DISPLAY_MANAGER_BRIGHTNESS_2);
+        displayListenerCaptor.getValue().onDisplayChanged(MAIN_DISPLAY_ID);
+
+        verify(mCarPowerManagementService).sendDisplayBrightness(eq(MAIN_DISPLAY_ID), anyInt());
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testDisplayBrightnessChangeFromDisplayManager_ignoreRecentChange()
+            throws Exception {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{mDisplay, mDistantDisplay});
+        when(mDisplay.getState()).thenReturn(Display.STATE_ON);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_ON);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ false);
+
+        mDisplayInterface.startDisplayStateMonitoring();
+
+        var displayListenerCaptor = ArgumentCaptor.forClass(DisplayListener.class);
+        verify(mDisplayManager).registerDisplayListener(displayListenerCaptor.capture(), isNull(),
+                anyLong());
+        clearInvocations(mCarPowerManagementService);
+
+        // This variable stores the brightness settings. Need to use a list to be
+        // effective final.
+        ArrayList<Float> brightness = new ArrayList<>();
+
+        doAnswer((inv) -> {
+            brightness.add(inv.getArgument(1));
+            return null;
+        }).when(mDisplayManager).setBrightness(eq(MAIN_DISPLAY_ID), anyFloat());
+        when(mDisplayManager.getBrightness(eq(MAIN_DISPLAY_ID))).thenAnswer((inv) -> {
+            return brightness.get(0);
+        });
+
+        // Simulate a brightness change from VHAL.
+        mDisplayInterface.onDisplayBrightnessChangeFromVhal(MAIN_DISPLAY_ID,
+                /* percentBright= */ 50);
+        // This should trigger an onDisplayChanged event.
+        displayListenerCaptor.getValue().onDisplayChanged(MAIN_DISPLAY_ID);
+
+        // Because the brightness event is caused by VHAL, so we must ignore it
+        // and not report back to VHAL again.
+        verify(mCarPowerManagementService, never()).sendDisplayBrightness(anyInt(), anyInt());
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testIsAnyDisplayEnabled_on_beforeStartMonitoring() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{
+                mDisplay, mDistantDisplay, mVirtualDisplay, mOverlayDisplay});
+        when(mDisplay.getState()).thenReturn(Display.STATE_ON);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_OFF);
+        when(mDisplayManager.getBrightness(MAIN_DISPLAY_ID)).thenReturn(
+                DISPLAY_MANAGER_BRIGHTNESS_1);
+        when(mDisplayManager.getBrightness(DISTANT_DISPLAY_ID)).thenReturn(
+                DISPLAY_MANAGER_BRIGHTNESS_2);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ true);
+
+        assertThat(mDisplayInterface.isAnyDisplayEnabled()).isTrue();
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testIsAnyDisplayEnabled_off_beforeStartMonitoring() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{
+                mDisplay, mDistantDisplay, mVirtualDisplay, mOverlayDisplay});
+        when(mDisplay.getState()).thenReturn(Display.STATE_OFF);
+        when(mDistantDisplay.getState()).thenReturn(Display.STATE_OFF);
+        when(mDisplayManager.getBrightness(MAIN_DISPLAY_ID)).thenReturn(
+                DISPLAY_MANAGER_BRIGHTNESS_1);
+        when(mDisplayManager.getBrightness(DISTANT_DISPLAY_ID)).thenReturn(
+                DISPLAY_MANAGER_BRIGHTNESS_2);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ true);
+
+        assertThat(mDisplayInterface.isAnyDisplayEnabled()).isFalse();
+    }
+
+    @Test
+    @EnableFlags(FLAG_MULTI_DISPLAY_BRIGHTNESS_CONTROL)
+    public void testSetAllDisplayState_beforeStartMonitoring() {
+        when(mDisplayManager.getDisplays()).thenReturn(new Display[]{
+                mDisplay, mDistantDisplay, mVirtualDisplay, mOverlayDisplay});
+        when(mCarPowerManagementService.canTurnOnDisplay(anyInt())).thenReturn(true);
+
+        createDisplayInterface(/* visibleBgUsersSupported= */ true);
+
+        mDisplayInterface.setAllDisplayState(true);
+
+        verify(mWakeLockInterface).switchToFullWakeLock(MAIN_DISPLAY_ID);
+        verify(mWakeLockInterface).switchToFullWakeLock(DISTANT_DISPLAY_ID);
+    }
 
-        mDisplayInterface = new DisplayInterface.DefaultImpl(mContext, mWakeLockInterface) {
-            @Override
-            public void refreshDisplayBrightness() {
-            }
+    private void createDisplayInterface(boolean visibleBgUsersSupported) {
+        when(mUserManager.isVisibleBackgroundUsersSupported()).thenReturn(
+                visibleBgUsersSupported);
 
-            @Override
-            public void refreshDisplayBrightness(int displayId) {
-            }
-        };
+        mDisplayInterface = new DisplayInterface.DefaultImpl(mContext, mWakeLockInterface,
+                mSettings, mDisplayHelper, mCurrentUserFetcher);
         mDisplayInterface.init(mCarPowerManagementService, mCarUserService);
     }
 }
diff --git a/tests/carservice_unit_test/src/com/android/car/user/BaseCarUserServiceTestCase.java b/tests/carservice_unit_test/src/com/android/car/user/BaseCarUserServiceTestCase.java
index 9c58245361..1982340b34 100644
--- a/tests/carservice_unit_test/src/com/android/car/user/BaseCarUserServiceTestCase.java
+++ b/tests/carservice_unit_test/src/com/android/car/user/BaseCarUserServiceTestCase.java
@@ -115,6 +115,7 @@ import com.android.car.internal.common.UserHelperLite;
 import com.android.car.internal.os.CarSystemProperties;
 import com.android.car.internal.user.UserHelper;
 import com.android.car.pm.CarPackageManagerService;
+import com.android.car.provider.Settings;
 import com.android.internal.R;
 import com.android.internal.util.Preconditions;
 
@@ -291,7 +292,7 @@ abstract class BaseCarUserServiceTestCase extends AbstractExtendedMockitoTestCas
                 () -> CarSystemProperties.getUserHalTimeout());
         CarLocalServices.addService(CarOccupantZoneService.class, mCarOccupantZoneService);
 
-        mCarUserService = newCarUserService(/* switchGuestUserBeforeGoingSleep= */ false);
+        mCarUserService = new TestCarUserServiceBuilder().build();
 
         CarServiceHelperWrapper wrapper = CarServiceHelperWrapper.create();
         wrapper.setCarServiceHelper(mICarServiceHelper);
@@ -610,32 +611,40 @@ abstract class BaseCarUserServiceTestCase extends AbstractExtendedMockitoTestCas
         return getResult(mUserAssociationRespFuture, "result of getting user association");
     }
 
-    protected CarUserService newCarUserService(boolean switchGuestUserBeforeGoingSleep) {
-        when(mMockedResources
-                .getBoolean(com.android.car.R.bool.config_switchGuestUserBeforeGoingSleep))
-                .thenReturn(switchGuestUserBeforeGoingSleep);
-
-        when(mMockedResources
-                .getString(com.android.car.R.string.config_userPickerActivity))
-                .thenReturn(FAKE_USER_PICKER_PACKAGE);
-
-        when(mMockedResources
-                .getString(com.android.internal.R.string.config_systemUIServiceComponent))
-                .thenReturn(FAKE_SYSTEM_UI_SERVICE_PACKAGE);
-
-        return new CarUserService(
-                mMockContext,
-                mUserHal,
-                mMockedUserManager,
-                mMockedUserHandleHelper,
-                mMockedDevicePolicyManager,
-                mMockedActivityManager,
-                /* maxRunningUsers= */ 3,
-                mInitialUserSetter,
-                mCarUxRestrictionService,
-                mHandler,
-                mCarPackageManagerService,
-                mCarOccupantZoneService);
+    protected class TestCarUserServiceBuilder {
+        private boolean mSwitchGuestUserBeforeGoingSleep = false;
+
+        protected TestCarUserServiceBuilder setSwitchGuestUserBeforeGoingSleep(boolean enabled) {
+            mSwitchGuestUserBeforeGoingSleep = enabled;
+            return this;
+        }
+
+        protected CarUserService build() {
+            when(mMockedResources
+                    .getBoolean(com.android.car.R.bool.config_switchGuestUserBeforeGoingSleep))
+                    .thenReturn(mSwitchGuestUserBeforeGoingSleep);
+
+            when(mMockedResources
+                    .getString(com.android.car.R.string.config_userPickerActivity))
+                    .thenReturn(FAKE_USER_PICKER_PACKAGE);
+
+            when(mMockedResources
+                    .getString(com.android.internal.R.string.config_systemUIServiceComponent))
+                    .thenReturn(FAKE_SYSTEM_UI_SERVICE_PACKAGE);
+
+            return new CarUserService(
+                    mMockContext,
+                    mUserHal,
+                    mMockedUserManager,
+                    /* maxRunningUsers= */ 3,
+                    mCarUxRestrictionService,
+                    mCarPackageManagerService,
+                    mCarOccupantZoneService,
+                    new CarUserService.Deps(mMockedUserHandleHelper, mMockedDevicePolicyManager,
+                            mMockedActivityManager, mInitialUserSetter, mHandler,
+                            new ActivityManagerCurrentUserFetcher(),
+                            new Settings.DefaultImpl()));
+        }
     }
 
     /**
diff --git a/tests/carservice_unit_test/src/com/android/car/user/CarUserServiceTest.java b/tests/carservice_unit_test/src/com/android/car/user/CarUserServiceTest.java
index ceb2b7af42..975dcca722 100644
--- a/tests/carservice_unit_test/src/com/android/car/user/CarUserServiceTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/user/CarUserServiceTest.java
@@ -16,6 +16,7 @@
 
 package com.android.car.user;
 
+import static android.car.feature.Flags.FLAG_SUPPORTS_SECURE_PASSENGER_USERS;
 import static android.car.test.mocks.AndroidMockitoHelper.mockAmStartUserInBackground;
 import static android.car.test.mocks.AndroidMockitoHelper.mockAmStartUserInBackgroundVisibleOnDisplay;
 import static android.car.test.mocks.AndroidMockitoHelper.mockAmSwitchUser;
@@ -71,6 +72,7 @@ import android.car.SyncResultCallback;
 import android.car.VehicleAreaSeat;
 import android.car.builtin.app.ActivityManagerHelper;
 import android.car.builtin.os.UserManagerHelper;
+import android.car.builtin.widget.LockPatternHelper;
 import android.car.drivingstate.ICarUxRestrictionsChangeListener;
 import android.car.settings.CarSettings;
 import android.car.test.mocks.BlockingAnswer;
@@ -104,6 +106,7 @@ import android.os.Process;
 import android.os.RemoteException;
 import android.os.UserHandle;
 import android.os.UserManager;
+import android.platform.test.flag.junit.SetFlagsRule;
 import android.util.Log;
 import android.view.Display;
 
@@ -112,6 +115,7 @@ import com.android.car.internal.ResultCallbackImpl;
 import com.android.car.internal.util.DebugUtils;
 
 import org.junit.Before;
+import org.junit.Rule;
 import org.junit.Test;
 import org.mockito.ArgumentCaptor;
 import org.mockito.Mock;
@@ -143,6 +147,8 @@ public final class CarUserServiceTest extends BaseCarUserServiceTestCase {
     private ICarResultReceiver mAnotherLifecycleEventReceiver;
     @Mock
     private Context mMockUserContext;
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
 
     private MockSettings mMockSettings;
 
@@ -157,13 +163,14 @@ public final class CarUserServiceTest extends BaseCarUserServiceTestCase {
         mMockSettings = new MockSettings(builder);
         super.onSessionBuilder(builder);
 
-        builder.spyStatic(Car.class);
+        builder.spyStatic(Car.class).spyStatic(LockPatternHelper.class);
     }
 
     @Before
     public void setUp() {
         when(mLifecycleEventReceiver.asBinder()).thenReturn(mMockBinder);
         when(mAnotherLifecycleEventReceiver.asBinder()).thenReturn(mAnotherMockBinder);
+        doReturn(false).when(() -> LockPatternHelper.isSecure(any(), anyInt()));
     }
 
     @Test
@@ -2431,6 +2438,36 @@ public final class CarUserServiceTest extends BaseCarUserServiceTestCase {
         assertThat(getUserStartResponse().isSuccess()).isFalse();
     }
 
+    @Test
+    public void testStartUser_securePassenger_unsupported() throws Exception {
+        doReturn(true).when(() -> LockPatternHelper.isSecure(any(), anyInt()));
+        initUserAndDisplay(TEST_USER_ID, TEST_DISPLAY_ID);
+
+        mSetFlagsRule.disableFlags(FLAG_SUPPORTS_SECURE_PASSENGER_USERS);
+        UserStartRequest request = new UserStartRequest.Builder(UserHandle.of(TEST_USER_ID))
+                .setDisplayId(TEST_DISPLAY_ID).build();
+        startUser(request, mUserStartResultCallbackImpl);
+
+        assertThat(getUserStartResponse().getStatus())
+                .isEqualTo(UserStartResponse.STATUS_UNSUPPORTED_PLATFORM_FAILURE);
+        assertThat(getUserStartResponse().isSuccess()).isFalse();
+    }
+
+    @Test
+    public void testStartUser_securePassenger_supported() throws Exception {
+        doReturn(true).when(() -> LockPatternHelper.isSecure(any(), anyInt()));
+        initUserAndDisplay(TEST_USER_ID, TEST_DISPLAY_ID);
+
+        mSetFlagsRule.enableFlags(FLAG_SUPPORTS_SECURE_PASSENGER_USERS);
+        UserStartRequest request = new UserStartRequest.Builder(UserHandle.of(TEST_USER_ID))
+                .setDisplayId(TEST_DISPLAY_ID).build();
+        startUser(request, mUserStartResultCallbackImpl);
+
+        assertThat(getUserStartResponse().getStatus())
+                .isEqualTo(UserStartResponse.STATUS_SUCCESSFUL);
+        assertThat(getUserStartResponse().isSuccess()).isTrue();
+    }
+
     @Test
     public void testStartUser_withoutDisplayId_startsUserInBackground() throws Exception {
         mockCurrentUser(mRegularUser);
@@ -2787,7 +2824,8 @@ public final class CarUserServiceTest extends BaseCarUserServiceTestCase {
         mockExistingUsersAndCurrentUser(mGuestUser);
         when(mInitialUserSetter.canReplaceGuestUser(any())).thenReturn(true);
 
-        CarUserService service = newCarUserService(/* switchGuestUserBeforeGoingSleep= */ true);
+        CarUserService service = new TestCarUserServiceBuilder().setSwitchGuestUserBeforeGoingSleep(
+                true).build();
         service.onSuspend();
         waitForHandlerThreadToFinish();
 
@@ -2800,7 +2838,8 @@ public final class CarUserServiceTest extends BaseCarUserServiceTestCase {
     public void testOnSuspend_notReplace() throws Exception {
         mockExistingUsersAndCurrentUser(mAdminUser);
 
-        CarUserService service = newCarUserService(/* switchGuestUserBeforeGoingSleep= */ true);
+        CarUserService service = new TestCarUserServiceBuilder().setSwitchGuestUserBeforeGoingSleep(
+                true).build();
         service.onSuspend();
         waitForHandlerThreadToFinish();
 
diff --git a/tests/carservice_unit_test/src/com/android/car/user/ExperimentalCarUserManagerUnitTest.java b/tests/carservice_unit_test/src/com/android/car/user/ExperimentalCarUserManagerUnitTest.java
deleted file mode 100644
index 6f054b1fe7..0000000000
--- a/tests/carservice_unit_test/src/com/android/car/user/ExperimentalCarUserManagerUnitTest.java
+++ /dev/null
@@ -1,252 +0,0 @@
-/*
- * Copyright (C) 2020 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package com.android.car.user;
-
-import static android.car.test.mocks.JavaMockitoHelper.getResult;
-
-import static com.google.common.truth.Truth.assertThat;
-
-import static org.mockito.ArgumentMatchers.anyBoolean;
-import static org.mockito.ArgumentMatchers.anyString;
-import static org.mockito.ArgumentMatchers.eq;
-import static org.mockito.ArgumentMatchers.notNull;
-import static org.mockito.Mockito.doAnswer;
-import static org.mockito.Mockito.doThrow;
-import static org.mockito.Mockito.when;
-
-import android.annotation.UserIdInt;
-import android.car.Car;
-import android.car.IExperimentalCarUserService;
-import android.car.test.mocks.AbstractExtendedMockitoTestCase;
-import android.car.test.util.UserTestingHelper;
-import android.car.user.ExperimentalCarUserManager;
-import android.car.user.UserCreationResult;
-import android.car.user.UserSwitchResult;
-import android.car.util.concurrent.AndroidFuture;
-import android.os.RemoteException;
-import android.os.UserHandle;
-
-import org.junit.Before;
-import org.junit.Test;
-import org.mockito.Mock;
-
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.List;
-
-public final class ExperimentalCarUserManagerUnitTest extends AbstractExtendedMockitoTestCase {
-
-    @Mock
-    private Car mCar;
-    @Mock
-    private IExperimentalCarUserService mService;
-
-    private ExperimentalCarUserManager mManager;
-
-    public ExperimentalCarUserManagerUnitTest() {
-        super(ExperimentalCarUserManager.TAG);
-    }
-
-    @Before public void setFixtures() {
-        mManager = new ExperimentalCarUserManager(mCar, mService);
-    }
-
-    @Test
-    public void testCreateDriver_Success_Admin() throws Exception {
-        String name = "test driver";
-        int userId = 10;
-        expectCreateDriverSucceed(name, userId);
-
-        AndroidFuture<UserCreationResult> future = mManager.createDriver(name, true);
-
-        UserCreationResult result = getCreateDriverResult(future);
-        assertThat(result.getErrorMessage()).isNull();
-        assertThat(result.getStatus()).isEqualTo(UserCreationResult.STATUS_SUCCESSFUL);
-        assertThat(result.getUser().getIdentifier()).isEqualTo(userId);
-    }
-
-    @Test
-    public void testCreateDriver_Success_NonAdmin() throws Exception {
-        String name = "test driver";
-        int userId = 10;
-        expectCreateDriverSucceed(name, userId);
-
-        AndroidFuture<UserCreationResult> future = mManager.createDriver(name, false);
-
-        UserCreationResult result = getCreateDriverResult(future);
-        assertThat(result.getErrorMessage()).isNull();
-        assertThat(result.getStatus()).isEqualTo(UserCreationResult.STATUS_SUCCESSFUL);
-        assertThat(result.getUser().getIdentifier()).isEqualTo(userId);
-    }
-
-    @Test
-    public void testCreateDriver_Error() throws Exception {
-        expectCreateDriverFail();
-
-        AndroidFuture<UserCreationResult> future = mManager.createDriver("test driver", false);
-
-        assertThat(future).isNotNull();
-        UserCreationResult result = getCreateDriverResult(future);
-        assertThat(result.getStatus()).isEqualTo(UserSwitchResult.STATUS_HAL_INTERNAL_FAILURE);
-    }
-
-    @Test
-    public void testCreatePassenger_Success() throws Exception {
-        expectCreatePassengerSucceed();
-        int userId = mManager.createPassenger("test passenger", 10);
-        assertThat(userId).isNotEqualTo(UserHandle.USER_NULL);
-    }
-
-    @Test
-    public void testCreatePassenger_Error() throws Exception {
-        expectCreatePassengerFail();
-        int userId = mManager.createPassenger("test passenger", 20);
-        assertThat(userId).isEqualTo(UserHandle.USER_NULL);
-    }
-
-    @Test
-    public void testSwitchDriver_Success() throws Exception {
-        expectSwitchDriverSucceed(10);
-        AndroidFuture<UserSwitchResult> future = mManager.switchDriver(10);
-        UserSwitchResult result = getSwitchDriverResult(future);
-        assertThat(result.getStatus()).isEqualTo(UserSwitchResult.STATUS_SUCCESSFUL);
-    }
-
-    @Test
-    public void testSwitchDriver_Error() throws Exception {
-        expectSwitchDriverFail(20);
-        AndroidFuture<UserSwitchResult> future = mManager.switchDriver(20);
-        assertThat(future).isNotNull();
-        UserSwitchResult result = getSwitchDriverResult(future);
-        assertThat(result.getStatus()).isEqualTo(UserSwitchResult.STATUS_HAL_INTERNAL_FAILURE);
-    }
-
-    @Test
-    public void testGetAllDrivers() throws Exception {
-        List<UserHandle> userHandles = new ArrayList<UserHandle>();
-        userHandles.add(UserHandle.of(10));
-        userHandles.add(UserHandle.of(20));
-        userHandles.add(UserHandle.of(30));
-        when(mService.getAllDrivers()).thenReturn(userHandles);
-        List<Integer> drivers = mManager.getAllDrivers();
-        assertThat(drivers).containsExactly(10, 20, 30);
-    }
-
-    @Test
-    public void testGetAllPassengers() throws Exception {
-        List<UserHandle> userHandles = new ArrayList<UserHandle>();
-        userHandles.add(UserHandle.of(100));
-        userHandles.add(UserHandle.of(101));
-        userHandles.add(UserHandle.of(102));
-
-        when(mService.getPassengers(10)).thenReturn(userHandles);
-        when(mService.getPassengers(20)).thenReturn(Arrays.asList());
-
-        List<Integer> passengers = mManager.getPassengers(10);
-        assertThat(passengers).containsExactly(100, 101, 102);
-
-        passengers = mManager.getPassengers(20);
-        assertThat(passengers).isEmpty();
-    }
-
-    @Test
-    public void testStartPassenger_Success() throws Exception {
-        expectStartPassengerSucceed();
-        boolean success = mManager.startPassenger(100, /* zoneId = */ 1);
-        assertThat(success).isTrue();
-    }
-
-    @Test
-    public void testStartPassenger_Error() throws Exception {
-        expectStartPassengerFail();
-        boolean success = mManager.startPassenger(200, /* zoneId = */ 1);
-        assertThat(success).isFalse();
-    }
-
-    @Test
-    public void testStopPassenger_Success() throws Exception {
-        expectStopPassengerSucceed();
-        boolean success = mManager.stopPassenger(100);
-        assertThat(success).isTrue();
-    }
-
-    @Test
-    public void testStopPassenger_Error() throws Exception {
-        expectStopPassengerFail();
-        boolean success = mManager.stopPassenger(200);
-        assertThat(success).isFalse();
-    }
-
-    private void expectCreateDriverSucceed(String name, @UserIdInt int userId) throws Exception {
-        AndroidFuture<UserCreationResult> future = new AndroidFuture<>();
-        future.complete(new UserCreationResult(UserCreationResult.STATUS_SUCCESSFUL,
-                UserTestingHelper.newUser(userId).getUserHandle()));
-        when(mService.createDriver(eq(name), anyBoolean())).thenReturn(future);
-    }
-
-    private void expectCreateDriverFail() throws Exception {
-        doThrow(new RemoteException("D'OH!")).when(mService)
-            .createDriver(anyString(), anyBoolean());
-    }
-
-    private void expectCreatePassengerSucceed() throws Exception {
-        when(mService.createPassenger("test passenger", /* driverId = */ 10))
-                .thenReturn(UserHandle.of(100));
-    }
-
-    private void expectCreatePassengerFail() throws Exception {
-        when(mService.createPassenger("test passenger", /* driverId = */ 10)).thenReturn(null);
-    }
-
-    private void expectSwitchDriverSucceed(@UserIdInt int userId) throws Exception {
-        doAnswer((invocation) -> {
-            @SuppressWarnings("unchecked")
-            AndroidFuture<UserSwitchResult> future = (AndroidFuture<UserSwitchResult>) invocation
-                    .getArguments()[1];
-            future.complete(new UserSwitchResult(UserSwitchResult.STATUS_SUCCESSFUL, null));
-            return null;
-        }).when(mService).switchDriver(eq(userId), notNull());
-    }
-
-    private void expectSwitchDriverFail(@UserIdInt int userId) throws Exception {
-        doThrow(new RemoteException("D'OH!")).when(mService)
-            .switchDriver(eq(userId), notNull());
-    }
-
-    private void expectStartPassengerSucceed() throws Exception {
-        when(mService.startPassenger(100, /* zoneId = */ 1)).thenReturn(true);
-    }
-
-    private void expectStartPassengerFail() throws Exception {
-        when(mService.startPassenger(200, /* zoneId = */ 1)).thenReturn(false);
-    }
-
-    private void expectStopPassengerSucceed() throws Exception {
-        when(mService.stopPassenger(100)).thenReturn(true);
-    }
-
-    private void expectStopPassengerFail() throws Exception {
-        when(mService.stopPassenger(200)).thenReturn(false);
-    }
-
-    private UserCreationResult getCreateDriverResult(AndroidFuture<UserCreationResult> future) {
-        return getResult(future, "create driver");
-    }
-
-    private UserSwitchResult getSwitchDriverResult(AndroidFuture<UserSwitchResult> future) {
-        return getResult(future, "switch driver");
-    }
-}
diff --git a/tests/carservice_unit_test/src/com/android/car/user/ExperimentalCarUserServiceTest.java b/tests/carservice_unit_test/src/com/android/car/user/ExperimentalCarUserServiceTest.java
deleted file mode 100644
index f13e6ea007..0000000000
--- a/tests/carservice_unit_test/src/com/android/car/user/ExperimentalCarUserServiceTest.java
+++ /dev/null
@@ -1,362 +0,0 @@
-/*
- * Copyright (C) 2021 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.car.user;
-
-import static android.car.test.mocks.AndroidMockitoHelper.mockAmSwitchUser;
-import static android.car.test.mocks.AndroidMockitoHelper.mockUmCreateUser;
-import static android.car.test.mocks.JavaMockitoHelper.getResult;
-
-import static com.android.car.user.MockedUserHandleBuilder.expectAdminUserExists;
-import static com.android.car.user.MockedUserHandleBuilder.expectDisabledUserExists;
-import static com.android.car.user.MockedUserHandleBuilder.expectEphemeralUserExists;
-import static com.android.car.user.MockedUserHandleBuilder.expectGuestUserExists;
-import static com.android.car.user.MockedUserHandleBuilder.expectManagedProfileExists;
-import static com.android.car.user.MockedUserHandleBuilder.expectRegularUserExists;
-import static com.android.dx.mockito.inline.extended.ExtendedMockito.doNothing;
-import static com.android.dx.mockito.inline.extended.ExtendedMockito.doReturn;
-
-import static com.google.common.truth.Truth.assertThat;
-
-import static org.mockito.ArgumentMatchers.any;
-import static org.mockito.ArgumentMatchers.anyBoolean;
-import static org.mockito.ArgumentMatchers.anyInt;
-import static org.mockito.Mockito.when;
-
-import android.annotation.NonNull;
-import android.annotation.UserIdInt;
-import android.car.CarOccupantZoneManager.OccupantTypeEnum;
-import android.car.CarOccupantZoneManager.OccupantZoneInfo;
-import android.car.builtin.app.ActivityManagerHelper;
-import android.car.builtin.os.UserManagerHelper;
-import android.car.user.UserCreationResult;
-import android.car.user.UserSwitchResult;
-import android.car.util.concurrent.AndroidFuture;
-import android.hardware.automotive.vehicle.CreateUserStatus;
-import android.hardware.automotive.vehicle.SwitchUserStatus;
-import android.os.RemoteException;
-import android.os.UserHandle;
-import android.os.UserManager;
-import android.util.SparseArray;
-
-import com.android.car.hal.HalCallback;
-import com.android.car.internal.user.UserHelper;
-import com.android.car.user.ExperimentalCarUserService.ZoneUserBindingHelper;
-
-import org.junit.Before;
-import org.junit.Test;
-
-import java.util.ArrayList;
-import java.util.Arrays;
-import java.util.Collections;
-import java.util.HashSet;
-import java.util.List;
-import java.util.Set;
-
-/**
- * Unit tests for the {@link ExperimentalCarUserService}.
- */
-public final class ExperimentalCarUserServiceTest extends BaseCarUserServiceTestCase {
-
-    private ExperimentalCarUserService mExperimentalCarUserService;
-
-    public ExperimentalCarUserServiceTest() {
-        super(ExperimentalCarUserService.TAG);
-    }
-
-    @Before
-    public void setUp() {
-        mExperimentalCarUserService =
-                new ExperimentalCarUserService(mMockContext, mCarUserService, mMockedUserManager,
-                        mMockedUserHandleHelper);
-
-        // TODO(b/172262561): refactor this call, which is not assigning the service to anything
-        // (but without it some tests fail due to NPE).
-        new FakeCarOccupantZoneService(mExperimentalCarUserService);
-    }
-
-    @Test
-    public void testCreateAdminDriver_IfCurrentUserIsAdminUser() throws Exception {
-        when(mMockedUserManager.isSystemUser()).thenReturn(true);
-        mockUmCreateUser(mMockedUserManager, "testUser", UserManager.USER_TYPE_FULL_SECONDARY,
-                UserManagerHelper.FLAG_ADMIN, UserHandle.of(100));
-        mockHalCreateUser(HalCallback.STATUS_OK, CreateUserStatus.SUCCESS);
-
-        AndroidFuture<UserCreationResult> future =
-                mExperimentalCarUserService.createDriver("testUser", true);
-        waitForHandlerThreadToFinish();
-
-        UserCreationResult result = getCreateDriverResult(future);
-        assertThat(result.getStatus()).isEqualTo(UserCreationResult.STATUS_SUCCESSFUL);
-        assertThat(result.getUser().getIdentifier()).isEqualTo(100);
-    }
-
-    @Test
-    public void testCreateAdminDriver_IfCurrentUserIsNotSystemUser() throws Exception {
-        when(mMockedUserManager.isSystemUser()).thenReturn(false);
-        AndroidFuture<UserCreationResult> future =
-                mExperimentalCarUserService.createDriver("testUser", true);
-        waitForHandlerThreadToFinish();
-        assertThat(getCreateDriverResult(future).getStatus())
-                .isEqualTo(UserCreationResult.STATUS_INVALID_REQUEST);
-    }
-
-    @Test
-    public void testCreateNonAdminDriver() throws Exception {
-        mockUmCreateUser(mMockedUserManager, "testUser", UserManager.USER_TYPE_FULL_SECONDARY,
-                NO_USER_INFO_FLAGS, UserHandle.of(100));
-        mockHalCreateUser(HalCallback.STATUS_OK, CreateUserStatus.SUCCESS);
-
-        AndroidFuture<UserCreationResult> future =
-                mExperimentalCarUserService.createDriver("testUser", false);
-        waitForHandlerThreadToFinish();
-
-        UserCreationResult result = getCreateDriverResult(future);
-        assertThat(result.getStatus()).isEqualTo(UserCreationResult.STATUS_SUCCESSFUL);
-        assertThat(result.getUser().getIdentifier()).isEqualTo(100);
-    }
-
-    @Test
-    // TODO(b/213374587): remove UserInfo usages
-    public void testCreatePassenger() {
-        // assignDefaultIconForUser is not used for testing
-        doReturn(null).when(() -> UserHelper.assignDefaultIcon(any(), any()));
-        doNothing()
-                .when(() -> UserHelper.setDefaultNonAdminRestrictions(any(), any(), anyBoolean()));
-        int driverId = 90;
-        int passengerId = 99;
-        String userName = "testUser";
-        UserHandle passenger = expectManagedProfileExists(mMockedUserHandleHelper, passengerId);
-
-        mockCreateProfile(driverId, userName, passenger);
-
-        expectRegularUserExists(mMockedUserHandleHelper, driverId);
-        assertThat(mExperimentalCarUserService.createPassenger(userName, driverId))
-                .isEqualTo(passenger);
-    }
-
-    @Test
-    public void testCreatePassenger_IfMaximumProfileAlreadyCreated() {
-        UserHandle driver = expectManagedProfileExists(mMockedUserHandleHelper, 90);
-        String userName = "testUser";
-
-        mockCreateProfile(driver.getIdentifier(), userName, null);
-
-        assertThat(mExperimentalCarUserService.createPassenger(userName, driver.getIdentifier()))
-                .isNull();
-    }
-
-    @Test
-    public void testCreatePassenger_IfDriverIsGuest() {
-        int driverId = 90;
-        expectGuestUserExists(mMockedUserHandleHelper, driverId, /* isEphemeral= */ false);
-        String userName = "testUser";
-        assertThat(mExperimentalCarUserService.createPassenger(userName, driverId)).isNull();
-    }
-
-    @Test
-    public void testSwitchDriver() throws Exception {
-        mockExistingUsersAndCurrentUser(mAdminUser);
-        int requestId = 42;
-        mSwitchUserResponse.status = SwitchUserStatus.SUCCESS;
-        mSwitchUserResponse.requestId = requestId;
-        mockHalSwitch(mAdminUser.getIdentifier(), mRegularUser, mSwitchUserResponse);
-        mockAmSwitchUser(mMockedActivityManager, mRegularUser, true);
-        when(mMockedUserManager.hasUserRestriction(UserManager.DISALLOW_USER_SWITCH))
-                .thenReturn(false);
-
-        mExperimentalCarUserService.switchDriver(mRegularUserId, mUserSwitchFuture);
-
-        assertThat(getUserSwitchResult(mRegularUserId).getStatus())
-                .isEqualTo(UserSwitchResult.STATUS_SUCCESSFUL);
-    }
-
-    @Test
-    public void testSwitchDriver_failUxRestrictions() throws Exception {
-        mockExistingUsersAndCurrentUser(mAdminUser);
-        mockGetUxRestrictions(/* restricted= */ true);
-        initService();
-
-        mExperimentalCarUserService.switchDriver(mRegularUserId, mUserSwitchFuture);
-
-        assertThat(getUserSwitchResult(mRegularUserId).getStatus())
-                .isEqualTo(UserSwitchResult.STATUS_UX_RESTRICTION_FAILURE);
-        verifyNoUserSwitch();
-        assertNoHalUserSwitch();
-    }
-
-    @Test
-    public void testSwitchDriver_IfUserSwitchIsNotAllowed() throws Exception {
-        when(mMockedUserManager.getUserSwitchability())
-                .thenReturn(UserManager.SWITCHABILITY_STATUS_USER_SWITCH_DISALLOWED);
-
-        mExperimentalCarUserService.switchDriver(mRegularUserId, mUserSwitchFuture);
-
-        assertThat(getUserSwitchResult(mRegularUserId).getStatus())
-                .isEqualTo(UserSwitchResult.STATUS_INVALID_REQUEST);
-    }
-
-    @Test
-    public void testSwitchDriver_IfSwitchedToCurrentUser() throws Exception {
-        mockExistingUsersAndCurrentUser(mAdminUser);
-        when(mMockedUserManager.hasUserRestriction(UserManager.DISALLOW_USER_SWITCH))
-                .thenReturn(false);
-
-        mExperimentalCarUserService.switchDriver(mAdminUserId, mUserSwitchFuture);
-
-        assertThat(getUserSwitchResult(mAdminUserId).getStatus())
-                .isEqualTo(UserSwitchResult.STATUS_OK_USER_ALREADY_IN_FOREGROUND);
-    }
-
-    @Test
-    public void testStartPassenger() throws RemoteException {
-        int passenger1Id = 91;
-        int passenger2Id = 92;
-        int passenger3Id = 93;
-        int zone1Id = 1;
-        int zone2Id = 2;
-        doReturn(true)
-                .when(() -> ActivityManagerHelper.startUserInBackground(anyInt()));
-        assertThat(mExperimentalCarUserService.startPassenger(passenger1Id, zone1Id)).isTrue();
-        assertThat(mExperimentalCarUserService.startPassenger(passenger2Id, zone2Id)).isTrue();
-        assertThat(mExperimentalCarUserService.startPassenger(passenger3Id, zone2Id)).isFalse();
-    }
-
-    @Test
-    public void testStopPassenger() throws RemoteException {
-        int user1Id = 101;
-        int passenger1Id = 901;
-        int passenger2Id = 902;
-        int zoneId = 1;
-        UserHandle user1 = expectRegularUserExists(mMockedUserHandleHelper, user1Id);
-        UserHandle passenger1 = expectRegularUserExists(mMockedUserHandleHelper, passenger1Id);
-
-        associateParentChild(user1, passenger1);
-        mockGetCurrentUser(user1Id);
-        doReturn(true)
-                .when(() -> ActivityManagerHelper.startUserInBackground(anyInt()));
-        assertThat(mExperimentalCarUserService.startPassenger(passenger1Id, zoneId)).isTrue();
-        assertThat(mExperimentalCarUserService.stopPassenger(passenger1Id)).isTrue();
-        // Test of stopping an already stopped passenger.
-        assertThat(mExperimentalCarUserService.stopPassenger(passenger1Id)).isTrue();
-        // Test of stopping a non-existing passenger.
-        assertThat(mExperimentalCarUserService.stopPassenger(passenger2Id)).isFalse();
-    }
-
-    private List<UserHandle> prepareUserList() {
-        List<UserHandle> users = new ArrayList<>(Arrays.asList(
-                expectAdminUserExists(mMockedUserHandleHelper, 100),
-                expectRegularUserExists(mMockedUserHandleHelper, 101),
-                expectManagedProfileExists(mMockedUserHandleHelper, 102),
-                expectRegularUserExists(mMockedUserHandleHelper, 103),
-                expectGuestUserExists(mMockedUserHandleHelper, 104, /* isEphemeral= */ false),
-                expectEphemeralUserExists(mMockedUserHandleHelper, 105),
-                expectDisabledUserExists(mMockedUserHandleHelper, 106),
-                expectManagedProfileExists(mMockedUserHandleHelper, 107),
-                expectManagedProfileExists(mMockedUserHandleHelper, 108),
-                expectRegularUserExists(mMockedUserHandleHelper, 109)));
-
-        // Parent: test100, child: test102
-        associateParentChild(users.get(0), users.get(2));
-        // Parent: test103, child: test107
-        associateParentChild(users.get(3), users.get(7));
-        // Parent: test103, child: test108
-        associateParentChild(users.get(3), users.get(8));
-        return users;
-    }
-
-    @Test
-    public void testGetAllPossibleDrivers() {
-        Set<Integer> expected = new HashSet<Integer>(Arrays.asList(100, 101, 103, 104));
-        mockExistingUsers(prepareUserList());
-        mockIsHeadlessSystemUser(109, true);
-        for (UserHandle user : mExperimentalCarUserService.getAllDrivers()) {
-            assertThat(expected).contains(user.getIdentifier());
-            expected.remove(user.getIdentifier());
-        }
-        assertThat(expected).isEmpty();
-    }
-
-    @Test
-    public void testGetAllPassengers() {
-        SparseArray<HashSet<Integer>> testCases = new SparseArray<HashSet<Integer>>() {
-            {
-                put(0, new HashSet<Integer>());
-                put(100, new HashSet<Integer>(Arrays.asList(102)));
-                put(101, new HashSet<Integer>());
-                put(103, new HashSet<Integer>(Arrays.asList(107)));
-            }
-        };
-        mockIsHeadlessSystemUser(108, true);
-        for (int i = 0; i < testCases.size(); i++) {
-            mockExistingUsers(prepareUserList());
-            List<UserHandle> passengers = mExperimentalCarUserService
-                    .getPassengers(testCases.keyAt(i));
-            HashSet<Integer> expected = testCases.valueAt(i);
-            for (UserHandle user : passengers) {
-                assertThat(expected).contains(user.getIdentifier());
-                expected.remove(user.getIdentifier());
-            }
-            assertThat(expected).isEmpty();
-        }
-    }
-
-    private UserCreationResult getCreateDriverResult(AndroidFuture<UserCreationResult> future) {
-        return getResult(future, "create driver");
-    }
-
-    private static final class FakeCarOccupantZoneService {
-        private final SparseArray<Integer> mZoneUserMap = new SparseArray<Integer>();
-        private final ZoneUserBindingHelper mZoneUserBindigHelper =
-                new ZoneUserBindingHelper() {
-                    @Override
-                    @NonNull
-                    public List<OccupantZoneInfo> getOccupantZones(
-                            @OccupantTypeEnum int occupantType) {
-                        return Collections.emptyList();
-                    }
-
-                    @Override
-                    public boolean assignUserToOccupantZone(@UserIdInt int userId, int zoneId) {
-                        if (mZoneUserMap.get(zoneId) != null) {
-                            return false;
-                        }
-                        mZoneUserMap.put(zoneId, userId);
-                        return true;
-                    }
-
-                    @Override
-                    public boolean unassignUserFromOccupantZone(@UserIdInt int userId) {
-                        for (int index = 0; index < mZoneUserMap.size(); index++) {
-                            if (mZoneUserMap.valueAt(index) == userId) {
-                                mZoneUserMap.removeAt(index);
-                                break;
-                            }
-                        }
-                        return true;
-                    }
-
-                    @Override
-                    public boolean isPassengerDisplayAvailable() {
-                        return true;
-                    }
-                };
-
-        FakeCarOccupantZoneService(ExperimentalCarUserService experimentalCarUserService) {
-            experimentalCarUserService.setZoneUserBindingHelper(mZoneUserBindigHelper);
-        }
-    }
-}
diff --git a/tests/carservice_unit_test/src/com/android/car/user/InitialUserSetterTest.java b/tests/carservice_unit_test/src/com/android/car/user/InitialUserSetterTest.java
index 2e96a6669c..16fb6f85a2 100644
--- a/tests/carservice_unit_test/src/com/android/car/user/InitialUserSetterTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/user/InitialUserSetterTest.java
@@ -15,7 +15,6 @@
  */
 package com.android.car.user;
 
-import static android.car.test.mocks.AndroidMockitoHelper.mockUmGetUserHandles;
 import static android.car.test.mocks.CarArgumentMatchers.isUserHandle;
 import static android.os.UserHandle.USER_SYSTEM;
 
@@ -25,9 +24,6 @@ import static com.android.car.user.MockedUserHandleBuilder.expectGuestUserExists
 import static com.android.car.user.MockedUserHandleBuilder.expectManagedProfileExists;
 import static com.android.car.user.MockedUserHandleBuilder.expectRegularUserExists;
 import static com.android.car.user.MockedUserHandleBuilder.expectSystemUserExists;
-import static com.android.dx.mockito.inline.extended.ExtendedMockito.doReturn;
-import static com.android.dx.mockito.inline.extended.ExtendedMockito.doThrow;
-import static com.android.dx.mockito.inline.extended.ExtendedMockito.verify;
 
 import static com.google.common.truth.Truth.assertThat;
 import static com.google.common.truth.Truth.assertWithMessage;
@@ -39,36 +35,41 @@ import static org.mockito.ArgumentMatchers.anyInt;
 import static org.mockito.ArgumentMatchers.anyString;
 import static org.mockito.ArgumentMatchers.argThat;
 import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.doThrow;
 import static org.mockito.Mockito.never;
 import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.when;
 
 import android.annotation.Nullable;
 import android.annotation.UserIdInt;
-import android.app.ActivityManager;
-import android.car.builtin.app.ActivityManagerHelper;
 import android.car.builtin.os.UserManagerHelper;
-import android.car.builtin.widget.LockPatternHelper;
 import android.car.settings.CarSettings;
-import android.car.test.mocks.AbstractExtendedMockitoTestCase;
-import android.car.test.mocks.MockSettings;
+import android.car.test.util.UserTestingHelper;
 import android.content.Context;
 import android.hardware.automotive.vehicle.InitialUserInfoRequestType;
 import android.hardware.automotive.vehicle.UserInfo;
 import android.os.UserHandle;
 import android.os.UserManager;
+import android.platform.test.ravenwood.RavenwoodRule;
 import android.provider.Settings;
+import android.util.ArrayMap;
 
-import com.android.car.internal.os.CarSystemProperties;
+import com.android.internal.annotations.GuardedBy;
 
 import org.junit.Before;
+import org.junit.Rule;
 import org.junit.Test;
+import org.junit.runner.RunWith;
 import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnitRunner;
 
 import java.util.Optional;
 import java.util.function.Consumer;
 
-public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase {
+@RunWith(MockitoJUnitRunner.Silent.class)
+public final class InitialUserSetterTest {
 
     private static final int NO_FLAGS = 0;
 
@@ -84,50 +85,91 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
                     .setRequestType(InitialUserInfoRequestType.RESUME)
                     .build();
 
+    @Rule
+    public final RavenwoodRule mRavenwood = new RavenwoodRule.Builder().setProvideMainThread(true)
+            .build();
+
     @Mock
     private Context mContext;
-
     @Mock
     private UserManager mUm;
-
     @Mock
     private CarUserService mCarUserService;
-
     @Mock
     private UserHandleHelper mMockedUserHandleHelper;
-
-    private MockSettings mMockSettings;
+    @Mock
+    private InitialUserSetter.LockPatternHelperIntf mLockPatternHelper;
+    @Mock
+    private InitialUserSetter.ActivityManagerHelperIntf mActivityManagerHelper;
+    @Mock
+    private InitialUserSetter.CarSystemPropertiesIntf mCarSystemProperties;
+    @Mock
+    private CurrentUserFetcher mCurrentUserFetcher;
+    @Mock
+    private com.android.car.provider.Settings mSettings;
 
     // Spy used in tests that need to verify the default behavior as fallback
     private InitialUserSetter mSetter;
 
     private final MyListener mListener = new MyListener();
 
-    public InitialUserSetterTest() {
-        super(InitialUserSetter.TAG);
+    private final Object mLock = new Object();
+    @GuardedBy("mLock")
+    private int mCurrentUserId = 0;
+    @GuardedBy("mLock")
+    private final ArrayMap<String, Integer> mFakeGlobalSettings = new ArrayMap<>();
+    @GuardedBy("mLock")
+    private final ArrayMap<String, String> mFakeSystemSettings = new ArrayMap<>();
+
+    private void mockGetCurrentUser(int userId) {
+        synchronized (mLock) {
+            mCurrentUserId = userId;
+        }
     }
 
-    @Override
-    protected void onSessionBuilder(CustomMockitoSessionBuilder session) {
-        mMockSettings = new MockSettings(session);
-        session
-            .spyStatic(ActivityManager.class)
-            .spyStatic(ActivityManagerHelper.class)
-            .spyStatic(CarSystemProperties.class)
-            .spyStatic(UserManager.class)
-            .spyStatic(LockPatternHelper.class);
+    private InitialUserSetter newSetter(boolean isHeadlessSystemUserMode) {
+        return spy(new InitialUserSetter(mContext, mCarUserService, mListener,
+                mMockedUserHandleHelper, new InitialUserSetter.Deps(
+                        mUm, OWNER_NAME, GUEST_NAME, isHeadlessSystemUserMode,
+                        mActivityManagerHelper, mCarSystemProperties, mLockPatternHelper,
+                        mCurrentUserFetcher, mSettings
+                )));
     }
 
     @Before
     public void setFixtures() {
+        when(mSettings.putIntGlobal(any(), any(), anyInt())).thenAnswer((inv) -> {
+            synchronized (mLock) {
+                mFakeGlobalSettings.put(inv.getArgument(1), inv.getArgument(2));
+            }
+            return true;
+        });
+        when(mSettings.getIntGlobal(any(), any(), anyInt())).thenAnswer((inv) -> {
+            synchronized (mLock) {
+                String key = inv.getArgument(1);
+                Integer result = mFakeGlobalSettings.get(key);
+                if (result == null) {
+                    return inv.getArgument(2);
+                }
+                return result;
+            }
+        });
+        when(mSettings.putStringSystem(any(), any(), any())).thenAnswer((inv) -> {
+            synchronized (mLock) {
+                mFakeSystemSettings.put(inv.getArgument(1), inv.getArgument(2));
+            }
+            return true;
+        });
+        when(mCurrentUserFetcher.getCurrentUser()).thenAnswer((inv) -> {
+            synchronized (mLock) {
+                return mCurrentUserId;
+            }
+        });
         when(mContext.createContextAsUser(any(), anyInt())).thenReturn(mContext);
-        mSetter = spy(new InitialUserSetter(mContext, mUm, mCarUserService, mListener,
-                        mMockedUserHandleHelper, OWNER_NAME, GUEST_NAME));
+        when(mLockPatternHelper.isSecure(any(), anyInt())).thenReturn(false);
         mockGetCurrentUser(CURRENT_USER_ID);
 
-        // Need explicitly mock this call, otherwise the test will fail because the real method
-        // will be called and it doesn't have the required permissions to use that API
-        doReturn(false).when(()->LockPatternHelper.isSecure(any(), anyInt()));
+        mSetter = newSetter(/* isHeadlessSystemUserMode= */ true);
     }
 
     @Test
@@ -850,9 +892,14 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
         assertThat(mSetter.startForegroundUser(INITIAL_USER_INFO_RESUME, 10)).isFalse();
     }
 
+    private void mockIsHeadlessSystemUserMode(boolean isHeadlessSystemUserMode) {
+        mSetter = newSetter(isHeadlessSystemUserMode);
+    }
+
     @Test
     public void testStartForegroundUser_nonHeadlessSystemUser() throws Exception {
         mockIsHeadlessSystemUserMode(false);
+
         expectAmStartFgUser(UserHandle.USER_SYSTEM, /* toBeReturned= */ true);
 
         assertThat(mSetter.startForegroundUser(INITIAL_USER_INFO_RESUME, UserHandle.USER_SYSTEM))
@@ -866,7 +913,7 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
         assertThat(mSetter.startForegroundUser(INITIAL_USER_INFO_RESUME, UserHandle.USER_SYSTEM))
                 .isFalse();
 
-        verify(() -> ActivityManagerHelper.startUserInForeground(UserHandle.USER_SYSTEM), never());
+        verify(mActivityManagerHelper, never()).startUserInForeground(UserHandle.USER_SYSTEM);
     }
 
     @Test
@@ -887,7 +934,7 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
         assertThat(mSetter.getInitialUser(/* usesOverrideUserIdProperty= */ true))
                 .isEqualTo(110);
         // should have reset last active user
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_USER_ID))
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_USER_ID))
                 .isEqualTo(UserHandle.USER_NULL);
     }
 
@@ -900,9 +947,9 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
         assertThat(mSetter.getInitialUser(/* usesOverrideUserIdProperty= */ true))
                 .isEqualTo(100);
         // should have reset both settions
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_USER_ID))
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_USER_ID))
                 .isEqualTo(UserHandle.USER_NULL);
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
                 .isEqualTo(UserHandle.USER_NULL);
     }
 
@@ -1011,8 +1058,9 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
 
         mSetter.setLastActiveUser(UserHandle.USER_SYSTEM);
 
-        mMockSettings.assertDoesNotContainsKey(CarSettings.Global.LAST_ACTIVE_USER_ID);
-        mMockSettings.assertDoesNotContainsKey(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID);
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_USER_ID)).isNull();
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
+                .isNull();
     }
 
     @Test
@@ -1022,9 +1070,9 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
 
         mSetter.setLastActiveUser(UserHandle.USER_SYSTEM);
 
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_USER_ID))
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_USER_ID))
                 .isEqualTo(UserHandle.USER_SYSTEM);
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
                 .isEqualTo(UserHandle.USER_SYSTEM);
     }
 
@@ -1033,8 +1081,9 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
         // Don't need to mock um.getUser(), it will return null by default
         mSetter.setLastActiveUser(42);
 
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_USER_ID)).isEqualTo(42);
-        mMockSettings.assertDoesNotContainsKey(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID);
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_USER_ID)).isEqualTo(42);
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
+                .isNull();
     }
 
     @Test
@@ -1047,9 +1096,9 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
         mSetter.setLastActiveUser(persistentUserId);
         mSetter.setLastActiveUser(ephemeralUserid);
 
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_USER_ID))
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_USER_ID))
                 .isEqualTo(ephemeralUserid);
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
                 .isEqualTo(persistentUserId);
     }
 
@@ -1058,29 +1107,35 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
         expectRegularUserExists(mMockedUserHandleHelper, 42);
         mSetter.setLastActiveUser(42);
 
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_USER_ID)).isEqualTo(42);
-        assertThat(mMockSettings.getInt(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_USER_ID)).isEqualTo(42);
+        assertThat(getFromFakeGlobalSettings(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID))
                 .isEqualTo(42);
     }
 
     private void mockGetAliveUsers(@UserIdInt int... userIds) {
-        mockUmGetUserHandles(mUm, /* excludeDying= */ false, userIds);
+        when(mUm.getUserHandles(/* excludeDying= */ false)).thenReturn(
+                UserTestingHelper.newUserHandles(userIds));
     }
 
     private void mockGetAliveUsers(UserHandle... users) {
-        mockUmGetUserHandles(mUm, /* excludeDying= */ false, users);
+        when(mUm.getUserHandles(/* excludeDying= */ false)).thenReturn(
+                UserTestingHelper.toList(users));
     }
 
     private void setLastActiveUser(@UserIdInt int userId) {
-        mMockSettings.putInt(CarSettings.Global.LAST_ACTIVE_USER_ID, userId);
+        synchronized (mLock) {
+            mFakeGlobalSettings.put(CarSettings.Global.LAST_ACTIVE_USER_ID, userId);
+        }
     }
 
     private void setLastPersistentActiveUser(@UserIdInt int userId) {
-        mMockSettings.putInt(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID, userId);
+        synchronized (mLock) {
+            mFakeGlobalSettings.put(CarSettings.Global.LAST_ACTIVE_PERSISTENT_USER_ID, userId);
+        }
     }
 
     private void setDefaultBootUserOverride(@UserIdInt int userId) {
-        doReturn(Optional.of(userId)).when(() -> CarSystemProperties.getBootUserOverrideId());
+        when(mCarSystemProperties.getBootUserOverrideId()).thenReturn(Optional.of(userId));
     }
 
     private UserHandle expectHasInitialUser(@UserIdInt int userId) {
@@ -1107,7 +1162,7 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
     }
 
     private void expectUserIsSecure(@UserIdInt int userId) {
-        doReturn(true).when(()->LockPatternHelper.isSecure(any(), eq(userId)));
+        when(mLockPatternHelper.isSecure(any(), eq(userId))).thenReturn(true);
     }
 
     private void expectGuestReplaced(int existingGuestId, UserHandle newGuest) {
@@ -1145,9 +1200,8 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
                 .thenThrow(new RuntimeException("Cannot create user. D'OH!"));
     }
 
-    private static void expectAmStartFgUser(@UserIdInt int userId, boolean toBeReturned)
-            throws Exception {
-        doReturn(toBeReturned).when(() -> ActivityManagerHelper.startUserInForeground(userId));
+    private void expectAmStartFgUser(@UserIdInt int userId, boolean toBeReturned) throws Exception {
+        when(mActivityManagerHelper.startUserInForeground(userId)).thenReturn(toBeReturned);
     }
 
     private void verifyUserSwitched(@UserIdInt int userId) throws Exception {
@@ -1231,11 +1285,23 @@ public final class InitialUserSetterTest extends AbstractExtendedMockitoTestCase
 
     private void assertSystemLocales(String expected) {
         // TODO(b/156033195): should test specific userId
-        assertThat(mMockSettings.getString(Settings.System.SYSTEM_LOCALES)).isEqualTo(expected);
+        assertThat(getFromFakeSystemSettings(Settings.System.SYSTEM_LOCALES)).isEqualTo(expected);
     }
 
     private void assertSystemLocalesToBeNull() {
-        assertThat(mMockSettings.getString(Settings.System.SYSTEM_LOCALES)).isNull();
+        assertThat(getFromFakeSystemSettings(Settings.System.SYSTEM_LOCALES)).isNull();
+    }
+
+    private Integer getFromFakeGlobalSettings(String key) {
+        synchronized (mLock) {
+            return mFakeGlobalSettings.get(key);
+        }
+    }
+
+    private String getFromFakeSystemSettings(String key) {
+        synchronized (mLock) {
+            return mFakeSystemSettings.get(key);
+        }
     }
 
     private static final class MyListener implements Consumer<UserHandle> {
diff --git a/tests/carservice_unit_test/src/com/android/car/watchdog/CarWatchdogServiceUnitTest.java b/tests/carservice_unit_test/src/com/android/car/watchdog/CarWatchdogServiceUnitTest.java
index 76ca1fddcc..bcdf7c2fa6 100644
--- a/tests/carservice_unit_test/src/com/android/car/watchdog/CarWatchdogServiceUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/watchdog/CarWatchdogServiceUnitTest.java
@@ -493,7 +493,7 @@ public final class CarWatchdogServiceUnitTest extends AbstractExtendedMockitoTes
                 new Intent().setAction(Intent.ACTION_REBOOT)
                         .setFlags(Intent.FLAG_RECEIVER_FOREGROUND));
         verify(mMockCarWatchdogDaemonHelper).notifySystemStateChange(StateType.POWER_CYCLE,
-                PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER, /* arg2= */ 0);
+                PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER, /* arg2= */ MISSING_ARG_VALUE);
     }
 
     @Test
@@ -502,15 +502,15 @@ public final class CarWatchdogServiceUnitTest extends AbstractExtendedMockitoTes
                 new Intent().setAction(Intent.ACTION_SHUTDOWN)
                         .setFlags(Intent.FLAG_RECEIVER_FOREGROUND));
         verify(mMockCarWatchdogDaemonHelper).notifySystemStateChange(StateType.POWER_CYCLE,
-                PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER, /* arg2= */ 0);
+                PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER, /* arg2= */ MISSING_ARG_VALUE);
     }
 
     @Test
     public void testDeviceShutdownBroadcastWithoutFlagReceiverForeground() throws Exception {
         mBroadcastReceiver.onReceive(mMockContext,
-                new Intent().setAction(Intent.ACTION_SHUTDOWN));
+            new Intent().setAction(Intent.ACTION_SHUTDOWN));
         verify(mMockCarWatchdogDaemonHelper, never()).notifySystemStateChange(StateType.POWER_CYCLE,
-                PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER, /* arg2= */ 0);
+                PowerCycle.POWER_CYCLE_SHUTDOWN_ENTER, /* arg2= */ MISSING_ARG_VALUE);
     }
 
     @Test
diff --git a/tests/carservice_unit_test/src/com/android/car/watchdog/WatchdogPerfHandlerUnitTest.java b/tests/carservice_unit_test/src/com/android/car/watchdog/WatchdogPerfHandlerUnitTest.java
index f38df1fbdc..306042bbbe 100644
--- a/tests/carservice_unit_test/src/com/android/car/watchdog/WatchdogPerfHandlerUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/watchdog/WatchdogPerfHandlerUnitTest.java
@@ -1115,7 +1115,7 @@ public class WatchdogPerfHandlerUnitTest extends AbstractExtendedMockitoTestCase
     private void crashAndDelayReconnectDaemon() {
         mWatchdogPerfHandler.onDaemonConnectionChange(/* isConnected= */ false);
 
-        mMainHandler.postAtTime(
+        mMainHandler.postDelayed(
                 () -> mWatchdogPerfHandler.onDaemonConnectionChange(/* isConnected= */ true),
                 MAX_WAIT_TIME_MILLS - 1000);
     }
@@ -4165,7 +4165,9 @@ public class WatchdogPerfHandlerUnitTest extends AbstractExtendedMockitoTestCase
         verifyDatabaseInit(wantedInvocations);
         captureStatsPullAtomCallback(wantedInvocations);
         mWatchdogPerfHandler.onDaemonConnectionChange(/* isConnected= */ true);
-
+        // Initialization of CarService fetches and syncs resource overuse configuration on the main
+        // thread. Wait until this completes.
+        CarServiceUtils.runOnMainSync(() -> {});
     }
 
     private void restartService(int totalRestarts, int wantedDbWrites) throws Exception {
diff --git a/tests/carservice_unit_test/src/com/android/car/watchdog/WatchdogProcessHandlerUnitTest.java b/tests/carservice_unit_test/src/com/android/car/watchdog/WatchdogProcessHandlerUnitTest.java
index a4a833fd5d..8d3b73773d 100644
--- a/tests/carservice_unit_test/src/com/android/car/watchdog/WatchdogProcessHandlerUnitTest.java
+++ b/tests/carservice_unit_test/src/com/android/car/watchdog/WatchdogProcessHandlerUnitTest.java
@@ -116,7 +116,67 @@ public class WatchdogProcessHandlerUnitTest extends AbstractExtendedMockitoTestC
         CarLocalServices.removeServiceForTest(CarServiceHelperWrapper.class);
     }
 
-    // TODO(b/288468494): Look into adding tests for prepareHealthCheck and updateUserState.
+    @Test
+    public void testPrepareHealthCheck() throws Exception {
+        // Register bad client; bad clients do not respond to CarWatchdogService when pinged
+        TestClient badClient = new BadTestClient();
+        mWatchdogProcessHandler.registerClient(badClient, TIMEOUT_CRITICAL);
+
+        // Start a health check, which will ping registered clients.
+        mWatchdogProcessHandler.postHealthCheckMessage(123456);
+
+        CarServiceUtils.runOnMainSync(() -> {});
+
+        // Clears all pending clients
+        mWatchdogProcessHandler.prepareHealthCheck();
+
+        // Since the pending clients cache was cleared, CarWatchdogService won't
+        // call onPrepareProcessTermination on our bad client even if it did not
+        // respond to the initial ping.
+        mWatchdogProcessHandler.postHealthCheckMessage(123456);
+
+        CarServiceUtils.runOnMainSync(() -> {});
+
+        // Check if bad client received onPrepareProcessTermination
+        assertWithMessage("Pinged clients not resetting").that(
+            badClient.getReceivedOnPrepareProcessTermination()).isEqualTo(false);
+    }
+
+    @Test
+    public void testUpdateUserState() throws Exception {
+        TestClient client = new TestClient();
+        mWatchdogProcessHandler.registerClient(client, TIMEOUT_CRITICAL);
+
+        // Setting the ClientInfo packageName in registerClient is done on the CarWatchdogService
+        // service handler thread. Wait until the below message is processed before
+        // returning, to the packageName is resolved in ClientInfo.
+        CarServiceUtils.runEmptyRunnableOnLooperSync(CAR_WATCHDOG_SERVICE_NAME);
+
+        mWatchdogProcessHandler.updateUserState(100, true);
+
+        ProtoOutputStream proto = new ProtoOutputStream();
+        mWatchdogProcessHandler.dumpProto(proto);
+
+        CarWatchdogDumpProto carWatchdogDumpProto = CarWatchdogDumpProto.parseFrom(
+                proto.getBytes());
+        CarWatchdogDumpProto.SystemHealthDump systemHealthDump =
+                carWatchdogDumpProto.getSystemHealthDump();
+
+        expectWithMessage("Stopped Users Count").that(
+            systemHealthDump.getStoppedUsersCount()).isEqualTo(1);
+        expectWithMessage("Stopped User").that(systemHealthDump.getStoppedUsers(0)).isEqualTo(100);
+
+        mWatchdogProcessHandler.updateUserState(100, false);
+
+        proto = new ProtoOutputStream();
+        mWatchdogProcessHandler.dumpProto(proto);
+
+        carWatchdogDumpProto = CarWatchdogDumpProto.parseFrom(proto.getBytes());
+        systemHealthDump = carWatchdogDumpProto.getSystemHealthDump();
+
+        expectWithMessage("Stopped Users Count").that(
+            systemHealthDump.getStoppedUsersCount()).isEqualTo(0);
+    }
 
     @Test
     public void testPostHealthCheckMessage() throws Exception {
@@ -323,6 +383,7 @@ public class WatchdogProcessHandlerUnitTest extends AbstractExtendedMockitoTestC
 
     private class TestClient extends ICarWatchdogServiceCallback.Stub {
         protected int mLastSessionId = INVALID_SESSION_ID;
+        protected boolean mReceivedOnPrepareProcessTermination = false;
 
         @Override
         public void onCheckHealthStatus(int sessionId, int timeout) {
@@ -332,11 +393,16 @@ public class WatchdogProcessHandlerUnitTest extends AbstractExtendedMockitoTestC
 
         @Override
         public void onPrepareProcessTermination() {
+            mReceivedOnPrepareProcessTermination = true;
         }
 
         public int getLastSessionId() {
             return mLastSessionId;
         }
+
+        public boolean getReceivedOnPrepareProcessTermination() {
+            return mReceivedOnPrepareProcessTermination;
+        }
     }
 
     private final class BadTestClient extends TestClient {
diff --git a/tests/obd2_test/Android.bp b/tests/obd2_test/Android.bp
index bb06d70a6e..f981352a72 100644
--- a/tests/obd2_test/Android.bp
+++ b/tests/obd2_test/Android.bp
@@ -45,6 +45,6 @@ android_test {
 
     libs: [
         "android.car-system-stubs",
-        "android.test.runner",
+        "android.test.runner.stubs.system",
     ],
 }
diff --git a/tests/vehiclehal_test/Android.bp b/tests/vehiclehal_test/Android.bp
index 61cf8917b1..5f03986656 100644
--- a/tests/vehiclehal_test/Android.bp
+++ b/tests/vehiclehal_test/Android.bp
@@ -25,6 +25,8 @@ package {
 android_test {
     name: "VehicleHalE2eTest",
 
+    defaults: ["vhal-interface-defaults"],
+
     srcs: ["src/**/*.java"],
 
     platform_apis: true,
@@ -38,15 +40,13 @@ android_test {
     static_libs: [
         "vehicle-hal-support-lib",
         "androidx.test.rules",
-        "android.hardware.automotive.vehicle-V3-java",
-        "android.hardware.automotive.vehicle.property-V3-java",
         "compatibility-device-util-axt",
         "truth",
     ],
 
     libs: [
         "android.car",
-        "android.test.runner",
-        "android.test.base",
+        "android.test.runner.stubs.system",
+        "android.test.base.stubs.system",
     ],
 }
diff --git a/tools/GenericCarApiBuilder/annotation_classlist_repohook.py b/tools/GenericCarApiBuilder/annotation_classlist_repohook.py
index 9e1f503685..93c39fe8f4 100755
--- a/tools/GenericCarApiBuilder/annotation_classlist_repohook.py
+++ b/tools/GenericCarApiBuilder/annotation_classlist_repohook.py
@@ -44,8 +44,8 @@ if rootDir is None or rootDir == "":
 
 javaHomeDir = os.getenv("JAVA_HOME")
 if javaHomeDir is None or javaHomeDir == "":
-    if Path(rootDir + '/prebuilts/jdk/jdk17/linux-x86').is_dir():
-        javaHomeDir = rootDir + "/prebuilts/jdk/jdk17/linux-x86"
+    if Path(rootDir + '/prebuilts/jdk/jdk21/linux-x86').is_dir():
+        javaHomeDir = rootDir + "/prebuilts/jdk/jdk21/linux-x86"
     else:
         print("$JAVA_HOME is not set. Please use source build/envsetup.sh` in $ANDROID_BUILD_TOP")
         sys.exit(1)
diff --git a/tools/GenericCarApiBuilder/complete_car_api_list.txt b/tools/GenericCarApiBuilder/complete_car_api_list.txt
deleted file mode 100644
index 28253876d9..0000000000
--- a/tools/GenericCarApiBuilder/complete_car_api_list.txt
+++ /dev/null
@@ -1,2932 +0,0 @@
-class @hide @SystemApi VehicleAreaDoor package android.car
-    field TIRAMISU_0 int DOOR_ROW_1_LEFT = 0x00000001;
-    field TIRAMISU_0 int DOOR_ROW_1_RIGHT = 0x00000004;
-    field TIRAMISU_0 int DOOR_ROW_2_LEFT = 0x00000010;
-    field TIRAMISU_0 int DOOR_ROW_2_RIGHT = 0x00000040;
-    field TIRAMISU_0 int DOOR_ROW_3_LEFT = 0x00000100;
-    field TIRAMISU_0 int DOOR_ROW_3_RIGHT = 0x00000400;
-    field TIRAMISU_0 int DOOR_HOOD = 0x10000000;
-    field TIRAMISU_0 int DOOR_REAR = 0x20000000;
-class @hiddenOnly @hide CarTransactionException package android.car
-class @hiddenOnly @hide DriverMonitoringDetection package android.car.occupantawareness
-    field TIRAMISU_0 int confidenceLevel;
-    field TIRAMISU_0 boolean isLookingOnRoad;
-    field TIRAMISU_0 long gazeDurationMillis;
-    field TIRAMISU_0 Parcelable.Creator<DriverMonitoringDetection> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-class @hiddenOnly @hide OccupantAwarenessDetection package android.car.occupantawareness
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_NONE = 0;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_DRIVER = 1 << 2;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_FRONT_PASSENGER = 1 << 1;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ROW_2_PASSENGER_LEFT = 1 << 3;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ROW_2_PASSENGER_CENTER = 1 << 4;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ROW_2_PASSENGER_RIGHT = 1 << 5;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ROW_3_PASSENGER_LEFT = 1 << 6;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ROW_3_PASSENGER_CENTER = 1 << 7;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ROW_3_PASSENGER_RIGHT = 1 << 8;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ALL_FRONT_OCCUPANTS = VEHICLE_OCCUPANT_DRIVER | VEHICLE_OCCUPANT_FRONT_PASSENGER;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ALL_ROW_2_OCCUPANTS = VEHICLE_OCCUPANT_ROW_2_PASSENGER_LEFT | VEHICLE_OCCUPANT_ROW_2_PASSENGER_RIGHT | VEHICLE_OCCUPANT_ROW_2_PASSENGER_CENTER;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ALL_ROW_3_OCCUPANTS = VEHICLE_OCCUPANT_ROW_3_PASSENGER_LEFT | VEHICLE_OCCUPANT_ROW_3_PASSENGER_RIGHT | VEHICLE_OCCUPANT_ROW_3_PASSENGER_CENTER;
-    field TIRAMISU_0 int VEHICLE_OCCUPANT_ALL_OCCUPANTS = VEHICLE_OCCUPANT_ALL_FRONT_OCCUPANTS | VEHICLE_OCCUPANT_ALL_ROW_2_OCCUPANTS | VEHICLE_OCCUPANT_ALL_ROW_3_OCCUPANTS;
-    field TIRAMISU_0 int CONFIDENCE_LEVEL_NONE = 0;
-    field TIRAMISU_0 int CONFIDENCE_LEVEL_LOW = 1;
-    field TIRAMISU_0 int CONFIDENCE_LEVEL_HIGH = 2;
-    field TIRAMISU_0 int CONFIDENCE_LEVEL_MAX = 3;
-    field TIRAMISU_0 int role;
-    field TIRAMISU_0 long timestampMillis;
-    field TIRAMISU_0 boolean isPresent;
-    field TIRAMISU_0 GazeDetection gazeDetection;
-    field TIRAMISU_0 DriverMonitoringDetection driverMonitoringDetection;
-    field TIRAMISU_0 Parcelable.Creator<OccupantAwarenessDetection> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-class @hiddenOnly @hide Point3D package android.car.occupantawareness
-    field TIRAMISU_0 double x;
-    field TIRAMISU_0 double y;
-    field TIRAMISU_0 double z;
-    field TIRAMISU_0 Parcelable.Creator<Point3D> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-class @hiddenOnly @hide SystemStatusEvent package android.car.occupantawareness
-    field TIRAMISU_0 int SYSTEM_STATUS_READY = 0;
-    field TIRAMISU_0 int SYSTEM_STATUS_NOT_SUPPORTED = 1;
-    field TIRAMISU_0 int SYSTEM_STATUS_NOT_READY = 2;
-    field TIRAMISU_0 int SYSTEM_STATUS_SYSTEM_FAILURE = 3;
-    field TIRAMISU_0 int DETECTION_TYPE_NONE = 0;
-    field TIRAMISU_0 int DETECTION_TYPE_PRESENCE = 1 << 0;
-    field TIRAMISU_0 int DETECTION_TYPE_GAZE = 1 << 1;
-    field TIRAMISU_0 int DETECTION_TYPE_DRIVER_MONITORING = 1 << 2;
-    field TIRAMISU_0 int systemStatus;
-    field TIRAMISU_0 int detectionType;
-    field TIRAMISU_0 Parcelable.Creator<SystemStatusEvent> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-class @hiddenOnly @hide GazeDetection package android.car.occupantawareness
-    field TIRAMISU_0 int VEHICLE_REGION_UNKNOWN = 0;
-    field TIRAMISU_0 int VEHICLE_REGION_CENTER_INSTRUMENT_CLUSTER = 1;
-    field TIRAMISU_0 int VEHICLE_REGION_REAR_VIEW_MIRROR = 2;
-    field TIRAMISU_0 int VEHICLE_REGION_LEFT_SIDE_MIRROR = 3;
-    field TIRAMISU_0 int VEHICLE_REGION_RIGHT_SIDE_MIRROR = 4;
-    field TIRAMISU_0 int VEHICLE_REGION_FORWARD_ROADWAY = 5;
-    field TIRAMISU_0 int VEHICLE_REGION_LEFT_ROADWAY = 6;
-    field TIRAMISU_0 int VEHICLE_REGION_RIGHT_ROADWAY = 7;
-    field TIRAMISU_0 int VEHICLE_REGION_HEAD_UNIT_DISPLAY = 8;
-    field TIRAMISU_0 int confidenceLevel;
-    field TIRAMISU_0 Point3D leftEyePosition;
-    field TIRAMISU_0 Point3D rightEyePosition;
-    field TIRAMISU_0 Point3D headAngleUnitVector;
-    field TIRAMISU_0 Point3D gazeAngleUnitVector;
-    field TIRAMISU_0 int gazeTarget;
-    field TIRAMISU_0 long durationOnTargetMillis;
-    field TIRAMISU_0 Parcelable.Creator<GazeDetection> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-class @hiddenOnly @hide OccupantAwarenessManager package android.car.occupantawareness
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 int getCapabilityForRole(int role);
-    method TIRAMISU_0 void registerChangeCallback(ChangeCallback callback);
-    method TIRAMISU_0 void unregisterChangeCallback();
-class OccupantAwarenessManager.ChangeCallback package android.car.occupantawareness
-    method TIRAMISU_0 void onSystemStateChanged(SystemStatusEvent systemStatus);
-    method TIRAMISU_0 void onDetectionEvent(OccupantAwarenessDetection event);
-class @hiddenOnly @hide VehicleOilLevel package android.car
-    field TIRAMISU_0 int CRITICALLY_LOW = 0;
-    field TIRAMISU_0 int LOW = 1;
-    field TIRAMISU_0 int NORMAL = 2;
-    field TIRAMISU_0 int HIGH = 3;
-    field TIRAMISU_0 int ERROR = 4;
-class @hiddenOnly @hide VehiclePropertyType package android.car
-    field TIRAMISU_0 int STRING = 0x00100000;
-    field TIRAMISU_0 int BOOLEAN = 0x00200000;
-    field TIRAMISU_0 int INT32 = 0x00400000;
-    field TIRAMISU_0 int INT32_VEC = 0x00410000;
-    field TIRAMISU_0 int INT64 = 0x00500000;
-    field TIRAMISU_0 int INT64_VEC = 0x00510000;
-    field TIRAMISU_0 int FLOAT = 0x00600000;
-    field TIRAMISU_0 int FLOAT_VEC = 0x00610000;
-    field TIRAMISU_0 int BYTES = 0x00700000;
-    field TIRAMISU_0 int MIXED = 0x00e00000;
-    field TIRAMISU_0 int MASK = 0x00ff0000;
-class @hide @SystemApi ProjectionStatus package android.car.projection
-    field TIRAMISU_0 int PROJECTION_STATE_INACTIVE = 0;
-    field TIRAMISU_0 int PROJECTION_STATE_READY_TO_PROJECT = 1;
-    field TIRAMISU_0 int PROJECTION_STATE_ACTIVE_FOREGROUND = 2;
-    field TIRAMISU_0 int PROJECTION_STATE_ACTIVE_BACKGROUND = 3;
-    field UPSIDE_DOWN_CAKE_0 int PROJECTION_STATE_ATTEMPTING = 4;
-    field UPSIDE_DOWN_CAKE_0 int PROJECTION_STATE_FINISHING = 5;
-    field TIRAMISU_0 int PROJECTION_TRANSPORT_NONE = 0;
-    field TIRAMISU_0 int PROJECTION_TRANSPORT_USB = 1;
-    field TIRAMISU_0 int PROJECTION_TRANSPORT_WIFI = 2;
-    field TIRAMISU_0 Creator<ProjectionStatus> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int getState();
-    method TIRAMISU_0 String getPackageName();
-    method TIRAMISU_0 Bundle getExtras();
-    method TIRAMISU_0 boolean isActive();
-    method TIRAMISU_0 int getTransport();
-    method TIRAMISU_0 List<MobileDevice> getConnectedMobileDevices();
-    method TIRAMISU_0 Builder builder(String packageName, int state);
-    method TIRAMISU_0 String toString();
-class ProjectionStatus.Builder package android.car.projection
-    method TIRAMISU_0 Builder setProjectionTransport(int transport);
-    method TIRAMISU_0 Builder addMobileDevice(MobileDevice mobileDevice);
-    method TIRAMISU_0 Builder setExtras(Bundle extras);
-    method TIRAMISU_0 ProjectionStatus build();
-class ProjectionStatus.MobileDevice package android.car.projection
-    field TIRAMISU_0 Creator<MobileDevice> CREATOR;
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int getId();
-    method TIRAMISU_0 String getName();
-    method TIRAMISU_0 List<Integer> getAvailableTransports();
-    method TIRAMISU_0 boolean isProjecting();
-    method TIRAMISU_0 Bundle getExtras();
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 Builder builder(int id, String name);
-    method TIRAMISU_0 String toString();
-class ProjectionStatus.MobileDevice.Builder package android.car.projection
-    method TIRAMISU_0 Builder addTransport(int transport);
-    method TIRAMISU_0 Builder setProjecting(boolean projecting);
-    method TIRAMISU_0 Builder setExtras(Bundle extras);
-    method TIRAMISU_0 MobileDevice build();
-class @hide @SystemApi ProjectionOptions package android.car.projection
-    field TIRAMISU_0 int UI_MODE_FULL_SCREEN = 0;
-    field TIRAMISU_0 int UI_MODE_BLENDED = 1;
-    field TIRAMISU_0 int AP_MODE_NOT_SPECIFIED = 0;
-    field TIRAMISU_0 int AP_MODE_TETHERED = 1;
-    field TIRAMISU_0 int AP_MODE_LOHS_DYNAMIC_CREDENTIALS = 2;
-    field TIRAMISU_0 int AP_MODE_LOHS_STATIC_CREDENTIALS = 3;
-    method TIRAMISU_0 int getUiMode();
-    method TIRAMISU_0 int getProjectionAccessPointMode();
-    method TIRAMISU_0 ActivityOptions getActivityOptions();
-    method TIRAMISU_0 ComponentName getConsentActivity();
-    method TIRAMISU_0 Bundle toBundle();
-    method TIRAMISU_0 @hiddenOnly Builder builder();
-    method TIRAMISU_0 @hiddenOnly String toString();
-class @hiddenOnly @hide ProjectionOptions.Builder package android.car.projection
-    method TIRAMISU_0 Builder setProjectionActivityOptions(ActivityOptions activityOptions);
-    method TIRAMISU_0 Builder setUiMode(int uiMode);
-    method TIRAMISU_0 Builder setConsentActivity(ComponentName consentActivity);
-    method TIRAMISU_0 Builder setAccessPointMode(int accessPointMode);
-    method TIRAMISU_0 ProjectionOptions build();
-class @hide @SystemApi CarEvsManager package android.car.evs
-    field TIRAMISU_0 String EXTRA_SESSION_TOKEN = "android.car.evs.extra.SESSION_TOKEN";
-    field TIRAMISU_0 int SERVICE_TYPE_REARVIEW = 0;
-    field TIRAMISU_0 int SERVICE_TYPE_SURROUNDVIEW = 1;
-    field TIRAMISU_0 int SERVICE_STATE_UNAVAILABLE = 0;
-    field TIRAMISU_0 int SERVICE_STATE_INACTIVE = 1;
-    field TIRAMISU_0 int SERVICE_STATE_REQUESTED = 2;
-    field TIRAMISU_0 int SERVICE_STATE_ACTIVE = 3;
-    field TIRAMISU_0 int STREAM_EVENT_NONE = 0;
-    field TIRAMISU_0 int STREAM_EVENT_STREAM_STARTED = 1;
-    field TIRAMISU_0 int STREAM_EVENT_STREAM_STOPPED = 2;
-    field TIRAMISU_0 int STREAM_EVENT_FRAME_DROPPED = 3;
-    field TIRAMISU_0 int STREAM_EVENT_TIMEOUT = 4;
-    field TIRAMISU_0 int STREAM_EVENT_PARAMETER_CHANGED = 5;
-    field TIRAMISU_0 int STREAM_EVENT_PRIMARY_OWNER_CHANGED = 6;
-    field TIRAMISU_0 int STREAM_EVENT_OTHER_ERRORS = 7;
-    field TIRAMISU_0 int ERROR_NONE = 0;
-    field TIRAMISU_0 int ERROR_UNAVAILABLE = -1;
-    field TIRAMISU_0 int ERROR_BUSY = -2;
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 void setStatusListener(Executor executor, CarEvsStatusListener listener);
-    method TIRAMISU_0 void clearStatusListener();
-    method TIRAMISU_0 void returnFrameBuffer(CarEvsBufferDescriptor buffer);
-    method TIRAMISU_0 int startActivity(int type);
-    method TIRAMISU_0 void stopActivity();
-    method TIRAMISU_0 int startVideoStream(int type, IBinder token, Executor executor, CarEvsStreamCallback callback);
-    method TIRAMISU_0 void stopVideoStream();
-    method TIRAMISU_0 CarEvsStatus getCurrentStatus();
-    method TIRAMISU_0 IBinder generateSessionToken();
-    method TIRAMISU_0 boolean isSupported(int type);
-interface CarEvsManager.CarEvsStatusListener package android.car.evs
-    method TIRAMISU_0 void onStatusChanged(CarEvsStatus status);
-interface CarEvsManager.CarEvsStreamCallback package android.car.evs
-    method TIRAMISU_0 void onStreamEvent(int event);
-    method TIRAMISU_0 void onNewFrame(CarEvsBufferDescriptor buffer);
-class @hide @SystemApi CarEvsStatus package android.car.evs
-    field TIRAMISU_0 Parcelable.Creator<CarEvsStatus> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 int getState();
-    method TIRAMISU_0 int getServiceType();
-class @hide @SystemApi CarEvsBufferDescriptor package android.car.evs
-    field TIRAMISU_0 Parcelable.Creator<CarEvsBufferDescriptor> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 int getId();
-    method TIRAMISU_0 HardwareBuffer getHardwareBuffer();
-class @hide @SystemApi CarMediaManager package android.car.media
-    field TIRAMISU_0 int MEDIA_SOURCE_MODE_PLAYBACK = 0;
-    field TIRAMISU_0 int MEDIA_SOURCE_MODE_BROWSE = 1;
-    method TIRAMISU_0 ComponentName getMediaSource(int mode);
-    method TIRAMISU_0 void setMediaSource(ComponentName componentName, int mode);
-    method TIRAMISU_0 void addMediaSourceListener(MediaSourceChangedListener callback, int mode);
-    method TIRAMISU_0 void removeMediaSourceListener(MediaSourceChangedListener callback, int mode);
-    method TIRAMISU_0 List<ComponentName> getLastMediaSources(int mode);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 @hiddenOnly boolean isIndependentPlaybackConfig();
-    method TIRAMISU_0 @hiddenOnly void setIndependentPlaybackConfig(boolean independent);
-interface CarMediaManager.MediaSourceChangedListener package android.car.media
-    method TIRAMISU_0 void onMediaSourceChanged(ComponentName componentName);
-class @hide @SystemApi CarAudioPatchHandle package android.car.media
-    field TIRAMISU_0 Parcelable.Creator<CarAudioPatchHandle> CREATOR;
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(Parcel out, int flags);
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 @hiddenOnly String getSourceAddress();
-    method TIRAMISU_0 @hiddenOnly String getSinkAddress();
-    method TIRAMISU_0 @hiddenOnly int getHandleId();
-class CarAudioManager package android.car.media
-    field TIRAMISU_0 int PRIMARY_AUDIO_ZONE = 0x0;
-    field TIRAMISU_0 int INVALID_AUDIO_ZONE = 0xffffffff;
-    field TIRAMISU_0 int AUDIO_FEATURE_DYNAMIC_ROUTING = 0x1;
-    field TIRAMISU_0 int AUDIO_FEATURE_VOLUME_GROUP_MUTING = 0x2;
-    field TIRAMISU_0 @hiddenOnly int INVALID_VOLUME_GROUP_ID = -1;
-    field TIRAMISU_0 String AUDIOFOCUS_EXTRA_RECEIVE_DUCKING_EVENTS = "android.car.media.AUDIOFOCUS_EXTRA_RECEIVE_DUCKING_EVENTS";
-    field TIRAMISU_0 @hiddenOnly String AUDIOFOCUS_EXTRA_REQUEST_ZONE_ID = "android.car.media.AUDIOFOCUS_EXTRA_REQUEST_ZONE_ID";
-    method TIRAMISU_0 @hiddenOnly boolean isDynamicRoutingEnabled();
-    method TIRAMISU_0 boolean isAudioFeatureEnabled(int audioFeature);
-    method TIRAMISU_0 void setGroupVolume(int groupId, int index, int flags);
-    method TIRAMISU_0 void setGroupVolume(int zoneId, int groupId, int index, int flags);
-    method TIRAMISU_0 int getGroupMaxVolume(int groupId);
-    method TIRAMISU_0 int getGroupMaxVolume(int zoneId, int groupId);
-    method TIRAMISU_0 int getGroupMinVolume(int groupId);
-    method TIRAMISU_0 int getGroupMinVolume(int zoneId, int groupId);
-    method TIRAMISU_0 int getGroupVolume(int groupId);
-    method TIRAMISU_0 int getGroupVolume(int zoneId, int groupId);
-    method TIRAMISU_0 void setFadeTowardFront(float value);
-    method TIRAMISU_0 void setBalanceTowardRight(float value);
-    method TIRAMISU_0 String[] getExternalSources();
-    method TIRAMISU_0 CarAudioPatchHandle createAudioPatch(String sourceAddress, int usage, int gainInMillibels);
-    method TIRAMISU_0 void releaseAudioPatch(CarAudioPatchHandle patch);
-    method TIRAMISU_0 int getVolumeGroupCount();
-    method TIRAMISU_0 int getVolumeGroupCount(int zoneId);
-    method TIRAMISU_0 int getVolumeGroupIdForUsage(int usage);
-    method TIRAMISU_0 int getVolumeGroupIdForUsage(int zoneId, int usage);
-    method TIRAMISU_0 int[] getUsagesForVolumeGroupId(int groupId);
-    method TIRAMISU_0 int[] getUsagesForVolumeGroupId(int zoneId, int groupId);
-    method TIRAMISU_0 boolean isPlaybackOnVolumeGroupActive(int zoneId, int groupId);
-    method TIRAMISU_0 List<Integer> getAudioZoneIds();
-    method TIRAMISU_0 @hiddenOnly int getZoneIdForUid(int uid);
-    method TIRAMISU_0 @hiddenOnly boolean setZoneIdForUid(int zoneId, int uid);
-    method TIRAMISU_0 @hiddenOnly boolean clearZoneIdForUid(int uid);
-    method TIRAMISU_0 AudioDeviceInfo getOutputDeviceForUsage(int zoneId, int usage);
-    method TIRAMISU_0 List<AudioDeviceInfo> getInputDevicesForZoneId(int zoneId);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 void registerCarVolumeCallback(CarVolumeCallback callback);
-    method TIRAMISU_0 void unregisterCarVolumeCallback(CarVolumeCallback callback);
-    method TIRAMISU_0 boolean isVolumeGroupMuted(int zoneId, int groupId);
-    method TIRAMISU_0 void setVolumeGroupMute(int zoneId, int groupId, boolean mute, int flags);
-class CarAudioManager.CarVolumeCallback package android.car.media
-    method TIRAMISU_0 void onGroupVolumeChanged(int zoneId, int groupId, int flags);
-    method TIRAMISU_0 void onMasterMuteChanged(int zoneId, int flags);
-    method TIRAMISU_0 void onGroupMuteChanged(int zoneId, int groupId, int flags);
-class CarMediaIntents package android.car.media
-    field TIRAMISU_0 String ACTION_MEDIA_TEMPLATE = "android.car.intent.action.MEDIA_TEMPLATE";
-    field TIRAMISU_0 String EXTRA_MEDIA_COMPONENT = "android.car.intent.extra.MEDIA_COMPONENT";
-    field TIRAMISU_0 String EXTRA_SEARCH_QUERY = "android.car.media.extra.SEARCH_QUERY";
-class @hide @SystemApi CarAppBlockingPolicy package android.car.content.pm
-    field TIRAMISU_0 AppBlockingPackageInfo[] whitelists;
-    field TIRAMISU_0 AppBlockingPackageInfo[] blacklists;
-    field TIRAMISU_0 Parcelable.Creator<CarAppBlockingPolicy> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 boolean equals(Object obj);
-    method TIRAMISU_0 String toString();
-class CarPackageManager package android.car.content.pm
-    field TIRAMISU_0 int FLAG_SET_POLICY_WAIT_FOR_CHANGE = 0x1;
-    field TIRAMISU_0 int FLAG_SET_POLICY_ADD = 0x2;
-    field TIRAMISU_0 int FLAG_SET_POLICY_REMOVE = 0x4;
-    field TIRAMISU_0 @hiddenOnly String BLOCKING_INTENT_EXTRA_BLOCKED_ACTIVITY_NAME = "blocked_activity";
-    field TIRAMISU_0 @hiddenOnly String BLOCKING_INTENT_EXTRA_BLOCKED_TASK_ID = "blocked_task_id";
-    field TIRAMISU_0 @hiddenOnly String BLOCKING_INTENT_EXTRA_ROOT_ACTIVITY_NAME = "root_activity_name";
-    field TIRAMISU_0 @hiddenOnly String BLOCKING_INTENT_EXTRA_IS_ROOT_ACTIVITY_DO = "is_root_activity_do";
-    field TIRAMISU_0 @hiddenOnly String BLOCKING_INTENT_EXTRA_DISPLAY_ID = "display_id";
-    field TIRAMISU_0 @hiddenOnly String DRIVING_SAFETY_REGION_ALL = "android.car.drivingsafetyregion.all";
-    field TIRAMISU_0 @hiddenOnly String DRIVING_SAFETY_ACTIVITY_METADATA_REGIONS = "android.car.drivingsafetyregions";
-    field TIRAMISU_0 @hiddenOnly int ERROR_CODE_NO_PACKAGE = -100;
-    field TIRAMISU_1 String MANIFEST_METADATA_TARGET_CAR_VERSION = "android.car.targetCarVersion";
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 void setAppBlockingPolicy(String packageName, CarAppBlockingPolicy policy, int flags);
-    method TIRAMISU_0 @hiddenOnly void restartTask(int taskId);
-    method TIRAMISU_0 boolean isActivityBackedBySafeActivity(ComponentName activityName);
-    method TIRAMISU_0 @hiddenOnly void setEnableActivityBlocking(boolean enable);
-    method TIRAMISU_0 boolean isActivityDistractionOptimized(String packageName, String className);
-    method TIRAMISU_0 boolean isPendingIntentDistractionOptimized(PendingIntent pendingIntent);
-    method TIRAMISU_0 boolean isServiceDistractionOptimized(String packageName, String className);
-    method TIRAMISU_0 @hiddenOnly String getCurrentDrivingSafetyRegion();
-    method TIRAMISU_0 @hiddenOnly void controlTemporaryActivityBlockingBypassingAsUser(String packageName, String activityClassName, boolean bypass, int userId);
-    method TIRAMISU_0 @hiddenOnly List<String> getSupportedDrivingSafetyRegionsForActivityAsUser(String packageName, String activityClassName, int userId);
-    method TIRAMISU_1 CarVersion getTargetCarVersion(String packageName);
-    method TIRAMISU_1 CarVersion getTargetCarVersion();
-class @hide @SystemApi AppBlockingPackageInfo package android.car.content.pm
-    field TIRAMISU_0 String packageName;
-    field TIRAMISU_0 int FLAG_SYSTEM_APP = 0x1;
-    field TIRAMISU_0 int FLAG_WHOLE_ACTIVITY = 0x2;
-    field TIRAMISU_0 int flags;
-    field TIRAMISU_0 int minRevisionCode;
-    field TIRAMISU_0 int maxRevisionCode;
-    field TIRAMISU_0 Signature[] signatures;
-    field TIRAMISU_0 String[] activities;
-    field TIRAMISU_0 Parcelable.Creator<AppBlockingPackageInfo> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly void verify();
-    method TIRAMISU_0 @hiddenOnly boolean isActivityCovered(String className);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 boolean equals(Object obj);
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi CarAppBlockingPolicyService package android.car.content.pm
-    field TIRAMISU_0 String SERVICE_INTERFACE = "android.car.content.pm.CarAppBlockingPolicyService";
-    method TIRAMISU_0 CarAppBlockingPolicy getAppBlockingPolicy();
-    method TIRAMISU_0 int onStartCommand(Intent intent, int flags, int startId);
-    method TIRAMISU_0 IBinder onBind(Intent intent);
-    method TIRAMISU_0 boolean onUnbind(Intent intent);
-class VehicleAreaSeat package android.car
-    field TIRAMISU_0 int SEAT_UNKNOWN = 0;
-    field TIRAMISU_0 int SEAT_ROW_1_LEFT = 0x0001;
-    field TIRAMISU_0 int SEAT_ROW_1_CENTER = 0x0002;
-    field TIRAMISU_0 int SEAT_ROW_1_RIGHT = 0x0004;
-    field TIRAMISU_0 int SEAT_ROW_2_LEFT = 0x0010;
-    field TIRAMISU_0 int SEAT_ROW_2_CENTER = 0x0020;
-    field TIRAMISU_0 int SEAT_ROW_2_RIGHT = 0x0040;
-    field TIRAMISU_0 int SEAT_ROW_3_LEFT = 0x0100;
-    field TIRAMISU_0 int SEAT_ROW_3_CENTER = 0x0200;
-    field TIRAMISU_0 int SEAT_ROW_3_RIGHT = 0x0400;
-    field TIRAMISU_0 @hiddenOnly int SIDE_LEFT = -1;
-    field TIRAMISU_0 @hiddenOnly int SIDE_CENTER = 0;
-    field TIRAMISU_0 @hiddenOnly int SIDE_RIGHT = 1;
-    method TIRAMISU_0 @hiddenOnly int fromRowAndSide(int rowNumber, int side);
-class CarOccupantZoneManager package android.car
-    field TIRAMISU_0 int DISPLAY_TYPE_UNKNOWN = 0;
-    field TIRAMISU_0 int DISPLAY_TYPE_MAIN = 1;
-    field TIRAMISU_0 int DISPLAY_TYPE_INSTRUMENT_CLUSTER = 2;
-    field TIRAMISU_0 int DISPLAY_TYPE_HUD = 3;
-    field TIRAMISU_0 int DISPLAY_TYPE_INPUT = 4;
-    field TIRAMISU_0 int DISPLAY_TYPE_AUXILIARY = 5;
-    field TIRAMISU_0 @hiddenOnly int OCCUPANT_TYPE_INVALID = -1;
-    field TIRAMISU_0 int OCCUPANT_TYPE_DRIVER = 0;
-    field TIRAMISU_0 int OCCUPANT_TYPE_FRONT_PASSENGER = 1;
-    field TIRAMISU_0 int OCCUPANT_TYPE_REAR_PASSENGER = 2;
-    field TIRAMISU_0 int ZONE_CONFIG_CHANGE_FLAG_DISPLAY = 0x1;
-    field TIRAMISU_0 int ZONE_CONFIG_CHANGE_FLAG_USER = 0x2;
-    field TIRAMISU_0 int ZONE_CONFIG_CHANGE_FLAG_AUDIO = 0x4;
-    method TIRAMISU_0 List<OccupantZoneInfo> getAllOccupantZones();
-    method TIRAMISU_0 List<Display> getAllDisplaysForOccupant(OccupantZoneInfo occupantZone);
-    method TIRAMISU_0 Display getDisplayForOccupant(OccupantZoneInfo occupantZone, int displayType);
-    method TIRAMISU_0 int getDisplayIdForDriver(int displayType);
-    method TIRAMISU_0 int getAudioZoneIdForOccupant(OccupantZoneInfo occupantZone);
-    method TIRAMISU_0 OccupantZoneInfo getOccupantForAudioZoneId(int audioZoneId);
-    method TIRAMISU_0 int getDisplayType(Display display);
-    method TIRAMISU_0 int getUserForOccupant(OccupantZoneInfo occupantZone);
-    method TIRAMISU_0 @hiddenOnly boolean assignProfileUserToOccupantZone(OccupantZoneInfo occupantZone, int userId);
-    method TIRAMISU_0 void registerOccupantZoneConfigChangeListener(OccupantZoneConfigChangeListener listener);
-    method TIRAMISU_0 void unregisterOccupantZoneConfigChangeListener(OccupantZoneConfigChangeListener listener);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-class CarOccupantZoneManager.OccupantZoneInfo package android.car
-    field TIRAMISU_0 @hiddenOnly int INVALID_ZONE_ID = -1;
-    field TIRAMISU_0 int zoneId;
-    field TIRAMISU_0 int occupantType;
-    field TIRAMISU_0 int seat;
-    field TIRAMISU_0 Parcelable.Creator<OccupantZoneInfo> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 boolean equals(Object other);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 String toString();
-interface CarOccupantZoneManager.OccupantZoneConfigChangeListener package android.car
-    method TIRAMISU_0 void onOccupantZoneConfigChanged(int changeFlags);
-class @hiddenOnly @hide VehicleSeatOccupancyState package android.car
-    field TIRAMISU_0 int UNKNOWN = 0;
-    field TIRAMISU_0 int VACANT = 1;
-    field TIRAMISU_0 int OCCUPIED = 2;
-class VehicleGear package android.car
-    field TIRAMISU_0 int GEAR_UNKNOWN = 0x0000;
-    field TIRAMISU_0 int GEAR_NEUTRAL = 0x0001;
-    field TIRAMISU_0 int GEAR_REVERSE = 0x0002;
-    field TIRAMISU_0 int GEAR_PARK = 0x0004;
-    field TIRAMISU_0 int GEAR_DRIVE = 0x0008;
-    field TIRAMISU_0 int GEAR_FIRST = 0x0010;
-    field TIRAMISU_0 int GEAR_SECOND = 0x0020;
-    field TIRAMISU_0 int GEAR_THIRD = 0x0040;
-    field TIRAMISU_0 int GEAR_FOURTH = 0x0080;
-    field TIRAMISU_0 int GEAR_FIFTH = 0x0100;
-    field TIRAMISU_0 int GEAR_SIXTH = 0x0200;
-    field TIRAMISU_0 int GEAR_SEVENTH = 0x0400;
-    field TIRAMISU_0 int GEAR_EIGHTH = 0x0800;
-    field TIRAMISU_0 int GEAR_NINTH = 0x1000;
-    method TIRAMISU_0 String toString(int o);
-class EvConnectorType package android.car
-    field TIRAMISU_0 int UNKNOWN = 0;
-    field TIRAMISU_0 int J1772 = 1;
-    field TIRAMISU_0 int MENNEKES = 2;
-    field TIRAMISU_0 int CHADEMO = 3;
-    field TIRAMISU_0 int COMBO_1 = 4;
-    field TIRAMISU_0 int COMBO_2 = 5;
-    field TIRAMISU_0 int TESLA_ROADSTER = 6;
-    field TIRAMISU_0 int TESLA_HPWC = 7;
-    field TIRAMISU_0 int TESLA_SUPERCHARGER = 8;
-    field TIRAMISU_0 int GBT = 9;
-    field TIRAMISU_0 int GBT_DC = 10;
-    field TIRAMISU_0 int SCAME = 11;
-    field TIRAMISU_0 int OTHER = 101;
-class @hide @SystemApi CarUserManager package android.car.user
-    field TIRAMISU_0 @hiddenOnly String TAG = CarUserManager.class.getSimpleName();
-    field TIRAMISU_0 int USER_LIFECYCLE_EVENT_TYPE_STARTING = CommonConstants.USER_LIFECYCLE_EVENT_TYPE_STARTING;
-    field TIRAMISU_0 int USER_LIFECYCLE_EVENT_TYPE_SWITCHING = CommonConstants.USER_LIFECYCLE_EVENT_TYPE_SWITCHING;
-    field TIRAMISU_0 int USER_LIFECYCLE_EVENT_TYPE_UNLOCKING = CommonConstants.USER_LIFECYCLE_EVENT_TYPE_UNLOCKING;
-    field TIRAMISU_0 int USER_LIFECYCLE_EVENT_TYPE_UNLOCKED = CommonConstants.USER_LIFECYCLE_EVENT_TYPE_UNLOCKED;
-    field TIRAMISU_0 @hiddenOnly int USER_LIFECYCLE_EVENT_TYPE_POST_UNLOCKED = CommonConstants.USER_LIFECYCLE_EVENT_TYPE_POST_UNLOCKED;
-    field TIRAMISU_0 int USER_LIFECYCLE_EVENT_TYPE_STOPPING = CommonConstants.USER_LIFECYCLE_EVENT_TYPE_STOPPING;
-    field TIRAMISU_0 int USER_LIFECYCLE_EVENT_TYPE_STOPPED = CommonConstants.USER_LIFECYCLE_EVENT_TYPE_STOPPED;
-    field TIRAMISU_1 int USER_LIFECYCLE_EVENT_TYPE_CREATED = CommonConstants.USER_LIFECYCLE_EVENT_TYPE_CREATED;
-    field TIRAMISU_0 @hiddenOnly String BUNDLE_PARAM_ACTION = "action";
-    field TIRAMISU_0 @hiddenOnly String BUNDLE_PARAM_PREVIOUS_USER_ID = "previous_user";
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_TYPE_KEY_FOB = 1;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_1 = 101;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_2 = 102;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_3 = 103;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_TYPE_CUSTOM_4 = 104;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_ASSOCIATE_CURRENT_USER = 1;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_DISASSOCIATE_CURRENT_USER = 2;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_SET_VALUE_DISASSOCIATE_ALL_USERS = 3;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_VALUE_UNKNOWN = 1;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_VALUE_ASSOCIATE_CURRENT_USER = 2;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_VALUE_ASSOCIATED_ANOTHER_USER = 3;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION_VALUE_NOT_ASSOCIATED_ANY_USER = 4;
-    method TIRAMISU_0 @hiddenOnly AsyncFuture<UserSwitchResult> switchUser(int targetUserId);
-    method TIRAMISU_0 @hiddenOnly AsyncFuture<UserSwitchResult> logoutUser();
-    method TIRAMISU_0 @hiddenOnly AsyncFuture<UserCreationResult> createGuest(String name);
-    method TIRAMISU_0 @hiddenOnly AsyncFuture<UserCreationResult> createUser(String name, int flags);
-    method TIRAMISU_0 @hiddenOnly void updatePreCreatedUsers();
-    method TIRAMISU_0 @hiddenOnly UserRemovalResult removeUser(int userId);
-    method TIRAMISU_0 void addListener(Executor executor, UserLifecycleListener listener);
-    method TIRAMISU_0 void addListener(Executor executor, UserLifecycleEventFilter filter, UserLifecycleListener listener);
-    method TIRAMISU_0 void removeListener(UserLifecycleListener listener);
-    method TIRAMISU_0 @hiddenOnly boolean isUserHalUserAssociationSupported();
-    method TIRAMISU_0 @hiddenOnly UserIdentificationAssociationResponse getUserIdentificationAssociation(int types);
-    method TIRAMISU_0 @hiddenOnly AsyncFuture<UserIdentificationAssociationResponse> setUserIdentificationAssociation(int[] types, int[] values);
-    method TIRAMISU_0 @hiddenOnly void setUserSwitchUiCallback(UserSwitchUiCallback callback);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 @hiddenOnly String lifecycleEventTypeToString(int type);
-    method TIRAMISU_0 @hiddenOnly boolean isValidUser(int userId);
-class @hide @SystemApi CarUserManager.UserLifecycleEvent package android.car.user
-    method TIRAMISU_0 int getEventType();
-    method TIRAMISU_0 @hiddenOnly int getUserId();
-    method TIRAMISU_0 UserHandle getUserHandle();
-    method TIRAMISU_0 @hiddenOnly int getPreviousUserId();
-    method TIRAMISU_0 UserHandle getPreviousUserHandle();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-interface @hide @SystemApi CarUserManager.UserLifecycleListener package android.car.user
-    method TIRAMISU_0 void onEvent(UserLifecycleEvent event);
-interface @hiddenOnly @hide CarUserManager.UserSwitchUiCallback package android.car.user
-    method TIRAMISU_0 void showUserSwitchDialog(int userId);
-class @hiddenOnly @hide ExperimentalCarUserManager package android.car.user
-    field TIRAMISU_0 @hiddenOnly String TAG = ExperimentalCarUserManager.class.getSimpleName();
-    method TIRAMISU_0 @hiddenOnly AndroidFuture<UserCreationResult> createDriver(String name, boolean admin);
-    method TIRAMISU_0 @hiddenOnly int createPassenger(String name, int driverId);
-    method TIRAMISU_0 @hiddenOnly AndroidFuture<UserSwitchResult> switchDriver(int driverId);
-    method TIRAMISU_0 @hiddenOnly List<Integer> getAllDrivers();
-    method TIRAMISU_0 @hiddenOnly List<Integer> getPassengers(int driverId);
-    method TIRAMISU_0 @hiddenOnly boolean startPassenger(int passengerId, int zoneId);
-    method TIRAMISU_0 @hiddenOnly boolean stopPassenger(int passengerId);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-class @hiddenOnly @hide UserStopResult package android.car.user
-    field TIRAMISU_0 int STATUS_SUCCESSFUL = CommonResults.STATUS_SUCCESSFUL;
-    field TIRAMISU_0 int STATUS_ANDROID_FAILURE = CommonResults.STATUS_ANDROID_FAILURE;
-    field TIRAMISU_0 int STATUS_USER_DOES_NOT_EXIST = CommonResults.LAST_COMMON_STATUS + 1;
-    field TIRAMISU_0 int STATUS_FAILURE_SYSTEM_USER = CommonResults.LAST_COMMON_STATUS + 2;
-    field TIRAMISU_0 int STATUS_FAILURE_CURRENT_USER = CommonResults.LAST_COMMON_STATUS + 3;
-    field TIRAMISU_0 Parcelable.Creator<UserStopResult> CREATOR;
-    method TIRAMISU_0 boolean isSuccess(int status);
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 @hiddenOnly String statusToString(int value);
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide UserCreationResult package android.car.user
-    field TIRAMISU_0 @hiddenOnly int STATUS_SUCCESSFUL = CommonResults.STATUS_SUCCESSFUL;
-    field TIRAMISU_0 @hiddenOnly int STATUS_ANDROID_FAILURE = CommonResults.STATUS_ANDROID_FAILURE;
-    field TIRAMISU_0 @hiddenOnly int STATUS_HAL_FAILURE = CommonResults.STATUS_HAL_FAILURE;
-    field TIRAMISU_0 @hiddenOnly int STATUS_HAL_INTERNAL_FAILURE = CommonResults.STATUS_HAL_INTERNAL_FAILURE;
-    field TIRAMISU_0 int STATUS_INVALID_REQUEST = CommonResults.STATUS_INVALID_REQUEST;
-    field TIRAMISU_0 Parcelable.Creator<UserCreationResult> CREATOR;
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 @hiddenOnly String statusToString(int value);
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 Integer getAndroidFailureStatus();
-    method TIRAMISU_0 UserHandle getUser();
-    method TIRAMISU_0 String getErrorMessage();
-    method TIRAMISU_0 @hiddenOnly String getInternalErrorMessage();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-class @hiddenOnly @hide UserRemovalResult package android.car.user
-    field TIRAMISU_0 int STATUS_SUCCESSFUL = CommonResults.STATUS_SUCCESSFUL;
-    field TIRAMISU_0 int STATUS_ANDROID_FAILURE = CommonResults.STATUS_ANDROID_FAILURE;
-    field TIRAMISU_0 int STATUS_INVALID_REQUEST = CommonResults.STATUS_INVALID_REQUEST;
-    field TIRAMISU_0 int STATUS_USER_DOES_NOT_EXIST = CommonResults.LAST_COMMON_STATUS + 1;
-    field TIRAMISU_0 int STATUS_SUCCESSFUL_LAST_ADMIN_REMOVED = CommonResults.LAST_COMMON_STATUS + 2;
-    field TIRAMISU_0 int STATUS_SUCCESSFUL_SET_EPHEMERAL = CommonResults.LAST_COMMON_STATUS + 3;
-    field TIRAMISU_0 int STATUS_SUCCESSFUL_LAST_ADMIN_SET_EPHEMERAL = CommonResults.LAST_COMMON_STATUS + 4;
-    field TIRAMISU_0 Parcelable.Creator<UserRemovalResult> CREATOR;
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 @hiddenOnly String statusToString(int value);
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class CommonResults package android.car.user
-    field TIRAMISU_0 int STATUS_SUCCESSFUL = 1;
-    field TIRAMISU_0 int STATUS_ANDROID_FAILURE = 2;
-    field TIRAMISU_0 int STATUS_HAL_FAILURE = 3;
-    field TIRAMISU_0 int STATUS_HAL_INTERNAL_FAILURE = 4;
-    field TIRAMISU_0 int STATUS_INVALID_REQUEST = 5;
-    field TIRAMISU_0 int STATUS_UX_RESTRICTION_FAILURE = 6;
-    field TIRAMISU_0 int LAST_COMMON_STATUS = 100;
-interface @hiddenOnly @hide OperationResult package android.car.user
-    method TIRAMISU_0 boolean isSuccess();
-class @hide @SystemApi UserLifecycleEventFilter package android.car.user
-    field TIRAMISU_0 Parcelable.Creator<UserLifecycleEventFilter> CREATOR;
-    method TIRAMISU_0 @hiddenOnly int[] getEventTypes();
-    method TIRAMISU_0 @hiddenOnly int[] getUserIds();
-    method TIRAMISU_0 boolean apply(UserLifecycleEvent event);
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide UserLifecycleEventFilter.Builder package android.car.user
-    method TIRAMISU_0 Builder addEventType(int eventType);
-    method TIRAMISU_0 Builder addUser(UserHandle userHandle);
-    method TIRAMISU_0 UserLifecycleEventFilter build();
-class @hiddenOnly @hide UserStartResult package android.car.user
-    field TIRAMISU_0 @hiddenOnly int STATUS_SUCCESSFUL = CommonResults.STATUS_SUCCESSFUL;
-    field TIRAMISU_0 @hiddenOnly int STATUS_ANDROID_FAILURE = CommonResults.STATUS_ANDROID_FAILURE;
-    field TIRAMISU_0 @hiddenOnly int STATUS_SUCCESSFUL_USER_IS_CURRENT_USER = CommonResults.LAST_COMMON_STATUS + 1;
-    field TIRAMISU_0 @hiddenOnly int STATUS_USER_DOES_NOT_EXIST = CommonResults.LAST_COMMON_STATUS + 2;
-    field TIRAMISU_0 Parcelable.Creator<UserStartResult> CREATOR;
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 @hiddenOnly String statusToString(int value);
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide UserIdentificationAssociationResponse package android.car.user
-    field TIRAMISU_0 Parcelable.Creator<UserIdentificationAssociationResponse> CREATOR;
-    method TIRAMISU_0 UserIdentificationAssociationResponse forFailure();
-    method TIRAMISU_0 UserIdentificationAssociationResponse forFailure(String errorMessage);
-    method TIRAMISU_0 UserIdentificationAssociationResponse forSuccess(int[] values);
-    method TIRAMISU_0 UserIdentificationAssociationResponse forSuccess(int[] values, String errorMessage);
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 String getErrorMessage();
-    method TIRAMISU_0 int[] getValues();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide UserSwitchResult package android.car.user
-    field TIRAMISU_0 int STATUS_SUCCESSFUL = CommonResults.STATUS_SUCCESSFUL;
-    field TIRAMISU_0 int STATUS_ANDROID_FAILURE = CommonResults.STATUS_ANDROID_FAILURE;
-    field TIRAMISU_0 int STATUS_HAL_FAILURE = CommonResults.STATUS_HAL_FAILURE;
-    field TIRAMISU_0 int STATUS_HAL_INTERNAL_FAILURE = CommonResults.STATUS_HAL_INTERNAL_FAILURE;
-    field TIRAMISU_0 int STATUS_INVALID_REQUEST = CommonResults.STATUS_INVALID_REQUEST;
-    field TIRAMISU_0 int STATUS_UX_RESTRICTION_FAILURE = CommonResults.STATUS_UX_RESTRICTION_FAILURE;
-    field TIRAMISU_0 int STATUS_OK_USER_ALREADY_IN_FOREGROUND = CommonResults.LAST_COMMON_STATUS + 1;
-    field TIRAMISU_0 int STATUS_TARGET_USER_ALREADY_BEING_SWITCHED_TO = CommonResults.LAST_COMMON_STATUS + 2;
-    field TIRAMISU_0 int STATUS_TARGET_USER_ABANDONED_DUE_TO_A_NEW_REQUEST = CommonResults.LAST_COMMON_STATUS + 3;
-    field TIRAMISU_0 int STATUS_NOT_SWITCHABLE = CommonResults.LAST_COMMON_STATUS + 4;
-    field TIRAMISU_0 int STATUS_NOT_LOGGED_IN = CommonResults.LAST_COMMON_STATUS + 5;
-    field TIRAMISU_0 Parcelable.Creator<UserSwitchResult> CREATOR;
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 @hiddenOnly String statusToString(int value);
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 @hiddenOnly Integer getAndroidFailureStatus();
-    method TIRAMISU_0 String getErrorMessage();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-class @hiddenOnly @hide VehicleLightState package android.car
-    field TIRAMISU_0 int OFF = 0;
-    field TIRAMISU_0 int ON = 1;
-    field TIRAMISU_0 int DAYTIME_RUNNING = 2;
-class @hiddenOnly @hide CarLibLog package android.car
-    field TIRAMISU_0 String TAG_CAR = "CAR.L";
-    field TIRAMISU_0 String TAG_CLUSTER = TAG_CAR + ".CLUSTER";
-    field TIRAMISU_0 String TAG_INPUT = TAG_CAR + ".INPUT";
-    field TIRAMISU_0 String TAG_NAV = TAG_CAR + ".NAV";
-    field TIRAMISU_0 String TAG_SENSOR = TAG_CAR + ".SENSOR";
-    field TIRAMISU_0 String TAG_DIAGNOSTIC = TAG_CAR + ".DIAGNOSTIC";
-class @hiddenOnly @hide VehicleHvacFanDirection package android.car
-    field TIRAMISU_0 int FACE = 0x1;
-    field TIRAMISU_0 int FLOOR = 0x2;
-    field TIRAMISU_0 int DEFROST = 0x4;
-class @hiddenOnly @hide CarLocationTestHelper package android.car.test
-    method TIRAMISU_0 @hiddenOnly boolean injectLocation(Location location, Context context);
-class @hiddenOnly @hide CarTestManager package android.car.test
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 @hiddenOnly void stopCarService(IBinder token);
-    method TIRAMISU_0 @hiddenOnly void startCarService(IBinder token);
-class VehicleAreaType package android.car
-    field TIRAMISU_0 int VEHICLE_AREA_TYPE_GLOBAL = 0;
-    field TIRAMISU_0 int VEHICLE_AREA_TYPE_WINDOW = 2;
-    field TIRAMISU_0 int VEHICLE_AREA_TYPE_SEAT = 3;
-    field TIRAMISU_0 int VEHICLE_AREA_TYPE_DOOR = 4;
-    field TIRAMISU_0 int VEHICLE_AREA_TYPE_MIRROR = 5;
-    field TIRAMISU_0 int VEHICLE_AREA_TYPE_WHEEL = 6;
-class ApiVersion package android.car
-    method TIRAMISU_1 boolean isAtLeast(T requiredVersion);
-    method TIRAMISU_1 int getMajorVersion();
-    method TIRAMISU_1 int getMinorVersion();
-    method TIRAMISU_1 @hiddenOnly boolean equals(Object obj);
-    method TIRAMISU_1 @hiddenOnly int hashCode();
-    method TIRAMISU_1 @hiddenOnly String toString();
-    method TIRAMISU_1 @hiddenOnly void writeToParcel(Parcel dest);
-    method TIRAMISU_1 @hiddenOnly T readFromParcel(Parcel source, ApiVersionFactory<T> factory);
-interface @hiddenOnly @hide ApiVersion.ApiVersionFactory package android.car
-    method  T forMajorAndMinor(int major, int minor);
-class PlatformVersion package android.car
-    field TIRAMISU_1 Parcelable.Creator<PlatformVersion> CREATOR;
-    method TIRAMISU_1 PlatformVersion forMajorAndMinorVersions(int majorVersion, int minorVersion);
-    method TIRAMISU_1 PlatformVersion forMajorVersion(int majorVersion);
-    method TIRAMISU_1 int describeContents();
-    method TIRAMISU_1 void writeToParcel(Parcel dest, int flags);
-class PlatformVersion.VERSION_CODES package android.car
-    field TIRAMISU_1 PlatformVersion TIRAMISU_0 = forMajorAndMinorVersions(Build.VERSION_CODES.TIRAMISU, 0);
-    field TIRAMISU_1 PlatformVersion TIRAMISU_1 = forMajorAndMinorVersions(Build.VERSION_CODES.TIRAMISU, 1);
-class @hide @SystemApi CarBugreportManager package android.car
-    method TIRAMISU_0 void requestBugreport(ParcelFileDescriptor output, ParcelFileDescriptor extraOutput, CarBugreportManagerCallback callback);
-    method TIRAMISU_0 @hiddenOnly void requestBugreportForTesting(ParcelFileDescriptor output, ParcelFileDescriptor extraOutput, CarBugreportManagerCallback callback);
-    method TIRAMISU_0 void cancelBugreport();
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-class CarBugreportManager.CarBugreportManagerCallback package android.car
-    field TIRAMISU_0 int CAR_BUGREPORT_DUMPSTATE_FAILED = 1;
-    field TIRAMISU_0 int CAR_BUGREPORT_IN_PROGRESS = 2;
-    field TIRAMISU_0 int CAR_BUGREPORT_DUMPSTATE_CONNECTION_FAILED = 3;
-    field TIRAMISU_0 int CAR_BUGREPORT_SERVICE_NOT_AVAILABLE = 4;
-    method TIRAMISU_0 void onProgress(float progress);
-    method TIRAMISU_0 void onError(int errorCode);
-    method TIRAMISU_0 void onFinished();
-class CarInfoManager package android.car
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_KEY_MANUFACTURER = 0x11100101;
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_KEY_MODEL = 0x11100102;
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_KEY_MODEL_YEAR = 0x11400103;
-    field TIRAMISU_0 @hiddenOnly String BASIC_INFO_KEY_VEHICLE_ID = "android.car.vehicle-id";
-    field TIRAMISU_0 @hiddenOnly String INFO_KEY_PRODUCT_CONFIGURATION = "android.car.product-config";
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_DRIVER_SEAT = 0x1540010a;
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_EV_PORT_LOCATION = 0x11400109;
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_FUEL_DOOR_LOCATION = 0x11400108;
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_FUEL_CAPACITY = 0x11600104;
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_FUEL_TYPES = 0x11410105;
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_EV_BATTERY_CAPACITY = 0x11600106;
-    field TIRAMISU_0 @hiddenOnly int BASIC_INFO_EV_CONNECTOR_TYPES = 0x11410107;
-    method TIRAMISU_0 String getManufacturer();
-    method TIRAMISU_0 String getModel();
-    method TIRAMISU_0 String getModelYear();
-    method TIRAMISU_0 int getModelYearInInteger();
-    method TIRAMISU_0 String getVehicleId();
-    method TIRAMISU_0 float getFuelCapacity();
-    method TIRAMISU_0 int[] getFuelTypes();
-    method TIRAMISU_0 float getEvBatteryCapacity();
-    method TIRAMISU_0 int[] getEvConnectorTypes();
-    method TIRAMISU_0 int getDriverSeat();
-    method TIRAMISU_0 int getEvPortLocation();
-    method TIRAMISU_0 int getFuelDoorLocation();
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-class @hide @SystemApi CarSettings package android.car.settings
-    field TIRAMISU_0 @hiddenOnly int[] DEFAULT_GARAGE_MODE_WAKE_UP_TIME = { 0, 0 };
-    field TIRAMISU_0 @hiddenOnly int DEFAULT_GARAGE_MODE_MAINTENANCE_WINDOW = 10 * 60 * 1000;
-class @hiddenOnly @hide CarSettings.Global package android.car.settings
-    field TIRAMISU_0 @hiddenOnly String DEFAULT_USER_RESTRICTIONS_SET = "android.car.DEFAULT_USER_RESTRICTIONS_SET";
-    field TIRAMISU_0 @hiddenOnly String DISABLE_INSTRUMENTATION_SERVICE = "android.car.DISABLE_INSTRUMENTATION_SERVICE";
-    field TIRAMISU_0 @hiddenOnly String ENABLE_USER_SWITCH_DEVELOPER_MESSAGE = "android.car.ENABLE_USER_SWITCH_DEVELOPER_MESSAGE";
-    field TIRAMISU_0 @hiddenOnly String LAST_ACTIVE_USER_ID = "android.car.LAST_ACTIVE_USER_ID";
-    field TIRAMISU_0 @hiddenOnly String LAST_ACTIVE_PERSISTENT_USER_ID = "android.car.LAST_ACTIVE_PERSISTENT_USER_ID";
-    field TIRAMISU_0 @hiddenOnly String SYSTEM_BAR_VISIBILITY_OVERRIDE = "android.car.SYSTEM_BAR_VISIBILITY_OVERRIDE";
-class @hide @SystemApi CarSettings.Secure package android.car.settings
-    field TIRAMISU_0 String KEY_AUDIO_FOCUS_NAVIGATION_REJECTED_DURING_CALL = "android.car.KEY_AUDIO_FOCUS_NAVIGATION_REJECTED_DURING_CALL";
-    field TIRAMISU_0 String KEY_AUDIO_PERSIST_VOLUME_GROUP_MUTE_STATES = "android.car.KEY_AUDIO_PERSIST_VOLUME_GROUP_MUTE_STATES";
-    field TIRAMISU_0 @hiddenOnly String KEY_BLUETOOTH_DEVICES = "android.car.KEY_BLUETOOTH_DEVICES";
-    field TIRAMISU_0 @hiddenOnly String KEY_BLUETOOTH_PROFILES_INHIBITED = "android.car.BLUETOOTH_PROFILES_INHIBITED";
-    field TIRAMISU_0 String KEY_ROTARY_KEY_EVENT_FILTER = "android.car.ROTARY_KEY_EVENT_FILTER";
-    field TIRAMISU_0 String KEY_ENABLE_INITIAL_NOTICE_SCREEN_TO_USER = "android.car.ENABLE_INITIAL_NOTICE_SCREEN_TO_USER";
-    field TIRAMISU_0 String KEY_SETUP_WIZARD_IN_PROGRESS = "android.car.SETUP_WIZARD_IN_PROGRESS";
-    field TIRAMISU_0 String KEY_PACKAGES_DISABLED_ON_RESOURCE_OVERUSE = "android.car.KEY_PACKAGES_DISABLED_ON_RESOURCE_OVERUSE";
-class @hide @SystemApi AoapService package android.car
-    field TIRAMISU_0 int RESULT_OK = 0;
-    field TIRAMISU_0 int RESULT_DEVICE_NOT_SUPPORTED = 1;
-    field TIRAMISU_0 int RESULT_DO_NOT_SWITCH_TO_AOAP = 2;
-    field TIRAMISU_0 @hiddenOnly int MSG_NEW_DEVICE_ATTACHED = 1;
-    field TIRAMISU_0 @hiddenOnly int MSG_NEW_DEVICE_ATTACHED_RESPONSE = 2;
-    field TIRAMISU_0 @hiddenOnly int MSG_CAN_SWITCH_TO_AOAP = 3;
-    field TIRAMISU_0 @hiddenOnly int MSG_CAN_SWITCH_TO_AOAP_RESPONSE = 4;
-    field TIRAMISU_0 @hiddenOnly String KEY_DEVICE = "usb-device";
-    field TIRAMISU_0 @hiddenOnly String KEY_RESULT = "result";
-    method TIRAMISU_0 int isDeviceSupported(UsbDevice device);
-    method TIRAMISU_0 int canSwitchToAoap(UsbDevice device);
-    method TIRAMISU_0 void onCreate();
-    method TIRAMISU_0 IBinder onBind(Intent intent);
-    method TIRAMISU_0 boolean onUnbind(Intent intent);
-    method TIRAMISU_0 void dump(FileDescriptor fd, PrintWriter writer, String[] args);
-class PlatformVersionMismatchException package android.car
-    field TIRAMISU_1 Parcelable.Creator<PlatformVersionMismatchException> CREATOR;
-    method TIRAMISU_1 String getMessage();
-    method TIRAMISU_1 PlatformVersion getExpectedPlatformApiVersion();
-    method TIRAMISU_1 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_1 int describeContents();
-class @hide @SystemApi VehiclePropertyAccess package android.car
-    field TIRAMISU_0 int NONE = 0x00;
-    field TIRAMISU_0 int READ = 0x01;
-    field TIRAMISU_0 int WRITE = 0x02;
-    field TIRAMISU_0 int READ_WRITE = 0x03;
-class VehicleIgnitionState package android.car
-    field TIRAMISU_0 int UNDEFINED = 0;
-    field TIRAMISU_0 int LOCK = 1;
-    field TIRAMISU_0 int OFF = 2;
-    field TIRAMISU_0 int ACC = 3;
-    field TIRAMISU_0 int ON = 4;
-    field TIRAMISU_0 int START = 5;
-    method TIRAMISU_0 String toString(int ignitionState);
-class @hide @SystemApi CarProjectionManager package android.car
-    field TIRAMISU_0 int PROJECTION_VOICE_SEARCH = 0x1;
-    field TIRAMISU_0 int PROJECTION_LONG_PRESS_VOICE_SEARCH = 0x2;
-    field TIRAMISU_0 int KEY_EVENT_VOICE_SEARCH_KEY_DOWN = 0;
-    field TIRAMISU_0 int KEY_EVENT_VOICE_SEARCH_SHORT_PRESS_KEY_UP = 1;
-    field TIRAMISU_0 int KEY_EVENT_VOICE_SEARCH_LONG_PRESS_KEY_DOWN = 2;
-    field TIRAMISU_0 int KEY_EVENT_VOICE_SEARCH_LONG_PRESS_KEY_UP = 3;
-    field TIRAMISU_0 int KEY_EVENT_CALL_KEY_DOWN = 4;
-    field TIRAMISU_0 int KEY_EVENT_CALL_SHORT_PRESS_KEY_UP = 5;
-    field TIRAMISU_0 int KEY_EVENT_CALL_LONG_PRESS_KEY_DOWN = 6;
-    field TIRAMISU_0 int KEY_EVENT_CALL_LONG_PRESS_KEY_UP = 7;
-    field TIRAMISU_0 @hiddenOnly int NUM_KEY_EVENTS = 8;
-    field TIRAMISU_0 @hiddenOnly int PROJECTION_AP_STARTED = 0;
-    field TIRAMISU_0 @hiddenOnly int PROJECTION_AP_STOPPED = 1;
-    field TIRAMISU_0 @hiddenOnly int PROJECTION_AP_FAILED = 2;
-    method TIRAMISU_0 @hiddenOnly void regsiterProjectionListener(CarProjectionListener listener, int voiceSearchFilter);
-    method TIRAMISU_0 void registerProjectionListener(CarProjectionListener listener, int voiceSearchFilter);
-    method TIRAMISU_0 @hiddenOnly void unregsiterProjectionListener();
-    method TIRAMISU_0 void unregisterProjectionListener();
-    method TIRAMISU_0 void addKeyEventHandler(Set<Integer> events, ProjectionKeyEventHandler eventHandler);
-    method TIRAMISU_0 void addKeyEventHandler(Set<Integer> events, Executor executor, ProjectionKeyEventHandler eventHandler);
-    method TIRAMISU_0 void removeKeyEventHandler(ProjectionKeyEventHandler eventHandler);
-    method TIRAMISU_0 void registerProjectionRunner(Intent serviceIntent);
-    method TIRAMISU_0 void unregisterProjectionRunner(Intent serviceIntent);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 void startProjectionAccessPoint(ProjectionAccessPointCallback callback);
-    method TIRAMISU_0 List<Integer> getAvailableWifiChannels(int band);
-    method TIRAMISU_0 void stopProjectionAccessPoint();
-    method TIRAMISU_0 boolean requestBluetoothProfileInhibit(BluetoothDevice device, int profile);
-    method TIRAMISU_0 boolean releaseBluetoothProfileInhibit(BluetoothDevice device, int profile);
-    method TIRAMISU_0 void updateProjectionStatus(ProjectionStatus status);
-    method TIRAMISU_0 void registerProjectionStatusListener(ProjectionStatusListener listener);
-    method TIRAMISU_0 void unregisterProjectionStatusListener(ProjectionStatusListener listener);
-    method TIRAMISU_0 Bundle getProjectionOptions();
-    method TIRAMISU_0 void resetProjectionAccessPointCredentials();
-interface CarProjectionManager.CarProjectionListener package android.car
-    method TIRAMISU_0 void onVoiceAssistantRequest(boolean fromLongPress);
-interface CarProjectionManager.ProjectionKeyEventHandler package android.car
-    method TIRAMISU_0 void onKeyEvent(int event);
-interface CarProjectionManager.ProjectionStatusListener package android.car
-    method TIRAMISU_0 void onProjectionStatusChanged(int state, String packageName, List<ProjectionStatus> details);
-class CarProjectionManager.ProjectionAccessPointCallback package android.car
-    field TIRAMISU_0 int ERROR_NO_CHANNEL = 1;
-    field TIRAMISU_0 int ERROR_GENERIC = 2;
-    field TIRAMISU_0 int ERROR_INCOMPATIBLE_MODE = 3;
-    field TIRAMISU_0 int ERROR_TETHERING_DISALLOWED = 4;
-    method TIRAMISU_0 void onStarted(WifiConfiguration wifiConfiguration);
-    method TIRAMISU_0 void onStarted(SoftApConfiguration softApConfiguration);
-    method TIRAMISU_0 void onStopped();
-    method TIRAMISU_0 void onFailed(int reason);
-class @hiddenOnly @hide StartUserInBackgroundResult package android.car.admin
-    field TIRAMISU_0 int STATUS_SUCCESS = 1;
-    field TIRAMISU_0 int STATUS_SUCCESS_CURRENT_USER = 2;
-    field TIRAMISU_0 int STATUS_FAILURE_USER_DOES_NOT_EXIST = 3;
-    field TIRAMISU_0 int STATUS_FAILURE_GENERIC = 100;
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi CarDevicePolicyManager package android.car.admin
-    field TIRAMISU_0 @hiddenOnly String TAG = CarDevicePolicyManager.class.getSimpleName();
-    field TIRAMISU_0 int USER_TYPE_REGULAR = 0;
-    field TIRAMISU_0 int USER_TYPE_ADMIN = 1;
-    field TIRAMISU_0 int USER_TYPE_GUEST = 2;
-    field TIRAMISU_0 @hiddenOnly int FIRST_USER_TYPE = USER_TYPE_REGULAR;
-    field TIRAMISU_0 @hiddenOnly int LAST_USER_TYPE = USER_TYPE_GUEST;
-    method TIRAMISU_0 RemoveUserResult removeUser(UserHandle user);
-    method TIRAMISU_0 CreateUserResult createUser(String name, int type);
-    method TIRAMISU_0 @hiddenOnly StartUserInBackgroundResult startUserInBackground(UserHandle user);
-    method TIRAMISU_0 @hiddenOnly StopUserResult stopUser(UserHandle user);
-    method TIRAMISU_0 @hiddenOnly void setUserDisclaimerShown(UserHandle user);
-    method TIRAMISU_0 @hiddenOnly void setUserDisclaimerAcknowledged(UserHandle user);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-class @hide @SystemApi RemoveUserResult package android.car.admin
-    field TIRAMISU_0 int STATUS_SUCCESS = 1;
-    field TIRAMISU_0 int STATUS_SUCCESS_LAST_ADMIN_REMOVED = 2;
-    field TIRAMISU_0 int STATUS_SUCCESS_SET_EPHEMERAL = 3;
-    field TIRAMISU_0 int STATUS_FAILURE_USER_DOES_NOT_EXIST = 4;
-    field TIRAMISU_0 int STATUS_FAILURE_INVALID_ARGUMENTS = 5;
-    field TIRAMISU_0 int STATUS_SUCCESS_LAST_ADMIN_SET_EPHEMERAL = 6;
-    field TIRAMISU_0 int STATUS_FAILURE_GENERIC = 100;
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 @hiddenOnly String statusToString(int status);
-class @hiddenOnly @hide StopUserResult package android.car.admin
-    field TIRAMISU_0 int STATUS_SUCCESS = 1;
-    field TIRAMISU_0 int STATUS_FAILURE_CURRENT_USER = 2;
-    field TIRAMISU_0 int STATUS_FAILURE_SYSTEM_USER = 3;
-    field TIRAMISU_0 int STATUS_FAILURE_USER_DOES_NOT_EXIST = 4;
-    field TIRAMISU_0 int STATUS_FAILURE_GENERIC = 100;
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi CreateUserResult package android.car.admin
-    field TIRAMISU_0 int STATUS_SUCCESS = 1;
-    field TIRAMISU_0 int STATUS_FAILURE_INVALID_ARGUMENTS = 2;
-    field TIRAMISU_0 int STATUS_FAILURE_GENERIC = 100;
-    method TIRAMISU_0 @hiddenOnly CreateUserResult forGenericError();
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 boolean isSuccess();
-    method TIRAMISU_0 UserHandle getUserHandle();
-    method TIRAMISU_0 String toString();
-class CarNotConnectedException package android.car
-class @hide @SystemApi IoStatsEntry package android.car.storagemonitoring
-    field TIRAMISU_0 Parcelable.Creator<IoStatsEntry> CREATOR;
-    field TIRAMISU_0 int uid;
-    field TIRAMISU_0 long runtimeMillis;
-    field TIRAMISU_0 IoStatsEntry.Metrics foreground;
-    field TIRAMISU_0 IoStatsEntry.Metrics background;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly void writeToJson(JsonWriter jsonWriter);
-    method TIRAMISU_0 @hiddenOnly IoStatsEntry delta(IoStatsEntry other);
-    method TIRAMISU_0 boolean equals(Object other);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 @hiddenOnly boolean representsSameMetrics(UidIoRecord record);
-class IoStatsEntry.Metrics package android.car.storagemonitoring
-    field TIRAMISU_0 Parcelable.Creator<IoStatsEntry.Metrics> CREATOR;
-    field TIRAMISU_0 long bytesRead;
-    field TIRAMISU_0 long bytesWritten;
-    field TIRAMISU_0 long bytesReadFromStorage;
-    field TIRAMISU_0 long bytesWrittenToStorage;
-    field TIRAMISU_0 long fsyncCalls;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly void writeToJson(JsonWriter jsonWriter);
-    method TIRAMISU_0 @hiddenOnly Metrics delta(Metrics other);
-    method TIRAMISU_0 boolean equals(Object other);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi IoStats package android.car.storagemonitoring
-    field TIRAMISU_0 Creator<IoStats> CREATOR;
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly void writeToJson(JsonWriter jsonWriter);
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 long getTimestamp();
-    method TIRAMISU_0 List<IoStatsEntry> getStats();
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 IoStatsEntry getUserIdStats(int uid);
-    method TIRAMISU_0 IoStatsEntry.Metrics getForegroundTotals();
-    method TIRAMISU_0 IoStatsEntry.Metrics getBackgroundTotals();
-    method TIRAMISU_0 IoStatsEntry.Metrics getTotals();
-    method TIRAMISU_0 boolean equals(Object other);
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi LifetimeWriteInfo package android.car.storagemonitoring
-    field TIRAMISU_0 Creator<IoStats> CREATOR;
-    field TIRAMISU_0 String partition;
-    field TIRAMISU_0 String fstype;
-    field TIRAMISU_0 long writtenBytes;
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly void writeToJson(JsonWriter jsonWriter);
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 boolean equals(Object other);
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi CarStorageMonitoringManager package android.car.storagemonitoring
-    field TIRAMISU_0 String INTENT_EXCESSIVE_IO = "android.car.storagemonitoring.EXCESSIVE_IO";
-    field TIRAMISU_0 int PRE_EOL_INFO_UNKNOWN = 0;
-    field TIRAMISU_0 int PRE_EOL_INFO_NORMAL = 1;
-    field TIRAMISU_0 int PRE_EOL_INFO_WARNING = 2;
-    field TIRAMISU_0 int PRE_EOL_INFO_URGENT = 3;
-    field TIRAMISU_0 long SHUTDOWN_COST_INFO_MISSING = -1;
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 int getPreEolIndicatorStatus();
-    method TIRAMISU_0 WearEstimate getWearEstimate();
-    method TIRAMISU_0 List<WearEstimateChange> getWearEstimateHistory();
-    method TIRAMISU_0 List<IoStatsEntry> getBootIoStats();
-    method TIRAMISU_0 long getShutdownDiskWriteAmount();
-    method TIRAMISU_0 List<IoStatsEntry> getAggregateIoStats();
-    method TIRAMISU_0 List<IoStats> getIoStatsDeltas();
-    method TIRAMISU_0 void registerListener(IoStatsListener listener);
-    method TIRAMISU_0 void unregisterListener(IoStatsListener listener);
-interface CarStorageMonitoringManager.IoStatsListener package android.car.storagemonitoring
-    method TIRAMISU_0 void onSnapshot(IoStats snapshot);
-class @hide @SystemApi UidIoRecord package android.car.storagemonitoring
-    field TIRAMISU_0 int uid;
-    field TIRAMISU_0 long foreground_rchar;
-    field TIRAMISU_0 long foreground_wchar;
-    field TIRAMISU_0 long foreground_read_bytes;
-    field TIRAMISU_0 long foreground_write_bytes;
-    field TIRAMISU_0 long foreground_fsync;
-    field TIRAMISU_0 long background_rchar;
-    field TIRAMISU_0 long background_wchar;
-    field TIRAMISU_0 long background_read_bytes;
-    field TIRAMISU_0 long background_write_bytes;
-    field TIRAMISU_0 long background_fsync;
-    method TIRAMISU_0 @hiddenOnly UidIoRecord delta(IoStatsEntry other);
-    method TIRAMISU_0 @hiddenOnly UidIoRecord delta(UidIoRecord other);
-class @hide @SystemApi WearEstimateChange package android.car.storagemonitoring
-    field TIRAMISU_0 Parcelable.Creator<WearEstimateChange> CREATOR;
-    field TIRAMISU_0 WearEstimate oldEstimate;
-    field TIRAMISU_0 WearEstimate newEstimate;
-    field TIRAMISU_0 long uptimeAtChange;
-    field TIRAMISU_0 Instant dateAtChange;
-    field TIRAMISU_0 boolean isAcceptableDegradation;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 boolean equals(Object other);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi WearEstimate package android.car.storagemonitoring
-    field TIRAMISU_0 int UNKNOWN = -1;
-    field TIRAMISU_0 @hiddenOnly WearEstimate UNKNOWN_ESTIMATE = new WearEstimate(UNKNOWN, UNKNOWN);
-    field TIRAMISU_0 Parcelable.Creator<WearEstimate> CREATOR;
-    field TIRAMISU_0 int typeA;
-    field TIRAMISU_0 int typeB;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly void writeToJson(JsonWriter jsonWriter);
-    method TIRAMISU_0 boolean equals(Object other);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 String toString();
-class @hiddenOnly @hide CarManagerBase package android.car
-    field TIRAMISU_0 Car mCar;
-    method TIRAMISU_0 Context getContext();
-    method TIRAMISU_0 Handler getEventHandler();
-    method TIRAMISU_0 T handleRemoteExceptionFromCarService(RemoteException e, T returnValue);
-    method TIRAMISU_0 void handleRemoteExceptionFromCarService(RemoteException e);
-    method TIRAMISU_0 T handleExceptionFromCarService(Exception e, T returnValue);
-    method TIRAMISU_0 void onCarDisconnected();
-    method TIRAMISU_0 T addDumpable(Object container, Supplier<T> dumpableSupplier);
-class @hide @SystemApi VehicleAreaWindow package android.car
-    field TIRAMISU_0 int WINDOW_FRONT_WINDSHIELD = 0x0001;
-    field TIRAMISU_0 int WINDOW_REAR_WINDSHIELD = 0x0002;
-    field TIRAMISU_0 int WINDOW_ROW_1_LEFT = 0x0010;
-    field TIRAMISU_0 int WINDOW_ROW_1_RIGHT = 0x0040;
-    field TIRAMISU_0 int WINDOW_ROW_2_LEFT = 0x0100;
-    field TIRAMISU_0 int WINDOW_ROW_2_RIGHT = 0x0400;
-    field TIRAMISU_0 int WINDOW_ROW_3_LEFT = 0x1000;
-    field TIRAMISU_0 int WINDOW_ROW_3_RIGHT = 0x4000;
-    field TIRAMISU_0 int WINDOW_ROOF_TOP_1 = 0x10000;
-    field TIRAMISU_0 int WINDOW_ROOF_TOP_2 = 0x20000;
-class @hide @SystemApi CarNavigationInstrumentCluster package android.car.navigation
-    field TIRAMISU_0 int CLUSTER_TYPE_CUSTOM_IMAGES_SUPPORTED = 1;
-    field TIRAMISU_0 int CLUSTER_TYPE_IMAGE_CODES_ONLY = 2;
-    field TIRAMISU_0 Parcelable.Creator<CarNavigationInstrumentCluster> CREATOR;
-    method TIRAMISU_0 CarNavigationInstrumentCluster createCluster(int minIntervalMillis);
-    method TIRAMISU_0 CarNavigationInstrumentCluster createCustomImageCluster(int minIntervalMillis, int imageWidth, int imageHeight, int imageColorDepthBits);
-    method TIRAMISU_0 int getMinIntervalMillis();
-    method TIRAMISU_0 int getType();
-    method TIRAMISU_0 int getImageWidth();
-    method TIRAMISU_0 int getImageHeight();
-    method TIRAMISU_0 @hiddenOnly Bundle getExtra();
-    method TIRAMISU_0 int getImageColorDepthBits();
-    method TIRAMISU_0 boolean supportsCustomImages();
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi CarNavigationStatusManager package android.car.navigation
-    method TIRAMISU_0 void sendEvent(int eventType, Bundle bundle);
-    method TIRAMISU_0 void sendNavigationStateChange(Bundle bundle);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 CarNavigationInstrumentCluster getInstrumentClusterInfo();
-class @hide @SystemApi VehicleAreaMirror package android.car
-    field TIRAMISU_0 int MIRROR_DRIVER_LEFT = 0x00000001;
-    field TIRAMISU_0 int MIRROR_DRIVER_RIGHT = 0x00000002;
-    field TIRAMISU_0 int MIRROR_DRIVER_CENTER = 0x00000004;
-class @hide @SystemApi CustomInputEvent package android.car.input
-    field TIRAMISU_0 int INPUT_CODE_F1 = 1001;
-    field TIRAMISU_0 int INPUT_CODE_F2 = 1002;
-    field TIRAMISU_0 int INPUT_CODE_F3 = 1003;
-    field TIRAMISU_0 int INPUT_CODE_F4 = 1004;
-    field TIRAMISU_0 int INPUT_CODE_F5 = 1005;
-    field TIRAMISU_0 int INPUT_CODE_F6 = 1006;
-    field TIRAMISU_0 int INPUT_CODE_F7 = 1007;
-    field TIRAMISU_0 int INPUT_CODE_F8 = 1008;
-    field TIRAMISU_0 int INPUT_CODE_F9 = 1009;
-    field TIRAMISU_0 int INPUT_CODE_F10 = 1010;
-    field TIRAMISU_0 Parcelable.Creator<CustomInputEvent> CREATOR;
-    method TIRAMISU_0 String inputCodeToString(int value);
-    method TIRAMISU_0 int getInputCode();
-    method TIRAMISU_0 int getTargetDisplayType();
-    method TIRAMISU_0 int getRepeatCounter();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi CarInputHandlingService package android.car.input
-    field TIRAMISU_0 String INPUT_CALLBACK_BINDER_KEY = "callback_binder";
-    field TIRAMISU_0 int INPUT_CALLBACK_BINDER_CODE = IBinder.FIRST_CALL_TRANSACTION;
-    method TIRAMISU_0 IBinder onBind(Intent intent);
-    method TIRAMISU_0 void onKeyEvent(KeyEvent keyEvent, int targetDisplay);
-    method TIRAMISU_0 void dump(FileDescriptor fd, PrintWriter writer, String[] args);
-class CarInputHandlingService.InputFilter package android.car.input
-    field TIRAMISU_0 int mKeyCode;
-    field TIRAMISU_0 int mTargetDisplay;
-    field TIRAMISU_0 Parcelable.Creator CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-class @hide @SystemApi RotaryEvent package android.car.input
-    field TIRAMISU_0 Parcelable.Creator<RotaryEvent> CREATOR;
-    method TIRAMISU_0 int getNumberOfClicks();
-    method TIRAMISU_0 long getUptimeMillisForClick(int clickIndex);
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 int getInputType();
-    method TIRAMISU_0 boolean isClockwise();
-    method TIRAMISU_0 long[] getUptimeMillisForClicks();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi CarInputManager package android.car.input
-    field TIRAMISU_0 int CAPTURE_REQ_FLAGS_ALLOW_DELAYED_GRANT = 0x1;
-    field TIRAMISU_0 int CAPTURE_REQ_FLAGS_TAKE_ALL_EVENTS_FOR_DISPLAY = 0x2;
-    field TIRAMISU_0 int INPUT_TYPE_ALL_INPUTS = 1;
-    field TIRAMISU_0 int INPUT_TYPE_ROTARY_NAVIGATION = 10;
-    field TIRAMISU_0 int INPUT_TYPE_ROTARY_VOLUME = 11;
-    field TIRAMISU_0 int INPUT_TYPE_DPAD_KEYS = 100;
-    field TIRAMISU_0 int INPUT_TYPE_NAVIGATE_KEYS = 101;
-    field TIRAMISU_0 int INPUT_TYPE_SYSTEM_NAVIGATE_KEYS = 102;
-    field TIRAMISU_0 int INPUT_TYPE_CUSTOM_INPUT_EVENT = 200;
-    field TIRAMISU_0 int INPUT_CAPTURE_RESPONSE_SUCCEEDED = 0;
-    field TIRAMISU_0 int INPUT_CAPTURE_RESPONSE_FAILED = 1;
-    field TIRAMISU_0 int INPUT_CAPTURE_RESPONSE_DELAYED = 2;
-    method TIRAMISU_0 int requestInputEventCapture(int targetDisplayType, int[] inputTypes, int requestFlags, CarInputCaptureCallback callback);
-    method TIRAMISU_0 int requestInputEventCapture(int targetDisplayType, int[] inputTypes, int requestFlags, Executor executor, CarInputCaptureCallback callback);
-    method TIRAMISU_0 void releaseInputEventCapture(int targetDisplayType);
-    method TIRAMISU_0 void injectKeyEvent(KeyEvent event, int targetDisplayType);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface CarInputManager.CarInputCaptureCallback package android.car.input
-    method TIRAMISU_0 void onKeyEvents(int targetDisplayType, List<KeyEvent> keyEvents);
-    method TIRAMISU_0 void onRotaryEvents(int targetDisplayType, List<RotaryEvent> events);
-    method TIRAMISU_0 void onCaptureStateChanged(int targetDisplayType, int[] activeInputTypes);
-    method TIRAMISU_0 void onCustomInputEvents(int targetDisplayType, List<CustomInputEvent> events);
-class @hiddenOnly @hide VehicleLightSwitch package android.car
-    field TIRAMISU_0 int OFF = 0;
-    field TIRAMISU_0 int ON = 1;
-    field TIRAMISU_0 int DAYTIME_RUNNING = 2;
-    field TIRAMISU_0 int AUTOMATIC = 0x100;
-class CarUxRestrictionsManager package android.car.drivingstate
-    field TIRAMISU_0 @hiddenOnly String UX_RESTRICTION_MODE_BASELINE = "baseline";
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 void registerListener(OnUxRestrictionsChangedListener listener);
-    method TIRAMISU_0 @hiddenOnly void registerListener(OnUxRestrictionsChangedListener listener, int displayId);
-    method TIRAMISU_0 void unregisterListener();
-    method TIRAMISU_0 @hiddenOnly boolean saveUxRestrictionsConfigurationForNextBoot(List<CarUxRestrictionsConfiguration> configs);
-    method TIRAMISU_0 CarUxRestrictions getCurrentCarUxRestrictions();
-    method TIRAMISU_0 @hiddenOnly CarUxRestrictions getCurrentCarUxRestrictions(int displayId);
-    method TIRAMISU_0 @hiddenOnly boolean setRestrictionMode(String mode);
-    method TIRAMISU_0 @hiddenOnly String getRestrictionMode();
-    method TIRAMISU_0 @hiddenOnly boolean saveUxRestrictionsConfigurationForNextBoot(CarUxRestrictionsConfiguration config);
-    method TIRAMISU_0 @hiddenOnly List<CarUxRestrictionsConfiguration> getStagedConfigs();
-    method TIRAMISU_0 @hiddenOnly List<CarUxRestrictionsConfiguration> getConfigs();
-interface CarUxRestrictionsManager.OnUxRestrictionsChangedListener package android.car.drivingstate
-    method TIRAMISU_0 void onUxRestrictionsChanged(CarUxRestrictions restrictionInfo);
-class @hide @SystemApi CarDrivingStateManager package android.car.drivingstate
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 void registerListener(CarDrivingStateEventListener listener);
-    method TIRAMISU_0 void unregisterListener();
-    method TIRAMISU_0 CarDrivingStateEvent getCurrentCarDrivingState();
-    method TIRAMISU_0 @hiddenOnly void injectDrivingState(int drivingState);
-interface @hide @SystemApi CarDrivingStateManager.CarDrivingStateEventListener package android.car.drivingstate
-    method TIRAMISU_0 void onDrivingStateChanged(CarDrivingStateEvent event);
-class CarUxRestrictions package android.car.drivingstate
-    field TIRAMISU_0 int UX_RESTRICTIONS_BASELINE = 0;
-    field TIRAMISU_0 int UX_RESTRICTIONS_NO_DIALPAD = 1;
-    field TIRAMISU_0 int UX_RESTRICTIONS_NO_FILTERING = 0x1 << 1;
-    field TIRAMISU_0 int UX_RESTRICTIONS_LIMIT_STRING_LENGTH = 0x1 << 2;
-    field TIRAMISU_0 int UX_RESTRICTIONS_NO_KEYBOARD = 0x1 << 3;
-    field TIRAMISU_0 int UX_RESTRICTIONS_NO_VIDEO = 0x1 << 4;
-    field TIRAMISU_0 int UX_RESTRICTIONS_LIMIT_CONTENT = 0x1 << 5;
-    field TIRAMISU_0 int UX_RESTRICTIONS_NO_SETUP = 0x1 << 6;
-    field TIRAMISU_0 int UX_RESTRICTIONS_NO_TEXT_MESSAGE = 0x1 << 7;
-    field TIRAMISU_0 int UX_RESTRICTIONS_NO_VOICE_TRANSCRIPTION = 0x1 << 8;
-    field TIRAMISU_0 int UX_RESTRICTIONS_FULLY_RESTRICTED = UX_RESTRICTIONS_NO_DIALPAD | UX_RESTRICTIONS_NO_FILTERING | UX_RESTRICTIONS_LIMIT_STRING_LENGTH | UX_RESTRICTIONS_NO_KEYBOARD | UX_RESTRICTIONS_NO_VIDEO | UX_RESTRICTIONS_LIMIT_CONTENT | UX_RESTRICTIONS_NO_SETUP | UX_RESTRICTIONS_NO_TEXT_MESSAGE | UX_RESTRICTIONS_NO_VOICE_TRANSCRIPTION;
-    field TIRAMISU_0 Parcelable.Creator<CarUxRestrictions> CREATOR;
-    method TIRAMISU_0 @hiddenOnly long getTimeStamp();
-    method TIRAMISU_0 boolean isRequiresDistractionOptimization();
-    method TIRAMISU_0 int getActiveRestrictions();
-    method TIRAMISU_0 int getMaxRestrictedStringLength();
-    method TIRAMISU_0 int getMaxCumulativeContentItems();
-    method TIRAMISU_0 int getMaxContentDepth();
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean isSameRestrictions(CarUxRestrictions other);
-class CarUxRestrictions.Builder package android.car.drivingstate
-    method TIRAMISU_0 Builder setMaxStringLength(int length);
-    method TIRAMISU_0 Builder setMaxCumulativeContentItems(int number);
-    method TIRAMISU_0 Builder setMaxContentDepth(int depth);
-    method TIRAMISU_0 CarUxRestrictions build();
-class @hide @SystemApi CarDrivingStateEvent package android.car.drivingstate
-    field TIRAMISU_0 int DRIVING_STATE_UNKNOWN = -1;
-    field TIRAMISU_0 int DRIVING_STATE_PARKED = 0;
-    field TIRAMISU_0 int DRIVING_STATE_IDLING = 1;
-    field TIRAMISU_0 int DRIVING_STATE_MOVING = 2;
-    field TIRAMISU_0 long timeStamp;
-    field TIRAMISU_0 int eventValue;
-    field TIRAMISU_0 Parcelable.Creator<CarDrivingStateEvent> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-class @hiddenOnly @hide CarUxRestrictionsConfiguration package android.car.drivingstate
-    field TIRAMISU_0 Parcelable.Creator<CarUxRestrictionsConfiguration> CREATOR;
-    method TIRAMISU_0 CarUxRestrictions getUxRestrictions(int drivingState, float currentSpeed);
-    method TIRAMISU_0 CarUxRestrictions getUxRestrictions(int drivingState, float currentSpeed, String mode);
-    method TIRAMISU_0 Integer getPhysicalPort();
-    method TIRAMISU_0 void writeJson(JsonWriter writer);
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 CarUxRestrictionsConfiguration readJson(JsonReader reader, int schemaVersion);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 boolean equals(Object obj);
-    method TIRAMISU_0 boolean hasSameParameters(CarUxRestrictionsConfiguration other);
-    method TIRAMISU_0 void dump(PrintWriter writer);
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-class @hiddenOnly @hide CarUxRestrictionsConfiguration.Builder package android.car.drivingstate
-    field TIRAMISU_0 Map<String,RestrictionModeContainer> mRestrictionModes = new ArrayMap<>();
-    method TIRAMISU_0 int validatePort(int port);
-    method TIRAMISU_0 Builder setPhysicalPort(int port);
-    method TIRAMISU_0 Builder setUxRestrictions(int drivingState, boolean requiresOptimization, int restrictions);
-    method TIRAMISU_0 Builder setUxRestrictions(int drivingState, SpeedRange speedRange, boolean requiresOptimization, int restrictions);
-    method TIRAMISU_0 Builder setUxRestrictions(int drivingState, DrivingStateRestrictions drivingStateRestrictions);
-    method TIRAMISU_0 Builder setMaxStringLength(int maxStringLength);
-    method TIRAMISU_0 Builder setMaxCumulativeContentItems(int maxCumulativeContentItems);
-    method TIRAMISU_0 Builder setMaxContentDepth(int maxContentDepth);
-    method TIRAMISU_0 CarUxRestrictionsConfiguration build();
-class CarUxRestrictionsConfiguration.Builder.SpeedRange package android.car.drivingstate
-    field TIRAMISU_0 float MAX_SPEED = Float.POSITIVE_INFINITY;
-    method TIRAMISU_0 boolean includes(float speed);
-    method TIRAMISU_0 int compareTo(SpeedRange other);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 boolean equals(Object obj);
-    method TIRAMISU_0 String toString();
-class @hiddenOnly @hide CarUxRestrictionsConfiguration.DrivingStateRestrictions package android.car.drivingstate
-    method TIRAMISU_0 DrivingStateRestrictions setDistractionOptimizationRequired(boolean distractionOptimizationRequired);
-    method TIRAMISU_0 DrivingStateRestrictions setRestrictions(int restrictions);
-    method TIRAMISU_0 DrivingStateRestrictions setMode(String mode);
-    method TIRAMISU_0 DrivingStateRestrictions setSpeedRange(Builder.SpeedRange speedRange);
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi CarActivityManager package android.car.app
-    field TIRAMISU_0 int RESULT_SUCCESS = 0;
-    field TIRAMISU_0 int RESULT_FAILURE = -1;
-    field TIRAMISU_0 int RESULT_INVALID_USER = -2;
-    field TIRAMISU_0 @hiddenOnly int ERROR_CODE_ACTIVITY_NOT_FOUND = -101;
-    method TIRAMISU_0 int setPersistentActivity(ComponentName activity, int displayId, int featureId);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 @hiddenOnly boolean registerTaskMonitor();
-    method TIRAMISU_0 @hiddenOnly void onTaskAppeared(ActivityManager.RunningTaskInfo taskInfo);
-    method TIRAMISU_0 @hiddenOnly void onTaskVanished(ActivityManager.RunningTaskInfo taskInfo);
-    method TIRAMISU_0 @hiddenOnly void onTaskInfoChanged(ActivityManager.RunningTaskInfo taskInfo);
-    method TIRAMISU_0 @hiddenOnly void unregisterTaskMonitor();
-    method TIRAMISU_1 @hiddenOnly List<ActivityManager.RunningTaskInfo> getVisibleTasks();
-class @hide @SystemApi CarVendorExtensionManager package android.car.hardware
-    method TIRAMISU_0 void registerCallback(CarVendorExtensionCallback callback);
-    method TIRAMISU_0 void unregisterCallback(CarVendorExtensionCallback callback);
-    method TIRAMISU_0 List<CarPropertyConfig> getProperties();
-    method TIRAMISU_0 boolean isPropertyAvailable(int propertyId, int area);
-    method TIRAMISU_0 E getGlobalProperty(Class<E> propertyClass, int propId);
-    method TIRAMISU_0 E getProperty(Class<E> propertyClass, int propId, int area);
-    method TIRAMISU_0 void setGlobalProperty(Class<E> propertyClass, int propId, E value);
-    method TIRAMISU_0 void setProperty(Class<E> propertyClass, int propId, int area, E value);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface CarVendorExtensionManager.CarVendorExtensionCallback package android.car.hardware
-    method TIRAMISU_0 void onChangeEvent(CarPropertyValue value);
-    method TIRAMISU_0 void onErrorEvent(int propertyId, int zone);
-class CarPropertyConfig package android.car.hardware
-    field TIRAMISU_0 int VEHICLE_PROPERTY_ACCESS_NONE = 0;
-    field TIRAMISU_0 int VEHICLE_PROPERTY_ACCESS_READ = 1;
-    field TIRAMISU_0 int VEHICLE_PROPERTY_ACCESS_WRITE = 2;
-    field TIRAMISU_0 int VEHICLE_PROPERTY_ACCESS_READ_WRITE = 3;
-    field TIRAMISU_0 int VEHICLE_PROPERTY_CHANGE_MODE_STATIC = 0;
-    field TIRAMISU_0 int VEHICLE_PROPERTY_CHANGE_MODE_ONCHANGE = 1;
-    field TIRAMISU_0 int VEHICLE_PROPERTY_CHANGE_MODE_CONTINUOUS = 2;
-    field TIRAMISU_0 Creator<CarPropertyConfig> CREATOR;
-    method TIRAMISU_0 int getAccess();
-    method TIRAMISU_0 int getAreaType();
-    method TIRAMISU_0 int getChangeMode();
-    method TIRAMISU_0 List<Integer> getConfigArray();
-    method TIRAMISU_0 @hiddenOnly String getConfigString();
-    method TIRAMISU_0 float getMaxSampleRate();
-    method TIRAMISU_0 float getMinSampleRate();
-    method TIRAMISU_0 int getPropertyId();
-    method TIRAMISU_0 Class<T> getPropertyType();
-    method TIRAMISU_0 boolean isGlobalProperty();
-    method TIRAMISU_0 @hiddenOnly int getAreaCount();
-    method TIRAMISU_0 int[] getAreaIds();
-    method TIRAMISU_0 @hiddenOnly int getFirstAndOnlyAreaId();
-    method TIRAMISU_0 @hiddenOnly boolean hasArea(int areaId);
-    method TIRAMISU_0 T getMinValue(int areaId);
-    method TIRAMISU_0 T getMaxValue(int areaId);
-    method TIRAMISU_0 T getMinValue();
-    method TIRAMISU_0 T getMaxValue();
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly String toString();
-    method TIRAMISU_0 Builder<T> newBuilder(Class<T> type, int propertyId, int areaType, int areaCapacity);
-    method TIRAMISU_0 @hiddenOnly Builder<T> newBuilder(Class<T> type, int propertyId, int areaType);
-class @hiddenOnly @hide CarPropertyConfig.AreaConfig package android.car.hardware
-    field TIRAMISU_0 Parcelable.Creator<AreaConfig<Object>> CREATOR;
-    method TIRAMISU_0 T getMinValue();
-    method TIRAMISU_0 T getMaxValue();
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi CarPropertyConfig.Builder package android.car.hardware
-    method TIRAMISU_0 Builder<T> addAreas(int[] areaIds);
-    method TIRAMISU_0 Builder<T> addArea(int areaId);
-    method TIRAMISU_0 Builder<T> addAreaConfig(int areaId, T min, T max);
-    method TIRAMISU_0 Builder<T> setAccess(int access);
-    method TIRAMISU_0 Builder<T> setChangeMode(int changeMode);
-    method TIRAMISU_0 Builder<T> setConfigArray(ArrayList<Integer> configArray);
-    method TIRAMISU_0 Builder<T> setConfigString(String configString);
-    method TIRAMISU_0 Builder<T> setMaxSampleRate(float maxSampleRate);
-    method TIRAMISU_0 Builder<T> setMinSampleRate(float minSampleRate);
-    method TIRAMISU_0 CarPropertyConfig<T> build();
-class @SystemApi CarHvacFanDirection package android.car.hardware
-    field TIRAMISU_0 int UNKNOWN = 0x0;
-    field TIRAMISU_0 int FACE = 0x01;
-    field TIRAMISU_0 int FLOOR = 0x02;
-    field TIRAMISU_0 int FACE_AND_FLOOR = 0x03;
-    field TIRAMISU_0 int DEFROST = 0x04;
-    field TIRAMISU_0 int DEFROST_AND_FLOOR = 0x06;
-class CarPropertyValue package android.car.hardware
-    field TIRAMISU_0 int STATUS_AVAILABLE = 0;
-    field TIRAMISU_0 int STATUS_UNAVAILABLE = 1;
-    field TIRAMISU_0 int STATUS_ERROR = 2;
-    field TIRAMISU_0 Creator<CarPropertyValue> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int getPropertyId();
-    method TIRAMISU_0 int getAreaId();
-    method TIRAMISU_0 int getStatus();
-    method TIRAMISU_0 long getTimestamp();
-    method TIRAMISU_0 T getValue();
-    method TIRAMISU_0 @hiddenOnly String toString();
-class @hiddenOnly @hide CarSensorConfig package android.car.hardware
-    field TIRAMISU_0 @hiddenOnly String WHEEL_TICK_DISTANCE_SUPPORTED_WHEELS = "android.car.wheelTickDistanceSupportedWheels";
-    field TIRAMISU_0 @hiddenOnly String WHEEL_TICK_DISTANCE_FRONT_LEFT_UM_PER_TICK = "android.car.wheelTickDistanceFrontLeftUmPerTick";
-    field TIRAMISU_0 @hiddenOnly String WHEEL_TICK_DISTANCE_FRONT_RIGHT_UM_PER_TICK = "android.car.wheelTickDistanceFrontRightUmPerTick";
-    field TIRAMISU_0 @hiddenOnly String WHEEL_TICK_DISTANCE_REAR_RIGHT_UM_PER_TICK = "android.car.wheelTickDistanceRearRightUmPerTick";
-    field TIRAMISU_0 @hiddenOnly String WHEEL_TICK_DISTANCE_REAR_LEFT_UM_PER_TICK = "android.car.wheelTickDistanceRearLeftUmPerTick";
-    field TIRAMISU_0 @hiddenOnly Parcelable.Creator<CarSensorConfig> CREATOR;
-    method TIRAMISU_0 @hiddenOnly int describeContents();
-    method TIRAMISU_0 @hiddenOnly void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly Bundle getBundle();
-    method TIRAMISU_0 @hiddenOnly int getInt(String key);
-    method TIRAMISU_0 @hiddenOnly int getType();
-    method TIRAMISU_0 @hiddenOnly String toString();
-class CarSensorEvent package android.car.hardware
-    field TIRAMISU_0 int GEAR_NEUTRAL = 0x0001;
-    field TIRAMISU_0 int GEAR_FIRST = 0x0010;
-    field TIRAMISU_0 int GEAR_SECOND = 0x0020;
-    field TIRAMISU_0 int GEAR_THIRD = 0x0040;
-    field TIRAMISU_0 int GEAR_FOURTH = 0x0080;
-    field TIRAMISU_0 int GEAR_FIFTH = 0x0100;
-    field TIRAMISU_0 int GEAR_SIXTH = 0x0200;
-    field TIRAMISU_0 int GEAR_SEVENTH = 0x0400;
-    field TIRAMISU_0 int GEAR_EIGHTH = 0x0800;
-    field TIRAMISU_0 int GEAR_NINTH = 0x1000;
-    field TIRAMISU_0 int GEAR_TENTH = 0x2000;
-    field TIRAMISU_0 int GEAR_DRIVE = 0x0008;
-    field TIRAMISU_0 int GEAR_PARK = 0x0004;
-    field TIRAMISU_0 int GEAR_REVERSE = 0x0002;
-    field TIRAMISU_0 int IGNITION_STATE_UNDEFINED = 0;
-    field TIRAMISU_0 int IGNITION_STATE_LOCK = 1;
-    field TIRAMISU_0 int IGNITION_STATE_OFF = 2;
-    field TIRAMISU_0 int IGNITION_STATE_ACC = 3;
-    field TIRAMISU_0 int IGNITION_STATE_ON = 4;
-    field TIRAMISU_0 int IGNITION_STATE_START = 5;
-    field TIRAMISU_0 int INDEX_ENVIRONMENT_TEMPERATURE = 0;
-    field TIRAMISU_0 int INDEX_WHEEL_DISTANCE_RESET_COUNT = 0;
-    field TIRAMISU_0 int INDEX_WHEEL_DISTANCE_FRONT_LEFT = 1;
-    field TIRAMISU_0 int INDEX_WHEEL_DISTANCE_FRONT_RIGHT = 2;
-    field TIRAMISU_0 int INDEX_WHEEL_DISTANCE_REAR_RIGHT = 3;
-    field TIRAMISU_0 int INDEX_WHEEL_DISTANCE_REAR_LEFT = 4;
-    field TIRAMISU_0 int sensorType;
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 float[] floatValues;
-    field TIRAMISU_0 int[] intValues;
-    field TIRAMISU_0 long[] longValues;
-    field TIRAMISU_0 Parcelable.Creator<CarSensorEvent> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 @hiddenOnly EnvironmentData getEnvironmentData(EnvironmentData data);
-    method TIRAMISU_0 @hiddenOnly IgnitionStateData getIgnitionStateData(IgnitionStateData data);
-    method TIRAMISU_0 @hiddenOnly NightData getNightData(NightData data);
-    method TIRAMISU_0 @hiddenOnly GearData getGearData(GearData data);
-    method TIRAMISU_0 @hiddenOnly ParkingBrakeData getParkingBrakeData(ParkingBrakeData data);
-    method TIRAMISU_0 @hiddenOnly FuelLevelData getFuelLevelData(FuelLevelData data);
-    method TIRAMISU_0 @hiddenOnly OdometerData getOdometerData(OdometerData data);
-    method TIRAMISU_0 @hiddenOnly RpmData getRpmData(RpmData data);
-    method TIRAMISU_0 @hiddenOnly CarSpeedData getCarSpeedData(CarSpeedData data);
-    method TIRAMISU_0 @hiddenOnly CarWheelTickDistanceData getCarWheelTickDistanceData(CarWheelTickDistanceData data);
-    method TIRAMISU_0 @hiddenOnly CarAbsActiveData getCarAbsActiveData(CarAbsActiveData data);
-    method TIRAMISU_0 @hiddenOnly CarTractionControlActiveData getCarTractionControlActiveData(CarTractionControlActiveData data);
-    method TIRAMISU_0 @hiddenOnly CarFuelDoorOpenData getCarFuelDoorOpenData(CarFuelDoorOpenData data);
-    method TIRAMISU_0 @hiddenOnly CarEvBatteryLevelData getCarEvBatteryLevelData(CarEvBatteryLevelData data);
-    method TIRAMISU_0 @hiddenOnly CarEvChargePortOpenData getCarEvChargePortOpenData(CarEvChargePortOpenData data);
-    method TIRAMISU_0 @hiddenOnly CarEvChargePortConnectedData getCarEvChargePortConnectedData(CarEvChargePortConnectedData data);
-    method TIRAMISU_0 @hiddenOnly CarEvBatteryChargeRateData getCarEvBatteryChargeRateData(CarEvBatteryChargeRateData data);
-    method TIRAMISU_0 @hiddenOnly CarEngineOilLevelData getCarEngineOilLevelData(CarEngineOilLevelData data);
-    method TIRAMISU_0 @hiddenOnly String toString();
-class CarSensorEvent.EnvironmentData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 float temperature;
-class @hiddenOnly @hide CarSensorEvent.IgnitionStateData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 int ignitionState;
-class @hiddenOnly @hide CarSensorEvent.NightData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 boolean isNightMode;
-class @hiddenOnly @hide CarSensorEvent.GearData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 int gear;
-class @hiddenOnly @hide CarSensorEvent.ParkingBrakeData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 boolean isEngaged;
-class @hiddenOnly @hide CarSensorEvent.FuelLevelData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 float level;
-class @hiddenOnly @hide CarSensorEvent.OdometerData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 float kms;
-class @hiddenOnly @hide CarSensorEvent.RpmData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 float rpm;
-class @hiddenOnly @hide CarSensorEvent.CarSpeedData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 float carSpeed;
-class @hiddenOnly @hide CarSensorEvent.CarWheelTickDistanceData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 long sensorResetCount;
-    field TIRAMISU_0 long frontLeftWheelDistanceMm;
-    field TIRAMISU_0 long frontRightWheelDistanceMm;
-    field TIRAMISU_0 long rearRightWheelDistanceMm;
-    field TIRAMISU_0 long rearLeftWheelDistanceMm;
-class @hiddenOnly @hide CarSensorEvent.CarAbsActiveData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 boolean absIsActive;
-class @hiddenOnly @hide CarSensorEvent.CarTractionControlActiveData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 boolean tractionControlIsActive;
-class @hiddenOnly @hide CarSensorEvent.CarFuelDoorOpenData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 boolean fuelDoorIsOpen;
-class @hiddenOnly @hide CarSensorEvent.CarEvBatteryLevelData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 float evBatteryLevel;
-class @hiddenOnly @hide CarSensorEvent.CarEvChargePortOpenData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 boolean evChargePortIsOpen;
-class @hiddenOnly @hide CarSensorEvent.CarEvChargePortConnectedData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 boolean evChargePortIsConnected;
-class @hiddenOnly @hide CarSensorEvent.CarEvBatteryChargeRateData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 float evChargeRate;
-class @hiddenOnly @hide CarSensorEvent.CarEngineOilLevelData package android.car.hardware
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 int engineOilLevel;
-class CarSensorManager package android.car.hardware
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED1 = 1;
-    field TIRAMISU_0 int SENSOR_TYPE_CAR_SPEED = 0x11600207;
-    field TIRAMISU_0 int SENSOR_TYPE_RPM = 0x11600305;
-    field TIRAMISU_0 int SENSOR_TYPE_ODOMETER = 0x11600204;
-    field TIRAMISU_0 int SENSOR_TYPE_FUEL_LEVEL = 0x11600307;
-    field TIRAMISU_0 int SENSOR_TYPE_PARKING_BRAKE = 0x11200402;
-    field TIRAMISU_0 int SENSOR_TYPE_GEAR = 0x11400400;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED8 = 8;
-    field TIRAMISU_0 int SENSOR_TYPE_NIGHT = 0x11200407;
-    field TIRAMISU_0 int SENSOR_TYPE_ENV_OUTSIDE_TEMPERATURE = 0x11600703;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED10 = 10;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED11 = 11;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED12 = 12;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED13 = 13;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED14 = 14;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED15 = 15;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED16 = 16;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED17 = 17;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED18 = 18;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED19 = 19;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED20 = 20;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED21 = 21;
-    field TIRAMISU_0 int SENSOR_TYPE_IGNITION_STATE = 0x11400409;
-    field TIRAMISU_0 int SENSOR_TYPE_WHEEL_TICK_DISTANCE = 0x11510306;
-    field TIRAMISU_0 int SENSOR_TYPE_ABS_ACTIVE = 0x1120040a;
-    field TIRAMISU_0 int SENSOR_TYPE_TRACTION_CONTROL_ACTIVE = 0x1120040b;
-    field TIRAMISU_0 @hiddenOnly int SENSOR_TYPE_RESERVED26 = 26;
-    field TIRAMISU_0 int SENSOR_TYPE_FUEL_DOOR_OPEN = 0x11200308;
-    field TIRAMISU_0 int SENSOR_TYPE_EV_BATTERY_LEVEL = 0x11600309;
-    field TIRAMISU_0 int SENSOR_TYPE_EV_CHARGE_PORT_OPEN = 0x1120030a;
-    field TIRAMISU_0 int SENSOR_TYPE_EV_CHARGE_PORT_CONNECTED = 0x1120030b;
-    field TIRAMISU_0 int SENSOR_TYPE_EV_BATTERY_CHARGE_RATE = 0x1160030c;
-    field TIRAMISU_0 int SENSOR_TYPE_ENGINE_OIL_LEVEL = 0x11400303;
-    field TIRAMISU_0 int SENSOR_RATE_ONCHANGE = 0;
-    field TIRAMISU_0 int SENSOR_RATE_NORMAL = 1;
-    field TIRAMISU_0 int SENSOR_RATE_UI = 5;
-    field TIRAMISU_0 int SENSOR_RATE_FAST = 10;
-    field TIRAMISU_0 int SENSOR_RATE_FASTEST = 100;
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 int[] getSupportedSensors();
-    method TIRAMISU_0 List<CarPropertyConfig> getPropertyList();
-    method TIRAMISU_0 boolean isSensorSupported(int sensorType);
-    method TIRAMISU_0 @hiddenOnly boolean isSensorSupported(int[] sensorList, int sensorType);
-    method TIRAMISU_0 boolean registerListener(OnSensorChangedListener listener, int sensorType, int rate);
-    method TIRAMISU_0 void unregisterListener(OnSensorChangedListener listener);
-    method TIRAMISU_0 void unregisterListener(OnSensorChangedListener listener, int sensorType);
-    method TIRAMISU_0 CarSensorEvent getLatestSensorEvent(int type);
-    method TIRAMISU_0 @hiddenOnly CarSensorConfig getSensorConfig(int type);
-interface CarSensorManager.OnSensorChangedListener package android.car.hardware
-    method TIRAMISU_0 void onSensorChanged(CarSensorEvent event);
-class @hide @SystemApi CarHvacManager package android.car.hardware.hvac
-    field TIRAMISU_0 int ID_MIRROR_DEFROSTER_ON = 0x1440050c;
-    field TIRAMISU_0 int ID_STEERING_WHEEL_HEAT = 0x1140050d;
-    field TIRAMISU_0 int ID_OUTSIDE_AIR_TEMP = 0x11600703;
-    field TIRAMISU_0 int ID_TEMPERATURE_DISPLAY_UNITS = 0x1140050e;
-    field TIRAMISU_0 int ID_ZONED_TEMP_SETPOINT = 0x15600503;
-    field TIRAMISU_0 int ID_ZONED_TEMP_ACTUAL = 0x15600502;
-    field TIRAMISU_0 int ID_ZONED_HVAC_POWER_ON = 0x15200510;
-    field TIRAMISU_0 int ID_ZONED_FAN_SPEED_SETPOINT = 0x15400500;
-    field TIRAMISU_0 int ID_ZONED_FAN_SPEED_RPM = 0x1540050f;
-    field TIRAMISU_0 int ID_ZONED_FAN_DIRECTION_AVAILABLE = 0x15410511;
-    field TIRAMISU_0 int ID_ZONED_FAN_DIRECTION = 0x15400501;
-    field TIRAMISU_0 int ID_ZONED_SEAT_TEMP = 0x1540050b;
-    field TIRAMISU_0 int ID_ZONED_AC_ON = 0x15200505;
-    field TIRAMISU_0 int ID_ZONED_AUTOMATIC_MODE_ON = 0x1520050A;
-    field TIRAMISU_0 int ID_ZONED_AIR_RECIRCULATION_ON = 0x15200508;
-    field TIRAMISU_0 int ID_ZONED_MAX_AC_ON = 0x15200506;
-    field TIRAMISU_0 int ID_ZONED_DUAL_ZONE_ON = 0x15200509;
-    field TIRAMISU_0 int ID_ZONED_MAX_DEFROST_ON = 0x15200507;
-    field TIRAMISU_0 int ID_ZONED_HVAC_AUTO_RECIRC_ON = 0x15200512;
-    field TIRAMISU_0 int ID_WINDOW_DEFROSTER_ON = 0x13200504;
-    field TIRAMISU_0 int FAN_DIRECTION_FACE = 0x1;
-    field TIRAMISU_0 int FAN_DIRECTION_FLOOR = 0x2;
-    field TIRAMISU_0 int FAN_DIRECTION_DEFROST = 0x4;
-    method TIRAMISU_0 void registerCallback(CarHvacEventCallback callback);
-    method TIRAMISU_0 void unregisterCallback(CarHvacEventCallback callback);
-    method TIRAMISU_0 List<CarPropertyConfig> getPropertyList();
-    method TIRAMISU_0 boolean isPropertyAvailable(int propertyId, int area);
-    method TIRAMISU_0 boolean getBooleanProperty(int propertyId, int area);
-    method TIRAMISU_0 float getFloatProperty(int propertyId, int area);
-    method TIRAMISU_0 int getIntProperty(int propertyId, int area);
-    method TIRAMISU_0 void setBooleanProperty(int propertyId, int area, boolean val);
-    method TIRAMISU_0 void setFloatProperty(int propertyId, int area, float val);
-    method TIRAMISU_0 void setIntProperty(int propertyId, int area, int val);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface CarHvacManager.CarHvacEventCallback package android.car.hardware.hvac
-    method TIRAMISU_0 void onChangeEvent(CarPropertyValue value);
-    method TIRAMISU_0 void onErrorEvent(int propertyId, int zone);
-class @hide @SystemApi CarCabinManager package android.car.hardware.cabin
-    field TIRAMISU_0 int ID_DOOR_POS = 0x16400b00;
-    field TIRAMISU_0 int ID_DOOR_MOVE = 0x16400b01;
-    field TIRAMISU_0 int ID_DOOR_LOCK = 0x16200b02;
-    field TIRAMISU_0 int ID_MIRROR_Z_POS = 0x14400b40;
-    field TIRAMISU_0 int ID_MIRROR_Z_MOVE = 0x14400b41;
-    field TIRAMISU_0 int ID_MIRROR_Y_POS = 0x14400b42;
-    field TIRAMISU_0 int ID_MIRROR_Y_MOVE = 0x14400b43;
-    field TIRAMISU_0 int ID_MIRROR_LOCK = 0x11200b44;
-    field TIRAMISU_0 int ID_MIRROR_FOLD = 0x11200b45;
-    field TIRAMISU_0 int ID_SEAT_MEMORY_SELECT = 0x15400b80;
-    field TIRAMISU_0 int ID_SEAT_MEMORY_SET = 0x15400b81;
-    field TIRAMISU_0 int ID_SEAT_BELT_BUCKLED = 0x15200b82;
-    field TIRAMISU_0 int ID_SEAT_BELT_HEIGHT_POS = 0x15400b83;
-    field TIRAMISU_0 int ID_SEAT_BELT_HEIGHT_MOVE = 0x15400b84;
-    field TIRAMISU_0 int ID_SEAT_FORE_AFT_POS = 0x15400b85;
-    field TIRAMISU_0 int ID_SEAT_FORE_AFT_MOVE = 0x15400b86;
-    field TIRAMISU_0 int ID_SEAT_BACKREST_ANGLE_1_POS = 0x15400b87;
-    field TIRAMISU_0 int ID_SEAT_BACKREST_ANGLE_1_MOVE = 0x15400b88;
-    field TIRAMISU_0 int ID_SEAT_BACKREST_ANGLE_2_POS = 0x15400b89;
-    field TIRAMISU_0 int ID_SEAT_BACKREST_ANGLE_2_MOVE = 0x15400b8a;
-    field TIRAMISU_0 int ID_SEAT_HEIGHT_POS = 0x15400b8b;
-    field TIRAMISU_0 int ID_SEAT_HEIGHT_MOVE = 0x15400b8c;
-    field TIRAMISU_0 int ID_SEAT_DEPTH_POS = 0x15400b8d;
-    field TIRAMISU_0 int ID_SEAT_DEPTH_MOVE = 0x15400b8e;
-    field TIRAMISU_0 int ID_SEAT_TILT_POS = 0x15400b8f;
-    field TIRAMISU_0 int ID_SEAT_TILT_MOVE = 0x15400b90;
-    field TIRAMISU_0 int ID_SEAT_LUMBAR_FORE_AFT_POS = 0x15400b91;
-    field TIRAMISU_0 int ID_SEAT_LUMBAR_FORE_AFT_MOVE = 0x15400b92;
-    field TIRAMISU_0 int ID_SEAT_LUMBAR_SIDE_SUPPORT_POS = 0x15400b93;
-    field TIRAMISU_0 int ID_SEAT_LUMBAR_SIDE_SUPPORT_MOVE = 0x15400b94;
-    field TIRAMISU_0 int ID_SEAT_HEADREST_HEIGHT_POS = 0x15400b95;
-    field TIRAMISU_0 int ID_SEAT_HEADREST_HEIGHT_MOVE = 0x15400b96;
-    field TIRAMISU_0 int ID_SEAT_HEADREST_ANGLE_POS = 0x15400b97;
-    field TIRAMISU_0 int ID_SEAT_HEADREST_ANGLE_MOVE = 0x15400b98;
-    field TIRAMISU_0 int ID_SEAT_HEADREST_FORE_AFT_POS = 0x15400b99;
-    field TIRAMISU_0 int ID_SEAT_HEADREST_FORE_AFT_MOVE = 0x15400b9a;
-    field TIRAMISU_0 int ID_WINDOW_POS = 0x13400bc0;
-    field TIRAMISU_0 int ID_WINDOW_MOVE = 0x13400bc1;
-    field TIRAMISU_0 int ID_WINDOW_LOCK = 0x13400bc4;
-    method TIRAMISU_0 boolean isZonedProperty(int propertyId);
-    method TIRAMISU_0 void registerCallback(CarCabinEventCallback callback);
-    method TIRAMISU_0 void unregisterCallback(CarCabinEventCallback callback);
-    method TIRAMISU_0 List<CarPropertyConfig> getPropertyList();
-    method TIRAMISU_0 boolean getBooleanProperty(int propertyId, int area);
-    method TIRAMISU_0 float getFloatProperty(int propertyId, int area);
-    method TIRAMISU_0 int getIntProperty(int propertyId, int area);
-    method TIRAMISU_0 void setBooleanProperty(int propertyId, int area, boolean val);
-    method TIRAMISU_0 void setFloatProperty(int propertyId, int area, float val);
-    method TIRAMISU_0 void setIntProperty(int propertyId, int area, int val);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface CarCabinManager.CarCabinEventCallback package android.car.hardware.cabin
-    method TIRAMISU_0 void onChangeEvent(CarPropertyValue value);
-    method TIRAMISU_0 void onErrorEvent(int propertyId, int zone);
-class PropertyAccessDeniedSecurityException package android.car.hardware.property
-class EvChargingConnectorType package android.car.hardware.property
-    field TIRAMISU_0 int UNKNOWN = 0;
-    field TIRAMISU_0 int IEC_TYPE_1_AC = 1;
-    field TIRAMISU_0 int IEC_TYPE_2_AC = 2;
-    field TIRAMISU_0 int IEC_TYPE_3_AC = 3;
-    field TIRAMISU_0 int IEC_TYPE_4_DC = 4;
-    field TIRAMISU_0 int IEC_TYPE_1_CCS_DC = 5;
-    field TIRAMISU_0 int IEC_TYPE_2_CCS_DC = 6;
-    field TIRAMISU_0 int TESLA_ROADSTER = 7;
-    field TIRAMISU_0 int TESLA_HPWC = 8;
-    field TIRAMISU_0 int TESLA_SUPERCHARGER = 9;
-    field TIRAMISU_0 int GBT_AC = 10;
-    field TIRAMISU_0 int GBT_DC = 11;
-    field TIRAMISU_0 int OTHER = 101;
-    method TIRAMISU_0 String toString(int connectorType);
-class PropertyNotAvailableException package android.car.hardware.property
-class @hide @SystemApi VehicleVendorPermission package android.car.hardware.property
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_WINDOW = "android.car.permission.GET_CAR_VENDOR_CATEGORY_WINDOW";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_WINDOW = "android.car.permission.SET_CAR_VENDOR_CATEGORY_WINDOW";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_DOOR = "android.car.permission.GET_CAR_VENDOR_CATEGORY_DOOR";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_DOOR = "android.car.permission.SET_CAR_VENDOR_CATEGORY_DOOR";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_SEAT = "android.car.permission.GET_CAR_VENDOR_CATEGORY_SEAT";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_SEAT = "android.car.permission.SET_CAR_VENDOR_CATEGORY_SEAT";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_MIRROR = "android.car.permission.GET_CAR_VENDOR_CATEGORY_MIRROR";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_MIRROR = "android.car.permission.SET_CAR_VENDOR_CATEGORY_MIRROR";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_INFO = "android.car.permission.GET_CAR_VENDOR_CATEGORY_INFO";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_INFO = "android.car.permission.SET_CAR_VENDOR_CATEGORY_INFO";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_ENGINE = "android.car.permission.GET_CAR_VENDOR_CATEGORY_ENGINE";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_ENGINE = "android.car.permission.SET_CAR_VENDOR_CATEGORY_ENGINE";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_HVAC = "android.car.permission.GET_CAR_VENDOR_CATEGORY_HVAC";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_HVAC = "android.car.permission.SET_CAR_VENDOR_CATEGORY_HVAC";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_LIGHT = "android.car.permission.GET_CAR_VENDOR_CATEGORY_LIGHT";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_LIGHT = "android.car.permission.SET_CAR_VENDOR_CATEGORY_LIGHT";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_1 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_1";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_1 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_1";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_2 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_2";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_2 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_2";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_3 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_3";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_3 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_3";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_4 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_4";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_4 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_4";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_5 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_5";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_5 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_5";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_6 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_6";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_6 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_6";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_7 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_7";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_7 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_7";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_8 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_8";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_8 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_8";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_9 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_9";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_9 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_9";
-    field TIRAMISU_0 String PERMISSION_GET_CAR_VENDOR_CATEGORY_10 = "android.car.permission.GET_CAR_VENDOR_CATEGORY_10";
-    field TIRAMISU_0 String PERMISSION_SET_CAR_VENDOR_CATEGORY_10 = "android.car.permission.SET_CAR_VENDOR_CATEGORY_10";
-class VehicleElectronicTollCollectionCardStatus package android.car.hardware.property
-    field TIRAMISU_0 int UNKNOWN = 0;
-    field TIRAMISU_0 int ELECTRONIC_TOLL_COLLECTION_CARD_VALID = 1;
-    field TIRAMISU_0 int ELECTRONIC_TOLL_COLLECTION_CARD_INVALID = 2;
-    field TIRAMISU_0 int ELECTRONIC_TOLL_COLLECTION_CARD_NOT_INSERTED = 3;
-class @hiddenOnly @hide VehicleHalStatusCode package android.car.hardware.property
-    field TIRAMISU_0 int STATUS_OK = 0;
-    field TIRAMISU_0 int STATUS_TRY_AGAIN = 1;
-    field TIRAMISU_0 int STATUS_INVALID_ARG = 2;
-    field TIRAMISU_0 int STATUS_NOT_AVAILABLE = 3;
-    field TIRAMISU_0 int STATUS_ACCESS_DENIED = 4;
-    field TIRAMISU_0 int STATUS_INTERNAL_ERROR = 5;
-class PropertyNotAvailableAndRetryException package android.car.hardware.property
-class VehicleElectronicTollCollectionCardType package android.car.hardware.property
-    field TIRAMISU_0 int UNKNOWN = 0;
-    field TIRAMISU_0 int JP_ELECTRONIC_TOLL_COLLECTION_CARD = 1;
-    field TIRAMISU_0 int JP_ELECTRONIC_TOLL_COLLECTION_CARD_V2 = 2;
-class CarInternalErrorException package android.car.hardware.property
-class @hiddenOnly @hide CarPropertyEvent package android.car.hardware.property
-    field TIRAMISU_0 int PROPERTY_EVENT_PROPERTY_CHANGE = 0;
-    field TIRAMISU_0 int PROPERTY_EVENT_ERROR = 1;
-    field TIRAMISU_0 Parcelable.Creator<CarPropertyEvent> CREATOR;
-    method TIRAMISU_0 int getEventType();
-    method TIRAMISU_0 CarPropertyValue<?> getCarPropertyValue();
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 CarPropertyEvent createErrorEventWithErrorCode(int propertyId, int areaId, int errorCode);
-    method TIRAMISU_0 int getErrorCode();
-    method TIRAMISU_0 String toString();
-class CarPropertyManager package android.car.hardware.property
-    field TIRAMISU_0 float SENSOR_RATE_ONCHANGE = 0f;
-    field TIRAMISU_0 float SENSOR_RATE_NORMAL = 1f;
-    field TIRAMISU_0 float SENSOR_RATE_UI = 5f;
-    field TIRAMISU_0 float SENSOR_RATE_FAST = 10f;
-    field TIRAMISU_0 float SENSOR_RATE_FASTEST = 100f;
-    field TIRAMISU_0 int CAR_SET_PROPERTY_ERROR_CODE_TRY_AGAIN = 1;
-    field TIRAMISU_0 int CAR_SET_PROPERTY_ERROR_CODE_INVALID_ARG = 2;
-    field TIRAMISU_0 int CAR_SET_PROPERTY_ERROR_CODE_PROPERTY_NOT_AVAILABLE = 3;
-    field TIRAMISU_0 int CAR_SET_PROPERTY_ERROR_CODE_ACCESS_DENIED = 4;
-    field TIRAMISU_0 int CAR_SET_PROPERTY_ERROR_CODE_UNKNOWN = 5;
-    method TIRAMISU_0 boolean registerCallback(CarPropertyEventCallback carPropertyEventCallback, int propertyId, float updateRateHz);
-    method TIRAMISU_0 void unregisterCallback(CarPropertyEventCallback carPropertyEventCallback);
-    method TIRAMISU_0 void unregisterCallback(CarPropertyEventCallback carPropertyEventCallback, int propertyId);
-    method TIRAMISU_0 List<CarPropertyConfig> getPropertyList();
-    method TIRAMISU_0 List<CarPropertyConfig> getPropertyList(ArraySet<Integer> propertyIds);
-    method TIRAMISU_0 CarPropertyConfig<?> getCarPropertyConfig(int propId);
-    method TIRAMISU_0 int getAreaId(int propId, int area);
-    method TIRAMISU_0 @hiddenOnly String getReadPermission(int propId);
-    method TIRAMISU_0 @hiddenOnly String getWritePermission(int propId);
-    method TIRAMISU_0 boolean isPropertyAvailable(int propId, int area);
-    method TIRAMISU_0 boolean getBooleanProperty(int prop, int area);
-    method TIRAMISU_0 float getFloatProperty(int prop, int area);
-    method TIRAMISU_0 int getIntProperty(int prop, int area);
-    method TIRAMISU_0 int[] getIntArrayProperty(int prop, int area);
-    method TIRAMISU_0 CarPropertyValue<E> getProperty(Class<E> clazz, int propId, int areaId);
-    method TIRAMISU_0 CarPropertyValue<E> getProperty(int propId, int areaId);
-    method TIRAMISU_0 void setProperty(Class<E> clazz, int propId, int areaId, E val);
-    method TIRAMISU_0 void setBooleanProperty(int prop, int areaId, boolean val);
-    method TIRAMISU_0 void setFloatProperty(int prop, int areaId, float val);
-    method TIRAMISU_0 void setIntProperty(int prop, int areaId, int val);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface CarPropertyManager.CarPropertyEventCallback package android.car.hardware.property
-    method TIRAMISU_0 void onChangeEvent(CarPropertyValue value);
-    method TIRAMISU_0 void onErrorEvent(int propId, int zone);
-    method TIRAMISU_0 void onErrorEvent(int propId, int areaId, int errorCode);
-class CarPowerManager package android.car.hardware.power
-    field TIRAMISU_0 @hiddenOnly String TAG = CarPowerManager.class.getSimpleName();
-    field TIRAMISU_0 int STATE_INVALID = 0;
-    field TIRAMISU_0 int STATE_WAIT_FOR_VHAL = 1;
-    field TIRAMISU_0 int STATE_SUSPEND_ENTER = 2;
-    field TIRAMISU_0 int STATE_SUSPEND_EXIT = 3;
-    field TIRAMISU_0 int STATE_SHUTDOWN_ENTER = 5;
-    field TIRAMISU_0 int STATE_ON = 6;
-    field TIRAMISU_0 int STATE_SHUTDOWN_PREPARE = 7;
-    field TIRAMISU_0 int STATE_SHUTDOWN_CANCELLED = 8;
-    field TIRAMISU_0 int STATE_HIBERNATION_ENTER = 9;
-    field TIRAMISU_0 int STATE_HIBERNATION_EXIT = 10;
-    field TIRAMISU_0 int STATE_PRE_SHUTDOWN_PREPARE = 11;
-    field TIRAMISU_0 int STATE_POST_SUSPEND_ENTER = 12;
-    field TIRAMISU_0 int STATE_POST_SHUTDOWN_ENTER = 13;
-    field TIRAMISU_0 int STATE_POST_HIBERNATION_ENTER = 14;
-    method TIRAMISU_0 @hiddenOnly void requestShutdownOnNextSuspend();
-    method TIRAMISU_0 @hiddenOnly void scheduleNextWakeupTime(int seconds);
-    method TIRAMISU_0 int getPowerState();
-    method TIRAMISU_0 void setListener(Executor executor, CarPowerStateListener listener);
-    method TIRAMISU_0 void setListenerWithCompletion(Executor executor, CarPowerStateListenerWithCompletion listener);
-    method TIRAMISU_0 void clearListener();
-    method TIRAMISU_0 CarPowerPolicy getCurrentPowerPolicy();
-    method TIRAMISU_0 void applyPowerPolicy(String policyId);
-    method TIRAMISU_0 void setPowerPolicyGroup(String policyGroupId);
-    method TIRAMISU_0 void addPowerPolicyListener(Executor executor, CarPowerPolicyFilter filter, CarPowerPolicyListener listener);
-    method TIRAMISU_0 void removePowerPolicyListener(CarPowerPolicyListener listener);
-    method TIRAMISU_0 @hiddenOnly boolean isCompletionAllowed(int state);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface @hide @SystemApi CarPowerManager.CompletablePowerStateChangeFuture package android.car.hardware.power
-    method TIRAMISU_0 void complete();
-    method TIRAMISU_0 long getExpirationTime();
-interface @hide @SystemApi CarPowerManager.CarPowerStateListener package android.car.hardware.power
-    method TIRAMISU_0 void onStateChanged(int state);
-interface @hide @SystemApi CarPowerManager.CarPowerStateListenerWithCompletion package android.car.hardware.power
-    method TIRAMISU_0 void onStateChanged(int state, CompletablePowerStateChangeFuture future);
-interface CarPowerManager.CarPowerPolicyListener package android.car.hardware.power
-    method TIRAMISU_0 void onPolicyChanged(CarPowerPolicy policy);
-class @hiddenOnly @hide PowerComponentUtil package android.car.hardware.power
-    field TIRAMISU_0 int COMPONENT_STATE_ENABLED = 1;
-    field TIRAMISU_0 int COMPONENT_STATE_DISABLED = 2;
-    field TIRAMISU_0 int COMPONENT_STATE_UNTOUCHED = 3;
-    field TIRAMISU_0 int INVALID_POWER_COMPONENT = -1;
-    field TIRAMISU_0 int FIRST_POWER_COMPONENT = PowerComponent.AUDIO;
-    field TIRAMISU_0 int LAST_POWER_COMPONENT = PowerComponent.CPU;
-    method TIRAMISU_0 boolean isValidPowerComponent(int component);
-    method TIRAMISU_0 boolean hasComponents(CarPowerPolicy policy, CarPowerPolicyFilter filter);
-    method TIRAMISU_0 int toPowerComponent(String component, boolean prefix);
-    method TIRAMISU_0 String powerComponentToString(int component);
-class CarPowerPolicy package android.car.hardware.power
-    field TIRAMISU_0 Parcelable.Creator<CarPowerPolicy> CREATOR;
-    method TIRAMISU_0 boolean isComponentEnabled(int component);
-    method TIRAMISU_0 String getPolicyId();
-    method TIRAMISU_0 int[] getEnabledComponents();
-    method TIRAMISU_0 int[] getDisabledComponents();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class CarPowerPolicyFilter package android.car.hardware.power
-    field TIRAMISU_0 Parcelable.Creator<CarPowerPolicyFilter> CREATOR;
-    method TIRAMISU_0 int[] getComponents();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class CarPowerPolicyFilter.Builder package android.car.hardware.power
-    method TIRAMISU_0 Builder setComponents(int value);
-    method TIRAMISU_0 CarPowerPolicyFilter build();
-class @hiddenOnly @hide CarFeatures package android.car
-    field TIRAMISU_0 @hiddenOnly String FEATURE_CAR_USER_NOTICE_SERVICE = "com.android.car.user.CarUserNoticeService";
-    method TIRAMISU_0 @hiddenOnly boolean isFeatureEnabled(ICar service, String featureName);
-    method TIRAMISU_0 @hiddenOnly void resetCache();
-class Car package android.car
-    field TIRAMISU_0 int API_VERSION_MAJOR_INT = 33;
-    field TIRAMISU_0 int API_VERSION_MINOR_INT = 1;
-    field TIRAMISU_0 int PLATFORM_VERSION_MINOR_INT = SystemProperties.getInt(PROPERTY_PLATFORM_MINOR_VERSION, /* def= */
-0);
-    field  @hiddenOnly String PROPERTY_EMULATED_PLATFORM_VERSION_MAJOR = "com.android.car.internal.debug.platform_major_version";
-    field  @hiddenOnly String PROPERTY_EMULATED_PLATFORM_VERSION_MINOR = "com.android.car.internal.debug.platform_minor_version";
-    field TIRAMISU_0 @hiddenOnly String CAR_SERVICE_BINDER_SERVICE_NAME = "car_service";
-    field TIRAMISU_0 String META_DATA_DISTRACTION_OPTIMIZED = "distractionOptimized";
-    field TIRAMISU_0 String META_DATA_REQUIRES_CAR_FEATURE = "requires-car-feature";
-    field TIRAMISU_0 String SENSOR_SERVICE = "sensor";
-    field TIRAMISU_0 String INFO_SERVICE = "info";
-    field TIRAMISU_0 String APP_FOCUS_SERVICE = "app_focus";
-    field TIRAMISU_0 String PACKAGE_SERVICE = "package";
-    field TIRAMISU_0 String AUDIO_SERVICE = "audio";
-    field TIRAMISU_0 String CAR_NAVIGATION_SERVICE = "car_navigation_service";
-    field TIRAMISU_0 String CAR_OCCUPANT_ZONE_SERVICE = "car_occupant_zone_service";
-    field TIRAMISU_0 String CAR_USER_SERVICE = "car_user_service";
-    field TIRAMISU_0 @hiddenOnly String EXPERIMENTAL_CAR_USER_SERVICE = "experimental_car_user_service";
-    field TIRAMISU_0 String CAR_DEVICE_POLICY_SERVICE = "car_device_policy_service";
-    field TIRAMISU_0 @hiddenOnly String CAR_INSTRUMENT_CLUSTER_SERVICE = "cluster_service";
-    field TIRAMISU_0 String CABIN_SERVICE = "cabin";
-    field TIRAMISU_0 String DIAGNOSTIC_SERVICE = "diagnostic";
-    field TIRAMISU_0 String HVAC_SERVICE = "hvac";
-    field TIRAMISU_0 String POWER_SERVICE = "power";
-    field TIRAMISU_0 String PROJECTION_SERVICE = "projection";
-    field TIRAMISU_0 String PROPERTY_SERVICE = "property";
-    field TIRAMISU_0 String VENDOR_EXTENSION_SERVICE = "vendor_extension";
-    field TIRAMISU_0 String VEHICLE_MAP_SERVICE = "vehicle_map_service";
-    field TIRAMISU_0 String VMS_SUBSCRIBER_SERVICE = "vehicle_map_subscriber_service";
-    field TIRAMISU_0 String CAR_DRIVING_STATE_SERVICE = "drivingstate";
-    field TIRAMISU_0 String CAR_UX_RESTRICTION_SERVICE = "uxrestriction";
-    field TIRAMISU_0 String OCCUPANT_AWARENESS_SERVICE = "occupant_awareness";
-    field TIRAMISU_0 String CAR_MEDIA_SERVICE = "car_media";
-    field TIRAMISU_0 String CAR_BUGREPORT_SERVICE = "car_bugreport";
-    field TIRAMISU_0 String STORAGE_MONITORING_SERVICE = "storage_monitoring";
-    field TIRAMISU_0 String CAR_WATCHDOG_SERVICE = "car_watchdog";
-    field TIRAMISU_0 String CAR_PERFORMANCE_SERVICE = "car_performance";
-    field TIRAMISU_0 String CAR_INPUT_SERVICE = "android.car.input";
-    field TIRAMISU_0 @hiddenOnly String CLUSTER_HOME_SERVICE = "cluster_home_service";
-    field TIRAMISU_0 String TEST_SERVICE = "car-service-test";
-    field TIRAMISU_0 String CAR_EVS_SERVICE = "car_evs_service";
-    field TIRAMISU_0 String CAR_TELEMETRY_SERVICE = "car_telemetry_service";
-    field TIRAMISU_0 String CAR_ACTIVITY_SERVICE = "car_activity_service";
-    field TIRAMISU_0 String PERMISSION_MILEAGE = "android.car.permission.CAR_MILEAGE";
-    field TIRAMISU_0 String PERMISSION_ENERGY = "android.car.permission.CAR_ENERGY";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_ENERGY = "android.car.permission.CONTROL_CAR_ENERGY";
-    field TIRAMISU_0 String PERMISSION_ADJUST_RANGE_REMAINING = "android.car.permission.ADJUST_RANGE_REMAINING";
-    field TIRAMISU_0 String PERMISSION_IDENTIFICATION = "android.car.permission.CAR_IDENTIFICATION";
-    field TIRAMISU_0 String PERMISSION_SPEED = "android.car.permission.CAR_SPEED";
-    field TIRAMISU_0 String PERMISSION_CAR_DYNAMICS_STATE = "android.car.permission.CAR_DYNAMICS_STATE";
-    field TIRAMISU_0 String PERMISSION_ENERGY_PORTS = "android.car.permission.CAR_ENERGY_PORTS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_ENERGY_PORTS = "android.car.permission.CONTROL_CAR_ENERGY_PORTS";
-    field TIRAMISU_0 String PERMISSION_EXTERIOR_LIGHTS = "android.car.permission.CAR_EXTERIOR_LIGHTS";
-    field TIRAMISU_0 String PERMISSION_READ_INTERIOR_LIGHTS = "android.car.permission.READ_CAR_INTERIOR_LIGHTS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_EXTERIOR_LIGHTS = "android.car.permission.CONTROL_CAR_EXTERIOR_LIGHTS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_INTERIOR_LIGHTS = "android.car.permission.CONTROL_CAR_INTERIOR_LIGHTS";
-    field TIRAMISU_0 String PERMISSION_POWERTRAIN = "android.car.permission.CAR_POWERTRAIN";
-    field TIRAMISU_0 String PERMISSION_CAR_CONTROL_AUDIO_VOLUME = "android.car.permission.CAR_CONTROL_AUDIO_VOLUME";
-    field TIRAMISU_0 String PERMISSION_CAR_CONTROL_AUDIO_SETTINGS = "android.car.permission.CAR_CONTROL_AUDIO_SETTINGS";
-    field TIRAMISU_0 String PERMISSION_RECEIVE_CAR_AUDIO_DUCKING_EVENTS = "android.car.permission.RECEIVE_CAR_AUDIO_DUCKING_EVENTS";
-    field TIRAMISU_0 String PERMISSION_CAR_NAVIGATION_MANAGER = "android.car.permission.CAR_NAVIGATION_MANAGER";
-    field TIRAMISU_0 String PERMISSION_CAR_INSTRUMENT_CLUSTER_CONTROL = "android.car.permission.CAR_INSTRUMENT_CLUSTER_CONTROL";
-    field TIRAMISU_0 @hiddenOnly String PERMISSION_CAR_MONITOR_CLUSTER_NAVIGATION_STATE = "android.car.permission.CAR_MONITOR_CLUSTER_NAVIGATION_STATE";
-    field TIRAMISU_0 @hiddenOnly String PERMISSION_CAR_DISPLAY_IN_CLUSTER = "android.car.permission.CAR_DISPLAY_IN_CLUSTER";
-    field TIRAMISU_0 String PERMISSION_CAR_INFO = "android.car.permission.CAR_INFO";
-    field TIRAMISU_0 String PERMISSION_PRIVILEGED_CAR_INFO = "android.car.permission.PRIVILEGED_CAR_INFO";
-    field TIRAMISU_0 String PERMISSION_READ_CAR_VENDOR_PERMISSION_INFO = "android.car.permission.READ_CAR_VENDOR_PERMISSION_INFO";
-    field TIRAMISU_0 String PERMISSION_EXTERIOR_ENVIRONMENT = "android.car.permission.CAR_EXTERIOR_ENVIRONMENT";
-    field TIRAMISU_0 String PERMISSION_VENDOR_EXTENSION = "android.car.permission.CAR_VENDOR_EXTENSION";
-    field TIRAMISU_0 String PERMISSION_CONTROL_APP_BLOCKING = "android.car.permission.CONTROL_APP_BLOCKING";
-    field TIRAMISU_0 String PERMISSION_CAR_ENGINE_DETAILED = "android.car.permission.CAR_ENGINE_DETAILED";
-    field TIRAMISU_0 String PERMISSION_TIRES = "android.car.permission.CAR_TIRES";
-    field TIRAMISU_0 String PERMISSION_CAR_EPOCH_TIME = "android.car.permission.CAR_EPOCH_TIME";
-    field TIRAMISU_0 String PERMISSION_STORAGE_ENCRYPTION_BINDING_SEED = "android.car.permission.STORAGE_ENCRYPTION_BINDING_SEED";
-    field TIRAMISU_0 String PERMISSION_READ_STEERING_STATE = "android.car.permission.READ_CAR_STEERING";
-    field TIRAMISU_0 String PERMISSION_READ_DISPLAY_UNITS = "android.car.permission.READ_CAR_DISPLAY_UNITS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_DISPLAY_UNITS = "android.car.permission.CONTROL_CAR_DISPLAY_UNITS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_DOORS = "android.car.permission.CONTROL_CAR_DOORS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_WINDOWS = "android.car.permission.CONTROL_CAR_WINDOWS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_SEATS = "android.car.permission.CONTROL_CAR_SEATS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_MIRRORS = "android.car.permission.CONTROL_CAR_MIRRORS";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_CLIMATE = "android.car.permission.CONTROL_CAR_CLIMATE";
-    field TIRAMISU_0 String PERMISSION_CAR_POWER = "android.car.permission.CAR_POWER";
-    field TIRAMISU_0 String PERMISSION_READ_CAR_POWER_POLICY = "android.car.permission.READ_CAR_POWER_POLICY";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_POWER_POLICY = "android.car.permission.CONTROL_CAR_POWER_POLICY";
-    field TIRAMISU_0 String PERMISSION_CONTROL_SHUTDOWN_PROCESS = "android.car.permission.CONTROL_SHUTDOWN_PROCESS";
-    field TIRAMISU_0 String PERMISSION_CAR_PROJECTION = "android.car.permission.CAR_PROJECTION";
-    field TIRAMISU_0 String PERMISSION_CAR_PROJECTION_STATUS = "android.car.permission.ACCESS_CAR_PROJECTION_STATUS";
-    field TIRAMISU_0 String PERMISSION_MOCK_VEHICLE_HAL = "android.car.permission.CAR_MOCK_VEHICLE_HAL";
-    field TIRAMISU_0 String PERMISSION_CAR_TEST_SERVICE = "android.car.permission.CAR_TEST_SERVICE";
-    field TIRAMISU_0 String PERMISSION_CAR_DRIVING_STATE = "android.car.permission.CAR_DRIVING_STATE";
-    field TIRAMISU_0 @hiddenOnly String PERMISSION_BIND_VMS_CLIENT = "android.car.permission.BIND_VMS_CLIENT";
-    field TIRAMISU_0 String PERMISSION_VMS_PUBLISHER = "android.car.permission.VMS_PUBLISHER";
-    field TIRAMISU_0 String PERMISSION_VMS_SUBSCRIBER = "android.car.permission.VMS_SUBSCRIBER";
-    field TIRAMISU_0 String PERMISSION_CAR_DIAGNOSTIC_READ_ALL = "android.car.permission.CAR_DIAGNOSTICS";
-    field TIRAMISU_0 String PERMISSION_CAR_DIAGNOSTIC_CLEAR = "android.car.permission.CLEAR_CAR_DIAGNOSTICS";
-    field TIRAMISU_0 @hiddenOnly String PERMISSION_CAR_UX_RESTRICTIONS_CONFIGURATION = "android.car.permission.CAR_UX_RESTRICTIONS_CONFIGURATION";
-    field TIRAMISU_0 String PERMISSION_READ_CAR_OCCUPANT_AWARENESS_STATE = "android.car.permission.READ_CAR_OCCUPANT_AWARENESS_STATE";
-    field TIRAMISU_0 String ACCESS_PRIVATE_DISPLAY_ID = "android.car.permission.ACCESS_PRIVATE_DISPLAY_ID";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_OCCUPANT_AWARENESS_SYSTEM = "android.car.permission.CONTROL_CAR_OCCUPANT_AWARENESS_SYSTEM";
-    field TIRAMISU_0 String PERMISSION_STORAGE_MONITORING = "android.car.permission.STORAGE_MONITORING";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_FEATURES = "android.car.permission.CONTROL_CAR_FEATURES";
-    field TIRAMISU_0 String PERMISSION_USE_CAR_WATCHDOG = "android.car.permission.USE_CAR_WATCHDOG";
-    field TIRAMISU_0 String PERMISSION_CAR_MONITOR_INPUT = "android.car.permission.CAR_MONITOR_INPUT";
-    field TIRAMISU_0 String PERMISSION_REQUEST_CAR_EVS_ACTIVITY = "android.car.permission.REQUEST_CAR_EVS_ACTIVITY";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_EVS_ACTIVITY = "android.car.permission.CONTROL_CAR_EVS_ACTIVITY";
-    field TIRAMISU_0 String PERMISSION_USE_CAR_EVS_CAMERA = "android.car.permission.USE_CAR_EVS_CAMERA";
-    field TIRAMISU_0 String PERMISSION_MONITOR_CAR_EVS_STATUS = "android.car.permission.MONITOR_CAR_EVS_STATUS";
-    field TIRAMISU_0 String PERMISSION_USE_CAR_TELEMETRY_SERVICE = "android.car.permission.USE_CAR_TELEMETRY_SERVICE";
-    field TIRAMISU_0 int CONNECTION_TYPE_EMBEDDED = 5;
-    field TIRAMISU_0 String PERMISSION_TEMPLATE_RENDERER = "android.car.permission.TEMPLATE_RENDERER";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_WATCHDOG_CONFIG = "android.car.permission.CONTROL_CAR_WATCHDOG_CONFIG";
-    field TIRAMISU_0 String PERMISSION_COLLECT_CAR_WATCHDOG_METRICS = "android.car.permission.COLLECT_CAR_WATCHDOG_METRICS";
-    field TIRAMISU_0 @hiddenOnly String PERMISSION_COLLECT_CAR_CPU_INFO = "android.car.permission.COLLECT_CAR_CPU_INFO";
-    field TIRAMISU_0 String PERMISSION_CONTROL_CAR_APP_LAUNCH = "android.car.permission.CONTROL_CAR_APP_LAUNCH";
-    field TIRAMISU_1 String PERMISSION_MANAGE_THREAD_PRIORITY = "android.car.permission.MANAGE_THREAD_PRIORITY";
-    field TIRAMISU_0 @hiddenOnly String CAR_TEMPLATE_HOST_RENDERER_SERVICE = "android.car.template.host.RendererService";
-    field TIRAMISU_0 String CAR_INTENT_ACTION_MEDIA_TEMPLATE = "android.car.intent.action.MEDIA_TEMPLATE";
-    field TIRAMISU_0 String CAR_EXTRA_MEDIA_COMPONENT = "android.car.intent.extra.MEDIA_COMPONENT";
-    field TIRAMISU_0 String CAR_EXTRA_MEDIA_PACKAGE = "android.car.intent.extra.MEDIA_PACKAGE";
-    field TIRAMISU_0 String CAR_EXTRA_BROWSE_SERVICE_FOR_SESSION = "android.media.session.BROWSE_SERVICE";
-    field TIRAMISU_0 @hiddenOnly String CAR_SERVICE_INTERFACE_NAME = CommonConstants.CAR_SERVICE_INTERFACE;
-    field TIRAMISU_0 @hiddenOnly String CAR_CATEGORY_NAVIGATION = "android.car.cluster.NAVIGATION";
-    field TIRAMISU_0 String CAR_EXTRA_CLUSTER_ACTIVITY_STATE = "android.car.cluster.ClusterActivityState";
-    field TIRAMISU_0 long CAR_WAIT_TIMEOUT_WAIT_FOREVER = -1;
-    field TIRAMISU_0 long CAR_WAIT_TIMEOUT_DO_NOT_WAIT = 0;
-    field TIRAMISU_0 int FEATURE_REQUEST_SUCCESS = 0;
-    field TIRAMISU_0 int FEATURE_REQUEST_ALREADY_IN_THE_STATE = 1;
-    field TIRAMISU_0 int FEATURE_REQUEST_MANDATORY = 2;
-    field TIRAMISU_0 int FEATURE_REQUEST_NOT_EXISTING = 3;
-    method TIRAMISU_1 android.car.CarVersion getCarVersion();
-    method TIRAMISU_1 android.car.PlatformVersion getPlatformVersion();
-    method TIRAMISU_0 boolean isApiVersionAtLeast(int requiredApiVersionMajor);
-    method TIRAMISU_0 boolean isApiVersionAtLeast(int requiredApiVersionMajor, int requiredApiVersionMinor);
-    method TIRAMISU_0 boolean isApiAndPlatformVersionAtLeast(int requiredApiVersionMajor, int minPlatformSdkInt);
-    method TIRAMISU_0 boolean isApiAndPlatformVersionAtLeast(int requiredApiVersionMajor, int requiredApiVersionMinor, int minPlatformSdkInt);
-    method TIRAMISU_0 Car createCar(Context context, ServiceConnection serviceConnectionListener, Handler handler);
-    method TIRAMISU_0 Car createCar(Context context, ServiceConnection serviceConnectionListener);
-    method TIRAMISU_0 Car createCar(Context context);
-    method TIRAMISU_0 Car createCar(Context context, Handler handler);
-    method TIRAMISU_0 Car createCar(Context context, Handler handler, long waitTimeoutMs, CarServiceLifecycleListener statusChangeListener);
-    method TIRAMISU_0 void connect();
-    method TIRAMISU_0 void disconnect();
-    method TIRAMISU_0 boolean isConnected();
-    method TIRAMISU_0 boolean isConnecting();
-    method TIRAMISU_0 @hiddenOnly ServiceConnection getServiceConnectionListener();
-    method TIRAMISU_0 Object getCarManager(String serviceName);
-    method TIRAMISU_0 int getCarConnectionType();
-    method TIRAMISU_0 boolean isFeatureEnabled(String featureName);
-    method TIRAMISU_0 int enableFeature(String featureName);
-    method TIRAMISU_0 int disableFeature(String featureName);
-    method TIRAMISU_0 List<String> getAllEnabledFeatures();
-    method TIRAMISU_0 List<String> getAllPendingDisabledFeatures();
-    method TIRAMISU_0 List<String> getAllPendingEnabledFeatures();
-    method TIRAMISU_0 @hiddenOnly Context getContext();
-    method TIRAMISU_0 @hiddenOnly Handler getEventHandler();
-    method TIRAMISU_0 @hiddenOnly T handleRemoteExceptionFromCarService(RemoteException e, T returnValue);
-    method TIRAMISU_0 @hiddenOnly void handleRemoteExceptionFromCarService(RemoteException e);
-    method TIRAMISU_0 @hiddenOnly T handleRemoteExceptionFromCarService(Service service, RemoteException e, T returnValue);
-    method TIRAMISU_0 @hiddenOnly void handleRemoteExceptionFromCarService(Service service, RemoteException e);
-interface Car.CarServiceLifecycleListener package android.car
-    method TIRAMISU_0 void onLifecycleChanged(Car car, boolean ready);
-class @hide @SystemApi CarTelemetryManager package android.car.telemetry
-    field TIRAMISU_0 int STATUS_ADD_METRICS_CONFIG_SUCCEEDED = 0;
-    field TIRAMISU_0 int STATUS_ADD_METRICS_CONFIG_ALREADY_EXISTS = 1;
-    field TIRAMISU_0 int STATUS_ADD_METRICS_CONFIG_VERSION_TOO_OLD = 2;
-    field TIRAMISU_0 int STATUS_ADD_METRICS_CONFIG_PARSE_FAILED = 3;
-    field TIRAMISU_0 int STATUS_ADD_METRICS_CONFIG_SIGNATURE_VERIFICATION_FAILED = 4;
-    field TIRAMISU_0 int STATUS_ADD_METRICS_CONFIG_UNKNOWN = 5;
-    field TIRAMISU_0 int STATUS_GET_METRICS_CONFIG_FINISHED = 0;
-    field TIRAMISU_0 int STATUS_GET_METRICS_CONFIG_PENDING = 1;
-    field TIRAMISU_0 int STATUS_GET_METRICS_CONFIG_INTERIM_RESULTS = 2;
-    field TIRAMISU_0 int STATUS_GET_METRICS_CONFIG_RUNTIME_ERROR = 3;
-    field TIRAMISU_0 int STATUS_GET_METRICS_CONFIG_DOES_NOT_EXIST = 4;
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 void addMetricsConfig(String metricsConfigName, byte[] metricsConfig, Executor executor, AddMetricsConfigCallback callback);
-    method TIRAMISU_0 void removeMetricsConfig(String metricsConfigName);
-    method TIRAMISU_0 void removeAllMetricsConfigs();
-    method TIRAMISU_0 void getFinishedReport(String metricsConfigName, Executor executor, MetricsReportCallback callback);
-    method TIRAMISU_0 void getAllFinishedReports(Executor executor, MetricsReportCallback callback);
-    method TIRAMISU_0 void setReportReadyListener(Executor executor, ReportReadyListener listener);
-    method TIRAMISU_0 void clearReportReadyListener();
-interface @hide @SystemApi CarTelemetryManager.AddMetricsConfigCallback package android.car.telemetry
-    method TIRAMISU_0 void onAddMetricsConfigStatus(String metricsConfigName, int statusCode);
-interface @hide @SystemApi CarTelemetryManager.MetricsReportCallback package android.car.telemetry
-    method TIRAMISU_0 void onResult(String metricsConfigName, PersistableBundle report, byte[] telemetryError, int status);
-interface @hide @SystemApi CarTelemetryManager.ReportReadyListener package android.car.telemetry
-    method TIRAMISU_0 void onReady(String metricsConfigName);
-class @hide @SystemApi ClusterActivityState package android.car.cluster
-    method TIRAMISU_0 boolean isVisible();
-    method TIRAMISU_0 Rect getUnobscuredBounds();
-    method TIRAMISU_0 Bundle getExtras();
-    method TIRAMISU_0 ClusterActivityState setVisible(boolean visible);
-    method TIRAMISU_0 ClusterActivityState setUnobscuredBounds(Rect unobscuredBounds);
-    method TIRAMISU_0 ClusterActivityState setExtras(Bundle bundle);
-    method TIRAMISU_0 ClusterActivityState create(boolean visible, Rect unobscuredBounds);
-    method TIRAMISU_0 ClusterActivityState fromBundle(Bundle bundle);
-    method TIRAMISU_0 Bundle toBundle();
-    method TIRAMISU_0 String toString();
-class @hide @SystemApi NavigationRenderer package android.car.cluster.renderer
-    method TIRAMISU_0 CarNavigationInstrumentCluster getNavigationProperties();
-    method TIRAMISU_0 void onEvent(int eventType, Bundle bundle);
-    method TIRAMISU_0 void onNavigationStateChanged(Bundle bundle);
-class @hide @SystemApi InstrumentClusterRenderer package android.car.cluster.renderer
-    method TIRAMISU_0 void onCreate(Context context);
-    method TIRAMISU_0 void onStart();
-    method TIRAMISU_0 void onStop();
-    method TIRAMISU_0 NavigationRenderer createNavigationRenderer();
-    method TIRAMISU_0 NavigationRenderer getNavigationRenderer();
-    method TIRAMISU_0 void initialize();
-class @hide @SystemApi InstrumentClusterRenderingService package android.car.cluster.renderer
-    field TIRAMISU_0 @hiddenOnly String EXTRA_BUNDLE_KEY_FOR_INSTRUMENT_CLUSTER_HELPER = "android.car.cluster.renderer.IInstrumentClusterHelper";
-    method TIRAMISU_0 IBinder onBind(Intent intent);
-    method TIRAMISU_0 NavigationRenderer getNavigationRenderer();
-    method TIRAMISU_0 void onKeyEvent(KeyEvent keyEvent);
-    method TIRAMISU_0 void onNavigationComponentLaunched();
-    method TIRAMISU_0 void onNavigationComponentReleased();
-    method TIRAMISU_0 boolean startFixedActivityModeForDisplayAndUser(Intent intent, ActivityOptions options, int userId);
-    method TIRAMISU_0 void stopFixedActivityMode(int displayId);
-    method TIRAMISU_0 @hiddenOnly ComponentName getComponentFromPackage(String packageName);
-    method TIRAMISU_0 boolean startNavigationActivity(ComponentName component);
-    method TIRAMISU_0 @hiddenOnly void setClusterActivityLaunchOptions(String category, ActivityOptions activityOptions);
-    method TIRAMISU_0 void setClusterActivityLaunchOptions(ActivityOptions activityOptions);
-    method TIRAMISU_0 @hiddenOnly void setClusterActivityState(String category, Bundle state);
-    method TIRAMISU_0 void setClusterActivityState(ClusterActivityState state);
-    method TIRAMISU_0 void dump(FileDescriptor fd, PrintWriter writer, String[] args);
-    method TIRAMISU_0 Bitmap getBitmap(Uri uri);
-    method TIRAMISU_0 Bitmap getBitmap(Uri uri, int width, int height);
-    method TIRAMISU_0 Bitmap getBitmap(Uri uri, int width, int height, float offLanesAlpha);
-class @hide @SystemApi CarInstrumentClusterManager package android.car.cluster
-    field TIRAMISU_0 String CATEGORY_NAVIGATION = "android.car.cluster.NAVIGATION";
-    field TIRAMISU_0 String KEY_EXTRA_ACTIVITY_STATE = "android.car.cluster.ClusterActivityState";
-    method TIRAMISU_0 void startActivity(Intent intent);
-    method TIRAMISU_0 void registerCallback(String category, Callback callback);
-    method TIRAMISU_0 void unregisterCallback(Callback callback);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface @hide @SystemApi CarInstrumentClusterManager.Callback package android.car.cluster
-    method TIRAMISU_0 void onClusterActivityStateChanged(String category, Bundle clusterActivityState);
-class @hiddenOnly @hide ClusterHomeManager package android.car.cluster
-    field TIRAMISU_0 int UI_TYPE_CLUSTER_NONE = -1;
-    field TIRAMISU_0 int UI_TYPE_CLUSTER_HOME = 0;
-    field TIRAMISU_0 int CONFIG_DISPLAY_ON_OFF = 0x01;
-    field TIRAMISU_0 int CONFIG_DISPLAY_BOUNDS = 0x02;
-    field TIRAMISU_0 int CONFIG_DISPLAY_INSETS = 0x04;
-    field TIRAMISU_0 int CONFIG_UI_TYPE = 0x08;
-    field TIRAMISU_0 int CONFIG_DISPLAY_ID = 0x10;
-    method TIRAMISU_0 void registerClusterStateListener(Executor executor, ClusterStateListener callback);
-    method TIRAMISU_0 void registerClusterNavigationStateListener(Executor executor, ClusterNavigationStateListener callback);
-    method TIRAMISU_0 void unregisterClusterStateListener(ClusterStateListener callback);
-    method TIRAMISU_0 void unregisterClusterNavigationStateListener(ClusterNavigationStateListener callback);
-    method TIRAMISU_0 void reportState(int uiTypeMain, int uiTypeSub, byte[] uiAvailability);
-    method TIRAMISU_0 void requestDisplay(int uiType);
-    method TIRAMISU_0 ClusterState getClusterState();
-    method TIRAMISU_0 boolean startFixedActivityModeAsUser(Intent intent, Bundle options, int userId);
-    method TIRAMISU_0 void stopFixedActivityMode();
-    method TIRAMISU_0 void onCarDisconnected();
-interface ClusterHomeManager.ClusterStateListener package android.car.cluster
-    method TIRAMISU_0 void onClusterStateChanged(ClusterState state, int changes);
-interface ClusterHomeManager.ClusterNavigationStateListener package android.car.cluster
-    method TIRAMISU_0 void onNavigationState(byte[] navigationState);
-class PortLocationType package android.car
-    field TIRAMISU_0 int UNKNOWN = 0;
-    field TIRAMISU_0 int FRONT_LEFT = 1;
-    field TIRAMISU_0 int FRONT_RIGHT = 2;
-    field TIRAMISU_0 int REAR_RIGHT = 3;
-    field TIRAMISU_0 int REAR_LEFT = 4;
-    field TIRAMISU_0 int FRONT = 5;
-    field TIRAMISU_0 int REAR = 6;
-class FuelType package android.car
-    field TIRAMISU_0 int UNKNOWN = 0;
-    field TIRAMISU_0 int UNLEADED = 1;
-    field TIRAMISU_0 int LEADED = 2;
-    field TIRAMISU_0 int DIESEL_1 = 3;
-    field TIRAMISU_0 int DIESEL_2 = 4;
-    field TIRAMISU_0 int BIODIESEL = 5;
-    field TIRAMISU_0 int E85 = 6;
-    field TIRAMISU_0 int LPG = 7;
-    field TIRAMISU_0 int CNG = 8;
-    field TIRAMISU_0 int LNG = 9;
-    field TIRAMISU_0 int ELECTRIC = 10;
-    field TIRAMISU_0 int HYDROGEN = 11;
-    field TIRAMISU_0 int OTHER = 12;
-class @hide @SystemApi VmsLayer package android.car.vms
-    field TIRAMISU_0 Parcelable.Creator<VmsLayer> CREATOR;
-    method TIRAMISU_0 int getSubtype();
-    method TIRAMISU_0 int getType();
-    method TIRAMISU_0 int getChannel();
-    method TIRAMISU_0 int getVersion();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi VmsOperationRecorder package android.car.vms
-    method TIRAMISU_0 VmsOperationRecorder get();
-    method TIRAMISU_0 void subscribe(VmsLayer layer);
-    method TIRAMISU_0 void unsubscribe(VmsLayer layer);
-    method TIRAMISU_0 void subscribe(VmsLayer layer, int publisherId);
-    method TIRAMISU_0 void unsubscribe(VmsLayer layer, int publisherId);
-    method TIRAMISU_0 void startMonitoring();
-    method TIRAMISU_0 void stopMonitoring();
-    method TIRAMISU_0 void setLayersOffering(VmsLayersOffering layersOffering);
-    method TIRAMISU_0 void getPublisherId(int publisherId);
-    method TIRAMISU_0 void addSubscription(int sequenceNumber, VmsLayer layer);
-    method TIRAMISU_0 void removeSubscription(int sequenceNumber, VmsLayer layer);
-    method TIRAMISU_0 void addPromiscuousSubscription(int sequenceNumber);
-    method TIRAMISU_0 void removePromiscuousSubscription(int sequenceNumber);
-    method TIRAMISU_0 void addHalSubscription(int sequenceNumber, VmsLayer layer);
-    method TIRAMISU_0 void removeHalSubscription(int sequenceNumber, VmsLayer layer);
-    method TIRAMISU_0 void setPublisherLayersOffering(VmsLayersOffering layersOffering);
-    method TIRAMISU_0 void setHalPublisherLayersOffering(VmsLayersOffering layersOffering);
-class @hiddenOnly @hide VmsOperationRecorder.Writer package android.car.vms
-    method TIRAMISU_0 boolean isEnabled();
-    method TIRAMISU_0 void write(String msg);
-class @hide @SystemApi VmsAvailableLayers package android.car.vms
-    field TIRAMISU_0 Parcelable.Creator<VmsAvailableLayers> CREATOR;
-    method TIRAMISU_0 int getSequence();
-    method TIRAMISU_0 int getSequenceNumber();
-    method TIRAMISU_0 Set<VmsAssociatedLayer> getAssociatedLayers();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide VmsSubscriptionHelper package android.car.vms
-    method TIRAMISU_0 void subscribe(VmsLayer layer);
-    method TIRAMISU_0 void subscribe(VmsLayer layer, int providerId);
-    method TIRAMISU_0 void unsubscribe(VmsLayer layer);
-    method TIRAMISU_0 void unsubscribe(VmsLayer layer, int providerId);
-    method TIRAMISU_0 Set<VmsAssociatedLayer> getSubscriptions();
-class @hide @SystemApi VmsClient package android.car.vms
-    method TIRAMISU_0 byte[] getProviderDescription(int providerId);
-    method TIRAMISU_0 void setSubscriptions(Set<VmsAssociatedLayer> layers);
-    method TIRAMISU_0 void setMonitoringEnabled(boolean enabled);
-    method TIRAMISU_0 boolean isMonitoringEnabled();
-    method TIRAMISU_0 VmsAvailableLayers getAvailableLayers();
-    method TIRAMISU_0 int registerProvider(byte[] providerDescription);
-    method TIRAMISU_0 void unregisterProvider(int providerId);
-    method TIRAMISU_0 void setProviderOfferings(int providerId, Set<VmsLayerDependency> offerings);
-    method TIRAMISU_0 void publishPacket(int providerId, VmsLayer layer, byte[] packet);
-    method TIRAMISU_0 VmsSubscriptionState getSubscriptionState();
-    method TIRAMISU_0 @hiddenOnly void register();
-    method TIRAMISU_0 @hiddenOnly void unregister();
-class @hide @SystemApi VmsLayerDependency package android.car.vms
-    field TIRAMISU_0 Parcelable.Creator<VmsLayerDependency> CREATOR;
-    method TIRAMISU_0 VmsLayer getLayer();
-    method TIRAMISU_0 Set<VmsLayer> getDependencies();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide VmsRegistrationInfo package android.car.vms
-    field TIRAMISU_0 Parcelable.Creator<VmsRegistrationInfo> CREATOR;
-    method TIRAMISU_0 VmsAvailableLayers getAvailableLayers();
-    method TIRAMISU_0 VmsSubscriptionState getSubscriptionState();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi VmsSubscriptionState package android.car.vms
-    field TIRAMISU_0 Parcelable.Creator<VmsSubscriptionState> CREATOR;
-    method TIRAMISU_0 int getSequenceNumber();
-    method TIRAMISU_0 Set<VmsLayer> getLayers();
-    method TIRAMISU_0 Set<VmsAssociatedLayer> getAssociatedLayers();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi VmsLayersOffering package android.car.vms
-    field TIRAMISU_0 Parcelable.Creator<VmsLayersOffering> CREATOR;
-    method TIRAMISU_0 Set<VmsLayerDependency> getDependencies();
-    method TIRAMISU_0 int getPublisherId();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi VmsAssociatedLayer package android.car.vms
-    field TIRAMISU_0 Parcelable.Creator<VmsAssociatedLayer> CREATOR;
-    method TIRAMISU_0 Set<Integer> getPublisherIds();
-    method TIRAMISU_0 VmsLayer getVmsLayer();
-    method TIRAMISU_0 Set<Integer> getProviderIds();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi VmsPublisherClientService package android.car.vms
-    method TIRAMISU_0 void onCreate();
-    method TIRAMISU_0 void onDestroy();
-    method TIRAMISU_0 IBinder onBind(Intent intent);
-    method TIRAMISU_0 @hiddenOnly void onCarLifecycleChanged(Car car, boolean ready);
-    method TIRAMISU_0 void onVmsPublisherServiceReady();
-    method TIRAMISU_0 void onVmsSubscriptionChange(VmsSubscriptionState subscriptionState);
-    method TIRAMISU_0 void publish(VmsLayer layer, int publisherId, byte[] payload);
-    method TIRAMISU_0 void setLayersOffering(VmsLayersOffering offering);
-    method TIRAMISU_0 int getPublisherId(byte[] publisherInfo);
-    method TIRAMISU_0 VmsSubscriptionState getSubscriptions();
-class @hide @SystemApi VmsSubscriberManager package android.car.vms
-    method TIRAMISU_0 @hiddenOnly VmsSubscriberManager wrap(Car car, VmsClientManager clientManager);
-    method TIRAMISU_0 void setVmsSubscriberClientCallback(Executor executor, VmsSubscriberClientCallback clientCallback);
-    method TIRAMISU_0 void clearVmsSubscriberClientCallback();
-    method TIRAMISU_0 byte[] getPublisherInfo(int publisherId);
-    method TIRAMISU_0 VmsAvailableLayers getAvailableLayers();
-    method TIRAMISU_0 void subscribe(VmsLayer layer);
-    method TIRAMISU_0 void subscribe(VmsLayer layer, int publisherId);
-    method TIRAMISU_0 void startMonitoring();
-    method TIRAMISU_0 void unsubscribe(VmsLayer layer);
-    method TIRAMISU_0 void unsubscribe(VmsLayer layer, int publisherId);
-    method TIRAMISU_0 void stopMonitoring();
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface VmsSubscriberManager.VmsSubscriberClientCallback package android.car.vms
-    method TIRAMISU_0 void onVmsMessageReceived(VmsLayer layer, byte[] payload);
-    method TIRAMISU_0 void onLayersAvailabilityChanged(VmsAvailableLayers availableLayers);
-class @hiddenOnly @hide VmsProviderInfo package android.car.vms
-    field TIRAMISU_0 Parcelable.Creator<VmsProviderInfo> CREATOR;
-    method TIRAMISU_0 byte[] getDescription();
-    method TIRAMISU_0 boolean equals(Object o);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi VmsClientManager package android.car.vms
-    method TIRAMISU_0 void registerVmsClientCallback(Executor executor, VmsClientCallback callback);
-    method TIRAMISU_0 @hiddenOnly void registerVmsClientCallback(Executor executor, VmsClientCallback callback, boolean legacyClient);
-    method TIRAMISU_0 void unregisterVmsClientCallback(VmsClientCallback callback);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface VmsClientManager.VmsClientCallback package android.car.vms
-    method TIRAMISU_0 void onClientConnected(VmsClient client);
-    method TIRAMISU_0 void onLayerAvailabilityChanged(VmsAvailableLayers availableLayers);
-    method TIRAMISU_0 void onSubscriptionStateChanged(VmsSubscriptionState subscriptionState);
-    method TIRAMISU_0 void onPacketReceived(int providerId, VmsLayer layer, byte[] packet);
-class VehicleAreaWheel package android.car
-    field TIRAMISU_0 int WHEEL_UNKNOWN = 0x00;
-    field TIRAMISU_0 int WHEEL_LEFT_FRONT = 0x01;
-    field TIRAMISU_0 int WHEEL_RIGHT_FRONT = 0x02;
-    field TIRAMISU_0 int WHEEL_LEFT_REAR = 0x04;
-    field TIRAMISU_0 int WHEEL_RIGHT_REAR = 0x08;
-class @hiddenOnly @hide AndroidFuture package android.car.util.concurrent
-    field TIRAMISU_0 Parcelable.Creator<AndroidFuture> CREATOR;
-    method TIRAMISU_0 AndroidFuture<U> completedFuture(U value);
-    method TIRAMISU_0 boolean complete(T value);
-    method TIRAMISU_0 boolean completeExceptionally(Throwable ex);
-    method TIRAMISU_0 boolean cancel(boolean mayInterruptIfRunning);
-    method TIRAMISU_0 void onCompleted(T res, Throwable err);
-    method TIRAMISU_0 AndroidFuture<T> whenComplete(BiConsumer<? super T,? super Throwable> action);
-    method TIRAMISU_0 AndroidFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor);
-    method TIRAMISU_0 void callListener(BiConsumer<? super TT,? super Throwable> listener, TT res, Throwable err);
-    method TIRAMISU_0 AndroidFuture<T> orTimeout(long timeout, TimeUnit unit);
-    method TIRAMISU_0 void triggerTimeout();
-    method TIRAMISU_0 AndroidFuture<T> cancelTimeout();
-    method TIRAMISU_0 AndroidFuture<T> setTimeoutHandler(Handler h);
-    method TIRAMISU_0 AndroidFuture<U> thenCompose(Function<? super T,? extends CompletionStage<U>> fn);
-    method TIRAMISU_0 AndroidFuture<U> thenComposeAsync(Function<? super T,? extends CompletionStage<U>> fn, Executor executor);
-    method TIRAMISU_0 AndroidFuture<U> thenApply(Function<? super T,? extends U> fn);
-    method TIRAMISU_0 AndroidFuture<U> thenApplyAsync(Function<? super T,? extends U> fn, Executor executor);
-    method TIRAMISU_0 AndroidFuture<V> thenCombine(CompletionStage<? extends U> other, BiFunction<? super T,? super U,? extends V> combineResults);
-    method TIRAMISU_0 AndroidFuture<T> thenCombine(CompletionStage<Void> other);
-    method TIRAMISU_0 AndroidFuture<T> supply(Supplier<T> supplier);
-    method TIRAMISU_0 AndroidFuture<T> supplyAsync(Supplier<T> supplier, Executor executor);
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 Throwable unwrapExecutionException(Throwable t);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide AndroidAsyncFuture package android.car.util.concurrent
-    method TIRAMISU_0 T get();
-    method TIRAMISU_0 T get(long timeout, TimeUnit unit);
-    method TIRAMISU_0 AsyncFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor);
-interface @hiddenOnly @hide AsyncFuture package android.car.util.concurrent
-    method TIRAMISU_0 T get();
-    method TIRAMISU_0 T get(long timeout, TimeUnit unit);
-    method TIRAMISU_0 AsyncFuture<T> whenCompleteAsync(BiConsumer<? super T,? super Throwable> action, Executor executor);
-class @hide @SystemApi CarDiagnosticManager package android.car.diagnostic
-    field TIRAMISU_0 int FRAME_TYPE_LIVE = 0;
-    field TIRAMISU_0 int FRAME_TYPE_FREEZE = 1;
-    field TIRAMISU_0 @hiddenOnly int[] FRAME_TYPES = { FRAME_TYPE_LIVE, FRAME_TYPE_FREEZE };
-    method TIRAMISU_0 void onCarDisconnected();
-    method TIRAMISU_0 boolean registerListener(OnDiagnosticEventListener listener, int frameType, int rate);
-    method TIRAMISU_0 void unregisterListener(OnDiagnosticEventListener listener);
-    method TIRAMISU_0 CarDiagnosticEvent getLatestLiveFrame();
-    method TIRAMISU_0 long[] getFreezeFrameTimestamps();
-    method TIRAMISU_0 CarDiagnosticEvent getFreezeFrame(long timestamp);
-    method TIRAMISU_0 boolean clearFreezeFrames(long timestamps);
-    method TIRAMISU_0 boolean isLiveFrameSupported();
-    method TIRAMISU_0 boolean isFreezeFrameNotificationSupported();
-    method TIRAMISU_0 boolean isGetFreezeFrameSupported();
-    method TIRAMISU_0 boolean isClearFreezeFramesSupported();
-    method TIRAMISU_0 boolean isSelectiveClearFreezeFramesSupported();
-interface CarDiagnosticManager.OnDiagnosticEventListener package android.car.diagnostic
-    method TIRAMISU_0 void onDiagnosticEvent(CarDiagnosticEvent carDiagnosticEvent);
-class @hide @SystemApi FloatSensorIndex package android.car.diagnostic
-    field TIRAMISU_0 int CALCULATED_ENGINE_LOAD = 0;
-    field TIRAMISU_0 int ENGINE_COOLANT_TEMPERATURE = 1;
-    field TIRAMISU_0 int SHORT_TERM_FUEL_TRIM_BANK1 = 2;
-    field TIRAMISU_0 int LONG_TERM_FUEL_TRIM_BANK1 = 3;
-    field TIRAMISU_0 int SHORT_TERM_FUEL_TRIM_BANK2 = 4;
-    field TIRAMISU_0 int LONG_TERM_FUEL_TRIM_BANK2 = 5;
-    field TIRAMISU_0 int FUEL_PRESSURE = 6;
-    field TIRAMISU_0 int INTAKE_MANIFOLD_ABSOLUTE_PRESSURE = 7;
-    field TIRAMISU_0 int ENGINE_RPM = 8;
-    field TIRAMISU_0 int VEHICLE_SPEED = 9;
-    field TIRAMISU_0 int TIMING_ADVANCE = 10;
-    field TIRAMISU_0 int MAF_AIR_FLOW_RATE = 11;
-    field TIRAMISU_0 int THROTTLE_POSITION = 12;
-    field TIRAMISU_0 int OXYGEN_SENSOR1_VOLTAGE = 13;
-    field TIRAMISU_0 int OXYGEN_SENSOR1_SHORT_TERM_FUEL_TRIM = 14;
-    field TIRAMISU_0 int OXYGEN_SENSOR1_FUEL_AIR_EQUIVALENCE_RATIO = 15;
-    field TIRAMISU_0 int OXYGEN_SENSOR2_VOLTAGE = 16;
-    field TIRAMISU_0 int OXYGEN_SENSOR2_SHORT_TERM_FUEL_TRIM = 17;
-    field TIRAMISU_0 int OXYGEN_SENSOR2_FUEL_AIR_EQUIVALENCE_RATIO = 18;
-    field TIRAMISU_0 int OXYGEN_SENSOR3_VOLTAGE = 19;
-    field TIRAMISU_0 int OXYGEN_SENSOR3_SHORT_TERM_FUEL_TRIM = 20;
-    field TIRAMISU_0 int OXYGEN_SENSOR3_FUEL_AIR_EQUIVALENCE_RATIO = 21;
-    field TIRAMISU_0 int OXYGEN_SENSOR4_VOLTAGE = 22;
-    field TIRAMISU_0 int OXYGEN_SENSOR4_SHORT_TERM_FUEL_TRIM = 23;
-    field TIRAMISU_0 int OXYGEN_SENSOR4_FUEL_AIR_EQUIVALENCE_RATIO = 24;
-    field TIRAMISU_0 int OXYGEN_SENSOR5_VOLTAGE = 25;
-    field TIRAMISU_0 int OXYGEN_SENSOR5_SHORT_TERM_FUEL_TRIM = 26;
-    field TIRAMISU_0 int OXYGEN_SENSOR5_FUEL_AIR_EQUIVALENCE_RATIO = 27;
-    field TIRAMISU_0 int OXYGEN_SENSOR6_VOLTAGE = 28;
-    field TIRAMISU_0 int OXYGEN_SENSOR6_SHORT_TERM_FUEL_TRIM = 29;
-    field TIRAMISU_0 int OXYGEN_SENSOR6_FUEL_AIR_EQUIVALENCE_RATIO = 30;
-    field TIRAMISU_0 int OXYGEN_SENSOR7_VOLTAGE = 31;
-    field TIRAMISU_0 int OXYGEN_SENSOR7_SHORT_TERM_FUEL_TRIM = 32;
-    field TIRAMISU_0 int OXYGEN_SENSOR7_FUEL_AIR_EQUIVALENCE_RATIO = 33;
-    field TIRAMISU_0 int OXYGEN_SENSOR8_VOLTAGE = 34;
-    field TIRAMISU_0 int OXYGEN_SENSOR8_SHORT_TERM_FUEL_TRIM = 35;
-    field TIRAMISU_0 int OXYGEN_SENSOR8_FUEL_AIR_EQUIVALENCE_RATIO = 36;
-    field TIRAMISU_0 int FUEL_RAIL_PRESSURE = 37;
-    field TIRAMISU_0 int FUEL_RAIL_GAUGE_PRESSURE = 38;
-    field TIRAMISU_0 int COMMANDED_EXHAUST_GAS_RECIRCULATION = 39;
-    field TIRAMISU_0 int EXHAUST_GAS_RECIRCULATION_ERROR = 40;
-    field TIRAMISU_0 int COMMANDED_EVAPORATIVE_PURGE = 41;
-    field TIRAMISU_0 int FUEL_TANK_LEVEL_INPUT = 42;
-    field TIRAMISU_0 int EVAPORATION_SYSTEM_VAPOR_PRESSURE = 43;
-    field TIRAMISU_0 int CATALYST_TEMPERATURE_BANK1_SENSOR1 = 44;
-    field TIRAMISU_0 int CATALYST_TEMPERATURE_BANK2_SENSOR1 = 45;
-    field TIRAMISU_0 int CATALYST_TEMPERATURE_BANK1_SENSOR2 = 46;
-    field TIRAMISU_0 int CATALYST_TEMPERATURE_BANK2_SENSOR2 = 47;
-    field TIRAMISU_0 int ABSOLUTE_LOAD_VALUE = 48;
-    field TIRAMISU_0 int FUEL_AIR_COMMANDED_EQUIVALENCE_RATIO = 49;
-    field TIRAMISU_0 int RELATIVE_THROTTLE_POSITION = 50;
-    field TIRAMISU_0 int ABSOLUTE_THROTTLE_POSITION_B = 51;
-    field TIRAMISU_0 int ABSOLUTE_THROTTLE_POSITION_C = 52;
-    field TIRAMISU_0 int ACCELERATOR_PEDAL_POSITION_D = 53;
-    field TIRAMISU_0 int ACCELERATOR_PEDAL_POSITION_E = 54;
-    field TIRAMISU_0 int ACCELERATOR_PEDAL_POSITION_F = 55;
-    field TIRAMISU_0 int COMMANDED_THROTTLE_ACTUATOR = 56;
-    field TIRAMISU_0 int ETHANOL_FUEL_PERCENTAGE = 57;
-    field TIRAMISU_0 int ABSOLUTE_EVAPORATION_SYSTEM_VAPOR_PRESSURE = 58;
-    field TIRAMISU_0 int SHORT_TERM_SECONDARY_OXYGEN_SENSOR_TRIM_BANK1 = 59;
-    field TIRAMISU_0 int SHORT_TERM_SECONDARY_OXYGEN_SENSOR_TRIM_BANK2 = 60;
-    field TIRAMISU_0 int SHORT_TERM_SECONDARY_OXYGEN_SENSOR_TRIM_BANK3 = 61;
-    field TIRAMISU_0 int SHORT_TERM_SECONDARY_OXYGEN_SENSOR_TRIM_BANK4 = 62;
-    field TIRAMISU_0 int LONG_TERM_SECONDARY_OXYGEN_SENSOR_TRIM_BANK1 = 63;
-    field TIRAMISU_0 int LONG_TERM_SECONDARY_OXYGEN_SENSOR_TRIM_BANK2 = 64;
-    field TIRAMISU_0 int LONG_TERM_SECONDARY_OXYGEN_SENSOR_TRIM_BANK3 = 65;
-    field TIRAMISU_0 int LONG_TERM_SECONDARY_OXYGEN_SENSOR_TRIM_BANK4 = 66;
-    field TIRAMISU_0 int RELATIVE_ACCELERATOR_PEDAL_POSITION = 67;
-    field TIRAMISU_0 int HYBRID_BATTERY_PACK_REMAINING_LIFE = 68;
-    field TIRAMISU_0 int FUEL_INJECTION_TIMING = 69;
-    field TIRAMISU_0 int ENGINE_FUEL_RATE = 70;
-    field TIRAMISU_0 int LAST_SYSTEM = ENGINE_FUEL_RATE;
-    field TIRAMISU_0 int VENDOR_START = LAST_SYSTEM + 1;
-class @hide @SystemApi CarDiagnosticEvent package android.car.diagnostic
-    field TIRAMISU_0 int frameType;
-    field TIRAMISU_0 long timestamp;
-    field TIRAMISU_0 String dtc;
-    field TIRAMISU_0 Parcelable.Creator<CarDiagnosticEvent> CREATOR;
-    method TIRAMISU_0 int describeContents();
-    method TIRAMISU_0 void writeToParcel(Parcel dest, int flags);
-    method TIRAMISU_0 void writeToJson(JsonWriter jsonWriter);
-    method TIRAMISU_0 @hiddenOnly CarDiagnosticEvent withVendorSensorsRemoved();
-    method TIRAMISU_0 boolean isLiveFrame();
-    method TIRAMISU_0 boolean isFreezeFrame();
-    method TIRAMISU_0 @hiddenOnly boolean isEmptyFrame();
-    method TIRAMISU_0 @hiddenOnly CarDiagnosticEvent checkLiveFrame();
-    method TIRAMISU_0 @hiddenOnly CarDiagnosticEvent checkFreezeFrame();
-    method TIRAMISU_0 @hiddenOnly boolean isEarlierThan(CarDiagnosticEvent otherEvent);
-    method TIRAMISU_0 boolean equals(Object otherObject);
-    method TIRAMISU_0 int hashCode();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 int getSystemIntegerSensor(int sensor, int defaultValue);
-    method TIRAMISU_0 float getSystemFloatSensor(int sensor, float defaultValue);
-    method TIRAMISU_0 int getVendorIntegerSensor(int sensor, int defaultValue);
-    method TIRAMISU_0 float getVendorFloatSensor(int sensor, float defaultValue);
-    method TIRAMISU_0 Integer getSystemIntegerSensor(int sensor);
-    method TIRAMISU_0 Float getSystemFloatSensor(int sensor);
-    method TIRAMISU_0 Integer getVendorIntegerSensor(int sensor);
-    method TIRAMISU_0 Float getVendorFloatSensor(int sensor);
-    method TIRAMISU_0 Integer getFuelSystemStatus();
-    method TIRAMISU_0 Integer getSecondaryAirStatus();
-    method TIRAMISU_0 CommonIgnitionMonitors getIgnitionMonitors();
-    method TIRAMISU_0 Integer getFuelType();
-class CarDiagnosticEvent.Builder package android.car.diagnostic
-    method TIRAMISU_0 Builder newLiveFrameBuilder();
-    method TIRAMISU_0 Builder newFreezeFrameBuilder();
-    method TIRAMISU_0 Builder atTimestamp(long timestamp);
-    method TIRAMISU_0 Builder setTimeStamp(long timeStamp);
-    method TIRAMISU_0 Builder withIntValue(int key, int value);
-    method TIRAMISU_0 Builder setIntValue(int key, int value);
-    method TIRAMISU_0 Builder withFloatValue(int key, float value);
-    method TIRAMISU_0 Builder setFloatValue(int key, float value);
-    method TIRAMISU_0 Builder withDtc(String dtc);
-    method TIRAMISU_0 Builder setDtc(String dtc);
-    method TIRAMISU_0 CarDiagnosticEvent build();
-class CarDiagnosticEvent.FuelSystemStatus package android.car.diagnostic
-    field TIRAMISU_0 int OPEN_INSUFFICIENT_ENGINE_TEMPERATURE = 1;
-    field TIRAMISU_0 int CLOSED_LOOP = 2;
-    field TIRAMISU_0 int OPEN_ENGINE_LOAD_OR_DECELERATION = 4;
-    field TIRAMISU_0 int OPEN_SYSTEM_FAILURE = 8;
-    field TIRAMISU_0 int CLOSED_LOOP_BUT_FEEDBACK_FAULT = 16;
-class CarDiagnosticEvent.SecondaryAirStatus package android.car.diagnostic
-    field TIRAMISU_0 int UPSTREAM = 1;
-    field TIRAMISU_0 int DOWNSTREAM_OF_CATALYCIC_CONVERTER = 2;
-    field TIRAMISU_0 int FROM_OUTSIDE_OR_OFF = 4;
-    field TIRAMISU_0 int PUMP_ON_FOR_DIAGNOSTICS = 8;
-class CarDiagnosticEvent.FuelType package android.car.diagnostic
-    field TIRAMISU_0 int NOT_AVAILABLE = 0;
-    field TIRAMISU_0 int GASOLINE = 1;
-    field TIRAMISU_0 int METHANOL = 2;
-    field TIRAMISU_0 int ETHANOL = 3;
-    field TIRAMISU_0 int DIESEL = 4;
-    field TIRAMISU_0 int LPG = 5;
-    field TIRAMISU_0 int CNG = 6;
-    field TIRAMISU_0 int PROPANE = 7;
-    field TIRAMISU_0 int ELECTRIC = 8;
-    field TIRAMISU_0 int BIFUEL_RUNNING_GASOLINE = 9;
-    field TIRAMISU_0 int BIFUEL_RUNNING_METHANOL = 10;
-    field TIRAMISU_0 int BIFUEL_RUNNING_ETHANOL = 11;
-    field TIRAMISU_0 int BIFUEL_RUNNING_LPG = 12;
-    field TIRAMISU_0 int BIFUEL_RUNNING_CNG = 13;
-    field TIRAMISU_0 int BIFUEL_RUNNING_PROPANE = 14;
-    field TIRAMISU_0 int BIFUEL_RUNNING_ELECTRIC = 15;
-    field TIRAMISU_0 int BIFUEL_RUNNING_ELECTRIC_AND_COMBUSTION = 16;
-    field TIRAMISU_0 int HYBRID_GASOLINE = 17;
-    field TIRAMISU_0 int HYBRID_ETHANOL = 18;
-    field TIRAMISU_0 int HYBRID_DIESEL = 19;
-    field TIRAMISU_0 int HYBRID_ELECTRIC = 20;
-    field TIRAMISU_0 int HYBRID_RUNNING_ELECTRIC_AND_COMBUSTION = 21;
-    field TIRAMISU_0 int HYBRID_REGENERATIVE = 22;
-    field TIRAMISU_0 int BIFUEL_RUNNING_DIESEL = 23;
-class CarDiagnosticEvent.IgnitionMonitor package android.car.diagnostic
-    field TIRAMISU_0 boolean available;
-    field TIRAMISU_0 boolean incomplete;
-class @hiddenOnly @hide CarDiagnosticEvent.IgnitionMonitor.Decoder package android.car.diagnostic
-    method TIRAMISU_0 IgnitionMonitor fromValue(int value);
-class CarDiagnosticEvent.CommonIgnitionMonitors package android.car.diagnostic
-    field TIRAMISU_0 IgnitionMonitor components;
-    field TIRAMISU_0 IgnitionMonitor fuelSystem;
-    field TIRAMISU_0 IgnitionMonitor misfire;
-    field TIRAMISU_0 @hiddenOnly int COMPONENTS_AVAILABLE = 0x1 << 0;
-    field TIRAMISU_0 @hiddenOnly int COMPONENTS_INCOMPLETE = 0x1 << 1;
-    field TIRAMISU_0 @hiddenOnly int FUEL_SYSTEM_AVAILABLE = 0x1 << 2;
-    field TIRAMISU_0 @hiddenOnly int FUEL_SYSTEM_INCOMPLETE = 0x1 << 3;
-    field TIRAMISU_0 @hiddenOnly int MISFIRE_AVAILABLE = 0x1 << 4;
-    field TIRAMISU_0 @hiddenOnly int MISFIRE_INCOMPLETE = 0x1 << 5;
-    field TIRAMISU_0 IgnitionMonitor.Decoder COMPONENTS_DECODER = new IgnitionMonitor.Decoder(COMPONENTS_AVAILABLE, COMPONENTS_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder FUEL_SYSTEM_DECODER = new IgnitionMonitor.Decoder(FUEL_SYSTEM_AVAILABLE, FUEL_SYSTEM_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder MISFIRE_DECODER = new IgnitionMonitor.Decoder(MISFIRE_AVAILABLE, MISFIRE_INCOMPLETE);
-    method TIRAMISU_0 SparkIgnitionMonitors asSparkIgnitionMonitors();
-    method TIRAMISU_0 CompressionIgnitionMonitors asCompressionIgnitionMonitors();
-class CarDiagnosticEvent.SparkIgnitionMonitors package android.car.diagnostic
-    field TIRAMISU_0 IgnitionMonitor EGR;
-    field TIRAMISU_0 IgnitionMonitor oxygenSensorHeater;
-    field TIRAMISU_0 IgnitionMonitor oxygenSensor;
-    field TIRAMISU_0 IgnitionMonitor ACRefrigerant;
-    field TIRAMISU_0 IgnitionMonitor secondaryAirSystem;
-    field TIRAMISU_0 IgnitionMonitor evaporativeSystem;
-    field TIRAMISU_0 IgnitionMonitor heatedCatalyst;
-    field TIRAMISU_0 IgnitionMonitor catalyst;
-    field TIRAMISU_0 @hiddenOnly int EGR_AVAILABLE = 0x1 << 6;
-    field TIRAMISU_0 @hiddenOnly int EGR_INCOMPLETE = 0x1 << 7;
-    field TIRAMISU_0 @hiddenOnly int OXYGEN_SENSOR_HEATER_AVAILABLE = 0x1 << 8;
-    field TIRAMISU_0 @hiddenOnly int OXYGEN_SENSOR_HEATER_INCOMPLETE = 0x1 << 9;
-    field TIRAMISU_0 @hiddenOnly int OXYGEN_SENSOR_AVAILABLE = 0x1 << 10;
-    field TIRAMISU_0 @hiddenOnly int OXYGEN_SENSOR_INCOMPLETE = 0x1 << 11;
-    field TIRAMISU_0 @hiddenOnly int AC_REFRIGERANT_AVAILABLE = 0x1 << 12;
-    field TIRAMISU_0 @hiddenOnly int AC_REFRIGERANT_INCOMPLETE = 0x1 << 13;
-    field TIRAMISU_0 @hiddenOnly int SECONDARY_AIR_SYSTEM_AVAILABLE = 0x1 << 14;
-    field TIRAMISU_0 @hiddenOnly int SECONDARY_AIR_SYSTEM_INCOMPLETE = 0x1 << 15;
-    field TIRAMISU_0 @hiddenOnly int EVAPORATIVE_SYSTEM_AVAILABLE = 0x1 << 16;
-    field TIRAMISU_0 @hiddenOnly int EVAPORATIVE_SYSTEM_INCOMPLETE = 0x1 << 17;
-    field TIRAMISU_0 @hiddenOnly int HEATED_CATALYST_AVAILABLE = 0x1 << 18;
-    field TIRAMISU_0 @hiddenOnly int HEATED_CATALYST_INCOMPLETE = 0x1 << 19;
-    field TIRAMISU_0 @hiddenOnly int CATALYST_AVAILABLE = 0x1 << 20;
-    field TIRAMISU_0 @hiddenOnly int CATALYST_INCOMPLETE = 0x1 << 21;
-    field TIRAMISU_0 IgnitionMonitor.Decoder EGR_DECODER = new IgnitionMonitor.Decoder(EGR_AVAILABLE, EGR_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder OXYGEN_SENSOR_HEATER_DECODER = new IgnitionMonitor.Decoder(OXYGEN_SENSOR_HEATER_AVAILABLE, OXYGEN_SENSOR_HEATER_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder OXYGEN_SENSOR_DECODER = new IgnitionMonitor.Decoder(OXYGEN_SENSOR_AVAILABLE, OXYGEN_SENSOR_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder AC_REFRIGERANT_DECODER = new IgnitionMonitor.Decoder(AC_REFRIGERANT_AVAILABLE, AC_REFRIGERANT_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder SECONDARY_AIR_SYSTEM_DECODER = new IgnitionMonitor.Decoder(SECONDARY_AIR_SYSTEM_AVAILABLE, SECONDARY_AIR_SYSTEM_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder EVAPORATIVE_SYSTEM_DECODER = new IgnitionMonitor.Decoder(EVAPORATIVE_SYSTEM_AVAILABLE, EVAPORATIVE_SYSTEM_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder HEATED_CATALYST_DECODER = new IgnitionMonitor.Decoder(HEATED_CATALYST_AVAILABLE, HEATED_CATALYST_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder CATALYST_DECODER = new IgnitionMonitor.Decoder(CATALYST_AVAILABLE, CATALYST_INCOMPLETE);
-class CarDiagnosticEvent.CompressionIgnitionMonitors package android.car.diagnostic
-    field TIRAMISU_0 IgnitionMonitor EGROrVVT;
-    field TIRAMISU_0 IgnitionMonitor PMFilter;
-    field TIRAMISU_0 IgnitionMonitor exhaustGasSensor;
-    field TIRAMISU_0 IgnitionMonitor boostPressure;
-    field TIRAMISU_0 IgnitionMonitor NOxSCR;
-    field TIRAMISU_0 IgnitionMonitor NMHCCatalyst;
-    field TIRAMISU_0 @hiddenOnly int EGR_OR_VVT_AVAILABLE = 0x1 << 6;
-    field TIRAMISU_0 @hiddenOnly int EGR_OR_VVT_INCOMPLETE = 0x1 << 7;
-    field TIRAMISU_0 @hiddenOnly int PM_FILTER_AVAILABLE = 0x1 << 8;
-    field TIRAMISU_0 @hiddenOnly int PM_FILTER_INCOMPLETE = 0x1 << 9;
-    field TIRAMISU_0 @hiddenOnly int EXHAUST_GAS_SENSOR_AVAILABLE = 0x1 << 10;
-    field TIRAMISU_0 @hiddenOnly int EXHAUST_GAS_SENSOR_INCOMPLETE = 0x1 << 11;
-    field TIRAMISU_0 @hiddenOnly int BOOST_PRESSURE_AVAILABLE = 0x1 << 12;
-    field TIRAMISU_0 @hiddenOnly int BOOST_PRESSURE_INCOMPLETE = 0x1 << 13;
-    field TIRAMISU_0 @hiddenOnly int NOx_SCR_AVAILABLE = 0x1 << 14;
-    field TIRAMISU_0 @hiddenOnly int NOx_SCR_INCOMPLETE = 0x1 << 15;
-    field TIRAMISU_0 @hiddenOnly int NMHC_CATALYST_AVAILABLE = 0x1 << 16;
-    field TIRAMISU_0 @hiddenOnly int NMHC_CATALYST_INCOMPLETE = 0x1 << 17;
-    field TIRAMISU_0 IgnitionMonitor.Decoder EGR_OR_VVT_DECODER = new IgnitionMonitor.Decoder(EGR_OR_VVT_AVAILABLE, EGR_OR_VVT_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder PM_FILTER_DECODER = new IgnitionMonitor.Decoder(PM_FILTER_AVAILABLE, PM_FILTER_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder EXHAUST_GAS_SENSOR_DECODER = new IgnitionMonitor.Decoder(EXHAUST_GAS_SENSOR_AVAILABLE, EXHAUST_GAS_SENSOR_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder BOOST_PRESSURE_DECODER = new IgnitionMonitor.Decoder(BOOST_PRESSURE_AVAILABLE, BOOST_PRESSURE_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder NOx_SCR_DECODER = new IgnitionMonitor.Decoder(NOx_SCR_AVAILABLE, NOx_SCR_INCOMPLETE);
-    field TIRAMISU_0 IgnitionMonitor.Decoder NMHC_CATALYST_DECODER = new IgnitionMonitor.Decoder(NMHC_CATALYST_AVAILABLE, NMHC_CATALYST_INCOMPLETE);
-class @hide @SystemApi IntegerSensorIndex package android.car.diagnostic
-    field TIRAMISU_0 int FUEL_SYSTEM_STATUS = 0;
-    field TIRAMISU_0 int MALFUNCTION_INDICATOR_LIGHT_ON = 1;
-    field TIRAMISU_0 int IGNITION_MONITORS_SUPPORTED = 2;
-    field TIRAMISU_0 int IGNITION_SPECIFIC_MONITORS = 3;
-    field TIRAMISU_0 int INTAKE_AIR_TEMPERATURE = 4;
-    field TIRAMISU_0 int COMMANDED_SECONDARY_AIR_STATUS = 5;
-    field TIRAMISU_0 int NUM_OXYGEN_SENSORS_PRESENT = 6;
-    field TIRAMISU_0 int RUNTIME_SINCE_ENGINE_START = 7;
-    field TIRAMISU_0 int DISTANCE_TRAVELED_WITH_MALFUNCTION_INDICATOR_LIGHT_ON = 8;
-    field TIRAMISU_0 int WARMUPS_SINCE_CODES_CLEARED = 9;
-    field TIRAMISU_0 int DISTANCE_TRAVELED_SINCE_CODES_CLEARED = 10;
-    field TIRAMISU_0 int ABSOLUTE_BAROMETRIC_PRESSURE = 11;
-    field TIRAMISU_0 int CONTROL_MODULE_VOLTAGE = 12;
-    field TIRAMISU_0 int AMBIENT_AIR_TEMPERATURE = 13;
-    field TIRAMISU_0 int TIME_WITH_MALFUNCTION_LIGHT_ON = 14;
-    field TIRAMISU_0 int TIME_SINCE_TROUBLE_CODES_CLEARED = 15;
-    field TIRAMISU_0 int MAX_FUEL_AIR_EQUIVALENCE_RATIO = 16;
-    field TIRAMISU_0 int MAX_OXYGEN_SENSOR_VOLTAGE = 17;
-    field TIRAMISU_0 int MAX_OXYGEN_SENSOR_CURRENT = 18;
-    field TIRAMISU_0 int MAX_INTAKE_MANIFOLD_ABSOLUTE_PRESSURE = 19;
-    field TIRAMISU_0 int MAX_AIR_FLOW_RATE_FROM_MASS_AIR_FLOW_SENSOR = 20;
-    field TIRAMISU_0 int FUEL_TYPE = 21;
-    field TIRAMISU_0 int FUEL_RAIL_ABSOLUTE_PRESSURE = 22;
-    field TIRAMISU_0 int ENGINE_OIL_TEMPERATURE = 23;
-    field TIRAMISU_0 int DRIVER_DEMAND_PERCENT_TORQUE = 24;
-    field TIRAMISU_0 int ENGINE_ACTUAL_PERCENT_TORQUE = 25;
-    field TIRAMISU_0 int ENGINE_REFERENCE_PERCENT_TORQUE = 26;
-    field TIRAMISU_0 int ENGINE_PERCENT_TORQUE_DATA_IDLE = 27;
-    field TIRAMISU_0 int ENGINE_PERCENT_TORQUE_DATA_POINT1 = 28;
-    field TIRAMISU_0 int ENGINE_PERCENT_TORQUE_DATA_POINT2 = 29;
-    field TIRAMISU_0 int ENGINE_PERCENT_TORQUE_DATA_POINT3 = 30;
-    field TIRAMISU_0 int ENGINE_PERCENT_TORQUE_DATA_POINT4 = 31;
-    field TIRAMISU_0 int LAST_SYSTEM = ENGINE_PERCENT_TORQUE_DATA_POINT4;
-    field TIRAMISU_0 int VENDOR_START = LAST_SYSTEM + 1;
-class VehiclePropertyIds package android.car
-    field TIRAMISU_0 int INVALID = 0;
-    field TIRAMISU_0 int INFO_VIN = 286261504;
-    field TIRAMISU_0 int INFO_MAKE = 286261505;
-    field TIRAMISU_0 int INFO_MODEL = 286261506;
-    field TIRAMISU_0 int INFO_MODEL_YEAR = 289407235;
-    field TIRAMISU_0 int INFO_FUEL_CAPACITY = 291504388;
-    field TIRAMISU_0 int INFO_FUEL_TYPE = 289472773;
-    field TIRAMISU_0 int INFO_EV_BATTERY_CAPACITY = 291504390;
-    field TIRAMISU_0 int INFO_EV_CONNECTOR_TYPE = 289472775;
-    field TIRAMISU_0 int INFO_FUEL_DOOR_LOCATION = 289407240;
-    field TIRAMISU_0 int INFO_EV_PORT_LOCATION = 289407241;
-    field TIRAMISU_0 int INFO_MULTI_EV_PORT_LOCATIONS = 289472780;
-    field TIRAMISU_0 int INFO_DRIVER_SEAT = 356516106;
-    field TIRAMISU_0 int INFO_EXTERIOR_DIMENSIONS = 289472779;
-    field TIRAMISU_0 int PERF_ODOMETER = 291504644;
-    field TIRAMISU_0 int PERF_VEHICLE_SPEED = 291504647;
-    field TIRAMISU_0 int PERF_VEHICLE_SPEED_DISPLAY = 291504648;
-    field TIRAMISU_0 int PERF_STEERING_ANGLE = 291504649;
-    field TIRAMISU_0 int PERF_REAR_STEERING_ANGLE = 291504656;
-    field TIRAMISU_0 int ENGINE_COOLANT_TEMP = 291504897;
-    field TIRAMISU_0 int ENGINE_OIL_LEVEL = 289407747;
-    field TIRAMISU_0 int ENGINE_OIL_TEMP = 291504900;
-    field TIRAMISU_0 int ENGINE_RPM = 291504901;
-    field TIRAMISU_0 int WHEEL_TICK = 290521862;
-    field TIRAMISU_0 int FUEL_LEVEL = 291504903;
-    field TIRAMISU_0 int FUEL_DOOR_OPEN = 287310600;
-    field TIRAMISU_0 int EV_BATTERY_LEVEL = 291504905;
-    field TIRAMISU_0 int EV_CHARGE_PORT_OPEN = 287310602;
-    field TIRAMISU_0 int EV_CHARGE_PORT_CONNECTED = 287310603;
-    field TIRAMISU_0 int EV_BATTERY_INSTANTANEOUS_CHARGE_RATE = 291504908;
-    field TIRAMISU_0 int RANGE_REMAINING = 291504904;
-    field TIRAMISU_0 int TIRE_PRESSURE = 392168201;
-    field TIRAMISU_0 int CRITICALLY_LOW_TIRE_PRESSURE = 392168202;
-    field TIRAMISU_0 int GEAR_SELECTION = 289408000;
-    field TIRAMISU_0 int CURRENT_GEAR = 289408001;
-    field TIRAMISU_0 int PARKING_BRAKE_ON = 287310850;
-    field TIRAMISU_0 int PARKING_BRAKE_AUTO_APPLY = 287310851;
-    field TIRAMISU_0 int FUEL_LEVEL_LOW = 287310853;
-    field TIRAMISU_0 int NIGHT_MODE = 287310855;
-    field TIRAMISU_0 int TURN_SIGNAL_STATE = 289408008;
-    field TIRAMISU_0 int IGNITION_STATE = 289408009;
-    field TIRAMISU_0 int ABS_ACTIVE = 287310858;
-    field TIRAMISU_0 int TRACTION_CONTROL_ACTIVE = 287310859;
-    field TIRAMISU_0 int HVAC_FAN_SPEED = 356517120;
-    field TIRAMISU_0 int HVAC_FAN_DIRECTION = 356517121;
-    field TIRAMISU_0 int HVAC_TEMPERATURE_CURRENT = 358614274;
-    field TIRAMISU_0 int HVAC_TEMPERATURE_SET = 358614275;
-    field TIRAMISU_0 int HVAC_TEMPERATURE_VALUE_SUGGESTION = 291570965;
-    field TIRAMISU_0 int HVAC_DEFROSTER = 320865540;
-    field TIRAMISU_0 int HVAC_AC_ON = 354419973;
-    field TIRAMISU_0 int HVAC_MAX_AC_ON = 354419974;
-    field TIRAMISU_0 int HVAC_MAX_DEFROST_ON = 354419975;
-    field TIRAMISU_0 int HVAC_RECIRC_ON = 354419976;
-    field TIRAMISU_0 int HVAC_DUAL_ON = 354419977;
-    field TIRAMISU_0 int HVAC_AUTO_ON = 354419978;
-    field TIRAMISU_0 int HVAC_SEAT_TEMPERATURE = 356517131;
-    field TIRAMISU_0 int HVAC_SIDE_MIRROR_HEAT = 339739916;
-    field TIRAMISU_0 int HVAC_STEERING_WHEEL_HEAT = 289408269;
-    field TIRAMISU_0 int HVAC_TEMPERATURE_DISPLAY_UNITS = 289408270;
-    field TIRAMISU_0 int HVAC_ACTUAL_FAN_SPEED_RPM = 356517135;
-    field TIRAMISU_0 int HVAC_POWER_ON = 354419984;
-    field TIRAMISU_0 int HVAC_FAN_DIRECTION_AVAILABLE = 356582673;
-    field TIRAMISU_0 int HVAC_AUTO_RECIRC_ON = 354419986;
-    field TIRAMISU_0 int HVAC_SEAT_VENTILATION = 356517139;
-    field TIRAMISU_0 int HVAC_ELECTRIC_DEFROSTER_ON = 320865556;
-    field TIRAMISU_0 int DISTANCE_DISPLAY_UNITS = 289408512;
-    field TIRAMISU_0 int FUEL_VOLUME_DISPLAY_UNITS = 289408513;
-    field TIRAMISU_0 int TIRE_PRESSURE_DISPLAY_UNITS = 289408514;
-    field TIRAMISU_0 int EV_BATTERY_DISPLAY_UNITS = 289408515;
-    field TIRAMISU_0 int VEHICLE_SPEED_DISPLAY_UNITS = 289408516;
-    field TIRAMISU_0 int FUEL_CONSUMPTION_UNITS_DISTANCE_OVER_VOLUME = 287311364;
-    field TIRAMISU_0 int ENV_OUTSIDE_TEMPERATURE = 291505923;
-    field TIRAMISU_0 int AP_POWER_STATE_REQ = 289475072;
-    field TIRAMISU_0 int AP_POWER_STATE_REPORT = 289475073;
-    field TIRAMISU_0 int AP_POWER_BOOTUP_REASON = 289409538;
-    field TIRAMISU_0 int DISPLAY_BRIGHTNESS = 289409539;
-    field TIRAMISU_0 int HW_KEY_INPUT = 289475088;
-    field TIRAMISU_0 int DOOR_POS = 373295872;
-    field TIRAMISU_0 int DOOR_MOVE = 373295873;
-    field TIRAMISU_0 int DOOR_LOCK = 371198722;
-    field TIRAMISU_0 int MIRROR_Z_POS = 339741504;
-    field TIRAMISU_0 int MIRROR_Z_MOVE = 339741505;
-    field TIRAMISU_0 int MIRROR_Y_POS = 339741506;
-    field TIRAMISU_0 int MIRROR_Y_MOVE = 339741507;
-    field TIRAMISU_0 int MIRROR_LOCK = 287312708;
-    field TIRAMISU_0 int MIRROR_FOLD = 287312709;
-    field TIRAMISU_0 int SEAT_MEMORY_SELECT = 356518784;
-    field TIRAMISU_0 int SEAT_MEMORY_SET = 356518785;
-    field TIRAMISU_0 int SEAT_BELT_BUCKLED = 354421634;
-    field TIRAMISU_0 int SEAT_BELT_HEIGHT_POS = 356518787;
-    field TIRAMISU_0 int SEAT_BELT_HEIGHT_MOVE = 356518788;
-    field TIRAMISU_0 int SEAT_FORE_AFT_POS = 356518789;
-    field TIRAMISU_0 int SEAT_FORE_AFT_MOVE = 356518790;
-    field TIRAMISU_0 int SEAT_BACKREST_ANGLE_1_POS = 356518791;
-    field TIRAMISU_0 int SEAT_BACKREST_ANGLE_1_MOVE = 356518792;
-    field TIRAMISU_0 int SEAT_BACKREST_ANGLE_2_POS = 356518793;
-    field TIRAMISU_0 int SEAT_BACKREST_ANGLE_2_MOVE = 356518794;
-    field TIRAMISU_0 int SEAT_HEIGHT_POS = 356518795;
-    field TIRAMISU_0 int SEAT_HEIGHT_MOVE = 356518796;
-    field TIRAMISU_0 int SEAT_DEPTH_POS = 356518797;
-    field TIRAMISU_0 int SEAT_DEPTH_MOVE = 356518798;
-    field TIRAMISU_0 int SEAT_TILT_POS = 356518799;
-    field TIRAMISU_0 int SEAT_TILT_MOVE = 356518800;
-    field TIRAMISU_0 int SEAT_LUMBAR_FORE_AFT_POS = 356518801;
-    field TIRAMISU_0 int SEAT_LUMBAR_FORE_AFT_MOVE = 356518802;
-    field TIRAMISU_0 int SEAT_LUMBAR_SIDE_SUPPORT_POS = 356518803;
-    field TIRAMISU_0 int SEAT_LUMBAR_SIDE_SUPPORT_MOVE = 356518804;
-    field TIRAMISU_0 int SEAT_HEADREST_HEIGHT_POS = 289409941;
-    field TIRAMISU_0 int SEAT_HEADREST_HEIGHT_MOVE = 356518806;
-    field TIRAMISU_0 int SEAT_HEADREST_ANGLE_POS = 356518807;
-    field TIRAMISU_0 int SEAT_HEADREST_ANGLE_MOVE = 356518808;
-    field TIRAMISU_0 int SEAT_HEADREST_FORE_AFT_POS = 356518809;
-    field TIRAMISU_0 int SEAT_HEADREST_FORE_AFT_MOVE = 356518810;
-    field TIRAMISU_0 int SEAT_OCCUPANCY = 356518832;
-    field TIRAMISU_0 int WINDOW_POS = 322964416;
-    field TIRAMISU_0 int WINDOW_MOVE = 322964417;
-    field TIRAMISU_0 int WINDOW_LOCK = 320867268;
-    field TIRAMISU_0 int VEHICLE_MAP_SERVICE = 299895808;
-    field TIRAMISU_0 int OBD2_LIVE_FRAME = 299896064;
-    field TIRAMISU_0 int OBD2_FREEZE_FRAME = 299896065;
-    field TIRAMISU_0 int OBD2_FREEZE_FRAME_INFO = 299896066;
-    field TIRAMISU_0 int OBD2_FREEZE_FRAME_CLEAR = 299896067;
-    field TIRAMISU_0 int HEADLIGHTS_STATE = 289410560;
-    field TIRAMISU_0 int HIGH_BEAM_LIGHTS_STATE = 289410561;
-    field TIRAMISU_0 int FOG_LIGHTS_STATE = 289410562;
-    field TIRAMISU_0 int HAZARD_LIGHTS_STATE = 289410563;
-    field TIRAMISU_0 int HEADLIGHTS_SWITCH = 289410576;
-    field TIRAMISU_0 int HIGH_BEAM_LIGHTS_SWITCH = 289410577;
-    field TIRAMISU_0 int FOG_LIGHTS_SWITCH = 289410578;
-    field TIRAMISU_0 int HAZARD_LIGHTS_SWITCH = 289410579;
-    field TIRAMISU_0 int CABIN_LIGHTS_STATE = 289410817;
-    field TIRAMISU_0 int CABIN_LIGHTS_SWITCH = 289410818;
-    field TIRAMISU_0 int READING_LIGHTS_STATE = 356519683;
-    field TIRAMISU_0 int READING_LIGHTS_SWITCH = 356519684;
-    field TIRAMISU_0 @hiddenOnly int INITIAL_USER_INFO = 299896583;
-    field TIRAMISU_0 @hiddenOnly int SWITCH_USER = 299896584;
-    field TIRAMISU_0 @hiddenOnly int CREATE_USER = 299896585;
-    field TIRAMISU_0 @hiddenOnly int REMOVE_USER = 299896586;
-    field TIRAMISU_0 @hiddenOnly int USER_IDENTIFICATION_ASSOCIATION = 299896587;
-    field TIRAMISU_0 @hiddenOnly int POWER_POLICY_REQ = 286265121;
-    field TIRAMISU_0 @hiddenOnly int POWER_POLICY_GROUP_REQ = 286265122;
-    field TIRAMISU_0 @hiddenOnly int CURRENT_POWER_POLICY = 286265123;
-    field TIRAMISU_0 @hiddenOnly int WATCHDOG_ALIVE = 290459441;
-    field TIRAMISU_0 @hiddenOnly int WATCHDOG_TERMINATED_PROCESS = 299896626;
-    field TIRAMISU_0 @hiddenOnly int VHAL_HEARTBEAT = 290459443;
-    field TIRAMISU_0 @hiddenOnly int CLUSTER_SWITCH_UI = 289410868;
-    field TIRAMISU_0 @hiddenOnly int CLUSTER_DISPLAY_STATE = 289476405;
-    field TIRAMISU_0 @hiddenOnly int CLUSTER_REPORT_STATE = 299896630;
-    field TIRAMISU_0 @hiddenOnly int CLUSTER_REQUEST_DISPLAY = 289410871;
-    field TIRAMISU_0 @hiddenOnly int CLUSTER_NAVIGATION_STATE = 292556600;
-    field TIRAMISU_0 int EPOCH_TIME = 290457094;
-    field TIRAMISU_0 int STORAGE_ENCRYPTION_BINDING_SEED = 292554247;
-    field TIRAMISU_0 int ELECTRONIC_TOLL_COLLECTION_CARD_TYPE = 289410873;
-    field TIRAMISU_0 int ELECTRONIC_TOLL_COLLECTION_CARD_STATUS = 289410874;
-    field TIRAMISU_0 int FRONT_FOG_LIGHTS_STATE = 289410875;
-    field TIRAMISU_0 int FRONT_FOG_LIGHTS_SWITCH = 289410876;
-    field TIRAMISU_0 int REAR_FOG_LIGHTS_STATE = 289410877;
-    field TIRAMISU_0 int REAR_FOG_LIGHTS_SWITCH = 289410878;
-    field TIRAMISU_0 int EV_CHARGE_CURRENT_DRAW_LIMIT = 291508031;
-    field TIRAMISU_0 int EV_CHARGE_PERCENT_LIMIT = 291508032;
-    field TIRAMISU_0 int EV_CHARGE_STATE = 289410881;
-    field TIRAMISU_0 int EV_CHARGE_SWITCH = 287313730;
-    field TIRAMISU_0 int EV_CHARGE_TIME_REMAINING = 289410883;
-    field TIRAMISU_0 int EV_REGENERATIVE_BRAKING_STATE = 289410884;
-    field TIRAMISU_0 int VEHICLE_CURB_WEIGHT = 289410886;
-    field TIRAMISU_0 int TRAILER_PRESENT = 289410885;
-    method TIRAMISU_0 String toString(int property);
-class VehicleUnit package android.car
-    field TIRAMISU_0 int SHOULD_NOT_USE = 0x000;
-    field TIRAMISU_0 int RPM = 0x02;
-    field TIRAMISU_0 int HERTZ = 0x03;
-    field TIRAMISU_0 int PERCENTILE = 0x10;
-    field TIRAMISU_0 int NANO_SECS = 0x50;
-    field TIRAMISU_0 int SECS = 0x53;
-    field TIRAMISU_0 int YEAR = 0x59;
-    field TIRAMISU_0 int MILLIAMPERE = 0x61;
-    field TIRAMISU_0 int MILLIVOLT = 0x62;
-    field TIRAMISU_0 int MILLIWATTS = 0x63;
-    field TIRAMISU_0 int DEGREES = 0x80;
-    field TIRAMISU_0 int MILLIMETER = 0x20;
-    field TIRAMISU_0 int METER = 0x21;
-    field TIRAMISU_0 int KILOMETER = 0x23;
-    field TIRAMISU_0 int MILE = 0x24;
-    field TIRAMISU_0 int CELSIUS = 0x30;
-    field TIRAMISU_0 int FAHRENHEIT = 0x31;
-    field TIRAMISU_0 int KELVIN = 0x32;
-    field TIRAMISU_0 int MILLILITER = 0x40;
-    field TIRAMISU_0 int LITER = 0x41;
-    field TIRAMISU_0 int US_GALLON = 0x42;
-    field TIRAMISU_0 int IMPERIAL_GALLON = 0x43;
-    field TIRAMISU_0 int WATT_HOUR = 0x60;
-    field TIRAMISU_0 int AMPERE_HOURS = 0x64;
-    field TIRAMISU_0 int KILOWATT_HOUR = 0x65;
-    field TIRAMISU_0 int KILOPASCAL = 0x70;
-    field TIRAMISU_0 int PSI = 0x71;
-    field TIRAMISU_0 int BAR = 0x72;
-    field TIRAMISU_0 int METER_PER_SEC = 0x01;
-    field TIRAMISU_0 int MILES_PER_HOUR = 0x90;
-    field TIRAMISU_0 int KILOMETERS_PER_HOUR = 0x91;
-class @hide @SystemApi CarPerformanceManager package android.car.os
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-    method TIRAMISU_0 @hiddenOnly void addCpuAvailabilityChangeListener(Executor executor, CpuAvailabilityMonitoringConfig config, CpuAvailabilityChangeListener listener);
-    method TIRAMISU_0 @hiddenOnly void removeCpuAvailabilityChangeListener(Executor executor, CpuAvailabilityChangeListener listener);
-    method TIRAMISU_1 void setThreadPriority(ThreadPolicyWithPriority policyWithPriority);
-    method TIRAMISU_1 ThreadPolicyWithPriority getThreadPriority();
-class @hide @SystemApi CarPerformanceManager.SetSchedulerFailedException package android.car.os
-interface @hiddenOnly @hide CarPerformanceManager.CpuAvailabilityChangeListener package android.car.os
-    method TIRAMISU_0 void onCpuAvailabilityChange(CpuAvailabilityInfo info);
-class @hiddenOnly @hide CpuAvailabilityMonitoringConfig package android.car.os
-    field TIRAMISU_0 int CPUSET_ALL = 1;
-    field TIRAMISU_0 int CPUSET_BACKGROUND = 2;
-    field TIRAMISU_0 int IGNORE_PERCENT_LOWER_BOUND = 0;
-    field TIRAMISU_0 int IGNORE_PERCENT_UPPER_BOUND = 100;
-    field TIRAMISU_0 int MONITORING_TIMEOUT_NEVER = -1;
-    field TIRAMISU_0 int TIMEOUT_ACTION_NOTIFICATION = 1;
-    field TIRAMISU_0 int TIMEOUT_ACTION_REMOVE = 2;
-    field TIRAMISU_0 Parcelable.Creator<CpuAvailabilityMonitoringConfig> CREATOR;
-    method TIRAMISU_0 @hiddenOnly String cpusetToString(int value);
-    method TIRAMISU_0 @hiddenOnly String ignorePercentToString(int value);
-    method TIRAMISU_0 @hiddenOnly String timeoutActionToString(int value);
-    method TIRAMISU_0 int getCpuset();
-    method TIRAMISU_0 int getLowerBoundPercent();
-    method TIRAMISU_0 int getUpperBoundPercent();
-    method TIRAMISU_0 long getTimeoutInSeconds();
-    method TIRAMISU_0 int getTimeoutAction();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class CpuAvailabilityMonitoringConfig.Builder package android.car.os
-    method TIRAMISU_0 Builder setCpuset(int value);
-    method TIRAMISU_0 Builder setLowerBoundPercent(int value);
-    method TIRAMISU_0 Builder setUpperBoundPercent(int value);
-    method TIRAMISU_0 Builder setTimeoutInSeconds(long value);
-    method TIRAMISU_0 Builder setTimeoutAction(int value);
-    method TIRAMISU_0 CpuAvailabilityMonitoringConfig build();
-class @hide @SystemApi ThreadPolicyWithPriority package android.car.os
-    field TIRAMISU_1 int PRIORITY_MIN = 1;
-    field TIRAMISU_1 int PRIORITY_MAX = 99;
-    field TIRAMISU_1 int SCHED_DEFAULT = 0;
-    field TIRAMISU_1 int SCHED_FIFO = 1;
-    field TIRAMISU_1 int SCHED_RR = 2;
-    field TIRAMISU_1 Parcelable.Creator<ThreadPolicyWithPriority> CREATOR;
-    method  @hiddenOnly String priorityToString(int value);
-    method TIRAMISU_1 @hiddenOnly String schedToString(int value);
-    method TIRAMISU_1 int getPolicy();
-    method TIRAMISU_1 int getPriority();
-    method TIRAMISU_1 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_1 int describeContents();
-class @hiddenOnly @hide CpuAvailabilityInfo package android.car.os
-    field TIRAMISU_0 Parcelable.Creator<CpuAvailabilityInfo> CREATOR;
-    method TIRAMISU_0 int getCpuset();
-    method TIRAMISU_0 int getAverageAvailabilityPercent();
-    method TIRAMISU_0 boolean isTimeout();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide CpuAvailabilityInfo.Builder package android.car.os
-    method TIRAMISU_0 Builder setCpuset(int value);
-    method TIRAMISU_0 Builder setAverageAvailabilityPercent(int value);
-    method TIRAMISU_0 Builder setTimeout(boolean value);
-    method TIRAMISU_0 CpuAvailabilityInfo build();
-class ResourceOveruseStats package android.car.watchdog
-    field TIRAMISU_0 Parcelable.Creator<ResourceOveruseStats> CREATOR;
-    method TIRAMISU_0 String getPackageName();
-    method TIRAMISU_0 UserHandle getUserHandle();
-    method TIRAMISU_0 IoOveruseStats getIoOveruseStats();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide ResourceOveruseStats.Builder package android.car.watchdog
-    method TIRAMISU_0 Builder setPackageName(String value);
-    method TIRAMISU_0 Builder setUserHandle(UserHandle value);
-    method TIRAMISU_0 Builder setIoOveruseStats(IoOveruseStats value);
-    method TIRAMISU_0 ResourceOveruseStats build();
-class @hide @SystemApi IoOveruseAlertThreshold package android.car.watchdog
-    field TIRAMISU_0 Parcelable.Creator<IoOveruseAlertThreshold> CREATOR;
-    method TIRAMISU_0 long getDurationInSeconds();
-    method TIRAMISU_0 long getWrittenBytesPerSecond();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class IoOveruseStats package android.car.watchdog
-    field TIRAMISU_0 Parcelable.Creator<IoOveruseStats> CREATOR;
-    method TIRAMISU_0 long getStartTime();
-    method TIRAMISU_0 long getDurationInSeconds();
-    method TIRAMISU_0 long getTotalOveruses();
-    method TIRAMISU_0 long getTotalTimesKilled();
-    method TIRAMISU_0 long getTotalBytesWritten();
-    method TIRAMISU_0 boolean isKillableOnOveruse();
-    method TIRAMISU_0 PerStateBytes getRemainingWriteBytes();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hiddenOnly @hide IoOveruseStats.Builder package android.car.watchdog
-    method TIRAMISU_0 Builder setStartTime(long value);
-    method TIRAMISU_0 Builder setDurationInSeconds(long value);
-    method TIRAMISU_0 Builder setTotalOveruses(long value);
-    method TIRAMISU_0 Builder setTotalTimesKilled(long value);
-    method TIRAMISU_0 Builder setTotalBytesWritten(long value);
-    method TIRAMISU_0 Builder setKillableOnOveruse(boolean value);
-    method TIRAMISU_0 Builder setRemainingWriteBytes(PerStateBytes value);
-    method TIRAMISU_0 IoOveruseStats build();
-class CarWatchdogManager package android.car.watchdog
-    field TIRAMISU_0 int TIMEOUT_CRITICAL = 0;
-    field TIRAMISU_0 int TIMEOUT_MODERATE = 1;
-    field TIRAMISU_0 int TIMEOUT_NORMAL = 2;
-    field TIRAMISU_0 int STATS_PERIOD_CURRENT_DAY = 1;
-    field TIRAMISU_0 int STATS_PERIOD_PAST_3_DAYS = 2;
-    field TIRAMISU_0 int STATS_PERIOD_PAST_7_DAYS = 3;
-    field TIRAMISU_0 int STATS_PERIOD_PAST_15_DAYS = 4;
-    field TIRAMISU_0 int STATS_PERIOD_PAST_30_DAYS = 5;
-    field TIRAMISU_0 int FLAG_RESOURCE_OVERUSE_IO = 1 << 0;
-    field TIRAMISU_0 int FLAG_MINIMUM_STATS_IO_1_MB = 1 << 0;
-    field TIRAMISU_0 int FLAG_MINIMUM_STATS_IO_100_MB = 1 << 1;
-    field TIRAMISU_0 int FLAG_MINIMUM_STATS_IO_1_GB = 1 << 2;
-    field TIRAMISU_0 int RETURN_CODE_SUCCESS = 0;
-    field TIRAMISU_0 int RETURN_CODE_ERROR = -1;
-    method TIRAMISU_0 void registerClient(Executor executor, CarWatchdogClientCallback client, int timeout);
-    method TIRAMISU_0 void unregisterClient(CarWatchdogClientCallback client);
-    method TIRAMISU_0 void tellClientAlive(CarWatchdogClientCallback client, int sessionId);
-    method TIRAMISU_0 ResourceOveruseStats getResourceOveruseStats(int resourceOveruseFlag, int maxStatsPeriod);
-    method TIRAMISU_0 List<ResourceOveruseStats> getAllResourceOveruseStats(int resourceOveruseFlag, int minimumStatsFlag, int maxStatsPeriod);
-    method TIRAMISU_0 ResourceOveruseStats getResourceOveruseStatsForUserPackage(String packageName, UserHandle userHandle, int resourceOveruseFlag, int maxStatsPeriod);
-    method TIRAMISU_0 void addResourceOveruseListener(Executor executor, int resourceOveruseFlag, ResourceOveruseListener listener);
-    method TIRAMISU_0 void removeResourceOveruseListener(ResourceOveruseListener listener);
-    method TIRAMISU_0 void addResourceOveruseListenerForSystem(Executor executor, int resourceOveruseFlag, ResourceOveruseListener listener);
-    method TIRAMISU_0 void removeResourceOveruseListenerForSystem(ResourceOveruseListener listener);
-    method TIRAMISU_0 void setKillablePackageAsUser(String packageName, UserHandle userHandle, boolean isKillable);
-    method TIRAMISU_0 List<PackageKillableState> getPackageKillableStatesAsUser(UserHandle userHandle);
-    method TIRAMISU_0 int setResourceOveruseConfigurations(List<ResourceOveruseConfiguration> configurations, int resourceOveruseFlag);
-    method TIRAMISU_0 List<ResourceOveruseConfiguration> getResourceOveruseConfigurations(int resourceOveruseFlag);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-class @hide @SystemApi CarWatchdogManager.CarWatchdogClientCallback package android.car.watchdog
-    method TIRAMISU_0 boolean onCheckHealthStatus(int sessionId, int timeout);
-    method TIRAMISU_0 void onPrepareProcessTermination();
-interface CarWatchdogManager.ResourceOveruseListener package android.car.watchdog
-    method TIRAMISU_0 void onOveruse(ResourceOveruseStats resourceOveruseStats);
-class @hide @SystemApi IoOveruseConfiguration package android.car.watchdog
-    field TIRAMISU_0 Parcelable.Creator<IoOveruseConfiguration> CREATOR;
-    method TIRAMISU_0 PerStateBytes getComponentLevelThresholds();
-    method TIRAMISU_0 Map<String,PerStateBytes> getPackageSpecificThresholds();
-    method TIRAMISU_0 Map<String,PerStateBytes> getAppCategorySpecificThresholds();
-    method TIRAMISU_0 List<IoOveruseAlertThreshold> getSystemWideThresholds();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class IoOveruseConfiguration.Builder package android.car.watchdog
-    method TIRAMISU_0 Builder setComponentLevelThresholds(PerStateBytes value);
-    method TIRAMISU_0 Builder setPackageSpecificThresholds(Map<String,PerStateBytes> value);
-    method TIRAMISU_0 Builder addPackageSpecificThresholds(String key, PerStateBytes value);
-    method TIRAMISU_0 Builder setAppCategorySpecificThresholds(Map<String,PerStateBytes> value);
-    method TIRAMISU_0 Builder addAppCategorySpecificThresholds(String key, PerStateBytes value);
-    method TIRAMISU_0 Builder setSystemWideThresholds(List<IoOveruseAlertThreshold> value);
-    method TIRAMISU_0 Builder addSystemWideThresholds(IoOveruseAlertThreshold value);
-    method TIRAMISU_0 IoOveruseConfiguration build();
-class @hide @SystemApi ResourceOveruseConfiguration package android.car.watchdog
-    field TIRAMISU_0 int COMPONENT_TYPE_SYSTEM = 1;
-    field TIRAMISU_0 int COMPONENT_TYPE_VENDOR = 2;
-    field TIRAMISU_0 int COMPONENT_TYPE_THIRD_PARTY = 3;
-    field TIRAMISU_0 String APPLICATION_CATEGORY_TYPE_MAPS = "android.car.watchdog.app.category.MAPS";
-    field TIRAMISU_0 String APPLICATION_CATEGORY_TYPE_MEDIA = "android.car.watchdog.app.category.MEDIA";
-    field TIRAMISU_0 Parcelable.Creator<ResourceOveruseConfiguration> CREATOR;
-    method TIRAMISU_0 @hiddenOnly String componentTypeToString(int value);
-    method TIRAMISU_0 int getComponentType();
-    method TIRAMISU_0 List<String> getSafeToKillPackages();
-    method TIRAMISU_0 List<String> getVendorPackagePrefixes();
-    method TIRAMISU_0 Map<String,String> getPackagesToAppCategoryTypes();
-    method TIRAMISU_0 IoOveruseConfiguration getIoOveruseConfiguration();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class ResourceOveruseConfiguration.Builder package android.car.watchdog
-    method TIRAMISU_0 Builder setComponentType(int value);
-    method TIRAMISU_0 Builder setSafeToKillPackages(List<String> value);
-    method TIRAMISU_0 Builder addSafeToKillPackages(String value);
-    method TIRAMISU_0 Builder setVendorPackagePrefixes(List<String> value);
-    method TIRAMISU_0 Builder addVendorPackagePrefixes(String value);
-    method TIRAMISU_0 Builder setPackagesToAppCategoryTypes(Map<String,String> value);
-    method TIRAMISU_0 Builder addPackagesToAppCategoryTypes(String key, String value);
-    method TIRAMISU_0 Builder setIoOveruseConfiguration(IoOveruseConfiguration value);
-    method TIRAMISU_0 ResourceOveruseConfiguration build();
-class PerStateBytes package android.car.watchdog
-    field TIRAMISU_0 Parcelable.Creator<PerStateBytes> CREATOR;
-    method TIRAMISU_0 long getForegroundModeBytes();
-    method TIRAMISU_0 long getBackgroundModeBytes();
-    method TIRAMISU_0 long getGarageModeBytes();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class @hide @SystemApi PackageKillableState package android.car.watchdog
-    field TIRAMISU_0 int KILLABLE_STATE_YES = 1;
-    field TIRAMISU_0 int KILLABLE_STATE_NO = 2;
-    field TIRAMISU_0 int KILLABLE_STATE_NEVER = 3;
-    field TIRAMISU_0 Parcelable.Creator<PackageKillableState> CREATOR;
-    method TIRAMISU_0 @hiddenOnly String killableStateToString(int value);
-    method TIRAMISU_0 String getPackageName();
-    method TIRAMISU_0 int getUserId();
-    method TIRAMISU_0 int getKillableState();
-    method TIRAMISU_0 String toString();
-    method TIRAMISU_0 void writeToParcel(android.os.Parcel dest, int flags);
-    method TIRAMISU_0 int describeContents();
-class CarAppFocusManager package android.car
-    field TIRAMISU_0 int APP_FOCUS_TYPE_NAVIGATION = 1;
-    field TIRAMISU_0 int APP_FOCUS_TYPE_VOICE_COMMAND = 2;
-    field TIRAMISU_0 @hiddenOnly int APP_FOCUS_MAX = 2;
-    field TIRAMISU_0 int APP_FOCUS_REQUEST_FAILED = 0;
-    field TIRAMISU_0 int APP_FOCUS_REQUEST_SUCCEEDED = 1;
-    method TIRAMISU_0 void addFocusListener(OnAppFocusChangedListener listener, int appType);
-    method TIRAMISU_0 void removeFocusListener(OnAppFocusChangedListener listener, int appType);
-    method TIRAMISU_0 void removeFocusListener(OnAppFocusChangedListener listener);
-    method TIRAMISU_0 @hiddenOnly int[] getActiveAppTypes();
-    method TIRAMISU_0 @hiddenOnly List<String> getAppTypeOwner(int appType);
-    method TIRAMISU_0 boolean isOwningFocus(OnAppFocusOwnershipCallback callback, int appType);
-    method TIRAMISU_0 int requestAppFocus(int appType, OnAppFocusOwnershipCallback ownershipCallback);
-    method TIRAMISU_0 void abandonAppFocus(OnAppFocusOwnershipCallback ownershipCallback, int appType);
-    method TIRAMISU_0 void abandonAppFocus(OnAppFocusOwnershipCallback ownershipCallback);
-    method TIRAMISU_0 @hiddenOnly void onCarDisconnected();
-interface CarAppFocusManager.OnAppFocusChangedListener package android.car
-    method TIRAMISU_0 void onAppFocusChanged(int appType, boolean active);
-interface CarAppFocusManager.OnAppFocusOwnershipCallback package android.car
-    method TIRAMISU_0 void onAppFocusOwnershipLost(int appType);
-    method TIRAMISU_0 void onAppFocusOwnershipGranted(int appType);
-class CarVersion package android.car
-    field TIRAMISU_1 Parcelable.Creator<CarVersion> CREATOR;
-    method TIRAMISU_1 CarVersion forMajorAndMinorVersions(int majorVersion, int minorVersion);
-    method TIRAMISU_1 CarVersion forMajorVersion(int majorVersion);
-    method TIRAMISU_1 int describeContents();
-    method TIRAMISU_1 void writeToParcel(Parcel dest, int flags);
-class CarVersion.VERSION_CODES package android.car
-    field TIRAMISU_1 CarVersion TIRAMISU_0 = forMajorAndMinorVersions(Build.VERSION_CODES.TIRAMISU, 0);
-    field TIRAMISU_1 CarVersion TIRAMISU_1 = forMajorAndMinorVersions(Build.VERSION_CODES.TIRAMISU, 1);
diff --git a/tools/GenericCarApiBuilder/complete_car_built_in_api_list.txt b/tools/GenericCarApiBuilder/complete_car_built_in_api_list.txt
deleted file mode 100644
index 387164c783..0000000000
--- a/tools/GenericCarApiBuilder/complete_car_built_in_api_list.txt
+++ /dev/null
@@ -1,339 +0,0 @@
-class @hide @SystemApi AudioManagerHelper package android.car.builtin.media
-    field TIRAMISU_0 int UNDEFINED_STREAM_TYPE = -1;
-    method TIRAMISU_0 boolean setAudioDeviceGain(AudioManager audioManager, String address, int gainInMillibels, boolean isOutput);
-    method TIRAMISU_0 AudioGainInfo getAudioGainInfo(AudioDeviceInfo deviceInfo);
-    method TIRAMISU_0 AudioPatchInfo createAudioPatch(AudioDeviceInfo sourceDevice, AudioDeviceInfo sinkDevice, int gainInMillibels);
-    method TIRAMISU_0 boolean releaseAudioPatch(AudioManager audioManager, AudioPatchInfo info);
-    method TIRAMISU_0 String usageToString(int usage);
-    method TIRAMISU_0 String usageToXsdString(int usage);
-    method TIRAMISU_0 int xsdStringToUsage(String usage);
-    method TIRAMISU_0 int getUsageVirtualSource();
-    method TIRAMISU_0 String adjustToString(int adjustment);
-    method TIRAMISU_0 void setMasterMute(AudioManager audioManager, boolean mute, int flags);
-    method TIRAMISU_0 boolean isMasterMute(AudioManager audioManager);
-    method TIRAMISU_0 void registerVolumeAndMuteReceiver(Context context, VolumeAndMuteReceiver audioAndMuteHelper);
-    method TIRAMISU_0 void unregisterVolumeAndMuteReceiver(Context context, VolumeAndMuteReceiver audioAndMuteHelper);
-    method TIRAMISU_0 boolean isCallFocusRequestClientId(String clientId);
-class AudioManagerHelper.AudioGainInfo package android.car.builtin.media
-    method TIRAMISU_0 int getMinGain();
-    method TIRAMISU_0 int getMaxGain();
-    method TIRAMISU_0 int getDefaultGain();
-    method TIRAMISU_0 int getStepValue();
-class AudioManagerHelper.AudioPatchInfo package android.car.builtin.media
-    method TIRAMISU_0 int getHandleId();
-    method TIRAMISU_0 String getSourceAddress();
-    method TIRAMISU_0 String getSinkAddress();
-    method TIRAMISU_0 String toString();
-class AudioManagerHelper.VolumeAndMuteReceiver package android.car.builtin.media
-    method TIRAMISU_0 void onVolumeChanged(int streamType);
-    method TIRAMISU_0 void onMuteChanged();
-class @hide @SystemApi PackageManagerHelper package android.car.builtin.content.pm
-    field TIRAMISU_0 String PROPERTY_CAR_SERVICE_PACKAGE_NAME = "ro.android.car.carservice.package";
-    field TIRAMISU_0 String PROPERTY_CAR_SERVICE_OVERLAY_PACKAGES = "ro.android.car.carservice.overlay.packages";
-    method TIRAMISU_0 String getSystemUiPackageName(Context context);
-    method TIRAMISU_0 PackageInfo getPackageInfoAsUser(PackageManager pm, String packageName, int packageInfoFlags, int userId);
-    method TIRAMISU_0 int getPackageUidAsUser(PackageManager pm, String packageName, int userId);
-    method TIRAMISU_0 String[] getNamesForUids(PackageManager pm, int[] uids);
-    method TIRAMISU_0 int getApplicationEnabledSettingForUser(String packageName, int userId);
-    method TIRAMISU_0 void setApplicationEnabledSettingForUser(String packageName, int newState, int flags, int userId, String callingPackage);
-    method TIRAMISU_0 boolean isOemApp(ApplicationInfo appInfo);
-    method TIRAMISU_0 boolean isOdmApp(ApplicationInfo appInfo);
-    method TIRAMISU_0 boolean isVendorApp(ApplicationInfo appInfo);
-    method TIRAMISU_0 boolean isSystemApp(ApplicationInfo appInfo);
-    method TIRAMISU_0 boolean isUpdatedSystemApp(ApplicationInfo appInfo);
-    method TIRAMISU_0 boolean isProductApp(ApplicationInfo appInfo);
-    method TIRAMISU_0 boolean isSystemExtApp(ApplicationInfo appInfo);
-    method TIRAMISU_0 ComponentName getComponentName(ComponentInfo info);
-class @hide @SystemApi ContextHelper package android.car.builtin.content
-    method TIRAMISU_0 int getDisplayId(Context context);
-    method TIRAMISU_0 void startActivityAsUser(Context context, Intent intent, Bundle options, UserHandle user);
-class @hide @SystemApi JobSchedulerHelper package android.car.builtin.job
-    method TIRAMISU_0 int getNumberOfRunningJobsAtIdle(Context context);
-    method TIRAMISU_0 int getNumberOfPendingJobs(Context context);
-class @hide @SystemApi DisplayHelper package android.car.builtin.view
-    field TIRAMISU_0 int INVALID_PORT = -1;
-    field TIRAMISU_0 int TYPE_INTERNAL = Display.TYPE_INTERNAL;
-    field TIRAMISU_0 int TYPE_EXTERNAL = Display.TYPE_EXTERNAL;
-    field TIRAMISU_0 int TYPE_VIRTUAL = Display.TYPE_VIRTUAL;
-    method TIRAMISU_0 int getPhysicalPort(Display display);
-    method TIRAMISU_0 String getUniqueId(Display display);
-    method TIRAMISU_0 int getType(Display display);
-class @hide @SystemApi KeyEventHelper package android.car.builtin.view
-    method TIRAMISU_0 void setDisplayId(KeyEvent keyEvent, int newDisplayId);
-class @hide @SystemApi DisplayAreaOrganizerHelper package android.car.builtin.window
-    field TIRAMISU_0 int FEATURE_UNDEFINED = DisplayAreaOrganizer.FEATURE_UNDEFINED;
-class @hide @SystemApi LockPatternHelper package android.car.builtin.widget
-    method TIRAMISU_0 boolean isSecure(Context context, int userId);
-class @hide @SystemApi AdvertisingSetHelper package android.car.builtin.bluetooth.le
-    method TIRAMISU_1 void getOwnAddress(AdvertisingSet advertisingSet);
-class @hide @SystemApi AdvertisingSetCallbackHelper package android.car.builtin.bluetooth.le
-    method TIRAMISU_1 AdvertisingSetCallback createRealCallbackFromProxy(Callback proxy);
-class AdvertisingSetCallbackHelper.Callback package android.car.builtin.bluetooth.le
-    method TIRAMISU_1 void onAdvertisingSetStarted(AdvertisingSet advertisingSet, int txPower, int status);
-    method TIRAMISU_1 void onAdvertisingSetStopped(AdvertisingSet advertisingSet);
-    method TIRAMISU_1 void onAdvertisingEnabled(AdvertisingSet advertisingSet, boolean enable, int status);
-    method TIRAMISU_1 void onAdvertisingDataSet(AdvertisingSet advertisingSet, int status);
-    method TIRAMISU_1 void onScanResponseDataSet(AdvertisingSet advertisingSet, int status);
-    method TIRAMISU_1 void onAdvertisingParametersUpdated(AdvertisingSet advertisingSet, int txPower, int status);
-    method TIRAMISU_1 void onPeriodicAdvertisingParametersUpdated(AdvertisingSet advertisingSet, int status);
-    method TIRAMISU_1 void onPeriodicAdvertisingDataSet(AdvertisingSet advertisingSet, int status);
-    method TIRAMISU_1 void onPeriodicAdvertisingEnabled(AdvertisingSet advertisingSet, boolean enable, int status);
-    method TIRAMISU_1 void onOwnAddressRead(AdvertisingSet advertisingSet, int addressType, String address);
-class @hide @SystemApi BluetoothHeadsetClientHelper package android.car.builtin.bluetooth
-    method TIRAMISU_0 List<BluetoothDevice> getConnectedBvraDevices(BluetoothHeadsetClient headsetClient);
-    method TIRAMISU_0 boolean startVoiceRecognition(BluetoothHeadsetClient headsetClient, BluetoothDevice device);
-    method TIRAMISU_0 boolean stopVoiceRecognition(BluetoothHeadsetClient headsetClient, BluetoothDevice device);
-class @hide @SystemApi InputManagerHelper package android.car.builtin.input
-    method TIRAMISU_0 boolean injectInputEvent(InputManager inputManager, android.view.InputEvent event);
-class @hide @SystemApi VoiceInteractionHelper package android.car.builtin.app
-    method TIRAMISU_0 boolean isAvailable();
-    method TIRAMISU_0 void setEnabled(boolean enabled);
-class @hide @SystemApi TaskInfoHelper package android.car.builtin.app
-    method TIRAMISU_0 int getDisplayId(TaskInfo task);
-    method TIRAMISU_0 int getUserId(TaskInfo task);
-    method TIRAMISU_0 boolean isVisible(TaskInfo task);
-    method TIRAMISU_0 String toString(TaskInfo task);
-class @hide @SystemApi ActivityManagerHelper package android.car.builtin.app
-    field TIRAMISU_0 int INVALID_TASK_ID = ActivityTaskManager.INVALID_TASK_ID;
-    method TIRAMISU_0 boolean startUserInBackground(int userId);
-    method TIRAMISU_0 boolean startUserInForeground(int userId);
-    method TIRAMISU_0 int stopUserWithDelayedLocking(int userId, boolean force);
-    method TIRAMISU_0 boolean unlockUser(int userId);
-    method TIRAMISU_0 void stopAllTasksForUser(int userId);
-    method TIRAMISU_0 ActivityOptions createActivityOptions(Bundle bOptions);
-    method TIRAMISU_0 void setFocusedRootTask(int taskId);
-    method TIRAMISU_0 boolean removeTask(int taskId);
-    method TIRAMISU_0 void registerProcessObserverCallback(ProcessObserverCallback callback);
-    method TIRAMISU_0 void unregisterProcessObserverCallback(ProcessObserverCallback callback);
-    method TIRAMISU_0 int checkComponentPermission(String permission, int uid, int owningUid, boolean exported);
-class ActivityManagerHelper.ProcessObserverCallback package android.car.builtin.app
-    field TIRAMISU_0 IProcessObserver.Stub mIProcessObserver = new IProcessObserver.Stub() {
-
-    @Override
-    public void onForegroundActivitiesChanged(int pid, int uid, boolean foregroundActivities) throws RemoteException {
-        ProcessObserverCallback.this.onForegroundActivitiesChanged(pid, uid, foregroundActivities);
-    }
-
-    @Override
-    public void onForegroundServicesChanged(int pid, int uid, int fgServiceTypes) throws RemoteException {
-    // Not used
-    }
-
-    @Override
-    public void onProcessDied(int pid, int uid) throws RemoteException {
-        ProcessObserverCallback.this.onProcessDied(pid, uid);
-    }
-};
-    method TIRAMISU_0 void onForegroundActivitiesChanged(int pid, int uid, boolean foregroundActivities);
-    method TIRAMISU_0 void onProcessDied(int pid, int uid);
-class @hide @SystemApi KeyguardManagerHelper package android.car.builtin.app
-    method TIRAMISU_0 boolean isKeyguardLocked();
-class @hide @SystemApi PermissionHelper package android.car.builtin
-    field TIRAMISU_0 String MONITOR_INPUT = android.Manifest.permission.MONITOR_INPUT;
-class @hide @SystemApi AtomicFileHelper package android.car.builtin.util
-    method TIRAMISU_0 boolean exists(AtomicFile file);
-class @hide @SystemApi EventLogHelper package android.car.builtin.util
-    method TIRAMISU_0 void writeCarHelperStart();
-    method TIRAMISU_0 void writeCarHelperBootPhase(int phase);
-    method TIRAMISU_0 void writeCarHelperUserStarting(int userId);
-    method TIRAMISU_0 void writeCarHelperUserSwitching(int fromUserId, int toUserId);
-    method TIRAMISU_0 void writeCarHelperUserUnlocking(int userId);
-    method TIRAMISU_0 void writeCarHelperUserUnlocked(int userId);
-    method TIRAMISU_0 void writeCarHelperUserStopping(int userId);
-    method TIRAMISU_0 void writeCarHelperUserStopped(int userId);
-    method TIRAMISU_0 void writeCarHelperServiceConnected();
-    method TIRAMISU_0 void writeCarServiceInit(int numberServices);
-    method TIRAMISU_0 void writeCarServiceVhalReconnected(int numberServices);
-    method TIRAMISU_0 void writeCarServiceSetCarServiceHelper(int pid);
-    method TIRAMISU_0 void writeCarServiceOnUserLifecycle(int type, int fromUserId, int toUserId);
-    method TIRAMISU_0 void writeCarServiceCreate(boolean hasVhal);
-    method TIRAMISU_0 void writeCarServiceConnected(String interfaceName);
-    method TIRAMISU_0 void writeCarServiceDestroy(boolean hasVhal);
-    method TIRAMISU_0 void writeCarServiceVhalDied(long cookie);
-    method TIRAMISU_0 void writeCarServiceInitBootUser();
-    method TIRAMISU_0 void writeCarServiceOnUserRemoved(int userId);
-    method TIRAMISU_0 void writeCarUserServiceInitialUserInfoReq(int requestType, int timeout, int currentUserId, int currentUserFlags, int numberExistingUsers);
-    method TIRAMISU_0 void writeCarUserServiceInitialUserInfoResp(int status, int action, int userId, int flags, String safeName, String userLocales);
-    method TIRAMISU_0 void writeCarUserServiceSetInitialUser(int userId);
-    method TIRAMISU_0 void writeCarUserServiceSetLifecycleListener(int uid, String packageName);
-    method TIRAMISU_0 void writeCarUserServiceResetLifecycleListener(int uid, String packageName);
-    method TIRAMISU_0 void writeCarUserServiceSwitchUserReq(int userId, int timeout);
-    method TIRAMISU_0 void writeCarUserServiceSwitchUserResp(int halCallbackStatus, int userSwitchStatus, String errorMessage);
-    method TIRAMISU_0 void writeCarUserServiceLogoutUserReq(int userId, int timeout);
-    method TIRAMISU_0 void writeCarUserServiceLogoutUserResp(int halCallbackStatus, int userSwitchStatus, String errorMessage);
-    method TIRAMISU_0 void writeCarUserServicePostSwitchUserReq(int targetUserId, int currentUserId);
-    method TIRAMISU_0 void writeCarUserServiceGetUserAuthReq(int uid, int userId, int numberTypes);
-    method TIRAMISU_0 void writeCarUserServiceGetUserAuthResp(int numberValues);
-    method TIRAMISU_0 void writeCarUserServiceSwitchUserUiReq(int userId);
-    method TIRAMISU_0 void writeCarUserServiceSwitchUserFromHalReq(int requestId, int uid);
-    method TIRAMISU_0 void writeCarUserServiceSetUserAuthReq(int uid, int userId, int numberAssociations);
-    method TIRAMISU_0 void writeCarUserServiceSetUserAuthResp(int numberValues, String errorMessage);
-    method TIRAMISU_0 void writeCarUserServiceCreateUserReq(String safeName, String userType, int flags, int timeout, int hasCallerRestrictions);
-    method TIRAMISU_0 void writeCarUserServiceCreateUserResp(int status, int result, String errorMessage);
-    method TIRAMISU_0 void writeCarUserServiceCreateUserUserCreated(int userId, String safeName, String userType, int flags);
-    method TIRAMISU_0 void writeCarUserServiceCreateUserUserRemoved(int userId, String reason);
-    method TIRAMISU_0 void writeCarUserServiceRemoveUserReq(int userId, int hascallerrestrictions);
-    method TIRAMISU_0 void writeCarUserServiceRemoveUserResp(int userId, int result);
-    method TIRAMISU_0 void writeCarUserServiceNotifyAppLifecycleListener(int uid, String packageName, int eventType, int fromUserId, int toUserId);
-    method TIRAMISU_0 void writeCarUserServiceNotifyInternalLifecycleListener(String listenerName, int eventType, int fromUserId, int toUserId);
-    method TIRAMISU_0 void writeCarUserServicePreCreationRequested(int numberUsers, int numberGuests);
-    method TIRAMISU_0 void writeCarUserServicePreCreationStatus(int numberExistingUsers, int numberUsersToAdd, int numberUsersToRemove, int numberExistingGuests, int numberGuestsToAdd, int numberGuestsToRemove, int numberInvalidUsersToRemove);
-    method TIRAMISU_0 void writeCarUserServiceStartUserInBackgroundReq(int userId);
-    method TIRAMISU_0 void writeCarUserServiceStartUserInBackgroundResp(int userId, int result);
-    method TIRAMISU_0 void writeCarUserServiceStopUserReq(int userId);
-    method TIRAMISU_0 void writeCarUserServiceStopUserResp(int userId, int result);
-    method TIRAMISU_0 void writeCarUserServiceInitialUserInfoReqComplete(int requestType);
-    method TIRAMISU_0 void writeCarUserHalInitialUserInfoReq(int requestId, int requestType, int timeout);
-    method TIRAMISU_0 void writeCarUserHalInitialUserInfoResp(int requestId, int status, int action, int userId, int flags, String safeName, String userLocales);
-    method TIRAMISU_0 void writeCarUserHalSwitchUserReq(int requestId, int userId, int userFlags, int timeout);
-    method TIRAMISU_0 void writeCarUserHalSwitchUserResp(int requestId, int status, int result, String errorMessage);
-    method TIRAMISU_0 void writeCarUserHalPostSwitchUserReq(int requestId, int targetUserId, int currentUserId);
-    method TIRAMISU_0 void writeCarUserHalGetUserAuthReq(Object[] int32Values);
-    method TIRAMISU_0 void writeCarUserHalGetUserAuthResp(Object[] valuesAndError);
-    method TIRAMISU_0 void writeCarUserHalLegacySwitchUserReq(int requestId, int targetUserId, int currentUserId);
-    method TIRAMISU_0 void writeCarUserHalSetUserAuthReq(Object[] int32Values);
-    method TIRAMISU_0 void writeCarUserHalSetUserAuthResp(Object[] valuesAndError);
-    method TIRAMISU_0 void writeCarUserHalOemSwitchUserReq(int requestId, int targetUserId);
-    method TIRAMISU_0 void writeCarUserHalCreateUserReq(int requestId, String safeName, int flags, int timeout);
-    method TIRAMISU_0 void writeCarUserHalCreateUserResp(int requestId, int status, int result, String errorMessage);
-    method TIRAMISU_0 void writeCarUserHalRemoveUserReq(int targetUserId, int currentUserId);
-    method TIRAMISU_0 void writeCarUserManagerAddListener(int uid, String packageName, boolean hasFilter);
-    method TIRAMISU_0 void writeCarUserManagerRemoveListener(int uid, String packageName);
-    method TIRAMISU_0 void writeCarUserManagerDisconnected(int uid);
-    method TIRAMISU_0 void writeCarUserManagerSwitchUserReq(int uid, int userId);
-    method TIRAMISU_0 void writeCarUserManagerSwitchUserResp(int uid, int status, String errorMessage);
-    method TIRAMISU_0 void writeCarUserManagerLogoutUserReq(int uid);
-    method TIRAMISU_0 void writeCarUserManagerLogoutUserResp(int uid, int status, String errorMessage);
-    method TIRAMISU_0 void writeCarUserManagerGetUserAuthReq(Object[] types);
-    method TIRAMISU_0 void writeCarUserManagerGetUserAuthResp(Object[] values);
-    method TIRAMISU_0 void writeCarUserManagerSetUserAuthReq(Object[] typesAndValuesPairs);
-    method TIRAMISU_0 void writeCarUserManagerSetUserAuthResp(Object[] values);
-    method TIRAMISU_0 void writeCarUserManagerCreateUserReq(int uid, String safeName, String userType, int flags);
-    method TIRAMISU_0 void writeCarUserManagerCreateUserResp(int uid, int status, String errorMessage);
-    method TIRAMISU_0 void writeCarUserManagerRemoveUserReq(int uid, int userId);
-    method TIRAMISU_0 void writeCarUserManagerRemoveUserResp(int uid, int status);
-    method TIRAMISU_0 void writeCarUserManagerNotifyLifecycleListener(int numberListeners, int eventType, int fromUserId, int toUserId);
-    method TIRAMISU_0 void writeCarUserManagerPreCreateUserReq(int uid);
-    method TIRAMISU_0 void writeCarDevicePolicyManagerRemoveUserReq(int uid, int userId);
-    method TIRAMISU_0 void writeCarDevicePolicyManagerRemoveUserResp(int uid, int status);
-    method TIRAMISU_0 void writeCarDevicePolicyManagerCreateUserReq(int uid, String safeName, int flags);
-    method TIRAMISU_0 void writeCarDevicePolicyManagerCreateUserResp(int uid, int status);
-    method TIRAMISU_0 void writeCarDevicePolicyManagerStartUserInBackgroundReq(int uid, int userId);
-    method TIRAMISU_0 void writeCarDevicePolicyManagerStartUserInBackgroundResp(int uid, int status);
-    method TIRAMISU_0 void writeCarDevicePolicyManagerStopUserReq(int uid, int userId);
-    method TIRAMISU_0 void writeCarDevicePolicyManagerStopUserResp(int uid, int status);
-    method TIRAMISU_0 void writePowerPolicyChange(String policy);
-    method TIRAMISU_0 void writeCarPowerManagerStateChange(int state);
-    method TIRAMISU_0 void writeCarPowerManagerStateRequest(int state, int param);
-    method TIRAMISU_0 void writeGarageModeEvent(int status);
-class @hide @SystemApi Slogf package android.car.builtin.util
-    method TIRAMISU_0 boolean isLoggable(String tag, int level);
-    method TIRAMISU_0 int v(String tag, String msg);
-    method TIRAMISU_0 int v(String tag, String msg, Throwable tr);
-    method TIRAMISU_0 int d(String tag, String msg);
-    method TIRAMISU_0 int d(String tag, String msg, Throwable tr);
-    method TIRAMISU_0 int i(String tag, String msg);
-    method TIRAMISU_0 int i(String tag, String msg, Throwable tr);
-    method TIRAMISU_0 int w(String tag, String msg);
-    method TIRAMISU_0 int w(String tag, String msg, Throwable tr);
-    method TIRAMISU_0 int w(String tag, Throwable tr);
-    method TIRAMISU_0 int e(String tag, String msg);
-    method TIRAMISU_0 int e(String tag, String msg, Throwable tr);
-    method TIRAMISU_0 int wtf(String tag, String msg);
-    method TIRAMISU_0 int wtf(String tag, Throwable tr);
-    method TIRAMISU_0 int wtf(String tag, String msg, Throwable tr);
-    method TIRAMISU_0 void v(String tag, String format, Object args);
-    method TIRAMISU_0 void d(String tag, String format, Object args);
-    method TIRAMISU_0 void i(String tag, String format, Object args);
-    method TIRAMISU_0 void w(String tag, String format, Object args);
-    method TIRAMISU_0 void w(String tag, Exception exception, String format, Object args);
-    method TIRAMISU_0 void e(String tag, String format, Object args);
-    method TIRAMISU_0 void e(String tag, Exception exception, String format, Object args);
-    method TIRAMISU_0 void wtf(String tag, String format, Object args);
-    method TIRAMISU_0 void wtf(String tag, Exception exception, String format, Object args);
-class @hide @SystemApi AssistUtilsHelper package android.car.builtin.util
-    field TIRAMISU_0 String EXTRA_CAR_PUSH_TO_TALK = "com.android.car.input.EXTRA_CAR_PUSH_TO_TALK";
-    method TIRAMISU_0 boolean isSessionRunning(Context context);
-    method TIRAMISU_0 void hideCurrentSession(Context context);
-    method TIRAMISU_0 void registerVoiceInteractionSessionListenerHelper(Context context, VoiceInteractionSessionListenerHelper sessionListener);
-    method TIRAMISU_0 boolean showPushToTalkSessionForActiveService(Context context, VoiceInteractionSessionShowCallbackHelper callback);
-interface AssistUtilsHelper.VoiceInteractionSessionShowCallbackHelper package android.car.builtin.util
-    method  void onFailed();
-    method  void onShown();
-interface AssistUtilsHelper.VoiceInteractionSessionListenerHelper package android.car.builtin.util
-    method  void onVoiceSessionShown();
-    method  void onVoiceSessionHidden();
-class @hide @SystemApi TimeUtils package android.car.builtin.util
-    method TIRAMISU_0 void dumpTime(PrintWriter pw, long time);
-    method TIRAMISU_0 void formatDuration(long duration, PrintWriter pw);
-class @hide @SystemApi TimingsTraceLog package android.car.builtin.util
-    method TIRAMISU_0 void traceBegin(String name);
-    method TIRAMISU_0 void traceEnd();
-    method TIRAMISU_0 void logDuration(String name, long timeMs);
-class @hide @SystemApi ValidationHelper package android.car.builtin.util
-    method TIRAMISU_0 boolean isUserIdValid(int userId);
-    method TIRAMISU_0 boolean isAppIdValid(int appId);
-class @hide @SystemApi PowerManagerHelper package android.car.builtin.power
-    method TIRAMISU_0 int getMaximumScreenBrightnessSetting(Context context);
-    method TIRAMISU_0 int getMinimumScreenBrightnessSetting(Context context);
-    method TIRAMISU_0 void setDisplayState(Context context, boolean on, long upTime);
-    method TIRAMISU_0 void shutdown(Context context, boolean confirm, String reason, boolean wait);
-class @hide @SystemApi BinderHelper package android.car.builtin.os
-    method TIRAMISU_0 void dumpRemoteCallbackList(RemoteCallbackList<?> list, PrintWriter pw);
-    method TIRAMISU_0 boolean onTransactForCmd(int code, Parcel data, Parcel reply, int flags, ShellCommandListener cmdListener);
-interface BinderHelper.ShellCommandListener package android.car.builtin.os
-    method TIRAMISU_0 int onShellCommand(FileDescriptor in, FileDescriptor out, FileDescriptor err, String[] args);
-class @hide @SystemApi ServiceManagerHelper package android.car.builtin.os
-    method TIRAMISU_0 IBinder getService(String name);
-    method TIRAMISU_0 IBinder checkService(String name);
-    method TIRAMISU_0 IBinder waitForDeclaredService(String name);
-    method TIRAMISU_0 void addService(String name, IBinder service);
-class @hide @SystemApi SystemPropertiesHelper package android.car.builtin.os
-    method TIRAMISU_0 void set(String key, String val);
-class @hide @SystemApi ParcelHelper package android.car.builtin.os
-    method TIRAMISU_0 String[] readStringArray(Parcel parcel);
-    method TIRAMISU_0 byte[] readBlob(Parcel parcel);
-    method TIRAMISU_0 void writeBlob(Parcel parcel, byte[] b);
-    method TIRAMISU_0 ArraySet<? extends Object> readArraySet(Parcel parcel, ClassLoader loader);
-    method TIRAMISU_0 void writeArraySet(Parcel parcel, ArraySet<? extends Object> val);
-class @hide @SystemApi BuildHelper package android.car.builtin.os
-    method TIRAMISU_0 boolean isUserBuild();
-    method TIRAMISU_0 boolean isEngBuild();
-    method TIRAMISU_0 boolean isUserDebugBuild();
-    method TIRAMISU_0 boolean isDebuggableBuild();
-class @hide @SystemApi UserManagerHelper package android.car.builtin.os
-    field TIRAMISU_0 int USER_NULL = UserHandle.USER_NULL;
-    field TIRAMISU_0 int USER_SYSTEM = UserHandle.USER_SYSTEM;
-    field TIRAMISU_0 int FLAG_PRIMARY = UserInfo.FLAG_PRIMARY;
-    field TIRAMISU_0 int FLAG_ADMIN = UserInfo.FLAG_ADMIN;
-    field TIRAMISU_0 int FLAG_GUEST = UserInfo.FLAG_GUEST;
-    field TIRAMISU_0 int FLAG_RESTRICTED = UserInfo.FLAG_RESTRICTED;
-    field TIRAMISU_0 int FLAG_INITIALIZED = UserInfo.FLAG_INITIALIZED;
-    field TIRAMISU_0 int FLAG_MANAGED_PROFILE = UserInfo.FLAG_MANAGED_PROFILE;
-    field TIRAMISU_0 int FLAG_DISABLED = UserInfo.FLAG_DISABLED;
-    field TIRAMISU_0 int FLAG_QUIET_MODE = UserInfo.FLAG_QUIET_MODE;
-    field TIRAMISU_0 int FLAG_EPHEMERAL = UserInfo.FLAG_EPHEMERAL;
-    field TIRAMISU_0 int FLAG_DEMO = UserInfo.FLAG_DEMO;
-    field TIRAMISU_0 int FLAG_FULL = UserInfo.FLAG_FULL;
-    field TIRAMISU_0 int FLAG_SYSTEM = UserInfo.FLAG_SYSTEM;
-    field TIRAMISU_0 int FLAG_PROFILE = UserInfo.FLAG_PROFILE;
-    method TIRAMISU_0 List<UserHandle> getUserHandles(UserManager userManager, boolean excludePartial, boolean excludeDying, boolean excludePreCreated);
-    method TIRAMISU_0 boolean isEphemeralUser(UserManager userManager, UserHandle user);
-    method TIRAMISU_0 boolean isEnabledUser(UserManager userManager, UserHandle user);
-    method TIRAMISU_0 boolean isPreCreatedUser(UserManager userManager, UserHandle user);
-    method TIRAMISU_0 boolean isInitializedUser(UserManager userManager, UserHandle user);
-    method TIRAMISU_0 String getDefaultUserTypeForUserInfoFlags(int userInfoFlag);
-    method TIRAMISU_0 UserHandle preCreateUser(UserManager userManager, String type);
-    method TIRAMISU_0 String getDefaultUserName(Context context);
-    method TIRAMISU_0 int getMaxRunningUsers(Context context);
-    method TIRAMISU_0 boolean markGuestForDeletion(UserManager userManager, UserHandle user);
-    method TIRAMISU_0 int getUserId(int uid);
-class @hide @SystemApi SharedMemoryHelper package android.car.builtin.os
-    method TIRAMISU_0 ParcelFileDescriptor createParcelFileDescriptor(SharedMemory memory);
-class @hide @SystemApi TraceHelper package android.car.builtin.os
-    field TIRAMISU_0 long TRACE_TAG_CAR_SERVICE = Trace.TRACE_TAG_SYSTEM_SERVER;
-class @hide @SystemApi SettingsHelper package android.car.builtin.provider
-    field TIRAMISU_0 String SYSTEM_LOCALES = "system_locales";
-class @hide @SystemApi CarBuiltin package android.car.builtin
-    field TIRAMISU_0 int PLATFORM_VERSION_MINOR_INT = SystemProperties.getInt(PROPERTY_PLATFORM_MINOR_VERSION, /* def= */
-0);
diff --git a/tools/GenericCarApiBuilder/hidden_api_check.py b/tools/GenericCarApiBuilder/hidden_api_check.py
index 58b6976775..aaa4d7f33d 100755
--- a/tools/GenericCarApiBuilder/hidden_api_check.py
+++ b/tools/GenericCarApiBuilder/hidden_api_check.py
@@ -44,8 +44,8 @@ if rootDir is None or rootDir == "":
 
 javaHomeDir = os.getenv("JAVA_HOME")
 if javaHomeDir is None or javaHomeDir == "":
-    if Path(rootDir + '/prebuilts/jdk/jdk17/linux-x86').is_dir():
-        javaHomeDir = rootDir + "/prebuilts/jdk/jdk17/linux-x86"
+    if Path(rootDir + '/prebuilts/jdk/jdk21/linux-x86').is_dir():
+        javaHomeDir = rootDir + "/prebuilts/jdk/jdk21/linux-x86"
     else:
         print("$JAVA_HOME is not set. Please use source build/envsetup.sh` in $ANDROID_BUILD_TOP")
         sys.exit(1)
diff --git a/tools/psi_monitor/psi_monitor.sh b/tools/psi_monitor/psi_monitor.sh
new file mode 100644
index 0000000000..8807ebe882
--- /dev/null
+++ b/tools/psi_monitor/psi_monitor.sh
@@ -0,0 +1,320 @@
+#! /system/bin/sh
+#
+# Monitors PSI and detects system readiness post CUJ completion.
+#
+# Setup required for the script to run:
+#   adb push psi_monitor.sh /data/local/tmp/psi_monitor.sh
+#   adb shell chmod 755 /data/local/tmp/psi_monitor.sh
+#   adb shell mkdir -p /data/local/tmp/psi_monitor
+#   adb root; adb shell setenforce 0;
+#
+# Examples:
+#   adb shell psi_monitor.sh --no_detect_baseline --out_dir=/data/local/tmp/psi_monitor
+#   adb shell psi_monitor.sh -d 120 -t 30 --exit_on_psi_stabilized
+#   adb shell psi_monitor.sh -d 120 -t 30 -b 5 -m 5
+#
+# Incoming signal:
+#   - PSI monitor waits for persist.debug.psi_monitor.cuj_completed to be true before starting
+#     the monitoring for PSI changes.
+#
+# Outgoing signals:
+#   - PSI monitor sets persist.debug.psi_monitor.threshold_met to true when the PSI exceeds the
+#     threshold and drop below the threshold again after the CUJ is completed.
+#   - PSI monitor sets persist.debug.psi_monitor.baseline_met to true when the PSI is stable
+#     (defined by MAX_PSI_BASE_POINT_DIFF) across the last N PSI entries (defined by
+#     TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE) after the CUJ is completed.
+
+readonly PSI_AVG10_POSITION=2
+PSI_AVG10_THRESHOLD=80
+# Baseline should determined only when the PSI is below 50.
+MAX_BASELINE_PSI=50
+TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE=5
+MAX_PSI_BASE_POINT_DIFF=5
+
+SHOULD_DYNAMICALLY_DETECT_BASELINE=true
+MAX_DURATION_SECONDS=120  # 2 minutes
+OUTPUT_DIR=/data/local/tmp/psi_monitor
+DID_CUJ_COMPLETE=false
+EXIT_ON_PSI_STABILIZED=false
+
+alias logcat_log=log
+alias did_cuj_complete='getprop persist.debug.psi_monitor.cuj_completed'
+alias reset_threshold_met='setprop persist.debug.psi_monitor.threshold_met false'
+alias set_threshold_met='setprop persist.debug.psi_monitor.threshold_met true'
+alias reset_baseline_met='setprop persist.debug.psi_monitor.baseline_met false'
+alias set_baseline_met='setprop persist.debug.psi_monitor.baseline_met true'
+
+set -e
+function trap_error() {
+    local return_value=$?
+    local line_no=$1
+    echo "Error at line ${line_no}: \"${BASH_COMMAND}\""
+    exit ${return_value}
+}
+trap 'trap_error $LINENO' ERR
+
+
+function uptime_millis() {
+  seconds=$(cat /proc/uptime | cut -f1 -d" ")
+  echo "(${seconds}*1000)/1" | bc
+}
+
+function err() {
+  echo -e "[$(date +'%Y-%m-%dT%H:%M:%S%z')] [$(uptime_millis)]: $*" | tee -a ${LOG_FILE} >&2
+  logcat_log -t "$0" -p e "$@"
+}
+
+function print_log() {
+  echo -e "[$(date +'%Y-%m-%dT%H:%M:%S%z')] [$(uptime_millis)]: $*" | tee -a ${LOG_FILE}
+  logcat_log -t "$0" -p i "$@"
+}
+
+function usage() {
+  echo "Monitors PSI and detects system readiness post CUJ completion."
+  echo "Usage: psi_monitor.sh [--no_detect_baseline] [--out_dir=<output_dir>] "\
+       "[--max_duration_seconds=<max_duration_seconds>] "\
+       "[--psi_avg10_threshold=<psi_avg10_threshold>] "\
+       "[--last_n_psi_entries_to_monitor_baseline=<last_n_psi_entries_to_monitor_baseline>] "\
+       "[--max_psi_base_point_diff=<max_psi_base_point_diff>] --exit_on_psi_stabilized"
+  echo "--no_detect_baseline: Instruct the monitor to not wait for the PSI to reach "\
+       "a baseline value"
+  echo "-o|--out_dir: Location to output the psi dump and logs"
+  echo "-d|--max_duration_seconds: Maximum duration to monitor for PSI changes"
+  echo "-t|--psi_avg10_threshold: PSI threshold level for peak CPU activity during post CUJ"
+  echo "-b|--total_psi_entries_to_monitor_baseline: Last N PSI entries to monitor to determine "\
+       "baseline"
+  echo "-m|--max_psi_base_point_diff: Max PSI diff between the min and max PSI values to "\
+       "determine baseline"
+  echo "--exit_on_psi_stabilized: Exit the monitor when the PSI is stabilized"
+}
+
+function parse_arguments() {
+  # Set the above threshold / duration / out_dir / dynamicall detect baseline by parsing
+  # the arguments.
+  while [[ $# > 0 ]]; do
+    key="$1"
+    case $key in
+      -h|--help)
+        usage
+        exit 1;;
+      --no_detect_baseline)
+        SHOULD_DYNAMICALLY_DETECT_BASELINE=false
+        ;;
+      -o|--out_dir)
+        OUTPUT_DIR=$2
+        shift;;
+      -d|--max_duration_seconds)
+        MAX_DURATION_SECONDS=$2
+        shift;;
+      -t|--psi_avg10_threshold)
+        PSI_AVG10_THRESHOLD=$2
+        shift;;
+      -b|--total_psi_entries_to_monitor_baseline)
+        TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE=$2
+        shift;;
+      -m|--max_psi_base_point_diff)
+        MAX_PSI_BASE_POINT_DIFF=$2
+        shift;;
+      --exit_on_psi_stabilized)
+        EXIT_ON_PSI_STABILIZED=true
+        shift;;
+      *)
+        err "Invalid option ${1}"
+        usage
+        exit 1;;
+    esac
+    shift # past argument or value
+  done
+}
+
+function check_arguments() {
+  readonly OUTPUT_DIR
+  if [[ ! -d ${OUTPUT_DIR} ]]; then
+    err "Out dir ${OUTPUT_DIR} does not exist"
+    exit 1
+  fi
+
+  readonly DUMP_FILE=${OUTPUT_DIR}/dump.txt
+  readonly LOG_FILE=${OUTPUT_DIR}/log.txt
+  rm -f ${DUMP_FILE}; touch ${DUMP_FILE}
+  rm -f ${LOG_FILE}; touch ${LOG_FILE}
+
+  if [[ ! -w ${DUMP_FILE} ]]; then
+    err "Dump file ${DUMP_FILE} is not writable"
+    exit 1
+  fi
+  if [[ ! -w ${LOG_FILE} ]]; then
+    err "Log file ${LOG_FILE} is not writable"
+    exit 1
+  fi
+
+  readonly PSI_AVG10_THRESHOLD
+  if [[ ${PSI_AVG10_THRESHOLD} != +([[:digit:]]) || ${PSI_AVG10_THRESHOLD} -le 0 \
+        || ${PSI_AVG10_THRESHOLD} -ge 100 ]]; then
+    err "PSI Avg10 threshold ${PSI_AVG10_THRESHOLD} is not a valid number. The value should be "\
+        "between 1 and 99"
+    exit 1
+  fi
+
+  if [[ ${PSI_AVG10_THRESHOLD} -lt ${MAX_BASELINE_PSI} ]]; then
+    print_log "Setting max baseline PSI to ${PSI_AVG10_THRESHOLD}, which is the PSI threshold"
+    MAX_BASELINE_PSI=${PSI_AVG10_THRESHOLD}
+  fi
+  readonly MAX_BASELINE_PSI
+
+  readonly MAX_DURATION_SECONDS
+  if [[ ${MAX_DURATION_SECONDS} != +([[:digit:]]) || ${MAX_DURATION_SECONDS} -lt 10 \
+        || ${MAX_DURATION_SECONDS} -gt 3600 ]]; then
+    err "Max duration seconds ${MAX_DURATION_SECONDS} is not a valid number. The value should be"\
+        "between 10 and 3600"
+    exit 1
+  fi
+
+  readonly TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE
+  if [[ ${TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE} != +([[:digit:]]) \
+        || ${TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE} -lt 5 \
+        || ${TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE} -gt 10 ]]; then
+    err "Last N PSI entries to monitor baseline ${TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE} is not "\
+        "a valid number. The value should be between 5 and 10"
+    exit 1
+  fi
+
+  readonly MAX_PSI_BASE_POINT_DIFF
+  if [[ ${MAX_PSI_BASE_POINT_DIFF} != +([[:digit:]]) || ${MAX_PSI_BASE_POINT_DIFF} -lt 1 \
+        || ${MAX_PSI_BASE_POINT_DIFF} -gt 10 ]]; then
+    err "Max PSI base point diff ${MAX_PSI_BASE_POINT_DIFF} is not a valid number. The value "\
+        "should be between 1 and 10"
+    exit 1
+  fi
+}
+
+latest_psi_avg_10=0
+latest_psi_line=""
+function read_psi_avg() {
+  latest_psi_line=$(grep . /proc/pressure/* | tr '\n' ' ' | sed 's|/proc/pressure/||g')
+  local cpu_some_line=$(echo ${latest_psi_line} | sed 's/\(total=[0-9]*\) /\1\n/g' | grep cpu:some)
+  latest_psi_avg_10=$(echo ${cpu_some_line} | cut -f${PSI_AVG10_POSITION} -d' ' \
+    | cut -f2 -d'=' | cut -f1 -d'.')
+  if [[ ${latest_psi_avg_10} != +([[:digit:]]) ]]; then
+    err "Error reading PSI. Read value ${latest_psi_avg_10}"
+    exit 1
+  fi
+}
+
+EXCEEDED_THRESHOLD_UPTIME_MILLIS=-1
+DROPPED_BELOW_THRESHOLD_UPTIME_MILLIS=-1
+function populate_exceeded_and_dropped_below_threshold() {
+  local psi_avg10=${1}
+  if [[ ${EXCEEDED_THRESHOLD_UPTIME_MILLIS} -lt 0 && ${psi_avg10} -ge ${PSI_AVG10_THRESHOLD} ]]
+  then
+    EXCEEDED_THRESHOLD_UPTIME_MILLIS=$(uptime_millis)
+    return
+  fi
+  if [[ ${EXCEEDED_THRESHOLD_UPTIME_MILLIS} -gt 0 && ${psi_avg10} -lt ${PSI_AVG10_THRESHOLD} ]]
+  then
+    DROPPED_BELOW_THRESHOLD_UPTIME_MILLIS=$(uptime_millis)
+  fi
+}
+
+function check_exceed_and_drop_below_threshold() {
+  if [[ ${EXCEEDED_THRESHOLD_UPTIME_MILLIS} -gt 0 \
+        && ${DROPPED_BELOW_THRESHOLD_UPTIME_MILLIS} -gt 0 ]]; then
+    return
+  fi
+  populate_exceeded_and_dropped_below_threshold ${@}
+  if [[ ${EXCEEDED_THRESHOLD_UPTIME_MILLIS} -gt 0 \
+        && ${DROPPED_BELOW_THRESHOLD_UPTIME_MILLIS} -gt 0 ]]; then
+    print_log "CPU PSI exceeded threshold ${PSI_AVG10_THRESHOLD} at" \
+        "${EXCEEDED_THRESHOLD_UPTIME_MILLIS} and dropped below at" \
+        "${DROPPED_BELOW_THRESHOLD_UPTIME_MILLIS}"
+    set_threshold_met
+    return
+  fi
+}
+
+LAST_N_PSI_AVG10_ARRAY=()
+BASELINE_UPTIME_MILLIS=-1
+NEXT_ELEMENT_TO_REMOVE=0
+function monitor_baseline_psi() {
+  if [[ ${1} -gt ${MAX_BASELINE_PSI} ||  ${SHOULD_DYNAMICALLY_DETECT_BASELINE} == false \
+        || ${BASELINE_UPTIME_MILLIS} -gt 0 ]]; then
+    return
+  fi
+  LAST_N_PSI_AVG10_ARRAY+=($1)
+  length=${#LAST_N_PSI_AVG10_ARRAY[@]}
+  if [[ ${length} -lt ${TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE} ]]; then
+    return
+  elif [[ ${length} -gt ${TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE} ]]; then
+    unset 'LAST_N_PSI_AVG10_ARRAY[NEXT_ELEMENT_TO_REMOVE]'
+    NEXT_ELEMENT_TO_REMOVE=$(expr ${NEXT_ELEMENT_TO_REMOVE} + 1)
+  fi
+  psi_min=$(echo ${LAST_N_PSI_AVG10_ARRAY[@]} | tr ' ' '\n' | sort -nr | tail -n1)
+  psi_max=$(echo ${LAST_N_PSI_AVG10_ARRAY[@]} | tr ' ' '\n' | sort -nr | head -n1)
+
+  if [[ `expr ${psi_max} - ${psi_min}` -gt ${MAX_PSI_BASE_POINT_DIFF} ]]; then
+    return
+  fi
+  BASELINE_UPTIME_MILLIS=$(uptime_millis)
+  print_log "PSI baseline is stable across ${TOTAL_PSI_ENTRIES_TO_MONITOR_BASELINE} entries. "\
+            "Min / Max / Latest PSI: [${psi_min}, ${psi_max}, ${1}]"
+  set_baseline_met
+  return
+}
+
+function main() {
+  parse_arguments "$@"
+  check_arguments
+  reset_threshold_met
+  reset_baseline_met
+
+  if [[ ${EXIT_ON_PSI_STABILIZED} == true ]]; then
+    print_log "Starting CPU PSI monitoring. Will exit when PSI is stabilized or after"\
+              "${MAX_DURATION_SECONDS} seconds"
+  else
+    print_log "Starting CPU PSI monitoring. Will exit after ${MAX_DURATION_SECONDS} seconds"
+  fi
+
+  start_uptime_millis=$(uptime_millis)
+  max_uptime_millis=`echo "${start_uptime_millis} + (${MAX_DURATION_SECONDS} * 1000)" | bc`
+  cuj_completion_uptime_millis=-1
+
+  while [[ $(uptime_millis) -lt ${max_uptime_millis} ]]; do
+    read_psi_avg
+
+    echo "$(uptime_millis) $(date '+%Y-%m-%d_%H:%M:%S') ${latest_psi_line}" >> ${DUMP_FILE}
+
+    if [[ ${cuj_completion_uptime_millis} -gt 0 || $(did_cuj_complete) == true ]]; then
+      if [[ ${cuj_completion_uptime_millis} == -1 ]]; then
+        cuj_completion_uptime_millis=$(uptime_millis)
+      fi
+      check_exceed_and_drop_below_threshold ${latest_psi_avg_10}
+      monitor_baseline_psi ${latest_psi_avg_10}
+    fi
+    if [[ ${EXCEEDED_THRESHOLD_UPTIME_MILLIS} -gt 0
+          && ${DROPPED_BELOW_THRESHOLD_UPTIME_MILLIS} -gt 0
+          && ( ${SHOULD_DYNAMICALLY_DETECT_BASELINE} == false
+              || ${BASELINE_UPTIME_MILLIS} -gt 0 )
+          && ${EXIT_ON_PSI_STABILIZED} == true ]]; then
+          break
+    fi
+    sleep 1
+  done
+
+  if [[ ${cuj_completion_uptime_millis} -le 0 ]]; then
+    print_log "CUJ did not complete"
+  else
+    print_log "CUJ completed at ${cuj_completion_uptime_millis}"
+    if [[ ${EXCEEDED_THRESHOLD_UPTIME_MILLIS} -gt 0
+          && ${DROPPED_BELOW_THRESHOLD_UPTIME_MILLIS} -gt 0 ]]; then
+      print_log "CPU PSI exceeded threshold at ${EXCEEDED_THRESHOLD_UPTIME_MILLIS} and dropped"\
+                "below threshold at ${DROPPED_BELOW_THRESHOLD_UPTIME_MILLIS}"
+    fi
+    if [[ ${SHOULD_DYNAMICALLY_DETECT_BASELINE} == true && ${BASELINE_UPTIME_MILLIS} -gt 0 ]]; then
+      print_log "CPU PSI reached baseline at ${BASELINE_UPTIME_MILLIS}"
+    elif [[ ${SHOULD_DYNAMICALLY_DETECT_BASELINE} == true ]]; then
+      print_log "CPU PSI did not reach baseline. Last N PSI values: ${LAST_N_PSI_AVG10_ARRAY[@]}"
+    fi
+  fi
+}
+
+main "$@"
diff --git a/tools/psi_monitor/run_cuj.sh b/tools/psi_monitor/run_cuj.sh
new file mode 100755
index 0000000000..f63da20fc9
--- /dev/null
+++ b/tools/psi_monitor/run_cuj.sh
@@ -0,0 +1,492 @@
+#!/bin/bash
+#
+# Runs a CUJ and collects PSI measurement.
+# Supported CUJs:
+#   - Bootup
+#   - User switch
+#   - App startup
+#   - Bootup with app launch
+#   - Resume (Work in progress)
+
+set -E
+function trap_error() {
+    local return_value=$?
+    local line_no=$1
+    echo "Error at line ${line_no}: \"${BASH_COMMAND}\""
+    exit ${return_value}
+}
+trap 'trap_error $LINENO' ERR
+
+readonly DEVICE_OUT_DIR="/data/local/tmp/psi_monitor"
+readonly DEVICE_SCRIPT="/data/local/tmp/psi_monitor.sh"
+readonly MIN_BOOTUP_DURATION_SECONDS=60
+readonly MIN_USER_SWITCH_DURATION_SECONDS=30
+readonly POST_APP_STARTUP_MONITOR_DURATION_SECONDS=30
+readonly POST_BOOT_APPS_LAUNCH_TIMES=5
+readonly MIN_BOOT_WITH_APP_LAUNCH_DURATION_SECONDS=90
+
+OUTPUT_DIR=${PWD}
+PSI_AVG10_THRESHOLD=80
+MAX_PSI_MONITOR_DURATION_SECONDS=120
+PSI_MONITOR_GRACE_DURATION_SECONDS=20
+CUJ=""
+USER_SWITCH_ARGS=""
+APP_STARTUP_PACKAGE=""
+APP_STARTUP_TIMES=1
+POST_BOOT_APP_LAUNCH_STATE="threshold_met"
+
+function err() {
+  echo -e "$@" >&2
+}
+
+function usage() {
+  echo "Runs a CUJ and collects PSI measurement."
+  echo "Usage: run_cuj.sh [-o|--out_dir=<output_dir>]"\
+       "[-d|--max_duration_seconds=<max_duration_seconds>]"\
+       "[-g|--grace_duration_seconds=<grace_duration_seconds>]"\
+       "[-b|--bootup] [-u|--user_switch=[<to_user_id> | <from_user_id>-<to_user_id>]]"\
+       "[-a|--app_startup=<app_package_name>] [--app_startup_times=<app_startup_times>]"\
+       "[-r|--resume]"\
+       "[--bootup_with_app_launch=<post_boot_app_launch_state>]"
+
+  echo "-o|--out_dir: Location to output the psi dump and logs"
+  echo "-t|--psi_avg10_threshold: PSI threshold level for peak CPU activity during post boot"
+  echo "-d|--max_duration_seconds: Maximum duration to monitor for PSI changes"
+  echo "-g|--grace_duration_seconds: Grace duration to wait before terminating the monitor"
+  echo "-b|--bootup: Run bootup CUJ"
+  echo "-u|--user_switch: Run user switch CUJ"
+  echo "-r|--resume: Run resume from suspend CUJ"
+  echo "-a|--app_startup: Run app startup CUJ"
+  echo "--app_startup_times: Number of times to launch the app during app startup CUJ"
+  echo "--bootup_with_app_launch: Run bootup with app launch CUJ. Must provide post boot app"\
+       "launch state, which is the post boot state to launch apps"
+
+  echo "Example commands:"
+  echo -e "\t1. ./run_cuj.sh -d 90 -g 20 -t 20 --bootup_with_app_launch threshold_met"
+  echo -e "\t2. ./run_cuj.sh -d 90 -g 20 -t 20 --bootup_with_app_launch baseline_met"
+  echo -e "\t3. ./run_cuj.sh -d 90 -g 20 -a com.android.contacts --app_startup_times 10"
+  echo -e "\t4. ./run_cuj.sh -d 90 -g 20 -u 10-11"
+  echo -e "\t5. ./run_cuj.sh -d 90 -g 20 -t 20 -b"
+}
+
+function check_and_set_cuj() {
+  if [[ ! -z ${CUJ} ]]; then
+    err "Multiple CUJs specified on the command line: ${CUJ} and ${1}"
+    exit 1
+  fi
+  CUJ=$1
+}
+
+function parse_arguments() {
+  while [[ $# > 0 ]]; do
+    key="$1"
+    case $key in
+    -h|--help)
+        usage
+        exit 1;;
+    -o|--out_dir)
+      OUTPUT_DIR=${2}
+      shift;;
+    -t|--psi_avg10_threshold)
+      PSI_AVG10_THRESHOLD=${2}
+      shift;;
+    -d|--max_duration_seconds)
+      MAX_PSI_MONITOR_DURATION_SECONDS=${2}
+      shift;;
+    -g|--grace_duration_seconds)
+      PSI_MONITOR_GRACE_DURATION_SECONDS=${2}
+      shift;;
+    -b|--bootup)
+      check_and_set_cuj "bootup"
+      ;;
+    -u|--user_switch)
+      check_and_set_cuj "user-switch"
+      USER_SWITCH_ARGS=${2}
+      shift;;
+    -a|--app_startup)
+      check_and_set_cuj "app-startup"
+      APP_STARTUP_PACKAGE=${2}
+      shift;;
+    --app_startup_times)
+      APP_STARTUP_TIMES=${2}
+      shift;;
+    -r|--resume)
+      check_and_set_cuj "resume"
+      ;;
+    --bootup_with_app_launch)
+      check_and_set_cuj "bootup-with-app-launch"
+      POST_BOOT_APP_LAUNCH_STATE=${2}
+      shift;;
+    *)
+      echo "${0}: Invalid option ${1}"
+      usage
+      exit 1;;
+    esac
+    shift # past argument or value
+  done
+}
+
+function check_arguments() {
+  readonly OUTPUT_DIR
+  if [[ ! -d ${OUTPUT_DIR} ]]; then
+    err "Out dir ${OUTPUT_DIR} does not exist"
+    exit 1
+  fi
+
+  readonly PSI_AVG10_THRESHOLD
+  if [[ ${PSI_AVG10_THRESHOLD} != +([[:digit:]]) || ${PSI_AVG10_THRESHOLD} -le 0 \
+        || ${PSI_AVG10_THRESHOLD} -ge 100 ]]; then
+    err "PSI Avg10 threshold ${PSI_AVG10_THRESHOLD} is not a valid number. The value should be "\
+        "between 1 and 99"
+    exit 1
+  fi
+
+  if [[ ${MAX_PSI_MONITOR_DURATION_SECONDS} != +([[:digit:]]) \
+        || ${MAX_PSI_MONITOR_DURATION_SECONDS} -lt 10 \
+        || ${MAX_PSI_MONITOR_DURATION_SECONDS} -gt 3600 ]]; then
+    err "Max psi monitor duration seconds ${MAX_PSI_MONITOR_DURATION_SECONDS} is not "\
+        "a valid number. The value should be between 10 and 3600"
+    exit 1
+  fi
+
+  readonly PSI_MONITOR_GRACE_DURATION_SECONDS
+  if [[ ${PSI_MONITOR_GRACE_DURATION_SECONDS} != +([[:digit:]]) \
+        || ${PSI_MONITOR_GRACE_DURATION_SECONDS} -lt 10 \
+        || ${PSI_MONITOR_GRACE_DURATION_SECONDS} -gt 3600 ]]; then
+    err "Psi monitor grace duration seconds ${PSI_MONITOR_GRACE_DURATION_SECONDS} is not "
+        "a valid number. The value should be between 10 and 3600"
+    exit 1
+  fi
+
+  if [[ -z ${CUJ} ]]; then
+    CUJ="bootup"
+    echo "CUJ not specified, defaulting to bootup"
+  fi
+
+  readonly CUJ
+  readonly FIRST_KILL_TIMEOUT=$(echo "${MAX_PSI_MONITOR_DURATION_SECONDS} \
+                        + ${PSI_MONITOR_GRACE_DURATION_SECONDS}" | bc)
+  readonly SECOND_KILL_TIMEOUT=$(echo "${FIRST_KILL_TIMEOUT} \
+                        + ${PSI_MONITOR_GRACE_DURATION_SECONDS}" | bc)
+}
+
+ALL_USER_IDS=()
+##
+#  Reads user ids from the device and sets the global variable ALL_USER_IDS.
+#
+# Parses the output of "adb shell pm list users", which is in the format of
+# """
+# Users:
+#       UserInfo{0:Driver:813} running
+#       UserInfo{10:Driver:412} running
+# """
+function read_all_user_ids() {
+  IFS=' ' read -r ALL_USER_IDS <<< $(adb shell pm list users | grep "{" | cut -d'{' -f2 \
+                                     | cut -d':' -f1 | tr '\n' ' ')
+}
+
+FROM_USER_ID=""
+TO_USER_ID=""
+function check_cuj_args() {
+  case ${CUJ} in
+    bootup)
+      if [[ ${MAX_PSI_MONITOR_DURATION_SECONDS} -lt ${MIN_BOOTUP_DURATION_SECONDS} ]]; then
+        MAX_PSI_MONITOR_DURATION_SECONDS=${MIN_BOOTUP_DURATION_SECONDS}
+        echo "Max psi monitor duration seconds is set to ${MAX_PSI_MONITOR_DURATION_SECONDS}"\
+             "to accommodate bootup CUJ"
+      fi
+      ;;
+    user-switch)
+      user_switch_args=()
+      IFS='-' read -r -a user_switch_args <<< "${USER_SWITCH_ARGS}"
+      if [[ ${#user_switch_args[@]} -lt 1 ||${#user_switch_args[@]} -gt 2 ]]; then
+        err "Invalid user switch args: ${USER_SWITCH_ARGS}. It should be in the format of" \
+            "<to_user_id> or <from_user_id>-<to_user_id>"
+        exit 1
+      elif [[ ${#user_switch_args[@]} -eq 2 ]]; then
+        FROM_USER_ID=${user_switch_args[0]}
+        TO_USER_ID=${user_switch_args[1]}
+      else
+        FROM_USER_ID=$(adb shell am get-current-user)
+        TO_USER_ID=${user_switch_args[0]}
+      fi
+
+      if [[ ${FROM_USER_ID} -eq 0 || ${TO_USER_ID} -eq 0 ]]; then
+        err "From user id and to user id should be non-zero or non system users"
+        exit 1
+      elif [[ ${FROM_USER_ID} -eq ${TO_USER_ID} ]]; then
+        err "From user id and to user id should be different"
+        exit 1
+      fi
+
+      read_all_user_ids
+      if [[ ! " ${ALL_USER_IDS[@]} " =~ " ${FROM_USER_ID} " ]]; then
+        err "From user id ${FROM_USER_ID} is not a valid user id."\
+            "Valid user ids are: ${ALL_USER_IDS[@]}"
+        exit 1
+      elif [[ ! " ${ALL_USER_IDS[@]} " =~ " ${TO_USER_ID} " ]]; then
+        err "To user id ${TO_USER_ID} is not a valid user id."\
+            "Valid user ids are: ${ALL_USER_IDS[@]}"
+        exit 1
+      fi
+      if [[ ${MAX_PSI_MONITOR_DURATION_SECONDS} -lt ${MIN_USER_SWITCH_DURATION_SECONDS} ]]; then
+        MAX_PSI_MONITOR_DURATION_SECONDS=${MIN_USER_SWITCH_DURATION_SECONDS}
+        echo "Max psi monitor duration seconds is set to ${MAX_PSI_MONITOR_DURATION_SECONDS}"\
+             "to accommodate user switch CUJ"
+      fi
+      ;;
+    app-startup)
+      if [[ -z ${APP_STARTUP_PACKAGE} ]]; then
+        err "App package name is not specified for app startup CUJ"
+        exit 1
+      fi
+      if [[ ${APP_STARTUP_TIMES} != +([[:digit:]]) || ${APP_STARTUP_TIMES} -le 0
+          || ${APP_STARTUP_TIMES} -gt 100 ]]; then
+        err "App startup times should be positive integer between 1 and 100"
+        exit 1
+      fi
+      min_duration=$(echo "${APP_STARTUP_TIMES}
+                      + ${POST_APP_STARTUP_MONITOR_DURATION_SECONDS}" | bc)
+      if [[ ${MAX_PSI_MONITOR_DURATION_SECONDS} -lt ${min_duration} ]]; then
+        MAX_PSI_MONITOR_DURATION_SECONDS=${min_duration}
+        echo "Max psi monitor duration seconds is set to ${MAX_PSI_MONITOR_DURATION_SECONDS}"\
+             "to accommodate app startup CUJ"
+      fi
+      ;;
+    bootup-with-app-launch)
+      if [[ ${POST_BOOT_APP_LAUNCH_STATE} != "threshold_met" && \
+            ${POST_BOOT_APP_LAUNCH_STATE} != "baseline_met" ]]; then
+        err "Post boot app launch state should be either threshold_met or baseline_met"
+        exit 1
+      fi
+      if [[ ${MAX_PSI_MONITOR_DURATION_SECONDS} -lt ${MIN_BOOT_WITH_APP_LAUNCH_DURATION_SECONDS} ]]
+      then
+        MAX_PSI_MONITOR_DURATION_SECONDS=${MIN_BOOT_WITH_APP_LAUNCH_DURATION_SECONDS}
+        echo "Max psi monitor duration seconds is set to ${MAX_PSI_MONITOR_DURATION_SECONDS}"\
+             "to accommodate bootup with app launch CUJ"
+      fi
+  esac
+}
+
+function run_psi_monitor() {
+  adb root
+  adb shell setenforce 0
+  timeout -k ${SECOND_KILL_TIMEOUT} ${FIRST_KILL_TIMEOUT} \
+    adb shell ${DEVICE_SCRIPT} --out_dir ${DEVICE_OUT_DIR} \
+      --psi_avg10_threshold ${PSI_AVG10_THRESHOLD} \
+      --max_duration_seconds ${MAX_PSI_MONITOR_DURATION_SECONDS} \
+        > ${OUTPUT_DIR}/psi_monitor_log.txt
+}
+
+function setup() {
+  adb shell rm -rf ${DEVICE_SCRIPT} ${DEVICE_OUT_DIR}
+  adb push psi_monitor.sh ${DEVICE_SCRIPT}
+  adb shell chmod 755 ${DEVICE_SCRIPT}
+  adb shell mkdir -p ${DEVICE_OUT_DIR}
+  adb shell setprop persist.debug.psi_monitor.cuj_completed false
+}
+
+FROM_USER_STOPPED_COUNT=0
+function get_from_user_stopped_count() {
+  echo $(adb logcat -d -b events | grep "ssm_user_stopped: ${FROM_USER_ID}" | wc -l)
+}
+
+# This function is called before starting the CUJ. It performs any setup required for the CUJ.
+# This function should leave the device in a state where the adb connection is active.
+function pre_start_cuj() {
+  case ${CUJ} in
+    bootup | bootup-with-app-launch)
+      echo "Rebooting adb device"; adb reboot
+      echo "Waiting for device connection"; adb wait-for-device
+      ;;
+    user-switch)
+      current_user_id=$(adb shell am get-current-user)
+      if [[ ${current_user_id} -eq ${FROM_USER_ID} ]]; then
+        return
+      else
+        echo "Switching user to from user ${FROM_USER_ID}, which is different from current user"\
+             "${current_user_id}"
+        adb shell am switch-user ${FROM_USER_ID}
+        echo "Waiting for user switch to complete by sleeping for 60 seconds"
+        sleep 60
+        # User switch events from previous switches should be ignored. So, get the number of
+        # user switch events from the previous run. Then use this to track the current user switch
+        # event.
+        FROM_USER_STOPPED_COUNT=$(get_from_user_stopped_count)
+      fi
+      ;;
+    resume)
+      err "Resume is not yet supported. Device needs an extra board to support this."\
+          "Refer to http://go/seahawk-str"; exit 1
+      adb shell cmd car_service hibernate --auto
+      echo "Waiting for device connection"; adb wait-for-device
+      ;;
+    app-startup)
+      res=$(adb shell pm list packages ${APP_STARTUP_PACKAGE})
+      if [[ -z ${res} ]]; then
+        err "App package ${APP_STARTUP_PACKAGE} is not installed on the device"
+        exit 1
+      elif [[ ! ${res} =~ ^package:${APP_STARTUP_PACKAGE}.* ]]; then
+        err "Multiple app packages with prefix ${APP_STARTUP_PACKAGE} are installed on the device"
+        exit 1
+      else
+        APP_STARTUP_PACKAGE=$(echo ${res} | cut -d':' -f2)
+      fi
+      # Reset the device to the home screen before starting the CUJ.
+      adb shell am start com.android.car.carlauncher/.CarLauncher
+      ;;
+    *)
+      ;;
+  esac
+}
+
+function start_cuj() {
+  case ${CUJ} in
+    bootup| bootup-with-app-launch)
+      # Boot doesn't need to be started by the script as it is already done by the bootloader
+      # as part of the reboot.
+      ;;
+    user-switch)
+      echo "Switching user to user ${TO_USER_ID}"
+      adb shell am switch-user ${TO_USER_ID}
+      ;;
+    resume)
+      # Device will be automatically woken up by the hibernate wakeup event. So, no action is
+      # needed.
+      ;;
+    app-startup)
+      echo "Starting app startup CUJ for ${APP_STARTUP_PACKAGE}"
+      for i in $(seq 1 ${APP_STARTUP_TIMES}); do
+        sleep 1
+        echo "Starting app startup CUJ for ${APP_STARTUP_PACKAGE} for the ${i}th time"
+        adb shell am start ${APP_STARTUP_PACKAGE}
+        if [[ ${i} -lt ${APP_STARTUP_TIMES} ]]; then
+          adb shell am force-stop --user current ${APP_STARTUP_PACKAGE}
+        fi
+      done
+      ;;
+  esac
+}
+
+function wait_for_cuj_to_complete() {
+  echo "Waiting for CUJ to complete"
+  case ${CUJ} in
+    bootup | bootup-with-app-launch)
+      while [[ $(adb shell getprop sys.boot_completed) != 1 ]]; do
+        sleep 0.5
+      done
+      # PSI monitor script will detect threshold and baseline changes only after the CUJ is
+      # completed. So, for boot-with-app-launch CUJ, mark the CUJ as completed on boot completed.
+      # This will allow the CUJ to progress forward based on the threshold_met or baseline_met
+      # conditions.
+      ;;
+    user-switch)
+      while [[ $(get_from_user_stopped_count) -eq ${FROM_USER_STOPPED_COUNT} ]]; do
+        sleep 0.1
+      done
+      ;;
+    resume)
+      # When adb is available after the device is woken up, the CUJ is considered as completed. So,
+      # no need to wait for any other event.
+      ;;
+    app-startup)
+      # App startup CUJ is considered as completed when all the apps are started. So, no need to
+      # wait for any other event.
+      ;;
+  esac
+  echo "CUJ completed, marking CUJ as completed"
+  adb shell setprop persist.debug.psi_monitor.cuj_completed true
+}
+
+function wait_for_threshold_met() {
+  echo "Waiting for threshold met"
+  while [[ $(adb shell getprop persist.debug.psi_monitor.threshold_met) != true ]]; do
+    # The PSI values are read only every 1 seconds by the PSI monitor script. So, wait for 50% of
+    # this duration to avoid waiting for too long and polling the device too often.
+    sleep 0.5
+  done
+}
+
+function wait_for_baseline_met() {
+  echo "Waiting for baseline met"
+  while [[ $(adb shell getprop persist.debug.psi_monitor.baseline_met) != true ]]; do
+    # The PSI values are read only every 1 seconds by the PSI monitor script. So, wait for 50% of
+    # this duration to avoid waiting for too long and polling the device too often.
+    sleep 0.5
+  done
+}
+
+function start_launcher_activity() {
+  echo "Starting launcher activity"
+  adb shell am start -a android.intent.action.MAIN -c android.intent.category.HOME -f 0x14000000 \
+    -n com.android.car.carlauncher/.CarLauncher
+}
+
+function start_app_grid_activity() {
+  echo "Starting GAS app grid activity"
+  adb shell am start -a com.android.car.carlauncher.ACTION_APP_GRID \
+    -c android.intent.category.HOME -f 0x24000000 \
+    -n com.android.car.carlauncher/.GASAppGridActivity
+}
+
+function start_maps_activity() {
+  echo "Starting maps activity"
+  adb shell am start -a android.intent.action.VIEW \
+    -n com.google.android.apps.maps/com.google.android.maps.MapsActivity
+}
+
+function launch_app_on_post_boot() {
+  for i in $(seq 1 ${POST_BOOT_APPS_LAUNCH_TIMES}); do
+    echo "Launching 3 apps on post boot for the ${i}th time"
+    start_launcher_activity && sleep 1
+    start_app_grid_activity && sleep 1
+    start_maps_activity && sleep 1
+  done
+}
+
+function post_cuj_events() {
+  case ${CUJ} in
+    bootup-with-app-launch)
+      if [[ ${POST_BOOT_APP_LAUNCH_STATE} == "threshold_met" ]]; then
+        wait_for_threshold_met
+      else
+        wait_for_baseline_met
+      fi
+      launch_app_on_post_boot
+      ;;
+    *)
+      ;;
+  esac
+}
+
+function main() {
+  parse_arguments "$@"
+  check_arguments
+  check_cuj_args
+  setup
+
+  pre_start_cuj
+
+  echo "Starting PSI monitoring"
+  run_psi_monitor &
+  psi_monitor_pid=$!
+
+  start_cuj
+
+  wait_for_cuj_to_complete
+
+  post_cuj_events &
+  post_cuj_events_pid=$!
+  echo "Triggered post CUJ events in the background at pid ${post_cuj_events_pid}"
+
+  echo "Waiting for PSI monitoring to complete at pid ${psi_monitor_pid}"
+  wait ${psi_monitor_pid}
+
+  # If the post CUJ events are still running, kill them because the PSI monitor has completed.
+  echo "Killing post CUJ events at pid ${post_cuj_events_pid}"
+  kill ${post_cuj_events_pid}
+
+  adb pull ${DEVICE_OUT_DIR} ${OUTPUT_DIR}
+}
+
+main "$@"
diff --git a/tools/scripts/enable_experimental_car_user.sh b/tools/scripts/enable_experimental_car_user.sh
deleted file mode 100755
index bc1f33d661..0000000000
--- a/tools/scripts/enable_experimental_car_user.sh
+++ /dev/null
@@ -1,105 +0,0 @@
-#! /bin/bash
-
-export RESTART=false
-
-if [ -z "${ANDROID_BUILD_TOP}" ]
-then
-   echo "ANDROID_BUILD_TOP not set"
-   exit 1
-fi
-
-function enable_android_feature() {
-  FEATURE=$1
-
-  echo -n "Checking if device has feature ${FEATURE}..."
-
-  if adb shell pm list features | grep "feature:${FEATURE}" > /dev/null
-  then
-    echo "yep"
-    return
-  fi
-
-  echo "not yet, let's fix that"
-
-  FROM="${ANDROID_BUILD_TOP}/frameworks/native/data/etc/${FEATURE}.xml"
-  TO="/vendor/etc/permissions/${FEATURE}.xml"
-
-  echo -n "..Checking if ${TO} exists..."
-  if adb shell ls ${TO} > /dev/null 2>&1
-  then
-    echo "it does"
-  else
-    echo "not yet"
-    echo -n "....Pushing $FROM to $TO"
-    if ! adb push $FROM $TO > /dev/null
-    then
-      echo "FAILED"
-      exit 1
-    else
-      echo "done"
-      RESTART=true
-    fi
-  fi
-
-  # Feature might have been explicitly disabled, in which case it needs to be commented out
-
-  XML_FILE=android.hardware.type.automotive.xml
-  GREP_REGEX="^ *<unavailable-feature name=.*${FEATURE}.*>\$"
-
-  for DIR in  "system" "vendor"
-  do
-    FULL_FILE=/${DIR}/etc/permissions/${XML_FILE}
-
-    echo -n "..Checking if ${FEATURE} is explicitly disabled on ${FULL_FILE}..."
-
-    if adb shell egrep "\"${GREP_REGEX}\"" ${FULL_FILE} > /dev/null
-    then
-      echo yep
-      BKP_FILE=/tmp/${XML_FILE}.$$
-
-      echo "....Creating backup file (${BKP_FILE})"
-      adb pull ${FULL_FILE} ${BKP_FILE} > /dev/null || exit 1
-      MODIFIED_FILE=/tmp/${XML_FILE}.$$.commented_out
-
-      echo "....Commenting that line out (on ${MODIFIED_FILE})"
-      # TODO: figure out how to re-use GREP_REGEX above - sed need to quote the (group) with \
-      sed "s/^ *\(<unavailable-feature name=.*${FEATURE}.*>*\)\$/<\!-- \1 -->/g" < ${BKP_FILE} > ${MODIFIED_FILE}
-
-      echo "....Replacing ${FULL_FILE}"
-      adb push ${MODIFIED_FILE} ${FULL_FILE} > /dev/null
-      RESTART=true
-    else
-      echo nope
-    fi
-  done
-}
-
-function enable_car_feature() {
-  FEATURE=$1
-
-  echo -n "Checking if car feature ${FEATURE} is enabled..."
-  if adb shell dumpsys car_service --services CarFeatureController | grep mEnabledFeatures | grep ${FEATURE} > /dev/null
-  then
-    echo yep
-    return
-  fi
-  echo nope, enabling it
-  if ! adb shell cmd car_service enable-feature ${FEATURE}
-  then
-    echo FAILED
-    exit 1
-  fi
-  RESTART=true
-}
-
-enable_android_feature android.software.device_admin
-enable_android_feature android.software.managed_users
-enable_car_feature experimental_car_user_service
-
-if ${RESTART}
-then
-  echo "Restarting system (run the command again afterwards to make sure it worked)"
-  adb shell stop && adb shell start
-else
-  echo "Good news, everyone! Everything is ready, no need to restart!"
-fi
diff --git a/tools/vehiclepropertyidsparser/verify_generated_prop_config_hook.py b/tools/vehiclepropertyidsparser/verify_generated_prop_config_hook.py
index dda74b5edd..e5a27ae3e0 100755
--- a/tools/vehiclepropertyidsparser/verify_generated_prop_config_hook.py
+++ b/tools/vehiclepropertyidsparser/verify_generated_prop_config_hook.py
@@ -37,7 +37,7 @@ VEHICLE_PROPERTY_IDS_PARSER = ('packages/services/Car/tools/'
 CAR_LIB = 'packages/services/Car/car-lib/src'
 CAR_SVC_PROPS = ('packages/services/Car/car-lib/generated-prop-config'
         '/CarSvcProps.json')
-JDK_FOLDER = '/prebuilts/jdk/jdk17/linux-x86'
+JDK_FOLDER = '/prebuilts/jdk/jdk21/linux-x86'
 
 
 def createTempFile():
```

