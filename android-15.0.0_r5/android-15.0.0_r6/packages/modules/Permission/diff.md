```diff
diff --git a/PermissionController/Android.bp b/PermissionController/Android.bp
index a8d2f846f..21d6f4774 100644
--- a/PermissionController/Android.bp
+++ b/PermissionController/Android.bp
@@ -72,6 +72,11 @@ java_library {
     ],
 }
 
+filegroup {
+    name: "PermissionController-jarjar-rules",
+    srcs: ["jarjar-rules.txt"],
+}
+
 android_library {
     name: "PermissionController-lib",
     sdk_version: "system_current",
@@ -112,7 +117,6 @@ android_library {
         "androidx.legacy_legacy-preference-v14",
         "androidx.leanback_leanback",
         "androidx.leanback_leanback-preference",
-        "androidx.lifecycle_lifecycle-extensions",
         "androidx.lifecycle_lifecycle-common-java8",
         "kotlin-stdlib",
         "kotlinx-coroutines-android",
@@ -169,7 +173,7 @@ android_library {
     ],
 
     // TODO(b/313706381): Remove jarjar once flagging lib is fixed
-    jarjar_rules: "jarjar-rules.txt",
+    jarjar_rules: ":PermissionController-jarjar-rules",
 }
 
 android_app {
diff --git a/PermissionController/AndroidManifest.xml b/PermissionController/AndroidManifest.xml
index c0d6c2907..9eeef93a2 100644
--- a/PermissionController/AndroidManifest.xml
+++ b/PermissionController/AndroidManifest.xml
@@ -65,10 +65,10 @@
     <uses-permission android:name="android.permission.START_TASKS_FROM_RECENTS" />
     <uses-permission android:name="android.permission.READ_APP_SPECIFIC_LOCALES" />
     <uses-permission android:name="android.permission.GET_APP_METADATA" />
-    <uses-permission android:name="android.permission.NFC_PREFERRED_PAYMENT_INFO" />
     <uses-permission android:name="android.permission.MANAGE_ENHANCED_CONFIRMATION_STATES" />
     <uses-permission android:name="android.permission.READ_SYSTEM_GRAMMATICAL_GENDER" />
     <uses-permission android:name="android.permission.MANAGE_CLIPBOARD_ACCESS_NOTIFICATION" />
+    <uses-permission android:name="android.permission.WATCH_APPOPS" />
 
     <application android:name="com.android.permissioncontroller.PermissionControllerApplication"
             android:label="@string/app_name"
diff --git a/PermissionController/OWNERS b/PermissionController/OWNERS
index 3ed65e519..3872198cb 100644
--- a/PermissionController/OWNERS
+++ b/PermissionController/OWNERS
@@ -4,8 +4,10 @@ include platform/frameworks/base:/core/java/android/permission/OWNERS
 stenning@google.com
 
 # For television related changes
-aabdagic@google.com
-robhor@google.com
+per-file TELEVISION_OWNERS = file:/PermissionController/TELEVISION_OWNERS
+per-file src/com/android/permissioncontroller/permission/ui/television/** = file:/PermissionController/TELEVISION_OWNERS
+per-file res/*-television/* = file:/PermissionController/TELEVISION_OWNERS
+per-file tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/television/** = file:/PermissionController/TELEVISION_OWNERS
 
 # For incident report related changes
 joeo@google.com
diff --git a/PermissionController/TELEVISION_OWNERS b/PermissionController/TELEVISION_OWNERS
new file mode 100644
index 000000000..af786d751
--- /dev/null
+++ b/PermissionController/TELEVISION_OWNERS
@@ -0,0 +1,2 @@
+bronger@google.com
+timurc@google.com
\ No newline at end of file
diff --git a/PermissionController/jarjar-rules.txt b/PermissionController/jarjar-rules.txt
index 5e70dfbbd..7bfda1ab1 100644
--- a/PermissionController/jarjar-rules.txt
+++ b/PermissionController/jarjar-rules.txt
@@ -1,3 +1,15 @@
+# You may bypass this Gerrit IfThisThenThat Lint if your change doesn't affect
+# RoleParser.applyJarjarTransform(), by adding NO_IFTTT=reason to your commit
+# message.
+# LINT.IfChange
+rule android.app.appfunctions.flags.*FeatureFlags* com.android.permissioncontroller.jarjar.@0
+rule android.app.appfunctions.flags.FeatureFlags* com.android.permissioncontroller.jarjar.@0
+rule android.app.appfunctions.flags.FeatureFlags com.android.permissioncontroller.jarjar.@0
+rule android.app.appfunctions.flags.Flags com.android.permissioncontroller.jarjar.@0
+rule android.companion.virtualdevice.flags.*FeatureFlags* com.android.permissioncontroller.jarjar.@0
+rule android.companion.virtualdevice.flags.FeatureFlags* com.android.permissioncontroller.jarjar.@0
+rule android.companion.virtualdevice.flags.FeatureFlags com.android.permissioncontroller.jarjar.@0
+rule android.companion.virtualdevice.flags.Flags com.android.permissioncontroller.jarjar.@0
 rule android.content.pm.*FeatureFlags* com.android.permissioncontroller.jarjar.@0
 rule android.content.pm.FeatureFlags* com.android.permissioncontroller.jarjar.@0
 rule android.content.pm.FeatureFlags com.android.permissioncontroller.jarjar.@0
@@ -10,3 +22,4 @@ rule android.os.*FeatureFlags* com.android.permissioncontroller.jarjar.@0
 rule android.os.FeatureFlags* com.android.permissioncontroller.jarjar.@0
 rule android.os.FeatureFlags com.android.permissioncontroller.jarjar.@0
 rule android.os.Flags com.android.permissioncontroller.jarjar.@0
+# LINT.ThenChange(PermissionController/role-controller/java/com/android/role/controller/model/RoleParser.java:applyJarjarTransform)
diff --git a/PermissionController/proguard.flags b/PermissionController/proguard.flags
index 292e3e4f4..52011e70c 100644
--- a/PermissionController/proguard.flags
+++ b/PermissionController/proguard.flags
@@ -32,6 +32,11 @@
   *** has*();
 }
 
+# Keep Flags classes because they may be referenced by reflection in roles.xml
+-keep class **.Flags {
+    *;
+}
+
 # Strip verbose logs.
 -assumenosideeffects class android.util.Log {
   static *** v(...);
diff --git a/PermissionController/res/drawable-v31/auto_grant_permissions_buttons.xml b/PermissionController/res/drawable-v31/auto_grant_permissions_buttons.xml
new file mode 100644
index 000000000..2b82388fb
--- /dev/null
+++ b/PermissionController/res/drawable-v31/auto_grant_permissions_buttons.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="UTF-8"?><!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <corners
+        android:bottomLeftRadius="@dimen/car_location_permission_prompt_radius"
+        android:bottomRightRadius="@dimen/car_location_permission_prompt_radius"
+        android:topLeftRadius="@dimen/car_location_permission_prompt_radius"
+        android:topRightRadius="@dimen/car_location_permission_prompt_radius" />
+    <solid android:color="@android:color/system_accent2_200" />
+</shape>
diff --git a/PermissionController/res/drawable-v31/auto_grant_permissions_dialog.xml b/PermissionController/res/drawable-v31/auto_grant_permissions_dialog.xml
new file mode 100644
index 000000000..bd96d07f0
--- /dev/null
+++ b/PermissionController/res/drawable-v31/auto_grant_permissions_dialog.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0" encoding="UTF-8"?><!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <corners
+        android:bottomLeftRadius="@dimen/car_location_permission_prompt_radius"
+        android:bottomRightRadius="@dimen/car_location_permission_prompt_radius"
+        android:topLeftRadius="@dimen/car_location_permission_prompt_radius"
+        android:topRightRadius="@dimen/car_location_permission_prompt_radius" />
+    <solid android:color="@android:color/system_neutral1_800" />
+</shape>
diff --git a/PermissionController/res/drawable/ic_android_security_privacy.xml b/PermissionController/res/drawable/ic_android_security_privacy.xml
new file mode 100644
index 000000000..e2cad5a99
--- /dev/null
+++ b/PermissionController/res/drawable/ic_android_security_privacy.xml
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="utf-8"?>
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="24dp"
+    android:height="24dp"
+    android:viewportWidth="960"
+    android:viewportHeight="960"
+    android:tint="?attr/colorControlNormal">
+  <path
+      android:fillColor="@android:color/white"
+      android:pathData="M480,797Q522,774 554.5,738Q587,702 587,651Q587,587 535,547Q483,507 428,472Q379,440 350,390Q321,340 321,282Q321,265 323,248.5Q325,232 330,215L240,247Q240,247 240,247Q240,247 240,247L240,412Q240,546 299.5,639Q359,732 480,797ZM666,629Q693,583 706.5,529Q720,475 720,412L720,247Q720,247 720,247Q720,247 720,247L480,161Q442,175 421.5,208.5Q401,242 401,282Q401,325 426.5,359.5Q452,394 489,416Q552,454 605.5,504Q659,554 666,629Q666,629 666,629Q666,629 666,629ZM480,880Q473,880 466.5,878.5Q460,877 454,874Q306,798 233,685.5Q160,573 160,412L160,248Q160,222 174.5,201Q189,180 213,172L453,86Q460,84 466.5,82Q473,80 480,80Q489,80 507,86L747,172Q771,180 785.5,200.5Q800,221 800,247L800,412Q800,573 725.5,686Q651,799 505,874Q499,877 493,878.5Q487,880 480,880Z"/>
+</vector>
diff --git a/PermissionController/res/drawable/ic_error.xml b/PermissionController/res/drawable/ic_error.xml
new file mode 100644
index 000000000..8355c11ca
--- /dev/null
+++ b/PermissionController/res/drawable/ic_error.xml
@@ -0,0 +1,10 @@
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="24dp"
+    android:height="24dp"
+    android:viewportWidth="960"
+    android:viewportHeight="960"
+    android:tint="?attr/colorControlNormal">
+  <path
+      android:fillColor="@android:color/white"
+      android:pathData="M480,680Q497,680 508.5,668.5Q520,657 520,640Q520,623 508.5,611.5Q497,600 480,600Q463,600 451.5,611.5Q440,623 440,640Q440,657 451.5,668.5Q463,680 480,680ZM440,520L520,520L520,280L440,280L440,520ZM480,880Q397,880 324,848.5Q251,817 197,763Q143,709 111.5,636Q80,563 80,480Q80,397 111.5,324Q143,251 197,197Q251,143 324,111.5Q397,80 480,80Q563,80 636,111.5Q709,143 763,197Q817,251 848.5,324Q880,397 880,480Q880,563 848.5,636Q817,709 763,763Q709,817 636,848.5Q563,880 480,880ZM480,800Q614,800 707,707Q800,614 800,480Q800,346 707,253Q614,160 480,160Q346,160 253,253Q160,346 160,480Q160,614 253,707Q346,800 480,800ZM480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Z"/>
+</vector>
diff --git a/PermissionController/res/drawable/ic_nfc.xml b/PermissionController/res/drawable/ic_nfc.xml
new file mode 100644
index 000000000..5c7cdadb4
--- /dev/null
+++ b/PermissionController/res/drawable/ic_nfc.xml
@@ -0,0 +1,30 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="24dp"
+    android:height="24dp"
+    android:viewportHeight="24"
+    android:viewportWidth="24"
+    android:tint="?android:attr/colorControlNormal">
+
+    <path
+       android:fillColor="@android:color/white"
+       android:pathData="M20,2L4,2c-1.1,0 -2,0.9 -2,2v16c0,1.1 0.9,2 2,2h16c1.1,0 2,-0.9 2,-2L22,4c0,-1.1 -0.9,-2 -2,-2zM20,20L4,20L4,4h16v16zM18,6h-5c-1.1,0 -2,0.9 -2,2v2.28c-0.6,0.35 -1,0.98 -1,1.72 0,1.1 0.9,2 2,2s2,-0.9 2,-2c0,-0.74 -0.4,-1.38 -1,-1.72L13,8h3v8L8,16L8,8h2L10,6L6,6v12h12L18,6z" />
+</vector>
diff --git a/PermissionController/res/drawable/ic_security_update_good.xml b/PermissionController/res/drawable/ic_security_update_good.xml
new file mode 100644
index 000000000..59e7a67fa
--- /dev/null
+++ b/PermissionController/res/drawable/ic_security_update_good.xml
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="utf-8"?>
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="24dp"
+    android:height="24dp"
+    android:viewportWidth="960"
+    android:viewportHeight="960"
+    android:tint="?attr/colorControlNormal">
+  <path
+      android:fillColor="@android:color/white"
+      android:pathData="M442,600L330,488L386,432L442,488L584,346L640,402L442,600ZM280,920Q247,920 223.5,896.5Q200,873 200,840L200,120Q200,87 223.5,63.5Q247,40 280,40L680,40Q713,40 736.5,63.5Q760,87 760,120L760,840Q760,873 736.5,896.5Q713,920 680,920L280,920ZM280,800L280,840Q280,840 280,840Q280,840 280,840L680,840Q680,840 680,840Q680,840 680,840L680,800L280,800ZM280,720L680,720L680,240L280,240L280,720ZM280,160L680,160L680,120Q680,120 680,120Q680,120 680,120L280,120Q280,120 280,120Q280,120 280,120L280,160ZM280,160L280,120Q280,120 280,120Q280,120 280,120L280,120Q280,120 280,120Q280,120 280,120L280,160L280,160ZM280,800L280,800L280,840Q280,840 280,840Q280,840 280,840L280,840Q280,840 280,840Q280,840 280,840L280,800Z"/>
+</vector>
diff --git a/PermissionController/res/drawable/ic_shield_exclamation_outline_24dp.xml b/PermissionController/res/drawable/ic_shield_exclamation_outline_24dp.xml
new file mode 100644
index 000000000..6bbf7a174
--- /dev/null
+++ b/PermissionController/res/drawable/ic_shield_exclamation_outline_24dp.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="24dp"
+    android:height="24dp"
+    android:viewportWidth="48"
+    android:viewportHeight="48"
+    android:tint="?attr/colorControlNormal">
+    <path
+        android:fillColor="@android:color/white"
+        android:pathData="M24,31.3Q24.7,31.3 25.2,30.8Q25.7,30.3 25.7,29.6Q25.7,28.9 25.2,28.4Q24.7,27.9 24,27.9Q23.3,27.9 22.8,28.4Q22.3,28.9 22.3,29.6Q22.3,30.3 22.8,30.8Q23.3,31.3 24,31.3ZM22.5,24.6H25.5V14.25H22.5ZM24,43.95Q17,42.2 12.5,35.825Q8,29.45 8,21.85V9.95L24,3.95L40,9.95V21.85Q40,29.45 35.5,35.825Q31,42.2 24,43.95ZM24,40.85Q29.75,38.95 33.375,33.675Q37,28.4 37,21.85V12.05L24,7.15L11,12.05V21.85Q11,28.4 14.625,33.675Q18.25,38.95 24,40.85ZM24,24Q24,24 24,24Q24,24 24,24Q24,24 24,24Q24,24 24,24Z" />
+</vector>
diff --git a/PermissionController/res/layout-television/preference_permissions_revoke.xml b/PermissionController/res/layout-television/preference_permissions_revoke.xml
index 439768fdf..91740d261 100644
--- a/PermissionController/res/layout-television/preference_permissions_revoke.xml
+++ b/PermissionController/res/layout-television/preference_permissions_revoke.xml
@@ -41,8 +41,8 @@
             android:visibility="gone">
             <ImageView
                 android:id="@android:id/icon"
-                android:layout_width="@dimen/permission_icon_size"
-                android:layout_height="@dimen/permission_icon_size"/>
+                android:layout_width="@dimen/tv_permission_icon_size"
+                android:layout_height="@dimen/tv_permission_icon_size"/>
         </LinearLayout>
 
         <TextView
diff --git a/PermissionController/res/layout/app_permission.xml b/PermissionController/res/layout/app_permission.xml
index 67ac627fc..07a9f2987 100644
--- a/PermissionController/res/layout/app_permission.xml
+++ b/PermissionController/res/layout/app_permission.xml
@@ -114,6 +114,7 @@
 
                     <RadioButton
                         android:id="@+id/select_radio_button"
+                        android:layout_toStartOf="@id/edit_photos_divider"
                         android:text="@string/app_permission_button_allow_limited_access"
                         android:layout_alignParentStart="true"
                         style="@style/AppPermissionRadioButton"
diff --git a/PermissionController/res/layout/auto_grant_permissions_material3.xml b/PermissionController/res/layout/auto_grant_permissions_material3.xml
new file mode 100644
index 000000000..d04a92865
--- /dev/null
+++ b/PermissionController/res/layout/auto_grant_permissions_material3.xml
@@ -0,0 +1,168 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<!--
+  ~ A lot of content in this file is identical to grant_permissions.xml
+  ~ Be sure to update both files when making changes.
+  -->
+
+<!-- In (hopefully very rare) case dialog is too high: allow scrolling -->
+<!-- The following layout file is a fork of the phone layout version, customized for auto -->
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    style="@style/AutoPermissionGrantScrollView"
+    android:layout_width="wrap_content"
+    android:layout_height="match_parent">
+
+    <LinearLayout
+        android:id="@+id/grant_singleton"
+        style="@style/AutoPermissionGrantSingleton"
+        android:focusable="false"
+        android:importantForAccessibility="no">
+
+        <!-- The dialog -->
+        <LinearLayout
+            android:id="@+id/grant_dialog"
+            style="@style/AutoPermissionGrantDialogMaterial3"
+            android:focusable="false"
+            android:importantForAccessibility="no"
+            android:theme="@style/Theme.PermissionGrantDialog">
+
+            <LinearLayout
+                android:id="@+id/content_container"
+                style="@style/AutoPermissionGrantContent">
+
+                <LinearLayout style="@style/AutoPermissionGrantDescription">
+
+                    <TextView
+                        android:id="@+id/permission_message"
+                        style="@style/AutoPermissionGrantTitleMessage"
+                        android:accessibilityHeading="true" />
+
+                </LinearLayout>
+
+                <TextView
+                    android:id="@+id/detail_message"
+                    style="@style/AutoPermissionGrantDetailMessage" />
+
+            </LinearLayout>
+
+            <!-- location (precise/approximate) animations -->
+            <LinearLayout
+                android:id="@+id/permission_location_accuracy"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content">
+
+                <ImageView
+                    android:id="@+id/permission_location_accuracy_fine_only"
+                    style="@style/AutoPermissionLocationAccuracyImageViewMaterial13"
+                    android:contentDescription="@string/precise_image_description" />
+
+                <ImageView
+                    android:id="@+id/permission_location_accuracy_coarse_only"
+                    style="@style/AutoPermissionLocationAccuracyImageViewMaterial13"
+                    android:contentDescription="@string/approximate_image_description" />
+
+                <RadioGroup
+                    android:id="@+id/permission_location_accuracy_radio_group"
+                    style="@style/AutoPermissionLocationAccuracyRadioGroupMaterial3">
+
+                    <RadioButton
+                        android:id="@+id/permission_location_accuracy_radio_fine"
+                        style="@style/AutoPermissionLocationAccuracyRadioFine"
+                        android:text="@string/permgrouprequest_finelocation_imagetext" />
+
+                    <RadioButton
+                        android:id="@+id/permission_location_accuracy_radio_coarse"
+                        style="@style/AutoPermissionLocationAccuracyRadioCoarse"
+                        android:text="@string/permgrouprequest_coarselocation_imagetext" />
+                </RadioGroup>
+
+            </LinearLayout>
+
+            <!-- Buttons on bottom of dialog -->
+            <LinearLayout style="@style/AutoPermissionGrantButtonListMaterial3">
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_dont_allow_more_selected_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_dont_select_more" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_no_upgrade_one_time_and_dont_ask_again_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_no_upgrade_one_time" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_no_upgrade_one_time_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_no_upgrade_one_time" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_no_upgrade_and_dont_ask_again_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_no_upgrade" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_no_upgrade_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_no_upgrade" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_deny_and_dont_ask_again_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_deny" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_deny_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_deny" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_allow_selected_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_allow_limited_access" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_allow_one_time_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_allow_one_time" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_allow_foreground_only_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_allow_foreground" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_allow_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_allow" />
+
+                <com.android.permissioncontroller.permission.ui.widget.SecureButton
+                    android:id="@+id/permission_allow_all_button"
+                    style="@style/AutoPermissionGrantButton"
+                    android:text="@string/grant_dialog_button_allow_all" />
+
+            </LinearLayout>
+
+            <com.android.permissioncontroller.permission.ui.v33.widget.SafetyProtectionSectionView
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_gravity="center"
+                android:layout_marginBottom="20dp"
+                android:layout_marginTop="0dp" />
+        </LinearLayout>
+    </LinearLayout>
+</ScrollView>
diff --git a/PermissionController/res/layout/car_switch_button_preference.xml b/PermissionController/res/layout/car_switch_button_preference.xml
new file mode 100644
index 000000000..a2c2dcd8f
--- /dev/null
+++ b/PermissionController/res/layout/car_switch_button_preference.xml
@@ -0,0 +1,68 @@
+<?xml version="1.0" encoding="utf-8"?><!--
+  ~ Copyright (C) 2019 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License
+  -->
+
+<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:gravity="center_vertical"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall">
+
+    <FrameLayout
+        android:id="@android:id/widget_frame"
+        android:layout_width="wrap_content"
+        android:layout_height="match_parent"
+        android:minWidth="?android:attr/listPreferredItemHeightSmall"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintTop_toTopOf="parent" />
+
+    <TextView
+        android:id="@android:id/title"
+        style="@style/AppPermissionLocationAccuracyTitle"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:ellipsize="end"
+        android:paddingBottom="@dimen/car_preference_row_vertical_margin"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        android:paddingTop="@dimen/car_preference_row_vertical_margin"
+        android:singleLine="true"
+        android:text="@string/app_permission_location_accuracy"
+        android:textAppearance="?android:attr/textAppearanceLarge"
+        app:layout_constraintEnd_toStartOf="@android:id/widget_frame"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintWidth_default="spread" />
+
+    <TextView
+        android:id="@android:id/summary"
+        style="@style/AppPermissionLocationAccuracySubtitle"
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:paddingBottom="@dimen/car_preference_row_vertical_margin"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+        android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+        android:text="@string/app_permission_location_accuracy_subtitle"
+        android:textAppearance="?android:attr/textAppearanceSmall"
+        app:layout_constraintEnd_toStartOf="@android:id/widget_frame"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toBottomOf="@android:id/title"
+        app:layout_constraintWidth_default="spread" />
+
+</androidx.constraintlayout.widget.ConstraintLayout>
\ No newline at end of file
diff --git a/PermissionController/res/layout/permission_footer_preference.xml b/PermissionController/res/layout/permission_footer_preference.xml
new file mode 100644
index 000000000..52c1f76e1
--- /dev/null
+++ b/PermissionController/res/layout/permission_footer_preference.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  Copyright (C) 2024 The Android Open Source Project
+
+  Licensed under the Apache License, Version 2.0 (the "License");
+  you may not use this file except in compliance with the License.
+  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+  -->
+
+<!-- A direct copy of the SettingsLib FooterPreference/res/layout-v33/preference_footer.xml
+  ~  with overlayable styles
+  -->
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    style="@style/PermissionFooterPreferenceRootLayoutStyle">
+
+    <LinearLayout
+        android:id="@+id/icon_frame"
+        style="@style/PermissionFooterPreferenceIconFrameStyle">
+        <ImageView
+            android:id="@android:id/icon"
+            style="@style/PermissionFooterPreferenceIconStyle"/>
+    </LinearLayout>
+
+    <LinearLayout
+        style="@style/PermissionFooterPreferenceLearnMoreTextLayoutStyle">
+        <TextView
+            android:id="@android:id/title"
+            style="@style/PermissionFooterPreferenceTitleTextStyle"/>
+
+        <com.android.settingslib.widget.LinkTextView
+            android:id="@+id/settingslib_learn_more"
+            android:text="@string/settingslib_learn_more_text"
+            style="@style/PermissionFooterPreferenceLearnMoreTextStyle"/>
+    </LinearLayout>
+
+</LinearLayout>
\ No newline at end of file
diff --git a/PermissionController/res/layout/permission_preference.xml b/PermissionController/res/layout/permission_preference.xml
new file mode 100644
index 000000000..314752140
--- /dev/null
+++ b/PermissionController/res/layout/permission_preference.xml
@@ -0,0 +1,54 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<!-- A direct copy of the SettingsLib SettingsTheme/res/layout-v33/settingslib_preference.xml,
+  ~  SettingsLib/SettingsTheme/res/layout-v31/settingslib_icon_frame.xml
+  ~  with overlayable styles
+  -->
+<com.android.permissioncontroller.permission.ui.handheld.v35.DrawableStateLinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    style="@style/PermissionPreferenceRootLayoutStyle">
+
+    <LinearLayout
+        android:id="@+id/icon_frame"
+        style="@style/PermissionPreferenceIconFrameStyle">
+
+        <androidx.preference.internal.PreferenceImageView
+            android:id="@android:id/icon"
+            style="@style/PermissionPreferenceIconStyle"/>
+
+    </LinearLayout>
+
+    <RelativeLayout
+        style="@style/PermissionPreferenceTextRelativeLayoutStyle">
+
+        <TextView
+            android:id="@android:id/title"
+            style="@style/PermissionPreferenceTitleTextStyle"/>
+
+        <TextView
+            android:id="@android:id/summary"
+            style="@style/PermissionPreferenceSummaryTextStyle"/>
+
+    </RelativeLayout>
+
+    <!-- Preference should place its actual preference widget here. -->
+    <LinearLayout
+        android:id="@android:id/widget_frame"
+        style="@style/PermissionPreferenceWidgetFrameLayoutStyle"/>
+
+</com.android.permissioncontroller.permission.ui.handheld.v35.DrawableStateLinearLayout>
diff --git a/PermissionController/res/layout/permission_preference_category.xml b/PermissionController/res/layout/permission_preference_category.xml
new file mode 100644
index 000000000..5e80f90a5
--- /dev/null
+++ b/PermissionController/res/layout/permission_preference_category.xml
@@ -0,0 +1,37 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<!-- A direct copy of the AndroidX preference/preference/res/layout/preference_category_material.xml
+  ~  with overlayable styles
+  -->
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    style="@style/PermissionPreferenceCategoryRootLayoutStyle">
+
+    <RelativeLayout
+        style="@style/PermissionPreferenceCategoryTextRelativeLayoutStyle">
+
+        <TextView
+            android:id="@android:id/title"
+            style="@style/PermissionPreferenceCategoryTitleTextStyle"/>
+
+        <TextView
+            android:id="@android:id/summary"
+            style="@style/PermissionPreferenceCategorySummaryTextStyle"/>
+
+    </RelativeLayout>
+</LinearLayout>
\ No newline at end of file
diff --git a/PermissionController/res/layout/preference_permissions_switch.xml b/PermissionController/res/layout/preference_permissions_switch_television.xml
similarity index 96%
rename from PermissionController/res/layout/preference_permissions_switch.xml
rename to PermissionController/res/layout/preference_permissions_switch_television.xml
index 85ded739d..7168b7a0a 100644
--- a/PermissionController/res/layout/preference_permissions_switch.xml
+++ b/PermissionController/res/layout/preference_permissions_switch_television.xml
@@ -39,8 +39,8 @@
         android:paddingBottom="4dp">
         <androidx.preference.internal.PreferenceImageView
             android:id="@android:id/icon"
-            android:layout_width="@dimen/permission_icon_size"
-            android:layout_height="@dimen/permission_icon_size"
+            android:layout_width="@dimen/tv_permission_icon_size"
+            android:layout_height="@dimen/tv_permission_icon_size"
             android:scaleType="fitCenter" />
     </LinearLayout>
 
diff --git a/PermissionController/res/layout/preference_permissions.xml b/PermissionController/res/layout/preference_permissions_television.xml
similarity index 96%
rename from PermissionController/res/layout/preference_permissions.xml
rename to PermissionController/res/layout/preference_permissions_television.xml
index b40a0e8fe..53a8431c6 100644
--- a/PermissionController/res/layout/preference_permissions.xml
+++ b/PermissionController/res/layout/preference_permissions_television.xml
@@ -39,8 +39,8 @@
         android:paddingBottom="4dp">
         <androidx.preference.internal.PreferenceImageView
             android:id="@android:id/icon"
-            android:layout_width="@dimen/permission_icon_size"
-            android:layout_height="@dimen/permission_icon_size"
+            android:layout_width="@dimen/tv_permission_icon_size"
+            android:layout_height="@dimen/tv_permission_icon_size"
             android:scaleType="fitCenter" />
     </LinearLayout>
 
diff --git a/PermissionController/res/layout/radio_button_preference_widget.xml b/PermissionController/res/layout/radio_button_preference_widget.xml
index cd2a2ce42..9bff4e46e 100644
--- a/PermissionController/res/layout/radio_button_preference_widget.xml
+++ b/PermissionController/res/layout/radio_button_preference_widget.xml
@@ -19,7 +19,7 @@
 <FrameLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="wrap_content"
-    android:minWidth="56dp"
+    android:minWidth="@dimen/toggle_preference_container_min_width"
     android:layout_height="match_parent">
 
     <RadioButton
diff --git a/PermissionController/res/layout/switch_button_preference_widget.xml b/PermissionController/res/layout/switch_button_preference_widget.xml
new file mode 100644
index 000000000..f5a2d595b
--- /dev/null
+++ b/PermissionController/res/layout/switch_button_preference_widget.xml
@@ -0,0 +1,30 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<!--
+  ~ Copyright (C) 2018 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<FrameLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="wrap_content"
+    android:minWidth="@dimen/toggle_preference_container_min_width"
+    android:layout_height="match_parent">
+
+    <Switch
+        android:id="@+id/location_accuracy_switch"
+        android:checked="false"
+        android:duplicateParentState="true"
+        style="@style/AppPermissionLocationAccuracySwitch" />
+</FrameLayout>
diff --git a/PermissionController/res/layout/footer_preference.xml b/PermissionController/res/layout/unused_apps_footer_preference.xml
similarity index 100%
rename from PermissionController/res/layout/footer_preference.xml
rename to PermissionController/res/layout/unused_apps_footer_preference.xml
diff --git a/PermissionController/res/values-af-television/strings.xml b/PermissionController/res/values-af-television/strings.xml
index 26a8bec01..fe101523c 100644
--- a/PermissionController/res/values-af-television/strings.xml
+++ b/PermissionController/res/values-af-television/strings.xml
@@ -20,8 +20,8 @@
     <string name="grant_dialog_how_to_change" msgid="997462845048160559">"Jy kan dit later verander in Instellings &gt; Programme"</string>
     <string name="current_permission_template" msgid="6240787325714651204">"<xliff:g id="CURRENT_PERMISSION_INDEX">%1$s</xliff:g> / <xliff:g id="PERMISSION_COUNT">%2$s</xliff:g>"</string>
     <string name="preference_show_system_apps" msgid="4262140518693221093">"Wys stelselprogramme"</string>
-    <string name="app_permissions_decor_title" msgid="7438716722786036814">"Programtoestemmings"</string>
-    <string name="manage_permissions_decor_title" msgid="4138423885439613577">"Programtoestemmings"</string>
+    <string name="app_permissions_decor_title" msgid="7438716722786036814">"Apptoestemmings"</string>
+    <string name="manage_permissions_decor_title" msgid="4138423885439613577">"Apptoestemmings"</string>
     <string name="permission_apps_decor_title" msgid="2811550489429789828">"<xliff:g id="PERMISSION">%1$s</xliff:g>-toestemmings"</string>
     <string name="additional_permissions_decor_title" msgid="5113847982502484225">"Bykomende toestemmings"</string>
     <string name="system_apps_decor_title" msgid="4402004958937474803">"<xliff:g id="PERMISSION">%1$s</xliff:g>-toestemmings"</string>
diff --git a/PermissionController/res/values-af-v35/strings.xml b/PermissionController/res/values-af-v35/strings.xml
new file mode 100644
index 000000000..ae1626d6d
--- /dev/null
+++ b/PermissionController/res/values-af-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sekuriteit"</string>
+</resources>
diff --git a/PermissionController/res/values-af/strings.xml b/PermissionController/res/values-af/strings.xml
index 4101b8d5d..356afd953 100644
--- a/PermissionController/res/values-af/strings.xml
+++ b/PermissionController/res/values-af/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"toestemmings"</string>
     <string name="cancel" msgid="8943320028373963831">"Kanselleer"</string>
     <string name="back" msgid="6249950659061523680">"Terug"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Maak toe"</string>
     <string name="available" msgid="6007778121920339498">"Beskikbaar"</string>
     <string name="blocked" msgid="9195547604866033708">"Geblokkeer"</string>
     <string name="on" msgid="280241003226755921">"Aan"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Geen"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Stelselverstek)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Geen apps nie"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Ander NFC-dienste"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Gekies"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Gekies – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"spesiale apptoegang"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Gister ingegaan <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Ingegaan <xliff:g id="TIME_DATE_0">%1$s</xliff:g><xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Jou eenmalige wagwoord is 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Laat beperkte instellings toe"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Beperkte instelling"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Hierdie instelling is vir jou veiligheid tans onbeskikbaar."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Toegang tot <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> is geweier vir die app"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Toestemmingsversoek is onderdruk"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Hierdie app versoek bykomende toestemmings, maar toestemmings kan nie in ’n stromingsessie verleen word nie. Verleen eers die toestemming op jou foon."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Vir noodoproep of -teksboodskap"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Ligging is na nooddienste toe gestuur"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Hierdie app het toegang tot jou toestel se ligging gekry tydens ’n oproep of teksboodskap na ’n noodnommer. Dit kan gebeur selfs al het die app nie liggingtoestemming nie of al is die toestelligging af. "<a href="https://support.google.com/android/answer/9319337">"Meer inligting"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Kyk op jou foon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Kon nie jou foon bereik nie"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Herprobeer?"</string>
 </resources>
diff --git a/PermissionController/res/values-am-v35/strings.xml b/PermissionController/res/values-am-v35/strings.xml
new file mode 100644
index 000000000..3d2bdc7e9
--- /dev/null
+++ b/PermissionController/res/values-am-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"ደህንነት"</string>
+</resources>
diff --git a/PermissionController/res/values-am/strings.xml b/PermissionController/res/values-am/strings.xml
index 6602a268d..f49db7957 100644
--- a/PermissionController/res/values-am/strings.xml
+++ b/PermissionController/res/values-am/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ፈቃዶች"</string>
     <string name="cancel" msgid="8943320028373963831">"ይቅር"</string>
     <string name="back" msgid="6249950659061523680">"ተመለስ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"ዝጋ"</string>
     <string name="available" msgid="6007778121920339498">"ይገኛል"</string>
     <string name="blocked" msgid="9195547604866033708">"ታግዷል"</string>
     <string name="on" msgid="280241003226755921">"በርቷል"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ምንም"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(የሥርዓት ነባሪ)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"መተግበሪያዎች የሉም"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"ሌሎች NFC አገልግሎቶች"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"ተመርጧል"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"ተመርጧል - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ልዩ የመተግበሪያ መዳረሻ"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"ትላንት በ<xliff:g id="TIME_DATE">%1$s</xliff:g> ላይ ተደርስበታል"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"በ<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g> ላይ ተደርስበታል"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"የአንድ ጊዜ የይለፍ ቃልዎ 132435 ነው"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"የተገደቡ ቅንብሮችን ፍቀድ"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"የተገደበ ቅንብር"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"ለእርስዎ ደህንነት ሲባል ይህ ቅንብር በአሁኑ ጊዜ አይገኝም።"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"መተግበሪያ የ<xliff:g id="PERMISSION_NAME">%1$s</xliff:g> መዳረሻ ተከልክሏል"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"እሺ"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"የፈቃድ ጥያቄ ታፍኗል"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ይህ መተግበሪያ ተጨማሪ ፈቃዶችን እየጠየቀ ነው፣ ነገር ግን ፈቃዶች በዥረት ክፍለ ጊዜ ውስጥ ሊሰጡ አይችሉም። መጀመሪያ በስልክዎ ላይ ፈቃድ ይስጡ።"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"ለአደጋ ጥሪ ወይም ጽሁፍ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"አካባቢ ወደ ድንገተኛ አደጋ አገልግሎቶች ተልኳል"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"ይህ መተግበሪያ ወደ የአደጋ ጊዜ ቁጥር ጥሪ በሚደረግበት ወይም ጽሁፍ በሚላክበት ጊዜ የመሣሪያዎን አካባቢ ደርሷል መተግበሪያው የአካባቢ ፈቃድ ሳይኖረው ወይም የመሣሪያው አካባቢ ሲጠፋም እንኳን ይህ ሊከሰት ይችላል። "<a href="https://support.google.com/android/answer/9319337">"የበለጠ ለመረዳት"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"ስልክዎን ይፈትሹ"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"ወደ ስልክዎ መድረስ አልተቻለም"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"እንደገና ይሞክር?"</string>
 </resources>
diff --git a/PermissionController/res/values-ar-v35/strings.xml b/PermissionController/res/values-ar-v35/strings.xml
new file mode 100644
index 000000000..6042920c0
--- /dev/null
+++ b/PermissionController/res/values-ar-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"الأمان"</string>
+</resources>
diff --git a/PermissionController/res/values-ar/strings.xml b/PermissionController/res/values-ar/strings.xml
index 260ea5277..d0bccee97 100644
--- a/PermissionController/res/values-ar/strings.xml
+++ b/PermissionController/res/values-ar/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"أذونات"</string>
     <string name="cancel" msgid="8943320028373963831">"إلغاء"</string>
     <string name="back" msgid="6249950659061523680">"رجوع"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"إغلاق"</string>
     <string name="available" msgid="6007778121920339498">"متاح"</string>
     <string name="blocked" msgid="9195547604866033708">"محظور"</string>
     <string name="on" msgid="280241003226755921">"مفعَّلة"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"غير محدَّد"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(الإعداد التلقائي للنظام)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"ليست هناك تطبيقات."</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"‏خدمات NFC الأخرى"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"التطبيق المُختار"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"التطبيق المُختار - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"أذونات خاصة للتطبيقات"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"‏آخر استخدام للإذن أمس: ‎<xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"‏آخر استخدام للإذن في ‎<xliff:g id="TIME_DATE_0">%1$s</xliff:g>: ‏<xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"كلمة المرور الصالحة لمرة واحدة هي 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"السماح بالإعدادات المحظورة"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"الإعداد محظور"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"للحفاظ على أمانك، هذا الإعداد غير متوفِّر حاليًا."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"تم منع التطبيق من الوصول إلى <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"حسنًا"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"تم إلغاء طلب الحصول على الإذن"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"يطلب هذا التطبيق الحصول على أذونات إضافية، ولكن لا يمكن منح أذونات في جلسة بث. امنح الإذن على هاتفك أولاً."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"مراسلة نصية أو مكالمة طوارئ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"تم إرسال بيانات الموقع الجغرافي إلى خدمات طوارئ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"وصل هذا التطبيق إلى الموقع الجغرافي لجهازك أثناء إجراء اتصال برقم طوارئ أو مراسلته نصيًا. يمكن أن يحدث ذلك حتى إذا لم يحصل التطبيق على إذن تحديد الموقع الجغرافي أو لم يتم تفعيل إعدادات الموقع الجغرافي للجهاز. "<a href="https://support.google.com/android/answer/9319337">"مزيد من المعلومات"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"يرجى التحقّق من هاتفك"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"تعذَّر الوصول إلى هاتفك"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"هل تريد إعادة المحاولة؟"</string>
 </resources>
diff --git a/PermissionController/res/values-as-v35/strings.xml b/PermissionController/res/values-as-v35/strings.xml
new file mode 100644
index 000000000..37ac47117
--- /dev/null
+++ b/PermissionController/res/values-as-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"সুৰক্ষা"</string>
+</resources>
diff --git a/PermissionController/res/values-as/strings.xml b/PermissionController/res/values-as/strings.xml
index e46e8bafe..ef3d28e5a 100644
--- a/PermissionController/res/values-as/strings.xml
+++ b/PermissionController/res/values-as/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"অনুমতি"</string>
     <string name="cancel" msgid="8943320028373963831">"বাতিল কৰক"</string>
     <string name="back" msgid="6249950659061523680">"উভতি যাওক"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"বন্ধ কৰক"</string>
     <string name="available" msgid="6007778121920339498">"উপলব্ধ"</string>
     <string name="blocked" msgid="9195547604866033708">"অৱৰোধ কৰা আছে"</string>
     <string name="on" msgid="280241003226755921">"অন আছে"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"নাই"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(ছিষ্টেম ডিফ\'ল্ট)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"কোনো এপ্‌ নাই"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"অন্য NFC সেৱা"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"বাছনিকৃত"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"বাছনিকৃত - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"বিশেষ এপ্ এক্সেছ"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"কালি <xliff:g id="TIME_DATE">%1$s</xliff:g>ত এক্সেছ কৰিছিল"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>ত এক্সেছ কৰিছিল"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"আপোনাৰ এবাৰ ব্যৱহাৰযোগ্য পাছৱর্ড হৈছে ১৩২৪৩৫"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"প্ৰতিবন্ধিত ছেটিঙৰ অনুমতি দিয়ক"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"প্ৰতিবন্ধিত ছেটিং"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"আপোনাৰ সুৰক্ষাৰ বাবে, এই ছেটিংটো বৰ্তমান উপলব্ধ নহয়।"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"এপ্‌টোক <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>ৰ এক্সেছ প্ৰত্যাখ্যান কৰা হৈছে"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ঠিক আছে"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"অনুমতিৰ অনুৰোধ অৱদমন কৰা হৈছে"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"এই এপ্‌টোৱে অতিৰিক্ত অনুমতিৰ বাবে অনুৰোধ কৰিছে, কিন্তু ষ্ট্ৰীমিং ছেশ্বনত অনুমতি দিব নোৱাৰি। আপোনাৰ ফ’নটোত প্ৰথমে অনুমতি দিয়ক।"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"জৰুৰীকালীন কল বা পাঠ বাৰ্তাৰ বাবে"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"অৱস্থান জৰুৰীকালীন সেৱালৈ পঠিওৱা হৈছে"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"এটা জৰুৰীকালীন নম্বৰলৈ কল কৰোঁতে বা বাৰ্তা পঠিয়াওঁতে এই এপ্‌টোৱে আপোনাৰ ডিভাইচৰ অৱস্থান এক্সেছ কৰিছে। এপ্‌টোৰ অৱস্থানৰ অনুমতি নাথাকিলে বা ডিভাইচৰ অৱস্থান অফ হৈ থাকিলেও এনে হ’ব পাৰে। "<a href="https://support.google.com/android/answer/9319337">"অধিক জানক"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"আপোনাৰ ফ’নটো চাওক"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"আপোনাৰ ফ’নটোৰ সৈতে সংযোগ কৰিব পৰা নগ’ল"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"পুনৰ চেষ্টা কৰিবনে?"</string>
 </resources>
diff --git a/PermissionController/res/values-az-v35/strings.xml b/PermissionController/res/values-az-v35/strings.xml
new file mode 100644
index 000000000..7ffd58cc1
--- /dev/null
+++ b/PermissionController/res/values-az-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Güvənlik"</string>
+</resources>
diff --git a/PermissionController/res/values-az/strings.xml b/PermissionController/res/values-az/strings.xml
index 773991122..a33e4c27e 100644
--- a/PermissionController/res/values-az/strings.xml
+++ b/PermissionController/res/values-az/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"icazələr"</string>
     <string name="cancel" msgid="8943320028373963831">"Ləğv edin"</string>
     <string name="back" msgid="6249950659061523680">"Geri"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Bağlayın"</string>
     <string name="available" msgid="6007778121920339498">"Əlçatan"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloklanıb"</string>
     <string name="on" msgid="280241003226755921">"Aktiv"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Yoxdur"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Sistem defoltu)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Tətbiq yoxdur"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Digər NFC xidmətləri"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Seçilib"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Seçilib - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"xüsusi tətbiq girişi"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Daxil olunub: dünən <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Daxil olunub: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Birdəfəlik parol: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Məhdudlaşdırılmış ayarlara icazə verin"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Məhdudlaşdırılmış ayar"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Güvənlik üçün bu ayar əlçatan deyil."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Tətbiqə <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> icazəsinə giriş verilmədi"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"İcazə sorğusu dayandırıldı"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Bu tətbiqə əlavə icazələr lazımdır, lakin yayım sessiyasında icazə vermək olmur. Əvvəlcə telefonda icazə verin."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Təcili zəng və ya mətn mesajı üçün"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Məkan təcili xidmətlərə göndərildi"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Bu tətbiq təcili nömrəyə zəng edərkən və ya mesaj göndərərkən cihazınızın məkanına daxil oldu. Bu hal hətta tətbiqin məkan icazəsi olmadıqda və ya cihaz məkanı sönülü olduqda da baş verə bilər. "<a href="https://support.google.com/android/answer/9319337">"Ətraflı məlumat"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Telefonu yoxlayın"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Telefona qoşulmaq olmur"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Təkrar cəhd edilsin?"</string>
 </resources>
diff --git a/PermissionController/res/values-b+sr+Latn-v35/strings.xml b/PermissionController/res/values-b+sr+Latn-v35/strings.xml
new file mode 100644
index 000000000..9ad2d24c7
--- /dev/null
+++ b/PermissionController/res/values-b+sr+Latn-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Bezbednost"</string>
+</resources>
diff --git a/PermissionController/res/values-b+sr+Latn/strings.xml b/PermissionController/res/values-b+sr+Latn/strings.xml
index d50d32f70..8215737c7 100644
--- a/PermissionController/res/values-b+sr+Latn/strings.xml
+++ b/PermissionController/res/values-b+sr+Latn/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"dozvole"</string>
     <string name="cancel" msgid="8943320028373963831">"Otkaži"</string>
     <string name="back" msgid="6249950659061523680">"Nazad"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Zatvori"</string>
     <string name="available" msgid="6007778121920339498">"Dostupno"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokirano"</string>
     <string name="on" msgid="280241003226755921">"Uključeno"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ništa"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Podrazumevana sistemska)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nema aplikacija"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Druge NFC usluge"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Izabrano"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Izabrano – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"poseban pristup aplikacija"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Pristupano juče: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Pristupano: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Jednokratna lozinka je 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Dozvoli ograničena podešavanja"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ograničeno podešavanje"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Ovo podešavanje je trenutno nedostupno radi vaše bezbednosti."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikaciji nije dozvoljen pristup dozvoli: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Važi"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Zahtev za dozvolu je blokiran"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Ova aplikacija zahteva dodatne dozvole, ali dozvole ne mogu da se daju u sesiji strimovanja. Prvo dajte dozvolu na telefonu."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Za hitni poziv ili poruku"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Lokacija je poslata hitnim službama"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Ova aplikacija je pristupila lokaciji uređaja tokom pozivanja broja za hitne slučajeve ili slanja poruke tom broju. To može da se dogodi čak i kada aplikacija nema dozvolu za lokaciju ili je lokacija uređaja isključena. "<a href="https://support.google.com/android/answer/9319337">"Saznajte više"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Proverite telefon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Povezivanje sa telefonom nije uspelo"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Želite li da probate ponovo?"</string>
 </resources>
diff --git a/PermissionController/res/values-be-v35/strings.xml b/PermissionController/res/values-be-v35/strings.xml
new file mode 100644
index 000000000..39f076e77
--- /dev/null
+++ b/PermissionController/res/values-be-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Бяспека"</string>
+</resources>
diff --git a/PermissionController/res/values-be/strings.xml b/PermissionController/res/values-be/strings.xml
index d0215198b..b009b68d3 100644
--- a/PermissionController/res/values-be/strings.xml
+++ b/PermissionController/res/values-be/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"дазволы"</string>
     <string name="cancel" msgid="8943320028373963831">"Скасаваць"</string>
     <string name="back" msgid="6249950659061523680">"Назад"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Закрыць"</string>
     <string name="available" msgid="6007778121920339498">"Даступна"</string>
     <string name="blocked" msgid="9195547604866033708">"Заблакіравана"</string>
     <string name="on" msgid="280241003226755921">"Уключана"</string>
@@ -92,7 +93,7 @@
     <string name="manage_permission" msgid="2895385393037061964">"Кіраваць дазволам"</string>
     <string name="no_apps" msgid="2412612731628386816">"Няма праграм"</string>
     <string name="location_settings" msgid="3624412509133422562">"Налады месцазнаходжання"</string>
-    <string name="location_warning" msgid="2381649060929040962">"<xliff:g id="APP_NAME">%1$s</xliff:g> з\'яўляецца службай геалакацыі для гэтай прылады. Доступ да вызначэння месцазнаходжання можна змяніць у наладах."</string>
+    <string name="location_warning" msgid="2381649060929040962">"<xliff:g id="APP_NAME">%1$s</xliff:g> з’яўляецца службай геалакацыі для гэтай прылады. Доступ да вызначэння месцазнаходжання можна змяніць у наладах."</string>
     <string name="system_warning" msgid="1173400963234358816">"Калі вы адхіліце гэты дазвол, асноўныя функцыі прылады могуць перастаць працаваць належным чынам."</string>
     <string name="deny_read_media_visual_warning" msgid="3982586279917232827">"Гэта праграма створана для ранейшай версіі Android. Забараніўшы праграме доступ да фота і відэа, вы таксама закрыеце доступ да музыкі і іншых аўдыяфайлаў."</string>
     <string name="deny_read_media_aural_warning" msgid="8928699919508646732">"Гэта праграма створана для ранейшай версіі Android. Забараніўшы праграме доступ да музыкі і іншых аўдыяфайлаў, вы таксама закрыеце доступ да фота і відэа."</string>
@@ -374,7 +375,7 @@
     <string name="role_sms_search_keywords" msgid="8022048144395047352">"тэкставае паведамленне, SMS, паведамленні, абмен паведамленнямі"</string>
     <string name="role_emergency_label" msgid="7028825857206842366">"Праграма экстраннай дапамогі"</string>
     <string name="role_emergency_short_label" msgid="2388431453335350348">"Праграма экстраннай дапамогі"</string>
-    <string name="role_emergency_description" msgid="5051840234887686630">"Праграмы, якія даюць вам магчымасць: запісаць медыцынскую інфармацыю і зрабіць яе даступнай для экстраннай службы; атрымліваць абвесткі пра стыхійныя бедствы і складаныя ўмовы надвор\'я; апавяшчаць іншых пра тое, што вам патрабуецца дапамога"</string>
+    <string name="role_emergency_description" msgid="5051840234887686630">"Праграмы, якія даюць вам магчымасць: запісаць медыцынскую інфармацыю і зрабіць яе даступнай для экстраннай службы; атрымліваць абвесткі пра стыхійныя бедствы і складаныя ўмовы надвор’я; апавяшчаць іншых пра тое, што вам патрабуецца дапамога"</string>
     <string name="role_emergency_request_title" msgid="8469579020654348567">"Прызначыць \"<xliff:g id="APP_NAME">%1$s</xliff:g>\" стандартнай праграмай экстраннай дапамогі?"</string>
     <string name="role_emergency_request_description" msgid="131645948770262850">"Дазволы не патрэбныя"</string>
     <string name="role_emergency_search_keywords" msgid="1920007722599213358">"у выпадку надзвычайнай сітуацыі"</string>
@@ -408,7 +409,7 @@
     <string name="role_notes_search_keywords" msgid="7710756695666744631">"нататкі"</string>
     <string name="role_wallet_label" msgid="3719419175656204207">"Стандартная праграма-кашалёк"</string>
     <string name="role_wallet_short_label" msgid="6521288403762457452">"Праграма-кашалёк"</string>
-    <string name="role_wallet_description" msgid="3726535836165949838">"У праграмах-кашальках можна захоўваць крэдытныя карткі, карткі лаяльнасці, ключы ад аўтамабіля і іншыя лічбавыя аб\'екты, што дае магчымасць ажыццяўляць розныя формы трансакцый."</string>
+    <string name="role_wallet_description" msgid="3726535836165949838">"У праграмах-кашальках можна захоўваць крэдытныя карткі, карткі лаяльнасці, ключы ад аўтамабіля і іншыя лічбавыя аб’екты, што дае магчымасць ажыццяўляць розныя формы трансакцый."</string>
     <string name="role_wallet_request_title" msgid="4770217108262737093">"Задаць у якасці стандартнай праграмы-кашалька праграму \"<xliff:g id="APP_NAME">%1$s</xliff:g>\"?"</string>
     <string name="role_wallet_request_description" msgid="6305487425777483053">"Дазволы не патрэбныя"</string>
     <string name="request_role_current_default" msgid="738722892438247184">"Цяперашняя стандартная"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Няма"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Стандартная сістэмная)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Няма праграм"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Іншыя сэрвісы NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Выбрана"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Выбрана – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"спецыяльны доступ для праграм"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Апошні раз доступ быў атрыманы ўчора ў <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Апошні раз доступ быў атрыманы ў <xliff:g id="TIME_DATE_1">%2$s</xliff:g> <xliff:g id="TIME_DATE_0">%1$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Ваш аднаразовы пароль: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Дазволіць абмежаваныя налады"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Налада з абмежаваным доступам"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"У мэтах бяспекі гэта налада цяпер недаступная."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Праграме адмоўлена ў дазволе \"<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>\""</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Запыт дазволаў заблакіраваны"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Гэта праграма запытвае дадатковыя дазволы, якія немагчыма даць падчас трансляцыі. Спачатку дайце дазвол на тэлефоне."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Для выкліку або SMS экстранным службам"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Геаданыя адпраўляюцца экстранным службам"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Калі вы тэлефанавалі або адпраўлялі SMS на нумар экстраннай службы, гэта праграма атрымлівала доступ да геаданых прылады. Гэта магчыма, нават калі ў праграмы няма дазволу на доступ да геаданых і калі вызначэнне геаданых прылады выключана. "<a href="https://support.google.com/android/answer/9319337">"Даведацца больш"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Працягніце на тэлефоне"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Не ўдалося падключыцца да тэлефона"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Паўтарыць спробу?"</string>
 </resources>
diff --git a/PermissionController/res/values-bg-v35/strings.xml b/PermissionController/res/values-bg-v35/strings.xml
new file mode 100644
index 000000000..72f4a8562
--- /dev/null
+++ b/PermissionController/res/values-bg-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Сигурност"</string>
+</resources>
diff --git a/PermissionController/res/values-bg/strings.xml b/PermissionController/res/values-bg/strings.xml
index ffbfd5a1c..b3c16b703 100644
--- a/PermissionController/res/values-bg/strings.xml
+++ b/PermissionController/res/values-bg/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"разрешения"</string>
     <string name="cancel" msgid="8943320028373963831">"Отказ"</string>
     <string name="back" msgid="6249950659061523680">"Назад"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Затваряне"</string>
     <string name="available" msgid="6007778121920339498">"Налице"</string>
     <string name="blocked" msgid="9195547604866033708">"Блокирано"</string>
     <string name="on" msgid="280241003226755921">"Вкл."</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Няма"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Стандартно за системата)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Няма приложения"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Други услуги за NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Избрано"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Избрано – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"специален достъп за приложението"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Осъществен достъп: вчера, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Осъществен достъп: <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Еднократната ви парола е 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Разрешаване на ограничените настройки"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ограничена настройка"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"От съображения за сигурност понастоящем тази настройка не е налице."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"На приложението бе отказан достъп до <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Заявката за разрешения е блокирана"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Това приложение изисква допълнителни разрешения, но те не могат да бъдат предоставени в сесия за поточно предаване. Първо ги предоставете на телефона си."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"За спешно обаждане или изпращане на съобщение"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Местоположението е изпратено до службите за спешни случаи"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Това приложение осъществи достъп до местоположението на устройството ви по време на обаждане или изпращане на текстово съобщение до номер за спешни случаи. Това може да се случи дори когато приложението няма разрешение за достъп до местоположението или местоположението на устройството е изключено. "<a href="https://support.google.com/android/answer/9319337">"Научете повече"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Проверете телефона си"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Не бе установена връзка с телефона ви"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Да се опита ли отново?"</string>
 </resources>
diff --git a/PermissionController/res/values-bn-v35/strings.xml b/PermissionController/res/values-bn-v35/strings.xml
new file mode 100644
index 000000000..066c4ad5a
--- /dev/null
+++ b/PermissionController/res/values-bn-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"সুরক্ষা"</string>
+</resources>
diff --git a/PermissionController/res/values-bn/strings.xml b/PermissionController/res/values-bn/strings.xml
index 9c916abef..4d7e6a55e 100644
--- a/PermissionController/res/values-bn/strings.xml
+++ b/PermissionController/res/values-bn/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"অনুমতি"</string>
     <string name="cancel" msgid="8943320028373963831">"বাতিল করুন"</string>
     <string name="back" msgid="6249950659061523680">"ফিরুন"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"বন্ধ করুন"</string>
     <string name="available" msgid="6007778121920339498">"উপলভ্য"</string>
     <string name="blocked" msgid="9195547604866033708">"ব্লক করা হয়েছে"</string>
     <string name="on" msgid="280241003226755921">"চালু করা আছে"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"কোনওটিই নয়"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(সিস্টেম ডিফল্ট)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"কোনও অ্যাপ নেই"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"অন্যান্য NFC পরিষেবা"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"বেছে নেওয়া হয়েছে"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"বেছে নেওয়া হয়েছে - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"অ্যাপের বিশেষ অ্যাক্সেস"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"গতকাল <xliff:g id="TIME_DATE">%1$s</xliff:g>-এ অ্যাক্সেস করা হয়েছে"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g><xliff:g id="TIME_DATE_1">%2$s</xliff:g>-এ অ্যাক্সেস করা হয়েছে"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"আপনার একবার ব্যবহারের পাসওয়ার্ড হল ১২৩৪৩৫"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"বিধিনিষেধযুক্ত সেটিংসের অনুমতি দিন"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"বিধিনিষেধযুক্ত সেটিংস"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"আপনার নিরাপত্তার জন্য, এই সেটিং বর্তমানে উপলভ্য নেই।"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"অ্যাপকে <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> অ্যাক্সেস করতে দেওয়া হয়নি"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ঠিক আছে"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"অনুমতির অনুরোধ ব্লক করা হয়েছে"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"এই অ্যাপ অতিরিক্ত অনুমতির জন্য অনুরোধ করছে, কিন্তু স্ট্রিমিং সেশন চলাকালীন অনুমতি দেওয়া যাবে না। প্রথমে আপনার ফোনে অনুমতি দিন।"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"জরুরি কল বা মেসেজের জন্য"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"জরুরি পরিষেবায় লোকেশন পাঠানো হয়েছে"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"আপনি যখন একটি জরুরি নম্বরে কল বা মেসেজ পাঠানোর সময়, অ্যাপটি আপনার ডিভাইসের লোকেশন অ্যাক্সেস করেছে। অ্যাপের ডিভাইসের লোকেশন অ্যাক্সেস করার অনুমতি না থাকলে অথবা লোকেশন বন্ধ থাকলেও এটি হতে পারে। "<a href="https://support.google.com/android/answer/9319337">"আরও জানুন"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"আপনার ফোন চেক করুন"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"আপনার ফোনে কানেক্ট করা যায়নি"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"আবার চেষ্টা করতে চান?"</string>
 </resources>
diff --git a/PermissionController/res/values-bs-v35/strings.xml b/PermissionController/res/values-bs-v35/strings.xml
new file mode 100644
index 000000000..71b83b6c9
--- /dev/null
+++ b/PermissionController/res/values-bs-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sigurnost"</string>
+</resources>
diff --git a/PermissionController/res/values-bs/strings.xml b/PermissionController/res/values-bs/strings.xml
index 56ee25058..9dbaca940 100644
--- a/PermissionController/res/values-bs/strings.xml
+++ b/PermissionController/res/values-bs/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"odobrenja"</string>
     <string name="cancel" msgid="8943320028373963831">"Otkaži"</string>
     <string name="back" msgid="6249950659061523680">"Nazad"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Zatvori"</string>
     <string name="available" msgid="6007778121920339498">"Dostupno"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokirano"</string>
     <string name="on" msgid="280241003226755921">"Uključeno"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nema"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Sistemski zadano)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nema aplikacija"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Druge NFC usluge"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Odabrano"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Odabrano – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"poseban pristup aplikacijama"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Pristupljeno je jučer u <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Pristupljeno je <xliff:g id="TIME_DATE_0">%1$s</xliff:g> u <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Jednokratna lozinka je 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Dozvoli ograničene postavke"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ograničena postavka"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Radi vaše sigurnosti postavka trenutno nije dostupna."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikaciji je odbijen pristup odobrenju <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Uredu"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Zahtjev za odobrenje je potisnut"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Aplikacija traži dodatna odobrenja, ali se ona ne mogu dati u sesiji prijenosa. Najprije dajte odobrenje na telefonu."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Za hitni poziv ili poruku"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Lokacija je poslana hitnim službama"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Ova aplikacija je pristupila lokaciji uređaja tokom poziva ili slanja poruke broju za hitne slučajeve. To se može dogoditi čak i kada aplikacija nema odobrenje za lokaciju ili je lokacija uređaja isključena. "<a href="https://support.google.com/android/answer/9319337">"Saznajte više"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Provjerite telefon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Nije se moguće povezati s telefonom"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Pokušati ponovo?"</string>
 </resources>
diff --git a/PermissionController/res/values-ca-v35/strings.xml b/PermissionController/res/values-ca-v35/strings.xml
new file mode 100644
index 000000000..10bff4b9c
--- /dev/null
+++ b/PermissionController/res/values-ca-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Seguretat"</string>
+</resources>
diff --git a/PermissionController/res/values-ca/strings.xml b/PermissionController/res/values-ca/strings.xml
index bbb20307b..e61f41507 100644
--- a/PermissionController/res/values-ca/strings.xml
+++ b/PermissionController/res/values-ca/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permisos"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancel·la"</string>
     <string name="back" msgid="6249950659061523680">"Enrere"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Tanca"</string>
     <string name="available" msgid="6007778121920339498">"Disponible"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloquejat"</string>
     <string name="on" msgid="280241003226755921">"Activat"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Cap"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Opció predeterminada del sistema)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Cap aplicació"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Altres serveis NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Seleccionada"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Seleccionada: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"accés especial d\'aplicacions"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"S\'hi va accedir ahir a les <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"S\'hi ha accedit el dia <xliff:g id="TIME_DATE_0">%1$s</xliff:g> a les <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"La contrasenya d\'un sol ús és 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Permet la configuració restringida"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Opció de configuració restringida"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Per a la teva seguretat, aquesta opció de configuració no està disponible en aquests moments."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"A l\'aplicació se li ha denegat l\'accés a <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"D\'acord"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"S\'ha suprimit la sol·licitud de permís"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Aquesta aplicació requereix permisos addicionals, però els permisos no es poden concedir en una sessió d\'estríming. Primer concedeix el permís al teu telèfon."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Per a trucades o missatges de text d\'emergència"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"La ubicació s\'ha enviat als serveis d\'emergències"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Aquesta aplicació ha accedit a la ubicació del teu dispositiu mentre feies una trucada o enviaves un missatge de text a un número d\'emergència. Això pot passar fins i tot quan l\'aplicació no té permís d\'ubicació o la ubicació del dispositiu està desactivada. "<a href="https://support.google.com/android/answer/9319337">"Més informació"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Comprova el telèfon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"No s\'ha pogut contactar amb el telèfon"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Vols tornar-ho a provar?"</string>
 </resources>
diff --git a/PermissionController/res/values-cs-v35/strings.xml b/PermissionController/res/values-cs-v35/strings.xml
new file mode 100644
index 000000000..95aa40cc4
--- /dev/null
+++ b/PermissionController/res/values-cs-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Zabezpečení"</string>
+</resources>
diff --git a/PermissionController/res/values-cs/strings.xml b/PermissionController/res/values-cs/strings.xml
index 4ad13ec8a..328647205 100644
--- a/PermissionController/res/values-cs/strings.xml
+++ b/PermissionController/res/values-cs/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"oprávnění"</string>
     <string name="cancel" msgid="8943320028373963831">"Zrušit"</string>
     <string name="back" msgid="6249950659061523680">"Zpět"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Zavřít"</string>
     <string name="available" msgid="6007778121920339498">"Dostupné"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokováno"</string>
     <string name="on" msgid="280241003226755921">"Zapnuto"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Žádná aplikace"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Výchozí nastavení systému)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Žádné aplikace"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Ostatní služby NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Vybráno"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Vybráno – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"zvláštní přístup aplikací"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Poslední přístup: včera v <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Poslední přístup: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Vaše jednorázové heslo je 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Povolit omezená nastavení"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Blokované nastavení"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Z důvodu vaší bezpečnosti toto nastavení momentálně není dostupné."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikaci byl odepřen přístup k oprávnění <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Žádost o oprávnění byla potlačena"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Tato aplikace požaduje další oprávnění, která ale nelze udělit během relace streamování. Oprávnění udělte nejprve na telefonu."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Pro tísňové volání nebo textovou zprávu"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Poloha byla odeslána na tísňovou linku"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Tato aplikace získala přístup k poloze vašeho zařízení během hovoru nebo při posílání SMS na číslo tísňového volání. K tomu může dojít, i když aplikace nemá oprávnění pro přístup k poloze nebo je poloha zařízení vypnutá. "<a href="https://support.google.com/android/answer/9319337">"Další informace"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Zkontrolujte svůj telefon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"K telefonu se nepodařilo připojit"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Zkusit znovu?"</string>
 </resources>
diff --git a/PermissionController/res/values-da-v35/strings.xml b/PermissionController/res/values-da-v35/strings.xml
new file mode 100644
index 000000000..911941e5b
--- /dev/null
+++ b/PermissionController/res/values-da-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sikkerhed"</string>
+</resources>
diff --git a/PermissionController/res/values-da/strings.xml b/PermissionController/res/values-da/strings.xml
index d8af25f0d..6a2456bd6 100644
--- a/PermissionController/res/values-da/strings.xml
+++ b/PermissionController/res/values-da/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"tilladelser"</string>
     <string name="cancel" msgid="8943320028373963831">"Annuller"</string>
     <string name="back" msgid="6249950659061523680">"Tilbage"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Luk"</string>
     <string name="available" msgid="6007778121920339498">"Tilgængelig"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokeret"</string>
     <string name="on" msgid="280241003226755921">"Til"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ingen"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Systemstandard)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Ingen apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Andre NFC-tjenester"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Valgt"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Valgt – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"særlig appadgang"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Tilgået i går kl. <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Tilgået <xliff:g id="TIME_DATE_0">%1$s</xliff:g> kl. <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Din engangskode er 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Tillad begrænsede indstillinger"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Begrænset indstilling"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Af hensyn til din sikkerhed er denne indstilling i øjeblikket ikke tilgængelig."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Appen blev nægtet adgang til <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Anmodning om tilladelse blokeret"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Denne app anmoder om yderligere tilladelser, men der kan ikke gives tilladelser under en streamingsession. Giv tilladelse på din telefon først."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"For opkald eller beskeder til et alarmnummer"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Lokation sendt til nødtjenester"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Denne app har tilgået din enheds lokation i forbindelse med et opkald eller en besked til et alarmnummer. Dette kan lade sig gøre, selvom appen ikke har lokationstilladelse, eller enhedens lokation er deaktiveret. "<a href="https://support.google.com/android/answer/9319337">"Få flere oplysninger"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Tjek din telefon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Der kunne ikke oprettes forbindelse til telefonen"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Vil du prøve igen?"</string>
 </resources>
diff --git a/PermissionController/res/values-de-v35/strings.xml b/PermissionController/res/values-de-v35/strings.xml
new file mode 100644
index 000000000..7f04a8b8c
--- /dev/null
+++ b/PermissionController/res/values-de-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sicherheit"</string>
+</resources>
diff --git a/PermissionController/res/values-de/strings.xml b/PermissionController/res/values-de/strings.xml
index 139a9e41d..efb3062d6 100644
--- a/PermissionController/res/values-de/strings.xml
+++ b/PermissionController/res/values-de/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"Berechtigungen"</string>
     <string name="cancel" msgid="8943320028373963831">"Abbrechen"</string>
     <string name="back" msgid="6249950659061523680">"Zurück"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Schließen"</string>
     <string name="available" msgid="6007778121920339498">"Verfügbar"</string>
     <string name="blocked" msgid="9195547604866033708">"Gesperrt"</string>
     <string name="on" msgid="280241003226755921">"An"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Keine"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(System-Standard­einstellung)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Keine Apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Andere NFC‑Dienste"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Ausgewählt"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Ausgewählt – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"spezieller App-Zugriff"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Zugriff: gestern, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Zugriff: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Dein Einmalpasswort lautet 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Eingeschränkte Einstellungen zulassen"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Eingeschränkte Einstellung"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Aus Sicherheitsgründen ist diese Einstellung derzeit nicht verfügbar."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"App wurde Zugriff auf „<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>“ verweigert"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Ok"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Berechtigungsanfrage unterdrückt"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Diese App fordert zusätzliche Berechtigungen an – in einer Streamingsitzung können jedoch keine Berechtigungen gewährt werden. Erteile zuerst die Berechtigung auf deinem Smartphone."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Für Notrufe oder Nachrichten an eine Notrufnummer"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Standort wurde an den Rettungsdienst gesendet"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Diese App hat den Standort deines Geräts abgerufen, während ein Notruf getätigt oder eine Nachricht an eine Notrufnummer gesendet wurde. Das kann auch dann passieren, wenn die App keine Berechtigung zur Standortermittlung hat oder der Gerätestandort deaktiviert ist. "<a href="https://support.google.com/android/answer/9319337">"Weitere Informationen"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Smartphone prüfen"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Verbindung mit dem Smartphone nicht möglich"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Noch einmal versuchen?"</string>
 </resources>
diff --git a/PermissionController/res/values-el-v35/strings.xml b/PermissionController/res/values-el-v35/strings.xml
new file mode 100644
index 000000000..fa7c62da3
--- /dev/null
+++ b/PermissionController/res/values-el-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Ασφάλεια"</string>
+</resources>
diff --git a/PermissionController/res/values-el/strings.xml b/PermissionController/res/values-el/strings.xml
index fe7103b90..cc59b6748 100644
--- a/PermissionController/res/values-el/strings.xml
+++ b/PermissionController/res/values-el/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"άδειες"</string>
     <string name="cancel" msgid="8943320028373963831">"Ακύρωση"</string>
     <string name="back" msgid="6249950659061523680">"Πίσω"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Κλείσιμο"</string>
     <string name="available" msgid="6007778121920339498">"Διαθέσιμο"</string>
     <string name="blocked" msgid="9195547604866033708">"Αποκλεισμένο"</string>
     <string name="on" msgid="280241003226755921">"Ενεργό"</string>
@@ -110,7 +111,7 @@
     <!-- no translation found for background_access_chooser_dialog_choices:1 (9127301153688725448) -->
     <!-- no translation found for background_access_chooser_dialog_choices:2 (4305536986042401191) -->
     <string name="permission_access_always" msgid="1474641821883823446">"Να επιτρέπεται πάντα"</string>
-    <string name="permission_access_only_foreground" msgid="7801170728159326195">"Μόνο με τη χρήση της εφαρμογής"</string>
+    <string name="permission_access_only_foreground" msgid="7801170728159326195">"Να επιτρέπεται μόνο κατά τη χρήση της εφαρμογής"</string>
     <string name="permission_access_never" msgid="4647014230217936900">"Να μην επιτρέπεται"</string>
     <string name="loading" msgid="4789365003890741082">"Φόρτωση…"</string>
     <string name="all_permissions" msgid="6911125611996872522">"Όλες οι άδειες"</string>
@@ -187,9 +188,9 @@
     <string name="app_permission_button_allow_all_files" msgid="1792232272599018825">"Να επιτρέπεται η διαχείριση όλων των αρχείων"</string>
     <string name="app_permission_button_allow_media_only" msgid="2834282724426046154">"Να επιτρέπεται η διαχείριση μόνο των μέσων"</string>
     <string name="app_permission_button_allow_always" msgid="4573292371734011171">"Να επιτρέπεται πάντα"</string>
-    <string name="app_permission_button_allow_foreground" msgid="1991570451498943207">"Μόνο με τη χρήση της εφαρμογής"</string>
+    <string name="app_permission_button_allow_foreground" msgid="1991570451498943207">"Να επιτρέπεται μόνο κατά τη χρήση της εφαρμογής"</string>
     <string name="app_permission_button_always_allow_all" msgid="4905699259378428855">"Να επιτρέπονται πάντα όλα"</string>
-    <string name="app_permission_button_ask" msgid="3342950658789427">"Να ερωτώμαι κάθε φορά"</string>
+    <string name="app_permission_button_ask" msgid="3342950658789427">"Ερώτηση κάθε φορά"</string>
     <string name="app_permission_button_deny" msgid="6016454069832050300">"Να μην επιτρέπεται"</string>
     <string name="app_permission_button_allow_limited_access" msgid="8824410215149764113">"Να επιτρέπεται περιορισμένη πρόσβαση"</string>
     <string name="precise_image_description" msgid="6349638632303619872">"Ακριβής τοποθεσία"</string>
@@ -255,7 +256,7 @@
     <string name="allowed_storage_scoped" msgid="5383645873719086975">"Επιτρέπεται η πρόσβαση μόνο σε μέσα"</string>
     <string name="allowed_storage_full" msgid="5356699280625693530">"Επιτρέπεται η διαχείριση όλων των αρχείων"</string>
     <string name="ask_header" msgid="2633816846459944376">"Ερώτηση κάθε φορά"</string>
-    <string name="denied_header" msgid="903209608358177654">"Δεν επιτρέπεται"</string>
+    <string name="denied_header" msgid="903209608358177654">"Δεν επιτρέπονται"</string>
     <string name="permission_group_name_with_device_name" msgid="8798741850536024820">"<xliff:g id="PERM_GROUP_NAME">%1$s</xliff:g> στη συσκευή <xliff:g id="DEVICE_NAME">%2$s</xliff:g>"</string>
     <string name="storage_footer_hyperlink_text" msgid="8873343987957834810">"Δείτε περισσότερες εφαρμογές με πρόσβαση σε όλα τα αρχεία"</string>
     <string name="days" msgid="609563020985571393">"{count,plural, =1{1 ημέρα}other{# ημέρες}}"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Καμία"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Προεπιλογή συστήματος)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Δεν υπάρχουν εφαρμογές"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Άλλες υπηρεσίες NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Επιλέχτηκε"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Επιλέχτηκε - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ειδική πρόσβαση στην εφαρμογή"</string>
@@ -501,11 +503,11 @@
     <string name="permgrouprequest_device_aware_read_media_visual" msgid="3122576538319059333">"Να επιτρέπεται στην εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η πρόσβαση σε φωτογραφίες και σε βίντεο στη συσκευή &lt;b&gt;<xliff:g id="DEVICE_NAME">%2$s</xliff:g>&lt;/b&gt;;"</string>
     <string name="permgrouprequest_more_photos" msgid="128933814654231321">"Να επιτρέπεται στην εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η πρόσβαση σε περισσότερες φωτογραφίες και βίντεο αυτής της συσκευής;"</string>
     <string name="permgrouprequest_device_aware_more_photos" msgid="1703469013613723053">"Να επιτρέπεται στην εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η πρόσβαση σε περισσότερες φωτογραφίες και βίντεο στη συσκευή &lt;b&gt;<xliff:g id="DEVICE_NAME">%2$s</xliff:g>&lt;/b&gt;;"</string>
-    <string name="permgrouprequest_microphone" msgid="2825208549114811299">"Να επιτρέπεται στο &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η εγγραφή ήχου;"</string>
-    <string name="permgrouprequest_device_aware_microphone" msgid="8821701550505437951">"Να επιτρέπεται στην εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η εγγραφή ήχου στη συσκευή &lt;b&gt;<xliff:g id="DEVICE_NAME">%2$s</xliff:g>&lt;/b&gt;;"</string>
+    <string name="permgrouprequest_microphone" msgid="2825208549114811299">"Να επιτρέπεται στο &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η ηχογράφηση;"</string>
+    <string name="permgrouprequest_device_aware_microphone" msgid="8821701550505437951">"Να επιτρέπεται στην εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η ηχογράφηση στη συσκευή &lt;b&gt;<xliff:g id="DEVICE_NAME">%2$s</xliff:g>&lt;/b&gt;;"</string>
     <string name="permgrouprequestdetail_microphone" msgid="8510456971528228861">"Αυτή η εφαρμογή θα μπορεί να εγγράφει ήχο μόνο όταν τη χρησιμοποιείτε"</string>
-    <string name="permgroupbackgroundrequest_microphone" msgid="8874462606796368183">"Να επιτρέπεται στο &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η εγγραφή ήχου;"</string>
-    <string name="permgroupbackgroundrequest_device_aware_microphone" msgid="3321823187623762958">"Να επιτρέπεται στην εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η εγγραφή ήχου στη συσκευή &lt;b&gt;<xliff:g id="DEVICE_NAME">%2$s</xliff:g>&lt;/b&gt;;"</string>
+    <string name="permgroupbackgroundrequest_microphone" msgid="8874462606796368183">"Να επιτρέπεται στο &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η ηχογράφηση;"</string>
+    <string name="permgroupbackgroundrequest_device_aware_microphone" msgid="3321823187623762958">"Να επιτρέπεται στην εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; η ηχογράφηση στη συσκευή &lt;b&gt;<xliff:g id="DEVICE_NAME">%2$s</xliff:g>&lt;/b&gt;;"</string>
     <string name="permgroupbackgroundrequestdetail_microphone" msgid="553702902263681838">"Αυτή η εφαρμογή ενδέχεται να εγγράφει βίντεο συνεχώς, ακόμη και όταν δεν τη χρησιμοποιείτε. "<annotation id="link">"Έγκριση στις ρυθμίσεις."</annotation></string>
     <string name="permgroupupgraderequest_microphone" msgid="1362781696161233341">"Αλλαγή πρόσβασης στο μικρόφωνο για την εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt;;"</string>
     <string name="permgroupupgraderequest_device_aware_microphone" msgid="8722411173971679806">"Να γίνει αλλαγή της πρόσβασης μικροφώνου για την εφαρμογή &lt;b&gt;<xliff:g id="APP_NAME">%1$s</xliff:g>&lt;/b&gt; στη συσκευή &lt;b&gt;<xliff:g id="DEVICE_NAME">%2$s</xliff:g>&lt;/b&gt;;"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Πρόσβαση χθες, στις <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Πρόσβαση στις <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Ο κωδικός πρόσβασης μίας χρήσης είναι 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Επιτρέπονται περιορισμένες ρυθμίσεις"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Περιορισμένη ρύθμιση"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Για την ασφάλειά σας, αυτή η ρύθμιση δεν είναι διαθέσιμη αυτή τη στιγμή."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Απορρίφθηκε η πρόσβαση της εφαρμογής στην άδεια <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ΟΚ"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Το αίτημα άδειας ανεστάλη"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Αυτή η εφαρμογή ζητά πρόσθετες άδειες, αλλά οι άδειες δεν μπορούν να εκχωρηθούν σε μια περίοδο σύνδεσης ροής. Εκχωρήστε πρώτα την άδεια στο τηλέφωνό σας."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Για κλήσεις ή μηνύματα έκτακτης ανάγκης"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Η τοποθεσία στάλθηκε στις υπηρεσίες έκτακτης ανάγκης"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Αυτή η εφαρμογή απέκτησε πρόσβαση στην τοποθεσία της συσκευής σας κατά τη διάρκεια μιας κλήσης ή κατά την αποστολή ενός μηνύματος σε έναν αριθμό έκτακτης ανάγκης. Αυτό μπορεί να συμβεί ακόμα και εάν η εφαρμογή δεν έχει άδεια τοποθεσίας ή εάν η τοποθεσία της συσκευής είναι απενεργοποιημένη. "<a href="https://support.google.com/android/answer/9319337">"Μάθετε περισσότερα"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Ελέγξτε το τηλέφωνό σας"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Δεν ήταν δυνατή η επικοινωνία με το τηλέφωνό σας"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Επανάληψη;"</string>
 </resources>
diff --git a/PermissionController/res/values-en-rAU-v35/strings.xml b/PermissionController/res/values-en-rAU-v35/strings.xml
new file mode 100644
index 000000000..c4b7df49d
--- /dev/null
+++ b/PermissionController/res/values-en-rAU-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Security"</string>
+</resources>
diff --git a/PermissionController/res/values-en-rAU/strings.xml b/PermissionController/res/values-en-rAU/strings.xml
index 5ae4af174..d15cb526b 100644
--- a/PermissionController/res/values-en-rAU/strings.xml
+++ b/PermissionController/res/values-en-rAU/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permissions"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancel"</string>
     <string name="back" msgid="6249950659061523680">"Back"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Close"</string>
     <string name="available" msgid="6007778121920339498">"Available"</string>
     <string name="blocked" msgid="9195547604866033708">"Blocked"</string>
     <string name="on" msgid="280241003226755921">"On"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"None"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(System default)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"No apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Other NFC services"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selected"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selected – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"special app access"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Accessed yesterday <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Accessed <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Your one-time password is 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Allow restricted settings"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Restricted setting"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"For your security, this setting is currently unavailable."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"App was denied access to <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Permission request suppressed"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"This app is requesting additional permissions, but permissions can\'t be granted in a streaming session. Grant the permission on your phone first."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"For emergency call or text"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Location sent to emergency services"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"This app accessed your device\'s location during a call or text to an emergency number. This can happen even when the app doesn\'t have location permission or the device location is off. "<a href="https://support.google.com/android/answer/9319337">"Learn more"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Check your phone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Couldn\'t reach your phone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Retry?"</string>
 </resources>
diff --git a/PermissionController/res/values-en-rCA-v35/strings.xml b/PermissionController/res/values-en-rCA-v35/strings.xml
new file mode 100644
index 000000000..c4b7df49d
--- /dev/null
+++ b/PermissionController/res/values-en-rCA-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Security"</string>
+</resources>
diff --git a/PermissionController/res/values-en-rCA/strings.xml b/PermissionController/res/values-en-rCA/strings.xml
index 972d1e409..bf9058a8c 100644
--- a/PermissionController/res/values-en-rCA/strings.xml
+++ b/PermissionController/res/values-en-rCA/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permissions"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancel"</string>
     <string name="back" msgid="6249950659061523680">"Back"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Close"</string>
     <string name="available" msgid="6007778121920339498">"Available"</string>
     <string name="blocked" msgid="9195547604866033708">"Blocked"</string>
     <string name="on" msgid="280241003226755921">"On"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"None"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(System default)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"No apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Other NFC services"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selected"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selected - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"special app access"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Accessed yesterday <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Accessed <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Your one time password is 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Allow restricted settings"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Restricted setting"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"For your security, this setting is currently unavailable."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"App was denied access to <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Permission request suppressed"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"This app is requesting additional permissions, but permissions can’t be granted in a streaming session. Grant the permission on your phone first."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"For emergency call or text"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Location sent to emergency services"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"This app accessed your device\'s location during a call or text to an emergency number. This can happen even when the app doesn\'t have location permission or the device location is off. "<a href="https://support.google.com/android/answer/9319337">"Learn more"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Check your phone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Couldn\'t reach your phone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Retry?"</string>
 </resources>
diff --git a/PermissionController/res/values-en-rGB-v35/strings.xml b/PermissionController/res/values-en-rGB-v35/strings.xml
new file mode 100644
index 000000000..c4b7df49d
--- /dev/null
+++ b/PermissionController/res/values-en-rGB-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Security"</string>
+</resources>
diff --git a/PermissionController/res/values-en-rGB/strings.xml b/PermissionController/res/values-en-rGB/strings.xml
index db98df25c..93508b04a 100644
--- a/PermissionController/res/values-en-rGB/strings.xml
+++ b/PermissionController/res/values-en-rGB/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permissions"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancel"</string>
     <string name="back" msgid="6249950659061523680">"Back"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Close"</string>
     <string name="available" msgid="6007778121920339498">"Available"</string>
     <string name="blocked" msgid="9195547604866033708">"Blocked"</string>
     <string name="on" msgid="280241003226755921">"On"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"None"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(System default)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"No apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Other NFC services"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selected"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selected – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"special app access"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Accessed yesterday <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Accessed <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Your one-time password is 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Allow restricted settings"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Restricted setting"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"For your security, this setting is currently unavailable."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"App was denied access to <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Permission request suppressed"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"This app is requesting additional permissions, but permissions can\'t be granted in a streaming session. Grant the permission on your phone first."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"For emergency call or text"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Location sent to emergency services"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"This app accessed your device\'s location during a call or text to an emergency number. This can happen even when the app doesn\'t have location permission or the device location is off. "<a href="https://support.google.com/android/answer/9319337">"Learn more"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Check your phone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Couldn\'t reach your phone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Retry?"</string>
 </resources>
diff --git a/PermissionController/res/values-en-rIN-v35/strings.xml b/PermissionController/res/values-en-rIN-v35/strings.xml
new file mode 100644
index 000000000..c4b7df49d
--- /dev/null
+++ b/PermissionController/res/values-en-rIN-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Security"</string>
+</resources>
diff --git a/PermissionController/res/values-en-rIN/strings.xml b/PermissionController/res/values-en-rIN/strings.xml
index db98df25c..93508b04a 100644
--- a/PermissionController/res/values-en-rIN/strings.xml
+++ b/PermissionController/res/values-en-rIN/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permissions"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancel"</string>
     <string name="back" msgid="6249950659061523680">"Back"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Close"</string>
     <string name="available" msgid="6007778121920339498">"Available"</string>
     <string name="blocked" msgid="9195547604866033708">"Blocked"</string>
     <string name="on" msgid="280241003226755921">"On"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"None"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(System default)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"No apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Other NFC services"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selected"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selected – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"special app access"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Accessed yesterday <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Accessed <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Your one-time password is 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Allow restricted settings"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Restricted setting"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"For your security, this setting is currently unavailable."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"App was denied access to <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Permission request suppressed"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"This app is requesting additional permissions, but permissions can\'t be granted in a streaming session. Grant the permission on your phone first."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"For emergency call or text"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Location sent to emergency services"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"This app accessed your device\'s location during a call or text to an emergency number. This can happen even when the app doesn\'t have location permission or the device location is off. "<a href="https://support.google.com/android/answer/9319337">"Learn more"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Check your phone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Couldn\'t reach your phone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Retry?"</string>
 </resources>
diff --git a/PermissionController/res/values-en-rXC-v35/strings.xml b/PermissionController/res/values-en-rXC-v35/strings.xml
new file mode 100644
index 000000000..642f2d7e1
--- /dev/null
+++ b/PermissionController/res/values-en-rXC-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‎‏‏‏‏‎‏‎‎‏‏‏‏‏‏‎‎‏‎‎‏‎‏‏‎‏‏‎‎‎‎‏‏‎‏‏‎‎‏‏‏‎‎‎‎‎‎‏‏‎‎‏‎‏‎‏‎‏‏‎‏‎‏‎Security‎‏‎‎‏‎"</string>
+</resources>
diff --git a/PermissionController/res/values-en-rXC/strings.xml b/PermissionController/res/values-en-rXC/strings.xml
index bd8edd323..33f7caeb9 100644
--- a/PermissionController/res/values-en-rXC/strings.xml
+++ b/PermissionController/res/values-en-rXC/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‎‏‏‎‎‎‎‏‏‎‏‏‎‏‎‏‎‎‏‏‎‎‏‎‏‎‎‎‏‏‎‎‏‏‏‏‎‎‏‎‏‏‏‏‏‎‎‎‏‏‏‎‏‏‏‎‎‏‎‏‏‏‏‎permissions‎‏‎‎‏‎"</string>
     <string name="cancel" msgid="8943320028373963831">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‏‏‏‎‎‎‎‎‏‏‏‎‏‎‎‎‎‏‏‏‎‎‎‏‎‏‏‏‎‏‎‎‏‏‎‏‏‏‏‎‏‏‏‎‏‏‏‎‏‎‏‎‎‎‎‏‏‎‏‏‏‎Cancel‎‏‎‎‏‎"</string>
     <string name="back" msgid="6249950659061523680">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‏‎‏‏‎‏‎‏‏‏‏‎‎‎‏‎‎‏‎‎‏‎‎‎‎‎‎‏‎‏‏‎‎‎‎‎‏‎‎‎‏‎‏‎‎‏‎‏‎‎‏‎‎‏‏‏‎‎‎‎‎‎Back‎‏‎‎‏‎"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‏‏‏‏‎‏‏‏‎‏‏‏‏‎‎‎‎‏‏‎‎‎‎‏‏‏‏‎‎‎‏‏‎‎‏‎‏‎‎‎‏‎‎‏‎‏‏‏‏‎‎‏‏‏‎‎‏‎‏‎‏‎Close‎‏‎‎‏‎"</string>
     <string name="available" msgid="6007778121920339498">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‏‎‎‏‏‎‏‎‏‏‏‏‏‏‏‏‎‏‎‏‎‎‏‎‏‏‏‏‏‎‎‎‎‏‏‏‎‎‏‏‎‏‏‎‎‏‏‎‏‏‏‏‎‎‎‏‎‏‎‏‎‎Available‎‏‎‎‏‎"</string>
     <string name="blocked" msgid="9195547604866033708">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‏‏‏‏‏‏‎‎‏‏‏‎‏‎‎‏‎‎‏‎‏‏‏‎‏‎‎‏‏‏‎‎‏‎‏‏‏‎‎‏‏‏‎‏‏‏‏‏‎‏‎‎‎‎‎‏‎‏‏‎‎‎Blocked‎‏‎‎‏‎"</string>
     <string name="on" msgid="280241003226755921">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‎‏‎‏‏‏‏‏‎‎‎‏‏‏‎‎‏‏‏‎‏‏‎‏‏‎‏‎‏‎‎‏‎‏‎‎‎‏‏‎‏‎‏‎‎‎‏‏‏‎‎‏‏‎‏‎‏‎‎‎‏‎On‎‏‎‎‏‎"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‏‏‏‏‎‎‎‎‏‎‎‏‎‏‏‏‏‎‏‎‎‎‏‎‏‏‏‏‎‏‏‏‎‎‏‏‏‏‎‎‎‎‏‏‎‏‏‏‎‏‏‎‏‏‎‎‏‏‎‎‏‎None‎‏‎‎‏‎"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‏‎‏‏‎‎‏‎‎‏‏‎‎‎‎‏‎‎‏‎‏‏‏‎‏‎‎‎‏‏‎‏‏‏‎‎‏‎‎‎‏‎‏‏‏‎‏‎‎‎‎‎‎‏‎‏‎‎‎‎‎‎(System default)‎‏‎‎‏‎"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‎‎‏‏‏‎‎‏‏‎‏‏‎‎‎‏‏‏‏‏‏‎‏‎‎‎‎‎‏‏‏‏‏‎‏‎‎‎‏‎‏‏‎‏‎‏‏‎‎‏‎‎‏‎‎‎‎‏‎‏‎No apps‎‏‎‎‏‎"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‏‎‎‏‎‏‎‏‎‏‏‎‏‏‏‎‎‎‏‎‎‎‏‏‎‎‎‎‎‎‎‎‎‎‎‎‏‎‎‎‏‏‏‏‏‎‎‏‎‏‏‎‎‎‏‎‎‎‏‎‏‎Other NFC services‎‏‎‎‏‎"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‎‏‎‏‏‎‎‏‎‏‎‏‎‏‏‏‏‏‏‏‎‎‎‎‎‏‏‎‎‎‎‏‏‏‏‏‏‏‏‎‏‏‎‎‎‎‏‎‎‎‏‏‏‏‏‎‎‏‏‏‎‎Selected‎‏‎‎‏‎"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‎‏‏‏‎‏‎‏‏‎‏‎‎‎‎‏‎‎‏‎‎‎‏‎‏‏‏‏‎‎‎‎‏‎‏‎‎‎‎‏‏‎‏‏‎‏‏‎‏‎‎‎‏‏‎‎‏‎‏‏‏‎‎‎Selected - ‎‏‎‎‏‏‎<xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>‎‏‎‎‏‏‏‎‎‏‎‎‏‎"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‎‏‏‏‏‎‏‏‏‏‎‎‎‏‎‏‎‎‎‎‏‎‎‏‏‏‎‏‏‎‏‏‏‏‏‎‏‎‎‏‏‎‎‎‎‏‏‎‏‎‏‎‎‏‏‎‎‎‎‏‎‎special app access‎‏‎‎‏‎"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‎‎‎‏‎‎‎‎‏‏‎‏‏‎‎‏‏‏‏‏‎‎‎‏‏‏‏‏‏‎‏‎‎‏‏‏‎‎‎‏‏‏‏‏‎‏‏‏‏‎‎‏‏‏‎‏‏‏‏‏‏‎Accessed yesterday ‎‏‎‎‏‏‎<xliff:g id="TIME_DATE">%1$s</xliff:g>‎‏‎‎‏‏‏‎‎‏‎‎‏‎"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‎‏‏‏‏‏‏‏‏‏‏‎‎‏‏‎‎‏‎‎‏‏‎‎‏‎‏‏‎‏‏‏‎‏‏‏‏‎‏‏‎‎‏‎‏‎‎‏‏‎‏‎‏‎‎‏‏‎‏‎‎‎‎‎Accessed ‎‏‎‎‏‏‎<xliff:g id="TIME_DATE_0">%1$s</xliff:g>‎‏‎‎‏‏‏‎ ‎‏‎‎‏‏‎<xliff:g id="TIME_DATE_1">%2$s</xliff:g>‎‏‎‎‏‏‏‎‎‏‎‎‏‎"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‎‏‎‎‎‏‏‏‎‎‏‏‏‎‏‎‏‏‎‏‏‎‎‎‎‎‏‎‎‎‏‏‏‎‎‏‎‎‏‏‏‎‎‎‏‏‏‎‏‏‎‎‏‎‏‏‏‏‏‏‎‎Your one time password is 132435‎‏‎‎‏‎"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‏‎‎‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‎‏‏‏‎‎‏‏‎‎‏‎‏‎‏‎‏‏‎‎‎‎‏‎‏‎‏‏‎‎‎‏‏‏‏‎‏‎‎‎‏‎Allow restricted settings‎‏‎‎‏‎"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‎‏‎‎‎‏‏‏‏‎‎‏‏‎‎‏‎‏‏‎‎‏‏‎‎‏‎‎‎‎‏‎‎‏‎‏‎‏‎‎‎‏‏‎‎‎‎‎‎‎‏‎‎‏‏‎‎‏‏‏‏‎Restricted setting‎‏‎‎‏‎"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‏‎‎‏‎‎‎‏‎‏‏‎‎‎‏‏‏‏‎‎‎‏‎‎‏‏‏‏‏‎‎‎‏‏‎‏‏‏‎‎‏‏‏‏‎‎‎‎‏‏‎‏‎‏‏‏‏‎‎‏‏‎For your security, this setting is currently unavailable.‎‏‎‎‏‎"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‎‏‏‏‏‎‏‏‏‎‏‎‎‏‏‎‏‎‎‏‎‏‏‏‏‎‎‏‏‎‎‏‎‎‏‏‏‏‎‏‎‏‏‏‎‎‏‏‎‏‎‏‎‏‏‎‎‏‏‏‎‏‎‎App was denied access to ‎‏‎‎‏‏‎<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>‎‏‎‎‏‏‏‎‎‏‎‎‏‎"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‏‎‏‏‎‏‏‎‎‏‏‎‎‏‎‎‎‏‏‏‎‏‎‏‎‎‎‏‎‏‏‎‎‏‏‎‎‏‏‏‏‎‎‎‎‎‏‎‏‏‎‎‏‎‎‎‏‎‏‎‎‎OK‎‏‎‎‏‎"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‏‏‎‏‏‏‎‎‏‎‏‎‏‏‏‎‎‎‏‎‏‏‎‎‎‎‏‎‏‏‏‏‎‎‎‏‎‏‎‎‎‏‎‏‎‎‎‎‎‏‎‏‎‏‏‎‎‎‎‎‏‎Permission request suppressed‎‏‎‎‏‎"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‎‎‏‎‏‏‏‎‏‎‎‎‎‏‏‏‎‎‎‎‏‏‎‎‏‎‏‏‏‎‎‎‏‏‎‏‏‏‎‏‏‏‎‏‏‏‎‎‎‏‎‎‏‎‏‏‎‎‎‏‏‏‎This app is requesting additional permissions, but permissions can’t be granted in a streaming session. Grant the permission on your phone first.‎‏‎‎‏‎"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‎‏‏‏‏‎‎‏‎‎‏‎‎‏‏‎‏‎‎‎‎‏‎‏‏‎‏‏‎‏‎‏‏‏‏‏‏‏‎‎‎‎‎‎‏‏‎‎‏‏‎‏‎‎‎‎‏‏‏‎‏‎For emergency call or text‎‏‎‎‏‎"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‎‎‏‎‏‏‏‏‎‎‏‎‏‎‏‏‎‏‎‎‏‏‎‏‏‎‏‏‎‎‏‏‏‎‏‎‎‎‏‏‎‎‎‏‏‎‏‏‎‎‏‏‏‏‏‎‏‎‎‏‏‏‎Location sent to emergency services‎‏‎‎‏‎"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‎‏‎‎‎‎‏‎‏‏‎‏‏‎‎‏‏‏‏‎‏‎‎‎‎‏‏‏‎‎‎‏‎‎‎‎‎‏‏‎‎‏‎‏‎‎‎‏‎‎‎‏‎‏‎‏‎‎‎‎‎‏‎This app accessed your device\'s location during a call or text to an emergency number. This can happen even when the app doesn\'t have location permission or the device location is off. ‎‏‎‎‏‏‎"<a href="https://support.google.com/android/answer/9319337">"‎‏‎‎‏‏‏‎Learn more‎‏‎‎‏‏‎"</a>"‎‏‎‎‏‏‏‎‎‏‎‎‏‎"</string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‎‏‏‏‎‎‏‏‎‏‏‎‏‏‏‏‏‏‎‏‎‏‏‏‎‎‏‏‎‎‏‎‎‎‎‎‏‎‎‎‏‎‏‏‎‏‏‏‏‏‎‏‎‎‎‏‎‏‏‎‎‎Check your phone‎‏‎‎‏‎"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‏‏‏‏‏‎‏‏‏‏‏‏‏‏‎‏‎‎‏‏‎‎‎‎‏‏‎‎‎‎‏‎‎‎‎‎‏‎‏‎‏‏‏‎‏‎‏‏‏‎‎‏‎‎‎‎‎‎‎‏‏‏‏‏‎Couldn\'t reach your phone‎‏‎‎‏‎"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"‎‏‎‎‎‎‎‏‎‏‏‏‎‎‎‎‎‎‏‎‎‏‎‎‎‎‏‏‏‏‏‏‎‏‎‎‏‏‏‎‏‎‏‏‎‎‏‎‎‏‏‎‏‎‏‎‎‎‏‏‏‏‎‏‎‎‎‎‎‏‎‏‏‎‏‏‎‏‎‏‎‎‎‎‏‎‏‏‎‎‎‎‎‏‏‎Retry?‎‏‎‎‏‎"</string>
 </resources>
diff --git a/PermissionController/res/values-es-rUS-v35/strings.xml b/PermissionController/res/values-es-rUS-v35/strings.xml
new file mode 100644
index 000000000..ecd01df78
--- /dev/null
+++ b/PermissionController/res/values-es-rUS-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Seguridad"</string>
+</resources>
diff --git a/PermissionController/res/values-es-rUS/strings.xml b/PermissionController/res/values-es-rUS/strings.xml
index 1e1b59d80..1247b2d3e 100644
--- a/PermissionController/res/values-es-rUS/strings.xml
+++ b/PermissionController/res/values-es-rUS/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permisos"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancelar"</string>
     <string name="back" msgid="6249950659061523680">"Atrás"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Cerrar"</string>
     <string name="available" msgid="6007778121920339498">"Disponible"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloqueado"</string>
     <string name="on" msgid="280241003226755921">"Activada"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ninguna"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Predeterminada del sistema)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Sin apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Otros servicios de NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Seleccionada"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Se seleccionó: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"Acceso especial de apps"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Último acceso: ayer a la(s) <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Último acceso: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> a la(s) <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Tu contraseña de un solo uso es 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Permitir configuración restringida"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Parámetro restringido"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Por seguridad, este parámetro de configuración no está disponible actualmente."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"A la app se le negó el acceso a <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Aceptar"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Se rechazó la solicitud de permiso"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Esta app solicita permisos adicionales, pero estos no se pueden otorgar durante una sesión de transmisión. Primero, otorga el permiso en el teléfono."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Para mensaje de texto o llamada de emergencia"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Ubicación enviada a servicios de emergencia"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Esta app accedió a la ubicación de tu dispositivo cuando hacías una llamada o enviabas un mensaje de texto a un número de emergencia. Esto puede suceder incluso si no se le otorgó a la app el permiso de ubicación o si la ubicación del dispositivo está desactivada. "<a href="https://support.google.com/android/answer/9319337">"Más información"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Revisa el teléfono"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"No se pudo establecer conexión con el teléfono"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"¿Quieres volver a intentarlo?"</string>
 </resources>
diff --git a/PermissionController/res/values-es-v35/strings.xml b/PermissionController/res/values-es-v35/strings.xml
new file mode 100644
index 000000000..ecd01df78
--- /dev/null
+++ b/PermissionController/res/values-es-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Seguridad"</string>
+</resources>
diff --git a/PermissionController/res/values-es/strings.xml b/PermissionController/res/values-es/strings.xml
index d0dbdf73e..402bd5214 100644
--- a/PermissionController/res/values-es/strings.xml
+++ b/PermissionController/res/values-es/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permisos"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancelar"</string>
     <string name="back" msgid="6249950659061523680">"Atrás"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Cerrar"</string>
     <string name="available" msgid="6007778121920339498">"Disponible"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloqueado"</string>
     <string name="on" msgid="280241003226755921">"Activado"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ninguna"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Predeterminado del sistema)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"No hay aplicaciones"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Otros servicios de NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Seleccionada"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Seleccionada: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"acceso especial de aplicaciones"</string>
@@ -582,7 +584,7 @@
     <string name="privacy_controls_qs" msgid="5780144882040591169">"Tus controles de privacidad"</string>
     <string name="security_settings_button_label_qs" msgid="8280343822465962330">"Más ajustes"</string>
     <string name="camera_toggle_label_qs" msgid="3880261453066157285">"Acceso a la cámara"</string>
-    <string name="microphone_toggle_label_qs" msgid="8132912469813396552">"Acceso al micrófono"</string>
+    <string name="microphone_toggle_label_qs" msgid="8132912469813396552">"Acceso a micro"</string>
     <string name="permissions_removed_qs" msgid="8957319130625294572">"Permiso retirado"</string>
     <string name="camera_usage_qs" msgid="4394233566086665994">"Ver el uso reciente de la cámara"</string>
     <string name="microphone_usage_qs" msgid="8527666682168170417">"Ver el uso reciente del micrófono"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Último acceso: ayer, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Último acceso: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Tu contraseña de un solo uso es 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Permitir ajustes restringidos"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ajuste restringido"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Por seguridad, este ajuste no está disponible actualmente."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Se ha denegado el acceso a <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> a la aplicación"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Aceptar"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Solicitud de permiso rechazada"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Esta aplicación está solicitando permisos adicionales, pero no se pueden dar durante una sesión de streaming. Da primero el permiso en tu teléfono."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Para llamadas o mensajes de emergencia"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Ubicación enviada a los servicios de emergencias"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Esta aplicación ha accedido a la ubicación de tu dispositivo mientras hacías una llamada o enviabas un mensaje al número de emergencia. Esto puede ocurrir aunque la aplicación no tenga el permiso de ubicación o la ubicación del dispositivo esté desactivada. "<a href="https://support.google.com/android/answer/9319337">"Más información"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Consulta tu teléfono"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"No se ha podido conectar con tu teléfono"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"¿Reintentar?"</string>
 </resources>
diff --git a/PermissionController/res/values-et-v35/strings.xml b/PermissionController/res/values-et-v35/strings.xml
new file mode 100644
index 000000000..3723766d0
--- /dev/null
+++ b/PermissionController/res/values-et-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Turvalisus"</string>
+</resources>
diff --git a/PermissionController/res/values-et/strings.xml b/PermissionController/res/values-et/strings.xml
index 42780598e..4d93ac4c0 100644
--- a/PermissionController/res/values-et/strings.xml
+++ b/PermissionController/res/values-et/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"load"</string>
     <string name="cancel" msgid="8943320028373963831">"Tühista"</string>
     <string name="back" msgid="6249950659061523680">"Tagasi"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Sule"</string>
     <string name="available" msgid="6007778121920339498">"Saadaval"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokeeritud"</string>
     <string name="on" msgid="280241003226755921">"Sees"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Puudub"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Süsteemi vaikeseade)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Rakendusi pole"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Muud NFC teenused"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Valitud"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Valitud – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"rakenduse erijuurdepääs"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Juurde pääsetud eile <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Juurde pääsetud <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Teie ühekordne parool on 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Piiratud seadete lubamine"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Piiratud seade"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Teie turvalisuse huvides pole see seade praegu saadaval."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Rakendusele ei antud luba <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Loataotlus peideti"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"See rakendus taotleb lisalube, kuid lube ei saa voogesituse seansis anda. Kõigepealt andke luba oma telefonile."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Hädaabikõne või hädaabinumbrile tekstsõnumi saatmise jaoks"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Asukoht saadeti hädaabiteenustele"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"See rakendus pääses hädaabinumbrile helistamise või sõnumi saatmise käigus juurde teie seadme asukohale. See võib juhtuda ka siis, kui rakendusel pole asukohale juurdepääsu luba või seadme asukoht on välja lülitatud. "<a href="https://support.google.com/android/answer/9319337">"Lisateave"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Kontrollige oma telefoni"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Teie telefoniga ei saanud ühendust"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Kas soovite uuesti proovida?"</string>
 </resources>
diff --git a/PermissionController/res/values-eu-v35/strings.xml b/PermissionController/res/values-eu-v35/strings.xml
new file mode 100644
index 000000000..63e64934c
--- /dev/null
+++ b/PermissionController/res/values-eu-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Segurtasuna"</string>
+</resources>
diff --git a/PermissionController/res/values-eu/strings.xml b/PermissionController/res/values-eu/strings.xml
index aa5ff3956..8160770ea 100644
--- a/PermissionController/res/values-eu/strings.xml
+++ b/PermissionController/res/values-eu/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"baimenak"</string>
     <string name="cancel" msgid="8943320028373963831">"Utzi"</string>
     <string name="back" msgid="6249950659061523680">"Atzera"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Itxi"</string>
     <string name="available" msgid="6007778121920339498">"Baimenduta"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokeatuta"</string>
     <string name="on" msgid="280241003226755921">"Aktibatuta"</string>
@@ -249,7 +250,7 @@
     <string name="app_permission_most_recent_denied_summary" msgid="7659497197737708112">"Une honetan ukatuta / Azken sarbide-data: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="app_permission_never_accessed_summary" msgid="401346181461975090">"Ez da erabili inoiz"</string>
     <string name="app_permission_never_accessed_denied_summary" msgid="6596000497490905146">"Ukatuta / Ez da erabili inoiz"</string>
-    <string name="allowed_header" msgid="7769277978004790414">"Baimenduta"</string>
+    <string name="allowed_header" msgid="7769277978004790414">"Baimendutakoak"</string>
     <string name="allowed_always_header" msgid="6455903312589013545">"Beti baimendutakoak"</string>
     <string name="allowed_foreground_header" msgid="6845655788447833353">"Erabili bitartean soilik baimendutakoak"</string>
     <string name="allowed_storage_scoped" msgid="5383645873719086975">"Multimedia-fitx. soilik erabiltzeko baimena dutenak"</string>
@@ -358,7 +359,7 @@
     <string name="role_browser_label" msgid="2877796144554070207">"Arakatzaile lehenetsia"</string>
     <string name="role_browser_short_label" msgid="6745009127123292296">"Arakatzaile-aplikazioa"</string>
     <string name="role_browser_description" msgid="3465253637499842671">"Interneteko sarbidea ematen dizuten eta sakatzen dituzun estekak bistaratzen dituzten aplikazioak"</string>
-    <string name="role_browser_request_title" msgid="2895200507835937192">"<xliff:g id="APP_NAME">%1$s</xliff:g> ezarri nahi duzu arakatzaile-aplikazio lehenetsi gisa?"</string>
+    <string name="role_browser_request_title" msgid="2895200507835937192">"<xliff:g id="APP_NAME">%1$s</xliff:g> ezarri nahi duzu arakatzaile lehenetsi gisa?"</string>
     <string name="role_browser_request_description" msgid="5888803407905985941">"Ez du behar baimenik"</string>
     <string name="role_dialer_label" msgid="1100224146343237968">"Telefono lehenetsia"</string>
     <string name="role_dialer_short_label" msgid="7186888549465352489">"Telefonoa aplikazioa"</string>
@@ -422,7 +423,7 @@
     <string name="system_uses_camera" msgid="1911223105234441470">"Sistemaren zerbitzu bat kamera erabiltzen ari da"</string>
     <string name="other_use" msgid="6564855051022776692">"Besta erabilera bat:"</string>
     <string name="ongoing_usage_dialog_ok" msgid="103556809118460072">"Ados"</string>
-    <string name="ongoing_usage_dialog_title" msgid="683836493556628569">"<xliff:g id="TYPES_LIST">%s</xliff:g> erabilitako azken aplikazioak"</string>
+    <string name="ongoing_usage_dialog_title" msgid="683836493556628569">"Azkenaldian <xliff:g id="TYPES_LIST">%s</xliff:g> erabilitako aplikazioak"</string>
     <string name="ongoing_usage_dialog_title_mic" msgid="5966714811125593992">"Mikrofonoa duela gutxi erabili dutenak"</string>
     <string name="ongoing_usage_dialog_title_camera" msgid="7819329688650711470">"Kamera duela gutxi erabili dutenak"</string>
     <string name="ongoing_usage_dialog_title_mic_camera" msgid="9079747867228772797">"Mikrofonoa eta kamera duela gutxi erabili dituztenak"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Bat ere ez"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(sistemaren aplikazio lehenetsia)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Ez dago aplikaziorik"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"NFC bidezko beste zerbitzu batzuk"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Hautatuta"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Hautatuta - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"aplikazio-baimen bereziak"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Atzo atzitu zen (<xliff:g id="TIME_DATE">%1$s</xliff:g>)"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Atzitze-data: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> (<xliff:g id="TIME_DATE_1">%2$s</xliff:g>)"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Zure erabilera bakarreko pasahitza 132435 da"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Eman ezarpen mugatuak erabiltzeko baimena"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Murriztapenak ditu ezarpenak"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Zure segurtasuna bermatzeko, ezarpena ez dago erabilgarri une honetan."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikazioari <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> erabiltzeko baimena ukatu zaio"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Ados"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Blokeatu da baimen-eskaera"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Baimen gehigarriak eskatzen ari da aplikazioa, baina ezin da eman baimenik igorpen-saioetan. Lehenik eta behin, eman baimena telefonoan."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Larrialdi-deiak egitean edo larrialdietarako testu-mezuak bidaltzean"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Kokapena larrialdi-zerbitzuei bidali zaie"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Aplikazioak gailuaren kokapena atzitu du larrialdietarako zenbaki batera dei bat egin edo testu-mezu bat bidali duzun bitartean. Baliteke aplikazioak kokapena erabiltzeko baimena ez izan edo gailuaren kokapena desaktibatuta egon arren gertatzea hori. "<a href="https://support.google.com/android/answer/9319337">"Lortu informazio gehiago"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Begiratu telefonoan"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Ezin izan da konektatu telefonora"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Berriro saiatu nahi duzu?"</string>
 </resources>
diff --git a/PermissionController/res/values-fa-v35/strings.xml b/PermissionController/res/values-fa-v35/strings.xml
new file mode 100644
index 000000000..5bc65a09d
--- /dev/null
+++ b/PermissionController/res/values-fa-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"امنیت"</string>
+</resources>
diff --git a/PermissionController/res/values-fa/strings.xml b/PermissionController/res/values-fa/strings.xml
index d86c9aade..4ed186f3e 100644
--- a/PermissionController/res/values-fa/strings.xml
+++ b/PermissionController/res/values-fa/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"اجازه‌ها"</string>
     <string name="cancel" msgid="8943320028373963831">"لغو"</string>
     <string name="back" msgid="6249950659061523680">"برگشت"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"بستن"</string>
     <string name="available" msgid="6007778121920339498">"دردسترس"</string>
     <string name="blocked" msgid="9195547604866033708">"مسدود"</string>
     <string name="on" msgid="280241003226755921">"روشن"</string>
@@ -249,7 +250,7 @@
     <string name="app_permission_most_recent_denied_summary" msgid="7659497197737708112">"درحال‌حاضر رد شده است / آخرین دسترسی: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="app_permission_never_accessed_summary" msgid="401346181461975090">"هرگز دسترسی نداشته است"</string>
     <string name="app_permission_never_accessed_denied_summary" msgid="6596000497490905146">"غیرمجاز / هرگز دسترسی نداشته است"</string>
-    <string name="allowed_header" msgid="7769277978004790414">"مجاز است"</string>
+    <string name="allowed_header" msgid="7769277978004790414">"مجاز بودن"</string>
     <string name="allowed_always_header" msgid="6455903312589013545">"همیشه مجاز بودن"</string>
     <string name="allowed_foreground_header" msgid="6845655788447833353">"مجاز فقط هنگام استفاده"</string>
     <string name="allowed_storage_scoped" msgid="5383645873719086975">"مجاز فقط برای دسترسی به رسانه‌ها"</string>
@@ -345,7 +346,7 @@
     <string name="no_apps_allowed" msgid="7718822655254468631">"برنامه‌ای مجاز نشده"</string>
     <string name="no_apps_allowed_full" msgid="8011716991498934104">"برنامه‌ای برای همه فایل‌ها مجاز نشده"</string>
     <string name="no_apps_allowed_scoped" msgid="4908850477787659501">"برنامه‌ای برای فقط رسانه مجاز نشده"</string>
-    <string name="no_apps_denied" msgid="7663435886986784743">"برنامه‌ای غیرمجاز نشده"</string>
+    <string name="no_apps_denied" msgid="7663435886986784743">"برنامه‌ای رد نشده"</string>
     <string name="car_permission_selected" msgid="180837028920791596">"انتخاب‌شده"</string>
     <string name="settings" msgid="5409109923158713323">"تنظیمات"</string>
     <string name="accessibility_service_dialog_title_single" msgid="7956432823014102366">"<xliff:g id="SERVICE_NAME">%s</xliff:g> سرویس به دستگاه شما دسترسی کامل دارند"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"هیچ‌کدام"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(پیش‌فرض سیستم)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"برنامه‌ای موجود نیست"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"‏دیگر سرویس‌های NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"انتخاب شد"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"انتخاب‌شده - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"دسترسی ویژه برنامه"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"دسترسی در روز گذشته ساعت <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"دسترسی در <xliff:g id="TIME_DATE_0">%1$s</xliff:g> ساعت <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"گذرواژه یکبارمصرف شما 132435 است"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"مجاز کردن تنظیمات محدودشده"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"تنظیم محدودشده"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"برای حفظ امنیت شما، درحال‌حاضر این تنظیم دردسترس نیست."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"درخواست برنامه برای دسترسی به <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> رد شد"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"بسیارخوب"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"درخواست اجازه رد شد"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"این برنامه درخواست اجازه‌های اضافی دارد، اما امکان دادن این اجازه‌ها در جلسه جاری‌سازی وجود ندارد. ابتدا اجازه را در تلفنتان اعطا کنید."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"برای تماس یا پیامک اضطراری"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"مکان به خدمات اضطراری ارسال شد"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"این برنامه درحین تماس با شماره تلفن اضطراری یا ارسال پیامک به آن به مکان دستگاهتان دسترسی پیدا کرده است. حتی زمانی‌که برنامه اجازه مکان ندارد یا مکان دستگاه خاموش است، ممکن است این اتفاق رخ دهد. "<a href="https://support.google.com/android/answer/9319337">"بیشتر بدانید"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"بررسی تلفن"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"ارتباط با تلفن برقرار نشد"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"مجدداً امتحان می‌کنید؟"</string>
 </resources>
diff --git a/PermissionController/res/values-fi-v35/strings.xml b/PermissionController/res/values-fi-v35/strings.xml
new file mode 100644
index 000000000..a1c8d62d4
--- /dev/null
+++ b/PermissionController/res/values-fi-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Suojaus"</string>
+</resources>
diff --git a/PermissionController/res/values-fi/strings.xml b/PermissionController/res/values-fi/strings.xml
index b1bcb5479..e47b603d3 100644
--- a/PermissionController/res/values-fi/strings.xml
+++ b/PermissionController/res/values-fi/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"käyttöoikeudet"</string>
     <string name="cancel" msgid="8943320028373963831">"Peru"</string>
     <string name="back" msgid="6249950659061523680">"Takaisin"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Sulje"</string>
     <string name="available" msgid="6007778121920339498">"Käytettävissä"</string>
     <string name="blocked" msgid="9195547604866033708">"Estetty"</string>
     <string name="on" msgid="280241003226755921">"Päällä"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ei mitään"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Järjestelmän oletusarvo)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Ei sovelluksia"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Muut NFC-palvelut"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Valittu"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Valittu – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"sovellusten erikoiskäyttö"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Avattu eilen klo <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Avattu <xliff:g id="TIME_DATE_0">%1$s</xliff:g> klo <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Kertakäyttöinen salasanasi on 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Salli rajoitetut asetukset"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Rajoitettu asetus"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Asetus ei ole tällä hetkellä käytettävissä turvallisuussyistä."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Sovellukselta on evätty pääsy: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Lupapyyntö estetty"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Sovellus pyytää lisälupia, mutta lupia ei voi myöntää striimatessa. Myönnä lupa ensin puhelimella."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Soitto tai tekstiviesti hätäkeskukselle"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Sijainti lähetetty hätäkeskukselle"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Tämä sovellus sai pääsyn laitteen sijaintiin, kun soitit tai lähetit tekstiviestin hätänumeroon. Tämä voi tapahtua, vaikka sovelluksella ei olisi sijaintilupaa tai laitteen sijainti olisi pois päältä. "<a href="https://support.google.com/android/answer/9319337">"Lue lisää"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Tarkista puhelimesi"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Puhelimeesi ei saatu yhteyttä"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Yritetäänkö uudelleen?"</string>
 </resources>
diff --git a/PermissionController/res/values-fr-rCA-v35/strings.xml b/PermissionController/res/values-fr-rCA-v35/strings.xml
new file mode 100644
index 000000000..9a88205ed
--- /dev/null
+++ b/PermissionController/res/values-fr-rCA-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sécurité"</string>
+</resources>
diff --git a/PermissionController/res/values-fr-rCA/strings.xml b/PermissionController/res/values-fr-rCA/strings.xml
index 542303ebb..31b6bdbec 100644
--- a/PermissionController/res/values-fr-rCA/strings.xml
+++ b/PermissionController/res/values-fr-rCA/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"autorisations"</string>
     <string name="cancel" msgid="8943320028373963831">"Annuler"</string>
     <string name="back" msgid="6249950659061523680">"Retour"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Fermer"</string>
     <string name="available" msgid="6007778121920339498">"Accessible"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloqué"</string>
     <string name="on" msgid="280241003226755921">"Activé"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Aucune"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Paramètre(s) système par défaut)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Aucune appli"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Autres services CCP"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Sélectionnée"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Sélectionnée – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"accès spécial des applis"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Accès hier (<xliff:g id="TIME_DATE">%1$s</xliff:g>)"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Accès : <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Votre mot de passe à usage unique est le suivant : 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Autoriser les paramètres restreints"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Paramètre restreint"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Pour protéger votre sécurité, ce paramètre n\'est pas accessible actuellement."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"L\'appli n\'a pas obtenu l\'accès à <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Demande d\'autorisation supprimée"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Cette appli demande des autorisations supplémentaires, mais celles-ci ne peuvent pas être accordées lors d\'une session de diffusion en continu. Accordez d\'abord l\'autorisation de votre téléphone."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Pour un appel ou un message texte d\'urgence"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Position envoyée aux services d\'urgence"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Cette appli a accédé à la position de votre appareil lors d\'un appel ou de l\'envoi d\'un message texte à un numéro d\'urgence. Cela peut se produire même si l\'appli ne dispose pas de l\'autorisation de localisation ou si la localisation de l\'appareil est désactivée. "<a href="https://support.google.com/android/answer/9319337">"En savoir plus"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Vérifiez votre téléphone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Impossible de joindre votre téléphone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Réessayer?"</string>
 </resources>
diff --git a/PermissionController/res/values-fr-v35/strings.xml b/PermissionController/res/values-fr-v35/strings.xml
new file mode 100644
index 000000000..9a88205ed
--- /dev/null
+++ b/PermissionController/res/values-fr-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sécurité"</string>
+</resources>
diff --git a/PermissionController/res/values-fr/strings.xml b/PermissionController/res/values-fr/strings.xml
index 8602cc8c8..2ea77b4f4 100644
--- a/PermissionController/res/values-fr/strings.xml
+++ b/PermissionController/res/values-fr/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"autorisations"</string>
     <string name="cancel" msgid="8943320028373963831">"Annuler"</string>
     <string name="back" msgid="6249950659061523680">"Retour"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Fermer"</string>
     <string name="available" msgid="6007778121920339498">"Disponible"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloqué"</string>
     <string name="on" msgid="280241003226755921">"Activé"</string>
@@ -368,7 +369,7 @@
     <string name="role_dialer_search_keywords" msgid="3324448983559188087">"clavier"</string>
     <string name="role_sms_label" msgid="8456999857547686640">"Appli de SMS par défaut"</string>
     <string name="role_sms_short_label" msgid="4371444488034692243">"Appli de SMS"</string>
-    <string name="role_sms_description" msgid="3424020199148153513">"Applications qui vous permettent d\'utiliser votre numéro de téléphone pour envoyer et recevoir des SMS, des photos, des vidéos et plus encore"</string>
+    <string name="role_sms_description" msgid="3424020199148153513">"Applications qui vous permettent d\'utiliser votre numéro de téléphone pour envoyer et recevoir des messages, des photos, des vidéos et plus encore"</string>
     <string name="role_sms_request_title" msgid="7953552109601185602">"Définir <xliff:g id="APP_NAME">%1$s</xliff:g> comme application par défaut pour les SMS ?"</string>
     <string name="role_sms_request_description" msgid="2691004766132144886">"Cette appli aura accès à votre appareil photo, vos contacts, vos fichiers et contenus multimédias, votre micro, votre téléphone et vos SMS"</string>
     <string name="role_sms_search_keywords" msgid="8022048144395047352">"SMS, envoyer un SMS, messages, message"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Aucune"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Application système par défaut)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Aucune application"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Autres services NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Sélectionnée"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Sélectionnée – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"accès spéciaux des applis"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Dernière consultation : hier, à <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Dernière consultation : <xliff:g id="TIME_DATE_0">%1$s</xliff:g><xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Votre mot de passe à usage unique est le suivant : 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Autoriser les paramètres restreints"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Paramètre restreint"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Pour votre sécurité, ce paramètre est actuellement indisponible."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"L\'appli s\'est vu refuser l\'accès à <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Demande d\'autorisation supprimée"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Cette appli demande des autorisations supplémentaires, mais il est impossible d\'accorder des autorisations lors d\'une session de streaming. Accordez tout d\'abord l\'autorisation sur votre téléphone."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Pour les messages ou les appels d\'urgence"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Position envoyée aux services d\'urgence"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Cette application a accédé à la position de votre appareil lors d\'un appel ou de l\'envoi d\'un message vers un numéro d\'urgence. Cela peut se produire même si l\'application ne dispose pas de l\'autorisation d\'accéder à la position ou lorsque la position de l\'appareil est désactivée. "<a href="https://support.google.com/android/answer/9319337">"En savoir plus"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Vérifier votre téléphone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Impossible de se connecter à votre téléphone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Réessayer ?"</string>
 </resources>
diff --git a/PermissionController/res/values-gl-v35/strings.xml b/PermissionController/res/values-gl-v35/strings.xml
new file mode 100644
index 000000000..54a03138f
--- /dev/null
+++ b/PermissionController/res/values-gl-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Seguranza"</string>
+</resources>
diff --git a/PermissionController/res/values-gl/strings.xml b/PermissionController/res/values-gl/strings.xml
index 7124ed4fd..8ceeab1a6 100644
--- a/PermissionController/res/values-gl/strings.xml
+++ b/PermissionController/res/values-gl/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permisos"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancelar"</string>
     <string name="back" msgid="6249950659061523680">"Atrás"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Pechar"</string>
     <string name="available" msgid="6007778121920339498">"Dispoñible"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloqueado"</string>
     <string name="on" msgid="280241003226755921">"Activado"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ningunha"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Opción predeterminada do sistema)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Non hai ningunha aplicación"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Outros servizos NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Aplicación seleccionada"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Aplicación seleccionada (<xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>)"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"acceso especial das aplicacións"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Último acceso: onte, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Último acceso: <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"O teu contrasinal dun só uso é 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Permitir opcións restrinxidas"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Opción de configuración restrinxida"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Pola túa seguranza, esta opción de configuración non está dispoñible nestes momentos."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Denegóuselle á aplicación o acceso ao permiso: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Aceptar"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Eliminouse a solicitude de permiso"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Esta aplicación solicita permisos adicionais, pero non se poden conceder nunha sesión de reprodución en tempo real. Primeiro tes que dar o permiso no teu teléfono."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Para mensaxes de texto ou chamadas de emerxencia"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Enviouse a localización aos servizos de emerxencia"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Esta aplicación accedeu á localización do teu dispositivo mentres facías unha chamada ou enviabas unha mensaxe de texto a un número de emerxencia. Isto pode ocorrer mesmo se a aplicación non ten permiso de acceso á localización ou a localización do dispositivo está desactivada. "<a href="https://support.google.com/android/answer/9319337">"Máis información"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Consulta o teléfono"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Non se puido establecer conexión co teléfono"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Queres tentalo de novo?"</string>
 </resources>
diff --git a/PermissionController/res/values-gu-v35/strings.xml b/PermissionController/res/values-gu-v35/strings.xml
new file mode 100644
index 000000000..60eb21111
--- /dev/null
+++ b/PermissionController/res/values-gu-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"સુરક્ષા"</string>
+</resources>
diff --git a/PermissionController/res/values-gu/strings.xml b/PermissionController/res/values-gu/strings.xml
index 6a5885f28..b65a5c582 100644
--- a/PermissionController/res/values-gu/strings.xml
+++ b/PermissionController/res/values-gu/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"પરવાનગીઓ"</string>
     <string name="cancel" msgid="8943320028373963831">"રદ કરો"</string>
     <string name="back" msgid="6249950659061523680">"પાછળ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"બંધ કરો"</string>
     <string name="available" msgid="6007778121920339498">"ઉપલબ્ધ છે"</string>
     <string name="blocked" msgid="9195547604866033708">"બ્લૉક કરેલો છે"</string>
     <string name="on" msgid="280241003226755921">"ચાલુ છે"</string>
@@ -371,7 +372,7 @@
     <string name="role_sms_description" msgid="3424020199148153513">"ઍપ કે જે તમને તમારા ફોન નંબરનો ઉપયોગ કરીને નાના ટેક્સ્ટ મેસેજ, ફોટા, વીડિયો અને ઘણું બધું મોકલવા અને પ્રાપ્ત કરવાની મંજૂરી આપે છે"</string>
     <string name="role_sms_request_title" msgid="7953552109601185602">"<xliff:g id="APP_NAME">%1$s</xliff:g>ને તમારી ડિફૉલ્ટ SMS ઍપ તરીકે સેટ કરીએ?"</string>
     <string name="role_sms_request_description" msgid="2691004766132144886">"આ ઍપને તમારા કૅમેરા, સંપર્કો, ફાઇલો અને મીડિયા, માઇક્રોફોન, ફોન અને SMSનો ઍક્સેસ આપવામાં આવશે."</string>
-    <string name="role_sms_search_keywords" msgid="8022048144395047352">"ટેક્સ્ટ સંદેશ, ટેક્સ્ટિંગ, સંદેશા, મેસેજિંગ"</string>
+    <string name="role_sms_search_keywords" msgid="8022048144395047352">"ટેક્સ્ટ મેસેજ, ટેક્સ્ટિંગ, મેસેજ, મેસેજિંગ"</string>
     <string name="role_emergency_label" msgid="7028825857206842366">"ડિફૉલ્ટ ઇમર્જન્સી ઍપ"</string>
     <string name="role_emergency_short_label" msgid="2388431453335350348">"ઇમર્જન્સી ઍપ"</string>
     <string name="role_emergency_description" msgid="5051840234887686630">"ઍપ કે જે તમને તમારી તબીબી માહિતી રેકોર્ડ કરીને ઇમર્જન્સી દરમિયાન ઍક્સેસ કરવાની; હવામાનની ગંભીર ઘટનાઓ અને દુર્ઘટનાઓ વિશે ચેતવણી મેળવવાની અને તમને સહાયની જરૂર હોય ત્યારે બીજા લોકોને તે વિશે સૂચિત કરવાની મંજૂરી આપે છે"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"કોઈ નહીં"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(સિસ્ટમ ડિફૉલ્ટ)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"કોઈ ઍપ નથી"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"અન્ય NFC સેવાઓ"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"પસંદ કરેલ"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"પસંદ કરેલ - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"વિશેષ ઍપનો ઍક્સેસ"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"ઍક્સેસ કર્યાનો સમય ગઈકાલે <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"ઍક્સેસ કર્યાનો સમય <xliff:g id="TIME_DATE_0">%1$s</xliff:g>ના રોજ <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"તમારો એક-વખત વપરાશનો પાસવર્ડ 132435 છે"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"પ્રતિબંધિત સેટિંગને મંજૂરી આપો"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"પ્રતિબંધિત સેટિંગ"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"તમારી સુરક્ષા માટે, આ સેટિંગ હાલમાં ઉપલબ્ધ નથી."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"ઍપને <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>નો ઍક્સેસ નકારવામાં આવ્યો"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ઓકે"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"પરવાનગીની વિનંતી નકારવામાં આવી"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"આ ઍપ વધારાની પરવાનગીઓની વિનંતી કરી રહી છે પણ સ્ટ્રીમિંગ સત્રમાં પરવાનગીઓને મંજૂરી આપી શકાતી નથી. પહેલા તમારા ફોન પર પરવાનગીની મંજૂરી આપો."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"ઇમર્જન્સી કૉલ કે ટેક્સ્ટ માટે"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ઇમર્જન્સી સર્વિસને મોકલવામાં આવેલું લોકેશન"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"કોઈ ઇમર્જન્સી નંબરને કૉલ કે ટેક્સ્ટ કરવા દરમિયાન આ ઍપ દ્વારા તમારા ડિવાઇસના લોકેશનને ઍક્સેસ કરવામાં આવ્યું. ઍપને લોકેશનની પરવાનગી ન હોય કે ડિવાઇસનું લોકેશન સેટિંગ બંધ કરેલું હોય, ત્યારે પણ આમ થઈ શકે છે. "<a href="https://support.google.com/android/answer/9319337">"વધુ જાણો"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"તમારો ફોન ચેક કરો"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"તમારા ફોન સુધી પહોંચી શકાયું નથી"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"ફરી પ્રયાસ કરીએ?"</string>
 </resources>
diff --git a/PermissionController/res/values-hi-v35/strings.xml b/PermissionController/res/values-hi-v35/strings.xml
new file mode 100644
index 000000000..3d8a7dedf
--- /dev/null
+++ b/PermissionController/res/values-hi-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"सुरक्षा"</string>
+</resources>
diff --git a/PermissionController/res/values-hi/strings.xml b/PermissionController/res/values-hi/strings.xml
index eb95fb9ba..c464a3a90 100644
--- a/PermissionController/res/values-hi/strings.xml
+++ b/PermissionController/res/values-hi/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"अनुमतियां"</string>
     <string name="cancel" msgid="8943320028373963831">"रद्द करें"</string>
     <string name="back" msgid="6249950659061523680">"वापस जाएं"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"बंद करें"</string>
     <string name="available" msgid="6007778121920339498">"उपलब्ध है"</string>
     <string name="blocked" msgid="9195547604866033708">"ब्लॉक किया गया"</string>
     <string name="on" msgid="280241003226755921">"चालू है"</string>
@@ -73,7 +74,7 @@
     <string name="days_ago" msgid="6650359081551335629">"{count,plural, =0{आज}=1{1 दिन पहले}one{# दिन पहले}other{# दिन पहले}}"</string>
     <string name="app_disable_dlg_positive" msgid="7418444149981904940">"ऐप्लिकेशन बंद करें"</string>
     <string name="app_disable_dlg_text" msgid="3126943217146120240">"अगर आप इस ऐप्लिकेशन को बंद कर देते हैं, तो हो सकता है कि Android और दूसरे ऐप्लिकेशन ठीक से काम न करें. ध्यान रखें कि आप इस ऐप्लिकेशन को मिटा नहीं सकते, क्योंकि यह आपके डिवाइस पर पहले से इंस्टॉल होकर आया है. इसे बंद करने पर ऐप्लिकेशन बंद हो जाएगा और आपके डिवाइस पर नहीं दिखेगा."</string>
-    <string name="app_permission_manager" msgid="3903811137630909550">"अनुमतियों को मैनेज करना"</string>
+    <string name="app_permission_manager" msgid="3903811137630909550">"अनुमतियों को मैनेज करें"</string>
     <string name="never_ask_again" msgid="4728762438198560329">"दोबारा न पूछें"</string>
     <string name="no_permissions" msgid="3881676756371148563">"किसी अनुमति की ज़रूरत नहीं है"</string>
     <string name="additional_permissions" msgid="5801285469338873430">"दूसरी अनुमतियां"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"कोई नहीं"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(सिस्टम डिफ़ॉल्ट)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"कोई ऐप्लिकेशन नहीं"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"अन्य एनएफ़सी सेवाएं"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"चुना हुआ"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"<xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g> - चुना गया"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ऐप्लिकेशन को खास अनुमति"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"<xliff:g id="TIME_DATE">%1$s</xliff:g> को कल ऐक्सेस किया गया था"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g> को ऐक्सेस किया गया"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"एक बार इस्तेमाल होने वाला पासवर्ड 132435 है"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"पाबंदी वाली सेटिंग को अनुमति दें"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"इस सेटिंग पर पाबंदी लगाई गई है"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"आपकी सुरक्षा के लिए, यह सेटिंग फ़िलहाल उपलब्ध नहीं है."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"ऐप्लिकेशन को, <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> को ऐक्सेस करने की अनुमति नहीं मिली"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ठीक है"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"अनुमति का अनुरोध अस्वीकार किया गया"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"यह ऐप्लिकेशन ज़्यादा अनुमतियों का अनुरोध कर रहा है. हालांकि, स्ट्रीमिंग सेशन के दौरान अनुमतियां नहीं दी जा सकतीं. सबसे पहले अपने फ़ोन पर अनुमति दें."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"आपातकालीन कॉल या मैसेज करने के लिए"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"आपातकालीन सेवाओं को जगह की जानकारी भेजी गई"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"ऐसा हो सकता है कि किसी आपातकालीन नंबर पर कॉल या मैसेज करने के दौरान, ऐप्लिकेशन ने आपके डिवाइस की जगह की जानकारी ऐक्सेस कर ली हो. ऐप्लिकेशन के पास जगह की जानकारी ऐक्सेस करने की अनुमति न होने या डिवाइस की जगह की जानकारी की सेटिंग बंद होने पर भी, ऐप्लिकेशन ऐसा कर सकता है. "<a href="https://support.google.com/android/answer/9319337">"ज़्यादा जानें"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"अपना फ़ोन देखें"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"आपके फ़ोन से कनेक्ट नहीं किया जा सका"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"फिर से कोशिश करें?"</string>
 </resources>
diff --git a/PermissionController/res/values-hr-v35/strings.xml b/PermissionController/res/values-hr-v35/strings.xml
new file mode 100644
index 000000000..71b83b6c9
--- /dev/null
+++ b/PermissionController/res/values-hr-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sigurnost"</string>
+</resources>
diff --git a/PermissionController/res/values-hr/strings.xml b/PermissionController/res/values-hr/strings.xml
index 0944aa5a8..55cfcfa78 100644
--- a/PermissionController/res/values-hr/strings.xml
+++ b/PermissionController/res/values-hr/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"dopuštenja"</string>
     <string name="cancel" msgid="8943320028373963831">"Odustani"</string>
     <string name="back" msgid="6249950659061523680">"Natrag"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Zatvori"</string>
     <string name="available" msgid="6007778121920339498">"Dostupno"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokirano"</string>
     <string name="on" msgid="280241003226755921">"Uključeno"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nijedna"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Zadana postavka sustava)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nema aplikacija"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Ostale NFC usluge"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Odabrano"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Odabrano – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"poseban pristup za aplikacije"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Pristupljeno jučer: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Pristupljeno: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Vaša jednokratna zaporka je 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Dopusti ograničene postavke"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ograničena postavka"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Radi vaše sigurnosti ova postavka trenutačno nije dostupna."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikaciji je odbijen pristup dopuštenju <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"U redu"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Upit za dopuštenje je spriječen"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Aplikacija zahtijeva dodatna dopuštenja, no dopuštenja se ne mogu odobriti u sesiji streaminga. Dopuštenje najprije odobrite na telefonu."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Za pozive ili poruke hitnim službama"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Lokacija poslana hitnim službama"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Ova je aplikacija pristupila lokaciji vašeg uređaja prilikom upućivanja poziva ili poruke na broj hitne službe. To se može dogoditi čak i kad aplikacija nema dopuštenje za lokaciju ili je lokacija uređaja isključena. "<a href="https://support.google.com/android/answer/9319337">"Saznajte više"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Provjerite telefon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Nije moguće dohvatiti telefon"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Želite li pokušati ponovo?"</string>
 </resources>
diff --git a/PermissionController/res/values-hu-v35/strings.xml b/PermissionController/res/values-hu-v35/strings.xml
new file mode 100644
index 000000000..b0ef5cfc4
--- /dev/null
+++ b/PermissionController/res/values-hu-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Biztonság"</string>
+</resources>
diff --git a/PermissionController/res/values-hu/strings.xml b/PermissionController/res/values-hu/strings.xml
index 8935dc8e2..32bfb9660 100644
--- a/PermissionController/res/values-hu/strings.xml
+++ b/PermissionController/res/values-hu/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"engedélyek"</string>
     <string name="cancel" msgid="8943320028373963831">"Mégse"</string>
     <string name="back" msgid="6249950659061523680">"Vissza"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Bezárás"</string>
     <string name="available" msgid="6007778121920339498">"Rendelkezésre áll"</string>
     <string name="blocked" msgid="9195547604866033708">"Letiltva"</string>
     <string name="on" msgid="280241003226755921">"Be"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nincs"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Alapértelmezett)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nincs alkalmazás"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Egyéb NFC-szolgáltatások"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Kiválasztva"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Kiválasztva – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"különleges alkalmazás-hozzáférés"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Hozzáférés: tegnap, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Hozzáférés: <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Az Ön egyszer használatos jelszava: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Korlátozott beállítások engedélyezése"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Korlátozott beállítás"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Biztonsága érdekében ez a beállítás jelenleg nem használható."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Az app nem kapott hozzáférést a következőhöz: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Engedélykérés letiltva"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Ez az alkalmazás további engedélyeket kér, de az engedélyeket nem lehet megadni streamelési munkamenetben. Előbb adja meg az engedélyeket a telefonján."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"A segélyhívó szám felhívásakor vagy a segélyhívó számra való üzenetküldéskor"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"A helyadatok el lettek küldve a segélyhívó szolgálatnak"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Az alkalmazás hozzáfért az eszköze helyadataihoz a segélyhívó szám felhívása vagy a segélyhívó számra való üzenetküldés során. Ez akkor is megtörténhet, amikor az appnak nincs helymeghatározási jogosultsága, vagy ki vannak kapcsolva az eszköz helyadatai. "<a href="https://support.google.com/android/answer/9319337">"További információ"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Ellenőrizze telefonját"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Nem sikerült elérni a telefonját"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Újrapróbálja?"</string>
 </resources>
diff --git a/PermissionController/res/values-hy-v35/strings.xml b/PermissionController/res/values-hy-v35/strings.xml
new file mode 100644
index 000000000..3cbb6bd04
--- /dev/null
+++ b/PermissionController/res/values-hy-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Անվտանգություն"</string>
+</resources>
diff --git a/PermissionController/res/values-hy/strings.xml b/PermissionController/res/values-hy/strings.xml
index 15feb127c..88c8d8d28 100644
--- a/PermissionController/res/values-hy/strings.xml
+++ b/PermissionController/res/values-hy/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"թույլտվություններ"</string>
     <string name="cancel" msgid="8943320028373963831">"Չեղարկել"</string>
     <string name="back" msgid="6249950659061523680">"Հետ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Փակել"</string>
     <string name="available" msgid="6007778121920339498">"Հասանելի է"</string>
     <string name="blocked" msgid="9195547604866033708">"Արգելափակված է"</string>
     <string name="on" msgid="280241003226755921">"Միացված է"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Չկա"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Համակարգի կանխադրված հավելված)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Հավելվածներ չկան"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Այլ NFC ծառայություններ"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Ընտրված է"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Ընտրված է – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"հատուկ հասանելիություն հավելվածների համար"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Բացվել է երեկ, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Բացվել է <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Մեկանգամյա օգտագործման ձեր գաղտնաբառը՝ 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Թույլատրել սահմանափակ ռեժիմի կարգավորումները"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Սահմանափակումներով կարգավորում"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Անվտանգության նկատառումներից ելնելով՝ այս կարգավորումը ներկայումս անհասանելի է։"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Հավելվածին մերժվել է <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>ի օգտագործման թույլտվությունը"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Եղավ"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Թույլտվության հայտն արգելափակվել է"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Այս հավելվածը պահանջում է լրացուցիչ թույլտվություններ, սակայն դրանք հնարավոր չէ տրամադրել հեռարձակման ժամանակ։ Նախ տրամադրեք թույլտվությունը ձեր հեռախոսում։"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Շտապ կանչի կամ հաղորդագրության համար"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Տեղադրության տվյալներն ուղարկվել են արտակարգ իրավիճակների ծառայություններին"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Այս հավելվածին հասանելի է դարձել ձեր սարքի տեղադրությունը արտակարգ իրավիճակների հեռախոսահամարին զանգելու կամ հաղորդագրություն ուղարկելու ժամանակ։ Նման բան կարող է պատահել, նույնիսկ եթե հավելվածը չունի տեղորոշման թույլտվություն, կամ սարքի տեղորոշումն անջատված է։ "<a href="https://support.google.com/android/answer/9319337">"Իմանալ ավելին"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Ստուգեք հեռախոսը"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Չհաջողվեց միանալ հեռախոսին"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Փորձե՞լ նորից։"</string>
 </resources>
diff --git a/PermissionController/res/values-in-v35/strings.xml b/PermissionController/res/values-in-v35/strings.xml
new file mode 100644
index 000000000..18a74e175
--- /dev/null
+++ b/PermissionController/res/values-in-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Keamanan"</string>
+</resources>
diff --git a/PermissionController/res/values-in-watch/strings.xml b/PermissionController/res/values-in-watch/strings.xml
index c124feda4..4f72c0154 100644
--- a/PermissionController/res/values-in-watch/strings.xml
+++ b/PermissionController/res/values-in-watch/strings.xml
@@ -22,11 +22,11 @@
     <string name="permission_summary_enforced_by_policy" msgid="2352478756952948019">"Tidak dapat diubah"</string>
     <string name="generic_yes" msgid="2489207724988649846">"Ya"</string>
     <string name="generic_cancel" msgid="2631708607129269698">"Batal"</string>
-    <string name="permission_access_always" msgid="2107115233573823032">"Semua"</string>
+    <string name="permission_access_always" msgid="2107115233573823032">"Sepanjang waktu"</string>
     <string name="permission_access_only_foreground" msgid="4412115020089923986">"Saat menggunakan aplikasi"</string>
-    <string name="app_permission_button_allow_always" msgid="4920899432212307102">"Semua"</string>
+    <string name="app_permission_button_allow_always" msgid="4920899432212307102">"Sepanjang waktu"</string>
     <string name="app_permission_button_allow_foreground" msgid="7186980598244864830">"Saat menggunakan aplikasi"</string>
-    <string name="grant_dialog_button_allow_always" msgid="7130695257254694576">"Semua"</string>
+    <string name="grant_dialog_button_allow_always" msgid="7130695257254694576">"Sepanjang waktu"</string>
     <string name="grant_dialog_button_allow_foreground" msgid="8917595344037255090">"Saat menggunakan aplikasi"</string>
-    <string name="grant_dialog_button_allow_background" msgid="6104993390936535493">"Semua"</string>
+    <string name="grant_dialog_button_allow_background" msgid="6104993390936535493">"Sepanjang waktu"</string>
 </resources>
diff --git a/PermissionController/res/values-in/strings.xml b/PermissionController/res/values-in/strings.xml
index 74b605607..4604dbaef 100644
--- a/PermissionController/res/values-in/strings.xml
+++ b/PermissionController/res/values-in/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"izin"</string>
     <string name="cancel" msgid="8943320028373963831">"Batal"</string>
     <string name="back" msgid="6249950659061523680">"Kembali"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Tutup"</string>
     <string name="available" msgid="6007778121920339498">"Tersedia"</string>
     <string name="blocked" msgid="9195547604866033708">"Diblokir"</string>
     <string name="on" msgid="280241003226755921">"Aktif"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Tidak ada"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Default sistem)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Tidak ada aplikasi"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Layanan NFC lainnya"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Dipilih"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Dipilih - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"akses aplikasi khusus"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Diakses kemarin <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Diakses <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Sandi sekali pakai Anda adalah 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Izinkan setelan terbatas"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Setelan terbatas"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Demi keamanan Anda, setelan ini tidak tersedia untuk saat ini."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikasi ditolak aksesnya ke <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Oke"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Permintaan izin diblokir"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Aplikasi ini meminta izin tambahan, tetapi izin tidak dapat diberikan dalam sesi streaming. Berikan izin di ponsel terlebih dahulu."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Untuk pesan teks atau panggilan darurat"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Lokasi dikirim ke layanan darurat"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Aplikasi ini mengakses lokasi perangkat Anda saat melakukan panggilan atau mengirim pesan teks ke nomor darurat. Hal ini dapat terjadi bahkan saat aplikasi tidak memiliki izin akses lokasi atau lokasi perangkat dinonaktifkan. "<a href="https://support.google.com/android/answer/9319337">"Pelajari lebih lanjut"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Periksa ponsel Anda"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Tidak dapat terhubung ke ponsel"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Coba lagi?"</string>
 </resources>
diff --git a/PermissionController/res/values-is-v35/strings.xml b/PermissionController/res/values-is-v35/strings.xml
new file mode 100644
index 000000000..4463df957
--- /dev/null
+++ b/PermissionController/res/values-is-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Öryggi"</string>
+</resources>
diff --git a/PermissionController/res/values-is/strings.xml b/PermissionController/res/values-is/strings.xml
index 08906ba97..ee49e777d 100644
--- a/PermissionController/res/values-is/strings.xml
+++ b/PermissionController/res/values-is/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"heimildir"</string>
     <string name="cancel" msgid="8943320028373963831">"Hætta við"</string>
     <string name="back" msgid="6249950659061523680">"Til baka"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Loka"</string>
     <string name="available" msgid="6007778121920339498">"Tiltækt"</string>
     <string name="blocked" msgid="9195547604866033708">"Lokað á"</string>
     <string name="on" msgid="280241003226755921">"Kveikt"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ekkert"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Sjálfgildi kerfis)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Engin forrit"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Aðrar NFC-þjónustur"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Valið"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Valið – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"sérstakur forritaaðgangur"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Opnað í gær kl. <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Opnað <xliff:g id="TIME_DATE_0">%1$s</xliff:g> kl. <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Einnota aðgangsorðið þitt er 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Leyfa takmarkaðar stillingar"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Takmörkuð stilling"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Til að tryggja öryggi þitt er þessi stilling ekki tiltæk eins og er."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Forritið fékk ekki aðgang að <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Í lagi"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Heimildarbeiðni hafnað"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Þetta forrit biður um viðbótarheimildir en ekki er hægt að veita heimildir í streymislotu. Veittu heimildina í símanum fyrst."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Fyrir neyðarsímtal eða -skilaboð"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Staðsetning send til neyðarþjónustu"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Þetta forrit fékk aðgang að staðsetningu tækisins vegna símtals eða skilaboða í neyðarnúmer. Þetta getur gerst jafnvel þótt forritið sé ekki með staðsetningarheimild eða slökkt sé á staðsetningu tækisins. "<a href="https://support.google.com/android/answer/9319337">"Nánar"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Athugaðu símann"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Ekki náðist samband við símann þinn"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Reyna aftur?"</string>
 </resources>
diff --git a/PermissionController/res/values-it-v35/strings.xml b/PermissionController/res/values-it-v35/strings.xml
new file mode 100644
index 000000000..61a64698f
--- /dev/null
+++ b/PermissionController/res/values-it-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sicurezza"</string>
+</resources>
diff --git a/PermissionController/res/values-it/strings.xml b/PermissionController/res/values-it/strings.xml
index 74b33d06a..857734db1 100644
--- a/PermissionController/res/values-it/strings.xml
+++ b/PermissionController/res/values-it/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"autorizzazioni"</string>
     <string name="cancel" msgid="8943320028373963831">"Annulla"</string>
     <string name="back" msgid="6249950659061523680">"Indietro"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Chiudi"</string>
     <string name="available" msgid="6007778121920339498">"Disponibile"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloccato"</string>
     <string name="on" msgid="280241003226755921">"On"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nessuna"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Predefinita)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nessuna app"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Altri servizi NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selezionata"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selezionata - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"accesso speciale per le app"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Ultimo accesso ieri: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Ultimo accesso: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"La password monouso è: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Consenti impostazioni con limitazioni"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Impostazione con limitazioni"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Per la tua sicurezza, questa impostazione non è al momento disponibile."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"All\'app è stato negato l\'accesso a <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Ok"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Richiesta di autorizzazione rifiutata"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Questa app richiede autorizzazioni aggiuntive, ma non è possibile concedere autorizzazioni in una sessione di streaming. Devi prima concedere l\'autorizzazione sul tuo smartphone."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Per messaggio o chiamata di emergenza"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Posizione inviata ai servizi di emergenza"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Questa app ha eseguito l\'accesso alla posizione del tuo dispositivo durante una chiamata o l\'invio di un messaggio a un numero di emergenza. Questo può accadere anche quando l\'app non ha l\'autorizzazione di accesso alla posizione o se la localizzazione del dispositivo è disattivata. "<a href="https://support.google.com/android/answer/9319337">"Scopri di più"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Controlla il tuo smartphone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Impossibile collegarsi allo smartphone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Vuoi riprovare?"</string>
 </resources>
diff --git a/PermissionController/res/values-iw-v35/strings.xml b/PermissionController/res/values-iw-v35/strings.xml
new file mode 100644
index 000000000..b9ebf0891
--- /dev/null
+++ b/PermissionController/res/values-iw-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"אבטחה"</string>
+</resources>
diff --git a/PermissionController/res/values-iw/strings.xml b/PermissionController/res/values-iw/strings.xml
index 231b0ba55..90536dcc8 100644
--- a/PermissionController/res/values-iw/strings.xml
+++ b/PermissionController/res/values-iw/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"הרשאות"</string>
     <string name="cancel" msgid="8943320028373963831">"ביטול"</string>
     <string name="back" msgid="6249950659061523680">"חזרה"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"סגירה"</string>
     <string name="available" msgid="6007778121920339498">"הגישה מותרת"</string>
     <string name="blocked" msgid="9195547604866033708">"הגישה חסומה"</string>
     <string name="on" msgid="280241003226755921">"מופעל"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ללא"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(ברירת מחדל של המערכת)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"אין אפליקציות"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"‏שירותי NFC אחרים"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"נבחרה"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"נבחרה – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"גישה מיוחדת של אפליקציה"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"גישה אתמול: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"תאריך גישה: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> ב-<xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"הסיסמה החד-פעמית שלך היא 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"הרשאה להגדרות מוגבלות"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"הגדרה מוגבלת"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"מטעמי אבטחה, ההגדרה הזו לא זמינה כרגע."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"בקשת הגישה של האפליקציה ל<xliff:g id="PERMISSION_NAME">%1$s</xliff:g> נדחתה"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"הבנתי"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"בקשת ההרשאה בוטלה"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"האפליקציה הזו מבקשת הרשאות נוספות, אבל אי אפשר לתת הרשאות בזמן פעילות של סטרימינג. צריך לתת את ההרשאה קודם בטלפון."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"לשיחת חירום או שליחת הודעת טקסט במקרה חירום"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"המיקום נשלח לשירותי החירום"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"האפליקציה הזו ניגשה למיקום המכשיר שלך בזמן שיחה או שליחת הודעת טקסט למספר חירום. זה יכול לקרות גם אם לאפליקציה אין הרשאת מיקום או שמיקום המכשיר מושבת. "<a href="https://support.google.com/android/answer/9319337">"מידע נוסף"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"צריך לבדוק בטלפון"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"אי אפשר להתחבר לטלפון"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"לנסות שוב?"</string>
 </resources>
diff --git a/PermissionController/res/values-ja-v35/strings.xml b/PermissionController/res/values-ja-v35/strings.xml
new file mode 100644
index 000000000..301dec443
--- /dev/null
+++ b/PermissionController/res/values-ja-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"セキュリティ"</string>
+</resources>
diff --git a/PermissionController/res/values-ja/strings.xml b/PermissionController/res/values-ja/strings.xml
index fd1658417..ecd742f55 100644
--- a/PermissionController/res/values-ja/strings.xml
+++ b/PermissionController/res/values-ja/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"権限"</string>
     <string name="cancel" msgid="8943320028373963831">"キャンセル"</string>
     <string name="back" msgid="6249950659061523680">"戻る"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"閉じる"</string>
     <string name="available" msgid="6007778121920339498">"使用可能"</string>
     <string name="blocked" msgid="9195547604866033708">"ブロック中"</string>
     <string name="on" msgid="280241003226755921">"ON"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"なし"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"（システムのデフォルト）"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"アプリなし"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"その他の NFC サービス"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"選択済み"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"選択済み - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"特別なアプリアクセス"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"昨日の <xliff:g id="TIME_DATE">%1$s</xliff:g> にアクセス"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g> にアクセス"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"ワンタイム パスワードは 132435 です"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"制限付き設定を許可"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"制限付き設定"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"セキュリティ保護のため、この設定は現在利用できません。"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"アプリは<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>へのアクセスを拒否されました"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"権限のリクエストが抑制されています"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"このアプリは追加の権限を求めていますが、ストリーミング セッションでは権限を付与できません。スマートフォンで先に権限を付与してください。"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"緊急通報（電話またはテキスト メッセージ）の場合"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"緊急サービスへの位置情報の送信"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"このアプリは緊急通報番号に電話またはテキスト メッセージで通報する際にデバイスの位置情報にアクセスしました。このアクセスは、アプリに位置情報の利用許可が付与されていない場合やデバイスの位置情報が OFF の場合も発生することがあります。"<a href="https://support.google.com/android/answer/9319337">"詳細"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"スマートフォンを確認してください"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"スマートフォンに接続できません"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"再試行しますか？"</string>
 </resources>
diff --git a/PermissionController/res/values-ka-v35/strings.xml b/PermissionController/res/values-ka-v35/strings.xml
new file mode 100644
index 000000000..fb932751b
--- /dev/null
+++ b/PermissionController/res/values-ka-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"უსაფრთხოება"</string>
+</resources>
diff --git a/PermissionController/res/values-ka/strings.xml b/PermissionController/res/values-ka/strings.xml
index 5bfebc26d..3f836afdf 100644
--- a/PermissionController/res/values-ka/strings.xml
+++ b/PermissionController/res/values-ka/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ნებართვები"</string>
     <string name="cancel" msgid="8943320028373963831">"გაუქმება"</string>
     <string name="back" msgid="6249950659061523680">"უკან"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"დახურვა"</string>
     <string name="available" msgid="6007778121920339498">"ხელმისაწვდომი"</string>
     <string name="blocked" msgid="9195547604866033708">"დაბლოკილი"</string>
     <string name="on" msgid="280241003226755921">"ჩართვა"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"არცერთი"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(სისტემის ნაგულისხმევი)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"აპები არ არის"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"სხვა NFC სერვისები"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"არჩეული"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"არჩეული - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"აპების სპეციალური წვდომა"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"წვდომა განხორციელდა გუშინ: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"წვდომა განხორციელდა: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"თქვენი ერთჯერადი პაროლია: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"შეზღუდული პარამეტრების დაშვება"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"შეზღუდული პარამეტრი"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"თქვენივე უსაფრთხოებისთვის ეს პარამეტრი ამჟამად მიუწვდომელია."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"აპისთვის უარყოფილია ნებართვაზე წვდომა: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"კარგი"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"ნებართვის მოთხოვნა შეჩერებულია"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ეს აპი დამატებით ნებართვებს მოითხოვს, მაგრამ ნებართვების მიცემა შეუძლებელია სტრიმინგის სესიაში. თავდაპირველად მიანიჭეთ ნებართვა ტელეფონზე."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"გადაუდებელი ზარის ან ტექსტური შეტყობინებისთვის"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"გადაუდებელი დახმარების სამსახურებთან მდებარეობის გაგზავნა"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"ამ აპმა წვდომა მიიღო თქვენი მოწყობილობის მდებარეობაზე ზარის ან ტექსტური შეტყობინების გაგზავნისას გადაუდებელი დახმარების სამსახურის ნომერზე. ეს შეიძლება მოხდეს მაშინაც კი, როდესაც აპს არ აქვს მდებარეობის ნებართვა ან მოწყობილობის მდებარეობა გამორთულია. "<a href="https://support.google.com/android/answer/9319337">"შეიტყვეთ მეტი"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"შეამოწმეთ თქვენი ტელეფონი"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"თქვენს ტელეფონთან დაკავშირება ვერ მოხერხდა"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"გსურთ ხელახლა ცდა?"</string>
 </resources>
diff --git a/PermissionController/res/values-kk-v35/strings.xml b/PermissionController/res/values-kk-v35/strings.xml
new file mode 100644
index 000000000..6c5e61d14
--- /dev/null
+++ b/PermissionController/res/values-kk-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Қауіпсіздік"</string>
+</resources>
diff --git a/PermissionController/res/values-kk/strings.xml b/PermissionController/res/values-kk/strings.xml
index 84f5f1342..ee9e14a6a 100644
--- a/PermissionController/res/values-kk/strings.xml
+++ b/PermissionController/res/values-kk/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"рұқсаттар"</string>
     <string name="cancel" msgid="8943320028373963831">"Бас тарту"</string>
     <string name="back" msgid="6249950659061523680">"Артқа"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Жабу"</string>
     <string name="available" msgid="6007778121920339498">"Қолжетімді"</string>
     <string name="blocked" msgid="9195547604866033708">"Блокталған"</string>
     <string name="on" msgid="280241003226755921">"Қосулы"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Жоқ"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(жүйенің әдепкі қолданбасы)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Қолданба жоқ"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Басқа NFC қызметтері"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Таңдалды"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Таңдалды – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"арнайы қолданба рұқсаты"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Кеше пайдаланылған уақыты: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Пайдаланылған уақыты: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Бір реттік құпия сөзіңіз: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Шектелген параметрлерге рұқсат беру"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Шектелген параметр"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Қауіпсіздік мақсатында бұл параметрді қазір пайдалану мүмкін емес."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Қолданбаға <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> рұқсаты берілмеді"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Жарайды"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Рұқсат сұрауы блокталды"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Бұл қолданба қосымша рұқсаттар сұрап жатыр, бірақ трансляция жүріп жатқанда рұқсат беру мүмкін емес. Алдымен телефонда рұқсат беріңіз."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Құтқару қызметіне қоңырау шалуға немесе мәтіндік хабар жіберуге арналған"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Локация құтқару қызметтеріне жіберілді"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Бұл қолданба құтқару қызметінің нөміріне қоңырау шалу немесе мәтіндік хабар жіберу кезінде құрылғының локациясын пайдаланды. Локацияны пайдалану рұқсаты болмаған немесе құрылғы локациясы өшірулі болған жағдайда да, қолданба локацияны пайдалануы мүмкін. "<a href="https://support.google.com/android/answer/9319337">"Толық ақпарат"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Телефоныңызды тексеріңіз"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Телефоныңызға қосылу мүмкін болмады."</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Қайталау керек пе?"</string>
 </resources>
diff --git a/PermissionController/res/values-km-v35/strings.xml b/PermissionController/res/values-km-v35/strings.xml
new file mode 100644
index 000000000..e461c54d5
--- /dev/null
+++ b/PermissionController/res/values-km-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"សន្តិសុខ"</string>
+</resources>
diff --git a/PermissionController/res/values-km/strings.xml b/PermissionController/res/values-km/strings.xml
index f54ef1631..82f5c1919 100644
--- a/PermissionController/res/values-km/strings.xml
+++ b/PermissionController/res/values-km/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ការអនុញ្ញាត"</string>
     <string name="cancel" msgid="8943320028373963831">"បោះបង់"</string>
     <string name="back" msgid="6249950659061523680">"ថយក្រោយ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"បិទ"</string>
     <string name="available" msgid="6007778121920339498">"អាចចូលប្រើបាន"</string>
     <string name="blocked" msgid="9195547604866033708">"បាន​ទប់ស្កាត់"</string>
     <string name="on" msgid="280241003226755921">"បើក"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"គ្មាន"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(លំនាំដើមប្រព័ន្ធ)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"គ្មានកម្មវិធី​ទេ​"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"សេវាកម្ម NFC ផ្សេងទៀត"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"បានជ្រើសរើស"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"បានជ្រើសរើស - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ការចូលប្រើកម្មវិធីពិសេស"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"បានចូលប្រើម្សិលមិញនៅម៉ោង <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"បានចូលប្រើនៅថ្ងៃទី <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"ពាក្យ​សម្ងាត់​ប្រើបាន​តែ​ម្ដងរបស់អ្នកគឺ 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"អនុញ្ញាតការកំណត់​ដែលបានដាក់កំហិត"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"ការកំណត់​ដែលបានដាក់កំហិត"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"ដើម្បីសុវត្ថិភាព​របស់អ្នក បច្ចុប្បន្នមិនអាចប្រើការកំណត់នេះបានទេ។"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"កម្មវិធីត្រូវបានបដិសេធមិនឱ្យចូលប្រើ<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"យល់ព្រម"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"បានទប់ស្កាត់សំណើសុំការអនុញ្ញាត"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"កម្មវិធីនេះកំពុងស្នើសុំការអនុញ្ញាតបន្ថែម ប៉ុន្តែមិនអាចផ្តល់ការអនុញ្ញាតក្នុងវគ្គផ្សាយបានទេ។ ផ្តល់ការអនុញ្ញាតនៅលើទូរសព្ទរបស់អ្នកជាមុនសិន។"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"សម្រាប់ការហៅ ឬផ្ញើសារជាអក្សរទៅលេខសង្គ្រោះបន្ទាន់"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"បានផ្ញើទីតាំង​ទៅសេវាសង្គ្រោះបន្ទាន់"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"កម្មវិធីនេះបានចូលប្រើទីតាំងឧបករណ៍របស់អ្នកក្នុងអំឡុងពេលហៅទូរសព្ទ ឬផ្ញើសារជាអក្សរទៅកាន់លេខសង្គ្រោះបន្ទាន់។ ករណីនេះអាចកើតឡើង ទោះបីជាកម្មវិធីនេះមិនមានការអនុញ្ញាតទីតាំង ឬបិទទីតាំងឧបករណ៍ក៏ដោយ។ "<a href="https://support.google.com/android/answer/9319337">"ស្វែងយល់បន្ថែម"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"ពិនិត្យមើល​ទូរសព្ទ​របស់អ្នក"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"មិនអាច​ភ្ជាប់ជាមួយ​ទូរសព្ទ​របស់អ្នក​បានទេ"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"ព្យាយាម​ម្ដង​ទៀតឬ?"</string>
 </resources>
diff --git a/PermissionController/res/values-kn-v35/strings.xml b/PermissionController/res/values-kn-v35/strings.xml
new file mode 100644
index 000000000..7205ee7fe
--- /dev/null
+++ b/PermissionController/res/values-kn-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"ಭದ್ರತೆ"</string>
+</resources>
diff --git a/PermissionController/res/values-kn/strings.xml b/PermissionController/res/values-kn/strings.xml
index 5582af507..43ce0a8b9 100644
--- a/PermissionController/res/values-kn/strings.xml
+++ b/PermissionController/res/values-kn/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ಅನುಮತಿಗಳು"</string>
     <string name="cancel" msgid="8943320028373963831">"ರದ್ದುಮಾಡಿ"</string>
     <string name="back" msgid="6249950659061523680">"ಹಿಂದಕ್ಕೆ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"ಮುಚ್ಚಿರಿ"</string>
     <string name="available" msgid="6007778121920339498">"ಲಭ್ಯವಿದೆ"</string>
     <string name="blocked" msgid="9195547604866033708">"ನಿರ್ಬಂಧಿಸಲಾಗಿದೆ"</string>
     <string name="on" msgid="280241003226755921">"ಆನ್"</string>
@@ -277,7 +278,7 @@
     <string name="post_drive_permission_decision_reminder_summary_1_app_1_permission" msgid="670521503734140711">"ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP">%1$s</xliff:g> ಗೆ <xliff:g id="PERMISSION">%2$s</xliff:g> ಪ್ರವೇಶವನ್ನು ನೀಡಿದ್ದೀರಿ"</string>
     <string name="post_drive_permission_decision_reminder_summary_1_app_2_permissions" msgid="671791184670801301">"ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP">%1$s</xliff:g> ಗೆ <xliff:g id="PERMISSION_1">%2$s</xliff:g> ಮತ್ತು <xliff:g id="PERMISSION_2">%3$s</xliff:g> ಪ್ರವೇಶವನ್ನು ನೀಡಿದ್ದೀರಿ"</string>
     <string name="post_drive_permission_decision_reminder_summary_1_app_multi_permission" msgid="4080701771111456927">"ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP">%2$s</xliff:g> ಗೆ <xliff:g id="COUNT">%1$d</xliff:g> ಅನುಮತಿಗಳನ್ನು ನೀಡಿದ್ದೀರಿ"</string>
-    <string name="post_drive_permission_decision_reminder_summary_multi_apps" msgid="5253882771252863902">"{count,plural, =1{ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP_0">%1$s</xliff:g> ಮತ್ತು # ಇತರ ಆ್ಯಪ್‌ಗೆ ಪ್ರವೇಶವನ್ನು ನೀಡಿದ್ದೀರಿ}one{ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP_1">%1$s</xliff:g> ಮತ್ತು # ಇತರ ಆ್ಯಪ್‌ಗಳಿಗೆ ಪ್ರವೇಶವನ್ನು ನೀಡಿದ್ದೀರಿ}other{ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP_1">%1$s</xliff:g> ಮತ್ತು # ಇತರ ಆ್ಯಪ್‌ಗಳಿಗೆ ಪ್ರವೇಶವನ್ನು ನೀಡಿದ್ದೀರಿ}}"</string>
+    <string name="post_drive_permission_decision_reminder_summary_multi_apps" msgid="5253882771252863902">"{count,plural, =1{ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP_0">%1$s</xliff:g> ಮತ್ತು # ಇತರ ಆ್ಯಪ್‌ಗೆ ಆ್ಯಕ್ಸೆಸ್ ಅನ್ನು ನೀಡಿದ್ದೀರಿ}one{ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP_1">%1$s</xliff:g> ಮತ್ತು # ಇತರ ಆ್ಯಪ್‌ಗಳಿಗೆ ಆ್ಯಕ್ಸೆಸ್ ಅನ್ನು ನೀಡಿದ್ದೀರಿ}other{ನೀವು ವಾಹನ ಚಲಾಯಿಸುವಾಗ, <xliff:g id="APP_1">%1$s</xliff:g> ಮತ್ತು # ಇತರ ಆ್ಯಪ್‌ಗಳಿಗೆ ಆ್ಯಕ್ಸೆಸ್ ಅನ್ನು ನೀಡಿದ್ದೀರಿ}}"</string>
     <string name="go_to_settings" msgid="1053735612211228335">"ಸೆಟ್ಟಿಂಗ್‌ಗಳಿಗೆ ಹೋಗಿ"</string>
     <string name="auto_revoke_setting_subtitle" msgid="8631720570723050460">"ಹಲವಾರು ತಿಂಗಳುಗಳಿಂದ ಕೆಲವು ಆ್ಯಪ್‌ಗಳನ್ನು ಬಳಸಲಾಗಿಲ್ಲ"</string>
     <string name="permissions_removed_category_title" msgid="1064754271178447643">"ತೆಗೆದುಹಾಕಲಾದ ಅನುಮತಿಗಳು"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ಯಾವುದೂ ಬೇಡ"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(ಸಿಸ್ಟಂ ಡಿಫಾಲ್ಟ್)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"ಯಾವುದೇ ಆ್ಯಪ್‌ಗಳು ಇಲ್ಲ"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"ಇತರ NFC ಸೇವೆಗಳು"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"ಆಯ್ಕೆಮಾಡಲಾಗಿದೆ"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"<xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g> - ಆಯ್ಕೆಮಾಡಲಾಗಿದೆ"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ವಿಶೇಷ ಆ್ಯಪ್ ಆ್ಯಕ್ಸೆಸ್"</string>
@@ -581,7 +583,7 @@
     <string name="safety_privacy_qs_tile_subtitle" msgid="3621544532041936749">"ಸ್ಥಿತಿ ಪರಿಶೀಲಿಸಿ"</string>
     <string name="privacy_controls_qs" msgid="5780144882040591169">"ನಿಮ್ಮ ಗೌಪ್ಯತೆ ನಿಯಂತ್ರಣಗಳು"</string>
     <string name="security_settings_button_label_qs" msgid="8280343822465962330">"ಇನ್ನಷ್ಟು ಸೆಟ್ಟಿಂಗ್‌ಗಳು"</string>
-    <string name="camera_toggle_label_qs" msgid="3880261453066157285">"ಕ್ಯಾಮರಾ ಪ್ರವೇಶ"</string>
+    <string name="camera_toggle_label_qs" msgid="3880261453066157285">"ಕ್ಯಾಮರಾ ಆ್ಯಕ್ಸೆಸ್"</string>
     <string name="microphone_toggle_label_qs" msgid="8132912469813396552">"ಮೈಕ್ ಆ್ಯಕ್ಸೆಸ್"</string>
     <string name="permissions_removed_qs" msgid="8957319130625294572">"ಅನುಮತಿಯನ್ನು ತೆಗೆದುಹಾಕಲಾಗಿದೆ"</string>
     <string name="camera_usage_qs" msgid="4394233566086665994">"ಇತ್ತೀಚಿನ ಕ್ಯಾಮರಾ ಬಳಕೆಯನ್ನು ನೋಡಿ"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"ನಿನ್ನೆ <xliff:g id="TIME_DATE">%1$s</xliff:g> ಸಮಯಕ್ಕೆ ಆ್ಯಕ್ಸೆಸ್ ಮಾಡಲಾಗಿದೆ"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g> ಸಮಯಕ್ಕೆ ಆ್ಯಕ್ಸೆಸ್ ಮಾಡಲಾಗಿದೆ"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"ನಿಮ್ಮ ಒನ್‌-ಟೈಮ್ ಪಾಸ್‌ವರ್ಡ್ 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"ನಿರ್ಬಂಧಿಸಲಾದ ಸೆಟ್ಟಿಂಗ್‌ಗಳನ್ನು ಅನುಮತಿಸಿ"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"ನಿರ್ಬಂಧಿಸಲಾದ ಸೆಟ್ಟಿಂಗ್"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"ನಿಮ್ಮ ಸುರಕ್ಷತೆಗಾಗಿ, ಈ ಸೆಟ್ಟಿಂಗ್ ಪ್ರಸ್ತುತ ಲಭ್ಯವಿಲ್ಲ."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"<xliff:g id="PERMISSION_NAME">%1$s</xliff:g> ಅನ್ನು ಆ್ಯಕ್ಸೆಸ್ ಮಾಡಲು ಆ್ಯಪ್‌ಗೆ ನಿರಾಕರಿಸಲಾಗಿದೆ"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ಸರಿ"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"ಅನುಮತಿ ವಿನಂತಿಯನ್ನು ನಿಗ್ರಹಿಸಲಾಗಿದೆ"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ಈ ಆ್ಯಪ್ ಹೆಚ್ಚುವರಿ ಅನುಮತಿಗಳನ್ನು ವಿನಂತಿಸುತ್ತಿದೆ, ಆದರೆ ಸ್ಟ್ರೀಮಿಂಗ್ ಸೆಶನ್‌ನಲ್ಲಿ ಅನುಮತಿಗಳನ್ನು ನೀಡಲು ಸಾಧ್ಯವಿಲ್ಲ. ಮೊದಲು ನಿಮ್ಮ ಫೋನ್‌ನಲ್ಲಿ ಅನುಮತಿ ನೀಡಿ."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"ತುರ್ತು ಕರೆ ಅಥವಾ ಪಠ್ಯಕ್ಕಾಗಿ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ಸ್ಥಳವನ್ನು ತುರ್ತು ಸೇವೆಗಳಿಗೆ ಕಳುಹಿಸಲಾಗಿದೆ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"ತುರ್ತು ಸಂಖ್ಯೆಗೆ ಕರೆ ಮಾಡಿದ ಅಥವಾ ಪಠ್ಯವನ್ನು ಕಳುಹಿಸುವ ಸಮಯದಲ್ಲಿ ಈ ಆ್ಯಪ್ ನಿಮ್ಮ ಸಾಧನದ ಸ್ಥಳವನ್ನು ಆ್ಯಕ್ಸೆಸ್ ಮಾಡಿದೆ. ಆ್ಯಪ್ ಸ್ಥಳದ ಅನುಮತಿಯನ್ನು ಹೊಂದಿಲ್ಲದಿರುವಾಗ ಅಥವಾ ಸಾಧನದ ಸ್ಥಳವು ಆಫ್ ಆಗಿರುವಾಗಲೂ ಇದು ಸಂಭವಿಸಬಹುದು. "<a href="https://support.google.com/android/answer/9319337">"ಇನ್ನಷ್ಟು ತಿಳಿಯಿರಿ"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"ನಿಮ್ಮ ಫೋನ್ ಅನ್ನು ಪರಿಶೀಲಿಸಿ"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"ನಿಮ್ಮ ಫೋನ್ ಅನ್ನು ಸಂಪರ್ಕಿಸಲು ಸಾಧ್ಯವಾಗಲಿಲ್ಲ"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"ಪುನಃ ಪ್ರಯತ್ನಿಸಬೇಕೆ?"</string>
 </resources>
diff --git a/PermissionController/res/values-ko-v35/strings.xml b/PermissionController/res/values-ko-v35/strings.xml
new file mode 100644
index 000000000..99de87a25
--- /dev/null
+++ b/PermissionController/res/values-ko-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"보안"</string>
+</resources>
diff --git a/PermissionController/res/values-ko/strings.xml b/PermissionController/res/values-ko/strings.xml
index 8105039cd..d611cdf9d 100644
--- a/PermissionController/res/values-ko/strings.xml
+++ b/PermissionController/res/values-ko/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"권한"</string>
     <string name="cancel" msgid="8943320028373963831">"취소"</string>
     <string name="back" msgid="6249950659061523680">"뒤로"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"닫기"</string>
     <string name="available" msgid="6007778121920339498">"허용됨"</string>
     <string name="blocked" msgid="9195547604866033708">"차단됨"</string>
     <string name="on" msgid="280241003226755921">"사용"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"없음"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(시스템 기본값)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"앱 없음"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"기타 NFC 서비스"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"선택됨"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"선택됨 - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"특수 앱 액세스 권한"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"어제 <xliff:g id="TIME_DATE">%1$s</xliff:g>에 액세스함"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>에 액세스함"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"일회용 비밀번호는 132435입니다"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"제한된 설정 허용"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"제한된 설정"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"보안을 위해 이 설정은 현재 사용할 수 없습니다."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>에 대한 앱의 액세스가 거부됨"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"확인"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"권한 요청 거부됨"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"앱에서 추가 권한을 요청합니다. 그러나 스트리밍 세션에서는 권한을 부여할 수 없습니다. 휴대전화에서 먼저 권한을 부여하세요."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"긴급 전화 또는 문자용"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"위치를 응급 서비스로 전송함"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"긴급 전화번호로 전화를 걸거나 문자를 전송하는 중에 앱에서 기기 위치에 액세스했습니다. 앱에 위치 정보 액세스 권한이 없거나 기기 위치 기능이 사용 중지되어 있는 경우에도 앱에서 기기 위치에 액세스할 수 있습니다. "<a href="https://support.google.com/android/answer/9319337">"자세히 알아보기"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"휴대전화를 확인하세요"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"휴대전화에 연결할 수 없습니다"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"다시 시도하시겠습니까?"</string>
 </resources>
diff --git a/PermissionController/res/values-ky-v35/strings.xml b/PermissionController/res/values-ky-v35/strings.xml
new file mode 100644
index 000000000..844abd6f0
--- /dev/null
+++ b/PermissionController/res/values-ky-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Коопсуздук"</string>
+</resources>
diff --git a/PermissionController/res/values-ky/strings.xml b/PermissionController/res/values-ky/strings.xml
index 4aa6e4473..ec6bde78b 100644
--- a/PermissionController/res/values-ky/strings.xml
+++ b/PermissionController/res/values-ky/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"уруксаттар"</string>
     <string name="cancel" msgid="8943320028373963831">"Жок"</string>
     <string name="back" msgid="6249950659061523680">"Артка"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Жабуу"</string>
     <string name="available" msgid="6007778121920339498">"Жеткиликтүү"</string>
     <string name="blocked" msgid="9195547604866033708">"Бөгөттөлдү"</string>
     <string name="on" msgid="280241003226755921">"Күйүк"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Жок"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Демейки тутум)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Бир да колдонмо жок"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Башка NFC кызматтары"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Тандалды"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Тандалды – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"колдонмонун атайын уруксаты"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Кечээ саат <xliff:g id="TIME_DATE">%1$s</xliff:g> колдонулду"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> саат <xliff:g id="TIME_DATE_1">%2$s</xliff:g> колдонулду"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Бир жолу гана колдонулуучу кодуңуз: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Чектелген параметрлерге уруксат берүү"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Чектелген функция"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Коопсуздук максатында бул параметр азырынча иштебейт."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Колдонмого <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> параметрин колдонууга тыюу салынды"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Жарайт"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Уруксат берүү сурамы четке кагылды"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Бул колдонмо кошумча уруксаттарды берүүнү суранып жатат, бирок алып ойнотуу сеансында уруксаттарды берүүгө болбойт. Адегенде телефондо уруксат бериңиз."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Шашылыш чалуу же билдирүү жөнөтүү үчүн"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Жайгашкан жер кырсыктаганда жардамга келчү кызматтарга жөнөтүлдү"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Бул колдонмо кырсыктаганда жардамга келчү кызматтын номерине чалып же билдирүү жөнөткөнүңүздө түзмөк жайгашкан жерди аныктады. Колдонмонун жайгашкан жерди аныктоого уруксаты болбосо же түзмөктүн жайгашкан жери өчүк болсо да, ушундай болушу мүмкүн. "<a href="https://support.google.com/android/answer/9319337">"Кеңири маалымат"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Телефонуңузду текшериңиз"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Телефонго туташкан жок"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Дагы аракет кыласызбы?"</string>
 </resources>
diff --git a/PermissionController/res/values-lo-v35/strings.xml b/PermissionController/res/values-lo-v35/strings.xml
new file mode 100644
index 000000000..08a6e9920
--- /dev/null
+++ b/PermissionController/res/values-lo-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"ຄວາມປອດໄພ"</string>
+</resources>
diff --git a/PermissionController/res/values-lo/strings.xml b/PermissionController/res/values-lo/strings.xml
index c7789fc2c..f71900d86 100644
--- a/PermissionController/res/values-lo/strings.xml
+++ b/PermissionController/res/values-lo/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ສິດອະນຸຍາດ"</string>
     <string name="cancel" msgid="8943320028373963831">"ຍົກເລີກ"</string>
     <string name="back" msgid="6249950659061523680">"ກັບຄືນ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"ປິດ"</string>
     <string name="available" msgid="6007778121920339498">"ສາມາດໃຊ້ໄດ້"</string>
     <string name="blocked" msgid="9195547604866033708">"ບລັອກແລ້ວ"</string>
     <string name="on" msgid="280241003226755921">"ເປີດຢູ່"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ບໍ່ມີ"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(ຄ່າເລີ່ມຕົ້ນຂອງລະບົບ)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"ບໍ່ມີແອັບ"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"ບໍລິການ NFC ອື່ນໆ"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"ເລືອກແລ້ວ"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"ເລືອກແລ້ວ - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ສິດການເຂົ້າເຖິງແອັບພິເສດ"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"ເຂົ້າເຖິງມື້ວານນີ້ເມື່ອ <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"ເຂົ້າເຖິງເມື່ອ <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"ລະຫັດຜ່ານແບບໃຊ້ໄດ້ເທື່ອດຽວຂອງທ່ານແມ່ນ 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"ອະນຸຍາດການຕັ້ງຄ່າທີ່ຈຳກັດ"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"ການຕັ້ງຄ່າທີ່ຈຳກັດ"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"ເພື່ອຄວາມປອດໄພຂອງທ່ານ, ຕອນນີ້ຈຶ່ງບໍ່ສາມາດໃຊ້ການຕັ້ງຄ່ານີ້ໄດ້."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"ແອັບຖືກປະຕິເສດສິດເຂົ້າເຖິງຫາ <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ຕົກລົງ"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"ຄຳຮ້ອງຂໍການອະນຸຍາດຖືກລະງັບ"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ແອັບນີ້ກຳລັງຮ້ອງຂໍການອະນຸຍາດເພີ່ມເຕີມ, ແຕ່ບໍ່ສາມາດໃຫ້ການອະນຸຍາດໃນເຊດຊັນການສະຕຣີມໄດ້. ກະລຸນາໃຫ້ການອະນຸຍາດໃນໂທລະສັບຂອງທ່ານກ່ອນ."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"ສຳລັບການໂທ ຫຼື ສົ່ງຂໍ້ຄວາມສຸກເສີນ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ສົ່ງສະຖານທີ່ໄປຫາບໍລິການສຸກເສີນແລ້ວ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"ແອັບນີ້ໄດ້ເຂົ້າເຖິງສະຖານທີ່ຂອງອຸປະກອນຂອງທ່ານໃນລະຫວ່າງທີ່ໂທ ຫຼື ສົ່ງຂໍ້ຄວາມຫາເບີໂທສຸກເສີນ. ເຊິ່ງນີ້ສາມາດເກີດຂຶ້ນໄດ້ເຖິງແມ່ນວ່າແອັບຈະບໍ່ມີການອະນຸຍາດສະຖານທີ່ ຫຼື ເຖິງແມ່ນວ່າສະຖານທີ່ຂອງອຸປະກອນຈະປິດຢູ່ກໍຕາມ. "<a href="https://support.google.com/android/answer/9319337">"ສຶກສາເພີ່ມເຕີມ"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"ກວດເບິ່ງໂທລະສັບຂອງທ່ານ"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"ບໍ່ສາມາດເຂົ້າເຖິງໂທລະສັບຂອງທ່ານໄດ້"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"ລອງໃໝ່ບໍ?"</string>
 </resources>
diff --git a/PermissionController/res/values-lt-v35/strings.xml b/PermissionController/res/values-lt-v35/strings.xml
new file mode 100644
index 000000000..b53fe3513
--- /dev/null
+++ b/PermissionController/res/values-lt-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sauga"</string>
+</resources>
diff --git a/PermissionController/res/values-lt/strings.xml b/PermissionController/res/values-lt/strings.xml
index af06edb45..59cd88b5b 100644
--- a/PermissionController/res/values-lt/strings.xml
+++ b/PermissionController/res/values-lt/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"leidimai"</string>
     <string name="cancel" msgid="8943320028373963831">"Atšaukti"</string>
     <string name="back" msgid="6249950659061523680">"Atgal"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Uždaryti"</string>
     <string name="available" msgid="6007778121920339498">"Pasiekiama"</string>
     <string name="blocked" msgid="9195547604866033708">"Užblokuota"</string>
     <string name="on" msgid="280241003226755921">"Įjungta"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nėra"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Sistemos numatytoji programa)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nėra programų"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Kitos NFC paslaugos"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Pasirinkta"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Pasirinkta: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"speciali prieiga prie programų"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Pasiekta vakar <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Pasiekta <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Jūsų vienkartinis slaptažodis yra 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Leisti apribotus nustatymus"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Apribotas nustatymas"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Šis nustatymas šiuo metu nepasiekiamas dėl jūsų saugumo."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Programai prieiga nesuteikta:<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Gerai"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Leidimo užklausa atmesta"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Ši programa prašo papildomų leidimų, bet jų negalima suteikti per srautinio perdavimo seansą. Leidimą pirmiausia suteikite telefone."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Skambutis arba pranešimas pagalbos numeriu"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Vietovės informacija išsiųsta pagalbos tarnyboms"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Skambinant ar siunčiant pranešimą pagalbos numeriu, ši programa pasiekė jūsų įrenginio vietovės informaciją. Taip gali nutikti net tada, kai programa neturi leidimo pasiekti vietovės duomenis arba kai įrenginio vietovė yra išjungta."<a href="https://support.google.com/android/answer/9319337">"Sužinokite daugiau"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Patikrinkite telefoną"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Nepavyksta pasiekti jūsų telefono"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Bandyti dar kartą?"</string>
 </resources>
diff --git a/PermissionController/res/values-lv-v35/strings.xml b/PermissionController/res/values-lv-v35/strings.xml
new file mode 100644
index 000000000..98ae9a138
--- /dev/null
+++ b/PermissionController/res/values-lv-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Drošība"</string>
+</resources>
diff --git a/PermissionController/res/values-lv/strings.xml b/PermissionController/res/values-lv/strings.xml
index 32bcdd732..297279e73 100644
--- a/PermissionController/res/values-lv/strings.xml
+++ b/PermissionController/res/values-lv/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"atļaujas"</string>
     <string name="cancel" msgid="8943320028373963831">"Atcelt"</string>
     <string name="back" msgid="6249950659061523680">"Atpakaļ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Aizvērt"</string>
     <string name="available" msgid="6007778121920339498">"Pieejama"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloķēta"</string>
     <string name="on" msgid="280241003226755921">"Ieslēgta"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nav"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Sistēmas noklusējums)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nav lietotņu"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Citi NFC pakalpojumi"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Atlasīta"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Atlasīta — <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"Īpaša lietotņu piekļuve"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Pēdējā piekļuves reize vakar: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Pēdējā piekļuves reize: <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Jūsu vienreizējā parole ir 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Atļaut ierobežotos iestatījumus"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ierobežots iestatījums"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Drošības apsvērumu dēļ šis iestatījums pašlaik nav pieejams."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Lietotnes piekļuve atļaujai “<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>” tika liegta"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Labi"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Atļaujas pieprasījums bloķēts"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Šī lietotne pieprasa papildu atļaujas, taču atļaujas nevar piešķirt straumēšanas sesijā. Vispirms piešķiriet attiecīgo atļauju savā tālrunī."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Ārkārtas izsaukumam (zvanam vai īsziņai)"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Ārkārtas palīdzības dienestiem tika nosūtīti atrašanās vietas dati"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Šī lietotne piekļuva ierīces atrašanās vietas datiem, zvanot vai sūtot īsziņu uz ārkārtas numuru. Tas var notikt pat tad, ja lietotnei nav atrašanās vietas atļaujas vai ierīcē ir izslēgta atrašanās vietas noteikšana. "<a href="https://support.google.com/android/answer/9319337">"Uzziniet vairāk."</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Pārbaudiet tālruni"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Nevarēja sasniegt jūsu tālruni."</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Vai mēģināt vēlreiz?"</string>
 </resources>
diff --git a/PermissionController/res/values-mk-v35/strings.xml b/PermissionController/res/values-mk-v35/strings.xml
new file mode 100644
index 000000000..3690e7e0e
--- /dev/null
+++ b/PermissionController/res/values-mk-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Безбедност"</string>
+</resources>
diff --git a/PermissionController/res/values-mk/strings.xml b/PermissionController/res/values-mk/strings.xml
index fe8d2cc09..2fdd35649 100644
--- a/PermissionController/res/values-mk/strings.xml
+++ b/PermissionController/res/values-mk/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"дозволи"</string>
     <string name="cancel" msgid="8943320028373963831">"Откажи"</string>
     <string name="back" msgid="6249950659061523680">"Назад"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Затвори"</string>
     <string name="available" msgid="6007778121920339498">"Дозволен"</string>
     <string name="blocked" msgid="9195547604866033708">"Блокиран"</string>
     <string name="on" msgid="280241003226755921">"Вклучено"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Нема"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Стандардно за системот)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Нема апликации"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Други услуги за NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Избрана"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Избрана - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"посебен пристап за апликации"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Пристапено вчера: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Пристапено: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Вашата еднократна лозинка е 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Дозволете ограничени поставки"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ограничена поставка"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"За ваша безбедност, поставкава е недостапна во моментов."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Барањето за пристап на апликацијата до <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> е одбиено"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Во ред"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Барањето за дозвола е потиснато"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Апликацијава бара дополнителни дозволи, но нив не може да ги доделите во сесија за стриминг. Прво доделете ја дозволата на вашиот телефон."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"За итен повик или порака"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Локацијата е испратена до службите за итни случаи"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Оваа апликација пристапи до локацијата на вашиот уред при размена на повик или пораки со број за итни случаи. Ова може да се случи дури и кога апликацијата нема дозвола за локација или кога локацијата на уредот е исклучена. "<a href="https://support.google.com/android/answer/9319337">"Дознајте повеќе"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Проверете го телефонот"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Не можеше да се контактира со телефонот"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Ќе се обидете повторно?"</string>
 </resources>
diff --git a/PermissionController/res/values-ml-v35/strings.xml b/PermissionController/res/values-ml-v35/strings.xml
new file mode 100644
index 000000000..7d3552e5f
--- /dev/null
+++ b/PermissionController/res/values-ml-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"സുരക്ഷ"</string>
+</resources>
diff --git a/PermissionController/res/values-ml/strings.xml b/PermissionController/res/values-ml/strings.xml
index 94f0cefbd..09ea9e376 100644
--- a/PermissionController/res/values-ml/strings.xml
+++ b/PermissionController/res/values-ml/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"അനുമതികൾ"</string>
     <string name="cancel" msgid="8943320028373963831">"റദ്ദാക്കുക"</string>
     <string name="back" msgid="6249950659061523680">"മടങ്ങുക"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"അടയ്ക്കുക"</string>
     <string name="available" msgid="6007778121920339498">"ലഭ്യമാണ്"</string>
     <string name="blocked" msgid="9195547604866033708">"ബ്ലോക്ക് ചെയ്‌തിരിക്കുന്നു"</string>
     <string name="on" msgid="280241003226755921">"ഓണാണ്"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ഒന്നുമില്ല"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(സിസ്‌റ്റം ഡിഫോൾട്ട്)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"ആപ്പുകൾ ഒന്നുമില്ല"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"മറ്റ് NFC സേവനങ്ങൾ"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"തിരഞ്ഞെടുത്തു"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"<xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g> - തിരഞ്ഞെടുത്തു"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"പ്രത്യേക ആപ്പ് ആക്‌സസ്"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"ഇന്നലെ <xliff:g id="TIME_DATE">%1$s</xliff:g>-ന് ആക്‌സസ് ചെയ്തു"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>-ന് ആക്‌സസ് ചെയ്തു"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"നിങ്ങളുടെ ഒറ്റത്തവണ പാസ്‌വേഡ് 132435 ആണ്"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"നിയന്ത്രിത ക്രമീകരണം അനുവദിക്കുക"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"നിയന്ത്രിത ക്രമീകരണം"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"നിങ്ങളുടെ സുരക്ഷയ്ക്ക്, ഈ ക്രമീകരണം നിലവിൽ ലഭ്യമല്ല."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"ആപ്പിന് <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> എന്നതിലേക്കുള്ള ആക്‌സസ് നിരസിച്ചു"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ശരി"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"അനുമതി അഭ്യർത്ഥന കാഴ്ച്ചയിൽ നിന്ന് മറച്ചു"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ഈ ആപ്പ് അധിക അനുമതികൾ അഭ്യർത്ഥിക്കുന്നു, എന്നാൽ സ്‌ട്രീമിംഗ് സെഷനിടയിൽ അനുമതികൾ നൽകാനാകില്ല. ആദ്യം നിങ്ങളുടെ ഫോണിൽ അനുമതി നൽകുക."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"എമർജൻസി കോളിനോ ടെക്സ്റ്റിനോ ആയി"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"അടിയന്തര സേവനങ്ങളിലേക്ക് ലൊക്കേഷൻ അയച്ചു"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"അടിയന്തര നമ്പറിലേക്ക് ഒരു കോൾ ചെയ്യുമ്പോഴോ ടെക്സ്റ്റ് ചെയ്യുമ്പോഴോ ഈ ആപ്പ് നിങ്ങളുടെ ഉപകരണത്തിന്റെ ലൊക്കേഷൻ ആക്‌സസ് ചെയ്തു. ആപ്പിന് ലൊക്കേഷൻ അനുമതി ഇല്ലാത്തപ്പോഴോ ഉപകരണ ലൊക്കേഷൻ ഓഫായിരിക്കുമ്പോഴോ പോലും ഇത് സംഭവിക്കാം. "<a href="https://support.google.com/android/answer/9319337">"കൂടുതലറിയുക"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"നിങ്ങളുടെ ഫോൺ പരിശോധിക്കുക"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"നിങ്ങളുടെ ഫോണുമായി കണക്റ്റ് ചെയ്യാനായില്ല"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"വീണ്ടും ശ്രമിക്കണോ?"</string>
 </resources>
diff --git a/PermissionController/res/values-mn-v35/strings.xml b/PermissionController/res/values-mn-v35/strings.xml
new file mode 100644
index 000000000..cb9e18162
--- /dev/null
+++ b/PermissionController/res/values-mn-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Аюулгүй байдал"</string>
+</resources>
diff --git a/PermissionController/res/values-mn/strings.xml b/PermissionController/res/values-mn/strings.xml
index ea1b653e3..c705e388b 100644
--- a/PermissionController/res/values-mn/strings.xml
+++ b/PermissionController/res/values-mn/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"зөвшөөрөл"</string>
     <string name="cancel" msgid="8943320028373963831">"Болих"</string>
     <string name="back" msgid="6249950659061523680">"Буцах"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Хаах"</string>
     <string name="available" msgid="6007778121920339498">"Боломжтой"</string>
     <string name="blocked" msgid="9195547604866033708">"Блоклосон"</string>
     <string name="on" msgid="280241003226755921">"Асаалттай"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Тохируулсан апп алга"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Системийн өгөгдмөл)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Апп алга"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Бусад NFC үйлчилгээ"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Сонгосон"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Сонгосон - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"аппын тусгай хандалт"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Өчигдөр <xliff:g id="TIME_DATE">%1$s</xliff:g>-д хандсан"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>-д хандсан"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Таны нэг удаагийн нууц үг бол 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Хязгаарлагдсан тохиргоог зөвшөөрөх"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Хязгаарлагдсан тохиргоо"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Таны аюулгүй байдлын үүднээс энэ тохиргоо одоогоор боломжгүй байна."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Аппад <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>-д хандах эрх олгохоос татгалзсан"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ОК"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Зөвшөөрлийн хүсэлтийг зогсоосон"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Энэ апп нэмэлт зөвшөөрөл хүсэж байгаа ч дамжуулалтын харилцан үйлдлийн үеэр зөвшөөрөл олгох боломжгүй. Эхлээд утсан дээрээ зөвшөөрөл олгоно уу."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Яаралтай дуудлага хийх эсвэл мессеж илгээх зорилгоор"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Байршлыг яаралтай тусламжийн үйлчилгээнүүд рүү илгээсэн"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Энэ апп яаралтай тусламжийн утасны дугаар луу хийсэн дуудлага эсвэл илгээсэн мессежийн үеэр таны төхөөрөмжийн байршилд хандсан. Энэ нь аппад байршлын зөвшөөрөл байхгүй эсвэл төхөөрөмжийн байршил унтраалттай байсан ч тохиолдож болно. "<a href="https://support.google.com/android/answer/9319337">"Нэмэлт мэдээлэл авах"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Утсаа шалгах"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Таны утастай холбогдож чадсангүй"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Дахин оролдох уу?"</string>
 </resources>
diff --git a/PermissionController/res/values-mr-v35/strings.xml b/PermissionController/res/values-mr-v35/strings.xml
new file mode 100644
index 000000000..3d8a7dedf
--- /dev/null
+++ b/PermissionController/res/values-mr-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"सुरक्षा"</string>
+</resources>
diff --git a/PermissionController/res/values-mr/strings.xml b/PermissionController/res/values-mr/strings.xml
index ce1621bbc..72f121d1c 100644
--- a/PermissionController/res/values-mr/strings.xml
+++ b/PermissionController/res/values-mr/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"परवानग्या"</string>
     <string name="cancel" msgid="8943320028373963831">"रद्द करा"</string>
     <string name="back" msgid="6249950659061523680">"मागे जा"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"बंद करा"</string>
     <string name="available" msgid="6007778121920339498">"उपलब्ध आहे"</string>
     <string name="blocked" msgid="9195547604866033708">"ब्लॉक केला आहे"</string>
     <string name="on" msgid="280241003226755921">"सुरू आहे"</string>
@@ -86,7 +87,7 @@
     <string name="app_permissions_group_summary" msgid="8788419008958284002">"<xliff:g id="COUNT_1">%2$d</xliff:g> पैकी <xliff:g id="COUNT_0">%1$d</xliff:g> अ‍ॅप्सना परवानगी दिली"</string>
     <string name="app_permissions_group_summary2" msgid="4329922444840521150">"<xliff:g id="COUNT_0">%1$d</xliff:g>/<xliff:g id="COUNT_1">%2$d</xliff:g> अ‍ॅप्सना अनुमती आहे"</string>
     <string name="menu_show_system" msgid="4254021607027872504">"सिस्टीम दाखवा"</string>
-    <string name="menu_hide_system" msgid="3855390843744028465">"सिस्टम लपवा"</string>
+    <string name="menu_hide_system" msgid="3855390843744028465">"सिस्टीम लपवा"</string>
     <string name="menu_show_7_days_data" msgid="8979611198508523706">"सात दिवस दाखवा"</string>
     <string name="menu_show_24_hours_data" msgid="8228054833323380780">"२४ तास दाखवा"</string>
     <string name="manage_permission" msgid="2895385393037061964">"परवानगी व्यवस्थापित करा"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"काहीही नाही"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(सिस्टम डीफॉल्ट)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"अ‍ॅप्स नाहीत"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"इतर NFC सेवा"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"निवडले"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"निवडले - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"विशेष अ‍ॅप अ‍ॅक्सेस"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"काल <xliff:g id="TIME_DATE">%1$s</xliff:g> वाजता ॲक्सेस केले"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> ला <xliff:g id="TIME_DATE_1">%2$s</xliff:g> वाजता ॲक्सेस केले"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"तुमचा वन टाइम पासवर्ड १३२४३५ हा आहे"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"प्रतिबंधित सेटिंग्जना अनुमती द्या"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"प्रतिबंधित सेटिंग"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"तुमच्या सुरक्षेसाठी, हे सेटिंग सध्या उपलब्ध नाही."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"अ‍ॅपचा <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> साठीचा अ‍ॅक्सेस नाकारला गेला आहे"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ओके"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"परवानगी मागणारी विनंती सप्रेस केली आहे"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"हे ॲप अतिरिक्त परवानग्यांची विनंती करत आहे, पण स्ट्रीमिंग सेशनदरम्यान परवानग्या दिल्या जाऊ शकत नाहीत. आधी तुमच्या फोनवर परवानगी द्या."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"आणीबाणी कॉल करण्यासाठी किंवा एसएमएस पाठवण्यासाठी"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"आणीबाणी सेवांना स्थान पाठवले आहे"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"आणीबाणी नंबरवर कॉल करत असताना किंवा एसएमएस पाठवत असताना या ॲपने तुमच्या डिव्हाइसचे स्थान ॲक्सेस केले आहे. ॲपकडे स्थान परवानगी नसताना किंवा डिव्हाइसचे स्थान बंद असतानादेखील हे होऊ शकते. "<a href="https://support.google.com/android/answer/9319337">"अधिक जाणून घ्या"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"तुमचा फोन तपासा"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"तुमच्या फोनशी कनेक्ट करता आले नाही"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"पुन्हा प्रयत्न करायचा आहे का?"</string>
 </resources>
diff --git a/PermissionController/res/values-ms-v35/strings.xml b/PermissionController/res/values-ms-v35/strings.xml
new file mode 100644
index 000000000..f09b6ea0e
--- /dev/null
+++ b/PermissionController/res/values-ms-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Keselamatan"</string>
+</resources>
diff --git a/PermissionController/res/values-ms/strings.xml b/PermissionController/res/values-ms/strings.xml
index d12d0797c..6b65594b4 100644
--- a/PermissionController/res/values-ms/strings.xml
+++ b/PermissionController/res/values-ms/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"kebenaran"</string>
     <string name="cancel" msgid="8943320028373963831">"Batal"</string>
     <string name="back" msgid="6249950659061523680">"Kembali"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Tutup"</string>
     <string name="available" msgid="6007778121920339498">"Tersedia"</string>
     <string name="blocked" msgid="9195547604866033708">"Disekat"</string>
     <string name="on" msgid="280241003226755921">"Hidup"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Tiada"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Ciri lalai sistem)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Tiada apl"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Perkhidmatan NFC yang lain"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Dipilih"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Dipilih - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"akses apl khas"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Diakses semalam <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Diakses <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Kata laluan sekali guna anda ialah 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Benarkan tetapan terhad"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Tetapan terhad"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Untuk keselamatan anda, tetapan ini tidak tersedia pada masa ini."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Akses apl kepada <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> telah ditolak"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Permintaan kebenaran disekat"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Apl ini meminta kebenaran tambahan tetapi kebenaran tidak boleh diberikan dalam sesi penstriman. Berikan kebenaran pada telefon anda dahulu."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Untuk panggilan atau teks kecemasan"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Lokasi dihantar kepada perkhidmatan kecemasan"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Apl ini mengakses lokasi peranti anda semasa panggilan atau teks kepada nombor kecemasan. Hal ini boleh berlaku apabila apl tiada kebenaran lokasi atau lokasi peranti telah dimatikan. "<a href="https://support.google.com/android/answer/9319337">"Ketahui lebih lanjut"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Semak telefon anda"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Tidak dapat menyambung kepada telefon anda"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Cuba semula?"</string>
 </resources>
diff --git a/PermissionController/res/values-my-v35/strings.xml b/PermissionController/res/values-my-v35/strings.xml
new file mode 100644
index 000000000..ef994e0a4
--- /dev/null
+++ b/PermissionController/res/values-my-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"လုံခြုံရေး"</string>
+</resources>
diff --git a/PermissionController/res/values-my/strings.xml b/PermissionController/res/values-my/strings.xml
index b5f28bd1b..b29ee2286 100644
--- a/PermissionController/res/values-my/strings.xml
+++ b/PermissionController/res/values-my/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ခွင့်ပြုချက်များ"</string>
     <string name="cancel" msgid="8943320028373963831">"မလုပ်တော့"</string>
     <string name="back" msgid="6249950659061523680">"နောက်သို့"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"ပိတ်ရန်"</string>
     <string name="available" msgid="6007778121920339498">"ရနိုင်သည်"</string>
     <string name="blocked" msgid="9195547604866033708">"ပိတ်ထားသည်"</string>
     <string name="on" msgid="280241003226755921">"ဖွင့်"</string>
@@ -194,7 +195,7 @@
     <string name="app_permission_button_allow_limited_access" msgid="8824410215149764113">"ကန့်သတ်သုံးခြင်းကို ခွင့်ပြုရန်"</string>
     <string name="precise_image_description" msgid="6349638632303619872">"နေရာအတိအကျ"</string>
     <string name="approximate_image_description" msgid="938803699637069884">"တည်နေရာခန့်မှန်းခြေ"</string>
-    <string name="app_permission_location_accuracy" msgid="7166912915040018669">"နေရာအတိအကျကို သုံးခြင်း"</string>
+    <string name="app_permission_location_accuracy" msgid="7166912915040018669">"နေရာအတိအကျ သုံးရန်"</string>
     <string name="app_permission_location_accuracy_subtitle" msgid="2654077606404987210">"နေရာအတိအကျကို ပိတ်ထားသည့်အခါ အက်ပ်များက သင်၏တည်နေရာခန့်မှန်းခြေကို သုံးနိုင်သည်"</string>
     <string name="app_permission_title" msgid="2090897901051370711">"<xliff:g id="PERM">%1$s</xliff:g> ခွင့်ပြုချက်"</string>
     <string name="app_permission_header" msgid="2951363137032603806">"ဤအက်ပ်အတွက် <xliff:g id="PERM">%1$s</xliff:g> အသုံးပြုခွင့်"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"မရှိ"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(စနစ်မူရင်း)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"အက်ပ် မရှိပါ"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"အခြား NFC ဝန်ဆောင်မှုများ"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"ရွေးထားသည်"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"ရွေးထားသည် - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"အက်ပ် အထူးအသုံးပြုခွင့်"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"မနေ့ <xliff:g id="TIME_DATE">%1$s</xliff:g> တွင် ဝင်ကြည့်ထားသည်"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g><xliff:g id="TIME_DATE_1">%2$s</xliff:g> တွင် ဝင်ကြည့်ထားသည်"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"သင့်တစ်ခါသုံး စကားဝှက်သည် 132435 ဖြစ်သည်"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"ကန့်သတ်ဆက်တင်များ ခွင့်ပြုရန်"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"ကန့်သတ်ဆက်တင်"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"သင့်လုံခြုံရေးအတွက် ဤဆက်တင်ကို လောလောဆယ် မရနိုင်ပါ။"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"အက်ပ်ကို <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> သုံးခွင့် ငြင်းပယ်ထားသည်"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"ခွင့်ပြုချက်တောင်းဆိုမှု ပိတ်ထားသည်"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ဤအက်ပ်သည် နောက်ထပ်ခွင့်ပြုချက်များကို တောင်းဆိုနေသော်လည်း တိုက်ရိုက်လွှင့်စက်ရှင်တွင် ခွင့်ပြုချက်များ ပေး၍မရပါ။ သင့်ဖုန်းတွင် ဦးစွာ ခွင့်ပြုချက်ပေးပါ။"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"အရေးပေါ်ဖုန်းခေါ်ခြင်း (သို့) စာတိုပို့ခြင်းအတွက်"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"အရေးပေါ်ဝန်ဆောင်မှုများထံ တည်နေရာ ပို့ထားသည်"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"အရေးပေါ် နံပါတ်ထံ ဖုန်းခေါ် (သို့) စာတိုပို့နေစဉ် ဤအက်ပ်သည် သင့်စက်ပစ္စည်း၏ တည်နေရာကို သုံးထားသည်။ အက်ပ်တွင် တည်နေရာခွင့်ပြုချက် မရှိလည်း (သို့) စက်ပစ္စည်းတည်နေရာကို ပိတ်ထားလည်း ဤသို့ဖြစ်နိုင်သည်။ "<a href="https://support.google.com/android/answer/9319337">"ပိုမိုလေ့လာရန်"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"သင့်ဖုန်းကို စစ်ဆေးပါ"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"သင့်ဖုန်းကို ချိတ်ဆက်၍မရပါ"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"ထပ်စမ်းကြည့်မလား။"</string>
 </resources>
diff --git a/PermissionController/res/values-nb-v35/strings.xml b/PermissionController/res/values-nb-v35/strings.xml
new file mode 100644
index 000000000..0e03b1f53
--- /dev/null
+++ b/PermissionController/res/values-nb-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Sikkerhet"</string>
+</resources>
diff --git a/PermissionController/res/values-nb/strings.xml b/PermissionController/res/values-nb/strings.xml
index 4266195b7..bb6cb00d5 100644
--- a/PermissionController/res/values-nb/strings.xml
+++ b/PermissionController/res/values-nb/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"tillatelser"</string>
     <string name="cancel" msgid="8943320028373963831">"Avbryt"</string>
     <string name="back" msgid="6249950659061523680">"Tilbake"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Lukk"</string>
     <string name="available" msgid="6007778121920339498">"Tilgjengelig"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokkert"</string>
     <string name="on" msgid="280241003226755921">"På"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ingen"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(System-&amp;shy;standard)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Ingen apper"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Andre NFC-tjenester"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Valgt"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Valgt – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"spesiell apptilgang"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Åpnet i går <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Åpnet <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Engangspassordet ditt er 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Tillat begrensede innstillinger"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Begrenset innstilling"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Av sikkerhetshensyn er denne innstillingen utilgjengelig for øyeblikket."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Appens tilgang til <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> ble avvist"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Forespørselen om tillatelse er skjult"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Denne appen ber om flere tillatelser, men du kan ikke gi tillatelser i en strømmeøkt. Gi tillatelsen på telefonen først."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"For nødanrop eller -meldinger"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Posisjonen er sendt til nødtjenester"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Denne appen leste posisjonen til enheten din under et anrop eller ved en melding til et nødnummer. Dette kan skje selv om enhetens posisjon er slått av eller appen ikke har posisjonstillatelse. "<a href="https://support.google.com/android/answer/9319337">"Finn ut mer"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Sjekk telefonen"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Fikk ikke kontakt med telefonen din"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Vil du prøve på nytt?"</string>
 </resources>
diff --git a/PermissionController/res/values-ne-v35/strings.xml b/PermissionController/res/values-ne-v35/strings.xml
new file mode 100644
index 000000000..3d8a7dedf
--- /dev/null
+++ b/PermissionController/res/values-ne-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"सुरक्षा"</string>
+</resources>
diff --git a/PermissionController/res/values-ne/strings.xml b/PermissionController/res/values-ne/strings.xml
index 9fff915f1..1a5c620c1 100644
--- a/PermissionController/res/values-ne/strings.xml
+++ b/PermissionController/res/values-ne/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"अनुमतिहरू"</string>
     <string name="cancel" msgid="8943320028373963831">"रद्द गर्नुहोस्"</string>
     <string name="back" msgid="6249950659061523680">"पछाडि जानुहोस्"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"बन्द गर्नुहोस्"</string>
     <string name="available" msgid="6007778121920339498">"उपलब्ध"</string>
     <string name="blocked" msgid="9195547604866033708">"ब्लक गरिएको"</string>
     <string name="on" msgid="280241003226755921">"अन छ"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"कुनै पनि होइन"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(सिस्टम डिफल्ट)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"कुनै पनि एप छैन"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"NFC का अन्य सेवाहरू"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"चयन गरिएको"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"चयन गरिएको - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"एपसम्बन्धी विशेष पहुँच"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"हिजो <xliff:g id="TIME_DATE">%1$s</xliff:g> मा एक्सेस गरिएको"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g> मा एक्सेस गरिएको"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"तपाईंको एक पटके पासवर्ड 132435 हो"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"प्रतिबन्ध लगाइएका सेटिङ अनलक गर्नुहोस्"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"प्रतिबन्ध लगाइएका सेटिङ"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"तपाईंको खाताको सुरक्षार्थ यो सेटिङ हाल उपलब्ध छैन।"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"एपले <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> प्रयोग गर्न मागेको अनुमति अस्वीकार गरिएको छ"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ठिक छ"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"अनुमतिसम्बन्धी अनुरोध रद्द गरिएको छ"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"यो एपले अतिरिक्त अनुमति मागिरहेको छ तर स्ट्रिमिङ सत्रमा अनुमति दिन मिल्दैन। सर्वप्रथम आफ्नो फोनमा अनुमति दिनुहोस्।"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"आपत्कालीन अवस्थामा यो नम्बरमा कल गर्नुहोस् वा टेक्स्ट म्यासेज पठाउनुहोस्"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"आपत्कालीन सेवाहरूमा लोकेसन पठाइएको छ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"यो एपले आपत्कालीन नम्बरमा कल वा टेक्स्ट म्यासेज गर्ने बेलामा तपाईंको डिभाइसको लोकेसन एक्सेस गरेको छ। यो एपलाई लोकेसन प्रयोग गर्ने अनुमति नदिइएका वा यो डिभाइसको लोकेसन अफ गरिएका अवस्थामा पनि यस्तो हुन सक्छ। "<a href="https://support.google.com/android/answer/9319337">"थप जान्नुहोस्"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"आफ्नो फोनमा हेर्नुहोस्"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"तपाईंको फोनमा कनेक्ट गर्न सकिएन"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"पुनः प्रयास गर्ने हो?"</string>
 </resources>
diff --git a/PermissionController/res/values-night/themes.xml b/PermissionController/res/values-night/themes.xml
index 7ac9b190b..8c6a10db5 100644
--- a/PermissionController/res/values-night/themes.xml
+++ b/PermissionController/res/values-night/themes.xml
@@ -41,4 +41,6 @@
     </style>
 
     <style name="Theme.DeviceDefault.Dialog.NoActionBar.DayNight" parent="@android:style/Theme.DeviceDefault.Dialog.NoActionBar" />
+
+    <style name="Theme.DeviceDefault.Dialog.Alert.DayNight" parent="@android:style/Theme.DeviceDefault.Dialog.Alert" />
 </resources>
diff --git a/PermissionController/res/values-nl-v35/strings.xml b/PermissionController/res/values-nl-v35/strings.xml
new file mode 100644
index 000000000..f38159c4d
--- /dev/null
+++ b/PermissionController/res/values-nl-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Beveiliging"</string>
+</resources>
diff --git a/PermissionController/res/values-nl/strings.xml b/PermissionController/res/values-nl/strings.xml
index 9454dfd1d..64cba5c57 100644
--- a/PermissionController/res/values-nl/strings.xml
+++ b/PermissionController/res/values-nl/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"rechten"</string>
     <string name="cancel" msgid="8943320028373963831">"Annuleren"</string>
     <string name="back" msgid="6249950659061523680">"Terug"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Sluiten"</string>
     <string name="available" msgid="6007778121920339498">"Beschikbaar"</string>
     <string name="blocked" msgid="9195547604866033708">"Geblokkeerd"</string>
     <string name="on" msgid="280241003226755921">"Aan"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Geen"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Systeem­standaard)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Geen apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Andere NFC-services"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Geselecteerd"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Geselecteerd: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"speciale app-toegang"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Geopend: gisteren om <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Geopend: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> om <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Je eenmalige wachtwoord is 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Beperkte instellingen toestaan"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Beperkte instelling"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Ter beveiliging is deze instelling op dit moment niet beschikbaar."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"App heeft geen toegang gekregen tot <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Verzoek om rechten onderdrukt"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Deze app vraagt om extra rechten, maar je kunt geen rechten verlenen tijdens een streamingsessie. Verleen het recht eerst op je telefoon."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Voor noodoproep of -tekstbericht"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Locatie naar de hulpdiensten gestuurd"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Deze app heeft toegang gehad tot de locatie van je apparaat tijdens een gesprek met of tekstbericht naar een alarmnummer. Dit kan ook gebeuren als de app geen locatierechten heeft of als de apparaatlocatie uitstaat. "<a href="https://support.google.com/android/answer/9319337">"Meer informatie"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Check je telefoon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Kan je telefoon niet bereiken"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Opnieuw proberen?"</string>
 </resources>
diff --git a/PermissionController/res/values-or-television/strings.xml b/PermissionController/res/values-or-television/strings.xml
index 2859cc59e..181c9640c 100644
--- a/PermissionController/res/values-or-television/strings.xml
+++ b/PermissionController/res/values-or-television/strings.xml
@@ -20,7 +20,7 @@
     <string name="grant_dialog_how_to_change" msgid="997462845048160559">"ଏହାକୁ ଆପଣ ପରେ ଆପ୍ସ ସେଟିଂସ୍‌ରେ&gt; ବଦଳାଇପାରିବେ"</string>
     <string name="current_permission_template" msgid="6240787325714651204">"<xliff:g id="CURRENT_PERMISSION_INDEX">%1$s</xliff:g> / <xliff:g id="PERMISSION_COUNT">%2$s</xliff:g>"</string>
     <string name="preference_show_system_apps" msgid="4262140518693221093">"ସିଷ୍ଟମ୍‍ ଆପ୍ସ ଦେଖାନ୍ତୁ"</string>
-    <string name="app_permissions_decor_title" msgid="7438716722786036814">"ଆପ ଅନୁମତିଗୁଡ଼ିକ"</string>
+    <string name="app_permissions_decor_title" msgid="7438716722786036814">"ଆପ ଅନୁମତି"</string>
     <string name="manage_permissions_decor_title" msgid="4138423885439613577">"ଆପ ଅନୁମତିଗୁଡ଼ିକ"</string>
     <string name="permission_apps_decor_title" msgid="2811550489429789828">"<xliff:g id="PERMISSION">%1$s</xliff:g> ଅନୁମତିଗୁଡ଼ିକ"</string>
     <string name="additional_permissions_decor_title" msgid="5113847982502484225">"ଅତିରିକ୍ତ ଅନୁମତି"</string>
diff --git a/PermissionController/res/values-or-v35/strings.xml b/PermissionController/res/values-or-v35/strings.xml
new file mode 100644
index 000000000..56dc78f79
--- /dev/null
+++ b/PermissionController/res/values-or-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"ସୁରକ୍ଷା"</string>
+</resources>
diff --git a/PermissionController/res/values-or/strings.xml b/PermissionController/res/values-or/strings.xml
index 1e76a53f3..34a2de9e7 100644
--- a/PermissionController/res/values-or/strings.xml
+++ b/PermissionController/res/values-or/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ଅନୁମତିଗୁଡ଼ିକ"</string>
     <string name="cancel" msgid="8943320028373963831">"ବାତିଲ କରନ୍ତୁ"</string>
     <string name="back" msgid="6249950659061523680">"ପଛକୁ ଫେରନ୍ତୁ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"ବନ୍ଦ କରନ୍ତୁ"</string>
     <string name="available" msgid="6007778121920339498">"ଉପଲବ୍ଧ ଅଛି"</string>
     <string name="blocked" msgid="9195547604866033708">"ବ୍ଲକ କରାଯାଇଛି"</string>
     <string name="on" msgid="280241003226755921">"ଚାଲୁ ଅଛି"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"କିଛି ଆପ ସେଟ କରାଯାଇନାହିଁ"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(ସିଷ୍ଟମ୍ ଡିଫଲ୍ଟ)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"କୌଣସି ଆପ୍‌ ନାହିଁ"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"ଅନ୍ୟ NFC ସେବା"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"ଚୟନ କରାଯାଇଛି"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"ଚୟନ କରାଯାଇଛି - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ବିଶେଷ ଆପ୍‌ ଆକ୍ସେସ୍‌"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"ଗତକାଲି <xliff:g id="TIME_DATE">%1$s</xliff:g>ରେ ଆକ୍ସେସ କରାଯାଇଛି"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>ରେ ଆକ୍ସେସ କରାଯାଇଛି"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"ଆପଣଙ୍କ ଗୋଟିଏ ଥରର ପାସୱାର୍ଡ ହେଉଛି 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"ପ୍ରତିବନ୍ଧିତ ସେଟିଂସକୁ ଅନୁମତି ଦିଅନ୍ତୁ"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"ପ୍ରତିବନ୍ଧିତ ସେଟିଂ"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"ଆପଣଙ୍କ ସୁରକ୍ଷା ପାଇଁ ଏହି ସେଟିଂ ବର୍ତ୍ତମାନ ଅନୁପଲବ୍ଧ ଅଟେ।"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>କୁ ଆପର ଆକ୍ସେସକୁ ଅଗ୍ରାହ୍ୟ କରାଯାଇଛି"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ଠିକ ଅଛି"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"ଅନୁମତି ଅନୁରୋଧକୁ ବନ୍ଦ କରାଯାଇଛି"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ଏହି ଆପ ଅତିରିକ୍ତ ଅନୁମତି ପାଇଁ ଅନୁରୋଧ କରୁଛି, ଏକ ଷ୍ଟ୍ରିମିଂ ସେସନରେ ଅନୁମତି ଦିଆଯାଇପାରିବ ନାହିଁ। ପ୍ରଥମେ ଆପଣଙ୍କ ଫୋନରେ ଅନୁମତି ଦିଅନ୍ତୁ।"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"ଜରୁରୀକାଳୀନ କଲ କିମ୍ବା ଟେକ୍ସଟ ପାଇଁ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ଜରୁରୀକାଳୀନ ସେବାଗୁଡ଼ିକୁ ଲୋକେସନ ପଠାଯାଇଛି"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"ଏକ ଜରୁରୀକାଳୀନ ନମ୍ବରକୁ କଲ କରାଯିବା କିମ୍ବା ଟେକ୍ସଟ ପଠାଇବା ସମୟରେ ଏହି ଆପ ଆପଣଙ୍କ ଡିଭାଇସର ଲୋକେସନକୁ ଆକ୍ସେସ କରିଛି। ଆପ ପାଖରେ ଲୋକେସନ ଅନୁମତି ନଥିଲେ କିମ୍ବା ଡିଭାଇସର ଲୋକେସନ ବନ୍ଦ ଥିଲେ ମଧ୍ୟ ଏହା ହୋଇପାରେ। "<a href="https://support.google.com/android/answer/9319337">"ଅଧିକ ଜାଣନ୍ତୁ"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"ଆପଣଙ୍କ ଫୋନ ଯାଞ୍ଚ କରନ୍ତୁ"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"ଆପଣଙ୍କ ଫୋନ ସହ କନେକ୍ଟ କରାଯାଇପାରିଲା ନାହିଁ"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"ପୁଣି ଚେଷ୍ଟା କରିବେ?"</string>
 </resources>
diff --git a/PermissionController/res/values-pa-v35/strings.xml b/PermissionController/res/values-pa-v35/strings.xml
new file mode 100644
index 000000000..f6cd2ad56
--- /dev/null
+++ b/PermissionController/res/values-pa-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"ਸੁਰੱਖਿਆ"</string>
+</resources>
diff --git a/PermissionController/res/values-pa/strings.xml b/PermissionController/res/values-pa/strings.xml
index f00741f53..f2f099d61 100644
--- a/PermissionController/res/values-pa/strings.xml
+++ b/PermissionController/res/values-pa/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ਇਜਾਜ਼ਤਾਂ"</string>
     <string name="cancel" msgid="8943320028373963831">"ਰੱਦ ਕਰੋ"</string>
     <string name="back" msgid="6249950659061523680">"ਪਿੱਛੇ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"ਬੰਦ ਕਰੋ"</string>
     <string name="available" msgid="6007778121920339498">"ਉਪਲਬਧ ਹੈ"</string>
     <string name="blocked" msgid="9195547604866033708">"ਬਲਾਕ ਹੈ"</string>
     <string name="on" msgid="280241003226755921">"ਚਾਲੂ ਹੈ"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ਕੋਈ ਨਹੀਂ"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(ਸਿਸਟਮ ਪੂਰਵ-ਨਿਰਧਾਰਿਤ)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"ਕੋਈ ਐਪਾਂ ਨਹੀਂ"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"ਹੋਰ NFC ਸੇਵਾਵਾਂ"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"ਚੁਣੀ ਗਈ"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"ਚੁਣੀ ਗਈ - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ਖਾਸ ਐਪ ਪਹੁੰਚ"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"<xliff:g id="TIME_DATE">%1$s</xliff:g> ਵਜੇ ਕੱਲ੍ਹ ਪਹੁੰਚ ਕੀਤੀ ਗਈ"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> ਨੂੰ <xliff:g id="TIME_DATE_1">%2$s</xliff:g> ਵਜੇ ਪਹੁੰਚ ਕੀਤੀ ਗਈ"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"ਤੁਹਾਡਾ ਇਕਹਰੀ-ਵਰਤੋਂ ਪਾਸਵਰਡ 132435 ਹੈ"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"ਪ੍ਰਤਿਬੰਧਿਤ ਸੈਟਿੰਗਾਂ ਦੀ ਆਗਿਆ ਦਿਓ"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"ਪ੍ਰਤਿਬੰਧਿਤ ਸੈਟਿੰਗਾਂ"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"ਤੁਹਾਡੀ ਸੁਰੱਖਿਆ ਲਈ, ਫ਼ਿਲਹਾਲ ਇਹ ਸੈਟਿੰਗ ਉਪਲਬਧ ਨਹੀਂ ਹੈ।"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"ਐਪ ਨੂੰ <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> ਤੱਕ ਪਹੁੰਚ ਕਰਨ ਦੀ ਆਗਿਆ ਨਹੀਂ ਦਿੱਤੀ ਗਈ"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ਠੀਕ ਹੈ"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"ਇਜਾਜ਼ਤ ਸੰਬੰਧੀ ਬੇਨਤੀ ਨੂੰ ਰੋਕਿਆ ਗਿਆ"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ਇਹ ਐਪ ਵਧੀਕ ਇਜਾਜ਼ਤਾਂ ਦੀ ਬੇਨਤੀ ਕਰ ਰਹੀ ਹੈ, ਪਰ ਸਟ੍ਰੀਮਿੰਗ ਸੈਸ਼ਨ ਵਿੱਚ ਇਜਾਜ਼ਤਾਂ ਨਹੀਂ ਦਿੱਤੀਆਂ ਜਾ ਸਕਦੀਆਂ। ਪਹਿਲਾਂ ਆਪਣੇ ਫ਼ੋਨ \'ਤੇ ਇਜਾਜ਼ਤ ਦਿਓ।"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"ਐਮਰਜੈਂਸੀ ਕਾਲ ਜਾਂ ਲਿਖਤ ਸੁਨੇਹੇ ਲਈ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ਐਮਰਜੈਂਸੀ ਸੇਵਾਵਾਂ ਨੂੰ ਭੇਜੀ ਗਈ ਟਿਕਾਣਾ ਜਾਣਕਾਰੀ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"ਇਸ ਐਪ ਵੱਲੋਂ ਐਮਰਜੈਂਸੀ ਨੰਬਰ \'ਤੇ ਕਾਲ ਕਰਨ ਜਾਂ ਲਿਖਤ ਸੁਨੇਹਾ ਭੇਜਣ ਦੌਰਾਨ ਤੁਹਾਡੇ ਡੀਵਾਈਸ ਦੇ ਟਿਕਾਣੇ ਤੱਕ ਪਹੁੰਚ ਕੀਤੀ ਗਈ। ਇਹ ਉਦੋਂ ਵੀ ਹੋ ਸਕਦਾ ਹੈ, ਜਦੋਂ ਐਪ ਕੋਲ ਟਿਕਾਣੇ ਦੀ ਇਜਾਜ਼ਤ ਨਹੀਂ ਹੁੰਦੀ ਹੈ ਜਾਂ ਡੀਵਾਈਸ ਦੀ ਟਿਕਾਣਾ ਸੁਵਿਧਾ ਬੰਦ ਹੁੰਦੀ ਹੈ। "<a href="https://support.google.com/android/answer/9319337">"ਹੋਰ ਜਾਣੋ"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"ਆਪਣੇ ਫ਼ੋਨ ਦੀ ਜਾਂਚ ਕਰੋ"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"ਤੁਹਾਡੇ ਫ਼ੋਨ ਤੱਕ ਪਹੁੰਚ ਨਹੀਂ ਕੀਤੀ ਜਾ ਸਕੀ"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"ਕੀ ਮੁੜ-ਕੋਸ਼ਿਸ਼ ਕਰਨੀ ਹੈ?"</string>
 </resources>
diff --git a/PermissionController/res/values-pl-v35/strings.xml b/PermissionController/res/values-pl-v35/strings.xml
new file mode 100644
index 000000000..441703f88
--- /dev/null
+++ b/PermissionController/res/values-pl-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Bezpieczeństwo"</string>
+</resources>
diff --git a/PermissionController/res/values-pl/strings.xml b/PermissionController/res/values-pl/strings.xml
index 3e402cb98..0b40b41f6 100644
--- a/PermissionController/res/values-pl/strings.xml
+++ b/PermissionController/res/values-pl/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"uprawnienia"</string>
     <string name="cancel" msgid="8943320028373963831">"Anuluj"</string>
     <string name="back" msgid="6249950659061523680">"Wstecz"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Zamknij"</string>
     <string name="available" msgid="6007778121920339498">"Odblokowany"</string>
     <string name="blocked" msgid="9195547604866033708">"Zablokowany"</string>
     <string name="on" msgid="280241003226755921">"Włączona"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Brak"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Domyślna aplikacja systemowa)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Brak aplikacji"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Inne usługi NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Wybrana"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Wybrana – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"aplikacje ze specjalnym dostępem"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Ostatni dostęp wczoraj, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Ostatni dostęp <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Twoje hasło jednorazowe to 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Zezwól na ustawienia z ograniczonym dostępem"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ustawienie z ograniczonym dostępem"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Ze względów bezpieczeństwa to ustawienie jest obecnie niedostępne."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikacja nie otrzymała dostępu do uprawnień <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Prośba o uprawnienia została zablokowana"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Ta aplikacja prosi o dodatkowe uprawnienia, ale nie można ich przyznać w trakcie sesji strumieniowania. Najpierw przyznaj te uprawnienia na telefonie."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Na potrzeby połączenia lub SMS-a alarmowego"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Lokalizacja została wysłana do służb ratunkowych"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Ta aplikacja uzyskała dostęp do lokalizacji Twojego urządzenia podczas połączenia z numerem alarmowym lub wysyłania SMS-a pod ten numer. Może się tak zdarzyć, nawet jeśli aplikacja nie ma uprawnień do lokalizacji lub gdy lokalizacja jest wyłączona na urządzeniu. "<a href="https://support.google.com/android/answer/9319337">"Więcej informacji"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Sprawdź telefon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Nie można połączyć się z telefonem"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Spróbować ponownie?"</string>
 </resources>
diff --git a/PermissionController/res/values-pt-rBR-v35/strings.xml b/PermissionController/res/values-pt-rBR-v35/strings.xml
new file mode 100644
index 000000000..96603658a
--- /dev/null
+++ b/PermissionController/res/values-pt-rBR-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Segurança"</string>
+</resources>
diff --git a/PermissionController/res/values-pt-rBR/strings.xml b/PermissionController/res/values-pt-rBR/strings.xml
index 3bb55bfbf..330ee5680 100644
--- a/PermissionController/res/values-pt-rBR/strings.xml
+++ b/PermissionController/res/values-pt-rBR/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permissões"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancelar"</string>
     <string name="back" msgid="6249950659061523680">"Voltar"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Fechar"</string>
     <string name="available" msgid="6007778121920339498">"Disponível"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloqueado"</string>
     <string name="on" msgid="280241003226755921">"Ativado"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nenhuma"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Padrão do sistema)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nenhum app"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Outros serviços de NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selecionado"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selecionado: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"Acesso especial para apps"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Último acesso: ontem, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Último acesso: <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Sua senha única é 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Permitir configurações restritas"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Configuração restrita"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Para sua segurança, essa configuração está indisponível no momento."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"O app não recebeu a seguinte permissão de acesso: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Solicitação de permissão suprimida"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Esse app está solicitando permissões extras, mas elas não podem ser concedidas em uma sessão de streaming. Dê permissão pelo smartphone primeiro."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Para uma chamada ou mensagem de texto de emergência"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Localização enviada aos serviços de emergência"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"O app acessou a localização do seu dispositivo durante uma ligação ou mensagem de texto para um número de emergência. Isso pode acontecer mesmo quando o app não tem permissão de localização ou a localização do dispositivo está desativada. "<a href="https://support.google.com/android/answer/9319337">"Saiba mais"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Confira seu smartphone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Não foi possível se conectar ao smartphone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Tentar de novo?"</string>
 </resources>
diff --git a/PermissionController/res/values-pt-rPT-v35/strings.xml b/PermissionController/res/values-pt-rPT-v35/strings.xml
new file mode 100644
index 000000000..96603658a
--- /dev/null
+++ b/PermissionController/res/values-pt-rPT-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Segurança"</string>
+</resources>
diff --git a/PermissionController/res/values-pt-rPT/strings.xml b/PermissionController/res/values-pt-rPT/strings.xml
index efccb407e..590f15b2a 100644
--- a/PermissionController/res/values-pt-rPT/strings.xml
+++ b/PermissionController/res/values-pt-rPT/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"autorizações"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancelar"</string>
     <string name="back" msgid="6249950659061523680">"Anterior"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Fechar"</string>
     <string name="available" msgid="6007778121920339498">"Disponível"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloqueado"</string>
     <string name="on" msgid="280241003226755921">"Ativado"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nenhuma"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Predefinição do sistema)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Sem apps"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Outros serviços NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selecionada"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selecionada – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"acesso especial a apps"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Acedido ontem à(s) <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Acedido a <xliff:g id="TIME_DATE_0">%1$s</xliff:g> à(s) <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"A sua palavra-passe de utilização única é 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Permitir definições restritas"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Definição restrita"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Para sua segurança, esta definição está indisponível atualmente."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"O acesso a <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> foi negado à app"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Pedido de autorização suprimido"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Esta app está a pedir autorizações adicionais, mas não é possível conceder autorizações numa sessão de streaming. Comece por conceder a autorização no seu telemóvel."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Para chamada ou mensagem de texto de emergência"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Localização enviada aos serviços de emergência"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Esta app acedeu à localização do seu dispositivo durante uma chamada ou o envio de uma mensagem de texto para um número de emergência. Isto pode acontecer mesmo quando a app não tem autorização de acesso à localização ou a localização do dispositivo está desativada. "<a href="https://support.google.com/android/answer/9319337">"Saiba mais"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Verifique o seu telemóvel"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Não foi possível ligar ao telemóvel"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Tentar novamente?"</string>
 </resources>
diff --git a/PermissionController/res/values-pt-v35/strings.xml b/PermissionController/res/values-pt-v35/strings.xml
new file mode 100644
index 000000000..96603658a
--- /dev/null
+++ b/PermissionController/res/values-pt-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Segurança"</string>
+</resources>
diff --git a/PermissionController/res/values-pt/strings.xml b/PermissionController/res/values-pt/strings.xml
index 3bb55bfbf..330ee5680 100644
--- a/PermissionController/res/values-pt/strings.xml
+++ b/PermissionController/res/values-pt/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permissões"</string>
     <string name="cancel" msgid="8943320028373963831">"Cancelar"</string>
     <string name="back" msgid="6249950659061523680">"Voltar"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Fechar"</string>
     <string name="available" msgid="6007778121920339498">"Disponível"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloqueado"</string>
     <string name="on" msgid="280241003226755921">"Ativado"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Nenhuma"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Padrão do sistema)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nenhum app"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Outros serviços de NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selecionado"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selecionado: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"Acesso especial para apps"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Último acesso: ontem, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Último acesso: <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Sua senha única é 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Permitir configurações restritas"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Configuração restrita"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Para sua segurança, essa configuração está indisponível no momento."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"O app não recebeu a seguinte permissão de acesso: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Solicitação de permissão suprimida"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Esse app está solicitando permissões extras, mas elas não podem ser concedidas em uma sessão de streaming. Dê permissão pelo smartphone primeiro."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Para uma chamada ou mensagem de texto de emergência"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Localização enviada aos serviços de emergência"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"O app acessou a localização do seu dispositivo durante uma ligação ou mensagem de texto para um número de emergência. Isso pode acontecer mesmo quando o app não tem permissão de localização ou a localização do dispositivo está desativada. "<a href="https://support.google.com/android/answer/9319337">"Saiba mais"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Confira seu smartphone"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Não foi possível se conectar ao smartphone"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Tentar de novo?"</string>
 </resources>
diff --git a/PermissionController/res/values-ro-v35/strings.xml b/PermissionController/res/values-ro-v35/strings.xml
new file mode 100644
index 000000000..856c75c82
--- /dev/null
+++ b/PermissionController/res/values-ro-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Securitate"</string>
+</resources>
diff --git a/PermissionController/res/values-ro/strings.xml b/PermissionController/res/values-ro/strings.xml
index d6eb7f541..177d5ab17 100644
--- a/PermissionController/res/values-ro/strings.xml
+++ b/PermissionController/res/values-ro/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"permisiuni"</string>
     <string name="cancel" msgid="8943320028373963831">"Anulează"</string>
     <string name="back" msgid="6249950659061523680">"Înapoi"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Închide"</string>
     <string name="available" msgid="6007778121920339498">"Disponibil"</string>
     <string name="blocked" msgid="9195547604866033708">"Blocat"</string>
     <string name="on" msgid="280241003226755921">"Activat"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Niciuna"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Prestabilită de sistem)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nicio aplicație"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Alte servicii NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Selectată"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Selectat - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"acces special pentru aplicații"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Data accesării: ieri, <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Data accesării: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Parola ta unică este 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Permite setările restricționate"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Setare restricționată"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Pentru securitatea ta, setarea este momentan indisponibilă."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Accesul aplicației la <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> a fost refuzat"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Solicitarea de permisiune s-a suprimat"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Aplicația solicită permisiuni suplimentare, dar acestea nu pot fi acordate într-o sesiune de streaming. Acordă permisiunea întâi pe telefon."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Pentru apel sau mesaj de urgență"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Locație trimisă la serviciile de urgență"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Această aplicație a accesat locația dispozitivului când ai inițiat un apel sau ai trimis un mesaj către un număr de urgență. Se poate întâmpla chiar dacă aplicația nu are permisiune pentru locație sau locația dispozitivului este dezactivată."<a href="https://support.google.com/android/answer/9319337">"Află mai mult"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Verifică-ți telefonul"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Nu s-a putut accesa telefonul"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Încerci din nou?"</string>
 </resources>
diff --git a/PermissionController/res/values-ru-v35/strings.xml b/PermissionController/res/values-ru-v35/strings.xml
new file mode 100644
index 000000000..c6fa35d68
--- /dev/null
+++ b/PermissionController/res/values-ru-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Безопасность"</string>
+</resources>
diff --git a/PermissionController/res/values-ru/strings.xml b/PermissionController/res/values-ru/strings.xml
index e2c933435..36b6c8bfe 100644
--- a/PermissionController/res/values-ru/strings.xml
+++ b/PermissionController/res/values-ru/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"разрешения"</string>
     <string name="cancel" msgid="8943320028373963831">"Отмена"</string>
     <string name="back" msgid="6249950659061523680">"Назад"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Закрыть"</string>
     <string name="available" msgid="6007778121920339498">"Доступно"</string>
     <string name="blocked" msgid="9195547604866033708">"Заблокировано"</string>
     <string name="on" msgid="280241003226755921">"Включено"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Нет"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(по умолчанию)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Приложений нет"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Другие сервисы NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Выбрано"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Выбрано: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"специальный доступ для приложений"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Последний доступ вчера: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Последний доступ: <xliff:g id="TIME_DATE_0">%1$s</xliff:g>, <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Ваш одноразовый код: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Разрешить доступ к настройкам"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Настройки с ограниченным доступом"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"В целях безопасности эти настройки пока недоступны."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Для приложения заблокировано разрешение \"<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>\""</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ОК"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Запрос разрешений заблокирован"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Это приложение запрашивает дополнительные разрешения, которые невозможно предоставить во время трансляции на устройство. Сначала откройте доступ на телефоне."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Для экстренного вызова или сообщения"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Местоположение отправлено экстренным службам"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Это приложение получало доступ к местоположению устройства во время звонка или отправки сообщения на номер экстренной службы. Такое возможно, даже если у приложения нет разрешения на определение местоположения или геолокация отключена на устройстве. "<a href="https://support.google.com/android/answer/9319337">"Подробнее…"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Проверьте телефон"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Нет связи с телефоном."</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Повторить попытку?"</string>
 </resources>
diff --git a/PermissionController/res/values-si-v35/strings.xml b/PermissionController/res/values-si-v35/strings.xml
new file mode 100644
index 000000000..dd5c408ae
--- /dev/null
+++ b/PermissionController/res/values-si-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"ආරක්ෂාව"</string>
+</resources>
diff --git a/PermissionController/res/values-si/strings.xml b/PermissionController/res/values-si/strings.xml
index d7458173f..fbec1af4f 100644
--- a/PermissionController/res/values-si/strings.xml
+++ b/PermissionController/res/values-si/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"අවසර"</string>
     <string name="cancel" msgid="8943320028373963831">"අවලංගු කරන්න"</string>
     <string name="back" msgid="6249950659061523680">"ආපසු යන්න"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"වසන්න"</string>
     <string name="available" msgid="6007778121920339498">"තිබේ"</string>
     <string name="blocked" msgid="9195547604866033708">"අවහිරයි"</string>
     <string name="on" msgid="280241003226755921">"සක්‍රීය"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"කිසිවක් නැත"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(පද්ධතිය පෙරනිමි)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"යෙදුම් නොමැත"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"වෙනත් NFC සේවා"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"තේරිණි"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"තේරිණි - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"විශේෂ යෙදුම් ප්‍රවේශය"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"ප්‍රවේශ වූයේ ඊයේ <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"ප්‍රවේශ වූයේ <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"ඔබේ එක් වරක මුරපදය 132435 වේ"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"සීමා කළ සැකසීම්වලට ඉඩ දෙන්න"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"සීමා කළ සැකසීම"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"ඔබේ ආරක්ෂාව සඳහා, මෙම සැකසීම දැනට නොමැත."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"යෙදුම <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> වෙත ප්‍රවේශය ප්‍රතික්ෂේප කරන ලදි"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"හරි"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"අවසර ඉල්ලීම වළක්වා ඇත"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"මෙම යෙදුම අතිරේක අවසර ඉල්ලා සිටින නමුත්, ප්‍රවාහ කිරීමේ සැසියක අවසර ලබා දිය නොහැක. පළමුව ඔබේ දුරකථනයෙන් අවසරය ලබා දෙන්න."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"හදිසි ඇමතුම් හෝ පෙළ සඳහා"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ස්ථානය හදිසි සේවා වෙත යවනු ලැබේ"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"මෙම යෙදුම හදිසි ඇමතුම් අංකයකට ඇමතුමක් දෙන හෝ කෙටි පණිවිඩයක් යවන අතරතුර ඔබේ උපාංගයේ ස්ථානයට ප්‍රවේශ විය. යෙදුමට ස්ථාන අවසරයක් නොමැති විට හෝ උපාංග ස්ථානය ක්‍රියා විරහිත විට පවා මෙය සිදු විය හැක. "<a href="https://support.google.com/android/answer/9319337">"තව දැන ගන්න"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"ඔබේ දුරකථනය පරීක්ෂා කරන්න"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"ඔබේ දුරකථනය වෙත ළඟා විය නොහැකි විය"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"යළි උත්සාහ කරන්න ද?"</string>
 </resources>
diff --git a/PermissionController/res/values-sk-v35/strings.xml b/PermissionController/res/values-sk-v35/strings.xml
new file mode 100644
index 000000000..6bd3cb05c
--- /dev/null
+++ b/PermissionController/res/values-sk-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Zabezpečenie"</string>
+</resources>
diff --git a/PermissionController/res/values-sk/strings.xml b/PermissionController/res/values-sk/strings.xml
index a0f244501..2b0c845c5 100644
--- a/PermissionController/res/values-sk/strings.xml
+++ b/PermissionController/res/values-sk/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"povolenia"</string>
     <string name="cancel" msgid="8943320028373963831">"Zrušiť"</string>
     <string name="back" msgid="6249950659061523680">"Späť"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Zavrieť"</string>
     <string name="available" msgid="6007778121920339498">"Dostupné"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokované"</string>
     <string name="on" msgid="280241003226755921">"Zapnuté"</string>
@@ -272,7 +273,7 @@
     <string name="unused_apps_notification_content" msgid="9195026773244581246">"Povolenia a dočasné súbory boli odstránené a upozornenia boli zastavené. Skontrolujte to klepnutím."</string>
     <string name="unused_apps_safety_center_card_title" msgid="5638409355530099149">"Skontrolujte aplikácie s odstránenými povoleniami"</string>
     <string name="unused_apps_safety_center_card_content" msgid="1088557243627427820">"V prípade aplikácií, ktoré ste dlhšie nepoužívali, boli povolenia a dočasné súbory odstránené a upozornenia deaktivované."</string>
-    <string name="unused_apps_safety_center_action_title" msgid="8865914432518993194">"Skontrolovať aplikácie"</string>
+    <string name="unused_apps_safety_center_action_title" msgid="8865914432518993194">"Kontrola aplikácií"</string>
     <string name="post_drive_permission_decision_reminder_title" msgid="1290697371418139976">"Skontrolujte nedávne povolenia"</string>
     <string name="post_drive_permission_decision_reminder_summary_1_app_1_permission" msgid="670521503734140711">"Počas jazdy ste udelili aplikácii <xliff:g id="APP">%1$s</xliff:g> povolenie <xliff:g id="PERMISSION">%2$s</xliff:g>"</string>
     <string name="post_drive_permission_decision_reminder_summary_1_app_2_permissions" msgid="671791184670801301">"Počas jazdy ste udelili aplikácii <xliff:g id="APP">%1$s</xliff:g> prístup k povoleniam <xliff:g id="PERMISSION_1">%2$s</xliff:g> &amp; <xliff:g id="PERMISSION_2">%3$s</xliff:g>"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Žiadna"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Predvolené systémom)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Žiadne aplikácie"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Ďalšie služby NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Vybraná"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Vybrané – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"špeciálny prístup aplikácií"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Otvorené včera <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Otvorené <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Jednorazové heslo je 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Povoliť obmedzené nastavenia"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Obmedzené nastavenie"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Z bezpečnostných dôvodov nie je toto nastavenie momentálne k dispozícii."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikácii bol prístup k povoleniu <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> zamietnutý"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Žiadosť o povolenie bola zablokovaná"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Táto aplikácia požaduje ďalšie povolenia, ale povolenia nie je možné udeliť v relácii streamovania. Najprv udeľte povolenie v telefóne."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Na účely tiesňového volania alebo textovej správy"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Poloha bola odoslaná tiesňovej linke"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Táto aplikácia získala počas hovoru s tiesňovou linkou alebo odosielania správy na ňu prístup k polohe vášho zariadenia. Môže sa to stať, aj keď daná aplikácia nemá povolený prístup k polohe alebo keď je poloha zariadenia vypnutá. "<a href="https://support.google.com/android/answer/9319337">"Ďalšie informácie"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Skontrolovať telefón"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"S telefónom sa nepodarilo spojiť"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Chcete to skúsiť znova?"</string>
 </resources>
diff --git a/PermissionController/res/values-sl-v35/strings.xml b/PermissionController/res/values-sl-v35/strings.xml
new file mode 100644
index 000000000..e20a0e57b
--- /dev/null
+++ b/PermissionController/res/values-sl-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Varnost"</string>
+</resources>
diff --git a/PermissionController/res/values-sl/strings.xml b/PermissionController/res/values-sl/strings.xml
index 198197c83..0e83c0d1f 100644
--- a/PermissionController/res/values-sl/strings.xml
+++ b/PermissionController/res/values-sl/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"dovoljenja"</string>
     <string name="cancel" msgid="8943320028373963831">"Prekliči"</string>
     <string name="back" msgid="6249950659061523680">"Nazaj"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Zapri"</string>
     <string name="available" msgid="6007778121920339498">"Na voljo"</string>
     <string name="blocked" msgid="9195547604866033708">"Blokirano"</string>
     <string name="on" msgid="280241003226755921">"Vklopljeno"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Brez"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(privzeta v sistemu)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Ni aplikacij"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Druge storitve NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Izbrano"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Izbrano – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"posebni dostop za aplikacije"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Zadnji dostop včeraj: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Zadnji dostop: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Enkratno geslo je 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Dovoli omejene nastavitve"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Omejena nastavitev"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Zaradi vaše varnosti ta nastavitev trenutno ni na voljo."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikaciji je bil zavrnjen dostop do dovoljenja »<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>«"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"V redu"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Zahteva za dovoljenje je bila prezrta"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Ta aplikacija zahteva dodatna dovoljenja, vendar teh ni mogoče odobriti med sejo pretočnega predvajanja. Dovoljenje najprej odobrite v telefonu."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Za klic ali sporočilo v sili"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Lokacija je poslana reševalnim službam"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Ta aplikacija je dostopala do lokacije naprave med klicanjem ali pošiljanjem sporočila na številko za klic v sili. To se lahko zgodi tudi, če aplikacija nima dovoljenja za lokacijo ali če je lokacija naprave izklopljena. "<a href="https://support.google.com/android/answer/9319337">"Več o tem"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Preverite telefon"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Telefona ni bilo mogoče doseči"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Ali želite poskusiti znova?"</string>
 </resources>
diff --git a/PermissionController/res/values-sq-v35/strings.xml b/PermissionController/res/values-sq-v35/strings.xml
new file mode 100644
index 000000000..ef8b1c486
--- /dev/null
+++ b/PermissionController/res/values-sq-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Siguria"</string>
+</resources>
diff --git a/PermissionController/res/values-sq/strings.xml b/PermissionController/res/values-sq/strings.xml
index 15209188a..4cca434cb 100644
--- a/PermissionController/res/values-sq/strings.xml
+++ b/PermissionController/res/values-sq/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"lejet"</string>
     <string name="cancel" msgid="8943320028373963831">"Anulo"</string>
     <string name="back" msgid="6249950659061523680">"Pas"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Mbyll"</string>
     <string name="available" msgid="6007778121920339498">"Ofrohet"</string>
     <string name="blocked" msgid="9195547604866033708">"Bllokuar"</string>
     <string name="on" msgid="280241003226755921">"Aktiv"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Asnjë"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Parazgjedhja e sistemit)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Nuk ka aplikacione"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Shërbime të tjera të NFC-së"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Zgjedhur"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Zgjedhur - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"qasje e veçantë e aplikacionit"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Qasja e fundit dje në <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Qasja e fundit më <xliff:g id="TIME_DATE_0">%1$s</xliff:g> në <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Fjalëkalimi yt njëpërdorimësh është 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Lejo cilësimet e kufizuara"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Cilësim i kufizuar"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Për sigurinë tënde, ky cilësim nuk ofrohet për momentin."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Aplikacionit iu refuzua qasja te: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Në rregull"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Kërkesa për leje është ndaluar"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Ky aplikacion po kërkon leje shtesë, por lejet nuk mund të jepen në një seancë transmetimi. Fillimisht jep lejen në telefonin tënd."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Për telefonatën apo mesazhin me tekst të urgjencës"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Vendndodhja u dërgua te shërbimet e urgjencës"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Ky aplikacion u qas te vendndodhja e pajisjes sate gjatë një telefonate apo mesazhi me tekst drejt një numri urgjence. Kjo mund të ndodhë edhe kur aplikacioni nuk ka lejen për vendndodhjen ose kur vendndodhja e pajisjes është joaktive. "<a href="https://support.google.com/android/answer/9319337">"Mëso më shumë"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Kontrollo telefonin"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Telefoni nuk mund të arrihej"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Të riprovohet?"</string>
 </resources>
diff --git a/PermissionController/res/values-sr-v35/strings.xml b/PermissionController/res/values-sr-v35/strings.xml
new file mode 100644
index 000000000..3690e7e0e
--- /dev/null
+++ b/PermissionController/res/values-sr-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Безбедност"</string>
+</resources>
diff --git a/PermissionController/res/values-sr/strings.xml b/PermissionController/res/values-sr/strings.xml
index 2475e817a..957c026e6 100644
--- a/PermissionController/res/values-sr/strings.xml
+++ b/PermissionController/res/values-sr/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"дозволе"</string>
     <string name="cancel" msgid="8943320028373963831">"Откажи"</string>
     <string name="back" msgid="6249950659061523680">"Назад"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Затвори"</string>
     <string name="available" msgid="6007778121920339498">"Доступно"</string>
     <string name="blocked" msgid="9195547604866033708">"Блокирано"</string>
     <string name="on" msgid="280241003226755921">"Укључено"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Ништа"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Подразумевана системска)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Нема апликација"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Друге NFC услуге"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Изабрано"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Изабрано – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"посебан приступ апликација"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Приступано јуче: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Приступано: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Једнократна лозинка је 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Дозволи ограничена подешавања"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Ограничено подешавање"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Ово подешавање је тренутно недоступно ради ваше безбедности."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Апликацији није дозвољен приступ дозволи: <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Важи"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Захтев за дозволу је блокиран"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Ова апликација захтева додатне дозволе, али дозволе не могу да се дају у сесији стримовања. Прво дајте дозволу на телефону."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"За хитни позив или поруку"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Локација је послата хитним службама"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Ова апликација је приступила локацији уређаја током позивања броја за хитне случајеве или слања поруке том броју. То може да се догоди чак и када апликација нема дозволу за локацију или је локација уређаја искључена. "<a href="https://support.google.com/android/answer/9319337">"Сазнајте више"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Проверите телефон"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Повезивање са телефоном није успело"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Желите ли да пробате поново?"</string>
 </resources>
diff --git a/PermissionController/res/values-sv-v35/strings.xml b/PermissionController/res/values-sv-v35/strings.xml
new file mode 100644
index 000000000..c3d1b1b1c
--- /dev/null
+++ b/PermissionController/res/values-sv-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Säkerhet"</string>
+</resources>
diff --git a/PermissionController/res/values-sv/strings.xml b/PermissionController/res/values-sv/strings.xml
index 9d79d1d6d..937a12200 100644
--- a/PermissionController/res/values-sv/strings.xml
+++ b/PermissionController/res/values-sv/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"behörigheter"</string>
     <string name="cancel" msgid="8943320028373963831">"Avbryt"</string>
     <string name="back" msgid="6249950659061523680">"Tillbaka"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Stäng"</string>
     <string name="available" msgid="6007778121920339498">"Tillgänglig"</string>
     <string name="blocked" msgid="9195547604866033708">"Blockerad"</string>
     <string name="on" msgid="280241003226755921">"På"</string>
@@ -436,10 +437,11 @@
     <string name="default_apps_more" msgid="4078194675848858093">"Fler standardappar"</string>
     <string name="default_apps_manage_domain_urls" msgid="6775566451561036069">"Öppna länkar"</string>
     <string name="default_apps_for_work" msgid="4970308943596201811">"Standardinställning för jobbet"</string>
-    <string name="default_apps_for_private_profile" msgid="2022024112144880785">"Standard för privat område"</string>
+    <string name="default_apps_for_private_profile" msgid="2022024112144880785">"Standard för privat utrymme"</string>
     <string name="default_app_none" msgid="9084592086808194457">"Ingen"</string>
-    <string name="default_app_system_default" msgid="6218386768175513760">"(Systemstandard)"</string>
+    <string name="default_app_system_default" msgid="6218386768175513760">"(System­standard)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Inga appar"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Andra NFC-tjänster"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Vald"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Vald – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"särskild appåtkomst"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Öppnades i går <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Öppnades <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Ditt engångslösenord är 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Tillåt blockerade inställningar"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Begränsad inställning"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Av säkerhetsskäl är den här inställningen inte tillgänglig för närvarande."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Appen nekades åtkomst till <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Begäran om behörighet har dolts"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Appen begär ytterligare behörigheter, men det går inte att bevilja behörigheter under streamingsessionen. Bevilja behörigheten på telefonen först."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"För ett nödsamtal eller nöd-sms"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Plats skickad till räddningstjänsten"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Den här appen fick åtkomst till enhetens plats när du ringde eller sms:ade till ett nödnummer. Detta kan hända även när appen inte har platsbehörighet eller om enhetens plats är inaktiverad. "<a href="https://support.google.com/android/answer/9319337">"Läs mer"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Kontrollera telefonen"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Det gick inte att nå telefonen"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Vill du försöka igen?"</string>
 </resources>
diff --git a/PermissionController/res/values-sw-v35/strings.xml b/PermissionController/res/values-sw-v35/strings.xml
new file mode 100644
index 000000000..6234b97ec
--- /dev/null
+++ b/PermissionController/res/values-sw-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Usalama"</string>
+</resources>
diff --git a/PermissionController/res/values-sw/strings.xml b/PermissionController/res/values-sw/strings.xml
index 08766ae6a..e774d92c1 100644
--- a/PermissionController/res/values-sw/strings.xml
+++ b/PermissionController/res/values-sw/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ruhusa"</string>
     <string name="cancel" msgid="8943320028373963831">"Ghairi"</string>
     <string name="back" msgid="6249950659061523680">"Rudi nyuma"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Funga"</string>
     <string name="available" msgid="6007778121920339498">"Inaruhusiwa kufikia"</string>
     <string name="blocked" msgid="9195547604866033708">"Imezuiwa kufikia"</string>
     <string name="on" msgid="280241003226755921">"Imewashwa"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Hakuna"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Programu chaguomsingi ya mfumo)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Hakuna programu"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Huduma nyinginezo za NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Umechagua"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Umechagua - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ufikiaji maalum wa programu"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Kilifunguliwa jana <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Kilifunguliwa <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Nenosiri lako la wakati mmoja ni 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Ruhusu mipangilio yenye mipaka"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Mipangilio imezuiwa"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Ili kulinda usalama wako, mipangilio hii haipatikani kwa sasa."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Programu haijapewa idhini ya kufikia <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Sawa"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Ombi la ruhusa limezuiwa"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Programu hii inaomba ruhusa za ziada. Hata hivyo, huwezi kutoa ruhusa ukitiririsha. Ruhusu kwenye simu yako kwanza."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Kwa kutuma ujumbe au kupiga simu ya dharura"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Data ya mahali imetumwa kwa huduma za dharura"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Programu hii ilifikia data ya mahali kilipo kifaa chako ulipokuwa ukipiga simu au kutuma ujumbe kwa namba ya dharura. Hali hii inaweza kutokea hata kama programu haina ruhusa ya mahali au umezima kipengele cha kufikia data ya mahali kifaa kilipo. "<a href="https://support.google.com/android/answer/9319337">"Pata maelezo zaidi"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Angalia simu yako"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Imeshindwa kufikia simu yako"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Ungependa kujaribu tena?"</string>
 </resources>
diff --git a/PermissionController/res/values-ta-v35/strings.xml b/PermissionController/res/values-ta-v35/strings.xml
new file mode 100644
index 000000000..6c6adaf80
--- /dev/null
+++ b/PermissionController/res/values-ta-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"பாதுகாப்பு"</string>
+</resources>
diff --git a/PermissionController/res/values-ta/strings.xml b/PermissionController/res/values-ta/strings.xml
index 601ae1f30..e4f158e6f 100644
--- a/PermissionController/res/values-ta/strings.xml
+++ b/PermissionController/res/values-ta/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"அனுமதிகள்"</string>
     <string name="cancel" msgid="8943320028373963831">"ரத்துசெய்"</string>
     <string name="back" msgid="6249950659061523680">"பின்செல்"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"மூடு"</string>
     <string name="available" msgid="6007778121920339498">"உள்ளது"</string>
     <string name="blocked" msgid="9195547604866033708">"தடுக்கப்பட்டது"</string>
     <string name="on" msgid="280241003226755921">"இயக்கப்பட்டுள்ளது"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ஏதுமில்லை"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(சிஸ்டத்தின் இயல்புநிலை)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"ஆப்ஸ் இல்லை"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"பிற NFC சேவைகள்"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"தேர்ந்தெடுக்கப்பட்டது"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"<xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g> தேர்ந்தெடுக்கப்பட்டுள்ளது"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ஆப்ஸிற்கான சிறப்பு அணுகல்"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"நேற்று அணுகிய நேரம்: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"அணுகிய நேரம்: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"ஒருமுறை பயன்படுத்தப்படும் கடவுச்சொல்: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"கட்டுப்படுத்தப்பட்ட அமைப்பை அனுமதி"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"கட்டுப்படுத்தப்பட்ட அமைப்பு"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"உங்கள் பாதுகாப்பிற்காக, இந்த அமைப்பு தற்போது இல்லை."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>க்கான ஆப்ஸ் அணுகல் நிராகரிக்கப்பட்டது"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"சரி"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"அணுகல் கோரிக்கை முடக்கப்பட்டது"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"இந்த ஆப்ஸ் கூடுதல் அனுமதிகளைக் கேட்கிறது. ஆனால் ஸ்ட்ரீமிங் அமர்வில் அனுமதிகள் வழங்கப்படாது. முதலில் உங்கள் மொபைலில் அனுமதி வழங்கவும்."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"அவசர அழைப்பு/மெசேஜுக்கு"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"அவசரகாலச் சேவைகளுக்கு இருப்பிடம் அனுப்பப்பட்டது"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"அவசர உதவி எண்ணை அழைத்தபோதோ அந்த எண்ணிற்கு மெசேஜ் அனுப்பியபோதோ உங்கள் சாதனத்தின் இருப்பிடத்தை இந்த ஆப்ஸ் அணுகியது. இருப்பிட அனுமதி ஆப்ஸுக்கு இல்லாதபோதும் சாதனத்தின் இருப்பிடம் முடக்கப்பட்டிருக்கும்போதும் கூட இப்படி நிகழலாம். "<a href="https://support.google.com/android/answer/9319337">"மேலும் அறிக"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"மொபைலைப் பாருங்கள்"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"உங்கள் மொபைலுடன் இணைக்க முடியவில்லை"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"மீண்டும் முயலவா?"</string>
 </resources>
diff --git a/PermissionController/res/values-te-v35/strings.xml b/PermissionController/res/values-te-v35/strings.xml
new file mode 100644
index 000000000..7285aa987
--- /dev/null
+++ b/PermissionController/res/values-te-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"సెక్యూరిటీ"</string>
+</resources>
diff --git a/PermissionController/res/values-te/strings.xml b/PermissionController/res/values-te/strings.xml
index de4af1639..13097cdf0 100644
--- a/PermissionController/res/values-te/strings.xml
+++ b/PermissionController/res/values-te/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"అనుమతులు"</string>
     <string name="cancel" msgid="8943320028373963831">"రద్దు చేయండి"</string>
     <string name="back" msgid="6249950659061523680">"వెనుకకు"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"మూసివేయండి"</string>
     <string name="available" msgid="6007778121920339498">"అందుబాటులో ఉంది"</string>
     <string name="blocked" msgid="9195547604866033708">"బ్లాక్ చేయబడినది"</string>
     <string name="on" msgid="280241003226755921">"ఆన్‌లో ఉంది"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ఏదీ కాదు"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(సిస్టమ్ ఆటోమేటిక్)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"ఏ యాప్ లేదు"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"ఇతర NFC సర్వీస్‌లు"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"ఎంచుకోబడింది"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"<xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g> - ఎంచుకోబడింది"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ప్రత్యేక యాప్ యాక్సెస్"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"నిన్న <xliff:g id="TIME_DATE">%1$s</xliff:g>‌కు యాక్సెస్‌ చేశారు"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g>‌న<xliff:g id="TIME_DATE_1">%2$s</xliff:g>‌కు యాక్సెస్‌ చేశారు"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"మీ ఒకసారి ఉపయోగించగల పాస్‌వర్డ్ 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"పరిమితం చేసిన సెట్టింగ్‌లను అనుమతించండి"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"పరిమితం చేయబడిన సెట్టింగ్"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"మీ సెక్యూరిటీ కోసం, ఈ సెట్టింగ్ ప్రస్తుతం అందుబాటులో లేదు."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"యాప్ <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>‌కు యాక్సెస్ తిరస్కరించబడింది"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"సరే"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"అనుమతి రిక్వెస్ట్ బ్లాక్ చేయబడింది"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"ఈ యాప్ అదనపు అనుమతి కోసం రిక్వెస్ట్ చేస్తోంది, కానీ స్ట్రీమింగ్ సెషన్‌లో అనుమతులను మంజూరు చేయడం సాధ్యం కాదు. ముందుగా మీ ఫోన్‌లో అనుమతిని మంజూరు చేయండి."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"ఎమర్జెన్సీ కాల్ లేదా టెక్స్ట్ మెసేజ్ పంపే విషయంలో"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ఎమర్జెన్సీ సర్వీసులకు లొకేషన్ పంపడం జరిగింది"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"ఎమర్జెన్సీ నంబర్‌కు కాల్ చేసినప్పుడు, లేదా టెక్స్ట్ మెసేజ్ పంపినప్పుడు ఈ యాప్ మీ పరికర లొకేషన్‌ను యాక్సెస్ చేసింది. యాప్‌నకు లొకేషన్ అనుమతి లేకున్నా లేదా పరికర లొకేషన్ ఆఫ్‌లో ఉన్నప్పటికీ కూడా ఇలా జరిగవచ్చు. "<a href="https://support.google.com/android/answer/9319337">"మరింత తెలుసుకోండి"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"మీ ఫోన్‌ను చెక్ చేయండి"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"మీ ఫోన్‌ను రీచ్ అవడం సాధ్యపడలేదు"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"మళ్లీ ట్రై చేయాలా?"</string>
 </resources>
diff --git a/PermissionController/res/values-television/styles.xml b/PermissionController/res/values-television/styles.xml
index 05ed588e9..3a54ce8b2 100644
--- a/PermissionController/res/values-television/styles.xml
+++ b/PermissionController/res/values-television/styles.xml
@@ -23,7 +23,7 @@
     </style>
 
     <style name="LeanbackPreference.Permissions">
-        <item name="layout">@layout/preference_permissions</item>
+        <item name="layout">@layout/preference_permissions_television</item>
     </style>
 
     <style name="LeanbackPreference.Category.Permissions">
@@ -31,7 +31,7 @@
     </style>
 
     <style name="LeanbackPreference.SwitchPreference.Permissions">
-        <item name="layout">@layout/preference_permissions_switch</item>
+        <item name="layout">@layout/preference_permissions_switch_television</item>
     </style>
 
     <!-- Request role dialog start -->
diff --git a/PermissionController/res/values-th-v35/strings.xml b/PermissionController/res/values-th-v35/strings.xml
new file mode 100644
index 000000000..cf819a8ce
--- /dev/null
+++ b/PermissionController/res/values-th-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"ความปลอดภัย"</string>
+</resources>
diff --git a/PermissionController/res/values-th/strings.xml b/PermissionController/res/values-th/strings.xml
index cb0a56061..0943c6011 100644
--- a/PermissionController/res/values-th/strings.xml
+++ b/PermissionController/res/values-th/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"สิทธิ์"</string>
     <string name="cancel" msgid="8943320028373963831">"ยกเลิก"</string>
     <string name="back" msgid="6249950659061523680">"กลับ"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"ปิด"</string>
     <string name="available" msgid="6007778121920339498">"พร้อมใช้งาน"</string>
     <string name="blocked" msgid="9195547604866033708">"ถูกบล็อก"</string>
     <string name="on" msgid="280241003226755921">"เปิด"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"ไม่มี"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(ค่าเริ่มต้นของระบบ)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"ไม่มีแอป"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"บริการ NFC อื่นๆ"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"เลือกไว้"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"เลือกไว้ - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"สิทธิ์เข้าถึงพิเศษของแอป"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"เข้าถึงเมื่อวานตอน <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"เข้าถึงเมื่อวันที่ <xliff:g id="TIME_DATE_0">%1$s</xliff:g> ตอน <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"รหัสผ่านที่สามารถใช้งานได้เพียงครั้งเดียวของคุณคือ 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"อนุญาตการตั้งค่าที่จำกัด"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"การตั้งค่าที่จำกัด"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"การตั้งค่านี้ใช้ไม่ได้ในตอนนี้เพื่อความปลอดภัยของคุณ"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"แอปถูกปฏิเสธไม่ให้เข้าถึง <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ตกลง"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"ระงับคำขอสิทธิ์อยู่"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"แอปนี้มีการขอสิทธิ์เพิ่มเติม แต่ไม่สามารถให้สิทธิ์ในเซสชันที่กำลังสตรีมอยู่ โปรดให้สิทธิ์ในโทรศัพท์ก่อน"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"สำหรับการโทรหรือส่งข้อความฉุกเฉิน"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ส่งตำแหน่งไปยังบริการช่วยเหลือฉุกเฉินแล้ว"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"แอปนี้เข้าถึงตำแหน่งของอุปกรณ์ระหว่างที่โทรหรือส่งข้อความหาหมายเลขฉุกเฉิน ซึ่งอาจเกิดขึ้นได้แม้ว่าแอปจะไม่มีสิทธิ์เข้าถึงตำแหน่งหรือแม้ว่าตำแหน่งของอุปกรณ์จะปิดอยู่ก็ตาม "<a href="https://support.google.com/android/answer/9319337">"ดูข้อมูลเพิ่มเติม"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"ตรวจสอบโทรศัพท์"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"เข้าถึงโทรศัพท์ของคุณไม่ได้"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"ลองใหม่ไหม"</string>
 </resources>
diff --git a/PermissionController/res/values-tl-v35/strings.xml b/PermissionController/res/values-tl-v35/strings.xml
new file mode 100644
index 000000000..ecd01df78
--- /dev/null
+++ b/PermissionController/res/values-tl-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Seguridad"</string>
+</resources>
diff --git a/PermissionController/res/values-tl/strings.xml b/PermissionController/res/values-tl/strings.xml
index f7a2a485c..f08b97531 100644
--- a/PermissionController/res/values-tl/strings.xml
+++ b/PermissionController/res/values-tl/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"mga pahintulot"</string>
     <string name="cancel" msgid="8943320028373963831">"Kanselahin"</string>
     <string name="back" msgid="6249950659061523680">"Bumalik"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Isara"</string>
     <string name="available" msgid="6007778121920339498">"Available"</string>
     <string name="blocked" msgid="9195547604866033708">"Naka-block"</string>
     <string name="on" msgid="280241003226755921">"Naka-on"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Wala"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Default ng system)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Walang app"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Iba pang serbisyo ng NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Napili"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Pinili - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"Espesyal na access ng app"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Na-access kahapon nang <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Na-access noong <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Ang iyong pang-isang beses na password ay 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Payagan ang mga pinaghihigpitang setting"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Pinaghihigpitang setting"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Para sa iyong seguridad, hindi available ang setting na ito sa ngayon."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Tinanggihan ang access ng appp sa <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Pinigilan ang kahilingan sa pahintulot"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Humihingi ang app na ito ng dagdag na pahintulot, pero hindi puwedeng ibigay ang mga pahintulot sa isang session ng streaming. Ibigay muna ang pahintulot sa iyong telepono."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Para sa emergency na tawag o text"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Ipinadala ang lokasyon sa mga serbisyong pang-emergency"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Na-access ng app na ito ang lokasyon ng iyong device habang may tawag o text sa isang pang-emergency na numero. Puwede itong mangyari kahit na walang pahintulot sa lokasyon ang app o naka-off ang lokasyon ng device. "<a href="https://support.google.com/android/answer/9319337">"Matuto pa"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Tingnan ang iyong telepono"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Hindi makakonekta sa iyong telepono"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Subukan ulit?"</string>
 </resources>
diff --git a/PermissionController/res/values-tr-v35/strings.xml b/PermissionController/res/values-tr-v35/strings.xml
new file mode 100644
index 000000000..ed8a1bf04
--- /dev/null
+++ b/PermissionController/res/values-tr-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Güvenlik"</string>
+</resources>
diff --git a/PermissionController/res/values-tr/strings.xml b/PermissionController/res/values-tr/strings.xml
index 669471f0c..14f6885af 100644
--- a/PermissionController/res/values-tr/strings.xml
+++ b/PermissionController/res/values-tr/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"izinler"</string>
     <string name="cancel" msgid="8943320028373963831">"İptal"</string>
     <string name="back" msgid="6249950659061523680">"Geri"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Kapat"</string>
     <string name="available" msgid="6007778121920339498">"İzin verildi"</string>
     <string name="blocked" msgid="9195547604866033708">"Engellendi"</string>
     <string name="on" msgid="280241003226755921">"Açık"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Yok"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Sistem varsayılanı)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Uygulama yok"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Diğer NFC hizmetleri"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Seçildi"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Seçildi - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"özel uygulama erişimi"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Dün saat <xliff:g id="TIME_DATE">%1$s</xliff:g> itibarıyla erişildi"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Erişim tarihi: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Tek kullanımlık şifreniz 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Kısıtlanmış ayarlara izin verme"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Kısıtlanmış ayar"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Güvenliğiniz için bu ayar şu anda kullanılamıyor."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Uygulamanın <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> iznine erişimi reddedildi"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"Tamam"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"İzin isteği reddedildi"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Bu uygulama ek izinler istiyor ancak akış oturumundayken izin verilemez. Önce telefonunuzda ilgili izni verin."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Acil durum araması veya mesajı için"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Konum, acil durum hizmetlerine gönderildi"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Bu uygulama, bir acil durum numarasına telefon ederken veya mesaj gönderirken cihazınızın konumuna erişti. Bu durum, uygulamanın konum izni olmadığında veya cihazın konumu kapalı olduğunda bile yaşanabilir ."<a href="https://support.google.com/android/answer/9319337">"Daha fazla bilgi edinin"</a>"."</string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Telefonunuzu kontrol edin"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Telefonunuza ulaşılamadı"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Yeniden denemek istiyor musunuz?"</string>
 </resources>
diff --git a/PermissionController/res/values-uk-v35/strings.xml b/PermissionController/res/values-uk-v35/strings.xml
new file mode 100644
index 000000000..d6eeae9b5
--- /dev/null
+++ b/PermissionController/res/values-uk-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Безпека"</string>
+</resources>
diff --git a/PermissionController/res/values-uk/strings.xml b/PermissionController/res/values-uk/strings.xml
index 53bf58314..7d713e2ff 100644
--- a/PermissionController/res/values-uk/strings.xml
+++ b/PermissionController/res/values-uk/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"дозволи"</string>
     <string name="cancel" msgid="8943320028373963831">"Скасувати"</string>
     <string name="back" msgid="6249950659061523680">"Назад"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Закрити"</string>
     <string name="available" msgid="6007778121920339498">"Доступно"</string>
     <string name="blocked" msgid="9195547604866033708">"Заблоковано"</string>
     <string name="on" msgid="280241003226755921">"Увімкнено"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Немає"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(За умовчанням)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Немає додатків"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Інші NFC-сервіси"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Вибрано"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Вибрано: <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"спеціальний доступ додатка"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Доступ отримано вчора: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Доступ отримано: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Ваш одноразовий пароль: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Дозволити налаштування з обмеженнями"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Налаштування з обмеженнями"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"З міркувань безпеки це налаштування наразі недоступне."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Додатку не надано дозвіл \"<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>\""</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ОК"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Запит на доступ відхилено"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Цьому додатку потрібно більше дозволів, але їх не можна надати під час потокового передавання. Спершу надайте дозвіл на телефоні."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Для екстрених викликів або SMS"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Геодані надіслано службам екстреної допомоги"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Цей додаток отримав доступ до геоданих вашого пристрою, коли ви телефонували або надсилали SMS на екстрений номер. Це може статися, навіть якщо додаток не має дозволу на доступ до геоданих або коли на пристрої вимкнено геолокацію. "<a href="https://support.google.com/android/answer/9319337">"Докладніше"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Перевірте телефон"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Не вдалося підключитися до телефона"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Повторити?"</string>
 </resources>
diff --git a/PermissionController/res/values-ur-v35/strings.xml b/PermissionController/res/values-ur-v35/strings.xml
new file mode 100644
index 000000000..d06432a1e
--- /dev/null
+++ b/PermissionController/res/values-ur-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"سیکیورٹی"</string>
+</resources>
diff --git a/PermissionController/res/values-ur/strings.xml b/PermissionController/res/values-ur/strings.xml
index 8927febb3..3b4fa91db 100644
--- a/PermissionController/res/values-ur/strings.xml
+++ b/PermissionController/res/values-ur/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"اجازتیں"</string>
     <string name="cancel" msgid="8943320028373963831">"منسوخ کریں"</string>
     <string name="back" msgid="6249950659061523680">"واپس جائیں"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"بند کریں"</string>
     <string name="available" msgid="6007778121920339498">"دستیاب ہے"</string>
     <string name="blocked" msgid="9195547604866033708">"مسدود کردہ"</string>
     <string name="on" msgid="280241003226755921">"آن"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"کوئی نہیں"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(سسٹم ڈیفالٹ)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"کوئی ایپس نہیں ہیں"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"‏دیگر NFC سروسز"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"منتخب کردہ"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"منتخب کردہ - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ایپ کی خاص رسائی"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"گزشتہ کل <xliff:g id="TIME_DATE">%1$s</xliff:g> پر رسائی حاصل کی گئی"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g> پر رسائی حاصل کی گئی"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"آپ کا ایک وقتی پاس ورڈ 132435 ہے"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"پابندی والی ترتیبات کی اجازت دیں"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"محدود ترتیب"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"آپ کی سیکیورٹی کیلئے، یہ ترتیب فی الحال دستیاب نہیں ہے۔"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"<xliff:g id="PERMISSION_NAME">%1$s</xliff:g> تک ایپ کی رسائی کو مسترد کر دیا گیا"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"ٹھیک ہے"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"اجازت کی درخواست مسترد کر دی گئی"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"یہ ایپ اضافی اجازتوں کی درخواست کر رہی ہے، لیکن سلسلہ بندی کے سیشن میں اجازتیں نہیں دی جا سکتیں۔ پہلے اپنے فون پر اجازت دیں۔"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"ایمرجنسی کال یا ٹیکسٹ کے لیے"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"ایمرجنسی سروسز کو مقام بھیج دیا گیا"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"اس ایپ نے ایمرجنسی نمبر پر ٹیکسٹ یا کال کے دوران آپ کے آلہ کے مقام تک رسائی حاصل کی۔ ایسا تب بھی ہو سکتا ہے جب ایپ کو مقام کی اجازت نہ ہو یا آلہ کا مقام آف ہو۔ "<a href="https://support.google.com/android/answer/9319337">"مزید جانیں"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"اپنا فون چیک کریں"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"آپ کے فون سے منسلک نہیں کیا جا سکا"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"دوبارہ کوشش کریں؟"</string>
 </resources>
diff --git a/PermissionController/res/values-uz-v35/strings.xml b/PermissionController/res/values-uz-v35/strings.xml
new file mode 100644
index 000000000..965903b10
--- /dev/null
+++ b/PermissionController/res/values-uz-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Xavfsizlik"</string>
+</resources>
diff --git a/PermissionController/res/values-uz/strings.xml b/PermissionController/res/values-uz/strings.xml
index 5ba4ce531..a1f04e4cf 100644
--- a/PermissionController/res/values-uz/strings.xml
+++ b/PermissionController/res/values-uz/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"ruxsatlar"</string>
     <string name="cancel" msgid="8943320028373963831">"Bekor qilish"</string>
     <string name="back" msgid="6249950659061523680">"Orqaga"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Yopish"</string>
     <string name="available" msgid="6007778121920339498">"Mavjud"</string>
     <string name="blocked" msgid="9195547604866033708">"Bloklangan"</string>
     <string name="on" msgid="280241003226755921">"Yoniq"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Hech qanday"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Birlamchi)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Hech qanday ilova topilmadi"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Boshqa NFC xizmatlari"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Tanlandi"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Tanlandi – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"maxsus ilova ruxsatlari"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Kecha kirilgan: <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Kirilgan: <xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Bir martalik parolingiz: 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Cheklangan sozlamalarga ruxsat berish"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Cheklangan sozlama"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Xavfsizlik maqsadida bu sozlama hozir ishlamaydi."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Ilovaga <xliff:g id="PERMISSION_NAME">%1$s</xliff:g> ruxsati berilmadi"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Ruxsat talabi bloklandi"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Bu ilova qoʻshimcha ruxsatlar talab qilmoqda, lekin ruxsatlar striming seansida berilmaydi. Avval telefoningizda ruxsat bering."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Favqulodda chaqiruv yoki SMS uchun"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Joylashuv axboroti favqulodda xizmatlarga yuborildi"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Bu ilova favqulodda xizmat raqamini chaqirish yoki SMS yuborish vaqtida qurilmangiz joylashuv axborotidan foydalandi. Bu ilovaga joylashuv axboroti uchun ruxsat berilmagan yoki qurilmada joylashuv xizmati faolsizlantirilgan boʻlsa ham yuz berishi mumkin. "<a href="https://support.google.com/android/answer/9319337">"Batafsil"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Telefonga qarang"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Telefonga ulanmadi"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Qayta urinib koʻrasizmi?"</string>
 </resources>
diff --git a/PermissionController/res/values-v31/config.xml b/PermissionController/res/values-v31/config.xml
index 2b8817d98..3f286fa98 100644
--- a/PermissionController/res/values-v31/config.xml
+++ b/PermissionController/res/values-v31/config.xml
@@ -17,5 +17,8 @@
 <resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <!-- Name of a font family to use for headlines in SettingsLib. This overrides the default value which points to a private resource. Setting it to an empty value allows it to fallback to the default on the device. -->
     <string name="settingslib_config_headlineFontFamily" translatable="false">@string/config_headlineFontFamily</string>
+
+    <!-- Changing this config on platform build sdk 30 and earlier does nothing. -->
+    <bool name="config_useCollapsingToolbarInPermissionSettings">true</bool>
 </resources>
 
diff --git a/PermissionController/res/values-v31/styles.xml b/PermissionController/res/values-v31/styles.xml
index d48012894..20fb84701 100644
--- a/PermissionController/res/values-v31/styles.xml
+++ b/PermissionController/res/values-v31/styles.xml
@@ -16,6 +16,23 @@
 
 <resources>
 
+    <!-- START AUTO PERMISSION GRANT DIALOG -->
+
+    <style name="AutoPermissionGrantButton" parent="@android:style/Widget.DeviceDefault.Button.Borderless.Colored">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:minHeight">@dimen/car_location_permission_prompt_min_height</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_marginTop">@dimen/car_location_permission_prompt_margin_small</item>
+        <item name="android:padding">@dimen/car_location_permission_prompt_padding_extra_small</item>
+        <item name="android:textSize">@dimen/car_location_permission_prompt_button_text_size</item>
+        <item name="android:lineHeight">@dimen/car_location_permission_prompt_line_height_small</item>
+        <item name="android:textColor">@android:color/system_accent2_900</item>
+        <item name="android:background">@drawable/auto_grant_permissions_buttons</item>
+        <item name="android:textAppearance">@style/AutoPermissionGrantTitleMessage</item>
+    </style>
+
+    <!-- END AUTO PERMISSION GRANT DIALOG -->
+
     <!-- START PERMISSION GRANT DIALOG -->
 
     <style name="PermissionGrantDialogMaterial3">
@@ -44,7 +61,8 @@
     <style name="PermissionGrantButtonTop"
            parent="@android:style/Widget.DeviceDefault.Button.Borderless.Colored">
         <item name="android:layout_width">match_parent</item>
-        <item name="android:layout_height">56dp</item>
+        <item name="android:minHeight">56dp</item>
+        <item name="android:layout_height">wrap_content</item>
         <item name="android:layout_marginLeft">24dp</item>
         <item name="android:layout_marginRight">24dp</item>
         <item name="android:layout_marginTop">2dp</item>
@@ -58,7 +76,8 @@
     <style name="PermissionGrantButtonMiddle"
            parent="@android:style/Widget.DeviceDefault.Button.Borderless.Colored">
         <item name="android:layout_width">match_parent</item>
-        <item name="android:layout_height">56dp</item>
+        <item name="android:minHeight">56dp</item>
+        <item name="android:layout_height">wrap_content</item>
         <item name="android:layout_marginLeft">24dp</item>
         <item name="android:layout_marginRight">24dp</item>
         <item name="android:layout_marginTop">2dp</item>
@@ -72,7 +91,8 @@
     <style name="PermissionGrantButtonBottom"
            parent="@android:style/Widget.DeviceDefault.Button.Borderless.Colored">
         <item name="android:layout_width">match_parent</item>
-        <item name="android:layout_height">56dp</item>
+        <item name="android:minHeight">56dp</item>
+        <item name="android:layout_height">wrap_content</item>
         <item name="android:layout_marginLeft">24dp</item>
         <item name="android:layout_marginRight">24dp</item>
         <item name="android:layout_marginTop">2dp</item>
diff --git a/PermissionController/res/values-v35/attrs.xml b/PermissionController/res/values-v35/attrs.xml
new file mode 100644
index 000000000..701534733
--- /dev/null
+++ b/PermissionController/res/values-v35/attrs.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License
+  -->
+
+<resources>
+    <!-- State value for {@link android.graphics.drawable.StateListDrawable StateListDrawable}, set
+         when a preference has an icon or has its icon space reserved. -->
+    <attr name="state_has_icon_space" format="boolean" />
+</resources>
diff --git a/PermissionController/res/values-v35/strings.xml b/PermissionController/res/values-v35/strings.xml
new file mode 100644
index 000000000..27a50bc0d
--- /dev/null
+++ b/PermissionController/res/values-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <!-- Title for a section that contains security settings on the Security and Privacy page [CHAR LIMIT=60] -->
+    <string name="safety_center_entries_category_title">Security</string>
+</resources>
diff --git a/PermissionController/res/values-v35/styles.xml b/PermissionController/res/values-v35/styles.xml
new file mode 100644
index 000000000..612125fb1
--- /dev/null
+++ b/PermissionController/res/values-v35/styles.xml
@@ -0,0 +1,201 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License
+  -->
+
+<resources>
+
+    <!-- START PREFERENCE STYLES -->
+
+    <style name="PermissionPreferenceCategoryRootLayoutStyle">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:paddingLeft">?android:attr/listPreferredItemPaddingLeft</item>
+        <item name="android:paddingStart">?android:attr/listPreferredItemPaddingStart</item>
+        <item name="android:paddingRight">?android:attr/listPreferredItemPaddingRight</item>
+        <item name="android:paddingEnd">?android:attr/listPreferredItemPaddingEnd</item>
+        <item name="android:background">?android:attr/selectableItemBackground</item>
+        <item name="android:baselineAligned">false</item>
+        <item name="android:layout_marginTop">16dp</item>
+        <item name="android:gravity">center_vertical</item>
+    </style>
+
+    <style name="PermissionPreferenceCategoryTextRelativeLayoutStyle">
+        <item name="android:layout_width">0dp</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_weight">1</item>
+        <item name="android:paddingTop">8dp</item>
+        <item name="android:paddingBottom">8dp</item>
+    </style>
+
+    <style name="PermissionPreferenceCategoryTitleTextStyle" parent="@style/PreferenceCategoryTitleTextStyle">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_gravity">start</item>
+        <item name="android:textAlignment">viewStart</item>
+    </style>
+
+    <style name="PermissionPreferenceCategorySummaryTextStyle" style="@style/PreferenceSummaryTextStyle">
+        <item name="android:ellipsize">end</item>
+        <item name="android:singleLine">true</item>
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_below">@android:id/title</item>
+        <item name="android:layout_alignLeft">@android:id/title</item>
+        <item name="android:layout_alignStart">@android:id/title</item>
+        <item name="android:layout_gravity">start</item>
+        <item name="android:textAlignment">viewStart</item>
+        <item name="android:textColor">?android:attr/textColorSecondary</item>
+        <item name="android:maxLines">10</item>
+    </style>
+
+    <style name="PermissionPreferenceRootLayoutStyle">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:minHeight">?android:attr/listPreferredItemHeightSmall</item>
+        <item name="android:gravity">center_vertical</item>
+        <item name="android:paddingLeft">?android:attr/listPreferredItemPaddingLeft</item>
+        <item name="android:paddingStart">?android:attr/listPreferredItemPaddingStart</item>
+        <item name="android:paddingRight">?android:attr/listPreferredItemPaddingRight</item>
+        <item name="android:paddingEnd">?android:attr/listPreferredItemPaddingEnd</item>
+        <item name="android:background">?android:attr/selectableItemBackground</item>
+        <item name="android:clipToPadding">false</item>
+        <item name="android:baselineAligned">false</item>
+    </style>
+
+    <style name="PermissionPreferenceIconFrameStyle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:minWidth">48dp</item>
+        <item name="android:gravity">start|center_vertical</item>
+        <item name="android:orientation">horizontal</item>
+        <item name="android:paddingLeft">0dp</item>
+        <item name="android:paddingStart">0dp</item>
+        <item name="android:paddingRight">8dp</item>
+        <item name="android:paddingEnd">8dp</item>
+        <item name="android:paddingTop">4dp</item>
+        <item name="android:paddingBottom">4dp</item>
+    </style>
+
+    <style name="PermissionPreferenceIconStyle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="maxWidth">48dp</item>
+        <item name="maxHeight">48dp</item>
+    </style>
+
+    <style name="PermissionPreferenceTextRelativeLayoutStyle">
+        <item name="android:layout_width">0dp</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_weight">1</item>
+        <item name="android:paddingTop">16dp</item>
+        <item name="android:paddingBottom">16dp</item>
+    </style>
+
+    <style name="PermissionPreferenceTitleTextStyle" >
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_gravity">start</item>
+        <item name="android:textAlignment">viewStart</item>
+        <item name="android:maxLines">2</item>
+        <item name="android:hyphenationFrequency">normalFast</item>
+        <item name="android:lineBreakWordStyle">phrase</item>
+        <item name="android:textAppearance">?android:attr/textAppearanceListItem</item>
+        <item name="android:ellipsize">marquee</item>
+    </style>
+
+    <style name="PermissionPreferenceSummaryTextStyle" parent="PreferenceSummaryTextStyle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_below">@android:id/title</item>
+        <item name="android:layout_alignLeft">@android:id/title</item>
+        <item name="android:layout_alignStart">@android:id/title</item>
+        <item name="android:layout_gravity">start</item>
+        <item name="android:textAlignment">viewStart</item>
+        <item name="android:textColor">?android:attr/textColorSecondary</item>
+        <item name="android:maxLines">10</item>
+        <item name="android:hyphenationFrequency">normalFast</item>
+        <item name="android:lineBreakWordStyle">phrase</item>
+    </style>
+
+    <style name="PermissionPreferenceWidgetFrameLayoutStyle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">match_parent</item>
+        <item name="android:gravity">end|center_vertical</item>
+        <item name="android:paddingLeft">16dp</item>
+        <item name="android:paddingStart">16dp</item>
+        <item name="android:paddingRight">0dp</item>
+        <item name="android:paddingEnd">0dp</item>
+        <item name="android:orientation">vertical</item>
+    </style>
+
+    <style name="PermissionFooterPreferenceRootLayoutStyle">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:minHeight">?android:attr/listPreferredItemHeight</item>
+        <item name="android:paddingStart">?android:attr/listPreferredItemPaddingStart</item>
+        <item name="android:paddingEnd">?android:attr/listPreferredItemPaddingEnd</item>
+        <item name="android:background">?android:attr/selectableItemBackground</item>
+        <item name="android:orientation">vertical</item>
+        <item name="android:clipToPadding">false</item>
+    </style>
+
+    <style name="PermissionFooterPreferenceIconFrameStyle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:minWidth">56dp</item>
+        <item name="android:gravity">start|top</item>
+        <item name="android:orientation">horizontal</item>
+        <item name="android:paddingEnd">12dp</item>
+        <item name="android:paddingTop">16dp</item>
+        <item name="android:paddingBottom">4dp</item>
+    </style>
+
+    <style name="PermissionFooterPreferenceIconStyle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+    </style>
+
+    <style name="PermissionFooterPreferenceLearnMoreTextLayoutStyle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:orientation">vertical</item>
+    </style>
+
+    <style name="PermissionFooterPreferenceTitleTextStyle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_gravity">start</item>
+        <item name="android:textAlignment">viewStart</item>
+        <item name="android:paddingTop">16dp</item>
+        <item name="android:paddingBottom">8dp</item>
+        <item name="android:textColor">?android:attr/textColorSecondary</item>
+        <item name="android:hyphenationFrequency">normalFast</item>
+        <item name="android:lineBreakWordStyle">phrase</item>
+        <item name="android:ellipsize">marquee</item>
+    </style>
+
+    <style name="PermissionFooterPreferenceLearnMoreTextStyle" parent="TextAppearance.Footer.Title.SettingsLib">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_gravity">start</item>
+        <item name="android:textAlignment">viewStart</item>
+        <item name="android:paddingBottom">8dp</item>
+        <item name="android:clickable">true</item>
+        <item name="android:visibility">gone</item>
+    </style>
+
+    <!-- END PREFERENCE STYLES -->
+</resources>
\ No newline at end of file
diff --git a/PermissionController/res/values-v35/themes.xml b/PermissionController/res/values-v35/themes.xml
index 49da01c6c..ff6c430c4 100644
--- a/PermissionController/res/values-v35/themes.xml
+++ b/PermissionController/res/values-v35/themes.xml
@@ -31,4 +31,5 @@
         <item name="android:windowOptOutEdgeToEdgeEnforcement">true</item>
     </style>
 
+    <style name="ThemeOverlay.PermissionSettings" parent="" />
 </resources>
diff --git a/PermissionController/res/values-vi-v35/strings.xml b/PermissionController/res/values-vi-v35/strings.xml
new file mode 100644
index 000000000..56c9bd351
--- /dev/null
+++ b/PermissionController/res/values-vi-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Bảo mật"</string>
+</resources>
diff --git a/PermissionController/res/values-vi/strings.xml b/PermissionController/res/values-vi/strings.xml
index 3796b4f9d..e4d0e73e7 100644
--- a/PermissionController/res/values-vi/strings.xml
+++ b/PermissionController/res/values-vi/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"quyền"</string>
     <string name="cancel" msgid="8943320028373963831">"Hủy"</string>
     <string name="back" msgid="6249950659061523680">"Quay lại"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Đóng"</string>
     <string name="available" msgid="6007778121920339498">"Được phép"</string>
     <string name="blocked" msgid="9195547604866033708">"Bị chặn"</string>
     <string name="on" msgid="280241003226755921">"Đang bật"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Không có"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Ứng dụng mặc định của hệ thống)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Không có ứng dụng nào"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Dịch vụ NFC khác"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Đã chọn"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Đã chọn – <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"quyền truy cập đặc biệt"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Truy cập hôm qua lúc <xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Truy cập lúc <xliff:g id="TIME_DATE_1">%2$s</xliff:g> ngày <xliff:g id="TIME_DATE_0">%1$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Mật khẩu một lần của bạn là 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Cho phép các chế độ cài đặt bị hạn chế"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Chế độ cài đặt bị hạn chế"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Để đảm bảo an toàn cho bạn, chế độ cài đặt này hiện không dùng được."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"Ứng dụng đã bị từ chối cấp quyền truy cập vào <xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"OK"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Yêu cầu quyền đã bị chặn"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Ứng dụng này đang yêu cầu thêm quyền, nhưng bạn không thể cấp quyền trong một phiên truyền trực tuyến. Trước tiên, hãy cấp quyền trên điện thoại của bạn."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Đối với cuộc gọi hoặc tin nhắn khẩn cấp"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Thông tin vị trí được gửi đến dịch vụ khẩn cấp"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Ứng dụng này đã truy cập thông tin vị trí thiết bị của bạn trong khi gọi điện hoặc nhắn tin tới một số khẩn cấp. Điều này có thể xảy ra ngay cả khi ứng dụng này không có quyền truy cập thông tin vị trí hoặc dịch vụ vị trí trên thiết bị đang tắt. "<a href="https://support.google.com/android/answer/9319337">"Tìm hiểu thêm"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Kiểm tra điện thoại của bạn"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Không kết nối được với điện thoại của bạn"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Thử lại?"</string>
 </resources>
diff --git a/PermissionController/res/values-zh-rCN-v35/strings.xml b/PermissionController/res/values-zh-rCN-v35/strings.xml
new file mode 100644
index 000000000..c9da7729f
--- /dev/null
+++ b/PermissionController/res/values-zh-rCN-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"安全"</string>
+</resources>
diff --git a/PermissionController/res/values-zh-rCN/strings.xml b/PermissionController/res/values-zh-rCN/strings.xml
index 57634575e..72ad13f40 100644
--- a/PermissionController/res/values-zh-rCN/strings.xml
+++ b/PermissionController/res/values-zh-rCN/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"权限"</string>
     <string name="cancel" msgid="8943320028373963831">"取消"</string>
     <string name="back" msgid="6249950659061523680">"返回"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"关闭"</string>
     <string name="available" msgid="6007778121920339498">"可用"</string>
     <string name="blocked" msgid="9195547604866033708">"已禁用"</string>
     <string name="on" msgid="280241003226755921">"已开启"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"无"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"（系统默认）"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"没有应用"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"其他 NFC 服务"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"已选择"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"已选择 - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"特殊应用权限"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"昨天<xliff:g id="TIME_DATE">%1$s</xliff:g>访问过"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"<xliff:g id="TIME_DATE_0">%1$s</xliff:g><xliff:g id="TIME_DATE_1">%2$s</xliff:g>访问过"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"您的动态密码为 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"允许受限制的设置"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"受限制的设置"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"出于安全考虑，此设置目前不可用。"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"系统已拒绝向此应用授予<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>访问权限"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"确定"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"权限请求被阻止"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"此应用请求获得额外的权限，但在流式传输会话期间无法授予权限。请先在手机上授予相应权限。"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"用于紧急呼叫或发送紧急短信"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"已向应急服务发送位置信息"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"在向紧急电话号码致电或发短信期间，此应用会获取您设备的位置信息。即使此应用没有位置信息权限或设备位置信息服务已关闭，也可能发生此情况。"<a href="https://support.google.com/android/answer/9319337">"了解详情"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"请查看您的手机"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"无法连接到您的手机"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"要重试吗？"</string>
 </resources>
diff --git a/PermissionController/res/values-zh-rHK-v35/strings.xml b/PermissionController/res/values-zh-rHK-v35/strings.xml
new file mode 100644
index 000000000..15c4d9bff
--- /dev/null
+++ b/PermissionController/res/values-zh-rHK-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"安全性"</string>
+</resources>
diff --git a/PermissionController/res/values-zh-rHK/strings.xml b/PermissionController/res/values-zh-rHK/strings.xml
index c3f40d3ff..bfc2db95e 100644
--- a/PermissionController/res/values-zh-rHK/strings.xml
+++ b/PermissionController/res/values-zh-rHK/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"權限"</string>
     <string name="cancel" msgid="8943320028373963831">"取消"</string>
     <string name="back" msgid="6249950659061523680">"返回"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"關閉"</string>
     <string name="available" msgid="6007778121920339498">"可用"</string>
     <string name="blocked" msgid="9195547604866033708">"已封鎖"</string>
     <string name="on" msgid="280241003226755921">"開啟"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"無"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(系統預設)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"沒有應用程式"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"其他 NFC 服務"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"已選取"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"已選取 - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"特別應用程式存取權"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"上次存取時間：昨天<xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"上次存取時間：<xliff:g id="TIME_DATE_0">%1$s</xliff:g><xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"你的一次性密碼是 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"允許受限設定"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"受限設定"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"為安全起見，系統目前不提供此設定。"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"系統已拒絕授予應用程式「<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>」存取權"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"確定"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"權限要求被拒"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"此應用程式要求額外的權限，但串流工作階段期間無法授予權限。請先在手機上授予權限。"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"供緊急電話或短訊使用"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"已傳送位置給緊急服務"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"此應用程式在你與緊急電話號碼通話或收發短訊期間存取過你的裝置位置。即使應用程式沒有位置權限或裝置位置已關閉，也可能會發生這種情況。"<a href="https://support.google.com/android/answer/9319337">"瞭解詳情"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"請查看手機"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"無法連接你的手機"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"要重試嗎？"</string>
 </resources>
diff --git a/PermissionController/res/values-zh-rTW-v35/strings.xml b/PermissionController/res/values-zh-rTW-v35/strings.xml
new file mode 100644
index 000000000..15c4d9bff
--- /dev/null
+++ b/PermissionController/res/values-zh-rTW-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"安全性"</string>
+</resources>
diff --git a/PermissionController/res/values-zh-rTW/strings.xml b/PermissionController/res/values-zh-rTW/strings.xml
index 9bedb8fc1..408107f8a 100644
--- a/PermissionController/res/values-zh-rTW/strings.xml
+++ b/PermissionController/res/values-zh-rTW/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"權限"</string>
     <string name="cancel" msgid="8943320028373963831">"取消"</string>
     <string name="back" msgid="6249950659061523680">"返回"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"關閉"</string>
     <string name="available" msgid="6007778121920339498">"可用"</string>
     <string name="blocked" msgid="9195547604866033708">"已封鎖"</string>
     <string name="on" msgid="280241003226755921">"開啟"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"無"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(系統預設)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"沒有可用的應用程式"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"其他 NFC 服務"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"已選取"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"已選取 - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"特殊應用程式存取權"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"上次存取時間：昨天<xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"上次存取時間：<xliff:g id="TIME_DATE_0">%1$s</xliff:g><xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"你的動態密碼為 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"解除受限制的設定"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"受限制的設定"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"為了安全起見，目前無法使用這項設定。"</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"系統已拒絕授予應用程式「<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>」存取權"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"確定"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"權限要求遭拒"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"這個應用程式要求額外權限，但串流期間無法授權。請先在手機上授予權限。"</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"用於緊急電話或簡訊"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"位置資訊已傳送至緊急救援服務"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"這個應用程式已在你撥打緊急電話號碼或傳送簡訊期間，存取裝置的位置資訊。即使應用程式並未取得位置存取權，或是裝置定位功能已關閉，也可能發生這種情況。"<a href="https://support.google.com/android/answer/9319337">"瞭解詳情"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"查看手機"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"無法連上手機"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"要重試嗎？"</string>
 </resources>
diff --git a/PermissionController/res/values-zu-v35/strings.xml b/PermissionController/res/values-zu-v35/strings.xml
new file mode 100644
index 000000000..39381b3ce
--- /dev/null
+++ b/PermissionController/res/values-zu-v35/strings.xml
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--  Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+ -->
+
+<resources xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
+    <string name="safety_center_entries_category_title" msgid="4413287601344137909">"Ukuvikeleka"</string>
+</resources>
diff --git a/PermissionController/res/values-zu/strings.xml b/PermissionController/res/values-zu/strings.xml
index bc97d7000..4669b2506 100644
--- a/PermissionController/res/values-zu/strings.xml
+++ b/PermissionController/res/values-zu/strings.xml
@@ -21,6 +21,7 @@
     <string name="permission_search_keyword" msgid="1214451577494730543">"izimvume"</string>
     <string name="cancel" msgid="8943320028373963831">"Khansela"</string>
     <string name="back" msgid="6249950659061523680">"Emuva"</string>
+    <string name="dialog_close" msgid="6840699812532384661">"Vala"</string>
     <string name="available" msgid="6007778121920339498">"Iyatholakala"</string>
     <string name="blocked" msgid="9195547604866033708">"Uvinjiwe"</string>
     <string name="on" msgid="280241003226755921">"Vuliwe"</string>
@@ -440,6 +441,7 @@
     <string name="default_app_none" msgid="9084592086808194457">"Lutho"</string>
     <string name="default_app_system_default" msgid="6218386768175513760">"(Okuzenzakalelayo kwesistimu)"</string>
     <string name="default_app_no_apps" msgid="115720991680586885">"Azikho izinhlelo zokusebenza"</string>
+    <string name="default_payment_app_other_nfc_services" msgid="5957633798695758917">"Amanye amasevisi we-NFC"</string>
     <string name="car_default_app_selected" msgid="5416420830430644174">"Ekhethiwe"</string>
     <string name="car_default_app_selected_with_info" msgid="1932204186080593500">"Ekhethiwe - <xliff:g id="ADDITIONAL_INFO">%1$s</xliff:g>"</string>
     <string name="special_app_access_search_keyword" msgid="8032347212290774210">"ukufinyelela kwi-app okukhethekile"</string>
@@ -669,6 +671,7 @@
     <string name="wear_app_perms_24h_access_yest" msgid="7069312481704735679">"Kufinyelelwe izolo ngo-<xliff:g id="TIME_DATE">%1$s</xliff:g>"</string>
     <string name="wear_app_perms_7d_access" msgid="4608069019194676432">"Kufinyelelwe ngo-<xliff:g id="TIME_DATE_0">%1$s</xliff:g> <xliff:g id="TIME_DATE_1">%2$s</xliff:g>"</string>
     <string name="test_otp_msg" msgid="7559110574222727550">"Iphasiwedi yakho yesikhathi esisodwa ithi 132435"</string>
+    <string name="allow_restricted_settings" msgid="8073000189478396881">"Vumela amasethingi akhawulelwe"</string>
     <string name="enhanced_confirmation_dialog_title" msgid="7562437438040966351">"Amasethingi akhawulelwe"</string>
     <string name="enhanced_confirmation_dialog_desc" msgid="5921240234843839219">"Ukuze uphephe, leli sethingi okwamanje alitholakali."</string>
     <string name="enhanced_confirmation_dialog_title_permission" msgid="2149144789394238266">"I-app inqatshelwe ukufinyelela ku-<xliff:g id="PERMISSION_NAME">%1$s</xliff:g>"</string>
@@ -681,4 +684,10 @@
     <string name="enhanced_confirmation_dialog_ok" msgid="8560373821598619924">"KULUNGILE"</string>
     <string name="permission_grant_dialog_streaming_blocked_title" msgid="8905241017017043649">"Isicelo semvume sicindezelwe"</string>
     <string name="permission_grant_dialog_streaming_blocked_description" msgid="838165608934085319">"Le-app icela izimvume ezengeziwe, kodwa izimvume azikwazi ukunikezwa ngesikhathi sokusakaza-bukhoma. Nikeza imvume kufoni yakho kuqala."</string>
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label" msgid="5702912511473457693">"Okwekholi yezimo eziphuthumayo noma umyalezo"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_title" msgid="849723944428031911">"Indawo ithunyelwe emasevisini ezimo eziphuthumayo"</string>
+    <string name="privacy_dashboard_emergency_location_dialog_description" msgid="5815970230573483329">"Le app ifinyelele indawo yedivayisi yakho phakathi nekholi noma umyalezo othunyelwe enombolweni yezimo eziphuthumayo. Lokhu kungenzeka lapho i-app ingenayo imvume yendawo noma uma indawo yedivayisi ivaliwe. "<a href="https://support.google.com/android/answer/9319337">"Funda kabanzi"</a></string>
+    <string name="wear_check_your_phone_title" msgid="7957291983474981420">"Hlola ifoni yakho"</string>
+    <string name="wear_phone_connection_error" msgid="8934350845737930783">"Ayikwazanga ukufinyelela efonini yakho"</string>
+    <string name="wear_phone_connection_should_retry" msgid="2835355845567088003">"Zama futhi?"</string>
 </resources>
diff --git a/PermissionController/res/values/attrs.xml b/PermissionController/res/values/attrs.xml
index cc93effde..0634ab5f1 100644
--- a/PermissionController/res/values/attrs.xml
+++ b/PermissionController/res/values/attrs.xml
@@ -37,4 +37,9 @@
     <attr name="carDividerColor" format="color"/>
     <!-- END: Car Settings Preferences -->
 
+    <!-- START: AppPermissionFragment -->
+    <attr name="extraWidgetId" format="reference" />
+    <attr name="extraWidgetIcon" format="reference" />
+    <attr name="checkboxId" format="reference" />
+    <!-- END: AppPermissionFragment -->
 </resources>
diff --git a/PermissionController/res/values/config.xml b/PermissionController/res/values/config.xml
index 8e3a58abd..675368cba 100644
--- a/PermissionController/res/values/config.xml
+++ b/PermissionController/res/values/config.xml
@@ -27,4 +27,6 @@
 
     <!-- Whether to show the "Show password" toggle -->
     <bool name="config_display_show_password_toggle">true</bool>
+
+    <bool name="config_permissionFooterPreferenceIconVisible">true</bool>
 </resources>
diff --git a/PermissionController/res/values/dimens.xml b/PermissionController/res/values/dimens.xml
index 53d5341fe..f838fea45 100644
--- a/PermissionController/res/values/dimens.xml
+++ b/PermissionController/res/values/dimens.xml
@@ -23,9 +23,12 @@
     <dimen name="header_margin_start">16dp</dimen>
     <dimen name="header_margin_end">16dp</dimen>
 
-    <dimen name="permission_icon_size">24dp</dimen>
+    <dimen name="tv_permission_icon_size">24dp</dimen>
     <dimen name="permission_icon_header_size">32dp</dimen>
 
+    <dimen name="permission_preference_app_icon_size">@dimen/secondary_app_icon_size</dimen>
+    <dimen name="permission_preference_permission_group_icon_size">24dp</dimen>
+
     <dimen name="lb_action_section_width">384dp</dimen>
 
     <dimen name="lb_content_section_width">576dp</dimen>
@@ -70,6 +73,31 @@
 
     <dimen name="location_accuracy_image_size">130dp</dimen>
 
+    <dimen name="toggle_preference_container_min_width">56dp</dimen>
+
+    <dimen name="car_location_permission_prompt_radius">40dp</dimen>
+    <dimen name="car_location_permission_prompt_icon_size">32dp</dimen>
+    <dimen name="car_location_permission_prompt_padding_large">40dp</dimen>
+    <dimen name="car_location_permission_prompt_padding">24dp</dimen>
+    <dimen name="car_location_permission_prompt_padding_medium">20dp</dimen>
+    <dimen name="car_location_permission_prompt_padding_small">16dp</dimen>
+    <dimen name="car_location_permission_prompt_padding_extra_small">6dp</dimen>
+    <dimen name="car_location_permission_prompt_margin_large">32dp</dimen>
+    <dimen name="car_location_permission_prompt_margin_medium">24dp</dimen>
+    <dimen name="car_location_permission_prompt_margin_small">12dp</dimen>
+    <dimen name="car_location_permission_prompt_margin_xsmall">8dp</dimen>
+    <dimen name="car_location_permission_prompt_margin_extra_small">6dp</dimen>
+    <dimen name="car_location_permission_prompt_min_width">520dp</dimen>
+    <dimen name="car_location_permission_prompt_min_height">64dp</dimen>
+    <dimen name="car_location_permission_prompt_button_text_size">28sp</dimen>
+    <dimen name="car_location_permission_prompt_text_size_xlarge">32sp</dimen>
+    <dimen name="car_location_permission_prompt_line_height_xlarge">40sp</dimen>
+    <dimen name="car_location_permission_prompt_text_size_large">24sp</dimen>
+    <dimen name="car_location_permission_prompt_text_size_medium">20sp</dimen>
+    <dimen name="car_location_permission_prompt_text_size_small">16sp</dimen>
+    <dimen name="car_location_permission_prompt_line_height_small">36sp</dimen>
+    <dimen name="car_location_permission_prompt_radio_button_text_size">28sp</dimen>
+
     <item name="permission_access_time_dialog_width_scalar" format="float" type="dimen">0.9</item>
     <item name="permission_access_time_dialog_height_scalar" format="float" type="dimen">0.7</item>
 
diff --git a/PermissionController/res/values/overlayable.xml b/PermissionController/res/values/overlayable.xml
index 0cf52ac4a..9075fa67c 100644
--- a/PermissionController/res/values/overlayable.xml
+++ b/PermissionController/res/values/overlayable.xml
@@ -27,6 +27,43 @@
             <item type="string" name="help_url_action_disabled_by_restricted_settings" />
             <!-- END HELP LINKS -->
 
+            <!-- START PREFERENCE STYLES. Used in V35 only -->
+            <item type="style" name="PermissionPreferenceCategoryRootLayoutStyle" />
+            <item type="style" name="PermissionPreferenceCategoryTextRelativeLayoutStyle" />
+            <item type="style" name="PermissionPreferenceCategoryTitleTextStyle" />
+            <item type="style" name="PermissionPreferenceCategorySummaryTextStyle" />
+
+            <item type="style" name="PermissionPreferenceRootLayoutStyle" />
+            <item type="style" name="PermissionPreferenceIconFrameStyle" />
+            <item type="style" name="PermissionPreferenceIconStyle" />
+            <item type="style" name="PermissionPreferenceTextRelativeLayoutStyle" />
+            <item type="style" name="PermissionPreferenceTitleTextStyle" />
+            <item type="style" name="PermissionPreferenceSummaryTextStyle" />
+            <item type="style" name="PermissionPreferenceWidgetFrameLayoutStyle" />
+
+            <item type="style" name="PermissionFooterPreferenceRootLayoutStyle" />
+            <item type="style" name="PermissionFooterPreferenceIconFrameStyle" />
+            <item type="style" name="PermissionFooterPreferenceIconStyle" />
+            <item type="style" name="PermissionFooterPreferenceLearnMoreTextLayoutStyle" />
+            <item type="style" name="PermissionFooterPreferenceTitleTextStyle" />
+            <item type="style" name="PermissionFooterPreferenceLearnMoreTextStyle" />
+
+            <item type="bool" name="config_permissionFooterPreferenceIconVisible" />
+            <item type="dimen" name="permission_preference_app_icon_size" />
+            <item type="dimen" name="permission_preference_permission_group_icon_size" />
+
+            <!-- END PREFERENCE STYLES -->
+
+            <!-- START AUTO PERMISSION GRANT DIALOG -->
+
+            <item type="style" name="AutoPermissionLocationAccuracyRadioFine" />
+            <item type="style" name="AutoPermissionLocationAccuracyRadioCoarse" />
+            <item type="style" name="AutoPermissionGrantDialogMaterial3" />
+            <item type="style" name="AutoPermissionGrantTitleMessage" />
+            <item type="style" name="AutoPermissionGrantButton" />
+
+            <!-- END AUTO PERMISSION GRANT DIALOG -->
+
             <!-- START PERMISSION GRANT DIALOG -->
             <item type="style" name="PermissionGrantScrollView" />
             <item type="style" name="PermissionGrantSingleton" />
@@ -287,6 +324,10 @@
             <item type="dimen" name="secondary_app_icon_size" />
             <!-- END SETTINGSLIB APPPREFERENCE -->
 
+            <!-- START ATTRS -->
+            <item type="attr" name="state_has_icon_space" />
+            <!-- END ATTRS -->
+
             <!-- START THEMES -->
             <item type="style" name="Settings" />
             <item type="style" name="TextAppearance.CategoryTitle" />
@@ -296,6 +337,8 @@
             <item type="style" name="RequestRole" />
             <item type="style" name="Theme.PermissionGrantDialog" />
             <item type="style" name="PermissionDialog" />
+            <!-- Theme overlay applied to permission settings UI on v35+ -->
+            <item type="style" name="ThemeOverlay.PermissionSettings" />
             <!-- END THEMES -->
 
             <!-- START VISIBILITY CONFIGS -->
@@ -328,6 +371,7 @@
             <!-- END CAR THEMES -->
 
             <!-- START LAYOUTPREFERENCE -->
+            <!-- {@deprecated Use SettingsLibEntityHeaderTitle.} -->
             <item type="style" name="TextAppearance.EntityHeaderTitle" />
             <!-- END LAYOUTPREFERENCE -->
 
@@ -416,6 +460,15 @@
             <item type="style" name="EnhancedConfirmationDialogButton" />
             <!-- END ENHANCED CONFIRMATION DIALOG -->
 
+            <!-- START STETINGS LIB HEADER -->
+            <item type="style" name="SettingsLibEntityHeader" />
+            <item type="style" name="SettingsLibEntityHeaderContent" />
+            <item type="style" name="SettingsLibEntityHeaderIcon" />
+            <item type="style" name="SettingsLibEntityHeaderTitle" />
+
+            <item type="bool" name="config_useCollapsingToolbarInPermissionSettings"/>
+            <!-- END SETTINGS LIB HEADER -->
+
         </policy>
 
     </overlayable>
diff --git a/PermissionController/res/values/strings.xml b/PermissionController/res/values/strings.xml
index 9341e2967..d67a3582d 100644
--- a/PermissionController/res/values/strings.xml
+++ b/PermissionController/res/values/strings.xml
@@ -30,6 +30,9 @@
     <!-- Button label for back action [CHAR LIMIT=20] -->
     <string name="back">Back</string>
 
+    <!-- Button label for closing a dialog action -->
+    <string name="dialog_close">Close</string>
+
     <!-- Label indicating access is allowed. If you update this string, please
     update the string "quick_settings_camera_mic_available" in System Ui [CHAR LIMIT=NONE] -->
     <string name="available">Available</string>
@@ -1326,6 +1329,9 @@
     <!-- Label when there are no apps available for a default app [CHAR LIMIT=30] -->
     <string name="default_app_no_apps">No apps</string>
 
+    <!-- Title for preference item that will open a screen to manage other NFC services [CHAR LIMIT=50] -->
+    <string name="default_payment_app_other_nfc_services">Other NFC services</string>
+
     <!-- Label for the selected default app for default app [CHAR LIMIT=30] -->
     <string name="car_default_app_selected">Selected</string>
 
@@ -1989,6 +1995,9 @@ Allow <xliff:g id="app_name" example="Gmail">%4$s</xliff:g> to upload a bug repo
     <!-- A string representing a message (sms, email, etc.) telling the user about a one time password. Used for testing [CHAR LIMIT=NONE] -->
     <string name="test_otp_msg">Your one time password is 132435</string>
 
+    <!-- [CHAR LIMIT=50] Manage applications, unlock restricted setting from app permissions options menu -->
+    <string name="allow_restricted_settings">Allow restricted settings</string>
+
     <!-- START ENHANCED CONFIRMATION DIALOG -->
 
     <!--Title for dialog displayed to tell user that settings are blocked by setting restrictions [CHAR LIMIT=50] -->
@@ -2023,4 +2032,21 @@ Allow <xliff:g id="app_name" example="Gmail">%4$s</xliff:g> to upload a bug repo
 
     <!-- Descriptions for the warning dialog that shows when permission grant dialog is blocked from streaming to a remote device [CHAR LIMIT=200] -->
     <string name="permission_grant_dialog_streaming_blocked_description">This app is requesting additional permissions, but permissions can’t be granted in a streaming session. Grant the permission on your phone first.</string>
+
+    <!-- Attribution label that is enforced to show for emergency location accesses in the privacy dashboard -->
+    <string name="privacy_dashboard_emergency_location_enforced_attribution_label">For emergency call or text</string>
+    <!-- Title of the dialog when clicking the app op access entry for EMERGENCY_LOCATION in the privacy dashboard -->
+    <string name="privacy_dashboard_emergency_location_dialog_title">Location sent to emergency services</string>
+    <!-- Description of the dialog when clicking the app op access entry for EMERGENCY_LOCATION in the privacy dashboard -->
+    <string name="privacy_dashboard_emergency_location_dialog_description">This app accessed your device\'s location during a call or text to an emergency number. This can happen even when the app doesn\'t have location permission or the device location is off. <a href="https://support.google.com/android/answer/9319337">Learn more</a></string>
+    <!-- Close button in the pop up dialog when clicking the app op access entry in the privacy dashboard -->
+
+    <!-- Text instructing user to check their paired phone-->
+    <string name="wear_check_your_phone_title">Check your phone</string>
+
+    <!-- Text letting the user to know that companion phone couldn't be reached -->
+    <string name="wear_phone_connection_error">Couldn\'t reach your phone</string>
+
+    <!-- Text asking the user if they want to retry connecting to the paired phone -->
+    <string name="wear_phone_connection_should_retry">Retry?</string>
 </resources>
diff --git a/PermissionController/res/values/styles.xml b/PermissionController/res/values/styles.xml
index 043934ac4..c764e776e 100644
--- a/PermissionController/res/values/styles.xml
+++ b/PermissionController/res/values/styles.xml
@@ -17,6 +17,108 @@
 
 <resources>
 
+    <!--  START AUTO PERMISSION GRANT DIALOG  -->
+
+    <style name="AutoPermissionGrantScrollView">
+        <item name="android:scrollbars">none</item>
+        <item name="android:fillViewport">true</item>
+        <item name="android:clipChildren">false</item>
+    </style>
+
+    <style name="AutoPermissionGrantSingleton">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:gravity">center</item>
+    </style>
+
+    <style name="AutoPermissionGrantDialogMaterial3">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:orientation">vertical</item>
+        <item name="android:padding">@dimen/car_location_permission_prompt_padding_large</item>
+        <item name="android:background">@drawable/auto_grant_permissions_dialog</item>
+    </style>
+
+    <style name="AutoPermissionGrantContent">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:orientation">vertical</item>
+        <item name="android:paddingBottom">@dimen/car_location_permission_prompt_padding_medium</item>
+    </style>
+
+    <style name="AutoPermissionGrantDescription">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:orientation">vertical</item>
+        <item name="android:gravity">start</item>
+    </style>
+
+    <style name="AutoPermissionGrantTitleMessage" parent="@android:style/TextAppearance.DeviceDefault.WindowTitle">
+        <item name="android:layout_width">wrap_content</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:maxWidth">@dimen/car_location_permission_prompt_min_width</item>
+        <item name="android:textSize">@dimen/car_location_permission_prompt_text_size_xlarge</item>
+        <item name="android:lineHeight">@dimen/car_location_permission_prompt_line_height_xlarge</item>
+        <item name="android:layout_marginBottom">@dimen/car_location_permission_prompt_margin_small</item>
+        <item name="android:textAppearance">?android:attr/textAppearanceLarge</item>
+    </style>
+
+    <style name="AutoPermissionGrantDetailMessage" parent="@android:style/TextAppearance.DeviceDefault">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_marginTop">@dimen/car_location_permission_prompt_margin_small</item>
+        <item name="android:textSize">@dimen/car_location_permission_prompt_text_size_small</item>
+    </style>
+
+    <style name="AutoPermissionLocationAccuracyRadioGroupMaterial3">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_marginBottom">@dimen/car_location_permission_prompt_margin_medium</item>
+        <item name="android:gravity">center_horizontal</item>
+        <item name="android:orientation">horizontal</item>
+    </style>
+
+    <style name="AutoPermissionLocationAccuracyRadioFine">
+        <item name="android:button">@null</item>
+        <item name="android:background">@null</item>
+        <item name="android:gravity">center_horizontal</item>
+        <item name="android:layout_marginEnd">@dimen/car_location_permission_prompt_margin_large</item>
+        <item name="android:drawablePadding">8dp</item>
+        <item name="android:textSize">@dimen/car_location_permission_prompt_radio_button_text_size</item>
+        <item name="android:lineHeight">@dimen/car_location_permission_prompt_line_height_small</item>
+    </style>
+
+    <style name="AutoPermissionLocationAccuracyRadioCoarse">
+        <item name="android:button">@null</item>
+        <item name="android:background">@null</item>
+        <item name="android:gravity">center_horizontal</item>
+        <item name="android:layout_marginStart">@dimen/car_location_permission_prompt_margin_large</item>
+        <item name="android:drawablePadding">8dp</item>
+        <item name="android:textSize">@dimen/car_location_permission_prompt_radio_button_text_size</item>
+        <item name="android:lineHeight">@dimen/car_location_permission_prompt_line_height_small</item>
+    </style>
+
+    <style name="AutoPermissionLocationAccuracyImageViewMaterial13">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:layout_marginBottom">@dimen/car_location_permission_prompt_margin_medium</item>
+    </style>
+
+    <style name="AutoPermissionGrantButtonListMaterial3">
+        <item name="android:layout_width">match_parent</item>
+        <item name="android:layout_height">wrap_content</item>
+        <item name="android:orientation">vertical</item>
+    </style>
+
+    <style name="AutoPermissionGrantButtonBarSpace">
+        <item name="android:layout_width">0dp</item>
+        <item name="android:layout_height">0dp</item>
+        <item name="android:visibility">gone</item>
+    </style>
+
+    <!-- END AUTO PERMISSION GRANT DIALOG -->
+
+
     <!-- START PERMISSION GRANT DIALOG -->
 
     <style name="PermissionGrantScrollView">
@@ -1370,6 +1472,7 @@
         <item name="android:layout_height">wrap_content</item>
         <item name="android:layout_marginTop">16dp</item>
         <item name="android:gravity">center_horizontal</item>
+        <item name="android:fontFamily">google-sans</item>
     </style>
 
     <style name="EnhancedConfirmationDialogScrollView">
diff --git a/PermissionController/res/values/themes.xml b/PermissionController/res/values/themes.xml
index 2e6af4af1..9aa14a64c 100644
--- a/PermissionController/res/values/themes.xml
+++ b/PermissionController/res/values/themes.xml
@@ -107,6 +107,8 @@
 
     <style name="Theme.DeviceDefault.Dialog.NoActionBar.DayNight" parent="@android:style/Theme.DeviceDefault.Light.Dialog.NoActionBar" />
 
+    <style name="Theme.DeviceDefault.Dialog.Alert.DayNight" parent="@android:style/Theme.DeviceDefault.Light.Dialog.Alert" />
+
     <!--
         TODO(b/309578419): Make activities handle insets properly and then remove this.
     -->
@@ -152,7 +154,7 @@
 
     <!-- START ENHANCED CONFIRMATION DIALOG -->
 
-    <style name="Theme.EnhancedConfirmationDialog" parent="@android:style/Theme.DeviceDefault.Dialog.NoActionBar">
+    <style name="Theme.EnhancedConfirmationDialog" parent="@style/Theme.DeviceDefault.Dialog.NoActionBar.DayNight">
         <item name="windowNoTitle">true</item>
         <item name="android:alertDialogTheme">@style/Theme.EnhancedConfirmationDialogFragment</item>
         <item name="android:buttonBarStyle">@style/EnhancedConfirmationDialogButtonBar</item>
@@ -161,7 +163,7 @@
         <item name="android:buttonBarNeutralButtonStyle">@style/EnhancedConfirmationDialogButton</item>
     </style>
 
-    <style name="Theme.EnhancedConfirmationDialogFragment" parent="@android:style/Theme.DeviceDefault.Dialog.Alert">
+    <style name="Theme.EnhancedConfirmationDialogFragment" parent="@style/Theme.DeviceDefault.Dialog.Alert.DayNight">
         <item name="android:buttonBarStyle">@style/EnhancedConfirmationDialogButtonBar</item>
     </style>
 
diff --git a/PermissionController/res/xml/all_permissions.xml b/PermissionController/res/xml/all_permissions.xml
index 5f7f847ba..5e97f36af 100644
--- a/PermissionController/res/xml/all_permissions.xml
+++ b/PermissionController/res/xml/all_permissions.xml
@@ -17,7 +17,7 @@
 <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
                   android:title="@string/all_permissions">
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
             android:key="other_perms"
             android:title="@string/other_permissions" />
 
diff --git a/PermissionController/res/xml/allowed_denied.xml b/PermissionController/res/xml/allowed_denied.xml
index 0e6c27268..f283b2c5c 100644
--- a/PermissionController/res/xml/allowed_denied.xml
+++ b/PermissionController/res/xml/allowed_denied.xml
@@ -17,23 +17,23 @@
 <PreferenceScreen
     xmlns:android="http://schemas.android.com/apk/res/android">
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="allowed"
         android:title="@string/allowed_header" />
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="allowed_foreground"
         android:title="@string/allowed_foreground_header" />
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="ask"
         android:title="@string/ask_header" />
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="denied"
         android:title="@string/denied_header" />
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="storage_footer_category" />
 
 </PreferenceScreen>
diff --git a/PermissionController/res/xml/allowed_denied_storage.xml b/PermissionController/res/xml/allowed_denied_storage.xml
index e6fdc5dea..3a61f92f3 100644
--- a/PermissionController/res/xml/allowed_denied_storage.xml
+++ b/PermissionController/res/xml/allowed_denied_storage.xml
@@ -18,23 +18,23 @@
 <PreferenceScreen
     xmlns:android="http://schemas.android.com/apk/res/android">
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="allowed_storage_full"
         android:title="@string/allowed_storage_full" />
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="allowed_storage_scoped"
         android:title="@string/allowed_storage_scoped" />
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="allowed_foreground"
         android:title="@string/allowed_foreground_header" />
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="ask"
         android:title="@string/ask_header" />
 
-    <PreferenceCategory
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
         android:key="denied"
         android:title="@string/denied_header" />
 
diff --git a/PermissionController/res/xml/app_permission.xml b/PermissionController/res/xml/app_permission.xml
new file mode 100644
index 000000000..5e6857185
--- /dev/null
+++ b/PermissionController/res/xml/app_permission.xml
@@ -0,0 +1,104 @@
+<PreferenceScreen
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto">
+
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
+        android:key="app_permission_rationale_container"
+        android:title="@string/app_permission_rationale_message"
+        app:isPreferenceVisible="false">
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionPreference
+            android:key="app_permission_rationale"
+            android:icon="@drawable/ic_shield_exclamation_outline_24dp"
+            android:summary="@string/app_location_permission_rationale_subtitle"
+            android:title="@string/app_location_permission_rationale_title" />
+
+    </com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory>
+
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory
+        android:key="app_permission_button_category"
+        android:title="@string/app_permission_header">
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference
+            android:key="app_permission_allow_radio_button"
+            android:title="@string/app_permission_button_allow"
+            app:checkboxId="@+id/allow_radio_button" />
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference
+            android:key="app_permission_allow_always_radio_button"
+            android:title="@string/app_permission_button_allow_always"
+            app:checkboxId="@+id/allow_always_radio_button"
+            app:isPreferenceVisible="false" />
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference
+            android:key="app_permission_allow_foreground_only_radio_button"
+            android:title="@string/app_permission_button_allow_foreground"
+            app:checkboxId="@+id/allow_foreground_only_radio_button" />
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference
+            android:key="app_permission_select_photos_radio_button"
+            android:title="@string/app_permission_button_allow_limited_access"
+            app:checkboxId="@+id/select_radio_button"
+            app:extraWidgetIcon="@drawable/ic_edit"
+            app:extraWidgetId="@+id/edit_selected_button" />
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference
+            android:key="app_permission_ask_one_time_radio_button"
+            android:title="@string/app_permission_button_ask"
+            app:checkboxId="@+id/ask_one_time_radio_button" />
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference
+            android:key="app_permission_ask_radio_button"
+            android:text="@string/app_permission_button_ask"
+            android:title="@string/app_permission_button_ask"
+            app:checkboxId="@+id/ask_radio_button" />
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference
+            android:key="app_permission_deny_radio_button"
+            android:title="@string/app_permission_button_deny"
+            app:checkboxId="@+id/deny_radio_button" />
+
+        <com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference
+            android:key="app_permission_deny_foreground_radio_button"
+            android:title="@string/app_permission_button_deny"
+            app:checkboxId="@+id/deny_foreground_radio_button" />
+
+    </com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory>
+
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionSwitchPreference
+        android:key="app_permission_location_accuracy_switch"
+        android:summary="@string/app_permission_location_accuracy_subtitle"
+        android:title="@string/app_permission_location_accuracy"
+        app:isPreferenceVisible="false" />
+
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionTwoTargetPreference
+        android:key="app_permission_details"
+        android:selectable="false"
+        android:summary="@string/permission_summary_enabled_system_fixed"
+        app:extraWidgetIcon="@drawable/ic_settings"
+        app:iconSpaceReserved="true"
+        app:isPreferenceVisible="false" />
+
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreference
+        android:key="app_permission_footer_link_1"
+        android:summary="@string/app_permission_footer_app_permissions_link" />
+
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreference
+        android:key="app_permission_footer_link_2"
+        android:summary="@string/app_permission_footer_permission_apps_link" />
+
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreference
+        android:key="app_permission_footer_storage_special_app_access"
+        android:icon="@drawable/ic_info_outline"
+        android:selectable="false"
+        android:summary="@string/app_permission_footer_special_file_access"
+        app:isPreferenceVisible="false" />
+
+    <com.android.permissioncontroller.permission.ui.handheld.PermissionPreference
+        android:key="app_permission_additional_info"
+        android:icon="@drawable/ic_info_outline"
+        android:selectable="false"
+        android:summary="@string/exempt_info_label"
+        app:isPreferenceVisible="false" />
+
+</PreferenceScreen>
diff --git a/PermissionController/res/xml/roles.xml b/PermissionController/res/xml/roles.xml
index 6e65b96e3..1d01f8208 100644
--- a/PermissionController/res/xml/roles.xml
+++ b/PermissionController/res/xml/roles.xml
@@ -92,6 +92,15 @@
         <permission name="android.permission.POST_NOTIFICATIONS" minSdkVersion="33" />
     </permission-set>
 
+    <permission-set name="virtual_device">
+        <permission name="android.permission.CREATE_VIRTUAL_DEVICE" minSdkVersion="33" />
+        <permission name="android.permission.ADD_TRUSTED_DISPLAY" minSdkVersion="33" />
+        <permission name="android.permission.ADD_ALWAYS_UNLOCKED_DISPLAY" minSdkVersion="33" />
+        <permission
+            name="android.permission.SUBSCRIBE_TO_KEYGUARD_LOCKED_STATE"
+            featureFlag="android.companion.virtualdevice.flags.Flags.activityControlApi" />
+    </permission-set>
+
     <role
         name="android.app.role.ASSISTANT"
         behavior="AssistantRoleBehavior"
@@ -697,6 +706,10 @@
                 minSdkVersion="35" />
             <permission name="android.permission.MANAGE_DEVICE_POLICY_AUDIT_LOGGING"
                 minSdkVersion="35" />
+            <permission name="android.permission.EXECUTE_APP_FUNCTIONS"
+                featureFlag="android.app.appfunctions.flags.Flags.enableAppFunctionManager" />
+            <permission name="android.permission.EXECUTE_APP_FUNCTIONS_TRUSTED"
+                featureFlag="android.app.appfunctions.flags.Flags.enableAppFunctionManager" />
         </permissions>
     </role>
 
@@ -860,6 +873,8 @@
             <permission name="android.permission.READ_SMS" minSdkVersion="33" />
             <permission name="android.permission.READ_PEOPLE_DATA" />
             <permission name="android.permission.READ_GLOBAL_APP_SEARCH_DATA" />
+            <permission name="android.permission.EXECUTE_APP_FUNCTIONS_TRUSTED"
+                featureFlag="android.app.appfunctions.flags.Flags.enableAppFunctionManager" />
         </permissions>
     </role>
 
@@ -1189,11 +1204,9 @@
         visible="false">
         <permissions>
             <permission-set name="notifications" />
+            <permission-set name="virtual_device" />
             <!-- For capturing audio from the app on the device. -->
             <permission name="android.permission.RECORD_AUDIO" />
-            <permission name="android.permission.CREATE_VIRTUAL_DEVICE" minSdkVersion="33" />
-            <permission name="android.permission.ADD_TRUSTED_DISPLAY" minSdkVersion="33" />
-            <permission name="android.permission.ADD_ALWAYS_UNLOCKED_DISPLAY" minSdkVersion="33" />
 
             <!--TODO(b/201605314) For calling Telecom framework API for audio streaming-->
             <!--<permission name="android.permission.PROVIDE_CALL_ENDPOINTS" />-->
@@ -1260,9 +1273,7 @@
         visible="false">
         <permissions>
             <permission-set name="nearby_devices" />
-            <permission name="android.permission.CREATE_VIRTUAL_DEVICE" />
-            <permission name="android.permission.ADD_TRUSTED_DISPLAY" />
-            <permission name="android.permission.ADD_ALWAYS_UNLOCKED_DISPLAY" />
+            <permission-set name="virtual_device" />
         </permissions>
     </role>
 
diff --git a/PermissionController/role-controller/Android.bp b/PermissionController/role-controller/Android.bp
index ea6545bb1..166823b08 100644
--- a/PermissionController/role-controller/Android.bp
+++ b/PermissionController/role-controller/Android.bp
@@ -27,6 +27,8 @@ java_library {
     ],
     static_libs: [
         "modules-utils-build_system",
+        "android.app.appfunctions.exported-flags-aconfig-java",
+        "android.companion.virtualdevice.flags-aconfig-java-export",
         "android.permission.flags-aconfig-java-export",
         "android.os.flags-aconfig-java-export",
     ],
diff --git a/PermissionController/role-controller/java/com/android/role/controller/behavior/AssistantRoleBehavior.java b/PermissionController/role-controller/java/com/android/role/controller/behavior/AssistantRoleBehavior.java
index c20734cde..d025d1b03 100644
--- a/PermissionController/role-controller/java/com/android/role/controller/behavior/AssistantRoleBehavior.java
+++ b/PermissionController/role-controller/java/com/android/role/controller/behavior/AssistantRoleBehavior.java
@@ -17,6 +17,7 @@
 package com.android.role.controller.behavior;
 
 import android.app.ActivityManager;
+import android.app.appfunctions.flags.Flags;
 import android.app.role.RoleManager;
 import android.content.Context;
 import android.content.Intent;
@@ -36,15 +37,18 @@ import android.util.Xml;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
+import com.android.role.controller.model.Permissions;
 import com.android.role.controller.model.Role;
 import com.android.role.controller.model.RoleBehavior;
 import com.android.role.controller.model.VisibilityMixin;
+import com.android.role.controller.util.PackageUtils;
 import com.android.role.controller.util.UserUtils;
 
 import org.xmlpull.v1.XmlPullParserException;
 
 import java.io.IOException;
 import java.util.ArrayList;
+import java.util.Arrays;
 import java.util.List;
 import java.util.Set;
 
@@ -55,6 +59,14 @@ public class AssistantRoleBehavior implements RoleBehavior {
 
     private static final String LOG_TAG = AssistantRoleBehavior.class.getSimpleName();
 
+    /**
+     * Permissions to be granted if the application fulfilling the assistant role is also a system
+     * or preinstalled app.
+     */
+    private static final List<String> SYSTEM_ASSISTANT_PERMISSIONS = Arrays.asList(
+            android.Manifest.permission.EXECUTE_APP_FUNCTIONS
+    );
+
     @Override
     public void onRoleAddedAsUser(@NonNull Role role, @NonNull UserHandle user,
             @NonNull Context context) {
@@ -76,6 +88,28 @@ public class AssistantRoleBehavior implements RoleBehavior {
         return !UserUtils.isProfile(user, context);
     }
 
+    @Override
+    public void grantAsUser(@NonNull Role role, @NonNull String packageName,
+            @NonNull UserHandle user, @NonNull Context context) {
+        if (Flags.enableAppFunctionManager()) {
+            if (PackageUtils.isSystemPackageAsUser(packageName, user, context)) {
+                Permissions.grantAsUser(packageName, SYSTEM_ASSISTANT_PERMISSIONS, false, false,
+                        true, false, false, user, context);
+            }
+        }
+    }
+
+    @Override
+    public void revokeAsUser(@NonNull Role role, @NonNull String packageName,
+            @NonNull UserHandle user, @NonNull Context context) {
+        if (Flags.enableAppFunctionManager()) {
+            if (PackageUtils.isSystemPackageAsUser(packageName, user, context)) {
+                Permissions.revokeAsUser(packageName, SYSTEM_ASSISTANT_PERMISSIONS, true, false,
+                        false, user, context);
+            }
+        }
+    }
+
     @Nullable
     @Override
     public List<String> getQualifyingPackagesAsUser(@NonNull Role role, @NonNull UserHandle user,
diff --git a/PermissionController/role-controller/java/com/android/role/controller/behavior/v34/NotesRoleBehavior.java b/PermissionController/role-controller/java/com/android/role/controller/behavior/v34/NotesRoleBehavior.java
index 71f7795f7..382a03d5f 100644
--- a/PermissionController/role-controller/java/com/android/role/controller/behavior/v34/NotesRoleBehavior.java
+++ b/PermissionController/role-controller/java/com/android/role/controller/behavior/v34/NotesRoleBehavior.java
@@ -46,17 +46,12 @@ public class NotesRoleBehavior implements RoleBehavior {
             return false;
         }
 
-        // Cloned profile shouldn't have a separate role.
-        if (UserUtils.isCloneProfile(user, context)) {
-            return false;
-        }
-
         if (UserUtils.isManagedProfile(user, context)) {
             // The role holder for work profile is separately controlled via config.
             return resources.getBoolean(android.R.bool.config_enableDefaultNotesForWorkProfile);
         }
 
-        return true;
+        return !UserUtils.isProfile(user, context);
     }
 
     /**
diff --git a/PermissionController/role-controller/java/com/android/role/controller/compat/AppOpsManagerCompat.java b/PermissionController/role-controller/java/com/android/role/controller/compat/AppOpsManagerCompat.java
index 8e5a768df..82873d185 100644
--- a/PermissionController/role-controller/java/com/android/role/controller/compat/AppOpsManagerCompat.java
+++ b/PermissionController/role-controller/java/com/android/role/controller/compat/AppOpsManagerCompat.java
@@ -17,10 +17,13 @@
 
 package com.android.role.controller.compat;
 
+import android.annotation.SuppressLint;
 import android.app.AppOpsManager;
+import android.os.Build;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.annotation.RequiresApi;
 
 import com.android.modules.utils.build.SdkLevel;
 
@@ -29,6 +32,11 @@ import java.util.Objects;
 /** Helper for accessing features in {@link AppOpsManager}. */
 public class AppOpsManagerCompat {
 
+    @RequiresApi(Build.VERSION_CODES.TIRAMISU)
+    @SuppressLint("NewApi")
+    public static final String OPSTR_ACCESS_RESTRICTED_SETTINGS =
+            AppOpsManager.OPSTR_ACCESS_RESTRICTED_SETTINGS;
+
     private AppOpsManagerCompat() {}
 
     /**
diff --git a/PermissionController/role-controller/java/com/android/role/controller/model/AppOp.java b/PermissionController/role-controller/java/com/android/role/controller/model/AppOp.java
index 11cfff114..1c71e0c99 100644
--- a/PermissionController/role-controller/java/com/android/role/controller/model/AppOp.java
+++ b/PermissionController/role-controller/java/com/android/role/controller/model/AppOp.java
@@ -28,6 +28,7 @@ import com.android.modules.utils.build.SdkLevel;
 import com.android.role.controller.util.PackageUtils;
 
 import java.util.Objects;
+import java.util.function.Supplier;
 
 /**
  * An app op to be granted or revoke by a {@link Role}.
@@ -40,6 +41,12 @@ public class AppOp {
     @NonNull
     private final String mName;
 
+    /**
+     * The feature flag for this app op to be granted, or {@code null} if none.
+     */
+    @Nullable
+    private final Supplier<Boolean> mFeatureFlag;
+
     /**
      * The maximum target SDK version for this app op to be granted, or {@code null} if none.
      */
@@ -56,9 +63,10 @@ public class AppOp {
      */
     private final int mMode;
 
-    public AppOp(@NonNull String name, @Nullable Integer maxTargetSdkVersion, int minSdkVersion,
-            int mode) {
+    public AppOp(@NonNull String name, @Nullable Supplier<Boolean> featureFlag,
+            @Nullable Integer maxTargetSdkVersion, int minSdkVersion, int mode) {
         mName = name;
+        mFeatureFlag = featureFlag;
         mMaxTargetSdkVersion = maxTargetSdkVersion;
         mMinSdkVersion = minSdkVersion;
         mMode = mode;
@@ -69,12 +77,17 @@ public class AppOp {
         return mName;
     }
 
+    @Nullable
+    public Supplier<Boolean> getFeatureFlag() {
+        return mFeatureFlag;
+    }
+
     @Nullable
     public Integer getMaxTargetSdkVersion() {
         return mMaxTargetSdkVersion;
     }
 
-    public int getMindSdkVersion() {
+    public int getMinSdkVersion() {
         return mMinSdkVersion;
     }
 
@@ -117,11 +130,18 @@ public class AppOp {
         return Permissions.setAppOpUidModeAsUser(packageName, mName, defaultMode, user, context);
     }
 
+    boolean isAvailableByFeatureFlagAndSdkVersion() {
+        if (mFeatureFlag != null && !mFeatureFlag.get()) {
+            return false;
+        }
+        return Build.VERSION.SDK_INT >= mMinSdkVersion
+                // Workaround to match the value 35 for V in roles.xml before SDK finalization.
+                || (mMinSdkVersion == 35 && SdkLevel.isAtLeastV());
+    }
+
     private boolean isAvailableAsUser(@NonNull String packageName,
             @NonNull UserHandle user, @NonNull Context context) {
-        if (!(Build.VERSION.SDK_INT >= mMinSdkVersion
-                // Workaround to match the value 35 for V in roles.xml before SDK finalization.
-                || (mMinSdkVersion == 35 && SdkLevel.isAtLeastV()))) {
+        if (!isAvailableByFeatureFlagAndSdkVersion()) {
             return false;
         }
         if (mMaxTargetSdkVersion == null) {
@@ -139,6 +159,7 @@ public class AppOp {
     public String toString() {
         return "AppOp{"
                 + "mName='" + mName + '\''
+                + ", mFeatureFlag=" + mFeatureFlag
                 + ", mMaxTargetSdkVersion=" + mMaxTargetSdkVersion
                 + ", mMinSdkVersion=" + mMinSdkVersion
                 + ", mMode=" + mMode
@@ -153,15 +174,16 @@ public class AppOp {
         if (object == null || getClass() != object.getClass()) {
             return false;
         }
-        AppOp appOp = (AppOp) object;
-        return mMinSdkVersion == appOp.mMinSdkVersion
-                && mMode == appOp.mMode
-                && Objects.equals(mName, appOp.mName)
-                && Objects.equals(mMaxTargetSdkVersion, appOp.mMaxTargetSdkVersion);
+        AppOp that = (AppOp) object;
+        return mMinSdkVersion == that.mMinSdkVersion
+                && mMode == that.mMode
+                && Objects.equals(mName, that.mName)
+                && Objects.equals(mFeatureFlag, that.mFeatureFlag)
+                && Objects.equals(mMaxTargetSdkVersion, that.mMaxTargetSdkVersion);
     }
 
     @Override
     public int hashCode() {
-        return Objects.hash(mName, mMaxTargetSdkVersion, mMinSdkVersion, mMode);
+        return Objects.hash(mName, mFeatureFlag, mMaxTargetSdkVersion, mMinSdkVersion, mMode);
     }
 }
diff --git a/PermissionController/role-controller/java/com/android/role/controller/model/Permission.java b/PermissionController/role-controller/java/com/android/role/controller/model/Permission.java
index f999e5972..05b19ff94 100644
--- a/PermissionController/role-controller/java/com/android/role/controller/model/Permission.java
+++ b/PermissionController/role-controller/java/com/android/role/controller/model/Permission.java
@@ -23,11 +23,13 @@ import android.os.Build;
 import android.os.UserHandle;
 
 import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
 
 import com.android.modules.utils.build.SdkLevel;
 import com.android.role.controller.util.UserUtils;
 
 import java.util.Objects;
+import java.util.function.Supplier;
 
 /**
  * A permission to be granted or revoke by a {@link Role}.
@@ -40,6 +42,12 @@ public class Permission {
     @NonNull
     private final String mName;
 
+    /**
+     * The feature flag for this permission to be granted, or {@code null} if none.
+     */
+    @Nullable
+    private final Supplier<Boolean> mFeatureFlag;
+
     /**
      * The minimum SDK version for this permission to be granted.
      */
@@ -50,8 +58,10 @@ public class Permission {
      */
     private final int mOptionalMinSdkVersion;
 
-    public Permission(@NonNull String name, int minSdkVersion, int optionalMinSdkVersion) {
+    public Permission(@NonNull String name, @Nullable Supplier<Boolean> featureFlag,
+            int minSdkVersion, int optionalMinSdkVersion) {
         mName = name;
+        mFeatureFlag = featureFlag;
         mMinSdkVersion = minSdkVersion;
         mOptionalMinSdkVersion = optionalMinSdkVersion;
     }
@@ -61,6 +71,11 @@ public class Permission {
         return mName;
     }
 
+    @Nullable
+    public Supplier<Boolean> getFeatureFlag() {
+        return mFeatureFlag;
+    }
+
     public int getMinSdkVersion() {
         return mMinSdkVersion;
     }
@@ -78,6 +93,9 @@ public class Permission {
      * @return whether this permission is available
      */
     public boolean isAvailableAsUser(@NonNull UserHandle user, @NonNull Context context) {
+        if (mFeatureFlag != null && !mFeatureFlag.get()) {
+            return false;
+        }
         if (Build.VERSION.SDK_INT >= mMinSdkVersion
                 // Workaround to match the value 35 for V in roles.xml before SDK finalization.
                 || (mMinSdkVersion == 35 && SdkLevel.isAtLeastV())) {
@@ -110,17 +128,20 @@ public class Permission {
      * @return a permission with the specified SDK versions
      */
     @NonNull
-    public Permission withSdkVersions(int minSdkVersion, int optionalMinSdkVersion) {
-        if (mMinSdkVersion == minSdkVersion && mOptionalMinSdkVersion == optionalMinSdkVersion) {
+    public Permission withFeatureFlagAndSdkVersions(@Nullable Supplier<Boolean> featureFlag,
+            int minSdkVersion, int optionalMinSdkVersion) {
+        if (mFeatureFlag == featureFlag && mMinSdkVersion == minSdkVersion
+                && mOptionalMinSdkVersion == optionalMinSdkVersion) {
             return this;
         }
-        return new Permission(mName, minSdkVersion, optionalMinSdkVersion);
+        return new Permission(mName, featureFlag, minSdkVersion, optionalMinSdkVersion);
     }
 
     @Override
     public String toString() {
         return "Permission{"
                 + "mName='" + mName + '\''
+                + ", mFeatureFlag=" + mFeatureFlag
                 + ", mMinSdkVersion=" + mMinSdkVersion
                 + ", mOptionalMinSdkVersion=" + mOptionalMinSdkVersion
                 + '}';
@@ -137,11 +158,12 @@ public class Permission {
         Permission that = (Permission) object;
         return mMinSdkVersion == that.mMinSdkVersion
                 && mOptionalMinSdkVersion == that.mOptionalMinSdkVersion
-                && mName.equals(that.mName);
+                && Objects.equals(mName, that.mName)
+                && Objects.equals(mFeatureFlag, that.mFeatureFlag);
     }
 
     @Override
     public int hashCode() {
-        return Objects.hash(mName, mMinSdkVersion, mOptionalMinSdkVersion);
+        return Objects.hash(mName, mFeatureFlag, mMinSdkVersion, mOptionalMinSdkVersion);
     }
 }
diff --git a/PermissionController/role-controller/java/com/android/role/controller/model/Role.java b/PermissionController/role-controller/java/com/android/role/controller/model/Role.java
index c3541c83b..04fd615e1 100644
--- a/PermissionController/role-controller/java/com/android/role/controller/model/Role.java
+++ b/PermissionController/role-controller/java/com/android/role/controller/model/Role.java
@@ -52,6 +52,7 @@ import java.util.ArrayList;
 import java.util.Collections;
 import java.util.List;
 import java.util.Objects;
+import java.util.function.Supplier;
 
 /**
  * Specifies a role and its properties.
@@ -117,6 +118,12 @@ public class Role {
      */
     private final boolean mFallBackToDefaultHolder;
 
+    /**
+     * The feature flag for this app op to be granted, or {@code null} if none.
+     */
+    @Nullable
+    private final Supplier<Boolean> mFeatureFlag;
+
     /**
      * The string resource for the label of this role.
      */
@@ -234,12 +241,13 @@ public class Role {
     public Role(@NonNull String name, boolean allowBypassingQualification,
             @Nullable RoleBehavior behavior, @Nullable String defaultHoldersResourceName,
             @StringRes int descriptionResource, boolean exclusive, boolean fallBackToDefaultHolder,
-            @StringRes int labelResource, int maxSdkVersion, int minSdkVersion,
-            boolean onlyGrantWhenAdded, boolean overrideUserWhenGranting,
-            @StringRes int requestDescriptionResource, @StringRes int requestTitleResource,
-            boolean requestable, @StringRes int searchKeywordsResource,
-            @StringRes int shortLabelResource, boolean showNone, boolean statik, boolean systemOnly,
-            boolean visible, @NonNull List<RequiredComponent> requiredComponents,
+            @Nullable Supplier<Boolean> featureFlag, @StringRes int labelResource,
+            int maxSdkVersion, int minSdkVersion, boolean onlyGrantWhenAdded,
+            boolean overrideUserWhenGranting, @StringRes int requestDescriptionResource,
+            @StringRes int requestTitleResource, boolean requestable,
+            @StringRes int searchKeywordsResource, @StringRes int shortLabelResource,
+            boolean showNone, boolean statik, boolean systemOnly, boolean visible,
+            @NonNull List<RequiredComponent> requiredComponents,
             @NonNull List<Permission> permissions, @NonNull List<Permission> appOpPermissions,
             @NonNull List<AppOp> appOps, @NonNull List<PreferredActivity> preferredActivities,
             @Nullable String uiBehaviorName) {
@@ -250,6 +258,7 @@ public class Role {
         mDescriptionResource = descriptionResource;
         mExclusive = exclusive;
         mFallBackToDefaultHolder = fallBackToDefaultHolder;
+        mFeatureFlag = featureFlag;
         mLabelResource = labelResource;
         mMaxSdkVersion = maxSdkVersion;
         mMinSdkVersion = minSdkVersion;
@@ -291,6 +300,11 @@ public class Role {
         return mExclusive;
     }
 
+    @Nullable
+    public Supplier<Boolean> getFeatureFlag() {
+        return mFeatureFlag;
+    }
+
     @StringRes
     public int getLabelResource() {
         return mLabelResource;
@@ -396,7 +410,7 @@ public class Role {
      * @return whether this role is available.
      */
     public boolean isAvailableAsUser(@NonNull UserHandle user, @NonNull Context context) {
-        if (!isAvailableBySdkVersion()) {
+        if (!isAvailableByFeatureFlagAndSdkVersion()) {
             return false;
         }
         if (mBehavior != null) {
@@ -410,7 +424,10 @@ public class Role {
      *
      * @return whether this role is available based on SDK version
      */
-    boolean isAvailableBySdkVersion() {
+    boolean isAvailableByFeatureFlagAndSdkVersion() {
+        if (mFeatureFlag != null && !mFeatureFlag.get()) {
+            return false;
+        }
         return (Build.VERSION.SDK_INT >= mMinSdkVersion
                 // Workaround to match the value 35 for V in roles.xml before SDK finalization.
                 || (mMinSdkVersion == 35 && SdkLevel.isAtLeastV()))
@@ -1087,6 +1104,7 @@ public class Role {
                 + ", mDescriptionResource=" + mDescriptionResource
                 + ", mExclusive=" + mExclusive
                 + ", mFallBackToDefaultHolder=" + mFallBackToDefaultHolder
+                + ", mFeatureFlag=" + mFeatureFlag
                 + ", mLabelResource=" + mLabelResource
                 + ", mMaxSdkVersion=" + mMaxSdkVersion
                 + ", mMinSdkVersion=" + mMinSdkVersion
diff --git a/PermissionController/role-controller/java/com/android/role/controller/model/RoleParser.java b/PermissionController/role-controller/java/com/android/role/controller/model/RoleParser.java
index 30a6f1638..f1a275daf 100644
--- a/PermissionController/role-controller/java/com/android/role/controller/model/RoleParser.java
+++ b/PermissionController/role-controller/java/com/android/role/controller/model/RoleParser.java
@@ -41,12 +41,15 @@ import com.android.role.controller.util.ResourceUtils;
 import org.xmlpull.v1.XmlPullParserException;
 
 import java.io.IOException;
+import java.lang.reflect.Method;
+import java.lang.reflect.Modifier;
 import java.util.ArrayList;
 import java.util.Collection;
 import java.util.Collections;
 import java.util.List;
 import java.util.Objects;
 import java.util.function.Function;
+import java.util.function.Supplier;
 
 /**
  * Parser for {@link Role} definitions.
@@ -90,6 +93,7 @@ public class RoleParser {
     private static final String ATTRIBUTE_DESCRIPTION = "description";
     private static final String ATTRIBUTE_EXCLUSIVE = "exclusive";
     private static final String ATTRIBUTE_FALL_BACK_TO_DEFAULT_HOLDER = "fallBackToDefaultHolder";
+    private static final String ATTRIBUTE_FEATURE_FLAG = "featureFlag";
     private static final String ATTRIBUTE_LABEL = "label";
     private static final String ATTRIBUTE_MAX_SDK_VERSION = "maxSdkVersion";
     private static final String ATTRIBUTE_MIN_SDK_VERSION = "minSdkVersion";
@@ -134,6 +138,21 @@ public class RoleParser {
         sModeNameToMode.put(MODE_NAME_FOREGROUND, AppOpsManager.MODE_FOREGROUND);
     }
 
+    private static final Supplier<Boolean> sFeatureFlagFallback = () -> false;
+
+    private static final ArrayMap<Class<?>, Class<?>> sPrimitiveToWrapperClass = new ArrayMap<>();
+    static {
+        sPrimitiveToWrapperClass.put(Boolean.TYPE, Boolean.class);
+        sPrimitiveToWrapperClass.put(Byte.TYPE, Byte.class);
+        sPrimitiveToWrapperClass.put(Character.TYPE, Character.class);
+        sPrimitiveToWrapperClass.put(Short.TYPE, Short.class);
+        sPrimitiveToWrapperClass.put(Integer.TYPE, Integer.class);
+        sPrimitiveToWrapperClass.put(Long.TYPE, Long.class);
+        sPrimitiveToWrapperClass.put(Float.TYPE, Float.class);
+        sPrimitiveToWrapperClass.put(Double.TYPE, Double.class);
+        sPrimitiveToWrapperClass.put(Void.TYPE, Void.class);
+    }
+
     @NonNull
     private final Context mContext;
 
@@ -273,6 +292,9 @@ public class RoleParser {
             return null;
         }
 
+        Supplier<Boolean> featureFlag = getAttributeMethodValue(parser, ATTRIBUTE_FEATURE_FLAG,
+                boolean.class, sFeatureFlagFallback, TAG_PERMISSION_SET);
+
         int minSdkVersion = getAttributeIntValue(parser, ATTRIBUTE_MIN_SDK_VERSION,
                 Build.VERSION_CODES.BASE);
         int optionalMinSdkVersion = getAttributeIntValue(parser, ATTRIBUTE_OPTIONAL_MIN_SDK_VERSION,
@@ -295,11 +317,13 @@ public class RoleParser {
                 if (permission == null) {
                     continue;
                 }
+                Supplier<Boolean> mergedFeatureFlag =
+                        mergeFeatureFlags(permission.getFeatureFlag(), featureFlag);
                 int mergedMinSdkVersion = Math.max(permission.getMinSdkVersion(), minSdkVersion);
                 int mergedOptionalMinSdkVersion = Math.max(permission.getOptionalMinSdkVersion(),
                         optionalMinSdkVersion);
-                permission = permission.withSdkVersions(mergedMinSdkVersion,
-                        mergedOptionalMinSdkVersion);
+                permission = permission.withFeatureFlagAndSdkVersions(mergedFeatureFlag,
+                        mergedMinSdkVersion, mergedOptionalMinSdkVersion);
                 validateNoDuplicateElement(permission, permissions, "permission");
                 permissions.add(permission);
             } else {
@@ -319,11 +343,16 @@ public class RoleParser {
             skipCurrentTag(parser);
             return null;
         }
+
+        Supplier<Boolean> featureFlag = getAttributeMethodValue(parser, ATTRIBUTE_FEATURE_FLAG,
+                boolean.class, sFeatureFlagFallback, TAG_PERMISSION);
+
         int minSdkVersion = getAttributeIntValue(parser, ATTRIBUTE_MIN_SDK_VERSION,
                 Build.VERSION_CODES.BASE);
         int optionalMinSdkVersion = getAttributeIntValue(parser, ATTRIBUTE_OPTIONAL_MIN_SDK_VERSION,
                 minSdkVersion);
-        return new Permission(name, minSdkVersion, optionalMinSdkVersion);
+
+        return new Permission(name, featureFlag, minSdkVersion, optionalMinSdkVersion);
     }
 
     @Nullable
@@ -394,6 +423,9 @@ public class RoleParser {
         boolean fallBackToDefaultHolder = getAttributeBooleanValue(parser,
                 ATTRIBUTE_FALL_BACK_TO_DEFAULT_HOLDER, false);
 
+        Supplier<Boolean> featureFlag = getAttributeMethodValue(parser, ATTRIBUTE_FEATURE_FLAG,
+                boolean.class, sFeatureFlagFallback, TAG_ROLE);
+
         int maxSdkVersion = getAttributeIntValue(parser, ATTRIBUTE_MAX_SDK_VERSION,
                 Build.VERSION_CODES.CUR_DEVELOPMENT);
         int minSdkVersion = getAttributeIntValue(parser, ATTRIBUTE_MIN_SDK_VERSION,
@@ -535,7 +567,7 @@ public class RoleParser {
             preferredActivities = Collections.emptyList();
         }
         return new Role(name, allowBypassingQualification, behavior, defaultHoldersResourceName,
-                descriptionResource, exclusive, fallBackToDefaultHolder, labelResource,
+                descriptionResource, exclusive, fallBackToDefaultHolder, featureFlag, labelResource,
                 maxSdkVersion, minSdkVersion, onlyGrantWhenAdded, overrideUserWhenGranting,
                 requestDescriptionResource, requestTitleResource, requestable,
                 searchKeywordsResource, shortLabelResource, showNone, statik, systemOnly, visible,
@@ -780,6 +812,9 @@ public class RoleParser {
                         throwOrLogMessage("Unknown permission set:" + permissionSetName);
                         continue;
                     }
+                    Supplier<Boolean> featureFlag = getAttributeMethodValue(parser,
+                            ATTRIBUTE_FEATURE_FLAG, boolean.class, sFeatureFlagFallback,
+                            TAG_PERMISSION_SET);
                     int minSdkVersion = getAttributeIntValue(parser, ATTRIBUTE_MIN_SDK_VERSION,
                             Build.VERSION_CODES.BASE);
                     int optionalMinSdkVersion = getAttributeIntValue(parser,
@@ -789,12 +824,14 @@ public class RoleParser {
                     for (int permissionsInSetIndex = 0;
                             permissionsInSetIndex < permissionsInSetSize; permissionsInSetIndex++) {
                         Permission permission = permissionsInSet.get(permissionsInSetIndex);
+                        Supplier<Boolean> mergedFeatureFlag =
+                                mergeFeatureFlags(permission.getFeatureFlag(), featureFlag);
                         int mergedMinSdkVersion =
                                 Math.max(permission.getMinSdkVersion(), minSdkVersion);
                         int mergedOptionalMinSdkVersion = Math.max(
                                 permission.getOptionalMinSdkVersion(), optionalMinSdkVersion);
-                        permission = permission.withSdkVersions(mergedMinSdkVersion,
-                                mergedOptionalMinSdkVersion);
+                        permission = permission.withFeatureFlagAndSdkVersions(mergedFeatureFlag,
+                                mergedMinSdkVersion, mergedOptionalMinSdkVersion);
                         // We do allow intersection between permission sets.
                         permissions.add(permission);
                     }
@@ -872,6 +909,8 @@ public class RoleParser {
                 }
                 validateNoDuplicateElement(name, appOpNames, "app op");
                 appOpNames.add(name);
+                Supplier<Boolean> featureFlag = getAttributeMethodValue(parser,
+                        ATTRIBUTE_FEATURE_FLAG, boolean.class, sFeatureFlagFallback, TAG_APP_OP);
                 Integer maxTargetSdkVersion = getAttributeIntValue(parser,
                         ATTRIBUTE_MAX_TARGET_SDK_VERSION, Integer.MIN_VALUE);
                 if (maxTargetSdkVersion == Integer.MIN_VALUE) {
@@ -893,7 +932,8 @@ public class RoleParser {
                     continue;
                 }
                 int mode = sModeNameToMode.valueAt(modeIndex);
-                AppOp appOp = new AppOp(name, maxTargetSdkVersion, minSdkVersion, mode);
+                AppOp appOp = new AppOp(name, featureFlag, maxTargetSdkVersion, minSdkVersion,
+                        mode);
                 appOps.add(appOp);
             } else {
                 throwOrLogForUnknownTag(parser);
@@ -1052,6 +1092,110 @@ public class RoleParser {
         return getAttributeResourceValue(parser, name, defaultValue);
     }
 
+    @Nullable
+    private <T> Supplier<T> getAttributeMethodValue(@NonNull XmlResourceParser parser,
+            @NonNull String name, @NonNull Class<T> returnType, @Nullable Supplier<T> fallbackValue,
+            @NonNull String tagName) {
+        String value = parser.getAttributeValue(null, name);
+        if (value == null) {
+            return null;
+        }
+        int lastDotIndex = value.lastIndexOf('.');
+        if (lastDotIndex == -1) {
+            throwOrLogMessage("Invalid method \"" + value + "\" for \"" + name + "\" on <" + tagName
+                    + ">");
+            return fallbackValue;
+        }
+        String className = applyJarjarTransform(value.substring(0, lastDotIndex));
+        String methodName = value.substring(lastDotIndex + 1);
+        Method method;
+        try {
+            Class<?> clazz = Class.forName(className);
+            method = clazz.getMethod(methodName);
+        } catch (Exception e) {
+            throwOrLogMessage("Cannot find method \"" + value + "\" for \"" + name + "\" on <"
+                    + tagName + ">", e);
+            return fallbackValue;
+        }
+        int methodModifiers = method.getModifiers();
+        if ((methodModifiers & Modifier.PUBLIC) != Modifier.PUBLIC) {
+            throwOrLogMessage("Non-public method \"" + value + "\" for \"" + name + "\" on <"
+                    + tagName + ">");
+            return fallbackValue;
+        }
+        if ((methodModifiers & Modifier.STATIC) != Modifier.STATIC) {
+            throwOrLogMessage("Non-static method \"" + value + "\" for \"" + name + "\" on <"
+                    + tagName + ">");
+            return fallbackValue;
+        }
+        Class<?> methodReturnType = method.getReturnType();
+        if (!primitiveToWrapperClass(returnType).isAssignableFrom(
+                primitiveToWrapperClass(methodReturnType))) {
+            throwOrLogMessage("Unexpected return type for method \"" + value + "\" for \""
+                    + name + "\" on <" + tagName + ">, expected:" + returnType.getName()
+                    + ", found: " + methodReturnType.getName());
+            return fallbackValue;
+        }
+        return new Supplier<T>() {
+            @Override
+            public T get() {
+                try {
+                    //noinspection unchecked
+                    return (T) method.invoke(null);
+                } catch (Exception e) {
+                    throwOrLogMessage("Failed to invoke method \"" + value + "\" for \"" + name
+                            + "\" on <" + tagName + ">", e);
+                    return fallbackValue.get();
+                }
+            }
+            @Override
+            public String toString() {
+                return "Method{name=" + value + "}";
+            }
+        };
+    }
+
+    // LINT.IfChange(applyJarjarTransform)
+    /**
+     * Simulate the jarjar transform that should happen on the class name.
+     * <p>
+     * Currently this only handles the {@code Flags} classes for feature flagging.
+     */
+    @NonNull
+    private String applyJarjarTransform(@NonNull String className) {
+        if (className.endsWith(".Flags")) {
+            String jarjarPrefix = Objects.equals(mContext.getPackageName(), "android")
+                    ? "com.android.permission.jarjar." : "com.android.permissioncontroller.jarjar.";
+            return jarjarPrefix + className;
+        }
+        return className;
+    }
+    // LINT.ThenChange()
+
+    /**
+     * Return the wrapper class for the given class if it's a primitive type, or the class itself
+     * otherwise.
+     */
+    @NonNull
+    private Class<?> primitiveToWrapperClass(@NonNull Class<?> clazz) {
+        if (clazz.isPrimitive()) {
+            return sPrimitiveToWrapperClass.get(clazz);
+        }
+        return clazz;
+    }
+
+    @Nullable
+    private Supplier<Boolean> mergeFeatureFlags(@Nullable Supplier<Boolean> featureFlag1,
+            @Nullable Supplier<Boolean> featureFlag2) {
+        if (featureFlag1 == null) {
+            return featureFlag2;
+        }
+        if (featureFlag2 == null) {
+            return featureFlag1;
+        }
+        return () -> featureFlag1.get() && featureFlag2.get();
+    }
+
     private <T> void validateNoDuplicateElement(@NonNull T element,
             @NonNull Collection<T> collection, @NonNull String name) {
         if (collection.contains(element)) {
@@ -1108,7 +1252,7 @@ public class RoleParser {
         for (int rolesIndex = 0; rolesIndex < rolesSize; rolesIndex++) {
             Role role = roles.valueAt(rolesIndex);
 
-            if (!role.isAvailableBySdkVersion()) {
+            if (!role.isAvailableByFeatureFlagAndSdkVersion()) {
                 continue;
             }
 
@@ -1223,6 +1367,9 @@ public class RoleParser {
     }
 
     private void validateAppOp(@NonNull AppOp appOp) {
+        if (!appOp.isAvailableByFeatureFlagAndSdkVersion()) {
+            return;
+        }
         // This throws IllegalArgumentException if app op is unknown.
         String permission = AppOpsManager.opToPermission(appOp.getName());
         if (permission != null) {
diff --git a/PermissionController/src/com/android/permissioncontroller/DeviceUtils.java b/PermissionController/src/com/android/permissioncontroller/DeviceUtils.java
index ec3642d1d..fb3536e1a 100644
--- a/PermissionController/src/com/android/permissioncontroller/DeviceUtils.java
+++ b/PermissionController/src/com/android/permissioncontroller/DeviceUtils.java
@@ -31,4 +31,13 @@ public class DeviceUtils {
     public static boolean isAuto(Context context) {
         return context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_AUTOMOTIVE);
     }
+
+    public static boolean isHandheld() {
+        Context context = PermissionControllerApplication.get();
+        return !isTelevision(context) && !isAuto(context) && !isWear(context);
+    }
+
+    public static boolean isHandheld(Context context) {
+        return !isTelevision(context) && !isAuto(context) && !isWear(context);
+    }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/appops/data/model/v31/DiscretePackageOpsModel.kt b/PermissionController/src/com/android/permissioncontroller/appops/data/model/v31/DiscretePackageOpsModel.kt
new file mode 100644
index 000000000..a24aff1f9
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/appops/data/model/v31/DiscretePackageOpsModel.kt
@@ -0,0 +1,44 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.appops.data.model.v31
+
+/**
+ * Data class representing historical package ops read from DiscreteRegistry, These ops are for one
+ * permission group, as the permission timeline page show one group at a time.
+ */
+data class DiscretePackageOpsModel(
+    val packageName: String,
+    val userId: Int,
+    val appOpAccesses: List<DiscreteOpModel>,
+    // some package may support attribution, in that case we want to group ops by label.
+    var attributionLabel: String? = null,
+    // variable to indicate whether the permission group is user sensitive or not.
+    var isUserSensitive: Boolean = false,
+) {
+    /**
+     * The time stamps (i.e. accessTimeMillis and durationMillis) are with precision rounded to
+     * minute.
+     */
+    data class DiscreteOpModel(
+        val opName: String,
+        val accessTimeMillis: Long,
+        val durationMillis: Long,
+        val attributionTag: String? = null,
+        val proxyPackageName: String? = null,
+        val proxyUserId: Int? = null,
+    )
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/appops/data/repository/v31/AppOpRepository.kt b/PermissionController/src/com/android/permissioncontroller/appops/data/repository/v31/AppOpRepository.kt
index 8f3286e36..3057f05e9 100644
--- a/PermissionController/src/com/android/permissioncontroller/appops/data/repository/v31/AppOpRepository.kt
+++ b/PermissionController/src/com/android/permissioncontroller/appops/data/repository/v31/AppOpRepository.kt
@@ -17,23 +17,41 @@
 package com.android.permissioncontroller.appops.data.repository.v31
 
 import android.app.AppOpsManager
+import android.app.AppOpsManager.AttributedOpEntry
+import android.app.AppOpsManager.HISTORY_FLAG_DISCRETE
+import android.app.AppOpsManager.HISTORY_FLAG_GET_ATTRIBUTION_CHAINS
+import android.app.AppOpsManager.HistoricalOps
+import android.app.AppOpsManager.HistoricalOpsRequest
+import android.app.AppOpsManager.OP_FLAG_SELF
+import android.app.AppOpsManager.OP_FLAG_TRUSTED_PROXIED
+import android.app.AppOpsManager.OP_FLAG_TRUSTED_PROXY
 import android.app.Application
-import android.content.pm.PackageManager
 import android.os.UserHandle
+import android.permission.flags.Flags
 import android.util.Log
 import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.DeviceUtils
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel.DiscreteOpModel
 import com.android.permissioncontroller.appops.data.model.v31.PackageAppOpUsageModel
 import com.android.permissioncontroller.appops.data.model.v31.PackageAppOpUsageModel.AppOpUsageModel
-import com.android.permissioncontroller.permission.data.PackageBroadcastReceiver
+import com.android.permissioncontroller.data.repository.v31.AppOpChangeListener
+import com.android.permissioncontroller.data.repository.v31.PackageChangeListener
+import com.android.permissioncontroller.data.repository.v31.PermissionChangeListener
 import com.android.permissioncontroller.permission.data.repository.v31.PermissionRepository
 import com.android.permissioncontroller.permission.utils.PermissionMapping
+import java.util.concurrent.TimeUnit
 import kotlin.concurrent.Volatile
+import kotlin.coroutines.suspendCoroutine
 import kotlinx.coroutines.CoroutineDispatcher
+import kotlinx.coroutines.CoroutineScope
 import kotlinx.coroutines.Dispatchers
+import kotlinx.coroutines.Job
 import kotlinx.coroutines.channels.awaitClose
 import kotlinx.coroutines.flow.Flow
 import kotlinx.coroutines.flow.callbackFlow
 import kotlinx.coroutines.flow.flowOn
+import kotlinx.coroutines.launch
 
 /**
  * This repository encapsulate app op data (i.e. app op usage, app op mode, historical ops etc.)
@@ -48,6 +66,17 @@ interface AppOpRepository {
      */
     val packageAppOpsUsages: Flow<List<PackageAppOpUsageModel>>
 
+    /**
+     * Returns a flow of discrete package ops.
+     *
+     * @param opNames A list of app op names.
+     * @param coroutineScope the coroutine scope where we fetch the data asynchronously.
+     */
+    fun getDiscreteOps(
+        opNames: List<String>,
+        coroutineScope: CoroutineScope
+    ): Flow<List<DiscretePackageOpsModel>>
+
     companion object {
         @Volatile private var instance: AppOpRepository? = null
 
@@ -73,91 +102,112 @@ class AppOpRepositoryImpl(
 
     private val appOpNames = getPrivacyDashboardAppOpNames()
 
-    override val packageAppOpsUsages by lazy {
-        callbackFlow {
-                send(getPackageOps())
-
-                // Suppress OnOpNotedListener lint error, startWatchingNoted is behind sdk check.
-                @SuppressWarnings("NewApi")
-                val callback =
-                    object :
-                        PackageManager.OnPermissionsChangedListener,
-                        PackageBroadcastReceiver.PackageBroadcastListener,
-                        AppOpsManager.OnOpActiveChangedListener,
-                        AppOpsManager.OnOpNotedListener,
-                        AppOpsManager.OnOpChangedListener {
-                        override fun onPermissionsChanged(uid: Int) {
-                            sendUpdate()
-                        }
+    override fun getDiscreteOps(
+        opNames: List<String>,
+        coroutineScope: CoroutineScope
+    ): Flow<List<DiscretePackageOpsModel>> {
+        return callbackFlow {
+                var job: Job? = null
+                send(getDiscreteOps(opNames))
 
-                        override fun onOpChanged(op: String?, packageName: String?) {
-                            sendUpdate()
-                        }
-
-                        override fun onPackageUpdate(packageName: String) {
-                            sendUpdate()
-                        }
-
-                        override fun onOpActiveChanged(
-                            op: String,
-                            uid: Int,
-                            packageName: String,
-                            active: Boolean
-                        ) {
-                            sendUpdate()
-                        }
+                fun sendUpdate() {
+                    if (job == null || job?.isActive == false) {
+                        job = coroutineScope.launch { trySend(getDiscreteOps(opNames)) }
+                    }
+                }
 
-                        override fun onOpNoted(
-                            op: String,
-                            uid: Int,
-                            packageName: String,
-                            attributionTag: String?,
-                            flags: Int,
-                            result: Int
-                        ) {
-                            sendUpdate()
-                        }
+                val appOpListener =
+                    AppOpChangeListener(opNames.toSet(), appOpsManager) { sendUpdate() }
+                val packageListener = PackageChangeListener { sendUpdate() }
+                val permissionListener = PermissionChangeListener(packageManager) { sendUpdate() }
+                packageListener.register()
+                appOpListener.register()
+                permissionListener.register()
+                awaitClose {
+                    appOpListener.unregister()
+                    packageListener.unregister()
+                    permissionListener.unregister()
+                }
+            }
+            .flowOn(dispatcher)
+    }
 
-                        fun sendUpdate() {
-                            trySend(getPackageOps())
+    private suspend fun getDiscreteOps(opNames: List<String>): List<DiscretePackageOpsModel> {
+        val duration =
+            if (DeviceUtils.isHandheld()) TimeUnit.DAYS.toMillis(7) else TimeUnit.DAYS.toMillis(1)
+        val currentTime = System.currentTimeMillis()
+        val beginTimeMillis = currentTime - duration
+        val request =
+            HistoricalOpsRequest.Builder(beginTimeMillis, currentTime)
+                .setFlags(OP_FLAG_SELF or OP_FLAG_TRUSTED_PROXIED)
+                .setOpNames(opNames)
+                .setHistoryFlags(HISTORY_FLAG_DISCRETE or HISTORY_FLAG_GET_ATTRIBUTION_CHAINS)
+                .build()
+        val historicalOps: HistoricalOps = suspendCoroutine {
+            appOpsManager.getHistoricalOps(request, { it.run() }) { ops: HistoricalOps ->
+                it.resumeWith(Result.success(ops))
+            }
+        }
+        val discreteOpsResult = mutableListOf<DiscretePackageOpsModel>()
+        // Read through nested (uid -> package name -> attribution tag -> op -> discrete events)
+        // historical ops data structure
+        for (uidIndex in 0 until historicalOps.uidCount) {
+            val historicalUidOps = historicalOps.getUidOpsAt(uidIndex)
+            val userId = UserHandle.getUserHandleForUid(historicalUidOps.uid).identifier
+            for (packageIndex in 0 until historicalUidOps.packageCount) {
+                val historicalPackageOps = historicalUidOps.getPackageOpsAt(packageIndex)
+                val packageName = historicalPackageOps.packageName
+                val appOpEvents = mutableListOf<DiscreteOpModel>()
+                for (tagIndex in 0 until historicalPackageOps.attributedOpsCount) {
+                    val attributedHistoricalOps = historicalPackageOps.getAttributedOpsAt(tagIndex)
+                    for (opIndex in 0 until attributedHistoricalOps.opCount) {
+                        val historicalOp = attributedHistoricalOps.getOpAt(opIndex)
+                        for (index in 0 until historicalOp.discreteAccessCount) {
+                            val attributedOpEntry: AttributedOpEntry =
+                                historicalOp.getDiscreteAccessAt(index)
+                            val proxy = attributedOpEntry.getLastProxyInfo(OPS_LAST_ACCESS_FLAGS)
+                            val opEvent =
+                                DiscreteOpModel(
+                                    opName = historicalOp.opName,
+                                    accessTimeMillis =
+                                        attributedOpEntry.getLastAccessTime(OPS_LAST_ACCESS_FLAGS),
+                                    durationMillis =
+                                        attributedOpEntry.getLastDuration(OPS_LAST_ACCESS_FLAGS),
+                                    attributionTag = attributedHistoricalOps.tag,
+                                    proxyPackageName = proxy?.packageName,
+                                    proxyUserId =
+                                        proxy?.uid?.let {
+                                            UserHandle.getUserHandleForUid(it).identifier
+                                        },
+                                )
+                            appOpEvents.add(opEvent)
                         }
                     }
+                }
+                discreteOpsResult.add(DiscretePackageOpsModel(packageName, userId, appOpEvents))
+            }
+        }
+        return discreteOpsResult
+    }
 
-                packageManager.addOnPermissionsChangeListener(callback)
-                PackageBroadcastReceiver.addAllCallback(callback)
-                appOpNames.forEach { opName ->
-                    // TODO(b/262035952): We watch each active op individually as
-                    //  startWatchingActive only registers the callback if all ops are valid.
-                    //  Fix this behavior so if one op is invalid it doesn't affect the other ops.
-                    try {
-                        appOpsManager.startWatchingActive(arrayOf(opName), { it.run() }, callback)
-                    } catch (ignored: IllegalArgumentException) {
-                        // Older builds may not support all requested app ops.
-                    }
-
-                    try {
-                        appOpsManager.startWatchingMode(opName, /* all packages */ null, callback)
-                    } catch (ignored: IllegalArgumentException) {
-                        // Older builds may not support all requested app ops.
-                    }
+    override val packageAppOpsUsages by lazy {
+        callbackFlow {
+                send(getPackageOps())
 
-                    if (SdkLevel.isAtLeastU()) {
-                        try {
-                            appOpsManager.startWatchingNoted(arrayOf(opName), callback)
-                        } catch (ignored: IllegalArgumentException) {
-                            // Older builds may not support all requested app ops.
-                        }
-                    }
+                fun sendUpdate() {
+                    trySend(getPackageOps())
                 }
 
+                val appOpListener = AppOpChangeListener(appOpNames, appOpsManager) { sendUpdate() }
+                val packageListener = PackageChangeListener { sendUpdate() }
+                val permissionListener = PermissionChangeListener(packageManager) { sendUpdate() }
+                packageListener.register()
+                appOpListener.register()
+                permissionListener.register()
                 awaitClose {
-                    packageManager.removeOnPermissionsChangeListener(callback)
-                    PackageBroadcastReceiver.removeAllCallback(callback)
-                    appOpsManager.stopWatchingActive(callback)
-                    appOpsManager.stopWatchingMode(callback)
-                    if (SdkLevel.isAtLeastU()) {
-                        appOpsManager.stopWatchingNoted(callback)
-                    }
+                    appOpListener.unregister()
+                    packageListener.unregister()
+                    permissionListener.unregister()
                 }
             }
             .flowOn(dispatcher)
@@ -202,6 +252,9 @@ class AppOpRepositoryImpl(
         if (SdkLevel.isAtLeastT()) {
             opNames.add(AppOpsManager.OPSTR_RECEIVE_AMBIENT_TRIGGER_AUDIO)
         }
+        if (SdkLevel.isAtLeastV() && Flags.locationBypassPrivacyDashboardEnabled()) {
+            opNames.add(AppOpsManager.OPSTR_EMERGENCY_LOCATION)
+        }
         return opNames
     }
 
@@ -209,8 +262,6 @@ class AppOpRepositoryImpl(
         private const val LOG_TAG = "AppOpUsageRepository"
 
         private const val OPS_LAST_ACCESS_FLAGS =
-            AppOpsManager.OP_FLAG_SELF or
-                AppOpsManager.OP_FLAG_TRUSTED_PROXIED or
-                AppOpsManager.OP_FLAG_TRUSTED_PROXY
+            OP_FLAG_SELF or OP_FLAG_TRUSTED_PROXIED or OP_FLAG_TRUSTED_PROXY
     }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/appops/data/repository/v31/package-info.java b/PermissionController/src/com/android/permissioncontroller/appops/data/repository/v31/package-info.java
new file mode 100644
index 000000000..c51eab598
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/appops/data/repository/v31/package-info.java
@@ -0,0 +1,18 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+@androidx.annotation.RequiresApi(android.os.Build.VERSION_CODES.S)
+package com.android.permissioncontroller.appops.data.repository.v31;
diff --git a/PermissionController/src/com/android/permissioncontroller/data/repository/v31/RepositoryListeners.kt b/PermissionController/src/com/android/permissioncontroller/data/repository/v31/RepositoryListeners.kt
new file mode 100644
index 000000000..7c61a1f82
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/data/repository/v31/RepositoryListeners.kt
@@ -0,0 +1,121 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.data.repository.v31
+
+import android.app.AppOpsManager
+import android.content.pm.PackageManager
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.permission.data.PackageBroadcastReceiver
+
+class PermissionChangeListener(
+    private val packageManager: PackageManager,
+    private val callback: () -> Unit
+) : PackageManager.OnPermissionsChangedListener {
+    fun register() {
+        packageManager.addOnPermissionsChangeListener(this)
+    }
+
+    fun unregister() {
+        packageManager.removeOnPermissionsChangeListener(this)
+    }
+
+    override fun onPermissionsChanged(uid: Int) {
+        callback()
+    }
+}
+
+class PackageChangeListener(private val callback: () -> Unit) :
+    PackageBroadcastReceiver.PackageBroadcastListener {
+
+    fun register() {
+        PackageBroadcastReceiver.addAllCallback(this)
+    }
+
+    fun unregister() {
+        PackageBroadcastReceiver.removeAllCallback(this)
+    }
+
+    override fun onPackageUpdate(packageName: String) {
+        callback()
+    }
+}
+
+// Suppress OnOpNotedListener, it was introduced in Q but became System API in U.
+@SuppressWarnings("NewApi")
+class AppOpChangeListener(
+    private val opNames: Set<String>,
+    private val appOpsManager: AppOpsManager,
+    private val callback: () -> Unit
+) :
+    AppOpsManager.OnOpChangedListener,
+    AppOpsManager.OnOpNotedListener,
+    AppOpsManager.OnOpActiveChangedListener {
+
+    fun register() {
+        opNames.forEach { opName ->
+            // TODO(b/262035952): We watch each active op individually as
+            //  startWatchingActive only registers the callback if all ops are valid.
+            //  Fix this behavior so if one op is invalid it doesn't affect the other ops.
+            try {
+                appOpsManager.startWatchingActive(arrayOf(opName), { it.run() }, this)
+            } catch (ignored: IllegalArgumentException) {
+                // Older builds may not support all requested app ops.
+            }
+
+            try {
+                appOpsManager.startWatchingMode(opName, /* all packages */ null, this)
+            } catch (ignored: IllegalArgumentException) {
+                // Older builds may not support all requested app ops.
+            }
+
+            if (SdkLevel.isAtLeastU()) {
+                try {
+                    appOpsManager.startWatchingNoted(arrayOf(opName), this)
+                } catch (ignored: IllegalArgumentException) {
+                    // Older builds may not support all requested app ops.
+                }
+            }
+        }
+    }
+
+    fun unregister() {
+        appOpsManager.stopWatchingActive(this)
+        appOpsManager.stopWatchingMode(this)
+        if (SdkLevel.isAtLeastU()) {
+            appOpsManager.stopWatchingNoted(this)
+        }
+    }
+
+    override fun onOpChanged(op: String?, packageName: String?) {
+        callback()
+    }
+
+    override fun onOpNoted(
+        op: String,
+        uid: Int,
+        packageName: String,
+        attributionTag: String?,
+        flags: Int,
+        result: Int
+    ) {
+        callback()
+    }
+
+    override fun onOpActiveChanged(op: String, uid: Int, packageName: String, active: Boolean) {
+        callback()
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/ecm/EnhancedConfirmationDialogActivity.kt b/PermissionController/src/com/android/permissioncontroller/ecm/EnhancedConfirmationDialogActivity.kt
index e813b782a..bc6f774ad 100644
--- a/PermissionController/src/com/android/permissioncontroller/ecm/EnhancedConfirmationDialogActivity.kt
+++ b/PermissionController/src/com/android/permissioncontroller/ecm/EnhancedConfirmationDialogActivity.kt
@@ -40,8 +40,10 @@ import androidx.fragment.app.DialogFragment
 import androidx.fragment.app.FragmentActivity
 import com.android.modules.utils.build.SdkLevel
 import com.android.permissioncontroller.Constants.EXTRA_IS_ECM_IN_APP
+import com.android.permissioncontroller.DeviceUtils
 import com.android.permissioncontroller.R
 import com.android.permissioncontroller.ecm.EnhancedConfirmationStatsLogUtils.DialogResult
+import com.android.permissioncontroller.permission.ui.wear.WearEnhancedConfirmationDialogFragment
 import com.android.permissioncontroller.permission.utils.KotlinUtils
 import com.android.permissioncontroller.permission.utils.PermissionMapping
 import com.android.permissioncontroller.permission.utils.Utils
@@ -82,9 +84,13 @@ class EnhancedConfirmationDialogActivity : FragmentActivity() {
             setClearRestrictionAllowed(packageName, UserHandle.getUserHandleForUid(uid))
 
         val setting = Setting.fromIdentifier(this, settingIdentifier, isEcmInApp)
-        val dialogFragment =
+        if (DeviceUtils.isWear(this)) {
+            WearEnhancedConfirmationDialogFragment.newInstance(setting.title, setting.message)
+                .show(supportFragmentManager, WearEnhancedConfirmationDialogFragment.TAG)
+        } else {
             EnhancedConfirmationDialogFragment.newInstance(setting.title, setting.message)
-        dialogFragment.show(supportFragmentManager, EnhancedConfirmationDialogFragment.TAG)
+                .show(supportFragmentManager, EnhancedConfirmationDialogFragment.TAG)
+        }
     }
 
     override fun onSaveInstanceState(outState: Bundle) {
@@ -178,7 +184,7 @@ class EnhancedConfirmationDialogActivity : FragmentActivity() {
         }
     }
 
-    private fun onDialogResult(dialogResult: DialogResult) {
+    fun onDialogResult(dialogResult: DialogResult) {
         this.dialogResult = dialogResult
         setResult(
             RESULT_OK,
diff --git a/PermissionController/src/com/android/permissioncontroller/hibernation/HibernationPolicy.kt b/PermissionController/src/com/android/permissioncontroller/hibernation/HibernationPolicy.kt
index d0e97f365..d23225ed3 100644
--- a/PermissionController/src/com/android/permissioncontroller/hibernation/HibernationPolicy.kt
+++ b/PermissionController/src/com/android/permissioncontroller/hibernation/HibernationPolicy.kt
@@ -42,6 +42,7 @@ import android.app.usage.UsageStatsManager.INTERVAL_DAILY
 import android.app.usage.UsageStatsManager.INTERVAL_MONTHLY
 import android.content.BroadcastReceiver
 import android.content.ComponentName
+import android.content.ContentResolver
 import android.content.Context
 import android.content.Intent
 import android.content.Intent.FLAG_ACTIVITY_NEW_TASK
@@ -49,6 +50,8 @@ import android.content.Intent.FLAG_RECEIVER_FOREGROUND
 import android.content.SharedPreferences
 import android.content.pm.PackageManager
 import android.content.pm.PackageManager.PERMISSION_GRANTED
+import android.database.ContentObserver
+import android.net.Uri
 import android.os.Build
 import android.os.Bundle
 import android.os.Process
@@ -59,6 +62,7 @@ import android.printservice.PrintService
 import android.provider.DeviceConfig
 import android.provider.DeviceConfig.NAMESPACE_APP_HIBERNATION
 import android.provider.Settings
+import android.provider.Settings.Secure.USER_SETUP_COMPLETE
 import android.safetycenter.SafetyCenterManager
 import android.safetycenter.SafetyEvent
 import android.safetycenter.SafetySourceData
@@ -105,13 +109,13 @@ import com.android.permissioncontroller.permission.utils.KotlinUtils
 import com.android.permissioncontroller.permission.utils.StringUtils
 import com.android.permissioncontroller.permission.utils.Utils
 import com.android.permissioncontroller.permission.utils.forEachInParallel
-import java.util.Date
-import java.util.Random
-import java.util.concurrent.TimeUnit
 import kotlinx.coroutines.Dispatchers.Main
 import kotlinx.coroutines.GlobalScope
 import kotlinx.coroutines.Job
 import kotlinx.coroutines.launch
+import java.util.Date
+import java.util.Random
+import java.util.concurrent.TimeUnit
 
 private const val LOG_TAG = "HibernationPolicy"
 const val DEBUG_OVERRIDE_THRESHOLDS = false
@@ -144,7 +148,7 @@ private fun getCheckFrequencyMs() =
 // Intentionally kept value of the key same as before because we want to continue reading value of
 // this shared preference stored by previous versions of PermissionController
 const val PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING = "first_boot_time"
-const val PREF_KEY_BOOT_TIME_SNAPSHOT = "ah_boot_time_snapshot"
+const val PREF_KEY_SYSTEM_TIME_SNAPSHOT = "ah_boot_time_snapshot"
 const val PREF_KEY_ELAPSED_REALTIME_SNAPSHOT = "ah_elapsed_realtime_snapshot"
 
 private const val PREFS_FILE_NAME = "unused_apps_prefs"
@@ -274,7 +278,29 @@ class HibernationBroadcastReceiver : BroadcastReceiver() {
 
     override fun onReceive(context: Context, intent: Intent) {
         val action = intent.action
+        val contentResolver = context.contentResolver
         if (action == Intent.ACTION_BOOT_COMPLETED || action == ACTION_SET_UP_HIBERNATION) {
+            if (isUserSetupComplete(contentResolver)) {
+                maybeInitStartTimeUnusedAppTracking(context.sharedPreferences)
+            } else {
+                // User set-up is not complete. Delay this until it is.
+                // This is best-effort as the process may be killed before set-up completes
+                // which prevents this callback from being called.
+                // In that case, unused app tracking will instead start when the job first runs
+                contentResolver.registerContentObserver(
+                    Settings.Secure.getUriFor(USER_SETUP_COMPLETE),
+                    /* notifyForDescendants= */ false,
+                    object : ContentObserver(/* handler= */ null) {
+                        override fun onChange(selfChange: Boolean, uri: Uri?) {
+                            if (uri == Settings.Secure.getUriFor(USER_SETUP_COMPLETE)
+                                && isUserSetupComplete(contentResolver)) {
+                                contentResolver.unregisterContentObserver(this)
+                                maybeInitStartTimeUnusedAppTracking(context.sharedPreferences)
+                            }
+                        }
+                    }
+                )
+            }
             if (DEBUG_HIBERNATION_POLICY) {
                 DumpableLog.i(
                     LOG_TAG,
@@ -284,7 +310,7 @@ class HibernationBroadcastReceiver : BroadcastReceiver() {
                 )
             }
 
-            initStartTimeOfUnusedAppTracking(context.sharedPreferences)
+            setSystemTimeSnapshots(context.sharedPreferences)
 
             // If this user is a profile, then its hibernation/auto-revoke will be handled by the
             // primary user
@@ -329,7 +355,7 @@ class HibernationBroadcastReceiver : BroadcastReceiver() {
             }
         }
         if (action == Intent.ACTION_TIME_CHANGED || action == Intent.ACTION_TIMEZONE_CHANGED) {
-            adjustStartTimeOfUnusedAppTracking(context.sharedPreferences)
+            adjustSnapshotTimes(context.sharedPreferences)
         }
     }
 
@@ -764,7 +790,7 @@ internal class SystemTime {
 private fun getSystemTime(sharedPreferences: SharedPreferences): SystemTime {
     val systemTime = SystemTime()
     val systemTimeSnapshot =
-        sharedPreferences.getLong(PREF_KEY_BOOT_TIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
+        sharedPreferences.getLong(PREF_KEY_SYSTEM_TIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
     if (systemTimeSnapshot == SNAPSHOT_UNINITIALIZED) {
         DumpableLog.e(LOG_TAG, "PREF_KEY_BOOT_TIME_SNAPSHOT is not initialized")
         return systemTime
@@ -803,7 +829,7 @@ fun getStartTimeOfUnusedAppTracking(sharedPreferences: SharedPreferences): Long
     val diffSystemTime = getSystemTime(sharedPreferences).diffSystemTime
     // If the value stored is older than a day adjust start time.
     if (diffSystemTime > ONE_DAY_MS) {
-        adjustStartTimeOfUnusedAppTracking(sharedPreferences)
+        adjustSnapshotTimes(sharedPreferences)
     }
     return sharedPreferences.getLong(
         PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING,
@@ -811,7 +837,10 @@ fun getStartTimeOfUnusedAppTracking(sharedPreferences: SharedPreferences): Long
     )
 }
 
-private fun initStartTimeOfUnusedAppTracking(sharedPreferences: SharedPreferences) {
+/**
+ * Init the start time of unused apps tracking if it has not been initialized before
+ */
+private fun maybeInitStartTimeUnusedAppTracking(sharedPreferences: SharedPreferences) {
     val systemTimeSnapshot = System.currentTimeMillis()
     if (
         sharedPreferences.getLong(
@@ -824,33 +853,43 @@ private fun initStartTimeOfUnusedAppTracking(sharedPreferences: SharedPreference
             .putLong(PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING, systemTimeSnapshot)
             .apply()
     }
+}
+
+private fun setSystemTimeSnapshots(sharedPreferences: SharedPreferences) {
+    val systemTimeSnapshot = System.currentTimeMillis()
     val realtimeSnapshot = SystemClock.elapsedRealtime()
     sharedPreferences
         .edit()
-        .putLong(PREF_KEY_BOOT_TIME_SNAPSHOT, systemTimeSnapshot)
+        .putLong(PREF_KEY_SYSTEM_TIME_SNAPSHOT, systemTimeSnapshot)
         .putLong(PREF_KEY_ELAPSED_REALTIME_SNAPSHOT, realtimeSnapshot)
         .apply()
 }
 
-private fun adjustStartTimeOfUnusedAppTracking(sharedPreferences: SharedPreferences) {
+private fun adjustSnapshotTimes(sharedPreferences: SharedPreferences) {
     val systemTime = getSystemTime(sharedPreferences)
+    val editor = sharedPreferences
+        .edit()
+        .putLong(PREF_KEY_SYSTEM_TIME_SNAPSHOT, systemTime.actualSystemTime)
+        .putLong(PREF_KEY_ELAPSED_REALTIME_SNAPSHOT, systemTime.actualRealtime)
+
     val startTimeOfUnusedAppTracking =
         sharedPreferences.getLong(
             PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING,
             SNAPSHOT_UNINITIALIZED
         )
     if (startTimeOfUnusedAppTracking == SNAPSHOT_UNINITIALIZED) {
-        DumpableLog.e(LOG_TAG, "PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING is not initialized")
-        return
+        DumpableLog.w(LOG_TAG, "PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING is not initialized")
+    } else {
+        val adjustedStartTimeOfUnusedAppTracking =
+                startTimeOfUnusedAppTracking + systemTime.diffSystemTime
+        editor.putLong(PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING,
+                adjustedStartTimeOfUnusedAppTracking)
     }
-    val adjustedStartTimeOfUnusedAppTracking =
-        startTimeOfUnusedAppTracking + systemTime.diffSystemTime
-    sharedPreferences
-        .edit()
-        .putLong(PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING, adjustedStartTimeOfUnusedAppTracking)
-        .putLong(PREF_KEY_BOOT_TIME_SNAPSHOT, systemTime.actualSystemTime)
-        .putLong(PREF_KEY_ELAPSED_REALTIME_SNAPSHOT, systemTime.actualRealtime)
-        .apply()
+    editor.apply()
+}
+
+private fun isUserSetupComplete(contentResolver: ContentResolver): Boolean {
+    return Settings.Secure.getInt(contentResolver, USER_SETUP_COMPLETE, 0) != 0
 }
 
 /** Make intent to go to unused apps page. */
@@ -901,6 +940,16 @@ class HibernationJobService : JobService() {
             DumpableLog.i(LOG_TAG, "onStartJob")
         }
 
+        if (!isUserSetupComplete(contentResolver)) {
+            if (DEBUG_HIBERNATION_POLICY) {
+                DumpableLog.i(LOG_TAG, "Skipping hibernation job because set-up is not complete")
+            }
+            jobFinished(params, /* wantsReschedule= */ true)
+            return true
+        }
+
+        maybeInitStartTimeUnusedAppTracking(sharedPreferences)
+
         if (SKIP_NEXT_RUN) {
             SKIP_NEXT_RUN = false
             if (DEBUG_HIBERNATION_POLICY) {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/TEST_MAPPING b/PermissionController/src/com/android/permissioncontroller/permission/TEST_MAPPING
index 7ec419864..a94f84f60 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/TEST_MAPPING
+++ b/PermissionController/src/com/android/permissioncontroller/permission/TEST_MAPPING
@@ -1,30 +1,7 @@
 {
     "presubmit": [
         {
-            "name": "CtsPermissionTestCases",
-            "options": [
-                {
-                    "include-filter": "android.permission.cts.BackgroundPermissionsTest"
-                },
-                {
-                    "include-filter": "android.permission.cts.LocationAccessCheckTest"
-                },
-                {
-                    "include-filter": "android.permission.cts.NotificationListenerCheckTest"
-                },
-                {
-                    "include-filter": "android.permission.cts.OneTimePermissionTest"
-                },
-                {
-                    "include-filter": "android.permission.cts.PermissionControllerTest"
-                },
-                {
-                    "include-filter": "android.permission.cts.PlatformPermissionGroupMappingTest"
-                },
-                {
-                    "exclude-annotation": "androidx.test.filters.FlakyTest"
-                }
-            ]
+            "name": "CtsPermissionTestCases_PermissionController"
         },
         {
             "name": "CtsHibernationTestCases",
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/compat/AppPermissionFragmentCompat.java b/PermissionController/src/com/android/permissioncontroller/permission/compat/AppPermissionFragmentCompat.java
new file mode 100644
index 000000000..188e3a9d0
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/compat/AppPermissionFragmentCompat.java
@@ -0,0 +1,84 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.compat;
+
+import static com.android.permissioncontroller.Constants.EXTRA_SESSION_ID;
+import static com.android.permissioncontroller.permission.ui.ManagePermissionsActivity.EXTRA_CALLER_NAME;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.os.UserHandle;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.preference.PreferenceFragmentCompat;
+
+import com.android.modules.utils.build.SdkLevel;
+import com.android.permission.flags.Flags;
+import com.android.permissioncontroller.permission.ui.handheld.max35.LegacyAppPermissionFragment;
+import com.android.permissioncontroller.permission.ui.handheld.v36.AppPermissionFragment;
+
+/** Helper methods for AppPermissionFragment across SDKs for compatibility. */
+public class AppPermissionFragmentCompat {
+    public static final String GRANT_CATEGORY = "grant_category";
+    public static final String PERSISTENT_DEVICE_ID = "persistent_device_id";
+
+    /**
+     * Create an instance of this fragment
+     */
+    @NonNull
+    public static PreferenceFragmentCompat createFragment() {
+        if (SdkLevel.isAtLeastV() && Flags.appPermissionFragmentUsesPreferences()) {
+            return new AppPermissionFragment();
+        } else {
+            return new LegacyAppPermissionFragment();
+        }
+    }
+
+    /**
+     * Create a bundle with the arguments needed by this fragment
+     *
+     * @param packageName   The name of the package
+     * @param permName      The name of the permission whose group this fragment is for (optional)
+     * @param groupName     The name of the permission group (required if permName not specified)
+     * @param userHandle    The user of the app permission group
+     * @param caller        The name of the fragment we called from
+     * @param sessionId     The current session ID
+     * @param grantCategory The grant status of this app permission group. Used to initially set
+     *                      the button state
+     * @param persistentDeviceId A persistent device ID (optional)
+     * @return A bundle with all of the args placed
+     */
+    public static Bundle createArgs(@NonNull String packageName,
+            @Nullable String permName, @Nullable String groupName,
+            @NonNull UserHandle userHandle, @Nullable String caller, long sessionId,
+            @Nullable String grantCategory, @Nullable String persistentDeviceId) {
+        Bundle arguments = new Bundle();
+        arguments.putString(Intent.EXTRA_PACKAGE_NAME, packageName);
+        if (groupName == null) {
+            arguments.putString(Intent.EXTRA_PERMISSION_NAME, permName);
+        } else {
+            arguments.putString(Intent.EXTRA_PERMISSION_GROUP_NAME, groupName);
+        }
+        arguments.putParcelable(Intent.EXTRA_USER, userHandle);
+        arguments.putString(EXTRA_CALLER_NAME, caller);
+        arguments.putLong(EXTRA_SESSION_ID, sessionId);
+        arguments.putString(GRANT_CATEGORY, grantCategory);
+        arguments.putString(PERSISTENT_DEVICE_ID, persistentDeviceId);
+        return arguments;
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/data/LightPermInfoLiveData.kt b/PermissionController/src/com/android/permissioncontroller/permission/data/LightPermInfoLiveData.kt
index 091c45b92..68aa55e14 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/data/LightPermInfoLiveData.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/data/LightPermInfoLiveData.kt
@@ -67,7 +67,7 @@ private constructor(private val app: Application, private val permissionName: St
 
         val newValue =
             try {
-                LightPermInfo(app.packageManager.getPermissionInfo(permissionName, 0))
+                LightPermInfo(app.packageManager.getPermissionInfo(permissionName, 0), null)
             } catch (e: PackageManager.NameNotFoundException) {
                 Log.w(LOG_TAG, "Permission \"$permissionName\" not found")
                 invalidateSingle(permissionName)
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/data/PermGroupLiveData.kt b/PermissionController/src/com/android/permissioncontroller/permission/data/PermGroupLiveData.kt
index d44fea233..e923746d7 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/data/PermGroupLiveData.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/data/PermGroupLiveData.kt
@@ -17,6 +17,7 @@
 package com.android.permissioncontroller.permission.data
 
 import android.app.Application
+import android.content.pm.ApplicationInfo
 import android.content.pm.PackageItemInfo
 import android.content.pm.PackageManager
 import android.content.pm.PermissionGroupInfo
@@ -64,7 +65,6 @@ private constructor(private val app: Application, private val groupName: String)
      */
     override fun onUpdate() {
         val permissionInfos = mutableMapOf<String, LightPermInfo>()
-
         groupInfo =
             Utils.getGroupInfo(groupName, context)
                 ?: run {
@@ -73,28 +73,25 @@ private constructor(private val app: Application, private val groupName: String)
                     value = null
                     return
                 }
-
+        val permInfos = mutableListOf<PermissionInfo>()
         when (groupInfo) {
             is PermissionGroupInfo -> {
-                val permInfos =
-                    try {
+                try {
+                    permInfos.addAll(
                         Utils.getInstalledRuntimePermissionInfosForGroup(
                             context.packageManager,
                             groupName
                         )
-                    } catch (e: PackageManager.NameNotFoundException) {
-                        Log.e(LOG_TAG, "Invalid permission group $groupName")
-                        invalidateSingle(groupName)
-                        value = null
-                        return
-                    }
-
-                for (permInfo in permInfos) {
-                    permissionInfos[permInfo.name] = LightPermInfo(permInfo)
+                    )
+                } catch (e: PackageManager.NameNotFoundException) {
+                    Log.e(LOG_TAG, "Invalid permission group $groupName")
+                    invalidateSingle(groupName)
+                    value = null
+                    return
                 }
             }
             is PermissionInfo -> {
-                permissionInfos[groupInfo.name] = LightPermInfo(groupInfo as PermissionInfo)
+                permInfos.add(groupInfo as PermissionInfo)
             }
             else -> {
                 value = null
@@ -102,19 +99,25 @@ private constructor(private val app: Application, private val groupName: String)
             }
         }
 
-        val permGroup = PermGroup(LightPermGroupInfo(groupInfo), permissionInfos)
-
-        value = permGroup
-
-        val packageNames =
-            permissionInfos.values.map { permInfo -> permInfo.packageName }.toMutableSet()
+        val packageNames = permInfos.map { permInfo -> permInfo.packageName }.toMutableSet()
         packageNames.add(groupInfo.packageName)
-
         // TODO ntmyren: What if the package isn't installed for the system user?
         val getLiveData = { packageName: String ->
             LightPackageInfoLiveData[packageName, UserHandle.SYSTEM]
         }
         setSourcesToDifference(packageNames, packageLiveDatas, getLiveData)
+        if (!packageLiveDatas.all { it.value.isInitialized }) {
+            return
+        }
+        for (permInfo in permInfos) {
+            val lightPackageInfo = packageLiveDatas[permInfo.packageName]?.value
+            val isSystem =
+                lightPackageInfo?.let { it.appFlags and ApplicationInfo.FLAG_SYSTEM != 0 }
+            permissionInfos[permInfo.name] = LightPermInfo(permInfo, isSystem)
+        }
+
+        val permGroup = PermGroup(LightPermGroupInfo(groupInfo), permissionInfos)
+        value = permGroup
     }
 
     override fun onInactive() {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/domain/model/v31/PermissionGroupUsageModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/domain/model/v31/PermissionGroupUsageModel.kt
index 4b2364cc5..fef152c4e 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/domain/model/v31/PermissionGroupUsageModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/domain/model/v31/PermissionGroupUsageModel.kt
@@ -29,3 +29,10 @@ data class PermissionGroupUsageModel(
      */
     val isUserSensitive: Boolean,
 )
+
+sealed class PermissionGroupUsageModelWrapper {
+    data object Loading : PermissionGroupUsageModelWrapper()
+
+    data class Success(val permissionUsageModels: List<PermissionGroupUsageModel>) :
+        PermissionGroupUsageModelWrapper()
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/domain/model/v31/PermissionTimelineUsageModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/domain/model/v31/PermissionTimelineUsageModel.kt
new file mode 100644
index 000000000..04233299e
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/domain/model/v31/PermissionTimelineUsageModel.kt
@@ -0,0 +1,42 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.domain.model.v31
+
+/**
+ * This model class provides data for creating one row/preference on the permission timeline page.
+ * The time stamps are with precision rounded to minute.
+ */
+data class PermissionTimelineUsageModel(
+    val packageName: String,
+    val userId: Int,
+    val opNames: Set<String>,
+    val accessStartMillis: Long,
+    val accessEndMillis: Long,
+    val durationMillis: Long,
+    val isUserSensitive: Boolean = false,
+    val attributionLabel: String? = null,
+    val attributionTags: Set<String>? = null,
+    val proxyPackageName: String? = null,
+    val proxyUserId: Int? = null,
+)
+
+sealed class PermissionTimelineUsageModelWrapper {
+    data object Loading : PermissionTimelineUsageModelWrapper()
+
+    data class Success(val timelineUsageModels: List<PermissionTimelineUsageModel>) :
+        PermissionTimelineUsageModelWrapper()
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/GetPermissionGroupUsageDetailsUseCase.kt b/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/GetPermissionGroupUsageDetailsUseCase.kt
new file mode 100644
index 000000000..16eaaf6f2
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/GetPermissionGroupUsageDetailsUseCase.kt
@@ -0,0 +1,313 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.domain.usecase.v31
+
+import android.Manifest
+import android.app.AppOpsManager
+import android.os.UserHandle
+import android.permission.flags.Flags
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel.DiscreteOpModel
+import com.android.permissioncontroller.appops.data.repository.v31.AppOpRepository
+import com.android.permissioncontroller.permission.data.repository.v31.PermissionRepository
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionTimelineUsageModel
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionTimelineUsageModelWrapper
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.CLUSTER_SPACING_MINUTES
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.ONE_MINUTE_MS
+import com.android.permissioncontroller.permission.utils.PermissionMapping
+import com.android.permissioncontroller.pm.data.repository.v31.PackageRepository
+import com.android.permissioncontroller.role.data.repository.v31.RoleRepository
+import com.android.permissioncontroller.user.data.repository.v31.UserRepository
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.flow.Flow
+import kotlinx.coroutines.flow.map
+
+/**
+ * This use case reads discrete app ops data and transform it to show the private data access by
+ * apps on permission timeline page.
+ */
+class GetPermissionGroupUsageDetailsUseCase(
+    private val permissionGroup: String,
+    private val packageRepository: PackageRepository,
+    private val permissionRepository: PermissionRepository,
+    private val appOpRepository: AppOpRepository,
+    private val roleRepository: RoleRepository,
+    private val userRepository: UserRepository,
+) {
+    operator fun invoke(coroutineScope: CoroutineScope): Flow<PermissionTimelineUsageModelWrapper> {
+        val opNames = requireNotNull(permissionGroupToOpNames[permissionGroup])
+        return appOpRepository.getDiscreteOps(opNames, coroutineScope).map { pkgOps ->
+            val currentUsers =
+                userRepository
+                    .getUserProfilesIncludingCurrentUser()
+                    .filterUsersToShowInQuietMode(userRepository)
+            val exemptedPackages = roleRepository.getExemptedPackages()
+
+            val filteredPackageOps: List<DiscretePackageOpsModel> =
+                pkgOps
+                    .filter { packageOps ->
+                        packageOps.userId in currentUsers &&
+                            packageOps.packageName !in exemptedPackages
+                    }
+                    .filterPackagesNotRequestingPermission(permissionGroup)
+                    .map { packageOps ->
+                        packageOps.isUserSensitive =
+                            isPermissionGroupUserSensitive(
+                                packageOps.packageName,
+                                permissionGroup,
+                                packageOps.userId,
+                                permissionRepository,
+                                packageRepository
+                            )
+                        packageOps
+                    }
+            val attributedPackageOps: List<DiscretePackageOpsModel> =
+                filteredPackageOps.groupByAttributionLabelIfNeeded()
+            val clusteredPackageOps: List<DiscretePackageOpsModel> =
+                attributedPackageOps.createAccessClusters()
+            val permissionTimelineUsageModels: List<PermissionTimelineUsageModel> =
+                clusteredPackageOps.buildPermissionTimelineUsage()
+            PermissionTimelineUsageModelWrapper.Success(permissionTimelineUsageModels)
+        }
+    }
+
+    /** Group app op accesses by attribution label if it is available and user visible. */
+    private suspend fun List<DiscretePackageOpsModel>.groupByAttributionLabelIfNeeded() =
+        map { packageOps ->
+                val attributionInfo =
+                    packageRepository.getPackageAttributionInfo(
+                        packageOps.packageName,
+                        UserHandle.of(packageOps.userId)
+                    )
+                if (attributionInfo != null) {
+                    if (attributionInfo.areUserVisible && attributionInfo.tagResourceMap != null) {
+                        val attributionLabelOpsMap: Map<String?, List<DiscreteOpModel>> =
+                            packageOps.appOpAccesses
+                                .map { appOpEntry ->
+                                    val resourceId =
+                                        attributionInfo.tagResourceMap[appOpEntry.attributionTag]
+                                    val label = attributionInfo.resourceLabelMap?.get(resourceId)
+                                    label to appOpEntry
+                                }
+                                .groupBy { labelAppOpEntryPair -> labelAppOpEntryPair.first }
+                                .mapValues { (_, values) ->
+                                    values.map { labelAppOpEntryPair -> labelAppOpEntryPair.second }
+                                }
+
+                        attributionLabelOpsMap.map { labelAppOpsEntry ->
+                            DiscretePackageOpsModel(
+                                packageOps.packageName,
+                                packageOps.userId,
+                                appOpAccesses = labelAppOpsEntry.value,
+                                attributionLabel = labelAppOpsEntry.key,
+                                isUserSensitive = packageOps.isUserSensitive,
+                            )
+                        }
+                    } else {
+                        listOf(packageOps)
+                    }
+                } else {
+                    listOf(packageOps)
+                }
+            }
+            .flatten()
+
+    /**
+     * App op accesses are merged if the timestamp of the access is within the cluster spacing i.e.
+     * one minute.
+     */
+    private fun List<DiscretePackageOpsModel>.createAccessClusters():
+        List<DiscretePackageOpsModel> {
+        return flatMap { packageOps ->
+            val clusters = mutableListOf<DiscretePackageOpsModel>()
+            val currentCluster = mutableListOf<DiscreteOpModel>()
+            val sortedOps = packageOps.appOpAccesses.sortedBy { it.accessTimeMillis }
+            for (discreteAccess in sortedOps) {
+                if (currentCluster.isEmpty()) {
+                    currentCluster.add(discreteAccess)
+                } else if (!canAccessBeAddedToCluster(discreteAccess, currentCluster)) {
+                    clusters.add(
+                        DiscretePackageOpsModel(
+                            packageOps.packageName,
+                            packageOps.userId,
+                            currentCluster.toMutableList(),
+                            packageOps.attributionLabel,
+                            packageOps.isUserSensitive
+                        )
+                    )
+                    currentCluster.clear()
+                    currentCluster.add(discreteAccess)
+                } else {
+                    currentCluster.add(discreteAccess)
+                }
+            }
+
+            if (currentCluster.isNotEmpty()) {
+                clusters.add(
+                    DiscretePackageOpsModel(
+                        packageOps.packageName,
+                        packageOps.userId,
+                        currentCluster.toMutableList(),
+                        packageOps.attributionLabel,
+                        packageOps.isUserSensitive
+                    )
+                )
+            }
+            clusters
+        }
+    }
+
+    private fun List<DiscretePackageOpsModel>.buildPermissionTimelineUsage():
+        List<PermissionTimelineUsageModel> {
+        return this.map { packageOpsCluster ->
+            val startTimeMillis = packageOpsCluster.appOpAccesses.minOf { it.accessTimeMillis }
+            // The end minute is exclusive here in terms of access, i.e. [1..5) as the private data
+            // was not accessed at minute 5, it helps calculate the duration correctly.
+            val endTimeMillis =
+                packageOpsCluster.appOpAccesses.maxOf { appOpEvent ->
+                    if (appOpEvent.durationMillis > 0)
+                        appOpEvent.accessTimeMillis + appOpEvent.durationMillis
+                    else appOpEvent.accessTimeMillis + ONE_MINUTE_MS
+                }
+            val durationMillis = endTimeMillis - startTimeMillis
+            val proxy = packageOpsCluster.appOpAccesses.firstOrNull { it.proxyPackageName != null }
+
+            PermissionTimelineUsageModel(
+                packageOpsCluster.packageName,
+                packageOpsCluster.userId,
+                packageOpsCluster.appOpAccesses.map { it.opName }.toSet(),
+                startTimeMillis,
+                // Make the end time inclusive i.e. [1..4]
+                endTimeMillis - ONE_MINUTE_MS,
+                durationMillis,
+                packageOpsCluster.isUserSensitive,
+                packageOpsCluster.attributionLabel,
+                packageOpsCluster.appOpAccesses.mapNotNull { it.attributionTag }.toSet(),
+                proxy?.proxyPackageName,
+                proxy?.proxyUserId,
+            )
+        }
+    }
+
+    private fun isLocationByPassEnabled(): Boolean =
+        SdkLevel.isAtLeastV() && Flags.locationBypassPrivacyDashboardEnabled()
+
+    /**
+     * Determine if an op should be in its own cluster and hence display as an individual entry in
+     * the privacy timeline
+     */
+    private fun isOpClusteredByItself(opName: String): Boolean {
+        if (isLocationByPassEnabled()) {
+            return opName == AppOpsManager.OPSTR_EMERGENCY_LOCATION
+        }
+        return false
+    }
+
+    private fun canAccessBeAddedToCluster(
+        currentAccess: DiscreteOpModel,
+        clusteredAccesses: List<DiscreteOpModel>
+    ): Boolean {
+        val clusterOp = clusteredAccesses.last().opName
+        if (
+            (isOpClusteredByItself(currentAccess.opName) || isOpClusteredByItself(clusterOp)) &&
+                currentAccess.opName != clusteredAccesses.last().opName
+        ) {
+            return false
+        }
+        val currentAccessMinute = currentAccess.accessTimeMillis / ONE_MINUTE_MS
+        val prevMostRecentAccessMillis =
+            clusteredAccesses.maxOf { discreteAccess ->
+                if (discreteAccess.durationMillis > 0)
+                // accessTimeMillis and durationMillis are rounded at minute level. if an entry
+                // says mic was accessed for 3 minutes at minute 45, then the end time should
+                // be minute 47, as the mic was accessed at minute 45, 46, and 47.
+                // 45 + 3 - 1 = 47
+                discreteAccess.accessTimeMillis + discreteAccess.durationMillis - ONE_MINUTE_MS
+                else discreteAccess.accessTimeMillis
+            }
+        val prevMostRecentAccessMinute = prevMostRecentAccessMillis / ONE_MINUTE_MS
+        return (currentAccessMinute - prevMostRecentAccessMinute) <= CLUSTER_SPACING_MINUTES
+    }
+
+    private fun getGroupOfPlatformPermission(permission: String): String? {
+        if (permission == Manifest.permission.LOCATION_BYPASS) {
+            return Manifest.permission_group.LOCATION
+        }
+        return PermissionMapping.getGroupOfPlatformPermission(permission)
+    }
+
+    /**
+     * Filter out packages that are not requesting any permission from the permission group anymore.
+     */
+    private suspend fun List<DiscretePackageOpsModel>.filterPackagesNotRequestingPermission(
+        permissionGroup: String
+    ): List<DiscretePackageOpsModel> {
+        return mapNotNull { packageOpsModel ->
+            val userHandle = UserHandle.of(packageOpsModel.userId)
+            val packageInfo =
+                packageRepository.getPackageInfo(packageOpsModel.packageName, userHandle)
+            val isAnyPermissionRequestedFromPermissionGroup =
+                packageInfo?.requestedPermissions?.any { permission ->
+                    permissionGroup == getGroupOfPlatformPermission(permission)
+                } ?: false
+            if (isAnyPermissionRequestedFromPermissionGroup) {
+                packageOpsModel
+            } else {
+                null
+            }
+        }
+    }
+
+    companion object {
+        val permissionGroupToOpNames: Map<String, List<String>> = permissionGroupToOpNamesMap()
+
+        private fun permissionGroupToOpNamesMap(): Map<String, List<String>> {
+            val permissionGroupOpNamesMap = mutableMapOf<String, MutableList<String>>()
+            val permissionGroups =
+                listOf(
+                    Manifest.permission_group.CAMERA,
+                    Manifest.permission_group.LOCATION,
+                    Manifest.permission_group.MICROPHONE
+                )
+            permissionGroups.forEach { permissionGroup ->
+                val opNames =
+                    PermissionMapping.getPlatformPermissionNamesOfGroup(permissionGroup)
+                        .mapNotNull { AppOpsManager.permissionToOp(it) }
+                        .toMutableList()
+                permissionGroupOpNamesMap[permissionGroup] = opNames
+            }
+            permissionGroupOpNamesMap[Manifest.permission_group.MICROPHONE]?.add(
+                AppOpsManager.OPSTR_PHONE_CALL_MICROPHONE
+            )
+            permissionGroupOpNamesMap[Manifest.permission_group.CAMERA]?.add(
+                AppOpsManager.OPSTR_PHONE_CALL_CAMERA
+            )
+            if (SdkLevel.isAtLeastT()) {
+                permissionGroupOpNamesMap[Manifest.permission_group.MICROPHONE]?.add(
+                    AppOpsManager.OPSTR_RECEIVE_AMBIENT_TRIGGER_AUDIO
+                )
+            }
+            if (isLocationByPassEnabled()) {
+                permissionGroupOpNamesMap[Manifest.permission_group.LOCATION]?.add(
+                    AppOpsManager.OPSTR_EMERGENCY_LOCATION
+                )
+            }
+            return permissionGroupOpNamesMap.toMap()
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/GetPermissionGroupUsageUseCase.kt b/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/GetPermissionGroupUsageUseCase.kt
index 7e079949a..5faacc235 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/GetPermissionGroupUsageUseCase.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/GetPermissionGroupUsageUseCase.kt
@@ -29,6 +29,7 @@ import com.android.permissioncontroller.appops.data.repository.v31.AppOpReposito
 import com.android.permissioncontroller.permission.data.repository.v31.PermissionRepository
 import com.android.permissioncontroller.permission.domain.model.v31.PackagePermissionGroupUsageModel
 import com.android.permissioncontroller.permission.domain.model.v31.PermissionGroupUsageModel
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionGroupUsageModelWrapper
 import com.android.permissioncontroller.permission.utils.PermissionMapping
 import com.android.permissioncontroller.pm.data.repository.v31.PackageRepository
 import com.android.permissioncontroller.role.data.repository.v31.RoleRepository
@@ -51,18 +52,20 @@ class GetPermissionGroupUsageUseCase(
      * Returns a flow (i.e. a stream) of permission group usages (i.e. the private data accesses)
      * for privacy dashboard page.
      */
-    operator fun invoke(): Flow<List<PermissionGroupUsageModel>> {
+    operator fun invoke(): Flow<PermissionGroupUsageModelWrapper> {
         return appOpRepository.packageAppOpsUsages.map { packagesOps ->
             val exemptedPackages = roleRepository.getExemptedPackages()
             val currentUsers = userRepository.getUserProfilesIncludingCurrentUser()
 
-            packagesOps
-                .mapToPermissionGroups()
-                .filter { it.userId in currentUsers }
-                .filter { it.packageName !in exemptedPackages }
-                .filterQuietProfilesIfNeeded(currentUsers)
-                .filterNonRequestedOps()
-                .buildPermissionGroupUsageModels()
+            val usages =
+                packagesOps
+                    .mapToPermissionGroups()
+                    .filter { it.userId in currentUsers }
+                    .filter { it.packageName !in exemptedPackages }
+                    .filterQuietProfilesIfNeeded(currentUsers)
+                    .filterNonRequestedOps()
+                    .buildPermissionGroupUsageModels()
+            PermissionGroupUsageModelWrapper.Success(usages)
         }
     }
 
@@ -128,8 +131,7 @@ class GetPermissionGroupUsageUseCase(
                     packageInfo?.requestedPermissions?.any { permission ->
                         permissionGroupUsage.key ==
                             PermissionMapping.getGroupOfPlatformPermission(permission)
-                    }
-                        ?: false
+                    } ?: false
                 }
             if (filteredOps.isNotEmpty()) {
                 PackagePermissionGroupUsageModel(pkgOps.packageName, filteredOps, pkgOps.userId)
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/PermissionUsageUtils.kt b/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/PermissionUsageUtils.kt
new file mode 100644
index 000000000..7f5910ac1
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/PermissionUsageUtils.kt
@@ -0,0 +1,103 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.domain.usecase.v31
+
+import android.Manifest
+import android.content.pm.ApplicationInfo
+import android.content.pm.PackageInfo
+import android.content.pm.PackageManager
+import android.os.UserHandle
+import android.permission.flags.Flags
+import androidx.annotation.VisibleForTesting
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.permission.data.repository.v31.PermissionRepository
+import com.android.permissioncontroller.permission.utils.PermissionMapping
+import com.android.permissioncontroller.pm.data.repository.v31.PackageRepository
+import com.android.permissioncontroller.user.data.repository.v31.UserRepository
+
+/** Returns a list of users which can be shown in the Settings surfaces. */
+suspend fun List<Int>.filterUsersToShowInQuietMode(userRepository: UserRepository): List<Int> {
+    if (!SdkLevel.isAtLeastV()) {
+        return this
+    }
+    val usersQuietModeEnabledMap =
+        this.associateWith { userId -> userRepository.isQuietModeEnabled(userId) }
+    val usersShouldShowInQuietModeMap =
+        this.associateWith { userId -> userRepository.shouldShowInQuietMode(userId) }
+
+    return filter {
+        val isQuietModeEnabled = checkNotNull(usersQuietModeEnabledMap[it])
+        val shouldShowInQuietMode = checkNotNull(usersShouldShowInQuietModeMap[it])
+        !isQuietModeEnabled || shouldShowInQuietMode
+    }
+}
+
+/**
+ * Determines if an app's permission group is user-sensitive. if the permission group is not user
+ * sensitive then its only shown when user choose `Show system` option
+ */
+suspend fun isPermissionGroupUserSensitive(
+    packageName: String,
+    permissionGroup: String,
+    userId: Int,
+    permissionRepository: PermissionRepository,
+    packageRepository: PackageRepository,
+): Boolean {
+    if (isTelecomPackage(packageName, permissionGroup)) {
+        return false
+    }
+    val userHandle = UserHandle.of(userId)
+    val packageInfo = packageRepository.getPackageInfo(packageName, userHandle) ?: return false
+    // if not a system app, the permission group must be user sensitive
+    if (packageInfo.applicationFlags and ApplicationInfo.FLAG_SYSTEM == 0) {
+        return true
+    }
+
+    packageInfo.requestedPermissions.forEachIndexed { index, permissionName ->
+        if (PermissionMapping.getGroupOfPlatformPermission(permissionName) == permissionGroup) {
+            val permFlags =
+                permissionRepository.getPermissionFlags(permissionName, packageName, userHandle)
+            val packageFlags = packageInfo.requestedPermissionsFlags[index]
+            val isPermissionGranted =
+                packageFlags and PackageInfo.REQUESTED_PERMISSION_GRANTED != 0 &&
+                    permFlags and PackageManager.FLAG_PERMISSION_REVOKED_COMPAT == 0
+            if (isPermissionUserSensitive(isPermissionGranted, permFlags)) {
+                return true
+            }
+        }
+    }
+    return false
+}
+
+private fun isPermissionUserSensitive(isPermissionGranted: Boolean, permissionFlags: Int): Boolean {
+    return if (isPermissionGranted) {
+        permissionFlags and PackageManager.FLAG_PERMISSION_USER_SENSITIVE_WHEN_GRANTED != 0
+    } else {
+        permissionFlags and PackageManager.FLAG_PERMISSION_USER_SENSITIVE_WHEN_DENIED != 0
+    }
+}
+
+@VisibleForTesting const val TELECOM_PACKAGE = "com.android.server.telecom"
+
+private fun isTelecomPackage(packageName: String, permissionGroup: String): Boolean {
+    return packageName == TELECOM_PACKAGE &&
+        (permissionGroup == Manifest.permission_group.CAMERA ||
+            permissionGroup == Manifest.permission_group.MICROPHONE)
+}
+
+fun isLocationByPassEnabled(): Boolean =
+    SdkLevel.isAtLeastV() && Flags.locationBypassPrivacyDashboardEnabled()
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/package-info.java b/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/package-info.java
new file mode 100644
index 000000000..5a9df05f9
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/domain/usecase/v31/package-info.java
@@ -0,0 +1,18 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+@androidx.annotation.RequiresApi(android.os.Build.VERSION_CODES.S)
+package com.android.permissioncontroller.permission.domain.usecase.v31;
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightAppPermGroup.kt b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightAppPermGroup.kt
index a5736ca83..61a604de8 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightAppPermGroup.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightAppPermGroup.kt
@@ -20,6 +20,7 @@ import android.Manifest
 import android.Manifest.permission.ACCESS_COARSE_LOCATION
 import android.os.Build
 import android.os.UserHandle
+import com.android.permissioncontroller.permission.utils.Utils
 
 /**
  * A lightweight version of the AppPermissionGroup data structure. Represents information about a
@@ -75,10 +76,13 @@ data class LightAppPermGroup(
         get() =
             permissions.mapNotNull { (name, _) -> if (name !in backgroundPermNames) name else null }
 
+    val isPlatformPermissionGroup = permGroupInfo.packageName == Utils.OS_PKG
+
     val foreground =
         AppPermSubGroup(
             permissions.filter { it.key in foregroundPermNames },
             packageInfo,
+            isPlatformPermissionGroup,
             specialLocationGrant
         )
 
@@ -86,6 +90,7 @@ data class LightAppPermGroup(
         AppPermSubGroup(
             permissions.filter { it.key in backgroundPermNames },
             packageInfo,
+            isPlatformPermissionGroup,
             specialLocationGrant
         )
 
@@ -123,7 +128,7 @@ data class LightAppPermGroup(
     val isOneTime =
         (permGroupName != Manifest.permission_group.LOCATION &&
             permissions.any { it.value.isOneTime } &&
-            permissions.none { !it.value.isOneTime && it.value.isGrantedIncludingAppOp }) ||
+            permissions.none { !it.value.isOneTime && it.value.isGranted }) ||
             (permGroupName == Manifest.permission_group.LOCATION &&
                 permissions[ACCESS_COARSE_LOCATION]?.isOneTime == true)
 
@@ -160,16 +165,24 @@ data class LightAppPermGroup(
      *
      * @param permissions The permissions contained within this subgroup, a subset of those
      *   contained in the full group
+     * @param isPlatformPermissionGroup Whether this is a platform permission group
      * @param specialLocationGrant Whether this is a special location package
      */
     data class AppPermSubGroup
     internal constructor(
         private val permissions: Map<String, LightPermission>,
         private val packageInfo: LightPackageInfo,
+        private val isPlatformPermissionGroup: Boolean,
         private val specialLocationGrant: Boolean?
     ) {
         /** Whether any of this App Permission SubGroup's permissions are granted */
-        val isGranted = specialLocationGrant ?: permissions.any { it.value.isGrantedIncludingAppOp }
+        val isGranted =
+            specialLocationGrant
+                ?: permissions.any {
+                    val mayGrantByPlatformOrSystem =
+                        !isPlatformPermissionGroup || it.value.isPlatformOrSystem
+                    it.value.isGranted && mayGrantByPlatformOrSystem
+                }
 
         /**
          * Whether this App Permission SubGroup should be treated as granted. This means either:
@@ -178,14 +191,13 @@ data class LightAppPermGroup(
          * 2) All permissions were auto-granted (all permissions are all granted and all
          *    RevokeWhenRequested.)
          */
-        val isGrantedExcludingRWROrAllRWR =
+        val allowFullGroupGrant =
             specialLocationGrant
                 ?: (permissions.any {
-                    it.value.isGrantedIncludingAppOp && !it.value.isRevokeWhenRequested
-                } ||
-                    permissions.all {
-                        it.value.isGrantedIncludingAppOp && it.value.isRevokeWhenRequested
-                    })
+                    val mayGrantByPlatformOrSystem =
+                        !isPlatformPermissionGroup || it.value.isPlatformOrSystem
+                    it.value.allowFullGroupGrant && mayGrantByPlatformOrSystem
+                } || permissions.all { it.value.isGranted && it.value.isRevokeWhenRequested })
 
         /** Whether any of this App Permission SubGroup's permissions are granted by default */
         val isGrantedByDefault = permissions.any { it.value.isGrantedByDefault }
@@ -196,7 +208,7 @@ data class LightAppPermGroup(
          */
         val isOneTime =
             permissions.any { it.value.isOneTime } &&
-                permissions.none { it.value.isGrantedIncludingAppOp && !it.value.isOneTime }
+                permissions.none { it.value.isGranted && !it.value.isOneTime }
 
         /**
          * Whether any of this App Permission Subgroup's foreground permissions are fixed by policy
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPackageInfo.kt b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPackageInfo.kt
index ab8afae08..32bc3c526 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPackageInfo.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPackageInfo.kt
@@ -61,7 +61,9 @@ data class LightPackageInfo(
         pI: PackageInfo
     ) : this(
         pI.packageName,
-        pI.permissions?.map { perm -> LightPermInfo(perm) } ?: emptyList(),
+        pI.permissions?.map { perm ->
+            LightPermInfo(perm, pI.applicationInfo!!.flags and ApplicationInfo.FLAG_SYSTEM != 0)
+        } ?: emptyList(),
         pI.requestedPermissions?.toList() ?: emptyList(),
         pI.requestedPermissionsFlags?.toList() ?: emptyList(),
         pI.applicationInfo!!.uid,
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPermInfo.kt b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPermInfo.kt
index c1d271098..a25dcc24b 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPermInfo.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPermInfo.kt
@@ -30,6 +30,7 @@ import android.content.pm.PermissionInfo
  * @param protection The protection level of this permission
  * @param protection Extra information about the protection of this permission
  * @param flags The system flags of this permission
+ * @param isSystem Whether this permission is defined by a system app
  */
 data class LightPermInfo(
     val name: String,
@@ -38,10 +39,12 @@ data class LightPermInfo(
     val backgroundPermission: String?,
     val protection: Int,
     val protectionFlags: Int,
-    val flags: Int
+    val flags: Int,
+    val isSystem: Boolean?,
 ) {
     constructor(
-        permInfo: PermissionInfo
+        permInfo: PermissionInfo,
+        isSystem: Boolean?
     ) : this(
         permInfo.name,
         permInfo.packageName,
@@ -49,7 +52,8 @@ data class LightPermInfo(
         permInfo.backgroundPermission,
         permInfo.protection,
         permInfo.protectionFlags,
-        permInfo.flags
+        permInfo.flags,
+        isSystem
     )
 
     /**
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPermission.kt b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPermission.kt
index 7492ea6e0..66a076551 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPermission.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/LightPermission.kt
@@ -28,8 +28,8 @@ import com.android.permissioncontroller.permission.utils.Utils
  *
  * @param pkgInfo The package requesting the permission
  * @param permInfo The permissionInfo this represents
- * @param isGrantedIncludingAppOp Whether or not this permission is functionally granted. A
- *   non-granted app op but granted permission is counted as not granted
+ * @param isGranted Whether or not this permission is functionally granted. A non-granted app op but
+ *   granted permission is counted as not granted
  * @param flags The PermissionController flags for this permission
  * @param foregroundPerms The foreground permission names corresponding to this permission, if this
  *   permission is a background permission
@@ -37,7 +37,7 @@ import com.android.permissioncontroller.permission.utils.Utils
 data class LightPermission(
     val pkgInfo: LightPackageInfo,
     val permInfo: LightPermInfo,
-    val isGrantedIncludingAppOp: Boolean,
+    val isGranted: Boolean,
     val flags: Int,
     val foregroundPerms: List<String>?
 ) {
@@ -98,9 +98,9 @@ data class LightPermission(
     /** Whether this permission is user sensitive in its current grant state */
     val isUserSensitive =
         !isRuntimePlatformPermission(permInfo.name) ||
-            (isGrantedIncludingAppOp &&
+            (isGranted &&
                 (flags and PackageManager.FLAG_PERMISSION_USER_SENSITIVE_WHEN_GRANTED) != 0) ||
-            (!isGrantedIncludingAppOp &&
+            (!isGranted &&
                 (flags and PackageManager.FLAG_PERMISSION_USER_SENSITIVE_WHEN_DENIED) != 0)
     /** Whether the permission is restricted */
     val isRestricted =
@@ -122,10 +122,17 @@ data class LightPermission(
      */
     val isSelectedLocationAccuracy =
         flags and PackageManager.FLAG_PERMISSION_SELECTED_LOCATION_ACCURACY != 0
+    /** Whether this permission is defined by platform or a system app */
+    val isPlatformOrSystem = permInfo.packageName == Utils.OS_PKG || permInfo.isSystem == true
+    /**
+     * Whether this permission is granted including app op and does not hold the
+     * PackageManager.FLAG_PERMISSION_REVOKE_WHEN_REQUESTED flag.
+     */
+    val allowFullGroupGrant = isGranted && !isRevokeWhenRequested
 
     override fun toString() = buildString {
         append(name)
-        if (isGrantedIncludingAppOp) append(", Granted") else append(", NotGranted")
+        if (isGranted) append(", Granted") else append(", NotGranted")
         if (isPolicyFixed) append(", PolicyFixed")
         if (isSystemFixed) append(", SystemFixed")
         if (isUserFixed) append(", UserFixed")
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/v31/LightHistoricalPackageOps.kt b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/v31/LightHistoricalPackageOps.kt
index d5451c208..04cc8a796 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/v31/LightHistoricalPackageOps.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/model/livedatatypes/v31/LightHistoricalPackageOps.kt
@@ -155,6 +155,7 @@ data class LightHistoricalPackageOps(
                     val opEntry: AttributedOpEntry = it.getDiscreteAccessAt(i)
                     discreteAccessList.add(
                         DiscreteAccess(
+                            it.opName,
                             opEntry.getLastAccessTime(DISCRETE_ACCESS_OP_FLAGS),
                             opEntry.getLastDuration(DISCRETE_ACCESS_OP_FLAGS),
                             opEntry.getLastProxyInfo(DISCRETE_ACCESS_OP_FLAGS)
@@ -192,6 +193,7 @@ data class LightHistoricalPackageOps(
                     val attributedOpEntry: AttributedOpEntry = it.getDiscreteAccessAt(i)
                     discreteAccessList.add(
                         DiscreteAccess(
+                            it.opName,
                             attributedOpEntry.getLastAccessTime(DISCRETE_ACCESS_OP_FLAGS),
                             attributedOpEntry.getLastDuration(DISCRETE_ACCESS_OP_FLAGS),
                             attributedOpEntry.getLastProxyInfo(DISCRETE_ACCESS_OP_FLAGS)
@@ -231,6 +233,7 @@ data class LightHistoricalPackageOps(
 
     /** Data class representing a discrete permission access. */
     data class DiscreteAccess(
+        val opName: String,
         val accessTimeMs: Long,
         val accessDurationMs: Long,
         val proxy: OpEventProxyInfo?
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/service/AutoRevokePermissions.kt b/PermissionController/src/com/android/permissioncontroller/permission/service/AutoRevokePermissions.kt
index cfe753019..aae2aa212 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/service/AutoRevokePermissions.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/service/AutoRevokePermissions.kt
@@ -132,7 +132,7 @@ suspend fun revokeAppPermissions(
                 val fixed = group.isBackgroundFixed || group.isForegroundFixed
                 val granted =
                     group.permissions.any { (_, perm) ->
-                        perm.isGrantedIncludingAppOp && perm.name !in AUTO_REVOKE_EXEMPT_PERMISSIONS
+                        perm.isGranted && perm.name !in AUTO_REVOKE_EXEMPT_PERMISSIONS
                     }
                 if (
                     !fixed &&
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/service/PermissionControllerServiceImpl.java b/PermissionController/src/com/android/permissioncontroller/permission/service/PermissionControllerServiceImpl.java
index eb78414f9..e3deb58a7 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/service/PermissionControllerServiceImpl.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/service/PermissionControllerServiceImpl.java
@@ -861,6 +861,7 @@ public final class PermissionControllerServiceImpl extends PermissionControllerL
             group.setSelfRevoked();
             group.persistChanges(false);
         }
+        Log.d(LOG_TAG, "Self revoked permissions: " + String.join(",", permissions));
         getMainExecutor().execute(callback);
     }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/service/RuntimePermissionsUpgradeController.kt b/PermissionController/src/com/android/permissioncontroller/permission/service/RuntimePermissionsUpgradeController.kt
index af3b60702..2734116dd 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/service/RuntimePermissionsUpgradeController.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/service/RuntimePermissionsUpgradeController.kt
@@ -492,7 +492,7 @@ object RuntimePermissionsUpgradeController {
                     LightPermission(
                         perm.pkgInfo,
                         perm.permInfo,
-                        perm.isGrantedIncludingAppOp,
+                        perm.isGranted,
                         perm.flags or FLAG_PERMISSION_RESTRICTION_UPGRADE_EXEMPT,
                         perm.foregroundPerms
                     )
@@ -569,7 +569,7 @@ object RuntimePermissionsUpgradeController {
                         !perm.isUserSet &&
                             !perm.isSystemFixed &&
                             !perm.isPolicyFixed &&
-                            !perm.isGrantedIncludingAppOp
+                            !perm.isGranted
                     ) {
                         grants.add(
                             Grant(false, appPermGroup, listOf(permission.ACCESS_MEDIA_LOCATION))
@@ -670,7 +670,7 @@ object RuntimePermissionsUpgradeController {
                         LightPermission(
                             perm.pkgInfo,
                             perm.permInfo,
-                            perm.isGrantedIncludingAppOp,
+                            perm.isGranted,
                             perm.flags or FLAG_PERMISSION_RESTRICTION_UPGRADE_EXEMPT,
                             perm.foregroundPerms
                         )
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/service/TEST_MAPPING b/PermissionController/src/com/android/permissioncontroller/permission/service/TEST_MAPPING
index 487701204..dc1bb28a5 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/service/TEST_MAPPING
+++ b/PermissionController/src/com/android/permissioncontroller/permission/service/TEST_MAPPING
@@ -1,19 +1,5 @@
 {
     "presubmit": [
-        {
-            "name": "CtsPermissionTestCases",
-            "options": [
-                {
-                    "exclude-annotation": "androidx.test.filters.FlakyTest"
-                },
-                {
-                    "include-filter": "android.permission.cts.PermissionControllerTest"
-                },
-                {
-                    "include-filter": "android.permission.cts.OneTimePermissionTest"
-                }
-            ]
-        },
         {
             "name": "CtsPermissionUiTestCases",
             "options": [
@@ -25,18 +11,6 @@
                 }
             ]
         },
-        {
-            "name": "CtsPermissionTestCases",
-            "options": [
-                {
-                    "exclude-annotation": "androidx.test.filters.FlakyTest"
-                },
-                {
-                    "include-filter": "android.permission.cts.LocationAccessCheckTest"
-                }
-            ],
-            "file_patterns": ["LocationAccessCheck\\.java"]
-        },
         {
             "name": "CtsBackupTestCases",
             "options": [
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/service/v34/SafetyLabelChangesJobService.kt b/PermissionController/src/com/android/permissioncontroller/permission/service/v34/SafetyLabelChangesJobService.kt
index 58536b796..715e3823d 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/service/v34/SafetyLabelChangesJobService.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/service/v34/SafetyLabelChangesJobService.kt
@@ -111,10 +111,6 @@ class SafetyLabelChangesJobService : JobService() {
                 Log.i(LOG_TAG, "onReceive: Safety label change notifications are not enabled.")
                 return
             }
-            if (KotlinUtils.safetyLabelChangesJobServiceKillSwitch()) {
-                Log.i(LOG_TAG, "onReceive: kill switch is set.")
-                return
-            }
             if (isContextInProfileUser(receiverContext)) {
                 Log.i(
                     LOG_TAG,
@@ -174,10 +170,6 @@ class SafetyLabelChangesJobService : JobService() {
             Log.w(LOG_TAG, "Not starting job: safety label change notifications are not enabled.")
             return false
         }
-        if (KotlinUtils.safetyLabelChangesJobServiceKillSwitch()) {
-            Log.i(LOG_TAG, "Not starting job: kill switch is set.")
-            return false
-        }
         when (params.jobId) {
             SAFETY_LABEL_CHANGES_DETECT_UPDATES_JOB_ID -> {
                 dispatchDetectUpdatesJob(params)
@@ -490,8 +482,7 @@ class SafetyLabelChangesJobService : JobService() {
     private suspend fun getNumberOfAppsWithDataSharingChanged(): Int {
         val appDataSharingUpdates =
             AppDataSharingUpdatesLiveData(PermissionControllerApplication.get())
-                .getInitializedValue()
-                ?: return 0
+                .getInitializedValue() ?: return 0
 
         return appDataSharingUpdates
             .map { appDataSharingUpdate ->
@@ -523,8 +514,7 @@ class SafetyLabelChangesJobService : JobService() {
             }
             ?.keys
             ?.filter { packageUser: Pair<String, UserHandle> -> packageUser.first == packageName }
-            ?.map { packageUser: Pair<String, UserHandle> -> packageUser.second }
-            ?: listOf()
+            ?.map { packageUser: Pair<String, UserHandle> -> packageUser.second } ?: listOf()
     }
 
     private fun AppDataSharingUpdate.containsLocationCategoryUpdate() =
@@ -660,9 +650,7 @@ class SafetyLabelChangesJobService : JobService() {
                             SAFETY_LABEL_CHANGES_DETECT_UPDATES_JOB_ID,
                             ComponentName(context, SafetyLabelChangesJobService::class.java)
                         )
-                        .setRequiresDeviceIdle(
-                            KotlinUtils.runSafetyLabelChangesJobOnlyWhenDeviceIdle()
-                        )
+                        .setRequiresDeviceIdle(true)
                         .build()
                 val result = jobScheduler.schedule(job)
                 if (result != JobScheduler.RESULT_SUCCESS) {
@@ -693,9 +681,7 @@ class SafetyLabelChangesJobService : JobService() {
                             SAFETY_LABEL_CHANGES_PERIODIC_NOTIFICATION_JOB_ID,
                             ComponentName(context, SafetyLabelChangesJobService::class.java)
                         )
-                        .setRequiresDeviceIdle(
-                            KotlinUtils.runSafetyLabelChangesJobOnlyWhenDeviceIdle()
-                        )
+                        .setRequiresDeviceIdle(true)
                         .setPeriodic(KotlinUtils.getSafetyLabelChangesJobIntervalMillis())
                         .setPersisted(true)
                         .build()
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/ManagePermissionsActivity.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/ManagePermissionsActivity.java
index df5b98ae7..36917fbf1 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/ManagePermissionsActivity.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/ManagePermissionsActivity.java
@@ -61,6 +61,7 @@ import com.android.permissioncontroller.DeviceUtils;
 import com.android.permissioncontroller.PermissionControllerStatsLog;
 import com.android.permissioncontroller.R;
 import com.android.permissioncontroller.hibernation.HibernationPolicyKt;
+import com.android.permissioncontroller.permission.compat.AppPermissionFragmentCompat;
 import com.android.permissioncontroller.permission.ui.auto.AutoAllAppPermissionsFragment;
 import com.android.permissioncontroller.permission.ui.auto.AutoAppPermissionsFragment;
 import com.android.permissioncontroller.permission.ui.auto.AutoManageStandardPermissionsFragment;
@@ -69,7 +70,6 @@ import com.android.permissioncontroller.permission.ui.auto.AutoReviewPermissionD
 import com.android.permissioncontroller.permission.ui.auto.AutoUnusedAppsFragment;
 import com.android.permissioncontroller.permission.ui.auto.dashboard.AutoPermissionUsageDetailsFragment;
 import com.android.permissioncontroller.permission.ui.auto.dashboard.AutoPermissionUsageFragment;
-import com.android.permissioncontroller.permission.ui.handheld.AppPermissionFragment;
 import com.android.permissioncontroller.permission.ui.handheld.AppPermissionGroupsFragment;
 import com.android.permissioncontroller.permission.ui.handheld.PermissionAppsFragment;
 import com.android.permissioncontroller.permission.ui.handheld.v31.PermissionDetailsWrapperFragment;
@@ -154,6 +154,17 @@ public final class ManagePermissionsActivity extends SettingsActivity {
             // fragments are restored properly on configuration changes.
             setTheme(R.style.CarSettings);
         }
+        if (SdkLevel.isAtLeastV() && DeviceUtils.isHandheld(this)) {
+            switch (getIntent().getAction()) {
+                case Intent.ACTION_MANAGE_PERMISSIONS:
+                case Intent.ACTION_MANAGE_APP_PERMISSION:
+                case Intent.ACTION_MANAGE_APP_PERMISSIONS:
+                case APP_PERMISSIONS_SETTINGS:
+                case Intent.ACTION_MANAGE_PERMISSION_APPS:
+                    getTheme().applyStyle(R.style.ThemeOverlay_PermissionSettings, true);
+                    break;
+            }
+        }
         super.onCreate(savedInstanceState);
 
         // TODO(b/309578419): Make this activity handle insets properly and then remove this.
@@ -259,7 +270,7 @@ public final class ManagePermissionsActivity extends SettingsActivity {
                             groupName, showSystem, sessionId);
                 } else if (DeviceUtils.isWear(this)) {
                     androidXFragment = WearPermissionUsageDetailsFragment
-                            .newInstance(groupName, showSystem, show7Days);
+                            .newInstance(groupName, showSystem);
                 } else {
                     androidXFragment = PermissionDetailsWrapperFragment
                             .newInstance(groupName, Long.MAX_VALUE, showSystem, sessionId,
@@ -312,8 +323,8 @@ public final class ManagePermissionsActivity extends SettingsActivity {
                     args = WearAppPermissionFragment.createArgs(packageName, permissionName,
                             groupName, userHandle, caller, sessionId, null);
                 } else {
-                    args = AppPermissionFragment.createArgs(packageName, permissionName,
-                            groupName, userHandle, caller, sessionId, null);
+                    args = AppPermissionFragmentCompat.createArgs(packageName, permissionName,
+                            groupName, userHandle, caller, sessionId, null, null);
                 }
                 setNavGraph(args, R.id.app_permission);
                 return;
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/TEST_MAPPING b/PermissionController/src/com/android/permissioncontroller/permission/ui/TEST_MAPPING
index d0b115bcb..507f19a15 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/TEST_MAPPING
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/TEST_MAPPING
@@ -1,17 +1,4 @@
 {
-    "presubmit": [
-        {
-            "name": "CtsPermissionTestCases",
-            "options": [
-                {
-                    "include-filter": "android.permission.cts.OneTimePermissionTest"
-                },
-                {
-                    "exclude-annotation": "androidx.test.filters.FlakyTest"
-                }
-            ]
-        }
-    ],
     "presubmit-large": [
         {
             "name": "CtsDevicePolicyManagerTestCases",
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoAppPermissionFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoAppPermissionFragment.java
index 1f30572ad..026f108fa 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoAppPermissionFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoAppPermissionFragment.java
@@ -22,6 +22,8 @@ import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_
 import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW_ALWAYS;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW_FOREGROUND;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__DENY;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__GRANT_FINE_LOCATION;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__REVOKE_FINE_LOCATION;
 import static com.android.permissioncontroller.permission.ui.ManagePermissionsActivity.EXTRA_RESULT_PERMISSION_INTERACTED;
 import static com.android.permissioncontroller.permission.ui.ManagePermissionsActivity.EXTRA_RESULT_PERMISSION_RESULT;
 
@@ -42,6 +44,7 @@ import android.text.BidiFormatter;
 import android.util.Log;
 import android.view.View;
 import android.widget.RadioButton;
+import android.widget.Switch;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -95,6 +98,9 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
     private TwoStatePreference mForegroundOnlyPermissionPreference;
     @NonNull
     private TwoStatePreference mDenyPermissionPreference;
+
+    @NonNull
+    private TwoStatePreference mToggleFineLocationPreference;
     @NonNull
     private AutoTwoTargetPreference mDetailsPreference;
 
@@ -127,9 +133,9 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
      * Returns a new {@link AutoAppPermissionFragment}.
      *
      * @param packageName the package name for which the permission is being changed
-     * @param permName the name of the permission being changed
-     * @param groupName the name of the permission group being changed
-     * @param userHandle the user for which the permission is being changed
+     * @param permName    the name of the permission being changed
+     * @param groupName   the name of the permission group being changed
+     * @param userHandle  the user for which the permission is being changed
      */
     @NonNull
     public static AutoAppPermissionFragment newInstance(@NonNull String packageName,
@@ -157,6 +163,7 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
     @Override
     public void onCreate(@Nullable Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
+
         mPackageName = getArguments().getString(Intent.EXTRA_PACKAGE_NAME);
         mPermGroupName = getArguments().getString(Intent.EXTRA_PERMISSION_GROUP_NAME);
         if (mPermGroupName == null) {
@@ -214,6 +221,29 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
         mDenyPermissionPreference.setTitle(R.string.app_permission_button_deny);
         permissionSelector.addPreference(mDenyPermissionPreference);
 
+
+        Log.i(LOG_TAG, "enableCoarseFineLocationPromptForAaos flag set to: "
+                + Flags.enableCoarseFineLocationPromptForAaos());
+        if (Flags.enableCoarseFineLocationPromptForAaos()) {
+            mToggleFineLocationPreference = new SelectedSwitchPermissionPreference(
+                    requireContext());
+            mToggleFineLocationPreference.setTitle(R.string.app_permission_location_accuracy);
+            mToggleFineLocationPreference.setSummary(
+                    R.string.app_permission_location_accuracy_subtitle);
+            permissionSelector.addPreference(mToggleFineLocationPreference);
+
+            mToggleFineLocationPreference.setOnPreferenceClickListener(v -> {
+                if (mToggleFineLocationPreference.isChecked()) {
+                    requestChange(ChangeRequest.GRANT_FINE_LOCATION,
+                            APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__GRANT_FINE_LOCATION);
+                } else {
+                    requestChange(ChangeRequest.REVOKE_FINE_LOCATION,
+                            APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__REVOKE_FINE_LOCATION);
+                }
+                return true;
+            });
+        }
+
         mAllowPermissionPreference.setOnPreferenceClickListener(v -> {
             checkOnlyOneButtonOverride(AppPermissionViewModel.ButtonType.ALLOW);
             setResult(GrantPermissionsViewHandler.GRANTED_ALWAYS);
@@ -244,6 +274,8 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
         });
 
         mDetailsPreference = new AutoTwoTargetPreference(requireContext());
+        // If the details are updated, setDetail will update the visibility
+        mDetailsPreference.setVisible(false);
         screen.addPreference(mDetailsPreference);
     }
 
@@ -294,6 +326,16 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
                 }
             }
         }
+
+        if (Flags.enableCoarseFineLocationPromptForAaos()) {
+            mViewModel.getButtonStateLiveData().observe(this, buttonState -> {
+                AppPermissionViewModel.ButtonState locationAccuracyState = buttonState.get(
+                        AppPermissionViewModel.ButtonType.LOCATION_ACCURACY);
+                mToggleFineLocationPreference.setVisible(locationAccuracyState.isShown());
+                mToggleFineLocationPreference.setChecked(locationAccuracyState.isChecked());
+                mToggleFineLocationPreference.setEnabled(locationAccuracyState.isEnabled());
+            });
+        }
     }
 
     @Override
@@ -498,6 +540,7 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
         } else {
             mDetailsPreference.setSummary(detailResIds.getFirst());
         }
+        mDetailsPreference.setVisible(true);
     }
 
     /**
@@ -552,6 +595,26 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
         }
     }
 
+    private static class SelectedSwitchPermissionPreference extends TwoStatePreference {
+
+        SelectedSwitchPermissionPreference(Context context) {
+            super(context, null,
+                    TypedArrayUtils.getAttr(context, androidx.preference.R.attr.preferenceStyle,
+                            android.R.attr.preferenceStyle));
+            setPersistent(false);
+            setLayoutResource(R.layout.car_switch_button_preference);
+            setWidgetLayoutResource(R.layout.switch_button_preference_widget);
+        }
+
+        @Override
+        public void onBindViewHolder(PreferenceViewHolder holder) {
+            super.onBindViewHolder(holder);
+
+            Switch switchButton = (Switch) holder.findViewById(R.id.location_accuracy_switch);
+            switchButton.setChecked(isChecked());
+        }
+    }
+
     /**
      * A dialog warning the user that they are about to deny a permission that was granted by
      * default.
@@ -564,7 +627,7 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
                 + ".arg.changeRequest";
         private static final String BUTTON = ConfirmDialog.class.getName()
                 + ".arg.button";
-        private static int sCode =  APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW;
+        private static int sCode = APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW;
 
         @NonNull
         @Override
@@ -611,6 +674,7 @@ public class AutoAppPermissionFragment extends AutoSettingsFrameFragment
     }
 
     @Override
+    @RequiresApi(Build.VERSION_CODES.TIRAMISU)
     public void showAdvancedConfirmDialog(AdvancedConfirmDialogArgs args) {
         AlertDialog.Builder b = new AlertDialog.Builder(getContext())
                 .setIcon(args.getIconId())
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoAppPermissionsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoAppPermissionsFragment.java
index 446d97c3e..2c4f76eee 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoAppPermissionsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoAppPermissionsFragment.java
@@ -145,8 +145,7 @@ public class AutoAppPermissionsFragment extends AutoSettingsFrameFragment implem
         if (SdkLevel.isAtLeastS()) {
             mPermissionUsages = new PermissionUsages(getContext());
 
-            long aggregateDataFilterBeginDays = KotlinUtils.INSTANCE.is7DayToggleEnabled()
-                    ? AppPermissionGroupsViewModel.AGGREGATE_DATA_FILTER_BEGIN_DAYS_7 :
+            long aggregateDataFilterBeginDays =
                     AppPermissionGroupsViewModel.AGGREGATE_DATA_FILTER_BEGIN_DAYS_1;
 
             long filterTimeBeginMillis = Math.max(System.currentTimeMillis()
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoLocationPermissionPromptView.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoLocationPermissionPromptView.java
new file mode 100644
index 000000000..aee72c295
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/AutoLocationPermissionPromptView.java
@@ -0,0 +1,558 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.auto;
+
+import static android.Manifest.permission.ACCESS_COARSE_LOCATION;
+import static android.Manifest.permission.ACCESS_FINE_LOCATION;
+
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.ALLOW_ALL_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.ALLOW_ALWAYS_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.ALLOW_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.ALLOW_FOREGROUND_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.ALLOW_ONE_TIME_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.ALLOW_SELECTED_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.COARSE_RADIO_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.DENY_AND_DONT_ASK_AGAIN_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.DENY_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.DIALOG_WITH_BOTH_LOCATIONS;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.DIALOG_WITH_COARSE_LOCATION_ONLY;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.DIALOG_WITH_FINE_LOCATION_ONLY;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.DONT_ALLOW_MORE_SELECTED_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.FINE_RADIO_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.LOCATION_ACCURACY_LAYOUT;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.NEXT_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.NEXT_LOCATION_DIALOG;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.NO_UPGRADE_AND_DONT_ASK_AGAIN_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.NO_UPGRADE_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.NO_UPGRADE_OT_AND_DONT_ASK_AGAIN_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsActivity.NO_UPGRADE_OT_BUTTON;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.CANCELED;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.DENIED;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.DENIED_DO_NOT_ASK_AGAIN;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.DENIED_MORE;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.GRANTED_ALWAYS;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.GRANTED_FOREGROUND_ONLY;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.GRANTED_ONE_TIME;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.GRANTED_USER_SELECTED;
+
+import android.app.Activity;
+import android.content.Context;
+import android.graphics.Typeface;
+import android.graphics.drawable.Icon;
+import android.text.method.LinkMovementMethod;
+import android.transition.ChangeBounds;
+import android.transition.TransitionManager;
+import android.util.SparseIntArray;
+import android.view.Gravity;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.view.Window;
+import android.view.accessibility.AccessibilityNodeInfo;
+import android.view.animation.AnimationUtils;
+import android.widget.Button;
+import android.widget.ImageView;
+import android.widget.RadioButton;
+import android.widget.RadioGroup;
+import android.widget.TextView;
+
+import androidx.annotation.RawRes;
+
+import com.android.permissioncontroller.R;
+import com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler;
+
+import com.airbnb.lottie.LottieComposition;
+import com.airbnb.lottie.LottieCompositionFactory;
+import com.airbnb.lottie.LottieDrawable;
+
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+
+/**
+ * An extension of {@link GrantPermissionsAutoViewHandler} that updates the current auto location
+ * permission prompt with a custom view
+ */
+public class AutoLocationPermissionPromptView implements View.OnClickListener {
+    private static final int[] LOCATION_ACCURACY_DIALOGS =
+    {
+        DIALOG_WITH_BOTH_LOCATIONS,
+        DIALOG_WITH_FINE_LOCATION_ONLY,
+        DIALOG_WITH_COARSE_LOCATION_ONLY
+    };
+    private static final long ANIMATION_DURATION_MILLIS = 200;
+    private static final float LOCATION_IMAGE_SIZE_MODIFIER = 2;
+    private final Context mContext;
+    private GrantPermissionsViewHandler.ResultListener mResultListener;
+    private String mGroupName;
+    private Icon mGroupIcon;
+    private CharSequence mGroupMessage;
+    private CharSequence mDetailMessage;
+    private boolean[] mButtonVisibilities;
+    private boolean[] mLocationVisibilities;
+    private SparseIntArray mButtonResIdToNum = new SparseIntArray();
+    private SparseIntArray mLocationResIdToNum = new SparseIntArray();
+    private boolean mIsLocationPermissionDialogActionClicked = false;
+    private LottieDrawable mCoarseOffDrawable = null;
+    private LottieDrawable mCoarseOnDrawable = null;
+    private LottieDrawable mFineOffDrawable = null;
+    private LottieDrawable mFineOnDrawable = null;
+
+    // Views
+    private ViewGroup mRootView = null;
+    private TextView mMessageView = null;
+    private TextView mDetailedMessageView = null;
+    private Button[] mButtons = new Button[NEXT_BUTTON];
+    private View[] mLocationViews = new View[NEXT_LOCATION_DIALOG];
+
+    // Dialog Config
+    private RadioButton mCoarseRadioButton = null;
+    private RadioButton mFineRadioButton = null;
+    private int mSelectedPrecision = 0;
+    private float mLocationAccuracyImageDiameter = 0;
+
+    /**
+     * Constructs a new AutoLocationPermissionPromptView.
+     *
+     * @param context the Context in which the view is created
+     */
+    public AutoLocationPermissionPromptView(Context context) {
+        mContext = context;
+        generateResIdToButtonMap();
+        mLocationAccuracyImageDiameter =
+            mContext.getResources().getDimension(R.dimen.location_accuracy_image_size)
+                    + LOCATION_IMAGE_SIZE_MODIFIER;
+    }
+
+    /**
+     * Sets the ResultListener for this view. The ResultListener will be notified when
+     * the user makes a selection in the permission prompt.
+     *
+     * @param listener the ResultListener to set
+     */
+    public void setResultListener(GrantPermissionsViewHandler.ResultListener listener) {
+        mResultListener = listener;
+    }
+
+    /**
+     * Creates and initializes the custom view for the auto location permission prompt.
+     * This method inflates the layout, sets up various UI elements, and configures their behaviors
+     * such as click listeners and gravity adjustments.
+     */
+    public View createView() {
+        ViewGroup rootView = (ViewGroup) LayoutInflater.from(mContext).inflate(
+                R.layout.auto_grant_permissions_material3, null);
+
+        this.mRootView = rootView;
+
+        int gravity = rootView.requireViewById(R.id.grant_singleton).getForegroundGravity();
+        int verticalGravity = Gravity.VERTICAL_GRAVITY_MASK & gravity;
+        if (mContext instanceof Activity activity) {
+            Window window = activity.getWindow();
+            window.setGravity(Gravity.CENTER_HORIZONTAL | verticalGravity);
+        }
+
+        rootView.requireViewById(R.id.grant_singleton).setOnClickListener(this);
+        rootView.requireViewById(R.id.grant_dialog).setOnClickListener(this);
+
+        mMessageView = rootView.requireViewById(R.id.permission_message);
+        mDetailedMessageView = rootView.requireViewById(R.id.detail_message);
+        mDetailedMessageView.setMovementMethod(LinkMovementMethod.getInstance());
+
+        Button[] buttons = new Button[NEXT_BUTTON];
+        int numButtons = mButtonResIdToNum.size();
+        for (int i = 0; i < numButtons; i++) {
+            Button button = rootView.requireViewById(mButtonResIdToNum.keyAt(i));
+            button.setOnClickListener(this);
+            buttons[mButtonResIdToNum.valueAt(i)] = button;
+        }
+        this.mButtons = buttons;
+
+        View[] locationViews = new View[NEXT_LOCATION_DIALOG];
+        for (int i = 0; i < mLocationResIdToNum.size(); i++) {
+            View locationView = rootView.requireViewById(mLocationResIdToNum.keyAt(i));
+            locationViews[mLocationResIdToNum.valueAt(i)] = locationView;
+        }
+
+        initializeAnimatedImages();
+
+        mCoarseRadioButton = (RadioButton) locationViews[COARSE_RADIO_BUTTON];
+        mFineRadioButton = (RadioButton) locationViews[FINE_RADIO_BUTTON];
+        mCoarseRadioButton.setOnClickListener(this);
+        mFineRadioButton.setOnClickListener(this);
+        this.mLocationViews = locationViews;
+
+        if (mDetailMessage != null) {
+            updateAll();
+        }
+        return rootView;
+    }
+
+    private void initializeAnimatedImages() {
+        mCoarseOffDrawable = getLottieDrawable(R.raw.coarse_loc_off);
+        mCoarseOnDrawable = getLottieDrawable(R.raw.coarse_loc_on);
+        mFineOffDrawable = getLottieDrawable(R.raw.fine_loc_off);
+        mFineOnDrawable = getLottieDrawable(R.raw.fine_loc_on);
+    }
+
+    private LottieDrawable getLottieDrawable(@RawRes int rawResId) {
+        LottieComposition composition = LottieCompositionFactory
+                .fromRawResSync(mContext, rawResId).getValue();
+        if (composition == null) {
+            throw new NullPointerException();
+        }
+
+        float scale = mLocationAccuracyImageDiameter / composition.getBounds().width();
+        LottieDrawable drawable = new LottieDrawable() {
+            @Override
+            public int getIntrinsicHeight() {
+                return ((int) (super.getIntrinsicHeight() * scale));
+            }
+
+            @Override
+            public int getIntrinsicWidth() {
+                return ((int) (super.getIntrinsicWidth() * scale));
+            }
+        };
+        drawable.setComposition(composition);
+        return drawable;
+    }
+
+    /**
+     * Updates the state of the view with the provided parameters. This method is called to refresh
+     * the UI elements with new data, ensuring that the view reflects the latest information.
+     */
+    public void updateState(String groupName, Icon icon,
+            CharSequence message, CharSequence detailMessage, boolean[] buttonVisibilities,
+            boolean[] locationVisibilities, int selectedPrecision) {
+
+        mGroupName = groupName;
+        mGroupIcon = icon;
+        mGroupMessage = message;
+        mDetailMessage = detailMessage;
+        mSelectedPrecision = selectedPrecision;
+        setButtonVisibilities(buttonVisibilities);
+        setLocationVisibilities(locationVisibilities);
+
+        // If the iconView is null, it's likely other related views are also null. Attempting to
+        // update variables in this state could lead to a null object reference and crash the app.
+        if (mMessageView != null) {
+            updateAll();
+        }
+    }
+
+    private void updateAll() {
+        updateDescription();
+        updateDetailDescription();
+        updateButtons();
+        updateLocationVisibilities();
+
+        ChangeBounds growShrinkToNewContentSize = new ChangeBounds();
+        growShrinkToNewContentSize.setDuration(ANIMATION_DURATION_MILLIS);
+        growShrinkToNewContentSize.setInterpolator(
+                AnimationUtils.loadInterpolator(mContext, android.R.interpolator.fast_out_slow_in));
+        TransitionManager.beginDelayedTransition(mRootView, growShrinkToNewContentSize);
+    }
+
+    private void updateLocationVisibilities() {
+        if (mLocationVisibilities[LOCATION_ACCURACY_LAYOUT]) {
+            if (mIsLocationPermissionDialogActionClicked) {
+                return;
+            }
+            mLocationViews[LOCATION_ACCURACY_LAYOUT].setVisibility(View.VISIBLE);
+            for (int i : LOCATION_ACCURACY_DIALOGS) {
+                if (mLocationVisibilities[i]) {
+                    mLocationViews[i].setVisibility(View.VISIBLE);
+                } else {
+                    mLocationViews[i].setVisibility(View.GONE);
+                }
+            }
+
+            if (mLocationVisibilities[DIALOG_WITH_BOTH_LOCATIONS]) {
+                mCoarseRadioButton.setVisibility(View.VISIBLE);
+                mFineRadioButton.setVisibility(View.VISIBLE);
+                if (mSelectedPrecision == 0) {
+                    mFineRadioButton.setChecked(mLocationVisibilities[FINE_RADIO_BUTTON]);
+                    mCoarseRadioButton.setChecked(mLocationVisibilities[COARSE_RADIO_BUTTON]);
+                } else {
+                    mFineRadioButton.setChecked(mSelectedPrecision == FINE_RADIO_BUTTON);
+                    mCoarseRadioButton.setChecked(mSelectedPrecision == COARSE_RADIO_BUTTON);
+                }
+                if (mCoarseRadioButton.isChecked()) {
+                    runLocationAccuracyAnimation(false);
+
+                } else if (mFineRadioButton.isChecked()) {
+                    runLocationAccuracyAnimation(true);
+                }
+            } else if (mLocationVisibilities[DIALOG_WITH_COARSE_LOCATION_ONLY]) {
+                ((ImageView) mLocationViews[DIALOG_WITH_COARSE_LOCATION_ONLY])
+                        .setImageDrawable(mCoarseOnDrawable);
+                mCoarseOnDrawable.start();
+            } else if (mLocationVisibilities[DIALOG_WITH_FINE_LOCATION_ONLY]) {
+                ((ImageView) mLocationViews[DIALOG_WITH_FINE_LOCATION_ONLY])
+                        .setImageDrawable(mFineOnDrawable);
+                mFineOnDrawable.start();
+            }
+        } else {
+            mLocationViews[LOCATION_ACCURACY_LAYOUT].setVisibility(View.GONE);
+            for (int i : LOCATION_ACCURACY_DIALOGS) {
+                mLocationVisibilities[i] = false;
+                mLocationViews[i].setVisibility(View.GONE);
+            }
+        }
+    }
+
+    private void runLocationAccuracyAnimation(boolean isFineSelected) {
+        if (isFineSelected) {
+            mCoarseOnDrawable.stop();
+            mFineOffDrawable.stop();
+            // Sets the drawable to appear to the left, top, right, or bottom of the text
+            mCoarseRadioButton.setCompoundDrawablesWithIntrinsicBounds(
+                    /* left */ null,
+                    /* top */ mCoarseOffDrawable,
+                    /* right */ null,
+                    /* bottom */ null
+            );
+            mFineRadioButton.setCompoundDrawablesWithIntrinsicBounds(
+                    /* left */ null,
+                    /* top */ mFineOnDrawable,
+                    /* right */ null,
+                    /* bottom */ null
+            );
+            mCoarseOffDrawable.start();
+            mFineOnDrawable.start();
+            mFineRadioButton.setTypeface(null, Typeface.BOLD);
+            mCoarseRadioButton.setTypeface(null, Typeface.NORMAL);
+        } else {
+            mCoarseOffDrawable.stop();
+            mFineOnDrawable.stop();
+            mCoarseRadioButton.setCompoundDrawablesWithIntrinsicBounds(
+                    /* left */ null,
+                    /* top */ mCoarseOnDrawable,
+                    /* right */ null,
+                    /* bottom */ null
+            );
+            mFineRadioButton.setCompoundDrawablesWithIntrinsicBounds(
+                    /* left */ null,
+                    /* top */ mFineOffDrawable,
+                    /* right */ null,
+                    /* bottom */ null
+            );
+            mFineOffDrawable.start();
+            mCoarseOnDrawable.start();
+            mCoarseRadioButton.setTypeface(null, Typeface.BOLD);
+            mFineRadioButton.setTypeface(null, Typeface.NORMAL);
+        }
+    }
+
+    private void updateButtons() {
+        for (int i = 0; i < mButtonResIdToNum.size(); i++) {
+            int pos = mButtonResIdToNum.valueAt(i);
+            if (pos < mButtonVisibilities.length && mButtonVisibilities[pos]) {
+                mButtons[pos].setVisibility(View.VISIBLE);
+            } else {
+                mButtons[pos].setVisibility(View.GONE);
+            }
+            if (pos == ALLOW_FOREGROUND_BUTTON && mButtonVisibilities[pos]) {
+                if (mLocationVisibilities[LOCATION_ACCURACY_LAYOUT]
+                        && mLocationVisibilities[DIALOG_WITH_FINE_LOCATION_ONLY]
+                ) {
+                    mButtons[pos].setText(mContext.getResources().getString(
+                            R.string.grant_dialog_button_change_to_precise_location));
+                } else {
+                    mButtons[pos].setText(mContext.getResources().getString(
+                            R.string.grant_dialog_button_allow_foreground));
+                }
+            }
+            if ((pos == DENY_BUTTON || pos == DENY_AND_DONT_ASK_AGAIN_BUTTON)) {
+                if (
+                        mLocationVisibilities[LOCATION_ACCURACY_LAYOUT]
+                                && mLocationVisibilities[DIALOG_WITH_FINE_LOCATION_ONLY]
+                ) {
+                    mButtons[pos].setText(mContext.getResources().getString(
+                            R.string.grant_dialog_button_keey_approximate_location));
+                } else {
+                    mButtons[pos].setText(
+                            mContext.getResources().getString(R.string.grant_dialog_button_deny));
+                }
+            }
+            mButtons[pos].requestLayout();
+        }
+    }
+
+    private void updateDetailDescription() {
+        if (mDetailMessage == null) {
+            mDetailedMessageView.setVisibility(View.GONE);
+        } else {
+            mDetailedMessageView.setText(mDetailMessage);
+            mDetailedMessageView.setVisibility(View.VISIBLE);
+        }
+    }
+
+    private void updateDescription() {
+        mMessageView.setText(mGroupMessage);
+    }
+
+    private void setButtonVisibilities(boolean[] visibilities) {
+        // If GrantPermissionsActivity sent the user directly to settings, button visibilities are
+        // not created. If the activity was then destroyed by the system, once the activity is
+        // recreated to perform onActivityResult, it will try to loadInstanceState in onCreate but
+        // the button visibilities were never set, so they will be null.
+        mButtonVisibilities = visibilities == null ? new boolean[0] : visibilities;
+    }
+
+    private void setLocationVisibilities(boolean[] visibilities) {
+        mLocationVisibilities = visibilities == null ? new boolean[0] : visibilities;
+    }
+
+    @Override
+    public void onClick(View view) {
+        int id = view.getId();
+
+        if (id == R.id.permission_location_accuracy_radio_fine) {
+            if (mSelectedPrecision != FINE_RADIO_BUTTON) {
+                ((RadioButton) mLocationViews[FINE_RADIO_BUTTON]).setChecked(true);
+                mSelectedPrecision = FINE_RADIO_BUTTON;
+                runLocationAccuracyAnimation(true);
+            }
+            return;
+        }
+
+        if (id == R.id.permission_location_accuracy_radio_coarse) {
+            if (mSelectedPrecision != COARSE_RADIO_BUTTON) {
+                ((RadioButton) mLocationViews[COARSE_RADIO_BUTTON]).setChecked(true);
+                mSelectedPrecision = COARSE_RADIO_BUTTON;
+                runLocationAccuracyAnimation(false);
+            }
+            return;
+        }
+
+        if (mLocationVisibilities[LOCATION_ACCURACY_LAYOUT]) {
+            mIsLocationPermissionDialogActionClicked = true;
+        }
+
+        if (id == R.id.grant_singleton) {
+            mResultListener.onPermissionGrantResult(mGroupName, CANCELED);
+            return;
+        }
+
+        List<String> affectedForegroundPermissions = new ArrayList<>();
+        if (mLocationVisibilities[DIALOG_WITH_BOTH_LOCATIONS]) {
+            if (((RadioGroup) mLocationViews[DIALOG_WITH_BOTH_LOCATIONS])
+                    .getCheckedRadioButtonId() == R.id.permission_location_accuracy_radio_coarse) {
+
+                affectedForegroundPermissions.add(ACCESS_COARSE_LOCATION);
+            } else if (((RadioGroup) mLocationViews[DIALOG_WITH_BOTH_LOCATIONS])
+                    .getCheckedRadioButtonId() == R.id.permission_location_accuracy_radio_fine) {
+
+                affectedForegroundPermissions.add(ACCESS_FINE_LOCATION);
+                affectedForegroundPermissions.add(ACCESS_COARSE_LOCATION);
+            }
+        } else if (mLocationVisibilities[DIALOG_WITH_FINE_LOCATION_ONLY]) {
+            affectedForegroundPermissions.add(ACCESS_FINE_LOCATION);
+        } else if (mLocationVisibilities[DIALOG_WITH_COARSE_LOCATION_ONLY]) {
+            affectedForegroundPermissions.add(ACCESS_COARSE_LOCATION);
+        }
+
+
+        Map<Integer, Integer> buttonToResultValueMap = initializeButtonToResultValueMap();
+        int resultValue = buttonToResultValueMap.getOrDefault(
+                mButtonResIdToNum.get(id, -1), -1);
+        if (resultValue != -1) {
+            if (resultValue != DENIED_MORE) {
+                view.performAccessibilityAction(
+                        AccessibilityNodeInfo.ACTION_CLEAR_ACCESSIBILITY_FOCUS, null);
+            }
+            mResultListener.onPermissionGrantResult(mGroupName, affectedForegroundPermissions,
+                    resultValue);
+        }
+    }
+
+    private Map<Integer, Integer> initializeButtonToResultValueMap() {
+        Map<Integer, Integer> map = new HashMap<>();
+        map.put(ALLOW_ALL_BUTTON, GRANTED_ALWAYS);
+        map.put(ALLOW_BUTTON, GRANTED_ALWAYS);
+        map.put(ALLOW_FOREGROUND_BUTTON, GRANTED_FOREGROUND_ONLY);
+        map.put(ALLOW_ALWAYS_BUTTON, GRANTED_ALWAYS);
+        map.put(ALLOW_ONE_TIME_BUTTON, GRANTED_ONE_TIME);
+        map.put(ALLOW_SELECTED_BUTTON, GRANTED_USER_SELECTED);
+        map.put(DONT_ALLOW_MORE_SELECTED_BUTTON, DENIED_MORE);
+        map.put(DENY_BUTTON, DENIED);
+        map.put(NO_UPGRADE_BUTTON, DENIED);
+        map.put(NO_UPGRADE_OT_BUTTON, DENIED);
+        map.put(DENY_AND_DONT_ASK_AGAIN_BUTTON, DENIED_DO_NOT_ASK_AGAIN);
+        map.put(NO_UPGRADE_AND_DONT_ASK_AGAIN_BUTTON, DENIED_DO_NOT_ASK_AGAIN);
+        map.put(NO_UPGRADE_OT_AND_DONT_ASK_AGAIN_BUTTON, DENIED_DO_NOT_ASK_AGAIN);
+        return map;
+    }
+
+    private void generateResIdToButtonMap() {
+        mButtonResIdToNum.put(R.id.permission_allow_button, ALLOW_BUTTON);
+        mButtonResIdToNum.put(
+                R.id.permission_allow_foreground_only_button,
+                ALLOW_FOREGROUND_BUTTON
+        );
+        mButtonResIdToNum.put(R.id.permission_deny_button, DENY_BUTTON);
+        mButtonResIdToNum.put(
+                R.id.permission_deny_and_dont_ask_again_button,
+                DENY_AND_DONT_ASK_AGAIN_BUTTON
+        );
+        mButtonResIdToNum.put(R.id.permission_allow_one_time_button, ALLOW_ONE_TIME_BUTTON);
+        mButtonResIdToNum.put(R.id.permission_no_upgrade_button, NO_UPGRADE_BUTTON);
+        mButtonResIdToNum.put(
+                R.id.permission_no_upgrade_and_dont_ask_again_button,
+                NO_UPGRADE_AND_DONT_ASK_AGAIN_BUTTON
+        );
+        mButtonResIdToNum.put(
+                R.id.permission_no_upgrade_one_time_button,
+                NO_UPGRADE_OT_BUTTON
+        );
+        mButtonResIdToNum.put(
+                R.id.permission_no_upgrade_one_time_and_dont_ask_again_button,
+                NO_UPGRADE_OT_AND_DONT_ASK_AGAIN_BUTTON
+        );
+        mButtonResIdToNum.put(R.id.permission_allow_all_button, ALLOW_ALL_BUTTON);
+        mButtonResIdToNum.put(R.id.permission_allow_selected_button, ALLOW_SELECTED_BUTTON);
+        mButtonResIdToNum.put(
+                R.id.permission_dont_allow_more_selected_button,
+                DONT_ALLOW_MORE_SELECTED_BUTTON
+        );
+
+        mLocationResIdToNum.put(R.id.permission_location_accuracy, LOCATION_ACCURACY_LAYOUT);
+        mLocationResIdToNum.put(
+                R.id.permission_location_accuracy_radio_fine,
+                FINE_RADIO_BUTTON
+        );
+        mLocationResIdToNum.put(
+                R.id.permission_location_accuracy_radio_coarse,
+                COARSE_RADIO_BUTTON
+        );
+        mLocationResIdToNum.put(
+                R.id.permission_location_accuracy_radio_group,
+                DIALOG_WITH_BOTH_LOCATIONS
+        );
+        mLocationResIdToNum.put(
+                R.id.permission_location_accuracy_fine_only,
+                DIALOG_WITH_FINE_LOCATION_ONLY
+        );
+        mLocationResIdToNum.put(
+                R.id.permission_location_accuracy_coarse_only,
+                DIALOG_WITH_COARSE_LOCATION_ONLY
+        );
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/GrantPermissionsAutoViewHandler.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/GrantPermissionsAutoViewHandler.java
index 9f2e54b2f..300c108f9 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/GrantPermissionsAutoViewHandler.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/GrantPermissionsAutoViewHandler.java
@@ -30,6 +30,7 @@ import android.app.AlertDialog;
 import android.content.Context;
 import android.graphics.drawable.Icon;
 import android.os.Bundle;
+import android.util.Log;
 import android.view.View;
 import android.view.WindowManager;
 
@@ -37,6 +38,7 @@ import com.android.car.ui.AlertDialogBuilder;
 import com.android.car.ui.recyclerview.CarUiContentListItem;
 import com.android.car.ui.recyclerview.CarUiListItem;
 import com.android.car.ui.recyclerview.CarUiListItemAdapter;
+import com.android.permission.flags.Flags;
 import com.android.permissioncontroller.R;
 import com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler;
 
@@ -44,6 +46,7 @@ import java.util.ArrayList;
 import java.util.List;
 import java.util.stream.IntStream;
 
+
 /**
  * A {@link GrantPermissionsViewHandler} that is specific for the auto use-case. In this case, the
  * permissions dialog is displayed using car-ui-lib {@link AlertDialogBuilder}
@@ -55,11 +58,16 @@ public class GrantPermissionsAutoViewHandler implements GrantPermissionsViewHand
     private static final String ARG_GROUP_ICON = "ARG_GROUP_ICON";
     private static final String ARG_GROUP_MESSAGE = "ARG_GROUP_MESSAGE";
     private static final String ARG_GROUP_DETAIL_MESSAGE = "ARG_GROUP_DETAIL_MESSAGE";
-    private static final String ARG_BUTTON_VISIBILITIES = "ARG_BUTTON_VISIBILITIES";
+    private static final String ARG_DIALOG_BUTTON_VISIBILITIES = "ARG_DIALOG_BUTTON_VISIBILITIES";
+    private static final String ARG_DIALOG_LOCATION_VISIBILITIES =
+            "ARG_DIALOG_LOCATION_VISIBILITIES";
+    private static final String ARG_DIALOG_SELECTED_PRECISION = "ARG_DIALOG_SELECTED_PRECISION";
+    private static final String LOG_TAG = GrantPermissionsAutoViewHandler.class.getSimpleName();
 
     private final Context mContext;
     private ResultListener mResultListener;
     private AlertDialog mDialog;
+    private AutoLocationPermissionPromptView mAutoLocationPermissionPromptView;
     private String mGroupName;
     private int mGroupCount;
     private int mGroupIndex;
@@ -68,20 +76,34 @@ public class GrantPermissionsAutoViewHandler implements GrantPermissionsViewHand
     private CharSequence mDetailMessage;
     private boolean[] mButtonVisibilities;
 
+    // Tracks the selected location accuracy option.
+    // States: 0 (no option), 1 (fine), 2 (coarse)
+    private int mSelectedPrecision = 0;
+
+
     public GrantPermissionsAutoViewHandler(Context context, String appPackageName) {
         mContext = context;
+        mAutoLocationPermissionPromptView = new AutoLocationPermissionPromptView(context);
     }
 
+
     @Override
     public GrantPermissionsViewHandler setResultListener(ResultListener listener) {
         mResultListener = listener;
+        mAutoLocationPermissionPromptView.setResultListener(listener);
         return this;
     }
 
     @Override
     public View createView() {
-        // We will use a system dialog instead of a locally defined view.
-        return new View(mContext);
+        Log.d(LOG_TAG, "enableCoarseFineLocationPromptForAaos flag set to: "
+                + Flags.enableCoarseFineLocationPromptForAaos());
+        if (Flags.enableCoarseFineLocationPromptForAaos()) {
+            return mAutoLocationPermissionPromptView.createView();
+        } else {
+            // We will use a system dialog instead of a locally defined view.
+            return new View(mContext);
+        }
     }
 
     @Override
@@ -104,7 +126,13 @@ public class GrantPermissionsAutoViewHandler implements GrantPermissionsViewHand
         mDetailMessage = detailMessage;
         setButtonVisibilities(buttonVisibilities);
 
-        update();
+        if (Flags.enableCoarseFineLocationPromptForAaos()) {
+            mAutoLocationPermissionPromptView.updateState(groupName,
+                    icon, message, detailMessage, buttonVisibilities, locationVisibilities,
+                    mSelectedPrecision);
+        } else {
+            update();
+        }
     }
 
     private void update() {
@@ -192,7 +220,8 @@ public class GrantPermissionsAutoViewHandler implements GrantPermissionsViewHand
         arguments.putParcelable(ARG_GROUP_ICON, mGroupIcon);
         arguments.putCharSequence(ARG_GROUP_MESSAGE, mGroupMessage);
         arguments.putCharSequence(ARG_GROUP_DETAIL_MESSAGE, mDetailMessage);
-        arguments.putBooleanArray(ARG_BUTTON_VISIBILITIES, mButtonVisibilities);
+        arguments.putBooleanArray(ARG_DIALOG_BUTTON_VISIBILITIES, mButtonVisibilities);
+        arguments.putInt(ARG_DIALOG_SELECTED_PRECISION, mSelectedPrecision);
     }
 
     @Override
@@ -203,17 +232,30 @@ public class GrantPermissionsAutoViewHandler implements GrantPermissionsViewHand
         mGroupCount = savedInstanceState.getInt(ARG_GROUP_COUNT);
         mGroupIndex = savedInstanceState.getInt(ARG_GROUP_INDEX);
         mDetailMessage = savedInstanceState.getCharSequence(ARG_GROUP_DETAIL_MESSAGE);
-        setButtonVisibilities(savedInstanceState.getBooleanArray(ARG_BUTTON_VISIBILITIES));
+        setButtonVisibilities(savedInstanceState.getBooleanArray(ARG_DIALOG_BUTTON_VISIBILITIES));
+        boolean[] locationVisibilities =
+                savedInstanceState.getBooleanArray(ARG_DIALOG_LOCATION_VISIBILITIES);
+        mSelectedPrecision = savedInstanceState.getInt(ARG_DIALOG_SELECTED_PRECISION);
 
-        update();
+        if (Flags.enableCoarseFineLocationPromptForAaos()) {
+            mAutoLocationPermissionPromptView.updateState(mGroupName,
+                    mGroupIcon, mGroupMessage, mDetailMessage,
+                    mButtonVisibilities, locationVisibilities, mSelectedPrecision);
+        } else {
+            update();
+        }
     }
 
+
     private void setButtonVisibilities(boolean[] visibilities) {
         // If GrantPermissionsActivity sent the user directly to settings, button visibilities are
         // not created. If the activity was then destroyed by the system, once the activity is
         // recreated to perform onActivityResult, it will try to loadInstanceState in onCreate but
         // the button visibilities were never set, so they will be null.
         mButtonVisibilities = visibilities == null ? new boolean[0] : visibilities;
+        if (visibilities == null) {
+            Log.e(LOG_TAG, "Button visibilities are null");
+        }
     }
 
     @Override
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/dashboard/AutoPermissionHistoryPreference.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/dashboard/AutoPermissionHistoryPreference.kt
index 08460178c..2d14260a2 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/dashboard/AutoPermissionHistoryPreference.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/dashboard/AutoPermissionHistoryPreference.kt
@@ -61,7 +61,7 @@ class AutoPermissionHistoryPreference(
                     accessEndTime = historyPreferenceData.accessEndTime,
                     accessStartTime = historyPreferenceData.accessStartTime,
                     showingAttribution = historyPreferenceData.showingAttribution,
-                    attributionTags = historyPreferenceData.attributionTags
+                    attributionTags = historyPreferenceData.attributionTags.toSet()
                 )
             )
             true
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/dashboard/AutoPermissionUsageFragment.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/dashboard/AutoPermissionUsageFragment.kt
index c11129514..9f39bd785 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/dashboard/AutoPermissionUsageFragment.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/auto/dashboard/AutoPermissionUsageFragment.kt
@@ -13,16 +13,12 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-@file:Suppress("DEPRECATION")
-
 package com.android.permissioncontroller.permission.ui.auto.dashboard
 
-import android.app.Activity
-import android.app.Application
-import android.app.role.RoleManager
-import android.content.Context
+import android.Manifest
 import android.os.Build
 import android.os.Bundle
+import android.util.Log
 import androidx.annotation.RequiresApi
 import androidx.lifecycle.ViewModelProvider
 import com.android.car.ui.preference.CarUiPreference
@@ -32,45 +28,38 @@ import com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_
 import com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_USAGE_FRAGMENT_INTERACTION__ACTION__SHOW_SYSTEM_CLICKED
 import com.android.permissioncontroller.R
 import com.android.permissioncontroller.auto.AutoSettingsFrameFragment
-import com.android.permissioncontroller.permission.model.legacy.PermissionApps.AppDataLoader
-import com.android.permissioncontroller.permission.model.legacy.PermissionApps.PermissionApp
-import com.android.permissioncontroller.permission.model.livedatatypes.PermGroupPackagesUiInfo
-import com.android.permissioncontroller.permission.model.v31.AppPermissionUsage
-import com.android.permissioncontroller.permission.model.v31.PermissionUsages
-import com.android.permissioncontroller.permission.model.v31.PermissionUsages.PermissionsUsagesChangeCallback
-import com.android.permissioncontroller.permission.ui.legacy.PermissionUsageViewModelFactoryLegacy
-import com.android.permissioncontroller.permission.ui.legacy.PermissionUsageViewModelLegacy
-import com.android.permissioncontroller.permission.ui.legacy.PermissionUsageViewModelLegacy.PermissionGroupWithUsageCount
-import com.android.permissioncontroller.permission.ui.model.ManagePermissionsViewModel
 import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageControlPreferenceUtils
-import com.android.permissioncontroller.permission.utils.Utils
+import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsageViewModel
+import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsageViewModelFactory
+import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsagesUiState
 
 @RequiresApi(Build.VERSION_CODES.S)
-class AutoPermissionUsageFragment : AutoSettingsFrameFragment(), PermissionsUsagesChangeCallback {
+class AutoPermissionUsageFragment : AutoSettingsFrameFragment() {
 
     companion object {
+        private val LOG_TAG = AutoPermissionUsageFragment::class.simpleName
         private const val KEY_SESSION_ID = "_session_id"
+        private val PERMISSION_GROUP_ORDER: Map<String, Int> =
+            java.util.Map.of(
+                Manifest.permission_group.LOCATION,
+                0,
+                Manifest.permission_group.CAMERA,
+                1,
+                Manifest.permission_group.MICROPHONE,
+                2
+            )
+        private const val DEFAULT_ORDER: Int = 3
     }
 
     private val SESSION_ID_KEY = (AutoPermissionUsageFragment::class.java.name + KEY_SESSION_ID)
 
-    private lateinit var permissionUsages: PermissionUsages
-    private lateinit var usageViewModel: PermissionUsageViewModelLegacy
-    private lateinit var managePermissionsViewModel: ManagePermissionsViewModel
-
-    private var appPermissionUsages: List<AppPermissionUsage> = listOf()
-    private var permissionGroups: List<PermGroupPackagesUiInfo> = listOf()
     private var showSystem = false
-
-    // Auto currently doesn't show last 7 days due to the UX constraint that there is no pattern to
-    // support multiple actions (showSystem & show7Days). Support will likely be added once this
-    // pattern is resolved.
-    private val show7Days = false
     private var finishedInitialLoad = false
     private var hasSystemApps = false
 
     /** Unique Id of a request */
     private var sessionId: Long = 0
+    private lateinit var mViewModel: PermissionUsageViewModel
 
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
@@ -80,26 +69,10 @@ class AutoPermissionUsageFragment : AutoSettingsFrameFragment(), PermissionsUsag
                 ?: (arguments?.getLong(Constants.EXTRA_SESSION_ID, Constants.INVALID_SESSION_ID)
                     ?: Constants.INVALID_SESSION_ID)
 
-        val context: Context = preferenceManager.getContext()
-        permissionUsages = PermissionUsages(context)
-        val roleManager = Utils.getSystemServiceSafe(context, RoleManager::class.java)
-        val application: Application = requireActivity().getApplication()
-        val managePermissionsViewModelFactory =
-            ViewModelProvider.AndroidViewModelFactory.getInstance(application)
-        managePermissionsViewModel =
-            ViewModelProvider(this, managePermissionsViewModelFactory)[
-                ManagePermissionsViewModel::class.java]
-        val usageViewModelFactory = PermissionUsageViewModelFactoryLegacy(roleManager)
-        usageViewModel =
-            ViewModelProvider(this, usageViewModelFactory)[
-                PermissionUsageViewModelLegacy::class.java]
-
-        managePermissionsViewModel.standardPermGroupsLiveData.observe(
-            this,
-            this::onPermissionGroupsChanged
-        )
+        val factory = PermissionUsageViewModelFactory(requireActivity().application, this, Bundle())
+        mViewModel = ViewModelProvider(this, factory)[PermissionUsageViewModel::class.java]
+        mViewModel.permissionUsagesUiLiveData.observe(this, this::updateAllUI)
         setLoading(true)
-        reloadData()
     }
 
     override fun onSaveInstanceState(outState: Bundle) {
@@ -107,13 +80,8 @@ class AutoPermissionUsageFragment : AutoSettingsFrameFragment(), PermissionsUsag
         outState.putLong(SESSION_ID_KEY, sessionId)
     }
 
-    private fun onPermissionGroupsChanged(permissionGroups: List<PermGroupPackagesUiInfo>) {
-        this.permissionGroups = permissionGroups
-        updateUI()
-    }
-
     override fun onCreatePreferences(bundlle: Bundle?, s: String?) {
-        preferenceScreen = preferenceManager.createPreferenceScreen(context!!)
+        preferenceScreen = preferenceManager.createPreferenceScreen(requireContext())
     }
 
     private fun updateSystemToggle() {
@@ -126,9 +94,9 @@ class AutoPermissionUsageFragment : AutoSettingsFrameFragment(), PermissionsUsag
         }
         showSystem = !showSystem
         updateAction()
-        updateUI()
     }
 
+    /** Creates Show/Hide system button if necessary. */
     private fun updateAction() {
         if (!hasSystemApps) {
             setAction(null, null)
@@ -140,100 +108,56 @@ class AutoPermissionUsageFragment : AutoSettingsFrameFragment(), PermissionsUsag
             } else {
                 getString(R.string.menu_show_system)
             }
-        setAction(label) { updateSystemToggle() }
-    }
-
-    /** Reloads the data to show. */
-    private fun reloadData() {
-        usageViewModel.loadPermissionUsages(
-            requireActivity().getLoaderManager(),
-            permissionUsages,
-            this
-        )
-        if (finishedInitialLoad) {
-            setLoading(false)
+        setAction(label) {
+            mViewModel.updateShowSystem(!showSystem)
+            updateSystemToggle()
         }
     }
 
-    override fun onPermissionUsagesChanged() {
-        if (permissionUsages.usages.isEmpty()) {
-            return
-        }
-        appPermissionUsages = ArrayList(permissionUsages.usages)
-        updateUI()
-    }
-
-    private fun updateUI() {
-        if (permissionGroups.isEmpty() || appPermissionUsages.isEmpty()) {
+    private fun updateAllUI(uiData: PermissionUsagesUiState) {
+        Log.v(LOG_TAG, "Privacy dashboard data = $uiData")
+        if (activity == null || uiData is PermissionUsagesUiState.Loading) {
             return
         }
         getPreferenceScreen().removeAll()
-
-        val permissionUsagesUiData =
-            usageViewModel.buildPermissionUsagesUiData(
-                appPermissionUsages,
-                show7Days,
-                showSystem,
-                requireContext()
-            )
-        val permissionApps = permissionUsagesUiData.permissionApps
-        val displayShowSystemToggle = permissionUsagesUiData.displayShowSystemToggle
-
-        if (hasSystemApps != displayShowSystemToggle) {
-            hasSystemApps = displayShowSystemToggle
+        val permissionUsagesUiData = uiData as PermissionUsagesUiState.Success
+        if (hasSystemApps != permissionUsagesUiData.containsSystemAppUsage) {
+            hasSystemApps = permissionUsagesUiData.containsSystemAppUsage
             updateAction()
         }
 
-        val permissionGroupWithUsageCounts: List<PermissionGroupWithUsageCount> =
-            permissionUsagesUiData.orderedPermissionGroupsWithUsageCount
-
-        addUIContent(permissionGroupWithUsageCounts, permissionApps)
-    }
+        val permissionGroupWithUsageCounts = permissionUsagesUiData.permissionGroupUsageCount
+        val permissionGroupWithUsageCountsEntries = permissionGroupWithUsageCounts.entries.toList()
 
-    /** Use the usages and permApps that are previously constructed to add UI content to the page */
-    private fun addUIContent(
-        permissionGroupWithUsageCounts: List<PermissionGroupWithUsageCount>,
-        permApps: java.util.ArrayList<PermissionApp>
-    ) {
-        AppDataLoader(context) {
-                // Show permission groups with permissions granted to an app, including groups
-                // where the permission is only granted to a system app. This still excludes groups
-                // that don't have grants from any apps. Showing the same groups regardless of
-                // whether showSystem is selected avoids permission groups hiding and appearing,
-                // which is a confusing user experience.
-                val usedPermissionGroups =
-                    permissionGroups
-                        .filter {
-                            (it.nonSystemUserSetOrPreGranted > 0) or
-                                (it.systemUserSetOrPreGranted > 0)
-                        }
-                        .filterNot { it.onlyShellPackageGranted }
-
-                for (i in permissionGroupWithUsageCounts.indices) {
-                    val groupName = permissionGroupWithUsageCounts[i].permGroup
-                    val count = permissionGroupWithUsageCounts[i].appCount
-                    if ((usedPermissionGroups.filter { it.name == groupName }).isEmpty()) {
-                        continue
-                    }
-                    val permissionUsagePreference = CarUiPreference(requireContext())
-                    PermissionUsageControlPreferenceUtils.initPreference(
-                        permissionUsagePreference,
-                        requireContext(),
-                        groupName,
-                        count,
-                        showSystem,
-                        sessionId,
-                        show7Days
+        permissionGroupWithUsageCountsEntries.sortedWith(
+            Comparator.comparing { permissionGroupWithUsageCount: Map.Entry<String, Int> ->
+                    PERMISSION_GROUP_ORDER.getOrDefault(
+                        permissionGroupWithUsageCount.key,
+                        DEFAULT_ORDER
                     )
-                    getPreferenceScreen().addPreference(permissionUsagePreference)
                 }
-                finishedInitialLoad = true
-                setLoading(false)
-                val activity: Activity? = activity
-                if (activity != null) {
-                    permissionUsages.stopLoader(activity.loaderManager)
+                .thenComparing { permissionGroupWithUsageCount: Map.Entry<String, Int> ->
+                    mViewModel.getPermissionGroupLabel(
+                        requireContext(),
+                        permissionGroupWithUsageCount.key
+                    )
                 }
-            }
-            .execute(*permApps.toTypedArray())
+        )
+
+        for (i in permissionGroupWithUsageCountsEntries.indices) {
+            val permissionUsagePreference = CarUiPreference(requireContext())
+            PermissionUsageControlPreferenceUtils.initPreference(
+                permissionUsagePreference,
+                requireContext(),
+                permissionGroupWithUsageCountsEntries[i].key,
+                permissionGroupWithUsageCountsEntries[i].value,
+                showSystem,
+                sessionId,
+                false
+            )
+            getPreferenceScreen().addPreference(permissionUsagePreference)
+        }
+        finishedInitialLoad = true
+        setLoading(false)
     }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AllAppPermissionsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AllAppPermissionsFragment.java
index a09312a60..81de139e4 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AllAppPermissionsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AllAppPermissionsFragment.java
@@ -36,7 +36,6 @@ import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.lifecycle.ViewModelProvider;
 import androidx.preference.Preference;
-import androidx.preference.PreferenceCategory;
 import androidx.preference.PreferenceGroup;
 
 import com.android.permissioncontroller.R;
@@ -229,7 +228,7 @@ public final class AllAppPermissionsFragment extends SettingsWithLargeHeader {
         }
         PreferenceGroup pref = findPreference(groupName);
         if (pref == null) {
-            pref = new PreferenceCategory(getPreferenceManager().getContext());
+            pref = new PermissionPreferenceCategory(getPreferenceManager().getContext());
             pref.setKey(groupName);
             pref.setTitle(KotlinUtils.INSTANCE.getPermGroupLabel(getContext(), groupName));
             getPreferenceScreen().addPreference(pref);
@@ -251,7 +250,7 @@ public final class AllAppPermissionsFragment extends SettingsWithLargeHeader {
                     getActivity().getApplication(), mPackageName, groupName, mUser, false);
             pref = new MyMultiTargetSwitchPreference(context, permName, appPermGroup);
         } else {
-            pref = new Preference(context);
+            pref = new PermissionPreference(context);
         }
         pref.setIcon(KotlinUtils.INSTANCE.getPermInfoIcon(context, permName));
         pref.setTitle(KotlinUtils.INSTANCE.getPermInfoLabel(context, permName));
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AllAppPermissionsWrapperFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AllAppPermissionsWrapperFragment.java
index 354081cb5..84f1b8b2b 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AllAppPermissionsWrapperFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AllAppPermissionsWrapperFragment.java
@@ -43,4 +43,9 @@ public class AllAppPermissionsWrapperFragment extends PermissionsCollapsingToolb
                 packageName, filterGroup, userHandle));
         return instance;
     }
+
+    @Override
+    protected boolean isPermissionSettings() {
+        return true;
+    }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionGroupsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionGroupsFragment.java
index eff5738fc..969ac17eb 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionGroupsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionGroupsFragment.java
@@ -79,7 +79,6 @@ import com.android.permissioncontroller.permission.utils.StringUtils;
 import com.android.permissioncontroller.permission.utils.Utils;
 import com.android.permissioncontroller.permission.utils.v35.MultiDeviceUtils;
 import com.android.settingslib.HelpUtils;
-import com.android.settingslib.widget.FooterPreference;
 
 import java.text.Collator;
 import java.time.Instant;
@@ -185,9 +184,8 @@ public final class AppPermissionGroupsFragment extends SettingsWithLargeHeader i
             Context context = getPreferenceManager().getContext();
             mPermissionUsages = new PermissionUsages(context);
 
-            long aggregateDataFilterBeginDays = KotlinUtils.INSTANCE.is7DayToggleEnabled()
-                    ? AppPermissionGroupsViewModel.AGGREGATE_DATA_FILTER_BEGIN_DAYS_7 :
-                    AppPermissionGroupsViewModel.AGGREGATE_DATA_FILTER_BEGIN_DAYS_1;
+            long aggregateDataFilterBeginDays =
+                    AppPermissionGroupsViewModel.AGGREGATE_DATA_FILTER_BEGIN_DAYS_7;
 
             long filterTimeBeginMillis = Math.max(System.currentTimeMillis()
                             - DAYS.toMillis(aggregateDataFilterBeginDays),
@@ -252,6 +250,12 @@ public final class AppPermissionGroupsFragment extends SettingsWithLargeHeader i
                         mPackageName, mUser));
                 return true;
             }
+
+            case MENU_ALLOW_RESTRICTED_SETTINGS: {
+                mViewModel.clearRestriction();
+                getActivity().invalidateOptionsMenu();
+                return true;
+            }
         }
         return super.onOptionsItemSelected(item);
     }
@@ -266,6 +270,20 @@ public final class AppPermissionGroupsFragment extends SettingsWithLargeHeader i
                         getClass().getName());
             }
         }
+
+        if (SdkLevel.isAtLeastT() && !SdkLevel.isAtLeastV()
+                && Flags.enhancedConfirmationBackportEnabled()) {
+            menu.add(Menu.NONE, MENU_ALLOW_RESTRICTED_SETTINGS, Menu.NONE,
+                    R.string.allow_restricted_settings);
+        }
+    }
+
+    @Override
+    public void onPrepareOptionsMenu(@NonNull Menu menu) {
+        final MenuItem allowRestrictedSettingsMenu = menu.findItem(MENU_ALLOW_RESTRICTED_SETTINGS);
+        if (allowRestrictedSettingsMenu != null) {
+            allowRestrictedSettingsMenu.setVisible(mViewModel.isClearRestrictedAllowed());
+        }
     }
 
     private static void bindUi(SettingsWithLargeHeader fragment, String packageName,
@@ -432,11 +450,11 @@ public final class AppPermissionGroupsFragment extends SettingsWithLargeHeader i
     private void addAutoRevokePreferences(PreferenceScreen screen) {
         Context context = screen.getPreferenceManager().getContext();
 
-        PreferenceCategory autoRevokeCategory = new PreferenceCategory(context);
+        PreferenceCategory autoRevokeCategory = new PermissionPreferenceCategory(context);
         autoRevokeCategory.setKey(AUTO_REVOKE_CATEGORY_KEY);
         screen.addPreference(autoRevokeCategory);
 
-        SwitchPreference autoRevokeSwitch = new SwitchPreference(context);
+        SwitchPreference autoRevokeSwitch = new PermissionSwitchPreference(context);
         autoRevokeSwitch.setOnPreferenceClickListener((preference) -> {
             mViewModel.setAutoRevoke(autoRevokeSwitch.isChecked());
             return true;
@@ -459,8 +477,9 @@ public final class AppPermissionGroupsFragment extends SettingsWithLargeHeader i
         autoRevokeSwitch.setKey(AUTO_REVOKE_SWITCH_KEY);
         autoRevokeCategory.addPreference(autoRevokeSwitch);
 
-        Preference autoRevokeSummary = SdkLevel.isAtLeastS() ? new FooterPreference(context)
-                : new Preference(context);
+        Preference autoRevokeSummary =
+                SdkLevel.isAtLeastS() ? new PermissionFooterPreference(context)
+                : new PermissionPreference(context);
         autoRevokeSummary.setIcon(Utils.applyTint(getActivity(), R.drawable.ic_info_outline,
                 android.R.attr.colorControlNormal));
         autoRevokeSummary.setKey(AUTO_REVOKE_SUMMARY_KEY);
@@ -503,7 +522,10 @@ public final class AppPermissionGroupsFragment extends SettingsWithLargeHeader i
         }
 
         groupLabels.sort(mCollator);
-        if (groupLabels.isEmpty()) {
+        autoRevokeSummary.setVisible(true);
+        if (state.isExemptBySystem()) {
+            autoRevokeSummary.setVisible(false);
+        } else if (groupLabels.isEmpty()) {
             autoRevokeSummary.setSummary(R.string.auto_revoke_summary);
         } else {
             autoRevokeSummary.setSummary(getString(R.string.auto_revoke_summary_with_permissions,
@@ -523,7 +545,7 @@ public final class AppPermissionGroupsFragment extends SettingsWithLargeHeader i
     }
 
     private Preference setUpCustomPermissionsScreen(Context context, int count, String category) {
-        final Preference extraPerms = new Preference(context);
+        final Preference extraPerms = new PermissionPreference(context);
         extraPerms.setIcon(Utils.applyTint(getActivity(), R.drawable.ic_toc,
                 android.R.attr.colorControlNormal));
         extraPerms.setTitle(R.string.additional_permissions);
@@ -540,7 +562,7 @@ public final class AppPermissionGroupsFragment extends SettingsWithLargeHeader i
 
     private void setNoPermissionPreference(PreferenceCategory category, @StringRes int stringId,
             Context context) {
-        Preference empty = new Preference(context);
+        Preference empty = new PermissionPreference(context);
         empty.setKey(getString(stringId));
         empty.setTitle(empty.getKey());
         empty.setSelectable(false);
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionGroupsWrapperFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionGroupsWrapperFragment.java
index 5d7a90106..951ade811 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionGroupsWrapperFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionGroupsWrapperFragment.java
@@ -29,4 +29,9 @@ public class AppPermissionGroupsWrapperFragment extends PermissionsCollapsingToo
     public PreferenceFragmentCompat createPreferenceFragment() {
         return new AppPermissionGroupsFragment();
     }
+
+    @Override
+    protected boolean isPermissionSettings() {
+        return true;
+    }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionWrapperFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionWrapperFragment.java
index 4655d9afb..8650d99fc 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionWrapperFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionWrapperFragment.java
@@ -19,6 +19,8 @@ package com.android.permissioncontroller.permission.ui.handheld;
 import androidx.annotation.NonNull;
 import androidx.preference.PreferenceFragmentCompat;
 
+import com.android.permissioncontroller.permission.compat.AppPermissionFragmentCompat;
+
 /**
  * Wrapper over AppPermissionFragment
  */
@@ -27,6 +29,11 @@ public class AppPermissionWrapperFragment extends PermissionsCollapsingToolbarBa
     @NonNull
     @Override
     public PreferenceFragmentCompat createPreferenceFragment() {
-        return new AppPermissionFragment();
+        return AppPermissionFragmentCompat.createFragment();
+    }
+
+    @Override
+    protected boolean isPermissionSettings() {
+        return true;
     }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreference.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/BasePermissionReviewPreference.java
similarity index 98%
rename from PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreference.java
rename to PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/BasePermissionReviewPreference.java
index 1089fcac2..a763d5f92 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreference.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/BasePermissionReviewPreference.java
@@ -48,7 +48,7 @@ import com.android.settingslib.RestrictedLockUtils.EnforcedAdmin;
 /**
  * A preference for representing a permission group requested by an app.
  */
-class PermissionPreference extends MultiTargetSwitchPreference {
+class BasePermissionReviewPreference extends MultiTargetSwitchPreference {
 
     /**
      * holds state for the permission group represented by this preference.
@@ -114,7 +114,7 @@ class PermissionPreference extends MultiTargetSwitchPreference {
         void onBackgroundAccessChosen(String key, int chosenItem);
     }
 
-    PermissionPreference(PreferenceFragmentCompat fragment, LightAppPermGroup group,
+    BasePermissionReviewPreference(PreferenceFragmentCompat fragment, LightAppPermGroup group,
             PermissionPreferenceChangeListener callbacks,
             ReviewPermissionsViewModel reviewPermissionsViewModel) {
         super(fragment.getPreferenceManager().getContext());
@@ -417,7 +417,7 @@ class PermissionPreference extends MultiTargetSwitchPreference {
      *     <li>{@code showDefaultDenyDialog}</li>
      *     <li>{@link DefaultDenyDialog#onCreateDialog}</li>
      *     <li>{@link PermissionPreferenceOwnerFragment#onDenyAnyWay}</li>
-     *     <li>{@link PermissionPreference#onDenyAnyWay}</li>
+     *     <li>{@link BasePermissionReviewPreference#onDenyAnyWay}</li>
      * </ol>
      *
      * @param changeTarget Whether background or foreground should be changed
@@ -448,7 +448,7 @@ class PermissionPreference extends MultiTargetSwitchPreference {
      *     <li>{@code showBackgroundChooserDialog}</li>
      *     <li>{@link BackgroundAccessChooser#onCreateDialog}</li>
      *     <li>{@link PermissionPreferenceOwnerFragment#onBackgroundAccessChosen}</li>
-     *     <li>{@link PermissionPreference#onBackgroundAccessChosen}</li>
+     *     <li>{@link BasePermissionReviewPreference#onBackgroundAccessChosen}</li>
      * </ol>
      */
     private void showBackgroundChooserDialog() {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/HandheldUnusedAppsFragment.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/HandheldUnusedAppsFragment.kt
index 37ac50bb8..030b12c66 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/HandheldUnusedAppsFragment.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/HandheldUnusedAppsFragment.kt
@@ -77,10 +77,10 @@ class HandheldUnusedAppsFragment :
     override fun createFooterPreference(): Preference {
         var preference: Preference
         if (isHibernationEnabled()) {
-            preference = com.android.settingslib.widget.FooterPreference(requireContext())
+            preference = PermissionFooterPreference(requireContext())
             preference.summary = getString(R.string.unused_apps_page_summary)
         } else {
-            preference = FooterPreference(requireContext())
+            preference = UnusedAppsFooterPreference(requireContext())
 
             preference.summary = getString(R.string.auto_revoked_apps_page_summary)
             preference.secondSummary = getString(R.string.auto_revoke_open_app_message)
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageCustomPermissionsWrapperFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageCustomPermissionsWrapperFragment.java
index f7409b97f..c96fb6a4a 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageCustomPermissionsWrapperFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageCustomPermissionsWrapperFragment.java
@@ -30,4 +30,9 @@ public class ManageCustomPermissionsWrapperFragment
     public PreferenceFragmentCompat createPreferenceFragment() {
         return new ManageCustomPermissionsFragment();
     }
+
+    @Override
+    protected boolean isPermissionSettings() {
+        return true;
+    }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManagePermissionsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManagePermissionsFragment.java
index 47f4a4c56..15b76e592 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManagePermissionsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManagePermissionsFragment.java
@@ -158,7 +158,7 @@ abstract class ManagePermissionsFragment extends PermissionsFrameFragment
      * A preference whose icons have the same fixed size. Allows the setting of dividers above and
      * below the preference.
      */
-    protected static final class FixedSizeIconPreference extends Preference {
+    protected static final class FixedSizeIconPreference extends PermissionPreference {
         private boolean mShowDividerAbove = true;
         private boolean mShowDividerBelow = false;
 
@@ -178,7 +178,7 @@ abstract class ManagePermissionsFragment extends PermissionsFrameFragment
             ImageView icon = ((ImageView) holder.findViewById(android.R.id.icon));
             icon.setAdjustViewBounds(true);
             int size = getContext().getResources().getDimensionPixelSize(
-                    R.dimen.permission_icon_size);
+                    R.dimen.permission_preference_permission_group_icon_size);
             icon.setMaxWidth(size);
             icon.setMaxHeight(size);
             icon.getLayoutParams().width = size;
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageStandardPermissionsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageStandardPermissionsFragment.java
index 86fcf2c27..bf99b7134 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageStandardPermissionsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageStandardPermissionsFragment.java
@@ -36,7 +36,6 @@ import com.android.permissioncontroller.permission.ui.UnusedAppsFragment;
 import com.android.permissioncontroller.permission.ui.model.ManageStandardPermissionsViewModel;
 import com.android.permissioncontroller.permission.utils.StringUtils;
 import com.android.permissioncontroller.permission.utils.Utils;
-import com.android.settingslib.widget.FooterPreference;
 
 /**
  * Fragment that allows the user to manage standard permissions.
@@ -168,8 +167,9 @@ public final class ManageStandardPermissionsFragment extends ManagePermissionsFr
         return screen;
     }
 
-    private FooterPreference createAutoRevokeFooterPreferenceForSPlus() {
-        FooterPreference autoRevokePreference = new FooterPreference(getContext());
+    private PermissionFooterPreference createAutoRevokeFooterPreferenceForSPlus() {
+        PermissionFooterPreference autoRevokePreference =
+                new PermissionFooterPreference(getContext());
         autoRevokePreference.setSummary(R.string.auto_revoked_apps_page_summary);
         autoRevokePreference.setLearnMoreAction(view -> {
             mViewModel.showAutoRevoke(this, UnusedAppsFragment.createArgs(
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageStandardPermissionsWrapperFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageStandardPermissionsWrapperFragment.java
index a2f9924fa..a4c9150d3 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageStandardPermissionsWrapperFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ManageStandardPermissionsWrapperFragment.java
@@ -30,4 +30,9 @@ public class ManageStandardPermissionsWrapperFragment
     public PreferenceFragmentCompat createPreferenceFragment() {
         return new ManageStandardPermissionsFragment();
     }
+
+    @Override
+    protected boolean isPermissionSettings() {
+        return true;
+    }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionAppsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionAppsFragment.java
index 76e52ad94..e7121709c 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionAppsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionAppsFragment.java
@@ -52,6 +52,7 @@ import androidx.preference.PreferenceScreen;
 
 import com.android.modules.utils.build.SdkLevel;
 import com.android.permissioncontroller.R;
+import com.android.permissioncontroller.permission.compat.AppPermissionFragmentCompat;
 import com.android.permissioncontroller.permission.model.v31.AppPermissionUsage;
 import com.android.permissioncontroller.permission.model.v31.PermissionUsages;
 import com.android.permissioncontroller.permission.ui.Category;
@@ -62,7 +63,6 @@ import com.android.permissioncontroller.permission.utils.KotlinUtils;
 import com.android.permissioncontroller.permission.utils.Utils;
 import com.android.settingslib.HelpUtils;
 import com.android.settingslib.utils.applications.AppUtils;
-import com.android.settingslib.widget.FooterPreference;
 
 import kotlin.Pair;
 import kotlin.Triple;
@@ -324,7 +324,7 @@ public final class PermissionAppsFragment extends SettingsWithLargeHeader implem
             return;
         }
 
-        FooterPreference preference = new FooterPreference(context);
+        PermissionFooterPreference preference = new PermissionFooterPreference(context);
         preference.setKey(STORAGE_FOOTER_PREFERENCE_KEY);
         preference.setIcon(Utils.applyTint(getActivity(), R.drawable.ic_info_outline,
                 android.R.attr.colorControlNormal));
@@ -419,7 +419,7 @@ public final class PermissionAppsFragment extends SettingsWithLargeHeader implem
             // permission, set up the empty preference.
             if (packages.size() == 0
                     && (!isStorageAndLessThanT || !grantCategory.equals(ALLOWED))) {
-                Preference empty = new Preference(context);
+                Preference empty = new PermissionPreference(context);
                 empty.setSelectable(false);
                 empty.setKey(category.getKey() + KEY_EMPTY);
                 if (grantCategory.equals(ALLOWED)) {
@@ -474,9 +474,9 @@ public final class PermissionAppsFragment extends SettingsWithLargeHeader implem
                         packageName, user));
                 pref.setOnPreferenceClickListener((Preference p) -> {
                     mViewModel.navigateToAppPermission(this, packageName, user,
-                            AppPermissionFragment.createArgs(packageName, null, mPermGroupName,
-                                    user, getClass().getName(), sessionId,
-                                    grantCategory.getCategoryName()));
+                            AppPermissionFragmentCompat.createArgs(packageName, null,
+                                    mPermGroupName, user, getClass().getName(), sessionId,
+                                    grantCategory.getCategoryName(), null));
                     return true;
                 });
                 pref.setTitleContentDescription(AppUtils.getAppContentDescription(context,
@@ -496,7 +496,7 @@ public final class PermissionAppsFragment extends SettingsWithLargeHeader implem
                 PreferenceCategory full = findPreference(STORAGE_ALLOWED_FULL);
                 PreferenceCategory scoped = findPreference(STORAGE_ALLOWED_SCOPED);
                 if (full.getPreferenceCount() == 0) {
-                    Preference empty = new Preference(context);
+                    Preference empty = new PermissionPreference(context);
                     empty.setSelectable(false);
                     empty.setKey(STORAGE_ALLOWED_FULL + KEY_EMPTY);
                     empty.setTitle(getString(R.string.no_apps_allowed_full));
@@ -504,7 +504,7 @@ public final class PermissionAppsFragment extends SettingsWithLargeHeader implem
                 }
 
                 if (scoped.getPreferenceCount() == 0) {
-                    Preference empty = new Preference(context);
+                    Preference empty = new PermissionPreference(context);
                     empty.setSelectable(false);
                     empty.setKey(STORAGE_ALLOWED_FULL + KEY_EMPTY);
                     empty.setTitle(getString(R.string.no_apps_allowed_scoped));
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionAppsWrapperFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionAppsWrapperFragment.java
index 36bbe9a20..70525f7c2 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionAppsWrapperFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionAppsWrapperFragment.java
@@ -28,4 +28,9 @@ public class PermissionAppsWrapperFragment extends PermissionsCollapsingToolbarB
     public PreferenceFragmentCompat createPreferenceFragment() {
         return new PermissionAppsFragment();
     }
+
+    @Override
+    protected boolean isPermissionSettings() {
+        return true;
+    }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionControlPreference.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionControlPreference.java
index 039aca39d..e6a8ef6a0 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionControlPreference.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionControlPreference.java
@@ -20,8 +20,6 @@ import static android.health.connect.HealthPermissions.HEALTH_PERMISSION_GROUP;
 
 import static com.android.permissioncontroller.Constants.EXTRA_SESSION_ID;
 import static com.android.permissioncontroller.permission.ui.ManagePermissionsActivity.EXTRA_CALLER_NAME;
-import static com.android.permissioncontroller.permission.ui.handheld.AppPermissionFragment.GRANT_CATEGORY;
-import static com.android.permissioncontroller.permission.ui.handheld.AppPermissionFragment.PERSISTENT_DEVICE_ID;
 import static com.android.permissioncontroller.permission.utils.KotlinUtilsKt.navigateSafe;
 
 import android.Manifest;
@@ -40,10 +38,11 @@ import android.widget.TextView;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.navigation.Navigation;
-import androidx.preference.Preference;
 import androidx.preference.PreferenceViewHolder;
 
+import com.android.modules.utils.build.SdkLevel;
 import com.android.permissioncontroller.R;
+import com.android.permissioncontroller.permission.compat.AppPermissionFragmentCompat;
 import com.android.permissioncontroller.permission.model.AppPermissionGroup;
 import com.android.permissioncontroller.permission.ui.LocationProviderInterceptDialog;
 import com.android.permissioncontroller.permission.utils.LocationUtils;
@@ -54,7 +53,7 @@ import java.util.List;
 /**
  * A preference that links to the screen where a permission can be toggled.
  */
-public class PermissionControlPreference extends Preference {
+public class PermissionControlPreference extends PermissionPreference {
     private final @NonNull Context mContext;
     private @Nullable Drawable mWidgetIcon;
     private @Nullable String mWidgetIconContentDescription;
@@ -176,14 +175,21 @@ public class PermissionControlPreference extends Preference {
 
     @Override
     public void onBindViewHolder(PreferenceViewHolder holder) {
+        ImageView icon = ((ImageView) holder.findViewById(android.R.id.icon));
         if (mUseSmallerIcon) {
-            ImageView icon = ((ImageView) holder.findViewById(android.R.id.icon));
-            icon.setMaxWidth(
-                    mContext.getResources().getDimensionPixelSize(
-                            com.android.settingslib.widget.theme.R.dimen.secondary_app_icon_size));
-            icon.setMaxHeight(
-                    mContext.getResources().getDimensionPixelSize(
-                            com.android.settingslib.widget.theme.R.dimen.secondary_app_icon_size));
+            int iconSize = mContext.getResources().getDimensionPixelSize(
+                            com.android.settingslib.widget.theme.R.dimen.secondary_app_icon_size);
+            icon.setMaxWidth(iconSize);
+            icon.setMaxHeight(iconSize);
+        } else if (SdkLevel.isAtLeastV()) {
+            icon.setAdjustViewBounds(true);
+            int size = getContext().getResources().getDimensionPixelSize(
+                    R.dimen.permission_preference_permission_group_icon_size);
+            icon.setMaxWidth(size);
+            icon.setMaxHeight(size);
+            icon.getLayoutParams().width = size;
+            icon.getLayoutParams().height = size;
+            icon.setScaleType(ImageView.ScaleType.FIT_CENTER);
         }
 
         super.onBindViewHolder(holder);
@@ -232,14 +238,8 @@ public class PermissionControlPreference extends Preference {
                     Utils.navigateToAppHealthConnectSettings(mContext, mPackageName, mUser);
                     return true;
                 }
-                Bundle args = new Bundle();
-                args.putString(Intent.EXTRA_PACKAGE_NAME, mPackageName);
-                args.putString(Intent.EXTRA_PERMISSION_GROUP_NAME, mPermGroupName);
-                args.putParcelable(Intent.EXTRA_USER, mUser);
-                args.putString(EXTRA_CALLER_NAME, mCaller);
-                args.putLong(EXTRA_SESSION_ID, mSessionId);
-                args.putString(GRANT_CATEGORY, mGranted);
-                args.putString(PERSISTENT_DEVICE_ID, mPersistentDeviceId);
+                Bundle args = AppPermissionFragmentCompat.createArgs(mPackageName, null,
+                        mPermGroupName, mUser, mCaller, mSessionId, mGranted, mPersistentDeviceId);
                 navigateSafe(Navigation.findNavController(holder.itemView), R.id.perm_groups_to_app,
                         args);
             } else {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionFooterPreference.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionFooterPreference.kt
new file mode 100644
index 000000000..1cd4ed23a
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionFooterPreference.kt
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.handheld
+
+import android.content.Context
+import android.view.View
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.R
+import com.android.settingslib.widget.FooterPreference
+
+class PermissionFooterPreference(c: Context) : FooterPreference(c) {
+    init {
+        if (SdkLevel.isAtLeastV()) {
+            layoutResource = R.layout.permission_footer_preference
+            if (c.resources.getBoolean(R.bool.config_permissionFooterPreferenceIconVisible)) {
+                setIconVisibility(View.VISIBLE)
+            } else {
+                setIconVisibility(View.GONE)
+            }
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreference.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreference.kt
new file mode 100644
index 000000000..5e30183ec
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreference.kt
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.handheld
+
+import android.content.Context
+import android.util.AttributeSet
+import androidx.preference.Preference
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.DeviceUtils
+import com.android.permissioncontroller.R
+
+open class PermissionPreference : Preference {
+    constructor(c: Context) : super(c)
+
+    constructor(c: Context, a: AttributeSet) : super(c, a)
+
+    init {
+        if (SdkLevel.isAtLeastV() && DeviceUtils.isHandheld(context)) {
+            layoutResource = R.layout.permission_preference
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreferenceCategory.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreferenceCategory.kt
new file mode 100644
index 000000000..ef1752530
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionPreferenceCategory.kt
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.handheld
+
+import android.content.Context
+import android.util.AttributeSet
+import androidx.preference.PreferenceCategory
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.DeviceUtils
+import com.android.permissioncontroller.R
+
+open class PermissionPreferenceCategory : PreferenceCategory {
+    constructor(c: Context) : super(c)
+
+    constructor(c: Context, a: AttributeSet) : super(c, a)
+
+    init {
+        if (SdkLevel.isAtLeastV() && DeviceUtils.isHandheld(context)) {
+            layoutResource = R.layout.permission_preference_category
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionSelectorWithWidgetPreference.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionSelectorWithWidgetPreference.kt
new file mode 100644
index 000000000..9d095c7dc
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionSelectorWithWidgetPreference.kt
@@ -0,0 +1,97 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.handheld
+
+import android.content.Context
+import android.util.AttributeSet
+import android.widget.ImageView
+import androidx.annotation.AttrRes
+import androidx.annotation.DrawableRes
+import androidx.annotation.IdRes
+import androidx.preference.PreferenceViewHolder
+import com.android.permissioncontroller.R
+import com.android.permissioncontroller.permission.utils.ResourceUtils
+import com.android.settingslib.widget.SelectorWithWidgetPreference
+
+/**
+ * A `SelectorWithWidgetPreference` with additional features:
+ * - Propagates the supplied `app:extraWidgetIcon` drawable to the extraWidget
+ * - Propagates the supplied `app:extraWidgetId` id to the extraWidget (the icon on the right)
+ * - Propagates the supplied `app:checkboxId` id to the checkbox (or radio button, on the left)
+ * - Allows defining a "disabled click listener" handler that handles clicks when disabled
+ */
+class PermissionSelectorWithWidgetPreference : SelectorWithWidgetPreference {
+    constructor(context: Context) : super(context) {
+        init(context, null)
+    }
+
+    constructor(context: Context, attrs: AttributeSet?) : super(context, attrs) {
+        init(context, attrs)
+    }
+
+    constructor(
+        context: Context,
+        attrs: AttributeSet?,
+        @AttrRes defStyleAttr: Int
+    ) : super(context, attrs, defStyleAttr) {
+        init(context, attrs)
+    }
+
+    constructor(context: Context, isCheckbox: Boolean) : super(context, isCheckbox) {
+        init(context, null)
+    }
+
+    private fun init(context: Context, attrs: AttributeSet?) {
+        extraWidgetIconRes =
+            ResourceUtils.getResourceIdByAttr(context, attrs, R.attr.extraWidgetIcon)
+        extraWidgetIdRes = ResourceUtils.getResourceIdByAttr(context, attrs, R.attr.extraWidgetId)
+        checkboxIdRes = ResourceUtils.getResourceIdByAttr(context, attrs, R.attr.checkboxId)
+    }
+
+    @DrawableRes private var extraWidgetIconRes = 0
+    @IdRes private var extraWidgetIdRes = 0
+    @IdRes private var checkboxIdRes = 0
+    private var onDisabledClickListener: OnClickListener? = null
+
+    override fun onBindViewHolder(holder: PreferenceViewHolder) {
+        super.onBindViewHolder(holder)
+        val extraWidget = holder.findViewById(
+            com.android.settingslib.widget.preference.selector.R.id.selector_extra_widget
+        ) as? ImageView
+        val checkbox = holder.findViewById(android.R.id.checkbox)
+        if (extraWidgetIconRes != 0) {
+            extraWidget?.setImageResource(extraWidgetIconRes)
+        }
+        if (extraWidgetIdRes != 0) {
+            extraWidget?.id = extraWidgetIdRes
+        }
+        if (checkboxIdRes != 0) {
+            checkbox?.id = checkboxIdRes
+        }
+        if (onDisabledClickListener != null) {
+            holder.itemView.isEnabled = true
+            holder.itemView.setOnClickListener {
+                onDisabledClickListener?.onRadioButtonClicked(this)
+            }
+        }
+    }
+
+    fun setOnDisabledClickListener(onClickListener: OnClickListener?) {
+        onDisabledClickListener = onClickListener
+        notifyChanged()
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionSwitchPreference.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionSwitchPreference.kt
new file mode 100644
index 000000000..73339f304
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionSwitchPreference.kt
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.handheld
+
+import android.content.Context
+import android.util.AttributeSet
+import androidx.preference.SwitchPreference
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.DeviceUtils
+import com.android.permissioncontroller.R
+
+open class PermissionSwitchPreference : SwitchPreference {
+    constructor(c: Context) : super(c)
+
+    constructor(c: Context, a: AttributeSet) : super(c, a)
+
+    init {
+        if (SdkLevel.isAtLeastV() && DeviceUtils.isHandheld(context)) {
+            layoutResource = R.layout.permission_preference
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionTwoTargetPreference.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionTwoTargetPreference.kt
new file mode 100644
index 000000000..13c9ee7c4
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionTwoTargetPreference.kt
@@ -0,0 +1,101 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.handheld
+
+import android.content.Context
+import android.util.AttributeSet
+import android.widget.ImageView
+import androidx.annotation.AttrRes
+import androidx.annotation.DrawableRes
+import androidx.annotation.StyleRes
+import androidx.preference.PreferenceViewHolder
+import com.android.permissioncontroller.R
+import com.android.permissioncontroller.permission.utils.ResourceUtils
+import com.android.settingslib.widget.TwoTargetPreference
+
+/**
+ * A `TwoTargetPreference` with additional features:
+ * - Propagates the supplied `app:extraWidgetIcon` drawable to the second target
+ * - Allows defining a click listener on the second target (the icon on the right)
+ */
+class PermissionTwoTargetPreference : TwoTargetPreference {
+    constructor(context: Context) : super(context) {
+        init(context, null)
+    }
+
+    constructor(context: Context, attrs: AttributeSet?) : super(context, attrs) {
+        init(context, attrs)
+    }
+
+    constructor(
+        context: Context,
+        attrs: AttributeSet?,
+        @AttrRes defStyleAttr: Int
+    ) : super(context, attrs, defStyleAttr) {
+        init(context, attrs)
+    }
+
+    constructor(
+        context: Context,
+        attrs: AttributeSet?,
+        @AttrRes defStyleAttr: Int,
+        @StyleRes defStyleRes: Int
+    ) : super(context, attrs, defStyleAttr, defStyleRes) {
+        init(context, attrs)
+    }
+
+    private fun init(context: Context, attrs: AttributeSet?) {
+        extraWidgetIconRes =
+            ResourceUtils.getResourceIdByAttr(context, attrs, R.attr.extraWidgetIcon)
+    }
+
+    @DrawableRes private var extraWidgetIconRes = 0
+    private var secondTargetClickListener: OnSecondTargetClickListener? = null
+
+    override fun onBindViewHolder(holder: PreferenceViewHolder) {
+        super.onBindViewHolder(holder)
+        val settingsButton = holder.findViewById(R.id.settings_button) as ImageView
+        if (extraWidgetIconRes != 0) {
+            settingsButton.setImageResource(extraWidgetIconRes)
+        }
+        if (secondTargetClickListener != null) {
+            settingsButton.setOnClickListener {
+                secondTargetClickListener!!.onSecondTargetClick(this)
+            }
+        } else {
+            settingsButton.setOnClickListener(null)
+        }
+    }
+
+    override fun getSecondTargetResId() = R.layout.settings_button_preference_widget
+
+    override fun shouldHideSecondTarget() = secondTargetClickListener == null
+
+    fun setOnSecondTargetClickListener(listener: OnSecondTargetClickListener?) {
+        secondTargetClickListener = listener
+        notifyChanged()
+    }
+
+    fun setExtraWidgetIconRes(@DrawableRes extraWidgetIconRes: Int) {
+        this.extraWidgetIconRes = extraWidgetIconRes
+        notifyChanged()
+    }
+
+    interface OnSecondTargetClickListener {
+        fun onSecondTargetClick(preference: TwoTargetPreference)
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionsCollapsingToolbarBaseFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionsCollapsingToolbarBaseFragment.java
index fde134b4d..1d433f096 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionsCollapsingToolbarBaseFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionsCollapsingToolbarBaseFragment.java
@@ -23,6 +23,8 @@ import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.preference.PreferenceFragmentCompat;
 
+import com.android.modules.utils.build.SdkLevel;
+import com.android.permissioncontroller.R;
 import com.android.settingslib.collapsingtoolbar.CollapsingToolbarBaseFragment;
 
 /**
@@ -60,4 +62,14 @@ public abstract class PermissionsCollapsingToolbarBaseFragment
      */
     @NonNull
     public abstract PreferenceFragmentCompat createPreferenceFragment();
+
+    @Override
+    protected final boolean useCollapsingToolbar() {
+        return SdkLevel.isAtLeastS() && (!isPermissionSettings() || getResources()
+                .getBoolean(R.bool.config_useCollapsingToolbarInPermissionSettings));
+    }
+
+    protected boolean isPermissionSettings() {
+        return false;
+    }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionsFrameFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionsFrameFragment.java
index 17e72b413..af204d7d4 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionsFrameFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/PermissionsFrameFragment.java
@@ -28,11 +28,15 @@ import android.view.animation.Animation.AnimationListener;
 import android.view.animation.AnimationUtils;
 import android.widget.TextView;
 
+import androidx.annotation.NonNull;
 import androidx.preference.PreferenceFragmentCompat;
+import androidx.preference.PreferenceScreen;
 import androidx.recyclerview.widget.RecyclerView;
 
 import com.android.modules.utils.build.SdkLevel;
+import com.android.permissioncontroller.DeviceUtils;
 import com.android.permissioncontroller.R;
+import com.android.permissioncontroller.permission.ui.handheld.v35.SectionPreferenceGroupAdapter;
 import com.android.permissioncontroller.permission.utils.Utils;
 import com.android.settingslib.widget.ActionBarShadowController;
 
@@ -42,6 +46,7 @@ public abstract class PermissionsFrameFragment extends PreferenceFragmentCompat
     static final int MENU_ALL_PERMS = Menu.FIRST + 1;
     public static final int MENU_SHOW_SYSTEM = Menu.FIRST + 2;
     public static final int MENU_HIDE_SYSTEM = Menu.FIRST + 3;
+    static final int MENU_ALLOW_RESTRICTED_SETTINGS = Menu.FIRST + 4;
 
     private ViewGroup mPreferencesContainer;
 
@@ -117,6 +122,15 @@ public abstract class PermissionsFrameFragment extends PreferenceFragmentCompat
         // empty
     }
 
+    @Override
+    public RecyclerView.Adapter onCreateAdapter(@NonNull PreferenceScreen preferenceScreen) {
+        if (SdkLevel.isAtLeastV() && DeviceUtils.isHandheld(requireContext())) {
+            return new SectionPreferenceGroupAdapter(preferenceScreen);
+        } else {
+            return super.onCreateAdapter(preferenceScreen);
+        }
+    }
+
     protected void setLoading(boolean loading, boolean animate) {
         setLoading(loading, animate, false);
     }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ReviewPermissionsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ReviewPermissionsFragment.java
index 5a7c3f2b5..73366f4cd 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ReviewPermissionsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/ReviewPermissionsFragment.java
@@ -77,8 +77,9 @@ import java.util.Random;
  * which permissions to grant to the app before first use and if an update changed the permissions.
  */
 public final class ReviewPermissionsFragment extends PreferenceFragmentCompat
-        implements View.OnClickListener, PermissionPreference.PermissionPreferenceChangeListener,
-        PermissionPreference.PermissionPreferenceOwnerFragment {
+        implements View.OnClickListener,
+        BasePermissionReviewPreference.PermissionPreferenceChangeListener,
+        BasePermissionReviewPreference.PermissionPreferenceOwnerFragment {
 
     private static final String EXTRA_PACKAGE_INFO =
             "com.android.permissioncontroller.permission.ui.extra.PACKAGE_INFO";
@@ -267,11 +268,11 @@ public final class ReviewPermissionsFragment extends PreferenceFragmentCompat
             PermissionControllerStatsLog.write(REVIEW_PERMISSIONS_FRAGMENT_RESULT_REPORTED,
                     changeId, mViewModel.getPackageInfo().applicationInfo.uid,
                     group.getPackageName(),
-                    permission.getName(), permission.isGrantedIncludingAppOp());
+                    permission.getName(), permission.isGranted());
             Log.i(LOG_TAG, "Permission grant via permission review changeId=" + changeId + " uid="
                     + mViewModel.getPackageInfo().applicationInfo.uid + " packageName="
                     + group.getPackageName() + " permission="
-                    + permission.getName() + " granted=" + permission.isGrantedIncludingAppOp());
+                    + permission.getName() + " granted=" + permission.isGranted());
         }
     }
 
@@ -369,7 +370,7 @@ public final class ReviewPermissionsFragment extends PreferenceFragmentCompat
                     screen.addPreference(preference);
                 } else {
                     if (mNewPermissionsCategory == null) {
-                        mNewPermissionsCategory = new PreferenceCategory(activity);
+                        mNewPermissionsCategory = new PermissionPreferenceCategory(activity);
                         mNewPermissionsCategory.setTitle(R.string.new_permissions_category);
                         mNewPermissionsCategory.setOrder(1);
                         screen.addPreference(mNewPermissionsCategory);
@@ -378,7 +379,7 @@ public final class ReviewPermissionsFragment extends PreferenceFragmentCompat
                 }
             } else {
                 if (mCurrentPermissionsCategory == null) {
-                    mCurrentPermissionsCategory = new PreferenceCategory(activity);
+                    mCurrentPermissionsCategory = new PermissionPreferenceCategory(activity);
                     mCurrentPermissionsCategory.setTitle(R.string.current_permissions_category);
                     mCurrentPermissionsCategory.setOrder(2);
                     screen.addPreference(mCurrentPermissionsCategory);
@@ -447,7 +448,7 @@ public final class ReviewPermissionsFragment extends PreferenceFragmentCompat
     }
 
     /**
-     * Extend the {@link PermissionPreference}:
+     * Extend the {@link BasePermissionReviewPreference}:
      * <ul>
      *     <li>Show the description of the permission group</li>
      *     <li>Show the permission group as granted if the user has not toggled it yet. This means
@@ -455,7 +456,7 @@ public final class ReviewPermissionsFragment extends PreferenceFragmentCompat
      *     in {@link #confirmPermissionsReview()}.</li>
      * </ul>
      */
-    private static class PermissionReviewPreference extends PermissionPreference {
+    private static class PermissionReviewPreference extends BasePermissionReviewPreference {
         private final LightAppPermGroup mGroup;
         private final Context mContext;
         private boolean mWasChanged;
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/SettingsWithLargeHeader.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/SettingsWithLargeHeader.java
index 8745ac8f7..e16753e09 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/SettingsWithLargeHeader.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/SettingsWithLargeHeader.java
@@ -29,7 +29,6 @@ import android.widget.TextView;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
-import androidx.preference.PreferenceCategory;
 import androidx.preference.PreferenceScreen;
 import androidx.preference.PreferenceViewHolder;
 
@@ -180,7 +179,7 @@ public abstract class SettingsWithLargeHeader extends PermissionsFrameFragment
     /**
      * A Preference that will act as the "Large Header" for "SettingsWithLargeHeader" fragments.
      */
-    public static class LargeHeaderPreference extends PreferenceCategory {
+    public static class LargeHeaderPreference extends PermissionPreferenceCategory {
         private SettingsWithLargeHeader mFragment;
 
         private LargeHeaderPreference(Context context, SettingsWithLargeHeader fragment) {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/SmartIconLoadPackagePermissionPreference.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/SmartIconLoadPackagePermissionPreference.kt
index b31b3e484..5f04b159e 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/SmartIconLoadPackagePermissionPreference.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/SmartIconLoadPackagePermissionPreference.kt
@@ -24,7 +24,6 @@ import android.view.View
 import android.widget.ImageView
 import android.widget.TextView
 import androidx.preference.AndroidResources
-import androidx.preference.Preference
 import androidx.preference.PreferenceViewHolder
 import com.android.permissioncontroller.R
 import com.android.permissioncontroller.permission.utils.KotlinUtils
@@ -39,13 +38,12 @@ import com.android.permissioncontroller.permission.utils.KotlinUtils
  * @param user The user whose package icon will be retrieved
  * @param context The current context
  */
-open class SmartIconLoadPackagePermissionPreference
-constructor(
+open class SmartIconLoadPackagePermissionPreference(
     private val app: Application,
     private val packageName: String,
     private val user: UserHandle,
     context: Context
-) : Preference(context) {
+) : PermissionPreference(context) {
 
     private var titleContentDescription: CharSequence? = null
 
@@ -60,18 +58,14 @@ constructor(
         title.maxLines = 1
         title.ellipsize = TextUtils.TruncateAt.END
 
-        val imageView = holder.findViewById(android.R.id.icon) as ImageView
+        val icon = holder.findViewById(android.R.id.icon) as ImageView
+        val iconSize =
+            context.resources.getDimensionPixelSize(R.dimen.permission_preference_app_icon_size)
+        icon.maxWidth = iconSize
+        icon.maxHeight = iconSize
 
-        imageView.maxWidth =
-            context.resources.getDimensionPixelSize(
-                com.android.settingslib.widget.theme.R.dimen.secondary_app_icon_size
-            )
-        imageView.maxHeight =
-            context.resources.getDimensionPixelSize(
-                com.android.settingslib.widget.theme.R.dimen.secondary_app_icon_size
-            )
-        imageView.setImageDrawable(KotlinUtils.getBadgedPackageIcon(app, packageName, user))
-        imageView.visibility = View.VISIBLE
+        icon.setImageDrawable(KotlinUtils.getBadgedPackageIcon(app, packageName, user))
+        icon.visibility = View.VISIBLE
 
         var imageFrame: View? = holder.findViewById(R.id.icon_frame)
         if (imageFrame == null) {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/FooterPreference.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/UnusedAppsFooterPreference.kt
similarity index 79%
rename from PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/FooterPreference.kt
rename to PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/UnusedAppsFooterPreference.kt
index 278243f09..9972682f5 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/FooterPreference.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/UnusedAppsFooterPreference.kt
@@ -17,7 +17,6 @@
 package com.android.permissioncontroller.permission.ui.handheld
 
 import android.content.Context
-import android.util.AttributeSet
 import android.widget.TextView
 import androidx.preference.Preference
 import androidx.preference.PreferenceViewHolder
@@ -27,15 +26,12 @@ import com.android.permissioncontroller.R
  * A Preference for the footer of a screen. Has two summaries, and adjusted spacing and icon
  * placement.
  */
-class FooterPreference : Preference {
-    constructor(c: Context) : super(c)
-    constructor(c: Context, a: AttributeSet) : super(c, a)
-    constructor(c: Context, a: AttributeSet, attr: Int) : super(c, a, attr)
-    constructor(c: Context, a: AttributeSet, attr: Int, res: Int) : super(c, a, attr, res)
+class UnusedAppsFooterPreference(c: Context) : Preference(c) {
 
     init {
-        layoutResource = R.layout.footer_preference
+        layoutResource = R.layout.unused_apps_footer_preference
     }
+
     var secondSummary: CharSequence = ""
         set(value) {
             secondSummaryView?.text = value
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/max35/LegacyAppPermissionFragment.java
similarity index 90%
rename from PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionFragment.java
rename to PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/max35/LegacyAppPermissionFragment.java
index f65f3d788..35650defb 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/AppPermissionFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/max35/LegacyAppPermissionFragment.java
@@ -14,7 +14,9 @@
  * limitations under the License.
  */
 
-package com.android.permissioncontroller.permission.ui.handheld;
+// LINT.IfChange
+
+package com.android.permissioncontroller.permission.ui.handheld.max35;
 
 import static android.Manifest.permission_group.STORAGE;
 import static android.app.Activity.RESULT_OK;
@@ -30,6 +32,7 @@ import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_
 import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__GRANT_FINE_LOCATION;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__PHOTOS_SELECTED;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__REVOKE_FINE_LOCATION;
+import static com.android.permissioncontroller.permission.compat.AppPermissionFragmentCompat.PERSISTENT_DEVICE_ID;
 import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.DENIED;
 import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.DENIED_DO_NOT_ASK_AGAIN;
 import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.GRANTED_ALWAYS;
@@ -47,11 +50,13 @@ import android.content.Context;
 import android.content.DialogInterface;
 import android.content.Intent;
 import android.graphics.drawable.Drawable;
+import android.os.Build;
 import android.os.Bundle;
 import android.os.Handler;
 import android.os.Looper;
 import android.os.UserHandle;
 import android.text.BidiFormatter;
+import android.util.ArrayMap;
 import android.util.Log;
 import android.view.LayoutInflater;
 import android.view.MenuItem;
@@ -66,7 +71,7 @@ import android.widget.TextView;
 import android.widget.Toast;
 
 import androidx.annotation.NonNull;
-import androidx.annotation.Nullable;
+import androidx.annotation.RequiresApi;
 import androidx.annotation.StringRes;
 import androidx.core.widget.NestedScrollView;
 import androidx.fragment.app.DialogFragment;
@@ -76,6 +81,10 @@ import com.android.modules.utils.build.SdkLevel;
 import com.android.permissioncontroller.R;
 import com.android.permissioncontroller.permission.data.FullStoragePermissionAppsLiveData.FullStoragePackageState;
 import com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler;
+import com.android.permissioncontroller.permission.ui.handheld.AllAppPermissionsFragment;
+import com.android.permissioncontroller.permission.ui.handheld.AppPermissionGroupsFragment;
+import com.android.permissioncontroller.permission.ui.handheld.PermissionAppsFragment;
+import com.android.permissioncontroller.permission.ui.handheld.SettingsWithLargeHeader;
 import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel;
 import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel.ButtonState;
 import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel.ButtonType;
@@ -101,15 +110,12 @@ import java.util.Set;
  *
  * <p>Allows the user to control whether the app is granted the permission.
  */
-public class AppPermissionFragment extends SettingsWithLargeHeader
+public class LegacyAppPermissionFragment extends SettingsWithLargeHeader
         implements AppPermissionViewModel.ConfirmDialogShowingFragment {
-    private static final String LOG_TAG = "AppPermissionFragment";
+    private static final String LOG_TAG = "LegacyAppPermissionFragment";
     private static final long POST_DELAY_MS = 20;
     private static final long EDIT_PHOTOS_BUTTON_ANIMATION_LENGTH_MS = 200L;
 
-    static final String GRANT_CATEGORY = "grant_category";
-    static final String PERSISTENT_DEVICE_ID = "persistent_device_id";
-
     private @NonNull AppPermissionViewModel mViewModel;
     private @NonNull ViewGroup mAppPermissionRationaleContainer;
     private @NonNull ViewGroup mAppPermissionRationaleContent;
@@ -119,10 +125,10 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
     private @NonNull RadioButton mAllowForegroundButton;
     private @NonNull RadioButton mAskOneTimeButton;
     private @NonNull RadioButton mAskButton;
-    private @NonNull RadioButton mAllowLimitedButton;
+    private @NonNull RadioButton mSelectButton;
     private @NonNull RadioButton mDenyButton;
     private @NonNull RadioButton mDenyForegroundButton;
-    private @NonNull ImageView mSelectPhotosButton;
+    private @NonNull ImageView mEditSelectedPhotosButton;
     private @NonNull View mAllowLimitedPhotosLayout;
     private @NonNull View mSelectPhotosDivider;
     private @NonNull View mLocationAccuracy;
@@ -146,37 +152,6 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
     private Drawable mPackageIcon;
     private @NonNull RoleManager mRoleManager;
 
-    /**
-     * Create a bundle with the arguments needed by this fragment
-     *
-     * @param packageName   The name of the package
-     * @param permName      The name of the permission whose group this fragment is for (optional)
-     * @param groupName     The name of the permission group (required if permName not specified)
-     * @param userHandle    The user of the app permission group
-     * @param caller        The name of the fragment we called from
-     * @param sessionId     The current session ID
-     * @param grantCategory The grant status of this app permission group. Used to initially set
-     *                      the button state
-     * @return A bundle with all of the args placed
-     */
-    public static Bundle createArgs(@NonNull String packageName,
-            @Nullable String permName, @Nullable String groupName,
-            @NonNull UserHandle userHandle, @Nullable String caller, long sessionId, @Nullable
-            String grantCategory) {
-        Bundle arguments = new Bundle();
-        arguments.putString(Intent.EXTRA_PACKAGE_NAME, packageName);
-        if (groupName == null) {
-            arguments.putString(Intent.EXTRA_PERMISSION_NAME, permName);
-        } else {
-            arguments.putString(Intent.EXTRA_PERMISSION_GROUP_NAME, groupName);
-        }
-        arguments.putParcelable(Intent.EXTRA_USER, userHandle);
-        arguments.putString(EXTRA_CALLER_NAME, caller);
-        arguments.putLong(EXTRA_SESSION_ID, sessionId);
-        arguments.putString(GRANT_CATEGORY, grantCategory);
-        return arguments;
-    }
-
     @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
@@ -280,7 +255,7 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
         mAllowForegroundButton = root.requireViewById(R.id.allow_foreground_only_radio_button);
         mAskOneTimeButton = root.requireViewById(R.id.ask_one_time_radio_button);
         mAskButton = root.requireViewById(R.id.ask_radio_button);
-        mAllowLimitedButton = root.requireViewById(R.id.select_radio_button);
+        mSelectButton = root.requireViewById(R.id.select_radio_button);
         mDenyButton = root.requireViewById(R.id.deny_radio_button);
         mDenyForegroundButton = root.requireViewById(R.id.deny_foreground_radio_button);
 
@@ -290,7 +265,7 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
         mLocationAccuracy = root.requireViewById(R.id.location_accuracy);
         mLocationAccuracySwitch = root.requireViewById(R.id.location_accuracy_switch);
         mAllowLimitedPhotosLayout = root.requireViewById(R.id.radio_select_layout);
-        mSelectPhotosButton = root.requireViewById(R.id.edit_selected_button);
+        mEditSelectedPhotosButton = root.requireViewById(R.id.edit_selected_button);
         mSelectPhotosDivider = root.requireViewById(R.id.edit_photos_divider);
         mNestedScrollView = root.requireViewById(R.id.nested_scroll_view);
 
@@ -307,7 +282,7 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
             mLocationAccuracy.setVisibility(View.GONE);
             mAllowLimitedPhotosLayout.setVisibility(View.GONE);
             mSelectPhotosDivider.setAlpha(0f);
-            mSelectPhotosButton.setAlpha(0f);
+            mEditSelectedPhotosButton.setAlpha(0f);
         }
 
         if (mViewModel.getFullStorageStateLiveData().isInitialized() && mIsStorageGroup) {
@@ -408,6 +383,7 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
         }
         mAllowButtonFrame.setOnClickListener((v) -> allowButtonFrameClickListener());
         mAllowAlwaysButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.ALLOW_ALWAYS);
             if (mIsStorageGroup) {
                 showConfirmDialog(ChangeRequest.GRANT_ALL_FILE_ACCESS,
                         R.string.special_file_access_dialog, -1, false);
@@ -418,6 +394,7 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
             setResult(GRANTED_ALWAYS);
         });
         mAllowForegroundButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.ALLOW_FOREGROUND);
             if (mIsStorageGroup) {
                 mViewModel.setAllFilesAccess(false);
                 mViewModel.requestChange(false, this, this, ChangeRequest.GRANT_BOTH,
@@ -429,19 +406,24 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
                 setResult(GRANTED_FOREGROUND_ONLY);
             }
         });
-        // mAskOneTimeButton only shows if checked hence should do nothing
+        mAskOneTimeButton.setOnClickListener((v) -> {
+            // mAskOneTimeButton only shows if checked hence should do nothing
+            markSingleButtonAsChecked(ButtonType.ASK_ONCE);
+        });
         mAskButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.ASK);
             mViewModel.requestChange(true, this, this, ChangeRequest.REVOKE_BOTH,
                     APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ASK_EVERY_TIME);
             setResult(DENIED);
         });
-        mAllowLimitedButton.setOnClickListener((v) -> {
+        mSelectButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.SELECT_PHOTOS);
             int buttonPressed =
                     APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__PHOTOS_SELECTED;
             mViewModel.requestChange(false, this, this, ChangeRequest.PHOTOS_SELECTED,
                     buttonPressed);
         });
-        mSelectPhotosButton.setOnClickListener((v) -> {
+        mEditSelectedPhotosButton.setOnClickListener((v) -> {
             ButtonState selectState = states.get(ButtonType.SELECT_PHOTOS);
             if (selectState != null && selectState.isChecked() && !mPhotoPickerTriggered) {
                 mPhotoPickerTriggered = true;
@@ -449,6 +431,7 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
             }
         });
         mDenyButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.DENY);
             if (mViewModel.getFullStorageStateLiveData().getValue() != null
                     && !mViewModel.getFullStorageStateLiveData().getValue().isLegacy()) {
                 mViewModel.setAllFilesAccess(false);
@@ -458,6 +441,7 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
             setResult(DENIED_DO_NOT_ASK_AGAIN);
         });
         mDenyForegroundButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.DENY_FOREGROUND);
             mViewModel.requestChange(false, this, this, ChangeRequest.REVOKE_FOREGROUND,
                     APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__DENY_FOREGROUND);
             setResult(DENIED_DO_NOT_ASK_AGAIN);
@@ -485,8 +469,8 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
         setButtonState(mAskButton, states.get(ButtonType.ASK));
         setButtonState(mDenyButton, states.get(ButtonType.DENY));
         setButtonState(mDenyForegroundButton, states.get(ButtonType.DENY_FOREGROUND));
-        setButtonState(mAllowLimitedButton, states.get(ButtonType.SELECT_PHOTOS));
-        if (mAllowLimitedButton.getVisibility() == View.VISIBLE) {
+        setButtonState(mSelectButton, states.get(ButtonType.SELECT_PHOTOS));
+        if (mSelectButton.getVisibility() == View.VISIBLE) {
             mAllowButton.setText(R.string.app_permission_button_always_allow_all);
         } else {
             mAllowButton.setText(R.string.app_permission_button_allow);
@@ -515,7 +499,7 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
         if (!mAllowButton.isEnabled()) {
             mViewModel.handleDisabledAllowButton(this);
         } else {
-            mAllowButton.setChecked(true);
+            markSingleButtonAsChecked(ButtonType.ALLOW);
             mViewModel.requestChange(false, this, this, ChangeRequest.GRANT_FOREGROUND,
                     APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW);
             setResult(GRANTED_ALWAYS);
@@ -533,16 +517,16 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
             button.jumpDrawablesToCurrentState();
         }
 
-        if (button == mAllowLimitedButton) {
+        if (button == mSelectButton) {
             mAllowLimitedPhotosLayout.setVisibility(visible);
             float endOpacity = state.isChecked() ? 1f : 0f;
             // On initial load, do not show the fade in/out animation
             if (mIsInitialLoad) {
                 mSelectPhotosDivider.setAlpha(endOpacity);
-                mSelectPhotosButton.setAlpha(endOpacity);
+                mEditSelectedPhotosButton.setAlpha(endOpacity);
                 return;
             }
-            mSelectPhotosButton.animate().alpha(endOpacity)
+            mEditSelectedPhotosButton.animate().alpha(endOpacity)
                     .setDuration(EDIT_PHOTOS_BUTTON_ANIMATION_LENGTH_MS);
             mSelectPhotosDivider.animate().alpha(endOpacity)
                     .setDuration(EDIT_PHOTOS_BUTTON_ANIMATION_LENGTH_MS);
@@ -670,6 +654,24 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
                 ConfirmDialog.class.getName());
     }
 
+    private void markSingleButtonAsChecked(ButtonType buttonToMarkChecked) {
+        if (!mViewModel.getButtonStateLiveData().isInitialized()) {
+            return;
+        }
+        Map<ButtonType, ButtonState> currentStates = mViewModel.getButtonStateLiveData().getValue();
+        Map<ButtonType, ButtonState> newStates = new ArrayMap<>();
+        for (ButtonType button: currentStates.keySet()) {
+            ButtonState state = currentStates.get(button);
+            boolean isChecked = button == buttonToMarkChecked
+                    // Don't uncheck the Location Accuracy switch, if it is checked
+                    || (button == ButtonType.LOCATION_ACCURACY && state.isChecked());
+            ButtonState newState = new ButtonState(isChecked, state.isEnabled(), state.isShown(),
+                    state.getCustomRequest());
+            newStates.put(button, newState);
+        }
+        setRadioButtonsState(newStates);
+    }
+
     /**
      * A dialog warning the user that they are about to deny a permission that was granted by
      * default, or that they are denying a permission on a Pre-M app
@@ -690,7 +692,8 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
         public Dialog onCreateDialog(Bundle savedInstanceState) {
             // TODO(b/229024576): This code is duplicated, refactor ConfirmDialog for easier
             // NFF sharing
-            AppPermissionFragment fragment = (AppPermissionFragment) getParentFragment();
+            LegacyAppPermissionFragment fragment =
+                    (LegacyAppPermissionFragment) getParentFragment();
             boolean isGrantFileAccess = getArguments().getSerializable(CHANGE_REQUEST)
                     == ChangeRequest.GRANT_ALL_FILE_ACCESS;
             int positiveButtonStringResId = R.string.grant_dialog_button_deny_anyway;
@@ -721,12 +724,14 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
 
         @Override
         public void onCancel(DialogInterface dialog) {
-            AppPermissionFragment fragment = (AppPermissionFragment) getParentFragment();
+            LegacyAppPermissionFragment fragment =
+                    (LegacyAppPermissionFragment) getParentFragment();
             fragment.setRadioButtonsState(fragment.mViewModel.getButtonStateLiveData().getValue());
         }
     }
 
     @Override
+    @RequiresApi(Build.VERSION_CODES.TIRAMISU)
     public void showAdvancedConfirmDialog(AdvancedConfirmDialogArgs args) {
         AlertDialog.Builder b = new AlertDialog.Builder(getContext())
                 .setIcon(args.getIconId())
@@ -741,7 +746,8 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
                 .setPositiveButton(args.getPositiveButtonTextId(),
                         (DialogInterface dialog, int which) -> {
                             mViewModel.requestChange(args.getSetOneTime(),
-                                    AppPermissionFragment.this, AppPermissionFragment.this,
+                                    LegacyAppPermissionFragment.this,
+                                    LegacyAppPermissionFragment.this,
                                     args.getChangeRequest(), args.getButtonClicked());
                         });
         if (args.getTitleId() != 0) {
@@ -750,3 +756,4 @@ public class AppPermissionFragment extends SettingsWithLargeHeader
         b.show();
     }
 }
+// LINT.ThenChange(../v36/AppPermissionFragment.java)
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionHistoryPreference.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionHistoryPreference.java
index 5c20ef9df..933911bff 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionHistoryPreference.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionHistoryPreference.java
@@ -18,8 +18,10 @@ package com.android.permissioncontroller.permission.ui.handheld.v31;
 
 import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_DETAILS_INTERACTION;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_DETAILS_INTERACTION__ACTION__INFO_ICON_CLICKED;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_DETAILS_INTERACTION__ACTION__TIMELINE_ROW_CLICKED;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.write;
 
+import android.app.AlertDialog;
 import android.content.ActivityNotFoundException;
 import android.content.Context;
 import android.content.Intent;
@@ -28,6 +30,7 @@ import android.content.pm.ResolveInfo;
 import android.graphics.drawable.Drawable;
 import android.os.UserHandle;
 import android.text.format.DateFormat;
+import android.text.method.LinkMovementMethod;
 import android.util.Log;
 import android.view.Gravity;
 import android.view.LayoutInflater;
@@ -47,8 +50,8 @@ import com.android.permissioncontroller.permission.compat.IntentCompat;
 import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel;
 import com.android.permissioncontroller.permission.utils.Utils;
 
-import java.util.ArrayList;
 import java.util.Objects;
+import java.util.Set;
 
 /**
  * Preference for the permission history page
@@ -64,26 +67,22 @@ public class PermissionHistoryPreference extends Preference {
     private final long mAccessStartTime;
     private final long mAccessEndTime;
     private final Drawable mAppIcon;
-    private final String mTitle;
-    private final ArrayList<String> mAttributionTags;
+    private final Set<String> mAttributionTags;
     private final boolean mIsLastUsage;
-    private final Intent mIntent;
+    private Intent mIntent = null;
+    private boolean mIntentLoaded = false;
     private final boolean mShowingAttribution;
     private final PackageManager mUserPackageManager;
+    private final boolean mIsEmergencyLocationAccess;
 
     private final long mSessionId;
 
-    private Drawable mWidgetIcon;
-
-    public PermissionHistoryPreference(@NonNull Context context,
-            @NonNull UserHandle userHandle, @NonNull String pkgName,
-            @Nullable Drawable appIcon,
-            @NonNull String preferenceTitle,
-            @NonNull String permissionGroup,
-            @NonNull long accessStartTime,
-            @NonNull long accessEndTime,
-            @Nullable CharSequence summaryText, boolean showingAttribution,
-            @NonNull ArrayList<String> attributionTags, boolean isLastUsage, long sessionId) {
+    public PermissionHistoryPreference(@NonNull Context context, @NonNull UserHandle userHandle,
+            @NonNull String pkgName, @Nullable Drawable packageIcon, @NonNull String packageLabel,
+            @NonNull String permissionGroup, @NonNull long accessStartTime,
+            @NonNull long accessEndTime, @Nullable CharSequence summaryText,
+            boolean showingAttribution, @NonNull Set<String> attributionTags,
+            boolean isLastUsage, long sessionId, boolean isEmergencyLocationAccess) {
         super(context);
         mContext = context;
         Context userContext = Utils.getUserContext(context, userHandle);
@@ -93,24 +92,18 @@ public class PermissionHistoryPreference extends Preference {
         mPermissionGroup = permissionGroup;
         mAccessStartTime = accessStartTime;
         mAccessEndTime = accessEndTime;
-        mAppIcon = appIcon;
-        mTitle = preferenceTitle;
-        mWidgetIcon = null;
+        mAppIcon = packageIcon;
         mAttributionTags = attributionTags;
         mIsLastUsage = isLastUsage;
         mSessionId = sessionId;
         mShowingAttribution = showingAttribution;
+        mIsEmergencyLocationAccess = isEmergencyLocationAccess;
 
-        setTitle(mTitle);
+        setTitle(packageLabel);
         if (summaryText != null) {
             setSummary(summaryText);
         }
-
-        mIntent = getViewPermissionUsageForPeriodIntent(showingAttribution);
-        if (mIntent != null) {
-            mWidgetIcon = mContext.getDrawable(R.drawable.ic_info_outline);
-            setWidgetLayoutResource(R.layout.image_view_with_divider);
-        }
+        setWidgetLayoutResource(R.layout.image_view_with_divider);
     }
 
     @Override
@@ -135,13 +128,14 @@ public class PermissionHistoryPreference extends Preference {
         widgetFrameParent.setGravity(Gravity.TOP);
 
         TextView permissionHistoryTime = widget.findViewById(R.id.permission_history_time);
-        permissionHistoryTime.setText(DateFormat.getTimeFormat(mContext).format(mAccessEndTime));
+        permissionHistoryTime.setText(DateFormat.getTimeFormat(mContext).format(mAccessStartTime));
 
-        ImageView permissionIcon = widget.findViewById(R.id.permission_history_icon);
-        permissionIcon.setImageDrawable(mAppIcon);
+        ImageView appIcon = widget.findViewById(R.id.permission_history_icon);
+        appIcon.setImageDrawable(mAppIcon);
 
         ImageView widgetView = widgetFrame.findViewById(R.id.icon);
-        setInfoIcon(holder, widgetView);
+        View dividerVerticalBar = widgetFrame.findViewById(R.id.divider);
+        setInfoIcon(holder, widgetView, dividerVerticalBar);
 
         View dashLine = widget.findViewById(R.id.permission_history_dash_line);
         dashLine.setVisibility(mIsLastUsage ? View.GONE : View.VISIBLE);
@@ -150,24 +144,58 @@ public class PermissionHistoryPreference extends Preference {
         // It's temporarily created via a static method due to ongoing ViewModel refactoring.
         Intent intent =
                 PermissionUsageDetailsViewModel.Companion.createHistoryPreferenceClickIntent(
-                    mContext,
-                    mUserHandle,
-                    mPackageName,
-                    mPermissionGroup,
-                    mAccessStartTime,
-                    mAccessEndTime,
-                    mShowingAttribution,
-                    mAttributionTags);
-
-        setOnPreferenceClickListener((preference) -> {
-            mContext.startActivityAsUser(intent, mUserHandle);
-            return true;
-        });
+                        mContext,
+                        mUserHandle,
+                        mPackageName,
+                        mPermissionGroup,
+                        mAccessStartTime,
+                        mAccessEndTime,
+                        mShowingAttribution,
+                        mAttributionTags);
+
+        if (mIsEmergencyLocationAccess) {
+            setOnPreferenceClickListener(preference -> {
+                write(PERMISSION_DETAILS_INTERACTION,
+                        mSessionId,
+                        mPermissionGroup,
+                        mPackageName,
+                        PERMISSION_DETAILS_INTERACTION__ACTION__TIMELINE_ROW_CLICKED);
+                AlertDialog.Builder dialogBuilder = new AlertDialog.Builder(mContext)
+                        .setTitle(R.string.privacy_dashboard_emergency_location_dialog_title)
+                        .setMessage(
+                                R.string.privacy_dashboard_emergency_location_dialog_description)
+                        .setPositiveButton(R.string.app_permissions,  (dialog, which) -> {
+                            mContext.startActivityAsUser(intent, mUserHandle);
+                        })
+                        .setNegativeButton(R.string.dialog_close, null);
+
+                AlertDialog alertDialog = dialogBuilder.create();
+                alertDialog.show();
+                TextView messageView = alertDialog.findViewById(android.R.id.message);
+                if (messageView != null) {
+                    messageView.setMovementMethod(LinkMovementMethod.getInstance());
+                }
+                return true;
+            });
+        } else {
+            setOnPreferenceClickListener((preference) -> {
+                write(PERMISSION_DETAILS_INTERACTION,
+                        mSessionId,
+                        mPermissionGroup,
+                        mPackageName,
+                        PERMISSION_DETAILS_INTERACTION__ACTION__TIMELINE_ROW_CLICKED);
+                mContext.startActivityAsUser(intent, mUserHandle);
+                return true;
+            });
+        }
     }
 
-    private void setInfoIcon(@NonNull PreferenceViewHolder holder, ImageView widgetView) {
-        if (mIntent != null) {
-            widgetView.setImageDrawable(mWidgetIcon);
+    private void setInfoIcon(@NonNull PreferenceViewHolder holder, ImageView widgetView,
+            View dividerVerticalBar) {
+        Intent intent = getViewPermissionUsageForPeriodIntent();
+        if (intent != null) {
+            dividerVerticalBar.setVisibility(View.VISIBLE);
+            widgetView.setImageDrawable(mContext.getDrawable(R.drawable.ic_info_outline));
             widgetView.setOnClickListener(v -> {
                 write(PERMISSION_DETAILS_INTERACTION,
                         mSessionId,
@@ -175,7 +203,7 @@ public class PermissionHistoryPreference extends Preference {
                         mPackageName,
                         PERMISSION_DETAILS_INTERACTION__ACTION__INFO_ICON_CLICKED);
                 try {
-                    mContext.startActivityAsUser(mIntent, mUserHandle);
+                    mContext.startActivityAsUser(intent, mUserHandle);
                 } catch (ActivityNotFoundException e) {
                     Log.e(LOG_TAG, "No activity found for viewing permission usage.");
                 }
@@ -183,6 +211,9 @@ public class PermissionHistoryPreference extends Preference {
             View preferenceRootView = holder.itemView;
             preferenceRootView.setPaddingRelative(preferenceRootView.getPaddingStart(),
                     preferenceRootView.getPaddingTop(), 0, preferenceRootView.getPaddingBottom());
+        } else {
+            dividerVerticalBar.setVisibility(View.GONE);
+            widgetView.setImageDrawable(null);
         }
     }
 
@@ -191,7 +222,10 @@ public class PermissionHistoryPreference extends Preference {
      * can't be handled.
      */
     @Nullable
-    private Intent getViewPermissionUsageForPeriodIntent(boolean showingAttribution) {
+    private Intent getViewPermissionUsageForPeriodIntent() {
+        if (mIntentLoaded) {
+            return mIntent;
+        }
         Intent viewUsageIntent = new Intent();
         viewUsageIntent.setAction(Intent.ACTION_VIEW_PERMISSION_USAGE_FOR_PERIOD);
         viewUsageIntent.setPackage(mPackageName);
@@ -201,7 +235,7 @@ public class PermissionHistoryPreference extends Preference {
         viewUsageIntent.putExtra(Intent.EXTRA_START_TIME,
                 mAccessStartTime);
         viewUsageIntent.putExtra(Intent.EXTRA_END_TIME, mAccessEndTime);
-        viewUsageIntent.putExtra(IntentCompat.EXTRA_SHOWING_ATTRIBUTION, showingAttribution);
+        viewUsageIntent.putExtra(IntentCompat.EXTRA_SHOWING_ATTRIBUTION, mShowingAttribution);
         viewUsageIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
 
         ResolveInfo resolveInfo = mUserPackageManager.resolveActivity(viewUsageIntent,
@@ -209,8 +243,9 @@ public class PermissionHistoryPreference extends Preference {
         if (resolveInfo != null && resolveInfo.activityInfo != null && Objects.equals(
                 resolveInfo.activityInfo.permission,
                 android.Manifest.permission.START_VIEW_PERMISSION_USAGE)) {
-            return viewUsageIntent;
+            mIntent = viewUsageIntent;
         }
-        return null;
+        mIntentLoaded = true;
+        return mIntent;
     }
 }
\ No newline at end of file
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionUsageDetailsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionUsageDetailsFragment.java
index 621657016..3a904c466 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionUsageDetailsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionUsageDetailsFragment.java
@@ -18,6 +18,11 @@ package com.android.permissioncontroller.permission.ui.handheld.v31;
 
 import static com.android.permissioncontroller.Constants.EXTRA_SESSION_ID;
 import static com.android.permissioncontroller.Constants.INVALID_SESSION_ID;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_DETAILS_INTERACTION;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_DETAILS_INTERACTION__ACTION__MANAGE_PERMISSIONS_CLICKED;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_DETAILS_INTERACTION__ACTION__SHOW_7DAYS_CLICKED;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_DETAILS_INTERACTION__ACTION__SHOW_SYSTEM_CLICKED;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.write;
 
 import android.app.ActionBar;
 import android.app.Activity;
@@ -37,7 +42,6 @@ import android.view.MenuItem;
 import android.view.View;
 import android.view.ViewGroup;
 
-import androidx.annotation.Nullable;
 import androidx.annotation.RequiresApi;
 import androidx.coordinatorlayout.widget.CoordinatorLayout;
 import androidx.lifecycle.ViewModelProvider;
@@ -50,9 +54,9 @@ import com.android.permissioncontroller.PermissionControllerApplication;
 import com.android.permissioncontroller.R;
 import com.android.permissioncontroller.permission.ui.ManagePermissionsActivity;
 import com.android.permissioncontroller.permission.ui.handheld.SettingsWithLargeHeader;
-import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel;
+import com.android.permissioncontroller.permission.ui.model.v31.BasePermissionUsageDetailsViewModel;
 import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.AppPermissionAccessUiInfo;
-import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsUiInfo;
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsUiState;
 import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsViewModelFactory;
 import com.android.permissioncontroller.permission.utils.KotlinUtils;
 
@@ -76,16 +80,16 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
 
     private static final int MENU_SHOW_7_DAYS_DATA = Menu.FIRST + 4;
     private static final int MENU_SHOW_24_HOURS_DATA = Menu.FIRST + 5;
-    private @Nullable String mPermissionGroup;
-    private int mUsageSubtitle;
+    private String mPermissionGroup;
     private boolean mHasSystemApps;
+    private boolean mMenuItemsCreated = false;
 
     private MenuItem mShowSystemMenu;
     private MenuItem mHideSystemMenu;
     private MenuItem mShow7DaysDataMenu;
     private MenuItem mShow24HoursDataMenu;
 
-    private PermissionUsageDetailsViewModel mViewModel;
+    private BasePermissionUsageDetailsViewModel mViewModel;
 
     private long mSessionId;
 
@@ -93,17 +97,15 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         mPermissionGroup = getArguments().getString(Intent.EXTRA_PERMISSION_GROUP_NAME);
-
         if (mPermissionGroup == null) {
             Log.e(TAG, "No permission group was provided for PermissionDetailsFragment");
             return;
         }
-
         PermissionUsageDetailsViewModelFactory factory =
                 new PermissionUsageDetailsViewModelFactory(
                         PermissionControllerApplication.get(), this, mPermissionGroup);
         mViewModel =
-                new ViewModelProvider(this, factory).get(PermissionUsageDetailsViewModel.class);
+                new ViewModelProvider(this, factory).get(BasePermissionUsageDetailsViewModel.class);
 
         if (savedInstanceState != null) {
             mSessionId = savedInstanceState.getLong(SESSION_ID_KEY);
@@ -114,9 +116,7 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
         mViewModel.updateShowSystemAppsToggle(
                 getArguments().getBoolean(ManagePermissionsActivity.EXTRA_SHOW_SYSTEM, false));
         mViewModel.updateShow7DaysToggle(
-                KotlinUtils.INSTANCE.is7DayToggleEnabled()
-                        && getArguments()
-                                .getBoolean(ManagePermissionsActivity.EXTRA_SHOW_7_DAYS, false));
+                getArguments().getBoolean(ManagePermissionsActivity.EXTRA_SHOW_7_DAYS, false));
 
         setHasOptionsMenu(true);
         ActionBar ab = getActivity().getActionBar();
@@ -163,6 +163,11 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
         extendedFab.setVisibility(View.VISIBLE);
         extendedFab.setOnClickListener(
                 view -> {
+                    write(PERMISSION_DETAILS_INTERACTION,
+                            mSessionId,
+                            mPermissionGroup,
+                            null,
+                            PERMISSION_DETAILS_INTERACTION__ACTION__MANAGE_PERMISSIONS_CLICKED);
                     Intent intent =
                             new Intent(Intent.ACTION_MANAGE_PERMISSION_APPS)
                                     .putExtra(Intent.EXTRA_PERMISSION_NAME, mPermissionGroup);
@@ -190,9 +195,9 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
                             .getString(
                                     R.string.permission_group_usage_title,
                                     KotlinUtils.INSTANCE.getPermGroupLabel(
-                                            getActivity(), mPermissionGroup));
+                                            requireActivity(), mPermissionGroup));
         }
-        getActivity().setTitle(title);
+        requireActivity().setTitle(title);
     }
 
     @Override
@@ -207,31 +212,21 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
                 menu.add(Menu.NONE, MENU_SHOW_SYSTEM, Menu.NONE, R.string.menu_show_system);
         mHideSystemMenu =
                 menu.add(Menu.NONE, MENU_HIDE_SYSTEM, Menu.NONE, R.string.menu_hide_system);
-        boolean showSystem = false;
-        if (mViewModel.getShowSystemLiveData().getValue() != null) {
-            showSystem = mViewModel.getShowSystemLiveData().getValue();
-        }
-        updateShowSystemToggle(showSystem);
-
-        if (KotlinUtils.INSTANCE.is7DayToggleEnabled()) {
-            mShow7DaysDataMenu =
-                    menu.add(
-                            Menu.NONE,
-                            MENU_SHOW_7_DAYS_DATA,
-                            Menu.NONE,
-                            R.string.menu_show_7_days_data);
-            mShow24HoursDataMenu =
-                    menu.add(
-                            Menu.NONE,
-                            MENU_SHOW_24_HOURS_DATA,
-                            Menu.NONE,
-                            R.string.menu_show_24_hours_data);
-            boolean show7Days = false;
-            if (mViewModel.getShow7DaysLiveData().getValue() != null) {
-                show7Days = mViewModel.getShow7DaysLiveData().getValue();
-            }
-            updateShow7DaysToggle(show7Days);
-        }
+        mShow7DaysDataMenu =
+                menu.add(
+                        Menu.NONE,
+                        MENU_SHOW_7_DAYS_DATA,
+                        Menu.NONE,
+                        R.string.menu_show_7_days_data);
+        mShow24HoursDataMenu =
+                menu.add(
+                        Menu.NONE,
+                        MENU_SHOW_24_HOURS_DATA,
+                        Menu.NONE,
+                        R.string.menu_show_24_hours_data);
+        mMenuItemsCreated = true;
+        updateShow7DaysToggle(mViewModel.getShow7Days());
+        updateShowSystemToggle(mViewModel.getShowSystem());
     }
 
     @Override
@@ -239,16 +234,26 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
         int itemId = item.getItemId();
         switch (itemId) {
             case android.R.id.home:
-                getActivity().finishAfterTransition();
+                requireActivity().finishAfterTransition();
                 return true;
             case MENU_SHOW_SYSTEM:
+                write(PERMISSION_DETAILS_INTERACTION,
+                        mSessionId,
+                        mPermissionGroup,
+                        null,
+                        PERMISSION_DETAILS_INTERACTION__ACTION__SHOW_SYSTEM_CLICKED);
                 mViewModel.updateShowSystemAppsToggle(true);
                 break;
             case MENU_HIDE_SYSTEM:
                 mViewModel.updateShowSystemAppsToggle(false);
                 break;
             case MENU_SHOW_7_DAYS_DATA:
-                mViewModel.updateShow7DaysToggle(KotlinUtils.INSTANCE.is7DayToggleEnabled());
+                write(PERMISSION_DETAILS_INTERACTION,
+                        mSessionId,
+                        mPermissionGroup,
+                        null,
+                        PERMISSION_DETAILS_INTERACTION__ACTION__SHOW_7DAYS_CLICKED);
+                mViewModel.updateShow7DaysToggle(true);
                 break;
             case MENU_SHOW_24_HOURS_DATA:
                 mViewModel.updateShow7DaysToggle(false);
@@ -259,10 +264,12 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
     }
 
     /** Updates page content and menu items. */
-    private void updateAllUI(PermissionUsageDetailsUiInfo uiData) {
-        if (getActivity() == null) {
+    private void updateAllUI(PermissionUsageDetailsUiState uiInfo) {
+        if (getActivity() == null || uiInfo instanceof PermissionUsageDetailsUiState.Loading) {
             return;
         }
+        PermissionUsageDetailsUiState.Success uiData =
+                (PermissionUsageDetailsUiState.Success) uiInfo;
         Context context = getActivity();
         PreferenceScreen screen = getPreferenceScreen();
         if (screen == null) {
@@ -270,50 +277,34 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
             setPreferenceScreen(screen);
         }
         screen.removeAll();
-        boolean show7Days =
-                mViewModel.getShow7DaysLiveData().getValue() != null
-                        ? mViewModel.getShow7DaysLiveData().getValue()
-                        : false;
-
         Preference subtitlePreference = new Preference(context);
-        updateShow7DaysToggle(show7Days);
-        mUsageSubtitle =
-                show7Days
-                        ? R.string.permission_group_usage_subtitle_7d
-                        : R.string.permission_group_usage_subtitle_24h;
+        updateShow7DaysToggle(uiData.getShow7Days());
+        int usageSubtitle = uiData.getShow7Days()
+                ? R.string.permission_group_usage_subtitle_7d
+                : R.string.permission_group_usage_subtitle_24h;
 
         subtitlePreference.setSummary(
                 getResources()
                         .getString(
-                                mUsageSubtitle,
+                                usageSubtitle,
                                 KotlinUtils.INSTANCE.getPermGroupLabel(
-                                        getActivity(), mPermissionGroup)));
+                                        context, mPermissionGroup)));
         subtitlePreference.setSelectable(false);
         screen.addPreference(subtitlePreference);
 
-        boolean containsSystemAppAccesses = uiData.getContainsSystemAppAccesses();
+        boolean containsSystemAppAccesses = uiData.getContainsSystemAppUsage();
         if (mHasSystemApps != containsSystemAppAccesses) {
             mHasSystemApps = containsSystemAppAccesses;
         }
-        boolean showSystem =
-                mViewModel.getShowSystemLiveData().getValue() != null
-                        ? mViewModel.getShowSystemLiveData().getValue()
-                        : false;
-        updateShowSystemToggle(showSystem);
+        updateShowSystemToggle(uiData.getShowSystem());
 
         // Make these variables effectively final so that
         // we can use these captured variables in the below lambda expression
         AtomicReference<PreferenceCategory> category =
                 new AtomicReference<>(createDayCategoryPreference());
         screen.addPreference(category.get());
-        PreferenceScreen finalScreen = screen;
-
-        if (getActivity() == null) {
-            // Fragment has no Activity, return.
-            return;
-        }
-        renderHistoryPreferences(uiData.getAppPermissionAccessUiInfoList(), category, finalScreen);
 
+        renderHistoryPreferences(uiData.getAppPermissionAccessUiInfoList(), category, screen);
         setLoading(false, true);
         setProgressBarVisible(false);
     }
@@ -323,8 +314,7 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
             List<AppPermissionAccessUiInfo> appPermissionAccessUiInfoList,
             AtomicReference<PreferenceCategory> category,
             PreferenceScreen preferenceScreen) {
-        Context context = getContext();
-        long previousDateMs = 0L;
+        Context context = requireContext();
         long midnightToday =
                 ZonedDateTime.now(ZoneId.systemDefault())
                                 .truncatedTo(ChronoUnit.DAYS)
@@ -337,19 +327,20 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
                                 .toEpochSecond()
                         * 1000L;
 
+        long previousAccessDateMs = 0L;
+        ZoneId zoneId = Clock.system(ZoneId.systemDefault()).getZone();
+
         for (int i = 0; i < appPermissionAccessUiInfoList.size(); i++) {
             AppPermissionAccessUiInfo appPermissionAccessUiInfo =
                     appPermissionAccessUiInfoList.get(i);
             long accessEndTime = appPermissionAccessUiInfo.getAccessEndTime();
-            long currentDateMs =
-                    ZonedDateTime.ofInstant(
-                                            Instant.ofEpochMilli(accessEndTime),
-                                            Clock.system(ZoneId.systemDefault()).getZone())
-                                    .truncatedTo(ChronoUnit.DAYS)
-                                    .toEpochSecond()
+            long accessDateMS =
+                    ZonedDateTime.ofInstant(Instant.ofEpochMilli(accessEndTime), zoneId)
+                            .truncatedTo(ChronoUnit.DAYS)
+                            .toEpochSecond()
                             * 1000L;
-            if (currentDateMs != previousDateMs) {
-                if (previousDateMs != 0L) {
+            if (accessDateMS != previousAccessDateMs) {
+                if (previousAccessDateMs != 0L) {
                     category.set(createDayCategoryPreference());
                     preferenceScreen.addPreference(category.get());
                 }
@@ -359,14 +350,14 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
                     category.get().setTitle(R.string.permission_history_category_yesterday);
                 } else {
                     category.get()
-                            .setTitle(DateFormat.getLongDateFormat(context).format(currentDateMs));
+                            .setTitle(DateFormat.getLongDateFormat(context).format(accessDateMS));
                 }
-                previousDateMs = currentDateMs;
+                previousAccessDateMs = accessDateMS;
             }
 
             Preference permissionUsagePreference =
                     new PermissionHistoryPreference(
-                            getContext(),
+                            context,
                             appPermissionAccessUiInfo.getUserHandle(),
                             appPermissionAccessUiInfo.getPackageName(),
                             appPermissionAccessUiInfo.getBadgedPackageIcon(),
@@ -378,44 +369,36 @@ public class PermissionUsageDetailsFragment extends SettingsWithLargeHeader {
                             appPermissionAccessUiInfo.getShowingAttribution(),
                             appPermissionAccessUiInfo.getAttributionTags(),
                             i == appPermissionAccessUiInfoList.size() - 1,
-                            mSessionId);
+                            mSessionId,
+                            appPermissionAccessUiInfo.isEmergencyLocationAccess());
 
             category.get().addPreference(permissionUsagePreference);
         }
     }
 
     private void updateShowSystemToggle(boolean showSystem) {
+        if (!mMenuItemsCreated) return;
+
         if (mHasSystemApps) {
-            if (mShowSystemMenu != null) {
-                mShowSystemMenu.setVisible(!showSystem);
-                mShowSystemMenu.setEnabled(true);
-            }
+            mShowSystemMenu.setVisible(!showSystem);
+            mShowSystemMenu.setEnabled(true);
 
-            if (mHideSystemMenu != null) {
-                mHideSystemMenu.setVisible(showSystem);
-                mHideSystemMenu.setEnabled(true);
-            }
+            mHideSystemMenu.setVisible(showSystem);
+            mHideSystemMenu.setEnabled(true);
         } else {
-            if (mShowSystemMenu != null) {
-                mShowSystemMenu.setVisible(true);
-                mShowSystemMenu.setEnabled(false);
-            }
+            mShowSystemMenu.setVisible(true);
+            mShowSystemMenu.setEnabled(false);
 
-            if (mHideSystemMenu != null) {
-                mHideSystemMenu.setVisible(false);
-                mHideSystemMenu.setEnabled(false);
-            }
+            mHideSystemMenu.setVisible(false);
+            mHideSystemMenu.setEnabled(false);
         }
     }
 
     private void updateShow7DaysToggle(boolean show7Days) {
-        if (mShow7DaysDataMenu != null) {
-            mShow7DaysDataMenu.setVisible(!show7Days);
-        }
+        if (!mMenuItemsCreated) return;
 
-        if (mShow24HoursDataMenu != null) {
-            mShow24HoursDataMenu.setVisible(show7Days);
-        }
+        mShow7DaysDataMenu.setVisible(!show7Days);
+        mShow24HoursDataMenu.setVisible(show7Days);
     }
 
     private PreferenceCategory createDayCategoryPreference() {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionUsageFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionUsageFragment.java
index 7102fae9a..79db4660e 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionUsageFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v31/PermissionUsageFragment.java
@@ -20,6 +20,7 @@ import static com.android.permissioncontroller.Constants.EXTRA_SESSION_ID;
 import static com.android.permissioncontroller.Constants.INVALID_SESSION_ID;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_USAGE_FRAGMENT_INTERACTION;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_USAGE_FRAGMENT_INTERACTION__ACTION__SEE_OTHER_PERMISSIONS_CLICKED;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_USAGE_FRAGMENT_INTERACTION__ACTION__SHOW_7DAYS_CLICKED;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_USAGE_FRAGMENT_INTERACTION__ACTION__SHOW_SYSTEM_CLICKED;
 import static com.android.permissioncontroller.PermissionControllerStatsLog.write;
 
@@ -46,8 +47,6 @@ import com.android.permissioncontroller.permission.ui.handheld.SettingsWithLarge
 import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsageViewModel;
 import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsageViewModelFactory;
 import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsagesUiState;
-import com.android.permissioncontroller.permission.utils.KotlinUtils;
-import com.android.settingslib.HelpUtils;
 
 import java.util.ArrayList;
 import java.util.Comparator;
@@ -89,6 +88,7 @@ public class PermissionUsageFragment extends SettingsWithLargeHeader {
     private MenuItem mShow7DaysDataMenu;
     private MenuItem mShow24HoursDataMenu;
     private boolean mOtherExpanded;
+    private boolean mMenuItemsCreated = false;
 
     private PermissionUsageGraphicPreference mGraphic;
 
@@ -198,26 +198,21 @@ public class PermissionUsageFragment extends SettingsWithLargeHeader {
                 menu.add(Menu.NONE, MENU_SHOW_SYSTEM, Menu.NONE, R.string.menu_show_system);
         mHideSystemMenu =
                 menu.add(Menu.NONE, MENU_HIDE_SYSTEM, Menu.NONE, R.string.menu_hide_system);
+        mShow7DaysDataMenu =
+                menu.add(
+                        Menu.NONE,
+                        MENU_SHOW_7_DAYS_DATA,
+                        Menu.NONE,
+                        R.string.menu_show_7_days_data);
+        mShow24HoursDataMenu =
+                menu.add(
+                        Menu.NONE,
+                        MENU_SHOW_24_HOURS_DATA,
+                        Menu.NONE,
+                        R.string.menu_show_24_hours_data);
+        mMenuItemsCreated = true;
+        updateShow7DaysToggle(mViewModel.getShow7DaysData());
         updateShowSystemToggle(mViewModel.getShowSystemApps());
-
-        if (KotlinUtils.INSTANCE.is7DayToggleEnabled()) {
-            mShow7DaysDataMenu =
-                    menu.add(
-                            Menu.NONE,
-                            MENU_SHOW_7_DAYS_DATA,
-                            Menu.NONE,
-                            R.string.menu_show_7_days_data);
-            mShow24HoursDataMenu =
-                    menu.add(
-                            Menu.NONE,
-                            MENU_SHOW_24_HOURS_DATA,
-                            Menu.NONE,
-                            R.string.menu_show_24_hours_data);
-            updateShow7DaysToggle(mViewModel.getShow7DaysData());
-        }
-
-        HelpUtils.prepareHelpMenuItem(
-                getActivity(), menu, R.string.help_permission_usage, getClass().getName());
     }
 
     @Override
@@ -232,16 +227,20 @@ public class PermissionUsageFragment extends SettingsWithLargeHeader {
                         PERMISSION_USAGE_FRAGMENT_INTERACTION,
                         mSessionId,
                         PERMISSION_USAGE_FRAGMENT_INTERACTION__ACTION__SHOW_SYSTEM_CLICKED);
-                updateAllUI(mViewModel.updateShowSystem(true));
+                mViewModel.updateShowSystem(true);
                 break;
             case MENU_HIDE_SYSTEM:
-                updateAllUI(mViewModel.updateShowSystem(false));
+                mViewModel.updateShowSystem(false);
                 break;
             case MENU_SHOW_7_DAYS_DATA:
-                updateAllUI(mViewModel.updateShow7Days(KotlinUtils.INSTANCE.is7DayToggleEnabled()));
+                write(
+                        PERMISSION_USAGE_FRAGMENT_INTERACTION,
+                        mSessionId,
+                        PERMISSION_USAGE_FRAGMENT_INTERACTION__ACTION__SHOW_7DAYS_CLICKED);
+                mViewModel.updateShow7Days(true);
                 break;
             case MENU_SHOW_24_HOURS_DATA:
-                updateAllUI(mViewModel.updateShow7Days(false));
+                mViewModel.updateShow7Days(false);
                 break;
         }
         return super.onOptionsItemSelected(item);
@@ -261,31 +260,28 @@ public class PermissionUsageFragment extends SettingsWithLargeHeader {
     }
 
     private void updateShowSystemToggle(boolean showSystem) {
+        if (!mMenuItemsCreated) return;
+
         if (mHasSystemApps) {
-            if (mShowSystemMenu != null) {
-                mShowSystemMenu.setVisible(!showSystem);
-            }
-            if (mHideSystemMenu != null) {
-                mHideSystemMenu.setVisible(showSystem);
-            }
+            mShowSystemMenu.setVisible(!showSystem);
+            mShowSystemMenu.setEnabled(true);
+
+            mHideSystemMenu.setVisible(showSystem);
+            mHideSystemMenu.setEnabled(true);
         } else {
-            if (mShowSystemMenu != null) {
-                mShowSystemMenu.setVisible(false);
-            }
-            if (mHideSystemMenu != null) {
-                mHideSystemMenu.setVisible(false);
-            }
+            mShowSystemMenu.setVisible(true);
+            mShowSystemMenu.setEnabled(false);
+
+            mHideSystemMenu.setVisible(false);
+            mHideSystemMenu.setEnabled(false);
         }
     }
 
     private void updateShow7DaysToggle(boolean show7Days) {
-        if (mShow7DaysDataMenu != null) {
-            mShow7DaysDataMenu.setVisible(!show7Days);
-        }
+        if (!mMenuItemsCreated) return;
 
-        if (mShow24HoursDataMenu != null) {
-            mShow24HoursDataMenu.setVisible(show7Days);
-        }
+        mShow7DaysDataMenu.setVisible(!show7Days);
+        mShow24HoursDataMenu.setVisible(show7Days);
     }
 
     /** Updates page content and menu items. */
@@ -318,7 +314,6 @@ public class PermissionUsageFragment extends SettingsWithLargeHeader {
                     mSessionId,
                     PERMISSION_USAGE_FRAGMENT_INTERACTION__ACTION__SEE_OTHER_PERMISSIONS_CLICKED);
         });
-        boolean containsSystemAppUsages = permissionUsagesUiData.getShouldShowSystemToggle();
         Map<String, Integer> permissionGroupWithUsageCounts =
                 permissionUsagesUiData.getPermissionGroupUsageCount();
         List<Map.Entry<String, Integer>> permissionGroupWithUsageCountsEntries =
@@ -332,13 +327,14 @@ public class PermissionUsageFragment extends SettingsWithLargeHeader {
                         mViewModel.getPermissionGroupLabel(
                                 context, permissionGroupWithUsageCount.getKey())));
 
+        boolean containsSystemAppUsages = permissionUsagesUiData.getContainsSystemAppUsage();
         if (mHasSystemApps != containsSystemAppUsages) {
             mHasSystemApps = containsSystemAppUsages;
         }
-
-        boolean show7Days = mViewModel.getShow7DaysData();
+        boolean show7Days = permissionUsagesUiData.getShow7Days();
+        boolean showSystem = permissionUsagesUiData.getShowSystem();
         updateShow7DaysToggle(show7Days);
-        updateShowSystemToggle(mViewModel.getShowSystemApps());
+        updateShowSystemToggle(showSystem);
 
         mGraphic = new PermissionUsageGraphicPreference(context, show7Days);
         screen.addPreference(mGraphic);
@@ -351,7 +347,8 @@ public class PermissionUsageFragment extends SettingsWithLargeHeader {
                 getAdvancedInfoSummaryString(context, permissionGroupWithUsageCountsEntries);
         screen.setSummary(advancedInfoSummary);
 
-        addUIContent(context, permissionGroupWithUsageCountsEntries, category);
+        addUIContent(context, permissionGroupWithUsageCountsEntries, category,
+                showSystem, show7Days);
     }
 
     private CharSequence getAdvancedInfoSummaryString(
@@ -404,10 +401,10 @@ public class PermissionUsageFragment extends SettingsWithLargeHeader {
     private void addUIContent(
             Context context,
             List<Map.Entry<String, Integer>> permissionGroupWithUsageCounts,
-            PreferenceCategory category) {
-        boolean showSystem = mViewModel.getShowSystemApps();
-        boolean show7Days = mViewModel.getShow7DaysData();
-
+            PreferenceCategory category,
+            boolean showSystem,
+            boolean show7Days
+    ) {
         for (int i = 0; i < permissionGroupWithUsageCounts.size(); i++) {
             Map.Entry<String, Integer> permissionGroupWithUsageCount =
                     permissionGroupWithUsageCounts.get(i);
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v35/DrawableStateLinearLayout.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v35/DrawableStateLinearLayout.kt
new file mode 100644
index 000000000..e24ba1fab
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v35/DrawableStateLinearLayout.kt
@@ -0,0 +1,60 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.handheld.v35
+
+import android.content.Context
+import android.util.AttributeSet
+import android.widget.LinearLayout
+import androidx.annotation.AttrRes
+import androidx.annotation.StyleRes
+
+/** This is a simple wrapper for [LinearLayout] that allows setting an extra drawable state. */
+class DrawableStateLinearLayout : LinearLayout {
+    var extraDrawableState: IntArray? = null
+        set(value) {
+            if (field != value) {
+                field = value
+                refreshDrawableState()
+            }
+        }
+
+    constructor(context: Context) : super(context)
+
+    constructor(context: Context, attrs: AttributeSet?) : super(context, attrs)
+
+    constructor(
+        context: Context,
+        attrs: AttributeSet?,
+        @AttrRes defStyleAttr: Int
+    ) : super(context, attrs, defStyleAttr)
+
+    constructor(
+        context: Context,
+        attrs: AttributeSet?,
+        @AttrRes defStyleAttr: Int,
+        @StyleRes defStyleRes: Int
+    ) : super(context, attrs, defStyleAttr, defStyleRes)
+
+    override fun onCreateDrawableState(extraSpace: Int): IntArray {
+        val extraDrawableState =
+            extraDrawableState ?: return super.onCreateDrawableState(extraSpace)
+        return mergeDrawableStates(
+            super.onCreateDrawableState(extraSpace + extraDrawableState.size),
+            extraDrawableState
+        )
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v35/SectionPreferenceGroupAdapter.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v35/SectionPreferenceGroupAdapter.kt
new file mode 100644
index 000000000..72e066777
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v35/SectionPreferenceGroupAdapter.kt
@@ -0,0 +1,151 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.handheld.v35
+
+import android.os.Handler
+import android.os.Looper
+import android.view.View
+import androidx.preference.Preference
+import androidx.preference.PreferenceCategory
+import androidx.preference.PreferenceGroup
+import androidx.preference.PreferenceGroupAdapter
+import androidx.preference.PreferenceViewHolder
+import com.android.permissioncontroller.R
+import com.android.settingslib.widget.FooterPreference
+
+/**
+ * This is an extension over [PreferenceGroupAdapter] that allows creating visual sections for
+ * preferences. It sets the following drawable states on item views when they are
+ * [DrawableStateLinearLayout]:
+ * - [android.R.attr.state_single] if the item is the only one in a section
+ * - [android.R.attr.state_first] if the item is the first one in a section
+ * - [android.R.attr.state_middle] if the item is neither the first one or the last one in a section
+ * - [android.R.attr.state_last] if the item is the last one in a section
+ * - [R.attr.state_has_icon_space] if the item has icon space
+ *
+ * Note that [androidx.preference.PreferenceManager.PreferenceComparisonCallback] isn't supported
+ * (yet).
+ */
+class SectionPreferenceGroupAdapter(preferenceGroup: PreferenceGroup) :
+    PreferenceGroupAdapter(preferenceGroup) {
+    private var itemPositionStates = intArrayOf()
+
+    private val handler = Handler(Looper.getMainLooper())
+
+    private val syncRunnable = Runnable { buildItemPositionStates() }
+
+    init {
+        buildItemPositionStates()
+    }
+
+    override fun onPreferenceHierarchyChange(preference: Preference) {
+        super.onPreferenceHierarchyChange(preference)
+
+        // Post after super class has posted their sync runnable to update preferences.
+        handler.removeCallbacks(syncRunnable)
+        handler.post(syncRunnable)
+    }
+
+    private fun buildItemPositionStates() {
+        val itemCount = itemCount
+        if (itemPositionStates.size != itemCount) {
+            itemPositionStates = IntArray(itemCount)
+        }
+
+        var lastItemIndex = -1
+        for (i in 0..<itemCount) {
+            val preference = getItem(i)!!
+
+            if (preference.isSectionDivider) {
+                itemPositionStates[i] = 0
+                continue
+            }
+
+            val isFirstItemInFirstSection = lastItemIndex == -1
+            val isFirstItemInNewSection = lastItemIndex != i - 1
+            itemPositionStates[i] =
+                if (isFirstItemInFirstSection || isFirstItemInNewSection) {
+                    android.R.attr.state_first
+                } else {
+                    android.R.attr.state_middle
+                }
+            if (!isFirstItemInFirstSection && isFirstItemInNewSection) {
+                itemPositionStates[lastItemIndex] =
+                    if (itemPositionStates[lastItemIndex] == android.R.attr.state_first) {
+                        android.R.attr.state_single
+                    } else {
+                        android.R.attr.state_last
+                    }
+            }
+
+            lastItemIndex = i
+        }
+
+        if (lastItemIndex != -1) {
+            itemPositionStates[lastItemIndex] =
+                if (itemPositionStates[lastItemIndex] == android.R.attr.state_first) {
+                    android.R.attr.state_single
+                } else {
+                    android.R.attr.state_last
+                }
+        }
+    }
+
+    private val Preference.isSectionDivider: Boolean
+        get() = this is PreferenceCategory || this is FooterPreference
+
+    override fun onBindViewHolder(holder: PreferenceViewHolder, position: Int) {
+        super.onBindViewHolder(holder, position)
+
+        val drawableStateLinearLayout = holder.itemView as? DrawableStateLinearLayout ?: return
+        val positionState = itemPositionStates.getOrElse(position) { 0 }
+        if (positionState == 0) {
+            return
+        }
+        val iconFrame =
+            holder.findViewById(androidx.preference.R.id.icon_frame)
+                ?: holder.findViewById(android.R.id.icon_frame)
+        val hasIconSpace = iconFrame != null && iconFrame.visibility != View.GONE
+        drawableStateLinearLayout.extraDrawableState =
+            when (positionState) {
+                android.R.attr.state_single ->
+                    if (hasIconSpace) STATE_SET_SINGLE_HAS_ICON_SPACE else STATE_SET_SINGLE
+                android.R.attr.state_first ->
+                    if (hasIconSpace) STATE_SET_FIRST_HAS_ICON_SPACE else STATE_SET_FIRST
+                android.R.attr.state_middle ->
+                    if (hasIconSpace) STATE_SET_MIDDLE_HAS_ICON_SPACE else STATE_SET_MIDDLE
+                android.R.attr.state_last ->
+                    if (hasIconSpace) STATE_SET_LAST_HAS_ICON_SPACE else STATE_SET_LAST
+                else -> error(positionState)
+            }
+    }
+
+    companion object {
+        private val STATE_SET_SINGLE = intArrayOf(android.R.attr.state_single)
+        private val STATE_SET_FIRST = intArrayOf(android.R.attr.state_first)
+        private val STATE_SET_MIDDLE = intArrayOf(android.R.attr.state_middle)
+        private val STATE_SET_LAST = intArrayOf(android.R.attr.state_last)
+        private val STATE_SET_SINGLE_HAS_ICON_SPACE =
+            intArrayOf(android.R.attr.state_single, R.attr.state_has_icon_space)
+        private val STATE_SET_FIRST_HAS_ICON_SPACE =
+            intArrayOf(android.R.attr.state_first, R.attr.state_has_icon_space)
+        private val STATE_SET_MIDDLE_HAS_ICON_SPACE =
+            intArrayOf(android.R.attr.state_middle, R.attr.state_has_icon_space)
+        private val STATE_SET_LAST_HAS_ICON_SPACE =
+            intArrayOf(android.R.attr.state_last, R.attr.state_has_icon_space)
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v36/AppPermissionFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v36/AppPermissionFragment.java
new file mode 100644
index 000000000..481dc0dac
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/handheld/v36/AppPermissionFragment.java
@@ -0,0 +1,713 @@
+/*
+ * Copyright (C) 2018 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+// LINT.IfChange
+
+package com.android.permissioncontroller.permission.ui.handheld.v36;
+
+import static android.Manifest.permission_group.STORAGE;
+import static android.app.Activity.RESULT_OK;
+
+import static com.android.permissioncontroller.Constants.EXTRA_SESSION_ID;
+import static com.android.permissioncontroller.Constants.INVALID_SESSION_ID;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW_ALWAYS;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW_FOREGROUND;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ASK_EVERY_TIME;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__DENY;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__DENY_FOREGROUND;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__GRANT_FINE_LOCATION;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__PHOTOS_SELECTED;
+import static com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__REVOKE_FINE_LOCATION;
+import static com.android.permissioncontroller.permission.compat.AppPermissionFragmentCompat.PERSISTENT_DEVICE_ID;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.DENIED;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.DENIED_DO_NOT_ASK_AGAIN;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.GRANTED_ALWAYS;
+import static com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler.GRANTED_FOREGROUND_ONLY;
+import static com.android.permissioncontroller.permission.ui.ManagePermissionsActivity.EXTRA_CALLER_NAME;
+import static com.android.permissioncontroller.permission.ui.ManagePermissionsActivity.EXTRA_RESULT_PERMISSION_INTERACTED;
+import static com.android.permissioncontroller.permission.ui.ManagePermissionsActivity.EXTRA_RESULT_PERMISSION_RESULT;
+import static com.android.permissioncontroller.permission.ui.handheld.UtilsKt.pressBack;
+
+import android.app.ActionBar;
+import android.app.AlertDialog;
+import android.app.Dialog;
+import android.app.role.RoleManager;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.Intent;
+import android.graphics.drawable.Drawable;
+import android.os.Build;
+import android.os.Bundle;
+import android.os.Handler;
+import android.os.Looper;
+import android.os.UserHandle;
+import android.text.BidiFormatter;
+import android.util.ArrayMap;
+import android.util.Log;
+import android.view.LayoutInflater;
+import android.view.MenuItem;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.Toast;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.RequiresApi;
+import androidx.annotation.StringRes;
+import androidx.fragment.app.DialogFragment;
+import androidx.lifecycle.ViewModelProvider;
+import androidx.preference.Preference;
+import androidx.preference.TwoStatePreference;
+
+import com.android.modules.utils.build.SdkLevel;
+import com.android.permissioncontroller.R;
+import com.android.permissioncontroller.permission.data.FullStoragePermissionAppsLiveData.FullStoragePackageState;
+import com.android.permissioncontroller.permission.ui.GrantPermissionsViewHandler;
+import com.android.permissioncontroller.permission.ui.handheld.AllAppPermissionsFragment;
+import com.android.permissioncontroller.permission.ui.handheld.AppPermissionGroupsFragment;
+import com.android.permissioncontroller.permission.ui.handheld.PermissionAppsFragment;
+import com.android.permissioncontroller.permission.ui.handheld.PermissionPreference;
+import com.android.permissioncontroller.permission.ui.handheld.PermissionPreferenceCategory;
+import com.android.permissioncontroller.permission.ui.handheld.PermissionSelectorWithWidgetPreference;
+import com.android.permissioncontroller.permission.ui.handheld.PermissionSwitchPreference;
+import com.android.permissioncontroller.permission.ui.handheld.PermissionTwoTargetPreference;
+import com.android.permissioncontroller.permission.ui.handheld.SettingsWithLargeHeader;
+import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel;
+import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel.ButtonState;
+import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel.ButtonType;
+import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel.ChangeRequest;
+import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModelFactory;
+import com.android.permissioncontroller.permission.ui.v33.AdvancedConfirmDialogArgs;
+import com.android.permissioncontroller.permission.utils.KotlinUtils;
+import com.android.permissioncontroller.permission.utils.Utils;
+import com.android.permissioncontroller.permission.utils.v35.MultiDeviceUtils;
+import com.android.settingslib.RestrictedLockUtils;
+import com.android.settingslib.RestrictedLockUtils.EnforcedAdmin;
+import com.android.settingslib.widget.SelectorWithWidgetPreference;
+
+import kotlin.Pair;
+
+import java.util.Map;
+import java.util.Objects;
+import java.util.Set;
+
+/**
+ * Show and manage a single permission group for an app.
+ *
+ * <p>Allows the user to control whether the app is granted the permission.
+ *
+ * <p>Note: This fragment is opt-in on V and enabled on B.
+ */
+@RequiresApi(Build.VERSION_CODES.VANILLA_ICE_CREAM)
+public class AppPermissionFragment extends SettingsWithLargeHeader
+        implements AppPermissionViewModel.ConfirmDialogShowingFragment {
+    private static final String LOG_TAG = "AppPermissionFragment";
+    private static final long POST_DELAY_MS = 20;
+    private static final long EDIT_PHOTOS_BUTTON_ANIMATION_LENGTH_MS = 200L;
+
+    private @NonNull AppPermissionViewModel mViewModel;
+
+    private @NonNull PermissionPreferenceCategory mAppPermissionRationaleContainer;
+    private @NonNull PermissionPreference mAppPermissionRationaleContent;
+    private @NonNull PermissionPreferenceCategory mButtonCategory;
+    private @NonNull PermissionSelectorWithWidgetPreference mAllowButton;
+    private @NonNull SelectorWithWidgetPreference mAllowAlwaysButton;
+    private @NonNull SelectorWithWidgetPreference mAllowForegroundButton;
+    private @NonNull PermissionSelectorWithWidgetPreference mSelectButton;
+    private @NonNull SelectorWithWidgetPreference mAskOneTimeButton;
+    private @NonNull SelectorWithWidgetPreference mAskButton;
+    private @NonNull SelectorWithWidgetPreference mDenyButton;
+    private @NonNull SelectorWithWidgetPreference mDenyForegroundButton;
+    private @NonNull PermissionSwitchPreference mLocationAccuracySwitch;
+    private @NonNull PermissionTwoTargetPreference mDetails;
+    private @NonNull PermissionPreference mFooterLink1;
+    private @NonNull PermissionPreference mFooterLink2;
+    private @NonNull PermissionPreference mFooterStorageSpecialAppAccess;
+    private @NonNull PermissionPreference mAdditionalInfo;
+
+    private @NonNull String mPackageName;
+    private @NonNull String mPermGroupName;
+    private @NonNull UserHandle mUser;
+    private boolean mIsStorageGroup;
+    private boolean mIsInitialLoad;
+    // This prevents the user from clicking the photo picker button multiple times in succession
+    private boolean mPhotoPickerTriggered;
+    private long mSessionId;
+    private String mPersistentDeviceId;
+
+    private @NonNull String mPackageLabel;
+    private @NonNull String mPermGroupLabel;
+    private Drawable mPackageIcon;
+    private @NonNull RoleManager mRoleManager;
+
+    @Override
+    public void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+
+        setHasOptionsMenu(true);
+        ActionBar ab = getActivity().getActionBar();
+        if (ab != null) {
+            ab.setDisplayHomeAsUpEnabled(true);
+        }
+
+        mPackageName = getArguments().getString(Intent.EXTRA_PACKAGE_NAME);
+        mPermGroupName = getArguments().getString(Intent.EXTRA_PERMISSION_GROUP_NAME);
+        if (mPermGroupName == null) {
+            mPermGroupName = getArguments().getString(Intent.EXTRA_PERMISSION_NAME);
+        }
+        mIsStorageGroup = Objects.equals(mPermGroupName, STORAGE);
+        mUser = getArguments().getParcelable(Intent.EXTRA_USER);
+        mPackageLabel = BidiFormatter.getInstance().unicodeWrap(
+                KotlinUtils.INSTANCE.getPackageLabel(getActivity().getApplication(), mPackageName,
+                        mUser));
+        mPermGroupLabel = KotlinUtils.INSTANCE.getPermGroupLabel(getContext(),
+                mPermGroupName).toString();
+        mPackageIcon = KotlinUtils.INSTANCE.getBadgedPackageIcon(getActivity().getApplication(),
+                mPackageName, mUser);
+        mSessionId = getArguments().getLong(EXTRA_SESSION_ID, INVALID_SESSION_ID);
+
+        mPersistentDeviceId = getArguments().getString(PERSISTENT_DEVICE_ID,
+                MultiDeviceUtils.getDefaultDevicePersistentDeviceId());
+
+        AppPermissionViewModelFactory factory = new AppPermissionViewModelFactory(
+                getActivity().getApplication(), mPackageName, mPermGroupName, mUser, mSessionId,
+                mPersistentDeviceId);
+        mViewModel = new ViewModelProvider(this, factory).get(AppPermissionViewModel.class);
+        Handler delayHandler = new Handler(Looper.getMainLooper());
+        mViewModel.getButtonStateLiveData().observe(this, buttonState -> {
+            if (mIsInitialLoad) {
+                setRadioButtonsState(buttonState);
+            } else {
+                delayHandler.removeCallbacksAndMessages(null);
+                delayHandler.postDelayed(() -> setRadioButtonsState(buttonState), POST_DELAY_MS);
+            }
+        });
+        mViewModel.getDetailResIdLiveData().observe(this, this::setDetail);
+        mViewModel.getShowAdminSupportLiveData().observe(this, this::setAdminSupportDetail);
+        if (mIsStorageGroup) {
+            mViewModel.getFullStorageStateLiveData().observe(this, this::setSpecialStorageState);
+        }
+        mViewModel.getShowPermissionRationaleLiveData().observe(this,
+                this::showPermissionRationaleDialog);
+
+        mRoleManager = Utils.getSystemServiceSafe(getContext(), RoleManager.class);
+    }
+
+    @Override
+    public void onCreatePreferences(Bundle bundle, String s) {
+        super.onCreatePreferences(bundle, s);
+        addPreferencesFromResource(R.xml.app_permission);
+
+        mAppPermissionRationaleContainer = requirePreference("app_permission_rationale_container");
+        mAppPermissionRationaleContent = requirePreference("app_permission_rationale");
+        mButtonCategory = requirePreference("app_permission_button_category");
+        mAllowButton = requirePreference("app_permission_allow_radio_button");
+        mAllowAlwaysButton = requirePreference("app_permission_allow_always_radio_button");
+        mAllowForegroundButton =
+                requirePreference("app_permission_allow_foreground_only_radio_button");
+        mSelectButton = requirePreference("app_permission_select_photos_radio_button");
+        mAskOneTimeButton = requirePreference("app_permission_ask_one_time_radio_button");
+        mAskButton = requirePreference("app_permission_ask_radio_button");
+        mDenyButton = requirePreference("app_permission_deny_radio_button");
+        mDenyForegroundButton = requirePreference("app_permission_deny_foreground_radio_button");
+        mLocationAccuracySwitch = requirePreference("app_permission_location_accuracy_switch");
+        mDetails = requirePreference("app_permission_details");
+        mFooterLink1 = requirePreference("app_permission_footer_link_1");
+        mFooterLink2 = requirePreference("app_permission_footer_link_2");
+        mFooterStorageSpecialAppAccess =
+                requirePreference("app_permission_footer_storage_special_app_access");
+        mAdditionalInfo = requirePreference("app_permission_additional_info");
+    }
+
+    @SuppressWarnings("TypeParameterUnusedInFormals")
+    private <T extends Preference> @NonNull T requirePreference(@NonNull CharSequence key) {
+        return Objects.requireNonNull(findPreference(key),
+                "Failed to find preference '" + key + "'");
+    }
+
+    @Override
+    public View onCreateView(LayoutInflater inflater, ViewGroup container,
+            Bundle savedInstanceState) {
+        Context context = getContext();
+
+        mIsInitialLoad = true;
+
+        setHeader(mPackageIcon, mPackageLabel, null, null, false);
+
+        String text = null;
+        if (MultiDeviceUtils.isDefaultDeviceId(mPersistentDeviceId)) {
+            text = context.getString(R.string.app_permission_header, mPermGroupLabel);
+        } else {
+            final String deviceName = MultiDeviceUtils.getDeviceName(context, mPersistentDeviceId);
+            text = context.getString(R.string.app_permission_header_with_device_name,
+                    mPermGroupLabel, deviceName);
+        }
+        mButtonCategory.setTitle(text);
+
+        mFooterLink1.setSummary(context.getString(
+                R.string.app_permission_footer_app_permissions_link, mPackageLabel));
+        String caller = getArguments().getString(EXTRA_CALLER_NAME);
+        setBottomLinkState(mFooterLink1, caller, Intent.ACTION_MANAGE_APP_PERMISSIONS);
+
+        setBottomLinkState(mFooterLink2, caller, Intent.ACTION_MANAGE_PERMISSION_APPS);
+
+        Set<String> exemptedPackages = Utils.getExemptedPackages(mRoleManager);
+        if (exemptedPackages.contains(mPackageName)) {
+            int additional_info_label = Utils.isStatusBarIndicatorPermission(mPermGroupName)
+                    ? R.string.exempt_mic_camera_info_label : R.string.exempt_info_label;
+            mAdditionalInfo.setSummary(context.getString(additional_info_label, mPackageLabel));
+            mAdditionalInfo.setVisible(true);
+        } else {
+            mAdditionalInfo.setVisible(false);
+        }
+
+        if (mViewModel.getButtonStateLiveData().getValue() != null) {
+            setRadioButtonsState(mViewModel.getButtonStateLiveData().getValue());
+        } else {
+            mAllowButton.setVisible(false);
+            mAllowAlwaysButton.setVisible(false);
+            mAllowForegroundButton.setVisible(false);
+            mAskOneTimeButton.setVisible(false);
+            mAskButton.setVisible(false);
+            mDenyButton.setVisible(false);
+            mDenyForegroundButton.setVisible(false);
+            mLocationAccuracySwitch.setVisible(false);
+            mSelectButton.setVisible(false);
+            mSelectButton.setExtraWidgetOnClickListener(null);
+        }
+
+        if (mViewModel.getFullStorageStateLiveData().isInitialized() && mIsStorageGroup) {
+            setSpecialStorageState(mViewModel.getFullStorageStateLiveData().getValue());
+        } else {
+            mFooterStorageSpecialAppAccess.setVisible(false);
+        }
+
+        // Avoid an animation by showing this Preference immediately
+        showPermissionRationaleDialog(mViewModel.getShowPermissionRationaleLiveData().getValue());
+
+        getActivity().setTitle(
+                getPreferenceManager().getContext().getString(R.string.app_permission_title,
+                        mPermGroupLabel));
+
+        return super.onCreateView(inflater, container, savedInstanceState);
+    }
+
+    public void onResume() {
+        super.onResume();
+        // If we're returning to the fragment, photo picker hasn't been triggered
+        mPhotoPickerTriggered = false;
+    }
+
+    private void showPermissionRationaleDialog(Boolean showPermissionRationale) {
+        showPermissionRationaleDialog(showPermissionRationale == Boolean.TRUE);
+    }
+
+    private void showPermissionRationaleDialog(boolean showPermissionRationale) {
+        if (!showPermissionRationale) {
+            mAppPermissionRationaleContainer.setVisible(false);
+        } else {
+            mAppPermissionRationaleContainer.setVisible(true);
+            mAppPermissionRationaleContent.setOnPreferenceClickListener((v) -> {
+                if (SdkLevel.isAtLeastU()) {
+                    mViewModel.showPermissionRationaleActivity(getActivity(), mPermGroupName);
+                }
+                return true;
+            });
+        }
+    }
+
+    private void setBottomLinkState(Preference preference, String caller, String action) {
+        if ((Objects.equals(caller, AppPermissionGroupsFragment.class.getName())
+                && action.equals(Intent.ACTION_MANAGE_APP_PERMISSIONS))
+                || (Objects.equals(caller, PermissionAppsFragment.class.getName())
+                && action.equals(Intent.ACTION_MANAGE_PERMISSION_APPS))) {
+            preference.setVisible(false);
+        } else {
+            preference.setOnPreferenceClickListener((v) -> {
+                Bundle args;
+                if (action.equals(Intent.ACTION_MANAGE_APP_PERMISSIONS)) {
+                    args = AppPermissionGroupsFragment.createArgs(mPackageName, mUser,
+                            mSessionId, true);
+                } else {
+                    args = PermissionAppsFragment.createArgs(mPermGroupName, mSessionId);
+                }
+                mViewModel.showBottomLinkPage(this, action, args);
+                return true;
+            });
+        }
+    }
+
+    @Override
+    public boolean onOptionsItemSelected(MenuItem item) {
+        if (item.getItemId() == android.R.id.home) {
+            pressBack(this);
+            return true;
+        }
+        return super.onOptionsItemSelected(item);
+    }
+
+    private void setRadioButtonsState(Map<ButtonType, ButtonState> states) {
+        if (states == null && !mViewModel.getButtonStateLiveData().isStale()) {
+            pressBack(this);
+            Log.w(LOG_TAG, "invalid package " + mPackageName + " or perm group "
+                    + mPermGroupName);
+            Toast.makeText(
+                    getActivity(), R.string.app_not_found_dlg_title, Toast.LENGTH_LONG).show();
+            return;
+        } else if (states == null) {
+            return;
+        }
+
+        mAllowButton.setOnClickListener((v) -> {
+            allowButtonFrameClickListener();
+        });
+        mAllowButton.setOnDisabledClickListener((v) -> {
+            allowButtonFrameClickListener();
+        });
+        mAllowAlwaysButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.ALLOW_ALWAYS);
+            if (mIsStorageGroup) {
+                showConfirmDialog(ChangeRequest.GRANT_ALL_FILE_ACCESS,
+                        R.string.special_file_access_dialog, -1, false);
+            } else {
+                mViewModel.requestChange(false, this, this, ChangeRequest.GRANT_BOTH,
+                        APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW_ALWAYS);
+            }
+            setResult(GRANTED_ALWAYS);
+        });
+        mAllowForegroundButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.ALLOW_FOREGROUND);
+            if (mIsStorageGroup) {
+                mViewModel.setAllFilesAccess(false);
+                mViewModel.requestChange(false, this, this, ChangeRequest.GRANT_BOTH,
+                        APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW);
+                setResult(GRANTED_ALWAYS);
+            } else {
+                mViewModel.requestChange(false, this, this, ChangeRequest.GRANT_FOREGROUND_ONLY,
+                        APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW_FOREGROUND);
+                setResult(GRANTED_FOREGROUND_ONLY);
+            }
+        });
+        mAskOneTimeButton.setOnClickListener((v) -> {
+            // mAskOneTimeButton only shows if checked hence should do nothing
+            markSingleButtonAsChecked(ButtonType.ASK_ONCE);
+        });
+        mAskButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.ASK);
+            mViewModel.requestChange(true, this, this, ChangeRequest.REVOKE_BOTH,
+                    APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ASK_EVERY_TIME);
+            setResult(DENIED);
+        });
+        mSelectButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.SELECT_PHOTOS);
+            int buttonPressed =
+                    APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__PHOTOS_SELECTED;
+            mViewModel.requestChange(false, this, this, ChangeRequest.PHOTOS_SELECTED,
+                    buttonPressed);
+        });
+
+        if (isButtonChecked(states, ButtonType.SELECT_PHOTOS)) {
+            // Show the clickable extra widget
+            // TODO(b/366269715): make the widget show/hide via animation
+            mSelectButton.setExtraWidgetOnClickListener((v) -> {
+                if (isButtonChecked(states, ButtonType.SELECT_PHOTOS) && !mPhotoPickerTriggered) {
+                    mPhotoPickerTriggered = true;
+                    mViewModel.openPhotoPicker(this);
+                }
+            });
+        } else {
+            // Hide the clickable extra widget
+            mSelectButton.setExtraWidgetOnClickListener(null);
+        }
+
+        mDenyButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.DENY);
+            if (mViewModel.getFullStorageStateLiveData().getValue() != null
+                    && !mViewModel.getFullStorageStateLiveData().getValue().isLegacy()) {
+                mViewModel.setAllFilesAccess(false);
+            }
+            mViewModel.requestChange(false, this, this, ChangeRequest.REVOKE_BOTH,
+                    APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__DENY);
+            setResult(DENIED_DO_NOT_ASK_AGAIN);
+        });
+        mDenyForegroundButton.setOnClickListener((v) -> {
+            markSingleButtonAsChecked(ButtonType.DENY_FOREGROUND);
+            mViewModel.requestChange(false, this, this, ChangeRequest.REVOKE_FOREGROUND,
+                    APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__DENY_FOREGROUND);
+            setResult(DENIED_DO_NOT_ASK_AGAIN);
+        });
+        // Set long variable names to new variables to bypass linter errors.
+        int grantFineLocation =
+                APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__GRANT_FINE_LOCATION;
+        int revokeFineLocation =
+                APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__REVOKE_FINE_LOCATION;
+
+        mLocationAccuracySwitch.setOnPreferenceChangeListener((pref, newValue) -> {
+            if ((Boolean) newValue) {
+                mViewModel.requestChange(false, this, this, ChangeRequest.GRANT_FINE_LOCATION,
+                        grantFineLocation);
+            } else {
+                mViewModel.requestChange(false, this, this, ChangeRequest.REVOKE_FINE_LOCATION,
+                        revokeFineLocation);
+            }
+            // Don't actually toggle the switch yet. (Allow livedata observer to do so.)
+            return false;
+        });
+
+        setButtonState(mAllowButton, states.get(ButtonType.ALLOW));
+        setButtonState(mAllowAlwaysButton, states.get(ButtonType.ALLOW_ALWAYS));
+        setButtonState(mAllowForegroundButton, states.get(ButtonType.ALLOW_FOREGROUND));
+        setButtonState(mAskOneTimeButton, states.get(ButtonType.ASK_ONCE));
+        setButtonState(mAskButton, states.get(ButtonType.ASK));
+        setButtonState(mDenyButton, states.get(ButtonType.DENY));
+        setButtonState(mDenyForegroundButton, states.get(ButtonType.DENY_FOREGROUND));
+        setButtonState(mSelectButton, states.get(ButtonType.SELECT_PHOTOS));
+        if (mSelectButton.isVisible()) {
+            mAllowButton.setTitle(R.string.app_permission_button_always_allow_all);
+        } else {
+            mAllowButton.setTitle(R.string.app_permission_button_allow);
+        }
+
+        setButtonState(mLocationAccuracySwitch, states.get(ButtonType.LOCATION_ACCURACY));
+
+        mIsInitialLoad = false;
+
+        if (mViewModel.getFullStorageStateLiveData().isInitialized()) {
+            setSpecialStorageState(mViewModel.getFullStorageStateLiveData().getValue());
+        }
+    }
+
+    private void allowButtonFrameClickListener() {
+        if (!mAllowButton.isEnabled()) {
+            mViewModel.handleDisabledAllowButton(this);
+        } else {
+            markSingleButtonAsChecked(ButtonType.ALLOW);
+            mViewModel.requestChange(false, this, this, ChangeRequest.GRANT_FOREGROUND,
+                    APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW);
+            setResult(GRANTED_ALWAYS);
+        }
+    }
+
+    private void setButtonState(TwoStatePreference button,
+            AppPermissionViewModel.ButtonState state) {
+        button.setVisible(state.isShown());
+        button.setChecked(state.isChecked());
+        button.setEnabled(state.isEnabled());
+    }
+
+    private boolean isButtonChecked(Map<ButtonType, ButtonState> state, ButtonType button) {
+        return state.containsKey(button) && state.get(button).isChecked();
+    }
+
+    private void setSpecialStorageState(FullStoragePackageState storageState) {
+        if (!mAllowButton.isVisible() || !mIsStorageGroup) {
+            mFooterStorageSpecialAppAccess.setVisible(false);
+            return;
+        }
+
+        mAllowAlwaysButton.setTitle(R.string.app_permission_button_allow_all_files);
+        mAllowForegroundButton.setTitle(R.string.app_permission_button_allow_media_only);
+
+        if (storageState == null) {
+            mFooterStorageSpecialAppAccess.setVisible(false);
+            return;
+        }
+
+        if (storageState.isLegacy()) {
+            mAllowButton.setTitle(R.string.app_permission_button_allow_all_files);
+            mFooterStorageSpecialAppAccess.setVisible(false);
+            return;
+        }
+
+        mFooterStorageSpecialAppAccess.setVisible(true);
+    }
+
+    private void setResult(@GrantPermissionsViewHandler.Result int result) {
+        if (!mPackageName.equals(
+                getActivity().getIntent().getStringExtra(Intent.EXTRA_PACKAGE_NAME))) {
+            return;
+        }
+        Intent intent = new Intent()
+                .putExtra(EXTRA_RESULT_PERMISSION_INTERACTED, mPermGroupName)
+                .putExtra(EXTRA_RESULT_PERMISSION_RESULT, result);
+        getActivity().setResult(RESULT_OK, intent);
+    }
+
+    private void setDetail(Pair<Integer, Integer> detailResIds) {
+        if (detailResIds == null) {
+            mDetails.setOnSecondTargetClickListener(null);
+            return;
+        }
+        if (detailResIds.getSecond() != null) {
+            // If the permissions are individually controlled, also show a link to the page that
+            // lets you control them.
+            mDetails.setExtraWidgetIconRes(R.drawable.ic_settings);
+            Bundle args = AllAppPermissionsFragment.createArgs(mPackageName, mPermGroupName, mUser);
+            mDetails.setOnSecondTargetClickListener((v) ->
+                    mViewModel.showAllPermissions(this, args));
+            mDetails.setSummary(getPreferenceManager().getContext().getString(
+                    detailResIds.getFirst(), detailResIds.getSecond()));
+        } else {
+            mDetails.setOnSecondTargetClickListener(null);
+            mDetails.setSummary(getPreferenceManager().getContext().getString(
+                    detailResIds.getFirst()));
+        }
+        mDetails.setVisible(true);
+    }
+
+    private void setAdminSupportDetail(EnforcedAdmin admin) {
+        if (admin != null) {
+            mDetails.setExtraWidgetIconRes(R.drawable.ic_info_outline);
+            mDetails.setOnSecondTargetClickListener((v) ->
+                    RestrictedLockUtils.sendShowAdminSupportDetailsIntent(getContext(), admin));
+        } else {
+            mDetails.setOnSecondTargetClickListener(null);
+        }
+    }
+
+    /**
+     * Show a dialog that warns the users that they are about to revoke permissions that were
+     * granted by default, or that they are about to grant full file access to an app.
+     *
+     *
+     * The order of operation to revoke a permission granted by default is:
+     * 1. `showConfirmDialog`
+     * 1. [ConfirmDialog.onCreateDialog]
+     * 1. [AppPermissionViewModel.onDenyAnyWay] or [AppPermissionViewModel.onConfirmFileAccess]
+     * TODO: Remove once data can be passed between dialogs and fragments with nav component
+     *
+     * @param changeRequest Whether background or foreground should be changed
+     * @param messageId     The Id of the string message to show
+     * @param buttonPressed Button which was pressed to initiate the dialog, one of
+     *                      AppPermissionFragmentActionReported.button_pressed constants
+     * @param oneTime       Whether the one-time (ask) button was clicked rather than the deny
+     *                      button
+     */
+    @Override
+    public void showConfirmDialog(ChangeRequest changeRequest, @StringRes int messageId,
+            int buttonPressed, boolean oneTime) {
+        Bundle args = getArguments().deepCopy();
+        args.putInt(ConfirmDialog.MSG, messageId);
+        args.putSerializable(ConfirmDialog.CHANGE_REQUEST, changeRequest);
+        args.putInt(ConfirmDialog.BUTTON, buttonPressed);
+        args.putBoolean(ConfirmDialog.ONE_TIME, oneTime);
+        ConfirmDialog defaultDenyDialog = new ConfirmDialog();
+        defaultDenyDialog.setCancelable(true);
+        defaultDenyDialog.setArguments(args);
+        defaultDenyDialog.show(getChildFragmentManager().beginTransaction(),
+                ConfirmDialog.class.getName());
+    }
+
+    private void markSingleButtonAsChecked(ButtonType buttonToMarkChecked) {
+        if (!mViewModel.getButtonStateLiveData().isInitialized()) {
+            return;
+        }
+        Map<ButtonType, ButtonState> currentStates = mViewModel.getButtonStateLiveData().getValue();
+        Map<ButtonType, ButtonState> newStates = new ArrayMap<>();
+        for (ButtonType button: currentStates.keySet()) {
+            ButtonState state = currentStates.get(button);
+            boolean isChecked = button == buttonToMarkChecked
+                    // Don't uncheck the Location Accuracy switch, if it is checked
+                    || (button == ButtonType.LOCATION_ACCURACY && state.isChecked());
+            ButtonState newState = new ButtonState(isChecked, state.isEnabled(), state.isShown(),
+                    state.getCustomRequest());
+            newStates.put(button, newState);
+        }
+        setRadioButtonsState(newStates);
+    }
+
+    /**
+     * A dialog warning the user that they are about to deny a permission that was granted by
+     * default, or that they are denying a permission on a Pre-M app
+     *
+     * @see AppPermissionViewModel.ConfirmDialogShowingFragment#showConfirmDialog(ChangeRequest,
+     * int, int, boolean)
+     * @see #showConfirmDialog(ChangeRequest, int, int)
+     */
+    public static class ConfirmDialog extends DialogFragment {
+        static final String MSG = ConfirmDialog.class.getName() + ".arg.msg";
+        static final String CHANGE_REQUEST = ConfirmDialog.class.getName()
+                + ".arg.changeRequest";
+        private static final String KEY = ConfirmDialog.class.getName() + ".arg.key";
+        private static final String BUTTON = ConfirmDialog.class.getName() + ".arg.button";
+        private static final String ONE_TIME = ConfirmDialog.class.getName() + ".arg.onetime";
+        private static int sCode =  APP_PERMISSION_FRAGMENT_ACTION_REPORTED__BUTTON_PRESSED__ALLOW;
+        @Override
+        public Dialog onCreateDialog(Bundle savedInstanceState) {
+            // TODO(b/229024576): This code is duplicated, refactor ConfirmDialog for easier
+            // NFF sharing
+            AppPermissionFragment fragment = (AppPermissionFragment) getParentFragment();
+            boolean isGrantFileAccess = getArguments().getSerializable(CHANGE_REQUEST)
+                    == ChangeRequest.GRANT_ALL_FILE_ACCESS;
+            int positiveButtonStringResId = R.string.grant_dialog_button_deny_anyway;
+            if (isGrantFileAccess) {
+                positiveButtonStringResId = R.string.grant_dialog_button_allow;
+            }
+            AlertDialog.Builder b = new AlertDialog.Builder(getContext())
+                    .setMessage(getArguments().getInt(MSG))
+                    .setNegativeButton(R.string.cancel,
+                            (DialogInterface dialog, int which) -> dialog.cancel())
+                    .setPositiveButton(positiveButtonStringResId,
+                            (DialogInterface dialog, int which) -> {
+                                if (isGrantFileAccess) {
+                                    fragment.mViewModel.setAllFilesAccess(true);
+                                    fragment.mViewModel.requestChange(false, fragment,
+                                            fragment, ChangeRequest.GRANT_BOTH, sCode);
+                                } else {
+                                    fragment.mViewModel.onDenyAnyWay((ChangeRequest)
+                                                    getArguments().getSerializable(CHANGE_REQUEST),
+                                            getArguments().getInt(BUTTON),
+                                            getArguments().getBoolean(ONE_TIME));
+                                }
+                            });
+            Dialog d = b.create();
+            d.setCanceledOnTouchOutside(true);
+            return d;
+        }
+
+        @Override
+        public void onCancel(DialogInterface dialog) {
+            AppPermissionFragment fragment = (AppPermissionFragment) getParentFragment();
+            fragment.setRadioButtonsState(fragment.mViewModel.getButtonStateLiveData().getValue());
+        }
+    }
+
+    @Override
+    @RequiresApi(Build.VERSION_CODES.TIRAMISU)
+    public void showAdvancedConfirmDialog(AdvancedConfirmDialogArgs args) {
+        AlertDialog.Builder b = new AlertDialog.Builder(getContext())
+                .setIcon(args.getIconId())
+                .setMessage(args.getMessageId())
+                .setOnCancelListener((DialogInterface dialog) -> {
+                    setRadioButtonsState(mViewModel.getButtonStateLiveData().getValue());
+                })
+                .setNegativeButton(args.getNegativeButtonTextId(),
+                        (DialogInterface dialog, int which) -> {
+                            setRadioButtonsState(mViewModel.getButtonStateLiveData().getValue());
+                        })
+                .setPositiveButton(args.getPositiveButtonTextId(),
+                        (DialogInterface dialog, int which) -> {
+                            mViewModel.requestChange(args.getSetOneTime(),
+                                    AppPermissionFragment.this, AppPermissionFragment.this,
+                                    args.getChangeRequest(), args.getButtonClicked());
+                        });
+        if (args.getTitleId() != 0) {
+            b.setTitle(args.getTitleId());
+        }
+        b.show();
+    }
+}
+// LINT.ThenChange(../max35/LegacyAppPermissionFragment.java)
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/AppPermissionActivity.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/AppPermissionActivity.java
index 0ec003cb1..5ca71b902 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/AppPermissionActivity.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/AppPermissionActivity.java
@@ -36,6 +36,7 @@ import androidx.fragment.app.FragmentActivity;
 
 import com.android.permissioncontroller.DeviceUtils;
 import com.android.permissioncontroller.R;
+import com.android.permissioncontroller.permission.compat.AppPermissionFragmentCompat;
 import com.android.permissioncontroller.permission.ui.LocationProviderInterceptDialog;
 import com.android.permissioncontroller.permission.ui.ManagePermissionsActivity;
 import com.android.permissioncontroller.permission.ui.auto.AutoAppPermissionFragment;
@@ -163,8 +164,8 @@ public final class AppPermissionActivity extends FragmentActivity {
         } else if (DeviceUtils.isTelevision(this)) {
             Fragment androidXFragment = new AppPermissionFragment();
             androidXFragment.setArguments(
-                    AppPermissionFragment.createArgs(
-                            packageName, permissionName, groupName, userHandle, null, 0, null));
+                    AppPermissionFragmentCompat.createArgs(packageName, permissionName, groupName,
+                            userHandle, null, 0, null, null));
             getSupportFragmentManager().beginTransaction()
                     .replace(android.R.id.content, androidXFragment)
                     .commit();
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/PermissionUsageDetailsViewModelLegacy.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/PermissionUsageDetailsViewModelLegacy.kt
index c782a85f8..1369bfdaa 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/PermissionUsageDetailsViewModelLegacy.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/PermissionUsageDetailsViewModelLegacy.kt
@@ -40,7 +40,6 @@ import com.android.permissioncontroller.permission.model.v31.AppPermissionUsage.
 import com.android.permissioncontroller.permission.model.v31.PermissionUsages
 import com.android.permissioncontroller.permission.ui.handheld.v31.getDurationUsedStr
 import com.android.permissioncontroller.permission.ui.handheld.v31.shouldShowSubattributionInPermissionsDashboard
-import com.android.permissioncontroller.permission.utils.KotlinUtils
 import com.android.permissioncontroller.permission.utils.KotlinUtils.getPackageLabel
 import com.android.permissioncontroller.permission.utils.PermissionMapping
 import com.android.permissioncontroller.permission.utils.StringUtils
@@ -110,7 +109,7 @@ class PermissionUsageDetailsViewModelLegacy(
         show7Days: Boolean
     ): PermissionUsageDetailsUiData {
         val showPermissionUsagesDuration =
-            if (KotlinUtils.is7DayToggleEnabled() && show7Days) {
+            if (show7Days) {
                 TIME_7_DAYS_DURATION
             } else {
                 TIME_24_HOURS_DURATION
@@ -185,7 +184,8 @@ class PermissionUsageDetailsViewModelLegacy(
         group: String
     ): List<AppPermissionTimelineUsage> {
         val exemptedPackages = Utils.getExemptedPackages(roleManager)
-        return appPermissionUsages.filter { !exemptedPackages.contains(it.packageName) }
+        return appPermissionUsages
+            .filter { !exemptedPackages.contains(it.packageName) }
             .map { appPermissionUsage ->
                 getAppPermissionTimelineUsages(
                     appPermissionUsage.app,
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/PermissionUsageViewModelLegacy.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/PermissionUsageViewModelLegacy.kt
deleted file mode 100644
index 3032dece5..000000000
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/legacy/PermissionUsageViewModelLegacy.kt
+++ /dev/null
@@ -1,242 +0,0 @@
-/*
- * Copyright (C) 2022 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-@file:Suppress("DEPRECATION")
-
-package com.android.permissioncontroller.permission.ui.legacy
-
-import android.Manifest
-import android.app.LoaderManager
-import android.app.role.RoleManager
-import android.content.Context
-import android.os.Build
-import androidx.annotation.RequiresApi
-import androidx.lifecycle.ViewModel
-import androidx.lifecycle.ViewModelProvider
-import com.android.permissioncontroller.permission.model.AppPermissionGroup
-import com.android.permissioncontroller.permission.model.legacy.PermissionApps.PermissionApp
-import com.android.permissioncontroller.permission.model.v31.AppPermissionUsage
-import com.android.permissioncontroller.permission.model.v31.PermissionUsages
-import com.android.permissioncontroller.permission.utils.KotlinUtils
-import com.android.permissioncontroller.permission.utils.KotlinUtils.getPermGroupLabel
-import com.android.permissioncontroller.permission.utils.PermissionMapping
-import com.android.permissioncontroller.permission.utils.Utils
-import java.time.Instant
-import java.util.concurrent.TimeUnit
-import kotlin.math.max
-
-/** [ViewModel] for Permission Usage fragments. */
-@RequiresApi(Build.VERSION_CODES.S)
-class PermissionUsageViewModelLegacy(val roleManager: RoleManager) : ViewModel() {
-
-    private val exemptedPackages: Set<String> = Utils.getExemptedPackages(roleManager)
-
-    /** Companion object for [PermissionUsageViewModelLegacy]. */
-    companion object {
-        /** TODO(ewol): Use the config setting to determine amount of time to show. */
-        private val TIME_FILTER_MILLIS = TimeUnit.DAYS.toMillis(7)
-        private val TIME_7_DAYS_DURATION = TimeUnit.DAYS.toMillis(7)
-        private val TIME_24_HOURS_DURATION = TimeUnit.DAYS.toMillis(1)
-        /** Permission groups that should be hidden from the permissions usage UI. */
-        private val EXEMPTED_PERMISSION_GROUPS = setOf(Manifest.permission_group.NOTIFICATIONS)
-        @JvmStatic
-        /** Map to represent ordering for permission groups in the permissions usage UI. */
-        val PERMISSION_GROUP_ORDER: Map<String, Int> =
-            mapOf(
-                Manifest.permission_group.LOCATION to 0,
-                Manifest.permission_group.CAMERA to 1,
-                Manifest.permission_group.MICROPHONE to 2
-            )
-        private const val DEFAULT_ORDER = 3
-    }
-
-    /** Loads data from [PermissionUsages] using the [LoaderManager] pattern. */
-    fun loadPermissionUsages(
-        loaderManager: LoaderManager,
-        permissionUsages: PermissionUsages,
-        callback: PermissionUsages.PermissionsUsagesChangeCallback
-    ) {
-        val filterTimeBeginMillis =
-            max(System.currentTimeMillis() - TIME_FILTER_MILLIS, Instant.EPOCH.toEpochMilli())
-        permissionUsages.load(
-            null /*filterPackageName*/,
-            null /*filterPermissionGroups*/,
-            filterTimeBeginMillis,
-            Long.MAX_VALUE,
-            PermissionUsages.USAGE_FLAG_LAST or PermissionUsages.USAGE_FLAG_HISTORICAL,
-            loaderManager,
-            false /*getUiInfo*/,
-            false /*getNonPlatformPermissions*/,
-            callback /*callback*/,
-            false /*sync*/
-        )
-    }
-
-    /**
-     * Parses the provided list of [AppPermissionUsage] instances to build data for the UI to
-     * display.
-     */
-    fun buildPermissionUsagesUiData(
-        appPermissionUsages: List<AppPermissionUsage>,
-        show7Days: Boolean,
-        showSystem: Boolean,
-        context: Context,
-    ): PermissionUsagesUiData {
-        val curTime = System.currentTimeMillis()
-        val showPermissionUsagesDuration =
-            if (KotlinUtils.is7DayToggleEnabled() && show7Days) {
-                TIME_7_DAYS_DURATION
-            } else {
-                TIME_24_HOURS_DURATION
-            }
-        val startTime = max(curTime - showPermissionUsagesDuration, Instant.EPOCH.toEpochMilli())
-
-        val filteredAppPermissionUsages =
-            appPermissionUsages.filter { !exemptedPackages.contains(it.packageName) }
-        val displayShowSystemToggle: Boolean =
-            filteredAppPermissionUsages.displayShowSystemToggle(startTime)
-        val permissionApps = filteredAppPermissionUsages.getRecentPermissionApps(startTime)
-        val orderedPermissionGroupsWithUsage =
-            filteredAppPermissionUsages.buildOrderedPermissionGroupsWithUsageCount(
-                context,
-                startTime,
-                showSystem
-            )
-
-        return PermissionUsagesUiData(
-            permissionApps,
-            displayShowSystemToggle,
-            orderedPermissionGroupsWithUsage
-        )
-    }
-
-    /**
-     * Creates an ordered list of [PermissionGroupWithUsageCount] instances to show in the UI,
-     * representing a mapping of permission groups to the number of apps that recently accessed
-     * them.
-     *
-     * The list is ordered as follows:
-     * 1. Location
-     * 2. Camera
-     * 3. Microphone
-     * 4. Remaining permission groups, ordered alphabetically
-     */
-    private fun List<AppPermissionUsage>.buildOrderedPermissionGroupsWithUsageCount(
-        context: Context,
-        startTime: Long,
-        showSystem: Boolean
-    ): List<PermissionGroupWithUsageCount> {
-        val permissionGroupsUsageCountMap: MutableMap<String, Int> = HashMap()
-        extractPlatformAppPermissionGroupsToDisplay().forEach {
-            permissionGroupsUsageCountMap[it] = 0
-        }
-
-        for (appUsage in this) {
-            appUsage.groupUsages
-                .filter { showSystem || !it.group.isSystem() }
-                .filter { !EXEMPTED_PERMISSION_GROUPS.contains(it.group.name) }
-                .filter { it.lastAccessTime >= startTime }
-                .forEach {
-                    permissionGroupsUsageCountMap[it.group.name] =
-                        permissionGroupsUsageCountMap.getOrDefault(it.group.name, 0) + 1
-                }
-        }
-        return permissionGroupsUsageCountMap.entries
-            .map { PermissionGroupWithUsageCount(it.key, it.value) }
-            .sortedWith(
-                compareBy(
-                    { PERMISSION_GROUP_ORDER.getOrDefault(it.permGroup, DEFAULT_ORDER) },
-                    { getPermGroupLabel(context, it.permGroup).toString() }
-                )
-            )
-    }
-
-    /** Extracts [PermissionApp] where there has been recent permission usage. */
-    private fun List<AppPermissionUsage>.getRecentPermissionApps(
-        startTime: Long,
-    ): java.util.ArrayList<PermissionApp> {
-        return ArrayList(
-            filter { appPermissionUsage ->
-                    appPermissionUsage.groupUsages
-                        .filter { !EXEMPTED_PERMISSION_GROUPS.contains(it.group.name) }
-                        .any { it.lastAccessTime >= startTime || it.lastAccessTime == 0L }
-                }
-                .map { it.app }
-        )
-    }
-
-    /**
-     * Returns whether there are any user-sensitive app permission groups with recent usage, and
-     * therefore if the "show/hide system" toggle needs to be displayed in the UI
-     */
-    private fun List<AppPermissionUsage>.displayShowSystemToggle(
-        startTime: Long,
-    ): Boolean {
-        return flatMap { it.groupUsages }
-            .filter { !EXEMPTED_PERMISSION_GROUPS.contains(it.group.name) }
-            .filter { it.lastAccessTime > startTime && it.lastAccessTime > 0L }
-            .any { it.group.isSystem() }
-    }
-
-    /**
-     * Extracts to a set all the permission groups declared by the platform that should be displayed
-     * in the UI.
-     */
-    private fun List<AppPermissionUsage>.extractPlatformAppPermissionGroupsToDisplay():
-        Set<String> =
-        this.flatMap { it.groupUsages }
-            .map { it.group.name }
-            .filter { PermissionMapping.isPlatformPermissionGroup(it) }
-            .filter { !EXEMPTED_PERMISSION_GROUPS.contains(it) }
-            .toSet()
-
-    /**
-     * Returns whether the [AppPermissionGroup] is considered a system group.
-     *
-     * For the purpose of Permissions Hub UI, non user-sensitive [AppPermissionGroup]s are
-     * considered "system" and should be hidden from the main page unless requested by the user
-     * through the "show/hide system" toggle.
-     */
-    private fun AppPermissionGroup.isSystem() = !Utils.isGroupOrBgGroupUserSensitive(this)
-
-    /** Data class to hold all the information required to configure the UI. */
-    data class PermissionUsagesUiData(
-        /** List of [PermissionApp] instances */
-        // Note that these are used only to cache app data for the permission usage details
-        // fragment, and have no bearing on the UI on the main permission usage page.
-        val permissionApps: ArrayList<PermissionApp>,
-        /** Whether to show the "show/hide system" toggle. */
-        val displayShowSystemToggle: Boolean,
-        // TODO(b/243970988): Consider moving ordering logic to fragment.
-        /** [PermissionGroupWithUsageCount] instances ordered for display in UI */
-        val orderedPermissionGroupsWithUsageCount: List<PermissionGroupWithUsageCount>,
-    )
-
-    /**
-     * Data class to associate permission groups with the number of apps that recently accessed
-     * them.
-     */
-    data class PermissionGroupWithUsageCount(val permGroup: String, val appCount: Int)
-}
-
-/** Factory for [PermissionUsageViewModelLegacy]. */
-@RequiresApi(Build.VERSION_CODES.S)
-class PermissionUsageViewModelFactoryLegacy(private val roleManager: RoleManager) :
-    ViewModelProvider.Factory {
-
-    override fun <T : ViewModel> create(modelClass: Class<T>): T {
-        @Suppress("UNCHECKED_CAST") return PermissionUsageViewModelLegacy(roleManager) as T
-    }
-}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/AppPermissionGroupsViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/AppPermissionGroupsViewModel.kt
index ee0c5d2f2..4f43f4a0e 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/AppPermissionGroupsViewModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/AppPermissionGroupsViewModel.kt
@@ -17,6 +17,7 @@
 package com.android.permissioncontroller.permission.ui.model
 
 import android.Manifest
+import android.annotation.SuppressLint
 import android.app.AppOpsManager
 import android.app.AppOpsManager.MODE_ALLOWED
 import android.app.AppOpsManager.MODE_IGNORED
@@ -31,6 +32,8 @@ import androidx.lifecycle.ViewModel
 import androidx.lifecycle.ViewModelProvider
 import androidx.navigation.fragment.findNavController
 import com.android.modules.utils.build.SdkLevel
+import com.android.permission.flags.Flags
+import com.android.permissioncontroller.DeviceUtils
 import com.android.permissioncontroller.PermissionControllerApplication
 import com.android.permissioncontroller.PermissionControllerStatsLog
 import com.android.permissioncontroller.PermissionControllerStatsLog.APP_PERMISSION_GROUPS_FRAGMENT_AUTO_REVOKE_ACTION
@@ -51,7 +54,6 @@ import com.android.permissioncontroller.permission.model.livedatatypes.AppPermGr
 import com.android.permissioncontroller.permission.model.v31.AppPermissionUsage
 import com.android.permissioncontroller.permission.ui.Category
 import com.android.permissioncontroller.permission.utils.IPC
-import com.android.permissioncontroller.permission.utils.KotlinUtils
 import com.android.permissioncontroller.permission.utils.PermissionMapping
 import com.android.permissioncontroller.permission.utils.Utils
 import com.android.permissioncontroller.permission.utils.Utils.AppPermsLastAccessType
@@ -128,6 +130,42 @@ class AppPermissionGroupsViewModel(
     private val fullStoragePermsLiveData = FullStoragePermissionAppsLiveData
     private val packagePermsExternalDeviceLiveData =
         PackagePermissionsExternalDeviceLiveData[packageName, user]
+    private val appOpsManager = app.getSystemService(AppOpsManager::class.java)!!
+    private val packageManager = app.packageManager
+
+    /** Check if the application is in restricted settings mode. */
+    @SuppressLint("NewApi")
+    fun isClearRestrictedAllowed(): Boolean {
+        if (Flags.enhancedConfirmationBackportEnabled()) {
+            // TODO(b/347876543): Replace this when EnhancedConfirmtionServiceImpl is
+            // available.
+            val isRestricted =
+                appOpsManager.noteOpNoThrow(
+                    AppOpsManager.OPSTR_ACCESS_RESTRICTED_SETTINGS,
+                    packageManager.getApplicationInfoAsUser(packageName, 0, user).uid,
+                    packageName,
+                    null,
+                    null
+                ) == MODE_IGNORED
+            return isRestricted
+        }
+        return false
+    }
+
+    /** Allow restricted settings on the applications. */
+    @SuppressLint("NewApi")
+    fun clearRestriction() {
+        if (Flags.enhancedConfirmationBackportEnabled()) {
+            // TODO(b/347876543): Replace this when EnhancedConfirmationServiceImpl is
+            // available.
+            appOpsManager.setMode(
+                AppOpsManager.OPSTR_ACCESS_RESTRICTED_SETTINGS,
+                packageManager.getApplicationInfoAsUser(packageName, 0, user).uid,
+                packageName,
+                MODE_ALLOWED
+            )
+        }
+    }
 
     /**
      * LiveData whose data is a map of grant category (either allowed or denied) to a list of
@@ -396,7 +434,7 @@ class AppPermissionGroupsViewModel(
         }
 
         val aggregateDataFilterBeginDays =
-            if (KotlinUtils.is7DayToggleEnabled()) AGGREGATE_DATA_FILTER_BEGIN_DAYS_7
+            if (DeviceUtils.isHandheld()) AGGREGATE_DATA_FILTER_BEGIN_DAYS_7
             else AGGREGATE_DATA_FILTER_BEGIN_DAYS_1
 
         accessTime.clear()
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/AppPermissionViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/AppPermissionViewModel.kt
index 5b6d8b8db..8a9408517 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/AppPermissionViewModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/AppPermissionViewModel.kt
@@ -127,6 +127,7 @@ class AppPermissionViewModel(
             oneTime: Boolean
         )
 
+        @RequiresApi(Build.VERSION_CODES.TIRAMISU)
         fun showAdvancedConfirmDialog(args: AdvancedConfirmDialogArgs)
     }
 
@@ -325,6 +326,7 @@ class AppPermissionViewModel(
 
         private val mainLocListener = { isEnabled: Boolean -> checkAndUpdateStatus(!isEnabled) }
         private val locBypassListener = { _: Boolean -> checkAndUpdateStatus() }
+
         override fun onUpdate() {
             checkAndUpdateStatus()
         }
@@ -692,8 +694,7 @@ class AppPermissionViewModel(
                 app,
                 packageName,
                 permGroupName
-            )
-                ?: return
+            ) ?: return
         fragment.startActivity(restrictionIntent)
     }
 
@@ -726,10 +727,8 @@ class AppPermissionViewModel(
             // 2. Else if FINE or COARSE have the isSelectedLocationAccuracy flag set, then return
             //    true if FINE isSelectedLocationAccuracy is set.
             // 3. Else, return default precision from device config.
-            return if (
-                fineLocation.isGrantedIncludingAppOp || coarseLocation.isGrantedIncludingAppOp
-            ) {
-                fineLocation.isGrantedIncludingAppOp
+            return if (fineLocation.isGranted || coarseLocation.isGranted) {
+                fineLocation.isGranted
             } else if (
                 fineLocation.isSelectedLocationAccuracy || coarseLocation.isSelectedLocationAccuracy
             ) {
@@ -1381,9 +1380,7 @@ class AppPermissionViewModel(
     }
 
     private fun getIndividualPermissionDetailResId(group: LightAppPermGroup): Pair<Int, Int> {
-        return when (
-            val numRevoked = group.permissions.filter { !it.value.isGrantedIncludingAppOp }.size
-        ) {
+        return when (val numRevoked = group.permissions.filter { !it.value.isGranted }.size) {
             0 -> R.string.permission_revoked_none to numRevoked
             group.permissions.size -> R.string.permission_revoked_all to numRevoked
             else -> R.string.permission_revoked_count to numRevoked
@@ -1454,7 +1451,7 @@ class AppPermissionViewModel(
             val newPermission = newGroup.permissions[permName] ?: continue
 
             if (
-                permission.isGrantedIncludingAppOp != newPermission.isGrantedIncludingAppOp ||
+                permission.isGranted != newPermission.isGranted ||
                     permission.flags != newPermission.flags
             ) {
                 logAppPermissionFragmentActionReported(changeId, newPermission, buttonPressed)
@@ -1462,7 +1459,7 @@ class AppPermissionViewModel(
                     app.applicationContext,
                     packageName,
                     permGroupName,
-                    newPermission.isGrantedIncludingAppOp
+                    newPermission.isGranted
                 )
                 PermissionChangeStorageImpl.recordPermissionChange(packageName)
             }
@@ -1492,7 +1489,7 @@ class AppPermissionViewModel(
             uid,
             packageName,
             permission.permInfo.name,
-            permission.isGrantedIncludingAppOp,
+            permission.isGranted,
             permission.flags,
             buttonPressed
         )
@@ -1502,7 +1499,7 @@ class AppPermissionViewModel(
                 "$changeId uid=$uid packageName=$packageName permission=" +
                 permission.permInfo.name +
                 " isGranted=" +
-                permission.isGrantedIncludingAppOp +
+                permission.isGranted +
                 " permissionFlags=" +
                 permission.flags +
                 " buttonPressed=$buttonPressed"
@@ -1544,7 +1541,7 @@ class AppPermissionViewModel(
 
         return group.isGranted &&
             group.permissions.values.all {
-                it.name in partialPerms || (it.name !in partialPerms && !it.isGrantedIncludingAppOp)
+                it.name in partialPerms || (it.name !in partialPerms && !it.isGranted)
             }
     }
 }
@@ -1559,28 +1556,16 @@ class AppPermissionViewModel(
  * @param sessionId A session ID used in logs to identify this particular session
  * @param persistentDeviceId Indicates the device in the context of virtual devices
  */
-class AppPermissionViewModelFactory(
+class AppPermissionViewModelFactory
+@JvmOverloads
+constructor(
     private val app: Application,
     private val packageName: String,
     private val permGroupName: String,
     private val user: UserHandle,
     private val sessionId: Long,
-    private val persistentDeviceId: String
+    private val persistentDeviceId: String = MultiDeviceUtils.getDefaultDevicePersistentDeviceId()
 ) : ViewModelProvider.Factory {
-    constructor(
-        app: Application,
-        packageName: String,
-        permGroupName: String,
-        user: UserHandle,
-        sessionId: Long
-    ) : this(
-        app,
-        packageName,
-        permGroupName,
-        user,
-        sessionId,
-        MultiDeviceUtils.getDefaultDevicePersistentDeviceId()
-    )
 
     override fun <T : ViewModel> create(modelClass: Class<T>): T {
         @Suppress("UNCHECKED_CAST")
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/GrantPermissionsViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/GrantPermissionsViewModel.kt
index b5df6f410..0a01929e6 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/GrantPermissionsViewModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/GrantPermissionsViewModel.kt
@@ -338,7 +338,7 @@ class GrantPermissionsViewModel(
                     if (state != null) {
                         val allAffectedGranted =
                             state.affectedPermissions.all { perm ->
-                                appPermGroup.permissions[perm]?.isGrantedIncludingAppOp == true &&
+                                appPermGroup.permissions[perm]?.isGranted == true &&
                                     appPermGroup.permissions[perm]?.isRevokeWhenRequested == false
                             }
                         if (allAffectedGranted) {
@@ -592,7 +592,7 @@ class GrantPermissionsViewModel(
 
         val behavior = getGrantBehavior(group)
         return if (behavior.isGroupFullyGranted(group, groupRequestedPermissions)) {
-            if (group.permissions[perm]?.isGrantedIncludingAppOp == false) {
+            if (group.permissions[perm]?.isGranted == false) {
                 if (isBackground) {
                     grantBackgroundRuntimePermissions(app, group, listOf(perm))
                 } else {
@@ -864,18 +864,15 @@ class GrantPermissionsViewModel(
                 } else {
                     PERMISSION_GRANT_REQUEST_RESULT_REPORTED__RESULT__USER_GRANTED
                 }
+            var affectedPermissions: Collection<String> = groupState.affectedPermissions
             if (shouldAffectBackgroundPermissions) {
-                grantBackgroundRuntimePermissions(
-                    app,
-                    groupState.group,
-                    groupState.affectedPermissions
-                )
+                grantBackgroundRuntimePermissions(app, groupState.group, affectedPermissions)
             } else if (shouldAffectForegroundPermssions) {
                 if (affectedForegroundPermissions == null) {
                     grantForegroundRuntimePermissions(
                         app,
                         groupState.group,
-                        groupState.affectedPermissions,
+                        affectedPermissions,
                         isOneTime
                     )
                     // This prevents weird flag state when app targetSDK switches from S+ to R-
@@ -883,11 +880,12 @@ class GrantPermissionsViewModel(
                         KotlinUtils.setFlagsWhenLocationAccuracyChanged(app, groupState.group, true)
                     }
                 } else {
+                    affectedPermissions = affectedForegroundPermissions
                     val newGroup =
                         grantForegroundRuntimePermissions(
                             app,
                             groupState.group,
-                            affectedForegroundPermissions,
+                            affectedPermissions,
                             isOneTime
                         )
                     if (!isOneTime || newGroup.isOneTime) {
@@ -899,7 +897,17 @@ class GrantPermissionsViewModel(
                     }
                 }
             }
-            groupState.state = STATE_GRANTED
+            val shouldDenyFullGroupGrant =
+                groupState.group.isPlatformPermissionGroup &&
+                    affectedPermissions.none {
+                        groupState.group.permissions[it]?.isPlatformOrSystem == true
+                    }
+            groupState.state =
+                if (shouldDenyFullGroupGrant) {
+                    STATE_UNKNOWN
+                } else {
+                    STATE_GRANTED
+                }
         } else {
             if (shouldAffectBackgroundPermissions) {
                 revokeBackgroundRuntimePermissions(
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/PermissionAppsViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/PermissionAppsViewModel.kt
index 9317e7577..de35339bf 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/PermissionAppsViewModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/PermissionAppsViewModel.kt
@@ -37,6 +37,7 @@ import androidx.navigation.fragment.findNavController
 import androidx.preference.Preference
 import androidx.savedstate.SavedStateRegistryOwner
 import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.DeviceUtils
 import com.android.permissioncontroller.PermissionControllerStatsLog
 import com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_APPS_FRAGMENT_VIEWED__CATEGORY__ALLOWED
 import com.android.permissioncontroller.PermissionControllerStatsLog.PERMISSION_APPS_FRAGMENT_VIEWED__CATEGORY__ALLOWED_FOREGROUND
@@ -57,7 +58,6 @@ import com.android.permissioncontroller.permission.ui.model.PermissionAppsViewMo
 import com.android.permissioncontroller.permission.ui.model.PermissionAppsViewModel.Companion.SHOULD_SHOW_SYSTEM_KEY
 import com.android.permissioncontroller.permission.ui.model.PermissionAppsViewModel.Companion.SHOW_ALWAYS_ALLOWED
 import com.android.permissioncontroller.permission.utils.KotlinUtils.getPackageUid
-import com.android.permissioncontroller.permission.utils.KotlinUtils.is7DayToggleEnabled
 import com.android.permissioncontroller.permission.utils.LocationUtils
 import com.android.permissioncontroller.permission.utils.Utils
 import com.android.permissioncontroller.permission.utils.navigateSafe
@@ -164,7 +164,8 @@ class PermissionAppsViewModel(
 
     inner class CategorizedAppsLiveData(groupName: String) :
         MediatorLiveData<
-            @kotlin.jvm.JvmSuppressWildcards Map<Category, List<Pair<String, UserHandle>>>
+            @kotlin.jvm.JvmSuppressWildcards
+            Map<Category, List<Pair<String, UserHandle>>>
         >() {
         private val packagesUiInfoLiveData = SinglePermGroupPackagesUiInfoLiveData[groupName]
 
@@ -335,7 +336,7 @@ class PermissionAppsViewModel(
 
     fun getFilterTimeBeginMillis(): Long {
         val aggregateDataFilterBeginDays =
-            if (is7DayToggleEnabled()) AGGREGATE_DATA_FILTER_BEGIN_DAYS_7
+            if (DeviceUtils.isHandheld()) AGGREGATE_DATA_FILTER_BEGIN_DAYS_7
             else AGGREGATE_DATA_FILTER_BEGIN_DAYS_1
 
         return max(
@@ -358,7 +359,7 @@ class PermissionAppsViewModel(
         }
 
         val aggregateDataFilterBeginDays =
-            if (is7DayToggleEnabled()) AGGREGATE_DATA_FILTER_BEGIN_DAYS_7
+            if (DeviceUtils.isHandheld()) AGGREGATE_DATA_FILTER_BEGIN_DAYS_7
             else AGGREGATE_DATA_FILTER_BEGIN_DAYS_1
         val now = System.currentTimeMillis()
         val filterTimeBeginMillis =
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/ReviewPermissionsViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/ReviewPermissionsViewModel.kt
index 8613d1cae..ecb551ffc 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/ReviewPermissionsViewModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/ReviewPermissionsViewModel.kt
@@ -133,7 +133,7 @@ class ReviewPermissionsViewModel(val app: Application, val packageInfo: PackageI
         val lightPerms = permGroup.allPermissions.values.toList()
         val permissionCount = lightPerms.size
         for (i in 0 until permissionCount) {
-            if (!lightPerms[i].isGrantedIncludingAppOp) {
+            if (!lightPerms[i].isGranted) {
                 revokedCount++
             }
         }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/BackgroundGrantBehavior.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/BackgroundGrantBehavior.kt
index 6234b2755..7112d180f 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/BackgroundGrantBehavior.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/BackgroundGrantBehavior.kt
@@ -57,7 +57,7 @@ object BackgroundGrantBehavior : GrantBehavior() {
         val requestsBg = hasBgPerms(group, requestedPerms)
         val requestsFg = requestedPerms.any { it !in group.backgroundPermNames }
         val isOneTimeGroup = PermissionMapping.supportsOneTimeGrant(group.permGroupName)
-        val isFgGranted = group.foreground.isGrantedExcludingRWROrAllRWR
+        val isFgGranted = group.foreground.allowFullGroupGrant
         val isFgOneTime = group.foreground.isOneTime
         val splitSdk = getSdkGroupWasSplitToBg(requestedPerms)
         val isAppIsOlderThanSplitToBg = group.packageInfo.targetSdkVersion < splitSdk
@@ -171,16 +171,15 @@ object BackgroundGrantBehavior : GrantBehavior() {
         group: LightAppPermGroup,
         requestedPerms: Set<String>
     ): Boolean {
-        return (!hasBgPerms(group, requestedPerms) ||
-            group.background.isGrantedExcludingRWROrAllRWR) &&
-            group.foreground.isGrantedExcludingRWROrAllRWR
+        return (!hasBgPerms(group, requestedPerms) || group.background.allowFullGroupGrant) &&
+            group.foreground.allowFullGroupGrant
     }
 
     override fun isForegroundFullyGranted(
         group: LightAppPermGroup,
         requestedPerms: Set<String>
     ): Boolean {
-        return group.foreground.isGrantedExcludingRWROrAllRWR
+        return group.foreground.allowFullGroupGrant
     }
 
     override fun isPermissionFixed(group: LightAppPermGroup, perm: String): Boolean {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/GrantBehavior.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/GrantBehavior.kt
index 3b3619084..54d6dc0f3 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/GrantBehavior.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/GrantBehavior.kt
@@ -58,7 +58,7 @@ abstract class GrantBehavior {
      * group not already granted will be granted.
      */
     open fun isGroupFullyGranted(group: LightAppPermGroup, requestedPerms: Set<String>): Boolean {
-        return group.foreground.isGrantedExcludingRWROrAllRWR
+        return group.foreground.allowFullGroupGrant
     }
 
     /**
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/HealthGrantBehavior.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/HealthGrantBehavior.kt
index 8e540701a..4f5def312 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/HealthGrantBehavior.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/HealthGrantBehavior.kt
@@ -47,7 +47,7 @@ object HealthGrantBehavior : GrantBehavior() {
         group: LightAppPermGroup,
         requestedPerms: Set<String>
     ): Boolean {
-        return requestedPerms.all { group.permissions[it]?.isGrantedIncludingAppOp != false }
+        return requestedPerms.all { group.permissions[it]?.isGranted != false }
     }
 
     override fun isPermissionFixed(group: LightAppPermGroup, perm: String): Boolean {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/LocationGrantBehavior.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/LocationGrantBehavior.kt
index 2c5e2b732..31ac04cab 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/LocationGrantBehavior.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/LocationGrantBehavior.kt
@@ -37,8 +37,7 @@ object LocationGrantBehavior : GrantBehavior() {
     ): Prompt {
         val backgroundPrompt = BackgroundGrantBehavior.getPrompt(group, requestedPerms)
         val requestsBackground = requestedPerms.any { it in group.backgroundPermNames }
-        val coarseGranted =
-            group.permissions[ACCESS_COARSE_LOCATION]?.isGrantedIncludingAppOp == true
+        val coarseGranted = group.permissions[ACCESS_COARSE_LOCATION]?.isGranted == true
         return if (!supportsLocationAccuracy(group) || requestsBackground) {
             backgroundPrompt
         } else if (requestedPerms.contains(ACCESS_FINE_LOCATION)) {
@@ -84,10 +83,10 @@ object LocationGrantBehavior : GrantBehavior() {
         }
 
         if (requestedPerms.contains(ACCESS_FINE_LOCATION)) {
-            return group.permissions[ACCESS_FINE_LOCATION]?.isGrantedIncludingAppOp == true
+            return group.permissions[ACCESS_FINE_LOCATION]?.isGranted == true
         }
 
-        return group.foreground.isGrantedExcludingRWROrAllRWR
+        return group.foreground.allowFullGroupGrant
     }
 
     override fun isPermissionFixed(group: LightAppPermGroup, perm: String): Boolean {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/StorageGrantBehavior.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/StorageGrantBehavior.kt
index a690f5f59..9dd87674a 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/StorageGrantBehavior.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/grantPermissions/StorageGrantBehavior.kt
@@ -66,11 +66,11 @@ object StorageGrantBehavior : GrantBehavior() {
         }
 
         val userSelectedPerm = group.permissions[READ_MEDIA_VISUAL_USER_SELECTED]
-        if (userSelectedPerm?.isUserFixed == true && userSelectedPerm.isGrantedIncludingAppOp) {
+        if (userSelectedPerm?.isUserFixed == true && userSelectedPerm.isGranted) {
             return Prompt.NO_UI_PHOTO_PICKER_REDIRECT
         }
 
-        if (userSelectedPerm?.isGrantedIncludingAppOp == true) {
+        if (userSelectedPerm?.isGranted == true) {
             return Prompt.SELECT_MORE_PHOTOS
         } else {
             return Prompt.SELECT_PHOTOS
@@ -97,16 +97,14 @@ object StorageGrantBehavior : GrantBehavior() {
         }
 
         return group.permissions.values.any {
-            it.name !in getPartialGrantPermissions(group) && it.isGrantedIncludingAppOp
+            it.name !in getPartialGrantPermissions(group) && it.isGranted
         }
     }
 
     override fun isPermissionFixed(group: LightAppPermGroup, perm: String): Boolean {
         val userSelectedPerm = group.permissions[READ_MEDIA_VISUAL_USER_SELECTED]
         if (
-            userSelectedPerm != null &&
-                userSelectedPerm.isGrantedIncludingAppOp &&
-                userSelectedPerm.isUserFixed
+            userSelectedPerm != null && userSelectedPerm.isGranted && userSelectedPerm.isUserFixed
         ) {
             // If the user selected permission is fixed and granted, we immediately show the
             // photo picker, rather than filtering
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/BasePermissionUsageDetailsViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/BasePermissionUsageDetailsViewModel.kt
new file mode 100644
index 000000000..64c5c6927
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/BasePermissionUsageDetailsViewModel.kt
@@ -0,0 +1,124 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.model.v31
+
+import android.app.Application
+import android.graphics.drawable.Drawable
+import android.os.UserHandle
+import androidx.lifecycle.AndroidViewModel
+import androidx.lifecycle.LiveData
+import com.android.permissioncontroller.R
+import com.android.permissioncontroller.permission.ui.handheld.v31.getDurationUsedStr
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.CLUSTER_SPACING_MINUTES
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsUiState
+import com.android.permissioncontroller.permission.utils.KotlinUtils
+import java.util.concurrent.TimeUnit
+
+abstract class BasePermissionUsageDetailsViewModel(val app: Application) : AndroidViewModel(app) {
+    abstract fun getPermissionUsagesDetailsInfoUiLiveData(): LiveData<PermissionUsageDetailsUiState>
+
+    abstract fun getShowSystem(): Boolean
+
+    abstract val showSystemLiveData: LiveData<Boolean>
+
+    abstract fun getShow7Days(): Boolean
+
+    abstract fun updateShowSystemAppsToggle(showSystem: Boolean)
+
+    abstract fun updateShow7DaysToggle(show7Days: Boolean)
+
+    private val packageIconCache: MutableMap<Pair<String, UserHandle>, Drawable> = mutableMapOf()
+    private val packageLabelCache: MutableMap<String, String> = mutableMapOf()
+
+    /**
+     * Returns the label for the provided package name, by first searching the cache otherwise
+     * retrieving it from the app's [android.content.pm.ApplicationInfo].
+     */
+    fun getPackageLabel(packageName: String, user: UserHandle): String {
+        if (packageLabelCache.containsKey(packageName)) {
+            return requireNotNull(packageLabelCache[packageName])
+        }
+        val packageLabel = getPackageLabel(app, packageName, user)
+        packageLabelCache[packageName] = packageLabel
+        return packageLabel
+    }
+
+    open fun getPackageLabel(app: Application, packageName: String, user: UserHandle): String {
+        return KotlinUtils.getPackageLabel(app, packageName, user)
+    }
+
+    /**
+     * Returns the icon for the provided package name and user, by first searching the cache
+     * otherwise retrieving it from the app's [android.content.pm.ApplicationInfo].
+     */
+    fun getBadgedPackageIcon(packageName: String, userHandle: UserHandle): Drawable? {
+        val packageNameWithUser: Pair<String, UserHandle> = Pair(packageName, userHandle)
+        if (packageIconCache.containsKey(packageNameWithUser)) {
+            return requireNotNull(packageIconCache[packageNameWithUser])
+        }
+        val packageIcon = getBadgedPackageIcon(app, packageName, userHandle)
+        if (packageIcon != null) packageIconCache[packageNameWithUser] = packageIcon
+
+        return packageIcon
+    }
+
+    open fun getBadgedPackageIcon(
+        app: Application,
+        packageName: String,
+        user: UserHandle
+    ): Drawable? {
+        return KotlinUtils.getBadgedPackageIcon(app, packageName, user)
+    }
+
+    fun getDurationSummary(durationMs: Long): String? {
+        // Only show the duration summary if it is at least (CLUSTER_SPACING_MINUTES + 1) minutes.
+        // Displaying a time that is shorter than the cluster granularity
+        // (CLUSTER_SPACING_MINUTES) will not convey useful information.
+        if (durationMs >= TimeUnit.MINUTES.toMillis(CLUSTER_SPACING_MINUTES + 1)) {
+            return getDurationUsedStr(app, durationMs)
+        }
+        return null
+    }
+
+    fun buildUsageSummary(
+        subAttributionLabel: String?,
+        proxyPackageLabel: String?,
+        durationSummary: String?
+    ): String? {
+        val subTextStrings: MutableList<String> = mutableListOf()
+        subAttributionLabel?.let { subTextStrings.add(subAttributionLabel) }
+        proxyPackageLabel?.let { subTextStrings.add(it) }
+        durationSummary?.let { subTextStrings.add(it) }
+        return when (subTextStrings.size) {
+            3 ->
+                app.getString(
+                    R.string.history_preference_subtext_3,
+                    subTextStrings[0],
+                    subTextStrings[1],
+                    subTextStrings[2]
+                )
+            2 ->
+                app.getString(
+                    R.string.history_preference_subtext_2,
+                    subTextStrings[0],
+                    subTextStrings[1]
+                )
+            1 -> subTextStrings[0]
+            else -> null
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/PermissionUsageDetailsViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/PermissionUsageDetailsViewModel.kt
index 93fc280b4..497e5cc35 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/PermissionUsageDetailsViewModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/PermissionUsageDetailsViewModel.kt
@@ -34,12 +34,16 @@ import android.os.Build
 import android.os.Bundle
 import android.os.UserHandle
 import android.os.UserManager
+import android.permission.flags.Flags
+import android.util.Log
 import androidx.annotation.RequiresApi
 import androidx.lifecycle.AbstractSavedStateViewModelFactory
+import androidx.lifecycle.LiveData
 import androidx.lifecycle.SavedStateHandle
 import androidx.lifecycle.ViewModel
 import androidx.savedstate.SavedStateRegistryOwner
 import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.DeviceUtils
 import com.android.permissioncontroller.R
 import com.android.permissioncontroller.permission.compat.IntentCompat
 import com.android.permissioncontroller.permission.data.AppPermGroupUiInfoLiveData
@@ -56,7 +60,6 @@ import com.android.permissioncontroller.permission.model.livedatatypes.v31.Light
 import com.android.permissioncontroller.permission.model.livedatatypes.v31.LightHistoricalPackageOps.DiscreteAccess
 import com.android.permissioncontroller.permission.ui.handheld.v31.getDurationUsedStr
 import com.android.permissioncontroller.permission.ui.handheld.v31.shouldShowSubattributionInPermissionsDashboard
-import com.android.permissioncontroller.permission.utils.KotlinUtils
 import com.android.permissioncontroller.permission.utils.PermissionMapping
 import com.android.permissioncontroller.permission.utils.Utils
 import com.android.permissioncontroller.permission.utils.v31.SubattributionUtils
@@ -68,10 +71,10 @@ import java.util.concurrent.TimeUnit.DAYS
 /** [ViewModel] for the Permission Usage Details page. */
 @RequiresApi(Build.VERSION_CODES.S)
 class PermissionUsageDetailsViewModel(
-    val application: Application,
+    private val application: Application,
     private val state: SavedStateHandle,
     private val permissionGroup: String,
-) : ViewModel() {
+) : BasePermissionUsageDetailsViewModel(application) {
 
     val allLightHistoricalPackageOpsLiveData =
         AllLightHistoricalPackageOpsLiveData(application, opNames)
@@ -79,11 +82,9 @@ class PermissionUsageDetailsViewModel(
         mutableMapOf<AppPermissionId, AppPermGroupUiInfoLiveData>()
     private val lightPackageInfoLiveDataMap =
         mutableMapOf<Pair<String, UserHandle>, LightPackageInfoLiveData>()
-    val showSystemLiveData = state.getLiveData(SHOULD_SHOW_SYSTEM_KEY, false)
-    val show7DaysLiveData = state.getLiveData(SHOULD_SHOW_7_DAYS_KEY, false)
 
-    private val packageIconCache: MutableMap<Pair<String, UserHandle>, Drawable> = mutableMapOf()
-    private val packageLabelCache: MutableMap<String, String> = mutableMapOf()
+    override val showSystemLiveData = state.getLiveData(SHOULD_SHOW_SYSTEM_KEY, false)
+    val show7DaysLiveData = state.getLiveData(SHOULD_SHOW_7_DAYS_KEY, false)
 
     private val roleManager =
         Utils.getSystemServiceSafe(application.applicationContext, RoleManager::class.java)
@@ -91,25 +92,25 @@ class PermissionUsageDetailsViewModel(
         Utils.getSystemServiceSafe(application.applicationContext, UserManager::class.java)
 
     /** Updates whether system app permissions usage should be displayed in the UI. */
-    fun updateShowSystemAppsToggle(showSystem: Boolean) {
+    override fun updateShowSystemAppsToggle(showSystem: Boolean) {
         if (showSystem != state[SHOULD_SHOW_SYSTEM_KEY]) {
             state[SHOULD_SHOW_SYSTEM_KEY] = showSystem
         }
     }
 
     /** Updates whether 7 days usage or 1 day usage should be displayed in the UI. */
-    fun updateShow7DaysToggle(show7Days: Boolean) {
+    override fun updateShow7DaysToggle(show7Days: Boolean) {
         if (show7Days != state[SHOULD_SHOW_7_DAYS_KEY]) {
             state[SHOULD_SHOW_7_DAYS_KEY] = show7Days
         }
     }
 
-    /** Creates a [PermissionUsageDetailsUiInfo] containing all information to render the UI. */
-    fun buildPermissionUsageDetailsUiInfo(): PermissionUsageDetailsUiInfo {
+    /** Creates a [PermissionUsageDetailsUiState] containing all information to render the UI. */
+    fun buildPermissionUsageDetailsUiInfo(): PermissionUsageDetailsUiState {
         val showSystem: Boolean = state[SHOULD_SHOW_SYSTEM_KEY] ?: false
         val show7Days: Boolean = state[SHOULD_SHOW_7_DAYS_KEY] ?: false
         val showPermissionUsagesDuration =
-            if (KotlinUtils.is7DayToggleEnabled() && show7Days) {
+            if (show7Days && DeviceUtils.isHandheld()) {
                 TIME_7_DAYS_DURATION
             } else {
                 TIME_24_HOURS_DURATION
@@ -119,15 +120,15 @@ class PermissionUsageDetailsViewModel(
                 Instant.EPOCH.toEpochMilli()
             )
 
-        return PermissionUsageDetailsUiInfo(
-            show7Days,
-            showSystem,
+        return PermissionUsageDetailsUiState.Success(
             buildAppPermissionAccessUiInfoList(
                 allLightHistoricalPackageOpsLiveData,
                 startTime,
                 showSystem
             ),
-            containsSystemAppUsages(allLightHistoricalPackageOpsLiveData, startTime)
+            containsSystemAppUsages(allLightHistoricalPackageOpsLiveData, startTime),
+            showSystem,
+            show7Days
         )
     }
 
@@ -147,8 +148,7 @@ class PermissionUsageDetailsViewModel(
                     .filterOutExemptAppPermissions(true)
                     .filterAccessesLaterThan(startTime)
             }
-            ?.any { isAppPermissionSystem(it.appPermissionId) }
-            ?: false
+            ?.any { isAppPermissionSystem(it.appPermissionId) } ?: false
     }
 
     private fun isPermissionRequestedByApp(appPermissionId: AppPermissionId): Boolean {
@@ -156,8 +156,15 @@ class PermissionUsageDetailsViewModel(
             lightPackageInfoLiveDataMap[
                     Pair(appPermissionId.packageName, appPermissionId.userHandle)]
                 ?.value
-                ?.requestedPermissions
-                ?: listOf()
+                ?.requestedPermissions ?: listOf()
+
+        if (
+            appPermissionId.permissionGroup == Manifest.permission_group.LOCATION &&
+                appRequestedPermissions.contains(Manifest.permission.LOCATION_BYPASS)
+        ) {
+            return true
+        }
+
         return appRequestedPermissions.any {
             PermissionMapping.getGroupOfPlatformPermission(it) == appPermissionId.permissionGroup
         }
@@ -197,9 +204,8 @@ class PermissionUsageDetailsViewModel(
             .getLightHistoricalPackageOps()
             ?.filter { Utils.shouldShowInSettings(it.userHandle, userManager) }
             ?.flatMap { it.clusterAccesses(startTime, showSystem) }
-            ?.sortedBy { -1 * it.discreteAccesses.first().accessTimeMs }
             ?.map { it.buildAppPermissionAccessUiInfo() }
-            ?: listOf()
+            ?.sortedBy { -it.accessStartTime } ?: listOf()
     }
 
     private fun LightHistoricalPackageOps.clusterAccesses(
@@ -343,7 +349,9 @@ class PermissionUsageDetailsViewModel(
     ): List<AppPermissionDiscreteAccessCluster> {
         val clusters = mutableListOf<AppPermissionDiscreteAccessCluster>()
         val currentDiscreteAccesses = mutableListOf<DiscreteAccess>()
-        for (discreteAccess in appPermAccesses.discreteAccesses) {
+        // Iterate entries in asc order based on access timestamp.
+        for (index in appPermAccesses.discreteAccesses.size - 1 downTo 0) {
+            val discreteAccess = appPermAccesses.discreteAccesses[index]
             if (currentDiscreteAccesses.isEmpty()) {
                 currentDiscreteAccesses.add(discreteAccess)
             } else if (!canAccessBeAddedToCluster(discreteAccess, currentDiscreteAccesses)) {
@@ -352,7 +360,9 @@ class PermissionUsageDetailsViewModel(
                         appPermAccesses.appPermissionId,
                         appPermAccesses.attributionLabel,
                         appPermAccesses.attributionTags,
-                        currentDiscreteAccesses.toMutableList()
+                        currentDiscreteAccesses.toMutableList(),
+                        if (isOpClusteredByItself(discreteAccess.opName)) discreteAccess.opName
+                        else null
                     )
                 )
                 currentDiscreteAccesses.clear()
@@ -363,12 +373,14 @@ class PermissionUsageDetailsViewModel(
         }
 
         if (currentDiscreteAccesses.isNotEmpty()) {
+            val opName = currentDiscreteAccesses.last().opName
             clusters.add(
                 AppPermissionDiscreteAccessCluster(
                     appPermAccesses.appPermissionId,
                     appPermAccesses.attributionLabel,
                     appPermAccesses.attributionTags,
-                    currentDiscreteAccesses.toMutableList()
+                    currentDiscreteAccesses.toMutableList(),
+                    if (isOpClusteredByItself(opName)) opName else null
                 )
             )
         }
@@ -380,13 +392,37 @@ class PermissionUsageDetailsViewModel(
      * list that it can be added to the cluster.
      */
     private fun canAccessBeAddedToCluster(
-        discreteAccess: DiscreteAccess,
+        currentAccess: DiscreteAccess,
         clusteredAccesses: List<DiscreteAccess>
-    ): Boolean =
-        discreteAccess.accessTimeMs / ONE_HOUR_MS ==
-            clusteredAccesses.first().accessTimeMs / ONE_HOUR_MS &&
-            clusteredAccesses.last().accessTimeMs / ONE_MINUTE_MS -
-                discreteAccess.accessTimeMs / ONE_MINUTE_MS <= CLUSTER_SPACING_MINUTES
+    ): Boolean {
+        val clusterOp = clusteredAccesses.last().opName
+        if (
+            (isOpClusteredByItself(currentAccess.opName) || isOpClusteredByItself(clusterOp)) &&
+                currentAccess.opName != clusteredAccesses.last().opName
+        ) {
+            return false
+        }
+        val currentAccessMinute = currentAccess.accessTimeMs / ONE_MINUTE_MS
+        val prevMostRecentAccessMillis =
+            clusteredAccesses.maxOf { discreteAccess ->
+                if (discreteAccess.accessDurationMs > 0)
+                    discreteAccess.accessTimeMs + discreteAccess.accessDurationMs - ONE_MINUTE_MS
+                else discreteAccess.accessTimeMs
+            }
+        val prevMostRecentAccessMinute = prevMostRecentAccessMillis / ONE_MINUTE_MS
+        return (currentAccessMinute - prevMostRecentAccessMinute) <= CLUSTER_SPACING_MINUTES
+    }
+
+    /**
+     * Determine if an op should be in its own cluster and hence display as an individual entry in
+     * the privacy timeline
+     */
+    private fun isOpClusteredByItself(opName: String): Boolean {
+        if (isLocationByPassEnabled()) {
+            return opName == AppOpsManager.OPSTR_EMERGENCY_LOCATION
+        }
+        return false
+    }
 
     /**
      * Composes all UI information from a [AppPermissionDiscreteAccessCluster] into a
@@ -395,25 +431,42 @@ class PermissionUsageDetailsViewModel(
     private fun AppPermissionDiscreteAccessCluster.buildAppPermissionAccessUiInfo():
         AppPermissionAccessUiInfo {
         val context = application
-        val accessTimeList = this.discreteAccesses.map { it.accessTimeMs }
-        val durationSummaryLabel = getDurationSummary(context, this, accessTimeList)
+        // The end minute is exclusive here in terms of access, i.e. [1..5) as the private data
+        // was not accessed at minute 5, it helps calculate the duration correctly.
+        val accessEndTimeMillis =
+            discreteAccesses.maxOf { appOpEvent ->
+                if (appOpEvent.accessDurationMs > 0)
+                    appOpEvent.accessTimeMs + appOpEvent.accessDurationMs
+                else appOpEvent.accessTimeMs + ONE_MINUTE_MS
+            }
+        val accessStartTimeMillis = discreteAccesses.minOf { it.accessTimeMs }
+        val durationMs = accessEndTimeMillis - accessStartTimeMillis
+        val durationSummaryLabel =
+            if (durationMs >= TimeUnit.MINUTES.toMillis(CLUSTER_SPACING_MINUTES + 1)) {
+                getDurationUsedStr(context, durationMs)
+            } else null
+
         val proxyLabel = getProxyPackageLabel(this)
         val subAttributionLabel = getSubAttributionLabel(this)
-        val showingSubAttribution = subAttributionLabel != null && subAttributionLabel.isNotEmpty()
+        val showingSubAttribution = !subAttributionLabel.isNullOrEmpty()
         val summary =
             buildUsageSummary(context, subAttributionLabel, proxyLabel, durationSummaryLabel)
+        val isEmergencyLocationAccess =
+            isLocationByPassEnabled() && clusteredOp == AppOpsManager.OPSTR_EMERGENCY_LOCATION
 
         return AppPermissionAccessUiInfo(
             this.appPermissionId.userHandle,
             this.appPermissionId.packageName,
             getPackageLabel(this.appPermissionId.packageName, this.appPermissionId.userHandle),
             permissionGroup,
-            this.discreteAccesses.last().accessTimeMs,
-            this.discreteAccesses.first().accessTimeMs,
+            accessStartTimeMillis,
+            // Make the end time inclusive i.e. [1..4]
+            accessEndTimeMillis - ONE_MINUTE_MS,
             summary,
             showingSubAttribution,
-            ArrayList(this.attributionTags),
-            getBadgedPackageIcon(this.appPermissionId.packageName, this.appPermissionId.userHandle)
+            this.attributionTags.toSet(),
+            getBadgedPackageIcon(this.appPermissionId.packageName, this.appPermissionId.userHandle),
+            isEmergencyLocationAccess
         )
     }
 
@@ -455,36 +508,6 @@ class PermissionUsageDetailsViewModel(
             SubattributionUtils.isSubattributionSupported(lightPackageInfo)
     }
 
-    /** Returns a summary of the duration the permission was accessed for. */
-    private fun getDurationSummary(
-        context: Context,
-        accessCluster: AppPermissionDiscreteAccessCluster,
-        accessTimeList: List<Long>,
-    ): String? {
-        if (accessTimeList.isEmpty()) {
-            return null
-        }
-        // Since Location accesses are atomic, we manually calculate the access duration by
-        // comparing the first and last access within the cluster.
-        val durationMs: Long =
-            if (permissionGroup == Manifest.permission_group.LOCATION) {
-                accessTimeList[0] - accessTimeList[accessTimeList.size - 1]
-            } else {
-                accessCluster.discreteAccesses
-                    .filter { it.accessDurationMs > 0 }
-                    .sumOf { it.accessDurationMs }
-            }
-
-        // Only show the duration summary if it is at least (CLUSTER_SPACING_MINUTES + 1) minutes.
-        // Displaying a time that is shorter than the cluster granularity
-        // (CLUSTER_SPACING_MINUTES) will not convey useful information.
-        if (durationMs >= TimeUnit.MINUTES.toMillis(CLUSTER_SPACING_MINUTES + 1)) {
-            return getDurationUsedStr(context, durationMs)
-        }
-
-        return null
-    }
-
     /** Returns the proxied package label if the permission access was proxied. */
     private fun getProxyPackageLabel(accessCluster: AppPermissionDiscreteAccessCluster): String? =
         accessCluster.discreteAccesses
@@ -497,12 +520,24 @@ class PermissionUsageDetailsViewModel(
             }
 
     /** Returns the attribution label for the permission access, if any. */
-    private fun getSubAttributionLabel(accessCluster: AppPermissionDiscreteAccessCluster): String? =
-        if (accessCluster.attributionLabel == Resources.ID_NULL) null
+    private fun getSubAttributionLabel(accessCluster: AppPermissionDiscreteAccessCluster): String? {
+        // Special case for EMERGENCY_LOCATION app op. Show enforced attribution label in the
+        // Privacy Dashboard
+        if (
+            isLocationByPassEnabled() &&
+                accessCluster.clusteredOp == AppOpsManager.OPSTR_EMERGENCY_LOCATION
+        ) {
+            return application.getString(
+                R.string.privacy_dashboard_emergency_location_enforced_attribution_label
+            )
+        }
+
+        return if (accessCluster.attributionLabel == Resources.ID_NULL) null
         else {
             val lightPackageInfo = getLightPackageInfo(accessCluster.appPermissionId)
             getSubAttributionLabels(lightPackageInfo)?.get(accessCluster.attributionLabel)
         }
+    }
 
     private fun getSubAttributionLabels(lightPackageInfo: LightPackageInfo?): Map<Int, String>? =
         if (lightPackageInfo == null) null
@@ -528,34 +563,21 @@ class PermissionUsageDetailsViewModel(
         val accessEndTime: Long,
         val summaryText: CharSequence?,
         val showingAttribution: Boolean,
-        val attributionTags: ArrayList<String>,
+        val attributionTags: Set<String>,
         val badgedPackageIcon: Drawable?,
+        val isEmergencyLocationAccess: Boolean
     )
 
-    /**
-     * Class containing all the information needed by the permission usage details fragments to
-     * render UI.
-     */
-    data class PermissionUsageDetailsUiInfo(
-        /**
-         * Whether to show data over the last 7 days.
-         *
-         * While this information is available from the [SHOULD_SHOW_7_DAYS_KEY] state, we include
-         * it in the UI info so that it triggers a UI update when changed.
-         */
-        private val show7Days: Boolean,
-        /**
-         * Whether to show system apps' data.
-         *
-         * While this information is available from the [SHOULD_SHOW_SYSTEM_KEY] state, we include
-         * it in the UI info so that it triggers a UI update when changed.
-         */
-        private val showSystem: Boolean,
-        /** List of [AppPermissionAccessUiInfo]s to be displayed in the UI. */
-        val appPermissionAccessUiInfoList: List<AppPermissionAccessUiInfo>,
-        /** Whether to show the "show/hide system" toggle. */
-        val containsSystemAppAccesses: Boolean,
-    )
+    sealed class PermissionUsageDetailsUiState {
+        data object Loading : PermissionUsageDetailsUiState()
+
+        data class Success(
+            val appPermissionAccessUiInfoList: List<AppPermissionAccessUiInfo>,
+            val containsSystemAppUsage: Boolean,
+            val showSystem: Boolean,
+            val show7Days: Boolean,
+        ) : PermissionUsageDetailsUiState()
+    }
 
     /**
      * Data class representing a cluster of permission accesses close enough together to be
@@ -566,6 +588,7 @@ class PermissionUsageDetailsViewModel(
         val attributionLabel: Int,
         val attributionTags: List<String>,
         val discreteAccesses: List<DiscreteAccess>,
+        val clusteredOp: String?
     )
 
     /**
@@ -579,9 +602,10 @@ class PermissionUsageDetailsViewModel(
         val discreteAccesses: List<DiscreteAccess>
     )
 
-    /** [LiveData] object for [PermissionUsageDetailsUiInfo]. */
-    val permissionUsagesDetailsInfoUiLiveData =
-        object : SmartUpdateMediatorLiveData<@JvmSuppressWildcards PermissionUsageDetailsUiInfo>() {
+    /** [LiveData] object for [PermissionUsageDetailsUiState]. */
+    private val _permissionUsagesDetailsInfoUiLiveData =
+        object :
+            SmartUpdateMediatorLiveData<@JvmSuppressWildcards PermissionUsageDetailsUiState>() {
             private val getAppPermGroupUiInfoLiveData = { appPermissionId: AppPermissionId ->
                 AppPermGroupUiInfoLiveData[
                     Triple(
@@ -615,8 +639,7 @@ class PermissionUsageDetailsViewModel(
                             ?.get(packageWithUserHandle)
                             ?.appPermissionDiscreteAccesses
                             ?.map { it.appPermissionId }
-                            ?.toSet()
-                            ?: setOf()
+                            ?.toSet() ?: setOf()
 
                     appPermissionIds.addAll(appPermGroupIds)
                 }
@@ -648,44 +671,21 @@ class PermissionUsageDetailsViewModel(
             }
         }
 
-    /**
-     * Returns the icon for the provided package name and user, by first searching the cache
-     * otherwise retrieving it from the app's [android.content.pm.ApplicationInfo].
-     */
-    private fun getBadgedPackageIcon(packageName: String, userHandle: UserHandle): Drawable? {
-        val packageNameWithUser: Pair<String, UserHandle> = Pair(packageName, userHandle)
-        if (packageIconCache.containsKey(packageNameWithUser)) {
-            return requireNotNull(packageIconCache[packageNameWithUser])
-        }
-        val packageIcon = KotlinUtils.getBadgedPackageIcon(application, packageName, userHandle)
-        if (packageIcon != null) packageIconCache[packageNameWithUser] = packageIcon
-
-        return packageIcon
-    }
-
-    /**
-     * Returns the label for the provided package name, by first searching the cache otherwise
-     * retrieving it from the app's [android.content.pm.ApplicationInfo].
-     */
-    private fun getPackageLabel(packageName: String, user: UserHandle): String {
-        if (packageLabelCache.containsKey(packageName)) {
-            return requireNotNull(packageLabelCache[packageName])
-        }
+    override fun getPermissionUsagesDetailsInfoUiLiveData():
+        LiveData<PermissionUsageDetailsUiState> = _permissionUsagesDetailsInfoUiLiveData
 
-        val packageLabel = KotlinUtils.getPackageLabel(application, packageName, user)
-        packageLabelCache[packageName] = packageLabel
+    override fun getShowSystem(): Boolean = showSystemLiveData.value ?: false
 
-        return packageLabel
-    }
+    override fun getShow7Days(): Boolean = show7DaysLiveData.value ?: false
 
     /** Companion object for [PermissionUsageDetailsViewModel]. */
     companion object {
-        private const val ONE_HOUR_MS = 3_600_000
-        private const val ONE_MINUTE_MS = 60_000
-        private const val CLUSTER_SPACING_MINUTES: Long = 1L
+        const val ONE_HOUR_MS = 3_600_000
+        const val ONE_MINUTE_MS = 60_000
+        const val CLUSTER_SPACING_MINUTES: Long = 1L
         private const val TELECOM_PACKAGE = "com.android.server.telecom"
-        private val TIME_7_DAYS_DURATION: Long = DAYS.toMillis(7)
-        private val TIME_24_HOURS_DURATION: Long = DAYS.toMillis(1)
+        val TIME_7_DAYS_DURATION: Long = DAYS.toMillis(7)
+        val TIME_24_HOURS_DURATION: Long = DAYS.toMillis(1)
         internal const val SHOULD_SHOW_SYSTEM_KEY = "showSystem"
         internal const val SHOULD_SHOW_7_DAYS_KEY = "show7Days"
 
@@ -705,6 +705,9 @@ class PermissionUsageDetailsViewModel(
                     if (SdkLevel.isAtLeastT()) {
                         add(AppOpsManager.OPSTR_RECEIVE_AMBIENT_TRIGGER_AUDIO)
                     }
+                    if (isLocationByPassEnabled()) {
+                        add(AppOpsManager.OPSTR_EMERGENCY_LOCATION)
+                    }
                 }
 
         /** Creates the [Intent] for the click action of a privacy dashboard app usage event. */
@@ -716,7 +719,7 @@ class PermissionUsageDetailsViewModel(
             accessStartTime: Long,
             accessEndTime: Long,
             showingAttribution: Boolean,
-            attributionTags: List<String>
+            attributionTags: Set<String>
         ): Intent {
             return getManagePermissionUsageIntent(
                 context,
@@ -726,8 +729,7 @@ class PermissionUsageDetailsViewModel(
                 accessEndTime,
                 showingAttribution,
                 attributionTags
-            )
-                ?: getDefaultManageAppPermissionsIntent(packageName, userHandle)
+            ) ?: getDefaultManageAppPermissionsIntent(packageName, userHandle)
         }
 
         /**
@@ -741,7 +743,7 @@ class PermissionUsageDetailsViewModel(
             accessStartTime: Long,
             accessEndTime: Long,
             showingAttribution: Boolean,
-            attributionTags: List<String>
+            attributionTags: Set<String>
         ): Intent? {
             if (
                 !showingAttribution ||
@@ -790,6 +792,9 @@ class PermissionUsageDetailsViewModel(
                 putExtra(Intent.EXTRA_PACKAGE_NAME, packageName)
             }
         }
+
+        private fun isLocationByPassEnabled(): Boolean =
+            SdkLevel.isAtLeastV() && Flags.locationBypassPrivacyDashboardEnabled()
     }
 
     /** Factory for [PermissionUsageDetailsViewModel]. */
@@ -805,7 +810,14 @@ class PermissionUsageDetailsViewModel(
             handle: SavedStateHandle,
         ): T {
             @Suppress("UNCHECKED_CAST")
-            return PermissionUsageDetailsViewModel(app, handle, permissionGroup) as T
+            return if (
+                com.android.permission.flags.Flags.livedataRefactorPermissionTimelineEnabled()
+            ) {
+                Log.d("PermissionTimeline", "timeline refactor flag enabled..")
+                PermissionUsageDetailsViewModelV2.create(app, handle, permissionGroup) as T
+            } else {
+                PermissionUsageDetailsViewModel(app, handle, permissionGroup) as T
+            }
         }
     }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/PermissionUsageDetailsViewModelV2.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/PermissionUsageDetailsViewModelV2.kt
new file mode 100644
index 000000000..312a7ee20
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/model/v31/PermissionUsageDetailsViewModelV2.kt
@@ -0,0 +1,242 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.model.v31
+
+import android.app.AppOpsManager.OPSTR_EMERGENCY_LOCATION
+import android.app.Application
+import android.graphics.drawable.Drawable
+import android.os.UserHandle
+import androidx.annotation.VisibleForTesting
+import androidx.lifecycle.LiveData
+import androidx.lifecycle.SavedStateHandle
+import androidx.lifecycle.asLiveData
+import androidx.lifecycle.viewModelScope
+import com.android.permissioncontroller.DeviceUtils
+import com.android.permissioncontroller.R
+import com.android.permissioncontroller.appops.data.repository.v31.AppOpRepository
+import com.android.permissioncontroller.permission.data.repository.v31.PermissionRepository
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionTimelineUsageModel
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionTimelineUsageModelWrapper
+import com.android.permissioncontroller.permission.domain.usecase.v31.GetPermissionGroupUsageDetailsUseCase
+import com.android.permissioncontroller.permission.domain.usecase.v31.isLocationByPassEnabled
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.SHOULD_SHOW_7_DAYS_KEY
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.SHOULD_SHOW_SYSTEM_KEY
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.TIME_24_HOURS_DURATION
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.TIME_7_DAYS_DURATION
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsUiState
+import com.android.permissioncontroller.pm.data.repository.v31.PackageRepository
+import com.android.permissioncontroller.role.data.repository.v31.RoleRepository
+import com.android.permissioncontroller.user.data.repository.v31.UserRepository
+import java.time.Instant
+import kotlinx.coroutines.CoroutineDispatcher
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.Dispatchers
+import kotlinx.coroutines.flow.Flow
+import kotlinx.coroutines.flow.MutableStateFlow
+import kotlinx.coroutines.flow.SharingStarted
+import kotlinx.coroutines.flow.StateFlow
+import kotlinx.coroutines.flow.combine
+import kotlinx.coroutines.flow.flowOn
+import kotlinx.coroutines.flow.stateIn
+
+class PermissionUsageDetailsViewModelV2(
+    app: Application,
+    private val getPermissionUsageDetailsUseCase: GetPermissionGroupUsageDetailsUseCase,
+    private val state: SavedStateHandle,
+    private val permissionGroup: String,
+    scope: CoroutineScope? = null,
+    private val defaultDispatcher: CoroutineDispatcher = Dispatchers.Default,
+    private val packageRepository: PackageRepository = PackageRepository.getInstance(app)
+) : BasePermissionUsageDetailsViewModel(app) {
+    private val coroutineScope = scope ?: viewModelScope
+    private val context = app
+
+    private val showSystemFlow = MutableStateFlow(state[SHOULD_SHOW_SYSTEM_KEY] ?: false)
+    private val show7DaysFlow = MutableStateFlow(state[SHOULD_SHOW_7_DAYS_KEY] ?: false)
+
+    private val permissionTimelineUsagesFlow:
+        StateFlow<PermissionTimelineUsageModelWrapper> by lazy {
+        getPermissionUsageDetailsUseCase(coroutineScope)
+            .flowOn(defaultDispatcher)
+            .stateIn(
+                coroutineScope,
+                SharingStarted.WhileSubscribed(5000),
+                PermissionTimelineUsageModelWrapper.Loading
+            )
+    }
+
+    @VisibleForTesting
+    val permissionUsageDetailsUiStateFlow: Flow<PermissionUsageDetailsUiState> by lazy {
+        combine(permissionTimelineUsagesFlow, showSystemFlow, show7DaysFlow) {
+                permissionTimelineUsages,
+                showSystem,
+                show7Days ->
+                permissionTimelineUsages.buildPermissionUsageDetailsUiInfo(showSystem, show7Days)
+            }
+            .flowOn(defaultDispatcher)
+    }
+
+    override fun getPermissionUsagesDetailsInfoUiLiveData():
+        LiveData<PermissionUsageDetailsUiState> {
+        return permissionUsageDetailsUiStateFlow.asLiveData(
+            context = coroutineScope.coroutineContext
+        )
+    }
+
+    private fun PermissionTimelineUsageModelWrapper.buildPermissionUsageDetailsUiInfo(
+        showSystem: Boolean,
+        show7Days: Boolean
+    ): PermissionUsageDetailsUiState {
+        if (this is PermissionTimelineUsageModelWrapper.Loading) {
+            return PermissionUsageDetailsUiState.Loading
+        }
+        val timelineUsageModels =
+            (this as PermissionTimelineUsageModelWrapper.Success).timelineUsageModels
+        val startTime =
+            (System.currentTimeMillis() - getUsageDuration(show7Days)).coerceAtLeast(
+                Instant.EPOCH.toEpochMilli()
+            )
+
+        val permissionTimelineUsageModels =
+            timelineUsageModels.filter { it.accessEndMillis > startTime }
+        val containsSystemUsages = permissionTimelineUsageModels.any { !it.isUserSensitive }
+        val result =
+            permissionTimelineUsageModels
+                .filter { showSystem || it.isUserSensitive }
+                .map { clusterOps ->
+                    val durationSummaryLabel =
+                        if (clusterOps.durationMillis > 0) {
+                            getDurationSummary(clusterOps.durationMillis)
+                        } else {
+                            null
+                        }
+                    val proxyLabel = getProxyPackageLabel(clusterOps)
+                    val isEmergencyLocationAccess =
+                        isLocationByPassEnabled() &&
+                            clusterOps.opNames.any { it == OPSTR_EMERGENCY_LOCATION }
+                    val subAttributionLabel =
+                        if (isEmergencyLocationAccess) {
+                            emergencyLocationAttributionLabel
+                        } else {
+                            clusterOps.attributionLabel
+                        }
+                    val showingSubAttribution = !subAttributionLabel.isNullOrEmpty()
+                    val summary =
+                        buildUsageSummary(subAttributionLabel, proxyLabel, durationSummaryLabel)
+                    PermissionUsageDetailsViewModel.AppPermissionAccessUiInfo(
+                        UserHandle.of(clusterOps.userId),
+                        clusterOps.packageName,
+                        getPackageLabel(clusterOps.packageName, UserHandle.of(clusterOps.userId)),
+                        permissionGroup,
+                        clusterOps.accessStartMillis,
+                        clusterOps.accessEndMillis,
+                        summary,
+                        showingSubAttribution,
+                        clusterOps.attributionTags ?: emptySet(),
+                        getBadgedPackageIcon(
+                            clusterOps.packageName,
+                            UserHandle.of(clusterOps.userId)
+                        ),
+                        isEmergencyLocationAccess
+                    )
+                }
+                .sortedBy { -1 * it.accessStartTime }
+        return PermissionUsageDetailsUiState.Success(
+            result,
+            containsSystemUsages,
+            showSystem,
+            show7Days
+        )
+    }
+
+    private val emergencyLocationAttributionLabel: String by lazy {
+        context.getString(R.string.privacy_dashboard_emergency_location_enforced_attribution_label)
+    }
+
+    override fun getShowSystem(): Boolean = showSystemFlow.value
+
+    override val showSystemLiveData =
+        showSystemFlow.asLiveData(context = coroutineScope.coroutineContext)
+
+    override fun getShow7Days(): Boolean = show7DaysFlow.value
+
+    private fun getUsageDuration(show7Days: Boolean): Long {
+        return if (show7Days && DeviceUtils.isHandheld()) {
+            TIME_7_DAYS_DURATION
+        } else {
+            TIME_24_HOURS_DURATION
+        }
+    }
+
+    private fun getProxyPackageLabel(accessCluster: PermissionTimelineUsageModel): String? =
+        accessCluster.proxyPackageName?.let { proxyPackageName ->
+            if (accessCluster.proxyUserId != null) {
+                getPackageLabel(proxyPackageName, UserHandle.of(accessCluster.proxyUserId))
+            } else null
+        }
+
+    override fun updateShowSystemAppsToggle(showSystem: Boolean) {
+        if (showSystem != state[SHOULD_SHOW_SYSTEM_KEY]) {
+            state[SHOULD_SHOW_SYSTEM_KEY] = showSystem
+        }
+        showSystemFlow.compareAndSet(!showSystem, showSystem)
+    }
+
+    override fun updateShow7DaysToggle(show7Days: Boolean) {
+        if (show7Days != state[SHOULD_SHOW_7_DAYS_KEY]) {
+            state[SHOULD_SHOW_7_DAYS_KEY] = show7Days
+        }
+        show7DaysFlow.compareAndSet(!show7Days, show7Days)
+    }
+
+    // TODO review these methods when old impl is removed, suspend function??
+    override fun getPackageLabel(app: Application, packageName: String, user: UserHandle): String {
+        return packageRepository.getPackageLabel(packageName, user)
+    }
+
+    override fun getBadgedPackageIcon(
+        app: Application,
+        packageName: String,
+        user: UserHandle
+    ): Drawable? {
+        return packageRepository.getBadgedPackageIcon(packageName, user)
+    }
+
+    companion object {
+        fun create(
+            app: Application,
+            handle: SavedStateHandle,
+            permissionGroup: String
+        ): PermissionUsageDetailsViewModelV2 {
+            val permissionRepository = PermissionRepository.getInstance(app)
+            val packageRepository = PackageRepository.getInstance(app)
+            val appOpRepository = AppOpRepository.getInstance(app, permissionRepository)
+            val roleRepository = RoleRepository.getInstance(app)
+            val userRepository = UserRepository.getInstance(app)
+            val useCase =
+                GetPermissionGroupUsageDetailsUseCase(
+                    permissionGroup,
+                    packageRepository,
+                    permissionRepository,
+                    appOpRepository,
+                    roleRepository,
+                    userRepository
+                )
+            return PermissionUsageDetailsViewModelV2(app, useCase, handle, permissionGroup)
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/television/AllAppPermissionsFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/television/AllAppPermissionsFragment.java
index 43cad8335..3fbefc742 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/television/AllAppPermissionsFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/television/AllAppPermissionsFragment.java
@@ -250,7 +250,7 @@ public final class AllAppPermissionsFragment extends SettingsWithHeader {
 
         // TODO: No hardcoded layouts
         SwitchPreference pref = new SwitchPreference(getPreferenceManager().getContext());
-        pref.setLayoutResource(R.layout.preference_permissions);
+        pref.setLayoutResource(R.layout.preference_permissions_television);
         pref.setChecked(permGroup.areRuntimePermissionsGranted(filterPermissions));
         pref.setIcon(getTintedPermissionIcon(getActivity(), perm, group));
         pref.setTitle(perm.loadLabel(getActivity().getPackageManager()));
@@ -277,7 +277,7 @@ public final class AllAppPermissionsFragment extends SettingsWithHeader {
 
         // TODO: No hardcoded layouts
         Preference pref = new Preference(getActivity());
-        pref.setLayoutResource(R.layout.preference_permissions);
+        pref.setLayoutResource(R.layout.preference_permissions_television);
         pref.setIcon(getTintedPermissionIcon(getActivity(), perm, group));
         pref.setTitle(perm.loadLabel(pm));
         pref.setPersistent(false);
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/television/AppPermissionFragment.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/television/AppPermissionFragment.java
index 399a694d0..eb2f95a24 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/television/AppPermissionFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/television/AppPermissionFragment.java
@@ -44,6 +44,7 @@ import android.content.Intent;
 import android.content.pm.PackageInfo;
 import android.content.pm.PackageManager;
 import android.graphics.drawable.Drawable;
+import android.os.Build;
 import android.os.Bundle;
 import android.os.Handler;
 import android.os.Looper;
@@ -55,6 +56,7 @@ import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.annotation.RequiresApi;
 import androidx.annotation.StringRes;
 import androidx.fragment.app.DialogFragment;
 import androidx.lifecycle.ViewModelProvider;
@@ -499,6 +501,7 @@ public class AppPermissionFragment extends SettingsWithHeader
     }
 
     @Override
+    @RequiresApi(Build.VERSION_CODES.TIRAMISU)
     public void showAdvancedConfirmDialog(AdvancedConfirmDialogArgs args) {
         AlertDialog.Builder b = new AlertDialog.Builder(getContext())
                 .setIcon(args.getIconId())
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/television/TEST_MAPPING b/PermissionController/src/com/android/permissioncontroller/permission/ui/television/TEST_MAPPING
new file mode 100644
index 000000000..1a74fb208
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/television/TEST_MAPPING
@@ -0,0 +1,19 @@
+{
+  "tv-postsubmit": [
+    {
+      "name": "PermissionUiTestCases",
+      "options": [
+        {"include-filter": "com.android.permissioncontroller.permissionui.ui.television"},
+        {"exclude-annotation": "org.junit.Ignore"},
+        {"exclude-annotation": "androidx.test.filters.FlakyTest"}
+      ]
+    },
+    {
+      "name": "CtsPermissionUiTestCases",
+      "options": [
+        {"include-filter": "android.permissionui.cts.CameraMicIndicatorsPermissionTest"},
+        {"exclude-annotation": "org.junit.Ignore"}
+      ]
+    }
+  ]
+}
\ No newline at end of file
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/viewmodel/v31/PermissionUsageViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/viewmodel/v31/PermissionUsageViewModel.kt
index 2741a3cd8..0df91adcc 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/viewmodel/v31/PermissionUsageViewModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/viewmodel/v31/PermissionUsageViewModel.kt
@@ -29,22 +29,25 @@ import androidx.lifecycle.ViewModel
 import androidx.lifecycle.asLiveData
 import androidx.lifecycle.viewModelScope
 import androidx.savedstate.SavedStateRegistryOwner
+import com.android.permissioncontroller.DeviceUtils
 import com.android.permissioncontroller.permission.data.repository.v31.PermissionRepository
 import com.android.permissioncontroller.permission.domain.model.v31.PermissionGroupUsageModel
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionGroupUsageModelWrapper
 import com.android.permissioncontroller.permission.domain.usecase.v31.GetPermissionGroupUsageUseCase
-import com.android.permissioncontroller.permission.utils.KotlinUtils
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.SHOULD_SHOW_7_DAYS_KEY
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.Companion.SHOULD_SHOW_SYSTEM_KEY
 import java.time.Instant
 import java.util.concurrent.TimeUnit
-import kotlin.concurrent.Volatile
 import kotlin.math.max
 import kotlinx.coroutines.CoroutineDispatcher
 import kotlinx.coroutines.CoroutineScope
 import kotlinx.coroutines.Dispatchers
 import kotlinx.coroutines.flow.Flow
+import kotlinx.coroutines.flow.MutableStateFlow
 import kotlinx.coroutines.flow.SharingStarted
 import kotlinx.coroutines.flow.StateFlow
+import kotlinx.coroutines.flow.combine
 import kotlinx.coroutines.flow.flowOn
-import kotlinx.coroutines.flow.map
 import kotlinx.coroutines.flow.stateIn
 import kotlinx.coroutines.runBlocking
 
@@ -55,43 +58,41 @@ class PermissionUsageViewModel(
     private val getPermissionUsageUseCase: GetPermissionGroupUsageUseCase,
     scope: CoroutineScope? = null,
     private val defaultDispatcher: CoroutineDispatcher = Dispatchers.Default,
-    // Inject the parameter to prevent READ_DEVICE_CONFIG permission error on T- platforms.
-    private val is7DayToggleEnabled: Boolean = KotlinUtils.is7DayToggleEnabled(),
+    private val savedState: SavedStateHandle = SavedStateHandle(emptyMap()),
 ) : AndroidViewModel(app) {
-    private var showSystemApps = false
-    private var show7DaysData = false
+    private val showSystemFlow = MutableStateFlow(savedState[SHOULD_SHOW_SYSTEM_KEY] ?: false)
+    private val show7DaysFlow = MutableStateFlow(savedState[SHOULD_SHOW_7_DAYS_KEY] ?: false)
     private val coroutineScope = scope ?: viewModelScope
 
-    // Cache permission usages to calculate ui state for "show system" and "show 7 days" toggle.
-    @Volatile private var permissionGroupUsages = emptyList<PermissionGroupUsageModel>()
-
-    private val permissionUsagesUiStateFlow: StateFlow<PermissionUsagesUiState> by lazy {
+    private val permissionUsagesUiStateFlow: StateFlow<PermissionGroupUsageModelWrapper> by lazy {
         getPermissionUsageUseCase()
-            .map { permGroupUsages ->
-                permissionGroupUsages = permGroupUsages
-                buildPermissionUsagesUiState(permGroupUsages)
-            }
             .flowOn(defaultDispatcher)
             .stateIn(
                 coroutineScope,
                 SharingStarted.WhileSubscribed(5000),
-                PermissionUsagesUiState.Loading
+                PermissionGroupUsageModelWrapper.Loading
             )
     }
 
-    val permissionUsagesUiLiveData =
-        permissionUsagesUiStateFlow.asLiveData(context = coroutineScope.coroutineContext)
-
     @VisibleForTesting
-    fun getPermissionUsagesUiDataFlow(): Flow<PermissionUsagesUiState> {
-        return permissionUsagesUiStateFlow
+    val permissionUsagesUiDataFlow: Flow<PermissionUsagesUiState> by lazy {
+        combine(permissionUsagesUiStateFlow, showSystemFlow, show7DaysFlow) {
+                permGroupUsages,
+                showSystemApps,
+                show7Days ->
+                buildPermissionUsagesUiState(permGroupUsages, showSystemApps, show7Days)
+            }
+            .flowOn(defaultDispatcher)
     }
 
+    val permissionUsagesUiLiveData =
+        permissionUsagesUiDataFlow.asLiveData(context = coroutineScope.coroutineContext)
+
     /** Get start time based on whether to show 24 hours or 7 days data. */
     private fun getStartTime(show7DaysData: Boolean): Long {
         val curTime = System.currentTimeMillis()
         val showPermissionUsagesDuration =
-            if (is7DayToggleEnabled && show7DaysData) {
+            if (show7DaysData && DeviceUtils.isHandheld()) {
                 TIME_7_DAYS_DURATION
             } else {
                 TIME_24_HOURS_DURATION
@@ -101,8 +102,17 @@ class PermissionUsageViewModel(
 
     /** Builds a [PermissionUsagesUiState] containing all data necessary to render the UI. */
     private fun buildPermissionUsagesUiState(
-        permissionGroupOps: List<PermissionGroupUsageModel>
+        usages: PermissionGroupUsageModelWrapper,
+        showSystemApps: Boolean,
+        show7DaysData: Boolean,
     ): PermissionUsagesUiState {
+        if (usages is PermissionGroupUsageModelWrapper.Loading) {
+            return PermissionUsagesUiState.Loading
+        }
+
+        val permissionGroupOps: List<PermissionGroupUsageModel> =
+            (usages as PermissionGroupUsageModelWrapper.Success).permissionUsageModels
+
         val startTime = getStartTime(show7DaysData)
         val dashboardPermissionGroups =
             permissionRepository.getPermissionGroupsForPrivacyDashboard()
@@ -120,26 +130,31 @@ class PermissionUsageViewModel(
             }
         return PermissionUsagesUiState.Success(
             permGroupOps.any { !it.isUserSensitive },
-            permissionUsageCountMap
+            permissionUsageCountMap,
+            showSystemApps,
+            show7DaysData
         )
     }
 
-    fun getShowSystemApps(): Boolean {
-        return showSystemApps
-    }
+    fun getShowSystemApps(): Boolean = showSystemFlow.value
 
-    fun getShow7DaysData(): Boolean {
-        return show7DaysData
-    }
+    fun getShow7DaysData(): Boolean = show7DaysFlow.value
+
+    val showSystemAppsLiveData =
+        showSystemFlow.asLiveData(context = coroutineScope.coroutineContext)
 
-    fun updateShowSystem(showSystem: Boolean): PermissionUsagesUiState {
-        showSystemApps = showSystem
-        return buildPermissionUsagesUiState(permissionGroupUsages)
+    fun updateShowSystem(showSystem: Boolean) {
+        if (showSystem != savedState[SHOULD_SHOW_SYSTEM_KEY]) {
+            savedState[SHOULD_SHOW_SYSTEM_KEY] = showSystem
+        }
+        showSystemFlow.compareAndSet(!showSystem, showSystem)
     }
 
-    fun updateShow7Days(show7Days: Boolean): PermissionUsagesUiState {
-        show7DaysData = show7Days
-        return buildPermissionUsagesUiState(permissionGroupUsages)
+    fun updateShow7Days(show7Days: Boolean) {
+        if (show7Days != savedState[SHOULD_SHOW_7_DAYS_KEY]) {
+            savedState[SHOULD_SHOW_7_DAYS_KEY] = show7Days
+        }
+        show7DaysFlow.compareAndSet(!show7Days, show7Days)
     }
 
     private val permissionGroupLabels = mutableMapOf<String, String>()
@@ -163,9 +178,12 @@ class PermissionUsageViewModel(
 /** Data class to hold all the information required to configure the UI. */
 sealed class PermissionUsagesUiState {
     data object Loading : PermissionUsagesUiState()
+
     data class Success(
-        val shouldShowSystemToggle: Boolean,
-        val permissionGroupUsageCount: Map<String, Int>
+        val containsSystemAppUsage: Boolean,
+        val permissionGroupUsageCount: Map<String, Int>,
+        val showSystem: Boolean,
+        val show7Days: Boolean,
     ) : PermissionUsagesUiState()
 }
 
@@ -184,6 +202,12 @@ class PermissionUsageViewModelFactory(
     ): T {
         val permissionRepository = PermissionRepository.getInstance(app)
         val permissionUsageUseCase = GetPermissionGroupUsageUseCase.create(app)
-        return PermissionUsageViewModel(app, permissionRepository, permissionUsageUseCase) as T
+        return PermissionUsageViewModel(
+            app,
+            permissionRepository,
+            permissionUsageUseCase,
+            savedState = handle
+        )
+            as T
     }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/viewmodel/v31/package-info.java b/PermissionController/src/com/android/permissioncontroller/permission/ui/viewmodel/v31/package-info.java
new file mode 100644
index 000000000..ab144afa8
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/viewmodel/v31/package-info.java
@@ -0,0 +1,18 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+@androidx.annotation.RequiresApi(android.os.Build.VERSION_CODES.S)
+package com.android.permissioncontroller.permission.ui.viewmodel.v31;
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/LocationProviderDialogScreen.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/LocationProviderDialogScreen.kt
new file mode 100644
index 000000000..6af62e01f
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/LocationProviderDialogScreen.kt
@@ -0,0 +1,71 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.wear
+
+import androidx.compose.foundation.layout.fillMaxWidth
+import androidx.compose.runtime.Composable
+import androidx.compose.runtime.LaunchedEffect
+import androidx.compose.ui.Modifier
+import androidx.compose.ui.res.stringResource
+import androidx.wear.compose.foundation.SwipeToDismissValue
+import androidx.wear.compose.foundation.rememberSwipeToDismissBoxState
+import androidx.wear.compose.material.ChipDefaults
+import androidx.wear.compose.material.MaterialTheme
+import androidx.wear.compose.material.SwipeToDismissBox
+import com.android.permissioncontroller.permission.ui.wear.elements.Chip
+import com.android.permissioncontroller.permission.ui.wear.elements.Scaffold
+import com.android.permissioncontroller.permission.ui.wear.model.LocationProviderInterceptDialogArgs
+
+@Composable
+fun LocationProviderDialogScreen(args: LocationProviderInterceptDialogArgs?) {
+    args?.apply {
+        val state = rememberSwipeToDismissBoxState()
+        LaunchedEffect(state.currentValue) {
+            // If the swipe is complete
+            if (state.currentValue == SwipeToDismissValue.Dismissed) {
+                onOkButtonClick()
+            }
+        }
+        SwipeToDismissBox(state = state) { isBackground ->
+            Scaffold(
+                showTimeText = false,
+                image = iconId,
+                title = stringResource(titleId),
+                subtitle = message,
+                isLoading = isBackground,
+                content = {
+                    item {
+                        Chip(
+                            label = stringResource(locationSettingsId),
+                            onClick = onLocationSettingsClick,
+                            modifier = Modifier.fillMaxWidth(),
+                            textColor = MaterialTheme.colors.surface,
+                            colors = ChipDefaults.primaryChipColors()
+                        )
+                    }
+                    item {
+                        Chip(
+                            label = stringResource(okButtonTitleId),
+                            onClick = onOkButtonClick,
+                            modifier = Modifier.fillMaxWidth(),
+                        )
+                    }
+                }
+            )
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionFragment.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionFragment.kt
index 3936e54d4..959dc9137 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionFragment.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionFragment.kt
@@ -19,11 +19,13 @@ package com.android.permissioncontroller.permission.ui.wear
 import android.Manifest
 import android.app.Activity
 import android.content.Intent
+import android.os.Build
 import android.os.Bundle
 import android.os.UserHandle
 import android.view.LayoutInflater
 import android.view.View
 import android.view.ViewGroup
+import androidx.annotation.RequiresApi
 import androidx.annotation.StringRes
 import androidx.compose.ui.platform.ComposeView
 import androidx.core.os.BundleCompat
@@ -125,15 +127,14 @@ class WearAppPermissionFragment : Fragment(), ConfirmDialogShowingFragment {
         val permGroupName =
             arguments?.getString(Intent.EXTRA_PERMISSION_GROUP_NAME)
                 ?: arguments?.getString(Intent.EXTRA_PERMISSION_NAME)
-                    ?: throw RuntimeException("Permission name must not be null.")
+                ?: throw RuntimeException("Permission name must not be null.")
 
         val isStorageGroup = permGroupName == Manifest.permission_group.STORAGE
 
         val user =
             arguments?.let {
                 BundleCompat.getParcelable(it, Intent.EXTRA_USER, UserHandle::class.java)
-            }
-                ?: UserHandle.SYSTEM
+            } ?: UserHandle.SYSTEM
         val permGroupLabel = getPermGroupLabel(activity, permGroupName).toString()
 
         val sessionId = arguments?.getLong(EXTRA_SESSION_ID) ?: Constants.INVALID_SESSION_ID
@@ -233,6 +234,8 @@ class WearAppPermissionFragment : Fragment(), ConfirmDialogShowingFragment {
             confirmDialogViewModel.showAdvancedConfirmDialogLiveData.value = false
         }
 
+        val onDisabledAllowButtonTap: () -> Unit = { viewModel.handleDisabledAllowButton(this) }
+
         return ComposeView(activity).apply {
             setContent {
                 WearPermissionTheme {
@@ -246,7 +249,8 @@ class WearAppPermissionFragment : Fragment(), ConfirmDialogShowingFragment {
                         onConfirmDialogOkButtonClick,
                         onConfirmDialogCancelButtonClick,
                         onAdvancedConfirmDialogOkButtonClick,
-                        onAdvancedConfirmDialogCancelButtonClick
+                        onAdvancedConfirmDialogCancelButtonClick,
+                        onDisabledAllowButtonTap
                     )
                 }
             }
@@ -269,6 +273,7 @@ class WearAppPermissionFragment : Fragment(), ConfirmDialogShowingFragment {
         confirmDialogViewModel.showConfirmDialogLiveData.value = true
     }
 
+    @RequiresApi(Build.VERSION_CODES.TIRAMISU)
     override fun showAdvancedConfirmDialog(args: AdvancedConfirmDialogArgs) {
         confirmDialogViewModel.advancedConfirmDialogArgs = args
         confirmDialogViewModel.showAdvancedConfirmDialogLiveData.value = true
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsFragment.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsFragment.kt
index 9b960dfb5..552876b7d 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsFragment.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsFragment.kt
@@ -46,8 +46,9 @@ import com.android.permissioncontroller.permission.ui.wear.model.AppPermissionGr
 import com.android.permissioncontroller.permission.ui.wear.model.AppPermissionGroupsRevokeDialogViewModelFactory
 import com.android.permissioncontroller.permission.ui.wear.model.WearAppPermissionUsagesViewModel
 import com.android.permissioncontroller.permission.ui.wear.model.WearAppPermissionUsagesViewModelFactory
+import com.android.permissioncontroller.permission.ui.wear.model.WearLocationProviderInterceptDialogViewModel
+import com.android.permissioncontroller.permission.ui.wear.model.WearLocationProviderInterceptDialogViewModelFactory
 import com.android.permissioncontroller.permission.ui.wear.theme.WearPermissionTheme
-import com.android.permissioncontroller.permission.utils.KotlinUtils.is7DayToggleEnabled
 import java.time.Instant
 import java.util.concurrent.TimeUnit
 
@@ -68,17 +69,15 @@ class WearAppPermissionGroupsFragment : Fragment(), PermissionsUsagesChangeCallb
         val user =
             arguments?.let {
                 BundleCompat.getParcelable(it, Intent.EXTRA_USER, UserHandle::class.java)!!
-            }
-                ?: UserHandle.SYSTEM
+            } ?: UserHandle.SYSTEM
 
         val activity: Activity = requireActivity()
         val packageManager = activity.packageManager
-
         val packageInfo: PackageInfo? =
             try {
                 packageManager.getPackageInfo(packageName, PackageManager.GET_PERMISSIONS)
             } catch (e: PackageManager.NameNotFoundException) {
-                Log.i(LOG_TAG, "No package:" + activity.getCallingPackage(), e)
+                Log.i(LOG_TAG, "No package:" + activity.callingPackage, e)
                 null
             }
 
@@ -88,16 +87,30 @@ class WearAppPermissionGroupsFragment : Fragment(), PermissionsUsagesChangeCallb
             return null
         }
         val sessionId = arguments?.getLong(EXTRA_SESSION_ID, 0) ?: 0
-        val appPermissions = AppPermissions(activity, packageInfo, true, { activity.finish() })
-        val factory = AppPermissionGroupsViewModelFactory(packageName, user, sessionId)
+
+        val appPermissions = AppPermissions(activity, packageInfo, true) { activity.finish() }
+
         val viewModel =
-            ViewModelProvider(this, factory).get(AppPermissionGroupsViewModel::class.java)
+            ViewModelProvider(
+                owner = this,
+                factory = AppPermissionGroupsViewModelFactory(packageName, user, sessionId)
+            )[AppPermissionGroupsViewModel::class.java]
+
         wearViewModel =
-            ViewModelProvider(this, WearAppPermissionUsagesViewModelFactory())
-                .get(WearAppPermissionUsagesViewModel::class.java)
+            ViewModelProvider(owner = this, factory = WearAppPermissionUsagesViewModelFactory())[
+                WearAppPermissionUsagesViewModel::class.java]
+
         val revokeDialogViewModel =
-            ViewModelProvider(this, AppPermissionGroupsRevokeDialogViewModelFactory())
-                .get(AppPermissionGroupsRevokeDialogViewModel::class.java)
+            ViewModelProvider(
+                owner = this,
+                factory = AppPermissionGroupsRevokeDialogViewModelFactory()
+            )[AppPermissionGroupsRevokeDialogViewModel::class.java]
+
+        val locationProviderInterceptDialogViewModel =
+            ViewModelProvider(
+                owner = this,
+                factory = WearLocationProviderInterceptDialogViewModelFactory()
+            )[WearLocationProviderInterceptDialogViewModel::class.java]
 
         val context = requireContext()
 
@@ -106,13 +119,10 @@ class WearAppPermissionGroupsFragment : Fragment(), PermissionsUsagesChangeCallb
         if (SdkLevel.isAtLeastS()) {
             permissionUsages = PermissionUsages(context)
             val aggregateDataFilterBeginDays =
-                (if (is7DayToggleEnabled())
-                        AppPermissionGroupsViewModel.AGGREGATE_DATA_FILTER_BEGIN_DAYS_7
-                    else AppPermissionGroupsViewModel.AGGREGATE_DATA_FILTER_BEGIN_DAYS_1)
-                    .toLong()
+                AppPermissionGroupsViewModel.AGGREGATE_DATA_FILTER_BEGIN_DAYS_1.toLong()
 
             val filterTimeBeginMillis =
-                Math.max(
+                maxOf(
                     System.currentTimeMillis() -
                         TimeUnit.DAYS.toMillis(aggregateDataFilterBeginDays),
                     Instant.EPOCH.toEpochMilli()
@@ -123,7 +133,7 @@ class WearAppPermissionGroupsFragment : Fragment(), PermissionsUsagesChangeCallb
                 filterTimeBeginMillis,
                 Long.MAX_VALUE,
                 PermissionUsages.USAGE_FLAG_LAST,
-                requireActivity().getLoaderManager(),
+                requireActivity().loaderManager,
                 false,
                 false,
                 this,
@@ -140,7 +150,8 @@ class WearAppPermissionGroupsFragment : Fragment(), PermissionsUsagesChangeCallb
                 appPermissions = appPermissions,
                 viewModel = viewModel,
                 wearViewModel = wearViewModel,
-                revokeDialogViewModel = revokeDialogViewModel
+                revokeDialogViewModel = revokeDialogViewModel,
+                locationProviderInterceptDialogViewModel = locationProviderInterceptDialogViewModel
             )
 
         return ComposeView(activity).apply {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsHelper.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsHelper.kt
index 9529ac83a..078eefe3b 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsHelper.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsHelper.kt
@@ -17,7 +17,6 @@
 package com.android.permissioncontroller.permission.ui.wear
 
 import android.content.Context
-import android.content.Intent
 import android.content.pm.PackageManager
 import android.content.pm.PermissionInfo
 import android.os.Build
@@ -35,14 +34,13 @@ import com.android.permissioncontroller.permission.model.Permission
 import com.android.permissioncontroller.permission.model.livedatatypes.HibernationSettingState
 import com.android.permissioncontroller.permission.model.v31.AppPermissionUsage
 import com.android.permissioncontroller.permission.ui.Category
-import com.android.permissioncontroller.permission.ui.LocationProviderInterceptDialog
-import com.android.permissioncontroller.permission.ui.handheld.AppPermissionFragment
 import com.android.permissioncontroller.permission.ui.model.AppPermissionGroupsViewModel
 import com.android.permissioncontroller.permission.ui.model.AppPermissionGroupsViewModel.GroupUiInfo
 import com.android.permissioncontroller.permission.ui.model.AppPermissionGroupsViewModel.PermSubtitle
 import com.android.permissioncontroller.permission.ui.wear.model.AppPermissionGroupsRevokeDialogViewModel
 import com.android.permissioncontroller.permission.ui.wear.model.RevokeDialogArgs
 import com.android.permissioncontroller.permission.ui.wear.model.WearAppPermissionUsagesViewModel
+import com.android.permissioncontroller.permission.ui.wear.model.WearLocationProviderInterceptDialogViewModel
 import com.android.permissioncontroller.permission.utils.ArrayUtils
 import com.android.permissioncontroller.permission.utils.LocationUtils
 import com.android.permissioncontroller.permission.utils.Utils
@@ -59,6 +57,7 @@ class WearAppPermissionGroupsHelper(
     val viewModel: AppPermissionGroupsViewModel,
     val wearViewModel: WearAppPermissionUsagesViewModel,
     val revokeDialogViewModel: AppPermissionGroupsRevokeDialogViewModel,
+    val locationProviderInterceptDialogViewModel: WearLocationProviderInterceptDialogViewModel,
     private val toggledGroups: ArraySet<AppPermissionGroup> = ArraySet()
 ) {
     fun getPermissionGroupChipParams(
@@ -310,9 +309,7 @@ class WearAppPermissionGroupsHelper(
         addToggledGroup(group)
 
         if (LocationUtils.isLocationGroupAndProvider(context, permGroupName, packageName)) {
-            val intent = Intent(context, LocationProviderInterceptDialog::class.java)
-            intent.putExtra(Intent.EXTRA_PACKAGE_NAME, packageName)
-            context.startActivityAsUser(intent, user)
+            locationProviderInterceptDialogViewModel.showDialog(context, packageName)
         } else if (
             LocationUtils.isLocationGroupAndControllerExtraPackage(
                 context,
@@ -324,7 +321,7 @@ class WearAppPermissionGroupsHelper(
             LocationUtils.startLocationControllerExtraPackageSettings(context, user)
         } else {
             val args =
-                AppPermissionFragment.createArgs(
+                WearAppPermissionFragment.createArgs(
                     packageName,
                     null,
                     permGroupName,
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsScreen.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsScreen.kt
index 0883666fc..ba37205a6 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsScreen.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionGroupsScreen.kt
@@ -39,6 +39,11 @@ fun WearAppPermissionGroupsScreen(helper: WearAppPermissionGroupsHelper) {
     val autoRevoke = helper.viewModel.autoRevokeLiveData.observeAsState(null)
     val appPermissionUsages = helper.wearViewModel.appPermissionUsages.observeAsState(emptyList())
     val showRevokeDialog = helper.revokeDialogViewModel.showDialogLiveData.observeAsState(false)
+    val showLocationProviderDialog =
+        helper.locationProviderInterceptDialogViewModel.dialogVisibilityLiveData.observeAsState(
+            false
+        )
+
     var isLoading by remember { mutableStateOf(true) }
 
     Box {
@@ -51,6 +56,11 @@ fun WearAppPermissionGroupsScreen(helper: WearAppPermissionGroupsHelper) {
             showDialog = showRevokeDialog.value,
             args = helper.revokeDialogViewModel.revokeDialogArgs
         )
+        if (showLocationProviderDialog.value) {
+            LocationProviderDialogScreen(
+                helper.locationProviderInterceptDialogViewModel.locationProviderInterceptDialogArgs
+            )
+        }
     }
 
     if (isLoading && !packagePermGroups.value.isNullOrEmpty()) {
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionScreen.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionScreen.kt
index ccbd51f7d..202ad49bb 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionScreen.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearAppPermissionScreen.kt
@@ -25,6 +25,7 @@ import androidx.compose.runtime.remember
 import androidx.compose.runtime.setValue
 import androidx.compose.ui.res.stringResource
 import androidx.wear.compose.foundation.lazy.rememberScalingLazyListState
+import androidx.wear.compose.material.ToggleChipDefaults
 import com.android.permissioncontroller.R
 import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel
 import com.android.permissioncontroller.permission.ui.model.AppPermissionViewModel.ButtonState
@@ -35,6 +36,7 @@ import com.android.permissioncontroller.permission.ui.wear.elements.ListFooter
 import com.android.permissioncontroller.permission.ui.wear.elements.ScrollableScreen
 import com.android.permissioncontroller.permission.ui.wear.elements.ToggleChip
 import com.android.permissioncontroller.permission.ui.wear.elements.ToggleChipToggleControl
+import com.android.permissioncontroller.permission.ui.wear.elements.toggleChipDisabledColors
 import com.android.permissioncontroller.permission.ui.wear.model.AppPermissionConfirmDialogViewModel
 import com.android.permissioncontroller.permission.ui.wear.model.ConfirmDialogArgs
 import com.android.settingslib.RestrictedLockUtils
@@ -50,7 +52,8 @@ fun WearAppPermissionScreen(
     onConfirmDialogOkButtonClick: (ConfirmDialogArgs) -> Unit,
     onConfirmDialogCancelButtonClick: () -> Unit,
     onAdvancedConfirmDialogOkButtonClick: (AdvancedConfirmDialogArgs) -> Unit,
-    onAdvancedConfirmDialogCancelButtonClick: () -> Unit
+    onAdvancedConfirmDialogCancelButtonClick: () -> Unit,
+    onDisabledAllowButtonClick: () -> Unit
 ) {
     val buttonState = viewModel.buttonStateLiveData.observeAsState(null)
     val detailResIds = viewModel.detailResIdLiveData.observeAsState(null)
@@ -70,6 +73,7 @@ fun WearAppPermissionScreen(
             onLocationSwitchChanged,
             onGrantedStateChanged,
             onFooterClicked,
+            onDisabledAllowButtonClick
         )
         ConfirmDialog(
             showDialog = showConfirmDialog.value,
@@ -98,7 +102,8 @@ internal fun WearAppPermissionContent(
     isLoading: Boolean,
     onLocationSwitchChanged: (Boolean) -> Unit,
     onGrantedStateChanged: (ButtonType, Boolean) -> Unit,
-    onFooterClicked: (RestrictedLockUtils.EnforcedAdmin) -> Unit
+    onFooterClicked: (RestrictedLockUtils.EnforcedAdmin) -> Unit,
+    onDisabledAllowButtonClick: () -> Unit
 ) {
     ScrollableScreen(title = title, isLoading = isLoading) {
         buttonState?.get(ButtonType.LOCATION_ACCURACY)?.let {
@@ -121,11 +126,20 @@ internal fun WearAppPermissionContent(
                     item {
                         ToggleChip(
                             checked = it.isChecked,
-                            enabled = it.isEnabled,
+                            colors =
+                                if (it.isEnabled) {
+                                    ToggleChipDefaults.toggleChipColors()
+                                } else {
+                                    toggleChipDisabledColors()
+                                },
                             label = labelsByButton(buttonType),
                             toggleControl = ToggleChipToggleControl.Radio,
                             onCheckedChanged = { checked ->
-                                onGrantedStateChanged(buttonType, checked)
+                                if (it.isEnabled) {
+                                    onGrantedStateChanged(buttonType, checked)
+                                } else {
+                                    onDisabledAllowButtonClick()
+                                }
                             },
                             labelMaxLine = Integer.MAX_VALUE
                         )
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearEnhancedConfirmationDialogFragment.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearEnhancedConfirmationDialogFragment.kt
new file mode 100644
index 000000000..e81fd948d
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearEnhancedConfirmationDialogFragment.kt
@@ -0,0 +1,75 @@
+/*
+ * Copyright 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      https://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.wear
+
+import android.content.Context
+import android.graphics.Color
+import android.os.Bundle
+import android.view.LayoutInflater
+import android.view.View
+import android.view.ViewGroup
+import androidx.compose.ui.platform.ComposeView
+import androidx.fragment.app.DialogFragment
+import androidx.fragment.app.viewModels
+import com.android.permissioncontroller.ecm.EnhancedConfirmationDialogActivity
+import com.android.permissioncontroller.permission.ui.wear.model.WearEnhancedConfirmationViewModel
+import com.android.permissioncontroller.permission.ui.wear.theme.WearPermissionTheme
+
+class WearEnhancedConfirmationDialogFragment : DialogFragment() {
+    private lateinit var enhancedConfirmationDialogActivity: EnhancedConfirmationDialogActivity
+    private val viewModel: WearEnhancedConfirmationViewModel by viewModels()
+
+    override fun onAttach(context: Context) {
+        super.onAttach(context)
+        enhancedConfirmationDialogActivity = context as EnhancedConfirmationDialogActivity
+        enhancedConfirmationDialogActivity.window.decorView.setBackgroundColor(Color.TRANSPARENT)
+    }
+
+    override fun onCreateView(
+        inflater: LayoutInflater,
+        container: ViewGroup?,
+        savedInstanceState: Bundle?
+    ): View {
+        val title =
+            arguments?.getString(KEY_TITLE) ?: throw RuntimeException("ECM Title can't be null")
+        val message =
+            arguments?.getCharSequence(KEY_MESSAGE)?.apply {
+                viewModel.stripLearnMoreLinkFrom(this)
+            } ?: throw RuntimeException("ECM Message can't be null")
+
+        return ComposeView(enhancedConfirmationDialogActivity).apply {
+            setContent {
+                WearPermissionTheme { WearEnhancedConfirmationScreen(viewModel, title, message) }
+            }
+        }
+    }
+
+    companion object {
+        const val TAG = "WearEnhancedConfirmationDialogFragment"
+        private const val KEY_TITLE = "KEY_TITLE"
+        private const val KEY_MESSAGE = "KEY_MESSAGE"
+
+        fun newInstance(title: String? = null, message: CharSequence? = null) =
+            WearEnhancedConfirmationDialogFragment().apply {
+                arguments =
+                    Bundle().apply {
+                        putString(KEY_TITLE, title)
+                        putCharSequence(KEY_MESSAGE, message)
+                    }
+            }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearEnhancedConfirmationScreen.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearEnhancedConfirmationScreen.kt
new file mode 100644
index 000000000..1c31ec96f
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearEnhancedConfirmationScreen.kt
@@ -0,0 +1,147 @@
+/*
+ * Copyright 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      https://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.wear
+
+import android.app.Activity
+import androidx.compose.foundation.background
+import androidx.compose.foundation.layout.Box
+import androidx.compose.foundation.layout.fillMaxSize
+import androidx.compose.foundation.layout.fillMaxWidth
+import androidx.compose.runtime.Composable
+import androidx.compose.runtime.LaunchedEffect
+import androidx.compose.runtime.getValue
+import androidx.compose.runtime.mutableStateOf
+import androidx.compose.runtime.remember
+import androidx.compose.runtime.setValue
+import androidx.compose.ui.Alignment
+import androidx.compose.ui.Modifier
+import androidx.compose.ui.platform.LocalContext
+import androidx.compose.ui.res.stringResource
+import androidx.fragment.app.FragmentActivity
+import androidx.wear.compose.foundation.SwipeToDismissValue
+import androidx.wear.compose.foundation.lazy.ScalingLazyListState
+import androidx.wear.compose.foundation.rememberSwipeToDismissBoxState
+import androidx.wear.compose.material.ChipDefaults
+import androidx.wear.compose.material.CircularProgressIndicator
+import androidx.wear.compose.material.MaterialTheme
+import androidx.wear.compose.material.SwipeToDismissBox
+import com.android.permissioncontroller.R
+import com.android.permissioncontroller.permission.ui.wear.elements.AlertDialog
+import com.android.permissioncontroller.permission.ui.wear.elements.CheckYourPhoneScreen
+import com.android.permissioncontroller.permission.ui.wear.elements.CheckYourPhoneState
+import com.android.permissioncontroller.permission.ui.wear.elements.CheckYourPhoneState.InProgress
+import com.android.permissioncontroller.permission.ui.wear.elements.CheckYourPhoneState.Success
+import com.android.permissioncontroller.permission.ui.wear.elements.Chip
+import com.android.permissioncontroller.permission.ui.wear.elements.ScrollableScreen
+import com.android.permissioncontroller.permission.ui.wear.elements.dismiss
+import com.android.permissioncontroller.permission.ui.wear.elements.findActivity
+import com.android.permissioncontroller.permission.ui.wear.model.WearEnhancedConfirmationViewModel
+import com.android.permissioncontroller.permission.ui.wear.model.WearEnhancedConfirmationViewModel.ScreenState
+
+@Composable
+fun WearEnhancedConfirmationScreen(
+    viewModel: WearEnhancedConfirmationViewModel,
+    title: String?,
+    message: CharSequence?,
+) {
+    var dismissed by remember { mutableStateOf(false) }
+    val context = LocalContext.current
+    val ecmScreenState = remember { viewModel.screenState }
+    val activity = context.findActivity()
+
+    val state = rememberSwipeToDismissBoxState()
+
+    LaunchedEffect(state.currentValue) {
+        if (state.currentValue == SwipeToDismissValue.Dismissed) {
+            dismiss(activity)
+            dismissed = true
+            state.snapTo(SwipeToDismissValue.Default)
+        }
+    }
+
+    fun dismiss(activity: Activity) {
+        if (activity is FragmentActivity) {
+            if (!activity.supportFragmentManager.popBackStackImmediate()) {
+                activity.finish()
+            }
+        } else {
+            activity.finish()
+        }
+    }
+
+    @Composable
+    fun ShowECMRestrictionDialog() =
+        ScrollableScreen(
+            showTimeText = false,
+            title = title,
+            subtitle = message,
+            image = R.drawable.ic_android_security_privacy,
+            content = {
+                item {
+                    Chip(
+                        label = stringResource(R.string.enhanced_confirmation_dialog_ok),
+                        onClick = { dismiss(activity) },
+                        modifier = Modifier.fillMaxWidth(),
+                        textColor = MaterialTheme.colors.surface,
+                        colors = ChipDefaults.primaryChipColors()
+                    )
+                }
+                item {
+                    Chip(
+                        label = stringResource(R.string.enhanced_confirmation_dialog_learn_more),
+                        onClick = { viewModel.openUriOnPhone(context) },
+                        modifier = Modifier.fillMaxWidth(),
+                    )
+                }
+            }
+        )
+
+    @Composable
+    fun ShowCheckYourPhoneDialog(state: CheckYourPhoneState) =
+        CheckYourPhoneScreen(
+            title = stringResource(id = R.string.wear_check_your_phone_title),
+            state = state
+        )
+
+    @Composable
+    fun ShowRemoteConnectionErrorDialog() =
+        AlertDialog(
+            title = stringResource(R.string.wear_phone_connection_error),
+            message = stringResource(R.string.wear_phone_connection_should_retry),
+            iconRes = R.drawable.ic_error,
+            showDialog = true,
+            okButtonIcon = R.drawable.ic_refresh,
+            onOKButtonClick = { viewModel.openUriOnPhone(context) },
+            onCancelButtonClick = { dismiss(activity) },
+            scalingLazyListState = ScalingLazyListState(1)
+        )
+
+    SwipeToDismissBox(state = state) { isBackground ->
+        if (isBackground || dismissed) {
+            Box(modifier = Modifier.fillMaxSize().background(MaterialTheme.colors.background)) {
+                CircularProgressIndicator(modifier = Modifier.align(Alignment.Center))
+            }
+        } else {
+            when (ecmScreenState.value) {
+                ScreenState.SHOW_RESTRICTION_DIALOG -> ShowECMRestrictionDialog()
+                ScreenState.SHOW_CONNECTION_IN_PROGRESS -> ShowCheckYourPhoneDialog(InProgress)
+                ScreenState.SHOW_CONNECTION_ERROR -> ShowRemoteConnectionErrorDialog()
+                ScreenState.SHOW_CONNECTION_SUCCESS -> ShowCheckYourPhoneDialog(Success)
+            }
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsFragment.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsFragment.kt
index d8eb71e0e..783ca593b 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsFragment.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsFragment.kt
@@ -33,11 +33,12 @@ import com.android.permissioncontroller.Constants
 import com.android.permissioncontroller.permission.model.v31.AppPermissionUsage
 import com.android.permissioncontroller.permission.model.v31.PermissionUsages
 import com.android.permissioncontroller.permission.model.v31.PermissionUsages.PermissionsUsagesChangeCallback
-import com.android.permissioncontroller.permission.ui.handheld.AppPermissionFragment
 import com.android.permissioncontroller.permission.ui.model.PermissionAppsViewModel
 import com.android.permissioncontroller.permission.ui.model.PermissionAppsViewModelFactory
 import com.android.permissioncontroller.permission.ui.wear.model.WearAppPermissionUsagesViewModel
 import com.android.permissioncontroller.permission.ui.wear.model.WearAppPermissionUsagesViewModelFactory
+import com.android.permissioncontroller.permission.ui.wear.model.WearLocationProviderInterceptDialogViewModel
+import com.android.permissioncontroller.permission.ui.wear.model.WearLocationProviderInterceptDialogViewModelFactory
 
 /**
  * This is a condensed version of
@@ -65,7 +66,7 @@ class WearPermissionAppsFragment : Fragment(), PermissionsUsagesChangeCallback {
         val permGroupName =
             arguments?.getString(Intent.EXTRA_PERMISSION_GROUP_NAME)
                 ?: arguments?.getString(Intent.EXTRA_PERMISSION_NAME)
-                    ?: throw RuntimeException("Permission group name must not be null.")
+                ?: throw RuntimeException("Permission group name must not be null.")
         val sessionId: Long =
             arguments?.getLong(Constants.EXTRA_SESSION_ID) ?: Constants.INVALID_SESSION_ID
         val isStorageAndLessThanT =
@@ -79,13 +80,19 @@ class WearPermissionAppsFragment : Fragment(), PermissionsUsagesChangeCallback {
             ViewModelProvider(this, WearAppPermissionUsagesViewModelFactory())
                 .get(WearAppPermissionUsagesViewModel::class.java)
 
+        val locationProviderDialogViewModel =
+            ViewModelProvider(
+                owner = this,
+                factory = WearLocationProviderInterceptDialogViewModelFactory()
+            )[WearLocationProviderInterceptDialogViewModel::class.java]
+
         val onAppClick: (String, UserHandle, String) -> Unit = { packageName, user, category ->
             run {
                 viewModel.navigateToAppPermission(
                     this,
                     packageName,
                     user,
-                    AppPermissionFragment.createArgs(
+                    WearAppPermissionFragment.createArgs(
                         packageName,
                         null,
                         permGroupName,
@@ -114,7 +121,7 @@ class WearPermissionAppsFragment : Fragment(), PermissionsUsagesChangeCallback {
                         isAllowedForeground,
                         isDenied,
                         sessionId,
-                        activity.getApplication(),
+                        activity.application,
                         permGroupName,
                         LOG_TAG
                     )
@@ -133,7 +140,7 @@ class WearPermissionAppsFragment : Fragment(), PermissionsUsagesChangeCallback {
                 filterTimeBeginMillis,
                 Long.MAX_VALUE,
                 PermissionUsages.USAGE_FLAG_LAST,
-                requireActivity().getLoaderManager(),
+                requireActivity().loaderManager,
                 false,
                 false,
                 this,
@@ -145,10 +152,12 @@ class WearPermissionAppsFragment : Fragment(), PermissionsUsagesChangeCallback {
             setContent {
                 WearPermissionAppsScreen(
                     WearPermissionAppsHelper(
-                        activity.getApplication(),
+                        activity.application,
+                        this@WearPermissionAppsFragment.requireContext(),
                         permGroupName,
                         viewModel,
                         wearViewModel,
+                        locationProviderDialogViewModel,
                         isStorageAndLessThanT,
                         onAppClick,
                         onShowSystemClick,
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsHelper.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsHelper.kt
index d14cdb620..a5d24e983 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsHelper.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsHelper.kt
@@ -17,6 +17,7 @@
 package com.android.permissioncontroller.permission.ui.wear
 
 import android.app.Application
+import android.content.Context
 import android.graphics.drawable.Drawable
 import android.os.UserHandle
 import com.android.permission.flags.Flags
@@ -25,9 +26,11 @@ import com.android.permissioncontroller.permission.model.v31.AppPermissionUsage
 import com.android.permissioncontroller.permission.ui.Category
 import com.android.permissioncontroller.permission.ui.model.PermissionAppsViewModel
 import com.android.permissioncontroller.permission.ui.wear.model.WearAppPermissionUsagesViewModel
+import com.android.permissioncontroller.permission.ui.wear.model.WearLocationProviderInterceptDialogViewModel
 import com.android.permissioncontroller.permission.utils.KotlinUtils
 import com.android.permissioncontroller.permission.utils.KotlinUtils.getPermGroupDescription
 import com.android.permissioncontroller.permission.utils.KotlinUtils.getPermGroupLabel
+import com.android.permissioncontroller.permission.utils.LocationUtils
 import com.android.settingslib.utils.applications.AppUtils
 import java.text.Collator
 import java.util.Random
@@ -35,20 +38,28 @@ import java.util.Random
 /** Helper class for WearPermissionsAppScreen. */
 class WearPermissionAppsHelper(
     val application: Application,
+    val context: Context,
     val permGroupName: String,
     val viewModel: PermissionAppsViewModel,
     val wearViewModel: WearAppPermissionUsagesViewModel,
+    val locationProviderDialogViewModel: WearLocationProviderInterceptDialogViewModel,
     private val isStorageAndLessThanT: Boolean,
     private val onAppClick: (String, UserHandle, String) -> Unit,
     val onShowSystemClick: (Boolean) -> Unit,
     val logFragmentCreated: (String, UserHandle, Long, Boolean, Boolean, Boolean) -> Unit
 ) {
     fun categorizedAppsLiveData() = viewModel.categorizedAppsLiveData
+
     fun hasSystemAppsLiveData() = viewModel.hasSystemAppsLiveData
+
     fun shouldShowSystemLiveData() = viewModel.shouldShowSystemLiveData
+
     fun showAlways() = viewModel.showAllowAlwaysStringLiveData.value ?: false
+
     fun getTitle() = getPermGroupLabel(application, permGroupName).toString()
+
     fun getSubTitle() = getPermGroupDescription(application, permGroupName).toString()
+
     fun getChipsByCategory(
         categorizedApps: Map<Category, List<Pair<String, UserHandle>>>,
         appPermissionUsages: List<AppPermissionUsage>
@@ -64,7 +75,7 @@ class WearPermissionAppsHelper(
         val comparator = ChipComparator(collator)
 
         val viewIdForLogging = Random().nextLong()
-        for (category in Category.values()) {
+        for (category in Category.entries) {
             if (category == Category.ALLOWED && isStorageAndLessThanT) {
                 val allowedList = categorizedApps[Category.ALLOWED]
                 if (!allowedList.isNullOrEmpty()) {
@@ -169,9 +180,21 @@ class WearPermissionAppsHelper(
             title = KotlinUtils.getPackageLabel(application, packageName, user),
             summary = summary,
             contentDescription =
-                AppUtils.getAppContentDescription(application, packageName, user.getIdentifier()),
+                AppUtils.getAppContentDescription(application, packageName, user.identifier),
             icon = KotlinUtils.getBadgedPackageIcon(application, packageName, user),
-            onClick = { onClick(packageName, user, category.categoryName) }
+            onClick = {
+                if (
+                    LocationUtils.isLocationGroupAndProvider(
+                        application.applicationContext,
+                        permGroupName,
+                        packageName
+                    )
+                ) {
+                    locationProviderDialogViewModel.showDialog(context, packageName)
+                } else {
+                    onClick(packageName, user, category.categoryName)
+                }
+            }
         )
     }
 
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsScreen.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsScreen.kt
index d694f20f8..8e779cb8c 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsScreen.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionAppsScreen.kt
@@ -16,6 +16,8 @@
 
 package com.android.permissioncontroller.permission.ui.wear
 
+import androidx.compose.foundation.layout.Box
+import androidx.compose.foundation.layout.fillMaxSize
 import androidx.compose.foundation.layout.fillMaxWidth
 import androidx.compose.foundation.layout.padding
 import androidx.compose.runtime.Composable
@@ -40,6 +42,8 @@ fun WearPermissionAppsScreen(helper: WearPermissionAppsHelper) {
     val categorizedApps = helper.categorizedAppsLiveData().observeAsState(emptyMap())
     val hasSystemApps = helper.hasSystemAppsLiveData().observeAsState(false)
     val showSystem = helper.shouldShowSystemLiveData().observeAsState(false)
+    val showLocationProviderDialog =
+        helper.locationProviderDialogViewModel.dialogVisibilityLiveData.observeAsState(false)
     val appPermissionUsages = helper.wearViewModel.appPermissionUsages.observeAsState(emptyList())
     var isLoading by remember { mutableStateOf(true) }
 
@@ -48,18 +52,23 @@ fun WearPermissionAppsScreen(helper: WearPermissionAppsHelper) {
     val showAlways = helper.showAlways()
     val chipsByCategory =
         helper.getChipsByCategory(categorizedApps.value, appPermissionUsages.value)
-
-    WearPermissionAppsContent(
-        chipsByCategory,
-        showSystem.value,
-        hasSystemApps.value,
-        title,
-        subTitle,
-        showAlways,
-        isLoading,
-        helper.onShowSystemClick
-    )
-
+    Box(modifier = Modifier.fillMaxSize()) {
+        val dialogArgs = helper.locationProviderDialogViewModel.locationProviderInterceptDialogArgs
+        if (showLocationProviderDialog.value && dialogArgs != null) {
+            LocationProviderDialogScreen(dialogArgs)
+        } else {
+            WearPermissionAppsContent(
+                chipsByCategory = chipsByCategory,
+                showSystem = showSystem.value,
+                hasSystemApps = hasSystemApps.value,
+                title = title,
+                subtitle = subTitle,
+                showAlways = showAlways,
+                isLoading = isLoading,
+                onShowSystemClick = helper.onShowSystemClick
+            )
+        }
+    }
     if (isLoading && categorizedApps.value.isNotEmpty()) {
         isLoading = false
     }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageDetailsFragment.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageDetailsFragment.kt
index ead7f9503..2ade4863a 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageDetailsFragment.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageDetailsFragment.kt
@@ -29,9 +29,8 @@ import androidx.fragment.app.Fragment
 import androidx.lifecycle.ViewModelProvider
 import com.android.permissioncontroller.PermissionControllerApplication
 import com.android.permissioncontroller.permission.ui.ManagePermissionsActivity
-import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel
+import com.android.permissioncontroller.permission.ui.model.v31.BasePermissionUsageDetailsViewModel
 import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsViewModelFactory
-import com.android.permissioncontroller.permission.utils.KotlinUtils.is7DayToggleEnabled
 
 /**
  * This is a condensed version of
@@ -53,8 +52,6 @@ class WearPermissionUsageDetailsFragment : Fragment() {
                 }
         val showSystem =
             arguments?.getBoolean(ManagePermissionsActivity.EXTRA_SHOW_SYSTEM, false) ?: false
-        val show7Days =
-            arguments?.getBoolean(ManagePermissionsActivity.EXTRA_SHOW_7_DAYS, false) ?: false
 
         val factory =
             PermissionUsageDetailsViewModelFactory(
@@ -63,9 +60,8 @@ class WearPermissionUsageDetailsFragment : Fragment() {
                 permissionGroup
             )
         val viewModel =
-            ViewModelProvider(this, factory).get(PermissionUsageDetailsViewModel::class.java)
+            ViewModelProvider(this, factory).get(BasePermissionUsageDetailsViewModel::class.java)
         viewModel.updateShowSystemAppsToggle(showSystem)
-        viewModel.updateShow7DaysToggle(is7DayToggleEnabled() && show7Days)
 
         return ComposeView(requireContext()).apply {
             setContent { WearPermissionUsageDetailsScreen(permissionGroup, viewModel) }
@@ -79,7 +75,6 @@ class WearPermissionUsageDetailsFragment : Fragment() {
         fun newInstance(
             groupName: String?,
             showSystem: Boolean,
-            show7Days: Boolean
         ): WearPermissionUsageDetailsFragment {
             return WearPermissionUsageDetailsFragment().apply {
                 val arguments =
@@ -88,7 +83,6 @@ class WearPermissionUsageDetailsFragment : Fragment() {
                             putString(Intent.EXTRA_PERMISSION_GROUP_NAME, groupName)
                         }
                         putBoolean(ManagePermissionsActivity.EXTRA_SHOW_SYSTEM, showSystem)
-                        putBoolean(ManagePermissionsActivity.EXTRA_SHOW_7_DAYS, show7Days)
                     }
                 setArguments(arguments)
             }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageDetailsScreen.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageDetailsScreen.kt
index 3c62e5343..1259c1ab5 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageDetailsScreen.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageDetailsScreen.kt
@@ -33,8 +33,10 @@ import androidx.compose.ui.res.stringResource
 import androidx.wear.compose.material.ChipDefaults
 import androidx.wear.compose.material.MaterialTheme
 import com.android.permissioncontroller.R
+import com.android.permissioncontroller.permission.ui.model.v31.BasePermissionUsageDetailsViewModel
 import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel
 import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.AppPermissionAccessUiInfo
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsUiState
 import com.android.permissioncontroller.permission.ui.wear.elements.Chip
 import com.android.permissioncontroller.permission.ui.wear.elements.ScrollableScreen
 import com.android.permissioncontroller.permission.utils.KotlinUtils
@@ -43,10 +45,10 @@ import com.android.permissioncontroller.permission.utils.KotlinUtils
 @Composable
 fun WearPermissionUsageDetailsScreen(
     permissionGroup: String,
-    viewModel: PermissionUsageDetailsViewModel
+    viewModel: BasePermissionUsageDetailsViewModel
 ) {
     val context = LocalContext.current
-    val uiData = viewModel.permissionUsagesDetailsInfoUiLiveData.observeAsState(null)
+    val uiData = viewModel.getPermissionUsagesDetailsInfoUiLiveData().observeAsState(null)
     val showSystem = viewModel.showSystemLiveData.observeAsState(false)
     var isLoading by remember { mutableStateOf(true) }
 
@@ -56,7 +58,14 @@ fun WearPermissionUsageDetailsScreen(
             R.string.permission_group_usage_title,
             KotlinUtils.getPermGroupLabel(context, permissionGroup)
         )
-    val hasSystemApps: Boolean = uiData.value?.containsSystemAppAccesses ?: false
+
+    val hasSystemApps: Boolean =
+        if (uiData.value is PermissionUsageDetailsUiState.Success) {
+            (uiData.value as PermissionUsageDetailsUiState.Success).containsSystemAppUsage
+        } else {
+            false
+        }
+
     val onShowSystemClick: (Boolean) -> Unit = { show ->
         run { viewModel.updateShowSystemAppsToggle(show) }
     }
@@ -84,7 +93,11 @@ fun WearPermissionUsageDetailsScreen(
     }
 
     val appPermissionAccessUiInfoList: List<AppPermissionAccessUiInfo> =
-        uiData.value?.appPermissionAccessUiInfoList ?: emptyList()
+        if (uiData.value is PermissionUsageDetailsUiState.Success) {
+            (uiData.value as PermissionUsageDetailsUiState.Success).appPermissionAccessUiInfoList
+        } else {
+            emptyList()
+        }
 
     WearPermissionUsageDetailsContent(
         title,
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageFragment.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageFragment.kt
index 8f8960269..22ab7f77f 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageFragment.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageFragment.kt
@@ -28,8 +28,6 @@ import androidx.lifecycle.ViewModelProvider
 import com.android.permissioncontroller.Constants
 import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsageViewModel
 import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsageViewModelFactory
-import com.android.permissioncontroller.permission.ui.wear.model.WearPermissionUsageViewModel
-import com.android.permissioncontroller.permission.ui.wear.model.WearPermissionUsageViewModelFactory
 
 /**
  * This is a condensed version of
@@ -38,27 +36,19 @@ import com.android.permissioncontroller.permission.ui.wear.model.WearPermissionU
  */
 @RequiresApi(Build.VERSION_CODES.S)
 class WearPermissionUsageFragment : Fragment() {
-    lateinit var wearViewModel: WearPermissionUsageViewModel
     override fun onCreateView(
         inflater: LayoutInflater,
         container: ViewGroup?,
         savedInstanceState: Bundle?
-    ): View? {
+    ): View {
         val sessionId: Long =
             arguments?.getLong(Constants.EXTRA_SESSION_ID) ?: Constants.INVALID_SESSION_ID
-        val factory =
-            PermissionUsageViewModelFactory(requireActivity().getApplication(), this, Bundle())
+
+        val factory = PermissionUsageViewModelFactory(requireActivity().application, this, Bundle())
         val viewModel = ViewModelProvider(this, factory).get(PermissionUsageViewModel::class.java)
-        wearViewModel =
-            ViewModelProvider(this, WearPermissionUsageViewModelFactory(viewModel))
-                .get(WearPermissionUsageViewModel::class.java)
 
-        viewModel.permissionUsagesUiLiveData.observe(
-            this,
-            wearViewModel::updatePermissionUsagesUiStateLiveData
-        )
         return ComposeView(requireContext()).apply {
-            setContent { WearPermissionUsageScreen(sessionId, viewModel, wearViewModel) }
+            setContent { WearPermissionUsageScreen(sessionId, viewModel) }
         }
     }
 
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageScreen.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageScreen.kt
index 62d0c6212..f83d3338d 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageScreen.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/WearPermissionUsageScreen.kt
@@ -34,7 +34,6 @@ import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUs
 import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsagesUiState
 import com.android.permissioncontroller.permission.ui.wear.elements.Chip
 import com.android.permissioncontroller.permission.ui.wear.elements.ScrollableScreen
-import com.android.permissioncontroller.permission.ui.wear.model.WearPermissionUsageViewModel
 import com.android.permissioncontroller.permission.utils.Utils
 import java.text.Collator
 
@@ -43,27 +42,21 @@ import java.text.Collator
 fun WearPermissionUsageScreen(
     sessionId: Long,
     viewModel: PermissionUsageViewModel,
-    wearViewModel: WearPermissionUsageViewModel
 ) {
     val context = LocalContext.current
-    val permissionUsagesUiData = wearViewModel.permissionUsagesUiStateLiveData.observeAsState(null)
-    val showSystem = wearViewModel.showSystemAppsLiveData.observeAsState(false)
-    val show7Days = wearViewModel.show7DaysLiveData.observeAsState(false)
+    val permissionUsagesUiData = viewModel.permissionUsagesUiLiveData.observeAsState(null)
+    val showSystem = viewModel.showSystemAppsLiveData.observeAsState(false)
     var isLoading by remember { mutableStateOf(true) }
     val isDataLoaded = permissionUsagesUiData.value is PermissionUsagesUiState.Success
     val hasSystemApps: Boolean =
         if (isDataLoaded) {
             val uiState = permissionUsagesUiData.value as PermissionUsagesUiState.Success
-            uiState.shouldShowSystemToggle
+            uiState.containsSystemAppUsage
         } else {
             false
         }
-    val onShowSystemClick: (Boolean) -> Unit = { show ->
-        run {
-            wearViewModel.updatePermissionUsagesUiStateLiveData(viewModel.updateShowSystem(show))
-            wearViewModel.showSystemAppsLiveData.value = viewModel.getShowSystemApps()
-        }
-    }
+
+    val onShowSystemClick: (Boolean) -> Unit = { show -> run { viewModel.updateShowSystem(show) } }
 
     val permissionGroupWithUsageCounts: Map<String, Int> =
         if (isDataLoaded) {
@@ -87,7 +80,7 @@ fun WearPermissionUsageScreen(
                     it.value,
                     showSystem.value,
                     sessionId,
-                    show7Days.value
+                    false,
                 )
             }
             .sortedWith { o1, o2 ->
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/AlertDialog.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/AlertDialog.kt
index aa04cfad8..c07d2ba9e 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/AlertDialog.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/AlertDialog.kt
@@ -17,11 +17,15 @@
 package com.android.permissioncontroller.permission.ui.wear.elements
 
 import androidx.compose.foundation.layout.fillMaxWidth
+import androidx.compose.material.icons.Icons
+import androidx.compose.material.icons.filled.Check
+import androidx.compose.material.icons.filled.Close
 import androidx.compose.runtime.Composable
 import androidx.compose.runtime.remember
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.platform.LocalConfiguration
 import androidx.compose.ui.platform.LocalDensity
+import androidx.compose.ui.platform.LocalFocusManager
 import androidx.compose.ui.res.painterResource
 import androidx.compose.ui.res.stringResource
 import androidx.compose.ui.text.rememberTextMeasurer
@@ -52,6 +56,8 @@ import com.android.permissioncontroller.permission.ui.wear.elements.layout.remem
 fun AlertDialog(
     message: String,
     iconRes: Int? = null,
+    okButtonIcon: Any = Icons.Default.Check,
+    cancelButtonIcon: Any = Icons.Default.Close,
     onCancelButtonClick: () -> Unit,
     onOKButtonClick: () -> Unit,
     showDialog: Boolean,
@@ -61,9 +67,13 @@ fun AlertDialog(
     okButtonContentDescription: String = stringResource(android.R.string.ok),
     cancelButtonContentDescription: String = stringResource(android.R.string.cancel)
 ) {
+    val focusManager = LocalFocusManager.current
     Dialog(
         showDialog = showDialog,
-        onDismissRequest = onCancelButtonClick,
+        onDismissRequest = {
+            focusManager.clearFocus()
+            onCancelButtonClick()
+        },
         scrollState = scalingLazyListState,
         modifier = modifier
     ) {
@@ -71,6 +81,8 @@ fun AlertDialog(
             title = title,
             icon = { AlertIcon(iconRes) },
             message = message,
+            okButtonIcon = okButtonIcon,
+            cancelButtonIcon = cancelButtonIcon,
             onCancel = onCancelButtonClick,
             onOk = onOKButtonClick,
             okButtonContentDescription = okButtonContentDescription,
@@ -89,6 +101,7 @@ fun AlertDialog(
 fun SingleButtonAlertDialog(
     message: String,
     iconRes: Int? = null,
+    okButtonIcon: Any = Icons.Default.Check,
     onButtonClick: () -> Unit,
     showDialog: Boolean,
     scalingLazyListState: ScalingLazyListState,
@@ -106,6 +119,7 @@ fun SingleButtonAlertDialog(
             title = title,
             icon = { AlertIcon(iconRes) },
             message = message,
+            okButtonIcon = okButtonIcon,
             onOk = onButtonClick,
             okButtonContentDescription = buttonContentDescription
         )
@@ -113,12 +127,14 @@ fun SingleButtonAlertDialog(
 }
 
 @Composable
-public fun AlertContent(
+fun AlertContent(
     onCancel: (() -> Unit)? = null,
     onOk: (() -> Unit)? = null,
     icon: @Composable (() -> Unit)? = null,
     title: String? = null,
     message: String? = null,
+    okButtonIcon: Any = Icons.Default.Check,
+    cancelButtonIcon: Any = Icons.Default.Close,
     okButtonContentDescription: String = stringResource(android.R.string.ok),
     cancelButtonContentDescription: String = stringResource(android.R.string.cancel),
     state: ScalingLazyColumnState =
@@ -143,7 +159,6 @@ public fun AlertContent(
                         text = it,
                         color = MaterialTheme.colors.onBackground,
                         textAlign = TextAlign.Center,
-                        maxLines = if (icon == null) 3 else 2,
                         overflow = TextOverflow.Ellipsis,
                     )
                 }
@@ -187,6 +202,8 @@ public fun AlertContent(
         content = content,
         onOk = onOk,
         onCancel = onCancel,
+        okButtonIcon = okButtonIcon,
+        cancelButtonIcon = cancelButtonIcon,
         okButtonContentDescription = okButtonContentDescription,
         cancelButtonContentDescription = cancelButtonContentDescription,
         state = state,
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/CheckYourPhone.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/CheckYourPhone.kt
new file mode 100644
index 000000000..59376b8fa
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/CheckYourPhone.kt
@@ -0,0 +1,124 @@
+/*
+ * Copyright 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      https://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.wear.elements
+
+import android.content.res.Configuration
+import androidx.compose.foundation.layout.Arrangement
+import androidx.compose.foundation.layout.Column
+import androidx.compose.foundation.layout.fillMaxSize
+import androidx.compose.foundation.layout.fillMaxWidth
+import androidx.compose.foundation.layout.padding
+import androidx.compose.runtime.Composable
+import androidx.compose.ui.Alignment
+import androidx.compose.ui.Modifier
+import androidx.compose.ui.platform.LocalConfiguration
+import androidx.compose.ui.text.font.FontWeight
+import androidx.compose.ui.text.style.TextAlign
+import androidx.compose.ui.unit.dp
+import androidx.wear.compose.material.MaterialTheme
+import androidx.wear.compose.material.Scaffold
+import androidx.wear.compose.material.Text
+import com.android.permissioncontroller.R
+
+private const val TOP_PADDING_SCREEN_PERCENTAGE = 0.1248f
+private const val BOTTOM_PADDING_SCREEN_PERCENTAGE = 0.0624f
+private const val SIDE_PADDING_SCREEN_PERCENTAGE = 0.052f
+private const val TEXT_PADDING_SCREEN_PERCENTAGE = 0.0416f
+
+enum class CheckYourPhoneState {
+    InProgress,
+    Success
+}
+
+/**
+ * A screen to request the user to check their paired phone to proceed. It also allows a [message]
+ * to be displayed.
+ *
+ * <img
+ * src="https://media.githubusercontent.com/media/google/horologist/main/docs/auth-composables/check_your_phone_screen_code.png"
+ * height="120" width="120"/>
+ */
+@Composable
+fun CheckYourPhoneScreen(
+    title: String,
+    state: CheckYourPhoneState,
+    modifier: Modifier = Modifier,
+    message: String? = null,
+) {
+    val configuration = LocalConfiguration.current
+
+    val isLarge = configuration.isLargeScreen
+
+    val topPadding = (configuration.screenHeightDp * TOP_PADDING_SCREEN_PERCENTAGE).dp
+    val bottomPadding = (configuration.screenHeightDp * BOTTOM_PADDING_SCREEN_PERCENTAGE).dp
+    val sidePadding = (configuration.screenHeightDp * SIDE_PADDING_SCREEN_PERCENTAGE).dp
+    val textPadding =
+        if (isLarge) (configuration.screenHeightDp * TEXT_PADDING_SCREEN_PERCENTAGE).dp else 0.dp
+
+    Scaffold {
+        Column(
+            modifier =
+                modifier
+                    .fillMaxSize()
+                    .padding(
+                        top = topPadding,
+                        bottom = bottomPadding,
+                        start = sidePadding,
+                        end = sidePadding,
+                    ),
+        ) {
+            Column(
+                modifier = Modifier.fillMaxWidth().weight(1f).padding(horizontal = textPadding),
+                verticalArrangement = Arrangement.Center,
+            ) {
+                Text(
+                    text = title,
+                    modifier = Modifier.fillMaxWidth().align(Alignment.CenterHorizontally),
+                    textAlign = TextAlign.Center,
+                    style = MaterialTheme.typography.title3.copy(fontWeight = FontWeight.W600),
+                )
+
+                if (message != null) {
+                    Text(
+                        text = message,
+                        modifier =
+                            Modifier.padding(top = 20.dp)
+                                .fillMaxWidth()
+                                .align(Alignment.CenterHorizontally),
+                        textAlign = TextAlign.Center,
+                    )
+                }
+            }
+            when (state) {
+                CheckYourPhoneState.InProgress ->
+                    RemoteConnectionProgressIndicator(
+                        iconRes = R.drawable.ic_security_update_good,
+                        Modifier.align(Alignment.CenterHorizontally)
+                    )
+                CheckYourPhoneState.Success ->
+                    RemoteConnectionSuccess(
+                        iconRes = R.drawable.ic_security_update_good,
+                        Modifier.align(Alignment.CenterHorizontally)
+                    )
+            }
+        }
+    }
+}
+
+/** Whether the device is considered large screen for layout adjustment purposes. */
+internal val Configuration.isLargeScreen: Boolean
+    get() = screenHeightDp > 224
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/Chip.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/Chip.kt
index ff3eddc65..40f097c67 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/Chip.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/Chip.kt
@@ -34,6 +34,7 @@ import androidx.compose.ui.graphics.vector.ImageVector
 import androidx.compose.ui.res.painterResource
 import androidx.compose.ui.res.stringResource
 import androidx.compose.ui.text.font.FontWeight
+import androidx.compose.ui.text.style.Hyphens
 import androidx.compose.ui.text.style.TextAlign
 import androidx.compose.ui.text.style.TextOverflow
 import androidx.compose.ui.unit.dp
@@ -53,7 +54,7 @@ import androidx.wear.compose.material.contentColorFor
  *   by the Wear guidelines;
  */
 @Composable
-public fun Chip(
+fun Chip(
     label: String,
     labelMaxLines: Int? = null,
     onClick: () -> Unit,
@@ -130,7 +131,7 @@ public fun Chip(
  *   by the Wear guidelines;
  */
 @Composable
-public fun Chip(
+fun Chip(
     @StringRes labelId: Int,
     labelMaxLines: Int? = null,
     onClick: () -> Unit,
@@ -167,7 +168,7 @@ public fun Chip(
 // Setting the color as per
 // https://source.corp.google.com/piper///depot/google3/java/com/google/android/clockwork/common/wearable/wearmaterial/button/res/color/wear_button_secondary_text_stateful.xml?q=wear_button_secondary_text_stateful
 @Composable
-public fun Chip(
+fun Chip(
     label: String,
     labelMaxLines: Int? = null,
     onClick: () -> Unit,
@@ -192,7 +193,11 @@ public fun Chip(
             textAlign = if (hasSecondaryLabel || hasIcon) TextAlign.Start else TextAlign.Center,
             overflow = TextOverflow.Ellipsis,
             maxLines = labelMaxLines ?: if (hasSecondaryLabel) 1 else 2,
-            style = MaterialTheme.typography.button.copy(fontWeight = FontWeight.W600)
+            style =
+                MaterialTheme.typography.button.copy(
+                    fontWeight = FontWeight.W600,
+                    hyphens = Hyphens.Auto
+                )
         )
     }
 
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ListHeader.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ListHeader.kt
index 259e1b0b2..0a2a3937c 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ListHeader.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ListHeader.kt
@@ -36,6 +36,7 @@ import androidx.compose.ui.graphics.Color
 import androidx.compose.ui.semantics.heading
 import androidx.compose.ui.semantics.semantics
 import androidx.compose.ui.text.font.FontWeight
+import androidx.compose.ui.text.style.Hyphens
 import androidx.compose.ui.unit.dp
 import androidx.wear.compose.material.LocalContentColor
 import androidx.wear.compose.material.LocalTextStyle
@@ -73,7 +74,10 @@ fun ListHeader(
         CompositionLocalProvider(
             LocalContentColor provides contentColor,
             LocalTextStyle provides
-                MaterialTheme.typography.title3.copy(fontWeight = FontWeight.W600),
+                MaterialTheme.typography.title3.copy(
+                    fontWeight = FontWeight.W600,
+                    hyphens = Hyphens.Auto
+                ),
         ) {
             content()
         }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/RemoteConnectionProgressIndicator.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/RemoteConnectionProgressIndicator.kt
new file mode 100644
index 000000000..244e7e3fd
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/RemoteConnectionProgressIndicator.kt
@@ -0,0 +1,75 @@
+/*
+ * Copyright 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      https://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.wear.elements
+
+import androidx.compose.foundation.background
+import androidx.compose.foundation.layout.Box
+import androidx.compose.foundation.layout.size
+import androidx.compose.foundation.shape.CircleShape
+import androidx.compose.runtime.Composable
+import androidx.compose.ui.Alignment
+import androidx.compose.ui.Modifier
+import androidx.compose.ui.draw.clip
+import androidx.compose.ui.res.painterResource
+import androidx.compose.ui.unit.dp
+import androidx.wear.compose.material.CircularProgressIndicator
+import androidx.wear.compose.material.Icon
+import androidx.wear.compose.material.MaterialTheme
+
+@Composable
+fun RemoteConnectionProgressIndicator(iconRes: Int, modifier: Modifier) {
+    val indicatorPadding = 8.dp
+    val iconSize = 48.dp
+    val progressBarStrokeWidth = 4.dp
+    Box(
+        modifier = modifier.size(iconSize).clip(CircleShape),
+    ) {
+        CircularProgressIndicator(
+            modifier = Modifier.size(iconSize - progressBarStrokeWidth + indicatorPadding),
+            strokeWidth = progressBarStrokeWidth,
+        )
+        Icon(
+            painter = painterResource(iconRes),
+            contentDescription = null,
+            modifier =
+                Modifier.align(Alignment.Center)
+                    .size(iconSize - indicatorPadding - 8.dp)
+                    .clip(CircleShape),
+        )
+    }
+}
+
+@Composable
+fun RemoteConnectionSuccess(iconRes: Int, modifier: Modifier) {
+    val indicatorPadding = 8.dp
+    val iconSize = 48.dp
+    val backgroundColor = MaterialTheme.colors.onSurface
+    val contentColor = MaterialTheme.colors.surface
+    Box(
+        modifier = modifier.size(iconSize).clip(CircleShape).background(backgroundColor),
+    ) {
+        Icon(
+            painter = painterResource(iconRes),
+            contentDescription = null,
+            tint = contentColor,
+            modifier =
+                Modifier.align(Alignment.Center)
+                    .size(iconSize - indicatorPadding - 8.dp)
+                    .clip(CircleShape),
+        )
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ResponsiveDialog.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ResponsiveDialog.kt
index cf828b91d..e1e869f71 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ResponsiveDialog.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ResponsiveDialog.kt
@@ -36,9 +36,9 @@ import androidx.compose.runtime.Composable
 import androidx.compose.runtime.CompositionLocalProvider
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
-import androidx.compose.ui.graphics.vector.ImageVector
 import androidx.compose.ui.platform.LocalConfiguration
 import androidx.compose.ui.res.stringResource
+import androidx.compose.ui.text.font.FontWeight
 import androidx.compose.ui.unit.Dp
 import androidx.compose.ui.unit.dp
 import androidx.wear.compose.foundation.lazy.ScalingLazyListScope
@@ -63,6 +63,8 @@ fun ResponsiveDialogContent(
     icon: @Composable (() -> Unit)? = null,
     title: @Composable (() -> Unit)? = null,
     message: @Composable (() -> Unit)? = null,
+    okButtonIcon: Any = Icons.Default.Check,
+    cancelButtonIcon: Any = Icons.Default.Close,
     onOk: (() -> Unit)? = null,
     onCancel: (() -> Unit)? = null,
     okButtonContentDescription: String = stringResource(android.R.string.ok),
@@ -104,7 +106,8 @@ fun ResponsiveDialogContent(
                 title?.let {
                     item {
                         CompositionLocalProvider(
-                            LocalTextStyle provides MaterialTheme.typography.title3,
+                            LocalTextStyle provides
+                                MaterialTheme.typography.title3.copy(fontWeight = FontWeight.W600),
                         ) {
                             Box(
                                 Modifier.fillMaxWidth(titleMaxWidthFraction)
@@ -151,7 +154,7 @@ fun ResponsiveDialogContent(
                         ) {
                             onCancel?.let {
                                 ResponsiveButton(
-                                    icon = Icons.Default.Close,
+                                    icon = cancelButtonIcon,
                                     cancelButtonContentDescription,
                                     onClick = it,
                                     buttonWidth,
@@ -160,7 +163,7 @@ fun ResponsiveDialogContent(
                             }
                             onOk?.let {
                                 ResponsiveButton(
-                                    icon = Icons.Default.Check,
+                                    icon = okButtonIcon,
                                     okButtonContentDescription,
                                     onClick = it,
                                     buttonWidth,
@@ -176,7 +179,7 @@ fun ResponsiveDialogContent(
 
 @Composable
 private fun ResponsiveButton(
-    icon: ImageVector,
+    icon: Any,
     contentDescription: String,
     onClick: () -> Unit,
     buttonWidth: Dp,
@@ -186,7 +189,7 @@ private fun ResponsiveButton(
         label = {
             Box(Modifier.fillMaxWidth()) {
                 Icon(
-                    imageVector = icon,
+                    icon = icon,
                     contentDescription = contentDescription,
                     modifier =
                         Modifier.size(ButtonDefaults.DefaultIconSize).align(Alignment.Center),
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ScrollableScreen.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ScrollableScreen.kt
index 717cf9528..53013def7 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ScrollableScreen.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ScrollableScreen.kt
@@ -88,15 +88,19 @@ fun ScrollableScreen(
     val state = rememberSwipeToDismissBoxState()
 
     LaunchedEffect(state.currentValue) {
+        // If the swipe is complete
         if (state.currentValue == SwipeToDismissValue.Dismissed) {
+            // pop the top fragment immediately or dismiss activity.
             dismiss(activity)
+            // Set  dismissed state as true
             dismissed = true
+            // Set swipe box back to starting position(that is cancelled swipe effect) to
+            // show loading indicator while fragment dismisses.
+            // For some reason fragment `popBackImmediate` takes few secs at times.
             state.snapTo(SwipeToDismissValue.Default)
         }
     }
 
-    // To support Swipe-dismiss effect,
-    // add the view to SwipeToDismissBox if the screen is not on the top fragment.
     if (getBackStackEntryCount(activity) > 0) {
         SwipeToDismissBox(state = state) { isBackground ->
             Scaffold(
@@ -135,12 +139,13 @@ internal fun Scaffold(
     titleTestTag: String? = null,
     subtitleTestTag: String? = null,
 ) {
+    val itemsSpacedBy = 4.dp
     val screenWidth = LocalConfiguration.current.screenWidthDp
     val screenHeight = LocalConfiguration.current.screenHeightDp
     val scrollContentHorizontalPadding = (screenWidth * 0.052).dp
     val titleHorizontalPadding = (screenWidth * 0.0884).dp
     val subtitleHorizontalPadding = (screenWidth * 0.0416).dp
-    val scrollContentTopPadding = (screenHeight * 0.1456).dp
+    val scrollContentTopPadding = (screenHeight * 0.1456).dp - itemsSpacedBy
     val scrollContentBottomPadding = (screenHeight * 0.3636).dp
     val titleBottomPadding =
         if (subtitle == null) {
@@ -198,7 +203,12 @@ internal fun Scaffold(
                 }
             },
             vignette = { Vignette(vignettePosition = VignettePosition.TopAndBottom) },
-            positionIndicator = { PositionIndicator(scalingLazyListState = listState) }
+            positionIndicator =
+                if (!isLoading) {
+                    { PositionIndicator(scalingLazyListState = listState) }
+                } else {
+                    null
+                }
         ) {
             Box(modifier = Modifier.fillMaxSize()) {
                 if (isLoading) {
@@ -218,6 +228,7 @@ internal fun Scaffold(
                                 bottom = scrollContentBottomPadding
                             )
                     ) {
+                        staticItem()
                         image?.let {
                             val imageModifier = Modifier.size(24.dp)
                             when (image) {
@@ -284,6 +295,26 @@ internal fun Scaffold(
     }
 }
 
+private fun ScalingLazyListScope.staticItem() {
+    /*
+    This empty item helps to ensure accurate scroll offset calculation. If auto centering is enabled
+    initial item's(first item for us) center matches the center of the screen. Scroll offset is 0 at
+    that point.
+
+    if auto centering is not enabled, initial item will start at the top of the screen with the
+    scroll offset equal to ScreenHeight/2 - scrollContentTopPadding - firstItemHeight/2.
+
+    We need to this offset value to properly move time text.That is the scroll-away offset of the
+    Time Text is equal to the scroll offset of the list at initial position.
+
+    It is easier to calculate if we know the values of ScreenHeight, ScrollContentTopPadding and
+    FirstItem's height. ScreenHeight and ScrollContentPadding are constants but height of the
+    FirstItem depends on the content. Instead of measuring the height, we can simplify the
+    calculation with an empty item with 0dp height.
+    */
+    item {}
+}
+
 @Composable
 private fun RequestFocusOnResume(focusRequester: FocusRequester) {
     val lifecycleOwner = LocalLifecycleOwner.current
@@ -308,8 +339,7 @@ internal fun getBackStackEntryCount(activity: Activity): Int {
     return if (activity is FragmentActivity) {
         activity.supportFragmentManager.primaryNavigationFragment
             ?.childFragmentManager
-            ?.backStackEntryCount
-            ?: 0
+            ?.backStackEntryCount ?: 0
     } else {
         0
     }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ToggleChip.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ToggleChip.kt
index fe1e75d67..a21a9d015 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ToggleChip.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/elements/ToggleChip.kt
@@ -30,6 +30,8 @@ import androidx.compose.ui.draw.clip
 import androidx.compose.ui.graphics.Color
 import androidx.compose.ui.graphics.compositeOver
 import androidx.compose.ui.res.stringResource
+import androidx.compose.ui.semantics.Role
+import androidx.compose.ui.semantics.role
 import androidx.compose.ui.semantics.semantics
 import androidx.compose.ui.semantics.stateDescription
 import androidx.compose.ui.text.style.TextAlign
@@ -51,7 +53,7 @@ import com.android.permissioncontroller.R
  * - a convenient way of providing an icon and setting the icon to be mirrored in RTL mode;
  */
 @Composable
-public fun ToggleChip(
+fun ToggleChip(
     checked: Boolean,
     onCheckedChanged: (Boolean) -> Unit,
     label: String,
@@ -127,6 +129,13 @@ public fun ToggleChip(
             }
         }
 
+    val semanticsRole =
+        when (toggleControl) {
+            ToggleChipToggleControl.Switch -> Role.Switch
+            ToggleChipToggleControl.Radio -> Role.RadioButton
+            ToggleChipToggleControl.Checkbox -> Role.Checkbox
+        }
+
     val stateDescriptionSemantics =
         stringResource(
             if (checked) {
@@ -141,7 +150,10 @@ public fun ToggleChip(
         label = labelParam,
         toggleControl = toggleControlParam,
         modifier =
-            modifier.fillMaxWidth().semantics { stateDescription = stateDescriptionSemantics },
+            modifier.fillMaxWidth().semantics {
+                role = semanticsRole
+                stateDescription = stateDescriptionSemantics
+            },
         appIcon = iconParam,
         secondaryLabel = secondaryLabelParam,
         colors = colors,
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/RemoteActivityHelper.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/RemoteActivityHelper.kt
new file mode 100644
index 000000000..3debe7bd3
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/RemoteActivityHelper.kt
@@ -0,0 +1,86 @@
+/*
+ * Copyright 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      https://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.wear.model
+
+import android.content.Context
+import android.content.Intent
+import android.os.Bundle
+import android.os.Parcel
+import android.os.ResultReceiver
+import kotlin.coroutines.Continuation
+import kotlin.coroutines.resume
+import kotlinx.coroutines.suspendCancellableCoroutine
+
+/*This class can be removed when the androidx library is available in Gerrit */
+class RemoteActivityHelper(val context: Context) {
+
+    companion object {
+        @SuppressWarnings("ActionValue")
+        private const val ACTION_REMOTE_INTENT: String =
+            "com.google.android.wearable.intent.action.REMOTE_INTENT"
+
+        private const val EXTRA_INTENT: String = "com.google.android.wearable.intent.extra.INTENT"
+
+        private const val EXTRA_RESULT_RECEIVER: String =
+            "com.google.android.wearable.intent.extra.RESULT_RECEIVER"
+
+        private const val RESULT_OK: Int = 0
+
+        private const val DEFAULT_PACKAGE = "com.google.android.wearable.app"
+
+        private fun getResultReceiverForSending(receiver: ResultReceiver): ResultReceiver {
+            val parcel = Parcel.obtain()
+            receiver.writeToParcel(parcel, 0)
+            parcel.setDataPosition(0)
+            val receiverForSending = ResultReceiver.CREATOR.createFromParcel(parcel)
+            parcel.recycle()
+            return receiverForSending
+        }
+    }
+
+    suspend fun startRemoteActivity(targetIntent: Intent): Boolean =
+        suspendCancellableCoroutine { cont ->
+            require(Intent.ACTION_VIEW == targetIntent.action) {
+                "Only ${Intent.ACTION_VIEW} action is currently supported for starting a" +
+                    " remote activity"
+            }
+            requireNotNull(targetIntent.data) {
+                "Data Uri is required when starting a remote activity"
+            }
+            require(targetIntent.categories?.contains(Intent.CATEGORY_BROWSABLE) == true) {
+                "The category ${Intent.CATEGORY_BROWSABLE} must be present on the intent"
+            }
+            val remoteResultReceiver = RemoteIntentResultReceiver(cont)
+            val remoteIntent =
+                Intent(ACTION_REMOTE_INTENT).apply {
+                    setPackage(DEFAULT_PACKAGE)
+                    putExtra(EXTRA_INTENT, targetIntent)
+                    putExtra(
+                        EXTRA_RESULT_RECEIVER,
+                        getResultReceiverForSending(remoteResultReceiver)
+                    )
+                }
+            context.sendBroadcast(remoteIntent)
+        }
+
+    private class RemoteIntentResultReceiver(val continuation: Continuation<Boolean>) :
+        ResultReceiver(null) {
+        override fun onReceiveResult(resultCode: Int, resultData: Bundle?) {
+            continuation.resume(resultCode == RESULT_OK)
+        }
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearEnhancedConfirmationViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearEnhancedConfirmationViewModel.kt
new file mode 100644
index 000000000..f4d5f29eb
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearEnhancedConfirmationViewModel.kt
@@ -0,0 +1,76 @@
+/*
+ * Copyright 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      https://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.wear.model
+
+import android.content.Context
+import android.content.Intent
+import android.net.Uri
+import android.text.SpannableStringBuilder
+import android.text.style.URLSpan
+import androidx.compose.runtime.MutableState
+import androidx.compose.runtime.State
+import androidx.compose.runtime.mutableStateOf
+import androidx.lifecycle.ViewModel
+import androidx.lifecycle.viewModelScope
+import com.android.permissioncontroller.R
+import kotlinx.coroutines.Dispatchers
+import kotlinx.coroutines.launch
+import kotlinx.coroutines.withContext
+
+class WearEnhancedConfirmationViewModel : ViewModel() {
+    enum class ScreenState {
+        SHOW_RESTRICTION_DIALOG,
+        SHOW_CONNECTION_IN_PROGRESS,
+        SHOW_CONNECTION_ERROR,
+        SHOW_CONNECTION_SUCCESS
+    }
+
+    private val mutableScreenState: MutableState<ScreenState> =
+        mutableStateOf(ScreenState.SHOW_RESTRICTION_DIALOG)
+    val screenState: State<ScreenState> = mutableScreenState
+
+    private fun getLearnMoreUri(context: Context) =
+        Uri.parse(context.getString(R.string.help_url_action_disabled_by_restricted_settings))
+
+    fun openUriOnPhone(context: Context) =
+        viewModelScope.launch {
+            val uri = getLearnMoreUri(context)
+            mutableScreenState.value = ScreenState.SHOW_CONNECTION_IN_PROGRESS
+            val target =
+                Intent(Intent.ACTION_VIEW).setData(uri).addCategory(Intent.CATEGORY_BROWSABLE)
+            val isSuccessful =
+                withContext(Dispatchers.IO) {
+                    RemoteActivityHelper(context).startRemoteActivity(target)
+                }
+            mutableScreenState.value =
+                if (isSuccessful) {
+                    ScreenState.SHOW_CONNECTION_SUCCESS
+                } else {
+                    ScreenState.SHOW_CONNECTION_ERROR
+                }
+        }
+
+    fun stripLearnMoreLinkFrom(message: CharSequence): CharSequence {
+        val text = SpannableStringBuilder.valueOf(message)
+        text.getSpans(0, message.length, URLSpan::class.java).map {
+            val spanStart = text.getSpanStart(it)
+            text.removeSpan(it)
+            text.delete(spanStart, message.length)
+        }
+        return text
+    }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearLocationProviderInterceptDialogViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearLocationProviderInterceptDialogViewModel.kt
new file mode 100644
index 000000000..009ff952c
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearLocationProviderInterceptDialogViewModel.kt
@@ -0,0 +1,90 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.wear.model
+
+import android.content.Context
+import android.content.Intent
+import android.content.pm.ApplicationInfo
+import android.content.pm.PackageInfo
+import android.content.pm.PackageManager
+import android.provider.Settings
+import androidx.lifecycle.LiveData
+import androidx.lifecycle.MutableLiveData
+import androidx.lifecycle.ViewModel
+import androidx.lifecycle.ViewModelProvider
+import com.android.permissioncontroller.R
+import com.android.permissioncontroller.permission.utils.Utils
+
+class WearLocationProviderInterceptDialogViewModel : ViewModel() {
+    private val showDialogLiveData = MutableLiveData<Boolean>()
+    val dialogVisibilityLiveData: LiveData<Boolean> = showDialogLiveData
+    var locationProviderInterceptDialogArgs: LocationProviderInterceptDialogArgs? = null
+
+    init {
+        showDialogLiveData.value = false
+    }
+
+    private fun applicationInfo(context: Context, packageName: String): ApplicationInfo? {
+        val packageInfo: PackageInfo? =
+            try {
+                context.packageManager.getPackageInfo(packageName, PackageManager.GET_PERMISSIONS)
+            } catch (e: PackageManager.NameNotFoundException) {
+                null
+            }
+        return packageInfo?.applicationInfo
+    }
+
+    fun showDialog(context: Context, packageName: String) {
+        val applicationInfo = applicationInfo(context, packageName) ?: return
+        val appLabel = Utils.getAppLabel(applicationInfo, context)
+        locationProviderInterceptDialogArgs =
+            LocationProviderInterceptDialogArgs(
+                iconId = R.drawable.ic_dialog_alert_material,
+                titleId = android.R.string.dialog_alert_title,
+                message = context.getString(R.string.location_warning, appLabel),
+                okButtonTitleId = R.string.ok,
+                locationSettingsId = R.string.location_settings,
+                onOkButtonClick = { dismissDialog() },
+                onLocationSettingsClick = {
+                    context.startActivity(Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS))
+                }
+            )
+        showDialogLiveData.value = true
+    }
+
+    fun dismissDialog() {
+        locationProviderInterceptDialogArgs = null
+        showDialogLiveData.value = false
+    }
+}
+
+/** Factory for an AppPermissionGroupsRevokeDialogViewModel */
+class WearLocationProviderInterceptDialogViewModelFactory : ViewModelProvider.Factory {
+    override fun <T : ViewModel> create(modelClass: Class<T>): T {
+        @Suppress("UNCHECKED_CAST") return WearLocationProviderInterceptDialogViewModel() as T
+    }
+}
+
+data class LocationProviderInterceptDialogArgs(
+    val iconId: Int,
+    val titleId: Int,
+    val message: String,
+    val okButtonTitleId: Int,
+    val locationSettingsId: Int,
+    val onOkButtonClick: () -> Unit,
+    val onLocationSettingsClick: () -> Unit
+)
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearPermissionUsageViewModel.kt b/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearPermissionUsageViewModel.kt
deleted file mode 100644
index 380c3cfee..000000000
--- a/PermissionController/src/com/android/permissioncontroller/permission/ui/wear/model/WearPermissionUsageViewModel.kt
+++ /dev/null
@@ -1,54 +0,0 @@
-/*
- * Copyright (C) 2024 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.permissioncontroller.permission.ui.wear.model
-
-import androidx.lifecycle.MutableLiveData
-import androidx.lifecycle.ViewModel
-import androidx.lifecycle.ViewModelProvider
-import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsageViewModel
-import com.android.permissioncontroller.permission.ui.viewmodel.v31.PermissionUsagesUiState
-
-class WearPermissionUsageViewModel(
-    permissionUsagesUiState: PermissionUsagesUiState?,
-    showSystemApps: Boolean,
-    show7DaysData: Boolean
-) : ViewModel() {
-    val permissionUsagesUiStateLiveData = MutableLiveData(permissionUsagesUiState)
-    /** A livedata which stores [BasePermissionUsageViewModel.getShowSystemApps()]. */
-    val showSystemAppsLiveData = MutableLiveData(showSystemApps)
-
-    /** A livedata which stores [BasePermissionUsageViewModel.getShow7DaysData()]. */
-    val show7DaysLiveData = MutableLiveData(show7DaysData)
-
-    fun updatePermissionUsagesUiStateLiveData(newUiData: PermissionUsagesUiState?) {
-        permissionUsagesUiStateLiveData.value = newUiData
-    }
-}
-
-/** Factory for a WearPermissionsUsageViewModel */
-class WearPermissionUsageViewModelFactory(val viewModel: PermissionUsageViewModel) :
-    ViewModelProvider.Factory {
-    override fun <T : ViewModel> create(modelClass: Class<T>): T {
-        @Suppress("UNCHECKED_CAST")
-        return WearPermissionUsageViewModel(
-            viewModel.permissionUsagesUiLiveData.value,
-            viewModel.getShowSystemApps(),
-            viewModel.getShow7DaysData()
-        )
-            as T
-    }
-}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/utils/KotlinUtils.kt b/PermissionController/src/com/android/permissioncontroller/permission/utils/KotlinUtils.kt
index b822aa541..fb33aaffc 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/utils/KotlinUtils.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/utils/KotlinUtils.kt
@@ -143,9 +143,6 @@ object KotlinUtils {
     /** Whether to show the location indicators. */
     private const val PROPERTY_LOCATION_INDICATORS_ENABLED = "location_indicators_enabled"
 
-    /** Whether to show 7-day toggle in privacy hub. */
-    private const val PRIVACY_DASHBOARD_7_DAY_TOGGLE = "privacy_dashboard_7_day_toggle"
-
     /** Whether to show the photo picker option in permission prompts. */
     private const val PROPERTY_PHOTO_PICKER_PROMPT_ENABLED = "photo_picker_prompt_enabled"
 
@@ -164,10 +161,6 @@ object KotlinUtils {
     private const val PROPERTY_SAFETY_LABEL_CHANGES_JOB_RUN_WHEN_IDLE =
         "safety_label_changes_job_run_when_idle"
 
-    /** Whether the kill switch is set for [SafetyLabelChangesJobService]. */
-    private const val PROPERTY_SAFETY_LABEL_CHANGES_JOB_SERVICE_KILL_SWITCH =
-        "safety_label_changes_job_service_kill_switch"
-
     data class Quadruple<out A, out B, out C, out D>(
         val first: A,
         val second: B,
@@ -207,21 +200,6 @@ object KotlinUtils {
         return SdkLevel.isAtLeastS()
     }
 
-    /**
-     * Whether we should enable the 7-day toggle in privacy dashboard
-     *
-     * @return whether the flag is enabled
-     */
-    @ChecksSdkIntAtLeast(Build.VERSION_CODES.S)
-    fun is7DayToggleEnabled(): Boolean {
-        return SdkLevel.isAtLeastS() &&
-            DeviceConfig.getBoolean(
-                DeviceConfig.NAMESPACE_PRIVACY,
-                PRIVACY_DASHBOARD_7_DAY_TOGGLE,
-                false
-            )
-    }
-
     /**
      * Whether the Photo Picker Prompt is enabled
      *
@@ -278,20 +256,6 @@ object KotlinUtils {
             !DeviceUtils.isWear(context)
     }
 
-    /**
-     * Whether the kill switch is set for [SafetyLabelChangesJobService]. If {@code true}, the
-     * service is effectively disabled and will not run or schedule any jobs.
-     */
-    @ChecksSdkIntAtLeast(api = Build.VERSION_CODES.UPSIDE_DOWN_CAKE, codename = "UpsideDownCake")
-    fun safetyLabelChangesJobServiceKillSwitch(): Boolean {
-        return SdkLevel.isAtLeastU() &&
-            DeviceConfig.getBoolean(
-                DeviceConfig.NAMESPACE_PRIVACY,
-                PROPERTY_SAFETY_LABEL_CHANGES_JOB_SERVICE_KILL_SWITCH,
-                false
-            )
-    }
-
     /** How often the safety label changes job will run. */
     @ChecksSdkIntAtLeast(api = Build.VERSION_CODES.UPSIDE_DOWN_CAKE, codename = "UpsideDownCake")
     fun getSafetyLabelChangesJobIntervalMillis(): Long {
@@ -302,16 +266,6 @@ object KotlinUtils {
         )
     }
 
-    /** Whether the safety label changes job should only be run when the device is idle. */
-    @ChecksSdkIntAtLeast(api = Build.VERSION_CODES.UPSIDE_DOWN_CAKE, codename = "UpsideDownCake")
-    fun runSafetyLabelChangesJobOnlyWhenDeviceIdle(): Boolean {
-        return DeviceConfig.getBoolean(
-            DeviceConfig.NAMESPACE_PRIVACY,
-            PROPERTY_SAFETY_LABEL_CHANGES_JOB_RUN_WHEN_IDLE,
-            true
-        )
-    }
-
     /**
      * Given a Map, and a List, determines which elements are in the list, but not the map, and vice
      * versa. Used primarily for determining which liveDatas are already being watched, and which
@@ -771,7 +725,7 @@ object KotlinUtils {
                 LightPermission(
                     group.packageInfo,
                     perm.permInfo,
-                    perm.isGrantedIncludingAppOp,
+                    perm.isGranted,
                     perm.flags or flagsToSet,
                     perm.foregroundPerms
                 )
@@ -904,7 +858,7 @@ object KotlinUtils {
                 group.specialLocationGrant
             )
         // If any permission in the group is one time granted, start one time permission session.
-        if (newGroup.permissions.any { it.value.isOneTime && it.value.isGrantedIncludingAppOp }) {
+        if (newGroup.permissions.any { it.value.isOneTime && it.value.isGranted }) {
             if (SdkLevel.isAtLeastT()) {
                 context
                     .getSystemService(PermissionManager::class.java)!!
@@ -966,7 +920,7 @@ object KotlinUtils {
 
         var newFlags = perm.flags
         var oldFlags = perm.flags
-        var isGranted = perm.isGrantedIncludingAppOp
+        var isGranted = perm.isGranted
         var shouldKill = false
 
         // Create a new context with the given deviceId so that permission updates will be bound
@@ -974,7 +928,7 @@ object KotlinUtils {
         val context = ContextCompat.createDeviceContext(app.applicationContext, deviceId)
 
         // Grant the permission if needed.
-        if (!perm.isGrantedIncludingAppOp) {
+        if (!perm.isGranted) {
             val affectsAppOp = permissionToOp(perm.name) != null || perm.isBackgroundPermission
 
             // TODO 195016052: investigate adding split permission handling
@@ -1043,14 +997,14 @@ object KotlinUtils {
 
         // If we newly grant background access to the fine location, double-guess the user some
         // time later if this was really the right choice.
-        if (!perm.isGrantedIncludingAppOp && isGranted) {
+        if (!perm.isGranted && isGranted) {
             var triggerLocationAccessCheck = false
             if (perm.name == ACCESS_FINE_LOCATION) {
                 val bgPerm = group.permissions[perm.backgroundPermission]
-                triggerLocationAccessCheck = bgPerm?.isGrantedIncludingAppOp == true
+                triggerLocationAccessCheck = bgPerm?.isGranted == true
             } else if (perm.name == ACCESS_BACKGROUND_LOCATION) {
                 val fgPerm = group.permissions[ACCESS_FINE_LOCATION]
-                triggerLocationAccessCheck = fgPerm?.isGrantedIncludingAppOp == true
+                triggerLocationAccessCheck = fgPerm?.isGranted == true
             }
             if (triggerLocationAccessCheck) {
                 // trigger location access check
@@ -1289,7 +1243,7 @@ object KotlinUtils {
         val user = UserHandle.getUserHandleForUid(group.packageInfo.uid)
         var newFlags = perm.flags
         val deviceId = group.deviceId
-        var isGranted = perm.isGrantedIncludingAppOp
+        var isGranted = perm.isGranted
         val supportsRuntime = group.packageInfo.targetSdkVersion >= Build.VERSION_CODES.M
         var shouldKill = false
 
@@ -1299,7 +1253,7 @@ object KotlinUtils {
         // to the device
         val context = ContextCompat.createDeviceContext(app.applicationContext, deviceId)
 
-        if (perm.isGrantedIncludingAppOp || (perm.isCompatRevoked && forceRemoveRevokedCompat)) {
+        if (perm.isGranted || (perm.isCompatRevoked && forceRemoveRevokedCompat)) {
             if (
                 supportsRuntime &&
                     !isPermissionSplitFromNonRuntime(
@@ -1363,14 +1317,14 @@ object KotlinUtils {
 
         // If we revoke background access to the fine location, we trigger a check to remove
         // notification warning about background location access
-        if (perm.isGrantedIncludingAppOp && !isGranted) {
+        if (perm.isGranted && !isGranted) {
             var cancelLocationAccessWarning = false
             if (perm.name == ACCESS_FINE_LOCATION) {
                 val bgPerm = group.permissions[perm.backgroundPermission]
-                cancelLocationAccessWarning = bgPerm?.isGrantedIncludingAppOp == true
+                cancelLocationAccessWarning = bgPerm?.isGranted == true
             } else if (perm.name == ACCESS_BACKGROUND_LOCATION) {
                 val fgPerm = group.permissions[ACCESS_FINE_LOCATION]
-                cancelLocationAccessWarning = fgPerm?.isGrantedIncludingAppOp == true
+                cancelLocationAccessWarning = fgPerm?.isGranted == true
             }
             if (cancelLocationAccessWarning) {
                 // cancel location access warning notification
@@ -1430,7 +1384,7 @@ object KotlinUtils {
                 val fgPerm = group.permissions[foregroundPermName]
                 val appOpName = permissionToOp(foregroundPermName) ?: continue
 
-                if (fgPerm != null && fgPerm.isGrantedIncludingAppOp) {
+                if (fgPerm != null && fgPerm.isGranted) {
                     wasChanged =
                         setOpMode(appOpName, uid, packageName, MODE_ALLOWED, appOpsManager) ||
                             wasChanged
@@ -1443,7 +1397,7 @@ object KotlinUtils {
                     if (group.permissions.containsKey(perm.backgroundPermission)) {
                         val bgPerm = group.permissions[perm.backgroundPermission]
                         val mode =
-                            if (bgPerm != null && bgPerm.isGrantedIncludingAppOp) MODE_ALLOWED
+                            if (bgPerm != null && bgPerm.isGranted) MODE_ALLOWED
                             else MODE_FOREGROUND
 
                         setOpMode(appOpName, uid, packageName, mode, appOpsManager)
@@ -1490,7 +1444,7 @@ object KotlinUtils {
         if (perm.isBackgroundPermission && perm.foregroundPerms != null) {
             for (foregroundPermName in perm.foregroundPerms) {
                 val fgPerm = group.permissions[foregroundPermName]
-                if (fgPerm != null && fgPerm.isGrantedIncludingAppOp) {
+                if (fgPerm != null && fgPerm.isGranted) {
                     val appOpName = permissionToOp(foregroundPermName) ?: return false
                     wasChanged =
                         wasChanged ||
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/utils/PermissionMapping.kt b/PermissionController/src/com/android/permissioncontroller/permission/utils/PermissionMapping.kt
index f97acb130..3198a4c09 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/utils/PermissionMapping.kt
+++ b/PermissionController/src/com/android/permissioncontroller/permission/utils/PermissionMapping.kt
@@ -22,6 +22,7 @@ import android.app.AppOpsManager
 import android.content.pm.PackageManager
 import android.content.pm.PermissionInfo
 import android.health.connect.HealthPermissions.HEALTH_PERMISSION_GROUP
+import android.permission.flags.Flags
 import android.util.Log
 import com.android.modules.utils.build.SdkLevel
 import com.android.permission.safetylabel.DataCategoryConstants
@@ -374,6 +375,13 @@ object PermissionMapping {
         if (opName == AppOpsManager.OPSTR_PHONE_CALL_CAMERA) {
             return Manifest.permission_group.CAMERA
         }
+        if (
+            SdkLevel.isAtLeastV() &&
+                Flags.locationBypassPrivacyDashboardEnabled() &&
+                opName == AppOpsManager.OPSTR_EMERGENCY_LOCATION
+        ) {
+            return Manifest.permission_group.LOCATION
+        }
 
         return try {
             AppOpsManager.opToPermission(opName)?.let { getGroupOfPlatformPermission(it) }
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/utils/ResourceUtils.kt b/PermissionController/src/com/android/permissioncontroller/permission/utils/ResourceUtils.kt
new file mode 100644
index 000000000..efe3361b1
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/permission/utils/ResourceUtils.kt
@@ -0,0 +1,26 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.utils
+import android.content.Context
+import android.util.AttributeSet
+import androidx.annotation.AttrRes
+import androidx.core.content.res.use
+
+object ResourceUtils {
+    fun getResourceIdByAttr(context: Context, attrs: AttributeSet?, @AttrRes attr: Int) =
+        context.obtainStyledAttributes(attrs, intArrayOf(attr)).use { it.getResourceId(0, 0) }
+}
diff --git a/PermissionController/src/com/android/permissioncontroller/permission/utils/SafetyNetLogger.java b/PermissionController/src/com/android/permissioncontroller/permission/utils/SafetyNetLogger.java
index 828857cc6..c9b023c44 100644
--- a/PermissionController/src/com/android/permissioncontroller/permission/utils/SafetyNetLogger.java
+++ b/PermissionController/src/com/android/permissioncontroller/permission/utils/SafetyNetLogger.java
@@ -95,7 +95,7 @@ public final class SafetyNetLogger {
             }
 
             builder.append(permission.getName()).append('|');
-            builder.append(permission.isGrantedIncludingAppOp()).append('|');
+            builder.append(permission.isGranted()).append('|');
             builder.append(permission.getFlags());
         }
     }
diff --git a/PermissionController/src/com/android/permissioncontroller/pm/data/model/v31/PackageInfoModel.kt b/PermissionController/src/com/android/permissioncontroller/pm/data/model/v31/PackageInfoModel.kt
index faef36f68..9e667d971 100644
--- a/PermissionController/src/com/android/permissioncontroller/pm/data/model/v31/PackageInfoModel.kt
+++ b/PermissionController/src/com/android/permissioncontroller/pm/data/model/v31/PackageInfoModel.kt
@@ -34,3 +34,12 @@ data class PackageInfoModel(
         requireNotNull(packageInfo.applicationInfo).flags
     )
 }
+
+data class PackageAttributionModel(
+    val packageName: String,
+    val areUserVisible: Boolean = false,
+    /** A map of attribution tag to attribution resource label identifier. */
+    val tagResourceMap: Map<String, Int>? = null,
+    /** A map of attribution resource label identifier to attribution label. */
+    val resourceLabelMap: Map<Int, String>? = null,
+)
diff --git a/PermissionController/src/com/android/permissioncontroller/pm/data/repository/v31/PackageRepository.kt b/PermissionController/src/com/android/permissioncontroller/pm/data/repository/v31/PackageRepository.kt
index 40c714f55..a7e06148a 100644
--- a/PermissionController/src/com/android/permissioncontroller/pm/data/repository/v31/PackageRepository.kt
+++ b/PermissionController/src/com/android/permissioncontroller/pm/data/repository/v31/PackageRepository.kt
@@ -18,9 +18,13 @@ package com.android.permissioncontroller.pm.data.repository.v31
 
 import android.app.Application
 import android.content.pm.PackageManager
+import android.content.res.Resources
+import android.graphics.drawable.Drawable
 import android.os.UserHandle
 import android.util.Log
+import com.android.modules.utils.build.SdkLevel
 import com.android.permissioncontroller.permission.utils.Utils
+import com.android.permissioncontroller.pm.data.model.v31.PackageAttributionModel
 import com.android.permissioncontroller.pm.data.model.v31.PackageInfoModel
 import kotlin.concurrent.Volatile
 import kotlinx.coroutines.CoroutineDispatcher
@@ -32,12 +36,37 @@ import kotlinx.coroutines.withContext
  * shouldn't access [PackageManager] directly, instead they should use the repository.
  */
 interface PackageRepository {
+    /**
+     * Returns a package label for the given [packageName] and [user] Returns [packageName] if the
+     * package is not found.
+     */
+    fun getPackageLabel(packageName: String, user: UserHandle): String
+
+    /**
+     * Returns a package's badged icon for the given [packageName] and [user] Returns null if the
+     * package is not found.
+     */
+    fun getBadgedPackageIcon(packageName: String, user: UserHandle): Drawable?
+
+    /**
+     * Returns a [PackageInfoModel] for the given [packageName] and [user] Returns null if the
+     * package is not found.
+     */
     suspend fun getPackageInfo(
         packageName: String,
         user: UserHandle,
         flags: Int = PackageManager.GET_PERMISSIONS
     ): PackageInfoModel?
 
+    /**
+     * Returns a [PackageAttributionModel] for the given [packageName] and [user] Returns null if
+     * the package is not found.
+     */
+    suspend fun getPackageAttributionInfo(
+        packageName: String,
+        user: UserHandle,
+    ): PackageAttributionModel?
+
     companion object {
         @Volatile private var instance: PackageRepository? = null
 
@@ -50,6 +79,26 @@ class PackageRepositoryImpl(
     private val app: Application,
     private val dispatcher: CoroutineDispatcher = Dispatchers.Default,
 ) : PackageRepository {
+    override fun getPackageLabel(packageName: String, user: UserHandle): String {
+        return try {
+            val userContext = Utils.getUserContext(app, user)
+            val appInfo = userContext.packageManager.getApplicationInfo(packageName, 0)
+            Utils.getFullAppLabel(appInfo, app)
+        } catch (e: PackageManager.NameNotFoundException) {
+            packageName
+        }
+    }
+
+    override fun getBadgedPackageIcon(packageName: String, user: UserHandle): Drawable? {
+        return try {
+            val userContext = Utils.getUserContext(app, user)
+            val appInfo = userContext.packageManager.getApplicationInfo(packageName, 0)
+            Utils.getBadgedIcon(app, appInfo)
+        } catch (e: PackageManager.NameNotFoundException) {
+            null
+        }
+    }
+
     override suspend fun getPackageInfo(
         packageName: String,
         user: UserHandle,
@@ -60,7 +109,7 @@ class PackageRepositoryImpl(
                 val packageInfo =
                     Utils.getUserContext(app, user)
                         .packageManager
-                        .getPackageInfo(packageName, PackageManager.GET_PERMISSIONS)
+                        .getPackageInfo(packageName, flags)
                 PackageInfoModel(packageInfo)
             } catch (e: PackageManager.NameNotFoundException) {
                 Log.w(LOG_TAG, "package $packageName not found for user ${user.identifier}")
@@ -68,6 +117,50 @@ class PackageRepositoryImpl(
             }
         }
 
+    @Suppress("DEPRECATION")
+    override suspend fun getPackageAttributionInfo(
+        packageName: String,
+        user: UserHandle,
+    ): PackageAttributionModel? =
+        withContext(dispatcher) {
+            try {
+                val packageInfo =
+                    Utils.getUserContext(app, user)
+                        .packageManager
+                        .getPackageInfo(packageName, PackageManager.GET_ATTRIBUTIONS)
+                val attributionUserVisible =
+                    packageInfo.applicationInfo?.areAttributionsUserVisible() ?: false
+                if (attributionUserVisible && SdkLevel.isAtLeastS()) {
+                    val pkgContext = app.createPackageContext(packageName, 0)
+                    val attributionTagToLabelRes =
+                        packageInfo.attributions?.associate { it.tag to it.label }
+                    val labelResToLabelStringMap =
+                        attributionTagToLabelRes
+                            ?.mapNotNull { entry ->
+                                val labelString =
+                                    try {
+                                        pkgContext.getString(entry.value)
+                                    } catch (e: Resources.NotFoundException) {
+                                        null
+                                    }
+                                if (labelString != null) entry.value to labelString else null
+                            }
+                            ?.toMap()
+                    PackageAttributionModel(
+                        packageName,
+                        true,
+                        attributionTagToLabelRes,
+                        labelResToLabelStringMap
+                    )
+                } else {
+                    PackageAttributionModel(packageName)
+                }
+            } catch (e: PackageManager.NameNotFoundException) {
+                Log.w(LOG_TAG, "package $packageName not found for user ${user.identifier}")
+                null
+            }
+        }
+
     companion object {
         private const val LOG_TAG = "PackageRepository"
     }
diff --git a/PermissionController/src/com/android/permissioncontroller/pm/data/repository/v31/package-info.java b/PermissionController/src/com/android/permissioncontroller/pm/data/repository/v31/package-info.java
new file mode 100644
index 000000000..5cfb75e31
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/pm/data/repository/v31/package-info.java
@@ -0,0 +1,18 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+@androidx.annotation.RequiresApi(android.os.Build.VERSION_CODES.S)
+package com.android.permissioncontroller.pm.data.repository.v31;
diff --git a/PermissionController/src/com/android/permissioncontroller/privacysources/TEST_MAPPING b/PermissionController/src/com/android/permissioncontroller/privacysources/TEST_MAPPING
index 3e8c5a19c..abf0c4101 100644
--- a/PermissionController/src/com/android/permissioncontroller/privacysources/TEST_MAPPING
+++ b/PermissionController/src/com/android/permissioncontroller/privacysources/TEST_MAPPING
@@ -23,18 +23,7 @@
       ]
     },
     {
-      "name": "CtsPermissionTestCases",
-      "options": [
-        {
-          "include-filter": "android.permission.cts.NotificationListenerCheckTest"
-        },
-        {
-          "include-filter": "android.permission.cts.AccessibilityPrivacySourceTest"
-        },
-        {
-          "exclude-annotation": "androidx.test.filters.FlakyTest"
-        }
-      ]
+      "name": "CtsPermissionTestCases_PrivacySources"
     }
   ],
   "postsubmit": [
diff --git a/PermissionController/src/com/android/permissioncontroller/role/Role.md b/PermissionController/src/com/android/permissioncontroller/role/Role.md
index acdfffb50..d4a514784 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/Role.md
+++ b/PermissionController/src/com/android/permissioncontroller/role/Role.md
@@ -31,8 +31,8 @@ The list of available roles and their behavior can be updated via PermissionCont
 of the platform release cycle. Since Android Q, all the default apps (e.g. default SMS app) are
 backed by a corresponding role implementation.
 
-The definition for all the roles can be found in [roles.xml](../../../../../res/xml/roles.xml) and
-associated [`RoleBehavior`](model/RoleBehavior.java) classes.
+The definition for all the roles can be found in [roles.xml][roles-xml] and
+associated [`RoleBehavior`][role-behavior] [classes][role-behavior-implementations].
 
 ## Defining a role
 
@@ -41,7 +41,7 @@ A role is defined by a `<role>` tag in `roles.xml`.
 The following attributes are available for role:
 
 - `name`: The unique name to identify the role, e.g. `android.app.role.SMS`.
-- `behavior`: Optional name of a [`RoleBehavior`](model/RoleBehavior.java) class to control certain
+- `behavior`: Optional name of a [`RoleBehavior`][role-behavior] class to control certain
 role behavior in Java code, e.g. `SmsRoleBehavior`. This can be useful when the XML syntax cannot
 express certain behavior specific to the role.
 - `defaultHolders`: Optional name of a system config resource that designates the default holders of
@@ -58,6 +58,10 @@ the default app detail page as a footer. This attribute is required if the role
 allowed to be its holder.
 - `fallBackToDefaultHolder`: Whether the role should fall back to the default holder. This attribute
 is optional and defaults to `false`.
+- `featureFlag`: Optional feature flag for the role be available, as the fully qualified name of
+the Java method on the `Flags` class which will be invoked via reflection. Note that any new
+aconfig library dependency will need corresponding jarjar rules for PermissionController and the
+system service JAR.
 - `label`: The string resource for the label of the role, e.g. `@string/role_sms_label`, which says
 "Default SMS app". For default apps, this string will appear in the default app detail page as the
 title. This attribute is required if the role is `visible`.
@@ -190,3 +194,7 @@ cmd role set-bypassing-role-qualification true|false
 
 The command outputs nothing and exits with `0` on success. If there was an error, the error will be
 printed and the command will terminate with a non-zero exit code.
+
+[role-behavior]: ../../../../../role-controller/java/com/android/role/controller/model/RoleBehavior.java
+[role-behavior-implementations]: ../../../../../role-controller/java/com/android/role/controller/behavior/
+[roles-xml]: ../../../../../res/xml/roles.xml
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/DefaultAppChildFragment.java b/PermissionController/src/com/android/permissioncontroller/role/ui/DefaultAppChildFragment.java
index 145031b63..2f515f02c 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/DefaultAppChildFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/DefaultAppChildFragment.java
@@ -17,6 +17,7 @@
 package com.android.permissioncontroller.role.ui;
 
 import android.app.Activity;
+import android.app.role.RoleManager;
 import android.content.Context;
 import android.content.Intent;
 import android.content.pm.ApplicationInfo;
@@ -30,16 +31,19 @@ import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.appcompat.content.res.AppCompatResources;
 import androidx.fragment.app.Fragment;
-import androidx.lifecycle.ViewModelProviders;
+import androidx.lifecycle.ViewModelProvider;
 import androidx.preference.Preference;
 import androidx.preference.PreferenceFragmentCompat;
 import androidx.preference.PreferenceManager;
 import androidx.preference.PreferenceScreen;
 import androidx.preference.TwoStatePreference;
 
+import com.android.modules.utils.build.SdkLevel;
 import com.android.permissioncontroller.R;
 import com.android.permissioncontroller.permission.utils.Utils;
+import com.android.permissioncontroller.role.utils.PackageUtils;
 import com.android.permissioncontroller.role.utils.RoleUiBehaviorUtils;
+import com.android.permissioncontroller.role.utils.SettingsCompat;
 import com.android.role.controller.model.Role;
 import com.android.role.controller.model.Roles;
 
@@ -63,6 +67,8 @@ public class DefaultAppChildFragment<PF extends PreferenceFragmentCompat
             + ".preference.NONE";
     private static final String PREFERENCE_KEY_DESCRIPTION = DefaultAppChildFragment.class.getName()
             + ".preference.DESCRIPTION";
+    private static final String PREFERENCE_KEY_OTHER_NFC_SERVICES =
+            DefaultAppChildFragment.class.getName() + ".preference.OTHER_NFC_SERVICES";
 
     @NonNull
     private String mRoleName;
@@ -112,8 +118,9 @@ public class DefaultAppChildFragment<PF extends PreferenceFragmentCompat
         mRole = Roles.get(activity).get(mRoleName);
         preferenceFragment.setTitle(getString(mRole.getLabelResource()));
 
-        mViewModel = ViewModelProviders.of(this, new DefaultAppViewModel.Factory(mRole, mUser,
-                activity.getApplication())).get(DefaultAppViewModel.class);
+        ViewModelProvider.Factory viewModelFactory = new DefaultAppViewModel.Factory(mRole, mUser,
+                activity.getApplication());
+        mViewModel = new ViewModelProvider(this, viewModelFactory).get(DefaultAppViewModel.class);
         mViewModel.getRoleLiveData().observe(this, this::onRoleChanged);
         mViewModel.getManageRoleHolderStateLiveData().observe(this,
                 this::onManageRoleHolderStateChanged);
@@ -132,11 +139,6 @@ public class DefaultAppChildFragment<PF extends PreferenceFragmentCompat
             preferenceScreen = preferenceManager.createPreferenceScreen(context);
             preferenceFragment.setPreferenceScreen(preferenceScreen);
         } else {
-            oldDescriptionPreference = preferenceScreen.findPreference(PREFERENCE_KEY_DESCRIPTION);
-            if (oldDescriptionPreference != null) {
-                preferenceScreen.removePreference(oldDescriptionPreference);
-                oldDescriptionPreference.setOrder(Preference.DEFAULT_ORDER);
-            }
             for (int i = preferenceScreen.getPreferenceCount() - 1; i >= 0; --i) {
                 Preference preference = preferenceScreen.getPreference(i);
 
@@ -167,13 +169,8 @@ public class DefaultAppChildFragment<PF extends PreferenceFragmentCompat
                     oldPreferences, preferenceScreen, context);
         }
 
-        Preference descriptionPreference = oldDescriptionPreference;
-        if (descriptionPreference == null) {
-            descriptionPreference = preferenceFragment.createFooterPreference();
-            descriptionPreference.setKey(PREFERENCE_KEY_DESCRIPTION);
-            descriptionPreference.setSummary(mRole.getDescriptionResource());
-        }
-        preferenceScreen.addPreference(descriptionPreference);
+        addNonPaymentNfcServicesPreference(preferenceScreen, oldPreferences, context);
+        addDescriptionPreference(preferenceScreen, oldPreferences);
 
         preferenceFragment.onPreferenceScreenChanged();
     }
@@ -264,6 +261,46 @@ public class DefaultAppChildFragment<PF extends PreferenceFragmentCompat
         mViewModel.setDefaultApp(packageName);
     }
 
+    private void addNonPaymentNfcServicesPreference(@NonNull PreferenceScreen preferenceScreen,
+            @NonNull ArrayMap<String, Preference> oldPreferences, @NonNull Context context) {
+        if (!(SdkLevel.isAtLeastV() && Objects.equals(mRoleName, RoleManager.ROLE_WALLET))) {
+            return;
+        }
+
+        Intent intent = new Intent(SettingsCompat.ACTION_MANAGE_OTHER_NFC_SERVICES_SETTINGS);
+        if (!PackageUtils.isIntentResolvedToSettings(intent, context)) {
+            return;
+        }
+
+        Preference preference = oldPreferences.get(PREFERENCE_KEY_OTHER_NFC_SERVICES);
+        if (preference == null) {
+            preference = new Preference(context);
+            preference.setKey(PREFERENCE_KEY_OTHER_NFC_SERVICES);
+            preference.setIcon(AppCompatResources.getDrawable(context, R.drawable.ic_nfc));
+            preference.setTitle(context.getString(
+                    R.string.default_payment_app_other_nfc_services));
+            preference.setPersistent(false);
+            preference.setOnPreferenceClickListener(preference2 -> {
+                context.startActivity(intent);
+                return true;
+            });
+        }
+
+        preferenceScreen.addPreference(preference);
+    }
+
+    private void addDescriptionPreference(@NonNull PreferenceScreen preferenceScreen,
+            @NonNull ArrayMap<String, Preference> oldPreferences) {
+        Preference preference = oldPreferences.get(PREFERENCE_KEY_DESCRIPTION);
+        if (preference == null) {
+            preference = requirePreferenceFragment().createFooterPreference();
+            preference.setKey(PREFERENCE_KEY_DESCRIPTION);
+            preference.setSummary(mRole.getDescriptionResource());
+        }
+
+        preferenceScreen.addPreference(preference);
+    }
+
     @NonNull
     private PF requirePreferenceFragment() {
         //noinspection unchecked
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/DefaultAppListChildFragment.java b/PermissionController/src/com/android/permissioncontroller/role/ui/DefaultAppListChildFragment.java
index 4fbe0ef33..0b96eb8ba 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/DefaultAppListChildFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/DefaultAppListChildFragment.java
@@ -17,11 +17,9 @@
 package com.android.permissioncontroller.role.ui;
 
 import android.app.admin.DevicePolicyResources.Strings.DefaultAppSettings;
-import android.content.ComponentName;
 import android.content.Context;
 import android.content.Intent;
 import android.content.pm.ApplicationInfo;
-import android.content.pm.PackageManager;
 import android.os.Bundle;
 import android.os.UserHandle;
 import android.provider.Settings;
@@ -30,7 +28,7 @@ import android.util.ArrayMap;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.fragment.app.Fragment;
-import androidx.lifecycle.ViewModelProviders;
+import androidx.lifecycle.ViewModelProvider;
 import androidx.preference.Preference;
 import androidx.preference.PreferenceCategory;
 import androidx.preference.PreferenceFragmentCompat;
@@ -40,12 +38,12 @@ import androidx.preference.PreferenceScreen;
 
 import com.android.permissioncontroller.R;
 import com.android.permissioncontroller.permission.utils.Utils;
+import com.android.permissioncontroller.role.utils.PackageUtils;
 import com.android.permissioncontroller.role.utils.RoleUiBehaviorUtils;
 import com.android.role.controller.model.Role;
 import com.android.role.controller.model.Roles;
 
 import java.util.List;
-import java.util.Objects;
 
 /**
  * Child fragment for the list of default apps.
@@ -84,8 +82,7 @@ public class DefaultAppListChildFragment<PF extends PreferenceFragmentCompat
     @Override
     public void onActivityCreated(@Nullable Bundle savedInstanceState) {
         super.onActivityCreated(savedInstanceState);
-
-        mViewModel = ViewModelProviders.of(this).get(DefaultAppListViewModel.class);
+        mViewModel = new ViewModelProvider(this).get(DefaultAppListViewModel.class);
         mViewModel.getLiveData().observe(this, roleItems -> onRoleListChanged());
         if (mViewModel.hasWorkProfile()) {
             mViewModel.getWorkLiveData().observe(this, roleItems -> onRoleListChanged());
@@ -263,7 +260,7 @@ public class DefaultAppListChildFragment<PF extends PreferenceFragmentCompat
     private static void addMoreDefaultAppsPreference(@NonNull PreferenceGroup preferenceGroup,
             @NonNull ArrayMap<String, Preference> oldPreferences, @NonNull Context context) {
         Intent intent = new Intent(Settings.ACTION_MANAGE_MORE_DEFAULT_APPS_SETTINGS);
-        if (!isIntentResolvedToSettings(intent, context)) {
+        if (!PackageUtils.isIntentResolvedToSettings(intent, context)) {
             return;
         }
 
@@ -286,7 +283,7 @@ public class DefaultAppListChildFragment<PF extends PreferenceFragmentCompat
     private static void addManageDomainUrlsPreference(@NonNull PreferenceGroup preferenceGroup,
             @NonNull ArrayMap<String, Preference> oldPreferences, @NonNull Context context) {
         Intent intent = new Intent(Settings.ACTION_MANAGE_DOMAIN_URLS);
-        if (!isIntentResolvedToSettings(intent, context)) {
+        if (!PackageUtils.isIntentResolvedToSettings(intent, context)) {
             return;
         }
 
@@ -306,19 +303,6 @@ public class DefaultAppListChildFragment<PF extends PreferenceFragmentCompat
         preferenceGroup.addPreference(preference);
     }
 
-    private static boolean isIntentResolvedToSettings(@NonNull Intent intent,
-            @NonNull Context context) {
-        PackageManager packageManager = context.getPackageManager();
-        ComponentName componentName = intent.resolveActivity(packageManager);
-        if (componentName == null) {
-            return false;
-        }
-        Intent settingsIntent = new Intent(Settings.ACTION_SETTINGS);
-        String settingsPackageName = settingsIntent.resolveActivity(packageManager)
-                .getPackageName();
-        return Objects.equals(componentName.getPackageName(), settingsPackageName);
-    }
-
     @NonNull
     private PF requirePreferenceFragment() {
         //noinspection unchecked
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/RequestRoleFragment.java b/PermissionController/src/com/android/permissioncontroller/role/ui/RequestRoleFragment.java
index fb3a46d6a..97ed74c01 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/RequestRoleFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/RequestRoleFragment.java
@@ -45,7 +45,7 @@ import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.appcompat.content.res.AppCompatResources;
 import androidx.fragment.app.DialogFragment;
-import androidx.lifecycle.ViewModelProviders;
+import androidx.lifecycle.ViewModelProvider;
 
 import com.android.permissioncontroller.PermissionControllerStatsLog;
 import com.android.permissioncontroller.R;
@@ -230,8 +230,9 @@ public class RequestRoleFragment extends DialogFragment {
         mPackageRemovalMonitor.register();
 
         // Postponed to onStart() so that the list view in dialog is created.
-        mViewModel = ViewModelProviders.of(this, new RequestRoleViewModel.Factory(mRole,
-                requireActivity().getApplication())).get(RequestRoleViewModel.class);
+        ViewModelProvider.Factory viewModelFactory = new RequestRoleViewModel.Factory(mRole,
+                requireActivity().getApplication());
+        mViewModel = new ViewModelProvider(this, viewModelFactory).get(RequestRoleViewModel.class);
         mViewModel.getRoleLiveData().observe(this, this::onRoleDataChanged);
         mViewModel.getManageRoleHolderStateLiveData().observe(this,
                 this::onManageRoleHolderStateChanged);
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/SettingsActivity.java b/PermissionController/src/com/android/permissioncontroller/role/ui/SettingsActivity.java
index ef12b2344..ee5f9a801 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/SettingsActivity.java
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/SettingsActivity.java
@@ -22,6 +22,7 @@ import android.view.WindowManager;
 import androidx.annotation.Nullable;
 
 import com.android.permissioncontroller.DeviceUtils;
+import com.android.settingslib.collapsingtoolbar.EdgeToEdgeUtils;
 import com.android.settingslib.collapsingtoolbar.SettingsTransitionActivity;
 
 /**
@@ -32,6 +33,8 @@ public class SettingsActivity extends SettingsTransitionActivity {
 
     @Override
     protected void onCreate(@Nullable Bundle savedInstanceState) {
+        EdgeToEdgeUtils.enable(this);
+
         super.onCreate(savedInstanceState);
 
         getWindow().addSystemFlags(
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/behavior/v35/WalletRoleUiBehavior.java b/PermissionController/src/com/android/permissioncontroller/role/ui/behavior/v35/WalletRoleUiBehavior.java
index aa6194997..f1754dde9 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/behavior/v35/WalletRoleUiBehavior.java
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/behavior/v35/WalletRoleUiBehavior.java
@@ -16,6 +16,7 @@
 
 package com.android.permissioncontroller.role.ui.behavior.v35;
 
+import android.content.ComponentName;
 import android.content.Context;
 import android.content.Intent;
 import android.content.pm.ApplicationInfo;
@@ -28,6 +29,7 @@ import android.nfc.cardemulation.HostApduService;
 import android.nfc.cardemulation.OffHostApduService;
 import android.os.Build;
 import android.os.UserHandle;
+import android.permission.flags.Flags;
 import android.text.TextUtils;
 import android.util.Log;
 
@@ -82,8 +84,18 @@ public class WalletRoleUiBehavior implements RoleUiBehavior {
             List<ApduServiceInfo> serviceInfos = getNfcServicesForPackage(
                     applicationInfo.packageName, user, context);
 
-            Pair<Drawable, CharSequence> bannerAndLabel =
-                    getNonPaymentServiceBannerAndLabelIfExists(serviceInfos, user, context);
+            Pair<Drawable, CharSequence> bannerAndLabel = null;
+            // If the flag is enabled , attempt to fetch it from property
+            if (Flags.walletRoleIconPropertyEnabled()) {
+                bannerAndLabel =
+                        getBannerAndLabelFromPackageProperty(context, user,
+                                applicationInfo.packageName);
+            }
+            // If it's null, indicating that the property is not set, perform a legacy icon lookup.
+            if (bannerAndLabel == null) {
+                bannerAndLabel =
+                        getNonPaymentServiceBannerAndLabelIfExists(serviceInfos, user, context);
+            }
             if (bannerAndLabel != null) {
                 preference.setIcon(bannerAndLabel.first);
                 if (setTitle) {
@@ -95,6 +107,30 @@ public class WalletRoleUiBehavior implements RoleUiBehavior {
         }
     }
 
+
+    @Nullable
+    private Pair<Drawable, CharSequence> getBannerAndLabelFromPackageProperty(
+            @NonNull Context context, @NonNull UserHandle user, @NonNull String packageName) {
+        List<ApduServiceInfo> apduServiceInfos = getNfcServicesForPackage(packageName,
+                user, context);
+        PackageManager packageManager = context.getPackageManager();
+        int apduServiceInfoSize = apduServiceInfos.size();
+        for (int i = 0; i < apduServiceInfoSize; i++) {
+            ApduServiceInfo serviceInfo = apduServiceInfos.get(i);
+            ComponentName componentName = serviceInfo.getComponent();
+            try {
+                PackageManager.Property iconProperty = packageManager.getProperty(
+                        ApduServiceInfo.PROPERTY_WALLET_PREFERRED_BANNER_AND_LABEL, componentName);
+                if (iconProperty.isBoolean() && iconProperty.getBoolean()) {
+                    return loadBannerAndLabel(serviceInfo, packageManager);
+                }
+            } catch (PackageManager.NameNotFoundException e) {
+                continue;
+            }
+        }
+        return null;
+    }
+
     @NonNull
     private static List<ApduServiceInfo> getNfcServicesForPackage(@NonNull String packageName,
             @NonNull UserHandle user, @NonNull Context context) {
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/specialappaccess/SpecialAppAccessChildFragment.java b/PermissionController/src/com/android/permissioncontroller/role/ui/specialappaccess/SpecialAppAccessChildFragment.java
index 4b397343c..0963635e7 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/specialappaccess/SpecialAppAccessChildFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/specialappaccess/SpecialAppAccessChildFragment.java
@@ -28,7 +28,7 @@ import android.util.Pair;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.fragment.app.Fragment;
-import androidx.lifecycle.ViewModelProviders;
+import androidx.lifecycle.ViewModelProvider;
 import androidx.preference.Preference;
 import androidx.preference.PreferenceFragmentCompat;
 import androidx.preference.PreferenceManager;
@@ -103,8 +103,10 @@ public class SpecialAppAccessChildFragment<PF extends PreferenceFragmentCompat
         mRole = Roles.get(activity).get(mRoleName);
         preferenceFragment.setTitle(getString(mRole.getLabelResource()));
 
-        mViewModel = ViewModelProviders.of(this, new SpecialAppAccessViewModel.Factory(mRole,
-                activity.getApplication())).get(SpecialAppAccessViewModel.class);
+        ViewModelProvider.Factory viewModelFactory = new SpecialAppAccessViewModel.Factory(mRole,
+                activity.getApplication());
+        mViewModel = new ViewModelProvider(this, viewModelFactory)
+                .get(SpecialAppAccessViewModel.class);
         mViewModel.getRoleLiveData().observe(this, this::onRoleChanged);
         mViewModel.observeManageRoleHolderState(this, this::onManageRoleHolderStateChanged);
     }
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/specialappaccess/SpecialAppAccessListChildFragment.java b/PermissionController/src/com/android/permissioncontroller/role/ui/specialappaccess/SpecialAppAccessListChildFragment.java
index cacb4377f..22169abf2 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/specialappaccess/SpecialAppAccessListChildFragment.java
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/specialappaccess/SpecialAppAccessListChildFragment.java
@@ -26,7 +26,7 @@ import android.util.ArrayMap;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.fragment.app.Fragment;
-import androidx.lifecycle.ViewModelProviders;
+import androidx.lifecycle.ViewModelProvider;
 import androidx.preference.Preference;
 import androidx.preference.PreferenceFragmentCompat;
 import androidx.preference.PreferenceManager;
@@ -69,7 +69,7 @@ public class SpecialAppAccessListChildFragment<PF extends PreferenceFragmentComp
     public void onActivityCreated(@Nullable Bundle savedInstanceState) {
         super.onActivityCreated(savedInstanceState);
 
-        mViewModel = ViewModelProviders.of(this).get(SpecialAppAccessListViewModel.class);
+        mViewModel = new ViewModelProvider(this).get(SpecialAppAccessListViewModel.class);
         mViewModel.getLiveData().observe(this, roleItems -> onRoleListChanged());
     }
 
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearDefaultAppHelper.kt b/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearDefaultAppHelper.kt
index 06b4e61be..a47719cf7 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearDefaultAppHelper.kt
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearDefaultAppHelper.kt
@@ -44,7 +44,7 @@ class WearDefaultAppHelper(
         if (role.shouldShowNone()) {
             WearRoleApplicationPreference(
                     context = context,
-                    label = context.getString(R.string.default_app_none),
+                    defaultLabel = context.getString(R.string.default_app_none),
                     checked = !hasHolderApplication(qualifyingApplications),
                     onDefaultCheckChanged = { _ -> viewModel.setNoneDefaultApp() }
                 )
@@ -62,7 +62,7 @@ class WearDefaultAppHelper(
                 val selected = pair.second
                 WearRoleApplicationPreference(
                         context = context,
-                        label = Utils.getFullAppLabel(appInfo, context),
+                        defaultLabel = Utils.getFullAppLabel(appInfo, context),
                         checked = selected,
                         onDefaultCheckChanged = { _ ->
                             run {
@@ -115,6 +115,7 @@ class WearDefaultAppHelper(
         confirmDialogViewModel.confirmDialogArgs = null
         confirmDialogViewModel.showConfirmDialogLiveData.value = false
     }
+
     private fun setDefaultApp(packageName: String) {
         viewModel.setDefaultApp(packageName)
     }
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearDefaultAppScreen.kt b/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearDefaultAppScreen.kt
index a133aa2c3..5d4233c6e 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearDefaultAppScreen.kt
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearDefaultAppScreen.kt
@@ -63,7 +63,7 @@ private fun WearDefaultAppContent(
         helper.getNonePreference(qualifyingApplications)?.let {
             item {
                 ToggleChip(
-                    label = it.label,
+                    label = it.title.toString(),
                     icon = it.icon,
                     checked = it.checked,
                     onCheckedChanged = it.onDefaultCheckChanged,
@@ -75,10 +75,10 @@ private fun WearDefaultAppContent(
         for (pref in helper.getPreferences(qualifyingApplications)) {
             item {
                 ToggleChip(
-                    label = pref.label,
+                    label = pref.title.toString(),
                     icon = pref.icon,
                     colors =
-                        if (pref.isEnabled()) {
+                        if (pref.isEnabled) {
                             ToggleChipDefaults.toggleChipColors()
                         } else {
                             toggleChipDisabledColors()
diff --git a/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearRoleApplicationPreference.kt b/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearRoleApplicationPreference.kt
index abaa33a56..6cd52f576 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearRoleApplicationPreference.kt
+++ b/PermissionController/src/com/android/permissioncontroller/role/ui/wear/WearRoleApplicationPreference.kt
@@ -27,17 +27,21 @@ import com.android.permissioncontroller.role.ui.RoleApplicationPreference
  */
 class WearRoleApplicationPreference(
     context: Context,
-    val label: String,
+    defaultLabel: String,
     val checked: Boolean,
     val onDefaultCheckChanged: (Boolean) -> Unit = {},
     private var restrictionIntent: Intent? = null
 ) : TwoStatePreference(context), RoleApplicationPreference {
+    init {
+        title = defaultLabel
+    }
+
     fun getOnCheckChanged(): (Boolean) -> Unit =
         restrictionIntent?.let { { _ -> context.startActivity(it) } } ?: onDefaultCheckChanged
 
     override fun setRestrictionIntent(restrictionIntent: Intent?) {
         this.restrictionIntent = restrictionIntent
-        setEnabled(restrictionIntent == null)
+        isEnabled = restrictionIntent == null
     }
 
     override fun asTwoStatePreference(): TwoStatePreference = this
diff --git a/PermissionController/src/com/android/permissioncontroller/role/utils/PackageUtils.java b/PermissionController/src/com/android/permissioncontroller/role/utils/PackageUtils.java
index 9aaa07ee0..1bfde0b8b 100644
--- a/PermissionController/src/com/android/permissioncontroller/role/utils/PackageUtils.java
+++ b/PermissionController/src/com/android/permissioncontroller/role/utils/PackageUtils.java
@@ -16,14 +16,19 @@
 
 package com.android.permissioncontroller.role.utils;
 
+import android.content.ComponentName;
 import android.content.Context;
+import android.content.Intent;
 import android.content.pm.ApplicationInfo;
 import android.content.pm.PackageManager;
 import android.os.UserHandle;
+import android.provider.Settings;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 
+import java.util.Objects;
+
 /**
  * Utility methods about application packages.
  */
@@ -66,4 +71,25 @@ public final class PackageUtils {
             @NonNull UserHandle user, @NonNull Context context) {
         return getApplicationInfo(packageName, UserUtils.getUserContext(context, user));
     }
+
+    /**
+     * Check whether an intent is resolved to an activity inside Settings.
+     *
+     * @param intent the intent to check
+     * @param context the {@code Context} to retrieve system services
+     *
+     * @return whether the intent is resolved to an activity inside Settings,
+     */
+    public static boolean isIntentResolvedToSettings(@NonNull Intent intent,
+            @NonNull Context context) {
+        PackageManager packageManager = context.getPackageManager();
+        ComponentName componentName = intent.resolveActivity(packageManager);
+        if (componentName == null) {
+            return false;
+        }
+        Intent settingsIntent = new Intent(Settings.ACTION_SETTINGS);
+        String settingsPackageName = settingsIntent.resolveActivity(packageManager)
+                .getPackageName();
+        return Objects.equals(componentName.getPackageName(), settingsPackageName);
+    }
 }
diff --git a/PermissionController/src/com/android/permissioncontroller/role/utils/SettingsCompat.java b/PermissionController/src/com/android/permissioncontroller/role/utils/SettingsCompat.java
new file mode 100644
index 000000000..b2c7e7a81
--- /dev/null
+++ b/PermissionController/src/com/android/permissioncontroller/role/utils/SettingsCompat.java
@@ -0,0 +1,40 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.role.utils;
+
+import android.annotation.SuppressLint;
+import android.os.Build;
+import android.provider.Settings;
+
+import androidx.annotation.RequiresApi;
+
+/**
+ * Helper for accessing features in {@link Settings}.
+ */
+public class SettingsCompat {
+
+    private SettingsCompat() {}
+
+    /**
+     * @see Settings#ACTION_MANAGE_OTHER_NFC_SERVICES_SETTINGS
+     */
+    @RequiresApi(Build.VERSION_CODES.VANILLA_ICE_CREAM)
+    // The constant is inlined so it's fine to suppress the warning.
+    @SuppressLint("NewApi")
+    public static final String ACTION_MANAGE_OTHER_NFC_SERVICES_SETTINGS =
+            Settings.ACTION_MANAGE_OTHER_NFC_SERVICES_SETTINGS;
+}
diff --git a/PermissionController/tests/inprocess/Android.bp b/PermissionController/tests/inprocess/Android.bp
index 7227e41ad..60b35e80f 100644
--- a/PermissionController/tests/inprocess/Android.bp
+++ b/PermissionController/tests/inprocess/Android.bp
@@ -37,11 +37,12 @@ android_test {
     srcs: ["src/**/*.kt"],
 
     libs: [
-        "android.test.base",
-        "android.test.runner",
+        "android.test.base.stubs.system",
+        "android.test.runner.stubs.system",
     ],
 
     static_libs: [
+        "androidx.arch.core_core-testing",
         "androidx.test.rules",
         "androidx.test.ext.truth",
         "androidx.test.ext.junit",
diff --git a/PermissionController/tests/inprocess/src/com/android/permissioncontroller/permission/ui/model/PermissionUsageDetailsViewModelTest.kt b/PermissionController/tests/inprocess/src/com/android/permissioncontroller/permission/ui/model/PermissionUsageDetailsViewModelTest.kt
new file mode 100644
index 000000000..eb5fdefdb
--- /dev/null
+++ b/PermissionController/tests/inprocess/src/com/android/permissioncontroller/permission/ui/model/PermissionUsageDetailsViewModelTest.kt
@@ -0,0 +1,70 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permission.ui.model
+
+import android.platform.test.annotations.RequiresFlagsEnabled
+import android.platform.test.flag.junit.DeviceFlagsValueProvider
+import androidx.arch.core.executor.testing.InstantTaskExecutorRule
+import androidx.lifecycle.SavedStateHandle
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import com.android.modules.utils.build.SdkLevel
+import com.android.permission.flags.Flags
+import com.android.permissioncontroller.PermissionControllerApplication
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsUiState
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModelV2
+import com.google.common.truth.Truth
+import java.util.concurrent.CountDownLatch
+import java.util.concurrent.TimeUnit
+import org.junit.Assume
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+
+/** This is an integration tests for permission timeline page view model. */
+@RunWith(AndroidJUnit4::class)
+class PermissionUsageDetailsViewModelTest {
+    @JvmField @Rule val checkFlagsRule = DeviceFlagsValueProvider.createCheckFlagsRule()
+
+    @JvmField @Rule val instantTaskExecutorRule = InstantTaskExecutorRule()
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_LIVEDATA_REFACTOR_PERMISSION_TIMELINE_ENABLED)
+    fun verifyUiStateIsGeneratedSuccessfully() {
+        Assume.assumeTrue(SdkLevel.isAtLeastS())
+        lateinit var uiState: PermissionUsageDetailsUiState.Success
+        val viewModel =
+            PermissionUsageDetailsViewModelV2.create(
+                PermissionControllerApplication.get(),
+                SavedStateHandle(mapOf("show7Days" to true, "showSystem" to true)),
+                LOCATION_PERMISSION_GROUP
+            )
+        val countDownLatch = CountDownLatch(1)
+
+        viewModel.getPermissionUsagesDetailsInfoUiLiveData().observeForever {
+            if (it is PermissionUsageDetailsUiState.Success) {
+                uiState = it
+                countDownLatch.countDown()
+            }
+        }
+        countDownLatch.await(5L, TimeUnit.SECONDS)
+        Truth.assertThat(uiState).isNotNull()
+    }
+
+    companion object {
+        private val LOCATION_PERMISSION_GROUP = android.Manifest.permission_group.LOCATION
+    }
+}
diff --git a/PermissionController/tests/mocking/Android.bp b/PermissionController/tests/mocking/Android.bp
index 3d425f5f8..37851b2bb 100644
--- a/PermissionController/tests/mocking/Android.bp
+++ b/PermissionController/tests/mocking/Android.bp
@@ -42,58 +42,14 @@ android_test {
     ],
 
     libs: [
-        "android.test.base",
-        "android.test.runner",
+        "android.test.base.stubs.system",
+        "android.test.runner.stubs.system",
         "safety-center-annotations",
     ],
 
     static_libs: [
         "PermissionController-lib",
-        "iconloader_sc_mainline_prod",
-        "com.google.android.material_material",
-        "androidx.transition_transition",
-        "androidx.compose.foundation_foundation",
-        "androidx.compose.runtime_runtime",
-        "androidx.compose.runtime_runtime-livedata",
-        "androidx.compose.ui_ui",
-        "androidx-constraintlayout_constraintlayout",
-        "androidx.core_core",
-        "androidx.media_media",
-        "androidx.legacy_legacy-support-core-utils",
-        "androidx.legacy_legacy-support-core-ui",
-        "androidx.fragment_fragment",
-        "androidx.appcompat_appcompat",
-        "androidx.preference_preference",
-        "androidx.recyclerview_recyclerview",
-        "androidx.legacy_legacy-preference-v14",
-        "androidx.leanback_leanback",
-        "androidx.leanback_leanback-preference",
         "androidx.lifecycle_lifecycle-extensions",
-        "androidx.lifecycle_lifecycle-common-java8",
-        "androidx.wear.compose_compose-material",
-        "kotlin-stdlib",
-        "kotlinx-coroutines-android",
-        "androidx.navigation_navigation-common-ktx",
-        "androidx.navigation_navigation-fragment-ktx",
-        "androidx.navigation_navigation-runtime-ktx",
-        "androidx.navigation_navigation-ui-ktx",
-        "SettingsLibHelpUtils",
-        "SettingsLibRestrictedLockUtils",
-        "SettingsLibAppPreference",
-        "SettingsLibSearchWidget",
-        "SettingsLibLayoutPreference",
-        "SettingsLibBarChartPreference",
-        "SettingsLibActionBarShadow",
-        "SettingsLibProgressBar",
-        "SettingsLibCollapsingToolbarBaseActivity",
-        "SettingsLibSettingsTheme",
-        "SettingsLibFooterPreference",
-        "SettingsLibSelectorWithWidgetPreference",
-        "SettingsLibTwoTargetPreference",
-        "SettingsLibActivityEmbedding",
-        "SettingsLibIllustrationPreference",
-        "androidx.annotation_annotation",
-        "permissioncontroller-statsd",
         // The PermissionController build file includes android.car-stubs in its libs dependency
         // and that works since the phone code does not initialize any classes with a android.car
         // dependency at runtime. If it did, the class loading would throw an exception. The "libs"
@@ -107,16 +63,6 @@ android_test {
         // mocked, then the stubs dependency would be suitable. Note that on Auto device the boot
         // class path will always override the static dependency.
         "android.car",
-        "car-ui-lib",
-        "libprotobuf-java-lite",
-        "SettingsLibUtils",
-        "modules-utils-build_system",
-        "safety-center-internal-data",
-        "safety-center-pending-intents",
-        "safety-center-resources-lib",
-        "safety-label",
-        "role-controller",
-        "lottie",
         "android.permission.flags-aconfig-java-export",
         "com.android.permission.flags-aconfig-java-export",
         "platform-test-annotations",
@@ -140,4 +86,7 @@ android_test {
     ],
 
     kotlincflags: ["-Xjvm-default=all"],
+
+    // TODO(b/313706381): Remove jarjar once flagging lib is fixed
+    jarjar_rules: ":PermissionController-jarjar-rules",
 }
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/appops/data/repository/FakeAppOpRepository.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/appops/data/repository/FakeAppOpRepository.kt
index 1077293d1..afb779c97 100644
--- a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/appops/data/repository/FakeAppOpRepository.kt
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/appops/data/repository/FakeAppOpRepository.kt
@@ -16,9 +16,21 @@
 
 package com.android.permissioncontroller.tests.mocking.appops.data.repository
 
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel
 import com.android.permissioncontroller.appops.data.model.v31.PackageAppOpUsageModel
 import com.android.permissioncontroller.appops.data.repository.v31.AppOpRepository
+import kotlinx.coroutines.CoroutineScope
 import kotlinx.coroutines.flow.Flow
+import kotlinx.coroutines.flow.flowOf
 
-class FakeAppOpRepository(override val packageAppOpsUsages: Flow<List<PackageAppOpUsageModel>>) :
-    AppOpRepository
+class FakeAppOpRepository(
+    override val packageAppOpsUsages: Flow<List<PackageAppOpUsageModel>>,
+    private val discreteOps: Flow<List<DiscretePackageOpsModel>> = flowOf(),
+) : AppOpRepository {
+    override fun getDiscreteOps(
+        opNames: List<String>,
+        coroutineScope: CoroutineScope
+    ): Flow<List<DiscretePackageOpsModel>> {
+        return discreteOps
+    }
+}
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/hibernation/HibernationPolicyTest.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/hibernation/HibernationPolicyTest.kt
index d85cb40b0..99aa4baa9 100644
--- a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/hibernation/HibernationPolicyTest.kt
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/hibernation/HibernationPolicyTest.kt
@@ -17,14 +17,18 @@
 package com.android.permissioncontroller.tests.mocking.hibernation
 
 import android.app.job.JobScheduler
+import android.content.ContentResolver
 import android.content.Context
 import android.content.Intent
 import android.content.SharedPreferences
+import android.database.ContentObserver
+import android.net.Uri
 import android.os.Build
 import android.os.SystemClock
 import android.os.UserManager
 import android.preference.PreferenceManager
 import android.provider.DeviceConfig
+import android.provider.Settings
 import androidx.test.core.app.ApplicationProvider
 import androidx.test.ext.junit.runners.AndroidJUnit4
 import androidx.test.filters.SdkSuppress
@@ -33,25 +37,30 @@ import com.android.permissioncontroller.Constants
 import com.android.permissioncontroller.PermissionControllerApplication
 import com.android.permissioncontroller.hibernation.HibernationBroadcastReceiver
 import com.android.permissioncontroller.hibernation.ONE_DAY_MS
-import com.android.permissioncontroller.hibernation.PREF_KEY_BOOT_TIME_SNAPSHOT
+import com.android.permissioncontroller.hibernation.PREF_KEY_SYSTEM_TIME_SNAPSHOT
 import com.android.permissioncontroller.hibernation.PREF_KEY_ELAPSED_REALTIME_SNAPSHOT
 import com.android.permissioncontroller.hibernation.PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING
 import com.android.permissioncontroller.hibernation.SNAPSHOT_UNINITIALIZED
 import com.android.permissioncontroller.hibernation.getStartTimeOfUnusedAppTracking
 import com.google.common.truth.Truth.assertThat
-import java.io.File
 import org.junit.After
 import org.junit.Before
 import org.junit.Test
 import org.junit.runner.RunWith
+import org.mockito.ArgumentCaptor
+import org.mockito.ArgumentMatchers.any
+import org.mockito.ArgumentMatchers.anyBoolean
 import org.mockito.ArgumentMatchers.anyInt
 import org.mockito.ArgumentMatchers.anyString
+import org.mockito.ArgumentMatchers.eq
 import org.mockito.Mock
 import org.mockito.Mockito
+import org.mockito.Mockito.verify
 import org.mockito.Mockito.`when`
 import org.mockito.MockitoAnnotations
 import org.mockito.MockitoSession
 import org.mockito.quality.Strictness
+import java.io.File
 
 /** Unit tests for [HibernationPolicy]. */
 @RunWith(AndroidJUnit4::class)
@@ -60,11 +69,14 @@ class HibernationPolicyTest {
 
     companion object {
         private val application = Mockito.mock(PermissionControllerApplication::class.java)
+        private const val USER_SETUP_INCOMPLETE = 0
+        private const val USER_SETUP_COMPLETE = 1
     }
 
     @Mock lateinit var jobScheduler: JobScheduler
     @Mock lateinit var context: Context
     @Mock lateinit var userManager: UserManager
+    @Mock lateinit var contentResolver: ContentResolver
 
     private lateinit var realContext: Context
     private lateinit var receiver: HibernationBroadcastReceiver
@@ -79,9 +91,13 @@ class HibernationPolicyTest {
             ExtendedMockito.mockitoSession()
                 .mockStatic(PermissionControllerApplication::class.java)
                 .mockStatic(DeviceConfig::class.java)
+                .mockStatic(Settings.Secure::class.java)
                 .strictness(Strictness.LENIENT)
                 .startMocking()
         `when`(PermissionControllerApplication.get()).thenReturn(application)
+        `when`(Settings.Secure.getInt(any(), eq(Settings.Secure.USER_SETUP_COMPLETE), anyInt()))
+                .thenReturn(USER_SETUP_COMPLETE)
+        `when`(Settings.Secure.getUriFor(any())).thenReturn(Mockito.mock(Uri::class.java))
 
         realContext = ApplicationProvider.getApplicationContext()
         sharedPreferences =
@@ -93,6 +109,7 @@ class HibernationPolicyTest {
         filesDir = realContext.cacheDir
         `when`(application.filesDir).thenReturn(filesDir)
         `when`(context.getSystemService(JobScheduler::class.java)).thenReturn(jobScheduler)
+        `when`(context.contentResolver).thenReturn(contentResolver)
         `when`(jobScheduler.schedule(Mockito.any())).thenReturn(JobScheduler.RESULT_SUCCESS)
 
         receiver = HibernationBroadcastReceiver()
@@ -101,10 +118,52 @@ class HibernationPolicyTest {
     @After
     fun cleanup() {
         mockitoSession.finishMocking()
+        sharedPreferences.edit().clear().commit()
         val logFile = File(filesDir, Constants.LOGS_TO_DUMP_FILE)
         logFile.delete()
     }
 
+    @Test
+    fun onReceive_userSetupIncomplete_doesNotInitializeStartTime() {
+        `when`(Settings.Secure.getInt(any(), eq(Settings.Secure.USER_SETUP_COMPLETE), anyInt()))
+                .thenReturn(USER_SETUP_INCOMPLETE)
+
+        receiver.onReceive(context, Intent(Intent.ACTION_BOOT_COMPLETED))
+
+        val startTimeOfUnusedAppTracking =
+                sharedPreferences.getLong(
+                        PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING,
+                        SNAPSHOT_UNINITIALIZED
+                )
+        assertThat(startTimeOfUnusedAppTracking).isEqualTo(SNAPSHOT_UNINITIALIZED)
+    }
+
+    @Test
+    fun onReceive_userSetupCompletes_initializesStartTime() {
+        `when`(Settings.Secure.getInt(any(), eq(Settings.Secure.USER_SETUP_COMPLETE), anyInt()))
+                .thenReturn(USER_SETUP_INCOMPLETE)
+
+        receiver.onReceive(context, Intent(Intent.ACTION_BOOT_COMPLETED))
+
+        val contentObserverCaptor = ArgumentCaptor.forClass(ContentObserver::class.java)
+        val uri = Settings.Secure.getUriFor(Settings.Secure.USER_SETUP_COMPLETE)
+        verify(contentResolver).registerContentObserver(
+                eq(uri),
+                anyBoolean(),
+                contentObserverCaptor.capture())
+        val contentObserver = contentObserverCaptor.value
+        `when`(Settings.Secure.getInt(any(), eq(Settings.Secure.USER_SETUP_COMPLETE), anyInt()))
+                .thenReturn(USER_SETUP_COMPLETE)
+        contentObserver.onChange(/* selfChange= */ false, uri)
+
+        val startTimeOfUnusedAppTracking =
+                sharedPreferences.getLong(
+                        PREF_KEY_START_TIME_OF_UNUSED_APP_TRACKING,
+                        SNAPSHOT_UNINITIALIZED
+                )
+        assertThat(startTimeOfUnusedAppTracking).isNotEqualTo(SNAPSHOT_UNINITIALIZED)
+    }
+
     @Test
     fun onReceive_shouldInitializeAndAdjustStartTimeOfUnusedAppTracking() {
         receiver.onReceive(context, Intent(Intent.ACTION_BOOT_COMPLETED))
@@ -114,7 +173,7 @@ class HibernationPolicyTest {
                 SNAPSHOT_UNINITIALIZED
             )
         val systemTimeSnapshot =
-            sharedPreferences.getLong(PREF_KEY_BOOT_TIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
+            sharedPreferences.getLong(PREF_KEY_SYSTEM_TIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
         val realtimeSnapshot =
             sharedPreferences.getLong(PREF_KEY_ELAPSED_REALTIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
         val currentTimeMillis = System.currentTimeMillis()
@@ -139,10 +198,10 @@ class HibernationPolicyTest {
             .isNotEqualTo(SNAPSHOT_UNINITIALIZED)
         receiver.onReceive(context, Intent(Intent.ACTION_BOOT_COMPLETED))
         val systemTimeSnapshot =
-            sharedPreferences.getLong(PREF_KEY_BOOT_TIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
+            sharedPreferences.getLong(PREF_KEY_SYSTEM_TIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
         sharedPreferences
             .edit()
-            .putLong(PREF_KEY_BOOT_TIME_SNAPSHOT, systemTimeSnapshot - ONE_DAY_MS)
+            .putLong(PREF_KEY_SYSTEM_TIME_SNAPSHOT, systemTimeSnapshot - ONE_DAY_MS)
             .apply()
         assertThat(getStartTimeOfUnusedAppTracking(sharedPreferences))
             .isNotEqualTo(systemTimeSnapshot)
@@ -155,7 +214,7 @@ class HibernationPolicyTest {
                 SNAPSHOT_UNINITIALIZED
             )
         val newSystemTimeSnapshot =
-            sharedPreferences.getLong(PREF_KEY_BOOT_TIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
+            sharedPreferences.getLong(PREF_KEY_SYSTEM_TIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
         val newRealtimeSnapshot =
             sharedPreferences.getLong(PREF_KEY_ELAPSED_REALTIME_SNAPSHOT, SNAPSHOT_UNINITIALIZED)
         assertThat(newStartTimeOfUnusedAppTracking).isNotEqualTo(SNAPSHOT_UNINITIALIZED)
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/domain/usecase/GetPermissionGroupUsageDetailsUseCaseTest.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/domain/usecase/GetPermissionGroupUsageDetailsUseCaseTest.kt
new file mode 100644
index 000000000..da2d05f63
--- /dev/null
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/domain/usecase/GetPermissionGroupUsageDetailsUseCaseTest.kt
@@ -0,0 +1,893 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.tests.mocking.permission.domain.usecase
+
+import android.app.AppOpsManager
+import android.content.Context
+import android.content.pm.ApplicationInfo
+import android.content.pm.PackageInfo
+import android.content.pm.PackageManager
+import android.os.UserHandle
+import android.permission.flags.Flags
+import android.platform.test.annotations.RequiresFlagsEnabled
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import com.android.dx.mockito.inline.extended.ExtendedMockito
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.PermissionControllerApplication
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel.DiscreteOpModel
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionTimelineUsageModel
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionTimelineUsageModelWrapper
+import com.android.permissioncontroller.permission.domain.usecase.v31.GetPermissionGroupUsageDetailsUseCase
+import com.android.permissioncontroller.permission.domain.usecase.v31.TELECOM_PACKAGE
+import com.android.permissioncontroller.pm.data.model.v31.PackageAttributionModel
+import com.android.permissioncontroller.pm.data.model.v31.PackageInfoModel
+import com.android.permissioncontroller.pm.data.repository.v31.PackageRepository
+import com.android.permissioncontroller.tests.mocking.appops.data.repository.FakeAppOpRepository
+import com.android.permissioncontroller.tests.mocking.coroutines.collectLastValue
+import com.android.permissioncontroller.tests.mocking.permission.data.repository.FakePermissionRepository
+import com.android.permissioncontroller.tests.mocking.pm.data.repository.FakePackageRepository
+import com.android.permissioncontroller.tests.mocking.role.data.repository.FakeRoleRepository
+import com.android.permissioncontroller.tests.mocking.user.data.repository.FakeUserRepository
+import com.android.permissioncontroller.user.data.repository.v31.UserRepository
+import com.google.common.truth.Truth
+import java.util.concurrent.TimeUnit.HOURS
+import java.util.concurrent.TimeUnit.MINUTES
+import kotlinx.coroutines.CoroutineScope
+import kotlinx.coroutines.flow.Flow
+import kotlinx.coroutines.flow.emptyFlow
+import kotlinx.coroutines.flow.flow
+import kotlinx.coroutines.test.TestScope
+import kotlinx.coroutines.test.runTest
+import org.junit.After
+import org.junit.Assume
+import org.junit.Before
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mockito.Mock
+import org.mockito.Mockito.`when` as whenever
+import org.mockito.MockitoAnnotations
+import org.mockito.MockitoSession
+import org.mockito.quality.Strictness
+
+@RunWith(AndroidJUnit4::class)
+class GetPermissionGroupUsageDetailsUseCaseTest {
+    @Mock private lateinit var application: PermissionControllerApplication
+    @Mock private lateinit var context: Context
+
+    private var mockitoSession: MockitoSession? = null
+    private lateinit var packageInfos: MutableMap<String, PackageInfoModel>
+
+    private val currentUser = android.os.Process.myUserHandle()
+    private val privateProfile = UserHandle.of(10)
+    private val guestUser = UserHandle.of(20)
+
+    private val testPackageName = "test.package"
+    private val guestUserPkgName = "test.package.guest"
+    private val exemptedPkgName = "test.exempted.package"
+    private val systemPackageName = "test.package.system"
+
+    @Before
+    fun setup() {
+        Assume.assumeTrue(SdkLevel.isAtLeastS())
+        MockitoAnnotations.initMocks(this)
+        mockitoSession =
+            ExtendedMockito.mockitoSession()
+                .mockStatic(PermissionControllerApplication::class.java)
+                .strictness(Strictness.LENIENT)
+                .startMocking()
+
+        whenever(PermissionControllerApplication.get()).thenReturn(application)
+        whenever(application.applicationContext).thenReturn(context)
+
+        packageInfos =
+            mapOf(
+                    testPackageName to getPackageInfoModel(testPackageName),
+                    guestUserPkgName to getPackageInfoModel(guestUserPkgName),
+                    exemptedPkgName to getPackageInfoModel(exemptedPkgName),
+                    systemPackageName to
+                        getPackageInfoModel(
+                            systemPackageName,
+                            applicationFlags = ApplicationInfo.FLAG_SYSTEM
+                        ),
+                )
+                .toMutableMap()
+    }
+
+    @After
+    fun finish() {
+        mockitoSession?.finishMocking()
+    }
+
+    @Test
+    fun guestUserUsagesAreFiltered() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_COARSE_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(5), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                    DiscretePackageOpsModel(guestUserPkgName, guestUser.identifier, appOpEvents)
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(2)
+        Truth.assertThat(permissionTimelineUsages.map { it.userId })
+            .doesNotContain(guestUser.identifier)
+    }
+
+    @Test
+    fun quiteProfileAndShowUsageInQuietMode() = runTest {
+        Assume.assumeTrue(SdkLevel.isAtLeastV())
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(5), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                    DiscretePackageOpsModel(
+                        testPackageName,
+                        privateProfile.identifier,
+                        appOpEvents
+                    ),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                userRepository =
+                    FakeUserRepository(
+                        currentUserProfiles =
+                            listOf(currentUser.identifier, privateProfile.identifier),
+                        quietUserProfiles = listOf(privateProfile.identifier),
+                        showInQuiteModeProfiles = listOf(privateProfile.identifier)
+                    )
+            )
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(4)
+        Truth.assertThat(permissionTimelineUsages.map { it.userId }.toSet())
+            .isEqualTo(setOf(currentUser.identifier, privateProfile.identifier))
+    }
+
+    @Test
+    fun quietProfileAndDoNotShowInQuietMode() = runTest {
+        Assume.assumeTrue(SdkLevel.isAtLeastV())
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(5), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                    DiscretePackageOpsModel(
+                        testPackageName,
+                        privateProfile.identifier,
+                        appOpEvents
+                    ),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                userRepository =
+                    FakeUserRepository(
+                        currentUserProfiles =
+                            listOf(currentUser.identifier, privateProfile.identifier),
+                        quietUserProfiles = listOf(privateProfile.identifier),
+                    )
+            )
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(2)
+        Truth.assertThat(permissionTimelineUsages.map { it.userId })
+            .contains(currentUser.identifier)
+        Truth.assertThat(permissionTimelineUsages.map { it.userId })
+            .doesNotContain(privateProfile.identifier)
+    }
+
+    @Test
+    fun exemptedPackageIsFiltered() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(5), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                    DiscretePackageOpsModel(exemptedPkgName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        val actualPackages = permissionTimelineUsages.map { it.packageName }
+        Truth.assertThat(actualPackages).contains(testPackageName)
+        Truth.assertThat(actualPackages).doesNotContain(exemptedPkgName)
+    }
+
+    @Test
+    fun packageNoLongerRequestingPermissionIsFiltered() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(5), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+        // package no more request location permission
+        packageInfos[testPackageName] =
+            getPackageInfoModel(testPackageName, requestedPermissions = listOf(CAMERA_PERMISSION))
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages).isEmpty()
+    }
+
+    @Test
+    fun discreteAccessesAreClustered() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(2), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(3), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        val timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(3))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(3))
+    }
+
+    @Test
+    fun continuousAccessesAreClustered() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(1),
+                    MINUTES.toMillis(1)
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(2),
+                    MINUTES.toMillis(1)
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(3),
+                    MINUTES.toMillis(2)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(CAMERA_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        val timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(4))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(4))
+    }
+
+    @Test
+    fun accessesAreClusteredAcrossHours() = runTest {
+        val hours3 = HOURS.toMillis(3)
+        val hours4 = HOURS.toMillis(4)
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_FINE_LOCATION,
+                    hours3 + MINUTES.toMillis(59),
+                    -1
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_FINE_LOCATION,
+                    hours4 + MINUTES.toMillis(0),
+                    -1
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_FINE_LOCATION,
+                    hours4 + MINUTES.toMillis(1),
+                    -1
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        val timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(hours3 + MINUTES.toMillis(59))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(hours4 + MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(3))
+    }
+
+    @Test
+    fun overlappingDurationAreClustered() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(1),
+                    MINUTES.toMillis(3)
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(3),
+                    MINUTES.toMillis(2)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(CAMERA_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        val timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(4))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(4))
+    }
+
+    @Test
+    fun discreteAccessesAreNotClustered() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(3), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(2)
+        var timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(1))
+
+        timelineModel = permissionTimelineUsages.last()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(3))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(3))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(1))
+    }
+
+    @Test
+    fun continuousAccessesAreNotClustered() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(1),
+                    MINUTES.toMillis(3)
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(5),
+                    MINUTES.toMillis(5)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(CAMERA_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(2)
+        var timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(3))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(3))
+
+        timelineModel = permissionTimelineUsages.last()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(5))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(9))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(5))
+    }
+
+    @Test
+    fun singleDiscreteAccess() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(1), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        val timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(1))
+    }
+
+    @Test
+    fun singleContinuousAccess() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(1),
+                    MINUTES.toMillis(3)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(CAMERA_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        val timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(3))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(3))
+    }
+
+    @Test
+    fun unexpectedContinuousAccess() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(1),
+                    MINUTES.toMillis(2)
+                ),
+                // This entry says the camera was accessed for 15 minutes starting at minute 3
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(3),
+                    MINUTES.toMillis(15)
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(4),
+                    MINUTES.toMillis(1)
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    MINUTES.toMillis(6),
+                    MINUTES.toMillis(1)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(CAMERA_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        val timelineModel = permissionTimelineUsages.first()
+        Truth.assertThat(timelineModel.accessStartMillis).isEqualTo(MINUTES.toMillis(1))
+        Truth.assertThat(timelineModel.accessEndMillis).isEqualTo(MINUTES.toMillis(17))
+        Truth.assertThat(timelineModel.durationMillis).isEqualTo(MINUTES.toMillis(17))
+    }
+
+    @Test
+    fun verifyUserSensitiveFlags() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_COARSE_LOCATION, MINUTES.toMillis(1), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                    DiscretePackageOpsModel(systemPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+        val permissionFlags =
+            mapOf<String, Int>(
+                COARSE_LOCATION_PERMISSION to
+                    PackageManager.FLAG_PERMISSION_USER_SENSITIVE_WHEN_GRANTED
+            )
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                permissionFlags = permissionFlags,
+            )
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(2)
+        val packageModelsMap = permissionTimelineUsages.groupBy { it.packageName }
+        val systemPackageModels = packageModelsMap[systemPackageName]
+        Truth.assertThat(systemPackageModels?.size).isEqualTo(1)
+        Truth.assertThat(systemPackageModels?.first()?.isUserSensitive).isEqualTo(true)
+        val testPackageModels = packageModelsMap[testPackageName]
+        Truth.assertThat(testPackageModels?.size).isEqualTo(1)
+        Truth.assertThat(testPackageModels?.first()?.isUserSensitive).isEqualTo(true)
+    }
+
+    @Test
+    fun verifyNotUserSensitiveFlagsForSystemPackage() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_COARSE_LOCATION, MINUTES.toMillis(1), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(systemPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+        val permissionFlags =
+            mapOf<String, Int>(
+                // 0 represents not user sensitive
+                COARSE_LOCATION_PERMISSION to 0
+            )
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                permissionFlags = permissionFlags,
+            )
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        Truth.assertThat(permissionTimelineUsages.first().isUserSensitive).isEqualTo(false)
+    }
+
+    @Test
+    fun verifyCameraUserSensitiveFlagsForTelecomPackage() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_CAMERA, MINUTES.toMillis(1), -1),
+            )
+        packageInfos[TELECOM_PACKAGE] = getPackageInfoModel(TELECOM_PACKAGE)
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(TELECOM_PACKAGE, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+        val permissionFlags =
+            mapOf<String, Int>(
+                CAMERA_PERMISSION to PackageManager.FLAG_PERMISSION_USER_SENSITIVE_WHEN_GRANTED
+            )
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(
+                CAMERA_PERMISSION_GROUP,
+                discretePackageOps,
+                permissionFlags = permissionFlags,
+            )
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        Truth.assertThat(permissionTimelineUsages.first().packageName).isEqualTo(TELECOM_PACKAGE)
+        Truth.assertThat(permissionTimelineUsages.first().isUserSensitive).isEqualTo(false)
+    }
+
+    @Test
+    fun verifyLocationUserSensitiveFlagsForTelecomPackage() = runTest {
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_COARSE_LOCATION, MINUTES.toMillis(1), -1),
+            )
+        packageInfos[TELECOM_PACKAGE] = getPackageInfoModel(TELECOM_PACKAGE)
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(TELECOM_PACKAGE, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+        val permissionFlags =
+            mapOf<String, Int>(
+                COARSE_LOCATION_PERMISSION to
+                    PackageManager.FLAG_PERMISSION_USER_SENSITIVE_WHEN_GRANTED
+            )
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                permissionFlags = permissionFlags,
+            )
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+        Truth.assertThat(permissionTimelineUsages.first().packageName).isEqualTo(TELECOM_PACKAGE)
+        Truth.assertThat(permissionTimelineUsages.first().isUserSensitive).isEqualTo(true)
+    }
+
+    @Test
+    fun verifyAttributionTagsAreGroupedAndClustered() = runTest {
+        val appOpEvents =
+            listOf(
+                // These 3 entries should be grouped and clustered.
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    MINUTES.toMillis(1),
+                    -1,
+                    "tag1"
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    MINUTES.toMillis(2),
+                    -1,
+                    "tag1"
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    MINUTES.toMillis(3),
+                    -1,
+                    "tag3"
+                ),
+                // The access at minute 4 should not be grouped or clustered.
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    MINUTES.toMillis(4),
+                    -1,
+                    "tag2"
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    MINUTES.toMillis(8),
+                    -1,
+                    "tag2"
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+        val packageAttributions = mutableMapOf<String, PackageAttributionModel>()
+        // tag1 and tag3 refers to same attribution label.
+        val attributionTagToLabelRes = mapOf("tag1" to 100, "tag2" to 200, "tag3" to 100)
+        val attributionsMap = mapOf(100 to "Tag1 Label", 200 to "Tag2 Label")
+        packageAttributions[testPackageName] =
+            PackageAttributionModel(
+                testPackageName,
+                true,
+                attributionTagToLabelRes,
+                attributionsMap
+            )
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                packageRepository = FakePackageRepository(packageInfos, packageAttributions)
+            )
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(3)
+        val labelToTimelineModelsMap = permissionTimelineUsages.groupBy { it.attributionLabel }
+        val tag1LabelModels = labelToTimelineModelsMap["Tag1 Label"]
+        val tag2LabelModels = labelToTimelineModelsMap["Tag2 Label"]
+
+        Truth.assertThat(tag1LabelModels?.size).isEqualTo(1)
+        Truth.assertThat(tag1LabelModels?.first()?.attributionLabel).isEqualTo("Tag1 Label")
+        Truth.assertThat(tag1LabelModels?.first()?.attributionTags).isEqualTo(setOf("tag1", "tag3"))
+
+        Truth.assertThat(tag2LabelModels?.size).isEqualTo(2)
+        Truth.assertThat(tag2LabelModels?.first()?.attributionLabel).isEqualTo("Tag2 Label")
+        Truth.assertThat(tag2LabelModels?.first()?.attributionTags).isEqualTo(setOf("tag2"))
+        Truth.assertThat(tag2LabelModels?.last()?.attributionLabel).isEqualTo("Tag2 Label")
+        Truth.assertThat(tag2LabelModels?.last()?.attributionTags).isEqualTo(setOf("tag2"))
+    }
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_LOCATION_BYPASS_PRIVACY_DASHBOARD_ENABLED)
+    fun emergencyAccessesAreNotClusteredWithRegularAccesses() = runTest {
+        Assume.assumeTrue(SdkLevel.isAtLeastV())
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_EMERGENCY_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_FINE_LOCATION, MINUTES.toMillis(2), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(2)
+    }
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_LOCATION_BYPASS_PRIVACY_DASHBOARD_ENABLED)
+    fun emergencyAccessesAreClustered() = runTest {
+        Assume.assumeTrue(SdkLevel.isAtLeastV())
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_EMERGENCY_LOCATION, MINUTES.toMillis(1), -1),
+                DiscreteOpModel(AppOpsManager.OPSTR_EMERGENCY_LOCATION, MINUTES.toMillis(2), -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getPermissionGroupUsageDetailsUseCase(LOCATION_PERMISSION_GROUP, discretePackageOps)
+        val permissionTimelineUsages = getResult(underTest, this)
+
+        Truth.assertThat(permissionTimelineUsages.size).isEqualTo(1)
+    }
+
+    private fun TestScope.getResult(
+        useCase: GetPermissionGroupUsageDetailsUseCase,
+        coroutineScope: CoroutineScope
+    ): List<PermissionTimelineUsageModel> {
+        val usages by collectLastValue(useCase(coroutineScope))
+        return (usages as PermissionTimelineUsageModelWrapper.Success).timelineUsageModels
+    }
+
+    private fun getPermissionGroupUsageDetailsUseCase(
+        permissionGroup: String,
+        discreteUsageFlow: Flow<List<DiscretePackageOpsModel>>,
+        permissionFlags: Map<String, Int> = emptyMap(),
+        userRepository: UserRepository = FakeUserRepository(listOf(currentUser.identifier)),
+        packageRepository: PackageRepository = FakePackageRepository(packageInfos)
+    ): GetPermissionGroupUsageDetailsUseCase {
+        val permissionRepository = FakePermissionRepository(permissionFlags)
+        val appOpUsageRepository = FakeAppOpRepository(emptyFlow(), discreteUsageFlow)
+        val roleRepository = FakeRoleRepository(setOf(exemptedPkgName))
+        return GetPermissionGroupUsageDetailsUseCase(
+            permissionGroup,
+            packageRepository,
+            permissionRepository,
+            appOpUsageRepository,
+            roleRepository,
+            userRepository
+        )
+    }
+
+    private fun getPackageInfoModel(
+        packageName: String,
+        requestedPermissions: List<String> =
+            listOf(COARSE_LOCATION_PERMISSION, FINE_LOCATION_PERMISSION, CAMERA_PERMISSION),
+        permissionsFlags: List<Int> =
+            listOf(
+                PackageInfo.REQUESTED_PERMISSION_GRANTED,
+                PackageInfo.REQUESTED_PERMISSION_GRANTED,
+                PackageInfo.REQUESTED_PERMISSION_GRANTED
+            ),
+        applicationFlags: Int = 0,
+    ) = PackageInfoModel(packageName, requestedPermissions, permissionsFlags, applicationFlags)
+
+    companion object {
+        private val FINE_LOCATION_PERMISSION = android.Manifest.permission.ACCESS_FINE_LOCATION
+        private val COARSE_LOCATION_PERMISSION = android.Manifest.permission.ACCESS_COARSE_LOCATION
+        private val CAMERA_PERMISSION = android.Manifest.permission.CAMERA
+
+        private val LOCATION_PERMISSION_GROUP = android.Manifest.permission_group.LOCATION
+        private val CAMERA_PERMISSION_GROUP = android.Manifest.permission_group.CAMERA
+    }
+}
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/domain/usecase/GetPermissionUsageUseCaseTest.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/domain/usecase/GetPermissionUsageUseCaseTest.kt
index d205989d6..aa748b992 100644
--- a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/domain/usecase/GetPermissionUsageUseCaseTest.kt
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/domain/usecase/GetPermissionUsageUseCaseTest.kt
@@ -29,6 +29,7 @@ import com.android.permissioncontroller.PermissionControllerApplication
 import com.android.permissioncontroller.appops.data.model.v31.PackageAppOpUsageModel
 import com.android.permissioncontroller.appops.data.model.v31.PackageAppOpUsageModel.AppOpUsageModel
 import com.android.permissioncontroller.permission.domain.model.v31.PermissionGroupUsageModel
+import com.android.permissioncontroller.permission.domain.model.v31.PermissionGroupUsageModelWrapper
 import com.android.permissioncontroller.permission.domain.usecase.v31.GetPermissionGroupUsageUseCase
 import com.android.permissioncontroller.permission.utils.Utils
 import com.android.permissioncontroller.pm.data.model.v31.PackageInfoModel
@@ -43,6 +44,7 @@ import com.android.permissioncontroller.user.data.repository.v31.UserRepository
 import com.google.common.truth.Truth.assertThat
 import kotlinx.coroutines.flow.Flow
 import kotlinx.coroutines.flow.flow
+import kotlinx.coroutines.test.TestScope
 import kotlinx.coroutines.test.runTest
 import org.junit.After
 import org.junit.Assume
@@ -119,7 +121,7 @@ class GetPermissionUsageUseCaseTest {
         }
         val underTest = getPermissionGroupUsageUseCase(appOpsUsageModelFlow)
 
-        val permissionGroupUsages by collectLastValue(underTest())
+        val permissionGroupUsages = getResult(underTest)
         assertThat(permissionGroupUsages)
             .isEqualTo(listOf(PermissionGroupUsageModel(CAMERA_PERMISSION_GROUP, 100, true)))
     }
@@ -149,7 +151,7 @@ class GetPermissionUsageUseCaseTest {
         val underTest =
             getPermissionGroupUsageUseCase(appOpsUsageModelFlow, userRepo = userRepository)
 
-        val permissionGroupUsages by collectLastValue(underTest())
+        val permissionGroupUsages = getResult(underTest)
         assertThat(permissionGroupUsages)
             .isEqualTo(
                 listOf(
@@ -181,7 +183,7 @@ class GetPermissionUsageUseCaseTest {
             )
         val underTest =
             getPermissionGroupUsageUseCase(appOpsUsageModelFlow, userRepo = userRepository)
-        val permissionGroupUsages by collectLastValue(underTest())
+        val permissionGroupUsages = getResult(underTest)
         assertThat(permissionGroupUsages).isEmpty()
     }
 
@@ -209,7 +211,7 @@ class GetPermissionUsageUseCaseTest {
         }
         val underTest = getPermissionGroupUsageUseCase(appOpsUsageModelFlow)
 
-        val permissionGroupUsages by collectLastValue(underTest())
+        val permissionGroupUsages = getResult(underTest)
         assertThat(permissionGroupUsages)
             .isEqualTo(listOf(PermissionGroupUsageModel(CAMERA_PERMISSION_GROUP, 100, true)))
     }
@@ -235,7 +237,7 @@ class GetPermissionUsageUseCaseTest {
             )
         val underTest = getPermissionGroupUsageUseCase(appOpsUsageModelFlow)
 
-        val permissionGroupUsages by collectLastValue(underTest())
+        val permissionGroupUsages = getResult(underTest)
         assertThat(permissionGroupUsages)
             .isEqualTo(listOf(PermissionGroupUsageModel(MICROPHONE_PERMISSION_GROUP, 100, true)))
     }
@@ -258,7 +260,7 @@ class GetPermissionUsageUseCaseTest {
         }
         val underTest = getPermissionGroupUsageUseCase(appOpsUsageModelFlow)
 
-        val permissionGroupUsages by collectLastValue(underTest())
+        val permissionGroupUsages = getResult(underTest)
         assertThat(permissionGroupUsages)
             .isEqualTo(
                 listOf(
@@ -285,7 +287,7 @@ class GetPermissionUsageUseCaseTest {
         // test package is not a system package
         val underTest = getPermissionGroupUsageUseCase(appOpsUsageModelFlow)
 
-        val permissionGroupUsages by collectLastValue(underTest())
+        val permissionGroupUsages = getResult(underTest)
         assertThat(permissionGroupUsages)
             .isEqualTo(
                 listOf(
@@ -328,7 +330,7 @@ class GetPermissionUsageUseCaseTest {
         val underTest =
             getPermissionGroupUsageUseCase(appOpsUsageModelFlow, permissionFlags = permissionFlags)
 
-        val permissionGroupUsages by collectLastValue(underTest())
+        val permissionGroupUsages = getResult(underTest)
         assertThat(permissionGroupUsages)
             .isEqualTo(
                 listOf(
@@ -338,6 +340,13 @@ class GetPermissionUsageUseCaseTest {
             )
     }
 
+    private fun TestScope.getResult(
+        useCase: GetPermissionGroupUsageUseCase
+    ): List<PermissionGroupUsageModel> {
+        val result by collectLastValue(useCase())
+        return (result as PermissionGroupUsageModelWrapper.Success).permissionUsageModels
+    }
+
     private fun getPackageInfoModel(
         packageName: String,
         requestedPermissions: List<String> = listOf(CAMERA_PERMISSION, RECORD_AUDIO_PERMISSION),
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/PermissionUsageDetailsViewModelTest.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/PermissionUsageDetailsViewModelTest.kt
new file mode 100644
index 000000000..31e81e588
--- /dev/null
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/PermissionUsageDetailsViewModelTest.kt
@@ -0,0 +1,554 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.tests.mocking.permission.ui.model
+
+import android.app.AppOpsManager
+import android.content.Context
+import android.content.pm.ApplicationInfo
+import android.content.pm.PackageInfo
+import android.permission.flags.Flags
+import androidx.lifecycle.SavedStateHandle
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import com.android.dx.mockito.inline.extended.ExtendedMockito
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.DeviceUtils
+import com.android.permissioncontroller.PermissionControllerApplication
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel
+import com.android.permissioncontroller.appops.data.model.v31.DiscretePackageOpsModel.DiscreteOpModel
+import com.android.permissioncontroller.permission.domain.usecase.v31.GetPermissionGroupUsageDetailsUseCase
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModel.PermissionUsageDetailsUiState
+import com.android.permissioncontroller.permission.ui.model.v31.PermissionUsageDetailsViewModelV2
+import com.android.permissioncontroller.permission.utils.StringUtils
+import com.android.permissioncontroller.permission.utils.Utils
+import com.android.permissioncontroller.pm.data.model.v31.PackageInfoModel
+import com.android.permissioncontroller.pm.data.repository.v31.PackageRepository
+import com.android.permissioncontroller.tests.mocking.appops.data.repository.FakeAppOpRepository
+import com.android.permissioncontroller.tests.mocking.coroutines.collectLastValue
+import com.android.permissioncontroller.tests.mocking.permission.data.repository.FakePermissionRepository
+import com.android.permissioncontroller.tests.mocking.pm.data.repository.FakePackageRepository
+import com.android.permissioncontroller.tests.mocking.role.data.repository.FakeRoleRepository
+import com.android.permissioncontroller.tests.mocking.user.data.repository.FakeUserRepository
+import com.google.common.truth.Truth.assertThat
+import java.util.concurrent.TimeUnit
+import kotlinx.coroutines.flow.Flow
+import kotlinx.coroutines.flow.MutableStateFlow
+import kotlinx.coroutines.flow.emptyFlow
+import kotlinx.coroutines.flow.flow
+import kotlinx.coroutines.test.StandardTestDispatcher
+import kotlinx.coroutines.test.TestScope
+import kotlinx.coroutines.test.runTest
+import org.junit.After
+import org.junit.Assume
+import org.junit.Before
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mockito.Mock
+import org.mockito.Mockito.any
+import org.mockito.Mockito.anyInt
+import org.mockito.Mockito.`when` as whenever
+import org.mockito.MockitoAnnotations
+import org.mockito.MockitoSession
+import org.mockito.quality.Strictness
+
+/**
+ * These unit tests are for new permission timeline implementation, the new view model class is
+ * [PermissionUsageDetailsViewModelV2]
+ */
+@RunWith(AndroidJUnit4::class)
+class PermissionUsageDetailsViewModelTest {
+    @Mock private lateinit var application: PermissionControllerApplication
+    @Mock private lateinit var context: Context
+    private var mockitoSession: MockitoSession? = null
+
+    private lateinit var packageRepository: PackageRepository
+
+    private val currentUser = android.os.Process.myUserHandle()
+    private val testPackageName = "test.package"
+    private val testPackageLabel = "Test Package Label"
+    private val systemPackageName = "test.package.system"
+    private lateinit var packageInfos: MutableMap<String, PackageInfoModel>
+
+    @Before
+    fun setup() {
+        Assume.assumeTrue(SdkLevel.isAtLeastS())
+        MockitoAnnotations.initMocks(this)
+        mockitoSession =
+            ExtendedMockito.mockitoSession()
+                .mockStatic(PermissionControllerApplication::class.java)
+                .mockStatic(Utils::class.java)
+                .mockStatic(DeviceUtils::class.java)
+                .mockStatic(StringUtils::class.java)
+                .mockStatic(Flags::class.java)
+                .strictness(Strictness.LENIENT)
+                .startMocking()
+
+        whenever(PermissionControllerApplication.get()).thenReturn(application)
+        whenever(application.applicationContext).thenReturn(context)
+        whenever(Utils.getUserContext(application, currentUser)).thenReturn(context)
+        whenever(DeviceUtils.isHandheld()).thenReturn(true)
+        whenever(
+                StringUtils.getIcuPluralsString(
+                    any(),
+                    anyInt(),
+                    anyInt(),
+                    any(Array<String>::class.java)
+                )
+            )
+            .thenReturn("Duration Summary")
+
+        packageInfos =
+            mapOf(
+                    testPackageName to getPackageInfoModel(testPackageName),
+                    systemPackageName to
+                        getPackageInfoModel(
+                            systemPackageName,
+                            applicationFlags = ApplicationInfo.FLAG_SYSTEM
+                        ),
+                )
+                .toMutableMap()
+
+        packageRepository =
+            FakePackageRepository(
+                packageInfos,
+                packagesAndLabels = mapOf(testPackageName to testPackageLabel)
+            )
+    }
+
+    @After
+    fun finish() {
+        mockitoSession?.finishMocking()
+    }
+
+    @Test
+    fun verifyOnlyNonSystemAppsAreShown() = runTest {
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_COARSE_LOCATION, accessTimeMillis, -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                    DiscretePackageOpsModel(systemPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getViewModel(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                savedStateMap = mapOf("show7Days" to false, "showSystem" to false),
+            )
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+
+        assertThat(uiState.containsSystemAppUsage).isEqualTo(true)
+        assertThat(uiState.appPermissionAccessUiInfoList.size).isEqualTo(1)
+        assertThat(uiState.appPermissionAccessUiInfoList.first().packageName)
+            .isEqualTo(testPackageName)
+        assertThat(uiState.appPermissionAccessUiInfoList.first().packageLabel)
+            .isEqualTo(testPackageLabel)
+    }
+
+    @Test
+    fun verifySystemAppsAreShown() = runTest {
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    accessTimeMillis,
+                    TimeUnit.MINUTES.toMillis(1)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                    DiscretePackageOpsModel(systemPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getViewModel(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                savedStateMap = mapOf("show7Days" to false, "showSystem" to true)
+            )
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+
+        assertThat(uiState.containsSystemAppUsage).isEqualTo(true)
+        assertThat(uiState.appPermissionAccessUiInfoList.size).isEqualTo(2)
+        assertThat(uiState.appPermissionAccessUiInfoList.map { it.packageName }.toSet())
+            .isEqualTo(setOf(testPackageName, systemPackageName))
+    }
+
+    @Test
+    fun verifyNoSystemAppsAvailable() = runTest {
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    accessTimeMillis,
+                    TimeUnit.MINUTES.toMillis(1)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getViewModel(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                savedStateMap = mapOf("show7Days" to false, "showSystem" to false)
+            )
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+
+        assertThat(uiState.containsSystemAppUsage).isEqualTo(false)
+    }
+
+    @Test
+    fun verifyNoSystemAppsAvailableInLast24Hours() = runTest {
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.DAYS.toMillis(2))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    accessTimeMillis,
+                    TimeUnit.MINUTES.toMillis(1)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(systemPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getViewModel(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+                savedStateMap = mapOf("show7Days" to false, "showSystem" to false)
+            )
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+
+        assertThat(uiState.containsSystemAppUsage).isEqualTo(false)
+    }
+
+    @Test
+    fun verify24HoursDataIsShown() = runTest {
+        val accessStartWithIn24Hours = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val accessStartBefore24Hours = (getCurrentTime() - TimeUnit.HOURS.toMillis(30))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    accessStartWithIn24Hours,
+                    TimeUnit.MINUTES.toMillis(5)
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    accessStartBefore24Hours,
+                    TimeUnit.MINUTES.toMillis(7)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest = getViewModel(CAMERA_PERMISSION_GROUP, discretePackageOps)
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+
+        assertThat(uiState.appPermissionAccessUiInfoList.size).isEqualTo(1)
+        val timelineRow = uiState.appPermissionAccessUiInfoList.first()
+        assertThat(timelineRow.accessStartTime).isEqualTo(accessStartWithIn24Hours)
+    }
+
+    @Test
+    fun verify7DaysDataIsShown() = runTest {
+        val accessTimeWithIn24Hours = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val accessTimeBefore24Hours = (getCurrentTime() - TimeUnit.DAYS.toMillis(3))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    accessTimeWithIn24Hours,
+                    TimeUnit.MINUTES.toMillis(5)
+                ),
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    accessTimeBefore24Hours,
+                    TimeUnit.MINUTES.toMillis(7)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getViewModel(
+                CAMERA_PERMISSION_GROUP,
+                discretePackageOps,
+                savedStateMap = mapOf("show7Days" to true, "showSystem" to false),
+            )
+
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+        assertThat(uiState.appPermissionAccessUiInfoList.size).isEqualTo(2)
+        // assert rows are sorted by access timestamps i.e. most recent entry first
+        assertThat(uiState.appPermissionAccessUiInfoList.map { it.accessStartTime })
+            .isInOrder(Comparator.reverseOrder<Long>())
+        val lastRow = uiState.appPermissionAccessUiInfoList.last()
+        assertThat(lastRow.accessStartTime).isEqualTo(accessTimeBefore24Hours)
+    }
+
+    @Test
+    fun verifyDurationLabelIsShown() = runTest {
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    accessTimeMillis,
+                    TimeUnit.MINUTES.toMillis(5)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest = getViewModel(CAMERA_PERMISSION_GROUP, discretePackageOps)
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+
+        assertThat(uiState.appPermissionAccessUiInfoList.size).isEqualTo(1)
+        val timelineRow = uiState.appPermissionAccessUiInfoList.first()
+        assertThat(timelineRow.summaryText).isEqualTo("Duration Summary")
+    }
+
+    @Test
+    fun verifyDurationLabelIsNotShown() = runTest {
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_CAMERA,
+                    accessTimeMillis,
+                    TimeUnit.MINUTES.toMillis(1)
+                ),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest = getViewModel(CAMERA_PERMISSION_GROUP, discretePackageOps)
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+
+        assertThat(uiState.appPermissionAccessUiInfoList.size).isEqualTo(1)
+        val timelineRow = uiState.appPermissionAccessUiInfoList.first()
+        assertThat(timelineRow.summaryText).isNull()
+    }
+
+    @Test
+    fun verifyEmergencyLocationAccessWithAttribution() = runTest {
+        Assume.assumeTrue(SdkLevel.isAtLeastV())
+        whenever(Flags.locationBypassPrivacyDashboardEnabled()).thenReturn(true)
+        whenever(application.getString(anyInt())).thenReturn("emergency attr label")
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(AppOpsManager.OPSTR_EMERGENCY_LOCATION, accessTimeMillis, -1),
+            )
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+
+        val underTest =
+            getViewModel(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+            )
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+        assertThat(uiState.appPermissionAccessUiInfoList.size).isEqualTo(1)
+        val timelineRow = uiState.appPermissionAccessUiInfoList.first()
+        assertThat(timelineRow.isEmergencyLocationAccess).isTrue()
+        assertThat(timelineRow.showingAttribution).isTrue()
+        assertThat(timelineRow.summaryText).isEqualTo("emergency attr label")
+    }
+
+    @Test
+    fun verifyNewEmittedEventsAreCollected() = runTest {
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.HOURS.toMillis(5))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    accessTimeMillis,
+                    TimeUnit.MINUTES.toMillis(1)
+                ),
+            )
+        val actualData =
+            listOf(
+                DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+            )
+        val discretePackageOps = MutableStateFlow(emptyList<DiscretePackageOpsModel>())
+        discretePackageOps.emit(emptyList())
+
+        val underTest =
+            getViewModel(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+            )
+        val result by collectLastValue(underTest.permissionUsageDetailsUiStateFlow)
+        var uiState = result as PermissionUsageDetailsUiState.Success
+        assertThat(uiState.appPermissionAccessUiInfoList).isEmpty()
+
+        // verify that the emitted value is collected
+        discretePackageOps.emit(actualData)
+        val updatedResult by collectLastValue(underTest.permissionUsageDetailsUiStateFlow)
+        uiState = updatedResult as PermissionUsageDetailsUiState.Success
+        assertThat(uiState.appPermissionAccessUiInfoList.size).isEqualTo(1)
+    }
+
+    @Test
+    fun verifyObserverIsNotifiedOnUserActionWhenDataIsSame() = runTest {
+        val accessTimeMillis = (getCurrentTime() - TimeUnit.HOURS.toMillis(2))
+        val appOpEvents =
+            listOf(
+                DiscreteOpModel(
+                    AppOpsManager.OPSTR_COARSE_LOCATION,
+                    accessTimeMillis,
+                    TimeUnit.MINUTES.toMillis(1)
+                ),
+            )
+
+        val discretePackageOps = flow {
+            emit(
+                listOf(
+                    DiscretePackageOpsModel(testPackageName, currentUser.identifier, appOpEvents),
+                )
+            )
+        }
+        val underTest =
+            getViewModel(
+                LOCATION_PERMISSION_GROUP,
+                discretePackageOps,
+            )
+
+        val uiState = getPermissionUsageDetailsUiState(underTest)
+        assertThat(uiState.show7Days).isFalse()
+
+        // perform user action
+        underTest.updateShow7DaysToggle(true)
+        val uiState2 = getPermissionUsageDetailsUiState(underTest)
+        assertThat(uiState2.show7Days).isTrue()
+    }
+
+    private fun getPermissionGroupUsageDetailsUseCase(
+        permissionGroup: String,
+        discreteUsageFlow: Flow<List<DiscretePackageOpsModel>>,
+    ): GetPermissionGroupUsageDetailsUseCase {
+        val userRepository = FakeUserRepository(listOf(currentUser.identifier))
+        val permissionRepository = FakePermissionRepository()
+        val appOpUsageRepository = FakeAppOpRepository(emptyFlow(), discreteUsageFlow)
+        val roleRepository = FakeRoleRepository()
+        return GetPermissionGroupUsageDetailsUseCase(
+            permissionGroup,
+            packageRepository,
+            permissionRepository,
+            appOpUsageRepository,
+            roleRepository,
+            userRepository
+        )
+    }
+
+    /** Get current time rounded at minute level. */
+    private fun getCurrentTime(): Long {
+        return System.currentTimeMillis() / ONE_MINUTE_MILLIS * ONE_MINUTE_MILLIS
+    }
+
+    private fun TestScope.getViewModel(
+        permissionGroup: String,
+        discretePackageOps: Flow<List<DiscretePackageOpsModel>>,
+        savedStateMap: Map<String, Boolean> = mapOf("show7Days" to false, "showSystem" to false),
+        pkgRepository: PackageRepository = packageRepository
+    ) =
+        PermissionUsageDetailsViewModelV2(
+            application,
+            getPermissionGroupUsageDetailsUseCase(permissionGroup, discretePackageOps),
+            SavedStateHandle(savedStateMap),
+            permissionGroup,
+            scope = backgroundScope,
+            StandardTestDispatcher(testScheduler),
+            packageRepository = pkgRepository
+        )
+
+    private fun TestScope.getPermissionUsageDetailsUiState(
+        viewModel: PermissionUsageDetailsViewModelV2
+    ): PermissionUsageDetailsUiState.Success {
+        val result by collectLastValue(viewModel.permissionUsageDetailsUiStateFlow)
+        return result as PermissionUsageDetailsUiState.Success
+    }
+
+    private fun getPackageInfoModel(
+        packageName: String,
+        requestedPermissions: List<String> = listOf(CAMERA_PERMISSION, COARSE_LOCATION_PERMISSION),
+        permissionsFlags: List<Int> =
+            listOf(
+                PackageInfo.REQUESTED_PERMISSION_GRANTED,
+                PackageInfo.REQUESTED_PERMISSION_GRANTED
+            ),
+        applicationFlags: Int = 0,
+    ) = PackageInfoModel(packageName, requestedPermissions, permissionsFlags, applicationFlags)
+
+    companion object {
+        private const val ONE_MINUTE_MILLIS = 60_000
+        private val COARSE_LOCATION_PERMISSION = android.Manifest.permission.ACCESS_COARSE_LOCATION
+        private val CAMERA_PERMISSION = android.Manifest.permission.CAMERA
+
+        private val LOCATION_PERMISSION_GROUP = android.Manifest.permission_group.LOCATION
+        private val CAMERA_PERMISSION_GROUP = android.Manifest.permission_group.CAMERA
+    }
+}
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/PermissionUsageViewModelTest.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/PermissionUsageViewModelTest.kt
index 38390ca64..cf18cdf7d 100644
--- a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/PermissionUsageViewModelTest.kt
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/PermissionUsageViewModelTest.kt
@@ -21,9 +21,11 @@ import android.content.Context
 import android.content.pm.ApplicationInfo
 import android.content.pm.PackageInfo
 import android.content.pm.PackageManager
+import androidx.lifecycle.SavedStateHandle
 import androidx.test.ext.junit.runners.AndroidJUnit4
 import com.android.dx.mockito.inline.extended.ExtendedMockito
 import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.DeviceUtils
 import com.android.permissioncontroller.PermissionControllerApplication
 import com.android.permissioncontroller.appops.data.model.v31.PackageAppOpUsageModel
 import com.android.permissioncontroller.appops.data.model.v31.PackageAppOpUsageModel.AppOpUsageModel
@@ -43,6 +45,7 @@ import com.google.common.truth.Truth.assertThat
 import java.util.concurrent.TimeUnit
 import kotlinx.coroutines.flow.flowOf
 import kotlinx.coroutines.test.StandardTestDispatcher
+import kotlinx.coroutines.test.TestScope
 import kotlinx.coroutines.test.runTest
 import org.junit.After
 import org.junit.Assume
@@ -66,6 +69,7 @@ class PermissionUsageViewModelTest {
     private val testPackageName = "test.package"
     private val systemPackageName = "test.package.system"
     private lateinit var packageInfos: MutableMap<String, PackageInfoModel>
+
     @Before
     fun setup() {
         Assume.assumeTrue(SdkLevel.isAtLeastS())
@@ -73,11 +77,13 @@ class PermissionUsageViewModelTest {
         mockitoSession =
             ExtendedMockito.mockitoSession()
                 .mockStatic(PermissionControllerApplication::class.java)
+                .mockStatic(DeviceUtils::class.java)
                 .strictness(Strictness.LENIENT)
                 .startMocking()
 
         whenever(PermissionControllerApplication.get()).thenReturn(application)
         whenever(application.applicationContext).thenReturn(context)
+        whenever(DeviceUtils.isHandheld()).thenReturn(true)
         PermissionMapping.addHealthPermissionsToPlatform(setOf("health1"))
 
         val permissionFlags =
@@ -105,21 +111,8 @@ class PermissionUsageViewModelTest {
 
     @Test
     fun allPermissionGroupsAreShown() = runTest {
-        val permissionUsageViewModel =
-            PermissionUsageViewModel(
-                application,
-                permissionRepository,
-                getPermissionGroupUsageUseCase(),
-                backgroundScope,
-                StandardTestDispatcher(testScheduler),
-                is7DayToggleEnabled = true
-            )
-
-        val uiData =
-            checkNotNull(
-                collectLastValue(permissionUsageViewModel.getPermissionUsagesUiDataFlow()).invoke()
-            )
-                as PermissionUsagesUiState.Success
+        val permissionUsageViewModel = getViewModel()
+        val uiData = getPermissionUsageUiState(permissionUsageViewModel)
 
         val expectedPermissions = PermissionMapping.getPlatformPermissionGroups().toMutableSet()
         if (SdkLevel.isAtLeastT()) {
@@ -129,7 +122,7 @@ class PermissionUsageViewModelTest {
     }
 
     @Test
-    fun permissionGroupsCountNonSystemApps() = runTest {
+    fun onlyNonSystemAppsUsageIsCounted() = runTest {
         val timestamp = System.currentTimeMillis() - TimeUnit.HOURS.toMillis(5)
         val appOpsUsage =
             listOf(
@@ -143,26 +136,19 @@ class PermissionUsageViewModelTest {
             )
         val permissionUsageUseCase = getPermissionGroupUsageUseCase(appOpsUsageModels)
         val permissionUsageViewModel =
-            PermissionUsageViewModel(
-                application,
-                permissionRepository,
-                permissionUsageUseCase,
-                backgroundScope,
-                StandardTestDispatcher(testScheduler),
-                is7DayToggleEnabled = true
-            )
-        val uiData =
-            checkNotNull(
-                collectLastValue(permissionUsageViewModel.getPermissionUsagesUiDataFlow()).invoke()
+            getViewModel(
+                useCase = permissionUsageUseCase,
+                savedStateHandle = SavedStateHandle(mapOf("showSystem" to false))
             )
-                as PermissionUsagesUiState.Success
+        val uiData = getPermissionUsageUiState(permissionUsageViewModel)
+
         val permissionGroupsCount = uiData.permissionGroupUsageCount
         assertThat(permissionGroupsCount[CAMERA_PERMISSION_GROUP]).isEqualTo(2)
         assertThat(permissionGroupsCount[MICROPHONE_PERMISSION_GROUP]).isEqualTo(1)
     }
 
     @Test
-    fun permissionGroupsCountAllApps() = runTest {
+    fun systemAppsUsageIsCounted() = runTest {
         val timestamp = System.currentTimeMillis() - TimeUnit.HOURS.toMillis(5)
         val appOpsUsage =
             listOf(
@@ -176,23 +162,111 @@ class PermissionUsageViewModelTest {
             )
         val permissionUsageUseCase = getPermissionGroupUsageUseCase(appOpsUsageModels)
         val permissionUsageViewModel =
-            PermissionUsageViewModel(
-                application,
-                permissionRepository,
-                permissionUsageUseCase,
-                backgroundScope,
-                StandardTestDispatcher(testScheduler),
-                is7DayToggleEnabled = true
+            getViewModel(
+                useCase = permissionUsageUseCase,
+                savedStateHandle = SavedStateHandle(mapOf("showSystem" to true))
             )
+        val uiData = getPermissionUsageUiState(permissionUsageViewModel)
 
-        collectLastValue(permissionUsageViewModel.getPermissionUsagesUiDataFlow()).invoke()
-        val uiData =
-            permissionUsageViewModel.updateShowSystem(true) as PermissionUsagesUiState.Success
         val permissionGroupsCount = uiData.permissionGroupUsageCount
         assertThat(permissionGroupsCount[CAMERA_PERMISSION_GROUP]).isEqualTo(2)
         assertThat(permissionGroupsCount[MICROPHONE_PERMISSION_GROUP]).isEqualTo(2)
     }
 
+    @Test
+    fun noSystemAppsAvailableInLast24Hours() = runTest {
+        val timestamp = System.currentTimeMillis() - TimeUnit.DAYS.toMillis(2)
+        val appOpsUsage =
+            listOf(
+                AppOpUsageModel(AppOpsManager.OPSTR_CAMERA, timestamp),
+                AppOpUsageModel(AppOpsManager.OPSTR_PHONE_CALL_MICROPHONE, timestamp),
+            )
+        val appOpsUsageModels =
+            listOf(
+                PackageAppOpUsageModel(testPackageName, appOpsUsage, currentUser.identifier),
+                PackageAppOpUsageModel(systemPackageName, appOpsUsage, currentUser.identifier),
+            )
+        val permissionUsageUseCase = getPermissionGroupUsageUseCase(appOpsUsageModels)
+        val permissionUsageViewModel = getViewModel(useCase = permissionUsageUseCase)
+        val uiData = getPermissionUsageUiState(permissionUsageViewModel)
+
+        assertThat(uiData.containsSystemAppUsage).isFalse()
+    }
+
+    @Test
+    fun appUsageIsCountedForLast7Days() = runTest {
+        val timestamp = System.currentTimeMillis() - TimeUnit.DAYS.toMillis(2)
+        val appOpsUsage =
+            listOf(
+                AppOpUsageModel(AppOpsManager.OPSTR_CAMERA, timestamp),
+                AppOpUsageModel(AppOpsManager.OPSTR_PHONE_CALL_MICROPHONE, timestamp),
+            )
+        val appOpsUsageModels =
+            listOf(
+                PackageAppOpUsageModel(testPackageName, appOpsUsage, currentUser.identifier),
+            )
+        val permissionUsageUseCase = getPermissionGroupUsageUseCase(appOpsUsageModels)
+        val permissionUsageViewModel =
+            getViewModel(
+                useCase = permissionUsageUseCase,
+                savedStateHandle = SavedStateHandle(mapOf("show7Days" to true))
+            )
+        val permissionGroupsCount =
+            getPermissionUsageUiState(permissionUsageViewModel).permissionGroupUsageCount
+
+        assertThat(permissionGroupsCount[CAMERA_PERMISSION_GROUP]).isEqualTo(1)
+        assertThat(permissionGroupsCount[MICROPHONE_PERMISSION_GROUP]).isEqualTo(1)
+    }
+
+    @Test
+    fun verifyObserverIsNotifiedOnUserActionWhenDataIsSame() = runTest {
+        val timestamp = System.currentTimeMillis() - TimeUnit.HOURS.toMillis(2)
+        val appOpsUsage =
+            listOf(
+                AppOpUsageModel(AppOpsManager.OPSTR_CAMERA, timestamp),
+                AppOpUsageModel(AppOpsManager.OPSTR_PHONE_CALL_MICROPHONE, timestamp),
+            )
+        val appOpsUsageModels =
+            listOf(
+                PackageAppOpUsageModel(testPackageName, appOpsUsage, currentUser.identifier),
+            )
+        val permissionUsageUseCase = getPermissionGroupUsageUseCase(appOpsUsageModels)
+        val permissionUsageViewModel =
+            getViewModel(
+                useCase = permissionUsageUseCase,
+                savedStateHandle = SavedStateHandle(mapOf("show7Days" to false))
+            )
+
+        val uiState = getPermissionUsageUiState(permissionUsageViewModel)
+        assertThat(uiState.show7Days).isFalse()
+
+        // perform user action
+        permissionUsageViewModel.updateShow7Days(true)
+        val uiState2 = getPermissionUsageUiState(permissionUsageViewModel)
+        assertThat(uiState2.show7Days).isTrue()
+    }
+
+    private fun TestScope.getViewModel(
+        useCase: GetPermissionGroupUsageUseCase = getPermissionGroupUsageUseCase(),
+        savedStateHandle: SavedStateHandle = SavedStateHandle(emptyMap())
+    ): PermissionUsageViewModel {
+        return PermissionUsageViewModel(
+            application,
+            permissionRepository,
+            useCase,
+            backgroundScope,
+            StandardTestDispatcher(testScheduler),
+            savedState = savedStateHandle
+        )
+    }
+
+    private fun TestScope.getPermissionUsageUiState(
+        viewModel: PermissionUsageViewModel
+    ): PermissionUsagesUiState.Success {
+        val result by collectLastValue(viewModel.permissionUsagesUiDataFlow)
+        return result as PermissionUsagesUiState.Success
+    }
+
     private fun getPermissionGroupUsageUseCase(
         packageAppOpsUsages: List<PackageAppOpUsageModel> = emptyList(),
     ): GetPermissionGroupUsageUseCase {
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/ReviewPermissionsViewModelTest.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/ReviewPermissionsViewModelTest.kt
index 899a026c4..0e8890df5 100644
--- a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/ReviewPermissionsViewModelTest.kt
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/ui/model/ReviewPermissionsViewModelTest.kt
@@ -104,7 +104,7 @@ class ReviewPermissionsViewModelTest {
         permissionsMap["mockedPermission1"] = permission2
 
         whenever(permGroup.allPermissions).thenReturn(permissionsMap)
-        whenever(permission1.isGrantedIncludingAppOp).thenReturn(true)
+        whenever(permission1.isGranted).thenReturn(true)
 
         val summary = model.getSummaryForIndividuallyControlledPermGroup(permGroup)
         assertEquals(
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/utils/GrantRevokeTests.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/utils/GrantRevokeTests.kt
index 8bd61ebe6..28f69b136 100644
--- a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/utils/GrantRevokeTests.kt
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/permission/utils/GrantRevokeTests.kt
@@ -25,6 +25,7 @@ import android.app.AppOpsManager.MODE_IGNORED
 import android.app.AppOpsManager.permissionToOp
 import android.app.Application
 import android.content.Context
+import android.content.pm.ApplicationInfo
 import android.content.pm.PackageManager
 import android.content.pm.PackageManager.FLAG_PERMISSION_AUTO_REVOKED
 import android.content.pm.PackageManager.FLAG_PERMISSION_ONE_TIME
@@ -216,7 +217,8 @@ class GrantRevokeTests {
                 backgroundPerm,
                 PermissionInfo.PROTECTION_DANGEROUS,
                 permInfoProtectionFlags,
-                0
+                0,
+                pkgInfo.appFlags and ApplicationInfo.FLAG_SYSTEM != 0
             )
         return LightPermission(
             pkgInfo,
@@ -292,7 +294,7 @@ class GrantRevokeTests {
             val flags = state.second
 
             assertWithMessage("permission $permName grant state incorrect")
-                .that(perms[permName]?.isGrantedIncludingAppOp)
+                .that(perms[permName]?.isGranted)
                 .isEqualTo(granted)
 
             val actualFlags = perms[permName]!!.flags
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/pm/data/repository/FakePackageRepository.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/pm/data/repository/FakePackageRepository.kt
index 29557b0b2..d199818c1 100644
--- a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/pm/data/repository/FakePackageRepository.kt
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/pm/data/repository/FakePackageRepository.kt
@@ -16,12 +16,25 @@
 
 package com.android.permissioncontroller.tests.mocking.pm.data.repository
 
+import android.graphics.drawable.Drawable
 import android.os.UserHandle
+import com.android.permissioncontroller.pm.data.model.v31.PackageAttributionModel
 import com.android.permissioncontroller.pm.data.model.v31.PackageInfoModel
 import com.android.permissioncontroller.pm.data.repository.v31.PackageRepository
 
-class FakePackageRepository(private val packages: Map<String, PackageInfoModel> = emptyMap()) :
-    PackageRepository {
+class FakePackageRepository(
+    private val packages: Map<String, PackageInfoModel> = emptyMap(),
+    private val packageAttributions: Map<String, PackageAttributionModel> = emptyMap(),
+    private val packagesAndLabels: Map<String, String> = emptyMap(),
+) : PackageRepository {
+    override fun getPackageLabel(packageName: String, user: UserHandle): String {
+        return packagesAndLabels[packageName] ?: packageName
+    }
+
+    override fun getBadgedPackageIcon(packageName: String, user: UserHandle): Drawable? {
+        return null
+    }
+
     override suspend fun getPackageInfo(
         packageName: String,
         user: UserHandle,
@@ -29,4 +42,11 @@ class FakePackageRepository(private val packages: Map<String, PackageInfoModel>
     ): PackageInfoModel? {
         return packages[packageName]
     }
+
+    override suspend fun getPackageAttributionInfo(
+        packageName: String,
+        user: UserHandle
+    ): PackageAttributionModel? {
+        return packageAttributions[packageName]
+    }
 }
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/pm/data/repository/PackageRepositoryTest.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/pm/data/repository/PackageRepositoryTest.kt
new file mode 100644
index 000000000..257cc2ac3
--- /dev/null
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/pm/data/repository/PackageRepositoryTest.kt
@@ -0,0 +1,162 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.tests.mocking.pm.data.repository
+
+import android.content.Context
+import android.content.pm.ApplicationInfo
+import android.content.pm.Attribution
+import android.content.pm.PackageInfo
+import android.content.pm.PackageManager
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import com.android.dx.mockito.inline.extended.ExtendedMockito
+import com.android.modules.utils.build.SdkLevel
+import com.android.permissioncontroller.PermissionControllerApplication
+import com.android.permissioncontroller.permission.utils.Utils
+import com.android.permissioncontroller.pm.data.repository.v31.PackageRepository
+import com.android.permissioncontroller.pm.data.repository.v31.PackageRepositoryImpl
+import com.google.common.truth.Truth.assertThat
+import kotlinx.coroutines.test.runTest
+import org.junit.After
+import org.junit.Assume
+import org.junit.Before
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mockito.Mock
+import org.mockito.Mockito.eq
+import org.mockito.Mockito.mock
+import org.mockito.Mockito.`when` as whenever
+import org.mockito.MockitoAnnotations
+import org.mockito.MockitoSession
+import org.mockito.quality.Strictness
+
+@RunWith(AndroidJUnit4::class)
+class PackageRepositoryTest {
+    @Mock private lateinit var application: PermissionControllerApplication
+
+    @Mock private lateinit var context: Context
+
+    @Mock private lateinit var packageManager: PackageManager
+
+    private lateinit var underTest: PackageRepository
+    private var mockitoSession: MockitoSession? = null
+
+    private val currentUser = android.os.Process.myUserHandle()
+    private val testPackageName = "test.package"
+
+    @Before
+    fun setup() {
+        MockitoAnnotations.initMocks(this)
+        mockitoSession =
+            ExtendedMockito.mockitoSession()
+                .mockStatic(PermissionControllerApplication::class.java)
+                .mockStatic(Utils::class.java)
+                .strictness(Strictness.LENIENT)
+                .startMocking()
+        whenever(PermissionControllerApplication.get()).thenReturn(application)
+        whenever(Utils.getUserContext(application, currentUser)).thenReturn(context)
+        whenever(context.packageManager).thenReturn(packageManager)
+
+        underTest = PackageRepositoryImpl(application)
+    }
+
+    @After
+    fun finish() {
+        mockitoSession?.finishMocking()
+    }
+
+    @Test
+    @Suppress("DEPRECATION")
+    fun verifyMissingPackageAttributionInfo() = runTest {
+        Assume.assumeTrue(SdkLevel.isAtLeastS())
+        val mockData = getPackageInfoWithoutAttribution()
+        whenever(
+                packageManager.getPackageInfo(
+                    eq(testPackageName),
+                    eq(PackageManager.GET_ATTRIBUTIONS)
+                )
+            )
+            .thenReturn(mockData)
+
+        val attributionInfo = underTest.getPackageAttributionInfo(testPackageName, currentUser)
+        assertThat(attributionInfo).isNotNull()
+        assertThat(attributionInfo?.packageName).isEqualTo(testPackageName)
+        assertThat(attributionInfo?.areUserVisible).isEqualTo(false)
+        assertThat(attributionInfo?.tagResourceMap).isNull()
+        assertThat(attributionInfo?.resourceLabelMap).isNull()
+    }
+
+    @Test
+    @Suppress("DEPRECATION")
+    fun verifyPackageAttributionInfo() = runTest {
+        Assume.assumeTrue(SdkLevel.isAtLeastS())
+        val mockData = getPackageInfoWithAttribution()
+        whenever(application.createPackageContext(eq(testPackageName), eq(0))).thenReturn(context)
+        whenever(context.getString(eq(100))).thenReturn("tag1 Label")
+        whenever(
+                packageManager.getPackageInfo(
+                    eq(testPackageName),
+                    eq(PackageManager.GET_ATTRIBUTIONS)
+                )
+            )
+            .thenReturn(mockData)
+
+        val expectedAttributionMap = mutableMapOf<Int, String>()
+        expectedAttributionMap[100] = "tag1 Label"
+
+        val expectedTagToLabelResMap = mutableMapOf<String, Int>()
+        expectedTagToLabelResMap["tag1"] = 100
+        expectedTagToLabelResMap["tag2"] = 200
+        val attributionInfo = underTest.getPackageAttributionInfo(testPackageName, currentUser)
+        assertThat(attributionInfo).isNotNull()
+        assertThat(attributionInfo?.packageName).isEqualTo(testPackageName)
+        assertThat(attributionInfo?.areUserVisible).isEqualTo(true)
+        assertThat(attributionInfo?.tagResourceMap).isEqualTo(expectedTagToLabelResMap)
+        assertThat(attributionInfo?.resourceLabelMap).isEqualTo(expectedAttributionMap)
+    }
+
+    private fun getPackageInfoWithoutAttribution(): PackageInfo {
+        val info = mock(ApplicationInfo::class.java)
+        whenever(info.areAttributionsUserVisible()).thenReturn(false)
+
+        return PackageInfo().apply {
+            packageName = testPackageName
+            applicationInfo = info
+            requestedPermissions = listOf<String>().toTypedArray()
+            requestedPermissionsFlags = listOf<Int>().toIntArray()
+        }
+    }
+
+    private fun getPackageInfoWithAttribution(): PackageInfo {
+        val attribution = mock(Attribution::class.java)
+        whenever(attribution.label).thenReturn(100)
+        whenever(attribution.tag).thenReturn("tag1")
+        val attribution2 = mock(Attribution::class.java)
+        whenever(attribution2.label).thenReturn(200)
+        whenever(attribution2.tag).thenReturn("tag2")
+
+        val info = mock(ApplicationInfo::class.java)
+        whenever(info.areAttributionsUserVisible()).thenReturn(true)
+
+        return PackageInfo().apply {
+            packageName = testPackageName
+            applicationInfo = info
+            requestedPermissions = listOf<String>().toTypedArray()
+            requestedPermissionsFlags = listOf<Int>().toIntArray()
+            attributions = listOf(attribution, attribution2).toTypedArray()
+        }
+    }
+}
diff --git a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/role/model/RoleParserTest.kt b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/role/model/RoleParserTest.kt
index 0989903d0..ec6ab4eff 100644
--- a/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/role/model/RoleParserTest.kt
+++ b/PermissionController/tests/mocking/src/com/android/permissioncontroller/tests/mocking/role/model/RoleParserTest.kt
@@ -34,10 +34,18 @@ class RoleParserTest {
         }
     }
 
-    private val targetContext = InstrumentationRegistry.getInstrumentation().getTargetContext()
+    private val instrumentation = InstrumentationRegistry.getInstrumentation()
+    private val uiAutomation = instrumentation.uiAutomation
+    private val targetContext = instrumentation.targetContext
 
     @Test
     fun testParseRolesWithValidation() {
-        RoleParser(targetContext, true).parse()
+        // We may need to call privileged APIs to determine availability of things.
+        uiAutomation.adoptShellPermissionIdentity()
+        try {
+            RoleParser(targetContext, true).parse()
+        } finally {
+            uiAutomation.dropShellPermissionIdentity()
+        }
     }
 }
diff --git a/PermissionController/tests/outofprocess/Android.bp b/PermissionController/tests/outofprocess/Android.bp
index 83bb65d6b..be0fa90ff 100644
--- a/PermissionController/tests/outofprocess/Android.bp
+++ b/PermissionController/tests/outofprocess/Android.bp
@@ -37,8 +37,8 @@ android_test {
     ],
 
     libs: [
-        "android.test.base",
-        "android.test.runner",
+        "android.test.base.stubs.system",
+        "android.test.runner.stubs.system",
     ],
 
     static_libs: [
diff --git a/PermissionController/tests/permissionui/Android.bp b/PermissionController/tests/permissionui/Android.bp
index 6aa0dc45c..6e1839d1d 100644
--- a/PermissionController/tests/permissionui/Android.bp
+++ b/PermissionController/tests/permissionui/Android.bp
@@ -38,17 +38,20 @@ android_test {
         "src/**/*.kt",
     ],
     libs: [
-        "android.test.base",
-        "android.test.runner",
+        "android.test.base.stubs.test",
+        "android.test.runner.stubs.test",
     ],
 
     static_libs: [
-        "androidx.test.rules",
-        "androidx.test.ext.truth",
         "androidx.test.ext.junit",
+        "androidx.test.ext.truth",
+        "androidx.test.rules",
         "androidx.test.uiautomator_uiautomator",
+        "com.android.permission.flags-aconfig-java",
         "compatibility-device-util-axt",
+        "flag-junit",
         "permission-test-util-lib",
+        "platform-test-annotations",
     ],
 
     test_suites: [
@@ -58,6 +61,7 @@ android_test {
     ],
 
     data: [
+        ":CtsAppThatRequestsLocationAndBackgroundPermission31",
         ":CtsAppThatRequestsLocationPermission29",
         ":PermissionUiUseStoragePermissionApp",
         ":PermissionUiUseCameraPermissionApp",
diff --git a/PermissionController/tests/permissionui/AndroidTest.xml b/PermissionController/tests/permissionui/AndroidTest.xml
index 566410777..a4aa03abe 100644
--- a/PermissionController/tests/permissionui/AndroidTest.xml
+++ b/PermissionController/tests/permissionui/AndroidTest.xml
@@ -37,6 +37,8 @@
 
     <!-- Load additional APKs onto device -->
     <target_preparer class="com.android.tradefed.targetprep.PushFilePreparer">
+        <option name="push-file" key="CtsAppThatRequestsLocationAndBackgroundPermission31.apk"
+            value="/data/local/tmp/pc-permissionui/AppThatRequestsLocationAndBackground.apk" />
         <option name="push-file" key="CtsAppThatRequestsLocationPermission29.apk"
                 value="/data/local/tmp/pc-permissionui/AppThatRequestsLocation.apk" />
         <option name="push-file" key="PermissionUiUseStoragePermissionApp.apk"
diff --git a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/AutoAppPermissionFragmentTest.kt b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/AutoAppPermissionFragmentTest.kt
new file mode 100644
index 000000000..a5420e067
--- /dev/null
+++ b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/AutoAppPermissionFragmentTest.kt
@@ -0,0 +1,187 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.permissionui.ui
+
+import android.Manifest.permission.ACCESS_COARSE_LOCATION
+import android.Manifest.permission.ACCESS_FINE_LOCATION
+import android.content.Intent
+import android.os.UserHandle
+import android.os.UserHandle.myUserId
+import android.permission.cts.PermissionUtils
+import android.permission.cts.PermissionUtils.grantPermission
+import android.permission.cts.PermissionUtils.revokePermission
+import android.platform.test.annotations.RequiresFlagsDisabled
+import android.platform.test.annotations.RequiresFlagsEnabled
+import android.platform.test.flag.junit.DeviceFlagsValueProvider
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import androidx.test.uiautomator.By
+import com.android.compatibility.common.util.SystemUtil.runWithShellPermissionIdentity
+import com.android.compatibility.common.util.UiAutomatorUtils2.waitFindObject
+import com.android.compatibility.common.util.UiAutomatorUtils2.waitFindObjectOrNull
+import com.android.compatibility.common.util.UiAutomatorUtils2.waitUntilObjectGone
+import com.android.modules.utils.build.SdkLevel
+import com.android.permission.flags.Flags
+import com.android.permissioncontroller.permissionui.wakeUpScreen
+import junit.framework.Assert.assertFalse
+import junit.framework.Assert.assertNotNull
+import junit.framework.Assert.assertNull
+import junit.framework.Assert.assertTrue
+import org.junit.After
+import org.junit.Assume.assumeTrue
+import org.junit.Before
+import org.junit.Rule
+import org.junit.Test
+import org.junit.runner.RunWith
+
+private const val LOCATION = "Location"
+private const val PERMISSION_REQUEST_APP = "PermissionRequestApp"
+private const val SWITCH_VIEW = "Use precise location"
+private const val LOG_TAG = "AppPermissionFragmentTest"
+private const val DONT_ALLOW = "Don\u2019t allow"
+private const val ALLOW_ONLY = "Allow only while using the app"
+
+/**
+ * Simple tests for {@link AutoAppPermissionFragment}
+ *
+ * Run with: atest AutoAppPermissionFragmentTest
+ */
+@RunWith(AndroidJUnit4::class)
+class AutoAppPermissionFragmentTest : BasePermissionUiTest() {
+
+    private val USER_PKG_V2 = "android.permission.cts.appthatrequestpermission"
+
+    @JvmField @Rule val checkFlagsRule = DeviceFlagsValueProvider.createCheckFlagsRule()
+
+    @Before fun assumeIsAuto() = assumeTrue(isAutomotive)
+
+    @Before
+    fun setup() {
+        wakeUpScreen()
+        assumeTrue("Location Accuracy is only available on S+", SdkLevel.isAtLeastS())
+        installTestAppThatRequestsFineLocation()
+        grantPermission(USER_PKG_V2, ACCESS_FINE_LOCATION)
+        grantPermission(USER_PKG_V2, ACCESS_COARSE_LOCATION)
+    }
+
+    private fun startManagePermissionAppsActivity() {
+        runWithShellPermissionIdentity {
+            instrumentationContext.startActivity(
+                Intent(Intent.ACTION_MANAGE_APP_PERMISSION).apply {
+                    addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
+                    addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK)
+                    putExtra(Intent.EXTRA_PACKAGE_NAME, USER_PKG_V2)
+                    putExtra(Intent.EXTRA_PERMISSION_NAME, ACCESS_FINE_LOCATION)
+                    putExtra(Intent.EXTRA_USER, UserHandle.of(myUserId()))
+                }
+            )
+        }
+    }
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_ENABLE_COARSE_FINE_LOCATION_PROMPT_FOR_AAOS)
+    fun whenSwitchViewOffCoarseLocationGranted() {
+        // Pre: Assert switch view exists and fine location granted
+        // Test: Find and toggle switch view
+        // Post-Condition: Assert that coarse location granted
+
+        startManagePermissionAppsActivity()
+
+        // confirm switch view exists and is currently on
+        assertNotNull(waitFindObjectOrNull(By.text(SWITCH_VIEW)))
+        assertTrue(PermissionUtils.isPermissionGranted(USER_PKG_V2, ACCESS_FINE_LOCATION))
+
+        // turn off switch view and confirm functionality
+        waitFindObject(By.text(SWITCH_VIEW)).click()
+        assertFalse(PermissionUtils.isPermissionGranted(USER_PKG_V2, ACCESS_FINE_LOCATION))
+        assertTrue(PermissionUtils.isPermissionGranted(USER_PKG_V2, ACCESS_COARSE_LOCATION))
+    }
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_ENABLE_COARSE_FINE_LOCATION_PROMPT_FOR_AAOS)
+    fun whenSwitchViewOnFineLocationGranted() {
+        // Pre: Assert switch view exists and fine location not granted
+        // Test: Find and toggle switch view
+        // Post-Condition: Assert that fine location granted
+
+        revokePermission(USER_PKG_V2, ACCESS_FINE_LOCATION)
+        startManagePermissionAppsActivity()
+
+        // confirm switch view exists and is currently off
+        assertNotNull(waitFindObjectOrNull(By.text(SWITCH_VIEW)))
+        assertFalse(PermissionUtils.isPermissionGranted(USER_PKG_V2, ACCESS_FINE_LOCATION))
+
+        // turn on switch view and confirm functionality
+        waitFindObject(By.text(SWITCH_VIEW)).click()
+        assertTrue(PermissionUtils.isPermissionGranted(USER_PKG_V2, ACCESS_FINE_LOCATION))
+        assertTrue(PermissionUtils.isPermissionGranted(USER_PKG_V2, ACCESS_COARSE_LOCATION))
+    }
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_ENABLE_COARSE_FINE_LOCATION_PROMPT_FOR_AAOS)
+    fun whenLocationPermissionsDeniedSwitchViewGone() {
+        // Pre: Assert switch view visible
+        // Test: Click "Don't Allow"
+        // Post-Condition: Assert switch view is not visible
+
+        startManagePermissionAppsActivity()
+
+        // confirm switch view exists
+        assertNotNull(waitFindObjectOrNull(By.text(SWITCH_VIEW)))
+
+        // turn off location permissions and confirm functionality
+        waitFindObject(By.text(DONT_ALLOW)).click()
+        assertNull(waitFindObjectOrNull(By.text(SWITCH_VIEW)))
+    }
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_ENABLE_COARSE_FINE_LOCATION_PROMPT_FOR_AAOS)
+    fun whenLocationPermissionsGrantedSwitchViewVisible() {
+        // Test: Click "Allow always"
+        // Post-Condition: Assert switch view is visible
+
+        revokePermission(USER_PKG_V2, ACCESS_FINE_LOCATION)
+        revokePermission(USER_PKG_V2, ACCESS_COARSE_LOCATION)
+        startManagePermissionAppsActivity()
+
+        // confirm switch view doesn't exist
+        assertNull(waitFindObjectOrNull(By.text(SWITCH_VIEW)))
+
+        // allow location permissions and confirm functionality
+        waitFindObject(By.text(ALLOW_ONLY)).click()
+        assertNotNull(waitFindObjectOrNull(By.text(SWITCH_VIEW)))
+    }
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_ENABLE_COARSE_FINE_LOCATION_PROMPT_FOR_AAOS)
+    fun whenFlaggedTurnedOnSwitchViewVisible() {
+        startManagePermissionAppsActivity()
+        assertNotNull(waitFindObjectOrNull(By.text(SWITCH_VIEW)))
+    }
+
+    @Test
+    @RequiresFlagsDisabled(Flags.FLAG_ENABLE_COARSE_FINE_LOCATION_PROMPT_FOR_AAOS)
+    fun whenFlaggedTurnedOffSwitchViewNotVisible() {
+        startManagePermissionAppsActivity()
+        waitUntilObjectGone(By.text(SWITCH_VIEW))
+        assertNull(waitFindObjectOrNull(By.text(SWITCH_VIEW)))
+    }
+
+    @After
+    fun uninstallTestApp() {
+        uninstallTestApps()
+    }
+}
diff --git a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/BasePermissionUiTest.kt b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/BasePermissionUiTest.kt
index 2cb7e7a5c..995e22945 100644
--- a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/BasePermissionUiTest.kt
+++ b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/BasePermissionUiTest.kt
@@ -34,6 +34,7 @@ abstract class BasePermissionUiTest {
             hasSystemFeature(PackageManager.FEATURE_LEANBACK) ||
                 hasSystemFeature(PackageManager.FEATURE_LEANBACK_ONLY)
         }
+    protected val isAutomotive = packageManager.hasSystemFeature(PackageManager.FEATURE_AUTOMOTIVE)
 
     @Rule fun disableAnimationsRule() = DisableAnimationRule()
 }
diff --git a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/TestAppUtils.kt b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/TestAppUtils.kt
index 09f59de30..7227ea3d8 100644
--- a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/TestAppUtils.kt
+++ b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/TestAppUtils.kt
@@ -23,6 +23,8 @@ import android.permission.cts.PermissionUtils.uninstallApp
 // Test Apps' APK files
 private const val APK_DIRECTORY = "/data/local/tmp/pc-permissionui/"
 private const val LOCATION_PERM_USER_APK = "$APK_DIRECTORY/AppThatRequestsLocation.apk"
+private const val FINE_AND_BACKGROUND_LOCATION_PERM_USER_APK =
+    "$APK_DIRECTORY/AppThatRequestsLocationAndBackground.apk"
 private const val CAMERA_PERM_USER_APK = "$APK_DIRECTORY/PermissionUiUseCameraPermissionApp.apk"
 private const val HEALTH_CONNECT_PERMISSION_USER_APK =
     "$APK_DIRECTORY/PermissionUiUseHealthConnectPermissionApp.apk"
@@ -52,6 +54,8 @@ const val TEST_APP_DEFINED_PERMISSION_C_LABEL = "Permission C"
 
 fun installTestAppThatRequestsLocation() = install(LOCATION_PERM_USER_APK)
 
+fun installTestAppThatRequestsFineLocation() = install(FINE_AND_BACKGROUND_LOCATION_PERM_USER_APK)
+
 fun installTestAppThatUsesCameraPermission() = install(CAMERA_PERM_USER_APK)
 
 fun installTestAppThatUsesHealthConnectPermission() = install(HEALTH_CONNECT_PERMISSION_USER_APK)
diff --git a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/handheld/v31/PermissionUsageFragmentTest.kt b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/handheld/v31/PermissionUsageFragmentTest.kt
index f81b620ce..ea3868c9d 100644
--- a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/handheld/v31/PermissionUsageFragmentTest.kt
+++ b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/handheld/v31/PermissionUsageFragmentTest.kt
@@ -32,6 +32,7 @@ import com.android.permissioncontroller.permissionui.PermissionHub2Test
 import com.android.permissioncontroller.permissionui.pressHome
 import com.android.permissioncontroller.permissionui.wakeUpScreen
 import org.junit.After
+import org.junit.Assume.assumeTrue
 import org.junit.Before
 import org.junit.Test
 import org.junit.runner.RunWith
@@ -45,6 +46,24 @@ class PermissionUsageFragmentTest : PermissionHub2Test() {
     private val APP_LABEL = "CameraRequestApp"
     private val CAMERA_PREF_LABEL = "Camera"
 
+    /**
+     * Returns `true` if [Intent.ACTION_REVIEW_PERMISSION_USAGE] is handled by permission controller
+     */
+    private fun isPrivacyDashboardProvidedByPermissionController(): Boolean {
+        val pm = context.packageManager
+        return pm.resolveActivity(Intent(Intent.ACTION_REVIEW_PERMISSION_USAGE), 0)!!
+            .activityInfo
+            .packageName == pm.permissionControllerPackageName
+    }
+
+    @Before
+    fun checkPreconditions() {
+        // Since there is no clear UI specification of privacy dashboard, OEM could have their
+        // own implementation with a different UI. Hence, limit the test scope to only permission
+        // controller.
+        assumeTrue(isPrivacyDashboardProvidedByPermissionController())
+    }
+
     @Before
     fun setup() {
         wakeUpScreen()
diff --git a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/television/ManagePermissionsOtherFragmentTest.kt b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/television/ManagePermissionsOtherFragmentTest.kt
index 2d338906b..9f0f548e0 100644
--- a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/television/ManagePermissionsOtherFragmentTest.kt
+++ b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/television/ManagePermissionsOtherFragmentTest.kt
@@ -22,6 +22,7 @@ import com.android.permissioncontroller.permissionui.ui.TEST_APP_DEFINED_PERMISS
 import com.android.permissioncontroller.permissionui.ui.grantTestAppPermission
 import com.android.permissioncontroller.permissionui.ui.installTestAppThatDefinesAdditionalPermissions
 import com.android.permissioncontroller.permissionui.ui.installTestAppThatUsesAdditionalPermission
+import org.junit.After
 import org.junit.Assert.assertEquals
 import org.junit.Assert.assertFalse
 import org.junit.Assert.assertTrue
@@ -49,6 +50,11 @@ class ManagePermissionsOtherFragmentTest : TelevisionUiBaseTest() {
         )
     }
 
+    @After
+    fun goOutOfOtherPermissionsScreen() {
+        uiDevice.pressBack()
+    }
+
     @Test
     fun bodySensors_permissionGroup_isNotShown() {
         assertFalse(
diff --git a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/television/OWNERS b/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/television/OWNERS
deleted file mode 100644
index c6774752d..000000000
--- a/PermissionController/tests/permissionui/src/com/android/permissioncontroller/permissionui/ui/television/OWNERS
+++ /dev/null
@@ -1,8 +0,0 @@
-# Primary maintainer
-
-# Other maintainers (ATV Core Framework team)
-bronger@google.com
-galinap@google.com
-philipjunker@google.com
-rgl@google.com
-valiiftime@google.com
diff --git a/SafetyCenter/Config/Android.bp b/SafetyCenter/Config/Android.bp
index a8d275226..32df3165e 100644
--- a/SafetyCenter/Config/Android.bp
+++ b/SafetyCenter/Config/Android.bp
@@ -35,7 +35,7 @@ java_library {
     libs: [
         "androidx.annotation_annotation",
         "framework-annotations-lib",
-        "framework-permission-s",
+        "framework-permission-s.impl",
         "safety-center-annotations",
     ],
     static_libs: [
diff --git a/SafetyCenter/Resources/res/values-ar/strings.xml b/SafetyCenter/Resources/res/values-ar/strings.xml
index 2a97af99a..0fc5079db 100644
--- a/SafetyCenter/Resources/res/values-ar/strings.xml
+++ b/SafetyCenter/Resources/res/values-ar/strings.xml
@@ -24,7 +24,7 @@
     <string name="lock_screen_summary_disabled" msgid="354071230916616692">"ما مِن معلومات بعد."</string>
     <string name="lock_screen_search_terms" msgid="2678486357779794826">"قفل الجهاز، قفل الشاشة، شاشة القفل، شاشة قفل، كلمة المرور، رقم التعريف الشخصي، نقش"</string>
     <string name="biometrics_title" msgid="5859504610285212938">"المقاييس الحيوية"</string>
-    <string name="biometrics_search_terms" msgid="6040319118762671981">"بصمة الإصبع، إصبع، إضافة بصمة إصبع، فتح الجهاز بالتعرف على الوجه، وجه"</string>
+    <string name="biometrics_search_terms" msgid="6040319118762671981">"بصمة الإصبع، إصبع، إضافة بصمة إصبع، فتح الجهاز ببصمة الوجه، وجه"</string>
     <string name="privacy_sources_title" msgid="4061110826457365957">"الخصوصية"</string>
     <string name="privacy_sources_summary" msgid="4089719981155120864">"لوحة البيانات والأذونات وعناصر التحكّم"</string>
     <string name="permission_usage_title" msgid="3633779688945350407">"لوحة بيانات الخصوصية"</string>
@@ -36,7 +36,7 @@
     <string name="privacy_controls_title" msgid="5322875777945432395">"عناصر التحكّم في الخصوصية"</string>
     <string name="privacy_controls_summary" msgid="2402066941190435424">"التحكُّم في وصول الجهاز إلى الميكروفون والكاميرا وغير ذلك"</string>
     <string name="privacy_controls_search_terms" msgid="3774472175934304165">"الخصوصية، عناصر التحكّم في الخصوصية"</string>
-    <string name="advanced_title" msgid="8745436380690561172">"الإعدادات المتقدّمة"</string>
+    <string name="advanced_title" msgid="8745436380690561172">"إعدادات إضافية"</string>
     <string name="advanced_security_title" msgid="1126833338772188155">"المزيد من إعدادات الأمان"</string>
     <string name="advanced_security_summary" msgid="6172253327022425123">"التشفير وبيانات الاعتماد وغير ذلك"</string>
     <string name="advanced_security_search_terms" msgid="3350609555814362075"></string>
diff --git a/SafetyCenter/Resources/res/values-ru-v34/strings.xml b/SafetyCenter/Resources/res/values-ru-v34/strings.xml
index 70b139c91..397ef7b9d 100644
--- a/SafetyCenter/Resources/res/values-ru-v34/strings.xml
+++ b/SafetyCenter/Resources/res/values-ru-v34/strings.xml
@@ -22,7 +22,7 @@
     <string name="privacy_sources_summary" msgid="4083646673569677049">"Разрешения, панель управления, параметры"</string>
     <string name="health_connect_title" msgid="8318152190040327804">"Здоровье и спорт"</string>
     <string name="health_connect_search_terms" msgid="4998970586245680829">"Здоровье, Здоровье и спорт"</string>
-    <string name="app_data_sharing_updates_title" msgid="7428862330643262588">"Обновления в передаче данных о местоположении"</string>
+    <string name="app_data_sharing_updates_title" msgid="7428862330643262588">"Изменения в передаче геоданных"</string>
     <string name="app_data_sharing_updates_search_terms" msgid="8414777373734245398">"Данные, Передача данных, Обновления передачи данных, Обновление доступа к данным, Обновление доступа к данным о местоположении"</string>
     <string name="advanced_title" msgid="6259362998269627310">"Другие настройки"</string>
     <string name="more_settings_title" msgid="9033454654010697185">"Дополнительные настройки защиты и конфиденциальности"</string>
diff --git a/TEST_MAPPING b/TEST_MAPPING
index 524d02af5..823738181 100644
--- a/TEST_MAPPING
+++ b/TEST_MAPPING
@@ -16,12 +16,7 @@
   ],
   "carpermission-postsubmit" : [
     {
-      "name" : "CtsPermissionUiTestCases",
-      "options": [
-        {
-          "include-annotation": "androidx.test.filters.FlakyTest"
-        }
-      ]
+      "name" : "CtsPermissionUiTestCases"
     }
   ],
   "alltests" : [
diff --git a/flags/Android.bp b/flags/Android.bp
index 457aa4f91..aba1e44a9 100644
--- a/flags/Android.bp
+++ b/flags/Android.bp
@@ -33,7 +33,7 @@ java_aconfig_library {
     sdk_version: "module_current",
     min_sdk_version: "30",
     installable: false,
-    libs: ["framework-configinfrastructure"],
+    libs: ["framework-configinfrastructure.stubs.module_lib"],
     visibility: [
         "//packages/modules/Permission:__subpackages__",
     ],
@@ -49,7 +49,7 @@ java_aconfig_library {
     sdk_version: "module_current",
     min_sdk_version: "30",
     installable: false,
-    libs: ["framework-configinfrastructure"],
+    libs: ["framework-configinfrastructure.stubs.module_lib"],
     visibility: [
         "//packages/modules/Permission:__subpackages__",
     ],
diff --git a/flags/flags.aconfig b/flags/flags.aconfig
index a81de8144..c94614654 100644
--- a/flags/flags.aconfig
+++ b/flags/flags.aconfig
@@ -45,3 +45,66 @@ flag {
     bug: "327489942"
     is_fixed_read_only: true
 }
+
+flag {
+    name: "enhanced_confirmation_backport_enabled"
+    is_exported: true
+    namespace: "permissions"
+    description: "Flag to backport enhanced confirmation in permission mainline to T and U."
+    bug: "347876543"
+    is_fixed_read_only: true
+}
+
+flag {
+    name: "enable_coarse_fine_location_prompt_for_aaos"
+    is_exported: true
+    namespace: "permissions"
+    description: "Feature flag to enable downgrading to coarse location on Automotive"
+    bug: "346369736"
+    is_fixed_read_only: true
+}
+
+flag {
+    name: "livedata_refactor_permission_timeline_enabled"
+    is_exported: true
+    namespace: "permissions"
+    description: "This flag is used to enable modern app architecture implementation for timeline page"
+    bug: "354234946"
+    is_fixed_read_only: true
+}
+
+flag {
+    name: "odad_notifications_supported"
+    is_exported: true
+    namespace: "permissions"
+    description: "This flag is used to enable Safety Center notifications support for ODAD"
+    bug: "356910008"
+    is_fixed_read_only: true
+}
+
+flag {
+    name: "safety_center_issue_only_affects_group_status"
+    is_exported: true
+    namespace: "permissions"
+    description: "This flag is used by Safety Center to affect the status light of an entry group when an issue only source pushes a warning"
+    bug: "356910111"
+    is_fixed_read_only: true
+}
+
+flag {
+    name: "safety_center_enabled_no_device_config"
+    is_exported: true
+    namespace: "permissions"
+    description: "This flag disables the usage of DeviceConfig to enable/disable Safety Center on UDC+ (enabled by default instead)"
+    bug: "354670125"
+    is_fixed_read_only: true
+}
+
+flag {
+    name: "app_permission_fragment_uses_preferences"
+    is_exported: true
+    namespace: "permissions"
+    description: "This flag enables AppPermissionFragment rather than LegacyAppPermissionFragment (to support BC25)"
+    bug: "349675008"
+    is_fixed_read_only: true
+}
diff --git a/framework-s/Android.bp b/framework-s/Android.bp
index 547beb3f8..f0a156ae8 100644
--- a/framework-s/Android.bp
+++ b/framework-s/Android.bp
@@ -107,4 +107,7 @@ java_sdk_library {
         "android.permission.flags-aconfig",
         "com.android.permission.flags-aconfig",
     ],
+    lint: {
+        baseline_filename: "lint-baseline-framework-permission-s.xml",
+    },
 }
diff --git a/framework-s/lint-baseline-framework-permission-s.xml b/framework-s/lint-baseline-framework-permission-s.xml
new file mode 100644
index 000000000..053c4ed43
--- /dev/null
+++ b/framework-s/lint-baseline-framework-permission-s.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<issues format="6" by="lint 8.4.0-alpha08" type="baseline" client="" dependencies="true" name="" variant="all" version="8.4.0-alpha08">
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onGetLegacyFallbackDisabledRoles()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `getLegacyFallbackDisabledRoles` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="                    List&lt;String> legacyFallbackDisabledRoles = onGetLegacyFallbackDisabledRoles();"
+        errorLine2="                                                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/framework-s/java/android/app/role/RoleControllerService.java"
+            line="197"
+            column="64"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `onGetLegacyFallbackDisabledRoles()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `getLegacyFallbackDisabledRoles` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="                List&lt;String> legacyFallbackDisabledRoles = onGetLegacyFallbackDisabledRoles();"
+        errorLine2="                                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/framework-s/java/android/app/role/RoleControllerService.java"
+            line="189"
+            column="60"/>
+    </issue>
+
+</issues>
diff --git a/permissions/com.android.permissioncontroller.xml b/permissions/com.android.permissioncontroller.xml
index 60484e24e..0af3644ff 100644
--- a/permissions/com.android.permissioncontroller.xml
+++ b/permissions/com.android.permissioncontroller.xml
@@ -35,5 +35,6 @@
         <permission name="android.permission.START_TASKS_FROM_RECENTS" />
         <permission name="android.permission.LAUNCH_MULTI_PANE_SETTINGS_DEEP_LINK" />
         <permission name="android.permission.READ_SYSTEM_GRAMMATICAL_GENDER" />
+        <permission name="android.permission.WATCH_APPOPS" />
     </privapp-permissions>
 </permissions>
diff --git a/service/Android.bp b/service/Android.bp
index d80fa4f0d..6f851c4d2 100644
--- a/service/Android.bp
+++ b/service/Android.bp
@@ -82,7 +82,7 @@ java_sdk_library {
     ],
     libs: [
         "androidx.annotation_annotation",
-        "framework-configinfrastructure",
+        "framework-configinfrastructure.stubs.module_lib",
         // TODO(b/177884622): Short term solution to prevent service-permission from seeing hidden
         //  APIs in framework-permission, as we don't actually have any dependency in it.
         //"framework-permission",
diff --git a/service/jarjar-rules.txt b/service/jarjar-rules.txt
index 4e7eb1d9a..4d4d6e050 100644
--- a/service/jarjar-rules.txt
+++ b/service/jarjar-rules.txt
@@ -1,3 +1,15 @@
+# You may bypass this Gerrit IfThisThenThat Lint if your change doesn't affect
+# RoleParser.applyJarjarTransform(), by adding NO_IFTTT=reason to your commit
+# message.
+# LINT.IfChange
+rule android.app.appfunctions.flags.*FeatureFlags* com.android.permission.jarjar.@0
+rule android.app.appfunctions.flags.FeatureFlags* com.android.permission.jarjar.@0
+rule android.app.appfunctions.flags.FeatureFlags com.android.permission.jarjar.@0
+rule android.app.appfunctions.flags.Flags com.android.permission.jarjar.@0
+rule android.companion.virtualdevice.flags.*FeatureFlags* com.android.permission.jarjar.@0
+rule android.companion.virtualdevice.flags.FeatureFlags* com.android.permission.jarjar.@0
+rule android.companion.virtualdevice.flags.FeatureFlags com.android.permission.jarjar.@0
+rule android.companion.virtualdevice.flags.Flags com.android.permission.jarjar.@0
 rule android.os.*FeatureFlags* com.android.permission.jarjar.@0
 rule android.os.FeatureFlags* com.android.permission.jarjar.@0
 rule android.os.FeatureFlags com.android.permission.jarjar.@0
@@ -25,3 +37,4 @@ rule com.android.safetycenter.resources.** com.android.permission.jarjar.@0
 rule com.google.protobuf.** com.android.permission.jarjar.@0
 rule kotlin.** com.android.permission.jarjar.@0
 rule com.android.permissioncontroller.PermissionControllerStatsLog com.android.permission.jarjar.@0
+# LINT.ThenChange(PermissionController/role-controller/java/com/android/role/controller/model/RoleParser.java:applyJarjarTransform)
diff --git a/service/java/com/android/ecm/EnhancedConfirmationService.java b/service/java/com/android/ecm/EnhancedConfirmationService.java
index 6e6501234..708884e85 100644
--- a/service/java/com/android/ecm/EnhancedConfirmationService.java
+++ b/service/java/com/android/ecm/EnhancedConfirmationService.java
@@ -348,7 +348,6 @@ public class EnhancedConfirmationService extends SystemService {
 
         private boolean isSettingEcmProtected(@NonNull String settingIdentifier) {
             if (mPackageManager.hasSystemFeature(PackageManager.FEATURE_LEANBACK)
-                    || mPackageManager.hasSystemFeature(PackageManager.FEATURE_WATCH)
                     || mPackageManager.hasSystemFeature(PackageManager.FEATURE_AUTOMOTIVE)) {
                 return false;
             }
diff --git a/service/java/com/android/safetycenter/SafetyCenterDataFactory.java b/service/java/com/android/safetycenter/SafetyCenterDataFactory.java
index 7c7ade3f1..7f4e2e166 100644
--- a/service/java/com/android/safetycenter/SafetyCenterDataFactory.java
+++ b/service/java/com/android/safetycenter/SafetyCenterDataFactory.java
@@ -17,7 +17,6 @@
 package com.android.safetycenter;
 
 import static android.os.Build.VERSION_CODES.UPSIDE_DOWN_CAKE;
-import static android.os.Build.VERSION_CODES.VANILLA_ICE_CREAM;
 
 import static com.android.safetycenter.UserProfileGroup.PROFILE_TYPE_MANAGED;
 import static com.android.safetycenter.UserProfileGroup.PROFILE_TYPE_PRIMARY;
@@ -388,6 +387,8 @@ public final class SafetyCenterDataFactory {
             SafetySourcesGroup safetySourcesGroup,
             String defaultPackageName,
             UserProfileGroup userProfileGroup) {
+        HighestSeverityIssueOnlyIssue highestSeverityIssueOnlyIssue =
+                new HighestSeverityIssueOnlyIssue();
         int groupSafetyCenterEntryLevel = SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNSPECIFIED;
 
         List<SafetySource> safetySources = safetySourcesGroup.getSafetySources();
@@ -415,6 +416,7 @@ public final class SafetyCenterDataFactory {
                                     groupSafetyCenterEntryLevel,
                                     addSafetyCenterEntry(
                                             safetyCenterOverallState,
+                                            highestSeverityIssueOnlyIssue,
                                             entries,
                                             safetySource,
                                             defaultPackageName,
@@ -436,7 +438,10 @@ public final class SafetyCenterDataFactory {
 
         CharSequence groupSummary =
                 getSafetyCenterEntryGroupSummary(
-                        safetySourcesGroup, groupSafetyCenterEntryLevel, entries);
+                        safetySourcesGroup,
+                        groupSafetyCenterEntryLevel,
+                        entries,
+                        highestSeverityIssueOnlyIssue);
         safetyCenterEntryOrGroups.add(
                 new SafetyCenterEntryOrGroup(
                         new SafetyCenterEntryGroup.Builder(
@@ -471,7 +476,8 @@ public final class SafetyCenterDataFactory {
     private CharSequence getSafetyCenterEntryGroupSummary(
             SafetySourcesGroup safetySourcesGroup,
             @SafetyCenterEntry.EntrySeverityLevel int groupSafetyCenterEntryLevel,
-            List<SafetyCenterEntry> entries) {
+            List<SafetyCenterEntry> entries,
+            HighestSeverityIssueOnlyIssue highestSeverityIssueOnlyIssue) {
         switch (groupSafetyCenterEntryLevel) {
             case SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_CRITICAL_WARNING:
             case SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_RECOMMENDATION:
@@ -500,6 +506,16 @@ public final class SafetyCenterDataFactory {
                     }
                 }
 
+                SafetySourceIssue highestSeverityIssueOnlySafetySourceIssue =
+                        highestSeverityIssueOnlyIssue.mSafetySourceIssue;
+                if (highestSeverityIssueOnlySafetySourceIssue != null
+                        && toSafetyCenterEntrySeverityLevel(
+                                        highestSeverityIssueOnlySafetySourceIssue
+                                                .getSeverityLevel())
+                                == groupSafetyCenterEntryLevel) {
+                    return highestSeverityIssueOnlySafetySourceIssue.getTitle();
+                }
+
                 return getDefaultGroupSummary(safetySourcesGroup, entries);
             case SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNSPECIFIED:
                 return getDefaultGroupSummary(safetySourcesGroup, entries);
@@ -554,6 +570,7 @@ public final class SafetyCenterDataFactory {
     @SafetyCenterEntry.EntrySeverityLevel
     private int addSafetyCenterEntry(
             SafetyCenterOverallState safetyCenterOverallState,
+            HighestSeverityIssueOnlyIssue highestSeverityIssueOnlyIssue,
             List<SafetyCenterEntry> entries,
             SafetySource safetySource,
             String defaultPackageName,
@@ -562,13 +579,10 @@ public final class SafetyCenterDataFactory {
             boolean isUserRunning) {
         SafetyCenterEntry safetyCenterEntry =
                 toSafetyCenterEntry(
-                        safetySource,
-                        defaultPackageName,
-                        userId,
-                        profileType,
-                        isUserRunning);
+                        safetySource, defaultPackageName, userId, profileType, isUserRunning);
         if (safetyCenterEntry == null) {
-            return SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNSPECIFIED;
+            return getSafetyCenterEntrySeverityLevelFromIssues(
+                    highestSeverityIssueOnlyIssue, safetySource, userId, isUserRunning);
         }
 
         safetyCenterOverallState.addEntryOverallSeverityLevel(
@@ -579,6 +593,64 @@ public final class SafetyCenterDataFactory {
         return safetyCenterEntry.getSeverityLevel();
     }
 
+    @SafetyCenterEntry.EntrySeverityLevel
+    private int getSafetyCenterEntrySeverityLevelFromIssues(
+            HighestSeverityIssueOnlyIssue highestSeverityIssueOnlyIssue,
+            SafetySource safetySource,
+            @UserIdInt int userId,
+            boolean isUserRunning) {
+        if (!Flags.safetyCenterIssueOnlyAffectsGroupStatus()) {
+            return SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNSPECIFIED;
+        }
+        if (safetySource.getType() != SafetySource.SAFETY_SOURCE_TYPE_ISSUE_ONLY) {
+            return SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNSPECIFIED;
+        }
+        if (!isUserRunning) {
+            // Issues don't show for non-running users.
+            return SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNSPECIFIED;
+        }
+        SafetySourceKey key = SafetySourceKey.of(safetySource.getId(), userId);
+        SafetySourceData safetySourceData =
+                mSafetyCenterDataManager.getSafetySourceDataInternal(key);
+        if (safetySourceData == null) {
+            return SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNSPECIFIED;
+        }
+        List<SafetySourceIssue> safetySourceIssues = safetySourceData.getIssues();
+        int safetyCenterEntrySeverityLevel = SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNSPECIFIED;
+        for (int i = 0; i < safetySourceIssues.size(); i++) {
+            SafetySourceIssue safetySourceIssue = safetySourceIssues.get(i);
+
+            SafetyCenterIssueKey safetyCenterIssueKey =
+                    SafetyCenterIssueKey.newBuilder()
+                            .setSafetySourceId(safetySource.getId())
+                            .setSafetySourceIssueId(safetySourceIssue.getId())
+                            .setUserId(userId)
+                            .build();
+
+            int safetySourceIssueSeverityLevel = safetySourceIssue.getSeverityLevel();
+
+            if (mSafetyCenterDataManager.isIssueDismissed(
+                    safetyCenterIssueKey, safetySourceIssueSeverityLevel)) {
+                continue;
+            }
+
+            SafetySourceIssue highestSeverityIssueOnlySafetySourceIssue =
+                    highestSeverityIssueOnlyIssue.mSafetySourceIssue;
+            if (highestSeverityIssueOnlySafetySourceIssue == null
+                    || safetySourceIssueSeverityLevel
+                            > highestSeverityIssueOnlySafetySourceIssue.getSeverityLevel()) {
+                highestSeverityIssueOnlyIssue.mSafetySourceIssue = safetySourceIssue;
+            }
+
+            safetyCenterEntrySeverityLevel =
+                    mergeSafetyCenterEntrySeverityLevels(
+                            safetyCenterEntrySeverityLevel,
+                            toSafetyCenterEntrySeverityLevel(safetySourceIssueSeverityLevel));
+        }
+
+        return safetyCenterEntrySeverityLevel;
+    }
+
     @Nullable
     private SafetyCenterEntry toSafetyCenterEntry(
             SafetySource safetySource,
@@ -783,11 +855,7 @@ public final class SafetyCenterDataFactory {
             boolean isUserRunning) {
         SafetyCenterStaticEntry staticEntry =
                 toSafetyCenterStaticEntry(
-                        safetySource,
-                        defaultPackageName,
-                        userId,
-                        profileType,
-                        isUserRunning);
+                        safetySource, defaultPackageName, userId, profileType, isUserRunning);
         if (staticEntry == null) {
             return;
         }
@@ -987,7 +1055,7 @@ public final class SafetyCenterDataFactory {
 
         Log.w(
                 TAG,
-                "Unexpected SafetySourceData.SeverityLevel in SafetySourceStatus: "
+                "Unexpected SafetySourceData.SeverityLevel in SafetySourceData: "
                         + safetySourceSeverityLevel);
         return SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_UNKNOWN;
     }
@@ -1155,7 +1223,7 @@ public final class SafetyCenterDataFactory {
                     return getIcuPluralsString(
                             "overall_severity_level_action_taken_summary", numAutomaticIssues);
                 }
-                // Fall through.
+            // Fall through.
             case SafetyCenterStatus.OVERALL_SEVERITY_LEVEL_RECOMMENDATION:
             case SafetyCenterStatus.OVERALL_SEVERITY_LEVEL_CRITICAL_WARNING:
                 return getIcuPluralsString("overall_severity_n_alerts_summary", numIssues);
@@ -1201,7 +1269,7 @@ public final class SafetyCenterDataFactory {
                 if (!overallSeverityUnknown) {
                     return null;
                 }
-                // Fall through.
+            // Fall through.
             case SafetyCenterStatus.REFRESH_STATUS_FULL_RESCAN_IN_PROGRESS:
                 return mSafetyCenterResourcesApk.getStringByName("scanning_title");
         }
@@ -1232,9 +1300,9 @@ public final class SafetyCenterDataFactory {
                 return mSafetyCenterResourcesApk.getString(safetySource.getTitleResId());
             case PROFILE_TYPE_MANAGED:
                 return DevicePolicyResources.getSafetySourceWorkString(
-                    mSafetyCenterResourcesApk,
-                    safetySource.getId(),
-                    safetySource.getTitleForWorkResId());
+                        mSafetyCenterResourcesApk,
+                        safetySource.getId(),
+                        safetySource.getTitleForWorkResId());
             case PROFILE_TYPE_PRIVATE:
                 if (SdkLevel.isAtLeastV() && Flags.privateProfileTitleApi()) {
                     return mSafetyCenterResourcesApk.getString(
@@ -1337,4 +1405,8 @@ public final class SafetyCenterDataFactory {
             return Math.max(left, right);
         }
     }
+
+    private static final class HighestSeverityIssueOnlyIssue {
+        @Nullable private SafetySourceIssue mSafetySourceIssue = null;
+    }
 }
diff --git a/service/java/com/android/safetycenter/SafetyCenterFlags.java b/service/java/com/android/safetycenter/SafetyCenterFlags.java
index e51d3a1cf..4e81280f4 100644
--- a/service/java/com/android/safetycenter/SafetyCenterFlags.java
+++ b/service/java/com/android/safetycenter/SafetyCenterFlags.java
@@ -28,6 +28,7 @@ import android.util.Log;
 import androidx.annotation.Nullable;
 
 import com.android.modules.utils.build.SdkLevel;
+import com.android.permission.flags.Flags;
 import com.android.safetycenter.resources.SafetyCenterResourcesApk;
 
 import java.io.PrintWriter;
@@ -123,6 +124,8 @@ public final class SafetyCenterFlags {
     private static final String RESURFACE_ISSUE_DELAYS_DEFAULT = "";
     private static final Duration RESURFACE_ISSUE_DELAYS_DEFAULT_DURATION = Duration.ofDays(180);
 
+    private static final ArraySet<String> sAllowedNotificationSources =
+            new ArraySet<>(new String[] {"GoogleAppProtectionService"});
     private static final ArraySet<String> sAllowedNotificationSourcesUPlus =
             new ArraySet<>(new String[] {"GoogleBackupAndRestore"});
 
@@ -229,6 +232,9 @@ public final class SafetyCenterFlags {
 
     /** Returns whether Safety Center is enabled. */
     public static boolean getSafetyCenterEnabled() {
+        if (Flags.safetyCenterEnabledNoDeviceConfig() && SdkLevel.isAtLeastU()) {
+            return true;
+        }
         return getBoolean(PROPERTY_SAFETY_CENTER_ENABLED, SdkLevel.isAtLeastU());
     }
 
@@ -251,15 +257,17 @@ public final class SafetyCenterFlags {
      */
     public static ArraySet<String> getNotificationsAllowedSourceIds() {
         ArraySet<String> sources = getNotificationsAllowedSourceIdsFlag();
+        // This is a hack to update the flag value via mainline update. Reasons why we can't do this
+        // via:
+        // remote flag update - these are generally avoided and considered risky
+        // XML config - it would break GTS tests for OEMs that have a separate config copy
+        // default flag value - it would also require a remote flag update
+        if (Flags.odadNotificationsSupported()) {
+            sources.addAll(sAllowedNotificationSources);
+        }
         if (SdkLevel.isAtLeastU()) {
-            // This is a hack to update the flag value via mainline update. Reasons why we can't do
-            // this via:
-            // remote flag update - these are generally avoided and considered risky
-            // XML config - it would break GTS tests for OEMs that have a separate config copy
-            // default flag value - it would also require a remote flag update
             sources.addAll(sAllowedNotificationSourcesUPlus);
         }
-
         return sources;
     }
 
diff --git a/service/java/com/android/safetycenter/SafetyCenterService.java b/service/java/com/android/safetycenter/SafetyCenterService.java
index c9a5e1c03..250be5f25 100644
--- a/service/java/com/android/safetycenter/SafetyCenterService.java
+++ b/service/java/com/android/safetycenter/SafetyCenterService.java
@@ -244,6 +244,9 @@ public final class SafetyCenterService extends SystemService {
 
     @GuardedBy("mApiLock")
     private void registerSafetyCenterEnabledListenerLocked() {
+        if (Flags.safetyCenterEnabledNoDeviceConfig() && SdkLevel.isAtLeastU()) {
+            return;
+        }
         SafetyCenterEnabledListener safetyCenterEnabledListener = new SafetyCenterEnabledListener();
         DeviceConfig.addOnPropertiesChangedListener(
                 DeviceConfig.NAMESPACE_PRIVACY,
@@ -1151,9 +1154,7 @@ public final class SafetyCenterService extends SystemService {
         if (!UserProfileGroup.isSupported(userId, context)) {
             Log.i(
                     TAG,
-                    "Received broadcast for user id: "
-                            + userId
-                            + ", which is an unsupported user");
+                    "Received broadcast for user id: " + userId + ", which is an unsupported user");
             return false;
         }
         if (Intent.ACTION_USER_SWITCHED.equals(action)
@@ -1166,11 +1167,7 @@ public final class SafetyCenterService extends SystemService {
             return false;
         }
         if (isProfileAddedOrAvailable(action) && !UserUtils.isUserExistent(userId, context)) {
-            Log.w(
-                    TAG,
-                    "Received broadcast for user id: "
-                            + userId
-                            + ", which does not exist");
+            Log.w(TAG, "Received broadcast for user id: " + userId + ", which does not exist");
             return false;
         }
         return true;
diff --git a/service/lint-baseline.xml b/service/lint-baseline.xml
index 226175e91..b10928320 100644
--- a/service/lint-baseline.xml
+++ b/service/lint-baseline.xml
@@ -45,4 +45,114 @@
             column="38"/>
     </issue>
 
+    <issue
+        id="FlaggedApi"
+        message="Method `RolesState()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `writeFile` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="            roles = new RolesState(mVersion, packagesHash,"
+        errorLine2="                    ^">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/RoleUserState.java"
+            line="450"
+            column="21"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getFallbackEnabledRoles()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `readFile` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="                fallbackEnabledRoles = roleState.getFallbackEnabledRoles();"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/RoleUserState.java"
+            line="468"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `RolesState()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `parseRoles` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="        return new RolesState(version, packagesHash, roles, fallbackEnabledRoles);"
+        errorLine2="               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/persistence/RolesPersistenceImpl.java"
+            line="167"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getFallbackEnabledRoles()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `serializeRoles` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="        Set&lt;String> fallbackEnabledRoles = roles.getFallbackEnabledRoles();"
+        errorLine2="                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/persistence/RolesPersistenceImpl.java"
+            line="247"
+            column="44"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `RolesState()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `RolesState` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="        this(version, packagesHash, roles, roles.keySet());"
+        errorLine2="        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/persistence/RolesState.java"
+            line="70"
+            column="9"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `RolesState()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `writeFile` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="            roles = new RolesState(mVersion, packagesHash,"
+        errorLine2="                    ^">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/RoleUserState.java"
+            line="450"
+            column="21"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getFallbackEnabledRoles()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `readFile` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="                fallbackEnabledRoles = roleState.getFallbackEnabledRoles();"
+        errorLine2="                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/RoleUserState.java"
+            line="468"
+            column="40"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `RolesState()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `parseRoles` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="        return new RolesState(version, packagesHash, roles, fallbackEnabledRoles);"
+        errorLine2="               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/persistence/RolesPersistenceImpl.java"
+            line="167"
+            column="16"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `getFallbackEnabledRoles()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `serializeRoles` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="        Set&lt;String> fallbackEnabledRoles = roles.getFallbackEnabledRoles();"
+        errorLine2="                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/persistence/RolesPersistenceImpl.java"
+            line="247"
+            column="44"/>
+    </issue>
+
+    <issue
+        id="FlaggedApi"
+        message="Method `RolesState()` is a flagged API and should be inside an `if (Flags.systemServerRoleControllerEnabled())` check (or annotate the surrounding method `RolesState` with `@FlaggedApi(Flags.FLAG_SYSTEM_SERVER_ROLE_CONTROLLER_ENABLED) to transfer requirement to caller`)"
+        errorLine1="        this(version, packagesHash, roles, roles.keySet());"
+        errorLine2="        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="packages/modules/Permission/service/java/com/android/role/persistence/RolesState.java"
+            line="70"
+            column="9"/>
+    </issue>
+
 </issues>
\ No newline at end of file
diff --git a/service/proguard.flags b/service/proguard.flags
index a504239a1..979a7febb 100644
--- a/service/proguard.flags
+++ b/service/proguard.flags
@@ -1,4 +1,9 @@
 # Keep classes that implements RoleBehavior, which are used by reflection.
 -keep class * implements com.android.role.controller.model.RoleBehavior {
     *;
-}
\ No newline at end of file
+}
+
+# Keep Flags classes because they may be referenced by reflection in roles.xml
+-keep class **.Flags {
+    *;
+}
diff --git a/tests/apex/Android.bp b/tests/apex/Android.bp
index 83bf4e252..18f1bea75 100644
--- a/tests/apex/Android.bp
+++ b/tests/apex/Android.bp
@@ -27,6 +27,7 @@ android_test {
     ],
     static_libs: [
         "service-permission.impl",
+        "services.core",
         "androidx.test.rules",
         "androidx.test.ext.junit",
         "androidx.test.ext.truth",
diff --git a/tests/apex/java/com/android/role/RoleUserStateTest.kt b/tests/apex/java/com/android/role/RoleUserStateTest.kt
new file mode 100644
index 000000000..8b0c51174
--- /dev/null
+++ b/tests/apex/java/com/android/role/RoleUserStateTest.kt
@@ -0,0 +1,94 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.role
+
+import android.os.UserHandle
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import com.android.server.role.RoleServicePlatformHelper
+import com.google.common.truth.Truth.assertWithMessage
+import org.junit.Before
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mockito.Mockito.mock
+
+@RunWith(AndroidJUnit4::class)
+class RoleUserStateTest {
+    private var roleServicePlatformHelper = mock(RoleServicePlatformHelper::class.java)
+    private var roleUserStateCallback = mock(RoleUserState.Callback::class.java)
+
+    private val userId = UserHandle.myUserId()
+    private val roleUserState =
+        RoleUserState(userId, roleServicePlatformHelper, roleUserStateCallback, false)
+
+    @Before
+    fun setUp() {
+        setUpRole(ROLE_NAME_1, true)
+        setUpRole(ROLE_NAME_2, false)
+    }
+
+    private fun setUpRole(roleName: String, fallbackEnabled: Boolean) {
+        roleUserState.addRoleName(roleName)
+        roleUserState.setFallbackEnabled(roleName, fallbackEnabled)
+    }
+
+    @Test
+    fun testUpgradeVersion_upgradeNotNeeded_remainsUnchanged() {
+        roleUserState.version = RoleUserState.VERSION_FALLBACK_STATE_MIGRATED
+        val legacyFallbackDisabledRoles = listOf(ROLE_NAME_1, ROLE_NAME_2)
+
+        roleUserState.upgradeVersion(legacyFallbackDisabledRoles)
+
+        assertRoleFallbackState(ROLE_NAME_1, roleUserState.isFallbackEnabled(ROLE_NAME_1), true)
+        assertRoleFallbackState(ROLE_NAME_2, roleUserState.isFallbackEnabled(ROLE_NAME_2), false)
+    }
+
+    @Test
+    fun testUpgradeVersion_upgradeNeeded_disabledFallbackStateMigrated() {
+        roleUserState.version = RoleUserState.VERSION_UNDEFINED
+        val legacyFallbackDisabledRoles = listOf(ROLE_NAME_1, ROLE_NAME_2)
+
+        roleUserState.upgradeVersion(legacyFallbackDisabledRoles)
+
+        assertRoleFallbackState(ROLE_NAME_1, roleUserState.isFallbackEnabled(ROLE_NAME_1), false)
+        assertRoleFallbackState(ROLE_NAME_2, roleUserState.isFallbackEnabled(ROLE_NAME_2), false)
+    }
+
+    @Test
+    fun testUpgradeVersion_upgradeNeeded_enabledFallbackStateMigrated() {
+        roleUserState.version = RoleUserState.VERSION_UNDEFINED
+        val legacyFallbackDisabledRoles = emptyList<String>()
+
+        roleUserState.upgradeVersion(legacyFallbackDisabledRoles)
+
+        assertRoleFallbackState(ROLE_NAME_1, roleUserState.isFallbackEnabled(ROLE_NAME_1), true)
+        assertRoleFallbackState(ROLE_NAME_2, roleUserState.isFallbackEnabled(ROLE_NAME_2), true)
+    }
+
+    private fun assertRoleFallbackState(roleName: String, actual: Boolean, expected: Boolean) {
+        assertWithMessage(
+                "Fallback enabled state for role: $roleName is $actual while" +
+                    " is expected to be $expected"
+            )
+            .that(actual)
+            .isEqualTo(expected)
+    }
+
+    companion object {
+        private const val ROLE_NAME_1 = "ROLE_NAME_1"
+        private const val ROLE_NAME_2 = "ROLE_NAME_2"
+    }
+}
diff --git a/tests/cts/permission/Android.bp b/tests/cts/permission/Android.bp
index 9636ceab6..e4fbb81b6 100644
--- a/tests/cts/permission/Android.bp
+++ b/tests/cts/permission/Android.bp
@@ -67,8 +67,8 @@ android_test {
     ],
     sdk_version: "test_current",
     libs: [
-        "android.test.runner",
-        "android.test.base",
+        "android.test.runner.stubs.test",
+        "android.test.base.stubs.test",
     ],
     data: [
         ":AppThatDefinesUndefinedPermissionGroupElement",
@@ -128,3 +128,41 @@ android_test {
     ],
     per_testcase_directory: true,
 }
+
+test_module_config {
+    name: "CtsPermissionTestCases_Platform",
+    base: "CtsPermissionTestCases",
+    test_suites: ["general-tests"],
+    include_filters: [
+        "android.permission.cts.BackgroundPermissionsTest",
+        "android.permission.cts.PermissionControllerTest",
+        "android.permission.cts.PermissionFlagsTest",
+        "android.permission.cts.RuntimePermissionPresentationInfoTest",
+        "android.permission.cts.SharedUidPermissionsTest",
+        "android.permission.cts.SplitPermissionTest",
+    ],
+}
+
+test_module_config {
+    name: "CtsPermissionTestCases_PermissionController",
+    base: "CtsPermissionTestCases",
+    test_suites: ["general-tests"],
+    include_filters: [
+        "android.permission.cts.BackgroundPermissionsTest",
+        "android.permission.cts.LocationAccessCheckTest",
+        "android.permission.cts.NotificationListenerCheckTest",
+        "android.permission.cts.OneTimePermissionTest",
+        "android.permission.cts.PermissionControllerTest",
+        "android.permission.cts.PlatformPermissionGroupMappingTest",
+    ],
+}
+
+test_module_config {
+    name: "CtsPermissionTestCases_PrivacySources",
+    base: "CtsPermissionTestCases",
+    test_suites: ["general-tests"],
+    include_filters: [
+        "android.permission.cts.AccessibilityPrivacySourceTest",
+        "android.permission.cts.NotificationListenerCheckTest",
+    ],
+}
diff --git a/tests/cts/permission/AndroidTest.xml b/tests/cts/permission/AndroidTest.xml
index 0d012db7d..eae2f9ed2 100644
--- a/tests/cts/permission/AndroidTest.xml
+++ b/tests/cts/permission/AndroidTest.xml
@@ -19,6 +19,7 @@
     <option name="config-descriptor:metadata" key="parameter" value="instant_app" />
     <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
     <option name="config-descriptor:metadata" key="parameter" value="secondary_user"/>
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user_on_secondary_display"/>
     <option name="config-descriptor:metadata" key="token" value="SIM_CARD" />
     <option name="config-descriptor:metadata" key="parameter" value="no_foldable_states" />
     <option name="config-descriptor:metadata" key="mainline-param" value="com.google.android.permission.apex" />
diff --git a/tests/cts/permission/AppThatRequestLocationAndBackgroundPermission31/Android.bp b/tests/cts/permission/AppThatRequestLocationAndBackgroundPermission31/Android.bp
new file mode 100644
index 000000000..c1d88e68e
--- /dev/null
+++ b/tests/cts/permission/AppThatRequestLocationAndBackgroundPermission31/Android.bp
@@ -0,0 +1,34 @@
+//
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+//
+
+package {
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+android_test_helper_app {
+    name: "CtsAppThatRequestsLocationAndBackgroundPermission31",
+    defaults: ["cts_defaults"],
+    sdk_version: "current",
+    min_sdk_version: "31",
+    target_sdk_version: "31",
+    // Tag this module as a cts test artifact
+    test_suites: [
+        "cts",
+        "general-tests",
+        "mts-permission",
+        "mcts-permission",
+    ],
+}
diff --git a/tests/cts/permission/AppThatRequestLocationAndBackgroundPermission31/AndroidManifest.xml b/tests/cts/permission/AppThatRequestLocationAndBackgroundPermission31/AndroidManifest.xml
new file mode 100644
index 000000000..c4cff9b0b
--- /dev/null
+++ b/tests/cts/permission/AppThatRequestLocationAndBackgroundPermission31/AndroidManifest.xml
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ -->
+
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+    package="android.permission.cts.appthatrequestpermission"
+    android:versionCode="3">
+
+    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
+    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
+    <uses-permission android:name="android.permission.ACCESS_BACKGROUND_LOCATION" />
+
+    <application android:label="PermissionRequestApp" />
+</manifest>
+
diff --git a/tests/cts/permission/nativeTests/AndroidTest.xml b/tests/cts/permission/nativeTests/AndroidTest.xml
index f477231ef..b389c1edf 100644
--- a/tests/cts/permission/nativeTests/AndroidTest.xml
+++ b/tests/cts/permission/nativeTests/AndroidTest.xml
@@ -20,6 +20,7 @@
     <option name="config-descriptor:metadata" key="parameter" value="multi_abi" />
     <option name="config-descriptor:metadata" key="parameter" value="no_foldable_states" />
     <option name="config-descriptor:metadata" key="parameter" value="secondary_user" />
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user_on_secondary_display" />
 
     <target_preparer class="com.android.tradefed.targetprep.RootTargetPreparer">
         <option name="force-root" value="false" />
diff --git a/tests/cts/permission/permissionTestUtilLib/src/android/permission/cts/CtsNotificationListenerHelperRule.kt b/tests/cts/permission/permissionTestUtilLib/src/android/permission/cts/CtsNotificationListenerHelperRule.kt
index acdf55ef1..3317f2d4c 100644
--- a/tests/cts/permission/permissionTestUtilLib/src/android/permission/cts/CtsNotificationListenerHelperRule.kt
+++ b/tests/cts/permission/permissionTestUtilLib/src/android/permission/cts/CtsNotificationListenerHelperRule.kt
@@ -28,6 +28,7 @@ class CtsNotificationListenerHelperRule(context: Context) : TestRule {
 
     private val notificationListenerComponentName =
         ComponentName(context, CtsNotificationListenerService::class.java)
+    private val context = context
 
     override fun apply(base: Statement, description: Description): Statement {
         return object : Statement() {
@@ -35,14 +36,20 @@ class CtsNotificationListenerHelperRule(context: Context) : TestRule {
                 try {
                     // Allow NLS used to verify notifications sent
                     SystemUtil.runShellCommand(
-                        ALLOW_NLS_COMMAND + notificationListenerComponentName.flattenToString()
+                        ALLOW_NLS_COMMAND +
+                            notificationListenerComponentName.flattenToString() +
+                            " " +
+                            context.getUserId()
                     )
 
                     base.evaluate()
                 } finally {
                     // Disallow NLS used to verify notifications sent
                     SystemUtil.runShellCommand(
-                        DISALLOW_NLS_COMMAND + notificationListenerComponentName.flattenToString()
+                        DISALLOW_NLS_COMMAND +
+                            notificationListenerComponentName.flattenToString() +
+                            " " +
+                            context.getUserId()
                     )
                 }
             }
diff --git a/tests/cts/permission/permissionTestUtilLib/src/android/permission/cts/PermissionUtils.java b/tests/cts/permission/permissionTestUtilLib/src/android/permission/cts/PermissionUtils.java
index 6bbf8b52e..29e97be51 100644
--- a/tests/cts/permission/permissionTestUtilLib/src/android/permission/cts/PermissionUtils.java
+++ b/tests/cts/permission/permissionTestUtilLib/src/android/permission/cts/PermissionUtils.java
@@ -260,7 +260,7 @@ public class PermissionUtils {
      * @param packageName Package to clear
      */
     public static void clearAppState(@NonNull String packageName) {
-        runShellCommand("pm clear --user current " + packageName);
+        runShellCommand("pm clear --user " + sContext.getUserId() + " " + packageName);
     }
 
     /**
diff --git a/tests/cts/permission/src/android/permission/cts/AccessibilityPrivacySourceTest.kt b/tests/cts/permission/src/android/permission/cts/AccessibilityPrivacySourceTest.kt
index 227fbfb9a..41c0afa07 100644
--- a/tests/cts/permission/src/android/permission/cts/AccessibilityPrivacySourceTest.kt
+++ b/tests/cts/permission/src/android/permission/cts/AccessibilityPrivacySourceTest.kt
@@ -44,12 +44,14 @@ import androidx.test.filters.SdkSuppress
 import androidx.test.platform.app.InstrumentationRegistry
 import androidx.test.runner.AndroidJUnit4
 import com.android.compatibility.common.util.DeviceConfigStateChangerRule
+import com.android.compatibility.common.util.SystemUtil.callWithShellPermissionIdentity
 import com.android.compatibility.common.util.SystemUtil.runShellCommand
 import com.android.compatibility.common.util.SystemUtil.runWithShellPermissionIdentity
 import com.android.modules.utils.build.SdkLevel
 import org.junit.After
 import org.junit.Assert
 import org.junit.Assume
+import org.junit.Assume.assumeFalse
 import org.junit.Before
 import org.junit.ClassRule
 import org.junit.Rule
@@ -215,6 +217,13 @@ class AccessibilityPrivacySourceTest {
     @Test
     fun testJobWithSafetyCenterDisabledDoesNotSendNotification() {
         setDeviceConfigPrivacyProperty(SAFETY_CENTER_ENABLED, false.toString())
+        // Safety Center cannot be disabled at runtime on UDC+.
+        assumeFalse(
+            "Safety Center cannot be disabled",
+            callWithShellPermissionIdentity {
+                safetyCenterManager?.isSafetyCenterEnabled() ?: false
+            }
+        )
         mAccessibilityServiceRule.enableService()
         runJobAndWaitUntilCompleted()
         assertEmptyNotification(permissionControllerPackage, ACCESSIBILITY_NOTIFICATION_ID)
@@ -223,6 +232,13 @@ class AccessibilityPrivacySourceTest {
     @Test
     fun testJobWithSafetyCenterDisabledDoesNotSendIssueToSafetyCenter() {
         setDeviceConfigPrivacyProperty(SAFETY_CENTER_ENABLED, false.toString())
+        // Safety Center cannot be disabled at runtime on UDC+.
+        assumeFalse(
+            "Safety Center cannot be disabled",
+            callWithShellPermissionIdentity {
+                safetyCenterManager?.isSafetyCenterEnabled() ?: false
+            }
+        )
         mAccessibilityServiceRule.enableService()
         runJobAndWaitUntilCompleted()
         assertSafetyCenterIssueDoesNotExist(
diff --git a/tests/cts/permission/src/android/permission/cts/DevicePermissionsTest.kt b/tests/cts/permission/src/android/permission/cts/DevicePermissionsTest.kt
index 516b0a05e..dbda1f5e1 100644
--- a/tests/cts/permission/src/android/permission/cts/DevicePermissionsTest.kt
+++ b/tests/cts/permission/src/android/permission/cts/DevicePermissionsTest.kt
@@ -103,7 +103,9 @@ class DevicePermissionsTest {
     @After
     fun cleanup() {
         runShellCommandOrThrow("pm uninstall $TEST_PACKAGE_NAME")
-        virtualDevice.close()
+        if (this::virtualDevice.isInitialized) {
+            virtualDevice.close()
+        }
     }
 
     @RequiresFlagsEnabled(
diff --git a/tests/cts/permission/src/android/permission/cts/FileSystemPermissionTest.java b/tests/cts/permission/src/android/permission/cts/FileSystemPermissionTest.java
index 94557464f..41b0bf97e 100644
--- a/tests/cts/permission/src/android/permission/cts/FileSystemPermissionTest.java
+++ b/tests/cts/permission/src/android/permission/cts/FileSystemPermissionTest.java
@@ -287,42 +287,6 @@ public class FileSystemPermissionTest {
         assertFileOwnedByGroup(f, "nfc");
     }
 
-    @MediumTest
-    @Test
-    public void testDevQtaguidSane() throws Exception {
-        File f = new File("/dev/xt_qtaguid");
-        assertFalse(f.canRead());
-        assertFalse(f.canWrite());
-        assertFalse(f.canExecute());
-
-        assertFileOwnedBy(f, "root");
-        assertFileOwnedByGroup(f, "root");
-    }
-
-    @MediumTest
-    @Test
-    public void testProcQtaguidCtrlSane() throws Exception {
-        File f = new File("/proc/net/xt_qtaguid/ctrl");
-        assertFalse(f.canRead());
-        assertFalse(f.canWrite());
-        assertFalse(f.canExecute());
-
-        assertFileOwnedBy(f, "root");
-        assertFileOwnedByGroup(f, "net_bw_acct");
-    }
-
-    @MediumTest
-    @Test
-    public void testProcQtaguidStatsSane() throws Exception {
-        File f = new File("/proc/net/xt_qtaguid/stats");
-        assertFalse(f.canRead());
-        assertFalse(f.canWrite());
-        assertFalse(f.canExecute());
-
-        assertFileOwnedBy(f, "root");
-        assertFileOwnedByGroup(f, "net_bw_stats");
-    }
-
     private static List<String> procNetFiles = Arrays.asList("anycast6", "arp", "arp_tables_matches",
             "arp_tables_names", "arp_tables_targets", "dev", "dev_mcast", "fib_trie", "fib_triestat",
             "hci", "icmp", "icmp6", "if_inet6", "igmp", "igmp6", "ip6_flowlabel",
diff --git a/tests/cts/permission/src/android/permission/cts/LocationAccessCheckTest.java b/tests/cts/permission/src/android/permission/cts/LocationAccessCheckTest.java
index 2bb2ed4c7..166a5dbd1 100644
--- a/tests/cts/permission/src/android/permission/cts/LocationAccessCheckTest.java
+++ b/tests/cts/permission/src/android/permission/cts/LocationAccessCheckTest.java
@@ -193,12 +193,15 @@ public class LocationAccessCheckTest {
                     PROPERTY_LOCATION_ACCESS_CHECK_DELAY_MILLIS,
                     "50");
 
+    @Rule
+    public CtsNotificationListenerHelperRule ctsNotificationListenerHelper =
+            new CtsNotificationListenerHelperRule(sContext);
+
     private static boolean sWasLocationEnabled = true;
 
     @BeforeClass
     public static void beforeClassSetup() throws Exception {
         reduceDelays();
-        allowNotificationAccess();
         installBackgroundAccessApp();
         runWithShellPermissionIdentity(() -> {
             sWasLocationEnabled = sLocationManager.isLocationEnabled();
@@ -225,7 +228,6 @@ public class LocationAccessCheckTest {
     public static void cleanupAfterClass() throws Throwable {
         resetDelays();
         uninstallTestApp();
-        disallowNotificationAccess();
         runWithShellPermissionIdentity(() -> {
             if (!sWasLocationEnabled) {
                 sLocationManager.setLocationEnabledForUser(false, Process.myUserHandle());
@@ -400,14 +402,6 @@ public class LocationAccessCheckTest {
         sUiAutomation.grantRuntimePermission(TEST_APP_PKG, permission);
     }
 
-    /**
-     * Register {@link CtsNotificationListenerService}.
-     */
-    public static void allowNotificationAccess() {
-        runShellCommand("cmd notification allow_listener " + (new ComponentName(sContext,
-                CtsNotificationListenerService.class).flattenToString()));
-    }
-
     public static void installBackgroundAccessApp() throws Exception {
         String output =
                 runShellCommandOrThrow("pm install -r -g " + TEST_APP_LOCATION_BG_ACCESS_APK);
@@ -546,14 +540,6 @@ public class LocationAccessCheckTest {
                 ACTION_SET_UP_LOCATION_ACCESS_CHECK, LocationAccessCheckOnBootReceiver);
     }
 
-    /**
-     * Unregister {@link CtsNotificationListenerService}.
-     */
-    public static void disallowNotificationAccess() {
-        runShellCommand("cmd notification disallow_listener " + (new ComponentName(sContext,
-                CtsNotificationListenerService.class)).flattenToString());
-    }
-
     @After
     public void cleanupAfterEachTest() throws Throwable {
         resetPrivacyConfig();
diff --git a/tests/cts/permission/src/android/permission/cts/OneTimePermissionTest.java b/tests/cts/permission/src/android/permission/cts/OneTimePermissionTest.java
index f5f222f80..2692c6e7c 100644
--- a/tests/cts/permission/src/android/permission/cts/OneTimePermissionTest.java
+++ b/tests/cts/permission/src/android/permission/cts/OneTimePermissionTest.java
@@ -295,7 +295,6 @@ public class OneTimePermissionTest {
             new Thread(() -> {
                 while (!hasExited[0]) {
                     DreamManager mDreamManager = mContext.getSystemService(DreamManager.class);
-                    mUiDevice.pressHome();
                     mUiDevice.pressBack();
                     runWithShellPermissionIdentity(() -> {
                         if (mDreamManager.isDreaming()) {
diff --git a/tests/cts/permission/src/android/permission/cts/PermissionUpdateListenerTest.java b/tests/cts/permission/src/android/permission/cts/PermissionUpdateListenerTest.java
index 33975f91c..e9e71af20 100644
--- a/tests/cts/permission/src/android/permission/cts/PermissionUpdateListenerTest.java
+++ b/tests/cts/permission/src/android/permission/cts/PermissionUpdateListenerTest.java
@@ -22,6 +22,8 @@ import static com.android.compatibility.common.util.SystemUtil.runWithShellPermi
 
 import static com.google.common.truth.Truth.assertThat;
 
+import static org.junit.Assume.assumeNotNull;
+
 import android.companion.virtual.VirtualDeviceManager;
 import android.companion.virtual.VirtualDeviceParams;
 import android.content.Context;
@@ -125,6 +127,7 @@ public class PermissionUpdateListenerTest {
     @RequiresFlagsEnabled({Flags.FLAG_DEVICE_AWARE_PERMISSION_APIS_ENABLED,
             Flags.FLAG_DEVICE_AWARE_PERMISSIONS_ENABLED})
     public void testVirtualDeviceGrantPermissionNotifyListener() throws InterruptedException {
+        assumeNotNull(mVirtualDeviceManager);
         VirtualDeviceManager.VirtualDevice virtualDevice =
                 mVirtualDeviceManager.createVirtualDevice(
                         mFakeAssociationRule.getAssociationInfo().getId(),
@@ -169,6 +172,7 @@ public class PermissionUpdateListenerTest {
     @RequiresFlagsEnabled({Flags.FLAG_DEVICE_AWARE_PERMISSION_APIS_ENABLED,
             Flags.FLAG_DEVICE_AWARE_PERMISSIONS_ENABLED})
     public void testVirtualDeviceRevokePermissionNotifyListener() throws InterruptedException {
+        assumeNotNull(mVirtualDeviceManager);
         VirtualDeviceManager.VirtualDevice virtualDevice =
                 mVirtualDeviceManager.createVirtualDevice(
                         mFakeAssociationRule.getAssociationInfo().getId(),
@@ -209,6 +213,7 @@ public class PermissionUpdateListenerTest {
     @RequiresFlagsEnabled({Flags.FLAG_DEVICE_AWARE_PERMISSION_APIS_ENABLED,
             Flags.FLAG_DEVICE_AWARE_PERMISSIONS_ENABLED})
     public void testVirtualDeviceUpdatePermissionFlagsNotifyListener() throws InterruptedException {
+        assumeNotNull(mVirtualDeviceManager);
         VirtualDeviceManager.VirtualDevice virtualDevice =
                 mVirtualDeviceManager.createVirtualDevice(
                         mFakeAssociationRule.getAssociationInfo().getId(),
diff --git a/tests/cts/permission/src/android/permission/cts/RecordSensitiveContentPermissionTest.kt b/tests/cts/permission/src/android/permission/cts/RecordSensitiveContentPermissionTest.kt
index b80f89938..d4c0fedfb 100644
--- a/tests/cts/permission/src/android/permission/cts/RecordSensitiveContentPermissionTest.kt
+++ b/tests/cts/permission/src/android/permission/cts/RecordSensitiveContentPermissionTest.kt
@@ -16,6 +16,7 @@
 
 package android.permission.cts
 
+import android.content.pm.PackageInfo
 import android.os.Build
 import android.permission.flags.Flags.FLAG_SENSITIVE_NOTIFICATION_APP_PROTECTION
 import android.platform.test.annotations.AppModeFull
@@ -42,20 +43,20 @@ class RecordSensitiveContentPermissionTest {
     @RequiresFlagsEnabled(FLAG_SENSITIVE_NOTIFICATION_APP_PROTECTION)
     fun testRecordSensitiveContentDuringProjection() {
         val packageManager = InstrumentationRegistry.getContext().getPackageManager()
-        val packagesHoldingPermission =
-            packageManager
-                .getPackagesHoldingPermissions(
-                    arrayOf(android.Manifest.permission.RECORD_SENSITIVE_CONTENT),
-                    0
-                )
-                .map { it.packageName }
+        val packagesInfoList: List<PackageInfo> =
+            packageManager.getPackagesHoldingPermissions(
+                arrayOf(android.Manifest.permission.RECORD_SENSITIVE_CONTENT),
+                0
+            )
+        val uidHoldingPermission: Set<Int> =
+            packagesInfoList.mapNotNullTo(mutableSetOf()) { it.applicationInfo?.uid }
 
-        if (packagesHoldingPermission.size > 1) {
+        if (uidHoldingPermission.size > 1) {
             Assert.fail(
                 "Only one system app on the device is allowed to hold the " +
-                    "RECORD_SENSITIVE_CONTENT_DURING_PROJECTION permission, " +
+                    "RECORD_SENSITIVE_CONTENT permission, " +
                     "packages holding the permissions are: " +
-                    packagesHoldingPermission
+                    packagesInfoList.map { it.packageName }
             )
         }
     }
diff --git a/tests/cts/permission/src/android/permission/cts/RevokeSelfPermissionTest.java b/tests/cts/permission/src/android/permission/cts/RevokeSelfPermissionTest.java
index 674fa2d12..2f066c224 100644
--- a/tests/cts/permission/src/android/permission/cts/RevokeSelfPermissionTest.java
+++ b/tests/cts/permission/src/android/permission/cts/RevokeSelfPermissionTest.java
@@ -245,7 +245,7 @@ public class RevokeSelfPermissionTest {
 
 
     private void installApp() {
-        runShellCommandOrThrow("pm install -r " + APK);
+        runShellCommandOrThrow("pm install -r --user " + mContext.getUserId() + " " + APK);
     }
 
     private void keepAppInForeground(long timeoutMillis) {
@@ -272,7 +272,9 @@ public class RevokeSelfPermissionTest {
         try {
             new Thread(() -> {
                 while (!hasExited[0]) {
-                    mUiDevice.pressHome();
+                    // Launch Home
+                    SystemUtil.runShellCommand("am start -a android.intent.action.MAIN -c android"
+                            + ".intent.category.HOME --user " + mContext.getUserId());
                     mUiDevice.pressBack();
                     try {
                         Thread.sleep(1000);
@@ -301,8 +303,10 @@ public class RevokeSelfPermissionTest {
     }
 
     private void revokePermissions(String[] permissions) {
-        runShellCommand("am start-activity -W -n " + APP_PKG_NAME  + "/.RevokePermission"
-                + " --esa permissions " + String.join(",", permissions));
+        runShellCommand(
+                "am start-activity " + "--user " + mContext.getUserId() + " -W -n " + APP_PKG_NAME
+                        + "/.RevokePermission" + " --esa permissions " + String.join(",",
+                        permissions));
         PackageManager pkgMgr = mContext.getPackageManager();
         eventually(() -> runWithShellPermissionIdentity(() -> {
             for (int i = 0; i < permissions.length; i++) {
diff --git a/tests/cts/permission/src/android/permission/cts/SafetyCenterUtils.kt b/tests/cts/permission/src/android/permission/cts/SafetyCenterUtils.kt
index 7ca9b138d..c5bdf606d 100644
--- a/tests/cts/permission/src/android/permission/cts/SafetyCenterUtils.kt
+++ b/tests/cts/permission/src/android/permission/cts/SafetyCenterUtils.kt
@@ -29,12 +29,14 @@ import android.safetycenter.SafetyCenterManager
 import androidx.annotation.RequiresApi
 import androidx.test.platform.app.InstrumentationRegistry
 import androidx.test.uiautomator.By
+import com.android.compatibility.common.util.SystemUtil.callWithShellPermissionIdentity
 import com.android.compatibility.common.util.SystemUtil.runWithShellPermissionIdentity
 import com.android.compatibility.common.util.UiAutomatorUtils2.waitFindObject
 import com.android.safetycenter.internaldata.SafetyCenterIds
 import com.android.safetycenter.internaldata.SafetyCenterIssueId
 import com.android.safetycenter.internaldata.SafetyCenterIssueKey
 import org.junit.Assert
+import org.junit.Assume.assumeTrue
 
 object SafetyCenterUtils {
     /** Name of the flag that determines whether SafetyCenter is enabled. */
@@ -54,6 +56,14 @@ object SafetyCenterUtils {
     @JvmStatic
     fun setSafetyCenterEnabled(enabled: Boolean) {
         setDeviceConfigPrivacyProperty(PROPERTY_SAFETY_CENTER_ENABLED, enabled.toString())
+        val safetyCenterManager =
+            instrumentation.targetContext.getSystemService(SafetyCenterManager::class.java)
+        assumeTrue(
+            "Cannot toggle Safety Center",
+            callWithShellPermissionIdentity {
+                safetyCenterManager?.isSafetyCenterEnabled ?: false
+            } == enabled
+        )
     }
 
     @RequiresApi(Build.VERSION_CODES.TIRAMISU)
diff --git a/tests/cts/permissionmultidevice/src/android/permissionmultidevice/cts/AppPermissionsTest.kt b/tests/cts/permissionmultidevice/src/android/permissionmultidevice/cts/AppPermissionsTest.kt
index 7ecc51ded..4d166939a 100644
--- a/tests/cts/permissionmultidevice/src/android/permissionmultidevice/cts/AppPermissionsTest.kt
+++ b/tests/cts/permissionmultidevice/src/android/permissionmultidevice/cts/AppPermissionsTest.kt
@@ -320,8 +320,7 @@ class AppPermissionsTest {
     }
 
     private fun verifyPermissionMessage() {
-        val actualText = UiAutomatorUtils2.waitFindObject(By.res(PERMISSION_MESSAGE_ID)).text
-        assertEquals(permissionMessage, actualText)
+        UiAutomatorUtils2.waitFindObject(By.text(permissionMessage))
     }
 
     private fun getGrantInfoMap(): Map<String, List<String>> {
@@ -441,8 +440,6 @@ class AppPermissionsTest {
             "com.android.permissioncontroller:id/deny_radio_button"
         private const val TITLE = "android:id/title"
         private const val RECYCLER_VIEW = "com.android.permissioncontroller:id/recycler_view"
-        private const val PERMISSION_MESSAGE_ID =
-            "com.android.permissioncontroller:id/permission_message"
         private const val NEW_WINDOW_TIMEOUT_MILLIS: Long = 20_000
     }
 }
diff --git a/tests/cts/permissionmultidevice/src/android/permissionmultidevice/cts/DeviceAwarePermissionGrantTest.kt b/tests/cts/permissionmultidevice/src/android/permissionmultidevice/cts/DeviceAwarePermissionGrantTest.kt
index c7f23377a..f0a0e3fc1 100644
--- a/tests/cts/permissionmultidevice/src/android/permissionmultidevice/cts/DeviceAwarePermissionGrantTest.kt
+++ b/tests/cts/permissionmultidevice/src/android/permissionmultidevice/cts/DeviceAwarePermissionGrantTest.kt
@@ -88,7 +88,7 @@ class DeviceAwarePermissionGrantTest {
                     .build()
             )
 
-        val displayConfig =
+        val displayConfigBuilder =
             VirtualDeviceRule.createDefaultVirtualDisplayConfigBuilder(
                     DISPLAY_WIDTH,
                     DISPLAY_HEIGHT
@@ -98,10 +98,9 @@ class DeviceAwarePermissionGrantTest {
                         DisplayManager.VIRTUAL_DISPLAY_FLAG_TRUSTED or
                         DisplayManager.VIRTUAL_DISPLAY_FLAG_OWN_CONTENT_ONLY
                 )
-                .build()
 
         virtualDisplay =
-            virtualDeviceRule.createManagedVirtualDisplay(virtualDevice, displayConfig)!!
+            virtualDeviceRule.createManagedVirtualDisplay(virtualDevice, displayConfigBuilder)!!
         deviceDisplayName =
             virtualDeviceManager.getVirtualDevice(virtualDevice.deviceId)!!.displayName.toString()
     }
diff --git a/tests/cts/permissionpolicy/Android.bp b/tests/cts/permissionpolicy/Android.bp
index 8f3c42b0e..e6041eea2 100644
--- a/tests/cts/permissionpolicy/Android.bp
+++ b/tests/cts/permissionpolicy/Android.bp
@@ -26,7 +26,7 @@ android_test {
         "cts",
         "general-tests",
     ],
-    libs: ["android.test.base"],
+    libs: ["android.test.base.stubs.test"],
     static_libs: [
         "androidx.test.core",
         "compatibility-device-util-axt",
@@ -64,4 +64,10 @@ android_test {
         ":CtsSMSNotRestrictedWithSharedUid",
         ":CtsProcessOutgoingCalls",
     ],
+    lint: {
+        extra_check_modules: [
+            "PermissionPolicyLintChecker",
+        ],
+        baseline_filename: "lint-baseline.xml",
+    },
 }
diff --git a/tests/cts/permissionpolicy/AndroidTest.xml b/tests/cts/permissionpolicy/AndroidTest.xml
index 8a5609ab9..47efacd7c 100644
--- a/tests/cts/permissionpolicy/AndroidTest.xml
+++ b/tests/cts/permissionpolicy/AndroidTest.xml
@@ -23,6 +23,7 @@
     <option name="config-descriptor:metadata" key="parameter" value="no_foldable_states" />
     <option name="config-descriptor:metadata" key="parameter" value="not_multi_abi" />
     <option name="config-descriptor:metadata" key="parameter" value="secondary_user"/>
+    <option name="config-descriptor:metadata" key="parameter" value="secondary_user_on_secondary_display"/>
     <option name="config-descriptor:metadata" key="parameter" value="run_on_sdk_sandbox" />
     <option name="config-descriptor:metadata" key="token" value="SIM_CARD" />
 
@@ -44,7 +45,7 @@
     <!-- Create place to store apks -->
     <target_preparer class="com.android.tradefed.targetprep.RunCommandTargetPreparer">
         <option name="run-command" value="mkdir -p /data/local/tmp/cts-permissionpolicy" />
-        <option name="teardown-command" value="rm -rf /data/local/tmp/cts-permissionpolicy-permissionpolicy"/>
+        <option name="teardown-command" value="rm -rf /data/local/tmp/cts-permissionpolicy"/>
     </target_preparer>
 
     <target_preparer class="com.android.compatibility.common.tradefed.targetprep.FilePusher">
diff --git a/tests/cts/permissionpolicy/lint-baseline.xml b/tests/cts/permissionpolicy/lint-baseline.xml
new file mode 100644
index 000000000..57014585b
--- /dev/null
+++ b/tests/cts/permissionpolicy/lint-baseline.xml
@@ -0,0 +1,12199 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<issues format="6" by="lint 8.4.0-alpha08" type="baseline" client="" dependencies="true" name="" variant="all" version="8.4.0-alpha08">
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_CONTACTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_CONTACTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="871"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_CONTACTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_CONTACTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="881"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_DEFAULT_ACCOUNT_FOR_CONTACTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_DEFAULT_ACCOUNT_FOR_CONTACTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="907"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_CALENDAR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_CALENDAR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="925"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_CALENDAR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_CALENDAR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="934"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_MESSAGES_ON_ICC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_MESSAGES_ON_ICC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="947"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SEND_SMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SEND_SMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="964"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_SMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_SMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="978"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_SMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_SMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="992"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_WAP_PUSH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_WAP_PUSH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1006"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_MMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_MMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1020"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CELL_BROADCAST_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CELL_BROADCAST_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1034"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_CELL_BROADCASTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_CELL_BROADCASTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1056"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SATELLITE_COMMUNICATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SATELLITE_COMMUNICATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1065"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_EXTERNAL_STORAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1124"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_MEDIA_AUDIO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_MEDIA_AUDIO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1148"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_MEDIA_VIDEO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_MEDIA_VIDEO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1171"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_MEDIA_IMAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_MEDIA_IMAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1186"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_MEDIA_VISUAL_USER_SELECTED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_MEDIA_VISUAL_USER_SELECTED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1206"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_EXTERNAL_STORAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1244"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_MEDIA_LOCATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_MEDIA_LOCATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1254"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_OBB isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_OBB&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1262"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_EXTERNAL_STORAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_EXTERNAL_STORAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1268"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_MEDIA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_MEDIA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1286"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_FINE_LOCATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_FINE_LOCATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1305"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_COARSE_LOCATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1316"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_BACKGROUND_LOCATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_BACKGROUND_LOCATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1333"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LOCATION_BYPASS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LOCATION_BYPASS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1346"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_IMS_CALL_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_IMS_CALL_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1366"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PERFORM_IMS_SINGLE_REGISTRATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PERFORM_IMS_SINGLE_REGISTRATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1376"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_CALL_LOG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_CALL_LOG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1395"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_CALL_LOG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_CALL_LOG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1418"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PROCESS_OUTGOING_CALLS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PROCESS_OUTGOING_CALLS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1437"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PHONE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PHONE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1469"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_BASIC_PHONE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_BASIC_PHONE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1477"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PHONE_NUMBERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PHONE_NUMBERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1486"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CALL_PHONE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CALL_PHONE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1498"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_SIP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_SIP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1517"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ANSWER_PHONE_CALLS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ANSWER_PHONE_CALLS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1526"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_OWN_CALLS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_OWN_CALLS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1538"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CALL_COMPANION_APP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CALL_COMPANION_APP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1550"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.EXEMPT_FROM_AUDIO_RECORD_RESTRICTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.EXEMPT_FROM_AUDIO_RECORD_RESTRICTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1560"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCEPT_HANDOVER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCEPT_HANDOVER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1576"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECORD_AUDIO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECORD_AUDIO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1599"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECORD_BACKGROUND_AUDIO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECORD_BACKGROUND_AUDIO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1610"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACTIVITY_RECOGNITION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACTIVITY_RECOGNITION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1631"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_UCE_PRESENCE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_UCE_PRESENCE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1646"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_UCE_OPTIONS_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_UCE_OPTIONS_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1655"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAMERA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAMERA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1683"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BACKGROUND_CAMERA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BACKGROUND_CAMERA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1702"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SYSTEM_CAMERA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SYSTEM_CAMERA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1712"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAMERA_OPEN_CLOSE_LISTENER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAMERA_OPEN_CLOSE_LISTENER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1721"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAMERA_PRIVACY_ALLOWLIST isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAMERA_PRIVACY_ALLOWLIST&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1745"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.HIGH_SAMPLING_RATE_SENSORS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.HIGH_SAMPLING_RATE_SENSORS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1764"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BODY_SENSORS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BODY_SENSORS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1773"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BODY_SENSORS_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BODY_SENSORS_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1790"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_FINGERPRINT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_FINGERPRINT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1802"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_BIOMETRIC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_BIOMETRIC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1811"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.POST_NOTIFICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.POST_NOTIFICATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1833"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PROFILE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PROFILE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1845"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_PROFILE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_PROFILE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1850"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_SOCIAL_STREAM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_SOCIAL_STREAM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1855"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_SOCIAL_STREAM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_SOCIAL_STREAM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1860"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_USER_DICTIONARY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_USER_DICTIONARY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1865"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_USER_DICTIONARY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_USER_DICTIONARY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1870"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_SMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_SMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1875"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.AUTHENTICATE_ACCOUNTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.AUTHENTICATE_ACCOUNTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1890"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ACCOUNTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ACCOUNTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1895"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_CREDENTIALS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_CREDENTIALS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1900"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUBSCRIBED_FEEDS_READ isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUBSCRIBED_FEEDS_READ&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1905"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUBSCRIBED_FEEDS_WRITE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUBSCRIBED_FEEDS_WRITE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1910"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FLASHLIGHT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FLASHLIGHT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1915"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SEND_RESPOND_VIA_MESSAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SEND_RESPOND_VIA_MESSAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1931"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SEND_SMS_NO_CONFIRMATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SEND_SMS_NO_CONFIRMATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1937"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CARRIER_FILTER_SMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CARRIER_FILTER_SMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1942"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_EMERGENCY_BROADCAST isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_EMERGENCY_BROADCAST&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1949"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_BLUETOOTH_MAP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_BLUETOOTH_MAP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1955"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_DIRECTORY_SEARCH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_DIRECTORY_SEARCH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1961"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_CELL_BROADCASTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_CELL_BROADCASTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="1967"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_LOCATION_EXTRA_COMMANDS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2008"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_LOCATION_PROVIDER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_LOCATION_PROVIDER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2015"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_LOCATION_TIME_ZONE_PROVIDER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_LOCATION_TIME_ZONE_PROVIDER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2024"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TIME_ZONE_PROVIDER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TIME_ZONE_PROVIDER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2035"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.HDMI_CEC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.HDMI_CEC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2041"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LOCATION_HARDWARE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LOCATION_HARDWARE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2047"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_CONTEXT_HUB isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_CONTEXT_HUB&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2055"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_MOCK_LOCATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_MOCK_LOCATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2063"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_AUTOMOTIVE_GNSS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_AUTOMOTIVE_GNSS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2071"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INTERNET isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INTERNET&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2082"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_NETWORK_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2090"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_WIFI_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_WIFI_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2098"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_WIFI_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_WIFI_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2106"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_WIFI_NETWORK_SELECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_WIFI_NETWORK_SELECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2116"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_WIFI_INTERFACES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_WIFI_INTERFACES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2124"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_IPSEC_TUNNELS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_IPSEC_TUNNELS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2132"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_TEST_NETWORKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_TEST_NETWORKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2139"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_REMOTE_AUTH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_REMOTE_AUTH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2144"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_REMOTE_AUTH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_REMOTE_AUTH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2149"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_WIFI_CREDENTIAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_WIFI_CREDENTIAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2154"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TETHER_PRIVILEGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TETHER_PRIVILEGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2160"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_WIFI_CREDENTIAL_CHANGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_WIFI_CREDENTIAL_CHANGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2166"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OVERRIDE_WIFI_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OVERRIDE_WIFI_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2173"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SCORE_NETWORKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SCORE_NETWORKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2178"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_NETWORK_SCORES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_NETWORK_SCORES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2185"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESTART_WIFI_SUBSYSTEM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESTART_WIFI_SUBSYSTEM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2191"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_AIRPLANE_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_AIRPLANE_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2197"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_STACK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_STACK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2205"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OBSERVE_NETWORK_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OBSERVE_NETWORK_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2209"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_FACTORY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_FACTORY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2213"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_STATS_PROVIDER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_STATS_PROVIDER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2217"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2225"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RADIO_SCAN_WITHOUT_LOCATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RADIO_SCAN_WITHOUT_LOCATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2234"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_SETUP_WIZARD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_SETUP_WIZARD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2242"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_MANAGED_PROVISIONING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_MANAGED_PROVISIONING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2250"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_CARRIER_PROVISIONING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_CARRIER_PROVISIONING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2258"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_LOWPAN_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_LOWPAN_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2263"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_LOWPAN_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_LOWPAN_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2268"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_LOWPAN_CREDENTIAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_LOWPAN_CREDENTIAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2273"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_LOWPAN_INTERFACES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_LOWPAN_INTERFACES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2279"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.THREAD_NETWORK_PRIVILEGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.THREAD_NETWORK_PRIVILEGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2286"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.THREAD_NETWORK_TESTING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.THREAD_NETWORK_TESTING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2291"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_BYPASS_PRIVATE_DNS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_BYPASS_PRIVATE_DNS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2297"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WIFI_SET_DEVICE_MOBILITY_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WIFI_SET_DEVICE_MOBILITY_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2303"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WIFI_UPDATE_USABILITY_STATS_SCORE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WIFI_UPDATE_USABILITY_STATS_SCORE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2308"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WIFI_UPDATE_COEX_UNSAFE_CHANNELS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WIFI_UPDATE_COEX_UNSAFE_CHANNELS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2313"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WIFI_ACCESS_COEX_UNSAFE_CHANNELS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WIFI_ACCESS_COEX_UNSAFE_CHANNELS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2318"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_WIFI_COUNTRY_CODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_WIFI_COUNTRY_CODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2323"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_OEM_PAID_NETWORK_PREFERENCE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_OEM_PAID_NETWORK_PREFERENCE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2329"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ETHERNET_NETWORKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ETHERNET_NETWORKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2334"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BLUETOOTH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BLUETOOTH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2355"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BLUETOOTH_SCAN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BLUETOOTH_SCAN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2362"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BLUETOOTH_CONNECT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BLUETOOTH_CONNECT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2370"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BLUETOOTH_ADVERTISE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BLUETOOTH_ADVERTISE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2378"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UWB_RANGING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UWB_RANGING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2386"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NEARBY_WIFI_DEVICES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NEARBY_WIFI_DEVICES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2394"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUSPEND_APPS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUSPEND_APPS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2404"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BLUETOOTH_ADMIN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BLUETOOTH_ADMIN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2420"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BLUETOOTH_PRIVILEGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BLUETOOTH_PRIVILEGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2428"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BLUETOOTH_MAP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BLUETOOTH_MAP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2434"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BLUETOOTH_STACK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BLUETOOTH_STACK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2441"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.VIRTUAL_INPUT_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.VIRTUAL_INPUT_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2447"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NFC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NFC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2453"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NFC_TRANSACTION_EVENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NFC_TRANSACTION_EVENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2461"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NFC_PREFERRED_PAYMENT_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NFC_PREFERRED_PAYMENT_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2469"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NFC_SET_CONTROLLER_ALWAYS_ON isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NFC_SET_CONTROLLER_ALWAYS_ON&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2477"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SECURE_ELEMENT_PRIVILEGED_OPERATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SECURE_ELEMENT_PRIVILEGED_OPERATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2485"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONNECTIVITY_INTERNAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONNECTIVITY_INTERNAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2494"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONNECTIVITY_USE_RESTRICTED_NETWORKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONNECTIVITY_USE_RESTRICTED_NETWORKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2499"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_SIGNAL_STRENGTH_WAKEUP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_SIGNAL_STRENGTH_WAKEUP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2506"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PACKET_KEEPALIVE_OFFLOAD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PACKET_KEEPALIVE_OFFLOAD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2511"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_DATA_ACTIVITY_CHANGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_DATA_ACTIVITY_CHANGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2516"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LOOP_RADIO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LOOP_RADIO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2521"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NFC_HANDOVER_STATUS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NFC_HANDOVER_STATUS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2526"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_BLUETOOTH_WHEN_WIRELESS_CONSENT_REQUIRED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_BLUETOOTH_WHEN_WIRELESS_CONSENT_REQUIRED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2532"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ENABLE_TEST_HARNESS_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ENABLE_TEST_HARNESS_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2536"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UWB_PRIVILEGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UWB_PRIVILEGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2542"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_ACCOUNTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_ACCOUNTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2561"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCOUNT_MANAGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCOUNT_MANAGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2570"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_WIFI_MULTICAST_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_WIFI_MULTICAST_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2581"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.VIBRATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.VIBRATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2589"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.VIBRATE_ALWAYS_ON isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.VIBRATE_ALWAYS_ON&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2598"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.VIBRATE_SYSTEM_CONSTANTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.VIBRATE_SYSTEM_CONSTANTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2605"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_VIBRATOR_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_VIBRATOR_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2612"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WAKE_LOCK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WAKE_LOCK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2621"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TRANSMIT_IR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TRANSMIT_IR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2629"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TURN_SCREEN_ON isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TURN_SCREEN_ON&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2638"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_AUDIO_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_AUDIO_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2651"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LAUNCH_CAPTURE_CONTENT_ACTIVITY_FOR_NOTE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LAUNCH_CAPTURE_CONTENT_ACTIVITY_FOR_NOTE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2666"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DETECT_SCREEN_CAPTURE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DETECT_SCREEN_CAPTURE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2672"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_FACTORY_RESET_PROTECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_FACTORY_RESET_PROTECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2694"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TRIGGER_LOST_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TRIGGER_LOST_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2706"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_USB isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_USB&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2716"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEBUGGING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEBUGGING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2722"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_MTP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_MTP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2728"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.HARDWARE_TEST isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.HARDWARE_TEST&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2735"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DYNAMIC_SYSTEM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DYNAMIC_SYSTEM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2739"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_DYNAMIC_SYSTEM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_DYNAMIC_SYSTEM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2744"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_BROADCAST_RADIO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_BROADCAST_RADIO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2749"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_FM_RADIO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_FM_RADIO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2754"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NET_ADMIN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NET_ADMIN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2759"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REMOTE_AUDIO_PLAYBACK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REMOTE_AUDIO_PLAYBACK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2763"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TV_INPUT_HARDWARE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TV_INPUT_HARDWARE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2770"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_TV_INPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_TV_INPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2777"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DVB_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DVB_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2782"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CARRIER_OEM_UNLOCK_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CARRIER_OEM_UNLOCK_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2787"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_USER_OEM_UNLOCK_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_USER_OEM_UNLOCK_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2792"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_OEM_UNLOCK_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_OEM_UNLOCK_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2797"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OEM_UNLOCK_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OEM_UNLOCK_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2802"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONFIGURE_FACTORY_RESET_PROTECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONFIGURE_FACTORY_RESET_PROTECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2808"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_PDB_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_PDB_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2813"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TEST_BLACKLISTED_PASSWORD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TEST_BLACKLISTED_PASSWORD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2818"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NOTIFY_PENDING_SYSTEM_UPDATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NOTIFY_PENDING_SYSTEM_UPDATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2823"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAMERA_DISABLE_TRANSMIT_LED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAMERA_DISABLE_TRANSMIT_LED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2834"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAMERA_SEND_SYSTEM_EVENTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAMERA_SEND_SYSTEM_EVENTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2839"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAMERA_INJECT_EXTERNAL_CAMERA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAMERA_INJECT_EXTERNAL_CAMERA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2844"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GRANT_RUNTIME_PERMISSIONS_TO_TELEPHONY_DEFAULTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GRANT_RUNTIME_PERMISSIONS_TO_TELEPHONY_DEFAULTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2854"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_PHONE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_PHONE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2860"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PRECISE_PHONE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PRECISE_PHONE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2866"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PRIVILEGED_PHONE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PRIVILEGED_PHONE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2871"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_ICC_AUTH_WITH_DEVICE_IDENTIFIER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_ICC_AUTH_WITH_DEVICE_IDENTIFIER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2878"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_ACTIVE_EMERGENCY_SESSION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_ACTIVE_EMERGENCY_SESSION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2884"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LISTEN_ALWAYS_REPORTED_SIGNAL_STRENGTH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LISTEN_ALWAYS_REPORTED_SIGNAL_STRENGTH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2889"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REGISTER_SIM_SUBSCRIPTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REGISTER_SIM_SUBSCRIPTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2896"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REGISTER_CALL_PROVIDER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REGISTER_CALL_PROVIDER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2902"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REGISTER_CONNECTION_MANAGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REGISTER_CONNECTION_MANAGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2908"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_INCALL_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_INCALL_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2915"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CALL_STREAMING_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CALL_STREAMING_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2922"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ONGOING_CALLS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ONGOING_CALLS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2927"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NETWORK_SCAN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NETWORK_SCAN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2935"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_VISUAL_VOICEMAIL_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2942"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_SCREENING_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_SCREENING_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2950"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_PHONE_ACCOUNT_SUGGESTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_PHONE_ACCOUNT_SUGGESTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2959"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CALL_DIAGNOSTIC_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CALL_DIAGNOSTIC_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2968"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CALL_REDIRECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CALL_REDIRECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2975"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CONNECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CONNECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2984"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TELECOM_CONNECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TELECOM_CONNECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2991"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_INCALL_EXPERIENCE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_INCALL_EXPERIENCE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="2996"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_STK_COMMANDS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_STK_COMMANDS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3001"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SEND_EMBMS_INTENTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SEND_EMBMS_INTENTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3006"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SENSORS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SENSORS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3012"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_DOMAIN_SELECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_DOMAIN_SELECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3022"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_IMS_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_IMS_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3031"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_SATELLITE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_SATELLITE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3040"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_SATELLITE_GATEWAY_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_SATELLITE_GATEWAY_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3048"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TELEPHONY_DATA_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TELEPHONY_DATA_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3057"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TELEPHONY_NETWORK_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TELEPHONY_NETWORK_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3066"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_EMBEDDED_SUBSCRIPTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_EMBEDDED_SUBSCRIPTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3074"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_EUICC_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_EUICC_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3082"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_CARRIER_APP_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_CARRIER_APP_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3090"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_GBA_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_GBA_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3099"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_RCS_USER_CAPABILITY_EXCHANGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_RCS_USER_CAPABILITY_EXCHANGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3108"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_LAST_KNOWN_CELL_ID isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_LAST_KNOWN_CELL_ID&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3117"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_MEDIA_STORAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_MEDIA_STORAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3132"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DOCUMENTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DOCUMENTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3141"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CRATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CRATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3152"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CACHE_CONTENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CACHE_CONTENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3158"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ALLOCATE_AGGRESSIVE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ALLOCATE_AGGRESSIVE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3165"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_RESERVED_DISK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_RESERVED_DISK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3174"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DISABLE_KEYGUARD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DISABLE_KEYGUARD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3185"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_PASSWORD_COMPLEXITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_PASSWORD_COMPLEXITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3194"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_TASKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_TASKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3205"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REAL_GET_TASKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REAL_GET_TASKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3220"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_TASKS_FROM_RECENTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_TASKS_FROM_RECENTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3225"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INTERACT_ACROSS_USERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INTERACT_ACROSS_USERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3232"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INTERACT_ACROSS_USERS_FULL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INTERACT_ACROSS_USERS_FULL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3239"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INTERACT_ACROSS_PROFILES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INTERACT_ACROSS_PROFILES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3244"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_HIDDEN_PROFILES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_HIDDEN_PROFILES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3250"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_HIDDEN_PROFILES_FULL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3258"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_CROSS_PROFILE_ACTIVITIES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_CROSS_PROFILE_ACTIVITIES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3263"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONFIGURE_INTERACT_ACROSS_PROFILES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONFIGURE_INTERACT_ACROSS_PROFILES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3269"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_USERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_USERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3275"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CREATE_USERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CREATE_USERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3284"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SUBSCRIPTION_USER_ASSOCIATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SUBSCRIPTION_USER_ASSOCIATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3290"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.QUERY_USERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.QUERY_USERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3295"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_BLOBS_ACROSS_USERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_BLOBS_ACROSS_USERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3299"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_PROFILE_AND_DEVICE_OWNERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_PROFILE_AND_DEVICE_OWNERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3304"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.QUERY_ADMIN_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.QUERY_ADMIN_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3311"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_APP_EXEMPTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_APP_EXEMPTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3315"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_TIME isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_TIME&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3321"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_RUNTIME_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_RUNTIME_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3328"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_ORGANIZATION_IDENTITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_ORGANIZATION_IDENTITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3335"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SUPPORT_MESSAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SUPPORT_MESSAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3343"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_BACKUP_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_BACKUP_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3350"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_LOCK_TASK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_LOCK_TASK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3357"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_APPS_CONTROL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_APPS_CONTROL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3364"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_INSTALL_UNKNOWN_SOURCES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_INSTALL_UNKNOWN_SOURCES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3371"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_APP_RESTRICTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_APP_RESTRICTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3378"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_CALLS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_CALLS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3385"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_DEBUGGING_FEATURES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_DEBUGGING_FEATURES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3392"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_MODIFY_USERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_MODIFY_USERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3399"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SAFE_BOOT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SAFE_BOOT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3406"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_MICROPHONE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_MICROPHONE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3414"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_CAMERA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_CAMERA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3422"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_KEYGUARD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_KEYGUARD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3429"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_ACCOUNT_MANAGEMENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_ACCOUNT_MANAGEMENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3436"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_PACKAGE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_PACKAGE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3443"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_RESET_PASSWORD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_RESET_PASSWORD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3451"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_STATUS_BAR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_STATUS_BAR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3455"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_BLUETOOTH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_BLUETOOTH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3462"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_FUN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_FUN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3469"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_AIRPLANE_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_AIRPLANE_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3476"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_MOBILE_NETWORK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_MOBILE_NETWORK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3483"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_PHYSICAL_MEDIA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_PHYSICAL_MEDIA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3490"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3497"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_USB_FILE_TRANSFER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_USB_FILE_TRANSFER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3504"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_LOCK_CREDENTIALS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_LOCK_CREDENTIALS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3511"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_WIFI isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_WIFI&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3518"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SCREEN_CAPTURE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SCREEN_CAPTURE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3525"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_INPUT_METHODS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_INPUT_METHODS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3532"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_RESTRICT_PRIVATE_DNS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_RESTRICT_PRIVATE_DNS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3540"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_DEFAULT_SMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_DEFAULT_SMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3547"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_PROFILES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_PROFILES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3554"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_PROFILE_INTERACTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_PROFILE_INTERACTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3562"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_VPN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_VPN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3569"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_AUDIO_OUTPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_AUDIO_OUTPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3576"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3583"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_LOCATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_LOCATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3590"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_FACTORY_RESET isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_FACTORY_RESET&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3597"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_WALLPAPER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_WALLPAPER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3604"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SCREEN_CONTENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SCREEN_CONTENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3611"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SYSTEM_DIALOGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SYSTEM_DIALOGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3618"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_RUN_IN_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_RUN_IN_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3625"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_PRINTING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_PRINTING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3632"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_NEARBY_COMMUNICATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_NEARBY_COMMUNICATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3640"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_THREAD_NETWORK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_THREAD_NETWORK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3647"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_ASSIST_CONTENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_ASSIST_CONTENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3654"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_WINDOWS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_WINDOWS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3661"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_LOCALE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_LOCALE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3668"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_AUTOFILL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_AUTOFILL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3675"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_USERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_USERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3682"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_CERTIFICATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_CERTIFICATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3689"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_OVERRIDE_APN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_OVERRIDE_APN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3696"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SECURITY_LOGGING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SECURITY_LOGGING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3703"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_AUDIT_LOGGING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_AUDIT_LOGGING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3711"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SYSTEM_UPDATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SYSTEM_UPDATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3718"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_QUERY_SYSTEM_UPDATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_QUERY_SYSTEM_UPDATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3725"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_PRIVATE_DNS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_PRIVATE_DNS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3732"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3739"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_NETWORK_LOGGING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_NETWORK_LOGGING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3746"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_USB_DATA_SIGNALLING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_USB_DATA_SIGNALLING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3750"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SUSPEND_PERSONAL_APPS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SUSPEND_PERSONAL_APPS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3757"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_KEEP_UNINSTALLED_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_KEEP_UNINSTALLED_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3764"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_ACCESSIBILITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_ACCESSIBILITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3771"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_COMMON_CRITERIA_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_COMMON_CRITERIA_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3778"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_METERED_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_METERED_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3785"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_PROXY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_PROXY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3792"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_BUGREPORT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_BUGREPORT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3799"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_APP_USER_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_APP_USER_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3806"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_LOCK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_LOCK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3814"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.QUERY_DEVICE_STOLEN_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.QUERY_DEVICE_STOLEN_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3822"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_SYSTEM_APPS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_SYSTEM_APPS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3829"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_WIPE_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_WIPE_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3836"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_MTE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_MTE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3841"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_DEVICE_IDENTIFIERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_DEVICE_IDENTIFIERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3845"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_CONTENT_PROTECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_CONTENT_PROTECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3852"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_MANAGED_SUBSCRIPTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_MANAGED_SUBSCRIPTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3859"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_BLOCK_UNINSTALL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_BLOCK_UNINSTALL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3865"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_CAMERA_TOGGLE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_CAMERA_TOGGLE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3871"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_MICROPHONE_TOGGLE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_MICROPHONE_TOGGLE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3877"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_ACROSS_USERS_SECURITY_CRITICAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_ACROSS_USERS_SECURITY_CRITICAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3885"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_ACROSS_USERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_ACROSS_USERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3893"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_ACROSS_USERS_FULL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_ACROSS_USERS_FULL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3901"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_POLICY_STORAGE_LIMIT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_POLICY_STORAGE_LIMIT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3908"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ENHANCED_CONFIRMATION_STATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ENHANCED_CONFIRMATION_STATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3915"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PROVISION_DEMO_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PROVISION_DEMO_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3920"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CLEAR_FREEZE_PERIOD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CLEAR_FREEZE_PERIOD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3926"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FORCE_DEVICE_POLICY_MANAGER_LOGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FORCE_DEVICE_POLICY_MANAGER_LOGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3931"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_DETAILED_TASKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_DETAILED_TASKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3937"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REORDER_TASKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REORDER_TASKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3943"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REMOVE_TASKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REMOVE_TASKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3949"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ACTIVITY_STACKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ACTIVITY_STACKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3954"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ACTIVITY_TASKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ACTIVITY_TASKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3958"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACTIVITY_EMBEDDING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACTIVITY_EMBEDDING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3962"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.EMBED_ANY_APP_IN_UNTRUSTED_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.EMBED_ANY_APP_IN_UNTRUSTED_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3974"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_ANY_ACTIVITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_ANY_ACTIVITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3980"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_ACTIVITIES_FROM_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_ACTIVITIES_FROM_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3984"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_FOREGROUND_SERVICES_FROM_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_FOREGROUND_SERVICES_FROM_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3993"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BROADCAST_OPTION_INTERACTIVE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BROADCAST_OPTION_INTERACTIVE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="3998"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SEND_SHOW_SUSPENDED_APP_DETAILS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SEND_SHOW_SUSPENDED_APP_DETAILS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4006"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_ACTIVITY_AS_CALLER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_ACTIVITY_AS_CALLER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4013"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESTART_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESTART_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4018"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.KILL_BACKGROUND_PROCESSES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.KILL_BACKGROUND_PROCESSES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4034"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.KILL_ALL_BACKGROUND_PROCESSES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.KILL_ALL_BACKGROUND_PROCESSES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4044"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_PROCESS_STATE_AND_OOM_SCORE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_PROCESS_STATE_AND_OOM_SCORE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4052"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_INTENT_SENDER_INTENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_INTENT_SENDER_INTENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4058"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SYSTEM_ALERT_WINDOW isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SYSTEM_ALERT_WINDOW&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4081"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SYSTEM_APPLICATION_OVERLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SYSTEM_APPLICATION_OVERLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4096"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RUN_IN_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RUN_IN_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4102"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_DATA_IN_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_DATA_IN_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4111"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_DISPLAY_OFFSET isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_DISPLAY_OFFSET&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4118"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_RUN_IN_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_RUN_IN_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4130"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_START_FOREGROUND_SERVICES_FROM_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_START_FOREGROUND_SERVICES_FROM_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4139"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_USE_DATA_IN_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_USE_DATA_IN_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4147"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_PROFILE_WATCH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_PROFILE_WATCH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4157"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_PROFILE_GLASSES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_PROFILE_GLASSES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4167"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_PROFILE_APP_STREAMING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_PROFILE_APP_STREAMING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4176"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_PROFILE_NEARBY_DEVICE_STREAMING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_PROFILE_NEARBY_DEVICE_STREAMING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4184"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_PROFILE_AUTOMOTIVE_PROJECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_PROFILE_AUTOMOTIVE_PROJECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4193"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_PROFILE_COMPUTER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_PROFILE_COMPUTER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4202"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_COMPANION_SELF_MANAGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_COMPANION_SELF_MANAGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4207"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.COMPANION_APPROVE_WIFI_CONNECTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.COMPANION_APPROVE_WIFI_CONNECTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4215"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PROJECTION_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PROJECTION_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4222"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TOGGLE_AUTOMOTIVE_PROJECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TOGGLE_AUTOMOTIVE_PROJECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4229"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.HIDE_OVERLAY_WINDOWS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.HIDE_OVERLAY_WINDOWS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4233"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_WALLPAPER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_WALLPAPER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4246"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_WALLPAPER_HINTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_WALLPAPER_HINTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4254"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_WALLPAPER_INTERNAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_WALLPAPER_INTERNAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4264"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ALWAYS_UPDATE_WALLPAPER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ALWAYS_UPDATE_WALLPAPER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4272"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_TIME isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_TIME&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4282"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_TIME_ZONE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_TIME_ZONE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4288"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUGGEST_TELEPHONY_TIME_AND_ZONE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUGGEST_TELEPHONY_TIME_AND_ZONE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4297"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUGGEST_MANUAL_TIME_AND_ZONE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUGGEST_MANUAL_TIME_AND_ZONE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4304"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUGGEST_EXTERNAL_TIME isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUGGEST_EXTERNAL_TIME&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4313"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_TIME_AND_ZONE_DETECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_TIME_AND_ZONE_DETECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4321"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.EXPAND_STATUS_BAR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.EXPAND_STATUS_BAR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4332"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_SYNC_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_SYNC_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4371"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_SYNC_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_SYNC_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4379"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_SYNC_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_SYNC_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4387"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_SCREEN_COMPATIBILITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_SCREEN_COMPATIBILITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4398"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_CONFIGURATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_CONFIGURATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4404"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4419"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_GSERVICES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_GSERVICES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4426"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_DEVICE_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_DEVICE_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4431"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_ALLOWLISTED_DEVICE_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_ALLOWLISTED_DEVICE_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4436"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_WRITE_SYNC_DISABLED_MODE_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_WRITE_SYNC_DISABLED_MODE_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4441"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_DEVICE_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_DEVICE_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4446"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_APP_SPECIFIC_LOCALES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_APP_SPECIFIC_LOCALES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4452"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_APP_SPECIFIC_LOCALECONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_APP_SPECIFIC_LOCALECONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4457"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MONITOR_DEVICE_CONFIG_ACCESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MONITOR_DEVICE_CONFIG_ACCESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4462"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FORCE_STOP_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FORCE_STOP_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4468"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RETRIEVE_WINDOW_CONTENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RETRIEVE_WINDOW_CONTENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4473"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_ANIMATION_SCALE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_ANIMATION_SCALE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4478"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PERSISTENT_ACTIVITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PERSISTENT_ACTIVITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4483"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_PACKAGE_SIZE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_PACKAGE_SIZE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4491"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_PREFERRED_APPLICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_PREFERRED_APPLICATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4499"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_BOOT_COMPLETED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4515"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BROADCAST_STICKY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BROADCAST_STICKY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4526"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MOUNT_UNMOUNT_FILESYSTEMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MOUNT_UNMOUNT_FILESYSTEMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4533"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MOUNT_FORMAT_FILESYSTEMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MOUNT_FORMAT_FILESYSTEMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4538"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.STORAGE_INTERNAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.STORAGE_INTERNAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4542"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ASEC_ACCESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ASEC_ACCESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4547"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ASEC_CREATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ASEC_CREATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4552"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ASEC_DESTROY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ASEC_DESTROY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4557"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ASEC_MOUNT_UNMOUNT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ASEC_MOUNT_UNMOUNT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4562"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ASEC_RENAME isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ASEC_RENAME&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4567"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_APN_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_APN_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4573"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_NETWORK_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_NETWORK_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4579"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CLEAR_APP_CACHE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CLEAR_APP_CACHE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4588"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ALLOW_ANY_CODEC_FOR_PLAYBACK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ALLOW_ANY_CODEC_FOR_PLAYBACK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4593"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CA_CERTIFICATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CA_CERTIFICATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4599"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECOVERY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECOVERY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4605"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_RESUME_ON_REBOOT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_RESUME_ON_REBOOT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4611"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_SYSTEM_UPDATE_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_SYSTEM_UPDATE_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4616"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_JOB_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_JOB_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4621"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4630"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.QUERY_TIME_ZONE_RULES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.QUERY_TIME_ZONE_RULES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4637"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_TIME_ZONE_RULES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_TIME_ZONE_RULES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4647"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESET_SHORTCUT_MANAGER_THROTTLING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESET_SHORTCUT_MANAGER_THROTTLING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4652"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_NETWORK_RECOMMENDATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_NETWORK_RECOMMENDATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4657"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_OVERLAY_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_OVERLAY_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4664"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CREDENTIAL_MANAGEMENT_APP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CREDENTIAL_MANAGEMENT_APP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4669"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_FONTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_FONTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4674"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_ATTESTATION_VERIFICATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_ATTESTATION_VERIFICATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4679"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.VERIFY_ATTESTATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.VERIFY_ATTESTATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4685"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_ATTESTATION_VERIFICATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_ATTESTATION_VERIFICATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4691"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_UNIQUE_ID_ATTESTATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_UNIQUE_ID_ATTESTATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4697"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_RKP_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_RKP_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4702"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LIST_ENABLED_CREDENTIAL_PROVIDERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LIST_ENABLED_CREDENTIAL_PROVIDERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4707"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PROVIDE_DEFAULT_ENABLED_CREDENTIAL_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PROVIDE_DEFAULT_ENABLED_CREDENTIAL_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4713"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CREDENTIAL_MANAGER_SET_ALLOWED_PROVIDERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CREDENTIAL_MANAGER_SET_ALLOWED_PROVIDERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4719"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CREDENTIAL_MANAGER_SET_ORIGIN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CREDENTIAL_MANAGER_SET_ORIGIN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4724"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CREDENTIAL_MANAGER_QUERY_CANDIDATE_CREDENTIALS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CREDENTIAL_MANAGER_QUERY_CANDIDATE_CREDENTIALS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4730"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LAUNCH_CREDENTIAL_SELECTOR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LAUNCH_CREDENTIAL_SELECTOR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4735"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PROVIDE_REMOTE_CREDENTIALS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PROVIDE_REMOTE_CREDENTIALS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4741"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_SECURE_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_SECURE_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4751"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DUMP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DUMP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4756"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_UI_TRACING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_UI_TRACING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4762"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_LOGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_LOGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4768"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_DEBUG_APP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_DEBUG_APP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4773"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_DROPBOX_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_DROPBOX_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4779"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_PROCESS_LIMIT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_PROCESS_LIMIT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4785"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_ALWAYS_FINISH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_ALWAYS_FINISH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4791"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SIGNAL_PERSISTENT_PROCESSES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SIGNAL_PERSISTENT_PROCESSES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4796"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TRACE_REPORT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TRACE_REPORT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4803"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.APPROVE_INCIDENT_REPORTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.APPROVE_INCIDENT_REPORTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4812"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_INCIDENT_REPORT_APPROVAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_INCIDENT_REPORT_APPROVAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4817"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_ACCOUNTS_PRIVILEGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_ACCOUNTS_PRIVILEGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4827"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_PASSWORD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_PASSWORD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4832"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DIAGNOSTIC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DIAGNOSTIC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4837"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.STATUS_BAR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.STATUS_BAR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4843"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TRIGGER_SHELL_BUGREPORT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TRIGGER_SHELL_BUGREPORT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4850"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TRIGGER_SHELL_PROFCOLLECT_UPLOAD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TRIGGER_SHELL_PROFCOLLECT_UPLOAD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4857"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.STATUS_BAR_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.STATUS_BAR_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4863"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_QUICK_SETTINGS_TILE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_QUICK_SETTINGS_TILE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4869"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CONTROLS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CONTROLS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4876"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FORCE_BACK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FORCE_BACK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4884"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_DEVICE_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_DEVICE_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4889"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_APP_OPS_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_APP_OPS_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4894"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_HISTORICAL_APP_OPS_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_HISTORICAL_APP_OPS_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4901"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_APP_OPS_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_APP_OPS_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4907"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_APP_OPS_RESTRICTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_APP_OPS_RESTRICTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4913"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_APP_OPS_MODES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_APP_OPS_MODES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4919"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INTERNAL_SYSTEM_WINDOW isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INTERNAL_SYSTEM_WINDOW&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4927"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UNLIMITED_TOASTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UNLIMITED_TOASTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4934"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.HIDE_NON_SYSTEM_OVERLAY_WINDOWS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.HIDE_NON_SYSTEM_OVERLAY_WINDOWS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4945"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_APP_TOKENS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_APP_TOKENS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4953"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REGISTER_WINDOW_MANAGER_LISTENERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REGISTER_WINDOW_MANAGER_LISTENERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4958"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FREEZE_SCREEN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FREEZE_SCREEN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4963"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INJECT_EVENTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INJECT_EVENTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4972"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FILTER_EVENTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FILTER_EVENTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4977"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RETRIEVE_WINDOW_TOKEN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RETRIEVE_WINDOW_TOKEN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4981"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_ACCESSIBILITY_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_ACCESSIBILITY_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4985"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACT_AS_PACKAGE_FOR_ACCESSIBILITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACT_AS_PACKAGE_FOR_ACCESSIBILITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4990"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_ACCESSIBILITY_VOLUME isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_ACCESSIBILITY_VOLUME&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="4994"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESSIBILITY_MOTION_EVENT_OBSERVING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESSIBILITY_MOTION_EVENT_OBSERVING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5001"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FRAME_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FRAME_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5005"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TEMPORARY_ENABLE_ACCESSIBILITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TEMPORARY_ENABLE_ACCESSIBILITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5009"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OPEN_ACCESSIBILITY_DETAILS_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OPEN_ACCESSIBILITY_DETAILS_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5016"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_ACTIVITY_WATCHER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_ACTIVITY_WATCHER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5025"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SHUTDOWN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SHUTDOWN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5031"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.STOP_APP_SWITCHES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.STOP_APP_SWITCHES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5039"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_TOP_ACTIVITY_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_TOP_ACTIVITY_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5047"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_SYSTEM_AUDIO_CAPTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_SYSTEM_AUDIO_CAPTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5054"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_INPUT_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_INPUT_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5061"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_INPUT_METHOD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_INPUT_METHOD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5068"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TEST_INPUT_METHOD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TEST_INPUT_METHOD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5074"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_MIDI_DEVICE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_MIDI_DEVICE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5081"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_ACCESSIBILITY_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_ACCESSIBILITY_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5088"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_PRINT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_PRINT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5095"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_PRINT_RECOMMENDATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_PRINT_RECOMMENDATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5104"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PRINT_SERVICES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PRINT_SERVICES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5112"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PRINT_SERVICE_RECOMMENDATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PRINT_SERVICE_RECOMMENDATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5120"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_NFC_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_NFC_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5128"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_QUICK_ACCESS_WALLET_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_QUICK_ACCESS_WALLET_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5135"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_PRINT_SPOOLER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_PRINT_SPOOLER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5140"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_COMPANION_DEVICE_MANAGER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_COMPANION_DEVICE_MANAGER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5145"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_COMPANION_DEVICE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_COMPANION_DEVICE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5151"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_RUNTIME_PERMISSION_PRESENTER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_RUNTIME_PERMISSION_PRESENTER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5157"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TEXT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TEXT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5164"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_ATTENTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_ATTENTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5172"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_ROTATION_RESOLVER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_ROTATION_RESOLVER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5181"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_VPN_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_VPN_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5189"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_WALLPAPER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_WALLPAPER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5196"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_GAME_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_GAME_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5205"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_VOICE_INTERACTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_VOICE_INTERACTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5212"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_HOTWORD_DETECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_HOTWORD_DETECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5220"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_HOTWORD_DETECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_HOTWORD_DETECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5228"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_VISUAL_QUERY_DETECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_VISUAL_QUERY_DETECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5236"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUBSCRIBE_TO_KEYGUARD_LOCKED_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUBSCRIBE_TO_KEYGUARD_LOCKED_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5243"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_AUTOFILL_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_AUTOFILL_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5250"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_FIELD_CLASSIFICATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_FIELD_CLASSIFICATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5259"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CREDENTIAL_PROVIDER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CREDENTIAL_PROVIDER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5266"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_AUTOFILL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_AUTOFILL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5275"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_AUTOFILL_FIELD_CLASSIFICATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_AUTOFILL_FIELD_CLASSIFICATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5282"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_INLINE_SUGGESTION_RENDER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_INLINE_SUGGESTION_RENDER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5289"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TEXTCLASSIFIER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TEXTCLASSIFIER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5297"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_REMOTE_LOCKSCREEN_VALIDATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_REMOTE_LOCKSCREEN_VALIDATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5306"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_SELECTION_TOOLBAR_RENDER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_SELECTION_TOOLBAR_RENDER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5314"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CONTENT_CAPTURE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CONTENT_CAPTURE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5322"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TRANSLATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TRANSLATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5330"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_UI_TRANSLATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_UI_TRANSLATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5337"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CONTENT_SUGGESTIONS_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CONTENT_SUGGESTIONS_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5345"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_WALLPAPER_EFFECTS_GENERATION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_WALLPAPER_EFFECTS_GENERATION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5354"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_MUSIC_RECOGNITION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_MUSIC_RECOGNITION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5363"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_AUGMENTED_AUTOFILL_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_AUGMENTED_AUTOFILL_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5371"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_VOICE_KEYPHRASES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_VOICE_KEYPHRASES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5383"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.KEYPHRASE_ENROLLMENT_APPLICATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.KEYPHRASE_ENROLLMENT_APPLICATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5394"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_REMOTE_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_REMOTE_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5400"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TV_AD_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TV_AD_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5408"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TV_INPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TV_INPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5415"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TV_INTERACTIVE_APP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TV_INTERACTIVE_APP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5422"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TV_REMOTE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TV_REMOTE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5431"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TV_VIRTUAL_REMOTE_CONTROLLER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TV_VIRTUAL_REMOTE_CONTROLLER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5439"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_HDMI_CEC_ACTIVE_SOURCE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_HDMI_CEC_ACTIVE_SOURCE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5445"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_PARENTAL_CONTROLS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_PARENTAL_CONTROLS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5451"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_CONTENT_RATING_SYSTEMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_CONTENT_RATING_SYSTEMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5457"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NOTIFY_TV_INPUTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NOTIFY_TV_INPUTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5464"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TUNER_RESOURCE_ACCESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TUNER_RESOURCE_ACCESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5472"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MEDIA_RESOURCE_OVERRIDE_PID isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MEDIA_RESOURCE_OVERRIDE_PID&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5480"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REGISTER_MEDIA_RESOURCE_OBSERVER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REGISTER_MEDIA_RESOURCE_OBSERVER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5489"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_ROUTE_PROVIDER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_ROUTE_PROVIDER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5495"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_DEVICE_ADMIN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_DEVICE_ADMIN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5502"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_ADMINS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_ADMINS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5508"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESET_PASSWORD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESET_PASSWORD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5514"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LOCK_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LOCK_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5520"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_ORIENTATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_ORIENTATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5528"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_POINTER_SPEED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_POINTER_SPEED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5535"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_INPUT_CALIBRATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_INPUT_CALIBRATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5541"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_KEYBOARD_LAYOUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_KEYBOARD_LAYOUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5548"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SCHEDULE_PRIORITIZED_ALARM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SCHEDULE_PRIORITIZED_ALARM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5557"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SCHEDULE_EXACT_ALARM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SCHEDULE_EXACT_ALARM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5578"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_EXACT_ALARM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_EXACT_ALARM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5605"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TABLET_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TABLET_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5614"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_INSTALL_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_INSTALL_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5622"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_DELETE_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_DELETE_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5633"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5640"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_SELF_UPDATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_SELF_UPDATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5648"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_PACKAGE_UPDATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_PACKAGE_UPDATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5656"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_TEST_ONLY_PACKAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_TEST_ONLY_PACKAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5681"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_DPC_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_DPC_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5691"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_INSTALLED_SESSION_PATHS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_INSTALLED_SESSION_PATHS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5700"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CLEAR_APP_USER_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CLEAR_APP_USER_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5715"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_APP_GRANTED_URI_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_APP_GRANTED_URI_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5722"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CLEAR_APP_GRANTED_URI_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5729"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SCOPED_ACCESS_DIRECTORY_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5740"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FORCE_PERSISTABLE_URI_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FORCE_PERSISTABLE_URI_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5751"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DELETE_CACHE_FILES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DELETE_CACHE_FILES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5757"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INTERNAL_DELETE_CACHE_FILES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INTERNAL_DELETE_CACHE_FILES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5762"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DELETE_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DELETE_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5770"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MOVE_PACKAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MOVE_PACKAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5775"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.KEEP_UNINSTALLED_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.KEEP_UNINSTALLED_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5780"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_COMPONENT_ENABLED_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_COMPONENT_ENABLED_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5786"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GRANT_RUNTIME_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GRANT_RUNTIME_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5791"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LAUNCH_PERMISSION_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LAUNCH_PERMISSION_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5797"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTALL_GRANT_RUNTIME_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTALL_GRANT_RUNTIME_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5803"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REVOKE_RUNTIME_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REVOKE_RUNTIME_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5808"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REVOKE_POST_NOTIFICATIONS_WITHOUT_KILL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REVOKE_POST_NOTIFICATIONS_WITHOUT_KILL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5814"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_RUNTIME_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_RUNTIME_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5819"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESTORE_RUNTIME_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESTORE_RUNTIME_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5826"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ADJUST_RUNTIME_PERMISSIONS_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5831"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPGRADE_RUNTIME_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPGRADE_RUNTIME_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5836"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WHITELIST_RESTRICTED_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WHITELIST_RESTRICTED_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5842"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WHITELIST_AUTO_REVOKE_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WHITELIST_AUTO_REVOKE_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5848"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OBSERVE_GRANT_REVOKE_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OBSERVE_GRANT_REVOKE_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5852"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ONE_TIME_PERMISSION_SESSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ONE_TIME_PERMISSION_SESSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5857"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ROLE_HOLDERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ROLE_HOLDERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5862"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEFAULT_APPLICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEFAULT_APPLICATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5869"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BYPASS_ROLE_QUALIFICATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BYPASS_ROLE_QUALIFICATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5878"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OBSERVE_ROLE_HOLDERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OBSERVE_ROLE_HOLDERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5883"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_COMPANION_DEVICES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_COMPANION_DEVICES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5888"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_OBSERVE_COMPANION_DEVICE_PRESENCE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_OBSERVE_COMPANION_DEVICE_PRESENCE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5894"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_OBSERVE_DEVICE_UUID_PRESENCE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_OBSERVE_DEVICE_UUID_PRESENCE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5904"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DELIVER_COMPANION_MESSAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DELIVER_COMPANION_MESSAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5909"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_COMPANION_TRANSPORTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_COMPANION_TRANSPORTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5917"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ASSOCIATE_COMPANION_DEVICES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ASSOCIATE_COMPANION_DEVICES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5923"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_SURFACE_FLINGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_SURFACE_FLINGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5930"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ROTATE_SURFACE_FLINGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ROTATE_SURFACE_FLINGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5938"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WAKEUP_SURFACE_FLINGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WAKEUP_SURFACE_FLINGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5947"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_FRAME_BUFFER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_FRAME_BUFFER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5955"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_TOUCH_MODE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_TOUCH_MODE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5962"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_INPUT_FLINGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_INPUT_FLINGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5967"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DISABLE_INPUT_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DISABLE_INPUT_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5974"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONFIGURE_WIFI_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONFIGURE_WIFI_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5978"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_WIFI_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_WIFI_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5986"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONFIGURE_DISPLAY_COLOR_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONFIGURE_DISPLAY_COLOR_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5992"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_DEVICE_LIGHTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_DEVICE_LIGHTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="5999"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_DISPLAY_SATURATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_DISPLAY_SATURATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6005"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_DISPLAY_COLOR_TRANSFORMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_DISPLAY_COLOR_TRANSFORMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6012"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BRIGHTNESS_SLIDER_USAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BRIGHTNESS_SLIDER_USAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6020"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_AMBIENT_LIGHT_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_AMBIENT_LIGHT_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6027"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONFIGURE_DISPLAY_BRIGHTNESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONFIGURE_DISPLAY_BRIGHTNESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6034"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_DISPLAY_BRIGHTNESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_DISPLAY_BRIGHTNESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6039"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OVERRIDE_DISPLAY_MODE_REQUESTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OVERRIDE_DISPLAY_MODE_REQUESTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6047"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_REFRESH_RATE_SWITCHING_TYPE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_REFRESH_RATE_SWITCHING_TYPE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6054"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_USER_PREFERRED_DISPLAY_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_USER_PREFERRED_DISPLAY_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6060"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_HDR_CONVERSION_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_HDR_CONVERSION_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6066"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_VPN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_VPN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6072"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_ALWAYS_ON_VPN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_ALWAYS_ON_VPN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6079"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_TUNER_AUDIO_INPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_TUNER_AUDIO_INPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6087"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_AUDIO_OUTPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_AUDIO_OUTPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6094"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_MEDIA_OUTPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_MEDIA_OUTPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6112"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_VOICE_COMMUNICATION_OUTPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_VOICE_COMMUNICATION_OUTPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6130"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_AUDIO_HOTWORD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_AUDIO_HOTWORD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6136"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_ULTRASOUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_ULTRASOUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6142"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SOUNDTRIGGER_DELEGATE_IDENTITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SOUNDTRIGGER_DELEGATE_IDENTITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6151"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_AUDIO_ROUTING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_AUDIO_ROUTING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6157"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_AUDIO_SETTINGS_PRIVILEGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_AUDIO_SETTINGS_PRIVILEGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6165"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CALL_AUDIO_INTERCEPTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CALL_AUDIO_INTERCEPTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6172"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.QUERY_AUDIO_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.QUERY_AUDIO_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6177"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_DEFAULT_AUDIO_EFFECTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_DEFAULT_AUDIO_EFFECTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6184"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DISABLE_SYSTEM_SOUND_EFFECTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DISABLE_SYSTEM_SOUND_EFFECTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6191"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REMOTE_DISPLAY_PROVIDER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REMOTE_DISPLAY_PROVIDER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6197"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_VIDEO_OUTPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_VIDEO_OUTPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6204"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_SECURE_VIDEO_OUTPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_SECURE_VIDEO_OUTPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6211"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MEDIA_CONTENT_CONTROL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MEDIA_CONTENT_CONTROL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6216"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MEDIA_ROUTING_CONTROL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MEDIA_ROUTING_CONTROL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6223"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_VOLUME_KEY_LONG_PRESS_LISTENER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_VOLUME_KEY_LONG_PRESS_LISTENER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6230"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_MEDIA_KEY_LISTENER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_MEDIA_KEY_LISTENER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6238"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BRICK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BRICK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6245"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REBOOT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REBOOT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6250"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DEVICE_POWER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="   &lt;permission android:name=&quot;android.permission.DEVICE_POWER&quot;"
+        errorLine2="   ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6257"
+            column="4"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.POWER_SAVER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.POWER_SAVER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6263"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BATTERY_PREDICTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BATTERY_PREDICTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6269"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USER_ACTIVITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USER_ACTIVITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6274"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_LOW_POWER_STANDBY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_LOW_POWER_STANDBY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6279"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_LOW_POWER_STANDBY_PORTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_LOW_POWER_STANDBY_PORTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6285"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NET_TUNNELING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NET_TUNNELING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6289"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FACTORY_TEST isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FACTORY_TEST&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6296"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BROADCAST_CLOSE_SYSTEM_DIALOGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BROADCAST_CLOSE_SYSTEM_DIALOGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6303"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BROADCAST_PACKAGE_REMOVED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BROADCAST_PACKAGE_REMOVED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6311"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BROADCAST_SMS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BROADCAST_SMS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6317"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BROADCAST_WAP_PUSH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BROADCAST_WAP_PUSH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6323"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BROADCAST_NETWORK_PRIVILEGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BROADCAST_NETWORK_PRIVILEGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6331"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MASTER_CLEAR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MASTER_CLEAR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6335"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CALL_PRIVILEGED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CALL_PRIVILEGED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6342"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PERFORM_CDMA_PROVISIONING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PERFORM_CDMA_PROVISIONING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6347"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PERFORM_SIM_ACTIVATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PERFORM_SIM_ACTIVATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6351"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_LOCATION_UPDATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_LOCATION_UPDATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6357"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_CHECKIN_PROPERTIES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_CHECKIN_PROPERTIES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6363"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PACKAGE_USAGE_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PACKAGE_USAGE_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6371"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REPORT_USAGE_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REPORT_USAGE_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6378"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_BROADCAST_RESPONSE_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_BROADCAST_RESPONSE_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6386"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LOADER_USAGE_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LOADER_USAGE_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6397"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OBSERVE_APP_USAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OBSERVE_APP_USAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6403"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_APP_IDLE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_APP_IDLE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6408"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_APP_LAUNCH_TIME_ESTIMATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_APP_LAUNCH_TIME_ESTIMATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6413"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_DEVICE_IDLE_TEMP_WHITELIST isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_DEVICE_IDLE_TEMP_WHITELIST&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6419"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6425"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BATTERY_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BATTERY_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6432"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.STATSCOMPANION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.STATSCOMPANION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6438"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REGISTER_STATS_PULL_ATOM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REGISTER_STATS_PULL_ATOM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6443"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_RESTRICTED_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_RESTRICTED_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6448"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BACKUP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BACKUP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6454"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_SETTINGS_OVERRIDEABLE_BY_RESTORE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_SETTINGS_OVERRIDEABLE_BY_RESTORE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6461"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECOVER_KEYSTORE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECOVER_KEYSTORE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6468"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONFIRM_FULL_BACKUP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONFIRM_FULL_BACKUP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6474"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_REMOTEVIEWS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_REMOTEVIEWS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6480"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_APPWIDGET isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_APPWIDGET&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6489"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SLICE_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SLICE_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6493"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_KEYGUARD_APPWIDGET isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_KEYGUARD_APPWIDGET&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6499"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_APPWIDGET_BIND_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_APPWIDGET_BIND_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6505"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHANGE_BACKGROUND_DATA_SETTING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHANGE_BACKGROUND_DATA_SETTING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6511"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GLOBAL_SEARCH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GLOBAL_SEARCH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6523"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GLOBAL_SEARCH_CONTROL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GLOBAL_SEARCH_CONTROL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6533"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_SEARCH_INDEXABLES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_SEARCH_INDEXABLES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6538"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_SETTINGS_SUGGESTIONS_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_SETTINGS_SUGGESTIONS_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6543"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_SETTINGS_HOMEPAGE_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_SETTINGS_HOMEPAGE_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6547"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LAUNCH_MULTI_PANE_SETTINGS_DEEP_LINK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LAUNCH_MULTI_PANE_SETTINGS_DEEP_LINK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6553"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ALLOW_PLACE_IN_MULTI_PANE_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ALLOW_PLACE_IN_MULTI_PANE_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6559"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_WALLPAPER_COMPONENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_WALLPAPER_COMPONENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6565"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_WALLPAPER_DIM_AMOUNT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_WALLPAPER_DIM_AMOUNT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6570"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_DREAM_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_DREAM_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6575"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_DREAM_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_DREAM_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6580"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_DREAM_SUPPRESSION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_DREAM_SUPPRESSION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6584"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_CACHE_FILESYSTEM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_CACHE_FILESYSTEM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6589"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.COPY_PROTECTED_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.COPY_PROTECTED_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6597"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CRYPT_KEEPER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CRYPT_KEEPER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6603"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_NETWORK_USAGE_HISTORY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_NETWORK_USAGE_HISTORY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6608"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_NETWORK_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_NETWORK_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6613"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_NETWORK_ACCOUNTING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_NETWORK_ACCOUNTING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6617"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SUBSCRIPTION_PLANS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SUBSCRIPTION_PLANS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6621"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.intent.category.MASTER_CLEAR.permission.C2D_MESSAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.intent.category.MASTER_CLEAR.permission.C2D_MESSAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6627"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PACKAGE_VERIFICATION_AGENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PACKAGE_VERIFICATION_AGENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6634"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_PACKAGE_VERIFIER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_PACKAGE_VERIFIER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6641"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PACKAGE_ROLLBACK_AGENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PACKAGE_ROLLBACK_AGENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6647"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ROLLBACKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ROLLBACKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6651"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TEST_MANAGE_ROLLBACKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TEST_MANAGE_ROLLBACKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6655"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_HARMFUL_APP_WARNINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_HARMFUL_APP_WARNINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6659"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INTENT_FILTER_VERIFICATION_AGENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INTENT_FILTER_VERIFICATION_AGENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6665"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_INTENT_FILTER_VERIFIER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_INTENT_FILTER_VERIFIER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6672"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DOMAIN_VERIFICATION_AGENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DOMAIN_VERIFICATION_AGENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6680"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_DOMAIN_VERIFICATION_AGENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_DOMAIN_VERIFICATION_AGENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6686"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_DOMAIN_VERIFICATION_USER_SELECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_DOMAIN_VERIFICATION_USER_SELECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6692"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SERIAL_PORT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SERIAL_PORT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6697"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_CONTENT_PROVIDERS_EXTERNALLY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_CONTENT_PROVIDERS_EXTERNALLY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6706"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_LOCK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_LOCK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6712"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REQUEST_NOTIFICATION_ASSISTANT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REQUEST_NOTIFICATION_ASSISTANT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6719"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_NOTIFICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_NOTIFICATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6725"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_NOTIFICATION_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_NOTIFICATION_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6732"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_NOTIFICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_NOTIFICATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6740"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_NOTIFICATION_LISTENERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_NOTIFICATION_LISTENERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6745"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_COLORIZED_NOTIFICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_COLORIZED_NOTIFICATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6751"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_KEYGUARD_SECURE_STORAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_KEYGUARD_SECURE_STORAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6756"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_INITIAL_LOCK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_INITIAL_LOCK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6761"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_AND_VERIFY_LOCKSCREEN_CREDENTIALS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_AND_VERIFY_LOCKSCREEN_CREDENTIALS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6766"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CHECK_REMOTE_LOCKSCREEN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CHECK_REMOTE_LOCKSCREEN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6771"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_FINGERPRINT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_FINGERPRINT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6775"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_FACE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_FACE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6779"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESET_FINGERPRINT_LOCKOUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESET_FINGERPRINT_LOCKOUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6783"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TEST_BIOMETRIC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TEST_BIOMETRIC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6789"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_BIOMETRIC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_BIOMETRIC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6793"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_BIOMETRIC_INTERNAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_BIOMETRIC_INTERNAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6797"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_BIOMETRIC_DIALOG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_BIOMETRIC_DIALOG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6801"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_BIOMETRIC_DIALOG_ADVANCED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_BIOMETRIC_DIALOG_ADVANCED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6809"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_KEYGUARD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_KEYGUARD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6814"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_KEYGUARD_SECURE_NOTIFICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_KEYGUARD_SECURE_NOTIFICATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6819"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_WEAK_ESCROW_TOKEN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_WEAK_ESCROW_TOKEN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6825"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TRUST_LISTENER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TRUST_LISTENER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6830"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PROVIDE_TRUST_AGENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PROVIDE_TRUST_AGENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6835"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SHOW_KEYGUARD_MESSAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SHOW_KEYGUARD_MESSAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6841"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LAUNCH_TRUST_AGENT_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LAUNCH_TRUST_AGENT_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6846"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_TRUST_AGENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_TRUST_AGENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6853"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_NOTIFICATION_LISTENER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_NOTIFICATION_LISTENER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6861"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_NOTIFICATION_ASSISTANT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_NOTIFICATION_ASSISTANT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6870"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CHOOSER_TARGET_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CHOOSER_TARGET_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6882"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PROVIDE_RESOLVER_RANKER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PROVIDE_RESOLVER_RANKER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6890"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_RESOLVER_RANKER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_RESOLVER_RANKER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6899"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CONDITION_PROVIDER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CONDITION_PROVIDER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6907"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_DREAM_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_DREAM_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6914"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CACHE_QUOTA_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CACHE_QUOTA_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6921"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INVOKE_CARRIER_SETUP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INVOKE_CARRIER_SETUP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6927"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_NETWORK_CONDITIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_NETWORK_CONDITIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6932"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_DRM_CERTIFICATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_DRM_CERTIFICATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6937"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_MEDIA_PROJECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_MEDIA_PROJECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6942"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_INSTALL_SESSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_INSTALL_SESSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6954"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REMOVE_DRM_CERTIFICATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REMOVE_DRM_CERTIFICATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6961"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CARRIER_MESSAGING_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CARRIER_MESSAGING_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6965"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_VOICE_INTERACTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_VOICE_INTERACTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6971"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CARRIER_SERVICES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CARRIER_SERVICES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6979"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_VIEW_PERMISSION_USAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_VIEW_PERMISSION_USAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6988"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_REVIEW_PERMISSION_DECISIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_REVIEW_PERMISSION_DECISIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="6998"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_VIEW_APP_FEATURES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_VIEW_APP_FEATURES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7007"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.QUERY_DO_NOT_ASK_CREDENTIALS_ON_BOOT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.QUERY_DO_NOT_ASK_CREDENTIALS_ON_BOOT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7015"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.KILL_UID isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.KILL_UID&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7023"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LOCAL_MAC_ADDRESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LOCAL_MAC_ADDRESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7028"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PEERS_MAC_ADDRESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PEERS_MAC_ADDRESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7034"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DISPATCH_NFC_MESSAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DISPATCH_NFC_MESSAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7041"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_DAY_NIGHT_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_DAY_NIGHT_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7048"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ENTER_CAR_MODE_PRIORITIZED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ENTER_CAR_MODE_PRIORITIZED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7057"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.HANDLE_CAR_MODE_CHANGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.HANDLE_CAR_MODE_CHANGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7063"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SEND_CATEGORY_CAR_NOTIFICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7068"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_INSTANT_APPS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_INSTANT_APPS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7078"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.VIEW_INSTANT_APPS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.VIEW_INSTANT_APPS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7084"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_BIND_INSTANT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_BIND_INSTANT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7091"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_MEDIA_RESOURCE_USAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_MEDIA_RESOURCE_USAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7097"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SOUND_TRIGGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SOUND_TRIGGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7104"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SOUND_TRIGGER_RUN_IN_BATTERY_SAVER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SOUND_TRIGGER_RUN_IN_BATTERY_SAVER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7111"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_SOUND_TRIGGER_DETECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_SOUND_TRIGGER_DETECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7117"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DISPATCH_PROVISIONING_MESSAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DISPATCH_PROVISIONING_MESSAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7123"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_BLOCKED_NUMBERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_BLOCKED_NUMBERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7131"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_BLOCKED_NUMBERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_BLOCKED_NUMBERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7139"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_VR_LISTENER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_VR_LISTENER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7145"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESTRICTED_VR_ACCESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESTRICTED_VR_ACCESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7152"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_VR_MANAGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_VR_MANAGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7157"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_VR_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_VR_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7162"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_LOCK_TASK_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_LOCK_TASK_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7167"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUBSTITUTE_NOTIFICATION_APP_NAME isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUBSTITUTE_NOTIFICATION_APP_NAME&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7173"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.NOTIFICATION_DURING_SETUP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.NOTIFICATION_DURING_SETUP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7178"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_AUTO_FILL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_AUTO_FILL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7183"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CONTENT_CAPTURE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CONTENT_CAPTURE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7188"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ROTATION_RESOLVER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ROTATION_RESOLVER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7193"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CLOUDSEARCH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CLOUDSEARCH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7198"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_MUSIC_RECOGNITION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_MUSIC_RECOGNITION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7203"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SPEECH_RECOGNITION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SPEECH_RECOGNITION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7208"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CONTENT_SUGGESTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CONTENT_SUGGESTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7213"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_APP_PREDICTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_APP_PREDICTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7218"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SEARCH_UI isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SEARCH_UI&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7223"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SMARTSPACE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SMARTSPACE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7228"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_SMARTSPACE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_SMARTSPACE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7234"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_WALLPAPER_EFFECTS_GENERATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_WALLPAPER_EFFECTS_GENERATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7247"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_THEME_OVERLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_THEME_OVERLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7253"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INSTANT_APP_FOREGROUND_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INSTANT_APP_FOREGROUND_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7258"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7265"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_CAMERA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_CAMERA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7274"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_CONNECTED_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_CONNECTED_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7283"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_DATA_SYNC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_DATA_SYNC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7292"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_LOCATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_LOCATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7301"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_MEDIA_PLAYBACK isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_MEDIA_PLAYBACK&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7310"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_MEDIA_PROJECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_MEDIA_PROJECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7319"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_MICROPHONE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_MICROPHONE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7328"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_PHONE_CALL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_PHONE_CALL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7337"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_HEALTH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_HEALTH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7346"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_REMOTE_MESSAGING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_REMOTE_MESSAGING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7355"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_SYSTEM_EXEMPTED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_SYSTEM_EXEMPTED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7366"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_FILE_MANAGEMENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_FILE_MANAGEMENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7376"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_MEDIA_PROCESSING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_MEDIA_PROCESSING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7386"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.FOREGROUND_SERVICE_SPECIAL_USE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.FOREGROUND_SERVICE_SPECIAL_USE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7395"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_SHORTCUTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_SHORTCUTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7402"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UNLIMITED_SHORTCUTS_API_CALLS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UNLIMITED_SHORTCUTS_API_CALLS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7407"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_RUNTIME_PROFILES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_RUNTIME_PROFILES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7412"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_AUDIO_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_AUDIO_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7416"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MODIFY_QUIET_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MODIFY_QUIET_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7421"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CAMERA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CAMERA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7426"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_REMOTE_APP_TRANSITION_ANIMATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_REMOTE_APP_TRANSITION_ANIMATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7432"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WATCH_APPOPS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WATCH_APPOPS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7437"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DISABLE_HIDDEN_API_CHECKS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DISABLE_HIDDEN_API_CHECKS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7442"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MONITOR_DEFAULT_SMS_PACKAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MONITOR_DEFAULT_SMS_PACKAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7448"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_CARRIER_MESSAGING_CLIENT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_CARRIER_MESSAGING_CLIENT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7453"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_EXPLICIT_HEALTH_CHECK_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_EXPLICIT_HEALTH_CHECK_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7460"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_EXTERNAL_STORAGE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_EXTERNAL_STORAGE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7467"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_APPOPS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_APPOPS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7472"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_CLIPBOARD_IN_BACKGROUND isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_CLIPBOARD_IN_BACKGROUND&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7477"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_CLIPBOARD_ACCESS_NOTIFICATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_CLIPBOARD_ACCESS_NOTIFICATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7483"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUPPRESS_CLIPBOARD_ACCESS_NOTIFICATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUPPRESS_CLIPBOARD_ACCESS_NOTIFICATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7488"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_ACCESSIBILITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_ACCESSIBILITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7494"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GRANT_PROFILE_OWNER_DEVICE_IDS_ACCESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GRANT_PROFILE_OWNER_DEVICE_IDS_ACCESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7501"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MARK_DEVICE_ORGANIZATION_OWNED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MARK_DEVICE_ORGANIZATION_OWNED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7507"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SMS_FINANCIAL_TRANSACTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SMS_FINANCIAL_TRANSACTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7513"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_FULL_SCREEN_INTENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_FULL_SCREEN_INTENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7520"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_SANDBOX_TRIGGER_AUDIO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_SANDBOX_TRIGGER_AUDIO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7531"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SEND_DEVICE_CUSTOMIZATION_READY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SEND_DEVICE_CUSTOMIZATION_READY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7537"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_DEVICE_CUSTOMIZATION_READY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_DEVICE_CUSTOMIZATION_READY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7543"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.AMBIENT_WALLPAPER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.AMBIENT_WALLPAPER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7548"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SENSOR_PRIVACY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SENSOR_PRIVACY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7553"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OBSERVE_SENSOR_PRIVACY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OBSERVE_SENSOR_PRIVACY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7558"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REVIEW_ACCESSIBILITY_SERVICES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REVIEW_ACCESSIBILITY_SERVICES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7564"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SUBSTITUTE_SHARE_TARGET_APP_NAME_AND_ICON isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SUBSTITUTE_SHARE_TARGET_APP_NAME_AND_ICON&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7570"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_SHARED_LIBRARIES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_SHARED_LIBRARIES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7575"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LOG_COMPAT_CHANGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LOG_COMPAT_CHANGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7580"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_COMPAT_CHANGE_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_COMPAT_CHANGE_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7584"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OVERRIDE_COMPAT_CHANGE_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OVERRIDE_COMPAT_CHANGE_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7590"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OVERRIDE_COMPAT_CHANGE_CONFIG_ON_RELEASE_BUILD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OVERRIDE_COMPAT_CHANGE_CONFIG_ON_RELEASE_BUILD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7595"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MONITOR_INPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MONITOR_INPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7599"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ALLOW_SLIPPERY_TOUCHES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ALLOW_SLIPPERY_TOUCHES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7603"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ASSOCIATE_INPUT_DEVICE_TO_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ASSOCIATE_INPUT_DEVICE_TO_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7607"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.QUERY_ALL_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.QUERY_ALL_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7612"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PEEK_DROPBOX_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PEEK_DROPBOX_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7622"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_TV_TUNER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_TV_TUNER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7628"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_TV_DESCRAMBLER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_TV_DESCRAMBLER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7634"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_TV_SHARED_FILTER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_TV_SHARED_FILTER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7640"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ADD_TRUSTED_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ADD_TRUSTED_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7644"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ADD_ALWAYS_UNLOCKED_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ADD_ALWAYS_UNLOCKED_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7648"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_LOCUS_ID_USAGE_STATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_LOCUS_ID_USAGE_STATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7652"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_APP_HIBERNATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_APP_HIBERNATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7656"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESET_APP_ERRORS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESET_APP_ERRORS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7661"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_THEME_OVERLAY_CONTROLLER_READY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_THEME_OVERLAY_CONTROLLER_READY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7666"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.INPUT_CONSUMER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.INPUT_CONSUMER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7670"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CONTROL_DEVICE_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CONTROL_DEVICE_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7676"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_DISPLAY_HASHING_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_DISPLAY_HASHING_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7684"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_TOAST_RATE_LIMITING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_TOAST_RATE_LIMITING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7690"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_GAME_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_GAME_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7695"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_GAME_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_GAME_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7700"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_FPS_COUNTER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_FPS_COUNTER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7705"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_GAME_ACTIVITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_GAME_ACTIVITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7711"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SIGNAL_REBOOT_READINESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SIGNAL_REBOOT_READINESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7717"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SHOW_CUSTOMIZED_RESOLVER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SHOW_CUSTOMIZED_RESOLVER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7724"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_PEOPLE_TILE_PREVIEW isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_PEOPLE_TILE_PREVIEW&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7728"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_PEOPLE_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_PEOPLE_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7734"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RENOUNCE_PERMISSIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RENOUNCE_PERMISSIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7739"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_NEARBY_STREAMING_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_NEARBY_STREAMING_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7747"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_CLIP_SOURCE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_CLIP_SOURCE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7753"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_TUNED_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_TUNED_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7759"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_PACKAGES_WITHOUT_USER_ACTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_PACKAGES_WITHOUT_USER_ACTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7767"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ENFORCE_UPDATE_OWNERSHIP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ENFORCE_UPDATE_OWNERSHIP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7778"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_BLACKOUT_CONTENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_BLACKOUT_CONTENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7790"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_GLOBAL_APP_SEARCH_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_GLOBAL_APP_SEARCH_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7795"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_ASSISTANT_APP_SEARCH_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_ASSISTANT_APP_SEARCH_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7800"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_HOME_APP_SEARCH_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_HOME_APP_SEARCH_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7805"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.EXECUTE_APP_ACTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.EXECUTE_APP_ACTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7814"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PROVIDE_OWN_AUTOFILL_SUGGESTIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PROVIDE_OWN_AUTOFILL_SUGGESTIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7821"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CREATE_VIRTUAL_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CREATE_VIRTUAL_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7826"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SEND_SAFETY_CENTER_UPDATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SEND_SAFETY_CENTER_UPDATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7834"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LAUNCH_DEVICE_MANAGER_SETUP isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LAUNCH_DEVICE_MANAGER_SETUP&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7841"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.UPDATE_DEVICE_MANAGEMENT_RESOURCES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.UPDATE_DEVICE_MANAGEMENT_RESOURCES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7847"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_SAFETY_CENTER_STATUS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_SAFETY_CENTER_STATUS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7854"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_SAFETY_CENTER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_SAFETY_CENTER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7862"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_AMBIENT_CONTEXT_EVENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_AMBIENT_CONTEXT_EVENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7868"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_AMBIENT_CONTEXT_DETECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_AMBIENT_CONTEXT_DETECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7875"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_UNRESTRICTED_KEEP_CLEAR_AREAS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_UNRESTRICTED_KEEP_CLEAR_AREAS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7884"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SET_UNRESTRICTED_GESTURE_EXCLUSION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SET_UNRESTRICTED_GESTURE_EXCLUSION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7891"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.TIS_EXTENSION_INTERFACE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.TIS_EXTENSION_INTERFACE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7900"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_SECURITY_LOG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_SECURITY_LOG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7905"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MAKE_UID_VISIBLE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MAKE_UID_VISIBLE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7911"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.HANDLE_QUERY_PACKAGE_RESTART isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.HANDLE_QUERY_PACKAGE_RESTART&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7916"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.REMAP_MODIFIER_KEYS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.REMAP_MODIFIER_KEYS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7923"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MONITOR_KEYBOARD_BACKLIGHT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MONITOR_KEYBOARD_BACKLIGHT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7929"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MONITOR_STICKY_MODIFIER_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MONITOR_STICKY_MODIFIER_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7936"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DEVICE_LOCK_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DEVICE_LOCK_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7945"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_WEARABLE_SENSING_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_WEARABLE_SENSING_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7953"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_WEARABLE_SENSING_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_WEARABLE_SENSING_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7960"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.USE_ON_DEVICE_INTELLIGENCE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.USE_ON_DEVICE_INTELLIGENCE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7968"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_ON_DEVICE_INTELLIGENCE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_ON_DEVICE_INTELLIGENCE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7977"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.BIND_ON_DEVICE_SANDBOXED_INFERENCE_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.BIND_ON_DEVICE_SANDBOXED_INFERENCE_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7986"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RUN_USER_INITIATED_JOBS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RUN_USER_INITIATED_JOBS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="7994"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_APP_METADATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_APP_METADATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8001"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.STAGE_HEALTH_CONNECT_REMOTE_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.STAGE_HEALTH_CONNECT_REMOTE_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8006"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.DELETE_STAGED_HEALTH_CONNECT_REMOTE_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.DELETE_STAGED_HEALTH_CONNECT_REMOTE_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8012"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.START_ACTIVITIES_FROM_SDK_SANDBOX isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.START_ACTIVITIES_FROM_SDK_SANDBOX&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8016"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MIGRATE_HEALTH_CONNECT_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MIGRATE_HEALTH_CONNECT_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8021"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.QUERY_CLONED_APPS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.QUERY_CLONED_APPS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8031"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.CAPTURE_CONSENTLESS_BUGREPORT_ON_USERDEBUG_BUILD isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.CAPTURE_CONSENTLESS_BUGREPORT_ON_USERDEBUG_BUILD&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8044"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.LOG_FOREGROUND_RESOURCE_USE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.LOG_FOREGROUND_RESOURCE_USE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8049"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.ACCESS_GPU_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.ACCESS_GPU_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8056"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_ANY_PROVIDER_TYPE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_ANY_PROVIDER_TYPE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8063"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SYNC_FLAGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SYNC_FLAGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8074"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.WRITE_FLAGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.WRITE_FLAGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8081"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_BINDING_UID_IMPORTANCE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_BINDING_UID_IMPORTANCE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8090"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.MANAGE_DISPLAYS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.MANAGE_DISPLAYS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8099"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.PREPARE_FACTORY_RESET isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.PREPARE_FACTORY_RESET&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8106"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.OVERRIDE_SYSTEM_KEY_BEHAVIOR_IN_FOCUSED_WINDOW isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.OVERRIDE_SYSTEM_KEY_BEHAVIOR_IN_FOCUSED_WINDOW&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8122"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESTRICT_DISPLAY_MODES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESTRICT_DISPLAY_MODES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8130"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RECEIVE_SENSITIVE_NOTIFICATIONS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RECEIVE_SENSITIVE_NOTIFICATIONS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8141"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.GET_BACKGROUND_INSTALLED_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.GET_BACKGROUND_INSTALLED_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8153"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.READ_SYSTEM_GRAMMATICAL_GENDER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.READ_SYSTEM_GRAMMATICAL_GENDER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8161"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.EMERGENCY_INSTALL_PACKAGES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.EMERGENCY_INSTALL_PACKAGES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8171"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SCREEN_TIMEOUT_OVERRIDE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SCREEN_TIMEOUT_OVERRIDE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8180"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.SETUP_FSVERITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.SETUP_FSVERITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8189"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.permission.RESERVED_FOR_TESTING_SIGNATURE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.permission.RESERVED_FOR_TESTING_SIGNATURE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/android_manifest.xml"
+            line="8200"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_ENERGY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_ENERGY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="29"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_ENERGY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_ENERGY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="34"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_DRIVER_MONITORING_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_DRIVER_MONITORING_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="39"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_DRIVER_MONITORING_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_DRIVER_MONITORING_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="43"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_DRIVER_MONITORING_STATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_DRIVER_MONITORING_STATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="47"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.ADJUST_RANGE_REMAINING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.ADJUST_RANGE_REMAINING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="51"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_IDENTIFICATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_IDENTIFICATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="55"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_CLIMATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_CLIMATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="59"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_DOORS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_DOORS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="63"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_WINDOWS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_WINDOWS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="67"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_MIRRORS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_MIRRORS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="71"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_GLOVE_BOX isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_GLOVE_BOX&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="75"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_SEATS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_SEATS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="79"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_AIRBAGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_AIRBAGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="83"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_MILEAGE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_MILEAGE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="87"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_TIRES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_TIRES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="91"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_CAR_STEERING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_CAR_STEERING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="95"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_CAR_DISPLAY_UNITS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_CAR_DISPLAY_UNITS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="99"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_DISPLAY_UNITS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_DISPLAY_UNITS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="103"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_SPEED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_SPEED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="107"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_ENERGY_PORTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_ENERGY_PORTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="112"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_ENERGY_PORTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_ENERGY_PORTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="116"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_ENGINE_DETAILED isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_ENGINE_DETAILED&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="120"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_DYNAMICS_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_DYNAMICS_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="124"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_VENDOR_EXTENSION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_VENDOR_EXTENSION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="128"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_PROJECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_PROJECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="132"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.ACCESS_CAR_PROJECTION_STATUS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.ACCESS_CAR_PROJECTION_STATUS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="136"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.BIND_PROJECTION_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.BIND_PROJECTION_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="140"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_MOCK_VEHICLE_HAL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_MOCK_VEHICLE_HAL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="144"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="148"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.PRIVILEGED_CAR_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.PRIVILEGED_CAR_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="152"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_CAR_VENDOR_PERMISSION_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_CAR_VENDOR_PERMISSION_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="156"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.MANAGE_REMOTE_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.MANAGE_REMOTE_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="160"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.MANAGE_OCCUPANT_CONNECTION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.MANAGE_OCCUPANT_CONNECTION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="164"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_EXTERIOR_ENVIRONMENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_EXTERIOR_ENVIRONMENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="173"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_EPOCH_TIME isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_EPOCH_TIME&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="177"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_EXTERIOR_LIGHTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_EXTERIOR_LIGHTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="181"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_EXTERIOR_LIGHTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_EXTERIOR_LIGHTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="185"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_CAR_INTERIOR_LIGHTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_CAR_INTERIOR_LIGHTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="189"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_INTERIOR_LIGHTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_INTERIOR_LIGHTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="193"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_POWER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_POWER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="197"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_POWERTRAIN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_POWERTRAIN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="201"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_POWERTRAIN isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_POWERTRAIN&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="205"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_CAR_SEAT_BELTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_CAR_SEAT_BELTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="209"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_DYNAMICS_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_DYNAMICS_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="213"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_IMPACT_SENSORS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_IMPACT_SENSORS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="217"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_HEAD_UP_DISPLAY_STATUS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_HEAD_UP_DISPLAY_STATUS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="221"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_HEAD_UP_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_HEAD_UP_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="225"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_VALET_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_VALET_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="229"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_VALET_MODE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_VALET_MODE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="233"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_CAR_AIRBAGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_CAR_AIRBAGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="237"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_ULTRASONICS_SENSOR_DATA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_ULTRASONICS_SENSOR_DATA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="241"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_NAVIGATION_MANAGER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_NAVIGATION_MANAGER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="245"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_DIAGNOSTICS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_DIAGNOSTICS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="249"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CLEAR_CAR_DIAGNOSTICS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CLEAR_CAR_DIAGNOSTICS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="253"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.BIND_VMS_CLIENT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.BIND_VMS_CLIENT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="257"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.VMS_PUBLISHER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.VMS_PUBLISHER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="261"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.VMS_SUBSCRIBER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.VMS_SUBSCRIBER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="265"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_DRIVING_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_DRIVING_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="269"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.USE_CAR_TELEMETRY_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.USE_CAR_TELEMETRY_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="273"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.REQUEST_CAR_EVS_ACTIVITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.REQUEST_CAR_EVS_ACTIVITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="277"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_EVS_ACTIVITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_EVS_ACTIVITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="281"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.USE_CAR_EVS_CAMERA isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.USE_CAR_EVS_CAMERA&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="285"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.MONITOR_CAR_EVS_STATUS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.MONITOR_CAR_EVS_STATUS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="289"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_APP_BLOCKING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_APP_BLOCKING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="293"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_CONTROL_AUDIO_VOLUME isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_CONTROL_AUDIO_VOLUME&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="297"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_CONTROL_AUDIO_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_CONTROL_AUDIO_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="301"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.RECEIVE_CAR_AUDIO_DUCKING_EVENTS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.RECEIVE_CAR_AUDIO_DUCKING_EVENTS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="305"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.BIND_INSTRUMENT_CLUSTER_RENDERER_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.BIND_INSTRUMENT_CLUSTER_RENDERER_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="309"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.BIND_CAR_INPUT_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.BIND_CAR_INPUT_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="313"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_DISPLAY_IN_CLUSTER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_DISPLAY_IN_CLUSTER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="317"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_INSTRUMENT_CLUSTER_CONTROL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_INSTRUMENT_CLUSTER_CONTROL&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="321"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_MONITOR_CLUSTER_NAVIGATION_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_MONITOR_CLUSTER_NAVIGATION_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="325"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_HANDLE_USB_AOAP_DEVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_HANDLE_USB_AOAP_DEVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="329"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_UX_RESTRICTIONS_CONFIGURATION isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_UX_RESTRICTIONS_CONFIGURATION&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="333"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_CAR_OCCUPANT_AWARENESS_STATE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_CAR_OCCUPANT_AWARENESS_STATE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="337"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.ACCESS_PRIVATE_DISPLAY_ID isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.ACCESS_PRIVATE_DISPLAY_ID&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="341"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_OCCUPANT_AWARENESS_SYSTEM isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_OCCUPANT_AWARENESS_SYSTEM&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="345"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.STORAGE_MONITORING isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.STORAGE_MONITORING&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="349"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_ENROLL_TRUST isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_ENROLL_TRUST&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="353"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_TEST_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_TEST_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="357"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_FEATURES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_FEATURES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="361"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.USE_CAR_WATCHDOG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.USE_CAR_WATCHDOG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="365"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_WATCHDOG_CONFIG isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_WATCHDOG_CONFIG&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="369"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.COLLECT_CAR_WATCHDOG_METRICS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.COLLECT_CAR_WATCHDOG_METRICS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="373"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_WINDOW isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_WINDOW&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="377"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_WINDOW isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_WINDOW&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="381"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_DOOR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_DOOR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="385"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_DOOR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_DOOR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="389"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_SEAT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_SEAT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="393"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_SEAT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_SEAT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="397"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_MIRROR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_MIRROR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="401"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_MIRROR isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_MIRROR&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="405"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="409"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_INFO isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_INFO&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="413"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_ENGINE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_ENGINE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="417"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_ENGINE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_ENGINE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="421"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_HVAC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_HVAC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="425"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_HVAC isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_HVAC&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="429"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_LIGHT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_LIGHT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="433"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_LIGHT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_LIGHT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="437"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_1 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_1&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="441"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_1 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_1&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="445"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_2 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_2&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="449"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_2 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_2&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="453"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_3 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_3&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="457"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_3 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_3&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="461"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_4 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_4&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="465"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_4 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_4&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="469"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_5 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_5&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="473"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_5 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_5&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="477"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_6 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_6&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="481"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_6 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_6&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="485"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_7 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_7&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="489"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_7 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_7&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="493"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_8 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_8&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="497"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_8 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_8&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="501"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_9 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_9&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="505"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_9 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_9&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="509"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.GET_CAR_VENDOR_CATEGORY_10 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.GET_CAR_VENDOR_CATEGORY_10&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="513"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.SET_CAR_VENDOR_CATEGORY_10 isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.SET_CAR_VENDOR_CATEGORY_10&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="517"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CAR_MONITOR_INPUT isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CAR_MONITOR_INPUT&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="521"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_CAR_POWER_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_CAR_POWER_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="525"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_POWER_POLICY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_POWER_POLICY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="529"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_SHUTDOWN_PROCESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_SHUTDOWN_PROCESS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="533"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.TEMPLATE_RENDERER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.TEMPLATE_RENDERER&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="537"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_CAR_APP_LAUNCH isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_CAR_APP_LAUNCH&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="541"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.MANAGE_THREAD_PRIORITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.MANAGE_THREAD_PRIORITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="545"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.BIND_OEM_CAR_SERVICE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.BIND_OEM_CAR_SERVICE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="549"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.MANAGE_OCCUPANT_ZONE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.MANAGE_OCCUPANT_ZONE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="553"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_STEERING_WHEEL isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="     &lt;permission android:name=&quot;android.car.permission.CONTROL_STEERING_WHEEL&quot;"
+        errorLine2="     ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="557"
+            column="6"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.USE_REMOTE_ACCESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="     &lt;permission android:name=&quot;android.car.permission.USE_REMOTE_ACCESS&quot;"
+        errorLine2="     ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="561"
+            column="6"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_REMOTE_ACCESS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="     &lt;permission android:name=&quot;android.car.permission.CONTROL_REMOTE_ACCESS&quot;"
+        errorLine2="     ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="565"
+            column="6"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_ADAS_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_ADAS_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="569"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_ADAS_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_ADAS_SETTINGS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="573"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_ADAS_STATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_ADAS_STATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="577"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_ADAS_STATES isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_ADAS_STATES&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="581"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.ACCESS_MIRRORED_SURFACE isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.ACCESS_MIRRORED_SURFACE&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="585"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.MIRROR_DISPLAY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.MIRROR_DISPLAY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="589"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.REGISTER_CAR_SYSTEM_UI_PROXY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.REGISTER_CAR_SYSTEM_UI_PROXY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="593"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.MANAGE_CAR_SYSTEM_UI isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.MANAGE_CAR_SYSTEM_UI&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="597"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_WINDSHIELD_WIPERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.READ_WINDSHIELD_WIPERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="601"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.CONTROL_WINDSHIELD_WIPERS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.CONTROL_WINDSHIELD_WIPERS&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="605"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.MANAGE_DISPLAY_COMPATIBILITY isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission android:name=&quot;android.car.permission.MANAGE_DISPLAY_COMPATIBILITY&quot;"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="609"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.READ_PERSIST_TETHERING_SETTINGS isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="613"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="PlatformPermissionWithoutFlag"
+        message="android.car.permission.BIND_APP_CARD_PROVIDER isn&apos;t guarded by a feature flag. New &lt;permission> elements must have the `android:featureFlag` attribute."
+        errorLine1="    &lt;permission"
+        errorLine2="    ^">
+        <location
+            file="packages/modules/Permission/tests/cts/permissionpolicy/res/raw/automotive_android_manifest.xml"
+            line="618"
+            column="5"/>
+    </issue>
+
+    <issue
+        id="MissingVersion"
+        message="Should set `android:versionCode` to specify the application version"
+        errorLine1="&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;"
+        errorLine2=" ~~~~~~~~">
+        <location
+            file="./out/soong/.intermediates/packages/modules/Permission/tests/cts/permissionpolicy/CtsPermissionPolicyTestCases/android_common/manifest_merger/AndroidManifest.xml"
+            line="17"
+            column="2"/>
+    </issue>
+
+    <issue
+        id="MissingVersion"
+        message="Should set `android:versionName` to specify the application version"
+        errorLine1="&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;"
+        errorLine2=" ~~~~~~~~">
+        <location
+            file="./out/soong/.intermediates/packages/modules/Permission/tests/cts/permissionpolicy/CtsPermissionPolicyTestCases/android_common/manifest_merger/AndroidManifest.xml"
+            line="17"
+            column="2"/>
+    </issue>
+
+    <issue
+        id="QueryAllPackagesPermission"
+        message="A `&lt;queries>` declaration should generally be used instead of QUERY_ALL_PACKAGES; see https://g.co/dev/packagevisibility for details"
+        errorLine1="    &lt;uses-permission android:name=&quot;android.permission.QUERY_ALL_PACKAGES&quot; />"
+        errorLine2="                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~">
+        <location
+            file="./out/soong/.intermediates/packages/modules/Permission/tests/cts/permissionpolicy/CtsPermissionPolicyTestCases/android_common/manifest_merger/AndroidManifest.xml"
+            line="26"
+            column="22"/>
+    </issue>
+
+    <issue
+        id="MissingApplicationIcon"
+        message="Should explicitly set `android:icon`, there is no default"
+        errorLine1="    &lt;application android:extractNativeLibs=&quot;false&quot; >"
+        errorLine2="     ~~~~~~~~~~~">
+        <location
+            file="./out/soong/.intermediates/packages/modules/Permission/tests/cts/permissionpolicy/CtsPermissionPolicyTestCases/android_common/manifest_merger/AndroidManifest.xml"
+            line="85"
+            column="6"/>
+    </issue>
+
+    <issue
+        id="UsingFeatureAutomotiveInCTS"
+        message="This class uses PackageManager.hasSystemFeature(\&quot;android.hardware.type.automotive\&quot;) or other equivalent methods. If it is used to make a CTS test behave differently on AAOS, you should use @RequireAutomotive or @RequireNotAutomotive instead; otherwise, please ignore this warning. See https://g3doc.corp.google.com/wireless/android/partner/compatibility/g3doc/dev/write-a-test/index.md#write-a-test-that-behaves-differently-on-aaos">
+        <location
+            file="./out/soong/.intermediates/frameworks/base/api/android_test_stubs_current/android_common/turbine-combined/android_test_stubs_current.jar!/android/content/pm/PackageManager.class"/>
+    </issue>
+
+</issues>
diff --git a/tests/cts/permissionpolicy/res/raw/android_manifest.xml b/tests/cts/permissionpolicy/res/raw/android_manifest.xml
index d212b2e59..af96c9a20 100644
--- a/tests/cts/permissionpolicy/res/raw/android_manifest.xml
+++ b/tests/cts/permissionpolicy/res/raw/android_manifest.xml
@@ -825,7 +825,6 @@
     <protected-broadcast android:name="android.intent.action.PROFILE_REMOVED" />
     <protected-broadcast android:name="com.android.internal.telephony.cat.SMS_SENT_ACTION" />
     <protected-broadcast android:name="com.android.internal.telephony.cat.SMS_DELIVERY_ACTION" />
-    <protected-broadcast android:name="com.android.internal.telephony.data.ACTION_RETRY" />
     <protected-broadcast android:name="android.companion.virtual.action.VIRTUAL_DEVICE_REMOVED" />
     <protected-broadcast android:name="com.android.internal.intent.action.FLASH_NOTIFICATION_START_PREVIEW" />
     <protected-broadcast android:name="com.android.internal.intent.action.FLASH_NOTIFICATION_STOP_PREVIEW" />
@@ -2605,6 +2604,14 @@
     <permission android:name="android.permission.VIBRATE_SYSTEM_CONSTANTS"
         android:protectionLevel="signature" />
 
+    <!-- @SystemApi Allows access to perform vendor effects in the vibrator.
+         <p>Protection level: signature
+         @hide
+    -->
+    <permission android:name="android.permission.VIBRATE_VENDOR_EFFECTS"
+        android:protectionLevel="signature|privileged"
+        android:featureFlag="android.os.vibrator.vendor_vibration_effects" />
+
     <!-- @SystemApi Allows access to the vibrator state.
          <p>Protection level: signature
          @hide
@@ -3649,7 +3656,6 @@
 
     <!-- Allows an application to set policy related to sending assist content to a
         privileged app such as the Assistant app.
-        @FlaggedApi("android.app.admin.flags.assist_content_user_restriction_enabled")
     -->
     <permission android:name="android.permission.MANAGE_DEVICE_POLICY_ASSIST_CONTENT"
         android:protectionLevel="internal|role" />
@@ -3706,7 +3712,6 @@
     <!-- Allows an application to use audit logging API.
         @hide
         @SystemApi
-        @FlaggedApi("android.app.admin.flags.security_log_v2_enabled")
     -->
     <permission android:name="android.permission.MANAGE_DEVICE_POLICY_AUDIT_LOGGING"
         android:protectionLevel="internal|role" />
@@ -3855,25 +3860,19 @@
     <!-- Allows an application to set policy related to subscriptions downloaded by an admin.
         <p>{@link Manifest.permission#MANAGE_DEVICE_POLICY_ACROSS_USERS_FULL} is required to call
             APIs protected by this permission on users different to the calling user.
-        @FlaggedApi("android.app.admin.flags.esim_management_enabled") -->
+    -->
     <permission android:name="android.permission.MANAGE_DEVICE_POLICY_MANAGED_SUBSCRIPTIONS"
         android:protectionLevel="internal|role" />
 
-    <!-- Allows an application to manage policy related to block package uninstallation.
-        @FlaggedApi("android.app.admin.flags.dedicated_device_control_api_enabled")
-    -->
+    <!-- Allows an application to manage policy related to block package uninstallation. -->
     <permission android:name="android.permission.MANAGE_DEVICE_POLICY_BLOCK_UNINSTALL"
         android:protectionLevel="internal|role" />
 
-    <!-- Allows an application to manage policy related to camera toggle.
-        @FlaggedApi("android.app.admin.flags.dedicated_device_control_api_enabled")
-    -->
+    <!-- Allows an application to manage policy related to camera toggle. -->
     <permission android:name="android.permission.MANAGE_DEVICE_POLICY_CAMERA_TOGGLE"
         android:protectionLevel="internal|role" />
 
-    <!-- Allows an application to manage policy related to microphone toggle.
-        @FlaggedApi("android.app.admin.flags.dedicated_device_control_api_enabled")
-    -->
+    <!-- Allows an application to manage policy related to microphone toggle. -->
     <permission android:name="android.permission.MANAGE_DEVICE_POLICY_MICROPHONE_TOGGLE"
         android:protectionLevel="internal|role" />
 
@@ -5472,6 +5471,15 @@
     <permission android:name="android.permission.TUNER_RESOURCE_ACCESS"
          android:protectionLevel="signature|privileged|vendorPrivileged" />
 
+    <!-- This permission is required among systems services to always keep the
+         binding with TvInputManagerService.
+         <p>Protection level: signature|privileged|vendorPrivileged
+         <p>This should only be used by the OEM TvInputService.
+         @hide -->
+    <permission android:name="android.permission.ALWAYS_BOUND_TV_INPUT"
+        android:protectionLevel="signature|privileged|vendorPrivileged"
+        android:featureFlag="android.media.tv.flags.tif_unbind_inactive_tis"/>
+
     <!-- @SystemApi This permission is required by Media Resource Manager Service when
          system services create MediaCodecs on behalf of other processes and apps.
          <p>Protection level: signature|privileged|vendorPrivileged
@@ -5911,8 +5919,8 @@
                 android:description="@string/permdesc_deliverCompanionMessages"
                 android:protectionLevel="normal" />
 
-    <!-- @hide @FlaggedApi("android.companion.flags.companion_transport_apis")
-         Allows an application to send and receive messages via CDM transports.
+    <!-- Allows an application to send and receive messages via CDM transports.
+         @hide
     -->
     <permission android:name="android.permission.USE_COMPANION_TRANSPORTS"
         android:protectionLevel="signature" />
@@ -7814,6 +7822,41 @@
     <permission android:name="android.permission.EXECUTE_APP_ACTION"
                 android:protectionLevel="internal|role" />
 
+    <!-- Must be required by an {@link android.app.appfunctions.AppFunctionService},
+         to ensure that only the system can bind to it.
+         <p>Protection level: signature
+         @FlaggedApi("android.app.appfunctions.flags.enable_app_function_manager")  -->
+    <permission android:name="android.permission.BIND_APP_FUNCTION_SERVICE"
+        android:featureFlag="android.app.appfunctions.flags.enable_app_function_manager"
+        android:protectionLevel="signature" />
+
+    <!-- @SystemApi Allows a trusted application to perform actions on behalf of users inside of
+         applications with privacy guarantees from the system.
+         <p>This permission is currently only granted to system packages in the
+         {@link android.app.role.SYSTEM_UI_INTELLIGENCE} role which complies with privacy
+         requirements outlined in the Android CDD section "9.8.6 Content Capture".
+         <p>Apps are not able to opt-out from caller having this permission.
+         <p>Protection level: internal|role
+         @hide
+         @FlaggedApi("android.app.appfunctions.flags.enable_app_function_manager")  -->
+    <permission android:name="android.permission.EXECUTE_APP_FUNCTIONS_TRUSTED"
+        android:featureFlag="android.app.appfunctions.flags.enable_app_function_manager"
+        android:protectionLevel="internal|role" />
+
+    <!-- @SystemApi Allows an application to perform actions on behalf of users inside of
+         applications.
+         <p>This permission is currently only granted to preinstalled / system apps having the
+         {@link android.app.role.ASSISTANT} role.
+         <p>Apps contributing app functions can opt to disallow callers with this permission,
+         limiting to only callers with {@link android.permission.EXECUTE_APP_FUNCTIONS_TRUSTED}
+         instead.
+         <p>Protection level: internal|role
+         @hide
+         @FlaggedApi("android.app.appfunctions.flags.enable_app_function_manager")  -->
+    <permission android:name="android.permission.EXECUTE_APP_FUNCTIONS"
+        android:featureFlag="android.app.appfunctions.flags.enable_app_function_manager"
+        android:protectionLevel="internal|role" />
+
     <!-- Allows an application to display its suggestions using the autofill framework.
          <p>For now, this permission is only granted to the Browser application.
          <p>Protection level: internal|role
@@ -7936,6 +7979,13 @@
     <permission android:name="android.permission.MONITOR_STICKY_MODIFIER_STATE"
                 android:protectionLevel="signature" />
 
+    <!-- Allows low-level access to manage key gestures
+         <p>Not for use by third-party applications.
+         @hide -->
+    <permission android:name="android.permission.MANAGE_KEY_GESTURES"
+                android:protectionLevel="signature"
+                android:featureFlag="com.android.hardware.input.manage_key_gestures" />
+
     <uses-permission android:name="android.permission.HANDLE_QUERY_PACKAGE_RESTART" />
 
     <!-- Allows financed device kiosk apps to perform actions on the Device Lock service
@@ -8044,6 +8094,20 @@
     <permission android:name="android.permission.CAPTURE_CONSENTLESS_BUGREPORT_ON_USERDEBUG_BUILD"
                 android:protectionLevel="internal|appop" />
 
+    <!-- @hide @SystemApi
+         @FlaggedApi(android.os.Flags.FLAG_ALLOW_CONSENTLESS_BUGREPORT_DELEGATED_CONSENT)
+         Allows system applications to capture bugreport directly without consent dialog when using
+         the bugreporting API, and instead use the applications-owned consent page.
+         <p>The application still needs to hold {@link android.permission.DUMP} permission and be
+         bugreport-whitelisted to be able to capture a bugreport using the bugreporting API in the
+         first place.
+         <p>Protection level: signature|privileged
+         <p>Not for use by third-party applications. -->
+    <permission
+        android:name="android.permission.CAPTURE_CONSENTLESS_BUGREPORT_DELEGATED_CONSENT"
+        android:protectionLevel="signature|privileged"
+        android:featureFlag="android.os.allow_consentless_bugreport_delegated_consent" />
+
     <!-- @SystemApi Allows to call APIs that log process lifecycle events
          @hide -->
     <permission android:name="android.permission.LOG_FOREGROUND_RESOURCE_USE"
diff --git a/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/NoProcessOutgoingCallPermissionTest.java b/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/NoProcessOutgoingCallPermissionTest.java
index 989c927e1..ae2bed3fb 100644
--- a/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/NoProcessOutgoingCallPermissionTest.java
+++ b/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/NoProcessOutgoingCallPermissionTest.java
@@ -86,7 +86,7 @@ public class NoProcessOutgoingCallPermissionTest {
     @Test
     public void testProcessOutgoingCall() throws InterruptedException {
         final PackageManager pm = mContext.getPackageManager();
-        if (!pm.hasSystemFeature(PackageManager.FEATURE_TELEPHONY) ||
+        if (!pm.hasSystemFeature(PackageManager.FEATURE_TELEPHONY_CALLING) ||
                 !pm.hasSystemFeature(PackageManager.FEATURE_SIP_VOIP)) {
             return;
         }
diff --git a/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/NoReceiveSmsPermissionTest.java b/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/NoReceiveSmsPermissionTest.java
index ecd31e620..c02d98077 100644
--- a/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/NoReceiveSmsPermissionTest.java
+++ b/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/NoReceiveSmsPermissionTest.java
@@ -77,7 +77,7 @@ public class NoReceiveSmsPermissionTest extends AndroidTestCase {
      */
     public void testReceiveTextMessage() {
         PackageManager packageManager = mContext.getPackageManager();
-        if (!packageManager.hasSystemFeature(PackageManager.FEATURE_TELEPHONY)) {
+        if (!packageManager.hasSystemFeature(PackageManager.FEATURE_TELEPHONY_MESSAGING)) {
             return;
         }
 
@@ -108,7 +108,7 @@ public class NoReceiveSmsPermissionTest extends AndroidTestCase {
      */
     public void testAppSpecificSmsToken() {
         PackageManager packageManager = mContext.getPackageManager();
-        if (!packageManager.hasSystemFeature(PackageManager.FEATURE_TELEPHONY)) {
+        if (!packageManager.hasSystemFeature(PackageManager.FEATURE_TELEPHONY_MESSAGING)) {
             return;
         }
 
diff --git a/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/PermissionPolicyTest.java b/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/PermissionPolicyTest.java
index 18c214a1f..a58602501 100644
--- a/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/PermissionPolicyTest.java
+++ b/tests/cts/permissionpolicy/src/android/permissionpolicy/cts/PermissionPolicyTest.java
@@ -33,6 +33,7 @@ import android.os.Process;
 import android.os.SystemProperties;
 import android.platform.test.annotations.AppModeFull;
 import android.platform.test.flag.junit.DeviceFlagsValueProvider;
+import android.platform.test.flag.util.FlagReadException;
 import android.util.ArrayMap;
 import android.util.ArraySet;
 import android.util.Log;
@@ -324,8 +325,10 @@ public class PermissionPolicyTest {
                         if (invert) {
                             featureFlag = featureFlag.substring(1).trim();
                         }
-                        boolean flagEnabled =
-                                invert != flagsValueProvider.getBoolean(featureFlag);
+                        boolean flagEnabled = invert;
+                        try {
+                            flagEnabled = invert != flagsValueProvider.getBoolean(featureFlag);
+                        } catch (FlagReadException ignored) { }
                         if (!flagEnabled) {
                             continue;
                         }
diff --git a/tests/cts/permissionui/Android.bp b/tests/cts/permissionui/Android.bp
index c4ff0e069..c047b397d 100644
--- a/tests/cts/permissionui/Android.bp
+++ b/tests/cts/permissionui/Android.bp
@@ -44,6 +44,7 @@ android_test {
         "platform-test-annotations",
         "android.content.pm.flags-aconfig-java-export",
         "android.permission.flags-aconfig-java-export",
+        "com.android.permission.flags-aconfig-java-export",
     ],
     data: [
         ":CtsPermissionPolicyApp25",
diff --git a/tests/cts/permissionui/AndroidTest.xml b/tests/cts/permissionui/AndroidTest.xml
index a44909206..b73606f67 100644
--- a/tests/cts/permissionui/AndroidTest.xml
+++ b/tests/cts/permissionui/AndroidTest.xml
@@ -92,6 +92,12 @@
         <option name="teardown-command" value="rm -rf /data/local/tmp/cts-permissionui"/>
     </target_preparer>
 
+    <!-- Ensures that screen recording is captured -->
+    <target_preparer class="com.android.tradefed.targetprep.RootTargetPreparer">
+        <option name="force-root" value="true" />
+        <option name="throw-on-error" value="false" />
+    </target_preparer>
+
     <metrics_collector class="com.android.tradefed.device.metric.FilePullerLogCollector">
         <option name="directory-keys" value="/data/user/0/android.permissionui.cts/files" />
         <option name="collect-on-run-ended-only" value="true" />
diff --git a/tests/cts/permissionui/res/values-en-rGB/strings.xml b/tests/cts/permissionui/res/values-en-rGB/strings.xml
new file mode 100755
index 000000000..7c98df768
--- /dev/null
+++ b/tests/cts/permissionui/res/values-en-rGB/strings.xml
@@ -0,0 +1,21 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<!--
+  ~ Copyright (C) 2017 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<resources>
+    <string name="permissions">Permission</string>
+</resources>
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/AppPermissionTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/AppPermissionTest.kt
index 4ada5717e..f0c12171c 100644
--- a/tests/cts/permissionui/src/android/permissionui/cts/AppPermissionTest.kt
+++ b/tests/cts/permissionui/src/android/permissionui/cts/AppPermissionTest.kt
@@ -335,7 +335,10 @@ class AppPermissionTest : BaseUsePermissionTest() {
     }
 
     private fun assertAppPermissionRationaleContainerIsVisible(expected: Boolean) {
-        findView(By.res(APP_PERMISSION_RATIONALE_CONTAINER_VIEW), expected)
+        findView(
+            By.text(getPermissionControllerString(APP_PERMISSION_RATIONALE_TITLE_TEXT)),
+            expected
+        )
     }
 
     companion object {
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/BasePermissionTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/BasePermissionTest.kt
index 17785a95b..4af5d56c6 100644
--- a/tests/cts/permissionui/src/android/permissionui/cts/BasePermissionTest.kt
+++ b/tests/cts/permissionui/src/android/permissionui/cts/BasePermissionTest.kt
@@ -360,14 +360,7 @@ abstract class BasePermissionTest {
             .clickAndWait(Until.newWindow(), NEW_WINDOW_TIMEOUT_MILLIS)
     }
 
-    protected fun findView(selector: BySelector, expected: Boolean) {
-        val timeoutMs =
-            if (expected) {
-                10000L
-            } else {
-                1000L
-            }
-
+    protected fun findView(selector: BySelector, timeoutMs: Long, expected: Boolean) {
         val exception =
             try {
                 waitFindObject(selector, timeoutMs)
@@ -378,6 +371,18 @@ abstract class BasePermissionTest {
         Assert.assertTrue("Expected to find view: $expected", (exception == null) == expected)
     }
 
+    protected fun findView(selector: BySelector, expected: Boolean) {
+        val timeoutMs =
+            if (expected) {
+                // Small screens with larger font fail to find views within 10s while scrolling
+                15000L
+            } else {
+                1000L
+            }
+
+        findView(selector, timeoutMs, expected)
+    }
+
     protected fun clickPermissionControllerUi(selector: BySelector, timeoutMillis: Long = 20_000) {
         click(selector.pkg(context.packageManager.permissionControllerPackageName), timeoutMillis)
     }
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/BaseUsePermissionTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/BaseUsePermissionTest.kt
index 244d18ca6..2332ff0c7 100644
--- a/tests/cts/permissionui/src/android/permissionui/cts/BaseUsePermissionTest.kt
+++ b/tests/cts/permissionui/src/android/permissionui/cts/BaseUsePermissionTest.kt
@@ -51,7 +51,6 @@ import com.android.compatibility.common.util.SystemUtil
 import com.android.compatibility.common.util.SystemUtil.callWithShellPermissionIdentity
 import com.android.compatibility.common.util.SystemUtil.eventually
 import com.android.compatibility.common.util.SystemUtil.runWithShellPermissionIdentity
-import com.android.compatibility.common.util.UiAutomatorUtils2
 import com.android.modules.utils.build.SdkLevel
 import java.util.concurrent.CompletableFuture
 import java.util.concurrent.TimeUnit
@@ -123,8 +122,6 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
 
         const val ALLOW_ALWAYS_RADIO_BUTTON =
             "com.android.permissioncontroller:id/allow_always_radio_button"
-        const val ALLOW_RADIO_BUTTON_FRAME =
-            "com.android.permissioncontroller:id/allow_radio_button_frame"
         const val ALLOW_RADIO_BUTTON = "com.android.permissioncontroller:id/allow_radio_button"
         const val ALLOW_FOREGROUND_RADIO_BUTTON =
             "com.android.permissioncontroller:id/allow_foreground_only_radio_button"
@@ -145,12 +142,12 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
         const val DENY_AND_DONT_ASK_AGAIN_BUTTON_TEXT =
             "grant_dialog_button_deny_and_dont_ask_again"
         const val NO_UPGRADE_AND_DONT_ASK_AGAIN_BUTTON_TEXT = "grant_dialog_button_no_upgrade"
+        const val ECM_ALERT_DIALOG_OK_BUTTON_TEXT = "enhanced_confirmation_dialog_ok"
         const val ALERT_DIALOG_MESSAGE = "android:id/message"
         const val ALERT_DIALOG_OK_BUTTON = "android:id/button1"
-        const val APP_PERMISSION_RATIONALE_CONTAINER_VIEW =
-            "com.android.permissioncontroller:id/app_permission_rationale_container"
-        const val APP_PERMISSION_RATIONALE_CONTENT_VIEW =
-            "com.android.permissioncontroller:id/app_permission_rationale_content"
+        const val APP_PERMISSION_RATIONALE_TITLE_TEXT = "app_location_permission_rationale_title"
+        const val APP_PERMISSION_RATIONALE_SUBTITLE_TEXT =
+            "app_location_permission_rationale_subtitle"
         const val GRANT_DIALOG_PERMISSION_RATIONALE_CONTAINER_VIEW =
             "com.android.permissioncontroller:id/permission_rationale_container"
         const val PERMISSION_RATIONALE_ACTIVITY_TITLE_VIEW =
@@ -162,6 +159,8 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
         const val PURPOSE_TITLE_ID = "com.android.permissioncontroller:id/purpose_title"
         const val PURPOSE_MESSAGE_ID = "com.android.permissioncontroller:id/purpose_message"
         const val LEARN_MORE_TITLE_ID = "com.android.permissioncontroller:id/learn_more_title"
+        const val HELP_URL_ECM =
+            "com.android.permissioncontroller:id/help_url_action_disabled_by_restricted_settings"
         const val LEARN_MORE_MESSAGE_ID = "com.android.permissioncontroller:id/learn_more_message"
         const val DETAIL_MESSAGE_ID = "com.android.permissioncontroller:id/detail_message"
         const val PERMISSION_RATIONALE_SETTINGS_SECTION =
@@ -369,8 +368,7 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
         // dialog
         callWithShellPermissionIdentity {
             context.packageManager.resolveActivity(finishOnCreateIntent, PackageManager.MATCH_ALL)
-        }
-            ?: return
+        } ?: return
 
         // Start the test app, and expect the targetSDK warning dialog
         context.startActivity(finishOnCreateIntent)
@@ -486,31 +484,19 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
     }
 
     protected fun installPackageWithInstallSourceAndNoMetadataFromStore(apkName: String) {
-        installPackageViaSession(
-            apkName,
-            packageSource = PACKAGE_SOURCE_STORE
-        )
+        installPackageViaSession(apkName, packageSource = PACKAGE_SOURCE_STORE)
     }
 
     protected fun installPackageWithInstallSourceAndNoMetadataFromLocalFile(apkName: String) {
-        installPackageViaSession(
-            apkName,
-            packageSource = PACKAGE_SOURCE_LOCAL_FILE
-        )
+        installPackageViaSession(apkName, packageSource = PACKAGE_SOURCE_LOCAL_FILE)
     }
 
     protected fun installPackageWithInstallSourceAndNoMetadataFromDownloadedFile(apkName: String) {
-        installPackageViaSession(
-            apkName,
-            packageSource = PACKAGE_SOURCE_DOWNLOADED_FILE
-        )
+        installPackageViaSession(apkName, packageSource = PACKAGE_SOURCE_DOWNLOADED_FILE)
     }
 
     protected fun installPackageWithInstallSourceAndNoMetadataFromOther(apkName: String) {
-        installPackageViaSession(
-            apkName,
-            packageSource = PACKAGE_SOURCE_OTHER
-        )
+        installPackageViaSession(apkName, packageSource = PACKAGE_SOURCE_OTHER)
     }
 
     protected fun installPackageWithInstallSourceAndInvalidMetadata(apkName: String) {
@@ -893,7 +879,7 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
 
     protected fun clickPermissionRequestDenyButton() {
         if (isAutomotive) {
-            scrollToBottom();
+            scrollToBottom()
             clickAndWaitForWindowTransition(
                 By.text(getPermissionControllerString(DENY_BUTTON_TEXT))
             )
@@ -960,9 +946,10 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
             uiDevice.click(x.toInt(), y.toInt())
             waitForIdleLong()
             val nextScreenNode: AccessibilityNodeInfo? =
-                    findAccessibilityNodeInfosByTextForSurfaceView(
-                        uiAutomation.rootInActiveWindow,
-                        "All the time")
+                findAccessibilityNodeInfosByTextForSurfaceView(
+                    uiAutomation.rootInActiveWindow,
+                    "All the time"
+                )
             if (nextScreenNode != null) {
                 clickedOnLink = true
                 break
@@ -973,7 +960,7 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
 
     protected fun clickPermissionRequestDenyAndDontAskAgainButton() {
         if (isAutomotive) {
-            scrollToBottom();
+            scrollToBottom()
             clickAndWaitForWindowTransition(
                 By.text(getPermissionControllerString(DENY_AND_DONT_ASK_AGAIN_BUTTON_TEXT))
             )
@@ -1004,7 +991,9 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
     }
 
     protected fun clickPermissionRationaleContentInAppPermission() {
-        clickAndWaitForWindowTransition(By.res(APP_PERMISSION_RATIONALE_CONTENT_VIEW))
+        clickAndWaitForWindowTransition(
+            By.text(getPermissionControllerString(APP_PERMISSION_RATIONALE_SUBTITLE_TEXT))
+        )
     }
 
     protected fun clickPermissionRationaleViewInGrantDialog() {
@@ -1114,6 +1103,21 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
         }
     }
 
+    @Suppress("DEPRECATION")
+    protected fun startManageAppPermissionsActivity() {
+        doAndWaitForWindowTransition {
+            runWithShellPermissionIdentity {
+                context.startActivity(
+                    Intent(Intent.ACTION_MANAGE_APP_PERMISSIONS).apply {
+                        addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
+                        addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK)
+                        putExtra(Intent.EXTRA_PACKAGE_NAME, APP_PACKAGE_NAME)
+                    }
+                )
+            }
+        }
+    }
+
     /** Starts activity with intent [ACTION_REVIEW_APP_DATA_SHARING_UPDATES]. */
     fun startAppDataSharingUpdatesActivity() {
         doAndWaitForWindowTransition {
@@ -1335,6 +1339,7 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
             android.Manifest.permission.ACCESS_BACKGROUND_LOCATION -> true
             else -> false
         }
+
     private fun showsAllowPhotosButton(permission: String): Boolean {
         if (!isPhotoPickerPermissionPromptEnabled()) {
             return false
@@ -1451,4 +1456,19 @@ abstract class BaseUsePermissionTest : BasePermissionTest() {
             }
         }
     }
+
+    protected fun clickECMAlertDialogOKButton(waitForWindowTransition: Boolean = !isWatch) {
+        var action = { click(By.res(ALERT_DIALOG_OK_BUTTON), TIMEOUT_MILLIS) }
+        if (isWatch) {
+            val okButtonText =
+                getPermissionControllerResString(ECM_ALERT_DIALOG_OK_BUTTON_TEXT) ?: "OK"
+            action = { click(By.text(okButtonText), TIMEOUT_MILLIS) }
+        }
+
+        if (waitForWindowTransition) {
+            doAndWaitForWindowTransition { action() }
+        } else {
+            action()
+        }
+    }
 }
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/CameraMicIndicatorsPermissionTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/CameraMicIndicatorsPermissionTest.kt
index 9325ff8fb..e3197599c 100644
--- a/tests/cts/permissionui/src/android/permissionui/cts/CameraMicIndicatorsPermissionTest.kt
+++ b/tests/cts/permissionui/src/android/permissionui/cts/CameraMicIndicatorsPermissionTest.kt
@@ -29,12 +29,14 @@ import android.os.Process
 import android.os.SystemClock
 import android.os.SystemProperties
 import android.permission.PermissionManager
+import android.permission.cts.MtsIgnore
 import android.platform.test.annotations.AsbSecurityTest
 import android.platform.test.rule.ScreenRecordRule
 import android.provider.DeviceConfig
 import android.provider.Settings
 import android.safetycenter.SafetyCenterManager
 import android.server.wm.WindowManagerStateHelper
+import android.util.Log
 import androidx.annotation.RequiresApi
 import androidx.test.filters.FlakyTest
 import androidx.test.filters.SdkSuppress
@@ -85,8 +87,7 @@ private const val PRIVACY_ITEM_ID = "com.android.systemui:id/privacy_item"
 private const val INDICATORS_FLAG = "camera_mic_icons_enabled"
 private const val WEAR_MIC_LABEL = "Microphone"
 private const val PERMISSION_INDICATORS_NOT_PRESENT = 162547999L
-private const val IDLE_TIMEOUT_MILLIS: Long = 1000
-private const val UNEXPECTED_TIMEOUT_MILLIS = 1000L
+private const val IDLE_TIMEOUT_MILLIS: Long = 2000
 private const val TIMEOUT_MILLIS: Long = 20000
 private const val TV_MIC_INDICATOR_WINDOW_TITLE = "MicrophoneCaptureIndicator"
 private const val MIC_LABEL_NAME = "microphone_toggle_label_qs"
@@ -137,6 +138,7 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
         private const val AUTO_MIC_INDICATOR_DISMISSAL_TIMEOUT_MS = 30_000L
         const val SAFETY_CENTER_ENABLED = "safety_center_is_enabled"
         const val DELAY_MILLIS = 3000L
+        private val TAG = CameraMicIndicatorsPermissionTest::class.java.simpleName
     }
 
     private val safetyCenterEnabled = callWithShellPermissionIdentity {
@@ -260,6 +262,7 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
         val manager = context.getSystemService(CameraManager::class.java)!!
         assumeTrue(manager.cameraIdList.isNotEmpty())
         changeSafetyCenterFlag(false.toString())
+        assumeSafetyCenterDisabled()
         testCameraAndMicIndicator(useMic = false, useCamera = true)
     }
 
@@ -267,20 +270,27 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
     @CddTest(requirement = "9.8.2/H-4-1,T-4-1,A-1-1")
     fun testMicIndicator() {
         changeSafetyCenterFlag(false.toString())
+        assumeSafetyCenterDisabled()
         testCameraAndMicIndicator(useMic = true, useCamera = false)
     }
 
     @Test
     @AsbSecurityTest(cveBugId = [258672042])
+    @MtsIgnore(bugId = 351903707)
     fun testMicIndicatorWithManualFinishOpStillShows() {
-        changeSafetyCenterFlag(false.toString())
-        testCameraAndMicIndicator(useMic = true, useCamera = false, finishEarly = true)
+        testCameraAndMicIndicator(
+            useMic = true,
+            useCamera = false,
+            finishEarly = true,
+            safetyCenterEnabled = getSafetyCenterEnabled()
+        )
     }
 
     @Test
     @CddTest(requirement = "9.8.2/H-4-1,T-4-1,A-1-1")
     fun testHotwordIndicatorBehavior() {
         changeSafetyCenterFlag(false.toString())
+        assumeSafetyCenterDisabled()
         testCameraAndMicIndicator(useMic = false, useCamera = false, useHotword = true)
     }
 
@@ -295,6 +305,7 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
         // If camera is not available skip the test
         assumeTrue(packageManager.hasSystemFeature(PackageManager.FEATURE_CAMERA_ANY))
         changeSafetyCenterFlag(false.toString())
+        assumeSafetyCenterDisabled()
         testCameraAndMicIndicator(useMic = false, useCamera = true, chainUsage = true)
     }
 
@@ -359,6 +370,11 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
         safetyCenterEnabled: Boolean = false,
         finishEarly: Boolean = false
     ) {
+        Log.d(
+            TAG,
+            "testCameraAndMicIndicator useMic=$useMic useCamera=$useCamera " +
+                "safetyCenterEnabled=$safetyCenterEnabled finishEarly=$finishEarly"
+        )
         // If camera is not available skip the test
         if (useCamera) {
             assumeTrue(packageManager.hasSystemFeature(PackageManager.FEATURE_CAMERA_ANY))
@@ -392,6 +408,7 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
                 }
             }
 
+            Log.d(TAG, "assert to make sure Indicators are displayed")
             assertIndicatorsShown(useMic, useCamera, useHotword, chainUsage, safetyCenterEnabled)
 
             if (finishEarly) {
@@ -400,10 +417,13 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
                 try {
                     // Check if the indicator has gone away. This will throw an exception if the
                     // indicator is still present
+                    Log.d(TAG, "checking on indicators again")
                     assertIndicatorsShown(false, false, false)
+                    Log.d(TAG, "indicators are gone")
                     // If we successfully asserted that the indicator went away, fail the test
                     failed = true
                 } catch (t: Throwable) {
+                    Log.d(TAG, "indicators are continuing to show")
                     // expected
                 }
                 if (failed) {
@@ -443,6 +463,13 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
                 } else {
                     useMic
                 }
+            if (!micInUse && !useCamera) {
+                // We're asserting the indicator is gone. Wait up to IDLE_TIMEOUT after the quick
+                // settings is opened to see if we find the indicator, so we don't automatically
+                // assert the indicator is gone, just because we didn't open quick settings fast
+                // enough.
+                UiAutomatorUtils2.waitFindObjectOrNull(By.res(PRIVACY_CHIP_ID), IDLE_TIMEOUT_MILLIS)
+            }
             assertPrivacyChipAndIndicatorsPresent(
                 micInUse,
                 useCamera,
@@ -573,6 +600,7 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
                 privacyChip.click()
             }
         } else {
+            Log.d(TAG, "waiting for PRIVACY_CHIP_ID to disappear")
             assertWithUiDump { UiAutomatorUtils2.waitUntilObjectGone(By.res(PRIVACY_CHIP_ID)) }
             return
         }
@@ -677,10 +705,17 @@ class CameraMicIndicatorsPermissionTest : StsExtraBusinessLogicTestCase {
 
     @RequiresApi(Build.VERSION_CODES.TIRAMISU)
     private fun assumeSafetyCenterEnabled() {
-        val safetyCenterManager = context.getSystemService(SafetyCenterManager::class.java)!!
-        val isSafetyCenterEnabled: Boolean =
-            runWithShellPermissionIdentity<Boolean> { safetyCenterManager.isSafetyCenterEnabled }
-        assumeTrue(isSafetyCenterEnabled)
+        assumeTrue(getSafetyCenterEnabled())
+    }
+
+    private fun assumeSafetyCenterDisabled() {
+        assumeFalse(getSafetyCenterEnabled())
+    }
+
+    private fun getSafetyCenterEnabled(): Boolean {
+        val safetyCenterManager =
+            context.getSystemService(SafetyCenterManager::class.java) ?: return false
+        return runWithShellPermissionIdentity<Boolean> { safetyCenterManager.isSafetyCenterEnabled }
     }
 
     protected fun waitFindObject(selector: BySelector): UiObject2? {
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/EnhancedConfirmationBackportTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/EnhancedConfirmationBackportTest.kt
new file mode 100644
index 000000000..f38f678e9
--- /dev/null
+++ b/tests/cts/permissionui/src/android/permissionui/cts/EnhancedConfirmationBackportTest.kt
@@ -0,0 +1,146 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package android.permissionui.cts
+
+import android.Manifest.permission_group.SMS
+import android.os.Build
+import android.platform.test.annotations.RequiresFlagsDisabled
+import android.platform.test.annotations.RequiresFlagsEnabled
+import android.platform.test.flag.junit.CheckFlagsRule
+import android.platform.test.flag.junit.DeviceFlagsValueProvider
+import androidx.test.filters.SdkSuppress
+import androidx.test.uiautomator.By
+import androidx.test.uiautomator.Until
+import com.android.modules.utils.build.SdkLevel
+import com.android.permission.flags.Flags
+import org.junit.Assume.assumeFalse
+import org.junit.Before
+import org.junit.Rule
+import org.junit.Test
+
+/** Enhanced Confirmation Backport UI tests.  */
+@SdkSuppress(minSdkVersion = Build.VERSION_CODES.TIRAMISU, codeName = "Tiramisu")
+class EnhancedConfirmationBackportTest : BaseUsePermissionTest() {
+
+    @JvmField
+    @Rule
+    val checkFlagsRule: CheckFlagsRule = DeviceFlagsValueProvider.createCheckFlagsRule()
+
+    @Before
+    fun setup() {
+        assumeFalse(isAutomotive)
+        assumeFalse(isTv)
+        assumeFalse(isWatch)
+    }
+
+    @SdkSuppress(minSdkVersion = Build.VERSION_CODES.TIRAMISU, codeName = "Tiramisu")
+    @RequiresFlagsEnabled(Flags.FLAG_ENHANCED_CONFIRMATION_BACKPORT_ENABLED)
+    @Test
+    fun installDownloadedFile_clickAppPermissions_clickAllowRestrictedSettings_clickSMSPermGroup_clickAllowed() {
+        installPackageWithInstallSourceAndNoMetadataFromDownloadedFile(APP_APK_NAME_LATEST)
+
+        startManageAppPermissionsActivity()
+        waitFindObject(By.descContains(MORE_OPTIONS)).clickAndWait(
+            Until.newWindow(),
+            BasePermissionTest.TIMEOUT_MILLIS
+        )
+
+        if (!SdkLevel.isAtLeastV()) {
+            waitFindObject(By.text(ALLOW_RESTRICTED_SETTINGS)).click()
+
+            pressBack()
+
+            navigateToIndividualPermissionSetting(SMS)
+
+            assertAllowButtonIsEnabledAndClickAndChecked()
+
+            pressBack()
+        } else {
+            findView(By.text(ALLOW_RESTRICTED_SETTINGS), false)
+        }
+
+        pressBack()
+    }
+
+    @SdkSuppress(minSdkVersion = Build.VERSION_CODES.TIRAMISU, codeName = "Tiramisu")
+    @RequiresFlagsEnabled(Flags.FLAG_ENHANCED_CONFIRMATION_BACKPORT_ENABLED)
+    @Test
+    fun installFromLocalFile_clickAppPermissions_clickAllowRestrictedSettings_clickSMSPermGroup_clickAllowed() {
+        installPackageWithInstallSourceAndNoMetadataFromLocalFile(APP_APK_NAME_LATEST)
+
+        startManageAppPermissionsActivity()
+        waitFindObject(By.descContains(MORE_OPTIONS)).click()
+
+        if (!SdkLevel.isAtLeastV()) {
+            waitFindObject(By.text(ALLOW_RESTRICTED_SETTINGS)).click()
+
+            pressBack()
+
+            navigateToIndividualPermissionSetting(SMS)
+
+            assertAllowButtonIsEnabledAndClickAndChecked()
+
+            pressBack()
+        } else {
+            findView(By.text(ALLOW_RESTRICTED_SETTINGS), false)
+        }
+
+        pressBack()
+    }
+
+    @SdkSuppress(minSdkVersion = Build.VERSION_CODES.TIRAMISU, codeName = "Tiramisu")
+    @RequiresFlagsDisabled(Flags.FLAG_ENHANCED_CONFIRMATION_BACKPORT_ENABLED)
+    @Test
+    fun installDownloadedFile_clickAppPermissions_noAllowRestrictedSettings() {
+        installPackageWithInstallSourceAndNoMetadataFromDownloadedFile(APP_APK_NAME_LATEST)
+
+        startManageAppPermissionsActivity()
+        waitFindObject(By.descContains(MORE_OPTIONS)).clickAndWait(
+            Until.newWindow(),
+            BasePermissionTest.TIMEOUT_MILLIS
+        )
+
+        findView(By.text(ALLOW_RESTRICTED_SETTINGS), false)
+
+        pressBack()
+    }
+
+    @SdkSuppress(minSdkVersion = Build.VERSION_CODES.TIRAMISU, codeName = "Tiramisu")
+    @RequiresFlagsDisabled(Flags.FLAG_ENHANCED_CONFIRMATION_BACKPORT_ENABLED)
+    @Test
+    fun installFromLocalFile_clickAppPermissions_noAllowRestrictedSettings() {
+        installPackageWithInstallSourceAndNoMetadataFromLocalFile(APP_APK_NAME_LATEST)
+
+        startManageAppPermissionsActivity()
+        waitFindObject(By.descContains(MORE_OPTIONS)).click()
+
+        findView(By.text(ALLOW_RESTRICTED_SETTINGS), false)
+
+        pressBack()
+    }
+
+    private fun assertAllowButtonIsEnabledAndClickAndChecked() {
+        waitFindObject(By.res(ALLOW_RADIO_BUTTON).enabled(true).checked(false))
+            .click()
+        waitFindObject(By.res(ALLOW_RADIO_BUTTON).checked(true))
+    }
+
+    companion object {
+        private const val MORE_OPTIONS = "More options"
+        private const val ALLOW_RESTRICTED_SETTINGS = "Allow restricted settings"
+    }
+}
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/EnhancedConfirmationManagerTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/EnhancedConfirmationManagerTest.kt
index c91201625..8e91a00ce 100644
--- a/tests/cts/permissionui/src/android/permissionui/cts/EnhancedConfirmationManagerTest.kt
+++ b/tests/cts/permissionui/src/android/permissionui/cts/EnhancedConfirmationManagerTest.kt
@@ -62,12 +62,16 @@ class EnhancedConfirmationManagerTest : BaseUsePermissionTest() {
     val mCheckFlagsRule: CheckFlagsRule = DeviceFlagsValueProvider.createCheckFlagsRule()
 
     @Before
-    fun assumeNotAutoTvOrWear() {
+    fun assumeNotAutoOrTv() {
         Assume.assumeFalse(packageManager.hasSystemFeature(PackageManager.FEATURE_LEANBACK))
-        Assume.assumeFalse(
-            packageManager.hasSystemFeature(PackageManager.FEATURE_AUTOMOTIVE)
-        )
-        Assume.assumeFalse(packageManager.hasSystemFeature(PackageManager.FEATURE_WATCH))
+        Assume.assumeFalse(packageManager.hasSystemFeature(PackageManager.FEATURE_AUTOMOTIVE))
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_ENHANCED_CONFIRMATION_MODE_APIS_ENABLED)
+    @Test
+    fun helpUrlActionLinkIsNotEmpty() {
+        val helpUrl = getPermissionControllerResString(HELP_URL_ECM)
+        assertFalse(helpUrl?.length == 0)
     }
 
     @RequiresFlagsEnabled(Flags.FLAG_ENHANCED_CONFIRMATION_MODE_APIS_ENABLED)
@@ -184,7 +188,7 @@ class EnhancedConfirmationManagerTest : BaseUsePermissionTest() {
             )
 
         requestAppPermissionsAndAssertResult(*permissionAndExpectedGrantResults) {
-            click(By.res(ALERT_DIALOG_OK_BUTTON), TIMEOUT_MILLIS)
+            clickECMAlertDialogOKButton(waitForWindowTransition = false)
         }
         assertTrue(isClearRestrictionAllowed(APP_PACKAGE_NAME))
 
@@ -211,8 +215,8 @@ class EnhancedConfirmationManagerTest : BaseUsePermissionTest() {
             GROUP_2_PERMISSION_2_RESTRICTED to false,
             waitForWindowTransition = false
         ) {
-            doAndWaitForWindowTransition { click(By.res(ALERT_DIALOG_OK_BUTTON), TIMEOUT_MILLIS) }
-            doAndWaitForWindowTransition { clickPermissionRequestDenyButton() }
+            clickECMAlertDialogOKButton()
+            clickPermissionRequestDenyButton()
         }
         assertTrue(isClearRestrictionAllowed(APP_PACKAGE_NAME))
 
@@ -221,7 +225,7 @@ class EnhancedConfirmationManagerTest : BaseUsePermissionTest() {
             GROUP_3_PERMISSION_2_UNRESTRICTED to true,
             waitForWindowTransition = false
         ) {
-            doAndWaitForWindowTransition { clickPermissionRequestAllowForegroundButton() }
+            clickPermissionRequestAllowForegroundButton()
         }
         assertTrue(isClearRestrictionAllowed(APP_PACKAGE_NAME))
     }
@@ -238,8 +242,8 @@ class EnhancedConfirmationManagerTest : BaseUsePermissionTest() {
             GROUP_2_PERMISSION_1_RESTRICTED to false,
             waitForWindowTransition = false
         ) {
-            doAndWaitForWindowTransition { click(By.res(ALERT_DIALOG_OK_BUTTON), TIMEOUT_MILLIS) }
-            doAndWaitForWindowTransition { clickPermissionRequestAllowForegroundButton() }
+            clickECMAlertDialogOKButton()
+            clickPermissionRequestAllowForegroundButton()
         }
         assertTrue(isClearRestrictionAllowed(APP_PACKAGE_NAME))
     }
@@ -256,8 +260,8 @@ class EnhancedConfirmationManagerTest : BaseUsePermissionTest() {
             GROUP_2_PERMISSION_1_RESTRICTED to false,
             waitForWindowTransition = false
         ) {
-            doAndWaitForWindowTransition { click(By.res(ALERT_DIALOG_OK_BUTTON), TIMEOUT_MILLIS) }
-            doAndWaitForWindowTransition { clickPermissionRequestAllowForegroundButton() }
+            clickECMAlertDialogOKButton()
+            clickPermissionRequestAllowForegroundButton()
         }
         assertTrue(isClearRestrictionAllowed(APP_PACKAGE_NAME))
     }
@@ -269,7 +273,17 @@ class EnhancedConfirmationManagerTest : BaseUsePermissionTest() {
     private fun assertNoEcmDialogShown() {
         assertNull(
             "expected to not see dialog",
-            waitFindObjectOrNull(By.res(ALERT_DIALOG_OK_BUTTON), UNEXPECTED_TIMEOUT_MILLIS.toLong())
+            if (isWatch) {
+                waitFindObjectOrNull(
+                    By.text(getPermissionControllerString(ECM_ALERT_DIALOG_OK_BUTTON_TEXT)),
+                    UNEXPECTED_TIMEOUT_MILLIS.toLong()
+                )
+            } else {
+                waitFindObjectOrNull(
+                    By.res(ALERT_DIALOG_OK_BUTTON),
+                    UNEXPECTED_TIMEOUT_MILLIS.toLong()
+                )
+            }
         )
     }
 
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/NotificationPermissionTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/NotificationPermissionTest.kt
index 9b72d1706..c8298b19a 100644
--- a/tests/cts/permissionui/src/android/permissionui/cts/NotificationPermissionTest.kt
+++ b/tests/cts/permissionui/src/android/permissionui/cts/NotificationPermissionTest.kt
@@ -27,7 +27,6 @@ import android.content.IntentFilter
 import android.content.pm.PackageManager
 import android.content.pm.PackageManager.PERMISSION_GRANTED
 import android.os.Build
-import android.os.UserHandle
 import android.provider.Settings
 import androidx.test.filters.FlakyTest
 import androidx.test.filters.SdkSuppress
@@ -60,7 +59,7 @@ const val EXPECTED_TIMEOUT_MS = 2000L
 class NotificationPermissionTest : BaseUsePermissionTest() {
 
     private val cr = callWithShellPermissionIdentity {
-        context.createContextAsUser(UserHandle.SYSTEM, 0).contentResolver
+        context.createContextAsUser(context.getUser(), 0).contentResolver
     }
     private var previousEnableState = -1
     private var countDown: CountDownLatch = CountDownLatch(1)
@@ -71,8 +70,7 @@ class NotificationPermissionTest : BaseUsePermissionTest() {
                 allowedGroups =
                     intent?.getStringArrayListExtra(
                         PackageManager.EXTRA_REQUEST_PERMISSIONS_RESULTS
-                    )
-                        ?: emptyList()
+                    ) ?: emptyList()
                 countDown.countDown()
             }
         }
@@ -153,6 +151,7 @@ class NotificationPermissionTest : BaseUsePermissionTest() {
         launchApp(createChannels = false)
         assertDialogNotShowing()
     }
+
     @Test
     fun notificationPromptDoesNotShowForNonLauncherIntentCategoryLaunches_onChannelCreate() {
         installPackage(APP_APK_PATH_CREATE_NOTIFICATION_CHANNELS_31, expectSuccess = true)
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/PermissionRationaleTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/PermissionRationaleTest.kt
index e20fdeffd..21df728ef 100644
--- a/tests/cts/permissionui/src/android/permissionui/cts/PermissionRationaleTest.kt
+++ b/tests/cts/permissionui/src/android/permissionui/cts/PermissionRationaleTest.kt
@@ -170,7 +170,9 @@ class PermissionRationaleTest : BaseUsePermissionTest() {
 
         clicksSettings_doesNothing_leaves()
 
-        eventually { assertPermissionRationaleDialogIsVisible(true) }
+        // Eventually requires a longer timeout than that of all internal ui checks in
+        // assertPermissionRationaleDialogIsVisible
+        eventually({ assertPermissionRationaleDialogIsVisible(true) }, 75000L)
     }
 
     @Test
@@ -223,7 +225,7 @@ class PermissionRationaleTest : BaseUsePermissionTest() {
     }
 
     private fun clickInstallSourceLink() {
-        findView(By.res(DATA_SHARING_SOURCE_MESSAGE_ID), true)
+        findView(By.res(DATA_SHARING_SOURCE_MESSAGE_ID), 20000L, true)
 
         eventually {
             // UiObject2 doesn't expose CharSequence.
diff --git a/tests/cts/permissionui/src/android/permissionui/cts/PermissionReviewTapjackingTest.kt b/tests/cts/permissionui/src/android/permissionui/cts/PermissionReviewTapjackingTest.kt
index a75f08916..14901eb2a 100644
--- a/tests/cts/permissionui/src/android/permissionui/cts/PermissionReviewTapjackingTest.kt
+++ b/tests/cts/permissionui/src/android/permissionui/cts/PermissionReviewTapjackingTest.kt
@@ -44,6 +44,8 @@ class PermissionReviewTapjackingTest : BaseUsePermissionTest() {
         installPackage(APP_APK_PATH_22)
         installPackage(HELPER_APP_OVERLAY)
 
+        Thread.sleep(1000)
+
         SystemUtil.runShellCommandOrThrow(
             "appops set $HELPER_PACKAGE_NAME android:system_alert_window allow"
         )
@@ -90,7 +92,7 @@ class PermissionReviewTapjackingTest : BaseUsePermissionTest() {
             // expected
         }
 
-        pressHome()
+        pressBack()
         findOverlay()
     }
 
diff --git a/tests/cts/safetycenter/src/android/safetycenter/cts/SafetyCenterManagerTest.kt b/tests/cts/safetycenter/src/android/safetycenter/cts/SafetyCenterManagerTest.kt
index 298d7643c..8fd45efb8 100644
--- a/tests/cts/safetycenter/src/android/safetycenter/cts/SafetyCenterManagerTest.kt
+++ b/tests/cts/safetycenter/src/android/safetycenter/cts/SafetyCenterManagerTest.kt
@@ -95,6 +95,7 @@ import com.google.common.util.concurrent.MoreExecutors.directExecutor
 import kotlin.test.assertFails
 import kotlin.test.assertFailsWith
 import kotlinx.coroutines.TimeoutCancellationException
+import org.junit.Assume.assumeFalse
 import org.junit.Assume.assumeTrue
 import org.junit.Rule
 import org.junit.Test
@@ -788,6 +789,10 @@ class SafetyCenterManagerTest {
 
     @Test
     fun safetyCenterEnabledChanged_whenImplicitReceiverHasPermission_receiverCalled() {
+        assumeTrue(
+            "Cannot toggle SafetyCenter using DeviceConfig",
+            SafetyCenterTestHelper.safetyCenterCanBeToggledUsingDeviceConfig()
+        )
         // Implicit broadcast is only sent to system user.
         assumeTrue(context.getSystemService(UserManager::class.java)!!.isSystemUser)
         val enabledChangedReceiver = SafetyCenterEnabledChangedReceiver(context)
@@ -806,6 +811,10 @@ class SafetyCenterManagerTest {
 
     @Test
     fun safetyCenterEnabledChanged_whenImplicitReceiverDoesntHavePermission_receiverNotCalled() {
+        assumeTrue(
+            "Cannot toggle SafetyCenter using DeviceConfig",
+            SafetyCenterTestHelper.safetyCenterCanBeToggledUsingDeviceConfig()
+        )
         // Implicit broadcast is only sent to system user.
         assumeTrue(context.getSystemService(UserManager::class.java)!!.isSystemUser)
         val enabledChangedReceiver = SafetyCenterEnabledChangedReceiver(context)
@@ -818,6 +827,10 @@ class SafetyCenterManagerTest {
 
     @Test
     fun safetyCenterEnabledChanged_whenSourceReceiverHasPermission_receiverCalled() {
+        assumeTrue(
+            "Cannot toggle SafetyCenter using DeviceConfig",
+            SafetyCenterTestHelper.safetyCenterCanBeToggledUsingDeviceConfig()
+        )
         safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.singleSourceConfig)
 
         val receiverValue =
@@ -833,6 +846,10 @@ class SafetyCenterManagerTest {
 
     @Test
     fun safetyCenterEnabledChanged_valueDoesntChange_receiverNotCalled() {
+        assumeTrue(
+            "Cannot toggle SafetyCenter using DeviceConfig",
+            SafetyCenterTestHelper.safetyCenterCanBeToggledUsingDeviceConfig()
+        )
         safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.singleSourceConfig)
 
         assertFailsWith(TimeoutCancellationException::class) {
@@ -845,6 +862,10 @@ class SafetyCenterManagerTest {
 
     @Test
     fun safetyCenterEnabledChanged_whenSourceReceiverDoesntHavePermission_receiverNotCalled() {
+        assumeTrue(
+            "Cannot toggle SafetyCenter using DeviceConfig",
+            SafetyCenterTestHelper.safetyCenterCanBeToggledUsingDeviceConfig()
+        )
         safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.singleSourceConfig)
 
         assertFailsWith(TimeoutCancellationException::class) {
@@ -854,6 +875,26 @@ class SafetyCenterManagerTest {
 
     @Test
     fun safetyCenterEnabledChanged_whenSourceReceiverNotInConfig_receiverNotCalled() {
+        assumeTrue(
+            "Cannot toggle SafetyCenter using DeviceConfig",
+            SafetyCenterTestHelper.safetyCenterCanBeToggledUsingDeviceConfig()
+        )
+        assertFailsWith(TimeoutCancellationException::class) {
+            SafetySourceReceiver.setSafetyCenterEnabledWithReceiverPermissionAndWait(
+                false,
+                TIMEOUT_SHORT
+            )
+        }
+    }
+
+    @Test
+    fun safetyCenterEnabledChanged_whenNoDeviceConfigFlag_receiverNotCalled() {
+        assumeFalse(
+            "SafetyCenter DeviceConfig flag is in use",
+            SafetyCenterTestHelper.safetyCenterCanBeToggledUsingDeviceConfig()
+        )
+        safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.singleSourceConfig)
+
         assertFailsWith(TimeoutCancellationException::class) {
             SafetySourceReceiver.setSafetyCenterEnabledWithReceiverPermissionAndWait(
                 false,
diff --git a/tests/functional/safetycenter/singleuser/src/android/safetycenter/functional/SafetyCenterManagerTest.kt b/tests/functional/safetycenter/singleuser/src/android/safetycenter/functional/SafetyCenterManagerTest.kt
index 4f06c0f3f..cb3935ec5 100644
--- a/tests/functional/safetycenter/singleuser/src/android/safetycenter/functional/SafetyCenterManagerTest.kt
+++ b/tests/functional/safetycenter/singleuser/src/android/safetycenter/functional/SafetyCenterManagerTest.kt
@@ -22,6 +22,9 @@ import android.content.Intent
 import android.os.Build.VERSION_CODES.TIRAMISU
 import android.os.Build.VERSION_CODES.UPSIDE_DOWN_CAKE
 import android.os.UserHandle
+import android.platform.test.annotations.RequiresFlagsDisabled
+import android.platform.test.annotations.RequiresFlagsEnabled
+import android.platform.test.flag.junit.DeviceFlagsValueProvider
 import android.safetycenter.SafetyCenterData
 import android.safetycenter.SafetyCenterEntry
 import android.safetycenter.SafetyCenterEntry.ENTRY_SEVERITY_LEVEL_CRITICAL_WARNING
@@ -64,6 +67,7 @@ import androidx.test.ext.junit.runners.AndroidJUnit4
 import androidx.test.filters.SdkSuppress
 import com.android.compatibility.common.util.SystemUtil
 import com.android.modules.utils.build.SdkLevel
+import com.android.permission.flags.Flags
 import com.android.safetycenter.internaldata.SafetyCenterBundles
 import com.android.safetycenter.internaldata.SafetyCenterBundles.ISSUES_TO_GROUPS_BUNDLE_KEY
 import com.android.safetycenter.internaldata.SafetyCenterEntryId
@@ -783,8 +787,9 @@ class SafetyCenterManagerTest {
                 )
             )
 
-    @get:Rule(order = 1) val supportsSafetyCenterRule = SupportsSafetyCenterRule(context)
-    @get:Rule(order = 2) val safetyCenterTestRule = SafetyCenterTestRule(safetyCenterTestHelper)
+    @get:Rule(order = 1) val flagsRule = DeviceFlagsValueProvider.createCheckFlagsRule()
+    @get:Rule(order = 2) val supportsSafetyCenterRule = SupportsSafetyCenterRule(context)
+    @get:Rule(order = 3) val safetyCenterTestRule = SafetyCenterTestRule(safetyCenterTestHelper)
 
     @Test
     fun getSafetySourceData_differentPackageWithManageSafetyCenterPermission_returnsData() {
@@ -3152,6 +3157,105 @@ class SafetyCenterManagerTest {
         assertThat(apiSafetyCenterData).isEqualTo(expectedSafetyCenterData)
     }
 
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_SAFETY_CENTER_ISSUE_ONLY_AFFECTS_GROUP_STATUS)
+    fun getSafetyCenterData_entryGroupWithIssueOnlySourceHighestOfGroup_affectsEntryGroupStatus() {
+        safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.entryGroupWithIssueOnlyConfig)
+        safetyCenterTestHelper.setData(SOURCE_ID_1, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(SOURCE_ID_2, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(
+            ISSUE_ONLY_ALL_OPTIONAL_ID,
+            SafetySourceTestData.issuesOnly(safetySourceTestData.recommendationGeneralIssue)
+        )
+
+        val apiSafetyCenterData = safetyCenterManager.getSafetyCenterDataWithPermission()
+
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.severityLevel)
+            .isEqualTo(ENTRY_SEVERITY_LEVEL_RECOMMENDATION)
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.summary!!.toString())
+            .isEqualTo("Recommendation issue title")
+    }
+
+    @Test
+    @RequiresFlagsEnabled(Flags.FLAG_SAFETY_CENTER_ISSUE_ONLY_AFFECTS_GROUP_STATUS)
+    fun getSafetyCenterData_entryGroupWithIssueOnlySourceSameAsGroup_affectsTitle() {
+        safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.entryGroupWithIssueOnlyConfig)
+        safetyCenterTestHelper.setData(SOURCE_ID_1, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(SOURCE_ID_2, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(
+            ISSUE_ONLY_ALL_OPTIONAL_ID,
+            SafetySourceTestData.issuesOnly(safetySourceTestData.informationIssue)
+        )
+
+        val apiSafetyCenterData = safetyCenterManager.getSafetyCenterDataWithPermission()
+
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.severityLevel)
+            .isEqualTo(ENTRY_SEVERITY_LEVEL_OK)
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.summary!!.toString())
+            .isEqualTo("Information issue title")
+    }
+
+    @Test
+    fun getSafetyCenterData_entryGroupWithIssueOnlySourceNotHighest_doesntAffectEntryGroupStatus() {
+        safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.entryGroupWithIssueOnlyConfig)
+        safetyCenterTestHelper.setData(
+            SOURCE_ID_1,
+            safetySourceTestData.recommendationWithGeneralIssue
+        )
+        safetyCenterTestHelper.setData(SOURCE_ID_2, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(
+            ISSUE_ONLY_ALL_OPTIONAL_ID,
+            SafetySourceTestData.issuesOnly(safetySourceTestData.informationIssue)
+        )
+
+        val apiSafetyCenterData = safetyCenterManager.getSafetyCenterDataWithPermission()
+
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.severityLevel)
+            .isEqualTo(ENTRY_SEVERITY_LEVEL_RECOMMENDATION)
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.summary!!.toString())
+            .isEqualTo("Recommendation summary")
+    }
+
+    @Test
+    fun getSafetyCenterData_entryGroupWithIssueOnlySourceDismissed_doesntAffectEntryGroupStatus() {
+        safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.entryGroupWithIssueOnlyConfig)
+        safetyCenterTestHelper.setData(SOURCE_ID_1, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(SOURCE_ID_2, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(
+            ISSUE_ONLY_ALL_OPTIONAL_ID,
+            SafetySourceTestData.issuesOnly(safetySourceTestData.recommendationGeneralIssue)
+        )
+        safetyCenterManager.dismissSafetyCenterIssueWithPermission(
+            SafetyCenterTestData.issueId(ISSUE_ONLY_ALL_OPTIONAL_ID, RECOMMENDATION_ISSUE_ID)
+        )
+
+        val apiSafetyCenterData = safetyCenterManager.getSafetyCenterDataWithPermission()
+
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.severityLevel)
+            .isEqualTo(ENTRY_SEVERITY_LEVEL_OK)
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.summary!!.toString())
+            .isEqualTo("OK")
+    }
+
+    @Test
+    @RequiresFlagsDisabled(Flags.FLAG_SAFETY_CENTER_ISSUE_ONLY_AFFECTS_GROUP_STATUS)
+    fun getSafetyCenterData_entryGroupWithIssueOnlySourceFlagOff_doesntAffectEntryGroupStatus() {
+        safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.entryGroupWithIssueOnlyConfig)
+        safetyCenterTestHelper.setData(SOURCE_ID_1, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(SOURCE_ID_2, safetySourceTestData.information)
+        safetyCenterTestHelper.setData(
+            ISSUE_ONLY_ALL_OPTIONAL_ID,
+            SafetySourceTestData.issuesOnly(safetySourceTestData.recommendationGeneralIssue)
+        )
+
+        val apiSafetyCenterData = safetyCenterManager.getSafetyCenterDataWithPermission()
+
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.severityLevel)
+            .isEqualTo(ENTRY_SEVERITY_LEVEL_OK)
+        assertThat(apiSafetyCenterData.entriesOrGroups.single().entryGroup!!.summary!!.toString())
+            .isEqualTo("OK")
+    }
+
     @Test
     fun addOnSafetyCenterDataChangedListener_listenerCalledWithSafetyCenterDataFromConfig() {
         safetyCenterTestHelper.setConfig(safetyCenterTestConfigs.singleSourceConfig)
@@ -3836,9 +3940,11 @@ class SafetyCenterManagerTest {
 
     companion object {
         private val RESURFACE_DELAY = Duration.ofMillis(500)
+
         // Wait 3 times the RESURFACE_DELAY before asserting whether an issue has or has not
         // resurfaced. Use a constant additive error buffer if we increase the delay considerably.
         private val RESURFACE_TIMEOUT = RESURFACE_DELAY.multipliedBy(3)
+
         // Check more than once during a RESURFACE_DELAY before asserting whether an issue has or
         // has not resurfaced. Use a different check logic (focused at the expected resurface time)
         // if we increase the delay considerably.
diff --git a/tests/lint/Android.bp b/tests/lint/Android.bp
new file mode 100644
index 000000000..04307dce2
--- /dev/null
+++ b/tests/lint/Android.bp
@@ -0,0 +1,55 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+package {
+    default_team: "trendy_team_android_permissions",
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+java_defaults {
+    name: "PermissionLintDefaults",
+    plugins: ["auto_service_plugin"],
+    libs: [
+        "auto_service_annotations",
+        "lint_api",
+    ],
+    static_libs: [
+        "AndroidCommonLint",
+    ],
+    kotlincflags: [
+        "-Xjvm-default=all",
+    ],
+}
+
+java_library_host {
+    name: "PermissionPolicyLintChecker",
+    defaults: [
+        "PermissionLintDefaults",
+    ],
+    srcs: [
+        "checks/src/main/java/com/android/permissioncontroller/lint/permissionpolicy/**/*.kt",
+    ],
+}
+
+java_test_host {
+    name: "PermissionPolicyLintCheckerTest",
+    defaults: [
+        "AndroidLintCheckerTestDefaults",
+        "PermissionLintDefaults",
+    ],
+    srcs: [
+        "checks/src/test/java/**/*.kt",
+        "checks/src/main/java/**/*.kt",
+    ],
+}
diff --git a/tests/lint/checks/src/main/java/com/android/permissioncontroller/lint/permissionpolicy/PermissionPolicyIssueRegistry.kt b/tests/lint/checks/src/main/java/com/android/permissioncontroller/lint/permissionpolicy/PermissionPolicyIssueRegistry.kt
new file mode 100644
index 000000000..b1f526123
--- /dev/null
+++ b/tests/lint/checks/src/main/java/com/android/permissioncontroller/lint/permissionpolicy/PermissionPolicyIssueRegistry.kt
@@ -0,0 +1,43 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.lint.permissionpolicy
+
+import com.android.tools.lint.client.api.IssueRegistry
+import com.android.tools.lint.client.api.Vendor
+import com.android.tools.lint.detector.api.CURRENT_API
+import com.google.auto.service.AutoService
+
+@AutoService(IssueRegistry::class)
+class PermissionPolicyIssueRegistry : IssueRegistry() {
+    override val issues =
+        listOf(
+            PlatformPermissionWithoutFlagDetector.ISSUE,
+        )
+
+    override val api: Int
+        get() = CURRENT_API
+
+    override val minApi: Int
+        get() = 8
+
+    override val vendor: Vendor =
+        Vendor(
+            vendorName = "Android",
+            feedbackUrl = "http://b/issues/new?component=137825",
+            contact = "evanseverson@google.com"
+        )
+}
diff --git a/tests/lint/checks/src/main/java/com/android/permissioncontroller/lint/permissionpolicy/PlatformPermissionWithoutFlagDetector.kt b/tests/lint/checks/src/main/java/com/android/permissioncontroller/lint/permissionpolicy/PlatformPermissionWithoutFlagDetector.kt
new file mode 100644
index 000000000..be5d66841
--- /dev/null
+++ b/tests/lint/checks/src/main/java/com/android/permissioncontroller/lint/permissionpolicy/PlatformPermissionWithoutFlagDetector.kt
@@ -0,0 +1,75 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/** Lint Detector that finds platform permissions that aren't guarded by a flag. */
+package com.android.permissioncontroller.lint.permissionpolicy
+
+import com.android.tools.lint.detector.api.Category
+import com.android.tools.lint.detector.api.Detector
+import com.android.tools.lint.detector.api.Implementation
+import com.android.tools.lint.detector.api.Incident
+import com.android.tools.lint.detector.api.Issue
+import com.android.tools.lint.detector.api.Scope
+import com.android.tools.lint.detector.api.Severity
+import com.android.tools.lint.detector.api.XmlContext
+import com.android.tools.lint.detector.api.XmlScanner
+import org.w3c.dom.Element
+
+class PlatformPermissionWithoutFlagDetector : Detector(), XmlScanner {
+
+    override fun getApplicableElements() = listOf("permission")
+
+    override fun visitElement(context: XmlContext, element: Element) {
+        val permissionName = element.getAttribute("android:name")
+        if (!permissionName!!.startsWith("android.")) {
+            return
+        }
+        val featureFlag = element.getAttribute("android:featureFlag")
+        if (featureFlag.isNullOrBlank()) {
+            val incident =
+                Incident(context, ISSUE)
+                    .at(element)
+                    .message(
+                        "$permissionName isn't guarded by a feature flag. New <permission> " +
+                            "elements must have the `android:featureFlag` attribute."
+                    )
+            context.report(incident)
+        }
+    }
+
+    companion object {
+        @JvmField
+        val ISSUE: Issue =
+            Issue.create(
+                id = "PlatformPermissionWithoutFlag",
+                briefDescription =
+                    "Checks for permissions that do not have an associated feature flag.",
+                explanation =
+                    """
+         All new platform permissions need to have the android:featureFlag attribute set.
+                    """
+                        .trimIndent(),
+                category = Category.CORRECTNESS,
+                priority = 6,
+                severity = Severity.ERROR,
+                implementation =
+                    Implementation(
+                        PlatformPermissionWithoutFlagDetector::class.java,
+                        Scope.MANIFEST_AND_RESOURCE_SCOPE
+                    ),
+            )
+    }
+}
diff --git a/tests/lint/checks/src/test/java/com/android/permissioncontroller/lint/permissionpolicy/PlatformPermissionWithoutFlagDetectorTest.kt b/tests/lint/checks/src/test/java/com/android/permissioncontroller/lint/permissionpolicy/PlatformPermissionWithoutFlagDetectorTest.kt
new file mode 100644
index 000000000..ec9cc71b5
--- /dev/null
+++ b/tests/lint/checks/src/test/java/com/android/permissioncontroller/lint/permissionpolicy/PlatformPermissionWithoutFlagDetectorTest.kt
@@ -0,0 +1,104 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.permissioncontroller.lint.permissionpolicy
+
+import com.android.tools.lint.checks.infrastructure.LintDetectorTest
+import com.android.tools.lint.detector.api.Detector
+import com.android.tools.lint.detector.api.Issue
+import org.junit.Test
+
+class PlatformPermissionWithoutFlagDetectorTest : LintDetectorTest() {
+    override fun getDetector(): Detector = PlatformPermissionWithoutFlagDetector()
+
+    override fun getIssues(): List<Issue> = listOf(PlatformPermissionWithoutFlagDetector.ISSUE)
+
+    @Test
+    fun testManifestPermissionsMustHaveFeatureFlag() {
+        lint()
+            .files(
+                xml(
+                        "AndroidManifest.xml",
+                        """
+<manifest xmlns:android="http://schemas.android.com/apk/res/android"
+        package="android" coreApp="true" android:sharedUserId="android.uid.system"
+        android:sharedUserLabel="@string/android_system_label">
+
+    <permission android:name="android.permission.EXAMPLE"
+            android:protectionLevel="normal" />
+
+    <permission android:name="com.android.permission.EXAMPLE2"
+            android:protectionLevel="normal" />
+
+    <permission android:name="android.permission.EXAMPLE3"
+            android:protectionLevel="normal"
+            android:featureFlag="this.is.a.feature.flag"/>
+
+    <attribution android:tag="ExampleTag" android:label="@string/example_label"/>
+
+    <application android:process="system"
+            android:persistent="true"
+            android:hasCode="false"
+            android:label="@string/android_system_label"
+            android:allowClearUserData="false"
+            android:backupAgent="com.android.server.backup.SystemBackupAgent"
+            android:killAfterRestore="false"
+            android:icon="@drawable/ic_launcher_android"
+            android:supportsRtl="true"
+            android:theme="@style/Theme.DeviceDefault.Light.DarkActionBar"
+            android:defaultToDeviceProtectedStorage="true"
+            android:forceQueryable="true"
+            android:directBootAware="true">
+        <activity android:name="com.android.internal.ExampleActivity"
+                  android:exported="false"
+                  android:theme="@style/Theme.DeviceDefault.Dialog.Alert.DayNight"
+                  android:finishOnCloseSystemDialogs="true"
+                  android:excludeFromRecents="true"
+                  android:documentLaunchMode="never"
+                  android:relinquishTaskIdentity="true"
+                  android:process=":ui"
+                  android:visibleToInstantApps="true">
+            <intent-filter>
+                <action android:name="com.android.internal.intent.action.EXAMPLE_ACTION" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+    </application>
+
+    <permission android:name="android.permission.EXAMPLE4"
+            android:protectionLevel="normal" />
+</manifest>
+"""
+                    )
+                    .indented()
+            )
+            .allowMissingSdk()
+            .run()
+            .expect(
+                """
+AndroidManifest.xml:5: Error: android.permission.EXAMPLE isn't guarded by a feature flag. New <permission> elements must have the android:featureFlag attribute. [PlatformPermissionWithoutFlag]
+    <permission android:name="android.permission.EXAMPLE"
+    ^
+AndroidManifest.xml:47: Error: android.permission.EXAMPLE4 isn't guarded by a feature flag. New <permission> elements must have the android:featureFlag attribute. [PlatformPermissionWithoutFlag]
+    <permission android:name="android.permission.EXAMPLE4"
+    ^
+2 errors, 0 warnings
+"""
+                    .trimIndent()
+            )
+    }
+}
diff --git a/tests/utils/safetycenter/java/com/android/safetycenter/testing/SafetyCenterTestConfigs.kt b/tests/utils/safetycenter/java/com/android/safetycenter/testing/SafetyCenterTestConfigs.kt
index 0e31b2934..261e179dd 100644
--- a/tests/utils/safetycenter/java/com/android/safetycenter/testing/SafetyCenterTestConfigs.kt
+++ b/tests/utils/safetycenter/java/com/android/safetycenter/testing/SafetyCenterTestConfigs.kt
@@ -350,6 +350,23 @@ class SafetyCenterTestConfigs(private val context: Context) {
             .addSafetySourcesGroup(dynamicSourceGroup3)
             .build()
 
+    /**
+     * A simple [SafetyCenterConfig] for tests with a single stateful group containing 2 dynamic
+     * sources and an issue only source.
+     */
+    val entryGroupWithIssueOnlyConfig =
+        SafetyCenterConfig.Builder()
+            .addSafetySourcesGroup(
+                safetySourcesGroupBuilder("EntryGroupWithIssueOnly")
+                    .addSafetySource(dynamicSource1)
+                    .addSafetySource(dynamicSource2)
+                    .addSafetySource(
+                        issueOnlySafetySourceBuilder(ISSUE_ONLY_ALL_OPTIONAL_ID).build()
+                    )
+                    .build()
+            )
+            .build()
+
     /**
      * A simple [SafetyCenterConfig] for tests with multiple sources with one source having an
      * invalid default intent.
diff --git a/tests/utils/safetycenter/java/com/android/safetycenter/testing/SafetyCenterTestHelper.kt b/tests/utils/safetycenter/java/com/android/safetycenter/testing/SafetyCenterTestHelper.kt
index 2902cdd6a..a138675d3 100644
--- a/tests/utils/safetycenter/java/com/android/safetycenter/testing/SafetyCenterTestHelper.kt
+++ b/tests/utils/safetycenter/java/com/android/safetycenter/testing/SafetyCenterTestHelper.kt
@@ -16,12 +16,14 @@
 
 package com.android.safetycenter.testing
 
+import android.Manifest.permission.READ_DEVICE_CONFIG
 import android.Manifest.permission.READ_SAFETY_CENTER_STATUS
 import android.Manifest.permission.SEND_SAFETY_CENTER_UPDATE
 import android.content.Context
 import android.os.Build.VERSION_CODES.TIRAMISU
 import android.os.Build.VERSION_CODES.UPSIDE_DOWN_CAKE
 import android.os.UserManager
+import android.platform.test.flag.junit.DeviceFlagsValueProvider
 import android.safetycenter.SafetyCenterManager
 import android.safetycenter.SafetyEvent
 import android.safetycenter.SafetySourceData
@@ -29,6 +31,8 @@ import android.safetycenter.config.SafetyCenterConfig
 import android.safetycenter.config.SafetySource.SAFETY_SOURCE_TYPE_STATIC
 import android.util.Log
 import androidx.annotation.RequiresApi
+import com.android.modules.utils.build.SdkLevel
+import com.android.permission.flags.Flags
 import com.android.safetycenter.testing.SafetyCenterApisWithShellPermissions.addOnSafetyCenterDataChangedListenerWithPermission
 import com.android.safetycenter.testing.SafetyCenterApisWithShellPermissions.clearAllSafetySourceDataForTestsWithPermission
 import com.android.safetycenter.testing.SafetyCenterApisWithShellPermissions.clearSafetyCenterConfigForTestsWithPermission
@@ -42,6 +46,7 @@ import com.android.safetycenter.testing.SafetyCenterFlags.isSafetyCenterEnabled
 import com.android.safetycenter.testing.SafetySourceTestData.Companion.EVENT_SOURCE_STATE_CHANGED
 import com.android.safetycenter.testing.ShellPermissions.callWithShellPermissionIdentity
 import com.google.common.util.concurrent.MoreExecutors.directExecutor
+import org.junit.Assume.assumeTrue
 
 /** A class that facilitates settings up Safety Center in tests. */
 @RequiresApi(TIRAMISU)
@@ -61,13 +66,17 @@ class SafetyCenterTestHelper(val context: Context) {
         SafetySourceReceiver.setup()
         TestActivity.enableHighPriorityAlias()
         SafetyCenterFlags.setup()
-        setEnabled(true)
+        if (safetyCenterCanBeToggledUsingDeviceConfig()) {
+            setEnabled(true)
+        }
     }
 
     /** Resets the state of Safety Center. To be called after each test. */
     fun reset() {
         Log.d(TAG, "reset")
-        setEnabled(true)
+        if (safetyCenterCanBeToggledUsingDeviceConfig()) {
+            setEnabled(true)
+        }
         listeners.forEach {
             safetyCenterManager.removeOnSafetyCenterDataChangedListenerWithPermission(it)
             it.cancel()
@@ -97,6 +106,10 @@ class SafetyCenterTestHelper(val context: Context) {
             Log.d(TAG, "isEnabled is already $value")
             return
         }
+        assumeTrue(
+            "Cannot toggle SafetyCenter using DeviceConfig",
+            safetyCenterCanBeToggledUsingDeviceConfig()
+        )
         setEnabledWaitingForSafetyCenterBroadcastIdle(value, safetyCenterConfig)
     }
 
@@ -152,7 +165,9 @@ class SafetyCenterTestHelper(val context: Context) {
     }
 
     private fun resetFlags() {
-        setEnabled(SafetyCenterFlags.snapshot.isSafetyCenterEnabled())
+        if (safetyCenterCanBeToggledUsingDeviceConfig()) {
+            setEnabled(SafetyCenterFlags.snapshot.isSafetyCenterEnabled())
+        }
         SafetyCenterFlags.reset()
     }
 
@@ -202,7 +217,19 @@ class SafetyCenterTestHelper(val context: Context) {
 
     private fun isEnabled() = safetyCenterManager.isSafetyCenterEnabledWithPermission()
 
-    private companion object {
-        const val TAG: String = "SafetyCenterTestHelper"
+    companion object {
+        private const val TAG: String = "SafetyCenterTestHelper"
+
+        /** Returns whether Safety Center can be enabled / disabled using a DeviceConfig flag. */
+        fun safetyCenterCanBeToggledUsingDeviceConfig(): Boolean {
+            val deviceFlagsValueProvider = DeviceFlagsValueProvider()
+            val safetyCenterEnabledNoDeviceConfig =
+                callWithShellPermissionIdentity(READ_DEVICE_CONFIG) {
+                    deviceFlagsValueProvider.getBoolean(
+                        Flags.FLAG_SAFETY_CENTER_ENABLED_NO_DEVICE_CONFIG
+                    )
+                }
+            return !safetyCenterEnabledNoDeviceConfig || !SdkLevel.isAtLeastU()
+        }
     }
 }
```

