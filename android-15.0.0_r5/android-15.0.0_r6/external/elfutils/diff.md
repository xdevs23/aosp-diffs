```diff
diff --git a/GPG-KEY b/GPG-KEY
index 671373e6..dca558b7 100644
--- a/GPG-KEY
+++ b/GPG-KEY
@@ -112,3 +112,37 @@ AwhaG1W+Y3LDe7S19M0cUzftEUeq3Jd89hoijC72tdba+BRfW0ncfvEcsk9QifSU
 1tvZxQ==
 =l2J7
 -----END PGP PUBLIC KEY BLOCK-----
+-----BEGIN PGP PUBLIC KEY BLOCK-----
+ 
+mQENBGXb21kBCADCyOpVSfJ6XHVp8+dspYCgkSwr26IF+SXHzt9dVyMChAKJIXib
+ty8NA/Huh3ZRNzFXdFM09yoYiglnYu3+r1rniliP1L1w3y0tDNxlvlLmVhM5WAfA
+IyZ9tI8X1XIfRLYsX70UM3jDvyoXkEQkjhQKDHrgBdBTNARHlHVykj44xD2TCwao
+vV0gFu2EmCN8TsMWLdQ1VymtYd/UFB6znlLzSglzzx4OYKyla6anbWqKxvB3siIH
+Pf/ULBh0JNTluH39kk486yE9Lh1z9H8FoVlUWcXvlr0rmPPQDl9se02bkd4rA/gD
+kRQmlUXxJIJCNYZiQ7k0nZSYQY6JzhY1szBLABEBAAG0H0Fhcm9uIE1lcmV5IDxh
+bWVyZXlAcmVkaGF0LmNvbT6JAVEEEwEIADsWIQRsK2MVY7jTMFeNPLR0/T+id55w
+cwUCZdvbWQIbAwULCQgHAgIiAgYVCgkICwIEFgIDAQIeBwIXgAAKCRB0/T+id55w
+cxHiCAC9evJD8CqSPOfuKFa2iITLoSM2ORdpsp5Wla9OpAV5GnUNKbR7KCLoG7OQ
+3Tth9qdHqrCIUigvj2xzcaovdyVRpDLBFG5cbrBB7Jqly0ptJhFUtx8wbDBammZq
+7ZAsLFP582ILqlLjcTIOUNk4ABuTDN9FIdewgWXMW7GPp5euJ4ucos2glySwLbC4
++6kZ1guYYbO3S9YWWyImP2Guf4KVi5kTF0USTklvszJLvwJNkYknQhxnDcWLeOPJ
+P4hOdHlwJSsaXcKyOn//FdMXRGDcknKcn43e03esXjflvz8HyXz4VbjEqDpOHS9i
+l/NOw6+C7+wcAvHDu583cMbuI7hziEYEEBEIAAYFAmXiB7IACgkQVZbdDOm/ZT2Q
+fwCfQSmNDkHu3ZxwvWs+mOFaYR3PGRAAnieQMVnPZd8kgGkVO/GNIJIBeuA7iF0E
+EBECAB0WIQRBoMESdLHof+KOTFPj134flRYZkQUCZeIIBAAKCRDj134flRYZkX4N
+AJ0Q8p1f7lmWgiHaHmD3DtuJ7uhWHACgk84evo0UsqVNi/4xHZ0wpVvxx+S5AQ0E
+ZdvbWQEIAKgzEcJMUfFgsUGwMO/I4mwjvB7+Jx90lSYjS3uM7E3jnYhu/en42skl
+nYEMxMR9EWUF6RZ78QiUvD/Ik6fP0YrMuTRBnZ7ZOd5zLPbgDIAOVeiVxFRwGOzj
+z01V/plDlz+zCQkS1tOPgpGKCzTol7/M9ks9AHqKE6DWrrk1LbER2qDyE6XMAe5b
+LNqdmtfJ2uf2XPThGGz0ujJ0MdistoRMechX9qBIBaLwxuA5edx+3iu6MdjMCeua
+yV+Yb4ePG+9IY3OmdC/3wNpJYOQvSsJz9PzX4Nf1PuIaT/JoQSmZa8aZYgtCVMCV
+t15UDdpPTyuFeXSBYLkuSQGM6DqARnEAEQEAAYkBNgQYAQgAIBYhBGwrYxVjuNMw
+V408tHT9P6J3nnBzBQJl29tZAhsMAAoJEHT9P6J3nnBzAJYH/1eX+r8VEDPU/TKA
+yqYW2Mg87jyo8+t2x0zFZfucni/0o3ejaSxSVtnWiFh79OWnACnbq0go+pT59X7V
+03VcYQgRpzLuD0OzcOmkHI4kgbB2Q3zNszlqb67Lkt+P9xy16DWS8N9qujfiTw6q
++xT/BsSxmOuWxexrRjui012g28TcihlQIRBOtJIA2vEwUWjuMkzno2Xbrxq99WH8
+iSr3bTGc/jpnMetW4iHE8VxUJ7ixvbcE4vWsfUqPyr/5U25a2D8XNmvqw9J1msNE
+5dlWzgmpLMHLVzKigvJffjsYxxLvekbSv/mJgonhDXUQvUnwy0bx41te/neXHrEv
+S0Zj1TU=
+=iz3/
+-----END PGP PUBLIC KEY BLOCK-----
diff --git a/METADATA b/METADATA
index 54866d4c..f6ee4de1 100644
--- a/METADATA
+++ b/METADATA
@@ -9,11 +9,11 @@ third_party {
     type: GIT
     value: "git://sourceware.org/git/elfutils.git"
   }
-  version: "elfutils-0.190"
+  version: "elfutils-0.191"
   license_type: RESTRICTED
   last_upgrade_date {
     year: 2024
-    month: 01
-    day: 24
+    month: 7
+    day: 8
   }
 }
diff --git a/Makefile.am b/Makefile.am
index 41badfd7..c9d59d4a 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -46,6 +46,11 @@ distcheck-hook:
 rpm: dist
 	rpmbuild -ts elfutils-@PACKAGE_VERSION@.tar.bz2
 
+rpmbuild: dist
+	mkdir -p rpmbuild
+	rpmbuild -ta elfutils-@PACKAGE_VERSION@.tar.bz2 \
+		--define "_topdir $(shell pwd)/rpmbuild"
+
 if GCOV
 
 COVERAGE_OUTPUT_FILE = $(PACKAGE_NAME).lcov
diff --git a/NEWS b/NEWS
index 0420d3b8..4549bb6e 100644
--- a/NEWS
+++ b/NEWS
@@ -1,3 +1,17 @@
+Version 0.191 "Bug fixes in C major"
+
+libdw: dwarf_addrdie now supports binaries lacking a .debug_aranges
+       section.
+
+       Improved support for DWARF package files.  Add new function
+       dwarf_cu_dwp_section_info.
+
+debuginfod: Caching eviction logic improvements to improve retention
+            of small/frequent/slow files such as Fedora's vdso.debug.
+
+srcfiles: Can now fetch the source files of a DWARF/ELF file and
+          place them into a zip.
+
 Version 0.190 "Woke!"
 
 CONTRIBUTING: Switch from real name policy to known identity policy.
diff --git a/backends/arm_machineflagname.c b/backends/arm_machineflagname.c
index e93092ae..d700d5f4 100644
--- a/backends/arm_machineflagname.c
+++ b/backends/arm_machineflagname.c
@@ -48,7 +48,7 @@ arm_machine_flag_name (Elf64_Word orig, Elf64_Word *flagref)
 	  "Version5 EABI",
         };
       *flagref &= ~((Elf64_Word) EF_ARM_EABIMASK);
-      return vername[version - 1];
+      return version <= 5 ? vername[version - 1] : NULL;
     }
   switch (EF_ARM_EABI_VERSION (orig))
     {
diff --git a/backends/loongarch_reloc.def b/backends/loongarch_reloc.def
index a39eefd9..cdc83211 100644
--- a/backends/loongarch_reloc.def
+++ b/backends/loongarch_reloc.def
@@ -128,3 +128,20 @@ RELOC_TYPE (SUB6,			REL)
 RELOC_TYPE (ADD_ULEB128,		REL)
 RELOC_TYPE (SUB_ULEB128,		REL)
 RELOC_TYPE (64_PCREL,			REL)
+RELOC_TYPE (CALL36,			REL)
+RELOC_TYPE (TLS_DESC_PC_HI20,		REL)
+RELOC_TYPE (TLS_DESC_PC_LO12,		REL)
+RELOC_TYPE (TLS_DESC64_PC_LO20,		REL)
+RELOC_TYPE (TLS_DESC64_PC_HI12,		REL)
+RELOC_TYPE (TLS_DESC_HI20,		REL)
+RELOC_TYPE (TLS_DESC_LO12,		REL)
+RELOC_TYPE (TLS_DESC64_LO20,		REL)
+RELOC_TYPE (TLS_DESC64_HI12,		REL)
+RELOC_TYPE (TLS_DESC_LD,		REL)
+RELOC_TYPE (TLS_DESC_CALL,		REL)
+RELOC_TYPE (TLS_LE_HI20_R,		REL)
+RELOC_TYPE (TLS_LE_ADD_R,		REL)
+RELOC_TYPE (TLS_LE_LO12_R,		REL)
+RELOC_TYPE (TLS_LD_PCREL20_S2,		REL)
+RELOC_TYPE (TLS_GD_PCREL20_S2,		REL)
+RELOC_TYPE (TLS_DESC_PCREL20_S2,	REL)
diff --git a/config.h b/config.h
index 364ce05c..c18c85ac 100644
--- a/config.h
+++ b/config.h
@@ -88,6 +88,9 @@
 /* Define to 1 if you have the <inttypes.h> header file. */
 #define HAVE_INTTYPES_H 1
 
+/* Define to 0 if libarchive is not available */
+/* #undef HAVE_LIBARCHIVE */
+
 /* Define to 1 if you have the `mremap' function. */
 #define HAVE_MREMAP 1
 
@@ -152,7 +155,7 @@
 #define PACKAGE_NAME "elfutils"
 
 /* Define to the full name and version of this package. */
-#define PACKAGE_STRING "elfutils 0.190"
+#define PACKAGE_STRING "elfutils 0.191"
 
 /* Define to the one symbol short name of this package. */
 #define PACKAGE_TARNAME "elfutils"
@@ -161,7 +164,7 @@
 #define PACKAGE_URL "http://elfutils.org/"
 
 /* Define to the version of this package. */
-#define PACKAGE_VERSION "0.190"
+#define PACKAGE_VERSION "0.191"
 
 /* The size of `long', as computed by sizeof. */
 #define SIZEOF_LONG 8
@@ -198,7 +201,7 @@
 #define USE_ZSTD_COMPRESS 1
 
 /* Version number of package */
-#define VERSION "0.190"
+#define VERSION "0.191"
 
 /* Define to 1 if `lex' declares `yytext' as a `char *' by default, not a
    `char[]'. */
diff --git a/config/elfutils.spec.in b/config/elfutils.spec.in
index 67e88cb5..d6621c9d 100644
--- a/config/elfutils.spec.in
+++ b/config/elfutils.spec.in
@@ -247,6 +247,7 @@ fi
 %{_bindir}/eu-ranlib
 %{_bindir}/eu-readelf
 %{_bindir}/eu-size
+%{_bindir}/eu-srcfiles
 %{_bindir}/eu-stack
 %{_bindir}/eu-strings
 %{_bindir}/eu-strip
@@ -341,6 +342,16 @@ exit 0
 %systemd_postun_with_restart debuginfod.service
 
 %changelog
+* Fri Mar  1 2024 Aaron Merey <amerey@redhat.com> 0.191-1
+- dwarf_addrdie now supports binaries lacking a .debug_aranges
+  section.
+- Improved support for DWARF package files.  Add new function
+  dwarf_cu_dwp_section_info.
+- debuginfod: Caching eviction logic improvements to improve retention
+  of small/frequent/slow files such as Fedora's vdso.debug.
+- srcfiles: Can now fetch the source files of a DWARF/ELF file and
+  place them into a zip.
+
 * Fri Nov  3 2023 Mark Wielaard <mark@klomp.org> 0.190-1
 - CONTRIBUTING: Switch from real name policy to known identity policy.
   Updated ChangeLog policy (no more separate ChangeLog files).
diff --git a/configure.ac b/configure.ac
index af5b6bf7..bbe8673e 100644
--- a/configure.ac
+++ b/configure.ac
@@ -18,7 +18,7 @@ dnl  GNU General Public License for more details.
 dnl
 dnl  You should have received a copy of the GNU General Public License
 dnl  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-AC_INIT([elfutils],[0.190],[https://sourceware.org/bugzilla],[elfutils],[http://elfutils.org/])
+AC_INIT([elfutils],[0.191],[https://sourceware.org/bugzilla],[elfutils],[http://elfutils.org/])
 
 dnl Workaround for older autoconf < 2.64
 m4_ifndef([AC_PACKAGE_URL],
@@ -45,7 +45,7 @@ fi
 AC_CONFIG_AUX_DIR([config])
 AC_CONFIG_FILES([config/Makefile])
 
-AC_COPYRIGHT([Copyright (C) 1996-2023 The elfutils developers.])
+AC_COPYRIGHT([Copyright (C) 1996-2024 The elfutils developers.])
 AC_PREREQ(2.63)			dnl Minimum Autoconf version required.
 
 dnl We use GNU make extensions; automake 1.10 defaults to -Wportability.
@@ -841,7 +841,7 @@ AM_CONDITIONAL([LIBDEBUGINFOD],[test "x$enable_libdebuginfod" = "xyes" || test "
 AM_CONDITIONAL([DUMMY_LIBDEBUGINFOD],[test "x$enable_libdebuginfod" = "xdummy"])
 AC_CHECK_HEADERS([execinfo.h])
 
-# Look for libmicrohttpd, libarchive, sqlite for debuginfo server
+# Look for libmicrohttpd, libarchive, sqlite for debuginfo server and srcfiles tool
 # minimum versions as per rhel7.
 AC_ARG_ENABLE([debuginfod],AS_HELP_STRING([--enable-debuginfod], [Build debuginfod server]))
 AS_IF([test "x$enable_debuginfod" != "xno"], [
@@ -853,11 +853,12 @@ AS_IF([test "x$enable_debuginfod" != "xno"], [
       AC_MSG_ERROR([need libdebuginfod (or dummy), use --disable-debuginfod to disable.])
     fi
     enable_debuginfod=yes # presume success
+    AC_DEFINE([HAVE_LIBARCHIVE], [1], [Define to 1 if libarchive is available]) # presume success
     PKG_PROG_PKG_CONFIG
     PKG_CHECK_MODULES([libmicrohttpd],[libmicrohttpd >= 0.9.33],[],[enable_debuginfod=no])
     PKG_CHECK_MODULES([oldlibmicrohttpd],[libmicrohttpd < 0.9.51],[old_libmicrohttpd=yes],[old_libmicrohttpd=no])
     PKG_CHECK_MODULES([sqlite3],[sqlite3 >= 3.7.17],[],[enable_debuginfod=no])
-    PKG_CHECK_MODULES([libarchive],[libarchive >= 3.1.2],[],[enable_debuginfod=no])
+    PKG_CHECK_MODULES([libarchive],[libarchive >= 3.1.2],[],[enable_debuginfod=no], AC_DEFINE([HAVE_LIBARCHIVE], [0], [Define to 0 if libarchive is not available]))
     if test "x$enable_debuginfod" = "xno"; then
       AC_MSG_ERROR([dependencies not found, use --disable-debuginfod to disable.])
     fi
diff --git a/debuginfod/debuginfod-client.c b/debuginfod/debuginfod-client.c
index dcf05031..0ee7db3d 100644
--- a/debuginfod/debuginfod-client.c
+++ b/debuginfod/debuginfod-client.c
@@ -1771,6 +1771,8 @@ debuginfod_query_server (debuginfod_client *c,
 
   /* PR27571: make cache files casually unwriteable; dirs are already 0700 */
   (void) fchmod(fd, 0400);
+  /* PR31248: lseek back to beginning */
+  (void) lseek(fd, 0, SEEK_SET);
                 
   /* rename tmp->real */
   rc = rename (target_cache_tmppath, target_cache_path);
diff --git a/debuginfod/debuginfod.cxx b/debuginfod/debuginfod.cxx
index c11aeda1..560880f2 100644
--- a/debuginfod/debuginfod.cxx
+++ b/debuginfod/debuginfod.cxx
@@ -1,5 +1,5 @@
 /* Debuginfo-over-http server.
-   Copyright (C) 2019-2021 Red Hat, Inc.
+   Copyright (C) 2019-2024 Red Hat, Inc.
    Copyright (C) 2021, 2022 Mark J. Wielaard <mark@klomp.org>
    This file is part of elfutils.
 
@@ -50,11 +50,6 @@ extern "C" {
 }
 #endif
 
-extern "C" {
-#include "printversion.h"
-#include "system.h"
-}
-
 #include "debuginfod.h"
 #include <dwarf.h>
 
@@ -74,6 +69,8 @@ extern "C" {
 #include <unistd.h>
 #include <fcntl.h>
 #include <netdb.h>
+#include <math.h>
+#include <float.h>
 
 
 /* If fts.h is included before config.h, its indirect inclusions may not
@@ -135,6 +132,11 @@ using namespace std;
 #define tid() pthread_self()
 #endif
 
+extern "C" {
+#include "printversion.h"
+#include "system.h"
+}
+
 
 inline bool
 string_endswith(const string& haystack, const string& needle)
@@ -417,7 +419,7 @@ static const struct argp_option options[] =
    { "verbose", 'v', NULL, 0, "Increase verbosity.", 0 },
    { "regex-groom", 'r', NULL, 0,"Uses regexes from -I and -X arguments to groom the database.",0},
 #define ARGP_KEY_FDCACHE_FDS 0x1001
-   { "fdcache-fds", ARGP_KEY_FDCACHE_FDS, "NUM", 0, "Maximum number of archive files to keep in fdcache.", 0 },
+   { "fdcache-fds", ARGP_KEY_FDCACHE_FDS, "NUM", OPTION_HIDDEN, NULL, 0 },
 #define ARGP_KEY_FDCACHE_MBS 0x1002
    { "fdcache-mbs", ARGP_KEY_FDCACHE_MBS, "MB", 0, "Maximum total size of archive file fdcache.", 0 },
 #define ARGP_KEY_FDCACHE_PREFETCH 0x1003
@@ -425,11 +427,9 @@ static const struct argp_option options[] =
 #define ARGP_KEY_FDCACHE_MINTMP 0x1004
    { "fdcache-mintmp", ARGP_KEY_FDCACHE_MINTMP, "NUM", 0, "Minimum free space% on tmpdir.", 0 },
 #define ARGP_KEY_FDCACHE_PREFETCH_MBS 0x1005
-   { "fdcache-prefetch-mbs", ARGP_KEY_FDCACHE_PREFETCH_MBS, "MB", 0,"Megabytes allocated to the \
-      prefetch cache.", 0},
+   { "fdcache-prefetch-mbs", ARGP_KEY_FDCACHE_PREFETCH_MBS, "MB", OPTION_HIDDEN, NULL, 0},
 #define ARGP_KEY_FDCACHE_PREFETCH_FDS 0x1006
-   { "fdcache-prefetch-fds", ARGP_KEY_FDCACHE_PREFETCH_FDS, "NUM", 0,"Number of files allocated to the \
-      prefetch cache.", 0},
+   { "fdcache-prefetch-fds", ARGP_KEY_FDCACHE_PREFETCH_FDS, "NUM", OPTION_HIDDEN, NULL, 0},
 #define ARGP_KEY_FORWARDED_TTL_LIMIT 0x1007
    {"forwarded-ttl-limit", ARGP_KEY_FORWARDED_TTL_LIMIT, "NUM", 0, "Limit of X-Forwarded-For hops, default 8.", 0},
 #define ARGP_KEY_PASSIVE 0x1008
@@ -482,12 +482,9 @@ static regex_t file_include_regex;
 static regex_t file_exclude_regex;
 static bool regex_groom = false;
 static bool traverse_logical;
-static long fdcache_fds;
 static long fdcache_mbs;
 static long fdcache_prefetch;
 static long fdcache_mintmp;
-static long fdcache_prefetch_mbs;
-static long fdcache_prefetch_fds;
 static unsigned forwarded_ttl_limit = 8;
 static bool scan_source_info = true;
 static string tmpdir;
@@ -495,7 +492,9 @@ static bool passive_p = false;
 static long scan_checkpoint = 256;
 
 static void set_metric(const string& key, double value);
-// static void inc_metric(const string& key);
+static void inc_metric(const string& key);
+static void add_metric(const string& metric,
+                       double value);
 static void set_metric(const string& metric,
                        const string& lname, const string& lvalue,
                        double value);
@@ -653,7 +652,7 @@ parse_opt (int key, char *arg,
       regex_groom = true;
       break;
     case ARGP_KEY_FDCACHE_FDS:
-      fdcache_fds = atol (arg);
+      // deprecated
       break;
     case ARGP_KEY_FDCACHE_MBS:
       fdcache_mbs = atol (arg);
@@ -673,14 +672,10 @@ parse_opt (int key, char *arg,
       source_paths.insert(string(arg));
       break;
     case ARGP_KEY_FDCACHE_PREFETCH_FDS:
-      fdcache_prefetch_fds = atol(arg);
-      if ( fdcache_prefetch_fds < 0)
-        argp_failure(state, 1, EINVAL, "fdcache prefetch fds");
+      // deprecated
       break;
     case ARGP_KEY_FDCACHE_PREFETCH_MBS:
-      fdcache_prefetch_mbs = atol(arg);
-      if ( fdcache_prefetch_mbs < 0)
-        argp_failure(state, 1, EINVAL, "fdcache prefetch mbs");
+      // deprecated
       break;
     case ARGP_KEY_PASSIVE:
       passive_p = true;
@@ -1438,76 +1433,79 @@ class libarchive_fdcache
 private:
   mutex fdcache_lock;
 
+  typedef pair<string,string> key; // archive, entry
   struct fdcache_entry
   {
-    string archive;
-    string entry;
-    string fd;
+    string fd; // file name (probably in $TMPDIR), not an actual open fd (EMFILE)
     double fd_size_mb; // slightly rounded up megabytes
+    time_t freshness; // when was this entry created or requested last
+    unsigned request_count; // how many requests were made; or 0=prefetch only
+    double latency; // how many seconds it took to extract the file
   };
-  deque<fdcache_entry> lru; // @head: most recently used
+
+  map<key,fdcache_entry> entries; // optimized for lookup
+  time_t last_cleaning;
   long max_fds;
-  deque<fdcache_entry> prefetch; // prefetched
   long max_mbs;
-  long max_prefetch_mbs;
-  long max_prefetch_fds;
 
 public:
   void set_metrics()
   {
     double fdcache_mb = 0.0;
     double prefetch_mb = 0.0;
-    for (auto i = lru.begin(); i < lru.end(); i++)
-      fdcache_mb += i->fd_size_mb;
-    for (auto j = prefetch.begin(); j < prefetch.end(); j++)
-      prefetch_mb += j->fd_size_mb;
+    unsigned fdcache_count = 0;
+    unsigned prefetch_count = 0;
+    for (auto &i : entries) {
+      if (i.second.request_count) {
+        fdcache_mb += i.second.fd_size_mb;
+        fdcache_count ++;
+      } else {
+        prefetch_mb += i.second.fd_size_mb;
+        prefetch_count ++;
+      }
+    }
     set_metric("fdcache_bytes", fdcache_mb*1024.0*1024.0);
-    set_metric("fdcache_count", lru.size());
+    set_metric("fdcache_count", fdcache_count);
     set_metric("fdcache_prefetch_bytes", prefetch_mb*1024.0*1024.0);
-    set_metric("fdcache_prefetch_count", prefetch.size());
+    set_metric("fdcache_prefetch_count", prefetch_count);
   }
 
-  void intern(const string& a, const string& b, string fd, off_t sz, bool front_p)
+  void intern(const string& a, const string& b, string fd, off_t sz,
+              bool requested_p, double lat)
   {
     {
       unique_lock<mutex> lock(fdcache_lock);
-      // nuke preexisting copy
-      for (auto i = lru.begin(); i < lru.end(); i++)
-        {
-          if (i->archive == a && i->entry == b)
-            {
-              unlink (i->fd.c_str());
-              lru.erase(i);
-              inc_metric("fdcache_op_count","op","dequeue");
-              break; // must not continue iterating
-            }
-        }
-      // nuke preexisting copy in prefetch
-      for (auto i = prefetch.begin(); i < prefetch.end(); i++)
+      time_t now = time(NULL);
+      // there is a chance it's already in here, just wasn't found last time
+      // if so, there's nothing to do but count our luck
+      auto i = entries.find(make_pair(a,b));
+      if (i != entries.end())
         {
-          if (i->archive == a && i->entry == b)
-            {
-              unlink (i->fd.c_str());
-              prefetch.erase(i);
-              inc_metric("fdcache_op_count","op","prefetch_dequeue");
-              break; // must not continue iterating
-            }
+          inc_metric("fdcache_op_count","op","redundant_intern");
+          if (requested_p) i->second.request_count ++; // repeat prefetch doesn't count
+          i->second.freshness = now;
+          // We need to nuke the temp file, since interning passes
+          // responsibility over the path to this structure.  It is
+          // possible that the caller still has an fd open, but that's
+          // OK.
+          unlink (fd.c_str());
+          return;
         }
       double mb = (sz+65535)/1048576.0; // round up to 64K block
-      fdcache_entry n = { a, b, fd, mb };
-      if (front_p)
-        {
-          inc_metric("fdcache_op_count","op","enqueue");
-          lru.push_front(n);
-        }
+      fdcache_entry n = { .fd=fd, .fd_size_mb=mb,
+                          .freshness=now, .request_count = requested_p?1U:0U,
+                          .latency=lat};
+      entries.insert(make_pair(make_pair(a,b),n));
+      
+      if (requested_p)
+        inc_metric("fdcache_op_count","op","enqueue");
       else
-        {
-          inc_metric("fdcache_op_count","op","prefetch_enqueue");
-          prefetch.push_front(n);
-        }
+        inc_metric("fdcache_op_count","op","prefetch_enqueue");
+      
       if (verbose > 3)
         obatched(clog) << "fdcache interned a=" << a << " b=" << b
-                       << " fd=" << fd << " mb=" << mb << " front=" << front_p << endl;
+                       << " fd=" << fd << " mb=" << mb << " front=" << requested_p
+                       << " latency=" << lat << endl;
       
       set_metrics();
     }
@@ -1517,10 +1515,10 @@ public:
       {
         inc_metric("fdcache_op_count","op","emerg-flush");
         obatched(clog) << "fdcache emergency flush for filling tmpdir" << endl;
-        this->limit(0, 0, 0, 0); // emergency flush
+        this->limit(0); // emergency flush
       }
-    else if (front_p)
-      this->limit(max_fds, max_mbs, max_prefetch_fds, max_prefetch_mbs); // age cache if required
+    else // age cache normally
+      this->limit(max_mbs);
   }
 
   int lookup(const string& a, const string& b)
@@ -1528,156 +1526,163 @@ public:
     int fd = -1;
     {
       unique_lock<mutex> lock(fdcache_lock);
-      for (auto i = lru.begin(); i < lru.end(); i++)
-        {
-          if (i->archive == a && i->entry == b)
-            { // found it; move it to head of lru
-              fdcache_entry n = *i;
-              lru.erase(i); // invalidates i, so no more iteration!
-              lru.push_front(n);
-              inc_metric("fdcache_op_count","op","requeue_front");
-              fd = open(n.fd.c_str(), O_RDONLY); 
-              break;
-            }
-        }
-      // Iterate through prefetch while fd == -1 to ensure that no duplication between lru and 
-      // prefetch occurs.
-      for ( auto i = prefetch.begin(); fd == -1 && i < prefetch.end(); ++i)
+      auto i = entries.find(make_pair(a,b));
+      if (i != entries.end())
         {
-          if (i->archive == a && i->entry == b)
-            { // found it; take the entry from the prefetch deque to the lru deque, since it has now been accessed.
-              fdcache_entry n = *i;
-              prefetch.erase(i);
-              lru.push_front(n);
-              inc_metric("fdcache_op_count","op","prefetch_access");
-              fd = open(n.fd.c_str(), O_RDONLY); 
-              break;
+          if (i->second.request_count == 0) // was a prefetch!
+            {
+              inc_metric("fdcache_prefetch_saved_milliseconds_count");
+              add_metric("fdcache_prefetch_saved_milliseconds_sum", i->second.latency*1000.);
             }
+          i->second.request_count ++;
+          i->second.freshness = time(NULL);
+          // brag about our success
+          inc_metric("fdcache_op_count","op","prefetch_access"); // backward compat
+          inc_metric("fdcache_saved_milliseconds_count");
+          add_metric("fdcache_saved_milliseconds_sum", i->second.latency*1000.);
+          fd = open(i->second.fd.c_str(), O_RDONLY); 
         }
     }
 
-    if (statfs_free_enough_p(tmpdir, "tmpdir", fdcache_mintmp))
-      {
-        inc_metric("fdcache_op_count","op","emerg-flush");
-        obatched(clog) << "fdcache emergency flush for filling tmpdir" << endl;
-        this->limit(0, 0, 0, 0); // emergency flush
-      }
-    else if (fd >= 0)
-      this->limit(max_fds, max_mbs, max_prefetch_fds, max_prefetch_mbs); // age cache if required
+    if (fd >= 0)
+      inc_metric("fdcache_op_count","op","lookup_hit");
+    else
+      inc_metric("fdcache_op_count","op","lookup_miss");
+    
+    // NB: no need to age the cache after just a lookup
 
     return fd;
   }
 
-  int probe(const string& a, const string& b) // just a cache residency check - don't modify LRU state, don't open
+  int probe(const string& a, const string& b) // just a cache residency check - don't modify state, don't open
   {
     unique_lock<mutex> lock(fdcache_lock);
-    for (auto i = lru.begin(); i < lru.end(); i++)
-      {
-        if (i->archive == a && i->entry == b)
-          {
-            inc_metric("fdcache_op_count","op","probe_hit");
-            return true;
-          }
-      }
-    for (auto i = prefetch.begin(); i < prefetch.end(); i++)
-      {
-        if (i->archive == a && i->entry == b)
-          {
-            inc_metric("fdcache_op_count","op","prefetch_probe_hit");
-            return true;
-          }
-      }
-    inc_metric("fdcache_op_count","op","probe_miss");
-    return false;
+    auto i = entries.find(make_pair(a,b));
+    if (i != entries.end()) {
+      inc_metric("fdcache_op_count","op","probe_hit");
+      return true;
+    } else {
+      inc_metric("fdcache_op_count","op","probe_miss");
+      return false;
+   }
   }
-
+  
   void clear(const string& a, const string& b)
   {
     unique_lock<mutex> lock(fdcache_lock);
-    for (auto i = lru.begin(); i < lru.end(); i++)
-      {
-        if (i->archive == a && i->entry == b)
-          { // found it; erase it from lru
-            fdcache_entry n = *i;
-            lru.erase(i); // invalidates i, so no more iteration!
-            inc_metric("fdcache_op_count","op","clear");
-            unlink (n.fd.c_str());
-            set_metrics();
-            return;
-          }
-      }
-    for (auto i = prefetch.begin(); i < prefetch.end(); i++)
-      {
-        if (i->archive == a && i->entry == b)
-          { // found it; erase it from lru
-            fdcache_entry n = *i;
-            prefetch.erase(i); // invalidates i, so no more iteration!
-            inc_metric("fdcache_op_count","op","prefetch_clear");
-            unlink (n.fd.c_str());
-            set_metrics();
-            return;
-          }
-      }
+    auto i = entries.find(make_pair(a,b));
+    if (i != entries.end()) {
+      inc_metric("fdcache_op_count","op",
+                 i->second.request_count > 0 ? "clear" : "prefetch_clear");
+      unlink (i->second.fd.c_str());
+      entries.erase(i);
+      set_metrics();
+      return;
+    }
   }
 
-  void limit(long maxfds, long maxmbs, long maxprefetchfds, long maxprefetchmbs , bool metrics_p = true)
+  void limit(long maxmbs, bool metrics_p = true)
   {
-    if (verbose > 3 && (this->max_fds != maxfds || this->max_mbs != maxmbs))
-      obatched(clog) << "fdcache limited to maxfds=" << maxfds << " maxmbs=" << maxmbs << endl;
+    time_t now = time(NULL);
+
+    // avoid overly frequent limit operations
+    if (maxmbs > 0 && (now - this->last_cleaning) < 10) // probably not worth parametrizing
+      return;
+    this->last_cleaning = now;
+    
+    if (verbose > 3 && (this->max_mbs != maxmbs))
+      obatched(clog) << "fdcache limited to maxmbs=" << maxmbs << endl;
 
     unique_lock<mutex> lock(fdcache_lock);
-    this->max_fds = maxfds;
+    
     this->max_mbs = maxmbs;
-    this->max_prefetch_fds = maxprefetchfds;
-    this->max_prefetch_mbs = maxprefetchmbs;
-    long total_fd = 0;
     double total_mb = 0.0;
-    for (auto i = lru.begin(); i < lru.end(); i++)
+
+    map<double, pair<string,string>> sorted_entries;
+    for (auto &i: entries)
       {
-        // accumulate totals from most recently used one going backward
-        total_fd ++;
-        total_mb += i->fd_size_mb;
-        if (total_fd > this->max_fds || total_mb > this->max_mbs)
-          {
-            // found the cut here point!
-
-            for (auto j = i; j < lru.end(); j++) // close all the fds from here on in
-              {
-                if (verbose > 3)
-                  obatched(clog) << "fdcache evicted a=" << j->archive << " b=" << j->entry
-                                 << " fd=" << j->fd << " mb=" << j->fd_size_mb << endl;
-                if (metrics_p)
-                  inc_metric("fdcache_op_count","op","evict");
-                unlink (j->fd.c_str());
-              }
+        total_mb += i.second.fd_size_mb;
+
+        // need a scalar quantity that combines these inputs in a sensible way:
+        //
+        // 1) freshness of this entry (last time it was accessed)
+        // 2) size of this entry
+        // 3) number of times it has been accessed (or if just prefetched with 0 accesses)
+        // 4) latency it required to extract
+        //
+        // The lower the "score", the earlier garbage collection will
+        // nuke it, so to prioritize entries for preservation, the
+        // score should be higher, and vice versa.
+        time_t factor_1_freshness = (now - i.second.freshness); // seconds
+        double factor_2_size = i.second.fd_size_mb; // megabytes
+        unsigned factor_3_accesscount = i.second.request_count; // units
+        double factor_4_latency = i.second.latency; // seconds
+
+        #if 0
+        double score = - factor_1_freshness; // simple LRU
+        #endif
+
+        double score = 0.
+          - log1p(factor_1_freshness)                // penalize old file
+          - log1p(factor_2_size)                     // penalize large file
+          + factor_4_latency * factor_3_accesscount; // reward slow + repeatedly read files
+
+        if (verbose > 4)
+          obatched(clog) << "fdcache scored score=" << score
+                         << " a=" << i.first.first << " b=" << i.first.second
+                         << " f1=" << factor_1_freshness << " f2=" << factor_2_size
+                         << " f3=" << factor_3_accesscount << " f4=" << factor_4_latency
+                         << endl;
+        
+        sorted_entries.insert(make_pair(score, i.first));
+      }
 
-            lru.erase(i, lru.end()); // erase the nodes generally
-            break;
-          }
+    unsigned cleaned = 0;
+    unsigned entries_original = entries.size();
+    double cleaned_score_min = DBL_MAX;
+    double cleaned_score_max = DBL_MIN;
+    
+    // drop as many entries[] as needed to bring total mb down to the threshold
+    for (auto &i: sorted_entries) // in increasing score order!
+      {
+        if (this->max_mbs > 0 // if this is not a "clear entire table"
+            && total_mb < this->max_mbs) // we've cleared enough to meet threshold
+          break; // stop clearing
+
+        auto j = entries.find(i.second);
+        if (j == entries.end())
+          continue; // should not happen
+
+        if (cleaned == 0)
+          cleaned_score_min = i.first;
+        cleaned++;
+        cleaned_score_max = i.first;
+        
+        if (verbose > 3)
+          obatched(clog) << "fdcache evicted score=" << i.first
+                         << " a=" << i.second.first << " b=" << i.second.second
+                         << " fd=" << j->second.fd << " mb=" << j->second.fd_size_mb
+                         << " rq=" << j->second.request_count << " lat=" << j->second.latency
+                         << " fr=" << (now - j->second.freshness)
+                         << endl;
+        if (metrics_p)
+          inc_metric("fdcache_op_count","op","evict");
+        
+        total_mb -= j->second.fd_size_mb;
+        unlink (j->second.fd.c_str());
+        entries.erase(j);
       }
-    total_fd = 0;
-    total_mb = 0.0;
-    for(auto i = prefetch.begin(); i < prefetch.end(); i++){
-      // accumulate totals from most recently used one going backward
-        total_fd ++;
-        total_mb += i->fd_size_mb;
-        if (total_fd > this->max_prefetch_fds || total_mb > this->max_prefetch_mbs)
-          {
-            // found the cut here point!
-            for (auto j = i; j < prefetch.end(); j++) // close all the fds from here on in
-              {
-                if (verbose > 3)
-                  obatched(clog) << "fdcache evicted from prefetch a=" << j->archive << " b=" << j->entry
-                                 << " fd=" << j->fd << " mb=" << j->fd_size_mb << endl;
-                if (metrics_p)
-                  inc_metric("fdcache_op_count","op","prefetch_evict");
-                unlink (j->fd.c_str());
-              }
 
-            prefetch.erase(i, prefetch.end()); // erase the nodes generally
-            break;
-          }
-    }
+    if (metrics_p)
+      inc_metric("fdcache_op_count","op","evict_cycle");
+    
+    if (verbose > 1 && cleaned > 0)
+      {
+        obatched(clog) << "fdcache evicted num=" << cleaned << " of=" << entries_original
+                       << " min=" << cleaned_score_min << " max=" << cleaned_score_max
+                       << endl;
+      }
+    
     if (metrics_p) set_metrics();
   }
 
@@ -1686,7 +1691,7 @@ public:
   {
     // unlink any fdcache entries in $TMPDIR
     // don't update metrics; those globals may be already destroyed
-    limit(0, 0, 0, 0, false);
+    limit(0, false);
   }
 };
 static libarchive_fdcache fdcache;
@@ -1701,7 +1706,8 @@ static libarchive_fdcache fdcache;
 
 static int
 extract_section (int elf_fd, int64_t parent_mtime,
-		 const string& b_source, const string& section)
+		 const string& b_source, const string& section,
+                 const timespec& extract_begin)
 {
   /* Search the fdcache.  */
   struct stat fs;
@@ -1771,29 +1777,41 @@ extract_section (int elf_fd, int64_t parent_mtime,
 
 	      /* Create temporary file containing the section.  */
 	      char *tmppath = NULL;
-	      rc = asprintf (&tmppath, "%s/debuginfod.XXXXXX", tmpdir.c_str());
+	      rc = asprintf (&tmppath, "%s/debuginfod-section.XXXXXX", tmpdir.c_str());
 	      if (rc < 0)
 		throw libc_exception (ENOMEM, "cannot allocate tmppath");
 	      defer_dtor<void*,void> tmmpath_freer (tmppath, free);
 	      fd = mkstemp (tmppath);
 	      if (fd < 0)
 		throw libc_exception (errno, "cannot create temporary file");
+
 	      ssize_t res = write_retry (fd, data->d_buf, data->d_size);
-	      if (res < 0 || (size_t) res != data->d_size)
+	      if (res < 0 || (size_t) res != data->d_size) {
+                close (fd);
+                unlink (tmppath);
 		throw libc_exception (errno, "cannot write to temporary file");
+              }
 
 	      /* Set mtime to be the same as the parent file's mtime.  */
 	      struct timespec tvs[2];
-	      if (fstat (elf_fd, &fs) != 0)
+	      if (fstat (elf_fd, &fs) != 0) {
+                close (fd);
+                unlink (tmppath);
 		throw libc_exception (errno, "cannot fstat file");
-
+              }
+              
 	      tvs[0].tv_sec = 0;
 	      tvs[0].tv_nsec = UTIME_OMIT;
 	      tvs[1] = fs.st_mtim;
 	      (void) futimens (fd, tvs);
 
+              struct timespec extract_end;
+              clock_gettime (CLOCK_MONOTONIC, &extract_end);
+              double extract_time = (extract_end.tv_sec - extract_begin.tv_sec)
+                + (extract_end.tv_nsec - extract_begin.tv_nsec)/1.e9;
+              
 	      /* Add to fdcache.  */
-	      fdcache.intern (b_source, section, tmppath, data->d_size, true);
+	      fdcache.intern (b_source, section, tmppath, data->d_size, true, extract_time);
 	      break;
 	    }
 	}
@@ -1817,10 +1835,14 @@ handle_buildid_f_match (bool internal_req_t,
                         int *result_fd)
 {
   (void) internal_req_t; // ignored
+
+  struct timespec extract_begin;
+  clock_gettime (CLOCK_MONOTONIC, &extract_begin);
+  
   int fd = open(b_source0.c_str(), O_RDONLY);
   if (fd < 0)
     throw libc_exception (errno, string("open ") + b_source0);
-
+  
   // NB: use manual close(2) in error case instead of defer_dtor, because
   // in the normal case, we want to hand the fd over to libmicrohttpd for
   // file transfer.
@@ -1843,7 +1865,7 @@ handle_buildid_f_match (bool internal_req_t,
 
   if (!section.empty ())
     {
-      int scn_fd = extract_section (fd, s.st_mtime, b_source0, section);
+      int scn_fd = extract_section (fd, s.st_mtime, b_source0, section, extract_begin);
       close (fd);
 
       if (scn_fd >= 0)
@@ -1918,6 +1940,9 @@ handle_buildid_r_match (bool internal_req_p,
                         const string& section,
                         int *result_fd)
 {
+  struct timespec extract_begin;
+  clock_gettime (CLOCK_MONOTONIC, &extract_begin);
+
   struct stat fs;
   int rc = stat (b_source0.c_str(), &fs);
   if (rc != 0)
@@ -1948,7 +1973,7 @@ handle_buildid_r_match (bool internal_req_p,
 	{
 	  int scn_fd = extract_section (fd, fs.st_mtime,
 					b_source0 + ":" + b_source1,
-					section);
+					section, extract_begin);
 	  close (fd);
 	  if (scn_fd >= 0)
 	    fd = scn_fd;
@@ -2009,6 +2034,7 @@ handle_buildid_r_match (bool internal_req_p,
         archive_decoder = arch.second;
       }
   FILE* fp;
+  
   defer_dtor<FILE*,int>::dtor_fn dfn;
   if (archive_decoder != "cat")
     {
@@ -2079,7 +2105,7 @@ handle_buildid_r_match (bool internal_req_p,
 
       // extract this file to a temporary file
       char* tmppath = NULL;
-      rc = asprintf (&tmppath, "%s/debuginfod.XXXXXX", tmpdir.c_str());
+      rc = asprintf (&tmppath, "%s/debuginfod-fdcache.XXXXXX", tmpdir.c_str());
       if (rc < 0)
         throw libc_exception (ENOMEM, "cannot allocate tmppath");
       defer_dtor<void*,void> tmmpath_freer (tmppath, free);
@@ -2106,13 +2132,18 @@ handle_buildid_r_match (bool internal_req_p,
       tvs[1].tv_nsec = archive_entry_mtime_nsec(e);
       (void) futimens (fd, tvs);  /* best effort */
 
+      struct timespec extract_end;
+      clock_gettime (CLOCK_MONOTONIC, &extract_end);
+      double extract_time = (extract_end.tv_sec - extract_begin.tv_sec)
+        + (extract_end.tv_nsec - extract_begin.tv_nsec)/1.e9;
+      
       if (r != 0) // stage 3
         {
           // NB: now we know we have a complete reusable file; make fdcache
           // responsible for unlinking it later.
           fdcache.intern(b_source0, fn,
                          tmppath, archive_entry_size(e),
-                         false); // prefetched ones go to the prefetch cache
+                         false, extract_time); // prefetched ones go to the prefetch cache
           prefetch_count --;
           close (fd); // we're not saving this fd to make a mhd-response from!
           continue;
@@ -2122,13 +2153,13 @@ handle_buildid_r_match (bool internal_req_p,
       // responsible for unlinking it later.
       fdcache.intern(b_source0, b_source1,
                      tmppath, archive_entry_size(e),
-                     true); // requested ones go to the front of lru
+                     true, extract_time); // requested ones go to the front of the line
 
       if (!section.empty ())
 	{
 	  int scn_fd = extract_section (fd, b_mtime,
 					b_source0 + ":" + b_source1,
-					section);
+					section, extract_begin);
 	  close (fd);
 	  if (scn_fd >= 0)
 	    fd = scn_fd;
@@ -2583,14 +2614,12 @@ set_metric(const string& metric, double value)
   unique_lock<mutex> lock(metrics_lock);
   metrics[metric] = value;
 }
-#if 0 /* unused */
 static void
 inc_metric(const string& metric)
 {
   unique_lock<mutex> lock(metrics_lock);
   metrics[metric] ++;
 }
-#endif
 static void
 set_metric(const string& metric,
            const string& lname, const string& lvalue,
@@ -2618,7 +2647,6 @@ add_metric(const string& metric,
   unique_lock<mutex> lock(metrics_lock);
   metrics[key] += value;
 }
-#if 0
 static void
 add_metric(const string& metric,
            double value)
@@ -2626,7 +2654,6 @@ add_metric(const string& metric,
   unique_lock<mutex> lock(metrics_lock);
   metrics[metric] += value;
 }
-#endif
 
 
 // and more for higher arity labels if needed
@@ -2996,8 +3023,6 @@ dwarf_extract_source_paths (Elf *elf, set<string>& debug_sourcefiles)
 
       if (comp_dir[0] == '\0' && cuname[0] != '/')
         {
-          // This is a common symptom for dwz-compressed debug files,
-          // where the altdebug file cannot be resolved.
           if (verbose > 3)
             obatched(clog) << "skipping cu=" << cuname << " due to empty comp_dir" << endl;
           continue;
@@ -3194,16 +3219,16 @@ register_file_name(sqlite_ps& ps_upsert_fileparts,
                    const string& name)
 {
   std::size_t slash = name.rfind('/');
-  string dirname, basename;
+  string dirname, filename;
   if (slash == std::string::npos)
     {
       dirname = "";
-      basename = name;
+      filename = name;
     }
   else
     {
       dirname = name.substr(0, slash);
-      basename = name.substr(slash+1);
+      filename = name.substr(slash+1);
     }
 
   // intern the two substrings
@@ -3213,21 +3238,21 @@ register_file_name(sqlite_ps& ps_upsert_fileparts,
     .step_ok_done();
   ps_upsert_fileparts
     .reset()
-    .bind(1, basename)
+    .bind(1, filename)
     .step_ok_done();
 
   // intern the tuple
   ps_upsert_file
     .reset()
     .bind(1, dirname)
-    .bind(2, basename)
+    .bind(2, filename)
     .step_ok_done();
 
   // look up the tuple's id
   ps_lookup_file
     .reset()
     .bind(1, dirname)
-    .bind(2, basename);
+    .bind(2, filename);
   int rc = ps_lookup_file.step();
   if (rc != SQLITE_ROW) throw sqlite_exception(rc, "step");
   
@@ -3481,7 +3506,7 @@ archive_classify (const string& rps, string& archive_extension, int64_t archivei
 
           // extract this file to a temporary file
           char* tmppath = NULL;
-          rc = asprintf (&tmppath, "%s/debuginfod.XXXXXX", tmpdir.c_str());
+          rc = asprintf (&tmppath, "%s/debuginfod-classify.XXXXXX", tmpdir.c_str());
           if (rc < 0)
             throw libc_exception (ENOMEM, "cannot allocate tmppath");
           defer_dtor<void*,void> tmmpath_freer (tmppath, free);
@@ -3492,8 +3517,10 @@ archive_classify (const string& rps, string& archive_extension, int64_t archivei
           defer_dtor<int,int> minifd_closer (fd, close);
 
           rc = archive_read_data_into_fd (a, fd);
-          if (rc != ARCHIVE_OK)
+          if (rc != ARCHIVE_OK) {
+            close (fd);
             throw archive_exception(a, "cannot extract file");
+          }
 
           // finally ... time to run elf_classify on this bad boy and update the database
           bool executable_p = false, debuginfo_p = false;
@@ -4201,9 +4228,12 @@ void groom()
   sqlite3_db_release_memory(dbq); // ... for both connections
   debuginfod_pool_groom(); // and release any debuginfod_client objects we've been holding onto
 
-  fdcache.limit(0,0,0,0); // release the fdcache contents
-  fdcache.limit(fdcache_fds, fdcache_mbs, fdcache_prefetch_fds, fdcache_prefetch_mbs); // restore status quo parameters
-
+#if 0 /* PR31265: don't jettison cache unnecessarily */
+  
+  fdcache.limit(0); // release the fdcache contents
+  fdcache.limit(fdcache_mbs); // restore status quo parameters
+#endif
+  
   clock_gettime (CLOCK_MONOTONIC, &ts_end);
   double deltas = (ts_end.tv_sec - ts_start.tv_sec) + (ts_end.tv_nsec - ts_start.tv_nsec)/1.e9;
 
@@ -4416,7 +4446,6 @@ main (int argc, char *argv[])
     fdcache_mbs = sfs.f_bavail * sfs.f_bsize / 1024 / 1024 / 4; // 25% of free space
   fdcache_mintmp = 25; // emergency flush at 25% remaining (75% full)
   fdcache_prefetch = 64; // guesstimate storage is this much less costly than re-decompression
-  fdcache_fds = (concurrency + fdcache_prefetch) * 2;
 
   /* Parse and process arguments.  */
   int remaining;
@@ -4425,17 +4454,10 @@ main (int argc, char *argv[])
       error (EXIT_FAILURE, 0,
              "unexpected argument: %s", argv[remaining]);
 
-  // Make the prefetch cache spaces a fraction of the main fdcache if
-  // unspecified.
-  if (fdcache_prefetch_fds == 0)
-    fdcache_prefetch_fds = fdcache_fds / 2;
-  if (fdcache_prefetch_mbs == 0)
-    fdcache_prefetch_mbs = fdcache_mbs / 2;
-
   if (scan_archives.size()==0 && !scan_files && source_paths.size()>0)
     obatched(clog) << "warning: without -F -R -U -Z, ignoring PATHs" << endl;
 
-  fdcache.limit(fdcache_fds, fdcache_mbs, fdcache_prefetch_fds, fdcache_prefetch_mbs);
+  fdcache.limit(fdcache_mbs);
 
   (void) signal (SIGPIPE, SIG_IGN); // microhttpd can generate it incidentally, ignore
   (void) signal (SIGINT, signal_handler); // ^C
@@ -4617,15 +4639,12 @@ main (int argc, char *argv[])
     obatched(clog) << "rescan time " << rescan_s << endl;
     obatched(clog) << "scan checkpoint " << scan_checkpoint << endl;
   }
-  obatched(clog) << "fdcache fds " << fdcache_fds << endl;
   obatched(clog) << "fdcache mbs " << fdcache_mbs << endl;
   obatched(clog) << "fdcache prefetch " << fdcache_prefetch << endl;
   obatched(clog) << "fdcache tmpdir " << tmpdir << endl;
   obatched(clog) << "fdcache tmpdir min% " << fdcache_mintmp << endl;
   if (! passive_p)
     obatched(clog) << "groom time " << groom_s << endl;
-  obatched(clog) << "prefetch fds " << fdcache_prefetch_fds << endl;
-  obatched(clog) << "prefetch mbs " << fdcache_prefetch_mbs << endl;
   obatched(clog) << "forwarded ttl limit " << forwarded_ttl_limit << endl;
 
   if (scan_archives.size()>0)
diff --git a/doc/debuginfod.8 b/doc/debuginfod.8
index 4f1f04b3..42e0fc9f 100644
--- a/doc/debuginfod.8
+++ b/doc/debuginfod.8
@@ -48,16 +48,10 @@ AT_comp_dir (compilation directory) attributes inside it.  Caution:
 source files listed in the DWARF may be a path \fIanywhere\fP in the
 file system, and debuginfod will readily serve their content on
 demand.  (Imagine a doctored DWARF file that lists \fI/etc/passwd\fP
-as a source file.)  If this is a concern, audit your binaries with
-tools such as:
+as a source file.)  If this is a concern, audit your binaries:
 
 .SAMPLE
-% eu-readelf -wline BINARY | sed -n '/^Directory.table/,/^File.name.table/p'
-or
-% eu-readelf -wline BINARY | sed -n '/^Directory.table/,/^Line.number/p'
-or even use debuginfod itself:
-% debuginfod -vvv -d :memory: -F BINARY 2>&1 | grep 'recorded.*source'
-^C
+% eu-srcfiles -e BINARY
 .ESAMPLE
 
 If any of the \fB\-R\fP, \fB-U\fP, or \fB-Z\fP options is given, each
@@ -65,12 +59,17 @@ file is scanned as an archive file that may contain ELF/DWARF/source
 files.  Archive files are recognized by extension.  If \-R is given,
 ".rpm" files are scanned; if \-U is given, ".deb" and ".ddeb" files
 are scanned; if \-Z is given, the listed extensions are scanned.
-Because of complications such as DWZ-compressed debuginfo, may require
-\fItwo\fP traversal passes to identify all source code.  Source files
-for RPMs are only served from other RPMs, so the caution for \-F does
-not apply.  Note that due to Debian/Ubuntu packaging policies &
-mechanisms, debuginfod cannot resolve source files for DEB/DDEB at
-all.
+
+Because of complications such as DWZ-compressed debuginfo, it may
+require \fItwo\fP traversal passes to identify all source code.
+Source files for binaries in archives are only served from archives,
+so the caution for \-F does not apply.  If the same source file may be
+found in multiple different archives, a heuristic chooses the one
+closest to the archive holding the debuginfo.  ("closest" means
+"longest common archive name prefix").  Note that due to Debian/Ubuntu
+packaging policies & mechanisms, debuginfod cannot resolve source
+files for DEB/DDEB at all.  Consider using the
+\-\-disable\-source\-scan option.
 
 If no PATH is listed, or none of the scanning options is given, then
 \fBdebuginfod\fP will simply serve content that it accumulated into
@@ -108,8 +107,8 @@ with \fB\%\-Z\ .rpm='(rpm2cpio|zstdcat)<'\fP instead of \fB\-R\fP.
 .TP
 .B "\-U"
 Activate DEB/DDEB patterns in archive scanning.  The default is off.
-Equivalent to \fB\%\-Z\ .deb='dpkg-deb\ \-\-fsys\-tarfile\fP'
-\fB\%\-Z\ .ddeb='dpkg-deb\ \-\-fsys\-tarfile'\fP.
+Equivalent to \fB\%\-Z\ .deb='(bsdtar\ \-O\ \-x\ \-f\ \-\ data.tar\\*)<\fP'
+and same for \fB.ddeb\fP and \fB.ipk\fP.
 
 .TP
 .B "\-d FILE" "\-\-database=FILE"
@@ -235,29 +234,26 @@ loops in the symbolic directory tree might lead to \fIinfinite
 traversal\fP.
 
 .TP
-.B "\-\-fdcache\-fds=NUM"  "\-\-fdcache\-mbs=MB"
+.B "\-\-fdcache\-mbs=MB"
 Configure limits on a cache that keeps recently extracted files from
-archives.  Up to NUM requested files and up to a total of MB megabytes
-will be kept extracted, in order to avoid having to decompress their
-archives over and over again. The default NUM and MB values depend on
-the concurrency of the system, and on the available disk space on the
-$TMPDIR or \fB/tmp\fP filesystem.  This is because that is where the
-most recently used extracted files are kept.  Grooming cleans out this
-cache.
+archives.  Up to a total of MB megabytes will be kept extracted, in
+order to avoid having to decompress their archives over and over
+again. The default MB values depend on the concurrency of the system,
+and on the available disk space on the $TMPDIR or \fB/tmp\fP
+filesystem.  (This is because that is where the most recently used
+extracted files are kept.)  While previous versions used plain LRU,
+the cache now attempts to preserve more frequently & recently accessed
+files, and especially those that took a long time to extract (e.g.,
+vdso.debug!), and penalizes large / old files.
 
 .TP
-.B "\-\-fdcache\-prefetch\-fds=NUM"  "\-\-fdcache\-prefetch\-mbs=MB"
-.B "\-\-fdcache\-prefetch=NUM2"
-
-In addition to the main fdcache, up to NUM2 other files from an
-archive may be prefetched into another cache before they are even
-requested.  Configure how many file descriptors (fds) and megabytes
-(mbs) are allocated to the prefetch fdcache. If unspecified, these
-values depend on concurrency of the system and on the available disk
-space on the $TMPDIR.  Allocating more to the prefetch cache will
-improve performance in environments where different parts of several
-large archives are being accessed.  This cache is also cleaned out
-during grooming.
+.B "\-\-fdcache\-prefetch=NUM"
+Up to NUM other files from an archive may be prefetched into the
+cache before they are even requested.  If unspecified, these values
+depend on concurrency of the system and on the available disk space on
+the $TMPDIR.  Allocating more will improve performance in environments
+where multiple different parts of several large archives are being
+accessed.
 
 .TP
 .B "\-\-fdcache\-mintmp=NUM"
diff --git a/doc/debuginfod_find_debuginfo.3 b/doc/debuginfod_find_debuginfo.3
index 6469a3df..0d553665 100644
--- a/doc/debuginfod_find_debuginfo.3
+++ b/doc/debuginfod_find_debuginfo.3
@@ -133,8 +133,9 @@ use with all other calls.  On error \fBNULL\fP will be returned and
 
 If a find family function is successful, the resulting file is saved
 to the client cache and a file descriptor to that file is returned.
-The caller needs to \fBclose\fP() this descriptor.  Otherwise, a
-negative error code is returned.
+The file descriptor points to the beginning of the file.  The caller
+needs to \fBclose\fP() this descriptor.  Otherwise, a negative error
+code is returned.
 
 .SH "OPTIONAL FUNCTIONS"
 
diff --git a/doc/srcfiles.1 b/doc/srcfiles.1
index 6149c21b..f1216596 100644
--- a/doc/srcfiles.1
+++ b/doc/srcfiles.1
@@ -21,15 +21,18 @@
 eu-srcfiles \- Lists the source files of a DWARF/ELF file.
 
 .SH "SYNOPSIS"
-eu-srcfiles [\fB\-0\fR|\fB\-\-null\fR] [\fB\-c\fR|\fB\-\-cu\-only\fR] [\fB\-v\fR|\fB\-\-verbose\fR] INPUT
+eu-srcfiles [\fB\-0\fR|\fB\-\-null\fR] [\fB\-c\fR|\fB\-\-cu\-only\fR] [\fB\-v\fR|\fB\-\-verbose\fR] [\fB\-z\fR|\fB\-\-zip\fR] INPUT
 
 .SH "DESCRIPTION"
-\fBeu-srcfiles\fR lists the source files of a given \s-DWARF/ELF\s0
+\fBeu-srcfiles\fR lists all the source files of a given DWARF/ELF
 file.  This list is based on a search of the DWARF debuginfo, which
 may be automatically fetched by debuginfod if applicable.  The target
 file may be an executable, a coredump, a process, or even the running
-kernel.  The default is the file 'a.out'.  The source file names are
-made unique and printed to standard output.
+kernel.  The default input is the file 'a.out'.  The source file names are
+made unique by prepending the full path name and then printed to standard output. The source files can be
+placed in a zip file that is sent to stdout.
+
+Note that all occurrences of '/./' and '/../' in the path name are canonicalized.
 
 .SH "INPUT OPTIONS"
 The long and short forms of options, shown here as alternatives, are
@@ -80,14 +83,29 @@ Print program version.
 \fB\-0, \-\-null\fR
 Separate items by a null instead of a newline.
 
+.TP
+\fB\-b, \-\-no-backup\fR
+Disables local source file search when
+debuginfod fails to fetch files.  This
+option is only applicable when fetching and
+zipping files.
+
 .TP
 \fB\-c, \-\-cu\-only\fR
-Only list the CU names.
+Only list the CU (compilation unit) names.
 
 .TP
 \fB\-v, \-\-verbose\fR
 Increase verbosity of logging messages.
 
+.TP
+\fB\-z, \-\-zip\fR
+Zip all the source files and send to stdout.
+By default, files will be automatically fetched by
+debuginfod (if applicable) or locally as a
+backup. Any source files that were not found
+will not be archived.
+
 
 .SH EXAMPLES
 
@@ -119,6 +137,11 @@ List the source files of a kernel image.
 eu-srcfiles -e /boot/vmlinuz-`uname -r`
 .ESAMPLE
 
+Zip all the source files for a binary.
+.SAMPLE
+eu-srcfiles -z -e /bin/ls > ls.zip
+.ESAMPLE
+
 
 .SH "AUTHOR"
 Written by Housam Alamour.
diff --git a/lib/printversion.c b/lib/printversion.c
index be629b59..2e6c54b3 100644
--- a/lib/printversion.c
+++ b/lib/printversion.c
@@ -40,5 +40,5 @@ print_version (FILE *stream, struct argp_state *state)
 Copyright (C) %s The elfutils developers <%s>.\n\
 This is free software; see the source for copying conditions.  There is NO\n\
 warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\
-"), "2023", PACKAGE_URL);
+"), "2024", PACKAGE_URL);
 }
diff --git a/lib/system.h b/lib/system.h
index 1c914efc..0db12d99 100644
--- a/lib/system.h
+++ b/lib/system.h
@@ -1,6 +1,7 @@
 /* Declarations for common convenience functions.
    Copyright (C) 2006-2011 Red Hat, Inc.
    Copyright (C) 2022 Mark J. Wielaard <mark@klomp.org>
+   Copyright (C) 2023 Khem Raj.
    This file is part of elfutils.
 
    This file is free software; you can redistribute it and/or modify
@@ -211,4 +212,17 @@ extern char *__cxa_demangle (const char *mangled_name, char *output_buffer,
   extern int never_defined_just_used_for_checking[(expr) ? 1 : -1]	\
     __attribute__ ((unused))
 
+/* We really want a basename implementation that doesn't modify the
+   input argument.  Normally you get that from string.h with _GNU_SOURCE
+   define.  But some libc implementations don't define it and other
+   define it, but provide an implementation that still modifies the
+   argument.  So define our own and poison a bare basename symbol.  */
+static inline const char *
+xbasename(const char *s)
+{
+  const char *p = strrchr(s, '/');
+  return p ? p+1 : s;
+}
+#pragma GCC poison basename
+
 #endif /* system.h */
diff --git a/libdw/Makefile.am b/libdw/Makefile.am
index e548f38c..5363c02a 100644
--- a/libdw/Makefile.am
+++ b/libdw/Makefile.am
@@ -93,7 +93,7 @@ libdw_a_SOURCES = dwarf_begin.c dwarf_begin_elf.c dwarf_end.c dwarf_getelf.c \
 		  dwarf_cu_die.c dwarf_peel_type.c dwarf_default_lower_bound.c \
 		  dwarf_die_addr_die.c dwarf_get_units.c \
 		  libdw_find_split_unit.c dwarf_cu_info.c \
-		  dwarf_next_lines.c
+		  dwarf_next_lines.c dwarf_cu_dwp_section_info.c
 
 if MAINTAINER_MODE
 BUILT_SOURCES = $(srcdir)/known-dwarf.h
diff --git a/libdw/dwarf.h b/libdw/dwarf.h
index b2e49db2..4be32de5 100644
--- a/libdw/dwarf.h
+++ b/libdw/dwarf.h
@@ -942,7 +942,7 @@ enum
 enum
   {
     DW_SECT_INFO = 1,
-    /* Reserved = 2, */
+    DW_SECT_TYPES = 2, /* Only DWARF4 GNU DebugFission. Reserved in DWARF5.  */
     DW_SECT_ABBREV = 3,
     DW_SECT_LINE = 4,
     DW_SECT_LOCLISTS = 5,
diff --git a/libdw/dwarf_addrdie.c b/libdw/dwarf_addrdie.c
index 3a08ab75..48a1aaea 100644
--- a/libdw/dwarf_addrdie.c
+++ b/libdw/dwarf_addrdie.c
@@ -41,7 +41,7 @@ dwarf_addrdie (Dwarf *dbg, Dwarf_Addr addr, Dwarf_Die *result)
   size_t naranges;
   Dwarf_Off off;
 
-  if (INTUSE(dwarf_getaranges) (dbg, &aranges, &naranges) != 0
+  if (__libdw_getdieranges (dbg, &aranges, &naranges) != 0
       || INTUSE(dwarf_getarangeinfo) (INTUSE(dwarf_getarange_addr) (aranges,
 								    addr),
 				      NULL, NULL, &off) != 0)
diff --git a/libdw/dwarf_begin_elf.c b/libdw/dwarf_begin_elf.c
index 323a91d0..ca2b7e2a 100644
--- a/libdw/dwarf_begin_elf.c
+++ b/libdw/dwarf_begin_elf.c
@@ -567,6 +567,7 @@ dwarf_begin_elf (Elf *elf, Dwarf_Cmd cmd, Elf_Scn *scngrp)
 
   result->elf = elf;
   result->alt_fd = -1;
+  result->dwp_fd = -1;
 
   /* Initialize the memory handling.  Initial blocks are allocated on first
      actual allocation.  */
diff --git a/libdw/dwarf_cu_dwp_section_info.c b/libdw/dwarf_cu_dwp_section_info.c
new file mode 100644
index 00000000..5a081f5a
--- /dev/null
+++ b/libdw/dwarf_cu_dwp_section_info.c
@@ -0,0 +1,532 @@
+/* Read DWARF package file index sections.
+   Copyright (c) 2023 Meta Platforms, Inc. and affiliates.
+   This file is part of elfutils.
+
+   This file is free software; you can redistribute it and/or modify
+   it under the terms of either
+
+     * the GNU Lesser General Public License as published by the Free
+       Software Foundation; either version 3 of the License, or (at
+       your option) any later version
+
+   or
+
+     * the GNU General Public License as published by the Free
+       Software Foundation; either version 2 of the License, or (at
+       your option) any later version
+
+   or both in parallel, as here.
+
+   elfutils is distributed in the hope that it will be useful, but
+   WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   General Public License for more details.
+
+   You should have received copies of the GNU General Public License and
+   the GNU Lesser General Public License along with this program.  If
+   not, see <http://www.gnu.org/licenses/>.  */
+
+#ifdef HAVE_CONFIG_H
+# include <config.h>
+#endif
+
+#include <assert.h>
+
+#include "libdwP.h"
+
+static Dwarf_Package_Index *
+__libdw_read_package_index (Dwarf *dbg, bool tu)
+{
+  Elf_Data *data;
+  if (tu)
+    data = dbg->sectiondata[IDX_debug_tu_index];
+  else
+    data = dbg->sectiondata[IDX_debug_cu_index];
+
+  /* We need at least 16 bytes for the header.  */
+  if (data == NULL || data->d_size < 16)
+    {
+    invalid:
+      __libdw_seterrno (DWARF_E_INVALID_DWARF);
+      return NULL;
+    }
+
+  const unsigned char *datap = data->d_buf;
+  const unsigned char *endp = datap + data->d_size;
+  uint16_t version;
+  /* In GNU DebugFission for DWARF 4, the version is 2 as a uword.  In the
+     standardized DWARF 5 format, it is a uhalf followed by a padding uhalf.
+     Check for both.  */
+  if (read_4ubyte_unaligned (dbg, datap) == 2)
+    version = 2;
+  else
+    {
+      version = read_2ubyte_unaligned (dbg, datap);
+      if (version != 5)
+	{
+	  __libdw_seterrno (DWARF_E_VERSION);
+	  return NULL;
+	}
+    }
+  datap += 4;
+  uint32_t section_count = read_4ubyte_unaligned_inc (dbg, datap);
+  uint32_t unit_count = read_4ubyte_unaligned_inc (dbg, datap);
+  uint32_t slot_count = read_4ubyte_unaligned_inc (dbg, datap);
+
+  /* The specification has a stricter requirement that
+     slot_count > 3 * unit_count / 2, but this is enough for us.  */
+  if (slot_count < unit_count)
+    goto invalid;
+
+  /* After the header, the section must contain:
+
+       8 byte signature per hash table slot
+     + 4 byte index per hash table slot
+     + Section offset table with 1 header row, 1 row per unit, 1 column per
+       section, 4 bytes per field
+     + Section size table with 1 row per unit, 1 column per section, 4 bytes
+       per field
+
+     We have to be careful about overflow when checking this.  */
+  const unsigned char *hash_table = datap;
+  if ((size_t) (endp - hash_table) < (uint64_t) slot_count * 12)
+    goto invalid;
+  const unsigned char *indices = hash_table + (size_t) slot_count * 8;
+  const unsigned char *sections = indices + (size_t) slot_count * 4;
+  if ((size_t) (endp - sections) < (uint64_t) section_count * 4)
+    goto invalid;
+  const unsigned char *section_offsets = sections + (size_t) section_count * 4;
+  if ((uint64_t) unit_count * section_count > UINT64_MAX / 8
+      || ((size_t) (endp - section_offsets)
+	  < (uint64_t) unit_count * section_count * 8))
+    goto invalid;
+  const unsigned char *section_sizes
+    = section_offsets + (uint64_t) unit_count * section_count * 4;
+
+  Dwarf_Package_Index *index = malloc (sizeof (*index));
+  if (index == NULL)
+    {
+      __libdw_seterrno (DWARF_E_NOMEM);
+      return NULL;
+    }
+
+  index->dbg = dbg;
+  /* Set absent sections to UINT32_MAX.  */
+  for (size_t i = 0;
+       i < sizeof (index->sections) / sizeof (index->sections[0]); i++)
+    index->sections[i] = UINT32_MAX;
+  for (size_t i = 0; i < section_count; i++)
+    {
+      uint32_t section = read_4ubyte_unaligned (dbg, sections + i * 4);
+      /* 2 is DW_SECT_TYPES in version 2 and reserved in version 5.  We ignore
+         it for version 5.
+	 5 is DW_SECT_LOC in version 2 and DW_SECT_LOCLISTS in version 5.  We
+	 use the same index for both.
+	 7 is DW_SECT_MACINFO in version 2 and DW_SECT_MACRO in version 5.  We
+	 use the same index for both.
+	 8 is DW_SECT_MACRO in version 2 and DW_SECT_RNGLISTS in version 5.  We
+	 use the same index for version 2's DW_SECT_MACRO as version 2's
+	 DW_SECT_MACINFO/version 5's DW_SECT_MACRO.
+	 We ignore unknown sections.  */
+      if (section == 0)
+	continue;
+      if (version == 2)
+	{
+	  if (section > 8)
+	    continue;
+	  else if (section == 8)
+	    section = DW_SECT_MACRO;
+	}
+      else if (section == 2
+	       || (section
+		   > sizeof (index->sections) / sizeof (index->sections[0])))
+	continue;
+      index->sections[section - 1] = i;
+    }
+
+  /* DW_SECT_INFO (or DW_SECT_TYPES for DWARF 4 type units) and DW_SECT_ABBREV
+     are required.  */
+  if (((!tu || dbg->sectiondata[IDX_debug_types] == NULL)
+       && index->sections[DW_SECT_INFO - 1] == UINT32_MAX)
+      || (tu && dbg->sectiondata[IDX_debug_types] != NULL
+	  && index->sections[DW_SECT_TYPES - 1] == UINT32_MAX)
+      || index->sections[DW_SECT_ABBREV - 1] == UINT32_MAX)
+    {
+      free (index);
+      __libdw_seterrno (DWARF_E_INVALID_DWARF);
+      return NULL;
+    }
+
+  index->section_count = section_count;
+  index->unit_count = unit_count;
+  index->slot_count = slot_count;
+  index->last_unit_found = 0;
+  index->hash_table = hash_table;
+  index->indices = indices;
+  index->section_offsets = section_offsets;
+  index->section_sizes = section_sizes;
+  index->debug_info_offsets = NULL;
+
+  return index;
+}
+
+static Dwarf_Package_Index *
+__libdw_package_index (Dwarf *dbg, bool tu)
+{
+  if (tu && dbg->tu_index != NULL)
+    return dbg->tu_index;
+  else if (!tu && dbg->cu_index != NULL)
+    return dbg->cu_index;
+
+  Dwarf_Package_Index *index = __libdw_read_package_index (dbg, tu);
+  if (index == NULL)
+    return NULL;
+
+  /* Offsets in the section offset table are 32-bit unsigned integers.  In
+     practice, the .debug_info.dwo section for very large executables can be
+     larger than 4GB.  GNU dwp as of binutils 2.41 and llvm-dwp before LLVM 15
+     both accidentally truncate offsets larger than 4GB.
+
+     LLVM 15 detects the overflow and errors out instead; see LLVM commit
+     f8df8114715b ("[DWP][DWARF] Detect and error on debug info offset
+     overflow").  However, lldb in LLVM 16 supports using dwp files with
+     truncated offsets by recovering them directly from the unit headers in the
+     .debug_info.dwo section; see LLVM commit c0db06227721 ("[DWARFLibrary] Add
+     support to re-construct cu-index").  Since LLVM 17, the overflow error can
+     be turned into a warning instead; see LLVM commit 53a483cee801 ("[DWP] add
+     overflow check for llvm-dwp tools if offset overflow").
+
+     LLVM's support for > 4GB offsets is effectively an extension to the DWARF
+     package file format, which we implement here.  The strategy is to walk the
+     unit headers in .debug_info.dwo in lockstep with the DW_SECT_INFO columns
+     in the section offset tables.  As long as they are in the same order
+     (which they are in practice for both GNU dwp and llvm-dwp), we can
+     correlate the truncated offset and produce a corrected array of offsets.
+
+     Note that this will be fixed properly in DWARF 6:
+     https://dwarfstd.org/issues/220708.2.html.  */
+  if (index->sections[DW_SECT_INFO - 1] != UINT32_MAX
+      && dbg->sectiondata[IDX_debug_info]->d_size > UINT32_MAX)
+    {
+      Dwarf_Package_Index *cu_index, *tu_index = NULL;
+      if (tu)
+	{
+	  tu_index = index;
+	  assert (dbg->cu_index == NULL);
+	  cu_index = __libdw_read_package_index (dbg, false);
+	  if (cu_index == NULL)
+	    {
+	      free(index);
+	      return NULL;
+	    }
+	}
+      else
+	{
+	  cu_index = index;
+	  if (dbg->sectiondata[IDX_debug_tu_index] != NULL
+	      && dbg->sectiondata[IDX_debug_types] == NULL)
+	    {
+	      assert (dbg->tu_index == NULL);
+	      tu_index = __libdw_read_package_index (dbg, true);
+	      if (tu_index == NULL)
+		{
+		  free(index);
+		  return NULL;
+		}
+	    }
+	}
+
+      cu_index->debug_info_offsets = malloc (cu_index->unit_count
+					     * sizeof (Dwarf_Off));
+      if (cu_index->debug_info_offsets == NULL)
+	{
+	  free (tu_index);
+	  free (cu_index);
+	  __libdw_seterrno (DWARF_E_NOMEM);
+	  return NULL;
+	}
+      if (tu_index != NULL)
+	{
+	  tu_index->debug_info_offsets = malloc (tu_index->unit_count
+						 * sizeof (Dwarf_Off));
+	  if (tu_index->debug_info_offsets == NULL)
+	    {
+	      free (tu_index);
+	      free (cu_index->debug_info_offsets);
+	      free (cu_index);
+	      __libdw_seterrno (DWARF_E_NOMEM);
+	      return NULL;
+	    }
+	}
+
+      Dwarf_Off off = 0;
+      uint32_t cui = 0, tui = 0;
+      uint32_t cu_count = cu_index->unit_count;
+      const unsigned char *cu_offset
+	= cu_index->section_offsets + cu_index->sections[DW_SECT_INFO - 1] * 4;
+      uint32_t tu_count = 0;
+      const unsigned char *tu_offset = NULL;
+      if (tu_index != NULL)
+	{
+	  tu_count = tu_index->unit_count;
+	  tu_offset = tu_index->section_offsets
+		      + tu_index->sections[DW_SECT_INFO - 1] * 4;
+	}
+      while (cui < cu_count || tui < tu_count)
+	{
+	  Dwarf_Off next_off;
+	  uint8_t unit_type;
+	  if (__libdw_next_unit (dbg, false, off, &next_off, NULL, NULL,
+				 &unit_type, NULL, NULL, NULL, NULL, NULL)
+	      != 0)
+	    {
+	    not_sorted:
+	      free (cu_index->debug_info_offsets);
+	      cu_index->debug_info_offsets = NULL;
+	      if (tu_index != NULL)
+		{
+		  free (tu_index->debug_info_offsets);
+		  tu_index->debug_info_offsets = NULL;
+		}
+	      break;
+	    }
+	  if (unit_type != DW_UT_split_type && cui < cu_count)
+	    {
+	      if ((off & UINT32_MAX) != read_4ubyte_unaligned (dbg, cu_offset))
+		goto not_sorted;
+	      cu_index->debug_info_offsets[cui++] = off;
+	      cu_offset += cu_index->section_count * 4;
+	    }
+	  else if (unit_type == DW_UT_split_type && tu_index != NULL
+		   && tui < tu_count)
+	    {
+	      if ((off & UINT32_MAX) != read_4ubyte_unaligned (dbg, tu_offset))
+		goto not_sorted;
+	      tu_index->debug_info_offsets[tui++] = off;
+	      tu_offset += tu_index->section_count * 4;
+	    }
+	  off = next_off;
+	}
+
+      if (tu)
+	dbg->cu_index = cu_index;
+      else if (tu_index != NULL)
+	dbg->tu_index = tu_index;
+    }
+
+  if (tu)
+    dbg->tu_index = index;
+  else
+    dbg->cu_index = index;
+  return index;
+}
+
+static int
+__libdw_dwp_unit_row (Dwarf_Package_Index *index, uint64_t unit_id,
+		      uint32_t *unit_rowp)
+{
+  if (index == NULL)
+    return -1;
+
+  uint32_t hash = unit_id;
+  uint32_t hash2 = (unit_id >> 32) | 1;
+  /* Only check each slot once.  */
+  for (uint32_t n = index->slot_count; n-- > 0; )
+    {
+      size_t slot = hash & (index->slot_count - 1);
+      uint64_t sig = read_8ubyte_unaligned (index->dbg,
+					    index->hash_table + slot * 8);
+      if (sig == unit_id)
+	{
+	  uint32_t row = read_4ubyte_unaligned (index->dbg,
+						index->indices + slot * 4);
+	  if (row > index->unit_count)
+	    {
+	      __libdw_seterrno (DWARF_E_INVALID_DWARF);
+	      return -1;
+	    }
+	  *unit_rowp = row;
+	  return 0;
+	}
+      else if (sig == 0
+	       && read_4ubyte_unaligned (index->dbg,
+					 index->indices + slot * 4) == 0)
+	break;
+      hash += hash2;
+    }
+  *unit_rowp = 0;
+  return 0;
+}
+
+static int
+__libdw_dwp_section_info (Dwarf_Package_Index *index, uint32_t unit_row,
+			  unsigned int section, Dwarf_Off *offsetp,
+			  Dwarf_Off *sizep)
+{
+  if (index == NULL)
+    return -1;
+  if (unit_row == 0)
+    {
+      __libdw_seterrno (DWARF_E_INVALID_DWARF);
+      return -1;
+    }
+  if (index->sections[section - 1] == UINT32_MAX)
+    {
+      if (offsetp != NULL)
+	*offsetp = 0;
+      if (sizep != NULL)
+	*sizep = 0;
+      return 0;
+    }
+  size_t i = (size_t)(unit_row - 1) * index->section_count
+	     + index->sections[section - 1];
+  if (offsetp != NULL)
+    {
+      if (section == DW_SECT_INFO && index->debug_info_offsets != NULL)
+	*offsetp = index->debug_info_offsets[unit_row - 1];
+      else
+	*offsetp = read_4ubyte_unaligned (index->dbg,
+					  index->section_offsets + i * 4);
+    }
+  if (sizep != NULL)
+    *sizep = read_4ubyte_unaligned (index->dbg,
+				    index->section_sizes + i * 4);
+  return 0;
+}
+
+int
+internal_function
+__libdw_dwp_find_unit (Dwarf *dbg, bool debug_types, Dwarf_Off off,
+		       uint16_t version, uint8_t unit_type, uint64_t unit_id8,
+		       uint32_t *unit_rowp, Dwarf_Off *abbrev_offsetp)
+{
+  if (version >= 5
+      && unit_type != DW_UT_split_compile && unit_type != DW_UT_split_type)
+    {
+    not_dwp:
+      *unit_rowp = 0;
+      *abbrev_offsetp = 0;
+      return 0;
+    }
+  bool tu = unit_type == DW_UT_split_type || debug_types;
+  if (dbg->sectiondata[tu ? IDX_debug_tu_index : IDX_debug_cu_index] == NULL)
+    goto not_dwp;
+  Dwarf_Package_Index *index = __libdw_package_index (dbg, tu);
+  if (index == NULL)
+    return -1;
+
+  /* This is always called for ascending offsets.  The most obvious way for a
+     producer to generate the section offset table is sorted by offset; both
+     GNU dwp and llvm-dwp do this.  In this common case, we can avoid the full
+     lookup.  */
+  if (index->last_unit_found < index->unit_count)
+    {
+      Dwarf_Off offset, size;
+      if (__libdw_dwp_section_info (index, index->last_unit_found + 1,
+				    debug_types ? DW_SECT_TYPES : DW_SECT_INFO,
+				    &offset, &size) != 0)
+	return -1;
+      if (offset <= off && off - offset < size)
+	{
+	  *unit_rowp = ++index->last_unit_found;
+	  goto done;
+	}
+      else
+	/* The units are not sorted. Don't try again.  */
+	index->last_unit_found = index->unit_count;
+    }
+
+  if (version >= 5 || debug_types)
+    {
+      /* In DWARF 5 and in type units, the unit signature is available in the
+         unit header.  */
+      if (__libdw_dwp_unit_row (index, unit_id8, unit_rowp) != 0)
+	return -1;
+    }
+  else
+    {
+      /* In DWARF 4 compilation units, the unit signature is an attribute.  We
+	 can't parse attributes in the split unit until we get the abbreviation
+	 table offset from the package index, which is a chicken-and-egg
+	 problem.  We could get the signature from the skeleton unit, but that
+	 may not be available.
+
+	 Instead, we resort to a linear scan through the section offset table.
+	 Finding all units is therefore quadratic in the number of units.
+	 However, this will likely never be needed in practice because of the
+	 sorted fast path above.  If this ceases to be the case, we can try to
+	 plumb through the skeleton unit's signature when it is available, or
+	 build a sorted lookup table for binary search.  */
+      if (index->sections[DW_SECT_INFO - 1] == UINT32_MAX)
+	{
+	  __libdw_seterrno (DWARF_E_INVALID_DWARF);
+	  return -1;
+	}
+      for (uint32_t i = 0; i < index->unit_count; i++)
+	{
+	  Dwarf_Off offset, size;
+	  __libdw_dwp_section_info (index, i + 1, DW_SECT_INFO, &offset,
+				    &size);
+	  if (offset <= off && off - offset < size)
+	    {
+	      *unit_rowp = i + 1;
+	      goto done;
+	    }
+	}
+      __libdw_seterrno (DWARF_E_INVALID_DWARF);
+      return -1;
+    }
+
+ done:
+  return __libdw_dwp_section_info (index, *unit_rowp, DW_SECT_ABBREV,
+				   abbrev_offsetp, NULL);
+}
+
+Dwarf_CU *
+internal_function
+__libdw_dwp_findcu_id (Dwarf *dbg, uint64_t unit_id8)
+{
+  Dwarf_Package_Index *index = __libdw_package_index (dbg, false);
+  uint32_t unit_row;
+  Dwarf_Off offset;
+  Dwarf_CU *cu;
+  if (__libdw_dwp_unit_row (index, unit_id8, &unit_row) == 0
+      && __libdw_dwp_section_info (index, unit_row, DW_SECT_INFO, &offset,
+				   NULL) == 0
+      && (cu = __libdw_findcu (dbg, offset, false)) != NULL
+      && cu->unit_type == DW_UT_split_compile
+      && cu->unit_id8 == unit_id8)
+    return cu;
+  else
+    return NULL;
+}
+
+int
+dwarf_cu_dwp_section_info (Dwarf_CU *cu, unsigned int section,
+			   Dwarf_Off *offsetp, Dwarf_Off *sizep)
+{
+  if (cu == NULL)
+    return -1;
+  if (section < DW_SECT_INFO || section > DW_SECT_RNGLISTS)
+    {
+      __libdw_seterrno (DWARF_E_UNKNOWN_SECTION);
+      return -1;
+    }
+  if (cu->dwp_row == 0)
+    {
+      if (offsetp != NULL)
+	*offsetp = 0;
+      if (sizep != NULL)
+	*sizep = 0;
+      return 0;
+    }
+  else
+    {
+      Dwarf_Package_Index *index
+	= cu->unit_type == DW_UT_split_compile
+	? cu->dbg->cu_index : cu->dbg->tu_index;
+      return __libdw_dwp_section_info (index, cu->dwp_row, section, offsetp,
+				       sizep);
+    }
+}
+INTDEF(dwarf_cu_dwp_section_info)
diff --git a/libdw/dwarf_decl_file.c b/libdw/dwarf_decl_file.c
index 75662a33..1b91a4e9 100644
--- a/libdw/dwarf_decl_file.c
+++ b/libdw/dwarf_decl_file.c
@@ -48,42 +48,17 @@ dwarf_decl_file (Dwarf_Die *die)
 			       &idx) != 0)
     return NULL;
 
-  /* Zero means no source file information available.  */
-  if (idx == 0)
-    {
-      __libdw_seterrno (DWARF_E_NO_ENTRY);
-      return NULL;
-    }
-
-  /* Get the array of source files for the CU.  */
-  struct Dwarf_CU *cu = attr_mem.cu;
-  if (cu->lines == NULL)
-    {
-      Dwarf_Lines *lines;
-      size_t nlines;
-
-      /* Let the more generic function do the work.  It'll create more
-	 data but that will be needed in an real program anyway.  */
-      (void) INTUSE(dwarf_getsrclines) (&CUDIE (cu), &lines, &nlines);
-      assert (cu->lines != NULL);
-    }
-
-  if (cu->lines == (void *) -1l)
-    {
-      /* If the file index is not zero, there must be file information
-	 available.  */
-      __libdw_seterrno (DWARF_E_INVALID_DWARF);
-      return NULL;
-    }
-
-  assert (cu->files != NULL && cu->files != (void *) -1l);
+  Dwarf_Files *files;
+  size_t nfiles;
+  if (INTUSE(dwarf_getsrcfiles) (&CUDIE (attr_mem.cu), &files, &nfiles) != 0)
+    return NULL;
 
-  if (idx >= cu->files->nfiles)
+  if (idx >= nfiles)
     {
       __libdw_seterrno (DWARF_E_INVALID_DWARF);
       return NULL;
     }
 
-  return cu->files->info[idx].name;
+  return files->info[idx].name;
 }
 OLD_VERSION (dwarf_decl_file, ELFUTILS_0.122)
diff --git a/libdw/dwarf_end.c b/libdw/dwarf_end.c
index e51d5dd7..ed8d27be 100644
--- a/libdw/dwarf_end.c
+++ b/libdw/dwarf_end.c
@@ -40,6 +40,17 @@
 #include "cfi.h"
 
 
+static void
+dwarf_package_index_free (Dwarf_Package_Index *index)
+{
+  if (index != NULL)
+    {
+      free (index->debug_info_offsets);
+      free (index);
+    }
+}
+
+
 static void
 noop_free (void *arg __attribute__ ((unused)))
 {
@@ -66,7 +77,9 @@ cu_free (void *arg)
 	  /* The fake_addr_cu might be shared, only release one.  */
 	  if (p->dbg->fake_addr_cu == p->split->dbg->fake_addr_cu)
 	    p->split->dbg->fake_addr_cu = NULL;
-	  INTUSE(dwarf_end) (p->split->dbg);
+	  /* There is only one DWP file. We free it later.  */
+	  if (p->split->dbg != p->dbg->dwp_dwarf)
+	    INTUSE(dwarf_end) (p->split->dbg);
 	}
     }
 }
@@ -77,6 +90,9 @@ dwarf_end (Dwarf *dwarf)
 {
   if (dwarf != NULL)
     {
+      dwarf_package_index_free (dwarf->tu_index);
+      dwarf_package_index_free (dwarf->cu_index);
+
       if (dwarf->cfi != NULL)
 	/* Clean up the CFI cache.  */
 	__libdw_destroy_frame_cache (dwarf->cfi);
@@ -144,6 +160,12 @@ dwarf_end (Dwarf *dwarf)
 	  close (dwarf->alt_fd);
 	}
 
+      if (dwarf->dwp_fd != -1)
+	{
+	  INTUSE(dwarf_end) (dwarf->dwp_dwarf);
+	  close (dwarf->dwp_fd);
+	}
+
       /* The cached path and dir we found the Dwarf ELF file in.  */
       free (dwarf->elfpath);
       free (dwarf->debugdir);
diff --git a/libdw/dwarf_error.c b/libdw/dwarf_error.c
index 46ea16b3..0123cfa2 100644
--- a/libdw/dwarf_error.c
+++ b/libdw/dwarf_error.c
@@ -102,6 +102,7 @@ static const char *errmsgs[] =
     [DWARF_E_NOT_CUDIE] = N_("not a CU (unit) DIE"),
     [DWARF_E_UNKNOWN_LANGUAGE] = N_("unknown language code"),
     [DWARF_E_NO_DEBUG_ADDR] = N_(".debug_addr section missing"),
+    [DWARF_E_UNKNOWN_SECTION] = N_("unknown section"),
   };
 #define nerrmsgs (sizeof (errmsgs) / sizeof (errmsgs[0]))
 
diff --git a/libdw/dwarf_get_units.c b/libdw/dwarf_get_units.c
index 6215bf4b..407ed2ba 100644
--- a/libdw/dwarf_get_units.c
+++ b/libdw/dwarf_get_units.c
@@ -129,3 +129,4 @@ dwarf_get_units (Dwarf *dwarf, Dwarf_CU *cu, Dwarf_CU **next_cu,
 
   return 0;
 }
+INTDEF(dwarf_get_units)
diff --git a/libdw/dwarf_getaranges.c b/libdw/dwarf_getaranges.c
index 27439d37..7a3cd36b 100644
--- a/libdw/dwarf_getaranges.c
+++ b/libdw/dwarf_getaranges.c
@@ -33,7 +33,6 @@
 #endif
 
 #include <stdlib.h>
-#include <assert.h>
 #include "libdwP.h"
 #include <dwarf.h>
 
@@ -54,6 +53,147 @@ compare_aranges (const void *a, const void *b)
   return 0;
 }
 
+/* Convert ARANGELIST into Dwarf_Aranges and store at ARANGES.  */
+static bool
+finalize_aranges (Dwarf *dbg, Dwarf_Aranges **aranges, size_t *naranges,
+		  struct arangelist *arangelist, unsigned int narangelist)
+{
+  /* Allocate the array for the result.  */
+  void *buf = libdw_alloc (dbg, Dwarf_Aranges,
+			   sizeof (Dwarf_Aranges)
+			   + narangelist * sizeof (Dwarf_Arange), 1);
+
+  /* First use the buffer for the pointers, and sort the entries.
+     We'll write the pointers in the end of the buffer, and then
+     copy into the buffer from the beginning so the overlap works.  */
+  eu_static_assert (sizeof (Dwarf_Arange) >= sizeof (Dwarf_Arange *));
+  struct arangelist **sortaranges
+    = (buf + sizeof (Dwarf_Aranges)
+       + ((sizeof (Dwarf_Arange) - sizeof sortaranges[0]) * narangelist));
+
+  /* The list is in LIFO order and usually they come in clumps with
+     ascending addresses.  So fill from the back to probably start with
+     runs already in order before we sort.  */
+  unsigned int i = narangelist;
+  while (i-- > 0)
+    {
+      sortaranges[i] = arangelist;
+      arangelist = arangelist->next;
+    }
+
+  /* Something went wrong if narangelist is less then the actual length
+     of arangelist. */
+  if (arangelist != NULL)
+    {
+      __libdw_seterrno (DWARF_E_UNKNOWN_ERROR);
+      return false;
+    }
+
+  /* Sort by ascending address.  */
+  qsort (sortaranges, narangelist, sizeof sortaranges[0], &compare_aranges);
+
+  /* Now that they are sorted, put them in the final array.
+     The buffers overlap, so we've clobbered the early elements
+     of SORTARANGES by the time we're reading the later ones.  */
+  *aranges = buf;
+  (*aranges)->dbg = dbg;
+  (*aranges)->naranges = narangelist;
+  if (naranges != NULL)
+    *naranges = narangelist;
+  for (i = 0; i < narangelist; ++i)
+    {
+      struct arangelist *elt = sortaranges[i];
+      (*aranges)->info[i] = elt->arange;
+      free (elt);
+    }
+
+  return true;
+}
+
+int
+__libdw_getdieranges (Dwarf *dbg, Dwarf_Aranges **aranges, size_t *naranges)
+{
+  if (dbg == NULL)
+    return -1;
+
+  if (dbg->dieranges != NULL)
+    {
+      *aranges = dbg->dieranges;
+      if (naranges != NULL)
+	*naranges = dbg->dieranges->naranges;
+      return 0;
+    }
+
+  struct arangelist *arangelist = NULL;
+  unsigned int narangelist = 0;
+
+  Dwarf_CU *cu = NULL;
+  while (INTUSE(dwarf_get_units) (dbg, cu, &cu, NULL, NULL, NULL, NULL) == 0)
+    {
+      Dwarf_Addr base;
+      Dwarf_Addr low;
+      Dwarf_Addr high;
+
+      Dwarf_Die cudie = CUDIE (cu);
+
+      /* Skip CUs that only contain type information.  */
+      if (!INTUSE(dwarf_hasattr) (&cudie, DW_AT_low_pc)
+	  && !INTUSE(dwarf_hasattr) (&cudie, DW_AT_ranges))
+	continue;
+
+      ptrdiff_t offset = 0;
+
+      /* Add arange for each range list entry or high_pc and low_pc.  */
+      while ((offset = INTUSE(dwarf_ranges) (&cudie, offset,
+					     &base, &low, &high)) > 0)
+	{
+	  if (offset == -1)
+	    {
+	      __libdw_seterrno (DWARF_E_INVALID_DWARF);
+	      goto fail;
+	    }
+
+	  struct arangelist *new_arange = malloc (sizeof *new_arange);
+	  if (unlikely (new_arange == NULL))
+	    {
+	      __libdw_seterrno (DWARF_E_NOMEM);
+	      goto fail;
+	    }
+
+	  new_arange->arange.addr = low;
+	  new_arange->arange.length = (Dwarf_Word) (high - low);
+	  new_arange->arange.offset = __libdw_first_die_off_from_cu (cu);
+
+	  new_arange->next = arangelist;
+	  arangelist = new_arange;
+	  ++narangelist;
+	}
+    }
+
+  if (narangelist == 0)
+    {
+      if (naranges != NULL)
+	*naranges = 0;
+      *aranges = NULL;
+      return 0;
+    }
+
+  if (!finalize_aranges (dbg, aranges, naranges, arangelist, narangelist))
+    goto fail;
+
+  dbg->dieranges = *aranges;
+  return 0;
+
+fail:
+  while (arangelist != NULL)
+    {
+      struct arangelist *next = arangelist->next;
+      free (arangelist);
+      arangelist = next;
+    }
+  return -1;
+}
+
 int
 dwarf_getaranges (Dwarf *dbg, Dwarf_Aranges **aranges, size_t *naranges)
 {
@@ -235,56 +375,16 @@ dwarf_getaranges (Dwarf *dbg, Dwarf_Aranges **aranges, size_t *naranges)
 
   if (narangelist == 0)
     {
-      assert (arangelist == NULL);
       if (naranges != NULL)
 	*naranges = 0;
       *aranges = NULL;
       return 0;
     }
 
-  /* Allocate the array for the result.  */
-  void *buf = libdw_alloc (dbg, Dwarf_Aranges,
-			   sizeof (Dwarf_Aranges)
-			   + narangelist * sizeof (Dwarf_Arange), 1);
+  if (!finalize_aranges (dbg, aranges, naranges, arangelist, narangelist))
+    goto fail;
 
-  /* First use the buffer for the pointers, and sort the entries.
-     We'll write the pointers in the end of the buffer, and then
-     copy into the buffer from the beginning so the overlap works.  */
-  assert (sizeof (Dwarf_Arange) >= sizeof (Dwarf_Arange *));
-  struct arangelist **sortaranges
-    = (buf + sizeof (Dwarf_Aranges)
-       + ((sizeof (Dwarf_Arange) - sizeof sortaranges[0]) * narangelist));
-
-  /* The list is in LIFO order and usually they come in clumps with
-     ascending addresses.  So fill from the back to probably start with
-     runs already in order before we sort.  */
-  unsigned int i = narangelist;
-  while (i-- > 0)
-    {
-      sortaranges[i] = arangelist;
-      arangelist = arangelist->next;
-    }
-  assert (arangelist == NULL);
-
-  /* Sort by ascending address.  */
-  qsort (sortaranges, narangelist, sizeof sortaranges[0], &compare_aranges);
-
-  /* Now that they are sorted, put them in the final array.
-     The buffers overlap, so we've clobbered the early elements
-     of SORTARANGES by the time we're reading the later ones.  */
-  *aranges = buf;
-  (*aranges)->dbg = dbg;
-  (*aranges)->naranges = narangelist;
   dbg->aranges = *aranges;
-  if (naranges != NULL)
-    *naranges = narangelist;
-  for (i = 0; i < narangelist; ++i)
-    {
-      struct arangelist *elt = sortaranges[i];
-      (*aranges)->info[i] = elt->arange;
-      free (elt);
-    }
-
   return 0;
 }
 INTDEF(dwarf_getaranges)
diff --git a/libdw/dwarf_getlocation.c b/libdw/dwarf_getlocation.c
index 553fdc98..37b32fc1 100644
--- a/libdw/dwarf_getlocation.c
+++ b/libdw/dwarf_getlocation.c
@@ -812,6 +812,12 @@ initial_offset (Dwarf_Attribute *attr, ptrdiff_t *offset)
 			    : DWARF_E_NO_DEBUG_LOCLISTS),
 			    NULL, &start_offset) == NULL)
 	return -1;
+
+      Dwarf_Off loc_off;
+      if (INTUSE(dwarf_cu_dwp_section_info) (attr->cu, DW_SECT_LOCLISTS,
+					     &loc_off, NULL) != 0)
+	return -1;
+      start_offset += loc_off;
     }
 
   *offset = start_offset;
diff --git a/libdw/dwarf_getmacros.c b/libdw/dwarf_getmacros.c
index a3a78884..2667eb45 100644
--- a/libdw/dwarf_getmacros.c
+++ b/libdw/dwarf_getmacros.c
@@ -47,7 +47,15 @@ get_offset_from (Dwarf_Die *die, int name, Dwarf_Word *retp)
     return -1;
 
   /* Offset into the corresponding section.  */
-  return INTUSE(dwarf_formudata) (&attr, retp);
+  if (INTUSE(dwarf_formudata) (&attr, retp) != 0)
+    return -1;
+
+  Dwarf_Off offset;
+  if (INTUSE(dwarf_cu_dwp_section_info) (die->cu, DW_SECT_MACRO, &offset, NULL)
+      != 0)
+    return -1;
+  *retp += offset;
+  return 0;
 }
 
 static int
@@ -131,6 +139,14 @@ get_macinfo_table (Dwarf *dbg, Dwarf_Word macoff, Dwarf_Die *cudie)
   else if (cudie->cu->unit_type == DW_UT_split_compile
 	   && dbg->sectiondata[IDX_debug_line] != NULL)
     line_offset = 0;
+  if (line_offset != (Dwarf_Off) -1)
+    {
+      Dwarf_Off dwp_offset;
+      if (INTUSE(dwarf_cu_dwp_section_info) (cudie->cu, DW_SECT_LINE,
+					     &dwp_offset, NULL) != 0)
+	return NULL;
+      line_offset += dwp_offset;
+    }
 
   Dwarf_Macro_Op_Table *table = libdw_alloc (dbg, Dwarf_Macro_Op_Table,
 					     macinfo_data_size, 1);
@@ -188,6 +204,14 @@ get_table_for_offset (Dwarf *dbg, Dwarf_Word macoff,
 	if (unlikely (INTUSE(dwarf_formudata) (attr, &line_offset) != 0))
 	  return NULL;
     }
+  if (line_offset != (Dwarf_Off) -1 && cudie != NULL)
+    {
+      Dwarf_Off dwp_offset;
+      if (INTUSE(dwarf_cu_dwp_section_info) (cudie->cu, DW_SECT_LINE,
+					     &dwp_offset, NULL) != 0)
+	return NULL;
+      line_offset += dwp_offset;
+    }
 
   uint8_t address_size;
   if (cudie != NULL)
diff --git a/libdw/dwarf_getsrc_file.c b/libdw/dwarf_getsrc_file.c
index 5289c7da..03da431c 100644
--- a/libdw/dwarf_getsrc_file.c
+++ b/libdw/dwarf_getsrc_file.c
@@ -98,7 +98,7 @@ dwarf_getsrc_file (Dwarf *dbg, const char *fname, int lineno, int column,
 	      /* Match the name with the name the user provided.  */
 	      const char *fname2 = line->files->info[lastfile].name;
 	      if (is_basename)
-		lastmatch = strcmp (basename (fname2), fname) == 0;
+		lastmatch = strcmp (xbasename (fname2), fname) == 0;
 	      else
 		lastmatch = strcmp (fname2, fname) == 0;
 	    }
diff --git a/libdw/dwarf_getsrcfiles.c b/libdw/dwarf_getsrcfiles.c
index 12fdabf2..cd2e5b5a 100644
--- a/libdw/dwarf_getsrcfiles.c
+++ b/libdw/dwarf_getsrcfiles.c
@@ -64,12 +64,17 @@ dwarf_getsrcfiles (Dwarf_Die *cudie, Dwarf_Files **files, size_t *nfiles)
 	     the table is at offset zero.  */
 	  if (cu->dbg->sectiondata[IDX_debug_line] != NULL)
 	    {
-	      /* We are only interested in the files, the lines will
-		 always come from the skeleton.  */
-	      res = __libdw_getsrclines (cu->dbg, 0,
-					 __libdw_getcompdir (cudie),
-					 cu->address_size, NULL,
-					 &cu->files);
+	      Dwarf_Off dwp_off;
+	      if (INTUSE(dwarf_cu_dwp_section_info) (cu, DW_SECT_LINE,
+						     &dwp_off, NULL) == 0)
+		{
+		  /* We are only interested in the files, the lines will
+		     always come from the skeleton.  */
+		  res = __libdw_getsrclines (cu->dbg, dwp_off,
+					     __libdw_getcompdir (cudie),
+					     cu->address_size, NULL,
+					     &cu->files);
+		}
 	    }
 	  else
 	    {
diff --git a/libdw/dwarf_next_lines.c b/libdw/dwarf_next_lines.c
index 9b76b47e..a96bd73e 100644
--- a/libdw/dwarf_next_lines.c
+++ b/libdw/dwarf_next_lines.c
@@ -95,62 +95,54 @@ dwarf_next_lines (Dwarf *dbg, Dwarf_Off off,
     {
       /* We need to find the matching CU to get the comp_dir.  Use the
 	 given CU as hint where to start searching.  Normally it will
-	 be the next CU that has a statement list. */
+	 be the next CU that has a statement list.  If the CUs are in a
+	 different order from the line tables, then we do a linear
+	 search.  */
       Dwarf_CU *given_cu = *cu;
       Dwarf_CU *next_cu = given_cu;
-      bool found = false;
-      while (dwarf_get_units (dbg, next_cu, &next_cu, NULL, NULL,
-			      &cudie, NULL) == 0)
+      bool restarted = false;
+      while (1)
 	{
-	  if (dwarf_hasattr (&cudie, DW_AT_stmt_list))
+	  if (restarted && next_cu == given_cu)
 	    {
-	      Dwarf_Attribute attr;
-	      Dwarf_Word stmt_off;
-	      if (dwarf_formudata (dwarf_attr (&cudie, DW_AT_stmt_list, &attr),
-				   &stmt_off) == 0
-		  && stmt_off == off)
-		{
-		  found = true;
-		  break;
-		}
+	      /* We checked all of the CUs and there was no match.  */
+	      *cu = NULL;
+	      break;
 	    }
-	  else if (off == 0
-		   && (next_cu->unit_type == DW_UT_split_compile
-		       || next_cu->unit_type == DW_UT_split_type))
+	  if (INTUSE(dwarf_get_units) (dbg, next_cu, &next_cu, NULL, NULL,
+				       &cudie, NULL) != 0)
 	    {
-	      /* For split units (in .dwo files) there is only one table
-		 at offset zero (containing just the files, no lines).  */
-	      found = true;
-	      break;
+	      /* We didn't find the matching CU after the starting point.
+	         Check the CUs up to the starting point.  */
+	      next_cu = NULL;
+	      restarted = true;
+	      continue;
 	    }
-	}
 
-      if (!found && given_cu != NULL)
-	{
-	  /* The CUs might be in a different order from the line
-	     tables. Need to do a linear search (but stop at the given
-	     CU, since we already searched those.  */
-	  next_cu = NULL;
-	  while (dwarf_get_units (dbg, next_cu, &next_cu, NULL, NULL,
-				  &cudie, NULL) == 0
-		 && next_cu != given_cu)
+	  Dwarf_Word stmt_off = 0;
+	  if (dwarf_hasattr (&cudie, DW_AT_stmt_list))
 	    {
 	      Dwarf_Attribute attr;
-	      Dwarf_Word stmt_off;
 	      if (dwarf_formudata (dwarf_attr (&cudie, DW_AT_stmt_list, &attr),
-				   &stmt_off) == 0
-		  && stmt_off == off)
-		{
-		  found = true;
-		  break;
-		}
+				   &stmt_off) != 0)
+		continue;
 	    }
-	}
+	  /* Split units have an implicit offset of 0.  */
+	  else if (next_cu->unit_type != DW_UT_split_compile
+		   && next_cu->unit_type != DW_UT_split_type)
+	    continue;
 
-      if (found)
-	*cu = next_cu;
-      else
-	*cu = NULL;
+	  Dwarf_Off dwp_off;
+	  if (INTUSE(dwarf_cu_dwp_section_info) (next_cu, DW_SECT_LINE,
+						 &dwp_off, NULL) == 0)
+	    stmt_off += dwp_off;
+
+	  if (stmt_off == off)
+	    {
+	      *cu = next_cu;
+	      break;
+	    }
+	}
     }
   else
     *cu = NULL;
diff --git a/libdw/libdw.h b/libdw/libdw.h
index 64d1689a..d53dc787 100644
--- a/libdw/libdw.h
+++ b/libdw/libdw.h
@@ -1081,6 +1081,33 @@ extern int dwarf_frame_register (Dwarf_Frame *frame, int regno,
   __nonnull_attribute__ (3, 4, 5);
 
 
+/* Return offset and/or size of CU's contribution to SECTION in a
+   DWARF package file.
+
+   If CU is not from a DWARF package file, the file does not have
+   SECTION, or CU does not contribute to SECTION, then *OFFSETP and
+   *SIZEP are set to 0 (this is not an error and the function will
+   return 0 in that case).
+
+   SECTION is a DW_SECT section identifier.  Note that the original
+   GNU DWARF package file extension for DWARF 4 used slightly
+   different section identifiers.  This function uses the standardized
+   section identifiers and maps the GNU DWARF 4 identifiers to their
+   standard DWARF 5 analogues: DW_SECT_LOCLISTS (5) refers to
+   .debug_locs.dwo for DWARF 4.  DW_SECT_MACRO (7) refers to
+   .debug_macinfo.dwo for DWARF 4 or .debug_macro.dwo for the GNU
+   .debug_macro extension for DWARF 4 (section identifier 8 is
+   DW_SECT_RNGLISTS in DWARF 5, NOT DW_SECT_MACRO like in the GNU
+   extension.)  .debug_types.dwo does not have a DWARF 5 equivalent,
+   so this function accepts the original DW_SECT_TYPES (2).
+
+   Returns 0 for success or -1 for errors reading the DWARF package
+   file data or if an unknown SECTION constant is given.  OFFSETP and
+   SIZEP may be NULL.  */
+extern int dwarf_cu_dwp_section_info (Dwarf_CU *cu, unsigned int section,
+				      Dwarf_Off *offsetp, Dwarf_Off *sizep);
+
+
 /* Return error code of last failing function call.  This value is kept
    separately for each thread.  */
 extern int dwarf_errno (void);
diff --git a/libdw/libdw.map b/libdw/libdw.map
index 5331ad45..3c5ce8dc 100644
--- a/libdw/libdw.map
+++ b/libdw/libdw.map
@@ -373,3 +373,8 @@ ELFUTILS_0.188 {
     dwfl_frame_reg;
     dwfl_report_offline_memory;
 } ELFUTILS_0.186;
+
+ELFUTILS_0.191 {
+  global:
+    dwarf_cu_dwp_section_info;
+} ELFUTILS_0.188;
diff --git a/libdw/libdwP.h b/libdw/libdwP.h
index aef42267..8b2f06fa 100644
--- a/libdw/libdwP.h
+++ b/libdw/libdwP.h
@@ -147,6 +147,7 @@ enum
   DWARF_E_NOT_CUDIE,
   DWARF_E_UNKNOWN_LANGUAGE,
   DWARF_E_NO_DEBUG_ADDR,
+  DWARF_E_UNKNOWN_SECTION,
 };
 
 
@@ -179,6 +180,9 @@ struct Dwarf
   /* dwz alternate DWARF file.  */
   Dwarf *alt_dwarf;
 
+  /* DWARF package file.  */
+  Dwarf *dwp_dwarf;
+
   /* The section data.  */
   Elf_Data *sectiondata[IDX_last];
 
@@ -196,6 +200,9 @@ struct Dwarf
      close this file descriptor.  */
   int alt_fd;
 
+  /* File descriptor of DWARF package file.  */
+  int dwp_fd;
+
   /* Information for traversing the .debug_pubnames section.  This is
      an array and separately allocated with malloc.  */
   struct pubnames_s
@@ -225,12 +232,20 @@ struct Dwarf
   /* Search tree for decoded .debug_line units.  */
   void *files_lines;
 
-  /* Address ranges.  */
+  /* Address ranges read from .debug_aranges.  */
   Dwarf_Aranges *aranges;
 
+  /* Address ranges inferred from CUs.  */
+  Dwarf_Aranges *dieranges;
+
   /* Cached info from the CFI section.  */
   struct Dwarf_CFI_s *cfi;
 
+  /* DWARF package file CU index section.  */
+  struct Dwarf_Package_Index_s *cu_index;
+  /* DWARF package file TU index section.  */
+  struct Dwarf_Package_Index_s *tu_index;
+
   /* Fake loc CU.  Used when synthesizing attributes for Dwarf_Ops that
      came from a location list entry in dwarf_getlocation_attr.
      Depending on version this is the .debug_loc or .debug_loclists
@@ -343,6 +358,26 @@ struct Dwarf_Aranges_s
   } info[0];
 };
 
+/* DWARF package file unit index.  */
+typedef struct Dwarf_Package_Index_s
+{
+  Dwarf *dbg;
+  uint32_t section_count;
+  uint32_t unit_count;
+  uint32_t slot_count;
+  /* Mapping from DW_SECT_* - 1 to column number in the section tables, or
+     UINT32_MAX if not present.  */
+  uint32_t sections[DW_SECT_RNGLISTS];
+  /* Row number of last unit found in the index.  */
+  uint32_t last_unit_found;
+  const unsigned char *hash_table;
+  const unsigned char *indices;
+  const unsigned char *section_offsets;
+  const unsigned char *section_sizes;
+  /* If DW_SECT_INFO section offsets were truncated to 32 bits, recovered
+     64-bit offsets.  */
+  Dwarf_Off *debug_info_offsets;
+} Dwarf_Package_Index;
 
 /* CU representation.  */
 struct Dwarf_CU
@@ -350,6 +385,8 @@ struct Dwarf_CU
   Dwarf *dbg;
   Dwarf_Off start;
   Dwarf_Off end;
+  /* Row number of this unit in DWARF package file index.  */
+  uint32_t dwp_row;
   uint8_t address_size;
   uint8_t offset_size;
   uint16_t version;
@@ -414,6 +451,50 @@ struct Dwarf_CU
   void *endp;
 };
 
+/* Aliases to avoid PLTs.  */
+INTDECL (dwarf_aggregate_size)
+INTDECL (dwarf_attr)
+INTDECL (dwarf_attr_integrate)
+INTDECL (dwarf_begin)
+INTDECL (dwarf_begin_elf)
+INTDECL (dwarf_child)
+INTDECL (dwarf_cu_dwp_section_info)
+INTDECL (dwarf_default_lower_bound)
+INTDECL (dwarf_dieoffset)
+INTDECL (dwarf_diename)
+INTDECL (dwarf_end)
+INTDECL (dwarf_entrypc)
+INTDECL (dwarf_errmsg)
+INTDECL (dwarf_formaddr)
+INTDECL (dwarf_formblock)
+INTDECL (dwarf_formref_die)
+INTDECL (dwarf_formsdata)
+INTDECL (dwarf_formstring)
+INTDECL (dwarf_formudata)
+INTDECL (dwarf_getabbrevattr_data)
+INTDECL (dwarf_getalt)
+INTDECL (dwarf_getarange_addr)
+INTDECL (dwarf_getarangeinfo)
+INTDECL (dwarf_getaranges)
+INTDECL (dwarf_getlocation_die)
+INTDECL (dwarf_getsrcfiles)
+INTDECL (dwarf_getsrclines)
+INTDECL (dwarf_get_units)
+INTDECL (dwarf_hasattr)
+INTDECL (dwarf_haschildren)
+INTDECL (dwarf_haspc)
+INTDECL (dwarf_highpc)
+INTDECL (dwarf_lowpc)
+INTDECL (dwarf_nextcu)
+INTDECL (dwarf_next_unit)
+INTDECL (dwarf_offdie)
+INTDECL (dwarf_peel_type)
+INTDECL (dwarf_ranges)
+INTDECL (dwarf_setalt)
+INTDECL (dwarf_siblingof)
+INTDECL (dwarf_srclang)
+INTDECL (dwarf_tag)
+
 #define ISV4TU(cu) ((cu)->version == 4 && (cu)->sec_idx == IDX_debug_types)
 
 /* Compute the offset of a CU's first DIE from the CU offset.
@@ -684,6 +765,17 @@ extern struct Dwarf *__libdw_find_split_dbg_addr (Dwarf *dbg, void *addr)
 extern struct Dwarf_CU *__libdw_find_split_unit (Dwarf_CU *cu)
      internal_function;
 
+/* Find a unit in a DWARF package file for __libdw_intern_next_unit.  */
+extern int __libdw_dwp_find_unit (Dwarf *dbg, bool debug_types, Dwarf_Off off,
+				  uint16_t version, uint8_t unit_type,
+				  uint64_t unit_id8, uint32_t *unit_rowp,
+				  Dwarf_Off *abbrev_offsetp)
+     __nonnull_attribute__ (1, 7, 8) internal_function;
+
+/* Find the compilation unit in a DWARF package file with the given id.  */
+extern Dwarf_CU *__libdw_dwp_findcu_id (Dwarf *dbg, uint64_t unit_id8)
+     __nonnull_attribute__ (1) internal_function;
+
 /* Get abbreviation with given code.  */
 extern Dwarf_Abbrev *__libdw_findabbrev (struct Dwarf_CU *cu,
 					 unsigned int code)
@@ -1061,30 +1153,35 @@ str_offsets_base_off (Dwarf *dbg, Dwarf_CU *cu)
   if (cu == NULL && dbg != NULL)
     {
       Dwarf_CU *first_cu;
-      if (dwarf_get_units (dbg, NULL, &first_cu,
-			   NULL, NULL, NULL, NULL) == 0)
+      if (INTUSE(dwarf_get_units) (dbg, NULL, &first_cu,
+				   NULL, NULL, NULL, NULL) == 0)
 	cu = first_cu;
     }
 
+  Dwarf_Off off = 0;
   if (cu != NULL)
     {
       if (cu->str_off_base == (Dwarf_Off) -1)
 	{
+	  Dwarf_Off dwp_offset;
+	  if (dwarf_cu_dwp_section_info (cu, DW_SECT_STR_OFFSETS, &dwp_offset,
+					 NULL) == 0)
+	    off = dwp_offset;
 	  Dwarf_Die cu_die = CUDIE(cu);
 	  Dwarf_Attribute attr;
 	  if (dwarf_attr (&cu_die, DW_AT_str_offsets_base, &attr) != NULL)
 	    {
-	      Dwarf_Word off;
-	      if (dwarf_formudata (&attr, &off) == 0)
+	      Dwarf_Word base;
+	      if (dwarf_formudata (&attr, &base) == 0)
 		{
-		  cu->str_off_base = off;
+		  cu->str_off_base = off + base;
 		  return cu->str_off_base;
 		}
 	    }
 	  /* For older DWARF simply assume zero (no header).  */
 	  if (cu->version < 5)
 	    {
-	      cu->str_off_base = 0;
+	      cu->str_off_base = off;
 	      return cu->str_off_base;
 	    }
 
@@ -1097,7 +1194,6 @@ str_offsets_base_off (Dwarf *dbg, Dwarf_CU *cu)
 
   /* No str_offsets_base attribute, we have to assume "zero".
      But there could be a header first.  */
-  Dwarf_Off off = 0;
   if (dbg == NULL)
     goto no_header;
 
@@ -1139,7 +1235,7 @@ str_offsets_base_off (Dwarf *dbg, Dwarf_CU *cu)
   /* padding */
   read_2ubyte_unaligned_inc (dbg, readp);
 
-  off = (Dwarf_Off) (readp - start);
+  off += (Dwarf_Off) (readp - start);
 
  no_header:
   if (cu != NULL)
@@ -1177,18 +1273,23 @@ __libdw_cu_ranges_base (Dwarf_CU *cu)
 	}
       else
 	{
+	  Dwarf_Off dwp_offset;
+	  if (dwarf_cu_dwp_section_info (cu, DW_SECT_RNGLISTS, &dwp_offset,
+					 NULL) == 0)
+	    offset = dwp_offset;
+
 	  if (dwarf_attr (&cu_die, DW_AT_rnglists_base, &attr) != NULL)
 	    {
 	      Dwarf_Word off;
 	      if (dwarf_formudata (&attr, &off) == 0)
-		offset = off;
+		offset += off;
 	    }
 
 	  /* There wasn't an rnglists_base, if the Dwarf does have a
 	     .debug_rnglists section, then it might be we need the
 	     base after the first header. */
 	  Elf_Data *data = cu->dbg->sectiondata[IDX_debug_rnglists];
-	  if (offset == 0 && data != NULL)
+	  if (offset == dwp_offset && data != NULL)
 	    {
 	      Dwarf *dbg = cu->dbg;
 	      const unsigned char *readp = data->d_buf;
@@ -1234,8 +1335,8 @@ __libdw_cu_ranges_base (Dwarf_CU *cu)
 	      if (unit_length - 8 < needed)
 		goto no_header;
 
-	      offset = (Dwarf_Off) (offset_array_start
-				    - (unsigned char *) data->d_buf);
+	      offset += (Dwarf_Off) (offset_array_start
+				     - (unsigned char *) data->d_buf);
 	    }
 	}
     no_header:
@@ -1253,20 +1354,25 @@ __libdw_cu_locs_base (Dwarf_CU *cu)
   if (cu->locs_base == (Dwarf_Off) -1)
     {
       Dwarf_Off offset = 0;
+      Dwarf_Off dwp_offset;
+      if (dwarf_cu_dwp_section_info (cu, DW_SECT_LOCLISTS, &dwp_offset, NULL)
+	  == 0)
+	offset = dwp_offset;
+
       Dwarf_Die cu_die = CUDIE(cu);
       Dwarf_Attribute attr;
       if (dwarf_attr (&cu_die, DW_AT_loclists_base, &attr) != NULL)
 	{
 	  Dwarf_Word off;
 	  if (dwarf_formudata (&attr, &off) == 0)
-	    offset = off;
+	    offset += off;
 	}
 
       /* There wasn't an loclists_base, if the Dwarf does have a
 	 .debug_loclists section, then it might be we need the
 	 base after the first header. */
       Elf_Data *data = cu->dbg->sectiondata[IDX_debug_loclists];
-      if (offset == 0 && data != NULL)
+      if (offset == dwp_offset && data != NULL)
 	{
 	  Dwarf *dbg = cu->dbg;
 	  const unsigned char *readp = data->d_buf;
@@ -1312,8 +1418,8 @@ __libdw_cu_locs_base (Dwarf_CU *cu)
 	  if (unit_length - 8 < needed)
 	    goto no_header;
 
-	  offset = (Dwarf_Off) (offset_array_start
-				- (unsigned char *) data->d_buf);
+	  offset += (Dwarf_Off) (offset_array_start
+				 - (unsigned char *) data->d_buf);
 	}
 
     no_header:
@@ -1335,12 +1441,19 @@ __libdw_link_skel_split (Dwarf_CU *skel, Dwarf_CU *split)
 
   /* Get .debug_addr and addr_base greedy.
      We also need it for the fake addr cu.
-     There is only one per split debug.  */
+     This needs to be done for each split unit (one per .dwo file, or multiple
+     per .dwp file).  */
   Dwarf *dbg = skel->dbg;
   Dwarf *sdbg = split->dbg;
-  if (sdbg->sectiondata[IDX_debug_addr] == NULL
-      && dbg->sectiondata[IDX_debug_addr] != NULL)
+  if (dbg->sectiondata[IDX_debug_addr] != NULL
+      /* If this split file hasn't been linked yet...  */
+      && (sdbg->sectiondata[IDX_debug_addr] == NULL
+	  /* ... or it was linked to the same skeleton file for another
+	     unit...  */
+	  || (sdbg->sectiondata[IDX_debug_addr]
+	      == dbg->sectiondata[IDX_debug_addr])))
     {
+      /* ... then link the address information for this file and unit.  */
       sdbg->sectiondata[IDX_debug_addr]
 	= dbg->sectiondata[IDX_debug_addr];
       split->addr_base = __libdw_cu_addr_base (skel);
@@ -1380,47 +1493,11 @@ char * __libdw_filepath (const char *debugdir, const char *dir,
 			 const char *file)
   internal_function;
 
+/* Like dwarf_getaranges but aranges are generated from CU address
+   ranges instead of being read from .debug_aranges.
 
-/* Aliases to avoid PLTs.  */
-INTDECL (dwarf_aggregate_size)
-INTDECL (dwarf_attr)
-INTDECL (dwarf_attr_integrate)
-INTDECL (dwarf_begin)
-INTDECL (dwarf_begin_elf)
-INTDECL (dwarf_child)
-INTDECL (dwarf_default_lower_bound)
-INTDECL (dwarf_dieoffset)
-INTDECL (dwarf_diename)
-INTDECL (dwarf_end)
-INTDECL (dwarf_entrypc)
-INTDECL (dwarf_errmsg)
-INTDECL (dwarf_formaddr)
-INTDECL (dwarf_formblock)
-INTDECL (dwarf_formref_die)
-INTDECL (dwarf_formsdata)
-INTDECL (dwarf_formstring)
-INTDECL (dwarf_formudata)
-INTDECL (dwarf_getabbrevattr_data)
-INTDECL (dwarf_getalt)
-INTDECL (dwarf_getarange_addr)
-INTDECL (dwarf_getarangeinfo)
-INTDECL (dwarf_getaranges)
-INTDECL (dwarf_getlocation_die)
-INTDECL (dwarf_getsrcfiles)
-INTDECL (dwarf_getsrclines)
-INTDECL (dwarf_hasattr)
-INTDECL (dwarf_haschildren)
-INTDECL (dwarf_haspc)
-INTDECL (dwarf_highpc)
-INTDECL (dwarf_lowpc)
-INTDECL (dwarf_nextcu)
-INTDECL (dwarf_next_unit)
-INTDECL (dwarf_offdie)
-INTDECL (dwarf_peel_type)
-INTDECL (dwarf_ranges)
-INTDECL (dwarf_setalt)
-INTDECL (dwarf_siblingof)
-INTDECL (dwarf_srclang)
-INTDECL (dwarf_tag)
-
+   Returns 0 if successful and updates ARANGES and NARANGES.  Otherwise
+   returns -1 and sets libdw_errno.
+*/
+int __libdw_getdieranges (Dwarf *dbg, Dwarf_Aranges **aranges, size_t *naranges);
 #endif	/* libdwP.h */
diff --git a/libdw/libdw_find_split_unit.c b/libdw/libdw_find_split_unit.c
index 533f8072..8426a925 100644
--- a/libdw/libdw_find_split_unit.c
+++ b/libdw/libdw_find_split_unit.c
@@ -51,8 +51,8 @@ try_split_file (Dwarf_CU *cu, const char *dwo_path)
       if (split_dwarf != NULL)
 	{
 	  Dwarf_CU *split = NULL;
-	  while (dwarf_get_units (split_dwarf, split, &split,
-				  NULL, NULL, NULL, NULL) == 0)
+	  while (INTUSE(dwarf_get_units) (split_dwarf, split, &split,
+					  NULL, NULL, NULL, NULL) == 0)
 	    {
 	      if (split->unit_type == DW_UT_split_compile
 		  && cu->unit_id8 == split->unit_id8)
@@ -85,6 +85,67 @@ try_split_file (Dwarf_CU *cu, const char *dwo_path)
     }
 }
 
+static void
+try_dwp_file (Dwarf_CU *cu)
+{
+  if (cu->dbg->dwp_dwarf == NULL)
+    {
+      if (cu->dbg->elfpath != NULL)
+	{
+	  /* The DWARF 5 standard says "the package file is typically placed in
+	     the same directory as the application, and is given the same name
+	     with a '.dwp' extension".  */
+	  size_t elfpath_len = strlen (cu->dbg->elfpath);
+	  char *dwp_path = malloc (elfpath_len + 5);
+	  if (dwp_path == NULL)
+	    {
+	      __libdw_seterrno (DWARF_E_NOMEM);
+	      return;
+	    }
+	  memcpy (dwp_path, cu->dbg->elfpath, elfpath_len);
+	  strcpy (dwp_path + elfpath_len, ".dwp");
+	  int dwp_fd = open (dwp_path, O_RDONLY);
+	  free (dwp_path);
+	  if (dwp_fd != -1)
+	    {
+	      Dwarf *dwp_dwarf = dwarf_begin (dwp_fd, DWARF_C_READ);
+	      /* There's no way to know whether we got the correct file until
+		 we look up the unit, but it should at least be a dwp file.  */
+	      if (dwp_dwarf != NULL
+		  && (dwp_dwarf->sectiondata[IDX_debug_cu_index] != NULL
+		      || dwp_dwarf->sectiondata[IDX_debug_tu_index] != NULL))
+		{
+		  cu->dbg->dwp_dwarf = dwp_dwarf;
+		  cu->dbg->dwp_fd = dwp_fd;
+		}
+	      else
+		close (dwp_fd);
+	    }
+	}
+      if (cu->dbg->dwp_dwarf == NULL)
+	cu->dbg->dwp_dwarf = (Dwarf *) -1;
+    }
+
+  if (cu->dbg->dwp_dwarf != (Dwarf *) -1)
+    {
+      Dwarf_CU *split = __libdw_dwp_findcu_id (cu->dbg->dwp_dwarf,
+					       cu->unit_id8);
+      if (split != NULL)
+	{
+	  if (tsearch (split->dbg, &cu->dbg->split_tree,
+		       __libdw_finddbg_cb) == NULL)
+	    {
+	      /* Something went wrong.  Don't link.  */
+	      __libdw_seterrno (DWARF_E_NOMEM);
+	      return;
+	    }
+
+	  /* Link skeleton and split compile units.  */
+	  __libdw_link_skel_split (cu, split);
+	}
+    }
+}
+
 Dwarf_CU *
 internal_function
 __libdw_find_split_unit (Dwarf_CU *cu)
@@ -98,14 +159,18 @@ __libdw_find_split_unit (Dwarf_CU *cu)
      same id as the skeleton.  */
   if (cu->unit_type == DW_UT_skeleton)
     {
+      /* First, try the dwp file.  */
+      try_dwp_file (cu);
+
       Dwarf_Die cudie = CUDIE (cu);
       Dwarf_Attribute dwo_name;
-      /* It is fine if dwo_dir doesn't exists, but then dwo_name needs
-	 to be an absolute path.  */
-      if (dwarf_attr (&cudie, DW_AT_dwo_name, &dwo_name) != NULL
-	  || dwarf_attr (&cudie, DW_AT_GNU_dwo_name, &dwo_name) != NULL)
+      /* Try a dwo file.  It is fine if dwo_dir doesn't exist, but then
+	 dwo_name needs to be an absolute path.  */
+      if (cu->split == (Dwarf_CU *) -1
+	  && (dwarf_attr (&cudie, DW_AT_dwo_name, &dwo_name) != NULL
+	      || dwarf_attr (&cudie, DW_AT_GNU_dwo_name, &dwo_name) != NULL))
 	{
-	  /* First try the dwo file name in the same directory
+	  /* Try the dwo file name in the same directory
 	     as we found the skeleton file.  */
 	  const char *dwo_file = dwarf_formstring (&dwo_name);
 	  const char *debugdir = cu->dbg->debugdir;
diff --git a/libdw/libdw_findcu.c b/libdw/libdw_findcu.c
index ed744231..6c7dcfb5 100644
--- a/libdw/libdw_findcu.c
+++ b/libdw/libdw_findcu.c
@@ -143,6 +143,13 @@ __libdw_intern_next_unit (Dwarf *dbg, bool debug_types)
   if (unlikely (*offsetp > data->d_size))
     *offsetp = data->d_size;
 
+  uint32_t dwp_row;
+  Dwarf_Off dwp_abbrev_offset;
+  if (__libdw_dwp_find_unit (dbg, debug_types, oldoff, version, unit_type,
+			     unit_id8, &dwp_row, &dwp_abbrev_offset) != 0)
+    return NULL;
+  abbrev_offset += dwp_abbrev_offset;
+
   /* Create an entry for this CU.  */
   struct Dwarf_CU *newp = libdw_typed_alloc (dbg, struct Dwarf_CU);
 
@@ -150,6 +157,7 @@ __libdw_intern_next_unit (Dwarf *dbg, bool debug_types)
   newp->sec_idx = sec_idx;
   newp->start = oldoff;
   newp->end = *offsetp;
+  newp->dwp_row = dwp_row;
   newp->address_size = address_size;
   newp->offset_size = offset_size;
   newp->version = version;
diff --git a/libdwfl/core-file.c b/libdwfl/core-file.c
index 87c940cb..89527d23 100644
--- a/libdwfl/core-file.c
+++ b/libdwfl/core-file.c
@@ -595,7 +595,7 @@ dwfl_core_file_report (Dwfl *dwfl, Elf *elf, const char *executable)
       if (! __libdwfl_dynamic_vaddr_get (module->elf, &file_dynamic_vaddr))
 	continue;
       Dwfl_Module *mod;
-      mod = __libdwfl_report_elf (dwfl, basename (module->name), module->name,
+      mod = __libdwfl_report_elf (dwfl, xbasename (module->name), module->name,
 				  module->fd, module->elf,
 				  module->l_ld - file_dynamic_vaddr,
 				  true, true);
diff --git a/libdwfl/cu.c b/libdwfl/cu.c
index b1afb19a..06684357 100644
--- a/libdwfl/cu.c
+++ b/libdwfl/cu.c
@@ -39,7 +39,7 @@
 static inline Dwarf_Arange *
 dwar (Dwfl_Module *mod, unsigned int idx)
 {
-  return &mod->dw->aranges->info[mod->aranges[idx].arange];
+  return &mod->dw->dieranges->info[mod->aranges[idx].arange];
 }
 
 
@@ -51,7 +51,7 @@ addrarange (Dwfl_Module *mod, Dwarf_Addr addr, struct dwfl_arange **arange)
       struct dwfl_arange *aranges = NULL;
       Dwarf_Aranges *dwaranges = NULL;
       size_t naranges;
-      if (INTUSE(dwarf_getaranges) (mod->dw, &dwaranges, &naranges) != 0)
+      if (__libdw_getdieranges (mod->dw, &dwaranges, &naranges) != 0)
 	return DWFL_E_LIBDW;
 
       /* If the module has no aranges (when no code is included) we
@@ -119,7 +119,7 @@ addrarange (Dwfl_Module *mod, Dwarf_Addr addr, struct dwfl_arange **arange)
 	    {
 	      /* It might be in the last range.  */
 	      const Dwarf_Arange *last
-		= &mod->dw->aranges->info[mod->dw->aranges->naranges - 1];
+		= &mod->dw->dieranges->info[mod->dw->dieranges->naranges - 1];
 	      if (addr > last->addr + last->length)
 		break;
 	    }
@@ -296,7 +296,7 @@ arangecu (Dwfl_Module *mod, struct dwfl_arange *arange, struct dwfl_cu **cu)
 {
   if (arange->cu == NULL)
     {
-      const Dwarf_Arange *dwarange = &mod->dw->aranges->info[arange->arange];
+      const Dwarf_Arange *dwarange = &mod->dw->dieranges->info[arange->arange];
       Dwfl_Error result = intern_cu (mod, dwarange->offset, &arange->cu);
       if (result != DWFL_E_NOERROR)
 	return result;
diff --git a/libdwfl/dwfl_module_getsrc_file.c b/libdwfl/dwfl_module_getsrc_file.c
index 513af6b8..fc144225 100644
--- a/libdwfl/dwfl_module_getsrc_file.c
+++ b/libdwfl/dwfl_module_getsrc_file.c
@@ -103,7 +103,7 @@ dwfl_module_getsrc_file (Dwfl_Module *mod,
 		{
 		  /* Match the name with the name the user provided.  */
 		  lastfile = file;
-		  lastmatch = !strcmp (is_basename ? basename (file) : file,
+		  lastmatch = !strcmp (is_basename ? xbasename (file) : file,
 				       fname);
 		}
 	    }
diff --git a/libdwfl/dwfl_segment_report_module.c b/libdwfl/dwfl_segment_report_module.c
index 3ef62a7d..dc34e0ae 100644
--- a/libdwfl/dwfl_segment_report_module.c
+++ b/libdwfl/dwfl_segment_report_module.c
@@ -718,7 +718,7 @@ dwfl_segment_report_module (Dwfl *dwfl, int ndx, const char *name,
 	      bias += fixup;
 	      if (module->name[0] != '\0')
 		{
-		  name = basename (module->name);
+		  name = xbasename (module->name);
 		  name_is_final = true;
 		}
 	      break;
@@ -737,17 +737,34 @@ dwfl_segment_report_module (Dwfl *dwfl, int ndx, const char *name,
 	        && invalid_elf (module->elf, module->disk_file_has_build_id,
 				&build_id))
 	      {
-		elf_end (module->elf);
-		close (module->fd);
-		module->elf = NULL;
-		module->fd = -1;
+		/* If MODULE's build-id doesn't match the disk file's
+		   build-id, close ELF only if MODULE and ELF refer to
+		   different builds of files with the same name.  This
+		   prevents premature closure of the correct ELF in cases
+		   where segments of a module are non-contiguous in memory.  */
+		if (name != NULL && module->name[0] != '\0'
+		    && strcmp (xbasename (module->name), xbasename (name)) == 0)
+		  {
+		    elf_end (module->elf);
+		    close (module->fd);
+		    module->elf = NULL;
+		    module->fd = -1;
+		  }
 	      }
-	    if (module->elf != NULL)
+	    else if (module->elf != NULL)
 	      {
-		/* Ignore this found module if it would conflict in address
-		   space with any already existing module of DWFL.  */
+		/* This module has already been reported.  */
 		skip_this_module = true;
 	      }
+	    else
+	      {
+		/* Only report this module if we haven't already done so.  */
+		for (Dwfl_Module *mod = dwfl->modulelist; mod != NULL;
+		     mod = mod->next)
+		  if (mod->low_addr == module_start
+		      && mod->high_addr == module_end)
+		    skip_this_module = true;
+	      }
 	  }
       if (skip_this_module)
 	goto out;
@@ -781,10 +798,6 @@ dwfl_segment_report_module (Dwfl *dwfl, int ndx, const char *name,
 	}
     }
 
-  /* Our return value now says to skip the segments contained
-     within the module.  */
-  ndx = addr_segndx (dwfl, segment, module_end, true);
-
   /* Examine its .dynamic section to get more interesting details.
      If it has DT_SONAME, we'll use that as the module name.
      If it has a DT_DEBUG, then it's actually a PIE rather than a DSO.
@@ -929,6 +942,8 @@ dwfl_segment_report_module (Dwfl *dwfl, int ndx, const char *name,
       ndx = -1;
       goto out;
     }
+  else
+    ndx++;
 
   /* We have reported the module.  Now let the caller decide whether we
      should read the whole thing in right now.  */
diff --git a/libdwfl/find-debuginfo.c b/libdwfl/find-debuginfo.c
index 7f7ab632..b358c774 100644
--- a/libdwfl/find-debuginfo.c
+++ b/libdwfl/find-debuginfo.c
@@ -164,7 +164,7 @@ find_debuginfo_in_path (Dwfl_Module *mod, const char *file_name,
 {
   bool cancheck = debuglink_crc != (GElf_Word) 0;
 
-  const char *file_basename = file_name == NULL ? NULL : basename (file_name);
+  const char *file_basename = file_name == NULL ? NULL : xbasename (file_name);
   char *localname = NULL;
 
   /* We invent a debuglink .debug name if NULL, but then want to try the
@@ -278,7 +278,7 @@ find_debuginfo_in_path (Dwfl_Module *mod, const char *file_name,
 	  else
 	    {
 	      subdir = NULL;
-	      file = basename (debuglink_file);
+	      file = xbasename (debuglink_file);
 	    }
 	  try_file_basename = debuglink_null;
 	  break;
@@ -306,7 +306,7 @@ find_debuginfo_in_path (Dwfl_Module *mod, const char *file_name,
 	    if (mod->dw != NULL && (p[0] == '\0' || p[0] == '/'))
 	      {
 		fd = try_open (&main_stat, dir, ".dwz",
-			       basename (file), &fname);
+			       xbasename (file), &fname);
 		if (fd < 0)
 		  {
 		    if (errno != ENOENT && errno != ENOTDIR)
diff --git a/libdwfl/image-header.c b/libdwfl/image-header.c
index c777cc84..03cd7a76 100644
--- a/libdwfl/image-header.c
+++ b/libdwfl/image-header.c
@@ -1,6 +1,6 @@
 /* Linux kernel image support for libdwfl.
    Copyright (C) 2009-2011 Red Hat, Inc.
-   Copyright (C) 2022 Mark J. Wielaard <mark@klomp.org>
+   Copyright (C) 2022, 2024 Mark J. Wielaard <mark@klomp.org>
    This file is part of elfutils.
 
    This file is free software; you can redistribute it and/or modify
@@ -64,17 +64,17 @@ __libdw_image_header (int fd, off_t *start_offset,
   if (likely (mapped_size > H_END))
     {
       const void *header = mapped;
-      char header_buffer[H_READ_SIZE];
+      char header_buffer[H_READ_SIZE + H_START];
       if (header == NULL)
 	{
-	  ssize_t n = pread_retry (fd, header_buffer, H_READ_SIZE,
+	  ssize_t n = pread_retry (fd, header_buffer + H_START, H_READ_SIZE,
 				   *start_offset + H_START);
 	  if (n < 0)
 	    return DWFL_E_ERRNO;
 	  if (n < H_READ_SIZE)
 	    return DWFL_E_BADELF;
 
-	  header = header_buffer - H_START;
+	  header = header_buffer;
 	}
 
       uint16_t magic1;
diff --git a/libdwfl/link_map.c b/libdwfl/link_map.c
index 76f23354..a6c66c78 100644
--- a/libdwfl/link_map.c
+++ b/libdwfl/link_map.c
@@ -475,7 +475,7 @@ report_r_debug (uint_fast8_t elfclass, uint_fast8_t elfdata,
 		      if (r_debug_info_module == NULL)
 			{
 			  // XXX hook for sysroot
-			  mod = __libdwfl_report_elf (dwfl, basename (name),
+			  mod = __libdwfl_report_elf (dwfl, xbasename (name),
 						      name, fd, elf, base,
 						      true, true);
 			  if (mod != NULL)
diff --git a/libdwfl/linux-kernel-modules.c b/libdwfl/linux-kernel-modules.c
index 58c0c417..e9faba26 100644
--- a/libdwfl/linux-kernel-modules.c
+++ b/libdwfl/linux-kernel-modules.c
@@ -116,7 +116,7 @@ try_kernel_name (Dwfl *dwfl, char **fname, bool try_debug)
 	/* Try the file's unadorned basename as DEBUGLINK_FILE,
 	   to look only for "vmlinux" files.  */
 	fd = INTUSE(dwfl_standard_find_debuginfo) (&fakemod, NULL, NULL, 0,
-						   *fname, basename (*fname),
+						   *fname, xbasename (*fname),
 						   0, &fakemod.debug.name);
 
       if (fakemod.debug.name != NULL)
diff --git a/libdwfl/offline.c b/libdwfl/offline.c
index e9ab0cc1..24e9e180 100644
--- a/libdwfl/offline.c
+++ b/libdwfl/offline.c
@@ -32,6 +32,7 @@
 # include <config.h>
 #endif
 
+#include "libelfP.h"
 #include "libdwflP.h"
 #include <fcntl.h>
 
@@ -254,7 +255,7 @@ process_archive (Dwfl *dwfl, const char *name, const char *file_name, int fd,
 {
   Dwfl_Module *mod = NULL;
   /* elf_begin supports opening archives even with fd == -1 passed.  */
-  Elf *member = elf_begin (fd, ELF_C_READ_MMAP_PRIVATE, archive);
+  Elf *member = elf_begin (fd, archive->cmd, archive);
   if (unlikely (member == NULL)) /* Empty archive.  */
     {
       __libdwfl_seterrno (DWFL_E_BADELF);
@@ -263,7 +264,7 @@ process_archive (Dwfl *dwfl, const char *name, const char *file_name, int fd,
 
   while (process_archive_member (dwfl, name, file_name, predicate,
 				 fd, member, &mod) != ELF_C_NULL)
-    member = elf_begin (fd, ELF_C_READ_MMAP_PRIVATE, archive);
+    member = elf_begin (fd, archive->cmd, archive);
 
   /* We can drop the archive Elf handle even if we're still using members
      in live modules.  When the last module's elf_end on a member returns
diff --git a/libdwfl/open.c b/libdwfl/open.c
index d0f357ed..43b29fa9 100644
--- a/libdwfl/open.c
+++ b/libdwfl/open.c
@@ -151,7 +151,7 @@ libdw_open_elf (int *fdp, Elf **elfp, bool close_on_fail, bool archive_ok,
 	  elf->state.ar.elf_ar_hdr.ar_name = "libdwfl is faking you out";
 	  elf->state.ar.elf_ar_hdr.ar_size = elf->maximum_size - offset;
 	  elf->state.ar.offset = offset - sizeof (struct ar_hdr);
-	  Elf *subelf = elf_begin (-1, ELF_C_READ_MMAP_PRIVATE, elf);
+	  Elf *subelf = elf_begin (-1, elf->cmd, elf);
 	  elf->kind = ELF_K_NONE;
 	  if (unlikely (subelf == NULL))
 	    error = DWFL_E_LIBELF;
@@ -215,8 +215,6 @@ __libdw_open_elf_memory (char *data, size_t size, Elf **elfp, bool archive_ok)
     {
       return DWFL_E_LIBELF;
     }
-  /* Allow using this ELF as reference for subsequent elf_begin calls.  */
-  (*elfp)->cmd = ELF_C_READ_MMAP_PRIVATE;
   return libdw_open_elf (&fd, elfp, false, archive_ok, true, false, true);
 }
 
diff --git a/libebl/eblobjnote.c b/libebl/eblobjnote.c
index 5a7c5c62..1ba5d8b3 100644
--- a/libebl/eblobjnote.c
+++ b/libebl/eblobjnote.c
@@ -155,8 +155,8 @@ ebl_object_note (Ebl *ebl, uint32_t namesz, const char *name, uint32_t type,
 	      } addrs;
 
 	      size_t addr_size = gelf_fsize (ebl->elf, ELF_T_ADDR,
-					     2, EV_CURRENT);
-	      if (descsz != addr_size)
+					     1, EV_CURRENT);
+	      if (descsz != addr_size * 2)
 		printf ("<unknown data>\n");
 	      else
 		{
diff --git a/libelf/elf.h b/libelf/elf.h
index 7b4a8fe4..f2206e5c 100644
--- a/libelf/elf.h
+++ b/libelf/elf.h
@@ -1,5 +1,5 @@
 /* This file defines standard ELF types, structures, and macros.
-   Copyright (C) 1995-2023 Free Software Foundation, Inc.
+   Copyright (C) 1995-2024 Free Software Foundation, Inc.
    This file is part of the GNU C Library.
 
    The GNU C Library is free software; you can redistribute it and/or
@@ -791,9 +791,12 @@ typedef struct
 					   Register */
 #define NT_PPC_PKEY	0x110		/* Memory Protection Keys
 					   registers.  */
+#define NT_PPC_DEXCR	0x111		/* PowerPC DEXCR registers.  */
+#define NT_PPC_HASHKEYR	0x112		/* PowerPC HASHKEYR register.  */
 #define NT_386_TLS	0x200		/* i386 TLS slots (struct user_desc) */
 #define NT_386_IOPERM	0x201		/* x86 io permission bitmap (1=deny) */
 #define NT_X86_XSTATE	0x202		/* x86 extended state using xsave */
+#define NT_X86_SHSTK	0x204		/* x86 SHSTK state */
 #define NT_S390_HIGH_GPRS	0x300	/* s390 upper register halves */
 #define NT_S390_TIMER	0x301		/* s390 timer register */
 #define NT_S390_TODCMP	0x302		/* s390 TOD clock comparator register */
@@ -832,6 +835,8 @@ typedef struct
 #define NT_MIPS_DSP	0x800		/* MIPS DSP ASE registers.  */
 #define NT_MIPS_FP_MODE	0x801		/* MIPS floating-point mode.  */
 #define NT_MIPS_MSA	0x802		/* MIPS SIMD registers.  */
+#define NT_RISCV_CSR	0x900		/* RISC-V Control and Status Registers */
+#define NT_RISCV_VECTOR	0x901		/* RISC-V vector registers */
 #define NT_LOONGARCH_CPUCFG	0xa00	/* LoongArch CPU config registers.  */
 #define NT_LOONGARCH_CSR	0xa01	/* LoongArch control and
 					   status registers.  */
@@ -841,6 +846,8 @@ typedef struct
 					   SIMD Extension registers.  */
 #define NT_LOONGARCH_LBT	0xa04	/* LoongArch Loongson Binary
 					   Translation registers.  */
+#define NT_LOONGARCH_HW_BREAK	0xa05   /* LoongArch hardware breakpoint registers */
+#define NT_LOONGARCH_HW_WATCH	0xa06   /* LoongArch hardware watchpoint registers */
 
 /* Legal values for the note segment descriptor types for object files.  */
 
@@ -3632,6 +3639,11 @@ enum
 /* x86-64 sh_type values.  */
 #define SHT_X86_64_UNWIND	0x70000001 /* Unwind information.  */
 
+/* x86-64 d_tag values.  */
+#define DT_X86_64_PLT		(DT_LOPROC + 0)
+#define DT_X86_64_PLTSZ		(DT_LOPROC + 1)
+#define DT_X86_64_PLTENT	(DT_LOPROC + 3)
+#define DT_X86_64_NUM		4
 
 /* AM33 relocations.  */
 #define R_MN10300_NONE		0	/* No reloc.  */
@@ -4319,6 +4331,23 @@ enum
 #define R_LARCH_ADD_ULEB128 107
 #define R_LARCH_SUB_ULEB128 108
 #define R_LARCH_64_PCREL 109
+#define R_LARCH_CALL36 110
+#define R_LARCH_TLS_DESC_PC_HI20 111
+#define R_LARCH_TLS_DESC_PC_LO12 112
+#define R_LARCH_TLS_DESC64_PC_LO20 113
+#define R_LARCH_TLS_DESC64_PC_HI12 114
+#define R_LARCH_TLS_DESC_HI20 115
+#define R_LARCH_TLS_DESC_LO12 116
+#define R_LARCH_TLS_DESC64_LO20 117
+#define R_LARCH_TLS_DESC64_HI12 118
+#define R_LARCH_TLS_DESC_LD 119
+#define R_LARCH_TLS_DESC_CALL 120
+#define R_LARCH_TLS_LE_HI20_R 121
+#define R_LARCH_TLS_LE_ADD_R 122
+#define R_LARCH_TLS_LE_LO12_R 123
+#define R_LARCH_TLS_LD_PCREL20_S2 124
+#define R_LARCH_TLS_GD_PCREL20_S2 125
+#define R_LARCH_TLS_DESC_PCREL20_S2 126
 
 /* ARC specific declarations.  */
 
diff --git a/libelf/elf_begin.c b/libelf/elf_begin.c
index fe8c640a..8a49f351 100644
--- a/libelf/elf_begin.c
+++ b/libelf/elf_begin.c
@@ -38,6 +38,7 @@
 #include <fcntl.h>
 #include <stdbool.h>
 #include <stddef.h>
+#include <stdint.h>
 #include <string.h>
 #include <sys/stat.h>
 
@@ -341,15 +342,15 @@ file_read_elf (int fildes, void *map_address, unsigned char *e_ident,
     {
       /* This pointer might not be directly usable if the alignment is
 	 not sufficient for the architecture.  */
-      Elf32_Ehdr *ehdr = (Elf32_Ehdr *) ((char *) map_address + offset);
+      uintptr_t ehdr = (uintptr_t) map_address + offset;
 
       /* This is a 32-bit binary.  */
       if (map_address != NULL && e_ident[EI_DATA] == MY_ELFDATA
 	  && (ALLOW_UNALIGNED
-	      || (((uintptr_t) ehdr) & (__alignof__ (Elf32_Ehdr) - 1)) == 0))
+	      || (ehdr & (__alignof__ (Elf32_Ehdr) - 1)) == 0))
 	{
 	  /* We can use the mmapped memory.  */
-	  elf->state.elf32.ehdr = ehdr;
+	  elf->state.elf32.ehdr = (Elf32_Ehdr *) ehdr;
 	}
       else
 	{
@@ -382,8 +383,7 @@ file_read_elf (int fildes, void *map_address, unsigned char *e_ident,
       if (map_address != NULL && e_ident[EI_DATA] == MY_ELFDATA
 	  && cmd != ELF_C_READ_MMAP /* We need a copy to be able to write.  */
 	  && (ALLOW_UNALIGNED
-	      || ((((uintptr_t) ehdr + e_shoff)
-		   & (__alignof__ (Elf32_Shdr) - 1)) == 0)))
+	      || (((ehdr + e_shoff) & (__alignof__ (Elf32_Shdr) - 1)) == 0)))
 	{
 	  if (unlikely (scncnt > 0 && e_shoff >= maxsize)
 	      || unlikely (maxsize - e_shoff
@@ -396,8 +396,7 @@ file_read_elf (int fildes, void *map_address, unsigned char *e_ident,
 	    }
 
 	  if (scncnt > 0)
-	    elf->state.elf32.shdr
-	      = (Elf32_Shdr *) ((char *) ehdr + e_shoff);
+	    elf->state.elf32.shdr = (Elf32_Shdr *) (ehdr + e_shoff);
 
 	  for (size_t cnt = 0; cnt < scncnt; ++cnt)
 	    {
@@ -445,15 +444,15 @@ file_read_elf (int fildes, void *map_address, unsigned char *e_ident,
     {
       /* This pointer might not be directly usable if the alignment is
 	 not sufficient for the architecture.  */
-      Elf64_Ehdr *ehdr = (Elf64_Ehdr *) ((char *) map_address + offset);
+      uintptr_t ehdr = (uintptr_t) map_address + offset;
 
       /* This is a 64-bit binary.  */
       if (map_address != NULL && e_ident[EI_DATA] == MY_ELFDATA
 	  && (ALLOW_UNALIGNED
-	      || (((uintptr_t) ehdr) & (__alignof__ (Elf64_Ehdr) - 1)) == 0))
+	      || (ehdr & (__alignof__ (Elf64_Ehdr) - 1)) == 0))
 	{
 	  /* We can use the mmapped memory.  */
-	  elf->state.elf64.ehdr = ehdr;
+	  elf->state.elf64.ehdr = (Elf64_Ehdr *) ehdr;
 	}
       else
 	{
@@ -486,8 +485,7 @@ file_read_elf (int fildes, void *map_address, unsigned char *e_ident,
       if (map_address != NULL && e_ident[EI_DATA] == MY_ELFDATA
 	  && cmd != ELF_C_READ_MMAP /* We need a copy to be able to write.  */
 	  && (ALLOW_UNALIGNED
-	      || ((((uintptr_t) ehdr + e_shoff)
-		   & (__alignof__ (Elf64_Shdr) - 1)) == 0)))
+	      || (((ehdr + e_shoff) & (__alignof__ (Elf64_Shdr) - 1)) == 0)))
 	{
 	  if (unlikely (scncnt > 0 && e_shoff >= maxsize)
 	      || unlikely (maxsize - e_shoff
@@ -495,8 +493,7 @@ file_read_elf (int fildes, void *map_address, unsigned char *e_ident,
 	    goto free_and_out;
 
 	  if (scncnt > 0)
-	    elf->state.elf64.shdr
-	      = (Elf64_Shdr *) ((char *) ehdr + e_shoff);
+	    elf->state.elf64.shdr = (Elf64_Shdr *) (ehdr + (ptrdiff_t) e_shoff);
 
 	  for (size_t cnt = 0; cnt < scncnt; ++cnt)
 	    {
diff --git a/libelf/elf_getdata_rawchunk.c b/libelf/elf_getdata_rawchunk.c
index 05ff329c..1751878d 100644
--- a/libelf/elf_getdata_rawchunk.c
+++ b/libelf/elf_getdata_rawchunk.c
@@ -175,6 +175,8 @@ elf_getdata_rawchunk (Elf *elf, int64_t offset, size_t size, Elf_Type type)
 
 	  /* The copy will be appropriately aligned for direct access.  */
 	  memcpy (buffer, rawchunk, size);
+
+	  free (rawchunk);
 	}
     }
   else
@@ -191,6 +193,9 @@ elf_getdata_rawchunk (Elf *elf, int64_t offset, size_t size, Elf_Type type)
 
       /* Call the conversion function.  */
       (*__elf_xfctstom[elf->class - 1][type])(buffer, rawchunk, size, 0);
+
+      if (!flags)
+	free (rawchunk);
     }
 
   /* Allocate the dummy container to point at this buffer.  */
diff --git a/libelf/elf_memory.c b/libelf/elf_memory.c
index a47f1d24..13d77cb7 100644
--- a/libelf/elf_memory.c
+++ b/libelf/elf_memory.c
@@ -46,5 +46,5 @@ elf_memory (char *image, size_t size)
       return NULL;
     }
 
-  return __libelf_read_mmaped_file (-1, image, 0, size, ELF_C_READ, NULL);
+  return __libelf_read_mmaped_file (-1, image, 0, size, ELF_C_READ_MMAP, NULL);
 }
diff --git a/patches/0001-libdwfl-Make-dwfl_report_offline_memory-work-with-EL.patch b/patches/0001-libdwfl-Make-dwfl_report_offline_memory-work-with-EL.patch
new file mode 100644
index 00000000..07119d7b
--- /dev/null
+++ b/patches/0001-libdwfl-Make-dwfl_report_offline_memory-work-with-EL.patch
@@ -0,0 +1,200 @@
+From 94cb85c3cbc59811de11869d1c1ce4f9bdb7f67c Mon Sep 17 00:00:00 2001
+From: Aleksei Vetrov <vvvvvv@google.com>
+Date: Thu, 11 Jul 2024 19:29:32 +0000
+Subject: [PATCH] libdwfl: Make dwfl_report_offline_memory work with
+ ELF_C_READ_MMAP
+To: elfutils-devel@sourceware.org
+Cc: kernel-team@android.com,
+    maennich@google.com,
+    vvvvvv@google.com
+
+elf_memory open mode recently changed from ELF_C_READ to
+ELF_C_READ_MMAP. This broken dwfl_report_offline_memory that changes
+mode to ELF_C_READ_MMAP_PRIVATE to be compatible with subsequent
+elf_begin on embedded ELF files.
+
+The proper implementation of dwfl_report_offline_memory doesn't change
+open mode and subsequent elf_begin invocations simply use cmd from the
+reference Elf*.
+
+Add tests to exercise Elf* to trigger the bug caused by incorrect cmd
+set to Elf*.
+
+	  * libdwfl/offline.c (process_archive): Use archive->cmd
+	  instead of hardcoded ELF_C_READ_MMAP_PRIVATE.
+	  * libdwfl/open.c (libdw_open_elf): Use elf->cmd instead of
+	  hardcoded ELF_C_READ_MMAP_PRIVATE.
+	  (__libdw_open_elf_memory): Don't override (*elfp)->cmd.
+	  * tests/Makefile.am (dwfl_report_offline_memory): Add libelf
+	  as dependency.
+	  * tests/dwfl-report-offline-memory.c: Add count_sections to
+	  exercise Elf* from dwfl_report_offline_memory.
+	  * tests/run-dwfl-report-offline-memory.sh: Add expected number
+	  of sections to test invocations.
+
+Signed-off-by: Aleksei Vetrov <vvvvvv@google.com>
+---
+ libdwfl/offline.c                       |  5 ++--
+ libdwfl/open.c                          |  4 +---
+ tests/Makefile.am                       |  2 +-
+ tests/dwfl-report-offline-memory.c      | 32 ++++++++++++++++++++++---
+ tests/run-dwfl-report-offline-memory.sh |  6 ++---
+ 5 files changed, 37 insertions(+), 12 deletions(-)
+
+diff --git a/libdwfl/offline.c b/libdwfl/offline.c
+index e9ab0cc1..24e9e180 100644
+--- a/libdwfl/offline.c
++++ b/libdwfl/offline.c
+@@ -32,6 +32,7 @@
+ # include <config.h>
+ #endif
+ 
++#include "libelfP.h"
+ #include "libdwflP.h"
+ #include <fcntl.h>
+ 
+@@ -254,7 +255,7 @@ process_archive (Dwfl *dwfl, const char *name, const char *file_name, int fd,
+ {
+   Dwfl_Module *mod = NULL;
+   /* elf_begin supports opening archives even with fd == -1 passed.  */
+-  Elf *member = elf_begin (fd, ELF_C_READ_MMAP_PRIVATE, archive);
++  Elf *member = elf_begin (fd, archive->cmd, archive);
+   if (unlikely (member == NULL)) /* Empty archive.  */
+     {
+       __libdwfl_seterrno (DWFL_E_BADELF);
+@@ -263,7 +264,7 @@ process_archive (Dwfl *dwfl, const char *name, const char *file_name, int fd,
+ 
+   while (process_archive_member (dwfl, name, file_name, predicate,
+ 				 fd, member, &mod) != ELF_C_NULL)
+-    member = elf_begin (fd, ELF_C_READ_MMAP_PRIVATE, archive);
++    member = elf_begin (fd, archive->cmd, archive);
+ 
+   /* We can drop the archive Elf handle even if we're still using members
+      in live modules.  When the last module's elf_end on a member returns
+diff --git a/libdwfl/open.c b/libdwfl/open.c
+index d0f357ed..43b29fa9 100644
+--- a/libdwfl/open.c
++++ b/libdwfl/open.c
+@@ -151,7 +151,7 @@ libdw_open_elf (int *fdp, Elf **elfp, bool close_on_fail, bool archive_ok,
+ 	  elf->state.ar.elf_ar_hdr.ar_name = "libdwfl is faking you out";
+ 	  elf->state.ar.elf_ar_hdr.ar_size = elf->maximum_size - offset;
+ 	  elf->state.ar.offset = offset - sizeof (struct ar_hdr);
+-	  Elf *subelf = elf_begin (-1, ELF_C_READ_MMAP_PRIVATE, elf);
++	  Elf *subelf = elf_begin (-1, elf->cmd, elf);
+ 	  elf->kind = ELF_K_NONE;
+ 	  if (unlikely (subelf == NULL))
+ 	    error = DWFL_E_LIBELF;
+@@ -215,8 +215,6 @@ __libdw_open_elf_memory (char *data, size_t size, Elf **elfp, bool archive_ok)
+     {
+       return DWFL_E_LIBELF;
+     }
+-  /* Allow using this ELF as reference for subsequent elf_begin calls.  */
+-  (*elfp)->cmd = ELF_C_READ_MMAP_PRIVATE;
+   return libdw_open_elf (&fd, elfp, false, archive_ok, true, false, true);
+ }
+ 
+diff --git a/tests/Makefile.am b/tests/Makefile.am
+index 77f9b90d..cfed54b7 100644
+--- a/tests/Makefile.am
++++ b/tests/Makefile.am
+@@ -792,7 +792,7 @@ test_elf_cntl_gelf_getshdr_LDADD = $(libelf)
+ dwflsyms_LDADD = $(libdw) $(libelf) $(argp_LDADD)
+ dwfllines_LDADD = $(libeu) $(libdw) $(libelf) $(argp_LDADD)
+ dwfl_report_elf_align_LDADD = $(libeu) $(libdw)
+-dwfl_report_offline_memory_LDADD = $(libeu) $(libdw)
++dwfl_report_offline_memory_LDADD = $(libeu) $(libdw) $(libelf)
+ dwfl_report_segment_contiguous_LDADD = $(libdw) $(libebl) $(libelf)
+ varlocs_LDADD = $(libeu) $(libdw) $(libelf) $(argp_LDADD)
+ backtrace_LDADD = $(libeu) $(libdw) $(libelf) $(argp_LDADD)
+diff --git a/tests/dwfl-report-offline-memory.c b/tests/dwfl-report-offline-memory.c
+index b3b4d9bd..3ecb66b9 100644
+--- a/tests/dwfl-report-offline-memory.c
++++ b/tests/dwfl-report-offline-memory.c
+@@ -18,14 +18,19 @@
+ #include <config.h>
+ 
+ #include <assert.h>
++#include <errno.h>
++#include <error.h>
+ #include <fcntl.h>
+ #include <locale.h>
+ #include <stdio.h>
+ #include <stdio_ext.h>
+ #include <stdlib.h>
++#include <string.h>
+ #include <unistd.h>
++
+ #include ELFUTILS_HEADER(dwfl)
+-#include "system.h"
++#include ELFUTILS_HEADER(elf)
++#include <gelf.h>
+ 
+ 
+ static const Dwfl_Callbacks offline_callbacks =
+@@ -45,6 +50,20 @@ count_modules (Dwfl_Module *mod __attribute__ ((unused)),
+   return DWARF_CB_OK;
+ }
+ 
++static int
++count_sections (Elf *elf)
++{
++  int result = 0;
++  Elf_Scn *section = NULL;
++  GElf_Shdr header;
++  while ((section = elf_nextscn (elf, section)) != NULL)
++    {
++      assert (gelf_getshdr (section, &header) != NULL);
++      result += 1;
++    }
++  return result;
++}
++
+ int
+ main (int argc, char **argv)
+ {
+@@ -54,10 +73,11 @@ main (int argc, char **argv)
+   /* Set locale.  */
+   (void) setlocale (LC_ALL, "");
+ 
+-  if (argc != 3)
++  if (argc != 4)
+     error (-1, 0,
+ 	   "usage: dwfl_report_offline_memory [filename] "
+-	   "[expected number of modules]");
++	   "[expected number of modules] "
++	   "[expected number of sections]");
+ 
+   const char *fname = argv[1];
+   int fd = open (fname, O_RDONLY);
+@@ -100,6 +120,12 @@ main (int argc, char **argv)
+   assert (endptr && !*endptr);
+   assert (number_of_modules == expected_number_of_modules);
+ 
++  GElf_Addr loadbase = 0;
++  Elf *elf = dwfl_module_getelf (mod, &loadbase);
++  int number_of_sections = count_sections (elf);
++  int expected_number_of_sections = atoi (argv[3]);
++  assert (number_of_sections == expected_number_of_sections);
++
+   dwfl_end (dwfl);
+   free (data);
+ 
+diff --git a/tests/run-dwfl-report-offline-memory.sh b/tests/run-dwfl-report-offline-memory.sh
+index 85f43f53..84c7f999 100755
+--- a/tests/run-dwfl-report-offline-memory.sh
++++ b/tests/run-dwfl-report-offline-memory.sh
+@@ -26,8 +26,8 @@ testfiles testarchive64.a
+ # bzip2 -zf test-ar-duplicates.a
+ testfiles test-ar-duplicates.a
+ 
+-testrun ${abs_builddir}/dwfl-report-offline-memory ./testfile-dwfl-report-elf-align-shlib.so 1
+-testrun ${abs_builddir}/dwfl-report-offline-memory ./testarchive64.a 3
+-testrun ${abs_builddir}/dwfl-report-offline-memory ./test-ar-duplicates.a 1
++testrun ${abs_builddir}/dwfl-report-offline-memory ./testfile-dwfl-report-elf-align-shlib.so 1 24
++testrun ${abs_builddir}/dwfl-report-offline-memory ./testarchive64.a 3 10
++testrun ${abs_builddir}/dwfl-report-offline-memory ./test-ar-duplicates.a 1 7
+ 
+ exit 0
+-- 
+2.45.2.993.g49e7a77208-goog
+
diff --git a/patches/libdw-check-offset-dwarf_formstring-in-all-cases.patch b/patches/libdw-check-offset-dwarf_formstring-in-all-cases.patch
deleted file mode 100644
index 7e30d2a3..00000000
--- a/patches/libdw-check-offset-dwarf_formstring-in-all-cases.patch
+++ /dev/null
@@ -1,36 +0,0 @@
-From 1bd9deb9aa19ac2e2fa9665009e0d5924adcf4d3 Mon Sep 17 00:00:00 2001
-From: Aleksei Vetrov <vvvvvv@google.com>
-Date: Thu, 16 Nov 2023 21:29:22 +0000
-Subject: [PATCH] libdw: check offset dwarf_formstring in all cases
-
-This check was initially added to test if offset overflows the safe
-prefix where any string will be null-terminated. However the check
-was placed in a wrong place and didn't cover all `attrp->form` cases.
-
-    * libdw/dwarf_formstring.c (dwarf_formstring): Move offset check
-      right before returning the result.
-
-Signed-off-by: Aleksei Vetrov <vvvvvv@google.com>
-
-diff --git a/libdw/dwarf_formstring.c b/libdw/dwarf_formstring.c
-index 0ee42411..65f03a5e 100644
---- a/libdw/dwarf_formstring.c
-+++ b/libdw/dwarf_formstring.c
-@@ -173,11 +173,11 @@ dwarf_formstring (Dwarf_Attribute *attrp)
- 	off = read_4ubyte_unaligned (dbg, datap);
-       else
- 	off = read_8ubyte_unaligned (dbg, datap);
--
--      if (off >= data_size)
--	goto invalid_offset;
-     }
- 
-+  if (off >= data_size)
-+    goto invalid_offset;
-+
-   return (const char *) data->d_buf + off;
- }
- INTDEF(dwarf_formstring)
--- 
-2.43.0.rc1.413.gea7ed67945-goog
-
diff --git a/patches/libdwfl-handle-duplicate-ELFs-when-reporting-archive.patch b/patches/libdwfl-handle-duplicate-ELFs-when-reporting-archive.patch
deleted file mode 100644
index 021ecdcf..00000000
--- a/patches/libdwfl-handle-duplicate-ELFs-when-reporting-archive.patch
+++ /dev/null
@@ -1,56 +0,0 @@
-From 0ab5a3eb4122f36cbaff259e7a0a3f9d014cb6f7 Mon Sep 17 00:00:00 2001
-From: Aleksei Vetrov <vvvvvv@google.com>
-Date: Mon, 20 Nov 2023 17:44:47 +0000
-Subject: [PATCH] libdwfl: handle duplicate ELFs when reporting archives
-
-When archive is processed in process_archive (libdwfl/offline.c), it
-creates an Elf object for each archive member. Then in
-process_archive_member it calls process_file to create a Dwfl_Module
-through __libdwfl_report_elf.
-
-The ownership of the Elf object is expected to be:
-
-* either transfered to the Dwfl_Module, if __libdwfl_report_elf returns
-  not NULL;
-
-* or handled at the end of process_archive_member by calling elf_end.
-
-Moreover, Elf object is expected to be alive, if __libdwfl_report_elf
-returns not NULL, because at the end of process_archive_member it
-advances to the next member through the elf_next call.
-
-The problem happens when __libdwfl_report_elf encounters Elf with the
-same name and content as it seen before. In that case dwfl_report_module
-will reuse existing Dwfl_Module object. This leads to a codepath that
-calls elf_end on the Elf object, while returning not NULL, breaking the
-elf_next call to the next member.
-
-The fix is to destroy m->main.elf instead and put the new Elf object in
-the already existing Dwfl_Module.
-
-    * libdwfl/dwfl_report_elf.c (__libdwfl_report_elf): Replace Elf in
-      the Dwfl_Module in case of duplicate modules to prolong its
-      lifetime for subsequent processing.
-
-Signed-off-by: Aleksei Vetrov <vvvvvv@google.com>
-
-diff --git a/libdwfl/dwfl_report_elf.c b/libdwfl/dwfl_report_elf.c
-index 581f4079..a76d3681 100644
---- a/libdwfl/dwfl_report_elf.c
-+++ b/libdwfl/dwfl_report_elf.c
-@@ -276,10 +276,11 @@ __libdwfl_report_elf (Dwfl *dwfl, const char *name, const char *file_name,
- 	}
-       else
- 	{
--	  elf_end (elf);
- 	  if (m->main_bias != bias
- 	      || m->main.vaddr != vaddr || m->main.address_sync != address_sync)
- 	    goto overlap;
-+	  elf_end (m->main.elf);
-+	  m->main.elf = elf;
- 	}
-     }
-   return m;
--- 
-2.43.0.rc1.413.gea7ed67945-goog
-
diff --git a/patches/libelf-check-decompressed-ZSTD-size.patch b/patches/libelf-check-decompressed-ZSTD-size.patch
deleted file mode 100644
index 6c76fac1..00000000
--- a/patches/libelf-check-decompressed-ZSTD-size.patch
+++ /dev/null
@@ -1,33 +0,0 @@
-From 03c171947cc538b04957ac2222ce86e7c0170bd1 Mon Sep 17 00:00:00 2001
-From: Aleksei Vetrov <vvvvvv@google.com>
-Date: Thu, 23 Nov 2023 15:31:47 +0000
-Subject: [PATCH] libelf: check decompressed ZSTD size
-
-Decompression functions like __libelf_decompress_zlib check that
-decompressed data has the same size as it was declared in the header
-(size_out argument). The same check is now added to
-__libelf_decompress_zstd to make sure that the whole allocated buffer is
-initialized.
-
-    * libelf/elf_compress.c (__libelf_decompress_zstd): Use return value
-      of ZSTD_decompress to check that decompressed data size is the
-      same as size_out of the buffer that was allocated.
-
-Signed-off-by: Aleksei Vetrov <vvvvvv@google.com>
-
-diff --git a/libelf/elf_compress.c b/libelf/elf_compress.c
-index c7283c6a..0ad6a32a 100644
---- a/libelf/elf_compress.c
-+++ b/libelf/elf_compress.c
-@@ -422,7 +422,7 @@ __libelf_decompress_zstd (void *buf_in, size_t size_in, size_t size_out)
-     }
- 
-   size_t ret = ZSTD_decompress (buf_out, size_out, buf_in, size_in);
--  if (ZSTD_isError (ret))
-+  if (unlikely (ZSTD_isError (ret)) || unlikely (ret != size_out))
-     {
-       free (buf_out);
-       __libelf_seterrno (ELF_E_DECOMPRESS_ERROR);
--- 
-2.43.0.rc1.413.gea7ed67945-goog
-
diff --git a/po/de.po b/po/de.po
index 47acd743..d6b3e2c3 100644
--- a/po/de.po
+++ b/po/de.po
@@ -11,7 +11,7 @@ msgid ""
 msgstr ""
 "Project-Id-Version: elfutils\n"
 "Report-Msgid-Bugs-To: https://sourceware.org/bugzilla/\n"
-"POT-Creation-Date: 2023-11-03 17:36+0100\n"
+"POT-Creation-Date: 2024-03-01 10:22-0500\n"
 "PO-Revision-Date: 2009-06-29 15:15+0200\n"
 "Last-Translator: Michael Mnch <micm@fedoraproject.org>\n"
 "Language-Team: German\n"
@@ -49,7 +49,7 @@ msgstr ""
 "GARANTIE,\n"
 "auch nicht fr Marktgngigkeit oder Eignung fr einen Bestimmten Zweck.\n"
 
-#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12202
+#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12203
 #: src/unstrip.c:311
 #, c-format
 msgid "memory exhausted"
@@ -308,7 +308,13 @@ msgstr "unbekannter Typ"
 msgid ".debug_addr section missing"
 msgstr ".debug_line Sektion fehlt"
 
-#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2547
+#: libdw/dwarf_error.c:105
+#, fuzzy
+#| msgid "unknown version"
+msgid "unknown section"
+msgstr "unbekannte Version"
+
+#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2598
 msgid "Input selection options:"
 msgstr "Eingabeauswahloptionen:"
 
@@ -647,7 +653,7 @@ msgstr "ungltige Grsse des Quell-Operanden"
 msgid "invalid size of destination operand"
 msgstr "ungltige Grsse des Ziel-Operanden"
 
-#: libelf/elf_error.c:86 src/readelf.c:6758
+#: libelf/elf_error.c:86 src/readelf.c:6759
 #, c-format
 msgid "invalid encoding"
 msgstr "ungltige Kodierung"
@@ -735,8 +741,8 @@ msgstr "data/scn Unterschied"
 msgid "invalid section header"
 msgstr "ungltiger Abschnitts-Header"
 
-#: libelf/elf_error.c:190 src/readelf.c:10637 src/readelf.c:11242
-#: src/readelf.c:11343 src/readelf.c:11531
+#: libelf/elf_error.c:190 src/readelf.c:10638 src/readelf.c:11243
+#: src/readelf.c:11344 src/readelf.c:11532
 #, c-format
 msgid "invalid data"
 msgstr "Ungltige Daten"
@@ -1629,7 +1635,7 @@ msgstr ""
 
 #: src/elfcmp.c:733 src/findtextrel.c:194 src/nm.c:363 src/ranlib.c:140
 #: src/size.c:271 src/strings.c:184 src/strip.c:1040 src/strip.c:1077
-#: src/unstrip.c:2194 src/unstrip.c:2223
+#: src/unstrip.c:2245 src/unstrip.c:2274
 #, c-format
 msgid "cannot open '%s'"
 msgstr "'%s' kann nicht geffnet werden"
@@ -3741,9 +3747,9 @@ msgstr "Kann Suchbaum nicht erstellen"
 #: src/nm.c:742 src/nm.c:1234 src/objdump.c:778 src/readelf.c:685
 #: src/readelf.c:1506 src/readelf.c:1655 src/readelf.c:1882 src/readelf.c:2123
 #: src/readelf.c:2312 src/readelf.c:2482 src/readelf.c:2604 src/readelf.c:2854
-#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3896
-#: src/readelf.c:3944 src/readelf.c:4013 src/readelf.c:12029
-#: src/readelf.c:13212 src/readelf.c:13422 src/readelf.c:13490 src/size.c:396
+#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3897
+#: src/readelf.c:3945 src/readelf.c:4014 src/readelf.c:12030
+#: src/readelf.c:13213 src/readelf.c:13423 src/readelf.c:13491 src/size.c:396
 #: src/size.c:467 src/strip.c:1093
 #, c-format
 msgid "cannot get section header string table index"
@@ -4086,11 +4092,11 @@ msgstr ""
 msgid "cannot get section: %s"
 msgstr ""
 
-#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13442
-#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:610
-#: src/unstrip.c:631 src/unstrip.c:671 src/unstrip.c:887 src/unstrip.c:1222
-#: src/unstrip.c:1349 src/unstrip.c:1373 src/unstrip.c:1429 src/unstrip.c:1470
-#: src/unstrip.c:1662 src/unstrip.c:1813 src/unstrip.c:1956 src/unstrip.c:2055
+#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13443
+#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:622
+#: src/unstrip.c:640 src/unstrip.c:680 src/unstrip.c:897 src/unstrip.c:1263
+#: src/unstrip.c:1390 src/unstrip.c:1414 src/unstrip.c:1470 src/unstrip.c:1511
+#: src/unstrip.c:1703 src/unstrip.c:1854 src/unstrip.c:1998 src/unstrip.c:2106
 #, c-format
 msgid "cannot get section header: %s"
 msgstr ""
@@ -4100,8 +4106,8 @@ msgstr ""
 msgid "cannot get section name"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/readelf.c:720 src/readelf.c:7176 src/readelf.c:11230 src/readelf.c:11332
-#: src/readelf.c:11516
+#: src/readelf.c:720 src/readelf.c:7177 src/readelf.c:11231 src/readelf.c:11333
+#: src/readelf.c:11517
 #, c-format
 msgid "cannot get %s content: %s"
 msgstr ""
@@ -4428,7 +4434,7 @@ msgid ""
 "  Segment Sections..."
 msgstr ""
 
-#: src/readelf.c:1519 src/unstrip.c:2114 src/unstrip.c:2156 src/unstrip.c:2163
+#: src/readelf.c:1519 src/unstrip.c:2165 src/unstrip.c:2207 src/unstrip.c:2214
 #, c-format
 msgid "cannot get program header: %s"
 msgstr ""
@@ -4463,19 +4469,19 @@ msgstr ""
 msgid "<INVALID SECTION>"
 msgstr ""
 
-#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3912 src/readelf.c:4212
-#: src/readelf.c:13314 src/readelf.c:13321 src/readelf.c:13365
-#: src/readelf.c:13372
+#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3913 src/readelf.c:4213
+#: src/readelf.c:13315 src/readelf.c:13322 src/readelf.c:13366
+#: src/readelf.c:13373
 msgid "Couldn't uncompress section"
 msgstr ""
 
-#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3916
+#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3917
 #, fuzzy, c-format
 msgid "cannot get section [%zd] header: %s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
 #: src/readelf.c:1886 src/readelf.c:2860 src/readelf.c:3146 src/readelf.c:3221
-#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5962
+#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5963
 #, fuzzy, c-format
 msgid "invalid sh_link value in section %zu"
 msgstr "ungltige .debug_line Sektion"
@@ -4746,51 +4752,51 @@ msgstr "      0  %6<PRIu32>      %5.1f%%\n"
 msgid "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 msgstr "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 
-#: src/readelf.c:3647
+#: src/readelf.c:3648
 #, c-format
 msgid ""
 " Average number of tests:   successful lookup: %f\n"
 "\t\t\t  unsuccessful lookup: %f\n"
 msgstr ""
 
-#: src/readelf.c:3665 src/readelf.c:3729 src/readelf.c:3795
+#: src/readelf.c:3666 src/readelf.c:3730 src/readelf.c:3796
 #, c-format
 msgid "cannot get data for section %d: %s"
 msgstr ""
 
-#: src/readelf.c:3673
+#: src/readelf.c:3674
 #, fuzzy, c-format
 msgid "invalid data in sysv.hash section %d"
 msgstr "ungltige .debug_line Sektion"
 
-#: src/readelf.c:3702
+#: src/readelf.c:3703
 #, fuzzy, c-format
 msgid "invalid chain in sysv.hash section %d"
 msgstr "ungltige .debug_line Sektion"
 
-#: src/readelf.c:3737
+#: src/readelf.c:3738
 #, fuzzy, c-format
 msgid "invalid data in sysv.hash64 section %d"
 msgstr "ungltige .debug_line Sektion"
 
-#: src/readelf.c:3768
+#: src/readelf.c:3769
 #, fuzzy, c-format
 msgid "invalid chain in sysv.hash64 section %d"
 msgstr "ungltige .debug_line Sektion"
 
-#: src/readelf.c:3804
+#: src/readelf.c:3805
 #, fuzzy, c-format
 msgid "invalid data in gnu.hash section %d"
 msgstr "ungltige .debug_line Sektion"
 
-#: src/readelf.c:3870
+#: src/readelf.c:3871
 #, c-format
 msgid ""
 " Symbol Bias: %u\n"
 " Bitmask Size: %zu bytes  %<PRIuFAST32>%% bits set  2nd hash shift: %u\n"
 msgstr ""
 
-#: src/readelf.c:3955
+#: src/readelf.c:3956
 #, c-format
 msgid ""
 "\n"
@@ -4801,13 +4807,13 @@ msgid_plural ""
 msgstr[0] ""
 msgstr[1] ""
 
-#: src/readelf.c:3969
+#: src/readelf.c:3970
 msgid ""
 "       Library                       Time Stamp          Checksum Version "
 "Flags"
 msgstr ""
 
-#: src/readelf.c:4029
+#: src/readelf.c:4030
 #, c-format
 msgid ""
 "\n"
@@ -4815,107 +4821,107 @@ msgid ""
 "%#0<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:4046
+#: src/readelf.c:4047
 msgid "  Owner          Size\n"
 msgstr ""
 
-#: src/readelf.c:4070
+#: src/readelf.c:4071
 #, c-format
 msgid "  %-13s  %4<PRIu32>\n"
 msgstr "  %-13s  %4<PRIu32>\n"
 
 #. Unknown subsection, print and skip.
-#: src/readelf.c:4109
+#: src/readelf.c:4110
 #, c-format
 msgid "    %-4u %12<PRIu32>\n"
 msgstr "    %-4u %12<PRIu32>\n"
 
 #. Tag_File
-#: src/readelf.c:4114
+#: src/readelf.c:4115
 #, c-format
 msgid "    File: %11<PRIu32>\n"
 msgstr "    File: %11<PRIu32>\n"
 
-#: src/readelf.c:4164
+#: src/readelf.c:4165
 #, c-format
 msgid "      %s: %<PRId64>, %s\n"
 msgstr "      %s: %<PRId64>, %s\n"
 
-#: src/readelf.c:4167
+#: src/readelf.c:4168
 #, c-format
 msgid "      %s: %<PRId64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:4170
+#: src/readelf.c:4171
 #, c-format
 msgid "      %s: %s\n"
 msgstr "      %s: %s\n"
 
-#: src/readelf.c:4180
+#: src/readelf.c:4181
 #, c-format
 msgid "      %u: %<PRId64>\n"
 msgstr "      %u: %<PRId64>\n"
 
-#: src/readelf.c:4183
+#: src/readelf.c:4184
 #, c-format
 msgid "      %u: %s\n"
 msgstr "      %u: %s\n"
 
-#: src/readelf.c:4221
+#: src/readelf.c:4222
 #, fuzzy
 msgid "Couldn't get data from section"
 msgstr "konnte Versionierungsabschnitt nicht erstellen: %s"
 
-#: src/readelf.c:4286
+#: src/readelf.c:4287
 #, fuzzy
 msgid "sprintf failure"
 msgstr "mprotect fehlgeschlagen"
 
-#: src/readelf.c:4770
+#: src/readelf.c:4771
 msgid "empty block"
 msgstr ""
 
-#: src/readelf.c:4773
+#: src/readelf.c:4774
 #, c-format
 msgid "%zu byte block:"
 msgstr ""
 
-#: src/readelf.c:5251
+#: src/readelf.c:5252
 #, c-format
 msgid "%*s[%2<PRIuMAX>] %s  <TRUNCATED>\n"
 msgstr ""
 
-#: src/readelf.c:5423
+#: src/readelf.c:5424
 #, c-format
 msgid "%s %#<PRIx64> used with different address sizes"
 msgstr ""
 
-#: src/readelf.c:5430
+#: src/readelf.c:5431
 #, c-format
 msgid "%s %#<PRIx64> used with different offset sizes"
 msgstr ""
 
-#: src/readelf.c:5437
+#: src/readelf.c:5438
 #, c-format
 msgid "%s %#<PRIx64> used with different base addresses"
 msgstr ""
 
-#: src/readelf.c:5444
+#: src/readelf.c:5445
 #, c-format
 msgid "%s %#<PRIx64> used with different attribute %s and %s"
 msgstr ""
 
-#: src/readelf.c:5544
+#: src/readelf.c:5545
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE IN REST OF SECTION>\n"
 msgstr ""
 
-#: src/readelf.c:5552
+#: src/readelf.c:5553
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE> ... %<PRIu64> bytes ...\n"
 msgstr ""
 
-#: src/readelf.c:5658
+#: src/readelf.c:5659
 #, c-format
 msgid ""
 "\n"
@@ -4923,74 +4929,74 @@ msgid ""
 " [ Code]\n"
 msgstr ""
 
-#: src/readelf.c:5666
+#: src/readelf.c:5667
 #, c-format
 msgid ""
 "\n"
 "Abbreviation section at offset %<PRIu64>:\n"
 msgstr ""
 
-#: src/readelf.c:5679
+#: src/readelf.c:5680
 #, c-format
 msgid " *** error while reading abbreviation: %s\n"
 msgstr ""
 
-#: src/readelf.c:5695
+#: src/readelf.c:5696
 #, c-format
 msgid " [%5u] offset: %<PRId64>, children: %s, tag: %s\n"
 msgstr ""
 
-#: src/readelf.c:5732 src/readelf.c:6025 src/readelf.c:6196 src/readelf.c:6567
-#: src/readelf.c:7193 src/readelf.c:8962 src/readelf.c:9704 src/readelf.c:10172
-#: src/readelf.c:10427 src/readelf.c:10589 src/readelf.c:10970
-#: src/readelf.c:11041
+#: src/readelf.c:5733 src/readelf.c:6026 src/readelf.c:6197 src/readelf.c:6568
+#: src/readelf.c:7194 src/readelf.c:8963 src/readelf.c:9705 src/readelf.c:10173
+#: src/readelf.c:10428 src/readelf.c:10590 src/readelf.c:10971
+#: src/readelf.c:11042
 #, c-format
 msgid ""
 "\n"
 "DWARF section [%2zu] '%s' at offset %#<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:5835 src/readelf.c:5859 src/readelf.c:6232 src/readelf.c:9740
+#: src/readelf.c:5836 src/readelf.c:5860 src/readelf.c:6233 src/readelf.c:9741
 #, fuzzy, c-format
 msgid " Length:         %8<PRIu64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:5837 src/readelf.c:5874 src/readelf.c:6245 src/readelf.c:9753
+#: src/readelf.c:5838 src/readelf.c:5875 src/readelf.c:6246 src/readelf.c:9754
 #, fuzzy, c-format
 msgid " DWARF version:  %8<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:5838 src/readelf.c:5883 src/readelf.c:6254 src/readelf.c:9762
+#: src/readelf.c:5839 src/readelf.c:5884 src/readelf.c:6255 src/readelf.c:9763
 #, fuzzy, c-format
 msgid " Address size:   %8<PRIu64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:5840 src/readelf.c:5893 src/readelf.c:6264 src/readelf.c:9772
+#: src/readelf.c:5841 src/readelf.c:5894 src/readelf.c:6265 src/readelf.c:9773
 #, fuzzy, c-format
 msgid " Segment size:   %8<PRIu64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:5878 src/readelf.c:6249 src/readelf.c:9757 src/readelf.c:11163
+#: src/readelf.c:5879 src/readelf.c:6250 src/readelf.c:9758 src/readelf.c:11164
 #, fuzzy, c-format
 msgid "Unknown version"
 msgstr "unbekannte Version"
 
-#: src/readelf.c:5888 src/readelf.c:6095 src/readelf.c:6259 src/readelf.c:9767
+#: src/readelf.c:5889 src/readelf.c:6096 src/readelf.c:6260 src/readelf.c:9768
 #, fuzzy, c-format
 msgid "unsupported address size"
 msgstr "Kein Adress-Wert"
 
-#: src/readelf.c:5899 src/readelf.c:6106 src/readelf.c:6269 src/readelf.c:9777
+#: src/readelf.c:5900 src/readelf.c:6107 src/readelf.c:6270 src/readelf.c:9778
 #, c-format
 msgid "unsupported segment size"
 msgstr ""
 
-#: src/readelf.c:5952
+#: src/readelf.c:5953
 #, c-format
 msgid "cannot get .debug_aranges content: %s"
 msgstr ""
 
-#: src/readelf.c:5967
+#: src/readelf.c:5968
 #, c-format
 msgid ""
 "\n"
@@ -5001,229 +5007,229 @@ msgid_plural ""
 msgstr[0] ""
 msgstr[1] ""
 
-#: src/readelf.c:5998
+#: src/readelf.c:5999
 #, c-format
 msgid " [%*zu] ???\n"
 msgstr " [%*zu] ???\n"
 
-#: src/readelf.c:6000
+#: src/readelf.c:6001
 #, c-format
 msgid ""
 " [%*zu] start: %0#*<PRIx64>, length: %5<PRIu64>, CU DIE offset: %6<PRId64>\n"
 msgstr ""
 
-#: src/readelf.c:6038 src/readelf.c:8981
+#: src/readelf.c:6039 src/readelf.c:8982
 #, c-format
 msgid ""
 "\n"
 "Table at offset %zu:\n"
 msgstr ""
 
-#: src/readelf.c:6042 src/readelf.c:6213 src/readelf.c:7217 src/readelf.c:8992
-#: src/readelf.c:9721
+#: src/readelf.c:6043 src/readelf.c:6214 src/readelf.c:7218 src/readelf.c:8993
+#: src/readelf.c:9722
 #, c-format
 msgid "invalid data in section [%zu] '%s'"
 msgstr ""
 
-#: src/readelf.c:6058
+#: src/readelf.c:6059
 #, fuzzy, c-format
 msgid ""
 "\n"
 " Length:        %6<PRIu64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:6070
+#: src/readelf.c:6071
 #, fuzzy, c-format
 msgid " DWARF version: %6<PRIuFAST16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:6074
+#: src/readelf.c:6075
 #, c-format
 msgid "unsupported aranges version"
 msgstr ""
 
-#: src/readelf.c:6085
+#: src/readelf.c:6086
 #, fuzzy, c-format
 msgid " CU offset:     %6<PRIx64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:6091
+#: src/readelf.c:6092
 #, c-format
 msgid " Address size:  %6<PRIu64>\n"
 msgstr ""
 
-#: src/readelf.c:6102
+#: src/readelf.c:6103
 #, c-format
 msgid ""
 " Segment size:  %6<PRIu64>\n"
 "\n"
 msgstr ""
 
-#: src/readelf.c:6157
+#: src/readelf.c:6158
 #, c-format
 msgid "   %zu padding bytes\n"
 msgstr ""
 
-#: src/readelf.c:6219 src/readelf.c:9727
+#: src/readelf.c:6220 src/readelf.c:9728
 #, fuzzy, c-format
 msgid ""
 "Table at Offset 0x%<PRIx64>:\n"
 "\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:6274 src/readelf.c:9782
+#: src/readelf.c:6275 src/readelf.c:9783
 #, fuzzy, c-format
 msgid " Offset entries: %8<PRIu64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:6290 src/readelf.c:9798
+#: src/readelf.c:6291 src/readelf.c:9799
 #, c-format
 msgid " Unknown CU base: "
 msgstr ""
 
-#: src/readelf.c:6292 src/readelf.c:9800
+#: src/readelf.c:6293 src/readelf.c:9801
 #, c-format
 msgid " CU [%6<PRIx64>] base: "
 msgstr ""
 
-#: src/readelf.c:6298 src/readelf.c:9806
+#: src/readelf.c:6299 src/readelf.c:9807
 #, c-format
 msgid " Not associated with a CU.\n"
 msgstr ""
 
-#: src/readelf.c:6309 src/readelf.c:9817
+#: src/readelf.c:6310 src/readelf.c:9818
 #, c-format
 msgid "too many offset entries for unit length"
 msgstr ""
 
-#: src/readelf.c:6313 src/readelf.c:9821
+#: src/readelf.c:6314 src/readelf.c:9822
 #, fuzzy, c-format
 msgid "  Offsets starting at 0x%<PRIx64>:\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:6365
+#: src/readelf.c:6366
 #, fuzzy, c-format
 msgid "invalid range list data"
 msgstr "Ungltige Daten"
 
-#: src/readelf.c:6550 src/readelf.c:10156
+#: src/readelf.c:6551 src/readelf.c:10157
 #, c-format
 msgid ""
 "   %zu padding bytes\n"
 "\n"
 msgstr ""
 
-#: src/readelf.c:6598 src/readelf.c:10205
+#: src/readelf.c:6599 src/readelf.c:10206
 #, c-format
 msgid ""
 "\n"
 " Unknown CU base: "
 msgstr ""
 
-#: src/readelf.c:6600 src/readelf.c:10207
+#: src/readelf.c:6601 src/readelf.c:10208
 #, c-format
 msgid ""
 "\n"
 " CU [%6<PRIx64>] base: "
 msgstr ""
 
-#: src/readelf.c:6609 src/readelf.c:10233 src/readelf.c:10259
+#: src/readelf.c:6610 src/readelf.c:10234 src/readelf.c:10260
 #, c-format
 msgid " [%6tx]  <INVALID DATA>\n"
 msgstr ""
 
-#: src/readelf.c:6634 src/readelf.c:10343
+#: src/readelf.c:6635 src/readelf.c:10344
 #, fuzzy
 msgid "base address"
 msgstr "Auerhalb des Adressbereiches"
 
-#: src/readelf.c:6644 src/readelf.c:10353
+#: src/readelf.c:6645 src/readelf.c:10354
 #, fuzzy, c-format
 msgid " [%6tx] empty list\n"
 msgstr " [%6tx]  %s..%s\n"
 
-#: src/readelf.c:6908
+#: src/readelf.c:6909
 msgid "         <INVALID DATA>\n"
 msgstr ""
 
-#: src/readelf.c:7165
+#: src/readelf.c:7166
 #, fuzzy, c-format
 msgid "cannot get ELF: %s"
 msgstr "ELF Kopf konnte nicht ausgelesen werden"
 
-#: src/readelf.c:7189
+#: src/readelf.c:7190
 #, c-format
 msgid ""
 "\n"
 "Call frame information section [%2zu] '%s' at offset %#<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:7239
+#: src/readelf.c:7240
 #, c-format
 msgid ""
 "\n"
 " [%6tx] Zero terminator\n"
 msgstr ""
 
-#: src/readelf.c:7343 src/readelf.c:7497
+#: src/readelf.c:7344 src/readelf.c:7498
 #, fuzzy, c-format
 msgid "invalid augmentation length"
 msgstr "ungltige Abschnittsausrichtung"
 
-#: src/readelf.c:7358
+#: src/readelf.c:7359
 msgid "FDE address encoding: "
 msgstr ""
 
-#: src/readelf.c:7364
+#: src/readelf.c:7365
 msgid "LSDA pointer encoding: "
 msgstr ""
 
-#: src/readelf.c:7474
+#: src/readelf.c:7475
 #, c-format
 msgid " (offset: %#<PRIx64>)"
 msgstr ""
 
-#: src/readelf.c:7481
+#: src/readelf.c:7482
 #, c-format
 msgid " (end offset: %#<PRIx64>)"
 msgstr ""
 
-#: src/readelf.c:7518
+#: src/readelf.c:7519
 #, c-format
 msgid "   %-26sLSDA pointer: %#<PRIx64>\n"
 msgstr ""
 
-#: src/readelf.c:7603
+#: src/readelf.c:7604
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute code: %s"
 msgstr ""
 
-#: src/readelf.c:7613
+#: src/readelf.c:7614
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute form: %s"
 msgstr ""
 
-#: src/readelf.c:7635
+#: src/readelf.c:7636
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute '%s' (%s) value: %s"
 msgstr ""
 
-#: src/readelf.c:7965
+#: src/readelf.c:7966
 #, fuzzy, c-format
 msgid "invalid file (%<PRId64>): %s"
 msgstr "Ungltige Datei"
 
-#: src/readelf.c:7969
+#: src/readelf.c:7970
 #, fuzzy, c-format
 msgid "no srcfiles for CU [%<PRIx64>]"
 msgstr "unbekannte Form %<PRIx64>"
 
-#: src/readelf.c:7973
+#: src/readelf.c:7974
 #, fuzzy, c-format
 msgid "couldn't get DWARF CU: %s"
 msgstr "ELF Kopf konnte nicht ausgelesen werden"
 
-#: src/readelf.c:8295
+#: src/readelf.c:8296
 #, c-format
 msgid ""
 "\n"
@@ -5231,12 +5237,12 @@ msgid ""
 " [Offset]\n"
 msgstr ""
 
-#: src/readelf.c:8345
+#: src/readelf.c:8346
 #, fuzzy, c-format
 msgid "cannot get next unit: %s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/readelf.c:8365
+#: src/readelf.c:8366
 #, c-format
 msgid ""
 " Type unit at offset %<PRIu64>:\n"
@@ -5245,7 +5251,7 @@ msgid ""
 " Type signature: %#<PRIx64>, Type offset: %#<PRIx64> [%<PRIx64>]\n"
 msgstr ""
 
-#: src/readelf.c:8377
+#: src/readelf.c:8378
 #, c-format
 msgid ""
 " Compilation unit at offset %<PRIu64>:\n"
@@ -5253,37 +5259,37 @@ msgid ""
 "%<PRIu8>, Offset size: %<PRIu8>\n"
 msgstr ""
 
-#: src/readelf.c:8387 src/readelf.c:8548
+#: src/readelf.c:8388 src/readelf.c:8549
 #, c-format
 msgid " Unit type: %s (%<PRIu8>)"
 msgstr ""
 
-#: src/readelf.c:8414
+#: src/readelf.c:8415
 #, c-format
 msgid "unknown version (%d) or unit type (%d)"
 msgstr ""
 
-#: src/readelf.c:8443
+#: src/readelf.c:8444
 #, c-format
 msgid "cannot get DIE offset: %s"
 msgstr ""
 
-#: src/readelf.c:8452
+#: src/readelf.c:8453
 #, fuzzy, c-format
 msgid "cannot get tag of DIE at offset [%<PRIx64>] in section '%s': %s"
 msgstr "konnte Programm-Kopf nicht erstellen: %s"
 
-#: src/readelf.c:8488
+#: src/readelf.c:8489
 #, c-format
 msgid "cannot get next DIE: %s\n"
 msgstr ""
 
-#: src/readelf.c:8496
+#: src/readelf.c:8497
 #, c-format
 msgid "cannot get next DIE: %s"
 msgstr ""
 
-#: src/readelf.c:8540
+#: src/readelf.c:8541
 #, c-format
 msgid ""
 " Split compilation unit at offset %<PRIu64>:\n"
@@ -5291,7 +5297,7 @@ msgid ""
 "%<PRIu8>, Offset size: %<PRIu8>\n"
 msgstr ""
 
-#: src/readelf.c:8592
+#: src/readelf.c:8593
 #, c-format
 msgid ""
 "\n"
@@ -5299,13 +5305,13 @@ msgid ""
 "\n"
 msgstr ""
 
-#: src/readelf.c:8924
+#: src/readelf.c:8925
 #, fuzzy, c-format
 msgid "unknown form: %s"
 msgstr "unbekannte Form %<PRIx64>"
 
 #. Print what we got so far.
-#: src/readelf.c:9072
+#: src/readelf.c:9073
 #, c-format
 msgid ""
 "\n"
@@ -5324,187 +5330,187 @@ msgid ""
 "Opcodes:\n"
 msgstr ""
 
-#: src/readelf.c:9094
+#: src/readelf.c:9095
 #, fuzzy, c-format
 msgid "cannot handle .debug_line version: %u\n"
 msgstr "ungltige .debug_line Sektion"
 
-#: src/readelf.c:9102
+#: src/readelf.c:9103
 #, fuzzy, c-format
 msgid "cannot handle address size: %u\n"
 msgstr "Kein Adress-Wert"
 
-#: src/readelf.c:9110
+#: src/readelf.c:9111
 #, c-format
 msgid "cannot handle segment selector size: %u\n"
 msgstr ""
 
-#: src/readelf.c:9120
+#: src/readelf.c:9121
 #, c-format
 msgid "invalid data at offset %tu in section [%zu] '%s'"
 msgstr ""
 
-#: src/readelf.c:9135
+#: src/readelf.c:9136
 #, c-format
 msgid "  [%*<PRIuFAST8>]  %hhu argument\n"
 msgid_plural "  [%*<PRIuFAST8>]  %hhu arguments\n"
 msgstr[0] ""
 msgstr[1] ""
 
-#: src/readelf.c:9146
+#: src/readelf.c:9147
 msgid ""
 "\n"
 "Directory table:"
 msgstr ""
 
-#: src/readelf.c:9152 src/readelf.c:9229
+#: src/readelf.c:9153 src/readelf.c:9230
 #, fuzzy, c-format
 msgid "      ["
 msgstr "      %s: %s\n"
 
-#: src/readelf.c:9223
+#: src/readelf.c:9224
 msgid ""
 "\n"
 "File name table:"
 msgstr ""
 
-#: src/readelf.c:9284
+#: src/readelf.c:9285
 msgid " Entry Dir   Time      Size      Name"
 msgstr ""
 
-#: src/readelf.c:9330
+#: src/readelf.c:9331
 msgid ""
 "\n"
 "No line number statements."
 msgstr ""
 
-#: src/readelf.c:9334
+#: src/readelf.c:9335
 msgid ""
 "\n"
 "Line number statements:"
 msgstr ""
 
-#: src/readelf.c:9349
+#: src/readelf.c:9350
 #, c-format
 msgid "invalid maximum operations per instruction is zero"
 msgstr ""
 
-#: src/readelf.c:9383
+#: src/readelf.c:9384
 #, c-format
 msgid " special opcode %u: address+%u = "
 msgstr ""
 
-#: src/readelf.c:9387
+#: src/readelf.c:9388
 #, c-format
 msgid ", op_index = %u, line%+d = %zu\n"
 msgstr ""
 
-#: src/readelf.c:9390
+#: src/readelf.c:9391
 #, c-format
 msgid ", line%+d = %zu\n"
 msgstr ""
 
-#: src/readelf.c:9408
+#: src/readelf.c:9409
 #, c-format
 msgid " extended opcode %u: "
 msgstr ""
 
-#: src/readelf.c:9413
+#: src/readelf.c:9414
 msgid " end of sequence"
 msgstr ""
 
-#: src/readelf.c:9431
+#: src/readelf.c:9432
 #, fuzzy, c-format
 msgid " set address to "
 msgstr "Auerhalb des Adressbereiches"
 
-#: src/readelf.c:9459
+#: src/readelf.c:9460
 #, c-format
 msgid " define new file: dir=%u, mtime=%<PRIu64>, length=%<PRIu64>, name=%s\n"
 msgstr ""
 
-#: src/readelf.c:9473
+#: src/readelf.c:9474
 #, c-format
 msgid " set discriminator to %u\n"
 msgstr ""
 
-#: src/readelf.c:9500
+#: src/readelf.c:9501
 #, c-format
 msgid " set inlined context %u, function name %s (0x%x)\n"
 msgstr ""
 
-#: src/readelf.c:9524
+#: src/readelf.c:9525
 #, c-format
 msgid " set function name %s (0x%x)\n"
 msgstr ""
 
 #. Unknown, ignore it.
-#: src/readelf.c:9531
+#: src/readelf.c:9532
 #, fuzzy
 msgid " unknown opcode"
 msgstr "unbekannter Typ"
 
 #. Takes no argument.
-#: src/readelf.c:9543
+#: src/readelf.c:9544
 msgid " copy"
 msgstr ""
 
-#: src/readelf.c:9554
+#: src/readelf.c:9555
 #, c-format
 msgid " advance address by %u to "
 msgstr ""
 
-#: src/readelf.c:9558 src/readelf.c:9619
+#: src/readelf.c:9559 src/readelf.c:9620
 #, c-format
 msgid ", op_index to %u"
 msgstr ""
 
-#: src/readelf.c:9570
+#: src/readelf.c:9571
 #, c-format
 msgid " advance line by constant %d to %<PRId64>\n"
 msgstr ""
 
-#: src/readelf.c:9580
+#: src/readelf.c:9581
 #, c-format
 msgid " set file to %<PRIu64>\n"
 msgstr ""
 
-#: src/readelf.c:9591
+#: src/readelf.c:9592
 #, c-format
 msgid " set column to %<PRIu64>\n"
 msgstr ""
 
-#: src/readelf.c:9598
+#: src/readelf.c:9599
 #, c-format
 msgid " set '%s' to %<PRIuFAST8>\n"
 msgstr ""
 
 #. Takes no argument.
-#: src/readelf.c:9604
+#: src/readelf.c:9605
 msgid " set basic block flag"
 msgstr ""
 
-#: src/readelf.c:9615
+#: src/readelf.c:9616
 #, c-format
 msgid " advance address by constant %u to "
 msgstr ""
 
-#: src/readelf.c:9635
+#: src/readelf.c:9636
 #, c-format
 msgid " advance address by fixed value %u to \n"
 msgstr ""
 
 #. Takes no argument.
-#: src/readelf.c:9645
+#: src/readelf.c:9646
 msgid " set prologue end flag"
 msgstr ""
 
 #. Takes no argument.
-#: src/readelf.c:9650
+#: src/readelf.c:9651
 msgid " set epilogue begin flag"
 msgstr ""
 
-#: src/readelf.c:9660
+#: src/readelf.c:9661
 #, c-format
 msgid " set isa to %u\n"
 msgstr ""
@@ -5512,93 +5518,93 @@ msgstr ""
 #. This is a new opcode the generator but not we know about.
 #. Read the parameters associated with it but then discard
 #. everything.  Read all the parameters for this opcode.
-#: src/readelf.c:9669
+#: src/readelf.c:9670
 #, c-format
 msgid " unknown opcode with %<PRIu8> parameter:"
 msgid_plural " unknown opcode with %<PRIu8> parameters:"
 msgstr[0] ""
 msgstr[1] ""
 
-#: src/readelf.c:9870
+#: src/readelf.c:9871
 #, c-format
 msgid "    <INVALID DATA>\n"
 msgstr ""
 
-#: src/readelf.c:9910
+#: src/readelf.c:9911
 #, fuzzy, c-format
 msgid "invalid loclists data"
 msgstr "Ungltige Daten"
 
-#: src/readelf.c:10380 src/readelf.c:11425
+#: src/readelf.c:10381 src/readelf.c:11426
 msgid "   <INVALID DATA>\n"
 msgstr ""
 
-#: src/readelf.c:10511
+#: src/readelf.c:10512
 #, c-format
 msgid "%*s*** non-terminated string at end of section"
 msgstr ""
 
-#: src/readelf.c:10534
+#: src/readelf.c:10535
 #, c-format
 msgid "%*s*** missing DW_MACINFO_start_file argument at end of section"
 msgstr ""
 
-#: src/readelf.c:10629
+#: src/readelf.c:10630
 #, fuzzy, c-format
 msgid " Offset:             0x%<PRIx64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:10641
+#: src/readelf.c:10642
 #, fuzzy, c-format
 msgid " Version:            %<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:10647 src/readelf.c:11546
+#: src/readelf.c:10648 src/readelf.c:11547
 #, c-format
 msgid "  unknown version, cannot parse section\n"
 msgstr ""
 
-#: src/readelf.c:10654
+#: src/readelf.c:10655
 #, fuzzy, c-format
 msgid " Flag:               0x%<PRIx8>"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:10683
+#: src/readelf.c:10684
 #, c-format
 msgid " Offset length:      %<PRIu8>\n"
 msgstr ""
 
-#: src/readelf.c:10691
+#: src/readelf.c:10692
 #, c-format
 msgid " .debug_line offset: 0x%<PRIx64>\n"
 msgstr ""
 
-#: src/readelf.c:10716
+#: src/readelf.c:10717
 #, c-format
 msgid "  extension opcode table, %<PRIu8> items:\n"
 msgstr ""
 
-#: src/readelf.c:10723
+#: src/readelf.c:10724
 #, c-format
 msgid "    [%<PRIx8>]"
 msgstr ""
 
-#: src/readelf.c:10735
+#: src/readelf.c:10736
 #, c-format
 msgid " %<PRIu8> arguments:"
 msgstr ""
 
-#: src/readelf.c:10750
+#: src/readelf.c:10751
 #, c-format
 msgid " no arguments."
 msgstr ""
 
-#: src/readelf.c:10951
+#: src/readelf.c:10952
 #, c-format
 msgid " [%5d] DIE offset: %6<PRId64>, CU DIE offset: %6<PRId64>, name: %s\n"
 msgstr ""
 
-#: src/readelf.c:11006
+#: src/readelf.c:11007
 #, c-format
 msgid ""
 "\n"
@@ -5607,72 +5613,72 @@ msgid ""
 msgstr ""
 
 #. TRANS: the debugstr| prefix makes the string unique.
-#: src/readelf.c:11011
+#: src/readelf.c:11012
 msgctxt "debugstr"
 msgid "Offset"
 msgstr ""
 
-#: src/readelf.c:11021
+#: src/readelf.c:11022
 #, c-format
 msgid " *** error, missing string terminator\n"
 msgstr ""
 
-#: src/readelf.c:11143
+#: src/readelf.c:11144
 #, fuzzy, c-format
 msgid " Length:        %8<PRIu64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11145
+#: src/readelf.c:11146
 #, fuzzy, c-format
 msgid " Offset size:   %8<PRIu8>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11159
+#: src/readelf.c:11160
 #, fuzzy, c-format
 msgid " DWARF version: %8<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11168
+#: src/readelf.c:11169
 #, fuzzy, c-format
 msgid " Padding:       %8<PRIx16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11222
+#: src/readelf.c:11223
 #, c-format
 msgid ""
 "\n"
 "Call frame search table section [%2zu] '.eh_frame_hdr':\n"
 msgstr ""
 
-#: src/readelf.c:11324
+#: src/readelf.c:11325
 #, c-format
 msgid ""
 "\n"
 "Exception handling table section [%2zu] '.gcc_except_table':\n"
 msgstr ""
 
-#: src/readelf.c:11347
+#: src/readelf.c:11348
 #, c-format
 msgid " LPStart encoding:    %#x "
 msgstr ""
 
-#: src/readelf.c:11359
+#: src/readelf.c:11360
 #, c-format
 msgid " TType encoding:      %#x "
 msgstr ""
 
-#: src/readelf.c:11376
+#: src/readelf.c:11377
 #, c-format
 msgid " Call site encoding:  %#x "
 msgstr ""
 
-#: src/readelf.c:11391
+#: src/readelf.c:11392
 msgid ""
 "\n"
 " Call site table:"
 msgstr ""
 
-#: src/readelf.c:11407
+#: src/readelf.c:11408
 #, c-format
 msgid ""
 " [%4u] Call site start:   %#<PRIx64>\n"
@@ -5681,164 +5687,164 @@ msgid ""
 "        Action:            %u\n"
 msgstr ""
 
-#: src/readelf.c:11480
+#: src/readelf.c:11481
 #, c-format
 msgid "invalid TType encoding"
 msgstr ""
 
-#: src/readelf.c:11507
+#: src/readelf.c:11508
 #, c-format
 msgid ""
 "\n"
 "GDB section [%2zu] '%s' at offset %#<PRIx64> contains %<PRId64> bytes :\n"
 msgstr ""
 
-#: src/readelf.c:11536
+#: src/readelf.c:11537
 #, fuzzy, c-format
 msgid " Version:         %<PRId32>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11555
+#: src/readelf.c:11556
 #, c-format
 msgid " CU offset:       %#<PRIx32>\n"
 msgstr ""
 
-#: src/readelf.c:11562
+#: src/readelf.c:11563
 #, c-format
 msgid " TU offset:       %#<PRIx32>\n"
 msgstr ""
 
-#: src/readelf.c:11569
+#: src/readelf.c:11570
 #, c-format
 msgid " address offset:  %#<PRIx32>\n"
 msgstr ""
 
-#: src/readelf.c:11576
+#: src/readelf.c:11577
 #, c-format
 msgid " symbol offset:   %#<PRIx32>\n"
 msgstr ""
 
-#: src/readelf.c:11586
+#: src/readelf.c:11587
 #, fuzzy, c-format
 msgid " shortcut offset: %#<PRIx32>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11594
+#: src/readelf.c:11595
 #, c-format
 msgid " constant offset: %#<PRIx32>\n"
 msgstr ""
 
-#: src/readelf.c:11608
+#: src/readelf.c:11609
 #, c-format
 msgid ""
 "\n"
 " CU list at offset %#<PRIx32> contains %zu entries:\n"
 msgstr ""
 
-#: src/readelf.c:11633
+#: src/readelf.c:11634
 #, c-format
 msgid ""
 "\n"
 " TU list at offset %#<PRIx32> contains %zu entries:\n"
 msgstr ""
 
-#: src/readelf.c:11662
+#: src/readelf.c:11663
 #, c-format
 msgid ""
 "\n"
 " Address list at offset %#<PRIx32> contains %zu entries:\n"
 msgstr ""
 
-#: src/readelf.c:11705
+#: src/readelf.c:11706
 #, c-format
 msgid ""
 "\n"
 " Symbol table at offset %#<PRIx32> contains %zu slots:\n"
 msgstr ""
 
-#: src/readelf.c:11790
+#: src/readelf.c:11791
 #, c-format
 msgid ""
 "\n"
 "Shortcut table at offset %#<PRIx32> contains %zu slots:\n"
 msgstr ""
 
-#: src/readelf.c:11802
+#: src/readelf.c:11803
 #, c-format
 msgid "Language of main: %s\n"
 msgstr ""
 
-#: src/readelf.c:11803
+#: src/readelf.c:11804
 #, c-format
 msgid "Name of main: "
 msgstr ""
 
-#: src/readelf.c:11886
+#: src/readelf.c:11887
 #, c-format
 msgid "cannot get debug context descriptor: %s"
 msgstr ""
 
-#: src/readelf.c:12252 src/readelf.c:12872 src/readelf.c:12982
-#: src/readelf.c:13039
+#: src/readelf.c:12253 src/readelf.c:12873 src/readelf.c:12983
+#: src/readelf.c:13040
 #, c-format
 msgid "cannot convert core note data: %s"
 msgstr ""
 
-#: src/readelf.c:12616
+#: src/readelf.c:12617
 #, c-format
 msgid ""
 "\n"
 "%*s... <repeats %u more times> ..."
 msgstr ""
 
-#: src/readelf.c:13118
+#: src/readelf.c:13119
 msgid "  Owner          Data size  Type\n"
 msgstr ""
 
-#: src/readelf.c:13146
+#: src/readelf.c:13147
 #, c-format
 msgid "  %-13.*s  %9<PRId32>  %s\n"
 msgstr ""
 
-#: src/readelf.c:13198
+#: src/readelf.c:13199
 #, fuzzy, c-format
 msgid "cannot get content of note: %s"
 msgstr "Konnte Inhalt von %s: %s nicht lesen"
 
-#: src/readelf.c:13231
+#: src/readelf.c:13232
 #, c-format
 msgid ""
 "\n"
 "Note section [%2zu] '%s' of %<PRIu64> bytes at offset %#0<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:13254
+#: src/readelf.c:13255
 #, c-format
 msgid ""
 "\n"
 "Note segment of %<PRIu64> bytes at offset %#0<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:13301
+#: src/readelf.c:13302
 #, fuzzy, c-format
 msgid ""
 "\n"
 "Section [%zu] '%s' has no data to dump.\n"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/readelf.c:13328 src/readelf.c:13379
+#: src/readelf.c:13329 src/readelf.c:13380
 #, fuzzy, c-format
 msgid "cannot get data for section [%zu] '%s': %s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/readelf.c:13333
+#: src/readelf.c:13334
 #, c-format
 msgid ""
 "\n"
 "Hex dump of section [%zu] '%s', %<PRIu64> bytes at offset %#0<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:13338
+#: src/readelf.c:13339
 #, c-format
 msgid ""
 "\n"
@@ -5846,21 +5852,21 @@ msgid ""
 "%#0<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:13352
+#: src/readelf.c:13353
 #, fuzzy, c-format
 msgid ""
 "\n"
 "Section [%zu] '%s' has no strings to dump.\n"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/readelf.c:13384
+#: src/readelf.c:13385
 #, c-format
 msgid ""
 "\n"
 "String section [%zu] '%s' contains %<PRIu64> bytes at offset %#0<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:13389
+#: src/readelf.c:13390
 #, c-format
 msgid ""
 "\n"
@@ -5868,45 +5874,45 @@ msgid ""
 "offset %#0<PRIx64>:\n"
 msgstr ""
 
-#: src/readelf.c:13437
+#: src/readelf.c:13438
 #, c-format
 msgid ""
 "\n"
 "section [%lu] does not exist"
 msgstr ""
 
-#: src/readelf.c:13467
+#: src/readelf.c:13468
 #, c-format
 msgid ""
 "\n"
 "section '%s' does not exist"
 msgstr ""
 
-#: src/readelf.c:13522
+#: src/readelf.c:13523
 #, c-format
 msgid "cannot get symbol index of archive '%s': %s"
 msgstr ""
 
-#: src/readelf.c:13525
+#: src/readelf.c:13526
 #, c-format
 msgid ""
 "\n"
 "Archive '%s' has no symbol index\n"
 msgstr ""
 
-#: src/readelf.c:13529
+#: src/readelf.c:13530
 #, c-format
 msgid ""
 "\n"
 "Index of archive '%s' has %zu entries:\n"
 msgstr ""
 
-#: src/readelf.c:13547
+#: src/readelf.c:13548
 #, fuzzy, c-format
 msgid "cannot extract member at offset %zu in '%s': %s"
 msgstr "konnte Programm-Kopf nicht erstellen: %s"
 
-#: src/readelf.c:13552
+#: src/readelf.c:13553
 #, c-format
 msgid "Archive member '%s' contains:\n"
 msgstr ""
@@ -6539,7 +6545,7 @@ msgstr ""
 msgid "cannot get shdrstrndx:%s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/unstrip.c:243 src/unstrip.c:2085
+#: src/unstrip.c:243 src/unstrip.c:2136
 #, c-format
 msgid "cannot get ELF header: %s"
 msgstr ""
@@ -6559,12 +6565,12 @@ msgstr "konnte Versionierungsabschnitt nicht erstellen: %s"
 msgid "cannot copy ELF header: %s"
 msgstr ""
 
-#: src/unstrip.c:264 src/unstrip.c:2103 src/unstrip.c:2146
+#: src/unstrip.c:264 src/unstrip.c:2154 src/unstrip.c:2197
 #, fuzzy, c-format
 msgid "cannot get number of program headers: %s"
 msgstr "konnte Programm-Kopf nicht erstellen: %s"
 
-#: src/unstrip.c:269 src/unstrip.c:2107
+#: src/unstrip.c:269 src/unstrip.c:2158
 #, c-format
 msgid "cannot create program headers: %s"
 msgstr "konnte Programm-Kopf nicht erstellen: %s"
@@ -6579,12 +6585,12 @@ msgstr "konnte Programm-Kopf nicht kopieren: %s"
 msgid "cannot copy section header: %s"
 msgstr ""
 
-#: src/unstrip.c:288 src/unstrip.c:1707
+#: src/unstrip.c:288 src/unstrip.c:1748
 #, c-format
 msgid "cannot get section data: %s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/unstrip.c:290 src/unstrip.c:1709
+#: src/unstrip.c:290 src/unstrip.c:1750
 #, c-format
 msgid "cannot copy section data: %s"
 msgstr "konnte Abschnittsdaten nicht kopieren: %s"
@@ -6594,14 +6600,14 @@ msgstr "konnte Abschnittsdaten nicht kopieren: %s"
 msgid "cannot create directory '%s'"
 msgstr "konnte Verzeichnis nicht erstellen: %s"
 
-#: src/unstrip.c:392 src/unstrip.c:657 src/unstrip.c:691 src/unstrip.c:859
-#: src/unstrip.c:1749
+#: src/unstrip.c:392 src/unstrip.c:666 src/unstrip.c:700 src/unstrip.c:868
+#: src/unstrip.c:1790
 #, c-format
 msgid "cannot get symbol table entry: %s"
 msgstr "konnte Eintrag aus der Symboltabelle nicht holen: %s"
 
-#: src/unstrip.c:408 src/unstrip.c:660 src/unstrip.c:681 src/unstrip.c:694
-#: src/unstrip.c:1770 src/unstrip.c:1965 src/unstrip.c:1989
+#: src/unstrip.c:408 src/unstrip.c:669 src/unstrip.c:690 src/unstrip.c:703
+#: src/unstrip.c:1811 src/unstrip.c:2007 src/unstrip.c:2031
 #, c-format
 msgid "cannot update symbol table: %s"
 msgstr "konnte Symboltabelle nicht aktualisieren: %s"
@@ -6636,224 +6642,238 @@ msgstr ""
 msgid "unexpected section type in [%zu] with sh_link to symtab"
 msgstr ""
 
-#: src/unstrip.c:848
+#: src/unstrip.c:857
 #, fuzzy, c-format
 msgid "cannot get symbol section data: %s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/unstrip.c:850
+#: src/unstrip.c:859
 #, fuzzy, c-format
 msgid "cannot get string section data: %s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/unstrip.c:867
+#: src/unstrip.c:876
 #, fuzzy, c-format
 msgid "invalid string offset in symbol [%zu]"
 msgstr "ungltiger Offset %zu fr Symbol %s"
 
-#: src/unstrip.c:1025 src/unstrip.c:1433
+#: src/unstrip.c:939
+msgid "found two identical index map positions."
+msgstr ""
+
+#: src/unstrip.c:990
+msgid "section symbols in unexpected order"
+msgstr ""
+
+#: src/unstrip.c:996
+#, fuzzy
+#| msgid "Display only defined symbols"
+msgid "found two identical symbols"
+msgstr "Zeige nur definierte Symbole"
+
+#: src/unstrip.c:1066 src/unstrip.c:1474
 #, fuzzy, c-format
 msgid "cannot read section [%zu] name: %s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/unstrip.c:1040
+#: src/unstrip.c:1081
 #, fuzzy, c-format
 msgid "bad sh_link for group section: %s"
 msgstr "ungltige .debug_line Sektion"
 
-#: src/unstrip.c:1046
+#: src/unstrip.c:1087
 #, fuzzy, c-format
 msgid "couldn't get shdr for group section: %s"
 msgstr "konnte Versionierungsabschnitt nicht erstellen: %s"
 
-#: src/unstrip.c:1051
+#: src/unstrip.c:1092
 #, fuzzy, c-format
 msgid "bad data for group symbol section: %s"
 msgstr "ungltige .debug_line Sektion"
 
-#: src/unstrip.c:1057
+#: src/unstrip.c:1098
 #, fuzzy, c-format
 msgid "couldn't get symbol for group section: %s"
 msgstr "konnte Programm-Kopf nicht erstellen: %s"
 
-#: src/unstrip.c:1062
+#: src/unstrip.c:1103
 #, fuzzy, c-format
 msgid "bad symbol name for group section: %s"
 msgstr "konnte Programm-Kopf nicht erstellen: %s"
 
-#: src/unstrip.c:1073 src/unstrip.c:1553
+#: src/unstrip.c:1114 src/unstrip.c:1594
 #, fuzzy, c-format
 msgid "cannot find matching section for [%zu] '%s'"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/unstrip.c:1118 src/unstrip.c:1137 src/unstrip.c:1175
+#: src/unstrip.c:1159 src/unstrip.c:1178 src/unstrip.c:1216
 #, c-format
 msgid "cannot read '.gnu.prelink_undo' section: %s"
 msgstr ""
 
-#: src/unstrip.c:1155
+#: src/unstrip.c:1196
 #, c-format
 msgid "overflow with shnum = %zu in '%s' section"
 msgstr ""
 
-#: src/unstrip.c:1166
+#: src/unstrip.c:1207
 #, c-format
 msgid "invalid contents in '%s' section"
 msgstr ""
 
-#: src/unstrip.c:1337 src/unstrip.c:1353 src/unstrip.c:1633 src/unstrip.c:1924
+#: src/unstrip.c:1378 src/unstrip.c:1394 src/unstrip.c:1674 src/unstrip.c:1966
 #, c-format
 msgid "cannot add section name to string table: %s"
 msgstr ""
 
-#: src/unstrip.c:1362
+#: src/unstrip.c:1403
 #, c-format
 msgid "cannot update section header string table data: %s"
 msgstr ""
 
-#: src/unstrip.c:1391 src/unstrip.c:1395
+#: src/unstrip.c:1432 src/unstrip.c:1436
 #, c-format
 msgid "cannot get section header string table section index: %s"
 msgstr ""
 
-#: src/unstrip.c:1399 src/unstrip.c:1403 src/unstrip.c:1648
+#: src/unstrip.c:1440 src/unstrip.c:1444 src/unstrip.c:1689
 #, c-format
 msgid "cannot get section count: %s"
 msgstr ""
 
-#: src/unstrip.c:1406
+#: src/unstrip.c:1447
 msgid "more sections in stripped file than debug file -- arguments reversed?"
 msgstr ""
 
-#: src/unstrip.c:1410
+#: src/unstrip.c:1451
 msgid "no sections in stripped file"
 msgstr ""
 
-#: src/unstrip.c:1458 src/unstrip.c:1568
+#: src/unstrip.c:1499 src/unstrip.c:1609
 #, c-format
 msgid "cannot read section header string table: %s"
 msgstr ""
 
-#: src/unstrip.c:1627
+#: src/unstrip.c:1668
 #, c-format
 msgid "cannot add new section: %s"
 msgstr ""
 
-#: src/unstrip.c:1757
+#: src/unstrip.c:1798
 #, fuzzy, c-format
 msgid "symbol [%zu] has invalid section index"
 msgstr "ungltiger Abschnittsindex"
 
-#: src/unstrip.c:1789
+#: src/unstrip.c:1830
 #, fuzzy, c-format
 msgid "group has invalid section index [%zd]"
 msgstr "ungltiger Abschnittsindex"
 
-#: src/unstrip.c:2064
+#: src/unstrip.c:2115
 #, fuzzy, c-format
 msgid "cannot read section data: %s"
 msgstr "konnte Abschnittsdaten nicht holen: %s"
 
-#: src/unstrip.c:2093
+#: src/unstrip.c:2144
 #, c-format
 msgid "cannot update ELF header: %s"
 msgstr ""
 
-#: src/unstrip.c:2117
+#: src/unstrip.c:2168
 #, c-format
 msgid "cannot update program header: %s"
 msgstr "konnte Programm-Kopf nicht aktualisieren: %s"
 
-#: src/unstrip.c:2122 src/unstrip.c:2205
+#: src/unstrip.c:2173 src/unstrip.c:2256
 #, c-format
 msgid "cannot write output file: %s"
 msgstr ""
 
-#: src/unstrip.c:2173
+#: src/unstrip.c:2224
 #, c-format
 msgid "DWARF data not adjusted for prelinking bias; consider prelink -u"
 msgstr ""
 
-#: src/unstrip.c:2176
+#: src/unstrip.c:2227
 #, c-format
 msgid ""
 "DWARF data in '%s' not adjusted for prelinking bias; consider prelink -u"
 msgstr ""
 
-#: src/unstrip.c:2196 src/unstrip.c:2248 src/unstrip.c:2260 src/unstrip.c:2350
+#: src/unstrip.c:2247 src/unstrip.c:2299 src/unstrip.c:2311 src/unstrip.c:2401
 #, c-format
 msgid "cannot create ELF descriptor: %s"
 msgstr ""
 
-#: src/unstrip.c:2234
+#: src/unstrip.c:2285
 msgid "WARNING: "
 msgstr ""
 
-#: src/unstrip.c:2236
+#: src/unstrip.c:2287
 msgid ", use --force"
 msgstr ""
 
-#: src/unstrip.c:2264
+#: src/unstrip.c:2315
 msgid "ELF header identification (e_ident) different"
 msgstr ""
 
-#: src/unstrip.c:2268
+#: src/unstrip.c:2319
 msgid "ELF header type (e_type) different"
 msgstr ""
 
-#: src/unstrip.c:2272
+#: src/unstrip.c:2323
 msgid "ELF header machine type (e_machine) different"
 msgstr ""
 
-#: src/unstrip.c:2276
+#: src/unstrip.c:2327
 msgid "stripped program header (e_phnum) smaller than unstripped"
 msgstr ""
 
-#: src/unstrip.c:2307
+#: src/unstrip.c:2358
 #, c-format
 msgid "cannot find stripped file for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2311
+#: src/unstrip.c:2362
 #, c-format
 msgid "cannot open stripped file '%s' for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2326
+#: src/unstrip.c:2377
 #, c-format
 msgid "cannot find debug file for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2330
+#: src/unstrip.c:2381
 #, c-format
 msgid "cannot open debug file '%s' for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2343
+#: src/unstrip.c:2394
 #, c-format
 msgid "module '%s' file '%s' is not stripped"
 msgstr ""
 
-#: src/unstrip.c:2374
+#: src/unstrip.c:2425
 #, c-format
 msgid "cannot cache section addresses for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2502
+#: src/unstrip.c:2553
 msgid "no matching modules found"
 msgstr "kein passendes Modul gefunden"
 
-#: src/unstrip.c:2512
+#: src/unstrip.c:2563
 msgid "matched more than one module"
 msgstr "mehr als ein passendes Modul"
 
-#: src/unstrip.c:2557
+#: src/unstrip.c:2608
 msgid ""
 "STRIPPED-FILE DEBUG-FILE\n"
 "[MODULE...]"
 msgstr ""
 
-#: src/unstrip.c:2558
+#: src/unstrip.c:2609
 msgid ""
 "Combine stripped files with separate symbols and debug information.\n"
 "\n"
diff --git a/po/es.po b/po/es.po
index 37362094..76efc24e 100644
--- a/po/es.po
+++ b/po/es.po
@@ -10,7 +10,7 @@ msgid ""
 msgstr ""
 "Project-Id-Version: elfutils\n"
 "Report-Msgid-Bugs-To: https://sourceware.org/bugzilla/\n"
-"POT-Creation-Date: 2023-11-03 17:36+0100\n"
+"POT-Creation-Date: 2024-03-01 10:22-0500\n"
 "PO-Revision-Date: 2011-01-10 15:17-0300\n"
 "Last-Translator: Claudio Rodrigo Pereyra Diaz <claudiorodrigo@pereyradiaz."
 "com.ar>\n"
@@ -52,7 +52,7 @@ msgstr ""
 "garanta, ni siquiera para SU COMERCIALIZACIN o PARA SER USADO CON UN FIN "
 "DETERMINADO.\n"
 
-#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12202
+#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12203
 #: src/unstrip.c:311
 #, c-format
 msgid "memory exhausted"
@@ -313,7 +313,13 @@ msgstr "cdigo operativo desconocido "
 msgid ".debug_addr section missing"
 msgstr ".debug_ranges section faltante"
 
-#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2547
+#: libdw/dwarf_error.c:105
+#, fuzzy
+#| msgid "unknown version"
+msgid "unknown section"
+msgstr "versin desconocida"
+
+#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2598
 msgid "Input selection options:"
 msgstr "Opciones de seleccin de entrada:"
 
@@ -649,7 +655,7 @@ msgstr "tamao invlido del operando fuente"
 msgid "invalid size of destination operand"
 msgstr "tamao invlido del operando destino"
 
-#: libelf/elf_error.c:86 src/readelf.c:6758
+#: libelf/elf_error.c:86 src/readelf.c:6759
 #, c-format
 msgid "invalid encoding"
 msgstr "codificacin invlida"
@@ -735,8 +741,8 @@ msgstr "no coinciden los datos/scn"
 msgid "invalid section header"
 msgstr "encabezamiento de seccin invlida"
 
-#: libelf/elf_error.c:190 src/readelf.c:10637 src/readelf.c:11242
-#: src/readelf.c:11343 src/readelf.c:11531
+#: libelf/elf_error.c:190 src/readelf.c:10638 src/readelf.c:11243
+#: src/readelf.c:11344 src/readelf.c:11532
 #, c-format
 msgid "invalid data"
 msgstr "datos invlidos"
@@ -1645,7 +1651,7 @@ msgstr "Valor invlido '%s' para parmetro --gaps"
 
 #: src/elfcmp.c:733 src/findtextrel.c:194 src/nm.c:363 src/ranlib.c:140
 #: src/size.c:271 src/strings.c:184 src/strip.c:1040 src/strip.c:1077
-#: src/unstrip.c:2194 src/unstrip.c:2223
+#: src/unstrip.c:2245 src/unstrip.c:2274
 #, c-format
 msgid "cannot open '%s'"
 msgstr "Imposible abrir '%s'"
@@ -4051,9 +4057,9 @@ msgstr "No se puede crear el rbol de bsqueda"
 #: src/nm.c:742 src/nm.c:1234 src/objdump.c:778 src/readelf.c:685
 #: src/readelf.c:1506 src/readelf.c:1655 src/readelf.c:1882 src/readelf.c:2123
 #: src/readelf.c:2312 src/readelf.c:2482 src/readelf.c:2604 src/readelf.c:2854
-#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3896
-#: src/readelf.c:3944 src/readelf.c:4013 src/readelf.c:12029
-#: src/readelf.c:13212 src/readelf.c:13422 src/readelf.c:13490 src/size.c:396
+#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3897
+#: src/readelf.c:3945 src/readelf.c:4014 src/readelf.c:12030
+#: src/readelf.c:13213 src/readelf.c:13423 src/readelf.c:13491 src/size.c:396
 #: src/size.c:467 src/strip.c:1093
 #, c-format
 msgid "cannot get section header string table index"
@@ -4407,11 +4413,11 @@ msgstr "no se pudieron determinar el nmero de secciones: %s"
 msgid "cannot get section: %s"
 msgstr "No se puede encontrar la seccin: %s"
 
-#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13442
-#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:610
-#: src/unstrip.c:631 src/unstrip.c:671 src/unstrip.c:887 src/unstrip.c:1222
-#: src/unstrip.c:1349 src/unstrip.c:1373 src/unstrip.c:1429 src/unstrip.c:1470
-#: src/unstrip.c:1662 src/unstrip.c:1813 src/unstrip.c:1956 src/unstrip.c:2055
+#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13443
+#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:622
+#: src/unstrip.c:640 src/unstrip.c:680 src/unstrip.c:897 src/unstrip.c:1263
+#: src/unstrip.c:1390 src/unstrip.c:1414 src/unstrip.c:1470 src/unstrip.c:1511
+#: src/unstrip.c:1703 src/unstrip.c:1854 src/unstrip.c:1998 src/unstrip.c:2106
 #, c-format
 msgid "cannot get section header: %s"
 msgstr "No se puede obtener encabezamiento de seccin: %s"
@@ -4421,8 +4427,8 @@ msgstr "No se puede obtener encabezamiento de seccin: %s"
 msgid "cannot get section name"
 msgstr "no se puede obtener encabezamiento de seccin\n"
 
-#: src/readelf.c:720 src/readelf.c:7176 src/readelf.c:11230 src/readelf.c:11332
-#: src/readelf.c:11516
+#: src/readelf.c:720 src/readelf.c:7177 src/readelf.c:11231 src/readelf.c:11333
+#: src/readelf.c:11517
 #, c-format
 msgid "cannot get %s content: %s"
 msgstr "No se puede obtener el contenido %s: %s"
@@ -4771,7 +4777,7 @@ msgstr ""
 " Seccin para asignacin de segmento:\n"
 "  Secciones de segmento..."
 
-#: src/readelf.c:1519 src/unstrip.c:2114 src/unstrip.c:2156 src/unstrip.c:2163
+#: src/readelf.c:1519 src/unstrip.c:2165 src/unstrip.c:2207 src/unstrip.c:2214
 #, c-format
 msgid "cannot get program header: %s"
 msgstr "no se puede obtener memoria para encabezamiento del programa: %s"
@@ -4814,19 +4820,19 @@ msgstr "<SMBOLO INVLIDO>"
 msgid "<INVALID SECTION>"
 msgstr "<SECCIN INVLIDA>"
 
-#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3912 src/readelf.c:4212
-#: src/readelf.c:13314 src/readelf.c:13321 src/readelf.c:13365
-#: src/readelf.c:13372
+#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3913 src/readelf.c:4213
+#: src/readelf.c:13315 src/readelf.c:13322 src/readelf.c:13366
+#: src/readelf.c:13373
 msgid "Couldn't uncompress section"
 msgstr ""
 
-#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3916
+#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3917
 #, fuzzy, c-format
 msgid "cannot get section [%zd] header: %s"
 msgstr "No se puede obtener encabezamiento de seccin: %s"
 
 #: src/readelf.c:1886 src/readelf.c:2860 src/readelf.c:3146 src/readelf.c:3221
-#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5962
+#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5963
 #, fuzzy, c-format
 msgid "invalid sh_link value in section %zu"
 msgstr ".debug_line section invlida"
@@ -5174,7 +5180,7 @@ msgstr "      0  %6<PRIu32>      %5.1f%%\n"
 msgid "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 msgstr "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 
-#: src/readelf.c:3647
+#: src/readelf.c:3648
 #, c-format
 msgid ""
 " Average number of tests:   successful lookup: %f\n"
@@ -5183,37 +5189,37 @@ msgstr ""
 " Nmero promedio de pruebas:   bsqueda exitosa: %f\n"
 "                          bsqueda sin xito: %f\n"
 
-#: src/readelf.c:3665 src/readelf.c:3729 src/readelf.c:3795
+#: src/readelf.c:3666 src/readelf.c:3730 src/readelf.c:3796
 #, c-format
 msgid "cannot get data for section %d: %s"
 msgstr "No se pueden obtener datos para la seccin %d: %s"
 
-#: src/readelf.c:3673
+#: src/readelf.c:3674
 #, fuzzy, c-format
 msgid "invalid data in sysv.hash section %d"
 msgstr "Datos invlidos en seccin [%zu] '%s'"
 
-#: src/readelf.c:3702
+#: src/readelf.c:3703
 #, fuzzy, c-format
 msgid "invalid chain in sysv.hash section %d"
 msgstr "Datos invlidos en seccin [%zu] '%s'"
 
-#: src/readelf.c:3737
+#: src/readelf.c:3738
 #, fuzzy, c-format
 msgid "invalid data in sysv.hash64 section %d"
 msgstr "Datos invlidos en seccin [%zu] '%s'"
 
-#: src/readelf.c:3768
+#: src/readelf.c:3769
 #, fuzzy, c-format
 msgid "invalid chain in sysv.hash64 section %d"
 msgstr "Datos invlidos en seccin [%zu] '%s'"
 
-#: src/readelf.c:3804
+#: src/readelf.c:3805
 #, fuzzy, c-format
 msgid "invalid data in gnu.hash section %d"
 msgstr "Datos invlidos en seccin [%zu] '%s'"
 
-#: src/readelf.c:3870
+#: src/readelf.c:3871
 #, c-format
 msgid ""
 " Symbol Bias: %u\n"
@@ -5223,7 +5229,7 @@ msgstr ""
 " Tamao de Bitmask: %zu bytes  %<PRIuFAST32>%% bits establecen segundo "
 "cambio de dispersin: %u\n"
 
-#: src/readelf.c:3955
+#: src/readelf.c:3956
 #, c-format
 msgid ""
 "\n"
@@ -5240,7 +5246,7 @@ msgstr[1] ""
 "Seccin de lista de biblioteca [%2zu] '%s' en compensacin %#0<PRIx64> "
 "contiene entradas %d:\n"
 
-#: src/readelf.c:3969
+#: src/readelf.c:3970
 msgid ""
 "       Library                       Time Stamp          Checksum Version "
 "Flags"
@@ -5248,7 +5254,7 @@ msgstr ""
 "       Biblioteca                       Marca de tiempo          Indicadores "
 "de versin de suma de verificacin"
 
-#: src/readelf.c:4029
+#: src/readelf.c:4030
 #, c-format
 msgid ""
 "\n"
@@ -5259,107 +5265,107 @@ msgstr ""
 "Seccin de atributos de objeto [%2zu] '%s' de %<PRIu64> bytes con "
 "desplazamiento %#0<PRIx64>:\n"
 
-#: src/readelf.c:4046
+#: src/readelf.c:4047
 msgid "  Owner          Size\n"
 msgstr "  Propietario          Tamao\n"
 
-#: src/readelf.c:4070
+#: src/readelf.c:4071
 #, c-format
 msgid "  %-13s  %4<PRIu32>\n"
 msgstr "  %-13s  %4<PRIu32>\n"
 
 #. Unknown subsection, print and skip.
-#: src/readelf.c:4109
+#: src/readelf.c:4110
 #, c-format
 msgid "    %-4u %12<PRIu32>\n"
 msgstr "    %-4u %12<PRIu32>\n"
 
 #. Tag_File
-#: src/readelf.c:4114
+#: src/readelf.c:4115
 #, c-format
 msgid "    File: %11<PRIu32>\n"
 msgstr "    File: %11<PRIu32>\n"
 
-#: src/readelf.c:4164
+#: src/readelf.c:4165
 #, c-format
 msgid "      %s: %<PRId64>, %s\n"
 msgstr "      %s: %<PRId64>, %s\n"
 
-#: src/readelf.c:4167
+#: src/readelf.c:4168
 #, c-format
 msgid "      %s: %<PRId64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:4170
+#: src/readelf.c:4171
 #, c-format
 msgid "      %s: %s\n"
 msgstr "      %s: %s\n"
 
-#: src/readelf.c:4180
+#: src/readelf.c:4181
 #, c-format
 msgid "      %u: %<PRId64>\n"
 msgstr "      %u: %<PRId64>\n"
 
-#: src/readelf.c:4183
+#: src/readelf.c:4184
 #, c-format
 msgid "      %u: %s\n"
 msgstr "      %u: %s\n"
 
-#: src/readelf.c:4221
+#: src/readelf.c:4222
 #, fuzzy
 msgid "Couldn't get data from section"
 msgstr "No se puede obtener encabezamiento de seccin 0th: %s"
 
-#: src/readelf.c:4286
+#: src/readelf.c:4287
 #, fuzzy
 msgid "sprintf failure"
 msgstr "mprotect fall"
 
-#: src/readelf.c:4770
+#: src/readelf.c:4771
 msgid "empty block"
 msgstr "bloque vaco"
 
-#: src/readelf.c:4773
+#: src/readelf.c:4774
 #, c-format
 msgid "%zu byte block:"
 msgstr "bloque de byte %zu:"
 
-#: src/readelf.c:5251
+#: src/readelf.c:5252
 #, fuzzy, c-format
 msgid "%*s[%2<PRIuMAX>] %s  <TRUNCATED>\n"
 msgstr "%*s[%4<PRIuMAX>] %s  <TRUNCATED>\n"
 
-#: src/readelf.c:5423
+#: src/readelf.c:5424
 #, c-format
 msgid "%s %#<PRIx64> used with different address sizes"
 msgstr "%s %#<PRIx64> utilizado con direcciones de diferente tamao"
 
-#: src/readelf.c:5430
+#: src/readelf.c:5431
 #, c-format
 msgid "%s %#<PRIx64> used with different offset sizes"
 msgstr "%s %#<PRIx64> utilizado con offsetr de diferente tamao"
 
-#: src/readelf.c:5437
+#: src/readelf.c:5438
 #, fuzzy, c-format
 msgid "%s %#<PRIx64> used with different base addresses"
 msgstr "%s %#<PRIx64> utilizado con direcciones de diferente tamao"
 
-#: src/readelf.c:5444
+#: src/readelf.c:5445
 #, fuzzy, c-format
 msgid "%s %#<PRIx64> used with different attribute %s and %s"
 msgstr "%s %#<PRIx64> utilizado con direcciones de diferente tamao"
 
-#: src/readelf.c:5544
+#: src/readelf.c:5545
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE IN REST OF SECTION>\n"
 msgstr " [%6tx] <MATERIAL INUTIL SIN UTILIZAR EN EL RESTO DE LA SECCION>\n"
 
-#: src/readelf.c:5552
+#: src/readelf.c:5553
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE> ... %<PRIu64> bytes ...\n"
 msgstr " [%6tx]  <MATERIAL INUTIL NO UTILIZADO> ... %<PRIu64> bytes ...\n"
 
-#: src/readelf.c:5658
+#: src/readelf.c:5659
 #, c-format
 msgid ""
 "\n"
@@ -5370,7 +5376,7 @@ msgstr ""
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64>:\n"
 " [ Cdigo]\n"
 
-#: src/readelf.c:5666
+#: src/readelf.c:5667
 #, c-format
 msgid ""
 "\n"
@@ -5379,20 +5385,20 @@ msgstr ""
 "\n"
 "Seccin de abreviatura en compensacin %<PRIu64>:\n"
 
-#: src/readelf.c:5679
+#: src/readelf.c:5680
 #, c-format
 msgid " *** error while reading abbreviation: %s\n"
 msgstr " *** error en lectura de abreviatura: %s\n"
 
-#: src/readelf.c:5695
+#: src/readelf.c:5696
 #, c-format
 msgid " [%5u] offset: %<PRId64>, children: %s, tag: %s\n"
 msgstr " [%5u] compensacin: %<PRId64>, hijos: %s, etiqueta: %s\n"
 
-#: src/readelf.c:5732 src/readelf.c:6025 src/readelf.c:6196 src/readelf.c:6567
-#: src/readelf.c:7193 src/readelf.c:8962 src/readelf.c:9704 src/readelf.c:10172
-#: src/readelf.c:10427 src/readelf.c:10589 src/readelf.c:10970
-#: src/readelf.c:11041
+#: src/readelf.c:5733 src/readelf.c:6026 src/readelf.c:6197 src/readelf.c:6568
+#: src/readelf.c:7194 src/readelf.c:8963 src/readelf.c:9705 src/readelf.c:10173
+#: src/readelf.c:10428 src/readelf.c:10590 src/readelf.c:10971
+#: src/readelf.c:11042
 #, c-format
 msgid ""
 "\n"
@@ -5401,47 +5407,47 @@ msgstr ""
 "\n"
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64>:\n"
 
-#: src/readelf.c:5835 src/readelf.c:5859 src/readelf.c:6232 src/readelf.c:9740
+#: src/readelf.c:5836 src/readelf.c:5860 src/readelf.c:6233 src/readelf.c:9741
 #, fuzzy, c-format
 msgid " Length:         %8<PRIu64>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:5837 src/readelf.c:5874 src/readelf.c:6245 src/readelf.c:9753
+#: src/readelf.c:5838 src/readelf.c:5875 src/readelf.c:6246 src/readelf.c:9754
 #, fuzzy, c-format
 msgid " DWARF version:  %8<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:5838 src/readelf.c:5883 src/readelf.c:6254 src/readelf.c:9762
+#: src/readelf.c:5839 src/readelf.c:5884 src/readelf.c:6255 src/readelf.c:9763
 #, fuzzy, c-format
 msgid " Address size:   %8<PRIu64>\n"
 msgstr " (fin de compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:5840 src/readelf.c:5893 src/readelf.c:6264 src/readelf.c:9772
+#: src/readelf.c:5841 src/readelf.c:5894 src/readelf.c:6265 src/readelf.c:9773
 #, fuzzy, c-format
 msgid " Segment size:   %8<PRIu64>\n"
 msgstr " establecer archivo a %<PRIu64>\n"
 
-#: src/readelf.c:5878 src/readelf.c:6249 src/readelf.c:9757 src/readelf.c:11163
+#: src/readelf.c:5879 src/readelf.c:6250 src/readelf.c:9758 src/readelf.c:11164
 #, fuzzy, c-format
 msgid "Unknown version"
 msgstr "versin desconocida"
 
-#: src/readelf.c:5888 src/readelf.c:6095 src/readelf.c:6259 src/readelf.c:9767
+#: src/readelf.c:5889 src/readelf.c:6096 src/readelf.c:6260 src/readelf.c:9768
 #, fuzzy, c-format
 msgid "unsupported address size"
 msgstr "no hay valor de direccin"
 
-#: src/readelf.c:5899 src/readelf.c:6106 src/readelf.c:6269 src/readelf.c:9777
+#: src/readelf.c:5900 src/readelf.c:6107 src/readelf.c:6270 src/readelf.c:9778
 #, c-format
 msgid "unsupported segment size"
 msgstr ""
 
-#: src/readelf.c:5952
+#: src/readelf.c:5953
 #, c-format
 msgid "cannot get .debug_aranges content: %s"
 msgstr "no se ha podido obtener contenido de .debug_aranges: %s"
 
-#: src/readelf.c:5967
+#: src/readelf.c:5968
 #, c-format
 msgid ""
 "\n"
@@ -5456,12 +5462,12 @@ msgstr[1] ""
 "\n"
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64> contiene entradas %zu:\n"
 
-#: src/readelf.c:5998
+#: src/readelf.c:5999
 #, c-format
 msgid " [%*zu] ???\n"
 msgstr " [%*zu] ???\n"
 
-#: src/readelf.c:6000
+#: src/readelf.c:6001
 #, c-format
 msgid ""
 " [%*zu] start: %0#*<PRIx64>, length: %5<PRIu64>, CU DIE offset: %6<PRId64>\n"
@@ -5469,7 +5475,7 @@ msgstr ""
 " Inicio [%*zu]: %0#*<PRIx64>, longitud: %5<PRIu64>, compensacin CU DIE: "
 "%6<PRId64>\n"
 
-#: src/readelf.c:6038 src/readelf.c:8981
+#: src/readelf.c:6039 src/readelf.c:8982
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5478,140 +5484,140 @@ msgstr ""
 "\n"
 "Tabla en compensacin %Zu:\n"
 
-#: src/readelf.c:6042 src/readelf.c:6213 src/readelf.c:7217 src/readelf.c:8992
-#: src/readelf.c:9721
+#: src/readelf.c:6043 src/readelf.c:6214 src/readelf.c:7218 src/readelf.c:8993
+#: src/readelf.c:9722
 #, c-format
 msgid "invalid data in section [%zu] '%s'"
 msgstr "Datos invlidos en seccin [%zu] '%s'"
 
-#: src/readelf.c:6058
+#: src/readelf.c:6059
 #, fuzzy, c-format
 msgid ""
 "\n"
 " Length:        %6<PRIu64>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:6070
+#: src/readelf.c:6071
 #, fuzzy, c-format
 msgid " DWARF version: %6<PRIuFAST16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:6074
+#: src/readelf.c:6075
 #, c-format
 msgid "unsupported aranges version"
 msgstr ""
 
-#: src/readelf.c:6085
+#: src/readelf.c:6086
 #, fuzzy, c-format
 msgid " CU offset:     %6<PRIx64>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:6091
+#: src/readelf.c:6092
 #, fuzzy, c-format
 msgid " Address size:  %6<PRIu64>\n"
 msgstr " (fin de compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:6102
+#: src/readelf.c:6103
 #, fuzzy, c-format
 msgid ""
 " Segment size:  %6<PRIu64>\n"
 "\n"
 msgstr " establecer archivo a %<PRIu64>\n"
 
-#: src/readelf.c:6157
+#: src/readelf.c:6158
 #, c-format
 msgid "   %zu padding bytes\n"
 msgstr ""
 
-#: src/readelf.c:6219 src/readelf.c:9727
+#: src/readelf.c:6220 src/readelf.c:9728
 #, fuzzy, c-format
 msgid ""
 "Table at Offset 0x%<PRIx64>:\n"
 "\n"
 msgstr " (fin de compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:6274 src/readelf.c:9782
+#: src/readelf.c:6275 src/readelf.c:9783
 #, fuzzy, c-format
 msgid " Offset entries: %8<PRIu64>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:6290 src/readelf.c:9798
+#: src/readelf.c:6291 src/readelf.c:9799
 #, c-format
 msgid " Unknown CU base: "
 msgstr ""
 
-#: src/readelf.c:6292 src/readelf.c:9800
+#: src/readelf.c:6293 src/readelf.c:9801
 #, c-format
 msgid " CU [%6<PRIx64>] base: "
 msgstr ""
 
-#: src/readelf.c:6298 src/readelf.c:9806
+#: src/readelf.c:6299 src/readelf.c:9807
 #, c-format
 msgid " Not associated with a CU.\n"
 msgstr ""
 
-#: src/readelf.c:6309 src/readelf.c:9817
+#: src/readelf.c:6310 src/readelf.c:9818
 #, c-format
 msgid "too many offset entries for unit length"
 msgstr ""
 
-#: src/readelf.c:6313 src/readelf.c:9821
+#: src/readelf.c:6314 src/readelf.c:9822
 #, fuzzy, c-format
 msgid "  Offsets starting at 0x%<PRIx64>:\n"
 msgstr "  Propietario          Tamao\n"
 
-#: src/readelf.c:6365
+#: src/readelf.c:6366
 #, fuzzy, c-format
 msgid "invalid range list data"
 msgstr "datos invlidos"
 
-#: src/readelf.c:6550 src/readelf.c:10156
+#: src/readelf.c:6551 src/readelf.c:10157
 #, c-format
 msgid ""
 "   %zu padding bytes\n"
 "\n"
 msgstr ""
 
-#: src/readelf.c:6598 src/readelf.c:10205
+#: src/readelf.c:6599 src/readelf.c:10206
 #, c-format
 msgid ""
 "\n"
 " Unknown CU base: "
 msgstr ""
 
-#: src/readelf.c:6600 src/readelf.c:10207
+#: src/readelf.c:6601 src/readelf.c:10208
 #, c-format
 msgid ""
 "\n"
 " CU [%6<PRIx64>] base: "
 msgstr ""
 
-#: src/readelf.c:6609 src/readelf.c:10233 src/readelf.c:10259
+#: src/readelf.c:6610 src/readelf.c:10234 src/readelf.c:10260
 #, c-format
 msgid " [%6tx]  <INVALID DATA>\n"
 msgstr " [%6tx]  <DATOS INVLIDOS>\n"
 
-#: src/readelf.c:6634 src/readelf.c:10343
+#: src/readelf.c:6635 src/readelf.c:10344
 #, fuzzy
 msgid "base address"
 msgstr "Establecer direccin a %s\n"
 
-#: src/readelf.c:6644 src/readelf.c:10353
+#: src/readelf.c:6645 src/readelf.c:10354
 #, fuzzy, c-format
 msgid " [%6tx] empty list\n"
 msgstr " [%6tx]  lista vaca\n"
 
-#: src/readelf.c:6908
+#: src/readelf.c:6909
 #, fuzzy
 msgid "         <INVALID DATA>\n"
 msgstr "   <DATOS INVLIDOS>\n"
 
-#: src/readelf.c:7165
+#: src/readelf.c:7166
 #, fuzzy, c-format
 msgid "cannot get ELF: %s"
 msgstr "no se puede leer encabezamiento ELF: %s"
 
-#: src/readelf.c:7189
+#: src/readelf.c:7190
 #, c-format
 msgid ""
 "\n"
@@ -5621,7 +5627,7 @@ msgstr ""
 "Seccin de informacin de marco de llamada [%2zu] '%s' en compensacin "
 "%#<PRIx64>:\n"
 
-#: src/readelf.c:7239
+#: src/readelf.c:7240
 #, c-format
 msgid ""
 "\n"
@@ -5630,65 +5636,65 @@ msgstr ""
 "\n"
 " [%6tx] Terminator cero\n"
 
-#: src/readelf.c:7343 src/readelf.c:7497
+#: src/readelf.c:7344 src/readelf.c:7498
 #, c-format
 msgid "invalid augmentation length"
 msgstr "longitud de aumento invlida"
 
-#: src/readelf.c:7358
+#: src/readelf.c:7359
 msgid "FDE address encoding: "
 msgstr "Codificacin de direccin FDE:"
 
-#: src/readelf.c:7364
+#: src/readelf.c:7365
 msgid "LSDA pointer encoding: "
 msgstr "Codificacin de puntero LSDA:"
 
-#: src/readelf.c:7474
+#: src/readelf.c:7475
 #, c-format
 msgid " (offset: %#<PRIx64>)"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:7481
+#: src/readelf.c:7482
 #, c-format
 msgid " (end offset: %#<PRIx64>)"
 msgstr " (fin de compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:7518
+#: src/readelf.c:7519
 #, c-format
 msgid "   %-26sLSDA pointer: %#<PRIx64>\n"
 msgstr "Puntero   %-26sLSDA: %#<PRIx64>\n"
 
-#: src/readelf.c:7603
+#: src/readelf.c:7604
 #, fuzzy, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute code: %s"
 msgstr "No se puede obtener cdigo de atributo: %s"
 
-#: src/readelf.c:7613
+#: src/readelf.c:7614
 #, fuzzy, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute form: %s"
 msgstr "No se puede obtener forma de atributo: %s"
 
-#: src/readelf.c:7635
+#: src/readelf.c:7636
 #, fuzzy, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute '%s' (%s) value: %s"
 msgstr "No se puede obtener valor: %s"
 
-#: src/readelf.c:7965
+#: src/readelf.c:7966
 #, fuzzy, c-format
 msgid "invalid file (%<PRId64>): %s"
 msgstr "Archivo invlido"
 
-#: src/readelf.c:7969
+#: src/readelf.c:7970
 #, fuzzy, c-format
 msgid "no srcfiles for CU [%<PRIx64>]"
 msgstr " establecer archivo a %<PRIu64>\n"
 
-#: src/readelf.c:7973
+#: src/readelf.c:7974
 #, fuzzy, c-format
 msgid "couldn't get DWARF CU: %s"
 msgstr "no se puede leer encabezamiento ELF: %s"
 
-#: src/readelf.c:8295
+#: src/readelf.c:8296
 #, c-format
 msgid ""
 "\n"
@@ -5699,12 +5705,12 @@ msgstr ""
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64>:\n"
 " [Offset]\n"
 
-#: src/readelf.c:8345
+#: src/readelf.c:8346
 #, fuzzy, c-format
 msgid "cannot get next unit: %s"
 msgstr "No se puede obtener prximo DIE: %s"
 
-#: src/readelf.c:8365
+#: src/readelf.c:8366
 #, fuzzy, c-format
 msgid ""
 " Type unit at offset %<PRIu64>:\n"
@@ -5717,7 +5723,7 @@ msgstr ""
 "Tamao de direccin: %<PRIu8>, Tamao de compensacin: %<PRIu8>\n"
 " Tipo de firma: %#<PRIx64>, Tipo de compensacin: %#<PRIx64>\n"
 
-#: src/readelf.c:8377
+#: src/readelf.c:8378
 #, c-format
 msgid ""
 " Compilation unit at offset %<PRIu64>:\n"
@@ -5728,39 +5734,39 @@ msgstr ""
 " Versin: %<PRIu16>, Compensacin de seccin de abreviatura: %<PRIu64>,  "
 "Tamao de direccin: %<PRIu8>, Tamao de compensacin: %<PRIu8>\n"
 
-#: src/readelf.c:8387 src/readelf.c:8548
+#: src/readelf.c:8388 src/readelf.c:8549
 #, c-format
 msgid " Unit type: %s (%<PRIu8>)"
 msgstr ""
 
-#: src/readelf.c:8414
+#: src/readelf.c:8415
 #, c-format
 msgid "unknown version (%d) or unit type (%d)"
 msgstr ""
 
-#: src/readelf.c:8443
+#: src/readelf.c:8444
 #, c-format
 msgid "cannot get DIE offset: %s"
 msgstr "no se puede obtener DIE en compensacin: %s"
 
-#: src/readelf.c:8452
+#: src/readelf.c:8453
 #, fuzzy, c-format
 msgid "cannot get tag of DIE at offset [%<PRIx64>] in section '%s': %s"
 msgstr ""
 "no se ha podido obtener etiqueta de DIE en compensacin%<PRIu64> en seccin "
 "'%s': %s"
 
-#: src/readelf.c:8488
+#: src/readelf.c:8489
 #, c-format
 msgid "cannot get next DIE: %s\n"
 msgstr "No se puede obtener prximo DIE: %s\n"
 
-#: src/readelf.c:8496
+#: src/readelf.c:8497
 #, c-format
 msgid "cannot get next DIE: %s"
 msgstr "No se puede obtener prximo DIE: %s"
 
-#: src/readelf.c:8540
+#: src/readelf.c:8541
 #, fuzzy, c-format
 msgid ""
 " Split compilation unit at offset %<PRIu64>:\n"
@@ -5771,7 +5777,7 @@ msgstr ""
 " Versin: %<PRIu16>, Compensacin de seccin de abreviatura: %<PRIu64>,  "
 "Tamao de direccin: %<PRIu8>, Tamao de compensacin: %<PRIu8>\n"
 
-#: src/readelf.c:8592
+#: src/readelf.c:8593
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5781,13 +5787,13 @@ msgstr ""
 "\n"
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64>:\n"
 
-#: src/readelf.c:8924
+#: src/readelf.c:8925
 #, fuzzy, c-format
 msgid "unknown form: %s"
 msgstr "Forma %<PRIx64> desconocida"
 
 #. Print what we got so far.
-#: src/readelf.c:9072
+#: src/readelf.c:9073
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5818,34 +5824,34 @@ msgstr ""
 "\n"
 "Cdigos operativos:\n"
 
-#: src/readelf.c:9094
+#: src/readelf.c:9095
 #, fuzzy, c-format
 msgid "cannot handle .debug_line version: %u\n"
 msgstr "no se puede obtener versin de smbolo: %s"
 
-#: src/readelf.c:9102
+#: src/readelf.c:9103
 #, fuzzy, c-format
 msgid "cannot handle address size: %u\n"
 msgstr "no hay valor de direccin"
 
-#: src/readelf.c:9110
+#: src/readelf.c:9111
 #, fuzzy, c-format
 msgid "cannot handle segment selector size: %u\n"
 msgstr "No se puede encontrar la seccin: %s"
 
-#: src/readelf.c:9120
+#: src/readelf.c:9121
 #, c-format
 msgid "invalid data at offset %tu in section [%zu] '%s'"
 msgstr "datos invlidos en compensacin %tu en seccin [%zu] '%s'"
 
-#: src/readelf.c:9135
+#: src/readelf.c:9136
 #, c-format
 msgid "  [%*<PRIuFAST8>]  %hhu argument\n"
 msgid_plural "  [%*<PRIuFAST8>]  %hhu arguments\n"
 msgstr[0] "  [%*<PRIuFAST8>]  argumento %hhu \n"
 msgstr[1] "  [%*<PRIuFAST8>]  argumento %hhu\n"
 
-#: src/readelf.c:9146
+#: src/readelf.c:9147
 msgid ""
 "\n"
 "Directory table:"
@@ -5853,12 +5859,12 @@ msgstr ""
 "\n"
 "Tabla de Directorio:"
 
-#: src/readelf.c:9152 src/readelf.c:9229
+#: src/readelf.c:9153 src/readelf.c:9230
 #, fuzzy, c-format
 msgid "      ["
 msgstr "      %s: %s\n"
 
-#: src/readelf.c:9223
+#: src/readelf.c:9224
 #, fuzzy
 msgid ""
 "\n"
@@ -5867,7 +5873,7 @@ msgstr ""
 "\n"
 " Tabla de sitio de llamada:"
 
-#: src/readelf.c:9284
+#: src/readelf.c:9285
 #, fuzzy
 msgid " Entry Dir   Time      Size      Name"
 msgstr ""
@@ -5875,7 +5881,7 @@ msgstr ""
 "Tabla de nombre de archivo:\n"
 " Directorio de entrada   Tiempo      Tamao      Nombre"
 
-#: src/readelf.c:9330
+#: src/readelf.c:9331
 #, fuzzy
 msgid ""
 "\n"
@@ -5884,7 +5890,7 @@ msgstr ""
 "\n"
 " Declaraciones de nmero de Lnea:"
 
-#: src/readelf.c:9334
+#: src/readelf.c:9335
 msgid ""
 "\n"
 "Line number statements:"
@@ -5892,132 +5898,132 @@ msgstr ""
 "\n"
 " Declaraciones de nmero de Lnea:"
 
-#: src/readelf.c:9349
+#: src/readelf.c:9350
 #, fuzzy, c-format
 msgid "invalid maximum operations per instruction is zero"
 msgstr "longitud mnima invlida de tamao de cadena coincidente"
 
-#: src/readelf.c:9383
+#: src/readelf.c:9384
 #, fuzzy, c-format
 msgid " special opcode %u: address+%u = "
 msgstr " opcode especial %u: direccin+%u = %s, lnea%+d = %zu\n"
 
-#: src/readelf.c:9387
+#: src/readelf.c:9388
 #, fuzzy, c-format
 msgid ", op_index = %u, line%+d = %zu\n"
 msgstr ""
 " opcode especial %u: direccin+%u = %s,  op_index = %u, lnea%+d = %zu\n"
 
-#: src/readelf.c:9390
+#: src/readelf.c:9391
 #, c-format
 msgid ", line%+d = %zu\n"
 msgstr ""
 
-#: src/readelf.c:9408
+#: src/readelf.c:9409
 #, c-format
 msgid " extended opcode %u: "
 msgstr "  Cdigo operativo extendido %u: "
 
-#: src/readelf.c:9413
+#: src/readelf.c:9414
 #, fuzzy
 msgid " end of sequence"
 msgstr "Fin de secuencia"
 
-#: src/readelf.c:9431
+#: src/readelf.c:9432
 #, fuzzy, c-format
 msgid " set address to "
 msgstr "Establecer direccin a %s\n"
 
-#: src/readelf.c:9459
+#: src/readelf.c:9460
 #, fuzzy, c-format
 msgid " define new file: dir=%u, mtime=%<PRIu64>, length=%<PRIu64>, name=%s\n"
 msgstr ""
 "definir nuevo archivo: dir=%u, mtime=%<PRIu64>, longitud=%<PRIu64>, "
 "nombre=%s\n"
 
-#: src/readelf.c:9473
+#: src/readelf.c:9474
 #, c-format
 msgid " set discriminator to %u\n"
 msgstr " establecer discriminador a %u\n"
 
-#: src/readelf.c:9500
+#: src/readelf.c:9501
 #, c-format
 msgid " set inlined context %u, function name %s (0x%x)\n"
 msgstr ""
 
-#: src/readelf.c:9524
+#: src/readelf.c:9525
 #, fuzzy, c-format
 #| msgid "Also show function names"
 msgid " set function name %s (0x%x)\n"
 msgstr "Tambin mostrar nombres de funcin"
 
 #. Unknown, ignore it.
-#: src/readelf.c:9531
+#: src/readelf.c:9532
 #, fuzzy
 msgid " unknown opcode"
 msgstr "cdigo operativo desconocido "
 
 #. Takes no argument.
-#: src/readelf.c:9543
+#: src/readelf.c:9544
 msgid " copy"
 msgstr "Copiar"
 
-#: src/readelf.c:9554
+#: src/readelf.c:9555
 #, fuzzy, c-format
 msgid " advance address by %u to "
 msgstr "Direccin de avance por %u a %s\n"
 
-#: src/readelf.c:9558 src/readelf.c:9619
+#: src/readelf.c:9559 src/readelf.c:9620
 #, c-format
 msgid ", op_index to %u"
 msgstr ""
 
-#: src/readelf.c:9570
+#: src/readelf.c:9571
 #, c-format
 msgid " advance line by constant %d to %<PRId64>\n"
 msgstr " lnea de avance por la constante %d a %<PRId64>\n"
 
-#: src/readelf.c:9580
+#: src/readelf.c:9581
 #, c-format
 msgid " set file to %<PRIu64>\n"
 msgstr " establecer archivo a %<PRIu64>\n"
 
-#: src/readelf.c:9591
+#: src/readelf.c:9592
 #, c-format
 msgid " set column to %<PRIu64>\n"
 msgstr "  Establecer columna a %<PRIu64>\n"
 
-#: src/readelf.c:9598
+#: src/readelf.c:9599
 #, c-format
 msgid " set '%s' to %<PRIuFAST8>\n"
 msgstr "Establecer '%s' a %<PRIuFAST8>\n"
 
 #. Takes no argument.
-#: src/readelf.c:9604
+#: src/readelf.c:9605
 msgid " set basic block flag"
 msgstr "Establecer bandera de bloque bsico"
 
-#: src/readelf.c:9615
+#: src/readelf.c:9616
 #, fuzzy, c-format
 msgid " advance address by constant %u to "
 msgstr "Direccin de avance por constante %u a %s\n"
 
-#: src/readelf.c:9635
+#: src/readelf.c:9636
 #, fuzzy, c-format
 msgid " advance address by fixed value %u to \n"
 msgstr "direccin de avance por valor corregido %u a %s\n"
 
 #. Takes no argument.
-#: src/readelf.c:9645
+#: src/readelf.c:9646
 msgid " set prologue end flag"
 msgstr " Establecer bandera prologue_end"
 
 #. Takes no argument.
-#: src/readelf.c:9650
+#: src/readelf.c:9651
 msgid " set epilogue begin flag"
 msgstr " Establecer bandera epilogue_begin"
 
-#: src/readelf.c:9660
+#: src/readelf.c:9661
 #, c-format
 msgid " set isa to %u\n"
 msgstr " establecer isa para %u\n"
@@ -6025,95 +6031,95 @@ msgstr " establecer isa para %u\n"
 #. This is a new opcode the generator but not we know about.
 #. Read the parameters associated with it but then discard
 #. everything.  Read all the parameters for this opcode.
-#: src/readelf.c:9669
+#: src/readelf.c:9670
 #, c-format
 msgid " unknown opcode with %<PRIu8> parameter:"
 msgid_plural " unknown opcode with %<PRIu8> parameters:"
 msgstr[0] " opcdigo con parmetro %<PRIu8> desconocido:"
 msgstr[1] " opcdigo con parmetros %<PRIu8> desconocido:"
 
-#: src/readelf.c:9870
+#: src/readelf.c:9871
 #, fuzzy, c-format
 msgid "    <INVALID DATA>\n"
 msgstr "   <DATOS INVLIDOS>\n"
 
-#: src/readelf.c:9910
+#: src/readelf.c:9911
 #, fuzzy, c-format
 msgid "invalid loclists data"
 msgstr "datos invlidos"
 
-#: src/readelf.c:10380 src/readelf.c:11425
+#: src/readelf.c:10381 src/readelf.c:11426
 msgid "   <INVALID DATA>\n"
 msgstr "   <DATOS INVLIDOS>\n"
 
-#: src/readelf.c:10511
+#: src/readelf.c:10512
 #, c-format
 msgid "%*s*** non-terminated string at end of section"
 msgstr "%*s*** cadena no finalizada al final de la seccin"
 
-#: src/readelf.c:10534
+#: src/readelf.c:10535
 #, fuzzy, c-format
 msgid "%*s*** missing DW_MACINFO_start_file argument at end of section"
 msgstr "%*s*** cadena no finalizada al final de la seccin"
 
-#: src/readelf.c:10629
+#: src/readelf.c:10630
 #, fuzzy, c-format
 msgid " Offset:             0x%<PRIx64>\n"
 msgstr "  Propietario          Tamao\n"
 
-#: src/readelf.c:10641
+#: src/readelf.c:10642
 #, fuzzy, c-format
 msgid " Version:            %<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:10647 src/readelf.c:11546
+#: src/readelf.c:10648 src/readelf.c:11547
 #, c-format
 msgid "  unknown version, cannot parse section\n"
 msgstr ""
 
-#: src/readelf.c:10654
+#: src/readelf.c:10655
 #, fuzzy, c-format
 msgid " Flag:               0x%<PRIx8>"
 msgstr "  Direccin de punto de entrada:               %#<PRIx64>\n"
 
-#: src/readelf.c:10683
+#: src/readelf.c:10684
 #, fuzzy, c-format
 msgid " Offset length:      %<PRIu8>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:10691
+#: src/readelf.c:10692
 #, fuzzy, c-format
 msgid " .debug_line offset: 0x%<PRIx64>\n"
 msgstr " (fin de compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:10716
+#: src/readelf.c:10717
 #, fuzzy, c-format
 msgid "  extension opcode table, %<PRIu8> items:\n"
 msgstr " opcdigo con parmetro %<PRIu8> desconocido:"
 
-#: src/readelf.c:10723
+#: src/readelf.c:10724
 #, c-format
 msgid "    [%<PRIx8>]"
 msgstr ""
 
-#: src/readelf.c:10735
+#: src/readelf.c:10736
 #, fuzzy, c-format
 msgid " %<PRIu8> arguments:"
 msgstr "  [%*<PRIuFAST8>]  argumento %hhu \n"
 
-#: src/readelf.c:10750
+#: src/readelf.c:10751
 #, c-format
 msgid " no arguments."
 msgstr ""
 
-#: src/readelf.c:10951
+#: src/readelf.c:10952
 #, c-format
 msgid " [%5d] DIE offset: %6<PRId64>, CU DIE offset: %6<PRId64>, name: %s\n"
 msgstr ""
 " Compensacin [%5d] DIE: %6<PRId64>, Compensacin CU DIE: %6<PRId64>, "
 "nombre: %s\n"
 
-#: src/readelf.c:11006
+#: src/readelf.c:11007
 #, c-format
 msgid ""
 "\n"
@@ -6125,37 +6131,37 @@ msgstr ""
 " %*s  String\n"
 
 #. TRANS: the debugstr| prefix makes the string unique.
-#: src/readelf.c:11011
+#: src/readelf.c:11012
 msgctxt "debugstr"
 msgid "Offset"
 msgstr ""
 
-#: src/readelf.c:11021
+#: src/readelf.c:11022
 #, fuzzy, c-format
 msgid " *** error, missing string terminator\n"
 msgstr " *** error en lectura de cadenas: %s\n"
 
-#: src/readelf.c:11143
+#: src/readelf.c:11144
 #, fuzzy, c-format
 msgid " Length:        %8<PRIu64>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11145
+#: src/readelf.c:11146
 #, fuzzy, c-format
 msgid " Offset size:   %8<PRIu8>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11159
+#: src/readelf.c:11160
 #, fuzzy, c-format
 msgid " DWARF version: %8<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11168
+#: src/readelf.c:11169
 #, fuzzy, c-format
 msgid " Padding:       %8<PRIx16>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11222
+#: src/readelf.c:11223
 #, c-format
 msgid ""
 "\n"
@@ -6164,7 +6170,7 @@ msgstr ""
 "\n"
 "Seccin de tabla de bsqueda de marco de llamada [%2zu] '.eh_frame_hdr':\n"
 
-#: src/readelf.c:11324
+#: src/readelf.c:11325
 #, c-format
 msgid ""
 "\n"
@@ -6173,22 +6179,22 @@ msgstr ""
 "\n"
 "Excepcin en el manejo de la seccin de tabla [%2zu] '.gcc_except_table':\n"
 
-#: src/readelf.c:11347
+#: src/readelf.c:11348
 #, c-format
 msgid " LPStart encoding:    %#x "
 msgstr "Codificacin LPStart:    %#x "
 
-#: src/readelf.c:11359
+#: src/readelf.c:11360
 #, c-format
 msgid " TType encoding:      %#x "
 msgstr "Codificacin TType:      %#x "
 
-#: src/readelf.c:11376
+#: src/readelf.c:11377
 #, c-format
 msgid " Call site encoding:  %#x "
 msgstr "Codificacin de sitio de llamada:  %#x "
 
-#: src/readelf.c:11391
+#: src/readelf.c:11392
 msgid ""
 "\n"
 " Call site table:"
@@ -6196,7 +6202,7 @@ msgstr ""
 "\n"
 " Tabla de sitio de llamada:"
 
-#: src/readelf.c:11407
+#: src/readelf.c:11408
 #, c-format
 msgid ""
 " [%4u] Call site start:   %#<PRIx64>\n"
@@ -6209,12 +6215,12 @@ msgstr ""
 "        Landing pad:       %#<PRIx64>\n"
 "        Action:            %u\n"
 
-#: src/readelf.c:11480
+#: src/readelf.c:11481
 #, c-format
 msgid "invalid TType encoding"
 msgstr "Codificacin TType invlida"
 
-#: src/readelf.c:11507
+#: src/readelf.c:11508
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6223,42 +6229,42 @@ msgstr ""
 "\n"
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64> contiene entrada %zu:\n"
 
-#: src/readelf.c:11536
+#: src/readelf.c:11537
 #, fuzzy, c-format
 msgid " Version:         %<PRId32>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11555
+#: src/readelf.c:11556
 #, fuzzy, c-format
 msgid " CU offset:       %#<PRIx32>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11562
+#: src/readelf.c:11563
 #, fuzzy, c-format
 msgid " TU offset:       %#<PRIx32>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11569
+#: src/readelf.c:11570
 #, fuzzy, c-format
 msgid " address offset:  %#<PRIx32>\n"
 msgstr " (fin de compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11576
+#: src/readelf.c:11577
 #, fuzzy, c-format
 msgid " symbol offset:   %#<PRIx32>\n"
 msgstr " (compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11586
+#: src/readelf.c:11587
 #, fuzzy, c-format
 msgid " shortcut offset: %#<PRIx32>\n"
 msgstr " (fin de compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11594
+#: src/readelf.c:11595
 #, fuzzy, c-format
 msgid " constant offset: %#<PRIx32>\n"
 msgstr " (fin de compensacin: %#<PRIx64>)"
 
-#: src/readelf.c:11608
+#: src/readelf.c:11609
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6267,7 +6273,7 @@ msgstr ""
 "\n"
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64> contiene entrada %zu:\n"
 
-#: src/readelf.c:11633
+#: src/readelf.c:11634
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6276,7 +6282,7 @@ msgstr ""
 "\n"
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64> contiene entrada %zu:\n"
 
-#: src/readelf.c:11662
+#: src/readelf.c:11663
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6285,7 +6291,7 @@ msgstr ""
 "\n"
 "Seccin DWARF [%2zu] '%s' en compensacin %#<PRIx64> contiene entrada %zu:\n"
 
-#: src/readelf.c:11705
+#: src/readelf.c:11706
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6294,7 +6300,7 @@ msgstr ""
 "\n"
 "Tabla de smbolos invlida en compensacin %#0<PRIx64>\n"
 
-#: src/readelf.c:11790
+#: src/readelf.c:11791
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6303,28 +6309,28 @@ msgstr ""
 "\n"
 "Tabla de smbolos invlida en compensacin %#0<PRIx64>\n"
 
-#: src/readelf.c:11802
+#: src/readelf.c:11803
 #, c-format
 msgid "Language of main: %s\n"
 msgstr ""
 
-#: src/readelf.c:11803
+#: src/readelf.c:11804
 #, c-format
 msgid "Name of main: "
 msgstr ""
 
-#: src/readelf.c:11886
+#: src/readelf.c:11887
 #, c-format
 msgid "cannot get debug context descriptor: %s"
 msgstr "no se puede depurar descriptor de contexto: %s"
 
-#: src/readelf.c:12252 src/readelf.c:12872 src/readelf.c:12982
-#: src/readelf.c:13039
+#: src/readelf.c:12253 src/readelf.c:12873 src/readelf.c:12983
+#: src/readelf.c:13040
 #, c-format
 msgid "cannot convert core note data: %s"
 msgstr "no es posible convertir datos de la nota principal: %s"
 
-#: src/readelf.c:12616
+#: src/readelf.c:12617
 #, c-format
 msgid ""
 "\n"
@@ -6333,21 +6339,21 @@ msgstr ""
 "\n"
 "%*s... <repeats %u more times> ..."
 
-#: src/readelf.c:13118
+#: src/readelf.c:13119
 msgid "  Owner          Data size  Type\n"
 msgstr "  Owner          Data size  Type\n"
 
-#: src/readelf.c:13146
+#: src/readelf.c:13147
 #, c-format
 msgid "  %-13.*s  %9<PRId32>  %s\n"
 msgstr "  %-13.*s  %9<PRId32>  %s\n"
 
-#: src/readelf.c:13198
+#: src/readelf.c:13199
 #, fuzzy, c-format
 msgid "cannot get content of note: %s"
 msgstr "no se puede obtener el contenido de seccin de nota: %s"
 
-#: src/readelf.c:13231
+#: src/readelf.c:13232
 #, c-format
 msgid ""
 "\n"
@@ -6356,7 +6362,7 @@ msgstr ""
 "\n"
 "Seccin de nota [%2zu] '%s' de %<PRIu64> bytes en compensacin %#0<PRIx64>:\n"
 
-#: src/readelf.c:13254
+#: src/readelf.c:13255
 #, c-format
 msgid ""
 "\n"
@@ -6365,7 +6371,7 @@ msgstr ""
 "\n"
 "Segmento de nota de %<PRIu64> bytes en compensacin %#0<PRIx64>:\n"
 
-#: src/readelf.c:13301
+#: src/readelf.c:13302
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6374,12 +6380,12 @@ msgstr ""
 "\n"
 "Seccin [%Zu] '%s' no tiene datos para volcar.\n"
 
-#: src/readelf.c:13328 src/readelf.c:13379
+#: src/readelf.c:13329 src/readelf.c:13380
 #, fuzzy, c-format
 msgid "cannot get data for section [%zu] '%s': %s"
 msgstr "no se pueden obtener datos para seccin [%Zu] '%s': %s"
 
-#: src/readelf.c:13333
+#: src/readelf.c:13334
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6389,7 +6395,7 @@ msgstr ""
 "Volcado Hex de seccin [%Zu] '%s', %<PRIu64> bytes en compensacin "
 "%#0<PRIx64>:\n"
 
-#: src/readelf.c:13338
+#: src/readelf.c:13339
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6400,7 +6406,7 @@ msgstr ""
 "Volcado Hex de seccin [%Zu] '%s', %<PRIu64> bytes en compensacin "
 "%#0<PRIx64>:\n"
 
-#: src/readelf.c:13352
+#: src/readelf.c:13353
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6409,7 +6415,7 @@ msgstr ""
 "\n"
 "Seccin [%Zu] '%s' no tiene datos para volcar.\n"
 
-#: src/readelf.c:13384
+#: src/readelf.c:13385
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6419,7 +6425,7 @@ msgstr ""
 "Seccin de cadena [%Zu] '%s' contiene %<PRIu64> bytes en compensacin "
 "%#0<PRIx64>:\n"
 
-#: src/readelf.c:13389
+#: src/readelf.c:13390
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6430,7 +6436,7 @@ msgstr ""
 "Seccin de cadena [%Zu] '%s' contiene %<PRIu64> bytes en compensacin "
 "%#0<PRIx64>:\n"
 
-#: src/readelf.c:13437
+#: src/readelf.c:13438
 #, c-format
 msgid ""
 "\n"
@@ -6439,7 +6445,7 @@ msgstr ""
 "\n"
 "seccin [%lu] no existe"
 
-#: src/readelf.c:13467
+#: src/readelf.c:13468
 #, c-format
 msgid ""
 "\n"
@@ -6448,12 +6454,12 @@ msgstr ""
 "\n"
 "seccin '%s' no existe"
 
-#: src/readelf.c:13522
+#: src/readelf.c:13523
 #, c-format
 msgid "cannot get symbol index of archive '%s': %s"
 msgstr "no se puede obtener el ndice de smbolo de archivo '%s': %s"
 
-#: src/readelf.c:13525
+#: src/readelf.c:13526
 #, c-format
 msgid ""
 "\n"
@@ -6462,7 +6468,7 @@ msgstr ""
 "\n"
 "Archivo '%s' no tiene ndice de smbolo\n"
 
-#: src/readelf.c:13529
+#: src/readelf.c:13530
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6471,12 +6477,12 @@ msgstr ""
 "\n"
 "ndice de archivo '%s' tiene %Zu entradas:\n"
 
-#: src/readelf.c:13547
+#: src/readelf.c:13548
 #, fuzzy, c-format
 msgid "cannot extract member at offset %zu in '%s': %s"
 msgstr "no es posible extraer miembro en compensacin %Zu en '%s': %s"
 
-#: src/readelf.c:13552
+#: src/readelf.c:13553
 #, c-format
 msgid "Archive member '%s' contains:\n"
 msgstr "Miembro de archivo contiene '%s':\n"
@@ -7119,7 +7125,7 @@ msgstr "no se puede crear el encabezamiento ELF: %s"
 msgid "cannot get shdrstrndx:%s"
 msgstr "No se puede encontrar la seccin: %s"
 
-#: src/unstrip.c:243 src/unstrip.c:2085
+#: src/unstrip.c:243 src/unstrip.c:2136
 #, c-format
 msgid "cannot get ELF header: %s"
 msgstr "no se puede leer encabezamiento ELF: %s"
@@ -7139,12 +7145,12 @@ msgstr "no se puede actualizar reubicacin: %s"
 msgid "cannot copy ELF header: %s"
 msgstr "no se puede copiar encabezamiento ELF: %s"
 
-#: src/unstrip.c:264 src/unstrip.c:2103 src/unstrip.c:2146
+#: src/unstrip.c:264 src/unstrip.c:2154 src/unstrip.c:2197
 #, fuzzy, c-format
 msgid "cannot get number of program headers: %s"
 msgstr "no se pudo determinar la cantidad de encabezados de programa: %s"
 
-#: src/unstrip.c:269 src/unstrip.c:2107
+#: src/unstrip.c:269 src/unstrip.c:2158
 #, c-format
 msgid "cannot create program headers: %s"
 msgstr "No pueden crear encabezamientos de programa: %s"
@@ -7159,12 +7165,12 @@ msgstr "no puede copiar encabezamiento de programa: %s"
 msgid "cannot copy section header: %s"
 msgstr "no se puede copiar encabezamiento de seccin: %s"
 
-#: src/unstrip.c:288 src/unstrip.c:1707
+#: src/unstrip.c:288 src/unstrip.c:1748
 #, c-format
 msgid "cannot get section data: %s"
 msgstr "no se pueden obtener datos de seccin: %s"
 
-#: src/unstrip.c:290 src/unstrip.c:1709
+#: src/unstrip.c:290 src/unstrip.c:1750
 #, c-format
 msgid "cannot copy section data: %s"
 msgstr "no pueden copiar datos de seccin: %s"
@@ -7174,14 +7180,14 @@ msgstr "no pueden copiar datos de seccin: %s"
 msgid "cannot create directory '%s'"
 msgstr "no se puede crear el directorio '%s'"
 
-#: src/unstrip.c:392 src/unstrip.c:657 src/unstrip.c:691 src/unstrip.c:859
-#: src/unstrip.c:1749
+#: src/unstrip.c:392 src/unstrip.c:666 src/unstrip.c:700 src/unstrip.c:868
+#: src/unstrip.c:1790
 #, c-format
 msgid "cannot get symbol table entry: %s"
 msgstr "no se puede obtener entrada de tabla de smbolos: %s"
 
-#: src/unstrip.c:408 src/unstrip.c:660 src/unstrip.c:681 src/unstrip.c:694
-#: src/unstrip.c:1770 src/unstrip.c:1965 src/unstrip.c:1989
+#: src/unstrip.c:408 src/unstrip.c:669 src/unstrip.c:690 src/unstrip.c:703
+#: src/unstrip.c:1811 src/unstrip.c:2007 src/unstrip.c:2031
 #, c-format
 msgid "cannot update symbol table: %s"
 msgstr "no se puede actualizar tabla de smbolos: %s"
@@ -7216,153 +7222,167 @@ msgstr "no se puede obtener versin de smbolo: %s"
 msgid "unexpected section type in [%zu] with sh_link to symtab"
 msgstr "tipo de seccin inesperado en [%Zu] con sh_link para symtab"
 
-#: src/unstrip.c:848
+#: src/unstrip.c:857
 #, fuzzy, c-format
 msgid "cannot get symbol section data: %s"
 msgstr "no se pueden obtener datos de seccin: %s"
 
-#: src/unstrip.c:850
+#: src/unstrip.c:859
 #, fuzzy, c-format
 msgid "cannot get string section data: %s"
 msgstr "no se pueden obtener datos de seccin: %s"
 
-#: src/unstrip.c:867
+#: src/unstrip.c:876
 #, fuzzy, c-format
 msgid "invalid string offset in symbol [%zu]"
 msgstr "compensacin de cadena invlida en smbolo [%Zu]"
 
-#: src/unstrip.c:1025 src/unstrip.c:1433
+#: src/unstrip.c:939
+msgid "found two identical index map positions."
+msgstr ""
+
+#: src/unstrip.c:990
+msgid "section symbols in unexpected order"
+msgstr ""
+
+#: src/unstrip.c:996
+#, fuzzy
+#| msgid "Strip debugging symbols."
+msgid "found two identical symbols"
+msgstr "Descartar los smbolos de depuracin."
+
+#: src/unstrip.c:1066 src/unstrip.c:1474
 #, fuzzy, c-format
 msgid "cannot read section [%zu] name: %s"
 msgstr "no se puede leer nombre [%Zu]: %s"
 
-#: src/unstrip.c:1040
+#: src/unstrip.c:1081
 #, fuzzy, c-format
 msgid "bad sh_link for group section: %s"
 msgstr ".debug_line section invlida"
 
-#: src/unstrip.c:1046
+#: src/unstrip.c:1087
 #, fuzzy, c-format
 msgid "couldn't get shdr for group section: %s"
 msgstr "No se puede obtener encabezamiento de seccin 0th: %s"
 
-#: src/unstrip.c:1051
+#: src/unstrip.c:1092
 #, fuzzy, c-format
 msgid "bad data for group symbol section: %s"
 msgstr "no se puede obtener seccin para smbolos\n"
 
-#: src/unstrip.c:1057
+#: src/unstrip.c:1098
 #, fuzzy, c-format
 msgid "couldn't get symbol for group section: %s"
 msgstr "no se puede obtener versin de smbolo: %s"
 
-#: src/unstrip.c:1062
+#: src/unstrip.c:1103
 #, fuzzy, c-format
 msgid "bad symbol name for group section: %s"
 msgstr "No se puede obtener el encabezamiento de seccin %zu: %s"
 
-#: src/unstrip.c:1073 src/unstrip.c:1553
+#: src/unstrip.c:1114 src/unstrip.c:1594
 #, fuzzy, c-format
 msgid "cannot find matching section for [%zu] '%s'"
 msgstr "no se puede hallar seccin coincidente para [%Zu] '%s'"
 
-#: src/unstrip.c:1118 src/unstrip.c:1137 src/unstrip.c:1175
+#: src/unstrip.c:1159 src/unstrip.c:1178 src/unstrip.c:1216
 #, c-format
 msgid "cannot read '.gnu.prelink_undo' section: %s"
 msgstr "no se puede leer seccin '.gnu.prelink_undo': %s"
 
-#: src/unstrip.c:1155
+#: src/unstrip.c:1196
 #, c-format
 msgid "overflow with shnum = %zu in '%s' section"
 msgstr ""
 
-#: src/unstrip.c:1166
+#: src/unstrip.c:1207
 #, c-format
 msgid "invalid contents in '%s' section"
 msgstr "contenido invlido en seccin '%s'"
 
-#: src/unstrip.c:1337 src/unstrip.c:1353 src/unstrip.c:1633 src/unstrip.c:1924
+#: src/unstrip.c:1378 src/unstrip.c:1394 src/unstrip.c:1674 src/unstrip.c:1966
 #, c-format
 msgid "cannot add section name to string table: %s"
 msgstr "no se puede aadir nombre de seccin a tabla de cadenas: %s"
 
-#: src/unstrip.c:1362
+#: src/unstrip.c:1403
 #, c-format
 msgid "cannot update section header string table data: %s"
 msgstr ""
 "no se pueden actualizar datos de tabla de cadenas de encabezamiento de "
 "seccin: %s"
 
-#: src/unstrip.c:1391 src/unstrip.c:1395
+#: src/unstrip.c:1432 src/unstrip.c:1436
 #, c-format
 msgid "cannot get section header string table section index: %s"
 msgstr ""
 "no se puede obtener ndice de seccin de tabla de cadenas de encabezamiento "
 "de seccin: %s"
 
-#: src/unstrip.c:1399 src/unstrip.c:1403 src/unstrip.c:1648
+#: src/unstrip.c:1440 src/unstrip.c:1444 src/unstrip.c:1689
 #, c-format
 msgid "cannot get section count: %s"
 msgstr "No se puede obtener cuenta de seccin: %s"
 
-#: src/unstrip.c:1406
+#: src/unstrip.c:1447
 msgid "more sections in stripped file than debug file -- arguments reversed?"
 msgstr ""
 "ms secciones en el archivo despojado que en el archivo de depuracin -- "
 "argumentos invertidos?"
 
-#: src/unstrip.c:1410
+#: src/unstrip.c:1451
 msgid "no sections in stripped file"
 msgstr ""
 
-#: src/unstrip.c:1458 src/unstrip.c:1568
+#: src/unstrip.c:1499 src/unstrip.c:1609
 #, c-format
 msgid "cannot read section header string table: %s"
 msgstr "no se puede obtener tabla de cadenas de encabezamiento de seccin: %s"
 
-#: src/unstrip.c:1627
+#: src/unstrip.c:1668
 #, c-format
 msgid "cannot add new section: %s"
 msgstr "No se puede aadir nueva seccin: %s"
 
-#: src/unstrip.c:1757
+#: src/unstrip.c:1798
 #, fuzzy, c-format
 msgid "symbol [%zu] has invalid section index"
 msgstr "smbolo [%Zu] tiene ndice de seccin invlido"
 
-#: src/unstrip.c:1789
+#: src/unstrip.c:1830
 #, fuzzy, c-format
 msgid "group has invalid section index [%zd]"
 msgstr "smbolo [%Zu] tiene ndice de seccin invlido"
 
-#: src/unstrip.c:2064
+#: src/unstrip.c:2115
 #, c-format
 msgid "cannot read section data: %s"
 msgstr "no se puede leer la seccin de datos: %s"
 
-#: src/unstrip.c:2093
+#: src/unstrip.c:2144
 #, c-format
 msgid "cannot update ELF header: %s"
 msgstr "No se puede actualizar encabezamiento ELF: %s"
 
-#: src/unstrip.c:2117
+#: src/unstrip.c:2168
 #, c-format
 msgid "cannot update program header: %s"
 msgstr "no se puede actualizar encabezamiento de programa: %s"
 
-#: src/unstrip.c:2122 src/unstrip.c:2205
+#: src/unstrip.c:2173 src/unstrip.c:2256
 #, c-format
 msgid "cannot write output file: %s"
 msgstr "no se puede escribir al archivo de salida: %s"
 
-#: src/unstrip.c:2173
+#: src/unstrip.c:2224
 #, c-format
 msgid "DWARF data not adjusted for prelinking bias; consider prelink -u"
 msgstr ""
 "datos DWARF no se ajustan para polarizacin de pre-enlace; considere prelink "
 "-u"
 
-#: src/unstrip.c:2176
+#: src/unstrip.c:2227
 #, c-format
 msgid ""
 "DWARF data in '%s' not adjusted for prelinking bias; consider prelink -u"
@@ -7370,75 +7390,75 @@ msgstr ""
 "Datos DWARF en '%s' no se ajustan a polarizacin de pre-enlace; considere "
 "prelink -u"
 
-#: src/unstrip.c:2196 src/unstrip.c:2248 src/unstrip.c:2260 src/unstrip.c:2350
+#: src/unstrip.c:2247 src/unstrip.c:2299 src/unstrip.c:2311 src/unstrip.c:2401
 #, c-format
 msgid "cannot create ELF descriptor: %s"
 msgstr "no se puede crear un descriptor ELF: %s"
 
-#: src/unstrip.c:2234
+#: src/unstrip.c:2285
 msgid "WARNING: "
 msgstr ""
 
-#: src/unstrip.c:2236
+#: src/unstrip.c:2287
 msgid ", use --force"
 msgstr ""
 
-#: src/unstrip.c:2264
+#: src/unstrip.c:2315
 msgid "ELF header identification (e_ident) different"
 msgstr ""
 
-#: src/unstrip.c:2268
+#: src/unstrip.c:2319
 msgid "ELF header type (e_type) different"
 msgstr ""
 
-#: src/unstrip.c:2272
+#: src/unstrip.c:2323
 msgid "ELF header machine type (e_machine) different"
 msgstr ""
 
-#: src/unstrip.c:2276
+#: src/unstrip.c:2327
 msgid "stripped program header (e_phnum) smaller than unstripped"
 msgstr ""
 
-#: src/unstrip.c:2307
+#: src/unstrip.c:2358
 #, c-format
 msgid "cannot find stripped file for module '%s': %s"
 msgstr "no se puede hallar archivo obtenido para mdulo '%s': %s "
 
-#: src/unstrip.c:2311
+#: src/unstrip.c:2362
 #, c-format
 msgid "cannot open stripped file '%s' for module '%s': %s"
 msgstr "No se puede abrir el archivo '%s' obtenido para mdulo '%s': %s"
 
-#: src/unstrip.c:2326
+#: src/unstrip.c:2377
 #, c-format
 msgid "cannot find debug file for module '%s': %s"
 msgstr "no puede hallar archivo de depuracin para mdulo '%s': %su"
 
-#: src/unstrip.c:2330
+#: src/unstrip.c:2381
 #, c-format
 msgid "cannot open debug file '%s' for module '%s': %s"
 msgstr "No puede abrir archivo de depuracin '%s' para mdulo '%s': %s"
 
-#: src/unstrip.c:2343
+#: src/unstrip.c:2394
 #, c-format
 msgid "module '%s' file '%s' is not stripped"
 msgstr "No se obtuvo el archivo '%s' de mdulo '%s' "
 
-#: src/unstrip.c:2374
+#: src/unstrip.c:2425
 #, c-format
 msgid "cannot cache section addresses for module '%s': %s"
 msgstr ""
 "No puede almacenar en cache direcciones de seccin para mdulo '%s': %s"
 
-#: src/unstrip.c:2502
+#: src/unstrip.c:2553
 msgid "no matching modules found"
 msgstr "No se encontraron mdulos coincidentes"
 
-#: src/unstrip.c:2512
+#: src/unstrip.c:2563
 msgid "matched more than one module"
 msgstr "coincidi con ms de un mdulo"
 
-#: src/unstrip.c:2557
+#: src/unstrip.c:2608
 msgid ""
 "STRIPPED-FILE DEBUG-FILE\n"
 "[MODULE...]"
@@ -7446,7 +7466,7 @@ msgstr ""
 "STRIPPED-FILE DEBUG-FILE\n"
 "[MODULE...]"
 
-#: src/unstrip.c:2558
+#: src/unstrip.c:2609
 #, fuzzy
 msgid ""
 "Combine stripped files with separate symbols and debug information.\n"
diff --git a/po/ja.po b/po/ja.po
index bca8f29f..9c46da52 100644
--- a/po/ja.po
+++ b/po/ja.po
@@ -8,7 +8,7 @@ msgid ""
 msgstr ""
 "Project-Id-Version: elfutils\n"
 "Report-Msgid-Bugs-To: https://sourceware.org/bugzilla/\n"
-"POT-Creation-Date: 2023-11-03 17:36+0100\n"
+"POT-Creation-Date: 2024-03-01 10:22-0500\n"
 "PO-Revision-Date: 2009-09-20 15:32+0900\n"
 "Last-Translator: Hyu_gabaru Ryu_ichi <hyu_gabaru@yahoo.co.jp>\n"
 "Language-Team: Japanese <jp@li.org>\n"
@@ -42,7 +42,7 @@ msgid ""
 "warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n"
 msgstr ""
 
-#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12202
+#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12203
 #: src/unstrip.c:311
 #, c-format
 msgid "memory exhausted"
@@ -290,7 +290,13 @@ msgstr ""
 msgid ".debug_addr section missing"
 msgstr ".debug_addr "
 
-#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2547
+#: libdw/dwarf_error.c:105
+#, fuzzy
+#| msgid "unknown version"
+msgid "unknown section"
+msgstr ""
+
+#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2598
 msgid "Input selection options:"
 msgstr ""
 
@@ -619,7 +625,7 @@ msgstr ""
 msgid "invalid size of destination operand"
 msgstr ""
 
-#: libelf/elf_error.c:86 src/readelf.c:6758
+#: libelf/elf_error.c:86 src/readelf.c:6759
 #, c-format
 msgid "invalid encoding"
 msgstr ""
@@ -704,8 +710,8 @@ msgstr "/scn"
 msgid "invalid section header"
 msgstr ""
 
-#: libelf/elf_error.c:190 src/readelf.c:10637 src/readelf.c:11242
-#: src/readelf.c:11343 src/readelf.c:11531
+#: libelf/elf_error.c:190 src/readelf.c:10638 src/readelf.c:11243
+#: src/readelf.c:11344 src/readelf.c:11532
 #, c-format
 msgid "invalid data"
 msgstr ""
@@ -1595,7 +1601,7 @@ msgstr "--gaps   '%s' "
 
 #: src/elfcmp.c:733 src/findtextrel.c:194 src/nm.c:363 src/ranlib.c:140
 #: src/size.c:271 src/strings.c:184 src/strip.c:1040 src/strip.c:1077
-#: src/unstrip.c:2194 src/unstrip.c:2223
+#: src/unstrip.c:2245 src/unstrip.c:2274
 #, c-format
 msgid "cannot open '%s'"
 msgstr "'%s' "
@@ -3793,9 +3799,9 @@ msgstr ""
 #: src/nm.c:742 src/nm.c:1234 src/objdump.c:778 src/readelf.c:685
 #: src/readelf.c:1506 src/readelf.c:1655 src/readelf.c:1882 src/readelf.c:2123
 #: src/readelf.c:2312 src/readelf.c:2482 src/readelf.c:2604 src/readelf.c:2854
-#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3896
-#: src/readelf.c:3944 src/readelf.c:4013 src/readelf.c:12029
-#: src/readelf.c:13212 src/readelf.c:13422 src/readelf.c:13490 src/size.c:396
+#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3897
+#: src/readelf.c:3945 src/readelf.c:4014 src/readelf.c:12030
+#: src/readelf.c:13213 src/readelf.c:13423 src/readelf.c:13491 src/size.c:396
 #: src/size.c:467 src/strip.c:1093
 #, c-format
 msgid "cannot get section header string table index"
@@ -4134,11 +4140,11 @@ msgstr ": %s"
 msgid "cannot get section: %s"
 msgstr ": %s"
 
-#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13442
-#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:610
-#: src/unstrip.c:631 src/unstrip.c:671 src/unstrip.c:887 src/unstrip.c:1222
-#: src/unstrip.c:1349 src/unstrip.c:1373 src/unstrip.c:1429 src/unstrip.c:1470
-#: src/unstrip.c:1662 src/unstrip.c:1813 src/unstrip.c:1956 src/unstrip.c:2055
+#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13443
+#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:622
+#: src/unstrip.c:640 src/unstrip.c:680 src/unstrip.c:897 src/unstrip.c:1263
+#: src/unstrip.c:1390 src/unstrip.c:1414 src/unstrip.c:1470 src/unstrip.c:1511
+#: src/unstrip.c:1703 src/unstrip.c:1854 src/unstrip.c:1998 src/unstrip.c:2106
 #, c-format
 msgid "cannot get section header: %s"
 msgstr ": %s"
@@ -4148,8 +4154,8 @@ msgstr ": %s"
 msgid "cannot get section name"
 msgstr ""
 
-#: src/readelf.c:720 src/readelf.c:7176 src/readelf.c:11230 src/readelf.c:11332
-#: src/readelf.c:11516
+#: src/readelf.c:720 src/readelf.c:7177 src/readelf.c:11231 src/readelf.c:11333
+#: src/readelf.c:11517
 #, c-format
 msgid "cannot get %s content: %s"
 msgstr "%s : %s"
@@ -4497,7 +4503,7 @@ msgstr ""
 " :\n"
 "   ..."
 
-#: src/readelf.c:1519 src/unstrip.c:2114 src/unstrip.c:2156 src/unstrip.c:2163
+#: src/readelf.c:1519 src/unstrip.c:2165 src/unstrip.c:2207 src/unstrip.c:2214
 #, c-format
 msgid "cannot get program header: %s"
 msgstr ": %s"
@@ -4536,19 +4542,19 @@ msgstr "<>"
 msgid "<INVALID SECTION>"
 msgstr "<>"
 
-#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3912 src/readelf.c:4212
-#: src/readelf.c:13314 src/readelf.c:13321 src/readelf.c:13365
-#: src/readelf.c:13372
+#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3913 src/readelf.c:4213
+#: src/readelf.c:13315 src/readelf.c:13322 src/readelf.c:13366
+#: src/readelf.c:13373
 msgid "Couldn't uncompress section"
 msgstr ""
 
-#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3916
+#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3917
 #, fuzzy, c-format
 msgid "cannot get section [%zd] header: %s"
 msgstr ": %s"
 
 #: src/readelf.c:1886 src/readelf.c:2860 src/readelf.c:3146 src/readelf.c:3221
-#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5962
+#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5963
 #, fuzzy, c-format
 msgid "invalid sh_link value in section %zu"
 msgstr " .debug_line "
@@ -4852,7 +4858,7 @@ msgstr "      0  %6<PRIu32>      %5.1f%%\n"
 msgid "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 msgstr "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 
-#: src/readelf.c:3647
+#: src/readelf.c:3648
 #, fuzzy, c-format
 msgid ""
 " Average number of tests:   successful lookup: %f\n"
@@ -4861,37 +4867,37 @@ msgstr ""
 " : : %f\n"
 "                 : %f\n"
 
-#: src/readelf.c:3665 src/readelf.c:3729 src/readelf.c:3795
+#: src/readelf.c:3666 src/readelf.c:3730 src/readelf.c:3796
 #, c-format
 msgid "cannot get data for section %d: %s"
 msgstr " %d: %s"
 
-#: src/readelf.c:3673
+#: src/readelf.c:3674
 #, fuzzy, c-format
 msgid "invalid data in sysv.hash section %d"
 msgstr " [%zu] '%s' "
 
-#: src/readelf.c:3702
+#: src/readelf.c:3703
 #, fuzzy, c-format
 msgid "invalid chain in sysv.hash section %d"
 msgstr " [%zu] '%s' "
 
-#: src/readelf.c:3737
+#: src/readelf.c:3738
 #, fuzzy, c-format
 msgid "invalid data in sysv.hash64 section %d"
 msgstr " [%zu] '%s' "
 
-#: src/readelf.c:3768
+#: src/readelf.c:3769
 #, fuzzy, c-format
 msgid "invalid chain in sysv.hash64 section %d"
 msgstr " [%zu] '%s' "
 
-#: src/readelf.c:3804
+#: src/readelf.c:3805
 #, fuzzy, c-format
 msgid "invalid data in gnu.hash section %d"
 msgstr " [%zu] '%s' "
 
-#: src/readelf.c:3870
+#: src/readelf.c:3871
 #, c-format
 msgid ""
 " Symbol Bias: %u\n"
@@ -4901,7 +4907,7 @@ msgstr ""
 " : %zu   %<PRIuFAST32>%%  2"
 ": %u\n"
 
-#: src/readelf.c:3955
+#: src/readelf.c:3956
 #, c-format
 msgid ""
 "\n"
@@ -4914,7 +4920,7 @@ msgstr[0] ""
 " %3$#0<PRIx64>  [%1$2zu] '%2$s'  "
 "%4$d :\n"
 
-#: src/readelf.c:3969
+#: src/readelf.c:3970
 msgid ""
 "       Library                       Time Stamp          Checksum Version "
 "Flags"
@@ -4922,7 +4928,7 @@ msgstr ""
 "                                "
 " "
 
-#: src/readelf.c:4029
+#: src/readelf.c:4030
 #, c-format
 msgid ""
 "\n"
@@ -4933,107 +4939,107 @@ msgstr ""
 " %4$#0<PRIx64>  %3$<PRIu64>  "
 "[%1$2zu] '%2$s':\n"
 
-#: src/readelf.c:4046
+#: src/readelf.c:4047
 msgid "  Owner          Size\n"
 msgstr "           \n"
 
-#: src/readelf.c:4070
+#: src/readelf.c:4071
 #, c-format
 msgid "  %-13s  %4<PRIu32>\n"
 msgstr "  %-13s  %4<PRIu32>\n"
 
 #. Unknown subsection, print and skip.
-#: src/readelf.c:4109
+#: src/readelf.c:4110
 #, c-format
 msgid "    %-4u %12<PRIu32>\n"
 msgstr "    %-4u %12<PRIu32>\n"
 
 #. Tag_File
-#: src/readelf.c:4114
+#: src/readelf.c:4115
 #, c-format
 msgid "    File: %11<PRIu32>\n"
 msgstr "    : %11<PRIu32>\n"
 
-#: src/readelf.c:4164
+#: src/readelf.c:4165
 #, c-format
 msgid "      %s: %<PRId64>, %s\n"
 msgstr "      %s: %<PRId64>%s\n"
 
-#: src/readelf.c:4167
+#: src/readelf.c:4168
 #, c-format
 msgid "      %s: %<PRId64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:4170
+#: src/readelf.c:4171
 #, c-format
 msgid "      %s: %s\n"
 msgstr "      %s: %s\n"
 
-#: src/readelf.c:4180
+#: src/readelf.c:4181
 #, c-format
 msgid "      %u: %<PRId64>\n"
 msgstr "      %u: %<PRId64>\n"
 
-#: src/readelf.c:4183
+#: src/readelf.c:4184
 #, c-format
 msgid "      %u: %s\n"
 msgstr "      %u: %s\n"
 
-#: src/readelf.c:4221
+#: src/readelf.c:4222
 #, fuzzy
 #| msgid "couldn't get shdr for group section: %s"
 msgid "Couldn't get data from section"
 msgstr " shdr : %s"
 
-#: src/readelf.c:4286
+#: src/readelf.c:4287
 msgid "sprintf failure"
 msgstr ""
 
-#: src/readelf.c:4770
+#: src/readelf.c:4771
 msgid "empty block"
 msgstr ""
 
-#: src/readelf.c:4773
+#: src/readelf.c:4774
 #, c-format
 msgid "%zu byte block:"
 msgstr "%zu :"
 
-#: src/readelf.c:5251
+#: src/readelf.c:5252
 #, fuzzy, c-format
 msgid "%*s[%2<PRIuMAX>] %s  <TRUNCATED>\n"
 msgstr "%*s[%4<PRIuMAX>] %s  <TRUNCATED>\n"
 
-#: src/readelf.c:5423
+#: src/readelf.c:5424
 #, c-format
 msgid "%s %#<PRIx64> used with different address sizes"
 msgstr ""
 
-#: src/readelf.c:5430
+#: src/readelf.c:5431
 #, c-format
 msgid "%s %#<PRIx64> used with different offset sizes"
 msgstr ""
 
-#: src/readelf.c:5437
+#: src/readelf.c:5438
 #, c-format
 msgid "%s %#<PRIx64> used with different base addresses"
 msgstr ""
 
-#: src/readelf.c:5444
+#: src/readelf.c:5445
 #, c-format
 msgid "%s %#<PRIx64> used with different attribute %s and %s"
 msgstr ""
 
-#: src/readelf.c:5544
+#: src/readelf.c:5545
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE IN REST OF SECTION>\n"
 msgstr ""
 
-#: src/readelf.c:5552
+#: src/readelf.c:5553
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE> ... %<PRIu64> bytes ...\n"
 msgstr ""
 
-#: src/readelf.c:5658
+#: src/readelf.c:5659
 #, c-format
 msgid ""
 "\n"
@@ -5044,7 +5050,7 @@ msgstr ""
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s':\n"
 " [ ]\n"
 
-#: src/readelf.c:5666
+#: src/readelf.c:5667
 #, c-format
 msgid ""
 "\n"
@@ -5053,20 +5059,20 @@ msgstr ""
 "\n"
 " %<PRIu64> :\n"
 
-#: src/readelf.c:5679
+#: src/readelf.c:5680
 #, c-format
 msgid " *** error while reading abbreviation: %s\n"
 msgstr " *** : %s\n"
 
-#: src/readelf.c:5695
+#: src/readelf.c:5696
 #, c-format
 msgid " [%5u] offset: %<PRId64>, children: %s, tag: %s\n"
 msgstr " [%5u] : %<PRId64>: %s: %s\n"
 
-#: src/readelf.c:5732 src/readelf.c:6025 src/readelf.c:6196 src/readelf.c:6567
-#: src/readelf.c:7193 src/readelf.c:8962 src/readelf.c:9704 src/readelf.c:10172
-#: src/readelf.c:10427 src/readelf.c:10589 src/readelf.c:10970
-#: src/readelf.c:11041
+#: src/readelf.c:5733 src/readelf.c:6026 src/readelf.c:6197 src/readelf.c:6568
+#: src/readelf.c:7194 src/readelf.c:8963 src/readelf.c:9705 src/readelf.c:10173
+#: src/readelf.c:10428 src/readelf.c:10590 src/readelf.c:10971
+#: src/readelf.c:11042
 #, c-format
 msgid ""
 "\n"
@@ -5075,47 +5081,47 @@ msgstr ""
 "\n"
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s':\n"
 
-#: src/readelf.c:5835 src/readelf.c:5859 src/readelf.c:6232 src/readelf.c:9740
+#: src/readelf.c:5836 src/readelf.c:5860 src/readelf.c:6233 src/readelf.c:9741
 #, fuzzy, c-format
 msgid " Length:         %8<PRIu64>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:5837 src/readelf.c:5874 src/readelf.c:6245 src/readelf.c:9753
+#: src/readelf.c:5838 src/readelf.c:5875 src/readelf.c:6246 src/readelf.c:9754
 #, fuzzy, c-format
 msgid " DWARF version:  %8<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:5838 src/readelf.c:5883 src/readelf.c:6254 src/readelf.c:9762
+#: src/readelf.c:5839 src/readelf.c:5884 src/readelf.c:6255 src/readelf.c:9763
 #, fuzzy, c-format
 msgid " Address size:   %8<PRIu64>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:5840 src/readelf.c:5893 src/readelf.c:6264 src/readelf.c:9772
+#: src/readelf.c:5841 src/readelf.c:5894 src/readelf.c:6265 src/readelf.c:9773
 #, fuzzy, c-format
 msgid " Segment size:   %8<PRIu64>\n"
 msgstr "  %<PRIu64> \n"
 
-#: src/readelf.c:5878 src/readelf.c:6249 src/readelf.c:9757 src/readelf.c:11163
+#: src/readelf.c:5879 src/readelf.c:6250 src/readelf.c:9758 src/readelf.c:11164
 #, fuzzy, c-format
 msgid "Unknown version"
 msgstr ""
 
-#: src/readelf.c:5888 src/readelf.c:6095 src/readelf.c:6259 src/readelf.c:9767
+#: src/readelf.c:5889 src/readelf.c:6096 src/readelf.c:6260 src/readelf.c:9768
 #, fuzzy, c-format
 msgid "unsupported address size"
 msgstr ""
 
-#: src/readelf.c:5899 src/readelf.c:6106 src/readelf.c:6269 src/readelf.c:9777
+#: src/readelf.c:5900 src/readelf.c:6107 src/readelf.c:6270 src/readelf.c:9778
 #, c-format
 msgid "unsupported segment size"
 msgstr ""
 
-#: src/readelf.c:5952
+#: src/readelf.c:5953
 #, c-format
 msgid "cannot get .debug_aranges content: %s"
 msgstr ".debug_aragnes : %s"
 
-#: src/readelf.c:5967
+#: src/readelf.c:5968
 #, c-format
 msgid ""
 "\n"
@@ -5128,19 +5134,19 @@ msgstr[0] ""
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s'  %4$zu "
 ":\n"
 
-#: src/readelf.c:5998
+#: src/readelf.c:5999
 #, c-format
 msgid " [%*zu] ???\n"
 msgstr " [%*zu] ???\n"
 
-#: src/readelf.c:6000
+#: src/readelf.c:6001
 #, c-format
 msgid ""
 " [%*zu] start: %0#*<PRIx64>, length: %5<PRIu64>, CU DIE offset: %6<PRId64>\n"
 msgstr ""
 " [%*zu] : %0#*<PRIx64>: %5<PRIu64>CU DIE : %6<PRId64>\n"
 
-#: src/readelf.c:6038 src/readelf.c:8981
+#: src/readelf.c:6039 src/readelf.c:8982
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5149,142 +5155,142 @@ msgstr ""
 "\n"
 " %Zu :\n"
 
-#: src/readelf.c:6042 src/readelf.c:6213 src/readelf.c:7217 src/readelf.c:8992
-#: src/readelf.c:9721
+#: src/readelf.c:6043 src/readelf.c:6214 src/readelf.c:7218 src/readelf.c:8993
+#: src/readelf.c:9722
 #, c-format
 msgid "invalid data in section [%zu] '%s'"
 msgstr " [%zu] '%s' "
 
-#: src/readelf.c:6058
+#: src/readelf.c:6059
 #, fuzzy, c-format
 msgid ""
 "\n"
 " Length:        %6<PRIu64>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:6070
+#: src/readelf.c:6071
 #, fuzzy, c-format
 msgid " DWARF version: %6<PRIuFAST16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:6074
+#: src/readelf.c:6075
 #, c-format
 msgid "unsupported aranges version"
 msgstr ""
 
-#: src/readelf.c:6085
+#: src/readelf.c:6086
 #, fuzzy, c-format
 msgid " CU offset:     %6<PRIx64>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:6091
+#: src/readelf.c:6092
 #, fuzzy, c-format
 msgid " Address size:  %6<PRIu64>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:6102
+#: src/readelf.c:6103
 #, fuzzy, c-format
 msgid ""
 " Segment size:  %6<PRIu64>\n"
 "\n"
 msgstr "  %<PRIu64> \n"
 
-#: src/readelf.c:6157
+#: src/readelf.c:6158
 #, c-format
 msgid "   %zu padding bytes\n"
 msgstr ""
 
-#: src/readelf.c:6219 src/readelf.c:9727
+#: src/readelf.c:6220 src/readelf.c:9728
 #, fuzzy, c-format
 msgid ""
 "Table at Offset 0x%<PRIx64>:\n"
 "\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:6274 src/readelf.c:9782
+#: src/readelf.c:6275 src/readelf.c:9783
 #, fuzzy, c-format
 msgid " Offset entries: %8<PRIu64>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:6290 src/readelf.c:9798
+#: src/readelf.c:6291 src/readelf.c:9799
 #, c-format
 msgid " Unknown CU base: "
 msgstr ""
 
-#: src/readelf.c:6292 src/readelf.c:9800
+#: src/readelf.c:6293 src/readelf.c:9801
 #, c-format
 msgid " CU [%6<PRIx64>] base: "
 msgstr ""
 
-#: src/readelf.c:6298 src/readelf.c:9806
+#: src/readelf.c:6299 src/readelf.c:9807
 #, c-format
 msgid " Not associated with a CU.\n"
 msgstr ""
 
-#: src/readelf.c:6309 src/readelf.c:9817
+#: src/readelf.c:6310 src/readelf.c:9818
 #, c-format
 msgid "too many offset entries for unit length"
 msgstr ""
 
-#: src/readelf.c:6313 src/readelf.c:9821
+#: src/readelf.c:6314 src/readelf.c:9822
 #, fuzzy, c-format
 msgid "  Offsets starting at 0x%<PRIx64>:\n"
 msgstr "           \n"
 
-#: src/readelf.c:6365
+#: src/readelf.c:6366
 #, fuzzy, c-format
 msgid "invalid range list data"
 msgstr ""
 
-#: src/readelf.c:6550 src/readelf.c:10156
+#: src/readelf.c:6551 src/readelf.c:10157
 #, c-format
 msgid ""
 "   %zu padding bytes\n"
 "\n"
 msgstr ""
 
-#: src/readelf.c:6598 src/readelf.c:10205
+#: src/readelf.c:6599 src/readelf.c:10206
 #, c-format
 msgid ""
 "\n"
 " Unknown CU base: "
 msgstr ""
 
-#: src/readelf.c:6600 src/readelf.c:10207
+#: src/readelf.c:6601 src/readelf.c:10208
 #, c-format
 msgid ""
 "\n"
 " CU [%6<PRIx64>] base: "
 msgstr ""
 
-#: src/readelf.c:6609 src/readelf.c:10233 src/readelf.c:10259
+#: src/readelf.c:6610 src/readelf.c:10234 src/readelf.c:10260
 #, c-format
 msgid " [%6tx]  <INVALID DATA>\n"
 msgstr " [%6tx]  <>\n"
 
-#: src/readelf.c:6634 src/readelf.c:10343
+#: src/readelf.c:6635 src/readelf.c:10344
 #, fuzzy
 msgid "base address"
 msgstr " %s \n"
 
-#: src/readelf.c:6644 src/readelf.c:10353
+#: src/readelf.c:6645 src/readelf.c:10354
 #, fuzzy, c-format
 msgid " [%6tx] empty list\n"
 msgstr ""
 "\n"
 " [%6tx] \n"
 
-#: src/readelf.c:6908
+#: src/readelf.c:6909
 #, fuzzy
 msgid "         <INVALID DATA>\n"
 msgstr " [%6tx]  <>\n"
 
-#: src/readelf.c:7165
+#: src/readelf.c:7166
 #, fuzzy, c-format
 msgid "cannot get ELF: %s"
 msgstr " DIE : %s"
 
-#: src/readelf.c:7189
+#: src/readelf.c:7190
 #, c-format
 msgid ""
 "\n"
@@ -5293,7 +5299,7 @@ msgstr ""
 "\n"
 " %3$#<PRIx64>   [%1$2zu] '%2$s':\n"
 
-#: src/readelf.c:7239
+#: src/readelf.c:7240
 #, c-format
 msgid ""
 "\n"
@@ -5302,65 +5308,65 @@ msgstr ""
 "\n"
 " [%6tx] \n"
 
-#: src/readelf.c:7343 src/readelf.c:7497
+#: src/readelf.c:7344 src/readelf.c:7498
 #, fuzzy, c-format
 msgid "invalid augmentation length"
 msgstr ""
 
-#: src/readelf.c:7358
+#: src/readelf.c:7359
 msgid "FDE address encoding: "
 msgstr "FDE "
 
-#: src/readelf.c:7364
+#: src/readelf.c:7365
 msgid "LSDA pointer encoding: "
 msgstr "LSDA :"
 
-#: src/readelf.c:7474
+#: src/readelf.c:7475
 #, c-format
 msgid " (offset: %#<PRIx64>)"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:7481
+#: src/readelf.c:7482
 #, c-format
 msgid " (end offset: %#<PRIx64>)"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:7518
+#: src/readelf.c:7519
 #, c-format
 msgid "   %-26sLSDA pointer: %#<PRIx64>\n"
 msgstr "   %-26sLSDA : %#<PRIx64>\n"
 
-#: src/readelf.c:7603
+#: src/readelf.c:7604
 #, fuzzy, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute code: %s"
 msgstr ": %s"
 
-#: src/readelf.c:7613
+#: src/readelf.c:7614
 #, fuzzy, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute form: %s"
 msgstr ": %s"
 
-#: src/readelf.c:7635
+#: src/readelf.c:7636
 #, fuzzy, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute '%s' (%s) value: %s"
 msgstr ": %s"
 
-#: src/readelf.c:7965
+#: src/readelf.c:7966
 #, fuzzy, c-format
 msgid "invalid file (%<PRId64>): %s"
 msgstr ""
 
-#: src/readelf.c:7969
+#: src/readelf.c:7970
 #, fuzzy, c-format
 msgid "no srcfiles for CU [%<PRIx64>]"
 msgstr "  %<PRIu64> \n"
 
-#: src/readelf.c:7973
+#: src/readelf.c:7974
 #, fuzzy, c-format
 msgid "couldn't get DWARF CU: %s"
 msgstr " DIE : %s"
 
-#: src/readelf.c:8295
+#: src/readelf.c:8296
 #, c-format
 msgid ""
 "\n"
@@ -5371,12 +5377,12 @@ msgstr ""
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s':\n"
 " []\n"
 
-#: src/readelf.c:8345
+#: src/readelf.c:8346
 #, fuzzy, c-format
 msgid "cannot get next unit: %s"
 msgstr " DIE : %s"
 
-#: src/readelf.c:8365
+#: src/readelf.c:8366
 #, fuzzy, c-format
 msgid ""
 " Type unit at offset %<PRIu64>:\n"
@@ -5388,7 +5394,7 @@ msgstr ""
 " : %2$<PRIu16>: %3$<PRIu64>"
 ": %4$<PRIu8>: %5$<PRIu8>\n"
 
-#: src/readelf.c:8377
+#: src/readelf.c:8378
 #, c-format
 msgid ""
 " Compilation unit at offset %<PRIu64>:\n"
@@ -5399,39 +5405,39 @@ msgstr ""
 " : %2$<PRIu16>: %3$<PRIu64>"
 ": %4$<PRIu8>: %5$<PRIu8>\n"
 
-#: src/readelf.c:8387 src/readelf.c:8548
+#: src/readelf.c:8388 src/readelf.c:8549
 #, c-format
 msgid " Unit type: %s (%<PRIu8>)"
 msgstr ""
 
-#: src/readelf.c:8414
+#: src/readelf.c:8415
 #, c-format
 msgid "unknown version (%d) or unit type (%d)"
 msgstr ""
 
-#: src/readelf.c:8443
+#: src/readelf.c:8444
 #, c-format
 msgid "cannot get DIE offset: %s"
 msgstr "DIE : %s"
 
-#: src/readelf.c:8452
+#: src/readelf.c:8453
 #, fuzzy, c-format
 msgid "cannot get tag of DIE at offset [%<PRIx64>] in section '%s': %s"
 msgstr ""
 " '%2$s'  %1$<PRIu64>  DIE : "
 "%3$s"
 
-#: src/readelf.c:8488
+#: src/readelf.c:8489
 #, c-format
 msgid "cannot get next DIE: %s\n"
 msgstr " DIE : %s\n"
 
-#: src/readelf.c:8496
+#: src/readelf.c:8497
 #, c-format
 msgid "cannot get next DIE: %s"
 msgstr " DIE : %s"
 
-#: src/readelf.c:8540
+#: src/readelf.c:8541
 #, fuzzy, c-format
 msgid ""
 " Split compilation unit at offset %<PRIu64>:\n"
@@ -5442,7 +5448,7 @@ msgstr ""
 " : %2$<PRIu16>: %3$<PRIu64>"
 ": %4$<PRIu8>: %5$<PRIu8>\n"
 
-#: src/readelf.c:8592
+#: src/readelf.c:8593
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5452,13 +5458,13 @@ msgstr ""
 "\n"
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s':\n"
 
-#: src/readelf.c:8924
+#: src/readelf.c:8925
 #, fuzzy, c-format
 msgid "unknown form: %s"
 msgstr " %<PRIx64>"
 
 #. Print what we got so far.
-#: src/readelf.c:9072
+#: src/readelf.c:9073
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5488,33 +5494,33 @@ msgstr ""
 "\n"
 ":\n"
 
-#: src/readelf.c:9094
+#: src/readelf.c:9095
 #, c-format
 msgid "cannot handle .debug_line version: %u\n"
 msgstr ".debug_line : %u\n"
 
-#: src/readelf.c:9102
+#: src/readelf.c:9103
 #, c-format
 msgid "cannot handle address size: %u\n"
 msgstr ": %u\n"
 
-#: src/readelf.c:9110
+#: src/readelf.c:9111
 #, c-format
 msgid "cannot handle segment selector size: %u\n"
 msgstr ": %u\n"
 
-#: src/readelf.c:9120
+#: src/readelf.c:9121
 #, c-format
 msgid "invalid data at offset %tu in section [%zu] '%s'"
 msgstr " [%2$zu] '%3$s'  %1$tu "
 
-#: src/readelf.c:9135
+#: src/readelf.c:9136
 #, c-format
 msgid "  [%*<PRIuFAST8>]  %hhu argument\n"
 msgid_plural "  [%*<PRIuFAST8>]  %hhu arguments\n"
 msgstr[0] "  [%*<PRIuFAST8>]  %hhu \n"
 
-#: src/readelf.c:9146
+#: src/readelf.c:9147
 msgid ""
 "\n"
 "Directory table:"
@@ -5522,12 +5528,12 @@ msgstr ""
 "\n"
 ":"
 
-#: src/readelf.c:9152 src/readelf.c:9229
+#: src/readelf.c:9153 src/readelf.c:9230
 #, fuzzy, c-format
 msgid "      ["
 msgstr "      %s: %s\n"
 
-#: src/readelf.c:9223
+#: src/readelf.c:9224
 #, fuzzy
 msgid ""
 "\n"
@@ -5536,7 +5542,7 @@ msgstr ""
 "\n"
 " :"
 
-#: src/readelf.c:9284
+#: src/readelf.c:9285
 #, fuzzy
 msgid " Entry Dir   Time      Size      Name"
 msgstr ""
@@ -5544,7 +5550,7 @@ msgstr ""
 ":\n"
 " Entry Dir            "
 
-#: src/readelf.c:9330
+#: src/readelf.c:9331
 #, fuzzy
 msgid ""
 "\n"
@@ -5553,7 +5559,7 @@ msgstr ""
 "\n"
 "      :"
 
-#: src/readelf.c:9334
+#: src/readelf.c:9335
 msgid ""
 "\n"
 "Line number statements:"
@@ -5561,129 +5567,129 @@ msgstr ""
 "\n"
 "      :"
 
-#: src/readelf.c:9349
+#: src/readelf.c:9350
 #, c-format
 msgid "invalid maximum operations per instruction is zero"
 msgstr ""
 
-#: src/readelf.c:9383
+#: src/readelf.c:9384
 #, fuzzy, c-format
 msgid " special opcode %u: address+%u = "
 msgstr "  %u: +%u = %s, %+d = %zu\n"
 
-#: src/readelf.c:9387
+#: src/readelf.c:9388
 #, fuzzy, c-format
 msgid ", op_index = %u, line%+d = %zu\n"
 msgstr "  %u: +%u = %s, %+d = %zu\n"
 
-#: src/readelf.c:9390
+#: src/readelf.c:9391
 #, c-format
 msgid ", line%+d = %zu\n"
 msgstr ""
 
-#: src/readelf.c:9408
+#: src/readelf.c:9409
 #, c-format
 msgid " extended opcode %u: "
 msgstr "  %u: "
 
-#: src/readelf.c:9413
+#: src/readelf.c:9414
 #, fuzzy
 msgid " end of sequence"
 msgstr ""
 
-#: src/readelf.c:9431
+#: src/readelf.c:9432
 #, fuzzy, c-format
 msgid " set address to "
 msgstr " %s \n"
 
-#: src/readelf.c:9459
+#: src/readelf.c:9460
 #, fuzzy, c-format
 msgid " define new file: dir=%u, mtime=%<PRIu64>, length=%<PRIu64>, name=%s\n"
 msgstr ""
 ": dir=%umtime=%<PRIu64>h=%<PRIu64>=%s\n"
 
-#: src/readelf.c:9473
+#: src/readelf.c:9474
 #, fuzzy, c-format
 msgid " set discriminator to %u\n"
 msgstr " %<PRIu64> \n"
 
-#: src/readelf.c:9500
+#: src/readelf.c:9501
 #, c-format
 msgid " set inlined context %u, function name %s (0x%x)\n"
 msgstr ""
 
-#: src/readelf.c:9524
+#: src/readelf.c:9525
 #, fuzzy, c-format
 #| msgid "Also show function names"
 msgid " set function name %s (0x%x)\n"
 msgstr ""
 
 #. Unknown, ignore it.
-#: src/readelf.c:9531
+#: src/readelf.c:9532
 msgid " unknown opcode"
 msgstr ""
 
 #. Takes no argument.
-#: src/readelf.c:9543
+#: src/readelf.c:9544
 msgid " copy"
 msgstr ""
 
-#: src/readelf.c:9554
+#: src/readelf.c:9555
 #, fuzzy, c-format
 msgid " advance address by %u to "
 msgstr " %u  %s \n"
 
-#: src/readelf.c:9558 src/readelf.c:9619
+#: src/readelf.c:9559 src/readelf.c:9620
 #, c-format
 msgid ", op_index to %u"
 msgstr ""
 
-#: src/readelf.c:9570
+#: src/readelf.c:9571
 #, c-format
 msgid " advance line by constant %d to %<PRId64>\n"
 msgstr " %d  %<PRId64> \n"
 
-#: src/readelf.c:9580
+#: src/readelf.c:9581
 #, c-format
 msgid " set file to %<PRIu64>\n"
 msgstr "  %<PRIu64> \n"
 
-#: src/readelf.c:9591
+#: src/readelf.c:9592
 #, c-format
 msgid " set column to %<PRIu64>\n"
 msgstr " %<PRIu64> \n"
 
-#: src/readelf.c:9598
+#: src/readelf.c:9599
 #, c-format
 msgid " set '%s' to %<PRIuFAST8>\n"
 msgstr " '%s'  %<PRIuFAST8> \n"
 
 #. Takes no argument.
-#: src/readelf.c:9604
+#: src/readelf.c:9605
 msgid " set basic block flag"
 msgstr ""
 
-#: src/readelf.c:9615
+#: src/readelf.c:9616
 #, fuzzy, c-format
 msgid " advance address by constant %u to "
 msgstr " %u  %s \n"
 
-#: src/readelf.c:9635
+#: src/readelf.c:9636
 #, fuzzy, c-format
 msgid " advance address by fixed value %u to \n"
 msgstr " %u  %s \n"
 
 #. Takes no argument.
-#: src/readelf.c:9645
+#: src/readelf.c:9646
 msgid " set prologue end flag"
 msgstr ""
 
 #. Takes no argument.
-#: src/readelf.c:9650
+#: src/readelf.c:9651
 msgid " set epilogue begin flag"
 msgstr ""
 
-#: src/readelf.c:9660
+#: src/readelf.c:9661
 #, fuzzy, c-format
 msgid " set isa to %u\n"
 msgstr "  %<PRIu64> \n"
@@ -5691,88 +5697,88 @@ msgstr "  %<PRIu64> \n"
 #. This is a new opcode the generator but not we know about.
 #. Read the parameters associated with it but then discard
 #. everything.  Read all the parameters for this opcode.
-#: src/readelf.c:9669
+#: src/readelf.c:9670
 #, c-format
 msgid " unknown opcode with %<PRIu8> parameter:"
 msgid_plural " unknown opcode with %<PRIu8> parameters:"
 msgstr[0] " %<PRIu8> :"
 
-#: src/readelf.c:9870
+#: src/readelf.c:9871
 #, fuzzy, c-format
 msgid "    <INVALID DATA>\n"
 msgstr " [%6tx]  <>\n"
 
-#: src/readelf.c:9910
+#: src/readelf.c:9911
 #, fuzzy, c-format
 msgid "invalid loclists data"
 msgstr ""
 
-#: src/readelf.c:10380 src/readelf.c:11425
+#: src/readelf.c:10381 src/readelf.c:11426
 #, fuzzy
 msgid "   <INVALID DATA>\n"
 msgstr " [%6tx]  <>\n"
 
-#: src/readelf.c:10511
+#: src/readelf.c:10512
 #, c-format
 msgid "%*s*** non-terminated string at end of section"
 msgstr "%*s*** "
 
-#: src/readelf.c:10534
+#: src/readelf.c:10535
 #, fuzzy, c-format
 msgid "%*s*** missing DW_MACINFO_start_file argument at end of section"
 msgstr "%*s*** "
 
-#: src/readelf.c:10629
+#: src/readelf.c:10630
 #, fuzzy, c-format
 msgid " Offset:             0x%<PRIx64>\n"
 msgstr "           \n"
 
-#: src/readelf.c:10641
+#: src/readelf.c:10642
 #, fuzzy, c-format
 msgid " Version:            %<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:10647 src/readelf.c:11546
+#: src/readelf.c:10648 src/readelf.c:11547
 #, c-format
 msgid "  unknown version, cannot parse section\n"
 msgstr ""
 
-#: src/readelf.c:10654
+#: src/readelf.c:10655
 #, fuzzy, c-format
 msgid " Flag:               0x%<PRIx8>"
 msgstr "       :               %#<PRIx64>\n"
 
-#: src/readelf.c:10683
+#: src/readelf.c:10684
 #, fuzzy, c-format
 msgid " Offset length:      %<PRIu8>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:10691
+#: src/readelf.c:10692
 #, fuzzy, c-format
 msgid " .debug_line offset: 0x%<PRIx64>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:10716
+#: src/readelf.c:10717
 #, fuzzy, c-format
 msgid "  extension opcode table, %<PRIu8> items:\n"
 msgstr " %<PRIu8> :"
 
-#: src/readelf.c:10723
+#: src/readelf.c:10724
 #, c-format
 msgid "    [%<PRIx8>]"
 msgstr ""
 
-#: src/readelf.c:10735
+#: src/readelf.c:10736
 #, fuzzy, c-format
 msgid " %<PRIu8> arguments:"
 msgstr "  [%*<PRIuFAST8>]  %hhu \n"
 
-#: src/readelf.c:10750
+#: src/readelf.c:10751
 #, c-format
 msgid " no arguments."
 msgstr ""
 
-#: src/readelf.c:10951
+#: src/readelf.c:10952
 #, c-format
 msgid " [%5d] DIE offset: %6<PRId64>, CU DIE offset: %6<PRId64>, name: %s\n"
 msgstr ""
@@ -5780,7 +5786,7 @@ msgstr ""
 
 # # " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s':\n"
 # # " %4$*s  \n" ?  fuzzy
-#: src/readelf.c:11006
+#: src/readelf.c:11007
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5792,37 +5798,37 @@ msgstr ""
 " %4$*s  \n"
 
 #. TRANS: the debugstr| prefix makes the string unique.
-#: src/readelf.c:11011
+#: src/readelf.c:11012
 msgctxt "debugstr"
 msgid "Offset"
 msgstr ""
 
-#: src/readelf.c:11021
+#: src/readelf.c:11022
 #, fuzzy, c-format
 msgid " *** error, missing string terminator\n"
 msgstr " *** : %s\n"
 
-#: src/readelf.c:11143
+#: src/readelf.c:11144
 #, fuzzy, c-format
 msgid " Length:        %8<PRIu64>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11145
+#: src/readelf.c:11146
 #, fuzzy, c-format
 msgid " Offset size:   %8<PRIu8>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11159
+#: src/readelf.c:11160
 #, fuzzy, c-format
 msgid " DWARF version: %8<PRIu16>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11168
+#: src/readelf.c:11169
 #, fuzzy, c-format
 msgid " Padding:       %8<PRIx16>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11222
+#: src/readelf.c:11223
 #, c-format
 msgid ""
 "\n"
@@ -5831,7 +5837,7 @@ msgstr ""
 "\n"
 " [%2zu] '.eh_frame_hdr':\n"
 
-#: src/readelf.c:11324
+#: src/readelf.c:11325
 #, c-format
 msgid ""
 "\n"
@@ -5840,22 +5846,22 @@ msgstr ""
 "\n"
 " [%2zu] '.gcc_except_table':\n"
 
-#: src/readelf.c:11347
+#: src/readelf.c:11348
 #, c-format
 msgid " LPStart encoding:    %#x "
 msgstr " LPStart :    %#x "
 
-#: src/readelf.c:11359
+#: src/readelf.c:11360
 #, c-format
 msgid " TType encoding:      %#x "
 msgstr "TType :       %#x "
 
-#: src/readelf.c:11376
+#: src/readelf.c:11377
 #, c-format
 msgid " Call site encoding:  %#x "
 msgstr ": %#x "
 
-#: src/readelf.c:11391
+#: src/readelf.c:11392
 msgid ""
 "\n"
 " Call site table:"
@@ -5863,7 +5869,7 @@ msgstr ""
 "\n"
 " :"
 
-#: src/readelf.c:11407
+#: src/readelf.c:11408
 #, c-format
 msgid ""
 " [%4u] Call site start:   %#<PRIx64>\n"
@@ -5876,12 +5882,12 @@ msgstr ""
 "        :           %#<PRIx64>\n"
 "        :               %u\n"
 
-#: src/readelf.c:11480
+#: src/readelf.c:11481
 #, c-format
 msgid "invalid TType encoding"
 msgstr " TType "
 
-#: src/readelf.c:11507
+#: src/readelf.c:11508
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5891,42 +5897,42 @@ msgstr ""
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s'  %4$zu "
 ":\n"
 
-#: src/readelf.c:11536
+#: src/readelf.c:11537
 #, fuzzy, c-format
 msgid " Version:         %<PRId32>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:11555
+#: src/readelf.c:11556
 #, fuzzy, c-format
 msgid " CU offset:       %#<PRIx32>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11562
+#: src/readelf.c:11563
 #, fuzzy, c-format
 msgid " TU offset:       %#<PRIx32>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11569
+#: src/readelf.c:11570
 #, fuzzy, c-format
 msgid " address offset:  %#<PRIx32>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11576
+#: src/readelf.c:11577
 #, fuzzy, c-format
 msgid " symbol offset:   %#<PRIx32>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11586
+#: src/readelf.c:11587
 #, fuzzy, c-format
 msgid " shortcut offset: %#<PRIx32>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11594
+#: src/readelf.c:11595
 #, fuzzy, c-format
 msgid " constant offset: %#<PRIx32>\n"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:11608
+#: src/readelf.c:11609
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5936,7 +5942,7 @@ msgstr ""
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s'  %4$zu "
 ":\n"
 
-#: src/readelf.c:11633
+#: src/readelf.c:11634
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5946,7 +5952,7 @@ msgstr ""
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s'  %4$zu "
 ":\n"
 
-#: src/readelf.c:11662
+#: src/readelf.c:11663
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5956,7 +5962,7 @@ msgstr ""
 " %3$#<PRIx64>  DWARF  [%1$2zu] '%2$s'  %4$zu "
 ":\n"
 
-#: src/readelf.c:11705
+#: src/readelf.c:11706
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5965,7 +5971,7 @@ msgstr ""
 "\n"
 " %#0<PRIx64> \n"
 
-#: src/readelf.c:11790
+#: src/readelf.c:11791
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -5974,28 +5980,28 @@ msgstr ""
 "\n"
 " %#0<PRIx64> \n"
 
-#: src/readelf.c:11802
+#: src/readelf.c:11803
 #, c-format
 msgid "Language of main: %s\n"
 msgstr ""
 
-#: src/readelf.c:11803
+#: src/readelf.c:11804
 #, c-format
 msgid "Name of main: "
 msgstr ""
 
-#: src/readelf.c:11886
+#: src/readelf.c:11887
 #, c-format
 msgid "cannot get debug context descriptor: %s"
 msgstr ": %s"
 
-#: src/readelf.c:12252 src/readelf.c:12872 src/readelf.c:12982
-#: src/readelf.c:13039
+#: src/readelf.c:12253 src/readelf.c:12873 src/readelf.c:12983
+#: src/readelf.c:13040
 #, c-format
 msgid "cannot convert core note data: %s"
 msgstr ": %s"
 
-#: src/readelf.c:12616
+#: src/readelf.c:12617
 #, c-format
 msgid ""
 "\n"
@@ -6004,21 +6010,21 @@ msgstr ""
 "\n"
 "%*s... < %u > ..."
 
-#: src/readelf.c:13118
+#: src/readelf.c:13119
 msgid "  Owner          Data size  Type\n"
 msgstr "           \n"
 
-#: src/readelf.c:13146
+#: src/readelf.c:13147
 #, c-format
 msgid "  %-13.*s  %9<PRId32>  %s\n"
 msgstr "  %-13.*s  %9<PRId32>  %s\n"
 
-#: src/readelf.c:13198
+#: src/readelf.c:13199
 #, c-format
 msgid "cannot get content of note: %s"
 msgstr ": %s"
 
-#: src/readelf.c:13231
+#: src/readelf.c:13232
 #, c-format
 msgid ""
 "\n"
@@ -6028,7 +6034,7 @@ msgstr ""
 " %4$#0<PRIx64>  %3$<PRIu64>  [%1$2zu] "
 "'%2$s':\n"
 
-#: src/readelf.c:13254
+#: src/readelf.c:13255
 #, c-format
 msgid ""
 "\n"
@@ -6037,7 +6043,7 @@ msgstr ""
 "\n"
 " %2$#0<PRIx64>  %1$<PRIu64> :\n"
 
-#: src/readelf.c:13301
+#: src/readelf.c:13302
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6046,12 +6052,12 @@ msgstr ""
 "\n"
 " [%Zu] '%s' \n"
 
-#: src/readelf.c:13328 src/readelf.c:13379
+#: src/readelf.c:13329 src/readelf.c:13380
 #, fuzzy, c-format
 msgid "cannot get data for section [%zu] '%s': %s"
 msgstr " [%Zu] '%s' : %s"
 
-#: src/readelf.c:13333
+#: src/readelf.c:13334
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6061,7 +6067,7 @@ msgstr ""
 " %4$#0<PRIx64>  [%1$Zu] '%2$s' 16"
 "%3$<PRIu64> :\n"
 
-#: src/readelf.c:13338
+#: src/readelf.c:13339
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6072,7 +6078,7 @@ msgstr ""
 " %4$#0<PRIx64>  [%1$Zu] '%2$s' 16"
 "%3$<PRIu64> :\n"
 
-#: src/readelf.c:13352
+#: src/readelf.c:13353
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6081,7 +6087,7 @@ msgstr ""
 "\n"
 " [%Zu] '%s' \n"
 
-#: src/readelf.c:13384
+#: src/readelf.c:13385
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6091,7 +6097,7 @@ msgstr ""
 " %4$#0<PRIx64>  [%1$Zu] '%2$s'  %3$<PRIu64> "
 ":\n"
 
-#: src/readelf.c:13389
+#: src/readelf.c:13390
 #, fuzzy, c-format
 msgid ""
 "\n"
@@ -6102,7 +6108,7 @@ msgstr ""
 " %4$#0<PRIx64>  [%1$Zu] '%2$s'  %3$<PRIu64> "
 ":\n"
 
-#: src/readelf.c:13437
+#: src/readelf.c:13438
 #, c-format
 msgid ""
 "\n"
@@ -6111,7 +6117,7 @@ msgstr ""
 "\n"
 " [%lu] "
 
-#: src/readelf.c:13467
+#: src/readelf.c:13468
 #, c-format
 msgid ""
 "\n"
@@ -6120,12 +6126,12 @@ msgstr ""
 "\n"
 " '%s' "
 
-#: src/readelf.c:13522
+#: src/readelf.c:13523
 #, c-format
 msgid "cannot get symbol index of archive '%s': %s"
 msgstr " '%s' : %s"
 
-#: src/readelf.c:13525
+#: src/readelf.c:13526
 #, c-format
 msgid ""
 "\n"
@@ -6134,7 +6140,7 @@ msgstr ""
 "\n"
 " '%s' \n"
 
-#: src/readelf.c:13529
+#: src/readelf.c:13530
 #, c-format
 msgid ""
 "\n"
@@ -6143,12 +6149,12 @@ msgstr ""
 "\n"
 " '%s'  %zu :\n"
 
-#: src/readelf.c:13547
+#: src/readelf.c:13548
 #, c-format
 msgid "cannot extract member at offset %zu in '%s': %s"
 msgstr "'%2$s'   %1$zu : %3$s"
 
-#: src/readelf.c:13552
+#: src/readelf.c:13553
 #, c-format
 msgid "Archive member '%s' contains:\n"
 msgstr " '%s' :\n"
@@ -6790,7 +6796,7 @@ msgstr "ELF : %s"
 msgid "cannot get shdrstrndx:%s"
 msgstr "shdrstrndx : %s"
 
-#: src/unstrip.c:243 src/unstrip.c:2085
+#: src/unstrip.c:243 src/unstrip.c:2136
 #, c-format
 msgid "cannot get ELF header: %s"
 msgstr "ELF : %s"
@@ -6810,12 +6816,12 @@ msgstr " zero : %s"
 msgid "cannot copy ELF header: %s"
 msgstr "ELF : %s"
 
-#: src/unstrip.c:264 src/unstrip.c:2103 src/unstrip.c:2146
+#: src/unstrip.c:264 src/unstrip.c:2154 src/unstrip.c:2197
 #, c-format
 msgid "cannot get number of program headers: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:269 src/unstrip.c:2107
+#: src/unstrip.c:269 src/unstrip.c:2158
 #, c-format
 msgid "cannot create program headers: %s"
 msgstr ": %s"
@@ -6830,12 +6836,12 @@ msgstr ": %s"
 msgid "cannot copy section header: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:288 src/unstrip.c:1707
+#: src/unstrip.c:288 src/unstrip.c:1748
 #, c-format
 msgid "cannot get section data: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:290 src/unstrip.c:1709
+#: src/unstrip.c:290 src/unstrip.c:1750
 #, c-format
 msgid "cannot copy section data: %s"
 msgstr ": %s"
@@ -6845,14 +6851,14 @@ msgstr ": %s"
 msgid "cannot create directory '%s'"
 msgstr " '%s' "
 
-#: src/unstrip.c:392 src/unstrip.c:657 src/unstrip.c:691 src/unstrip.c:859
-#: src/unstrip.c:1749
+#: src/unstrip.c:392 src/unstrip.c:666 src/unstrip.c:700 src/unstrip.c:868
+#: src/unstrip.c:1790
 #, c-format
 msgid "cannot get symbol table entry: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:408 src/unstrip.c:660 src/unstrip.c:681 src/unstrip.c:694
-#: src/unstrip.c:1770 src/unstrip.c:1965 src/unstrip.c:1989
+#: src/unstrip.c:408 src/unstrip.c:669 src/unstrip.c:690 src/unstrip.c:703
+#: src/unstrip.c:1811 src/unstrip.c:2007 src/unstrip.c:2031
 #, c-format
 msgid "cannot update symbol table: %s"
 msgstr ": %s"
@@ -6887,224 +6893,238 @@ msgstr ": %s"
 msgid "unexpected section type in [%zu] with sh_link to symtab"
 msgstr ""
 
-#: src/unstrip.c:848
+#: src/unstrip.c:857
 #, c-format
 msgid "cannot get symbol section data: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:850
+#: src/unstrip.c:859
 #, c-format
 msgid "cannot get string section data: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:867
+#: src/unstrip.c:876
 #, c-format
 msgid "invalid string offset in symbol [%zu]"
 msgstr " [%zu] "
 
-#: src/unstrip.c:1025 src/unstrip.c:1433
+#: src/unstrip.c:939
+msgid "found two identical index map positions."
+msgstr ""
+
+#: src/unstrip.c:990
+msgid "section symbols in unexpected order"
+msgstr ""
+
+#: src/unstrip.c:996
+#, fuzzy
+#| msgid "Show demangled symbols (ARG is always ignored)"
+msgid "found two identical symbols"
+msgstr "   ARG"
+
+#: src/unstrip.c:1066 src/unstrip.c:1474
 #, c-format
 msgid "cannot read section [%zu] name: %s"
 msgstr " [%zu] : %s"
 
-#: src/unstrip.c:1040
+#: src/unstrip.c:1081
 #, c-format
 msgid "bad sh_link for group section: %s"
 msgstr " sh_link : %s"
 
-#: src/unstrip.c:1046
+#: src/unstrip.c:1087
 #, c-format
 msgid "couldn't get shdr for group section: %s"
 msgstr " shdr : %s"
 
-#: src/unstrip.c:1051
+#: src/unstrip.c:1092
 #, c-format
 msgid "bad data for group symbol section: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:1057
+#: src/unstrip.c:1098
 #, c-format
 msgid "couldn't get symbol for group section: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:1062
+#: src/unstrip.c:1103
 #, c-format
 msgid "bad symbol name for group section: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:1073 src/unstrip.c:1553
+#: src/unstrip.c:1114 src/unstrip.c:1594
 #, fuzzy, c-format
 msgid "cannot find matching section for [%zu] '%s'"
 msgstr " [%zu] '%s' "
 
-#: src/unstrip.c:1118 src/unstrip.c:1137 src/unstrip.c:1175
+#: src/unstrip.c:1159 src/unstrip.c:1178 src/unstrip.c:1216
 #, c-format
 msgid "cannot read '.gnu.prelink_undo' section: %s"
 msgstr ""
 
-#: src/unstrip.c:1155
+#: src/unstrip.c:1196
 #, c-format
 msgid "overflow with shnum = %zu in '%s' section"
 msgstr ""
 
-#: src/unstrip.c:1166
+#: src/unstrip.c:1207
 #, c-format
 msgid "invalid contents in '%s' section"
 msgstr ""
 
-#: src/unstrip.c:1337 src/unstrip.c:1353 src/unstrip.c:1633 src/unstrip.c:1924
+#: src/unstrip.c:1378 src/unstrip.c:1394 src/unstrip.c:1674 src/unstrip.c:1966
 #, c-format
 msgid "cannot add section name to string table: %s"
 msgstr ""
 
-#: src/unstrip.c:1362
+#: src/unstrip.c:1403
 #, c-format
 msgid "cannot update section header string table data: %s"
 msgstr ""
 
-#: src/unstrip.c:1391 src/unstrip.c:1395
+#: src/unstrip.c:1432 src/unstrip.c:1436
 #, c-format
 msgid "cannot get section header string table section index: %s"
 msgstr ""
 
-#: src/unstrip.c:1399 src/unstrip.c:1403 src/unstrip.c:1648
+#: src/unstrip.c:1440 src/unstrip.c:1444 src/unstrip.c:1689
 #, c-format
 msgid "cannot get section count: %s"
 msgstr ""
 
-#: src/unstrip.c:1406
+#: src/unstrip.c:1447
 msgid "more sections in stripped file than debug file -- arguments reversed?"
 msgstr ""
 
-#: src/unstrip.c:1410
+#: src/unstrip.c:1451
 msgid "no sections in stripped file"
 msgstr ""
 
-#: src/unstrip.c:1458 src/unstrip.c:1568
+#: src/unstrip.c:1499 src/unstrip.c:1609
 #, c-format
 msgid "cannot read section header string table: %s"
 msgstr ""
 
-#: src/unstrip.c:1627
+#: src/unstrip.c:1668
 #, c-format
 msgid "cannot add new section: %s"
 msgstr ""
 
-#: src/unstrip.c:1757
+#: src/unstrip.c:1798
 #, c-format
 msgid "symbol [%zu] has invalid section index"
 msgstr " [%zu] "
 
-#: src/unstrip.c:1789
+#: src/unstrip.c:1830
 #, c-format
 msgid "group has invalid section index [%zd]"
 msgstr " [%zd] "
 
-#: src/unstrip.c:2064
+#: src/unstrip.c:2115
 #, c-format
 msgid "cannot read section data: %s"
 msgstr ": %s"
 
-#: src/unstrip.c:2093
+#: src/unstrip.c:2144
 #, c-format
 msgid "cannot update ELF header: %s"
 msgstr "ELF : %s"
 
-#: src/unstrip.c:2117
+#: src/unstrip.c:2168
 #, c-format
 msgid "cannot update program header: %s"
 msgstr ""
 
-#: src/unstrip.c:2122 src/unstrip.c:2205
+#: src/unstrip.c:2173 src/unstrip.c:2256
 #, c-format
 msgid "cannot write output file: %s"
 msgstr ""
 
-#: src/unstrip.c:2173
+#: src/unstrip.c:2224
 #, c-format
 msgid "DWARF data not adjusted for prelinking bias; consider prelink -u"
 msgstr ""
 
-#: src/unstrip.c:2176
+#: src/unstrip.c:2227
 #, c-format
 msgid ""
 "DWARF data in '%s' not adjusted for prelinking bias; consider prelink -u"
 msgstr ""
 
-#: src/unstrip.c:2196 src/unstrip.c:2248 src/unstrip.c:2260 src/unstrip.c:2350
+#: src/unstrip.c:2247 src/unstrip.c:2299 src/unstrip.c:2311 src/unstrip.c:2401
 #, c-format
 msgid "cannot create ELF descriptor: %s"
 msgstr ""
 
-#: src/unstrip.c:2234
+#: src/unstrip.c:2285
 msgid "WARNING: "
 msgstr ""
 
-#: src/unstrip.c:2236
+#: src/unstrip.c:2287
 msgid ", use --force"
 msgstr ""
 
-#: src/unstrip.c:2264
+#: src/unstrip.c:2315
 msgid "ELF header identification (e_ident) different"
 msgstr ""
 
-#: src/unstrip.c:2268
+#: src/unstrip.c:2319
 msgid "ELF header type (e_type) different"
 msgstr ""
 
-#: src/unstrip.c:2272
+#: src/unstrip.c:2323
 msgid "ELF header machine type (e_machine) different"
 msgstr ""
 
-#: src/unstrip.c:2276
+#: src/unstrip.c:2327
 msgid "stripped program header (e_phnum) smaller than unstripped"
 msgstr ""
 
-#: src/unstrip.c:2307
+#: src/unstrip.c:2358
 #, c-format
 msgid "cannot find stripped file for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2311
+#: src/unstrip.c:2362
 #, c-format
 msgid "cannot open stripped file '%s' for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2326
+#: src/unstrip.c:2377
 #, c-format
 msgid "cannot find debug file for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2330
+#: src/unstrip.c:2381
 #, c-format
 msgid "cannot open debug file '%s' for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2343
+#: src/unstrip.c:2394
 #, c-format
 msgid "module '%s' file '%s' is not stripped"
 msgstr ""
 
-#: src/unstrip.c:2374
+#: src/unstrip.c:2425
 #, c-format
 msgid "cannot cache section addresses for module '%s': %s"
 msgstr ""
 
-#: src/unstrip.c:2502
+#: src/unstrip.c:2553
 msgid "no matching modules found"
 msgstr ""
 
-#: src/unstrip.c:2512
+#: src/unstrip.c:2563
 msgid "matched more than one module"
 msgstr ""
 
-#: src/unstrip.c:2557
+#: src/unstrip.c:2608
 msgid ""
 "STRIPPED-FILE DEBUG-FILE\n"
 "[MODULE...]"
 msgstr ""
 
-#: src/unstrip.c:2558
+#: src/unstrip.c:2609
 msgid ""
 "Combine stripped files with separate symbols and debug information.\n"
 "\n"
diff --git a/po/pl.po b/po/pl.po
index a8bf8ce8..8d7f519b 100644
--- a/po/pl.po
+++ b/po/pl.po
@@ -8,7 +8,7 @@ msgid ""
 msgstr ""
 "Project-Id-Version: elfutils\n"
 "Report-Msgid-Bugs-To: https://sourceware.org/bugzilla/\n"
-"POT-Creation-Date: 2023-11-03 17:36+0100\n"
+"POT-Creation-Date: 2024-03-01 10:22-0500\n"
 "PO-Revision-Date: 2021-02-22 16:25+0100\n"
 "Last-Translator: Piotr Drg <piotrdrag@gmail.com>\n"
 "Language-Team: Polish <trans-pl@lists.fedoraproject.org>\n"
@@ -54,7 +54,7 @@ msgstr ""
 "BEZ JAKIEJKOLWIEK GWARANCJI, nawet domylnej gwarancji PRZYDATNOCI\n"
 "HANDLOWEJ albo PRZYDATNOCI DO OKRELONYCH ZASTOSOWA.\n"
 
-#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12202
+#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12203
 #: src/unstrip.c:311
 #, c-format
 msgid "memory exhausted"
@@ -302,7 +302,13 @@ msgstr "nieznany kod jzyka"
 msgid ".debug_addr section missing"
 msgstr "brak sekcji .debug_addr"
 
-#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2547
+#: libdw/dwarf_error.c:105
+#, fuzzy
+#| msgid "unknown version"
+msgid "unknown section"
+msgstr "nieznana wersja"
+
+#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2598
 msgid "Input selection options:"
 msgstr "Opcje wyboru wejcia:"
 
@@ -631,7 +637,7 @@ msgstr "nieprawidowy rozmiar operandu rdowego"
 msgid "invalid size of destination operand"
 msgstr "nieprawidowy rozmiar operandu docelowego"
 
-#: libelf/elf_error.c:86 src/readelf.c:6758
+#: libelf/elf_error.c:86 src/readelf.c:6759
 #, c-format
 msgid "invalid encoding"
 msgstr "nieprawidowe kodowanie"
@@ -716,8 +722,8 @@ msgstr "dane/scn nie zgadzaj si"
 msgid "invalid section header"
 msgstr "nieprawidowy nagwek sekcji"
 
-#: libelf/elf_error.c:190 src/readelf.c:10637 src/readelf.c:11242
-#: src/readelf.c:11343 src/readelf.c:11531
+#: libelf/elf_error.c:190 src/readelf.c:10638 src/readelf.c:11243
+#: src/readelf.c:11344 src/readelf.c:11532
 #, c-format
 msgid "invalid data"
 msgstr "nieprawidowe dane"
@@ -1648,7 +1654,7 @@ msgstr "Nieprawidowa warto %s dla parametru --gaps."
 
 #: src/elfcmp.c:733 src/findtextrel.c:194 src/nm.c:363 src/ranlib.c:140
 #: src/size.c:271 src/strings.c:184 src/strip.c:1040 src/strip.c:1077
-#: src/unstrip.c:2194 src/unstrip.c:2223
+#: src/unstrip.c:2245 src/unstrip.c:2274
 #, c-format
 msgid "cannot open '%s'"
 msgstr "nie mona otworzy %s"
@@ -4001,9 +4007,9 @@ msgstr "nie mona utworzy drzewa wyszukiwania"
 #: src/nm.c:742 src/nm.c:1234 src/objdump.c:778 src/readelf.c:685
 #: src/readelf.c:1506 src/readelf.c:1655 src/readelf.c:1882 src/readelf.c:2123
 #: src/readelf.c:2312 src/readelf.c:2482 src/readelf.c:2604 src/readelf.c:2854
-#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3896
-#: src/readelf.c:3944 src/readelf.c:4013 src/readelf.c:12029
-#: src/readelf.c:13212 src/readelf.c:13422 src/readelf.c:13490 src/size.c:396
+#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3897
+#: src/readelf.c:3945 src/readelf.c:4014 src/readelf.c:12030
+#: src/readelf.c:13213 src/readelf.c:13423 src/readelf.c:13491 src/size.c:396
 #: src/size.c:467 src/strip.c:1093
 #, c-format
 msgid "cannot get section header string table index"
@@ -4354,11 +4360,11 @@ msgstr "nie mona okreli liczby sekcji: %s"
 msgid "cannot get section: %s"
 msgstr "nie mona uzyska sekcji: %s"
 
-#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13442
-#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:610
-#: src/unstrip.c:631 src/unstrip.c:671 src/unstrip.c:887 src/unstrip.c:1222
-#: src/unstrip.c:1349 src/unstrip.c:1373 src/unstrip.c:1429 src/unstrip.c:1470
-#: src/unstrip.c:1662 src/unstrip.c:1813 src/unstrip.c:1956 src/unstrip.c:2055
+#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13443
+#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:622
+#: src/unstrip.c:640 src/unstrip.c:680 src/unstrip.c:897 src/unstrip.c:1263
+#: src/unstrip.c:1390 src/unstrip.c:1414 src/unstrip.c:1470 src/unstrip.c:1511
+#: src/unstrip.c:1703 src/unstrip.c:1854 src/unstrip.c:1998 src/unstrip.c:2106
 #, c-format
 msgid "cannot get section header: %s"
 msgstr "nie mona uzyska nagwka sekcji: %s"
@@ -4368,8 +4374,8 @@ msgstr "nie mona uzyska nagwka sekcji: %s"
 msgid "cannot get section name"
 msgstr "nie mona uzyska nazwy sekcji"
 
-#: src/readelf.c:720 src/readelf.c:7176 src/readelf.c:11230 src/readelf.c:11332
-#: src/readelf.c:11516
+#: src/readelf.c:720 src/readelf.c:7177 src/readelf.c:11231 src/readelf.c:11333
+#: src/readelf.c:11517
 #, c-format
 msgid "cannot get %s content: %s"
 msgstr "nie mona uzyska zwartoci %s: %s"
@@ -4718,7 +4724,7 @@ msgstr ""
 " Mapowanie sekcji do segmentw:\n"
 "  Segment sekcji"
 
-#: src/readelf.c:1519 src/unstrip.c:2114 src/unstrip.c:2156 src/unstrip.c:2163
+#: src/readelf.c:1519 src/unstrip.c:2165 src/unstrip.c:2207 src/unstrip.c:2214
 #, c-format
 msgid "cannot get program header: %s"
 msgstr "nie mona uzyska nagwka programu: %s"
@@ -4767,19 +4773,19 @@ msgstr "<NIEPRAWIDOWY SYMBOL>"
 msgid "<INVALID SECTION>"
 msgstr "<NIEPRAWIDOWY SEKCJA>"
 
-#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3912 src/readelf.c:4212
-#: src/readelf.c:13314 src/readelf.c:13321 src/readelf.c:13365
-#: src/readelf.c:13372
+#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3913 src/readelf.c:4213
+#: src/readelf.c:13315 src/readelf.c:13322 src/readelf.c:13366
+#: src/readelf.c:13373
 msgid "Couldn't uncompress section"
 msgstr "Nie mona dekompresowa sekcji"
 
-#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3916
+#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3917
 #, c-format
 msgid "cannot get section [%zd] header: %s"
 msgstr "nie mona uzyska nagwka sekcji [%zd]: %s"
 
 #: src/readelf.c:1886 src/readelf.c:2860 src/readelf.c:3146 src/readelf.c:3221
-#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5962
+#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5963
 #, c-format
 msgid "invalid sh_link value in section %zu"
 msgstr "nieprawidowa warto sh_link wsekcji %zu"
@@ -5166,7 +5172,7 @@ msgstr "      0  %6<PRIu32>      %5.1f%%\n"
 msgid "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 msgstr "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 
-#: src/readelf.c:3647
+#: src/readelf.c:3648
 #, c-format
 msgid ""
 " Average number of tests:   successful lookup: %f\n"
@@ -5175,37 +5181,37 @@ msgstr ""
 " rednia liczba testw:   udane wyszukania: %f\n"
 "\t\t\t  nieudane wyszukania: %f\n"
 
-#: src/readelf.c:3665 src/readelf.c:3729 src/readelf.c:3795
+#: src/readelf.c:3666 src/readelf.c:3730 src/readelf.c:3796
 #, c-format
 msgid "cannot get data for section %d: %s"
 msgstr "nie mona uzyska danych dla sekcji %d: %s"
 
-#: src/readelf.c:3673
+#: src/readelf.c:3674
 #, c-format
 msgid "invalid data in sysv.hash section %d"
 msgstr "nieprawidowe dane wsekcji sysv.hash %d"
 
-#: src/readelf.c:3702
+#: src/readelf.c:3703
 #, c-format
 msgid "invalid chain in sysv.hash section %d"
 msgstr "nieprawidowy acuch wsekcji sysv.hash %d"
 
-#: src/readelf.c:3737
+#: src/readelf.c:3738
 #, c-format
 msgid "invalid data in sysv.hash64 section %d"
 msgstr "nieprawidowe dane wsekcji sysv.hash64 %d"
 
-#: src/readelf.c:3768
+#: src/readelf.c:3769
 #, c-format
 msgid "invalid chain in sysv.hash64 section %d"
 msgstr "nieprawidowy acuch wsekcji sysv.hash64 %d"
 
-#: src/readelf.c:3804
+#: src/readelf.c:3805
 #, c-format
 msgid "invalid data in gnu.hash section %d"
 msgstr "nieprawidowe dane wsekcji gnu.hash %d"
 
-#: src/readelf.c:3870
+#: src/readelf.c:3871
 #, c-format
 msgid ""
 " Symbol Bias: %u\n"
@@ -5215,7 +5221,7 @@ msgstr ""
 " Rozmiar maski bitowej: %zuB  %<PRIuFAST32>%%b ustawionych  drugie "
 "przesunicie skrtu: %u\n"
 
-#: src/readelf.c:3955
+#: src/readelf.c:3956
 #, c-format
 msgid ""
 "\n"
@@ -5236,7 +5242,7 @@ msgstr[2] ""
 "Sekcja listy bibliotek [%2zu] %s pod offsetem %#0<PRIx64> zawiera %d "
 "wpisw:\n"
 
-#: src/readelf.c:3969
+#: src/readelf.c:3970
 msgid ""
 "       Library                       Time Stamp          Checksum Version "
 "Flags"
@@ -5244,7 +5250,7 @@ msgstr ""
 "       Biblioteka                    Czas                Suma k.  Wersja  "
 "Flagi"
 
-#: src/readelf.c:4029
+#: src/readelf.c:4030
 #, c-format
 msgid ""
 "\n"
@@ -5254,107 +5260,107 @@ msgstr ""
 "\n"
 "Sekcja atrybutw obiektu [%2zu] %s %<PRIu64>B pod offsetem %#0<PRIx64>:\n"
 
-#: src/readelf.c:4046
+#: src/readelf.c:4047
 msgid "  Owner          Size\n"
 msgstr "  Waciciel          Rozmiar\n"
 
-#: src/readelf.c:4070
+#: src/readelf.c:4071
 #, c-format
 msgid "  %-13s  %4<PRIu32>\n"
 msgstr "  %-13s  %4<PRIu32>\n"
 
 #. Unknown subsection, print and skip.
-#: src/readelf.c:4109
+#: src/readelf.c:4110
 #, c-format
 msgid "    %-4u %12<PRIu32>\n"
 msgstr "    %-4u %12<PRIu32>\n"
 
 #. Tag_File
-#: src/readelf.c:4114
+#: src/readelf.c:4115
 #, c-format
 msgid "    File: %11<PRIu32>\n"
 msgstr "    Plik: %11<PRIu32>\n"
 
-#: src/readelf.c:4164
+#: src/readelf.c:4165
 #, c-format
 msgid "      %s: %<PRId64>, %s\n"
 msgstr "      %s: %<PRId64>, %s\n"
 
-#: src/readelf.c:4167
+#: src/readelf.c:4168
 #, c-format
 msgid "      %s: %<PRId64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:4170
+#: src/readelf.c:4171
 #, c-format
 msgid "      %s: %s\n"
 msgstr "      %s: %s\n"
 
-#: src/readelf.c:4180
+#: src/readelf.c:4181
 #, c-format
 msgid "      %u: %<PRId64>\n"
 msgstr "      %u: %<PRId64>\n"
 
-#: src/readelf.c:4183
+#: src/readelf.c:4184
 #, c-format
 msgid "      %u: %s\n"
 msgstr "      %u: %s\n"
 
-#: src/readelf.c:4221
+#: src/readelf.c:4222
 #, fuzzy
 #| msgid "couldn't get shdr for group section: %s"
 msgid "Couldn't get data from section"
 msgstr "nie mona uzyska shdr dla sekcji grupy: %s"
 
-#: src/readelf.c:4286
+#: src/readelf.c:4287
 msgid "sprintf failure"
 msgstr "sprintf si nie powiodo"
 
-#: src/readelf.c:4770
+#: src/readelf.c:4771
 msgid "empty block"
 msgstr "pusty blok"
 
-#: src/readelf.c:4773
+#: src/readelf.c:4774
 #, c-format
 msgid "%zu byte block:"
 msgstr "blok o%zuB:"
 
-#: src/readelf.c:5251
+#: src/readelf.c:5252
 #, c-format
 msgid "%*s[%2<PRIuMAX>] %s  <TRUNCATED>\n"
 msgstr "%*s[%2<PRIuMAX>] %s  <SKRCONE>\n"
 
-#: src/readelf.c:5423
+#: src/readelf.c:5424
 #, c-format
 msgid "%s %#<PRIx64> used with different address sizes"
 msgstr "%s %#<PRIx64> zostao uyte zrnymi rozmiarami adresu"
 
-#: src/readelf.c:5430
+#: src/readelf.c:5431
 #, c-format
 msgid "%s %#<PRIx64> used with different offset sizes"
 msgstr "%s %#<PRIx64> zostao uyte zrnymi rozmiarami offsetu"
 
-#: src/readelf.c:5437
+#: src/readelf.c:5438
 #, c-format
 msgid "%s %#<PRIx64> used with different base addresses"
 msgstr "%s %#<PRIx64> zostao uyte zrnymi adresami podstawowymi"
 
-#: src/readelf.c:5444
+#: src/readelf.c:5445
 #, c-format
 msgid "%s %#<PRIx64> used with different attribute %s and %s"
 msgstr "%s %#<PRIx64> zostao uyte zrnymi atrybutami %s i%s"
 
-#: src/readelf.c:5544
+#: src/readelf.c:5545
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE IN REST OF SECTION>\n"
 msgstr " [%6tx]  <NIEUYWANE MIECIE WRESZCIE SEKCJI>\n"
 
-#: src/readelf.c:5552
+#: src/readelf.c:5553
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE> ... %<PRIu64> bytes ...\n"
 msgstr " [%6tx]  <NIEUYWANE MIECIE> %<PRIu64>B\n"
 
-#: src/readelf.c:5658
+#: src/readelf.c:5659
 #, c-format
 msgid ""
 "\n"
@@ -5365,7 +5371,7 @@ msgstr ""
 "Sekcja DWARF [%2zu] %s pod offsetem %#<PRIx64>:\n"
 " [ Kod]\n"
 
-#: src/readelf.c:5666
+#: src/readelf.c:5667
 #, c-format
 msgid ""
 "\n"
@@ -5374,20 +5380,20 @@ msgstr ""
 "\n"
 "Sekcja skrtw pod offsetem %<PRIu64>:\n"
 
-#: src/readelf.c:5679
+#: src/readelf.c:5680
 #, c-format
 msgid " *** error while reading abbreviation: %s\n"
 msgstr " *** bd podczas odczytywania skrtu: %s\n"
 
-#: src/readelf.c:5695
+#: src/readelf.c:5696
 #, c-format
 msgid " [%5u] offset: %<PRId64>, children: %s, tag: %s\n"
 msgstr " [%5u] offset: %<PRId64>, potomek: %s, znacznik: %s\n"
 
-#: src/readelf.c:5732 src/readelf.c:6025 src/readelf.c:6196 src/readelf.c:6567
-#: src/readelf.c:7193 src/readelf.c:8962 src/readelf.c:9704 src/readelf.c:10172
-#: src/readelf.c:10427 src/readelf.c:10589 src/readelf.c:10970
-#: src/readelf.c:11041
+#: src/readelf.c:5733 src/readelf.c:6026 src/readelf.c:6197 src/readelf.c:6568
+#: src/readelf.c:7194 src/readelf.c:8963 src/readelf.c:9705 src/readelf.c:10173
+#: src/readelf.c:10428 src/readelf.c:10590 src/readelf.c:10971
+#: src/readelf.c:11042
 #, c-format
 msgid ""
 "\n"
@@ -5396,47 +5402,47 @@ msgstr ""
 "\n"
 "Sekcja DWARF [%2zu] %s pod offsetem %#<PRIx64>:\n"
 
-#: src/readelf.c:5835 src/readelf.c:5859 src/readelf.c:6232 src/readelf.c:9740
+#: src/readelf.c:5836 src/readelf.c:5860 src/readelf.c:6233 src/readelf.c:9741
 #, c-format
 msgid " Length:         %8<PRIu64>\n"
 msgstr " Dugo:          %8<PRIu64>\n"
 
-#: src/readelf.c:5837 src/readelf.c:5874 src/readelf.c:6245 src/readelf.c:9753
+#: src/readelf.c:5838 src/readelf.c:5875 src/readelf.c:6246 src/readelf.c:9754
 #, c-format
 msgid " DWARF version:  %8<PRIu16>\n"
 msgstr " Wersja DWARF:     %8<PRIu16>\n"
 
-#: src/readelf.c:5838 src/readelf.c:5883 src/readelf.c:6254 src/readelf.c:9762
+#: src/readelf.c:5839 src/readelf.c:5884 src/readelf.c:6255 src/readelf.c:9763
 #, c-format
 msgid " Address size:   %8<PRIu64>\n"
 msgstr " Rozmiar adresu:   %8<PRIu64>\n"
 
-#: src/readelf.c:5840 src/readelf.c:5893 src/readelf.c:6264 src/readelf.c:9772
+#: src/readelf.c:5841 src/readelf.c:5894 src/readelf.c:6265 src/readelf.c:9773
 #, c-format
 msgid " Segment size:   %8<PRIu64>\n"
 msgstr " Rozmiar segmentu: %8<PRIu64>\n"
 
-#: src/readelf.c:5878 src/readelf.c:6249 src/readelf.c:9757 src/readelf.c:11163
+#: src/readelf.c:5879 src/readelf.c:6250 src/readelf.c:9758 src/readelf.c:11164
 #, c-format
 msgid "Unknown version"
 msgstr "Nieznana wersja"
 
-#: src/readelf.c:5888 src/readelf.c:6095 src/readelf.c:6259 src/readelf.c:9767
+#: src/readelf.c:5889 src/readelf.c:6096 src/readelf.c:6260 src/readelf.c:9768
 #, c-format
 msgid "unsupported address size"
 msgstr "nieobsugiwany rozmiar adresu"
 
-#: src/readelf.c:5899 src/readelf.c:6106 src/readelf.c:6269 src/readelf.c:9777
+#: src/readelf.c:5900 src/readelf.c:6107 src/readelf.c:6270 src/readelf.c:9778
 #, c-format
 msgid "unsupported segment size"
 msgstr "nieobsugiwany rozmiar segmentu"
 
-#: src/readelf.c:5952
+#: src/readelf.c:5953
 #, c-format
 msgid "cannot get .debug_aranges content: %s"
 msgstr "nie mona uzyska zawartoci .debug_aranges: %s"
 
-#: src/readelf.c:5967
+#: src/readelf.c:5968
 #, c-format
 msgid ""
 "\n"
@@ -5454,12 +5460,12 @@ msgstr[2] ""
 "\n"
 "Sekcja DWARF [%2zu] %s pod offsetem %#<PRIx64> zawiera %zu wpisw:\n"
 
-#: src/readelf.c:5998
+#: src/readelf.c:5999
 #, c-format
 msgid " [%*zu] ???\n"
 msgstr " [%*zu] ???\n"
 
-#: src/readelf.c:6000
+#: src/readelf.c:6001
 #, c-format
 msgid ""
 " [%*zu] start: %0#*<PRIx64>, length: %5<PRIu64>, CU DIE offset: %6<PRId64>\n"
@@ -5467,7 +5473,7 @@ msgstr ""
 " [%*zu] pocztek: %0#*<PRIx64>, dugo: %5<PRIu64>, offset CU DIE: "
 "%6<PRId64>\n"
 
-#: src/readelf.c:6038 src/readelf.c:8981
+#: src/readelf.c:6039 src/readelf.c:8982
 #, c-format
 msgid ""
 "\n"
@@ -5476,13 +5482,13 @@ msgstr ""
 "\n"
 "Tabela pod offsetem %zu:\n"
 
-#: src/readelf.c:6042 src/readelf.c:6213 src/readelf.c:7217 src/readelf.c:8992
-#: src/readelf.c:9721
+#: src/readelf.c:6043 src/readelf.c:6214 src/readelf.c:7218 src/readelf.c:8993
+#: src/readelf.c:9722
 #, c-format
 msgid "invalid data in section [%zu] '%s'"
 msgstr "nieprawidowe dane wsekcji [%zu] %s"
 
-#: src/readelf.c:6058
+#: src/readelf.c:6059
 #, c-format
 msgid ""
 "\n"
@@ -5491,27 +5497,27 @@ msgstr ""
 "\n"
 " Dugo:        %6<PRIu64>\n"
 
-#: src/readelf.c:6070
+#: src/readelf.c:6071
 #, c-format
 msgid " DWARF version: %6<PRIuFAST16>\n"
 msgstr " Wersja DWARF: %6<PRIuFAST16>\n"
 
-#: src/readelf.c:6074
+#: src/readelf.c:6075
 #, c-format
 msgid "unsupported aranges version"
 msgstr "nieobsugiwana wersja aranges"
 
-#: src/readelf.c:6085
+#: src/readelf.c:6086
 #, c-format
 msgid " CU offset:     %6<PRIx64>\n"
 msgstr " Offset CU:     %6<PRIx64>\n"
 
-#: src/readelf.c:6091
+#: src/readelf.c:6092
 #, c-format
 msgid " Address size:  %6<PRIu64>\n"
 msgstr " Offset adresu:  %6<PRIu64>\n"
 
-#: src/readelf.c:6102
+#: src/readelf.c:6103
 #, c-format
 msgid ""
 " Segment size:  %6<PRIu64>\n"
@@ -5520,12 +5526,12 @@ msgstr ""
 " Rozmiar segmentu:  %6<PRIu64>\n"
 "\n"
 
-#: src/readelf.c:6157
+#: src/readelf.c:6158
 #, c-format
 msgid "   %zu padding bytes\n"
 msgstr "   %zuB wypenienia\n"
 
-#: src/readelf.c:6219 src/readelf.c:9727
+#: src/readelf.c:6220 src/readelf.c:9728
 #, c-format
 msgid ""
 "Table at Offset 0x%<PRIx64>:\n"
@@ -5534,42 +5540,42 @@ msgstr ""
 "Tabela pod offsetem 0x%<PRIx64>:\n"
 "\n"
 
-#: src/readelf.c:6274 src/readelf.c:9782
+#: src/readelf.c:6275 src/readelf.c:9783
 #, c-format
 msgid " Offset entries: %8<PRIu64>\n"
 msgstr " Wpisy offsetu: %8<PRIu64>\n"
 
-#: src/readelf.c:6290 src/readelf.c:9798
+#: src/readelf.c:6291 src/readelf.c:9799
 #, c-format
 msgid " Unknown CU base: "
 msgstr " Nieznana podstawa CU: "
 
-#: src/readelf.c:6292 src/readelf.c:9800
+#: src/readelf.c:6293 src/readelf.c:9801
 #, c-format
 msgid " CU [%6<PRIx64>] base: "
 msgstr " Podstawa CU [%6<PRIx64>]: "
 
-#: src/readelf.c:6298 src/readelf.c:9806
+#: src/readelf.c:6299 src/readelf.c:9807
 #, c-format
 msgid " Not associated with a CU.\n"
 msgstr " Brak powizania zCU.\n"
 
-#: src/readelf.c:6309 src/readelf.c:9817
+#: src/readelf.c:6310 src/readelf.c:9818
 #, c-format
 msgid "too many offset entries for unit length"
 msgstr "za duo wpisw offsetu dla dugoci jednostki"
 
-#: src/readelf.c:6313 src/readelf.c:9821
+#: src/readelf.c:6314 src/readelf.c:9822
 #, c-format
 msgid "  Offsets starting at 0x%<PRIx64>:\n"
 msgstr "  Offsety zaczynajce si w0x%<PRIx64>:\n"
 
-#: src/readelf.c:6365
+#: src/readelf.c:6366
 #, c-format
 msgid "invalid range list data"
 msgstr "nieprawidowe dane listy zakresw"
 
-#: src/readelf.c:6550 src/readelf.c:10156
+#: src/readelf.c:6551 src/readelf.c:10157
 #, c-format
 msgid ""
 "   %zu padding bytes\n"
@@ -5578,7 +5584,7 @@ msgstr ""
 "   %zuB wypenienia\n"
 "\n"
 
-#: src/readelf.c:6598 src/readelf.c:10205
+#: src/readelf.c:6599 src/readelf.c:10206
 #, c-format
 msgid ""
 "\n"
@@ -5587,7 +5593,7 @@ msgstr ""
 "\n"
 " Nieznana podstawa CU: "
 
-#: src/readelf.c:6600 src/readelf.c:10207
+#: src/readelf.c:6601 src/readelf.c:10208
 #, c-format
 msgid ""
 "\n"
@@ -5596,30 +5602,30 @@ msgstr ""
 "\n"
 " Podstawa CU [%6<PRIx64>]: "
 
-#: src/readelf.c:6609 src/readelf.c:10233 src/readelf.c:10259
+#: src/readelf.c:6610 src/readelf.c:10234 src/readelf.c:10260
 #, c-format
 msgid " [%6tx]  <INVALID DATA>\n"
 msgstr " [%6tx]  <NIEPRAWIDOWE DANE>\n"
 
-#: src/readelf.c:6634 src/readelf.c:10343
+#: src/readelf.c:6635 src/readelf.c:10344
 msgid "base address"
 msgstr "adres podstawowy"
 
-#: src/readelf.c:6644 src/readelf.c:10353
+#: src/readelf.c:6645 src/readelf.c:10354
 #, c-format
 msgid " [%6tx] empty list\n"
 msgstr " [%6tx] pusta lista\n"
 
-#: src/readelf.c:6908
+#: src/readelf.c:6909
 msgid "         <INVALID DATA>\n"
 msgstr "         <NIEPRAWIDOWE DANE>\n"
 
-#: src/readelf.c:7165
+#: src/readelf.c:7166
 #, c-format
 msgid "cannot get ELF: %s"
 msgstr "nie mona uzyska ELF: %s"
 
-#: src/readelf.c:7189
+#: src/readelf.c:7190
 #, c-format
 msgid ""
 "\n"
@@ -5628,7 +5634,7 @@ msgstr ""
 "\n"
 "Sekcja informacji oramce wywoania [%2zu] %s pod offsetem %#<PRIx64>:\n"
 
-#: src/readelf.c:7239
+#: src/readelf.c:7240
 #, c-format
 msgid ""
 "\n"
@@ -5637,65 +5643,65 @@ msgstr ""
 "\n"
 " [%6tx] Zerowy koniec\n"
 
-#: src/readelf.c:7343 src/readelf.c:7497
+#: src/readelf.c:7344 src/readelf.c:7498
 #, c-format
 msgid "invalid augmentation length"
 msgstr "nieprawidowa dugo powikszenia"
 
-#: src/readelf.c:7358
+#: src/readelf.c:7359
 msgid "FDE address encoding: "
 msgstr "Kodowanie adresu FDE: "
 
-#: src/readelf.c:7364
+#: src/readelf.c:7365
 msgid "LSDA pointer encoding: "
 msgstr "Kodowanie wskanika LSDA: "
 
-#: src/readelf.c:7474
+#: src/readelf.c:7475
 #, c-format
 msgid " (offset: %#<PRIx64>)"
 msgstr " (offset: %#<PRIx64>)"
 
-#: src/readelf.c:7481
+#: src/readelf.c:7482
 #, c-format
 msgid " (end offset: %#<PRIx64>)"
 msgstr " (koczcy offset: %#<PRIx64>)"
 
-#: src/readelf.c:7518
+#: src/readelf.c:7519
 #, c-format
 msgid "   %-26sLSDA pointer: %#<PRIx64>\n"
 msgstr "   %-26sWskanik LSDA: %#<PRIx64>\n"
 
-#: src/readelf.c:7603
+#: src/readelf.c:7604
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute code: %s"
 msgstr "DIE [%<PRIx64>] nie mona uzyska kodu atrybutu: %s"
 
-#: src/readelf.c:7613
+#: src/readelf.c:7614
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute form: %s"
 msgstr "DIE [%<PRIx64>] nie mona uzyska formy atrybutu: %s"
 
-#: src/readelf.c:7635
+#: src/readelf.c:7636
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute '%s' (%s) value: %s"
 msgstr "DIE [%<PRIx64>] nie mona uzyska wartoci atrybutu %s (%s): %s"
 
-#: src/readelf.c:7965
+#: src/readelf.c:7966
 #, c-format
 msgid "invalid file (%<PRId64>): %s"
 msgstr "nieprawidowy plik (%<PRId64>): %s"
 
-#: src/readelf.c:7969
+#: src/readelf.c:7970
 #, c-format
 msgid "no srcfiles for CU [%<PRIx64>]"
 msgstr "brak plikw rdowych dla CU [%<PRIx64>]"
 
-#: src/readelf.c:7973
+#: src/readelf.c:7974
 #, c-format
 msgid "couldn't get DWARF CU: %s"
 msgstr "nie mona uzyska CU DWARF: %s"
 
-#: src/readelf.c:8295
+#: src/readelf.c:8296
 #, c-format
 msgid ""
 "\n"
@@ -5706,12 +5712,12 @@ msgstr ""
 "Sekcja DWARF [%2zu] %s pod offsetem %#<PRIx64>:\n"
 " [Offset]\n"
 
-#: src/readelf.c:8345
+#: src/readelf.c:8346
 #, c-format
 msgid "cannot get next unit: %s"
 msgstr "nie mona uzyska nastpnej jednostki: %s"
 
-#: src/readelf.c:8365
+#: src/readelf.c:8366
 #, c-format
 msgid ""
 " Type unit at offset %<PRIu64>:\n"
@@ -5724,7 +5730,7 @@ msgstr ""
 "%<PRIu8>, rozmiar offsetu: %<PRIu8>\n"
 " Podpis typu: %#<PRIx64>, offset typu: %#<PRIx64> [%<PRIx64>]\n"
 
-#: src/readelf.c:8377
+#: src/readelf.c:8378
 #, c-format
 msgid ""
 " Compilation unit at offset %<PRIu64>:\n"
@@ -5735,38 +5741,38 @@ msgstr ""
 " Wersja: %<PRIu16>, offset sekcji skrtw: %<PRIu64>, rozmiar adresu: "
 "%<PRIu8>, rozmiar offsetu: %<PRIu8>\n"
 
-#: src/readelf.c:8387 src/readelf.c:8548
+#: src/readelf.c:8388 src/readelf.c:8549
 #, c-format
 msgid " Unit type: %s (%<PRIu8>)"
 msgstr " Typ jednostki: %s (%<PRIu8>)"
 
-#: src/readelf.c:8414
+#: src/readelf.c:8415
 #, c-format
 msgid "unknown version (%d) or unit type (%d)"
 msgstr "nieznana wersja (%d) lub typ jednostki (%d)"
 
-#: src/readelf.c:8443
+#: src/readelf.c:8444
 #, c-format
 msgid "cannot get DIE offset: %s"
 msgstr "nie mona uzyska offsetu DIE: %s"
 
-#: src/readelf.c:8452
+#: src/readelf.c:8453
 #, c-format
 msgid "cannot get tag of DIE at offset [%<PRIx64>] in section '%s': %s"
 msgstr ""
 "nie mona uzyska znacznika DIE pod offsetem [%<PRIx64>] wsekcji %s: %s"
 
-#: src/readelf.c:8488
+#: src/readelf.c:8489
 #, c-format
 msgid "cannot get next DIE: %s\n"
 msgstr "nie mona uzyska nastpnego DIE: %s\n"
 
-#: src/readelf.c:8496
+#: src/readelf.c:8497
 #, c-format
 msgid "cannot get next DIE: %s"
 msgstr "nie mona uzyska nastpnego DIE: %s"
 
-#: src/readelf.c:8540
+#: src/readelf.c:8541
 #, c-format
 msgid ""
 " Split compilation unit at offset %<PRIu64>:\n"
@@ -5777,7 +5783,7 @@ msgstr ""
 " Wersja: %<PRIu16>, offset sekcji skrtw: %<PRIu64>, rozmiar adresu: "
 "%<PRIu8>, rozmiar offsetu: %<PRIu8>\n"
 
-#: src/readelf.c:8592
+#: src/readelf.c:8593
 #, c-format
 msgid ""
 "\n"
@@ -5788,13 +5794,13 @@ msgstr ""
 "Sekcja DWARF [%2zu] %s pod offsetem %#<PRIx64>:\n"
 "\n"
 
-#: src/readelf.c:8924
+#: src/readelf.c:8925
 #, c-format
 msgid "unknown form: %s"
 msgstr "nieznana forma: %s"
 
 #. Print what we got so far.
-#: src/readelf.c:9072
+#: src/readelf.c:9073
 #, c-format
 msgid ""
 "\n"
@@ -5827,27 +5833,27 @@ msgstr ""
 "\n"
 "Instrukcje:\n"
 
-#: src/readelf.c:9094
+#: src/readelf.c:9095
 #, c-format
 msgid "cannot handle .debug_line version: %u\n"
 msgstr "nie mona obsuy wersji .debug_line: %u\n"
 
-#: src/readelf.c:9102
+#: src/readelf.c:9103
 #, c-format
 msgid "cannot handle address size: %u\n"
 msgstr "nie mona obsuy rozmiaru adresu: %u\n"
 
-#: src/readelf.c:9110
+#: src/readelf.c:9111
 #, c-format
 msgid "cannot handle segment selector size: %u\n"
 msgstr "nie mona obsuy rozmiaru selektora segmentu: %u\n"
 
-#: src/readelf.c:9120
+#: src/readelf.c:9121
 #, c-format
 msgid "invalid data at offset %tu in section [%zu] '%s'"
 msgstr "nieprawidowe dane pod offsetem %tu wsekcji [%zu] %s"
 
-#: src/readelf.c:9135
+#: src/readelf.c:9136
 #, c-format
 msgid "  [%*<PRIuFAST8>]  %hhu argument\n"
 msgid_plural "  [%*<PRIuFAST8>]  %hhu arguments\n"
@@ -5855,7 +5861,7 @@ msgstr[0] "  [%*<PRIuFAST8>]  %hhu parametr\n"
 msgstr[1] "  [%*<PRIuFAST8>]  %hhu parametry\n"
 msgstr[2] "  [%*<PRIuFAST8>]  %hhu parametrw\n"
 
-#: src/readelf.c:9146
+#: src/readelf.c:9147
 msgid ""
 "\n"
 "Directory table:"
@@ -5863,12 +5869,12 @@ msgstr ""
 "\n"
 "Tabela katalogu:"
 
-#: src/readelf.c:9152 src/readelf.c:9229
+#: src/readelf.c:9153 src/readelf.c:9230
 #, c-format
 msgid "      ["
 msgstr "      ["
 
-#: src/readelf.c:9223
+#: src/readelf.c:9224
 msgid ""
 "\n"
 "File name table:"
@@ -5876,11 +5882,11 @@ msgstr ""
 "\n"
 "Tabela nazw plikw:"
 
-#: src/readelf.c:9284
+#: src/readelf.c:9285
 msgid " Entry Dir   Time      Size      Name"
 msgstr " Wpis  Kat   Czas      Rozmiar   Nazwa"
 
-#: src/readelf.c:9330
+#: src/readelf.c:9331
 msgid ""
 "\n"
 "No line number statements."
@@ -5888,7 +5894,7 @@ msgstr ""
 "\n"
 "Brak instrukcji numerw wierszy."
 
-#: src/readelf.c:9334
+#: src/readelf.c:9335
 msgid ""
 "\n"
 "Line number statements:"
@@ -5896,129 +5902,129 @@ msgstr ""
 "\n"
 "Instrukcje numerw wierszy:"
 
-#: src/readelf.c:9349
+#: src/readelf.c:9350
 #, c-format
 msgid "invalid maximum operations per instruction is zero"
 msgstr "nieprawidowe maksimum operacji na instrukcj wynosi zero"
 
-#: src/readelf.c:9383
+#: src/readelf.c:9384
 #, c-format
 msgid " special opcode %u: address+%u = "
 msgstr " instrukcja specjalna %u: adres+%u = "
 
-#: src/readelf.c:9387
+#: src/readelf.c:9388
 #, c-format
 msgid ", op_index = %u, line%+d = %zu\n"
 msgstr ", op_index = %u, wiersz%+d = %zu\n"
 
-#: src/readelf.c:9390
+#: src/readelf.c:9391
 #, c-format
 msgid ", line%+d = %zu\n"
 msgstr ", wiersz%+d = %zu\n"
 
-#: src/readelf.c:9408
+#: src/readelf.c:9409
 #, c-format
 msgid " extended opcode %u: "
 msgstr " instrukcja rozszerzona %u: "
 
-#: src/readelf.c:9413
+#: src/readelf.c:9414
 msgid " end of sequence"
 msgstr " koniec sekwencji"
 
-#: src/readelf.c:9431
+#: src/readelf.c:9432
 #, c-format
 msgid " set address to "
 msgstr " ustawienie adresu na "
 
-#: src/readelf.c:9459
+#: src/readelf.c:9460
 #, c-format
 msgid " define new file: dir=%u, mtime=%<PRIu64>, length=%<PRIu64>, name=%s\n"
 msgstr ""
 " definicja nowego pliku: dir=%u, mtime=%<PRIu64>, dugo=%<PRIu64>, "
 "nazwa=%s\n"
 
-#: src/readelf.c:9473
+#: src/readelf.c:9474
 #, c-format
 msgid " set discriminator to %u\n"
 msgstr " ustawienie dyskryminatora na %u\n"
 
-#: src/readelf.c:9500
+#: src/readelf.c:9501
 #, c-format
 msgid " set inlined context %u, function name %s (0x%x)\n"
 msgstr ""
 
-#: src/readelf.c:9524
+#: src/readelf.c:9525
 #, fuzzy, c-format
 #| msgid "Also show function names"
 msgid " set function name %s (0x%x)\n"
 msgstr "Wywietla take nazwy funkcji"
 
 #. Unknown, ignore it.
-#: src/readelf.c:9531
+#: src/readelf.c:9532
 msgid " unknown opcode"
 msgstr " nieznana instrukcja"
 
 #. Takes no argument.
-#: src/readelf.c:9543
+#: src/readelf.c:9544
 msgid " copy"
 msgstr " kopiowanie"
 
-#: src/readelf.c:9554
+#: src/readelf.c:9555
 #, c-format
 msgid " advance address by %u to "
 msgstr " zwikszenie adresu o%u do "
 
-#: src/readelf.c:9558 src/readelf.c:9619
+#: src/readelf.c:9559 src/readelf.c:9620
 #, c-format
 msgid ", op_index to %u"
 msgstr ", op_index do %u"
 
-#: src/readelf.c:9570
+#: src/readelf.c:9571
 #, c-format
 msgid " advance line by constant %d to %<PRId64>\n"
 msgstr " zwikszenie wiersza osta %d do %<PRId64>\n"
 
-#: src/readelf.c:9580
+#: src/readelf.c:9581
 #, c-format
 msgid " set file to %<PRIu64>\n"
 msgstr " ustawienie pliku na %<PRIu64>\n"
 
-#: src/readelf.c:9591
+#: src/readelf.c:9592
 #, c-format
 msgid " set column to %<PRIu64>\n"
 msgstr " ustawienie kolumny na %<PRIu64>\n"
 
-#: src/readelf.c:9598
+#: src/readelf.c:9599
 #, c-format
 msgid " set '%s' to %<PRIuFAST8>\n"
 msgstr " ustawienie %s na %<PRIuFAST8>\n"
 
 #. Takes no argument.
-#: src/readelf.c:9604
+#: src/readelf.c:9605
 msgid " set basic block flag"
 msgstr " ustawienie podstawowej flagi bloku"
 
-#: src/readelf.c:9615
+#: src/readelf.c:9616
 #, c-format
 msgid " advance address by constant %u to "
 msgstr " zwikszenie adresu osta %u do "
 
-#: src/readelf.c:9635
+#: src/readelf.c:9636
 #, c-format
 msgid " advance address by fixed value %u to \n"
 msgstr " zwikszenie adresu osta warto %u do \n"
 
 #. Takes no argument.
-#: src/readelf.c:9645
+#: src/readelf.c:9646
 msgid " set prologue end flag"
 msgstr " ustawienie flagi koca prologu"
 
 #. Takes no argument.
-#: src/readelf.c:9650
+#: src/readelf.c:9651
 msgid " set epilogue begin flag"
 msgstr " ustawienie flagi pocztku epilogu"
 
-#: src/readelf.c:9660
+#: src/readelf.c:9661
 #, c-format
 msgid " set isa to %u\n"
 msgstr " ustawienie isa na %u\n"
@@ -6026,7 +6032,7 @@ msgstr " ustawienie isa na %u\n"
 #. This is a new opcode the generator but not we know about.
 #. Read the parameters associated with it but then discard
 #. everything.  Read all the parameters for this opcode.
-#: src/readelf.c:9669
+#: src/readelf.c:9670
 #, c-format
 msgid " unknown opcode with %<PRIu8> parameter:"
 msgid_plural " unknown opcode with %<PRIu8> parameters:"
@@ -6034,86 +6040,86 @@ msgstr[0] " nieznana instrukcja z%<PRIu8> parametrem:"
 msgstr[1] " nieznana instrukcja z%<PRIu8> parametrami:"
 msgstr[2] " nieznana instrukcja z%<PRIu8> parametrami:"
 
-#: src/readelf.c:9870
+#: src/readelf.c:9871
 #, c-format
 msgid "    <INVALID DATA>\n"
 msgstr "    <NIEPRAWIDOWE DANE>\n"
 
-#: src/readelf.c:9910
+#: src/readelf.c:9911
 #, c-format
 msgid "invalid loclists data"
 msgstr "nieprawidowe dane loclists"
 
-#: src/readelf.c:10380 src/readelf.c:11425
+#: src/readelf.c:10381 src/readelf.c:11426
 msgid "   <INVALID DATA>\n"
 msgstr "   <NIEPRAWIDOWE DANE>\n"
 
-#: src/readelf.c:10511
+#: src/readelf.c:10512
 #, c-format
 msgid "%*s*** non-terminated string at end of section"
 msgstr "%*s*** niezakoczony cig na kocu sekcji"
 
-#: src/readelf.c:10534
+#: src/readelf.c:10535
 #, c-format
 msgid "%*s*** missing DW_MACINFO_start_file argument at end of section"
 msgstr "%*s*** brak parametru DW_MACINFO_start_file na kocu sekcji"
 
-#: src/readelf.c:10629
+#: src/readelf.c:10630
 #, c-format
 msgid " Offset:             0x%<PRIx64>\n"
 msgstr " Offset:             0x%<PRIx64>\n"
 
-#: src/readelf.c:10641
+#: src/readelf.c:10642
 #, c-format
 msgid " Version:            %<PRIu16>\n"
 msgstr " Wersja:             %<PRIu16>\n"
 
-#: src/readelf.c:10647 src/readelf.c:11546
+#: src/readelf.c:10648 src/readelf.c:11547
 #, c-format
 msgid "  unknown version, cannot parse section\n"
 msgstr "  nieznana wersja, nie mona przetworzy sekcji\n"
 
-#: src/readelf.c:10654
+#: src/readelf.c:10655
 #, c-format
 msgid " Flag:               0x%<PRIx8>"
 msgstr " Flaga:              0x%<PRIx8>"
 
-#: src/readelf.c:10683
+#: src/readelf.c:10684
 #, c-format
 msgid " Offset length:      %<PRIu8>\n"
 msgstr " Dugo offsetu:    %<PRIu8>\n"
 
-#: src/readelf.c:10691
+#: src/readelf.c:10692
 #, c-format
 msgid " .debug_line offset: 0x%<PRIx64>\n"
 msgstr " Offset .debug_line: 0x%<PRIx64>\n"
 
-#: src/readelf.c:10716
+#: src/readelf.c:10717
 #, c-format
 msgid "  extension opcode table, %<PRIu8> items:\n"
 msgstr "  tabela instrukcji rozszerzenia, %<PRIu8> elementw:\n"
 
-#: src/readelf.c:10723
+#: src/readelf.c:10724
 #, c-format
 msgid "    [%<PRIx8>]"
 msgstr "    [%<PRIx8>]"
 
-#: src/readelf.c:10735
+#: src/readelf.c:10736
 #, c-format
 msgid " %<PRIu8> arguments:"
 msgstr " Parametry %<PRIu8>:"
 
-#: src/readelf.c:10750
+#: src/readelf.c:10751
 #, c-format
 msgid " no arguments."
 msgstr " brak parametrw."
 
-#: src/readelf.c:10951
+#: src/readelf.c:10952
 #, c-format
 msgid " [%5d] DIE offset: %6<PRId64>, CU DIE offset: %6<PRId64>, name: %s\n"
 msgstr " [%5d] offset DIE: %6<PRId64>, offset CU DIE: %6<PRId64>, nazwa: %s\n"
 
-#: src/readelf.c:11006
+#: src/readelf.c:11007
 #, c-format
 msgid ""
 "\n"
@@ -6125,37 +6131,37 @@ msgstr ""
 " %*s  Cig\n"
 
 #. TRANS: the debugstr| prefix makes the string unique.
-#: src/readelf.c:11011
+#: src/readelf.c:11012
 msgctxt "debugstr"
 msgid "Offset"
 msgstr ""
 
-#: src/readelf.c:11021
+#: src/readelf.c:11022
 #, c-format
 msgid " *** error, missing string terminator\n"
 msgstr " *** bd, brak znaku koczcego cig\n"
 
-#: src/readelf.c:11143
+#: src/readelf.c:11144
 #, c-format
 msgid " Length:        %8<PRIu64>\n"
 msgstr " Dugo:         %8<PRIu64>\n"
 
-#: src/readelf.c:11145
+#: src/readelf.c:11146
 #, c-format
 msgid " Offset size:   %8<PRIu8>\n"
 msgstr " Rozmiar offsetu: %8<PRIu8>\n"
 
-#: src/readelf.c:11159
+#: src/readelf.c:11160
 #, c-format
 msgid " DWARF version: %8<PRIu16>\n"
 msgstr " Wersja DWARF:    %8<PRIu16>\n"
 
-#: src/readelf.c:11168
+#: src/readelf.c:11169
 #, c-format
 msgid " Padding:       %8<PRIx16>\n"
 msgstr " Wypenienie:     %8<PRIx16>\n"
 
-#: src/readelf.c:11222
+#: src/readelf.c:11223
 #, c-format
 msgid ""
 "\n"
@@ -6164,7 +6170,7 @@ msgstr ""
 "\n"
 "Sekcja tabeli wyszukiwania ramki wywoania [%2zu] .eh_frame_hdr:\n"
 
-#: src/readelf.c:11324
+#: src/readelf.c:11325
 #, c-format
 msgid ""
 "\n"
@@ -6173,22 +6179,22 @@ msgstr ""
 "\n"
 "Sekcja tabeli obsugiwania wyjtkw [%2zu] .gcc_except_table:\n"
 
-#: src/readelf.c:11347
+#: src/readelf.c:11348
 #, c-format
 msgid " LPStart encoding:    %#x "
 msgstr " Kodowanie LPStart:    %#x "
 
-#: src/readelf.c:11359
+#: src/readelf.c:11360
 #, c-format
 msgid " TType encoding:      %#x "
 msgstr " Kodowanie TType:      %#x "
 
-#: src/readelf.c:11376
+#: src/readelf.c:11377
 #, c-format
 msgid " Call site encoding:  %#x "
 msgstr " Kodowanie strony wywoania:  %#x "
 
-#: src/readelf.c:11391
+#: src/readelf.c:11392
 msgid ""
 "\n"
 " Call site table:"
@@ -6196,7 +6202,7 @@ msgstr ""
 "\n"
 " Tabela strony wywoania:"
 
-#: src/readelf.c:11407
+#: src/readelf.c:11408
 #, c-format
 msgid ""
 " [%4u] Call site start:   %#<PRIx64>\n"
@@ -6209,12 +6215,12 @@ msgstr ""
 "        Ldowisko:                 %#<PRIx64>\n"
 "        Dziaanie:                 %u\n"
 
-#: src/readelf.c:11480
+#: src/readelf.c:11481
 #, c-format
 msgid "invalid TType encoding"
 msgstr "nieprawidowe kodowanie TType"
 
-#: src/readelf.c:11507
+#: src/readelf.c:11508
 #, c-format
 msgid ""
 "\n"
@@ -6223,43 +6229,43 @@ msgstr ""
 "\n"
 "Sekcja GDB [%2zu] %s pod offsetem %#<PRIx64> zawiera %<PRId64>B:\n"
 
-#: src/readelf.c:11536
+#: src/readelf.c:11537
 #, c-format
 msgid " Version:         %<PRId32>\n"
 msgstr " Wersja:         %<PRId32>\n"
 
-#: src/readelf.c:11555
+#: src/readelf.c:11556
 #, c-format
 msgid " CU offset:       %#<PRIx32>\n"
 msgstr " offset CU:       %#<PRIx32>\n"
 
-#: src/readelf.c:11562
+#: src/readelf.c:11563
 #, c-format
 msgid " TU offset:       %#<PRIx32>\n"
 msgstr " offset TU:       %#<PRIx32>\n"
 
-#: src/readelf.c:11569
+#: src/readelf.c:11570
 #, c-format
 msgid " address offset:  %#<PRIx32>\n"
 msgstr " offset adresu:  %#<PRIx32>\n"
 
-#: src/readelf.c:11576
+#: src/readelf.c:11577
 #, c-format
 msgid " symbol offset:   %#<PRIx32>\n"
 msgstr " offset symbolu:   %#<PRIx32>\n"
 
-#: src/readelf.c:11586
+#: src/readelf.c:11587
 #, fuzzy, c-format
 #| msgid " constant offset: %#<PRIx32>\n"
 msgid " shortcut offset: %#<PRIx32>\n"
 msgstr " offset staej: %#<PRIx32>\n"
 
-#: src/readelf.c:11594
+#: src/readelf.c:11595
 #, c-format
 msgid " constant offset: %#<PRIx32>\n"
 msgstr " offset staej: %#<PRIx32>\n"
 
-#: src/readelf.c:11608
+#: src/readelf.c:11609
 #, c-format
 msgid ""
 "\n"
@@ -6268,7 +6274,7 @@ msgstr ""
 "\n"
 " Lista CU pod offsetem %#<PRIx32> zawiera %zu wpisw:\n"
 
-#: src/readelf.c:11633
+#: src/readelf.c:11634
 #, c-format
 msgid ""
 "\n"
@@ -6277,7 +6283,7 @@ msgstr ""
 "\n"
 " Lista TU pod offsetem %#<PRIx32> zawiera %zu wpisw:\n"
 
-#: src/readelf.c:11662
+#: src/readelf.c:11663
 #, c-format
 msgid ""
 "\n"
@@ -6286,7 +6292,7 @@ msgstr ""
 "\n"
 " Lista adresw pod offsetem %#<PRIx32> zawiera %zu wpisw:\n"
 
-#: src/readelf.c:11705
+#: src/readelf.c:11706
 #, c-format
 msgid ""
 "\n"
@@ -6295,7 +6301,7 @@ msgstr ""
 "\n"
 " Tabela symboli pod offsetem %#<PRIx32> zawiera %zu gniazd:\n"
 
-#: src/readelf.c:11790
+#: src/readelf.c:11791
 #, fuzzy, c-format
 #| msgid ""
 #| "\n"
@@ -6307,28 +6313,28 @@ msgstr ""
 "\n"
 " Tabela symboli pod offsetem %#<PRIx32> zawiera %zu gniazd:\n"
 
-#: src/readelf.c:11802
+#: src/readelf.c:11803
 #, c-format
 msgid "Language of main: %s\n"
 msgstr ""
 
-#: src/readelf.c:11803
+#: src/readelf.c:11804
 #, c-format
 msgid "Name of main: "
 msgstr ""
 
-#: src/readelf.c:11886
+#: src/readelf.c:11887
 #, c-format
 msgid "cannot get debug context descriptor: %s"
 msgstr "nie mona uzyska deskryptora kontekstu debugowania: %s"
 
-#: src/readelf.c:12252 src/readelf.c:12872 src/readelf.c:12982
-#: src/readelf.c:13039
+#: src/readelf.c:12253 src/readelf.c:12873 src/readelf.c:12983
+#: src/readelf.c:13040
 #, c-format
 msgid "cannot convert core note data: %s"
 msgstr "nie mona konwertowa danych notatki core: %s"
 
-#: src/readelf.c:12616
+#: src/readelf.c:12617
 #, c-format
 msgid ""
 "\n"
@@ -6337,21 +6343,21 @@ msgstr ""
 "\n"
 "%*s <powtarza si jeszcze %u razy>"
 
-#: src/readelf.c:13118
+#: src/readelf.c:13119
 msgid "  Owner          Data size  Type\n"
 msgstr "  Waciciel     Rozmiar danych  Typ\n"
 
-#: src/readelf.c:13146
+#: src/readelf.c:13147
 #, c-format
 msgid "  %-13.*s  %9<PRId32>  %s\n"
 msgstr "  %-13.*s  %9<PRId32>  %s\n"
 
-#: src/readelf.c:13198
+#: src/readelf.c:13199
 #, c-format
 msgid "cannot get content of note: %s"
 msgstr "nie mona uzyska zawartoci notatki: %s"
 
-#: src/readelf.c:13231
+#: src/readelf.c:13232
 #, c-format
 msgid ""
 "\n"
@@ -6361,7 +6367,7 @@ msgstr ""
 "Segment notatki [%2zu] %s odugoci %<PRIu64>B pod offsetem "
 "%#0<PRIx64>:\n"
 
-#: src/readelf.c:13254
+#: src/readelf.c:13255
 #, c-format
 msgid ""
 "\n"
@@ -6370,7 +6376,7 @@ msgstr ""
 "\n"
 "Segment notatki odugoci %<PRIu64>B pod offsetem %#0<PRIx64>:\n"
 
-#: src/readelf.c:13301
+#: src/readelf.c:13302
 #, c-format
 msgid ""
 "\n"
@@ -6379,12 +6385,12 @@ msgstr ""
 "\n"
 "Sekcja [%zu] %s nie ma danych do zrzucenia.\n"
 
-#: src/readelf.c:13328 src/readelf.c:13379
+#: src/readelf.c:13329 src/readelf.c:13380
 #, c-format
 msgid "cannot get data for section [%zu] '%s': %s"
 msgstr "nie mona uzyska danych dla sekcji [%zu] %s: %s"
 
-#: src/readelf.c:13333
+#: src/readelf.c:13334
 #, c-format
 msgid ""
 "\n"
@@ -6394,7 +6400,7 @@ msgstr ""
 "Segment zrzutu szesnastkowego [%zu] %s, %<PRIu64>B pod offsetem "
 "%#0<PRIx64>:\n"
 
-#: src/readelf.c:13338
+#: src/readelf.c:13339
 #, c-format
 msgid ""
 "\n"
@@ -6405,7 +6411,7 @@ msgstr ""
 "Zrzut szesnastkowy sekcji [%zu] %s, %<PRIu64>B (%zd nieskompresowanych) "
 "pod offsetem %#0<PRIx64>:\n"
 
-#: src/readelf.c:13352
+#: src/readelf.c:13353
 #, c-format
 msgid ""
 "\n"
@@ -6414,7 +6420,7 @@ msgstr ""
 "\n"
 "Sekcja [%zu] %s nie ma cigw do zrzucenia.\n"
 
-#: src/readelf.c:13384
+#: src/readelf.c:13385
 #, c-format
 msgid ""
 "\n"
@@ -6423,7 +6429,7 @@ msgstr ""
 "\n"
 "Sekcja cigw [%zu] %s zawiera %<PRIu64>B pod offsetem %#0<PRIx64>:\n"
 
-#: src/readelf.c:13389
+#: src/readelf.c:13390
 #, c-format
 msgid ""
 "\n"
@@ -6434,7 +6440,7 @@ msgstr ""
 "Sekcja cigw [%zu] %s zawiera %<PRIu64>B (%zd nieskompresowanych) pod "
 "offsetem %#0<PRIx64>:\n"
 
-#: src/readelf.c:13437
+#: src/readelf.c:13438
 #, c-format
 msgid ""
 "\n"
@@ -6443,7 +6449,7 @@ msgstr ""
 "\n"
 "sekcja [%lu] nie istnieje"
 
-#: src/readelf.c:13467
+#: src/readelf.c:13468
 #, c-format
 msgid ""
 "\n"
@@ -6452,12 +6458,12 @@ msgstr ""
 "\n"
 "sekcja %s nie istnieje"
 
-#: src/readelf.c:13522
+#: src/readelf.c:13523
 #, c-format
 msgid "cannot get symbol index of archive '%s': %s"
 msgstr "nie mona uzyska indeksu symboli archiwum %s: %s"
 
-#: src/readelf.c:13525
+#: src/readelf.c:13526
 #, c-format
 msgid ""
 "\n"
@@ -6466,7 +6472,7 @@ msgstr ""
 "\n"
 "Archiwum %s nie ma indeksu symboli\n"
 
-#: src/readelf.c:13529
+#: src/readelf.c:13530
 #, c-format
 msgid ""
 "\n"
@@ -6475,12 +6481,12 @@ msgstr ""
 "\n"
 "Indeks archiwum %s ma %zu wpisw:\n"
 
-#: src/readelf.c:13547
+#: src/readelf.c:13548
 #, c-format
 msgid "cannot extract member at offset %zu in '%s': %s"
 msgstr "nie mona wydoby elementw pod offsetem %zu w%s: %s"
 
-#: src/readelf.c:13552
+#: src/readelf.c:13553
 #, c-format
 msgid "Archive member '%s' contains:\n"
 msgstr "Element archiwum %s zawiera:\n"
@@ -7145,7 +7151,7 @@ msgstr "nie mona utworzy nagwka ELF: %s"
 msgid "cannot get shdrstrndx:%s"
 msgstr "nie mona uzyska shdrstrndx: %s"
 
-#: src/unstrip.c:243 src/unstrip.c:2085
+#: src/unstrip.c:243 src/unstrip.c:2136
 #, c-format
 msgid "cannot get ELF header: %s"
 msgstr "nie mona uzyska nagwka ELF: %s"
@@ -7165,12 +7171,12 @@ msgstr "nie mona zaktualizowa nowej sekcji zerowej: %s"
 msgid "cannot copy ELF header: %s"
 msgstr "nie mona skopiowa nagwka ELF: %s"
 
-#: src/unstrip.c:264 src/unstrip.c:2103 src/unstrip.c:2146
+#: src/unstrip.c:264 src/unstrip.c:2154 src/unstrip.c:2197
 #, c-format
 msgid "cannot get number of program headers: %s"
 msgstr "nie mona uzyska liczby nagwkw programu: %s"
 
-#: src/unstrip.c:269 src/unstrip.c:2107
+#: src/unstrip.c:269 src/unstrip.c:2158
 #, c-format
 msgid "cannot create program headers: %s"
 msgstr "nie mona utworzy nagwkw programu: %s"
@@ -7185,12 +7191,12 @@ msgstr "nie mona skopiowa nagwka programu: %s"
 msgid "cannot copy section header: %s"
 msgstr "nie mona skopiowa nagwka sekcji: %s"
 
-#: src/unstrip.c:288 src/unstrip.c:1707
+#: src/unstrip.c:288 src/unstrip.c:1748
 #, c-format
 msgid "cannot get section data: %s"
 msgstr "nie mona uzyska danych sekcji: %s"
 
-#: src/unstrip.c:290 src/unstrip.c:1709
+#: src/unstrip.c:290 src/unstrip.c:1750
 #, c-format
 msgid "cannot copy section data: %s"
 msgstr "nie mona skopiowa danych sekcji: %s"
@@ -7200,14 +7206,14 @@ msgstr "nie mona skopiowa danych sekcji: %s"
 msgid "cannot create directory '%s'"
 msgstr "nie mona utworzy katalogu %s"
 
-#: src/unstrip.c:392 src/unstrip.c:657 src/unstrip.c:691 src/unstrip.c:859
-#: src/unstrip.c:1749
+#: src/unstrip.c:392 src/unstrip.c:666 src/unstrip.c:700 src/unstrip.c:868
+#: src/unstrip.c:1790
 #, c-format
 msgid "cannot get symbol table entry: %s"
 msgstr "nie mona uzyska wpisu tabeli symboli: %s"
 
-#: src/unstrip.c:408 src/unstrip.c:660 src/unstrip.c:681 src/unstrip.c:694
-#: src/unstrip.c:1770 src/unstrip.c:1965 src/unstrip.c:1989
+#: src/unstrip.c:408 src/unstrip.c:669 src/unstrip.c:690 src/unstrip.c:703
+#: src/unstrip.c:1811 src/unstrip.c:2007 src/unstrip.c:2031
 #, c-format
 msgid "cannot update symbol table: %s"
 msgstr "nie mona zaktualizowa tabeli symboli: %s"
@@ -7242,149 +7248,164 @@ msgstr "nie mona uzyska wersji symbolu: %s"
 msgid "unexpected section type in [%zu] with sh_link to symtab"
 msgstr "nieoczekiwany typ sekcji w[%zu] zsh_link do tabeli symboli"
 
-#: src/unstrip.c:848
+#: src/unstrip.c:857
 #, c-format
 msgid "cannot get symbol section data: %s"
 msgstr "nie mona uzyska danych sekcji symboli: %s"
 
-#: src/unstrip.c:850
+#: src/unstrip.c:859
 #, c-format
 msgid "cannot get string section data: %s"
 msgstr "nie mona uzyska danych sekcji cigw: %s"
 
-#: src/unstrip.c:867
+#: src/unstrip.c:876
 #, c-format
 msgid "invalid string offset in symbol [%zu]"
 msgstr "nieprawidowy offset cigu wsymbolu [%zu]"
 
-#: src/unstrip.c:1025 src/unstrip.c:1433
+#: src/unstrip.c:939
+msgid "found two identical index map positions."
+msgstr ""
+
+#: src/unstrip.c:990
+msgid "section symbols in unexpected order"
+msgstr ""
+
+#: src/unstrip.c:996
+#, fuzzy
+#| msgid "Show demangled symbols (ARG is always ignored)"
+msgid "found two identical symbols"
+msgstr ""
+"Wywietla symbole zusunitym dekorowaniem (PARAMETR jest zawsze ignorowany)"
+
+#: src/unstrip.c:1066 src/unstrip.c:1474
 #, c-format
 msgid "cannot read section [%zu] name: %s"
 msgstr "nie mona odczyta nazwy sekcji [%zu]: %s"
 
-#: src/unstrip.c:1040
+#: src/unstrip.c:1081
 #, c-format
 msgid "bad sh_link for group section: %s"
 msgstr "bdne sh_link dla sekcji grupy: %s"
 
-#: src/unstrip.c:1046
+#: src/unstrip.c:1087
 #, c-format
 msgid "couldn't get shdr for group section: %s"
 msgstr "nie mona uzyska shdr dla sekcji grupy: %s"
 
-#: src/unstrip.c:1051
+#: src/unstrip.c:1092
 #, c-format
 msgid "bad data for group symbol section: %s"
 msgstr "bdne dane dla sekcji symboli grupy: %s"
 
-#: src/unstrip.c:1057
+#: src/unstrip.c:1098
 #, c-format
 msgid "couldn't get symbol for group section: %s"
 msgstr "nie mona uzyska symbolu dla sekcji grupy: %s"
 
-#: src/unstrip.c:1062
+#: src/unstrip.c:1103
 #, c-format
 msgid "bad symbol name for group section: %s"
 msgstr "bdna nazwa symbolu dla sekcji grupy: %s"
 
-#: src/unstrip.c:1073 src/unstrip.c:1553
+#: src/unstrip.c:1114 src/unstrip.c:1594
 #, c-format
 msgid "cannot find matching section for [%zu] '%s'"
 msgstr "nie mona odnale pasujcej sekcji dla [%zu] %s"
 
-#: src/unstrip.c:1118 src/unstrip.c:1137 src/unstrip.c:1175
+#: src/unstrip.c:1159 src/unstrip.c:1178 src/unstrip.c:1216
 #, c-format
 msgid "cannot read '.gnu.prelink_undo' section: %s"
 msgstr "nie mona odczyta sekcji .gnu.prelink_undo: %s"
 
-#: src/unstrip.c:1155
+#: src/unstrip.c:1196
 #, c-format
 msgid "overflow with shnum = %zu in '%s' section"
 msgstr "przepenienie zshnum = %zu wsekcji %s"
 
-#: src/unstrip.c:1166
+#: src/unstrip.c:1207
 #, c-format
 msgid "invalid contents in '%s' section"
 msgstr "nieprawidowa zawarto wsekcji %s"
 
-#: src/unstrip.c:1337 src/unstrip.c:1353 src/unstrip.c:1633 src/unstrip.c:1924
+#: src/unstrip.c:1378 src/unstrip.c:1394 src/unstrip.c:1674 src/unstrip.c:1966
 #, c-format
 msgid "cannot add section name to string table: %s"
 msgstr "nie mona nazwy sekcji do tabeli cigw: %s"
 
-#: src/unstrip.c:1362
+#: src/unstrip.c:1403
 #, c-format
 msgid "cannot update section header string table data: %s"
 msgstr "nie mona zaktualizowa danych tabeli cigw nagwkw sekcji: %s"
 
-#: src/unstrip.c:1391 src/unstrip.c:1395
+#: src/unstrip.c:1432 src/unstrip.c:1436
 #, c-format
 msgid "cannot get section header string table section index: %s"
 msgstr "nie mona uzyska indeksu sekcji tabeli cigw nagwkw sekcji: %s"
 
-#: src/unstrip.c:1399 src/unstrip.c:1403 src/unstrip.c:1648
+#: src/unstrip.c:1440 src/unstrip.c:1444 src/unstrip.c:1689
 #, c-format
 msgid "cannot get section count: %s"
 msgstr "nie mona uzyska licznika sekcji: %s"
 
-#: src/unstrip.c:1406
+#: src/unstrip.c:1447
 msgid "more sections in stripped file than debug file -- arguments reversed?"
 msgstr ""
 "wicej sekcji wokrojonym pliku ni wpliku debugowania  odwrcono "
 "parametry?"
 
-#: src/unstrip.c:1410
+#: src/unstrip.c:1451
 msgid "no sections in stripped file"
 msgstr "brak sekcji wokrojonym pliku"
 
-#: src/unstrip.c:1458 src/unstrip.c:1568
+#: src/unstrip.c:1499 src/unstrip.c:1609
 #, c-format
 msgid "cannot read section header string table: %s"
 msgstr "nie mona odczyta tabeli cigw nagwkw sekcji: %s"
 
-#: src/unstrip.c:1627
+#: src/unstrip.c:1668
 #, c-format
 msgid "cannot add new section: %s"
 msgstr "nie mona doda nowej sekcji: %s"
 
-#: src/unstrip.c:1757
+#: src/unstrip.c:1798
 #, c-format
 msgid "symbol [%zu] has invalid section index"
 msgstr "symbol [%zu] ma nieprawidowy indeks sekcji"
 
-#: src/unstrip.c:1789
+#: src/unstrip.c:1830
 #, c-format
 msgid "group has invalid section index [%zd]"
 msgstr "grupa ma nieprawidowy indeks sekcji [%zd]"
 
-#: src/unstrip.c:2064
+#: src/unstrip.c:2115
 #, c-format
 msgid "cannot read section data: %s"
 msgstr "nie mona odczyta danych sekcji: %s"
 
-#: src/unstrip.c:2093
+#: src/unstrip.c:2144
 #, c-format
 msgid "cannot update ELF header: %s"
 msgstr "nie mona zaktualizowa nagwka ELF: %s"
 
-#: src/unstrip.c:2117
+#: src/unstrip.c:2168
 #, c-format
 msgid "cannot update program header: %s"
 msgstr "nie mona zaktualizowa nagwka programu: %s"
 
-#: src/unstrip.c:2122 src/unstrip.c:2205
+#: src/unstrip.c:2173 src/unstrip.c:2256
 #, c-format
 msgid "cannot write output file: %s"
 msgstr "nie mona zapisa pliku wyjciowego: %s"
 
-#: src/unstrip.c:2173
+#: src/unstrip.c:2224
 #, c-format
 msgid "DWARF data not adjusted for prelinking bias; consider prelink -u"
 msgstr ""
 "Dane DWARF nie zostay dostosowane do przesunicia wczesnego konsolidowania; "
 "prosz rozway polecenie prelink -u"
 
-#: src/unstrip.c:2176
+#: src/unstrip.c:2227
 #, c-format
 msgid ""
 "DWARF data in '%s' not adjusted for prelinking bias; consider prelink -u"
@@ -7392,75 +7413,75 @@ msgstr ""
 "Dane DWARF w%s nie zostay dostosowane do przesunicia wczesnego "
 "konsolidowania; prosz rozway polecenie prelink -u"
 
-#: src/unstrip.c:2196 src/unstrip.c:2248 src/unstrip.c:2260 src/unstrip.c:2350
+#: src/unstrip.c:2247 src/unstrip.c:2299 src/unstrip.c:2311 src/unstrip.c:2401
 #, c-format
 msgid "cannot create ELF descriptor: %s"
 msgstr "nie mona utworzy deskryptora ELF: %s"
 
-#: src/unstrip.c:2234
+#: src/unstrip.c:2285
 msgid "WARNING: "
 msgstr "OSTRZEENIE: "
 
-#: src/unstrip.c:2236
+#: src/unstrip.c:2287
 msgid ", use --force"
 msgstr ", naley uy opcji --force"
 
-#: src/unstrip.c:2264
+#: src/unstrip.c:2315
 msgid "ELF header identification (e_ident) different"
 msgstr "Rna identyfikacja nagwka ELF (e_ident)"
 
-#: src/unstrip.c:2268
+#: src/unstrip.c:2319
 msgid "ELF header type (e_type) different"
 msgstr "Rne typy nagwka ELF (e_type)"
 
-#: src/unstrip.c:2272
+#: src/unstrip.c:2323
 msgid "ELF header machine type (e_machine) different"
 msgstr "Rne typy maszyny nagwka ELF (e_machine)"
 
-#: src/unstrip.c:2276
+#: src/unstrip.c:2327
 msgid "stripped program header (e_phnum) smaller than unstripped"
 msgstr "okrojony nagwek programu (e_phnum) jest mniejszy ni nieokrojony"
 
-#: src/unstrip.c:2307
+#: src/unstrip.c:2358
 #, c-format
 msgid "cannot find stripped file for module '%s': %s"
 msgstr "nie mona odnale okrojonego pliku dla moduu %s: %s"
 
-#: src/unstrip.c:2311
+#: src/unstrip.c:2362
 #, c-format
 msgid "cannot open stripped file '%s' for module '%s': %s"
 msgstr "nie mona otworzy okrojonego pliku %s dla moduu %s: %s"
 
-#: src/unstrip.c:2326
+#: src/unstrip.c:2377
 #, c-format
 msgid "cannot find debug file for module '%s': %s"
 msgstr "nie mona odnale pliku debugowania dla moduu %s: %s"
 
-#: src/unstrip.c:2330
+#: src/unstrip.c:2381
 #, c-format
 msgid "cannot open debug file '%s' for module '%s': %s"
 msgstr "nie mona otworzy pliku debugowania %s dla moduu %s: %s"
 
-#: src/unstrip.c:2343
+#: src/unstrip.c:2394
 #, c-format
 msgid "module '%s' file '%s' is not stripped"
 msgstr "modu %s pliku %s nie zosta okrojony"
 
-#: src/unstrip.c:2374
+#: src/unstrip.c:2425
 #, c-format
 msgid "cannot cache section addresses for module '%s': %s"
 msgstr ""
 "nie mona utworzy pamici podrcznej adresw sekcji dla moduu %s: %s"
 
-#: src/unstrip.c:2502
+#: src/unstrip.c:2553
 msgid "no matching modules found"
 msgstr "nie odnaleziono pasujcych moduw"
 
-#: src/unstrip.c:2512
+#: src/unstrip.c:2563
 msgid "matched more than one module"
 msgstr "pasuje wicej ni jeden modu"
 
-#: src/unstrip.c:2557
+#: src/unstrip.c:2608
 msgid ""
 "STRIPPED-FILE DEBUG-FILE\n"
 "[MODULE...]"
@@ -7468,7 +7489,7 @@ msgstr ""
 "OKROJONY-PLIK PLIK-DEBUGOWANIA\n"
 "[MODU]"
 
-#: src/unstrip.c:2558
+#: src/unstrip.c:2609
 msgid ""
 "Combine stripped files with separate symbols and debug information.\n"
 "\n"
diff --git a/po/uk.po b/po/uk.po
index 86f43ddf..f7007561 100644
--- a/po/uk.po
+++ b/po/uk.po
@@ -7,7 +7,7 @@ msgid ""
 msgstr ""
 "Project-Id-Version: elfutils\n"
 "Report-Msgid-Bugs-To: https://sourceware.org/bugzilla/\n"
-"POT-Creation-Date: 2023-11-03 17:36+0100\n"
+"POT-Creation-Date: 2024-03-01 10:22-0500\n"
 "PO-Revision-Date: 2020-03-28 14:59+0200\n"
 "Last-Translator: Yuri Chornoivan <yurchor@ukr.net>\n"
 "Language-Team: Ukrainian <kde-i18n-uk@kde.org>\n"
@@ -53,7 +53,7 @@ msgstr ""
 " .       "
 ",        .\n"
 
-#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12202
+#: lib/xmalloc.c:47 lib/xmalloc.c:60 lib/xmalloc.c:72 src/readelf.c:12203
 #: src/unstrip.c:311
 #, c-format
 msgid "memory exhausted"
@@ -304,7 +304,13 @@ msgstr "  "
 msgid ".debug_addr section missing"
 msgstr "  .debug_addr"
 
-#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2547
+#: libdw/dwarf_error.c:105
+#, fuzzy
+#| msgid "unknown version"
+msgid "unknown section"
+msgstr " "
+
+#: libdwfl/argp-std.c:45 src/stack.c:643 src/unstrip.c:2598
 msgid "Input selection options:"
 msgstr "   :"
 
@@ -635,7 +641,7 @@ msgstr "   
 msgid "invalid size of destination operand"
 msgstr "   "
 
-#: libelf/elf_error.c:86 src/readelf.c:6758
+#: libelf/elf_error.c:86 src/readelf.c:6759
 #, c-format
 msgid "invalid encoding"
 msgstr " "
@@ -720,8 +726,8 @@ msgstr "  data/scn"
 msgid "invalid section header"
 msgstr "  "
 
-#: libelf/elf_error.c:190 src/readelf.c:10637 src/readelf.c:11242
-#: src/readelf.c:11343 src/readelf.c:11531
+#: libelf/elf_error.c:190 src/readelf.c:10638 src/readelf.c:11243
+#: src/readelf.c:11344 src/readelf.c:11532
 #, c-format
 msgid "invalid data"
 msgstr " "
@@ -1623,7 +1629,7 @@ msgstr "  %s  --gaps."
 
 #: src/elfcmp.c:733 src/findtextrel.c:194 src/nm.c:363 src/ranlib.c:140
 #: src/size.c:271 src/strings.c:184 src/strip.c:1040 src/strip.c:1077
-#: src/unstrip.c:2194 src/unstrip.c:2223
+#: src/unstrip.c:2245 src/unstrip.c:2274
 #, c-format
 msgid "cannot open '%s'"
 msgstr "   %s"
@@ -4022,9 +4028,9 @@ msgstr "    "
 #: src/nm.c:742 src/nm.c:1234 src/objdump.c:778 src/readelf.c:685
 #: src/readelf.c:1506 src/readelf.c:1655 src/readelf.c:1882 src/readelf.c:2123
 #: src/readelf.c:2312 src/readelf.c:2482 src/readelf.c:2604 src/readelf.c:2854
-#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3896
-#: src/readelf.c:3944 src/readelf.c:4013 src/readelf.c:12029
-#: src/readelf.c:13212 src/readelf.c:13422 src/readelf.c:13490 src/size.c:396
+#: src/readelf.c:3140 src/readelf.c:3215 src/readelf.c:3301 src/readelf.c:3897
+#: src/readelf.c:3945 src/readelf.c:4014 src/readelf.c:12030
+#: src/readelf.c:13213 src/readelf.c:13423 src/readelf.c:13491 src/size.c:396
 #: src/size.c:467 src/strip.c:1093
 #, c-format
 msgid "cannot get section header string table index"
@@ -4375,11 +4381,11 @@ msgstr "    
 msgid "cannot get section: %s"
 msgstr "   : %s"
 
-#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13442
-#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:610
-#: src/unstrip.c:631 src/unstrip.c:671 src/unstrip.c:887 src/unstrip.c:1222
-#: src/unstrip.c:1349 src/unstrip.c:1373 src/unstrip.c:1429 src/unstrip.c:1470
-#: src/unstrip.c:1662 src/unstrip.c:1813 src/unstrip.c:1956 src/unstrip.c:2055
+#: src/readelf.c:703 src/readelf.c:1329 src/readelf.c:1537 src/readelf.c:13443
+#: src/unstrip.c:396 src/unstrip.c:427 src/unstrip.c:490 src/unstrip.c:622
+#: src/unstrip.c:640 src/unstrip.c:680 src/unstrip.c:897 src/unstrip.c:1263
+#: src/unstrip.c:1390 src/unstrip.c:1414 src/unstrip.c:1470 src/unstrip.c:1511
+#: src/unstrip.c:1703 src/unstrip.c:1854 src/unstrip.c:1998 src/unstrip.c:2106
 #, c-format
 msgid "cannot get section header: %s"
 msgstr "    : %s"
@@ -4389,8 +4395,8 @@ msgstr "    :
 msgid "cannot get section name"
 msgstr "    "
 
-#: src/readelf.c:720 src/readelf.c:7176 src/readelf.c:11230 src/readelf.c:11332
-#: src/readelf.c:11516
+#: src/readelf.c:720 src/readelf.c:7177 src/readelf.c:11231 src/readelf.c:11333
+#: src/readelf.c:11517
 #, c-format
 msgid "cannot get %s content: %s"
 msgstr "    %s: %s"
@@ -4738,7 +4744,7 @@ msgstr ""
 "    :\n"
 "   ..."
 
-#: src/readelf.c:1519 src/unstrip.c:2114 src/unstrip.c:2156 src/unstrip.c:2163
+#: src/readelf.c:1519 src/unstrip.c:2165 src/unstrip.c:2207 src/unstrip.c:2214
 #, c-format
 msgid "cannot get program header: %s"
 msgstr "    : %s"
@@ -4787,19 +4793,19 @@ msgstr "< >"
 msgid "<INVALID SECTION>"
 msgstr "< >"
 
-#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3912 src/readelf.c:4212
-#: src/readelf.c:13314 src/readelf.c:13321 src/readelf.c:13365
-#: src/readelf.c:13372
+#: src/readelf.c:1713 src/readelf.c:2614 src/readelf.c:3913 src/readelf.c:4213
+#: src/readelf.c:13315 src/readelf.c:13322 src/readelf.c:13366
+#: src/readelf.c:13373
 msgid "Couldn't uncompress section"
 msgstr "   "
 
-#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3916
+#: src/readelf.c:1717 src/readelf.c:2619 src/readelf.c:3917
 #, c-format
 msgid "cannot get section [%zd] header: %s"
 msgstr "     [%zd]: %s"
 
 #: src/readelf.c:1886 src/readelf.c:2860 src/readelf.c:3146 src/readelf.c:3221
-#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5962
+#: src/readelf.c:3524 src/readelf.c:3598 src/readelf.c:5963
 #, c-format
 msgid "invalid sh_link value in section %zu"
 msgstr "  sh_link   %zu"
@@ -5170,7 +5176,7 @@ msgstr "      0  %6<PRIu32>      %5.1f%%\n"
 msgid "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 msgstr "%7d  %6<PRIu32>      %5.1f%%    %5.1f%%\n"
 
-#: src/readelf.c:3647
+#: src/readelf.c:3648
 #, c-format
 msgid ""
 " Average number of tests:   successful lookup: %f\n"
@@ -5179,37 +5185,37 @@ msgstr ""
 "   :    : %f\n"
 "\t\t\t   : %f\n"
 
-#: src/readelf.c:3665 src/readelf.c:3729 src/readelf.c:3795
+#: src/readelf.c:3666 src/readelf.c:3730 src/readelf.c:3796
 #, c-format
 msgid "cannot get data for section %d: %s"
 msgstr "      %d: %s"
 
-#: src/readelf.c:3673
+#: src/readelf.c:3674
 #, c-format
 msgid "invalid data in sysv.hash section %d"
 msgstr "    sysv.hash %d"
 
-#: src/readelf.c:3702
+#: src/readelf.c:3703
 #, c-format
 msgid "invalid chain in sysv.hash section %d"
 msgstr "    sysv.hash %d"
 
-#: src/readelf.c:3737
+#: src/readelf.c:3738
 #, c-format
 msgid "invalid data in sysv.hash64 section %d"
 msgstr "    sysv.hash64 %d"
 
-#: src/readelf.c:3768
+#: src/readelf.c:3769
 #, c-format
 msgid "invalid chain in sysv.hash64 section %d"
 msgstr "    sysv.hash64 %d"
 
-#: src/readelf.c:3804
+#: src/readelf.c:3805
 #, c-format
 msgid "invalid data in gnu.hash section %d"
 msgstr "    gnu.hash %d"
 
-#: src/readelf.c:3870
+#: src/readelf.c:3871
 #, c-format
 msgid ""
 " Symbol Bias: %u\n"
@@ -5219,7 +5225,7 @@ msgstr ""
 "   : %zu   %<PRIuFAST32>%%     "
 "2- : %u\n"
 
-#: src/readelf.c:3955
+#: src/readelf.c:3956
 #, c-format
 msgid ""
 "\n"
@@ -5240,7 +5246,7 @@ msgstr[2] ""
 "   [%2zu] %s   %#0<PRIx64>  %d "
 ":\n"
 
-#: src/readelf.c:3969
+#: src/readelf.c:3970
 msgid ""
 "       Library                       Time Stamp          Checksum Version "
 "Flags"
@@ -5248,7 +5254,7 @@ msgstr ""
 "                                          "
 ""
 
-#: src/readelf.c:4029
+#: src/readelf.c:4030
 #, c-format
 msgid ""
 "\n"
@@ -5259,107 +5265,107 @@ msgstr ""
 "   [%2zu] %s  %<PRIu64>    "
 "%#0<PRIx64>:\n"
 
-#: src/readelf.c:4046
+#: src/readelf.c:4047
 msgid "  Owner          Size\n"
 msgstr "          \n"
 
-#: src/readelf.c:4070
+#: src/readelf.c:4071
 #, c-format
 msgid "  %-13s  %4<PRIu32>\n"
 msgstr "  %-13s  %4<PRIu32>\n"
 
 #. Unknown subsection, print and skip.
-#: src/readelf.c:4109
+#: src/readelf.c:4110
 #, c-format
 msgid "    %-4u %12<PRIu32>\n"
 msgstr "    %-4u %12<PRIu32>\n"
 
 #. Tag_File
-#: src/readelf.c:4114
+#: src/readelf.c:4115
 #, c-format
 msgid "    File: %11<PRIu32>\n"
 msgstr "    : %11<PRIu32>\n"
 
-#: src/readelf.c:4164
+#: src/readelf.c:4165
 #, c-format
 msgid "      %s: %<PRId64>, %s\n"
 msgstr "      %s: %<PRId64>, %s\n"
 
-#: src/readelf.c:4167
+#: src/readelf.c:4168
 #, c-format
 msgid "      %s: %<PRId64>\n"
 msgstr "      %s: %<PRId64>\n"
 
-#: src/readelf.c:4170
+#: src/readelf.c:4171
 #, c-format
 msgid "      %s: %s\n"
 msgstr "      %s: %s\n"
 
-#: src/readelf.c:4180
+#: src/readelf.c:4181
 #, c-format
 msgid "      %u: %<PRId64>\n"
 msgstr "      %u: %<PRId64>\n"
 
-#: src/readelf.c:4183
+#: src/readelf.c:4184
 #, c-format
 msgid "      %u: %s\n"
 msgstr "      %u: %s\n"
 
-#: src/readelf.c:4221
+#: src/readelf.c:4222
 #, fuzzy
 #| msgid "couldn't get shdr for group section: %s"
 msgid "Couldn't get data from section"
 msgstr "   shdr   : %s"
 
-#: src/readelf.c:4286
+#: src/readelf.c:4287
 msgid "sprintf failure"
 msgstr " sprintf"
 
-#: src/readelf.c:4770
+#: src/readelf.c:4771
 msgid "empty block"
 msgstr " "
 
-#: src/readelf.c:4773
+#: src/readelf.c:4774
 #, c-format
 msgid "%zu byte block:"
 msgstr "%zu- :"
 
-#: src/readelf.c:5251
+#: src/readelf.c:5252
 #, c-format
 msgid "%*s[%2<PRIuMAX>] %s  <TRUNCATED>\n"
 msgstr "%*s[%2<PRIuMAX>] %s  <>\n"
 
-#: src/readelf.c:5423
+#: src/readelf.c:5424
 #, c-format
 msgid "%s %#<PRIx64> used with different address sizes"
 msgstr "%s %#<PRIx64>     "
 
-#: src/readelf.c:5430
+#: src/readelf.c:5431
 #, c-format
 msgid "%s %#<PRIx64> used with different offset sizes"
 msgstr "%s %#<PRIx64>     "
 
-#: src/readelf.c:5437
+#: src/readelf.c:5438
 #, c-format
 msgid "%s %#<PRIx64> used with different base addresses"
 msgstr "%s %#<PRIx64>     "
 
-#: src/readelf.c:5444
+#: src/readelf.c:5445
 #, c-format
 msgid "%s %#<PRIx64> used with different attribute %s and %s"
 msgstr "%s %#<PRIx64>    , %s  %s"
 
-#: src/readelf.c:5544
+#: src/readelf.c:5545
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE IN REST OF SECTION>\n"
 msgstr " [%6tx]  <    >\n"
 
-#: src/readelf.c:5552
+#: src/readelf.c:5553
 #, c-format
 msgid " [%6tx]  <UNUSED GARBAGE> ... %<PRIu64> bytes ...\n"
 msgstr " [%6tx]  < > ... %<PRIu64>  ...\n"
 
-#: src/readelf.c:5658
+#: src/readelf.c:5659
 #, c-format
 msgid ""
 "\n"
@@ -5370,7 +5376,7 @@ msgstr ""
 " DWARF [%2zu] %s   %#<PRIx64>:\n"
 " [ ]\n"
 
-#: src/readelf.c:5666
+#: src/readelf.c:5667
 #, c-format
 msgid ""
 "\n"
@@ -5379,20 +5385,20 @@ msgstr ""
 "\n"
 "    %<PRIu64>:\n"
 
-#: src/readelf.c:5679
+#: src/readelf.c:5680
 #, c-format
 msgid " *** error while reading abbreviation: %s\n"
 msgstr " ***     : %s\n"
 
-#: src/readelf.c:5695
+#: src/readelf.c:5696
 #, c-format
 msgid " [%5u] offset: %<PRId64>, children: %s, tag: %s\n"
 msgstr " [%5u] : %<PRId64>, : %s, : %s\n"
 
-#: src/readelf.c:5732 src/readelf.c:6025 src/readelf.c:6196 src/readelf.c:6567
-#: src/readelf.c:7193 src/readelf.c:8962 src/readelf.c:9704 src/readelf.c:10172
-#: src/readelf.c:10427 src/readelf.c:10589 src/readelf.c:10970
-#: src/readelf.c:11041
+#: src/readelf.c:5733 src/readelf.c:6026 src/readelf.c:6197 src/readelf.c:6568
+#: src/readelf.c:7194 src/readelf.c:8963 src/readelf.c:9705 src/readelf.c:10173
+#: src/readelf.c:10428 src/readelf.c:10590 src/readelf.c:10971
+#: src/readelf.c:11042
 #, c-format
 msgid ""
 "\n"
@@ -5401,49 +5407,49 @@ msgstr ""
 "\n"
 " DWARF [%2zu] %s   %#<PRIx64>:\n"
 
-#: src/readelf.c:5835 src/readelf.c:5859 src/readelf.c:6232 src/readelf.c:9740
+#: src/readelf.c:5836 src/readelf.c:5860 src/readelf.c:6233 src/readelf.c:9741
 #, c-format
 msgid " Length:         %8<PRIu64>\n"
 msgstr " :        %8<PRIu64>\n"
 
-#: src/readelf.c:5837 src/readelf.c:5874 src/readelf.c:6245 src/readelf.c:9753
+#: src/readelf.c:5838 src/readelf.c:5875 src/readelf.c:6246 src/readelf.c:9754
 #, c-format
 msgid " DWARF version:  %8<PRIu16>\n"
 msgstr "  DWARF:   %8<PRIu16>\n"
 
-#: src/readelf.c:5838 src/readelf.c:5883 src/readelf.c:6254 src/readelf.c:9762
+#: src/readelf.c:5839 src/readelf.c:5884 src/readelf.c:6255 src/readelf.c:9763
 #, c-format
 msgid " Address size:   %8<PRIu64>\n"
 msgstr "  :  %8<PRIu64>\n"
 
-#: src/readelf.c:5840 src/readelf.c:5893 src/readelf.c:6264 src/readelf.c:9772
+#: src/readelf.c:5841 src/readelf.c:5894 src/readelf.c:6265 src/readelf.c:9773
 #, c-format
 msgid " Segment size:   %8<PRIu64>\n"
 msgstr ""
 "  : %8<PRIu64>\n"
 "\n"
 
-#: src/readelf.c:5878 src/readelf.c:6249 src/readelf.c:9757 src/readelf.c:11163
+#: src/readelf.c:5879 src/readelf.c:6250 src/readelf.c:9758 src/readelf.c:11164
 #, c-format
 msgid "Unknown version"
 msgstr " "
 
-#: src/readelf.c:5888 src/readelf.c:6095 src/readelf.c:6259 src/readelf.c:9767
+#: src/readelf.c:5889 src/readelf.c:6096 src/readelf.c:6260 src/readelf.c:9768
 #, c-format
 msgid "unsupported address size"
 msgstr "  "
 
-#: src/readelf.c:5899 src/readelf.c:6106 src/readelf.c:6269 src/readelf.c:9777
+#: src/readelf.c:5900 src/readelf.c:6107 src/readelf.c:6270 src/readelf.c:9778
 #, c-format
 msgid "unsupported segment size"
 msgstr "  "
 
-#: src/readelf.c:5952
+#: src/readelf.c:5953
 #, c-format
 msgid "cannot get .debug_aranges content: %s"
 msgstr "    get .debug_aranges: %s"
 
-#: src/readelf.c:5967
+#: src/readelf.c:5968
 #, c-format
 msgid ""
 "\n"
@@ -5461,12 +5467,12 @@ msgstr[2] ""
 "\n"
 " DWARF [%2zu] %s   %#<PRIx64>  %zu :\n"
 
-#: src/readelf.c:5998
+#: src/readelf.c:5999
 #, c-format
 msgid " [%*zu] ???\n"
 msgstr " [%*zu] ???\n"
 
-#: src/readelf.c:6000
+#: src/readelf.c:6001
 #, c-format
 msgid ""
 " [%*zu] start: %0#*<PRIx64>, length: %5<PRIu64>, CU DIE offset: %6<PRId64>\n"
@@ -5474,7 +5480,7 @@ msgstr ""
 " [%*zu] : %0#*<PRIx64>, : %5<PRIu64>,  CU DIE: "
 "%6<PRId64>\n"
 
-#: src/readelf.c:6038 src/readelf.c:8981
+#: src/readelf.c:6039 src/readelf.c:8982
 #, c-format
 msgid ""
 "\n"
@@ -5483,13 +5489,13 @@ msgstr ""
 "\n"
 "   %zu:\n"
 
-#: src/readelf.c:6042 src/readelf.c:6213 src/readelf.c:7217 src/readelf.c:8992
-#: src/readelf.c:9721
+#: src/readelf.c:6043 src/readelf.c:6214 src/readelf.c:7218 src/readelf.c:8993
+#: src/readelf.c:9722
 #, c-format
 msgid "invalid data in section [%zu] '%s'"
 msgstr "    [%zu] %s"
 
-#: src/readelf.c:6058
+#: src/readelf.c:6059
 #, c-format
 msgid ""
 "\n"
@@ -5498,27 +5504,27 @@ msgstr ""
 "\n"
 " :       %6<PRIu64>\n"
 
-#: src/readelf.c:6070
+#: src/readelf.c:6071
 #, c-format
 msgid " DWARF version: %6<PRIuFAST16>\n"
 msgstr "  DWARF:  %6<PRIuFAST16>\n"
 
-#: src/readelf.c:6074
+#: src/readelf.c:6075
 #, c-format
 msgid "unsupported aranges version"
 msgstr "  aranges"
 
-#: src/readelf.c:6085
+#: src/readelf.c:6086
 #, c-format
 msgid " CU offset:     %6<PRIx64>\n"
 msgstr "  CU:     %6<PRIx64>\n"
 
-#: src/readelf.c:6091
+#: src/readelf.c:6092
 #, c-format
 msgid " Address size:  %6<PRIu64>\n"
 msgstr "  :  %6<PRIu64>\n"
 
-#: src/readelf.c:6102
+#: src/readelf.c:6103
 #, c-format
 msgid ""
 " Segment size:  %6<PRIu64>\n"
@@ -5527,12 +5533,12 @@ msgstr ""
 "  :  %6<PRIu64>\n"
 "\n"
 
-#: src/readelf.c:6157
+#: src/readelf.c:6158
 #, c-format
 msgid "   %zu padding bytes\n"
 msgstr "   %zu  \n"
 
-#: src/readelf.c:6219 src/readelf.c:9727
+#: src/readelf.c:6220 src/readelf.c:9728
 #, c-format
 msgid ""
 "Table at Offset 0x%<PRIx64>:\n"
@@ -5541,42 +5547,42 @@ msgstr ""
 "   0x%<PRIx64>:\n"
 "\n"
 
-#: src/readelf.c:6274 src/readelf.c:9782
+#: src/readelf.c:6275 src/readelf.c:9783
 #, c-format
 msgid " Offset entries: %8<PRIu64>\n"
 msgstr "  : %8<PRIu64>\n"
 
-#: src/readelf.c:6290 src/readelf.c:9798
+#: src/readelf.c:6291 src/readelf.c:9799
 #, c-format
 msgid " Unknown CU base: "
 msgstr "   CU: "
 
-#: src/readelf.c:6292 src/readelf.c:9800
+#: src/readelf.c:6293 src/readelf.c:9801
 #, c-format
 msgid " CU [%6<PRIx64>] base: "
 msgstr "  CU [%6<PRIx64>]: "
 
-#: src/readelf.c:6298 src/readelf.c:9806
+#: src/readelf.c:6299 src/readelf.c:9807
 #, c-format
 msgid " Not associated with a CU.\n"
 msgstr "  '  CU.\n"
 
-#: src/readelf.c:6309 src/readelf.c:9817
+#: src/readelf.c:6310 src/readelf.c:9818
 #, c-format
 msgid "too many offset entries for unit length"
 msgstr "     "
 
-#: src/readelf.c:6313 src/readelf.c:9821
+#: src/readelf.c:6314 src/readelf.c:9822
 #, c-format
 msgid "  Offsets starting at 0x%<PRIx64>:\n"
 msgstr "  ,    0x%<PRIx64>:\n"
 
-#: src/readelf.c:6365
+#: src/readelf.c:6366
 #, c-format
 msgid "invalid range list data"
 msgstr "   "
 
-#: src/readelf.c:6550 src/readelf.c:10156
+#: src/readelf.c:6551 src/readelf.c:10157
 #, c-format
 msgid ""
 "   %zu padding bytes\n"
@@ -5585,7 +5591,7 @@ msgstr ""
 "   %zu  \n"
 "\n"
 
-#: src/readelf.c:6598 src/readelf.c:10205
+#: src/readelf.c:6599 src/readelf.c:10206
 #, c-format
 msgid ""
 "\n"
@@ -5594,7 +5600,7 @@ msgstr ""
 "\n"
 "   CU: "
 
-#: src/readelf.c:6600 src/readelf.c:10207
+#: src/readelf.c:6601 src/readelf.c:10208
 #, c-format
 msgid ""
 "\n"
@@ -5603,31 +5609,31 @@ msgstr ""
 "\n"
 "  CU [%6<PRIx64>]: "
 
-#: src/readelf.c:6609 src/readelf.c:10233 src/readelf.c:10259
+#: src/readelf.c:6610 src/readelf.c:10234 src/readelf.c:10260
 #, c-format
 msgid " [%6tx]  <INVALID DATA>\n"
 msgstr " [%6tx]  < >\n"
 
-#: src/readelf.c:6634 src/readelf.c:10343
+#: src/readelf.c:6635 src/readelf.c:10344
 #, fuzzy
 msgid "base address"
 msgstr "     "
 
-#: src/readelf.c:6644 src/readelf.c:10353
+#: src/readelf.c:6645 src/readelf.c:10354
 #, c-format
 msgid " [%6tx] empty list\n"
 msgstr " [%6tx]  \n"
 
-#: src/readelf.c:6908
+#: src/readelf.c:6909
 msgid "         <INVALID DATA>\n"
 msgstr "         < >\n"
 
-#: src/readelf.c:7165
+#: src/readelf.c:7166
 #, c-format
 msgid "cannot get ELF: %s"
 msgstr "   ELF: %s"
 
-#: src/readelf.c:7189
+#: src/readelf.c:7190
 #, c-format
 msgid ""
 "\n"
@@ -5636,7 +5642,7 @@ msgstr ""
 "\n"
 "     [%2zu] %s   %#<PRIx64>:\n"
 
-#: src/readelf.c:7239
+#: src/readelf.c:7240
 #, c-format
 msgid ""
 "\n"
@@ -5645,65 +5651,65 @@ msgstr ""
 "\n"
 " [%6tx]  \n"
 
-#: src/readelf.c:7343 src/readelf.c:7497
+#: src/readelf.c:7344 src/readelf.c:7498
 #, c-format
 msgid "invalid augmentation length"
 msgstr "  "
 
-#: src/readelf.c:7358
+#: src/readelf.c:7359
 msgid "FDE address encoding: "
 msgstr "  FDE: "
 
-#: src/readelf.c:7364
+#: src/readelf.c:7365
 msgid "LSDA pointer encoding: "
 msgstr "  LSDA: "
 
-#: src/readelf.c:7474
+#: src/readelf.c:7475
 #, c-format
 msgid " (offset: %#<PRIx64>)"
 msgstr " (: %#<PRIx64>)"
 
-#: src/readelf.c:7481
+#: src/readelf.c:7482
 #, c-format
 msgid " (end offset: %#<PRIx64>)"
 msgstr " (  : %#<PRIx64>)"
 
-#: src/readelf.c:7518
+#: src/readelf.c:7519
 #, c-format
 msgid "   %-26sLSDA pointer: %#<PRIx64>\n"
 msgstr "   %-26s LSDA: %#<PRIx64>\n"
 
-#: src/readelf.c:7603
+#: src/readelf.c:7604
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute code: %s"
 msgstr "DIE [%<PRIx64>]     : %s"
 
-#: src/readelf.c:7613
+#: src/readelf.c:7614
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute form: %s"
 msgstr "DIE [%<PRIx64>]     : %s"
 
-#: src/readelf.c:7635
+#: src/readelf.c:7636
 #, c-format
 msgid "DIE [%<PRIx64>] cannot get attribute '%s' (%s) value: %s"
 msgstr "DIE [%<PRIx64>]      %s (%s): %s"
 
-#: src/readelf.c:7965
+#: src/readelf.c:7966
 #, c-format
 msgid "invalid file (%<PRId64>): %s"
 msgstr "  (%<PRId64>): %s"
 
-#: src/readelf.c:7969
+#: src/readelf.c:7970
 #, c-format
 msgid "no srcfiles for CU [%<PRIx64>]"
 msgstr " srcfiles  CU [%<PRIx64>]"
 
-#: src/readelf.c:7973
+#: src/readelf.c:7974
 #, c-format
 msgid "couldn't get DWARF CU: %s"
 msgstr "   CU DWARF: %s"
 
-#: src/readelf.c:8295
+#: src/readelf.c:8296
 #, c-format
 msgid ""
 "\n"
@@ -5714,12 +5720,12 @@ msgstr ""
 " DWARF [%2zu] %s   %#<PRIx64>:\n"
 " []\n"
 
-#: src/readelf.c:8345
+#: src/readelf.c:8346
 #, c-format
 msgid "cannot get next unit: %s"
 msgstr "    : %s"
 
-#: src/readelf.c:8365
+#: src/readelf.c:8366
 #, c-format
 msgid ""
 " Type unit at offset %<PRIu64>:\n"
@@ -5732,7 +5738,7 @@ msgstr ""
 "%<PRIu8>,  : %<PRIu8>\n"
 "  : %#<PRIx64>,  : %#<PRIx64> [%<PRIx64>]\n"
 
-#: src/readelf.c:8377
+#: src/readelf.c:8378
 #, c-format
 msgid ""
 " Compilation unit at offset %<PRIu64>:\n"
@@ -5743,38 +5749,38 @@ msgstr ""
 " : %<PRIu16>,   : %<PRIu64>, : %<PRIu8>, "
 ": %<PRIu8>\n"
 
-#: src/readelf.c:8387 src/readelf.c:8548
+#: src/readelf.c:8388 src/readelf.c:8549
 #, c-format
 msgid " Unit type: %s (%<PRIu8>)"
 msgstr "  : %s (%<PRIu8>)"
 
-#: src/readelf.c:8414
+#: src/readelf.c:8415
 #, c-format
 msgid "unknown version (%d) or unit type (%d)"
 msgstr "  (%d)    (%d)"
 
-#: src/readelf.c:8443
+#: src/readelf.c:8444
 #, c-format
 msgid "cannot get DIE offset: %s"
 msgstr "    DIE: %s"
 
-#: src/readelf.c:8452
+#: src/readelf.c:8453
 #, c-format
 msgid "cannot get tag of DIE at offset [%<PRIx64>] in section '%s': %s"
 msgstr ""
 "    DIE   [%<PRIu64>]   %s: %s"
 
-#: src/readelf.c:8488
+#: src/readelf.c:8489
 #, c-format
 msgid "cannot get next DIE: %s\n"
 msgstr "    DIE: %s\n"
 
-#: src/readelf.c:8496
+#: src/readelf.c:8497
 #, c-format
 msgid "cannot get next DIE: %s"
 msgstr "    DIE: %s"
 
-#: src/readelf.c:8540
+#: src/readelf.c:8541
 #, c-format
 msgid ""
 " Split compilation unit at offset %<PRIu64>:\n"
@@ -5785,7 +5791,7 @@ msgstr ""
 " : %<PRIu16>,   : %<PRIu64>, : %<PRIu8>, "
 ": %<PRIu8>\n"
 
-#: src/readelf.c:8592
+#: src/readelf.c:8593
 #, c-format
 msgid ""
 "\n"
@@ -5796,13 +5802,13 @@ msgstr ""
 " DWARF [%2zu] %s   %#<PRIx64>:\n"
 "\n"
 
-#: src/readelf.c:8924
+#: src/readelf.c:8925
 #, c-format
 msgid "unknown form: %s"
 msgstr " : %s"
 
 #. Print what we got so far.
-#: src/readelf.c:9072
+#: src/readelf.c:9073
 #, c-format
 msgid ""
 "\n"
@@ -5835,27 +5841,27 @@ msgstr ""
 "\n"
 " :\n"
 
-#: src/readelf.c:9094
+#: src/readelf.c:9095
 #, c-format
 msgid "cannot handle .debug_line version: %u\n"
 msgstr "    .debug_line: %u\n"
 
-#: src/readelf.c:9102
+#: src/readelf.c:9103
 #, c-format
 msgid "cannot handle address size: %u\n"
 msgstr "    : %u\n"
 
-#: src/readelf.c:9110
+#: src/readelf.c:9111
 #, c-format
 msgid "cannot handle segment selector size: %u\n"
 msgstr "     : %u\n"
 
-#: src/readelf.c:9120
+#: src/readelf.c:9121
 #, c-format
 msgid "invalid data at offset %tu in section [%zu] '%s'"
 msgstr "    %tu   [%zu] %s"
 
-#: src/readelf.c:9135
+#: src/readelf.c:9136
 #, c-format
 msgid "  [%*<PRIuFAST8>]  %hhu argument\n"
 msgid_plural "  [%*<PRIuFAST8>]  %hhu arguments\n"
@@ -5863,7 +5869,7 @@ msgstr[0] "  [%*<PRIuFAST8>]  %hhu \n"
 msgstr[1] "  [%*<PRIuFAST8>]  %hhu \n"
 msgstr[2] "  [%*<PRIuFAST8>]  %hhu \n"
 
-#: src/readelf.c:9146
+#: src/readelf.c:9147
 msgid ""
 "\n"
 "Directory table:"
@@ -5871,12 +5877,12 @@ msgstr ""
 "\n"
 " :"
 
-#: src/readelf.c:9152 src/readelf.c:9229
+#: src/readelf.c:9153 src/readelf.c:9230
 #, c-format
 msgid "      ["
 msgstr "      ["
 
-#: src/readelf.c:9223
+#: src/readelf.c:9224
 msgid ""
 "\n"
 "File name table:"
@@ -5884,11 +5890,11 @@ msgstr ""
 "\n"
 "   :"
 
-#: src/readelf.c:9284
+#: src/readelf.c:9285
 msgid " Entry Dir   Time      Size      Name"
 msgstr "                "
 
-#: src/readelf.c:9330
+#: src/readelf.c:9331
 #, fuzzy
 msgid ""
 "\n"
@@ -5897,7 +5903,7 @@ msgstr ""
 "\n"
 "  :"
 
-#: src/readelf.c:9334
+#: src/readelf.c:9335
 msgid ""
 "\n"
 "Line number statements:"
@@ -5905,129 +5911,129 @@ msgstr ""
 "\n"
 "  :"
 
-#: src/readelf.c:9349
+#: src/readelf.c:9350
 #, c-format
 msgid "invalid maximum operations per instruction is zero"
 msgstr "       "
 
-#: src/readelf.c:9383
+#: src/readelf.c:9384
 #, c-format
 msgid " special opcode %u: address+%u = "
 msgstr "    %u: +%u = "
 
-#: src/readelf.c:9387
+#: src/readelf.c:9388
 #, c-format
 msgid ", op_index = %u, line%+d = %zu\n"
 msgstr ", _ = %u, %+d = %zu\n"
 
-#: src/readelf.c:9390
+#: src/readelf.c:9391
 #, c-format
 msgid ", line%+d = %zu\n"
 msgstr ", %+d = %zu\n"
 
-#: src/readelf.c:9408
+#: src/readelf.c:9409
 #, c-format
 msgid " extended opcode %u: "
 msgstr "    %u: "
 
-#: src/readelf.c:9413
+#: src/readelf.c:9414
 msgid " end of sequence"
 msgstr "  "
 
-#: src/readelf.c:9431
+#: src/readelf.c:9432
 #, c-format
 msgid " set address to "
 msgstr "     "
 
-#: src/readelf.c:9459
+#: src/readelf.c:9460
 #, c-format
 msgid " define new file: dir=%u, mtime=%<PRIu64>, length=%<PRIu64>, name=%s\n"
 msgstr ""
 "   : dir=%u, mtime=%<PRIu64>, =%<PRIu64>, "
 "=%s\n"
 
-#: src/readelf.c:9473
+#: src/readelf.c:9474
 #, c-format
 msgid " set discriminator to %u\n"
 msgstr "    %u\n"
 
-#: src/readelf.c:9500
+#: src/readelf.c:9501
 #, c-format
 msgid " set inlined context %u, function name %s (0x%x)\n"
 msgstr ""
 
-#: src/readelf.c:9524
+#: src/readelf.c:9525
 #, fuzzy, c-format
 #| msgid "Also show function names"
 msgid " set function name %s (0x%x)\n"
 msgstr "   "
 
 #. Unknown, ignore it.
-#: src/readelf.c:9531
+#: src/readelf.c:9532
 msgid " unknown opcode"
 msgstr "   "
 
 #. Takes no argument.
-#: src/readelf.c:9543
+#: src/readelf.c:9544
 msgid " copy"
 msgstr " "
 
-#: src/readelf.c:9554
+#: src/readelf.c:9555
 #, c-format
 msgid " advance address by %u to "
 msgstr "    %u  "
 
-#: src/readelf.c:9558 src/readelf.c:9619
+#: src/readelf.c:9559 src/readelf.c:9620
 #, c-format
 msgid ", op_index to %u"
 msgstr ", op_index  %u"
 
-#: src/readelf.c:9570
+#: src/readelf.c:9571
 #, c-format
 msgid " advance line by constant %d to %<PRId64>\n"
 msgstr "     %d  %<PRId64>\n"
 
-#: src/readelf.c:9580
+#: src/readelf.c:9581
 #, c-format
 msgid " set file to %<PRIu64>\n"
 msgstr "    %<PRIu64>\n"
 
-#: src/readelf.c:9591
+#: src/readelf.c:9592
 #, c-format
 msgid " set column to %<PRIu64>\n"
 msgstr "    %<PRIu64>\n"
 
-#: src/readelf.c:9598
+#: src/readelf.c:9599
 #, c-format
 msgid " set '%s' to %<PRIuFAST8>\n"
 msgstr "  %s  %<PRIuFAST8>\n"
 
 #. Takes no argument.
-#: src/readelf.c:9604
+#: src/readelf.c:9605
 msgid " set basic block flag"
 msgstr "    "
 
-#: src/readelf.c:9615
+#: src/readelf.c:9616
 #, c-format
 msgid " advance address by constant %u to "
 msgstr "      %u  "
 
-#: src/readelf.c:9635
+#: src/readelf.c:9636
 #, c-format
 msgid " advance address by fixed value %u to \n"
 msgstr "      %u  \n"
 
 #. Takes no argument.
-#: src/readelf.c:9645
+#: src/readelf.c:9646
 msgid " set prologue end flag"
 msgstr "    "
 
 #. Takes no argument.
-#: src/readelf.c:9650
+#: src/readelf.c:9651
 msgid " set epilogue begin flag"
 msgstr "    "
 
-#: src/readelf.c:9660
+#: src/readelf.c:9661
 #, c-format
 msgid " set isa to %u\n"
 msgstr "  isa  %u\n"
@@ -6035,7 +6041,7 @@ msgstr "  isa  %u\n"
 #. This is a new opcode the generator but not we know about.
 #. Read the parameters associated with it but then discard
 #. everything.  Read all the parameters for this opcode.
-#: src/readelf.c:9669
+#: src/readelf.c:9670
 #, c-format
 msgid " unknown opcode with %<PRIu8> parameter:"
 msgid_plural " unknown opcode with %<PRIu8> parameters:"
@@ -6043,87 +6049,87 @@ msgstr[0] "     %<PRIu8> 
 msgstr[1] "     %<PRIu8> :"
 msgstr[2] "     %<PRIu8> :"
 
-#: src/readelf.c:9870
+#: src/readelf.c:9871
 #, fuzzy, c-format
 msgid "    <INVALID DATA>\n"
 msgstr "   < >\n"
 
-#: src/readelf.c:9910
+#: src/readelf.c:9911
 #, c-format
 msgid "invalid loclists data"
 msgstr "  loclists"
 
-#: src/readelf.c:10380 src/readelf.c:11425
+#: src/readelf.c:10381 src/readelf.c:11426
 msgid "   <INVALID DATA>\n"
 msgstr "   < >\n"
 
-#: src/readelf.c:10511
+#: src/readelf.c:10512
 #, c-format
 msgid "%*s*** non-terminated string at end of section"
 msgstr "%*s***    "
 
-#: src/readelf.c:10534
+#: src/readelf.c:10535
 #, c-format
 msgid "%*s*** missing DW_MACINFO_start_file argument at end of section"
 msgstr "%*s***   DW_MACINFO_start_file  "
 
-#: src/readelf.c:10629
+#: src/readelf.c:10630
 #, c-format
 msgid " Offset:             0x%<PRIx64>\n"
 msgstr " :           0x%<PRIx64>\n"
 
-#: src/readelf.c:10641
+#: src/readelf.c:10642
 #, c-format
 msgid " Version:            %<PRIu16>\n"
 msgstr " :             %<PRIu16>\n"
 
-#: src/readelf.c:10647 src/readelf.c:11546
+#: src/readelf.c:10648 src/readelf.c:11547
 #, c-format
 msgid "  unknown version, cannot parse section\n"
 msgstr "   ,    \n"
 
-#: src/readelf.c:10654
+#: src/readelf.c:10655
 #, c-format
 msgid " Flag:               0x%<PRIx8>"
 msgstr " :          0x%<PRIx8>"
 
-#: src/readelf.c:10683
+#: src/readelf.c:10684
 #, c-format
 msgid " Offset length:      %<PRIu8>\n"
 msgstr "  :   %<PRIu8>\n"
 
-#: src/readelf.c:10691
+#: src/readelf.c:10692
 #, c-format
 msgid " .debug_line offset: 0x%<PRIx64>\n"
 msgstr "  .debug_line: 0x%<PRIx64>\n"
 
-#: src/readelf.c:10716
+#: src/readelf.c:10717
 #, c-format
 msgid "  extension opcode table, %<PRIu8> items:\n"
 msgstr "     ,   %<PRIu8>:\n"
 
-#: src/readelf.c:10723
+#: src/readelf.c:10724
 #, c-format
 msgid "    [%<PRIx8>]"
 msgstr "    [%<PRIx8>]"
 
-#: src/readelf.c:10735
+#: src/readelf.c:10736
 #, c-format
 msgid " %<PRIu8> arguments:"
 msgstr " %<PRIu8> :"
 
-#: src/readelf.c:10750
+#: src/readelf.c:10751
 #, c-format
 msgid " no arguments."
 msgstr "  ."
 
-#: src/readelf.c:10951
+#: src/readelf.c:10952
 #, c-format
 msgid " [%5d] DIE offset: %6<PRId64>, CU DIE offset: %6<PRId64>, name: %s\n"
 msgstr ""
 " [%5d]  DIE: %6<PRId64>,  CU DIE: %6<PRId64>, : %s\n"
 
-#: src/readelf.c:11006
+#: src/readelf.c:11007
 #, c-format
 msgid ""
 "\n"
@@ -6135,37 +6141,37 @@ msgstr ""
 " %*s  \n"
 
 #. TRANS: the debugstr| prefix makes the string unique.
-#: src/readelf.c:11011
+#: src/readelf.c:11012
 msgctxt "debugstr"
 msgid "Offset"
 msgstr ""
 
-#: src/readelf.c:11021
+#: src/readelf.c:11022
 #, c-format
 msgid " *** error, missing string terminator\n"
 msgstr " *** ,   \n"
 
-#: src/readelf.c:11143
+#: src/readelf.c:11144
 #, c-format
 msgid " Length:        %8<PRIu64>\n"
 msgstr " :       %8<PRIu64>\n"
 
-#: src/readelf.c:11145
+#: src/readelf.c:11146
 #, c-format
 msgid " Offset size:   %8<PRIu8>\n"
 msgstr "  :   %8<PRIu8>\n"
 
-#: src/readelf.c:11159
+#: src/readelf.c:11160
 #, c-format
 msgid " DWARF version: %8<PRIu16>\n"
 msgstr "  DWARF:  %8<PRIu16>\n"
 
-#: src/readelf.c:11168
+#: src/readelf.c:11169
 #, c-format
 msgid " Padding:       %8<PRIx16>\n"
 msgstr " :     %8<PRIx16>\n"
 
-#: src/readelf.c:11222
+#: src/readelf.c:11223
 #, c-format
 msgid ""
 "\n"
@@ -6174,7 +6180,7 @@ msgstr ""
 "\n"
 "     [%2zu] '.eh_frame_hdr':\n"
 
-#: src/readelf.c:11324
+#: src/readelf.c:11325
 #, c-format
 msgid ""
 "\n"
@@ -6183,22 +6189,22 @@ msgstr ""
 "\n"
 "    [%2zu] '.gcc_except_table':\n"
 
-#: src/readelf.c:11347
+#: src/readelf.c:11348
 #, c-format
 msgid " LPStart encoding:    %#x "
 msgstr "  LPStart:   %#x "
 
-#: src/readelf.c:11359
+#: src/readelf.c:11360
 #, c-format
 msgid " TType encoding:      %#x "
 msgstr "  TType:     %#x "
 
-#: src/readelf.c:11376
+#: src/readelf.c:11377
 #, c-format
 msgid " Call site encoding:  %#x "
 msgstr "   :%#x "
 
-#: src/readelf.c:11391
+#: src/readelf.c:11392
 msgid ""
 "\n"
 " Call site table:"
@@ -6206,7 +6212,7 @@ msgstr ""
 "\n"
 "   :"
 
-#: src/readelf.c:11407
+#: src/readelf.c:11408
 #, c-format
 msgid ""
 " [%4u] Call site start:   %#<PRIx64>\n"
@@ -6219,12 +6225,12 @@ msgstr ""
 "         :   %#<PRIx64>\n"
 "        :                  %u\n"
 
-#: src/readelf.c:11480
+#: src/readelf.c:11481
 #, c-format
 msgid "invalid TType encoding"
 msgstr "  TType"
 
-#: src/readelf.c:11507
+#: src/readelf.c:11508
 #, c-format
 msgid ""
 "\n"
@@ -6233,43 +6239,43 @@ msgstr ""
 "\n"
 " GDB [%2zu] %s   %#<PRIx64>  %<PRId64> :\n"
 
-#: src/readelf.c:11536
+#: src/readelf.c:11537
 #, c-format
 msgid " Version:         %<PRId32>\n"
 msgstr " :          %<PRId32>\n"
 
-#: src/readelf.c:11555
+#: src/readelf.c:11556
 #, c-format
 msgid " CU offset:       %#<PRIx32>\n"
 msgstr "  CU:     %#<PRIx32>\n"
 
-#: src/readelf.c:11562
+#: src/readelf.c:11563
 #, c-format
 msgid " TU offset:       %#<PRIx32>\n"
 msgstr "  TU:      %#<PRIx32>\n"
 
-#: src/readelf.c:11569
+#: src/readelf.c:11570
 #, c-format
 msgid " address offset:  %#<PRIx32>\n"
 msgstr "  : %#<PRIx32>\n"
 
-#: src/readelf.c:11576
+#: src/readelf.c:11577
 #, c-format
 msgid " symbol offset:   %#<PRIx32>\n"
 msgstr "  : %#<PRIx32>\n"
 
-#: src/readelf.c:11586
+#: src/readelf.c:11587
 #, fuzzy, c-format
 #| msgid " constant offset: %#<PRIx32>\n"
 msgid " shortcut offset: %#<PRIx32>\n"
 msgstr "  :  %#<PRIx32>\n"
 
-#: src/readelf.c:11594
+#: src/readelf.c:11595
 #, c-format
 msgid " constant offset: %#<PRIx32>\n"
 msgstr "  :  %#<PRIx32>\n"
 
-#: src/readelf.c:11608
+#: src/readelf.c:11609
 #, c-format
 msgid ""
 "\n"
@@ -6278,7 +6284,7 @@ msgstr ""
 "\n"
 "  CU   %#<PRIx32>  %zu :\n"
 
-#: src/readelf.c:11633
+#: src/readelf.c:11634
 #, c-format
 msgid ""
 "\n"
@@ -6287,7 +6293,7 @@ msgstr ""
 "\n"
 "  TU   %#<PRIx32>  %zu :\n"
 
-#: src/readelf.c:11662
+#: src/readelf.c:11663
 #, c-format
 msgid ""
 "\n"
@@ -6296,7 +6302,7 @@ msgstr ""
 "\n"
 "     %#<PRIx32>  %zu :\n"
 
-#: src/readelf.c:11705
+#: src/readelf.c:11706
 #, c-format
 msgid ""
 "\n"
@@ -6305,7 +6311,7 @@ msgstr ""
 "\n"
 "     %#<PRIx32>  %zu :\n"
 
-#: src/readelf.c:11790
+#: src/readelf.c:11791
 #, fuzzy, c-format
 #| msgid ""
 #| "\n"
@@ -6317,28 +6323,28 @@ msgstr ""
 "\n"
 "     %#<PRIx32>  %zu :\n"
 
-#: src/readelf.c:11802
+#: src/readelf.c:11803
 #, c-format
 msgid "Language of main: %s\n"
 msgstr ""
 
-#: src/readelf.c:11803
+#: src/readelf.c:11804
 #, c-format
 msgid "Name of main: "
 msgstr ""
 
-#: src/readelf.c:11886
+#: src/readelf.c:11887
 #, c-format
 msgid "cannot get debug context descriptor: %s"
 msgstr "     : %s"
 
-#: src/readelf.c:12252 src/readelf.c:12872 src/readelf.c:12982
-#: src/readelf.c:13039
+#: src/readelf.c:12253 src/readelf.c:12873 src/readelf.c:12983
+#: src/readelf.c:13040
 #, c-format
 msgid "cannot convert core note data: %s"
 msgstr "     : %s"
 
-#: src/readelf.c:12616
+#: src/readelf.c:12617
 #, c-format
 msgid ""
 "\n"
@@ -6347,21 +6353,21 @@ msgstr ""
 "\n"
 "%*s... < %u > ..."
 
-#: src/readelf.c:13118
+#: src/readelf.c:13119
 msgid "  Owner          Data size  Type\n"
 msgstr "          .  \n"
 
-#: src/readelf.c:13146
+#: src/readelf.c:13147
 #, c-format
 msgid "  %-13.*s  %9<PRId32>  %s\n"
 msgstr "  %-13.*s  %9<PRId32>  %s\n"
 
-#: src/readelf.c:13198
+#: src/readelf.c:13199
 #, c-format
 msgid "cannot get content of note: %s"
 msgstr "    : %s"
 
-#: src/readelf.c:13231
+#: src/readelf.c:13232
 #, c-format
 msgid ""
 "\n"
@@ -6371,7 +6377,7 @@ msgstr ""
 "  (note) [%2zu] %s  %<PRIu64>    "
 "%#0<PRIx64>:\n"
 
-#: src/readelf.c:13254
+#: src/readelf.c:13255
 #, c-format
 msgid ""
 "\n"
@@ -6380,7 +6386,7 @@ msgstr ""
 "\n"
 "   %<PRIu64>    %#0<PRIx64>:\n"
 
-#: src/readelf.c:13301
+#: src/readelf.c:13302
 #, c-format
 msgid ""
 "\n"
@@ -6389,12 +6395,12 @@ msgstr ""
 "\n"
 "  [%zu] %s      .\n"
 
-#: src/readelf.c:13328 src/readelf.c:13379
+#: src/readelf.c:13329 src/readelf.c:13380
 #, c-format
 msgid "cannot get data for section [%zu] '%s': %s"
 msgstr "      [%zu] %s: %s"
 
-#: src/readelf.c:13333
+#: src/readelf.c:13334
 #, c-format
 msgid ""
 "\n"
@@ -6403,7 +6409,7 @@ msgstr ""
 "\n"
 ".   [%zu] %s, %<PRIu64>    %#0<PRIx64>:\n"
 
-#: src/readelf.c:13338
+#: src/readelf.c:13339
 #, c-format
 msgid ""
 "\n"
@@ -6414,7 +6420,7 @@ msgstr ""
 ".   [%zu] %s, %<PRIu64>  (%zd )  "
 " %#0<PRIx64>:\n"
 
-#: src/readelf.c:13352
+#: src/readelf.c:13353
 #, c-format
 msgid ""
 "\n"
@@ -6423,7 +6429,7 @@ msgstr ""
 "\n"
 "  [%zu] %s      .\n"
 
-#: src/readelf.c:13384
+#: src/readelf.c:13385
 #, c-format
 msgid ""
 "\n"
@@ -6432,7 +6438,7 @@ msgstr ""
 "\n"
 "  [%zu] %s  %<PRIu64>    %#0<PRIx64>:\n"
 
-#: src/readelf.c:13389
+#: src/readelf.c:13390
 #, c-format
 msgid ""
 "\n"
@@ -6443,7 +6449,7 @@ msgstr ""
 "  [%zu] %s  %<PRIu64>  (%zd )  "
 " %#0<PRIx64>:\n"
 
-#: src/readelf.c:13437
+#: src/readelf.c:13438
 #, c-format
 msgid ""
 "\n"
@@ -6452,7 +6458,7 @@ msgstr ""
 "\n"
 " [%lu]  "
 
-#: src/readelf.c:13467
+#: src/readelf.c:13468
 #, c-format
 msgid ""
 "\n"
@@ -6461,12 +6467,12 @@ msgstr ""
 "\n"
 " %s  "
 
-#: src/readelf.c:13522
+#: src/readelf.c:13523
 #, c-format
 msgid "cannot get symbol index of archive '%s': %s"
 msgstr "      %s: %s"
 
-#: src/readelf.c:13525
+#: src/readelf.c:13526
 #, c-format
 msgid ""
 "\n"
@@ -6475,7 +6481,7 @@ msgstr ""
 "\n"
 "  %s   \n"
 
-#: src/readelf.c:13529
+#: src/readelf.c:13530
 #, c-format
 msgid ""
 "\n"
@@ -6484,12 +6490,12 @@ msgstr ""
 "\n"
 "  %s  %zu :\n"
 
-#: src/readelf.c:13547
+#: src/readelf.c:13548
 #, c-format
 msgid "cannot extract member at offset %zu in '%s': %s"
 msgstr "      %zu  %s: %s"
 
-#: src/readelf.c:13552
+#: src/readelf.c:13553
 #, c-format
 msgid "Archive member '%s' contains:\n"
 msgstr "  %s :\n"
@@ -7169,7 +7175,7 @@ msgstr "    ELF: %s"
 msgid "cannot get shdrstrndx:%s"
 msgstr "   shdrstrndx:%s"
 
-#: src/unstrip.c:243 src/unstrip.c:2085
+#: src/unstrip.c:243 src/unstrip.c:2136
 #, c-format
 msgid "cannot get ELF header: %s"
 msgstr "    ELF: %s"
@@ -7189,12 +7195,12 @@ msgstr "    
 msgid "cannot copy ELF header: %s"
 msgstr "    ELF: %s"
 
-#: src/unstrip.c:264 src/unstrip.c:2103 src/unstrip.c:2146
+#: src/unstrip.c:264 src/unstrip.c:2154 src/unstrip.c:2197
 #, c-format
 msgid "cannot get number of program headers: %s"
 msgstr "     : %s"
 
-#: src/unstrip.c:269 src/unstrip.c:2107
+#: src/unstrip.c:269 src/unstrip.c:2158
 #, c-format
 msgid "cannot create program headers: %s"
 msgstr "    : %s"
@@ -7209,12 +7215,12 @@ msgstr "    
 msgid "cannot copy section header: %s"
 msgstr "    : %s"
 
-#: src/unstrip.c:288 src/unstrip.c:1707
+#: src/unstrip.c:288 src/unstrip.c:1748
 #, c-format
 msgid "cannot get section data: %s"
 msgstr "    : %s"
 
-#: src/unstrip.c:290 src/unstrip.c:1709
+#: src/unstrip.c:290 src/unstrip.c:1750
 #, c-format
 msgid "cannot copy section data: %s"
 msgstr "    : %s"
@@ -7224,14 +7230,14 @@ msgstr "    : %s"
 msgid "cannot create directory '%s'"
 msgstr "    %s"
 
-#: src/unstrip.c:392 src/unstrip.c:657 src/unstrip.c:691 src/unstrip.c:859
-#: src/unstrip.c:1749
+#: src/unstrip.c:392 src/unstrip.c:666 src/unstrip.c:700 src/unstrip.c:868
+#: src/unstrip.c:1790
 #, c-format
 msgid "cannot get symbol table entry: %s"
 msgstr "     : %s"
 
-#: src/unstrip.c:408 src/unstrip.c:660 src/unstrip.c:681 src/unstrip.c:694
-#: src/unstrip.c:1770 src/unstrip.c:1965 src/unstrip.c:1989
+#: src/unstrip.c:408 src/unstrip.c:669 src/unstrip.c:690 src/unstrip.c:703
+#: src/unstrip.c:1811 src/unstrip.c:2007 src/unstrip.c:2031
 #, c-format
 msgid "cannot update symbol table: %s"
 msgstr "    : %s"
@@ -7266,150 +7272,164 @@ msgstr "    : %s"
 msgid "unexpected section type in [%zu] with sh_link to symtab"
 msgstr "    [%zu]   sh_link  symtab"
 
-#: src/unstrip.c:848
+#: src/unstrip.c:857
 #, c-format
 msgid "cannot get symbol section data: %s"
 msgstr "     : %s"
 
-#: src/unstrip.c:850
+#: src/unstrip.c:859
 #, c-format
 msgid "cannot get string section data: %s"
 msgstr "     : %s"
 
-#: src/unstrip.c:867
+#: src/unstrip.c:876
 #, c-format
 msgid "invalid string offset in symbol [%zu]"
 msgstr "     [%zu]"
 
-#: src/unstrip.c:1025 src/unstrip.c:1433
+#: src/unstrip.c:939
+msgid "found two identical index map positions."
+msgstr ""
+
+#: src/unstrip.c:990
+msgid "section symbols in unexpected order"
+msgstr ""
+
+#: src/unstrip.c:996
+#, fuzzy
+#| msgid "Show demangled symbols (ARG is always ignored)"
+msgid "found two identical symbols"
+msgstr "   (  )"
+
+#: src/unstrip.c:1066 src/unstrip.c:1474
 #, c-format
 msgid "cannot read section [%zu] name: %s"
 msgstr "     [%zu]: %s"
 
-#: src/unstrip.c:1040
+#: src/unstrip.c:1081
 #, c-format
 msgid "bad sh_link for group section: %s"
 msgstr "  sh_link   : %s"
 
-#: src/unstrip.c:1046
+#: src/unstrip.c:1087
 #, c-format
 msgid "couldn't get shdr for group section: %s"
 msgstr "   shdr   : %s"
 
-#: src/unstrip.c:1051
+#: src/unstrip.c:1092
 #, c-format
 msgid "bad data for group symbol section: %s"
 msgstr "     : %s"
 
-#: src/unstrip.c:1057
+#: src/unstrip.c:1098
 #, c-format
 msgid "couldn't get symbol for group section: %s"
 msgstr "      : %s"
 
-#: src/unstrip.c:1062
+#: src/unstrip.c:1103
 #, c-format
 msgid "bad symbol name for group section: %s"
 msgstr "     : %s"
 
-#: src/unstrip.c:1073 src/unstrip.c:1553
+#: src/unstrip.c:1114 src/unstrip.c:1594
 #, c-format
 msgid "cannot find matching section for [%zu] '%s'"
 msgstr "      [%zu] %s"
 
-#: src/unstrip.c:1118 src/unstrip.c:1137 src/unstrip.c:1175
+#: src/unstrip.c:1159 src/unstrip.c:1178 src/unstrip.c:1216
 #, c-format
 msgid "cannot read '.gnu.prelink_undo' section: %s"
 msgstr "    .gnu.prelink_undo: %s"
 
-#: src/unstrip.c:1155
+#: src/unstrip.c:1196
 #, c-format
 msgid "overflow with shnum = %zu in '%s' section"
 msgstr "  shnum = %zu   %s"
 
-#: src/unstrip.c:1166
+#: src/unstrip.c:1207
 #, c-format
 msgid "invalid contents in '%s' section"
 msgstr "   %s"
 
-#: src/unstrip.c:1337 src/unstrip.c:1353 src/unstrip.c:1633 src/unstrip.c:1924
+#: src/unstrip.c:1378 src/unstrip.c:1394 src/unstrip.c:1674 src/unstrip.c:1966
 #, c-format
 msgid "cannot add section name to string table: %s"
 msgstr "       : %s"
 
-#: src/unstrip.c:1362
+#: src/unstrip.c:1403
 #, c-format
 msgid "cannot update section header string table data: %s"
 msgstr "        : %s"
 
-#: src/unstrip.c:1391 src/unstrip.c:1395
+#: src/unstrip.c:1432 src/unstrip.c:1436
 #, c-format
 msgid "cannot get section header string table section index: %s"
 msgstr ""
 "         : %s"
 
-#: src/unstrip.c:1399 src/unstrip.c:1403 src/unstrip.c:1648
+#: src/unstrip.c:1440 src/unstrip.c:1444 src/unstrip.c:1689
 #, c-format
 msgid "cannot get section count: %s"
 msgstr "    : %s"
 
-#: src/unstrip.c:1406
+#: src/unstrip.c:1447
 msgid "more sections in stripped file than debug file -- arguments reversed?"
 msgstr ""
 "             "
 "  ?"
 
-#: src/unstrip.c:1410
+#: src/unstrip.c:1451
 msgid "no sections in stripped file"
 msgstr "    "
 
-#: src/unstrip.c:1458 src/unstrip.c:1568
+#: src/unstrip.c:1499 src/unstrip.c:1609
 #, c-format
 msgid "cannot read section header string table: %s"
 msgstr "      : %s"
 
-#: src/unstrip.c:1627
+#: src/unstrip.c:1668
 #, c-format
 msgid "cannot add new section: %s"
 msgstr "    : %s"
 
-#: src/unstrip.c:1757
+#: src/unstrip.c:1798
 #, c-format
 msgid "symbol [%zu] has invalid section index"
 msgstr " [%zu]    "
 
-#: src/unstrip.c:1789
+#: src/unstrip.c:1830
 #, c-format
 msgid "group has invalid section index [%zd]"
 msgstr "     [%zd]"
 
-#: src/unstrip.c:2064
+#: src/unstrip.c:2115
 #, c-format
 msgid "cannot read section data: %s"
 msgstr "    : %s"
 
-#: src/unstrip.c:2093
+#: src/unstrip.c:2144
 #, c-format
 msgid "cannot update ELF header: %s"
 msgstr "    ELF: %s"
 
-#: src/unstrip.c:2117
+#: src/unstrip.c:2168
 #, c-format
 msgid "cannot update program header: %s"
 msgstr "    : %s"
 
-#: src/unstrip.c:2122 src/unstrip.c:2205
+#: src/unstrip.c:2173 src/unstrip.c:2256
 #, c-format
 msgid "cannot write output file: %s"
 msgstr "     : %s"
 
-#: src/unstrip.c:2173
+#: src/unstrip.c:2224
 #, c-format
 msgid "DWARF data not adjusted for prelinking bias; consider prelink -u"
 msgstr ""
 " DWARF       ; "
 "    prelink -u"
 
-#: src/unstrip.c:2176
+#: src/unstrip.c:2227
 #, c-format
 msgid ""
 "DWARF data in '%s' not adjusted for prelinking bias; consider prelink -u"
@@ -7417,74 +7437,74 @@ msgstr ""
 " DWARF  %s       "
 ";     prelink -u"
 
-#: src/unstrip.c:2196 src/unstrip.c:2248 src/unstrip.c:2260 src/unstrip.c:2350
+#: src/unstrip.c:2247 src/unstrip.c:2299 src/unstrip.c:2311 src/unstrip.c:2401
 #, c-format
 msgid "cannot create ELF descriptor: %s"
 msgstr "    ELF: %s"
 
-#: src/unstrip.c:2234
+#: src/unstrip.c:2285
 msgid "WARNING: "
 msgstr ": "
 
-#: src/unstrip.c:2236
+#: src/unstrip.c:2287
 msgid ", use --force"
 msgstr ",  --force"
 
-#: src/unstrip.c:2264
+#: src/unstrip.c:2315
 msgid "ELF header identification (e_ident) different"
 msgstr "   ELF (e_ident)"
 
-#: src/unstrip.c:2268
+#: src/unstrip.c:2319
 msgid "ELF header type (e_type) different"
 msgstr "   ELF (e_type)"
 
-#: src/unstrip.c:2272
+#: src/unstrip.c:2323
 msgid "ELF header machine type (e_machine) different"
 msgstr "    ELF (e_machine)"
 
-#: src/unstrip.c:2276
+#: src/unstrip.c:2327
 msgid "stripped program header (e_phnum) smaller than unstripped"
 msgstr "   (e_phnum)    "
 
-#: src/unstrip.c:2307
+#: src/unstrip.c:2358
 #, c-format
 msgid "cannot find stripped file for module '%s': %s"
 msgstr "       %s: %s"
 
-#: src/unstrip.c:2311
+#: src/unstrip.c:2362
 #, c-format
 msgid "cannot open stripped file '%s' for module '%s': %s"
 msgstr "     %s   %s: %s"
 
-#: src/unstrip.c:2326
+#: src/unstrip.c:2377
 #, c-format
 msgid "cannot find debug file for module '%s': %s"
 msgstr "        %s: %s"
 
-#: src/unstrip.c:2330
+#: src/unstrip.c:2381
 #, c-format
 msgid "cannot open debug file '%s' for module '%s': %s"
 msgstr "      %s   %s: %s"
 
-#: src/unstrip.c:2343
+#: src/unstrip.c:2394
 #, c-format
 msgid "module '%s' file '%s' is not stripped"
 msgstr "  %s  %s   strip"
 
-#: src/unstrip.c:2374
+#: src/unstrip.c:2425
 #, c-format
 msgid "cannot cache section addresses for module '%s': %s"
 msgstr "       %s: %s"
 
-#: src/unstrip.c:2502
+#: src/unstrip.c:2553
 msgid "no matching modules found"
 msgstr "   "
 
-#: src/unstrip.c:2512
+#: src/unstrip.c:2563
 msgid "matched more than one module"
 msgstr "   "
 
-#: src/unstrip.c:2557
+#: src/unstrip.c:2608
 msgid ""
 "STRIPPED-FILE DEBUG-FILE\n"
 "[MODULE...]"
@@ -7492,7 +7512,7 @@ msgstr ""
 "- -DEBUG\n"
 "[...]"
 
-#: src/unstrip.c:2558
+#: src/unstrip.c:2609
 msgid ""
 "Combine stripped files with separate symbols and debug information.\n"
 "\n"
diff --git a/src/Makefile.am b/src/Makefile.am
index d3d9d408..1d592d4d 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -21,7 +21,7 @@ DEFS += $(YYDEBUG) -DDEBUGPRED=@DEBUGPRED@ \
 	-DSRCDIR=\"$(shell cd $(srcdir);pwd)\" -DOBJDIR=\"$(shell pwd)\"
 AM_CPPFLAGS += -I$(srcdir)/../libelf -I$(srcdir)/../libebl \
 	    -I$(srcdir)/../libdw -I$(srcdir)/../libdwelf \
-	    -I$(srcdir)/../libdwfl -I$(srcdir)/../libasm
+	    -I$(srcdir)/../libdwfl -I$(srcdir)/../libasm -I../debuginfod
 
 AM_LDFLAGS = -Wl,-rpath-link,../libelf:../libdw $(STACK_USAGE_NO_ERROR)
 
@@ -43,10 +43,20 @@ if BUILD_STATIC
 libasm = ../libasm/libasm.a
 libdw = ../libdw/libdw.a -lz $(zip_LIBS) $(libelf) -ldl -lpthread
 libelf = ../libelf/libelf.a -lz $(zstd_LIBS)
+if LIBDEBUGINFOD
+libdebuginfod = ../debuginfod/libdebuginfod.a -lpthread $(libcurl_LIBS)
+else
+libdebuginfod =
+endif
 else
 libasm = ../libasm/libasm.so
 libdw = ../libdw/libdw.so
 libelf = ../libelf/libelf.so
+if LIBDEBUGINFOD
+libdebuginfod = ../debuginfod/libdebuginfod.so
+else
+libdebuginfod =
+endif
 endif
 libebl = ../libebl/libebl.a ../backends/libebl_backends.a ../libcpu/libcpu.a
 libeu = ../lib/libeu.a
@@ -85,7 +95,7 @@ stack_LDADD = $(libebl) $(libelf) $(libdw) $(libeu) $(argp_LDADD) $(demanglelib)
 elfcompress_LDADD = $(libebl) $(libelf) $(libdw) $(libeu) $(argp_LDADD)
 elfclassify_LDADD = $(libelf) $(libdw) $(libeu) $(argp_LDADD)
 srcfiles_SOURCES = srcfiles.cxx
-srcfiles_LDADD = $(libdw) $(libelf) $(libeu)  $(argp_LDADD)
+srcfiles_LDADD = $(libdw) $(libelf) $(libeu)  $(argp_LDADD) $(libarchive_LIBS) $(libdebuginfod)
 
 installcheck-binPROGRAMS: $(bin_PROGRAMS)
 	bad=0; pid=$$$$; list="$(bin_PROGRAMS)"; for p in $$list; do \
diff --git a/src/addr2line.c b/src/addr2line.c
index d902d791..d87e5b45 100644
--- a/src/addr2line.c
+++ b/src/addr2line.c
@@ -385,7 +385,7 @@ print_dwarf_function (Dwfl_Module *mod, Dwarf_Addr addr)
 		  if (file == NULL)
 		    file = "???";
 		  else if (only_basenames)
-		    file = basename (file);
+		    file = xbasename (file);
 		  else if (use_comp_dir && file[0] != '/')
 		    {
 		      const char *const *dirs;
@@ -568,7 +568,7 @@ print_src (const char *src, int lineno, int linecol, Dwarf_Die *cu)
   const char *comp_dir_sep = "";
 
   if (only_basenames)
-    src = basename (src);
+    src = xbasename (src);
   else if (use_comp_dir && src[0] != '/')
     {
       Dwarf_Attribute attr;
diff --git a/src/ar.c b/src/ar.c
index 3bcb18fe..e6d6d58f 100644
--- a/src/ar.c
+++ b/src/ar.c
@@ -1133,7 +1133,7 @@ do_oper_insert (int oper, const char *arfname, char **argv, int argc,
       for (int cnt = 0; cnt < argc; ++cnt)
 	{
 	  ENTRY entry;
-	  entry.key = full_path ? argv[cnt] : basename (argv[cnt]);
+	  entry.key = full_path ? argv[cnt] : (char*)xbasename (argv[cnt]);
 	  entry.data = &argv[cnt];
 	  if (hsearch (entry, ENTER) == NULL)
 	    error_exit (errno, _("cannot insert into hash table"));
@@ -1242,7 +1242,7 @@ do_oper_insert (int oper, const char *arfname, char **argv, int argc,
       /* Open all the new files, get their sizes and add all symbols.  */
       for (int cnt = 0; cnt < argc; ++cnt)
 	{
-	  const char *bname = basename (argv[cnt]);
+	  const char *bname = xbasename (argv[cnt]);
 	  size_t bnamelen = strlen (bname);
 	  if (found[cnt] == NULL)
 	    {
diff --git a/src/nm.c b/src/nm.c
index fbdee8e1..3675f59b 100644
--- a/src/nm.c
+++ b/src/nm.c
@@ -1417,7 +1417,7 @@ show_symbols (int fd, Ebl *ebl, GElf_Ehdr *ehdr,
 			  int lineno;
 			  (void) dwarf_lineno (line, &lineno);
 			  const char *file = dwarf_linesrc (line, NULL, NULL);
-			  file = (file != NULL) ? basename (file) : "???";
+			  file = (file != NULL) ? xbasename (file) : "???";
 			  int n;
 			  n = obstack_printf (&whereob, "%s:%d%c", file,
 					      lineno, '\0');
@@ -1448,7 +1448,7 @@ show_symbols (int fd, Ebl *ebl, GElf_Ehdr *ehdr,
 		{
 		  /* We found the line.  */
 		  int n = obstack_printf (&whereob, "%s:%" PRIu64 "%c",
-					  basename ((*found)->file),
+					  xbasename ((*found)->file),
 					  (*found)->lineno,
 					  '\0');
 		  sym_mem[nentries_used].where = obstack_finish (&whereob);
diff --git a/src/readelf.c b/src/readelf.c
index decfaf15..0e931184 100644
--- a/src/readelf.c
+++ b/src/readelf.c
@@ -3159,7 +3159,7 @@ handle_verneed (Ebl *ebl, Elf_Scn *scn, GElf_Shdr *shdr)
 	  elf_strptr (ebl->elf, shstrndx, glink->sh_name));
 
   unsigned int offset = 0;
-  for (int cnt = shdr->sh_info; --cnt >= 0; )
+  for (unsigned int cnt = shdr->sh_info; cnt > 0; cnt--)
     {
       /* Get the data at the next offset.  */
       GElf_Verneed needmem;
@@ -3173,7 +3173,7 @@ handle_verneed (Ebl *ebl, Elf_Scn *scn, GElf_Shdr *shdr)
 	      (unsigned short int) need->vn_cnt);
 
       unsigned int auxoffset = offset + need->vn_aux;
-      for (int cnt2 = need->vn_cnt; --cnt2 >= 0; )
+      for (unsigned int cnt2 = need->vn_cnt; cnt2 > 0; cnt2--)
 	{
 	  GElf_Vernaux auxmem;
 	  GElf_Vernaux *aux = gelf_getvernaux (data, auxoffset, &auxmem);
@@ -3236,7 +3236,7 @@ handle_verdef (Ebl *ebl, Elf_Scn *scn, GElf_Shdr *shdr)
 	  elf_strptr (ebl->elf, shstrndx, glink->sh_name));
 
   unsigned int offset = 0;
-  for (int cnt = shdr->sh_info; --cnt >= 0; )
+  for (unsigned int cnt = shdr->sh_info; cnt > 0; cnt--)
     {
       /* Get the data at the next offset.  */
       GElf_Verdef defmem;
@@ -3259,7 +3259,7 @@ handle_verdef (Ebl *ebl, Elf_Scn *scn, GElf_Shdr *shdr)
 	      elf_strptr (ebl->elf, shdr->sh_link, aux->vda_name));
 
       auxoffset += aux->vda_next;
-      for (int cnt2 = 1; cnt2 < def->vd_cnt; ++cnt2)
+      for (unsigned int cnt2 = 1; cnt2 < def->vd_cnt; ++cnt2)
 	{
 	  aux = gelf_getverdaux (data, auxoffset, &auxmem);
 	  if (unlikely (aux == NULL))
@@ -3644,11 +3644,12 @@ print_hash_info (Ebl *ebl, Elf_Scn *scn, GElf_Shdr *shdr, size_t shstrndx,
 	  success += counts[cnt] * acc;
 	}
 
-      printf (_("\
+      if (nzero_counts > 0)
+	printf (_("\
  Average number of tests:   successful lookup: %f\n\
 			  unsuccessful lookup: %f\n"),
-	      (double) success / (double) nzero_counts,
-	      (double) nzero_counts / (double) nbucket);
+		(double) success / (double) nzero_counts,
+		(double) nzero_counts / (double) nbucket);
     }
 
   free (counts);
diff --git a/src/srcfiles.cxx b/src/srcfiles.cxx
index 3c7afdc4..892737cc 100644
--- a/src/srcfiles.cxx
+++ b/src/srcfiles.cxx
@@ -16,6 +16,21 @@
    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
 
+
+/* In case we have a bad fts we include this before config.h because it
+   can't handle _FILE_OFFSET_BITS.
+   Everything we need here is fine if its declarations just come first.
+   Also, include sys/types.h before fts.  On some systems fts.h is not self
+   contained.  */
+#ifdef BAD_FTS
+#include <sys/types.h>
+#include <fts.h>
+#endif
+
+#ifdef HAVE_CONFIG_H
+# include <config.h>
+#endif
+
 #include "printversion.h"
 #include <dwarf.h>
 #include <argp.h>
@@ -23,12 +38,37 @@
 #include <set>
 #include <string>
 #include <cassert>
-#include <config.h>
+#include <gelf.h>
+#include <memory>
+
+#ifdef ENABLE_LIBDEBUGINFOD
+#include "debuginfod.h"
+#endif
 
 #include <libdwfl.h>
 #include <fcntl.h>
 #include <iostream>
 #include <libdw.h>
+#include <sstream>
+#include <vector>
+
+/* Libraries for use by the --zip option */
+#ifdef HAVE_LIBARCHIVE
+#include <archive.h>
+#include <archive_entry.h>
+#endif
+
+/* If fts.h is included before config.h, its indirect inclusions may not
+   give us the right LFS aliases of these functions, so map them manually.  */
+#ifdef BAD_FTS
+#ifdef _FILE_OFFSET_BITS
+#define open open64
+#define fopen fopen64
+#endif
+#else
+  #include <sys/types.h>
+  #include <fts.h>
+#endif
 
 using namespace std;
 
@@ -38,6 +78,8 @@ ARGP_PROGRAM_VERSION_HOOK_DEF = print_version;
 /* Bug report address.  */
 ARGP_PROGRAM_BUG_ADDRESS_DEF = PACKAGE_BUGREPORT;
 
+constexpr size_t BUFFER_SIZE = 8192;
+
 /* Definitions of arguments for argp functions.  */
 static const struct argp_option options[] =
 {
@@ -46,12 +88,21 @@ static const struct argp_option options[] =
     N_ ("Separate items by a null instead of a newline."), 0 },
   { "verbose", 'v', NULL, 0,
     N_ ("Increase verbosity of logging messages."), 0 },
-  { "cu-only", 'c', NULL, 0, N_ ("Only list the CU names."), 0 },
+  { "cu-only", 'c', NULL, 0, N_("Only list the CU names."), 0 },
+  #ifdef HAVE_LIBARCHIVE
+  { "zip", 'z', NULL, 0, N_("Zip all the source files and send to stdout. "
+    "Cannot be used with the null option"), 0 },
+    #ifdef ENABLE_LIBDEBUGINFOD
+    { "no-backup", 'b', NULL, 0, N_("Disables local source file search when "
+      "debuginfod fails to fetch files. This option is only applicable"
+      "when fetching and zipping files."), 0 },
+    #endif
+  #endif
   { NULL, 0, NULL, 0, NULL, 0 }
 };
 
 /* Short description of program.  */
-static const char doc[] = N_("Lists the source files of a DWARF/ELF file. The default input is the file 'a.out'.");
+static const char doc[] = N_("Lists the source files of a DWARF/ELF file.  The default input is the file 'a.out'.");
 
 /* Strings for arguments in help texts.  */
 static const char args_doc[] = N_("INPUT");
@@ -67,18 +118,29 @@ static const struct argp argp =
   options, parse_opt, args_doc, doc, argp_children, NULL, NULL
 };
 
-/* Verbose message printing. */
+/* Verbose message printing.  */
 static bool verbose;
-/* Delimit the output with nulls. */
+/* Delimit the output with nulls.  */
 static bool null_arg;
-/* Only print compilation unit names. */
+/* Only print compilation unit names.  */
 static bool CU_only;
-
-/* Handle program arguments. */
+#ifdef HAVE_LIBARCHIVE
+  /* Zip all the source files and send to stdout. */
+  static bool zip;
+
+  #ifdef ENABLE_LIBDEBUGINFOD
+    /* Disables local source file search when debuginfod fails to fetch them.
+       This option is only applicable when fetching and zipping files.*/
+    static bool no_backup;
+  #endif
+#endif
+
+/* Handle program arguments.  Note null arg and zip
+    cannot be combined due to warnings raised when unzipping.  */
 static error_t
 parse_opt (int key, char *arg, struct argp_state *state)
 {
-  /* Suppress "unused parameter" warning. */
+  /* Suppress "unused parameter" warning.  */
   (void)arg;
   switch (key)
     {
@@ -98,17 +160,58 @@ parse_opt (int key, char *arg, struct argp_state *state)
       CU_only = true;
       break;
 
+    #ifdef HAVE_LIBARCHIVE
+      case 'z':
+      zip = true;
+      break;
+
+      #ifdef ENABLE_LIBDEBUGINFOD
+        case 'b':
+        no_backup = true;
+        break;
+      #endif
+    #endif
+
     default:
       return ARGP_ERR_UNKNOWN;
     }
   return 0;
 }
 
+/* Remove the "/./" , "../" and the preceding directory
+    that some paths include which raise errors during unzip.  */
+string canonicalize_path(string path)
+{
+    stringstream ss(path);
+    string token;
+    vector<string> tokens;
+    /* Extract each directory of the path and place into a vector.  */
+    while (getline(ss, token, '/')) {
+      /* Ignore any empty //, or /./ dirs.  */
+        if (token == "" || token == ".")
+            continue;
+      /* When /..  is encountered, remove the most recent directory from the vector.  */
+        else if (token == "..") {
+            if (!tokens.empty())
+                tokens.pop_back();
+        } else
+            tokens.push_back(token);
+    }
+    stringstream result;
+    if (tokens.empty())
+        return "/";
+    /* Reconstruct the path from the extracted directories.  */
+    for (const string &t : tokens) {
+        result << '/' << t;
+    }
+    return result.str();
+}
 
-/* Global list of collected source files.  Normally, it'll contain
-   the sources of just one named binary, but the '-K' option can cause
-   multiple dwfl modules to be loaded, thus listed.   */
-   set<string> debug_sourcefiles;
+/* Global list of collected source files and their respective module.
+   Normally, it'll contain the sources of just one named binary, but
+   the '-K' option can cause multiple dwfl modules to be loaded, thus
+   listed.  */
+set<pair<string, Dwfl_Module*>> debug_sourcefiles;
 
 static int
 collect_sourcefiles (Dwfl_Module *dwflmod,
@@ -118,14 +221,13 @@ collect_sourcefiles (Dwfl_Module *dwflmod,
                      void *arg __attribute__ ((unused)))
 {
   Dwarf *dbg;
-  Dwarf_Addr bias; /* ignored - for addressing purposes only  */
+  Dwarf_Addr bias; /* ignored - for addressing purposes only.  */
 
   dbg = dwfl_module_getdwarf (dwflmod, &bias);
 
   Dwarf_Off offset = 0;
   Dwarf_Off old_offset;
   size_t hsize;
-
   /* Traverse all CUs of this module.  */
   while (dwarf_nextcu (dbg, old_offset = offset, &offset, &hsize, NULL, NULL, NULL) == 0)
     {
@@ -141,7 +243,7 @@ collect_sourcefiles (Dwfl_Module *dwflmod,
       if (dwarf_getsrcfiles (cudie, &files, &nfiles) != 0)
         continue;
 
-      /* extract DW_AT_comp_dir to resolve relative file names  */
+      /* extract DW_AT_comp_dir to resolve relative file names.  */
       const char *comp_dir = "";
       const char *const *dirs;
       size_t ndirs;
@@ -152,11 +254,19 @@ collect_sourcefiles (Dwfl_Module *dwflmod,
         comp_dir = "";
 
       if (verbose)
-        std::clog << "searching for sources for cu=" << cuname
+        clog << "searching for sources for cu=" << cuname
                   << " comp_dir=" << comp_dir << " #files=" << nfiles
                   << " #dirs=" << ndirs << endl;
 
-      for (size_t f = 1; f < nfiles; f++)
+      if (comp_dir[0] == '\0' && cuname[0] != '/')
+        {
+          /* This is a common symptom for dwz-compressed debug files,
+             where the altdebug file cannot be resolved.  */
+          if (verbose)
+            clog << "skipping cu=" << cuname << " due to empty comp_dir" << endl;
+          continue;
+        }
+      for (size_t f = 1; f < nfiles; ++f)
         {
           const char *hat;
           if (CU_only)
@@ -172,7 +282,7 @@ collect_sourcefiles (Dwfl_Module *dwflmod,
             continue;
 
           if (string(hat).find("<built-in>")
-              != std::string::npos) /* gcc intrinsics, don't bother record  */
+              != string::npos) /* gcc intrinsics, don't bother recording */
             continue;
 
           string waldo;
@@ -180,13 +290,133 @@ collect_sourcefiles (Dwfl_Module *dwflmod,
             waldo = (string (hat));
           else if (comp_dir[0] != '\0') /* comp_dir relative */
             waldo = (string (comp_dir) + string ("/") + string (hat));
-          debug_sourcefiles.insert (waldo);
+          else
+           {
+             if (verbose)
+              clog << "skipping file=" << hat << " due to empty comp_dir" << endl;
+             continue;
+           }
+          waldo = canonicalize_path (waldo);
+          debug_sourcefiles.insert (make_pair(waldo, dwflmod));
         }
     }
-
   return DWARF_CB_OK;
 }
 
+#ifdef HAVE_LIBARCHIVE
+void zip_files()
+{
+  struct archive *a = archive_write_new();
+  struct stat st;
+  char buff[BUFFER_SIZE];
+  int len;
+  int fd;
+  #ifdef ENABLE_LIBDEBUGINFOD
+  /* Initialize a debuginfod client.  */
+  static unique_ptr <debuginfod_client, void (*)(debuginfod_client*)>
+    client (debuginfod_begin(), &debuginfod_end);
+  #endif
+
+  archive_write_set_format_zip(a);
+  archive_write_open_fd(a, STDOUT_FILENO);
+
+  int missing_files = 0;
+  for (const auto &pair : debug_sourcefiles)
+  {
+    fd = -1;
+    const std::string &file_path = pair.first;
+
+    /* Attempt to query debuginfod client to fetch source files.  */
+    #ifdef ENABLE_LIBDEBUGINFOD
+    Dwfl_Module* dwflmod = pair.second;
+    /* Obtain source file's build ID.  */
+    const unsigned char *bits;
+    GElf_Addr vaddr;
+    int bits_length = dwfl_module_build_id(dwflmod, &bits, &vaddr);
+    /* Ensure successful client and build ID acquisition.  */
+    if (client.get() != NULL && bits_length > 0)
+    {
+      fd = debuginfod_find_source(client.get(),
+                                    bits, bits_length,
+                                    file_path.c_str(), NULL);
+    }
+    else
+    {
+        if (client.get() == NULL)
+            cerr << "Error: Failed to initialize debuginfod client." << endl;
+        else
+            cerr << "Error: Invalid build ID length (" << bits_length << ")." << endl;
+    }
+    #endif
+
+    if (!no_backup)
+      /* Files could not be located using debuginfod, search locally */
+      if (fd < 0)
+        fd = open(file_path.c_str(), O_RDONLY);
+    if (fd < 0)
+    {
+      if (verbose)
+        cerr << file_path << endl;
+      missing_files++;
+      continue;
+    }
+
+    /* Create an entry for each file including file information to be placed in the zip.  */
+    if (fstat(fd, &st) == -1)
+    {
+      if (verbose)
+        cerr << file_path << endl;
+      missing_files++;
+      if (verbose)
+        cerr << "Error: Failed to get file status for " << file_path << ": " << strerror(errno) << endl;
+      continue;
+    }
+    struct archive_entry *entry = archive_entry_new();
+    /* Removing first "/"" to make the path "relative" before zipping, otherwise warnings are raised when unzipping.  */
+    string entry_name = file_path.substr(file_path.find_first_of('/') + 1);
+    archive_entry_set_pathname(entry, entry_name.c_str());
+    archive_entry_copy_stat(entry, &st);
+    if (archive_write_header(a, entry) != ARCHIVE_OK)
+    {
+      if (verbose)
+        cerr << file_path << endl;
+      missing_files++;
+      if (verbose)
+        cerr << "Error: failed to write header for " << file_path << ": " << archive_error_string(a) << endl;
+      continue;
+    }
+
+    /* Write the file to the zip.  */
+    len = read(fd, buff, sizeof(buff));
+    if (len == -1)
+    {
+      if (verbose)
+        cerr << file_path << endl;
+      missing_files++;
+      if (verbose)
+        cerr << "Error: Failed to open file: " << file_path << ": " << strerror(errno) <<endl;
+      continue;
+    }
+    while (len > 0)
+    {
+      if (archive_write_data(a, buff, len) < ARCHIVE_OK)
+      {
+        if (verbose)
+          cerr << "Error: Failed to read from the file: " << file_path << ": " << strerror(errno) << endl;
+        break;
+      }
+      len = read(fd, buff, sizeof(buff));
+    }
+    close(fd);
+    archive_entry_free(entry);
+  }
+  if (verbose && missing_files > 0 )
+    cerr << missing_files << " file(s) listed above could not be found.  " << endl;
+
+  archive_write_close(a);
+  archive_write_free(a);
+}
+#endif
 
 int
 main (int argc, char *argv[])
@@ -200,18 +430,27 @@ main (int argc, char *argv[])
   Dwfl *dwfl = NULL;
   (void) argp_parse (&argp, argc, argv, 0, &remaining, &dwfl);
   assert (dwfl != NULL);
-  /* Process all loaded modules - probably just one, except if -K or -p is used. */
+  /* Process all loaded modules - probably just one, except if -K or -p is used.  */
   (void) dwfl_getmodules (dwfl, &collect_sourcefiles, NULL, 0);
 
   if (!debug_sourcefiles.empty ())
-    for (const string &element : debug_sourcefiles)
+  {
+    #ifdef HAVE_LIBARCHIVE
+      if (zip)
+        zip_files();
+      else
+    #endif
       {
-        std::cout << element;
-        if (null_arg)
-          std::cout << '\0';
-        else
-          std::cout << '\n';
+        for (const auto &pair : debug_sourcefiles)
+          {
+            cout << pair.first;
+            if (null_arg)
+              cout << '\0';
+            else
+              cout << '\n';
+          }
       }
+  }
 
   dwfl_end (dwfl);
   return 0;
diff --git a/src/stack.c b/src/stack.c
index 534aa93c..f4c5ba8c 100644
--- a/src/stack.c
+++ b/src/stack.c
@@ -152,7 +152,7 @@ module_callback (Dwfl_Module *mod, void **userdata __attribute__((unused)),
 
   int width = get_addr_width (mod);
   printf ("0x%0*" PRIx64 "-0x%0*" PRIx64 " %s\n",
-	  width, start, width, end, basename (name));
+	  width, start, width, end, xbasename (name));
 
   const unsigned char *id;
   GElf_Addr id_vaddr;
diff --git a/src/strip.c b/src/strip.c
index 7f4788b3..6436443d 100644
--- a/src/strip.c
+++ b/src/strip.c
@@ -1800,7 +1800,7 @@ handle_elf (int fd, Elf *elf, const char *prefix, const char *fname,
 		      elf_errmsg (-1));
 	}
 
-      char *debug_basename = basename (debug_fname_embed ?: debug_fname);
+      const char *debug_basename = xbasename (debug_fname_embed ?: debug_fname);
       off_t crc_offset = strlen (debug_basename) + 1;
       /* Align to 4 byte boundary */
       crc_offset = ((crc_offset - 1) & ~3) + 4;
diff --git a/src/unstrip.c b/src/unstrip.c
index d5bd1821..d70053de 100644
--- a/src/unstrip.c
+++ b/src/unstrip.c
@@ -598,21 +598,30 @@ adjust_relocs (Elf_Scn *outscn, Elf_Scn *inscn, const GElf_Shdr *shdr,
 /* Adjust all the relocation sections in the file.  */
 static void
 adjust_all_relocs (Elf *elf, Elf_Scn *symtab, const GElf_Shdr *symshdr,
-		   size_t map[], size_t map_size)
+		   size_t map[], size_t map_size, bool scn_filter[])
 {
   size_t new_sh_link = elf_ndxscn (symtab);
   Elf_Scn *scn = NULL;
   while ((scn = elf_nextscn (elf, scn)) != NULL)
     if (scn != symtab)
       {
+	if (scn_filter != NULL)
+	  {
+	    size_t ndx = elf_ndxscn (scn);
+
+	    /* Skip relocations that were already mapped during adjust_relocs
+	       for the stripped symtab.  This is to avoid mapping a relocation's
+	       symbol index from X to Y during the first adjust_relocs and then
+	       wrongly remapping it from Y to Z during the second call.  */
+	    if (scn_filter[ndx])
+	      continue;
+	  }
+
 	GElf_Shdr shdr_mem;
 	GElf_Shdr *shdr = gelf_getshdr (scn, &shdr_mem);
 	ELF_CHECK (shdr != NULL, _("cannot get section header: %s"));
-	/* Don't redo SHT_GROUP, groups are in both the stripped and debug,
-	   it will already have been done by adjust_relocs for the
-	   stripped_symtab.  */
-	if (shdr->sh_type != SHT_NOBITS && shdr->sh_type != SHT_GROUP
-	    && shdr->sh_link == new_sh_link)
+
+	if (shdr->sh_type != SHT_NOBITS && shdr->sh_link == new_sh_link)
 	  adjust_relocs (scn, scn, shdr, map, map_size, symshdr);
       }
 }
@@ -697,7 +706,7 @@ add_new_section_symbols (Elf_Scn *old_symscn, size_t old_shnum,
     }
 
   /* Adjust any relocations referring to the old symbol table.  */
-  adjust_all_relocs (elf, symscn, shdr, symndx_map, nsym - 1);
+  adjust_all_relocs (elf, symscn, shdr, symndx_map, nsym - 1, NULL);
 
   return symdata;
 }
@@ -874,6 +883,7 @@ collect_symbols (Elf *outelf, bool rel, Elf_Scn *symscn, Elf_Scn *strscn,
       s->shndx = shndx;
       s->info.info = sym->st_info;
       s->info.other = sym->st_other;
+      s->duplicate = NULL;
 
       if (scnmap != NULL && shndx != SHN_UNDEF && shndx < SHN_LORESERVE)
 	s->shndx = scnmap[shndx - 1];
@@ -903,8 +913,7 @@ collect_symbols (Elf *outelf, bool rel, Elf_Scn *symscn, Elf_Scn *strscn,
   if (s1->value > s2->value)						      \
     return 1
 
-/* Compare symbols with a consistent ordering,
-   but one only meaningful for equality.  */
+/* Symbol comparison used to sort symbols in preparation for deduplication.  */
 static int
 compare_symbols (const void *a, const void *b)
 {
@@ -915,6 +924,38 @@ compare_symbols (const void *a, const void *b)
   CMP (size);
   CMP (shndx);
 
+  int res = s1->compare - s2->compare;
+  if (res != 0)
+    return res;
+
+  res = strcmp (s1->name, s2->name);
+  if (res != 0)
+    return res;
+
+  /* Duplicates still have distinct positions in the symbol index map.
+     Compare map positions to ensure that duplicate symbols are ordered
+     consistently even if the sort function is unstable.  */
+  CMP (map);
+  error_exit (0, _("found two identical index map positions."));
+}
+
+/* Symbol comparison used to deduplicate symbols found in both the stripped
+   and unstripped input files.
+
+   Similar to compare_symbols, but does not differentiate symbols based
+   on their position in the symbol index map.  Duplicates can't be found
+   by comparing index map postions because they always have distinct
+   positions in the map.  */
+static int
+compare_symbols_duplicate (const void *a, const void *b)
+{
+  const struct symbol *s1 = a;
+  const struct symbol *s2 = b;
+
+  CMP (value);
+  CMP (size);
+  CMP (shndx);
+
   return (s1->compare - s2->compare) ?: strcmp (s1->name, s2->name);
 }
 
@@ -946,13 +987,13 @@ compare_symbols_output (const void *a, const void *b)
 	  /* binutils always puts section symbols in section index order.  */
 	  CMP (shndx);
 	  else if (s1 != s2)
-	    error_exit (0, "section symbols in unexpected order");
+	    error_exit (0, _("section symbols in unexpected order"));
 	}
 
       /* Nothing really matters, so preserve the original order.  */
       CMP (map);
       else if (s1 != s2)
-	error_exit (0, "found two identical symbols");
+	error_exit (0, _("found two identical symbols"));
     }
 
   return cmp;
@@ -1855,7 +1896,8 @@ more sections in stripped file than debug file -- arguments reversed?"));
 	    }
 
 	  struct symbol *n = s;
-	  while (n + 1 < &symbols[total_syms] && !compare_symbols (s, n + 1))
+	  while (n + 1 < &symbols[total_syms]
+		 && !compare_symbols_duplicate (s, n + 1))
 	    ++n;
 
 	  while (s < n)
@@ -1992,6 +2034,11 @@ more sections in stripped file than debug file -- arguments reversed?"));
       elf_flagdata (symdata, ELF_C_SET, ELF_F_DIRTY);
       update_shdr (unstripped_symtab, shdr);
 
+      /* Track which sections are adjusted during the first round
+	 of calls to adjust_relocs.  */
+      bool scn_adjusted[unstripped_shnum];
+      memset (scn_adjusted, 0, sizeof scn_adjusted);
+
       if (stripped_symtab != NULL)
 	{
 	  /* Adjust any relocations referring to the old symbol table.  */
@@ -2000,14 +2047,18 @@ more sections in stripped file than debug file -- arguments reversed?"));
 	       sec < &sections[stripped_shnum - 1];
 	       ++sec)
 	    if (sec->outscn != NULL && sec->shdr.sh_link == old_sh_link)
-	      adjust_relocs (sec->outscn, sec->scn, &sec->shdr,
-			     symndx_map, total_syms, shdr);
+	      {
+		adjust_relocs (sec->outscn, sec->scn, &sec->shdr,
+			       symndx_map, total_syms, shdr);
+		scn_adjusted[elf_ndxscn (sec->outscn)] = true;
+	      }
 	}
 
       /* Also adjust references to the other old symbol table.  */
       adjust_all_relocs (unstripped, unstripped_symtab, shdr,
 			 &symndx_map[stripped_nsym - 1],
-			 total_syms - (stripped_nsym - 1));
+			 total_syms - (stripped_nsym - 1),
+			 scn_adjusted);
 
       free (symbols);
       free (symndx_map);
diff --git a/tests/.gitignore b/tests/.gitignore
index b9aa22ba..0289959d 100644
--- a/tests/.gitignore
+++ b/tests/.gitignore
@@ -28,9 +28,11 @@
 /backtrace-dwarf
 /buildid
 /core-dump-backtrace.lock
+/cu-dwp-section-info
 /debugaltlink
 /debuginfod_build_id_find
 /debuglink
+/declfiles
 /deleted
 /dwarf-die-addr-die
 /dwarf-getmacros
@@ -49,6 +51,7 @@
 /dwfl-report-elf-align
 /dwfl-report-offline-memory
 /dwfl-report-segment-contiguous
+/dwfl-core-noncontig
 /dwfllines
 /dwflmodtest
 /dwflsyms
@@ -62,6 +65,7 @@
 /elfshphehdr
 /elfstrmerge
 /elfstrtab
+/elf-print-reloc-syms
 /emptyfile
 /fillfile
 /find-prologues
diff --git a/tests/Makefile.am b/tests/Makefile.am
index 7fb8efb1..c8645dcf 100644
--- a/tests/Makefile.am
+++ b/tests/Makefile.am
@@ -42,7 +42,7 @@ check_PROGRAMS = arextract arsymtest newfile saridx scnnames sectiondump \
 		  dwfl-bug-addr-overflow arls dwfl-bug-fd-leak \
 		  dwfl-addr-sect dwfl-bug-report early-offscn \
 		  dwfl-bug-getmodules dwarf-getmacros dwarf-ranges addrcfi \
-		  dwarfcfi \
+		  dwfl-core-noncontig dwarfcfi \
 		  test-flag-nobits dwarf-getstring rerequest_tag \
 		  alldts typeiter typeiter2 low_high_pc \
 		  test-elf_cntl_gelf_getshdr dwflsyms dwfllines \
@@ -62,7 +62,8 @@ check_PROGRAMS = arextract arsymtest newfile saridx scnnames sectiondump \
 		  dwelf_elf_e_machine_string \
 		  getphdrnum leb128 read_unaligned \
 		  msg_tst system-elf-libelf-test system-elf-gelf-test \
-		  nvidia_extended_linemap_libdw \
+		  nvidia_extended_linemap_libdw elf-print-reloc-syms \
+		  cu-dwp-section-info declfiles \
 		  $(asm_TESTS)
 
 asm_TESTS = asm-tst1 asm-tst2 asm-tst3 asm-tst4 asm-tst5 \
@@ -212,7 +213,8 @@ TESTS = run-arextract.sh run-arsymtest.sh run-ar.sh newfile test-nlist \
 	$(asm_TESTS) run-disasm-bpf.sh run-low_high_pc-dw-form-indirect.sh \
 	run-nvidia-extended-linemap-libdw.sh run-nvidia-extended-linemap-readelf.sh \
 	run-readelf-dw-form-indirect.sh run-strip-largealign.sh \
-	run-readelf-Dd.sh
+	run-readelf-Dd.sh run-dwfl-core-noncontig.sh run-cu-dwp-section-info.sh \
+	run-declfiles.sh
 
 if !BIARCH
 export ELFUTILS_DISABLE_BIARCH = 1
@@ -632,7 +634,19 @@ EXTRA_DIST = run-arextract.sh run-arsymtest.sh run-ar.sh \
 	     run-nvidia-extended-linemap-libdw.sh run-nvidia-extended-linemap-readelf.sh \
 	     testfile_nvidia_linemap.bz2 \
 	     testfile-largealign.o.bz2 run-strip-largealign.sh \
-	     run-funcretval++11.sh
+	     run-funcretval++11.sh \
+	     test-ar-duplicates.a.bz2 \
+	     run-dwfl-core-noncontig.sh testcore-noncontig.bz2 \
+	     testfile-dwarf5-line-clang.bz2 \
+	     testfile-dwp-4.bz2 testfile-dwp-4.dwp.bz2 \
+	     testfile-dwp-4-strict.bz2 testfile-dwp-4-strict.dwp.bz2 \
+	     testfile-dwp-5.bz2 testfile-dwp-5.dwp.bz2 testfile-dwp.source \
+	     run-cu-dwp-section-info.sh run-declfiles.sh \
+	     testfile-dwp-5-cu-index-overflow.bz2 \
+	     testfile-dwp-5-cu-index-overflow.dwp.bz2 \
+	     testfile-dwp-4-cu-index-overflow.bz2 \
+	     testfile-dwp-4-cu-index-overflow.dwp.bz2 \
+	     testfile-dwp-cu-index-overflow.source
 
 
 if USE_VALGRIND
@@ -738,6 +752,7 @@ dwfl_bug_fd_leak_LDADD = $(libeu) $(libdw) $(libebl) $(libelf)
 dwfl_bug_report_LDADD = $(libdw) $(libebl) $(libelf)
 dwfl_bug_getmodules_LDADD = $(libeu) $(libdw) $(libebl) $(libelf)
 dwfl_addr_sect_LDADD = $(libeu) $(libdw) $(libebl) $(libelf) $(argp_LDADD)
+dwfl_core_noncontig_LDADD = $(libdw) $(libelf)
 dwarf_getmacros_LDADD = $(libdw)
 dwarf_ranges_LDADD = $(libdw)
 dwarf_getstring_LDADD = $(libdw)
@@ -753,7 +768,7 @@ test_elf_cntl_gelf_getshdr_LDADD = $(libelf)
 dwflsyms_LDADD = $(libdw) $(libelf) $(argp_LDADD)
 dwfllines_LDADD = $(libeu) $(libdw) $(libelf) $(argp_LDADD)
 dwfl_report_elf_align_LDADD = $(libeu) $(libdw)
-dwfl_report_offline_memory_LDADD = $(libeu) $(libdw)
+dwfl_report_offline_memory_LDADD = $(libeu) $(libdw) $(libelf)
 dwfl_report_segment_contiguous_LDADD = $(libdw) $(libebl) $(libelf)
 varlocs_LDADD = $(libeu) $(libdw) $(libelf) $(argp_LDADD)
 backtrace_LDADD = $(libeu) $(libdw) $(libelf) $(argp_LDADD)
@@ -807,6 +822,9 @@ getphdrnum_LDADD = $(libelf) $(libdw)
 leb128_LDADD = $(libelf) $(libdw)
 read_unaligned_LDADD = $(libelf) $(libdw)
 nvidia_extended_linemap_libdw_LDADD = $(libelf) $(libdw)
+elf_print_reloc_syms_LDADD = $(libelf)
+cu_dwp_section_info_LDADD = $(libdw)
+declfiles_LDADD = $(libdw)
 
 # We want to test the libelf headers against the system elf.h header.
 # Don't include any -I CPPFLAGS. Except when we install our own elf.h.
diff --git a/tests/cu-dwp-section-info.c b/tests/cu-dwp-section-info.c
new file mode 100644
index 00000000..f1756979
--- /dev/null
+++ b/tests/cu-dwp-section-info.c
@@ -0,0 +1,73 @@
+/* Test program for dwarf_cu_dwp_section_info
+   Copyright (c) 2023 Meta Platforms, Inc. and affiliates.
+   This file is part of elfutils.
+
+   This file is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 3 of the License, or
+   (at your option) any later version.
+
+   elfutils is distributed in the hope that it will be useful, but
+   WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
+
+#ifdef HAVE_CONFIG_H
+# include <config.h>
+#endif
+#include <stdio.h>
+#include <inttypes.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <fcntl.h>
+#include <unistd.h>
+
+#include <dwarf.h>
+#include ELFUTILS_HEADER(dw)
+
+int
+main (int argc, char *argv[])
+{
+  for (int i = 1; i < argc; i++)
+    {
+      printf ("file: %s\n", argv[i]);
+      int fd = open (argv[i], O_RDONLY);
+      Dwarf *dbg = dwarf_begin (fd, DWARF_C_READ);
+      if (dbg == NULL)
+	{
+	  printf ("%s not usable: %s\n", argv[i], dwarf_errmsg (-1));
+	  return -1;
+	}
+
+      Dwarf_CU *cu = NULL;
+      while (dwarf_get_units (dbg, cu, &cu, NULL, NULL, NULL, NULL) == 0)
+	{
+#define SECTION_INFO(section) do {					\
+	    printf (#section ": ");					\
+	    Dwarf_Off offset, size;					\
+	    if (dwarf_cu_dwp_section_info (cu, DW_SECT_##section,	\
+					   &offset, &size) == 0)	\
+	      printf ("0x%" PRIx64 " 0x%" PRIx64 "\n", offset, size);	\
+	    else							\
+	      printf ("%s\n", dwarf_errmsg (-1));			\
+	  } while (0)
+	  SECTION_INFO (INFO);
+	  SECTION_INFO (TYPES);
+	  SECTION_INFO (ABBREV);
+	  SECTION_INFO (LINE);
+	  SECTION_INFO (LOCLISTS);
+	  SECTION_INFO (STR_OFFSETS);
+	  SECTION_INFO (MACRO);
+	  SECTION_INFO (RNGLISTS);
+	  printf ("\n");
+	}
+
+      dwarf_end (dbg);
+      close (fd);
+    }
+
+  return 0;
+}
diff --git a/tests/debuginfod-subr.sh b/tests/debuginfod-subr.sh
index 108dff74..c3b0603d 100755
--- a/tests/debuginfod-subr.sh
+++ b/tests/debuginfod-subr.sh
@@ -79,12 +79,12 @@ errfiles() {
 # So we gather the LD_LIBRARY_PATH with this cunning trick:
 ldpath=`testrun sh -c 'echo $LD_LIBRARY_PATH'`
 
-wait_ready()
+wait_ready4()
 {
   port=$1;
   what=$2;
   value=$3;
-  timeout=20;
+  timeout=$4;
 
   echo "Wait $timeout seconds on $port for metric $what to change to $value"
   while [ $timeout -gt 0 ]; do
@@ -105,6 +105,16 @@ wait_ready()
   fi
 }
 
+wait_ready()
+{
+  port=$1;
+  what=$2;
+  value=$3;
+  timeout=20;
+  wait_ready4 "$port" "$what" "$value" "$timeout"
+}
+
+
 archive_test() {
     __BUILDID=$1
     __SOURCEPATH=$2
diff --git a/tests/declfiles.c b/tests/declfiles.c
new file mode 100644
index 00000000..0842d637
--- /dev/null
+++ b/tests/declfiles.c
@@ -0,0 +1,90 @@
+/* Test program for dwarf_decl_file
+   Copyright (c) 2024 Meta Platforms, Inc. and affiliates.
+   This file is part of elfutils.
+
+   This file is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 3 of the License, or
+   (at your option) any later version.
+
+   elfutils is distributed in the hope that it will be useful, but
+   WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
+
+#ifdef HAVE_CONFIG_H
+# include <config.h>
+#endif
+#include <fcntl.h>
+#include <stdio.h>
+#include <unistd.h>
+
+#include <dwarf.h>
+#include ELFUTILS_HEADER(dw)
+
+static void
+walk_tree (Dwarf_Die *dwarf_die, int indent)
+{
+  Dwarf_Die die = *dwarf_die;
+  do
+    {
+      int child_indent = indent;
+      const char *file = dwarf_decl_file (&die);
+      if (file != NULL)
+	{
+	  printf("%*s", indent, "");
+	  const char *name = dwarf_diename (&die) ?: "???";
+	  int line, column;
+	  if (dwarf_decl_line (&die, &line) == 0)
+	    {
+	      if (dwarf_decl_column (&die, &column) == 0)
+		printf ("%s@%s:%d:%d\n", name, file, line, column);
+	      else
+		printf ("%s@%s:%d\n", name, file, line);
+	    }
+	  else
+	    printf ("%s@%s\n", name, file);
+	  child_indent++;
+	}
+
+      Dwarf_Die child;
+      if (dwarf_child (&die, &child) == 0)
+	walk_tree (&child, child_indent);
+    }
+  while (dwarf_siblingof (&die, &die) == 0);
+}
+
+int
+main (int argc, char *argv[])
+{
+  for (int i = 1; i < argc; i++)
+    {
+      printf ("file: %s\n", argv[i]);
+      int fd = open (argv[i], O_RDONLY);
+      Dwarf *dbg = dwarf_begin (fd, DWARF_C_READ);
+      if (dbg == NULL)
+	{
+	  printf ("%s not usable: %s\n", argv[i], dwarf_errmsg (-1));
+	  return -1;
+	}
+
+      Dwarf_CU *cu = NULL;
+      Dwarf_Die cudie, subdie;
+      uint8_t unit_type;
+      while (dwarf_get_units (dbg, cu, &cu, NULL, &unit_type, &cudie, &subdie)
+	     == 0)
+	{
+	  Dwarf_Die *die = unit_type == DW_UT_skeleton ? &subdie : &cudie;
+	  printf (" cu: %s\n", dwarf_diename (die) ?: "???");
+	  walk_tree (die, 2);
+	}
+
+      dwarf_end (dbg);
+      close (fd);
+    }
+
+  return 0;
+}
diff --git a/tests/dwfl-core-noncontig.c b/tests/dwfl-core-noncontig.c
new file mode 100644
index 00000000..04558e28
--- /dev/null
+++ b/tests/dwfl-core-noncontig.c
@@ -0,0 +1,82 @@
+/* Test program for dwfl_getmodules bug.
+   Copyright (C) 2008 Red Hat, Inc.
+   This file is part of elfutils.
+
+   This file is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 3 of the License, or
+   (at your option) any later version.
+
+   elfutils is distributed in the hope that it will be useful, but
+   WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
+
+#include <config.h>
+#include <stdio.h>
+#include <fcntl.h>
+#include <assert.h>
+#include ELFUTILS_HEADER(dwfl)
+#include ELFUTILS_HEADER(elf)
+
+static const Dwfl_Callbacks cb =
+{
+  NULL,
+  NULL,
+  NULL,
+  NULL,
+};
+
+int
+main (int argc, char **argv)
+{
+  assert (argc == 2);
+
+  Dwfl *dwfl = dwfl_begin (&cb);
+
+  int fd = open (argv[1], O_RDONLY);
+  assert (fd != -1);
+
+  Elf *elf = elf_begin (fd, ELF_C_READ, NULL);
+  (void) dwfl_core_file_report (dwfl, elf, argv[0]);
+
+  /* testcore-noncontig contains a shared library mapped between 
+     non-contiguous segments of another shared library:
+
+     [...]
+     7f14e458c000-7f14e45ae000 00000000 139264      /usr/lib64/ld-2.17.so             (1)
+     7f14e4795000-7f14e4798000 00000000 12288       /usr/lib64/firefox/liblgpllibs.so (2)
+     7f14e4798000-7f14e479d000 00003000 20480       /usr/lib64/firefox/liblgpllibs.so
+     7f14e479d000-7f14e479f000 00008000 8192        /usr/lib64/firefox/liblgpllibs.so
+     7f14e479f000-7f14e47a0000 00009000 4096        /usr/lib64/firefox/liblgpllibs.so
+     7f14e47a0000-7f14e47a1000 0000a000 4096        /usr/lib64/firefox/liblgpllibs.so (3)
+     7f14e47ad000-7f14e47ae000 00021000 4096        /usr/lib64/ld-2.17.so             (4)
+     7f14e47ae000-7f14e47af000 00022000 4096        /usr/lib64/ld-2.17.so  */
+
+  /* First segment of the non-contiguous module (1).  */
+  int seg = dwfl_addrsegment (dwfl, 0x7f14e458c000, NULL);
+  assert (seg == 32);
+
+  /* First segment of the module within the non-contiguous module's address
+     range (2).  */
+  seg = dwfl_addrsegment (dwfl, 0x7f14e4795000, NULL);
+  assert (seg == 33);
+
+  /* Last segment of the module within the non-contiguous module's
+     address range (3).  */
+  seg = dwfl_addrsegment (dwfl, 0x7f14e47a0000, NULL);
+  assert (seg == 37);
+
+  /* First segment of non-contiguous module following its address space
+     gap (4).  */
+  seg = dwfl_addrsegment (dwfl, 0x7f14e47ad000, NULL);
+  assert (seg == 40);
+
+  dwfl_end (dwfl);
+  elf_end (elf);
+
+  return 0;
+}
diff --git a/tests/dwfl-report-offline-memory.c b/tests/dwfl-report-offline-memory.c
index b3b4d9bd..3ecb66b9 100644
--- a/tests/dwfl-report-offline-memory.c
+++ b/tests/dwfl-report-offline-memory.c
@@ -18,14 +18,19 @@
 #include <config.h>
 
 #include <assert.h>
+#include <errno.h>
+#include <error.h>
 #include <fcntl.h>
 #include <locale.h>
 #include <stdio.h>
 #include <stdio_ext.h>
 #include <stdlib.h>
+#include <string.h>
 #include <unistd.h>
+
 #include ELFUTILS_HEADER(dwfl)
-#include "system.h"
+#include ELFUTILS_HEADER(elf)
+#include <gelf.h>
 
 
 static const Dwfl_Callbacks offline_callbacks =
@@ -45,6 +50,20 @@ count_modules (Dwfl_Module *mod __attribute__ ((unused)),
   return DWARF_CB_OK;
 }
 
+static int
+count_sections (Elf *elf)
+{
+  int result = 0;
+  Elf_Scn *section = NULL;
+  GElf_Shdr header;
+  while ((section = elf_nextscn (elf, section)) != NULL)
+    {
+      assert (gelf_getshdr (section, &header) != NULL);
+      result += 1;
+    }
+  return result;
+}
+
 int
 main (int argc, char **argv)
 {
@@ -54,10 +73,11 @@ main (int argc, char **argv)
   /* Set locale.  */
   (void) setlocale (LC_ALL, "");
 
-  if (argc != 3)
+  if (argc != 4)
     error (-1, 0,
 	   "usage: dwfl_report_offline_memory [filename] "
-	   "[expected number of modules]");
+	   "[expected number of modules] "
+	   "[expected number of sections]");
 
   const char *fname = argv[1];
   int fd = open (fname, O_RDONLY);
@@ -100,6 +120,12 @@ main (int argc, char **argv)
   assert (endptr && !*endptr);
   assert (number_of_modules == expected_number_of_modules);
 
+  GElf_Addr loadbase = 0;
+  Elf *elf = dwfl_module_getelf (mod, &loadbase);
+  int number_of_sections = count_sections (elf);
+  int expected_number_of_sections = atoi (argv[3]);
+  assert (number_of_sections == expected_number_of_sections);
+
   dwfl_end (dwfl);
   free (data);
 
diff --git a/tests/elf-print-reloc-syms.c b/tests/elf-print-reloc-syms.c
new file mode 100644
index 00000000..b9453f6b
--- /dev/null
+++ b/tests/elf-print-reloc-syms.c
@@ -0,0 +1,142 @@
+/* Copyright (C) 2024 Red Hat, Inc.
+   This file is part of elfutils.
+
+   This file is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 3 of the License, or
+   (at your option) any later version.
+
+   elfutils is distributed in the hope that it will be useful, but
+   WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */
+
+#ifdef HAVE_CONFIG_H
+# include <config.h>
+#endif
+
+#include <fcntl.h>
+#include <gelf.h>
+#include <stdio.h>
+#include <unistd.h>
+#include <assert.h>
+
+static void
+print_reloc_symnames (Elf *elf, Elf_Scn *scn, GElf_Shdr *shdr, size_t sh_entsize)
+{
+  int nentries = shdr->sh_size / sh_entsize;
+
+  /* Get the data of the section.  */
+  Elf_Data *data = elf_getdata (scn, NULL);
+  assert (data != NULL);
+
+  /* Get the symbol table information.  */
+  Elf_Scn *symscn = elf_getscn (elf, shdr->sh_link);
+  GElf_Shdr symshdr_mem;
+  GElf_Shdr *symshdr = gelf_getshdr (symscn, &symshdr_mem);
+  Elf_Data *symdata = elf_getdata (symscn, NULL);
+  assert (symshdr != NULL);
+  assert (symdata != NULL);
+
+  /* Search for the optional extended section index table.  */
+  Elf_Data *xndxdata = NULL;
+  int xndxscnidx = elf_scnshndx (scn);
+  if (xndxscnidx)
+    xndxdata = elf_getdata (elf_getscn (elf, xndxscnidx), NULL);
+
+  /* Get the section header string table index.  */
+  size_t shstrndx;
+  assert (elf_getshdrstrndx (elf, &shstrndx) >= 0);
+
+  printf("Section: %s\n", elf_strptr (elf, shstrndx, shdr->sh_name));
+  for (int cnt = 0; cnt < nentries; ++cnt)
+    {
+      GElf_Rel relmem;
+      GElf_Rel *rel = gelf_getrel (data, cnt, &relmem);
+
+
+      if (likely (rel != NULL))
+        {
+          GElf_Sym symmem;
+          Elf32_Word xndx;
+          GElf_Sym *sym = gelf_getsymshndx (symdata, xndxdata,
+                                            GELF_R_SYM (rel->r_info),
+                                            &symmem, &xndx);
+
+	  if (sym == NULL)
+	    {
+	      printf ("<SYM NOT FOUND>\n");
+	      continue;
+	    }
+
+          if (GELF_ST_TYPE (sym->st_info) != STT_SECTION)
+            printf ("%s\n", elf_strptr (elf, symshdr->sh_link, sym->st_name));
+          else
+            {
+              /* This is a relocation against a STT_SECTION symbol.  */
+              GElf_Shdr secshdr_mem;
+              GElf_Shdr *secshdr;
+              secshdr = gelf_getshdr (elf_getscn (elf,
+                                                  sym->st_shndx == SHN_XINDEX
+                                                  ? xndx : sym->st_shndx),
+                                      &secshdr_mem);
+
+	      if (secshdr == NULL)
+		printf("<SECTION NOT FOUND>\n");
+              else
+                printf ("%s\n",
+			elf_strptr (elf, shstrndx, secshdr->sh_name));
+            }
+        }
+    }
+}
+
+int
+main (int argc, char *argv[])
+{
+  if (argc != 2)
+    {
+      printf ("Usage: elf_print_reloc_syms FILE\n");
+      return -1;
+    }
+
+  elf_version (EV_CURRENT);
+
+  int fd = open(argv[1], O_RDONLY);
+  assert (fd != -1);
+
+  Elf *elf = elf_begin (fd, ELF_C_READ, NULL);
+  assert (elf != NULL);
+
+  size_t shnums;
+  assert (elf_getshdrnum (elf, &shnums) >= 0);
+
+  Elf_Scn *scn = NULL;
+  while ((scn = elf_nextscn (elf, scn)) != NULL)
+    {
+      GElf_Shdr shdr_mem;
+      GElf_Shdr *shdr = gelf_getshdr (scn, &shdr_mem);
+
+      if (shdr != NULL)
+	{
+	  /* Print the names of symbols referred to by relocations.  */
+	  if (shdr->sh_type == SHT_REL)
+	    {
+	      size_t sh_entsize = gelf_fsize (elf, ELF_T_REL, 1, EV_CURRENT);
+	      print_reloc_symnames (elf, scn, shdr, sh_entsize);
+	    }
+	  else if (shdr->sh_type == SHT_RELA)
+	    {
+	      size_t sh_entsize = gelf_fsize (elf, ELF_T_RELA, 1, EV_CURRENT);
+	      print_reloc_symnames (elf, scn, shdr, sh_entsize);
+	    }
+	}
+    }
+
+  elf_end (elf);
+  close (fd);
+  return 0;
+}
diff --git a/tests/elfgetzdata.c b/tests/elfgetzdata.c
index 82afbe52..0af6c223 100644
--- a/tests/elfgetzdata.c
+++ b/tests/elfgetzdata.c
@@ -1,4 +1,5 @@
 /* Copyright (C) 2015 Red Hat, Inc.
+   Copyright (C) 2024 Mark J. Wielaard <mark@klomp.org>
    This file is part of elfutils.
 
    This file is free software; you can redistribute it and/or modify
@@ -18,16 +19,19 @@
 # include <config.h>
 #endif
 
+#include <assert.h>
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <fcntl.h>
 #include <inttypes.h>
 #include <libelf.h>
+#include <errno.h>
 #include <gelf.h>
 #include <stdbool.h>
 #include <stdio.h>
 #include <string.h>
 #include <unistd.h>
+#include <sys/mman.h>
 
 
 int
@@ -38,21 +42,62 @@ main (int argc, char *argv[])
 
   if (argc < 3
       || (strcmp (argv[1], "read") != 0
-          && strcmp (argv[1], "mmap") != 0))
+          && strcmp (argv[1], "mmap") != 0
+          && strcmp (argv[1], "mem") != 0))
     {
-      printf ("Usage: (read|mmap) files...\n");
+      printf ("Usage: (read|mmap|mem) files...\n");
       return -1;
     }
 
-  bool mmap = strcmp (argv[1], "mmap") == 0;
+  bool do_read = strcmp (argv[1], "read") == 0;
+  bool do_mmap = strcmp (argv[1], "mmap") == 0;
+  bool do_mem = strcmp (argv[1], "mem") == 0;
 
   elf_version (EV_CURRENT);
 
   for (cnt = 2; cnt < argc; ++cnt)
     {
       int fd = open (argv[cnt], O_RDONLY);
-
-      Elf *elf = elf_begin (fd, mmap ? ELF_C_READ_MMAP : ELF_C_READ, NULL);
+      void *map_address = NULL;
+      size_t map_size = 0;
+
+      Elf *elf;
+      if (do_read)
+	elf = elf_begin (fd, ELF_C_READ, NULL);
+      else if (do_mmap)
+	elf = elf_begin (fd, ELF_C_READ_MMAP, NULL);
+      else
+        {
+	  assert (do_mem);
+	  // We mmap the memory ourselves, explicitly PROT_READ only
+	  struct stat st;
+	  if (fstat (fd, &st) != 0)
+	    {
+	      printf ("%s cannot stat %s\n", argv[cnt], strerror (errno));
+	      result = 1;
+	      close (fd);
+	      continue;
+	    }
+	  map_size = st.st_size;
+	  map_address = mmap (NULL, map_size, PROT_READ, MAP_PRIVATE, fd, 0);
+	  if (map_address == MAP_FAILED)
+	    {
+	      printf ("%s cannot mmap %s\n", argv[cnt], strerror (errno));
+	      result = 1;
+	      close (fd);
+	      continue;
+	    }
+	  if (map_size < EI_NIDENT
+	      || memcmp (map_address, ELFMAG, SELFMAG) != 0)
+	    {
+	      printf ("%s isn't an ELF file\n", argv[cnt]);
+	      result = 1;
+	      munmap (map_address, map_size);
+	      close (fd);
+	      continue;
+	    }
+	  elf = elf_memory (map_address, map_size);
+        }
       if (elf == NULL)
 	{
 	  printf ("%s not usable %s\n", argv[cnt], elf_errmsg (-1));
@@ -107,6 +152,21 @@ main (int argc, char *argv[])
 
       elf_end (elf);
       close (fd);
+
+      if (do_mem)
+        {
+          /* Make sure we can still get at the memory.  */
+	  if (memcmp (map_address, ELFMAG, SELFMAG) != 0)
+	    {
+	      printf ("%s isn't an ELF file anymore???\n", argv[cnt]);
+	      result = 1;
+	    }
+	  if (munmap (map_address, map_size) != 0)
+	    {
+	      printf ("%s cannot munmap %s\n", argv[cnt], strerror (errno));
+	      result = 1;
+	    }
+        }
     }
 
   return result;
diff --git a/tests/elfstrmerge.c b/tests/elfstrmerge.c
index 56350bb9..4eb58bbb 100644
--- a/tests/elfstrmerge.c
+++ b/tests/elfstrmerge.c
@@ -447,7 +447,7 @@ main (int argc, char **argv)
     }
 
   newshnums = shdrnum - 1;
-  newscnbufs = calloc (sizeof (void *), newshnums);
+  newscnbufs = calloc (newshnums, sizeof (void *));
   if (newscnbufs == NULL)
     fail_errno ("Couldn't allocate memory for new section buffers", NULL);
 
diff --git a/tests/run-all-dwarf-ranges.sh b/tests/run-all-dwarf-ranges.sh
index cefb4231..61141cfa 100755
--- a/tests/run-all-dwarf-ranges.sh
+++ b/tests/run-all-dwarf-ranges.sh
@@ -126,4 +126,118 @@ die: no_subject (2e)
 
 EOF
 
+# See testfile-dwp.source.
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testfiles testfile-dwp-4 testfile-dwp-4.dwp
+
+testrun_compare ${abs_builddir}/all-dwarf-ranges testfile-dwp-5 << EOF
+die: foo.cc (11)
+ 401190..401200
+
+die: foo (2e)
+ 4011c0..401200
+
+die: x_x (1d)
+ 4011cb..4011eb
+ 4011f8..401200
+
+die: <unknown> (b)
+ 4011cb..4011eb
+ 4011f8..401200
+
+die: x_x (2e)
+ 401190..4011bd
+
+die: <unknown> (b)
+ 401190..401190
+ 401192..4011bb
+
+die: bar.cc (11)
+ 401200..40121b
+
+die: bar (2e)
+ 401200..40121b
+
+die: main.cc (11)
+ 401020..4010a0
+
+die: main (2e)
+ 401020..4010a0
+
+die: fibonacci (1d)
+ 401030..401032
+ 401036..401060
+ 401099..4010a0
+
+die: fibonacci (1d)
+ 40103a..401060
+ 401099..4010a0
+
+die: <unknown> (b)
+ 40103a..401060
+ 401099..4010a0
+
+die: <unknown> (b)
+ 40103a..401044
+ 401050..401060
+
+die: <unknown> (b)
+ 401050..401053
+ 401056..401059
+
+EOF
+
+testrun_compare ${abs_builddir}/all-dwarf-ranges testfile-dwp-4 << EOF
+die: foo.cc (11)
+ 401190..401200
+
+die: foo (2e)
+ 4011c0..401200
+
+die: x_x (1d)
+ 4011cb..4011eb
+ 4011f8..401200
+
+die: <unknown> (b)
+ 4011cb..4011eb
+ 4011f8..401200
+
+die: x_x (2e)
+ 401190..4011bd
+
+die: bar.cc (11)
+ 401200..40121b
+
+die: bar (2e)
+ 401200..40121b
+
+die: main.cc (11)
+ 401020..4010a0
+
+die: main (2e)
+ 401020..4010a0
+
+die: fibonacci (1d)
+ 401030..401032
+ 401036..401060
+ 401099..4010a0
+
+die: fibonacci (1d)
+ 40103a..401060
+ 401099..4010a0
+
+die: <unknown> (b)
+ 40103a..401060
+ 401099..4010a0
+
+die: <unknown> (b)
+ 40103a..401044
+ 401050..401060
+
+die: <unknown> (b)
+ 401050..401053
+ 401056..401059
+
+EOF
+
 exit 0
diff --git a/tests/run-allfcts.sh b/tests/run-allfcts.sh
index 9c0a55d8..4dd0284a 100755
--- a/tests/run-allfcts.sh
+++ b/tests/run-allfcts.sh
@@ -170,4 +170,21 @@ testrun_compare ${abs_builddir}/allfcts testfile-lto-gcc9 <<\EOF
 /home/mark/src/tests/testfile-lto-main.c:6:main
 EOF
 
+# = dwarf5-line.c =
+# int
+# main (int argc, char **argv)
+# {
+#   return 0;
+# }
+
+# Using clang version 17.0.4 (Fedora 17.0.4-1.fc39)
+# clang -gdwarf-5 -o testfile-dwarf5-line-clang dwarf5-line.c
+
+testfiles testfile-dwarf5-line-clang
+
+# Check that dwarf_decl_file can handle .debug_line file table index 0
+testrun_compare ${abs_builddir}/allfcts testfile-dwarf5-line-clang <<\EOF
+/home/amerey/test/dwarf5-line.c:2:main
+EOF
+
 exit 0
diff --git a/tests/run-cu-dwp-section-info.sh b/tests/run-cu-dwp-section-info.sh
new file mode 100755
index 00000000..202319c6
--- /dev/null
+++ b/tests/run-cu-dwp-section-info.sh
@@ -0,0 +1,168 @@
+#! /bin/sh
+# Copyright (c) 2023 Meta Platforms, Inc. and affiliates.
+# This file is part of elfutils.
+#
+# This file is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 3 of the License, or
+# (at your option) any later version.
+#
+# elfutils is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program.  If not, see <http://www.gnu.org/licenses/>.
+
+. $srcdir/test-subr.sh
+
+# See testfile-dwp.source.
+testfiles testfile-dwp-5.dwp testfile-dwp-4.dwp testfile-dwp-4-strict.dwp
+
+testrun_compare ${abs_builddir}/cu-dwp-section-info testfile-dwp-5.dwp << EOF
+file: testfile-dwp-5.dwp
+INFO: 0x0 0x70
+TYPES: 0x0 0x0
+ABBREV: 0x0 0x160
+LINE: 0x0 0x7f
+LOCLISTS: 0x0 0xdb
+STR_OFFSETS: 0x0 0x75c
+MACRO: 0x0 0x6c6
+RNGLISTS: 0x0 0x22
+
+INFO: 0x70 0x108
+TYPES: 0x0 0x0
+ABBREV: 0x0 0x160
+LINE: 0x0 0x7f
+LOCLISTS: 0x0 0xdb
+STR_OFFSETS: 0x0 0x75c
+MACRO: 0x0 0x6c6
+RNGLISTS: 0x0 0x22
+
+INFO: 0x178 0x6e
+TYPES: 0x0 0x0
+ABBREV: 0x160 0xca
+LINE: 0x7f 0x7f
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x75c 0x758
+MACRO: 0x6c6 0x6c5
+RNGLISTS: 0x0 0x0
+
+INFO: 0x1e6 0x78
+TYPES: 0x0 0x0
+ABBREV: 0x160 0xca
+LINE: 0x7f 0x7f
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x75c 0x758
+MACRO: 0x6c6 0x6c5
+RNGLISTS: 0x0 0x0
+
+INFO: 0x25e 0x193
+TYPES: 0x0 0x0
+ABBREV: 0x22a 0x18a
+LINE: 0xfe 0x81
+LOCLISTS: 0xdb 0xc9
+STR_OFFSETS: 0xeb4 0x77c
+MACRO: 0xd8b 0x6c6
+RNGLISTS: 0x22 0x43
+
+EOF
+
+testrun_compare ${abs_builddir}/cu-dwp-section-info testfile-dwp-4.dwp << EOF
+file: testfile-dwp-4.dwp
+INFO: 0x0 0x11e
+TYPES: 0x0 0x0
+ABBREV: 0x0 0x172
+LINE: 0x0 0x52
+LOCLISTS: 0x0 0x11b
+STR_OFFSETS: 0x0 0x754
+MACRO: 0x0 0x6c7
+RNGLISTS: 0x0 0x0
+
+INFO: 0x11e 0x76
+TYPES: 0x0 0x0
+ABBREV: 0x172 0xd7
+LINE: 0x52 0x52
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x754 0x750
+MACRO: 0x6c7 0x6c6
+RNGLISTS: 0x0 0x0
+
+INFO: 0x194 0x1c5
+TYPES: 0x0 0x0
+ABBREV: 0x249 0x19e
+LINE: 0xa4 0x53
+LOCLISTS: 0x11b 0xf1
+STR_OFFSETS: 0xea4 0x774
+MACRO: 0xd8d 0x6c7
+RNGLISTS: 0x0 0x0
+
+INFO: 0x0 0x0
+TYPES: 0x0 0x6f
+ABBREV: 0x0 0x172
+LINE: 0x0 0x52
+LOCLISTS: 0x0 0x11b
+STR_OFFSETS: 0x0 0x754
+MACRO: 0x0 0x6c7
+RNGLISTS: 0x0 0x0
+
+INFO: 0x0 0x0
+TYPES: 0x6f 0x6d
+ABBREV: 0x172 0xd7
+LINE: 0x52 0x52
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x754 0x750
+MACRO: 0x6c7 0x6c6
+RNGLISTS: 0x0 0x0
+
+EOF
+
+testrun_compare ${abs_builddir}/cu-dwp-section-info testfile-dwp-4-strict.dwp << EOF
+file: testfile-dwp-4-strict.dwp
+INFO: 0x0 0x105
+TYPES: 0x0 0x0
+ABBREV: 0x0 0x15f
+LINE: 0x0 0x52
+LOCLISTS: 0x0 0xe2
+STR_OFFSETS: 0x0 0x24
+MACRO: 0x0 0x38e4
+RNGLISTS: 0x0 0x0
+
+INFO: 0x105 0x72
+TYPES: 0x0 0x0
+ABBREV: 0x15f 0xd3
+LINE: 0x52 0x52
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x24 0x20
+MACRO: 0x38e4 0x38db
+RNGLISTS: 0x0 0x0
+
+INFO: 0x177 0x17b
+TYPES: 0x0 0x0
+ABBREV: 0x232 0x157
+LINE: 0xa4 0x53
+LOCLISTS: 0xe2 0xb1
+STR_OFFSETS: 0x44 0x44
+MACRO: 0x71bf 0x38f5
+RNGLISTS: 0x0 0x0
+
+INFO: 0x0 0x0
+TYPES: 0x0 0x6e
+ABBREV: 0x0 0x15f
+LINE: 0x0 0x52
+LOCLISTS: 0x0 0xe2
+STR_OFFSETS: 0x0 0x24
+MACRO: 0x0 0x38e4
+RNGLISTS: 0x0 0x0
+
+INFO: 0x0 0x0
+TYPES: 0x6e 0x6b
+ABBREV: 0x15f 0xd3
+LINE: 0x52 0x52
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x24 0x20
+MACRO: 0x38e4 0x38db
+RNGLISTS: 0x0 0x0
+
+EOF
diff --git a/tests/run-debuginfod-response-headers.sh b/tests/run-debuginfod-response-headers.sh
index fbb6a484..ea516ced 100755
--- a/tests/run-debuginfod-response-headers.sh
+++ b/tests/run-debuginfod-response-headers.sh
@@ -32,14 +32,6 @@ export DEBUGINFOD_CACHE_PATH=${PWD}/.client_cache
 base=9500
 get_ports
 mkdir F R
-env LD_LIBRARY_PATH=$ldpath DEBUGINFOD_URLS= ${abs_builddir}/../debuginfod/debuginfod $VERBOSE -F -R -d $DB -p $PORT1 -t0 -g0 -v R F > vlog$PORT1 2>&1 &
-PID1=$!
-tempfiles vlog$PORT1
-errfiles vlog$PORT1
-# Server must become ready
-wait_ready $PORT1 'ready' 1
-export DEBUGINFOD_URLS=http://127.0.0.1:$PORT1/   # or without trailing /
-########################################################################
 
 # Compile a simple program, strip its debuginfo and save the build-id.
 # Also move the debuginfo into another directory so that elfutils
@@ -57,12 +49,25 @@ if [ "$zstd" = "false" ]; then  # nuke the zstd fedora 31 ones
     rm -vrf R/debuginfod-rpms/fedora31
 fi
 
-kill -USR1 $PID1
+env LD_LIBRARY_PATH=$ldpath DEBUGINFOD_URLS= ${abs_builddir}/../debuginfod/debuginfod $VERBOSE -F -R -d $DB -p $PORT1 -t0 -g0 -v R F > vlog$PORT1 2>&1 &
+PID1=$!
+tempfiles vlog$PORT1
+errfiles vlog$PORT1
+# Server must become ready
+wait_ready $PORT1 'ready' 1
+export DEBUGINFOD_URLS=http://127.0.0.1:$PORT1/   # or without trailing /
+########################################################################
+
 # Wait till both files are in the index and scan/index fully finished
+wait_ready $PORT1 'ready' 1
 wait_ready $PORT1 'thread_work_total{role="traverse"}' 1
+wait_ready $PORT1 'thread_work_pending{role="scan"}' 0
+wait_ready $PORT1 'thread_busy{role="scan"}' 0
+
 # All rpms need to be in the index, except the dummy permission-000 one
 rpms=$(find R -name \*rpm | grep -v nothing | wc -l)
 wait_ready $PORT1 'scanned_files_total{source=".rpm archive"}' $rpms
+
 kill -USR1 $PID1  # two hits of SIGUSR1 may be needed to resolve .debug->dwz->srefs
 # Wait till both files are in the index and scan/index fully finished
 wait_ready $PORT1 'thread_work_total{role="traverse"}' 2
diff --git a/tests/run-declfiles.sh b/tests/run-declfiles.sh
new file mode 100755
index 00000000..5aa1b970
--- /dev/null
+++ b/tests/run-declfiles.sh
@@ -0,0 +1,323 @@
+#! /bin/sh
+# Copyright (c) 2024 Meta Platforms, Inc. and affiliates.
+# This file is part of elfutils.
+#
+# This file is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 3 of the License, or
+# (at your option) any later version.
+#
+# elfutils is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program.  If not, see <http://www.gnu.org/licenses/>.
+
+. $srcdir/test-subr.sh
+
+# see tests/testfile-dwarf-45.source
+testfiles testfile-dwarf-4 testfile-dwarf-5
+testfiles testfile-splitdwarf-4 testfile-hello4.dwo testfile-world4.dwo
+testfiles testfile-splitdwarf-5 testfile-hello5.dwo testfile-world5.dwo
+
+testrun_compare ${abs_builddir}/declfiles testfile-dwarf-4 << EOF
+file: testfile-dwarf-4
+ cu: hello.c
+  wchar_t@/opt/local/install/gcc/lib/gcc/x86_64-pc-linux-gnu/9.0.0/include/stddef.h:328:24
+  m@/var/tmp/hello/hello.h:1:12
+  m@/var/tmp/hello/hello.c:5:5
+  foo@/var/tmp/hello/hello.c:20:1
+   f@/var/tmp/hello/hello.c:20:14
+  baz@/var/tmp/hello/hello.c:8:5
+   x@/var/tmp/hello/hello.c:8:14
+   r@/var/tmp/hello/hello.c:10:7
+  frob@/var/tmp/hello/hello.h:5:1
+   a@/var/tmp/hello/hello.h:5:11
+   b@/var/tmp/hello/hello.h:5:18
+   c@/var/tmp/hello/hello.h:7:7
+  foo@/var/tmp/hello/hello.c:20:1
+   f@/var/tmp/hello/hello.c:20:14
+   frob@/var/tmp/hello/hello.h:5:1
+    b@/var/tmp/hello/hello.h:5:18
+    a@/var/tmp/hello/hello.h:5:11
+    c@/var/tmp/hello/hello.h:7:7
+    baz@/var/tmp/hello/hello.c:8:5
+     x@/var/tmp/hello/hello.c:8:14
+     r@/var/tmp/hello/hello.c:10:7
+   foo@/var/tmp/hello/hello.c:20:1
+    f@/var/tmp/hello/hello.c:20:14
+    main@/var/tmp/hello/hello.c:4:12
+  baz@/var/tmp/hello/hello.c:8:5
+   x@/var/tmp/hello/hello.c:8:14
+   r@/var/tmp/hello/hello.c:10:7
+   foo@/var/tmp/hello/hello.c:20:1
+  main@/var/tmp/hello/hello.c:4:12
+ cu: world.c
+  m@/var/tmp/hello/hello.h:1:12
+  main@/var/tmp/hello/world.c:14:1
+   argc@/var/tmp/hello/world.c:14:11
+   argv@/var/tmp/hello/world.c:14:30
+   n@/var/tmp/hello/world.c:16:15
+   calc@/var/tmp/hello/world.c:5:1
+   exit@/usr/include/stdlib.h:542:13
+  calc@/var/tmp/hello/world.c:5:1
+   word@/var/tmp/hello/world.c:5:19
+   frob@/var/tmp/hello/hello.h:5:1
+    b@/var/tmp/hello/hello.h:5:18
+    a@/var/tmp/hello/hello.h:5:11
+    c@/var/tmp/hello/hello.h:7:7
+    baz@/var/tmp/hello/hello.h:2:12
+  frob@/var/tmp/hello/hello.h:5:1
+   a@/var/tmp/hello/hello.h:5:11
+   b@/var/tmp/hello/hello.h:5:18
+   c@/var/tmp/hello/hello.h:7:7
+  exit@/usr/include/stdlib.h:542:13
+  baz@/var/tmp/hello/hello.h:2:12
+EOF
+
+testrun_compare ${abs_builddir}/declfiles testfile-dwarf-5 << EOF
+file: testfile-dwarf-5
+ cu: hello.c
+  wchar_t@/opt/local/install/gcc/lib/gcc/x86_64-pc-linux-gnu/9.0.0/include/stddef.h:328:24
+  m@/var/tmp/hello/hello.h:1:12
+  m@/var/tmp/hello/hello.c:5:5
+  foo@/var/tmp/hello/hello.c:20:1
+   f@/var/tmp/hello/hello.c:20:14
+  baz@/var/tmp/hello/hello.c:8:5
+   x@/var/tmp/hello/hello.c:8:14
+   r@/var/tmp/hello/hello.c:10:7
+  frob@/var/tmp/hello/hello.h:5:1
+   a@/var/tmp/hello/hello.h:5:11
+   b@/var/tmp/hello/hello.h:5:18
+   c@/var/tmp/hello/hello.h:7:7
+  foo@/var/tmp/hello/hello.c:20:1
+   f@/var/tmp/hello/hello.c:20:14
+   frob@/var/tmp/hello/hello.h:5:1
+    b@/var/tmp/hello/hello.h:5:18
+    a@/var/tmp/hello/hello.h:5:11
+    c@/var/tmp/hello/hello.h:7:7
+    baz@/var/tmp/hello/hello.c:8:5
+     x@/var/tmp/hello/hello.c:8:14
+     r@/var/tmp/hello/hello.c:10:7
+   foo@/var/tmp/hello/hello.c:20:1
+    f@/var/tmp/hello/hello.c:20:14
+  baz@/var/tmp/hello/hello.c:8:5
+   x@/var/tmp/hello/hello.c:8:14
+   r@/var/tmp/hello/hello.c:10:7
+  main@/var/tmp/hello/hello.c:4:12
+ cu: world.c
+  m@/var/tmp/hello/hello.h:1:12
+  main@/var/tmp/hello/world.c:14:1
+   argc@/var/tmp/hello/world.c:14:11
+   argv@/var/tmp/hello/world.c:14:30
+   n@/var/tmp/hello/world.c:16:15
+  calc@/var/tmp/hello/world.c:5:1
+   word@/var/tmp/hello/world.c:5:19
+   frob@/var/tmp/hello/hello.h:5:1
+    b@/var/tmp/hello/hello.h:5:18
+    a@/var/tmp/hello/hello.h:5:11
+    c@/var/tmp/hello/hello.h:7:7
+  frob@/var/tmp/hello/hello.h:5:1
+   a@/var/tmp/hello/hello.h:5:11
+   b@/var/tmp/hello/hello.h:5:18
+   c@/var/tmp/hello/hello.h:7:7
+  exit@/usr/include/stdlib.h:542:13
+  baz@/var/tmp/hello/hello.h:2:12
+EOF
+
+testrun_compare ${abs_builddir}/declfiles testfile-splitdwarf-4 << EOF
+file: testfile-splitdwarf-4
+ cu: hello.c
+  wchar_t@/opt/local/install/gcc/lib/gcc/x86_64-pc-linux-gnu/9.0.0/include/stddef.h:328:24
+  m@/home/mark/src/elfutils/tests/hello.h:1:12
+  m@/home/mark/src/elfutils/tests/hello.c:5:5
+  foo@/home/mark/src/elfutils/tests/hello.c:20:1
+   f@/home/mark/src/elfutils/tests/hello.c:20:14
+  baz@/home/mark/src/elfutils/tests/hello.c:8:5
+   x@/home/mark/src/elfutils/tests/hello.c:8:14
+   r@/home/mark/src/elfutils/tests/hello.c:10:7
+  frob@/home/mark/src/elfutils/tests/hello.h:5:1
+   a@/home/mark/src/elfutils/tests/hello.h:5:11
+   b@/home/mark/src/elfutils/tests/hello.h:5:18
+   c@/home/mark/src/elfutils/tests/hello.h:7:7
+  foo@/home/mark/src/elfutils/tests/hello.c:20:1
+   f@/home/mark/src/elfutils/tests/hello.c:20:14
+   frob@/home/mark/src/elfutils/tests/hello.h:5:1
+    b@/home/mark/src/elfutils/tests/hello.h:5:18
+    a@/home/mark/src/elfutils/tests/hello.h:5:11
+    c@/home/mark/src/elfutils/tests/hello.h:7:7
+    baz@/home/mark/src/elfutils/tests/hello.c:8:5
+     x@/home/mark/src/elfutils/tests/hello.c:8:14
+     r@/home/mark/src/elfutils/tests/hello.c:10:7
+   foo@/home/mark/src/elfutils/tests/hello.c:20:1
+    f@/home/mark/src/elfutils/tests/hello.c:20:14
+    main@/home/mark/src/elfutils/tests/hello.c:4:12
+  baz@/home/mark/src/elfutils/tests/hello.c:8:5
+   x@/home/mark/src/elfutils/tests/hello.c:8:14
+   r@/home/mark/src/elfutils/tests/hello.c:10:7
+   foo@/home/mark/src/elfutils/tests/hello.c:20:1
+  main@/home/mark/src/elfutils/tests/hello.c:4:12
+ cu: world.c
+  m@/home/mark/src/elfutils/tests/hello.h:1:12
+  main@/home/mark/src/elfutils/tests/world.c:14:1
+   argc@/home/mark/src/elfutils/tests/world.c:14:11
+   argv@/home/mark/src/elfutils/tests/world.c:14:30
+   n@/home/mark/src/elfutils/tests/world.c:16:15
+   calc@/home/mark/src/elfutils/tests/world.c:5:1
+   exit@/usr/include/stdlib.h:542:13
+  calc@/home/mark/src/elfutils/tests/world.c:5:1
+   word@/home/mark/src/elfutils/tests/world.c:5:19
+   frob@/home/mark/src/elfutils/tests/hello.h:5:1
+    b@/home/mark/src/elfutils/tests/hello.h:5:18
+    a@/home/mark/src/elfutils/tests/hello.h:5:11
+    c@/home/mark/src/elfutils/tests/hello.h:7:7
+    baz@/home/mark/src/elfutils/tests/hello.h:2:12
+  frob@/home/mark/src/elfutils/tests/hello.h:5:1
+   a@/home/mark/src/elfutils/tests/hello.h:5:11
+   b@/home/mark/src/elfutils/tests/hello.h:5:18
+   c@/home/mark/src/elfutils/tests/hello.h:7:7
+  exit@/usr/include/stdlib.h:542:13
+  baz@/home/mark/src/elfutils/tests/hello.h:2:12
+EOF
+
+testrun_compare ${abs_builddir}/declfiles testfile-splitdwarf-5 << EOF
+file: testfile-splitdwarf-5
+ cu: hello.c
+  wchar_t@/opt/local/install/gcc/lib/gcc/x86_64-pc-linux-gnu/9.0.0/include/stddef.h:328:24
+  m@/home/mark/src/elfutils/tests/hello.h:1:12
+  m@/home/mark/src/elfutils/tests/hello.c:5:5
+  foo@/home/mark/src/elfutils/tests/hello.c:20:1
+   f@/home/mark/src/elfutils/tests/hello.c:20:14
+  baz@/home/mark/src/elfutils/tests/hello.c:8:5
+   x@/home/mark/src/elfutils/tests/hello.c:8:14
+   r@/home/mark/src/elfutils/tests/hello.c:10:7
+  frob@/home/mark/src/elfutils/tests/hello.h:5:1
+   a@/home/mark/src/elfutils/tests/hello.h:5:11
+   b@/home/mark/src/elfutils/tests/hello.h:5:18
+   c@/home/mark/src/elfutils/tests/hello.h:7:7
+  foo@/home/mark/src/elfutils/tests/hello.c:20:1
+   f@/home/mark/src/elfutils/tests/hello.c:20:14
+   frob@/home/mark/src/elfutils/tests/hello.h:5:1
+    b@/home/mark/src/elfutils/tests/hello.h:5:18
+    a@/home/mark/src/elfutils/tests/hello.h:5:11
+    c@/home/mark/src/elfutils/tests/hello.h:7:7
+    baz@/home/mark/src/elfutils/tests/hello.c:8:5
+     x@/home/mark/src/elfutils/tests/hello.c:8:14
+     r@/home/mark/src/elfutils/tests/hello.c:10:7
+   foo@/home/mark/src/elfutils/tests/hello.c:20:1
+    f@/home/mark/src/elfutils/tests/hello.c:20:14
+  baz@/home/mark/src/elfutils/tests/hello.c:8:5
+   x@/home/mark/src/elfutils/tests/hello.c:8:14
+   r@/home/mark/src/elfutils/tests/hello.c:10:7
+  main@/home/mark/src/elfutils/tests/hello.c:4:12
+ cu: world.c
+  m@/home/mark/src/elfutils/tests/hello.h:1:12
+  main@/home/mark/src/elfutils/tests/world.c:14:1
+   argc@/home/mark/src/elfutils/tests/world.c:14:11
+   argv@/home/mark/src/elfutils/tests/world.c:14:30
+   n@/home/mark/src/elfutils/tests/world.c:16:15
+  calc@/home/mark/src/elfutils/tests/world.c:5:1
+   word@/home/mark/src/elfutils/tests/world.c:5:19
+   frob@/home/mark/src/elfutils/tests/hello.h:5:1
+    b@/home/mark/src/elfutils/tests/hello.h:5:18
+    a@/home/mark/src/elfutils/tests/hello.h:5:11
+    c@/home/mark/src/elfutils/tests/hello.h:7:7
+  frob@/home/mark/src/elfutils/tests/hello.h:5:1
+   a@/home/mark/src/elfutils/tests/hello.h:5:11
+   b@/home/mark/src/elfutils/tests/hello.h:5:18
+   c@/home/mark/src/elfutils/tests/hello.h:7:7
+  exit@/usr/include/stdlib.h:542:13
+  baz@/home/mark/src/elfutils/tests/hello.h:2:12
+EOF
+
+# See testfile-dwp.source.
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testfiles testfile-dwp-4 testfile-dwp-4.dwp
+
+testrun_compare ${abs_builddir}/declfiles testfile-dwp-5 << EOF
+file: testfile-dwp-5
+ cu: foo.cc
+  foo@/home/osandov/src/elfutils/tests/foobar.h:4:7
+  foo@/home/osandov/src/elfutils/tests/foo.cc:14:1
+   x@/home/osandov/src/elfutils/tests/foo.cc:16:7
+   x_x@/home/osandov/src/elfutils/tests/foo.cc:6:1
+    x@/home/osandov/src/elfutils/tests/foo.cc:6:10
+    i@/home/osandov/src/elfutils/tests/foo.cc:8:12
+  x_x@/home/osandov/src/elfutils/tests/foo.cc:6:1
+   x@/home/osandov/src/elfutils/tests/foo.cc:6:10
+   i@/home/osandov/src/elfutils/tests/foo.cc:8:12
+  x_x@/home/osandov/src/elfutils/tests/foo.cc:6:1
+   x@/home/osandov/src/elfutils/tests/foo.cc:6:10
+   i@/home/osandov/src/elfutils/tests/foo.cc:8:12
+ cu: bar.cc
+  bar@/home/osandov/src/elfutils/tests/foobar.h:10:8
+  bar@/home/osandov/src/elfutils/tests/bar.cc:6:1
+ cu: main.cc
+  foo@/home/osandov/src/elfutils/tests/foobar.h:4:7
+  bar@/home/osandov/src/elfutils/tests/foobar.h:10:8
+  main@/home/osandov/src/elfutils/tests/main.cc:6:1
+   argc@/home/osandov/src/elfutils/tests/main.cc:6:6
+   argv@/home/osandov/src/elfutils/tests/main.cc:6:6
+   myfoo@/home/osandov/src/elfutils/tests/main.cc:8:14
+   mybar@/home/osandov/src/elfutils/tests/main.cc:9:14
+   fibonacci@/home/osandov/src/elfutils/tests/foobar.h:17:1
+    n@/home/osandov/src/elfutils/tests/foobar.h:17:25
+    fibonacci@/home/osandov/src/elfutils/tests/foobar.h:17:1
+     n@/home/osandov/src/elfutils/tests/foobar.h:17:25
+     a@/home/osandov/src/elfutils/tests/foobar.h:23:12
+     b@/home/osandov/src/elfutils/tests/foobar.h:24:12
+     i@/home/osandov/src/elfutils/tests/foobar.h:25:25
+     tmp@/home/osandov/src/elfutils/tests/foobar.h:27:9
+  fibonacci@/home/osandov/src/elfutils/tests/foobar.h:17:1
+   n@/home/osandov/src/elfutils/tests/foobar.h:17:25
+   a@/home/osandov/src/elfutils/tests/foobar.h:23:12
+   b@/home/osandov/src/elfutils/tests/foobar.h:24:12
+   i@/home/osandov/src/elfutils/tests/foobar.h:25:25
+   tmp@/home/osandov/src/elfutils/tests/foobar.h:27:9
+EOF
+
+testrun_compare ${abs_builddir}/declfiles testfile-dwp-4 << EOF
+file: testfile-dwp-4
+ cu: foo.cc
+  foo@/home/osandov/src/elfutils/tests/foobar.h:4:7
+  foo@/home/osandov/src/elfutils/tests/foo.cc:14:1
+   x@/home/osandov/src/elfutils/tests/foo.cc:16:7
+   x_x@/home/osandov/src/elfutils/tests/foo.cc:6:1
+    x@/home/osandov/src/elfutils/tests/foo.cc:6:10
+    i@/home/osandov/src/elfutils/tests/foo.cc:8:12
+  x_x@/home/osandov/src/elfutils/tests/foo.cc:6:1
+   x@/home/osandov/src/elfutils/tests/foo.cc:6:10
+   i@/home/osandov/src/elfutils/tests/foo.cc:8:12
+  x_x@/home/osandov/src/elfutils/tests/foo.cc:6:1
+   x@/home/osandov/src/elfutils/tests/foo.cc:6:10
+   i@/home/osandov/src/elfutils/tests/foo.cc:8:12
+ cu: bar.cc
+  bar@/home/osandov/src/elfutils/tests/foobar.h:10:8
+  bar@/home/osandov/src/elfutils/tests/bar.cc:6:1
+ cu: main.cc
+  foo@/home/osandov/src/elfutils/tests/foobar.h:4:7
+  bar@/home/osandov/src/elfutils/tests/foobar.h:10:8
+  main@/home/osandov/src/elfutils/tests/main.cc:6:1
+   argc@/home/osandov/src/elfutils/tests/main.cc:6:6
+   argv@/home/osandov/src/elfutils/tests/main.cc:6:6
+   myfoo@/home/osandov/src/elfutils/tests/main.cc:8:14
+   mybar@/home/osandov/src/elfutils/tests/main.cc:9:14
+   fibonacci@/home/osandov/src/elfutils/tests/foobar.h:17:1
+    n@/home/osandov/src/elfutils/tests/foobar.h:17:25
+    fibonacci@/home/osandov/src/elfutils/tests/foobar.h:17:1
+     n@/home/osandov/src/elfutils/tests/foobar.h:17:25
+     a@/home/osandov/src/elfutils/tests/foobar.h:23:12
+     b@/home/osandov/src/elfutils/tests/foobar.h:24:12
+     i@/home/osandov/src/elfutils/tests/foobar.h:25:25
+     tmp@/home/osandov/src/elfutils/tests/foobar.h:27:9
+   foo@/home/osandov/src/elfutils/tests/foobar.h:4:7
+   bar@/home/osandov/src/elfutils/tests/foobar.h:10:8
+  fibonacci@/home/osandov/src/elfutils/tests/foobar.h:17:1
+   n@/home/osandov/src/elfutils/tests/foobar.h:17:25
+   a@/home/osandov/src/elfutils/tests/foobar.h:23:12
+   b@/home/osandov/src/elfutils/tests/foobar.h:24:12
+   i@/home/osandov/src/elfutils/tests/foobar.h:25:25
+   tmp@/home/osandov/src/elfutils/tests/foobar.h:27:9
+EOF
diff --git a/tests/run-dwarf-getmacros.sh b/tests/run-dwarf-getmacros.sh
index 0a488fa3..220c2426 100755
--- a/tests/run-dwarf-getmacros.sh
+++ b/tests/run-dwarf-getmacros.sh
@@ -707,4 +707,1416 @@ file /home/petr/proj/elfutils/master/elfutils/x.c
 /file
 EOF
 
+# See testfile-dwp.source.
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testfiles testfile-dwp-4-strict testfile-dwp-4-strict.dwp
+
+# Not testfile-dwp-4 because it's unclear what to do about
+# https://gcc.gnu.org/bugzilla/show_bug.cgi?id=99319.
+for file in testfile-dwp-5 testfile-dwp-4-strict; do
+	testrun_compare ${abs_builddir}/dwarf-getmacros "$file" '' '' << EOF
+CU foo.cc
+__STDC__ 1
+__cplusplus 201703L
+__STDC_UTF_16__ 1
+__STDC_UTF_32__ 1
+__STDC_HOSTED__ 1
+__GNUC__ 14
+__GNUC_MINOR__ 0
+__GNUC_PATCHLEVEL__ 0
+__VERSION__ "14.0.0 20230920 (experimental)"
+__ATOMIC_RELAXED 0
+__ATOMIC_SEQ_CST 5
+__ATOMIC_ACQUIRE 2
+__ATOMIC_RELEASE 3
+__ATOMIC_ACQ_REL 4
+__ATOMIC_CONSUME 1
+__OPTIMIZE__ 1
+__FINITE_MATH_ONLY__ 0
+_LP64 1
+__LP64__ 1
+__SIZEOF_INT__ 4
+__SIZEOF_LONG__ 8
+__SIZEOF_LONG_LONG__ 8
+__SIZEOF_SHORT__ 2
+__SIZEOF_FLOAT__ 4
+__SIZEOF_DOUBLE__ 8
+__SIZEOF_LONG_DOUBLE__ 16
+__SIZEOF_SIZE_T__ 8
+__CHAR_BIT__ 8
+__BIGGEST_ALIGNMENT__ 16
+__ORDER_LITTLE_ENDIAN__ 1234
+__ORDER_BIG_ENDIAN__ 4321
+__ORDER_PDP_ENDIAN__ 3412
+__BYTE_ORDER__ __ORDER_LITTLE_ENDIAN__
+__FLOAT_WORD_ORDER__ __ORDER_LITTLE_ENDIAN__
+__SIZEOF_POINTER__ 8
+__GNUC_EXECUTION_CHARSET_NAME "UTF-8"
+__GNUC_WIDE_EXECUTION_CHARSET_NAME "UTF-32LE"
+__GNUG__ 14
+__SIZE_TYPE__ long unsigned int
+__PTRDIFF_TYPE__ long int
+__WCHAR_TYPE__ int
+__WINT_TYPE__ unsigned int
+__INTMAX_TYPE__ long int
+__UINTMAX_TYPE__ long unsigned int
+__CHAR16_TYPE__ short unsigned int
+__CHAR32_TYPE__ unsigned int
+__SIG_ATOMIC_TYPE__ int
+__INT8_TYPE__ signed char
+__INT16_TYPE__ short int
+__INT32_TYPE__ int
+__INT64_TYPE__ long int
+__UINT8_TYPE__ unsigned char
+__UINT16_TYPE__ short unsigned int
+__UINT32_TYPE__ unsigned int
+__UINT64_TYPE__ long unsigned int
+__INT_LEAST8_TYPE__ signed char
+__INT_LEAST16_TYPE__ short int
+__INT_LEAST32_TYPE__ int
+__INT_LEAST64_TYPE__ long int
+__UINT_LEAST8_TYPE__ unsigned char
+__UINT_LEAST16_TYPE__ short unsigned int
+__UINT_LEAST32_TYPE__ unsigned int
+__UINT_LEAST64_TYPE__ long unsigned int
+__INT_FAST8_TYPE__ signed char
+__INT_FAST16_TYPE__ long int
+__INT_FAST32_TYPE__ long int
+__INT_FAST64_TYPE__ long int
+__UINT_FAST8_TYPE__ unsigned char
+__UINT_FAST16_TYPE__ long unsigned int
+__UINT_FAST32_TYPE__ long unsigned int
+__UINT_FAST64_TYPE__ long unsigned int
+__INTPTR_TYPE__ long int
+__UINTPTR_TYPE__ long unsigned int
+__GXX_WEAK__ 1
+__DEPRECATED 1
+__GXX_RTTI 1
+__cpp_rtti 199711L
+__GXX_EXPERIMENTAL_CXX0X__ 1
+__cpp_binary_literals 201304L
+__cpp_hex_float 201603L
+__cpp_runtime_arrays 198712L
+__cpp_raw_strings 200710L
+__cpp_unicode_literals 200710L
+__cpp_user_defined_literals 200809L
+__cpp_lambdas 200907L
+__cpp_decltype 200707L
+__cpp_attributes 200809L
+__cpp_rvalue_reference 200610L
+__cpp_rvalue_references 200610L
+__cpp_variadic_templates 200704L
+__cpp_initializer_lists 200806L
+__cpp_delegating_constructors 200604L
+__cpp_nsdmi 200809L
+__cpp_inheriting_constructors 201511L
+__cpp_ref_qualifiers 200710L
+__cpp_alias_templates 200704L
+__cpp_return_type_deduction 201304L
+__cpp_init_captures 201304L
+__cpp_generic_lambdas 201304L
+__cpp_decltype_auto 201304L
+__cpp_aggregate_nsdmi 201304L
+__cpp_variable_templates 201304L
+__cpp_digit_separators 201309L
+__cpp_unicode_characters 201411L
+__cpp_static_assert 201411L
+__cpp_namespace_attributes 201411L
+__cpp_enumerator_attributes 201411L
+__cpp_nested_namespace_definitions 201411L
+__cpp_fold_expressions 201603L
+__cpp_nontype_template_args 201411L
+__cpp_range_based_for 201603L
+__cpp_constexpr 201603L
+__cpp_if_constexpr 201606L
+__cpp_capture_star_this 201603L
+__cpp_inline_variables 201606L
+__cpp_aggregate_bases 201603L
+__cpp_deduction_guides 201703L
+__cpp_noexcept_function_type 201510L
+__cpp_template_auto 201606L
+__cpp_structured_bindings 201606L
+__cpp_variadic_using 201611L
+__cpp_guaranteed_copy_elision 201606L
+__cpp_nontype_template_parameter_auto 201606L
+__cpp_sized_deallocation 201309L
+__cpp_aligned_new 201606L
+__STDCPP_DEFAULT_NEW_ALIGNMENT__ 16
+__cpp_template_template_args 201611L
+__cpp_threadsafe_static_init 200806L
+__STDCPP_THREADS__ 1
+__EXCEPTIONS 1
+__cpp_exceptions 199711L
+__GXX_ABI_VERSION 1019
+__SCHAR_MAX__ 0x7f
+__SHRT_MAX__ 0x7fff
+__INT_MAX__ 0x7fffffff
+__LONG_MAX__ 0x7fffffffffffffffL
+__LONG_LONG_MAX__ 0x7fffffffffffffffLL
+__WCHAR_MAX__ 0x7fffffff
+__WCHAR_MIN__ (-__WCHAR_MAX__ - 1)
+__WINT_MAX__ 0xffffffffU
+__WINT_MIN__ 0U
+__PTRDIFF_MAX__ 0x7fffffffffffffffL
+__SIZE_MAX__ 0xffffffffffffffffUL
+__SCHAR_WIDTH__ 8
+__SHRT_WIDTH__ 16
+__INT_WIDTH__ 32
+__LONG_WIDTH__ 64
+__LONG_LONG_WIDTH__ 64
+__WCHAR_WIDTH__ 32
+__WINT_WIDTH__ 32
+__PTRDIFF_WIDTH__ 64
+__SIZE_WIDTH__ 64
+__GLIBCXX_TYPE_INT_N_0 __int128
+__GLIBCXX_BITSIZE_INT_N_0 128
+__INTMAX_MAX__ 0x7fffffffffffffffL
+__INTMAX_C(c) c ## L
+__UINTMAX_MAX__ 0xffffffffffffffffUL
+__UINTMAX_C(c) c ## UL
+__INTMAX_WIDTH__ 64
+__SIG_ATOMIC_MAX__ 0x7fffffff
+__SIG_ATOMIC_MIN__ (-__SIG_ATOMIC_MAX__ - 1)
+__SIG_ATOMIC_WIDTH__ 32
+__INT8_MAX__ 0x7f
+__INT16_MAX__ 0x7fff
+__INT32_MAX__ 0x7fffffff
+__INT64_MAX__ 0x7fffffffffffffffL
+__UINT8_MAX__ 0xff
+__UINT16_MAX__ 0xffff
+__UINT32_MAX__ 0xffffffffU
+__UINT64_MAX__ 0xffffffffffffffffUL
+__INT_LEAST8_MAX__ 0x7f
+__INT8_C(c) c
+__INT_LEAST8_WIDTH__ 8
+__INT_LEAST16_MAX__ 0x7fff
+__INT16_C(c) c
+__INT_LEAST16_WIDTH__ 16
+__INT_LEAST32_MAX__ 0x7fffffff
+__INT32_C(c) c
+__INT_LEAST32_WIDTH__ 32
+__INT_LEAST64_MAX__ 0x7fffffffffffffffL
+__INT64_C(c) c ## L
+__INT_LEAST64_WIDTH__ 64
+__UINT_LEAST8_MAX__ 0xff
+__UINT8_C(c) c
+__UINT_LEAST16_MAX__ 0xffff
+__UINT16_C(c) c
+__UINT_LEAST32_MAX__ 0xffffffffU
+__UINT32_C(c) c ## U
+__UINT_LEAST64_MAX__ 0xffffffffffffffffUL
+__UINT64_C(c) c ## UL
+__INT_FAST8_MAX__ 0x7f
+__INT_FAST8_WIDTH__ 8
+__INT_FAST16_MAX__ 0x7fffffffffffffffL
+__INT_FAST16_WIDTH__ 64
+__INT_FAST32_MAX__ 0x7fffffffffffffffL
+__INT_FAST32_WIDTH__ 64
+__INT_FAST64_MAX__ 0x7fffffffffffffffL
+__INT_FAST64_WIDTH__ 64
+__UINT_FAST8_MAX__ 0xff
+__UINT_FAST16_MAX__ 0xffffffffffffffffUL
+__UINT_FAST32_MAX__ 0xffffffffffffffffUL
+__UINT_FAST64_MAX__ 0xffffffffffffffffUL
+__INTPTR_MAX__ 0x7fffffffffffffffL
+__INTPTR_WIDTH__ 64
+__UINTPTR_MAX__ 0xffffffffffffffffUL
+__GCC_IEC_559 2
+__GCC_IEC_559_COMPLEX 2
+__FLT_EVAL_METHOD__ 0
+__FLT_EVAL_METHOD_TS_18661_3__ 0
+__DEC_EVAL_METHOD__ 2
+__FLT_RADIX__ 2
+__FLT_MANT_DIG__ 24
+__FLT_DIG__ 6
+__FLT_MIN_EXP__ (-125)
+__FLT_MIN_10_EXP__ (-37)
+__FLT_MAX_EXP__ 128
+__FLT_MAX_10_EXP__ 38
+__FLT_DECIMAL_DIG__ 9
+__FLT_MAX__ 3.40282346638528859811704183484516925e+38F
+__FLT_NORM_MAX__ 3.40282346638528859811704183484516925e+38F
+__FLT_MIN__ 1.17549435082228750796873653722224568e-38F
+__FLT_EPSILON__ 1.19209289550781250000000000000000000e-7F
+__FLT_DENORM_MIN__ 1.40129846432481707092372958328991613e-45F
+__FLT_HAS_DENORM__ 1
+__FLT_HAS_INFINITY__ 1
+__FLT_HAS_QUIET_NAN__ 1
+__FLT_IS_IEC_60559__ 1
+__DBL_MANT_DIG__ 53
+__DBL_DIG__ 15
+__DBL_MIN_EXP__ (-1021)
+__DBL_MIN_10_EXP__ (-307)
+__DBL_MAX_EXP__ 1024
+__DBL_MAX_10_EXP__ 308
+__DBL_DECIMAL_DIG__ 17
+__DBL_MAX__ double(1.79769313486231570814527423731704357e+308L)
+__DBL_NORM_MAX__ double(1.79769313486231570814527423731704357e+308L)
+__DBL_MIN__ double(2.22507385850720138309023271733240406e-308L)
+__DBL_EPSILON__ double(2.22044604925031308084726333618164062e-16L)
+__DBL_DENORM_MIN__ double(4.94065645841246544176568792868221372e-324L)
+__DBL_HAS_DENORM__ 1
+__DBL_HAS_INFINITY__ 1
+__DBL_HAS_QUIET_NAN__ 1
+__DBL_IS_IEC_60559__ 1
+__LDBL_MANT_DIG__ 64
+__LDBL_DIG__ 18
+__LDBL_MIN_EXP__ (-16381)
+__LDBL_MIN_10_EXP__ (-4931)
+__LDBL_MAX_EXP__ 16384
+__LDBL_MAX_10_EXP__ 4932
+__DECIMAL_DIG__ 21
+__LDBL_DECIMAL_DIG__ 21
+__LDBL_MAX__ 1.18973149535723176502126385303097021e+4932L
+__LDBL_NORM_MAX__ 1.18973149535723176502126385303097021e+4932L
+__LDBL_MIN__ 3.36210314311209350626267781732175260e-4932L
+__LDBL_EPSILON__ 1.08420217248550443400745280086994171e-19L
+__LDBL_DENORM_MIN__ 3.64519953188247460252840593361941982e-4951L
+__LDBL_HAS_DENORM__ 1
+__LDBL_HAS_INFINITY__ 1
+__LDBL_HAS_QUIET_NAN__ 1
+__LDBL_IS_IEC_60559__ 1
+__FLT16_MANT_DIG__ 11
+__FLT16_DIG__ 3
+__FLT16_MIN_EXP__ (-13)
+__FLT16_MIN_10_EXP__ (-4)
+__FLT16_MAX_EXP__ 16
+__FLT16_MAX_10_EXP__ 4
+__FLT16_DECIMAL_DIG__ 5
+__FLT16_MAX__ 6.55040000000000000000000000000000000e+4F16
+__FLT16_NORM_MAX__ 6.55040000000000000000000000000000000e+4F16
+__FLT16_MIN__ 6.10351562500000000000000000000000000e-5F16
+__FLT16_EPSILON__ 9.76562500000000000000000000000000000e-4F16
+__FLT16_DENORM_MIN__ 5.96046447753906250000000000000000000e-8F16
+__FLT16_HAS_DENORM__ 1
+__FLT16_HAS_INFINITY__ 1
+__FLT16_HAS_QUIET_NAN__ 1
+__FLT16_IS_IEC_60559__ 1
+__FLT32_MANT_DIG__ 24
+__FLT32_DIG__ 6
+__FLT32_MIN_EXP__ (-125)
+__FLT32_MIN_10_EXP__ (-37)
+__FLT32_MAX_EXP__ 128
+__FLT32_MAX_10_EXP__ 38
+__FLT32_DECIMAL_DIG__ 9
+__FLT32_MAX__ 3.40282346638528859811704183484516925e+38F32
+__FLT32_NORM_MAX__ 3.40282346638528859811704183484516925e+38F32
+__FLT32_MIN__ 1.17549435082228750796873653722224568e-38F32
+__FLT32_EPSILON__ 1.19209289550781250000000000000000000e-7F32
+__FLT32_DENORM_MIN__ 1.40129846432481707092372958328991613e-45F32
+__FLT32_HAS_DENORM__ 1
+__FLT32_HAS_INFINITY__ 1
+__FLT32_HAS_QUIET_NAN__ 1
+__FLT32_IS_IEC_60559__ 1
+__FLT64_MANT_DIG__ 53
+__FLT64_DIG__ 15
+__FLT64_MIN_EXP__ (-1021)
+__FLT64_MIN_10_EXP__ (-307)
+__FLT64_MAX_EXP__ 1024
+__FLT64_MAX_10_EXP__ 308
+__FLT64_DECIMAL_DIG__ 17
+__FLT64_MAX__ 1.79769313486231570814527423731704357e+308F64
+__FLT64_NORM_MAX__ 1.79769313486231570814527423731704357e+308F64
+__FLT64_MIN__ 2.22507385850720138309023271733240406e-308F64
+__FLT64_EPSILON__ 2.22044604925031308084726333618164062e-16F64
+__FLT64_DENORM_MIN__ 4.94065645841246544176568792868221372e-324F64
+__FLT64_HAS_DENORM__ 1
+__FLT64_HAS_INFINITY__ 1
+__FLT64_HAS_QUIET_NAN__ 1
+__FLT64_IS_IEC_60559__ 1
+__FLT128_MANT_DIG__ 113
+__FLT128_DIG__ 33
+__FLT128_MIN_EXP__ (-16381)
+__FLT128_MIN_10_EXP__ (-4931)
+__FLT128_MAX_EXP__ 16384
+__FLT128_MAX_10_EXP__ 4932
+__FLT128_DECIMAL_DIG__ 36
+__FLT128_MAX__ 1.18973149535723176508575932662800702e+4932F128
+__FLT128_NORM_MAX__ 1.18973149535723176508575932662800702e+4932F128
+__FLT128_MIN__ 3.36210314311209350626267781732175260e-4932F128
+__FLT128_EPSILON__ 1.92592994438723585305597794258492732e-34F128
+__FLT128_DENORM_MIN__ 6.47517511943802511092443895822764655e-4966F128
+__FLT128_HAS_DENORM__ 1
+__FLT128_HAS_INFINITY__ 1
+__FLT128_HAS_QUIET_NAN__ 1
+__FLT128_IS_IEC_60559__ 1
+__FLT32X_MANT_DIG__ 53
+__FLT32X_DIG__ 15
+__FLT32X_MIN_EXP__ (-1021)
+__FLT32X_MIN_10_EXP__ (-307)
+__FLT32X_MAX_EXP__ 1024
+__FLT32X_MAX_10_EXP__ 308
+__FLT32X_DECIMAL_DIG__ 17
+__FLT32X_MAX__ 1.79769313486231570814527423731704357e+308F32x
+__FLT32X_NORM_MAX__ 1.79769313486231570814527423731704357e+308F32x
+__FLT32X_MIN__ 2.22507385850720138309023271733240406e-308F32x
+__FLT32X_EPSILON__ 2.22044604925031308084726333618164062e-16F32x
+__FLT32X_DENORM_MIN__ 4.94065645841246544176568792868221372e-324F32x
+__FLT32X_HAS_DENORM__ 1
+__FLT32X_HAS_INFINITY__ 1
+__FLT32X_HAS_QUIET_NAN__ 1
+__FLT32X_IS_IEC_60559__ 1
+__FLT64X_MANT_DIG__ 64
+__FLT64X_DIG__ 18
+__FLT64X_MIN_EXP__ (-16381)
+__FLT64X_MIN_10_EXP__ (-4931)
+__FLT64X_MAX_EXP__ 16384
+__FLT64X_MAX_10_EXP__ 4932
+__FLT64X_DECIMAL_DIG__ 21
+__FLT64X_MAX__ 1.18973149535723176502126385303097021e+4932F64x
+__FLT64X_NORM_MAX__ 1.18973149535723176502126385303097021e+4932F64x
+__FLT64X_MIN__ 3.36210314311209350626267781732175260e-4932F64x
+__FLT64X_EPSILON__ 1.08420217248550443400745280086994171e-19F64x
+__FLT64X_DENORM_MIN__ 3.64519953188247460252840593361941982e-4951F64x
+__FLT64X_HAS_DENORM__ 1
+__FLT64X_HAS_INFINITY__ 1
+__FLT64X_HAS_QUIET_NAN__ 1
+__FLT64X_IS_IEC_60559__ 1
+__BFLT16_MANT_DIG__ 8
+__BFLT16_DIG__ 2
+__BFLT16_MIN_EXP__ (-125)
+__BFLT16_MIN_10_EXP__ (-37)
+__BFLT16_MAX_EXP__ 128
+__BFLT16_MAX_10_EXP__ 38
+__BFLT16_DECIMAL_DIG__ 4
+__BFLT16_MAX__ 3.38953138925153547590470800371487867e+38BF16
+__BFLT16_NORM_MAX__ 3.38953138925153547590470800371487867e+38BF16
+__BFLT16_MIN__ 1.17549435082228750796873653722224568e-38BF16
+__BFLT16_EPSILON__ 7.81250000000000000000000000000000000e-3BF16
+__BFLT16_DENORM_MIN__ 9.18354961579912115600575419704879436e-41BF16
+__BFLT16_HAS_DENORM__ 1
+__BFLT16_HAS_INFINITY__ 1
+__BFLT16_HAS_QUIET_NAN__ 1
+__BFLT16_IS_IEC_60559__ 0
+__DEC32_MANT_DIG__ 7
+__DEC32_MIN_EXP__ (-94)
+__DEC32_MAX_EXP__ 97
+__DEC32_MIN__ 1E-95DF
+__DEC32_MAX__ 9.999999E96DF
+__DEC32_EPSILON__ 1E-6DF
+__DEC32_SUBNORMAL_MIN__ 0.000001E-95DF
+__DEC64_MANT_DIG__ 16
+__DEC64_MIN_EXP__ (-382)
+__DEC64_MAX_EXP__ 385
+__DEC64_MIN__ 1E-383DD
+__DEC64_MAX__ 9.999999999999999E384DD
+__DEC64_EPSILON__ 1E-15DD
+__DEC64_SUBNORMAL_MIN__ 0.000000000000001E-383DD
+__DEC128_MANT_DIG__ 34
+__DEC128_MIN_EXP__ (-6142)
+__DEC128_MAX_EXP__ 6145
+__DEC128_MIN__ 1E-6143DL
+__DEC128_MAX__ 9.999999999999999999999999999999999E6144DL
+__DEC128_EPSILON__ 1E-33DL
+__DEC128_SUBNORMAL_MIN__ 0.000000000000000000000000000000001E-6143DL
+__REGISTER_PREFIX__ 
+__USER_LABEL_PREFIX__ 
+__GNUC_STDC_INLINE__ 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_1 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_2 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_4 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_8 1
+__GCC_ATOMIC_BOOL_LOCK_FREE 2
+__GCC_ATOMIC_CHAR_LOCK_FREE 2
+__GCC_ATOMIC_CHAR16_T_LOCK_FREE 2
+__GCC_ATOMIC_CHAR32_T_LOCK_FREE 2
+__GCC_ATOMIC_WCHAR_T_LOCK_FREE 2
+__GCC_ATOMIC_SHORT_LOCK_FREE 2
+__GCC_ATOMIC_INT_LOCK_FREE 2
+__GCC_ATOMIC_LONG_LOCK_FREE 2
+__GCC_ATOMIC_LLONG_LOCK_FREE 2
+__GCC_ATOMIC_TEST_AND_SET_TRUEVAL 1
+__GCC_DESTRUCTIVE_SIZE 64
+__GCC_CONSTRUCTIVE_SIZE 64
+__GCC_ATOMIC_POINTER_LOCK_FREE 2
+__HAVE_SPECULATION_SAFE_VALUE 1
+__GCC_HAVE_DWARF2_CFI_ASM 1
+__PRAGMA_REDEFINE_EXTNAME 1
+__SIZEOF_INT128__ 16
+__SIZEOF_WCHAR_T__ 4
+__SIZEOF_WINT_T__ 4
+__SIZEOF_PTRDIFF_T__ 8
+__amd64 1
+__amd64__ 1
+__x86_64 1
+__x86_64__ 1
+__SIZEOF_FLOAT80__ 16
+__SIZEOF_FLOAT128__ 16
+__ATOMIC_HLE_ACQUIRE 65536
+__ATOMIC_HLE_RELEASE 131072
+__GCC_ASM_FLAG_OUTPUTS__ 1
+__k8 1
+__k8__ 1
+__code_model_small__ 1
+__MMX__ 1
+__SSE__ 1
+__SSE2__ 1
+__FXSR__ 1
+__SSE_MATH__ 1
+__SSE2_MATH__ 1
+__MMX_WITH_SSE__ 1
+__SEG_FS 1
+__SEG_GS 1
+__gnu_linux__ 1
+__linux 1
+__linux__ 1
+linux 1
+__unix 1
+__unix__ 1
+unix 1
+__ELF__ 1
+__DECIMAL_BID_FORMAT__ 1
+_GNU_SOURCE 1
+file /home/osandov/src/elfutils/tests/foo.cc
+ file /usr/include/stdc-predef.h
+  _STDC_PREDEF_H 1
+  __STDC_IEC_559__ 1
+  __STDC_IEC_60559_BFP__ 201404L
+  __STDC_IEC_559_COMPLEX__ 1
+  __STDC_IEC_60559_COMPLEX__ 201404L
+  __STDC_ISO_10646__ 201706L
+ /file
+ file /home/osandov/src/elfutils/tests/foobar.h
+  FROB(x) ((x) ^ 0x2a2a2a2a)
+  FRY(x) ((x) * 0x100000001b3)
+ /file
+ ZERO() (1 - 1)
+/file
+CU bar.cc
+__STDC__ 1
+__cplusplus 201703L
+__STDC_UTF_16__ 1
+__STDC_UTF_32__ 1
+__STDC_HOSTED__ 1
+__GNUC__ 14
+__GNUC_MINOR__ 0
+__GNUC_PATCHLEVEL__ 0
+__VERSION__ "14.0.0 20230920 (experimental)"
+__ATOMIC_RELAXED 0
+__ATOMIC_SEQ_CST 5
+__ATOMIC_ACQUIRE 2
+__ATOMIC_RELEASE 3
+__ATOMIC_ACQ_REL 4
+__ATOMIC_CONSUME 1
+__OPTIMIZE__ 1
+__FINITE_MATH_ONLY__ 0
+_LP64 1
+__LP64__ 1
+__SIZEOF_INT__ 4
+__SIZEOF_LONG__ 8
+__SIZEOF_LONG_LONG__ 8
+__SIZEOF_SHORT__ 2
+__SIZEOF_FLOAT__ 4
+__SIZEOF_DOUBLE__ 8
+__SIZEOF_LONG_DOUBLE__ 16
+__SIZEOF_SIZE_T__ 8
+__CHAR_BIT__ 8
+__BIGGEST_ALIGNMENT__ 16
+__ORDER_LITTLE_ENDIAN__ 1234
+__ORDER_BIG_ENDIAN__ 4321
+__ORDER_PDP_ENDIAN__ 3412
+__BYTE_ORDER__ __ORDER_LITTLE_ENDIAN__
+__FLOAT_WORD_ORDER__ __ORDER_LITTLE_ENDIAN__
+__SIZEOF_POINTER__ 8
+__GNUC_EXECUTION_CHARSET_NAME "UTF-8"
+__GNUC_WIDE_EXECUTION_CHARSET_NAME "UTF-32LE"
+__GNUG__ 14
+__SIZE_TYPE__ long unsigned int
+__PTRDIFF_TYPE__ long int
+__WCHAR_TYPE__ int
+__WINT_TYPE__ unsigned int
+__INTMAX_TYPE__ long int
+__UINTMAX_TYPE__ long unsigned int
+__CHAR16_TYPE__ short unsigned int
+__CHAR32_TYPE__ unsigned int
+__SIG_ATOMIC_TYPE__ int
+__INT8_TYPE__ signed char
+__INT16_TYPE__ short int
+__INT32_TYPE__ int
+__INT64_TYPE__ long int
+__UINT8_TYPE__ unsigned char
+__UINT16_TYPE__ short unsigned int
+__UINT32_TYPE__ unsigned int
+__UINT64_TYPE__ long unsigned int
+__INT_LEAST8_TYPE__ signed char
+__INT_LEAST16_TYPE__ short int
+__INT_LEAST32_TYPE__ int
+__INT_LEAST64_TYPE__ long int
+__UINT_LEAST8_TYPE__ unsigned char
+__UINT_LEAST16_TYPE__ short unsigned int
+__UINT_LEAST32_TYPE__ unsigned int
+__UINT_LEAST64_TYPE__ long unsigned int
+__INT_FAST8_TYPE__ signed char
+__INT_FAST16_TYPE__ long int
+__INT_FAST32_TYPE__ long int
+__INT_FAST64_TYPE__ long int
+__UINT_FAST8_TYPE__ unsigned char
+__UINT_FAST16_TYPE__ long unsigned int
+__UINT_FAST32_TYPE__ long unsigned int
+__UINT_FAST64_TYPE__ long unsigned int
+__INTPTR_TYPE__ long int
+__UINTPTR_TYPE__ long unsigned int
+__GXX_WEAK__ 1
+__DEPRECATED 1
+__GXX_RTTI 1
+__cpp_rtti 199711L
+__GXX_EXPERIMENTAL_CXX0X__ 1
+__cpp_binary_literals 201304L
+__cpp_hex_float 201603L
+__cpp_runtime_arrays 198712L
+__cpp_raw_strings 200710L
+__cpp_unicode_literals 200710L
+__cpp_user_defined_literals 200809L
+__cpp_lambdas 200907L
+__cpp_decltype 200707L
+__cpp_attributes 200809L
+__cpp_rvalue_reference 200610L
+__cpp_rvalue_references 200610L
+__cpp_variadic_templates 200704L
+__cpp_initializer_lists 200806L
+__cpp_delegating_constructors 200604L
+__cpp_nsdmi 200809L
+__cpp_inheriting_constructors 201511L
+__cpp_ref_qualifiers 200710L
+__cpp_alias_templates 200704L
+__cpp_return_type_deduction 201304L
+__cpp_init_captures 201304L
+__cpp_generic_lambdas 201304L
+__cpp_decltype_auto 201304L
+__cpp_aggregate_nsdmi 201304L
+__cpp_variable_templates 201304L
+__cpp_digit_separators 201309L
+__cpp_unicode_characters 201411L
+__cpp_static_assert 201411L
+__cpp_namespace_attributes 201411L
+__cpp_enumerator_attributes 201411L
+__cpp_nested_namespace_definitions 201411L
+__cpp_fold_expressions 201603L
+__cpp_nontype_template_args 201411L
+__cpp_range_based_for 201603L
+__cpp_constexpr 201603L
+__cpp_if_constexpr 201606L
+__cpp_capture_star_this 201603L
+__cpp_inline_variables 201606L
+__cpp_aggregate_bases 201603L
+__cpp_deduction_guides 201703L
+__cpp_noexcept_function_type 201510L
+__cpp_template_auto 201606L
+__cpp_structured_bindings 201606L
+__cpp_variadic_using 201611L
+__cpp_guaranteed_copy_elision 201606L
+__cpp_nontype_template_parameter_auto 201606L
+__cpp_sized_deallocation 201309L
+__cpp_aligned_new 201606L
+__STDCPP_DEFAULT_NEW_ALIGNMENT__ 16
+__cpp_template_template_args 201611L
+__cpp_threadsafe_static_init 200806L
+__STDCPP_THREADS__ 1
+__EXCEPTIONS 1
+__cpp_exceptions 199711L
+__GXX_ABI_VERSION 1019
+__SCHAR_MAX__ 0x7f
+__SHRT_MAX__ 0x7fff
+__INT_MAX__ 0x7fffffff
+__LONG_MAX__ 0x7fffffffffffffffL
+__LONG_LONG_MAX__ 0x7fffffffffffffffLL
+__WCHAR_MAX__ 0x7fffffff
+__WCHAR_MIN__ (-__WCHAR_MAX__ - 1)
+__WINT_MAX__ 0xffffffffU
+__WINT_MIN__ 0U
+__PTRDIFF_MAX__ 0x7fffffffffffffffL
+__SIZE_MAX__ 0xffffffffffffffffUL
+__SCHAR_WIDTH__ 8
+__SHRT_WIDTH__ 16
+__INT_WIDTH__ 32
+__LONG_WIDTH__ 64
+__LONG_LONG_WIDTH__ 64
+__WCHAR_WIDTH__ 32
+__WINT_WIDTH__ 32
+__PTRDIFF_WIDTH__ 64
+__SIZE_WIDTH__ 64
+__GLIBCXX_TYPE_INT_N_0 __int128
+__GLIBCXX_BITSIZE_INT_N_0 128
+__INTMAX_MAX__ 0x7fffffffffffffffL
+__INTMAX_C(c) c ## L
+__UINTMAX_MAX__ 0xffffffffffffffffUL
+__UINTMAX_C(c) c ## UL
+__INTMAX_WIDTH__ 64
+__SIG_ATOMIC_MAX__ 0x7fffffff
+__SIG_ATOMIC_MIN__ (-__SIG_ATOMIC_MAX__ - 1)
+__SIG_ATOMIC_WIDTH__ 32
+__INT8_MAX__ 0x7f
+__INT16_MAX__ 0x7fff
+__INT32_MAX__ 0x7fffffff
+__INT64_MAX__ 0x7fffffffffffffffL
+__UINT8_MAX__ 0xff
+__UINT16_MAX__ 0xffff
+__UINT32_MAX__ 0xffffffffU
+__UINT64_MAX__ 0xffffffffffffffffUL
+__INT_LEAST8_MAX__ 0x7f
+__INT8_C(c) c
+__INT_LEAST8_WIDTH__ 8
+__INT_LEAST16_MAX__ 0x7fff
+__INT16_C(c) c
+__INT_LEAST16_WIDTH__ 16
+__INT_LEAST32_MAX__ 0x7fffffff
+__INT32_C(c) c
+__INT_LEAST32_WIDTH__ 32
+__INT_LEAST64_MAX__ 0x7fffffffffffffffL
+__INT64_C(c) c ## L
+__INT_LEAST64_WIDTH__ 64
+__UINT_LEAST8_MAX__ 0xff
+__UINT8_C(c) c
+__UINT_LEAST16_MAX__ 0xffff
+__UINT16_C(c) c
+__UINT_LEAST32_MAX__ 0xffffffffU
+__UINT32_C(c) c ## U
+__UINT_LEAST64_MAX__ 0xffffffffffffffffUL
+__UINT64_C(c) c ## UL
+__INT_FAST8_MAX__ 0x7f
+__INT_FAST8_WIDTH__ 8
+__INT_FAST16_MAX__ 0x7fffffffffffffffL
+__INT_FAST16_WIDTH__ 64
+__INT_FAST32_MAX__ 0x7fffffffffffffffL
+__INT_FAST32_WIDTH__ 64
+__INT_FAST64_MAX__ 0x7fffffffffffffffL
+__INT_FAST64_WIDTH__ 64
+__UINT_FAST8_MAX__ 0xff
+__UINT_FAST16_MAX__ 0xffffffffffffffffUL
+__UINT_FAST32_MAX__ 0xffffffffffffffffUL
+__UINT_FAST64_MAX__ 0xffffffffffffffffUL
+__INTPTR_MAX__ 0x7fffffffffffffffL
+__INTPTR_WIDTH__ 64
+__UINTPTR_MAX__ 0xffffffffffffffffUL
+__GCC_IEC_559 2
+__GCC_IEC_559_COMPLEX 2
+__FLT_EVAL_METHOD__ 0
+__FLT_EVAL_METHOD_TS_18661_3__ 0
+__DEC_EVAL_METHOD__ 2
+__FLT_RADIX__ 2
+__FLT_MANT_DIG__ 24
+__FLT_DIG__ 6
+__FLT_MIN_EXP__ (-125)
+__FLT_MIN_10_EXP__ (-37)
+__FLT_MAX_EXP__ 128
+__FLT_MAX_10_EXP__ 38
+__FLT_DECIMAL_DIG__ 9
+__FLT_MAX__ 3.40282346638528859811704183484516925e+38F
+__FLT_NORM_MAX__ 3.40282346638528859811704183484516925e+38F
+__FLT_MIN__ 1.17549435082228750796873653722224568e-38F
+__FLT_EPSILON__ 1.19209289550781250000000000000000000e-7F
+__FLT_DENORM_MIN__ 1.40129846432481707092372958328991613e-45F
+__FLT_HAS_DENORM__ 1
+__FLT_HAS_INFINITY__ 1
+__FLT_HAS_QUIET_NAN__ 1
+__FLT_IS_IEC_60559__ 1
+__DBL_MANT_DIG__ 53
+__DBL_DIG__ 15
+__DBL_MIN_EXP__ (-1021)
+__DBL_MIN_10_EXP__ (-307)
+__DBL_MAX_EXP__ 1024
+__DBL_MAX_10_EXP__ 308
+__DBL_DECIMAL_DIG__ 17
+__DBL_MAX__ double(1.79769313486231570814527423731704357e+308L)
+__DBL_NORM_MAX__ double(1.79769313486231570814527423731704357e+308L)
+__DBL_MIN__ double(2.22507385850720138309023271733240406e-308L)
+__DBL_EPSILON__ double(2.22044604925031308084726333618164062e-16L)
+__DBL_DENORM_MIN__ double(4.94065645841246544176568792868221372e-324L)
+__DBL_HAS_DENORM__ 1
+__DBL_HAS_INFINITY__ 1
+__DBL_HAS_QUIET_NAN__ 1
+__DBL_IS_IEC_60559__ 1
+__LDBL_MANT_DIG__ 64
+__LDBL_DIG__ 18
+__LDBL_MIN_EXP__ (-16381)
+__LDBL_MIN_10_EXP__ (-4931)
+__LDBL_MAX_EXP__ 16384
+__LDBL_MAX_10_EXP__ 4932
+__DECIMAL_DIG__ 21
+__LDBL_DECIMAL_DIG__ 21
+__LDBL_MAX__ 1.18973149535723176502126385303097021e+4932L
+__LDBL_NORM_MAX__ 1.18973149535723176502126385303097021e+4932L
+__LDBL_MIN__ 3.36210314311209350626267781732175260e-4932L
+__LDBL_EPSILON__ 1.08420217248550443400745280086994171e-19L
+__LDBL_DENORM_MIN__ 3.64519953188247460252840593361941982e-4951L
+__LDBL_HAS_DENORM__ 1
+__LDBL_HAS_INFINITY__ 1
+__LDBL_HAS_QUIET_NAN__ 1
+__LDBL_IS_IEC_60559__ 1
+__FLT16_MANT_DIG__ 11
+__FLT16_DIG__ 3
+__FLT16_MIN_EXP__ (-13)
+__FLT16_MIN_10_EXP__ (-4)
+__FLT16_MAX_EXP__ 16
+__FLT16_MAX_10_EXP__ 4
+__FLT16_DECIMAL_DIG__ 5
+__FLT16_MAX__ 6.55040000000000000000000000000000000e+4F16
+__FLT16_NORM_MAX__ 6.55040000000000000000000000000000000e+4F16
+__FLT16_MIN__ 6.10351562500000000000000000000000000e-5F16
+__FLT16_EPSILON__ 9.76562500000000000000000000000000000e-4F16
+__FLT16_DENORM_MIN__ 5.96046447753906250000000000000000000e-8F16
+__FLT16_HAS_DENORM__ 1
+__FLT16_HAS_INFINITY__ 1
+__FLT16_HAS_QUIET_NAN__ 1
+__FLT16_IS_IEC_60559__ 1
+__FLT32_MANT_DIG__ 24
+__FLT32_DIG__ 6
+__FLT32_MIN_EXP__ (-125)
+__FLT32_MIN_10_EXP__ (-37)
+__FLT32_MAX_EXP__ 128
+__FLT32_MAX_10_EXP__ 38
+__FLT32_DECIMAL_DIG__ 9
+__FLT32_MAX__ 3.40282346638528859811704183484516925e+38F32
+__FLT32_NORM_MAX__ 3.40282346638528859811704183484516925e+38F32
+__FLT32_MIN__ 1.17549435082228750796873653722224568e-38F32
+__FLT32_EPSILON__ 1.19209289550781250000000000000000000e-7F32
+__FLT32_DENORM_MIN__ 1.40129846432481707092372958328991613e-45F32
+__FLT32_HAS_DENORM__ 1
+__FLT32_HAS_INFINITY__ 1
+__FLT32_HAS_QUIET_NAN__ 1
+__FLT32_IS_IEC_60559__ 1
+__FLT64_MANT_DIG__ 53
+__FLT64_DIG__ 15
+__FLT64_MIN_EXP__ (-1021)
+__FLT64_MIN_10_EXP__ (-307)
+__FLT64_MAX_EXP__ 1024
+__FLT64_MAX_10_EXP__ 308
+__FLT64_DECIMAL_DIG__ 17
+__FLT64_MAX__ 1.79769313486231570814527423731704357e+308F64
+__FLT64_NORM_MAX__ 1.79769313486231570814527423731704357e+308F64
+__FLT64_MIN__ 2.22507385850720138309023271733240406e-308F64
+__FLT64_EPSILON__ 2.22044604925031308084726333618164062e-16F64
+__FLT64_DENORM_MIN__ 4.94065645841246544176568792868221372e-324F64
+__FLT64_HAS_DENORM__ 1
+__FLT64_HAS_INFINITY__ 1
+__FLT64_HAS_QUIET_NAN__ 1
+__FLT64_IS_IEC_60559__ 1
+__FLT128_MANT_DIG__ 113
+__FLT128_DIG__ 33
+__FLT128_MIN_EXP__ (-16381)
+__FLT128_MIN_10_EXP__ (-4931)
+__FLT128_MAX_EXP__ 16384
+__FLT128_MAX_10_EXP__ 4932
+__FLT128_DECIMAL_DIG__ 36
+__FLT128_MAX__ 1.18973149535723176508575932662800702e+4932F128
+__FLT128_NORM_MAX__ 1.18973149535723176508575932662800702e+4932F128
+__FLT128_MIN__ 3.36210314311209350626267781732175260e-4932F128
+__FLT128_EPSILON__ 1.92592994438723585305597794258492732e-34F128
+__FLT128_DENORM_MIN__ 6.47517511943802511092443895822764655e-4966F128
+__FLT128_HAS_DENORM__ 1
+__FLT128_HAS_INFINITY__ 1
+__FLT128_HAS_QUIET_NAN__ 1
+__FLT128_IS_IEC_60559__ 1
+__FLT32X_MANT_DIG__ 53
+__FLT32X_DIG__ 15
+__FLT32X_MIN_EXP__ (-1021)
+__FLT32X_MIN_10_EXP__ (-307)
+__FLT32X_MAX_EXP__ 1024
+__FLT32X_MAX_10_EXP__ 308
+__FLT32X_DECIMAL_DIG__ 17
+__FLT32X_MAX__ 1.79769313486231570814527423731704357e+308F32x
+__FLT32X_NORM_MAX__ 1.79769313486231570814527423731704357e+308F32x
+__FLT32X_MIN__ 2.22507385850720138309023271733240406e-308F32x
+__FLT32X_EPSILON__ 2.22044604925031308084726333618164062e-16F32x
+__FLT32X_DENORM_MIN__ 4.94065645841246544176568792868221372e-324F32x
+__FLT32X_HAS_DENORM__ 1
+__FLT32X_HAS_INFINITY__ 1
+__FLT32X_HAS_QUIET_NAN__ 1
+__FLT32X_IS_IEC_60559__ 1
+__FLT64X_MANT_DIG__ 64
+__FLT64X_DIG__ 18
+__FLT64X_MIN_EXP__ (-16381)
+__FLT64X_MIN_10_EXP__ (-4931)
+__FLT64X_MAX_EXP__ 16384
+__FLT64X_MAX_10_EXP__ 4932
+__FLT64X_DECIMAL_DIG__ 21
+__FLT64X_MAX__ 1.18973149535723176502126385303097021e+4932F64x
+__FLT64X_NORM_MAX__ 1.18973149535723176502126385303097021e+4932F64x
+__FLT64X_MIN__ 3.36210314311209350626267781732175260e-4932F64x
+__FLT64X_EPSILON__ 1.08420217248550443400745280086994171e-19F64x
+__FLT64X_DENORM_MIN__ 3.64519953188247460252840593361941982e-4951F64x
+__FLT64X_HAS_DENORM__ 1
+__FLT64X_HAS_INFINITY__ 1
+__FLT64X_HAS_QUIET_NAN__ 1
+__FLT64X_IS_IEC_60559__ 1
+__BFLT16_MANT_DIG__ 8
+__BFLT16_DIG__ 2
+__BFLT16_MIN_EXP__ (-125)
+__BFLT16_MIN_10_EXP__ (-37)
+__BFLT16_MAX_EXP__ 128
+__BFLT16_MAX_10_EXP__ 38
+__BFLT16_DECIMAL_DIG__ 4
+__BFLT16_MAX__ 3.38953138925153547590470800371487867e+38BF16
+__BFLT16_NORM_MAX__ 3.38953138925153547590470800371487867e+38BF16
+__BFLT16_MIN__ 1.17549435082228750796873653722224568e-38BF16
+__BFLT16_EPSILON__ 7.81250000000000000000000000000000000e-3BF16
+__BFLT16_DENORM_MIN__ 9.18354961579912115600575419704879436e-41BF16
+__BFLT16_HAS_DENORM__ 1
+__BFLT16_HAS_INFINITY__ 1
+__BFLT16_HAS_QUIET_NAN__ 1
+__BFLT16_IS_IEC_60559__ 0
+__DEC32_MANT_DIG__ 7
+__DEC32_MIN_EXP__ (-94)
+__DEC32_MAX_EXP__ 97
+__DEC32_MIN__ 1E-95DF
+__DEC32_MAX__ 9.999999E96DF
+__DEC32_EPSILON__ 1E-6DF
+__DEC32_SUBNORMAL_MIN__ 0.000001E-95DF
+__DEC64_MANT_DIG__ 16
+__DEC64_MIN_EXP__ (-382)
+__DEC64_MAX_EXP__ 385
+__DEC64_MIN__ 1E-383DD
+__DEC64_MAX__ 9.999999999999999E384DD
+__DEC64_EPSILON__ 1E-15DD
+__DEC64_SUBNORMAL_MIN__ 0.000000000000001E-383DD
+__DEC128_MANT_DIG__ 34
+__DEC128_MIN_EXP__ (-6142)
+__DEC128_MAX_EXP__ 6145
+__DEC128_MIN__ 1E-6143DL
+__DEC128_MAX__ 9.999999999999999999999999999999999E6144DL
+__DEC128_EPSILON__ 1E-33DL
+__DEC128_SUBNORMAL_MIN__ 0.000000000000000000000000000000001E-6143DL
+__REGISTER_PREFIX__ 
+__USER_LABEL_PREFIX__ 
+__GNUC_STDC_INLINE__ 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_1 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_2 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_4 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_8 1
+__GCC_ATOMIC_BOOL_LOCK_FREE 2
+__GCC_ATOMIC_CHAR_LOCK_FREE 2
+__GCC_ATOMIC_CHAR16_T_LOCK_FREE 2
+__GCC_ATOMIC_CHAR32_T_LOCK_FREE 2
+__GCC_ATOMIC_WCHAR_T_LOCK_FREE 2
+__GCC_ATOMIC_SHORT_LOCK_FREE 2
+__GCC_ATOMIC_INT_LOCK_FREE 2
+__GCC_ATOMIC_LONG_LOCK_FREE 2
+__GCC_ATOMIC_LLONG_LOCK_FREE 2
+__GCC_ATOMIC_TEST_AND_SET_TRUEVAL 1
+__GCC_DESTRUCTIVE_SIZE 64
+__GCC_CONSTRUCTIVE_SIZE 64
+__GCC_ATOMIC_POINTER_LOCK_FREE 2
+__HAVE_SPECULATION_SAFE_VALUE 1
+__GCC_HAVE_DWARF2_CFI_ASM 1
+__PRAGMA_REDEFINE_EXTNAME 1
+__SIZEOF_INT128__ 16
+__SIZEOF_WCHAR_T__ 4
+__SIZEOF_WINT_T__ 4
+__SIZEOF_PTRDIFF_T__ 8
+__amd64 1
+__amd64__ 1
+__x86_64 1
+__x86_64__ 1
+__SIZEOF_FLOAT80__ 16
+__SIZEOF_FLOAT128__ 16
+__ATOMIC_HLE_ACQUIRE 65536
+__ATOMIC_HLE_RELEASE 131072
+__GCC_ASM_FLAG_OUTPUTS__ 1
+__k8 1
+__k8__ 1
+__code_model_small__ 1
+__MMX__ 1
+__SSE__ 1
+__SSE2__ 1
+__FXSR__ 1
+__SSE_MATH__ 1
+__SSE2_MATH__ 1
+__MMX_WITH_SSE__ 1
+__SEG_FS 1
+__SEG_GS 1
+__gnu_linux__ 1
+__linux 1
+__linux__ 1
+linux 1
+__unix 1
+__unix__ 1
+unix 1
+__ELF__ 1
+__DECIMAL_BID_FORMAT__ 1
+_GNU_SOURCE 1
+file /home/osandov/src/elfutils/tests/bar.cc
+ file /usr/include/stdc-predef.h
+  _STDC_PREDEF_H 1
+  __STDC_IEC_559__ 1
+  __STDC_IEC_60559_BFP__ 201404L
+  __STDC_IEC_559_COMPLEX__ 1
+  __STDC_IEC_60559_COMPLEX__ 201404L
+  __STDC_ISO_10646__ 201706L
+ /file
+ file /home/osandov/src/elfutils/tests/foobar.h
+  FROB(x) ((x) ^ 0x2a2a2a2a)
+  FRY(x) ((x) * 0x100000001b3)
+ /file
+ ONE 1
+/file
+CU main.cc
+__STDC__ 1
+__cplusplus 201703L
+__STDC_UTF_16__ 1
+__STDC_UTF_32__ 1
+__STDC_HOSTED__ 1
+__GNUC__ 14
+__GNUC_MINOR__ 0
+__GNUC_PATCHLEVEL__ 0
+__VERSION__ "14.0.0 20230920 (experimental)"
+__ATOMIC_RELAXED 0
+__ATOMIC_SEQ_CST 5
+__ATOMIC_ACQUIRE 2
+__ATOMIC_RELEASE 3
+__ATOMIC_ACQ_REL 4
+__ATOMIC_CONSUME 1
+__OPTIMIZE__ 1
+__FINITE_MATH_ONLY__ 0
+_LP64 1
+__LP64__ 1
+__SIZEOF_INT__ 4
+__SIZEOF_LONG__ 8
+__SIZEOF_LONG_LONG__ 8
+__SIZEOF_SHORT__ 2
+__SIZEOF_FLOAT__ 4
+__SIZEOF_DOUBLE__ 8
+__SIZEOF_LONG_DOUBLE__ 16
+__SIZEOF_SIZE_T__ 8
+__CHAR_BIT__ 8
+__BIGGEST_ALIGNMENT__ 16
+__ORDER_LITTLE_ENDIAN__ 1234
+__ORDER_BIG_ENDIAN__ 4321
+__ORDER_PDP_ENDIAN__ 3412
+__BYTE_ORDER__ __ORDER_LITTLE_ENDIAN__
+__FLOAT_WORD_ORDER__ __ORDER_LITTLE_ENDIAN__
+__SIZEOF_POINTER__ 8
+__GNUC_EXECUTION_CHARSET_NAME "UTF-8"
+__GNUC_WIDE_EXECUTION_CHARSET_NAME "UTF-32LE"
+__GNUG__ 14
+__SIZE_TYPE__ long unsigned int
+__PTRDIFF_TYPE__ long int
+__WCHAR_TYPE__ int
+__WINT_TYPE__ unsigned int
+__INTMAX_TYPE__ long int
+__UINTMAX_TYPE__ long unsigned int
+__CHAR16_TYPE__ short unsigned int
+__CHAR32_TYPE__ unsigned int
+__SIG_ATOMIC_TYPE__ int
+__INT8_TYPE__ signed char
+__INT16_TYPE__ short int
+__INT32_TYPE__ int
+__INT64_TYPE__ long int
+__UINT8_TYPE__ unsigned char
+__UINT16_TYPE__ short unsigned int
+__UINT32_TYPE__ unsigned int
+__UINT64_TYPE__ long unsigned int
+__INT_LEAST8_TYPE__ signed char
+__INT_LEAST16_TYPE__ short int
+__INT_LEAST32_TYPE__ int
+__INT_LEAST64_TYPE__ long int
+__UINT_LEAST8_TYPE__ unsigned char
+__UINT_LEAST16_TYPE__ short unsigned int
+__UINT_LEAST32_TYPE__ unsigned int
+__UINT_LEAST64_TYPE__ long unsigned int
+__INT_FAST8_TYPE__ signed char
+__INT_FAST16_TYPE__ long int
+__INT_FAST32_TYPE__ long int
+__INT_FAST64_TYPE__ long int
+__UINT_FAST8_TYPE__ unsigned char
+__UINT_FAST16_TYPE__ long unsigned int
+__UINT_FAST32_TYPE__ long unsigned int
+__UINT_FAST64_TYPE__ long unsigned int
+__INTPTR_TYPE__ long int
+__UINTPTR_TYPE__ long unsigned int
+__GXX_WEAK__ 1
+__DEPRECATED 1
+__GXX_RTTI 1
+__cpp_rtti 199711L
+__GXX_EXPERIMENTAL_CXX0X__ 1
+__cpp_binary_literals 201304L
+__cpp_hex_float 201603L
+__cpp_runtime_arrays 198712L
+__cpp_raw_strings 200710L
+__cpp_unicode_literals 200710L
+__cpp_user_defined_literals 200809L
+__cpp_lambdas 200907L
+__cpp_decltype 200707L
+__cpp_attributes 200809L
+__cpp_rvalue_reference 200610L
+__cpp_rvalue_references 200610L
+__cpp_variadic_templates 200704L
+__cpp_initializer_lists 200806L
+__cpp_delegating_constructors 200604L
+__cpp_nsdmi 200809L
+__cpp_inheriting_constructors 201511L
+__cpp_ref_qualifiers 200710L
+__cpp_alias_templates 200704L
+__cpp_return_type_deduction 201304L
+__cpp_init_captures 201304L
+__cpp_generic_lambdas 201304L
+__cpp_decltype_auto 201304L
+__cpp_aggregate_nsdmi 201304L
+__cpp_variable_templates 201304L
+__cpp_digit_separators 201309L
+__cpp_unicode_characters 201411L
+__cpp_static_assert 201411L
+__cpp_namespace_attributes 201411L
+__cpp_enumerator_attributes 201411L
+__cpp_nested_namespace_definitions 201411L
+__cpp_fold_expressions 201603L
+__cpp_nontype_template_args 201411L
+__cpp_range_based_for 201603L
+__cpp_constexpr 201603L
+__cpp_if_constexpr 201606L
+__cpp_capture_star_this 201603L
+__cpp_inline_variables 201606L
+__cpp_aggregate_bases 201603L
+__cpp_deduction_guides 201703L
+__cpp_noexcept_function_type 201510L
+__cpp_template_auto 201606L
+__cpp_structured_bindings 201606L
+__cpp_variadic_using 201611L
+__cpp_guaranteed_copy_elision 201606L
+__cpp_nontype_template_parameter_auto 201606L
+__cpp_sized_deallocation 201309L
+__cpp_aligned_new 201606L
+__STDCPP_DEFAULT_NEW_ALIGNMENT__ 16
+__cpp_template_template_args 201611L
+__cpp_threadsafe_static_init 200806L
+__STDCPP_THREADS__ 1
+__EXCEPTIONS 1
+__cpp_exceptions 199711L
+__GXX_ABI_VERSION 1019
+__SCHAR_MAX__ 0x7f
+__SHRT_MAX__ 0x7fff
+__INT_MAX__ 0x7fffffff
+__LONG_MAX__ 0x7fffffffffffffffL
+__LONG_LONG_MAX__ 0x7fffffffffffffffLL
+__WCHAR_MAX__ 0x7fffffff
+__WCHAR_MIN__ (-__WCHAR_MAX__ - 1)
+__WINT_MAX__ 0xffffffffU
+__WINT_MIN__ 0U
+__PTRDIFF_MAX__ 0x7fffffffffffffffL
+__SIZE_MAX__ 0xffffffffffffffffUL
+__SCHAR_WIDTH__ 8
+__SHRT_WIDTH__ 16
+__INT_WIDTH__ 32
+__LONG_WIDTH__ 64
+__LONG_LONG_WIDTH__ 64
+__WCHAR_WIDTH__ 32
+__WINT_WIDTH__ 32
+__PTRDIFF_WIDTH__ 64
+__SIZE_WIDTH__ 64
+__GLIBCXX_TYPE_INT_N_0 __int128
+__GLIBCXX_BITSIZE_INT_N_0 128
+__INTMAX_MAX__ 0x7fffffffffffffffL
+__INTMAX_C(c) c ## L
+__UINTMAX_MAX__ 0xffffffffffffffffUL
+__UINTMAX_C(c) c ## UL
+__INTMAX_WIDTH__ 64
+__SIG_ATOMIC_MAX__ 0x7fffffff
+__SIG_ATOMIC_MIN__ (-__SIG_ATOMIC_MAX__ - 1)
+__SIG_ATOMIC_WIDTH__ 32
+__INT8_MAX__ 0x7f
+__INT16_MAX__ 0x7fff
+__INT32_MAX__ 0x7fffffff
+__INT64_MAX__ 0x7fffffffffffffffL
+__UINT8_MAX__ 0xff
+__UINT16_MAX__ 0xffff
+__UINT32_MAX__ 0xffffffffU
+__UINT64_MAX__ 0xffffffffffffffffUL
+__INT_LEAST8_MAX__ 0x7f
+__INT8_C(c) c
+__INT_LEAST8_WIDTH__ 8
+__INT_LEAST16_MAX__ 0x7fff
+__INT16_C(c) c
+__INT_LEAST16_WIDTH__ 16
+__INT_LEAST32_MAX__ 0x7fffffff
+__INT32_C(c) c
+__INT_LEAST32_WIDTH__ 32
+__INT_LEAST64_MAX__ 0x7fffffffffffffffL
+__INT64_C(c) c ## L
+__INT_LEAST64_WIDTH__ 64
+__UINT_LEAST8_MAX__ 0xff
+__UINT8_C(c) c
+__UINT_LEAST16_MAX__ 0xffff
+__UINT16_C(c) c
+__UINT_LEAST32_MAX__ 0xffffffffU
+__UINT32_C(c) c ## U
+__UINT_LEAST64_MAX__ 0xffffffffffffffffUL
+__UINT64_C(c) c ## UL
+__INT_FAST8_MAX__ 0x7f
+__INT_FAST8_WIDTH__ 8
+__INT_FAST16_MAX__ 0x7fffffffffffffffL
+__INT_FAST16_WIDTH__ 64
+__INT_FAST32_MAX__ 0x7fffffffffffffffL
+__INT_FAST32_WIDTH__ 64
+__INT_FAST64_MAX__ 0x7fffffffffffffffL
+__INT_FAST64_WIDTH__ 64
+__UINT_FAST8_MAX__ 0xff
+__UINT_FAST16_MAX__ 0xffffffffffffffffUL
+__UINT_FAST32_MAX__ 0xffffffffffffffffUL
+__UINT_FAST64_MAX__ 0xffffffffffffffffUL
+__INTPTR_MAX__ 0x7fffffffffffffffL
+__INTPTR_WIDTH__ 64
+__UINTPTR_MAX__ 0xffffffffffffffffUL
+__GCC_IEC_559 2
+__GCC_IEC_559_COMPLEX 2
+__FLT_EVAL_METHOD__ 0
+__FLT_EVAL_METHOD_TS_18661_3__ 0
+__DEC_EVAL_METHOD__ 2
+__FLT_RADIX__ 2
+__FLT_MANT_DIG__ 24
+__FLT_DIG__ 6
+__FLT_MIN_EXP__ (-125)
+__FLT_MIN_10_EXP__ (-37)
+__FLT_MAX_EXP__ 128
+__FLT_MAX_10_EXP__ 38
+__FLT_DECIMAL_DIG__ 9
+__FLT_MAX__ 3.40282346638528859811704183484516925e+38F
+__FLT_NORM_MAX__ 3.40282346638528859811704183484516925e+38F
+__FLT_MIN__ 1.17549435082228750796873653722224568e-38F
+__FLT_EPSILON__ 1.19209289550781250000000000000000000e-7F
+__FLT_DENORM_MIN__ 1.40129846432481707092372958328991613e-45F
+__FLT_HAS_DENORM__ 1
+__FLT_HAS_INFINITY__ 1
+__FLT_HAS_QUIET_NAN__ 1
+__FLT_IS_IEC_60559__ 1
+__DBL_MANT_DIG__ 53
+__DBL_DIG__ 15
+__DBL_MIN_EXP__ (-1021)
+__DBL_MIN_10_EXP__ (-307)
+__DBL_MAX_EXP__ 1024
+__DBL_MAX_10_EXP__ 308
+__DBL_DECIMAL_DIG__ 17
+__DBL_MAX__ double(1.79769313486231570814527423731704357e+308L)
+__DBL_NORM_MAX__ double(1.79769313486231570814527423731704357e+308L)
+__DBL_MIN__ double(2.22507385850720138309023271733240406e-308L)
+__DBL_EPSILON__ double(2.22044604925031308084726333618164062e-16L)
+__DBL_DENORM_MIN__ double(4.94065645841246544176568792868221372e-324L)
+__DBL_HAS_DENORM__ 1
+__DBL_HAS_INFINITY__ 1
+__DBL_HAS_QUIET_NAN__ 1
+__DBL_IS_IEC_60559__ 1
+__LDBL_MANT_DIG__ 64
+__LDBL_DIG__ 18
+__LDBL_MIN_EXP__ (-16381)
+__LDBL_MIN_10_EXP__ (-4931)
+__LDBL_MAX_EXP__ 16384
+__LDBL_MAX_10_EXP__ 4932
+__DECIMAL_DIG__ 21
+__LDBL_DECIMAL_DIG__ 21
+__LDBL_MAX__ 1.18973149535723176502126385303097021e+4932L
+__LDBL_NORM_MAX__ 1.18973149535723176502126385303097021e+4932L
+__LDBL_MIN__ 3.36210314311209350626267781732175260e-4932L
+__LDBL_EPSILON__ 1.08420217248550443400745280086994171e-19L
+__LDBL_DENORM_MIN__ 3.64519953188247460252840593361941982e-4951L
+__LDBL_HAS_DENORM__ 1
+__LDBL_HAS_INFINITY__ 1
+__LDBL_HAS_QUIET_NAN__ 1
+__LDBL_IS_IEC_60559__ 1
+__FLT16_MANT_DIG__ 11
+__FLT16_DIG__ 3
+__FLT16_MIN_EXP__ (-13)
+__FLT16_MIN_10_EXP__ (-4)
+__FLT16_MAX_EXP__ 16
+__FLT16_MAX_10_EXP__ 4
+__FLT16_DECIMAL_DIG__ 5
+__FLT16_MAX__ 6.55040000000000000000000000000000000e+4F16
+__FLT16_NORM_MAX__ 6.55040000000000000000000000000000000e+4F16
+__FLT16_MIN__ 6.10351562500000000000000000000000000e-5F16
+__FLT16_EPSILON__ 9.76562500000000000000000000000000000e-4F16
+__FLT16_DENORM_MIN__ 5.96046447753906250000000000000000000e-8F16
+__FLT16_HAS_DENORM__ 1
+__FLT16_HAS_INFINITY__ 1
+__FLT16_HAS_QUIET_NAN__ 1
+__FLT16_IS_IEC_60559__ 1
+__FLT32_MANT_DIG__ 24
+__FLT32_DIG__ 6
+__FLT32_MIN_EXP__ (-125)
+__FLT32_MIN_10_EXP__ (-37)
+__FLT32_MAX_EXP__ 128
+__FLT32_MAX_10_EXP__ 38
+__FLT32_DECIMAL_DIG__ 9
+__FLT32_MAX__ 3.40282346638528859811704183484516925e+38F32
+__FLT32_NORM_MAX__ 3.40282346638528859811704183484516925e+38F32
+__FLT32_MIN__ 1.17549435082228750796873653722224568e-38F32
+__FLT32_EPSILON__ 1.19209289550781250000000000000000000e-7F32
+__FLT32_DENORM_MIN__ 1.40129846432481707092372958328991613e-45F32
+__FLT32_HAS_DENORM__ 1
+__FLT32_HAS_INFINITY__ 1
+__FLT32_HAS_QUIET_NAN__ 1
+__FLT32_IS_IEC_60559__ 1
+__FLT64_MANT_DIG__ 53
+__FLT64_DIG__ 15
+__FLT64_MIN_EXP__ (-1021)
+__FLT64_MIN_10_EXP__ (-307)
+__FLT64_MAX_EXP__ 1024
+__FLT64_MAX_10_EXP__ 308
+__FLT64_DECIMAL_DIG__ 17
+__FLT64_MAX__ 1.79769313486231570814527423731704357e+308F64
+__FLT64_NORM_MAX__ 1.79769313486231570814527423731704357e+308F64
+__FLT64_MIN__ 2.22507385850720138309023271733240406e-308F64
+__FLT64_EPSILON__ 2.22044604925031308084726333618164062e-16F64
+__FLT64_DENORM_MIN__ 4.94065645841246544176568792868221372e-324F64
+__FLT64_HAS_DENORM__ 1
+__FLT64_HAS_INFINITY__ 1
+__FLT64_HAS_QUIET_NAN__ 1
+__FLT64_IS_IEC_60559__ 1
+__FLT128_MANT_DIG__ 113
+__FLT128_DIG__ 33
+__FLT128_MIN_EXP__ (-16381)
+__FLT128_MIN_10_EXP__ (-4931)
+__FLT128_MAX_EXP__ 16384
+__FLT128_MAX_10_EXP__ 4932
+__FLT128_DECIMAL_DIG__ 36
+__FLT128_MAX__ 1.18973149535723176508575932662800702e+4932F128
+__FLT128_NORM_MAX__ 1.18973149535723176508575932662800702e+4932F128
+__FLT128_MIN__ 3.36210314311209350626267781732175260e-4932F128
+__FLT128_EPSILON__ 1.92592994438723585305597794258492732e-34F128
+__FLT128_DENORM_MIN__ 6.47517511943802511092443895822764655e-4966F128
+__FLT128_HAS_DENORM__ 1
+__FLT128_HAS_INFINITY__ 1
+__FLT128_HAS_QUIET_NAN__ 1
+__FLT128_IS_IEC_60559__ 1
+__FLT32X_MANT_DIG__ 53
+__FLT32X_DIG__ 15
+__FLT32X_MIN_EXP__ (-1021)
+__FLT32X_MIN_10_EXP__ (-307)
+__FLT32X_MAX_EXP__ 1024
+__FLT32X_MAX_10_EXP__ 308
+__FLT32X_DECIMAL_DIG__ 17
+__FLT32X_MAX__ 1.79769313486231570814527423731704357e+308F32x
+__FLT32X_NORM_MAX__ 1.79769313486231570814527423731704357e+308F32x
+__FLT32X_MIN__ 2.22507385850720138309023271733240406e-308F32x
+__FLT32X_EPSILON__ 2.22044604925031308084726333618164062e-16F32x
+__FLT32X_DENORM_MIN__ 4.94065645841246544176568792868221372e-324F32x
+__FLT32X_HAS_DENORM__ 1
+__FLT32X_HAS_INFINITY__ 1
+__FLT32X_HAS_QUIET_NAN__ 1
+__FLT32X_IS_IEC_60559__ 1
+__FLT64X_MANT_DIG__ 64
+__FLT64X_DIG__ 18
+__FLT64X_MIN_EXP__ (-16381)
+__FLT64X_MIN_10_EXP__ (-4931)
+__FLT64X_MAX_EXP__ 16384
+__FLT64X_MAX_10_EXP__ 4932
+__FLT64X_DECIMAL_DIG__ 21
+__FLT64X_MAX__ 1.18973149535723176502126385303097021e+4932F64x
+__FLT64X_NORM_MAX__ 1.18973149535723176502126385303097021e+4932F64x
+__FLT64X_MIN__ 3.36210314311209350626267781732175260e-4932F64x
+__FLT64X_EPSILON__ 1.08420217248550443400745280086994171e-19F64x
+__FLT64X_DENORM_MIN__ 3.64519953188247460252840593361941982e-4951F64x
+__FLT64X_HAS_DENORM__ 1
+__FLT64X_HAS_INFINITY__ 1
+__FLT64X_HAS_QUIET_NAN__ 1
+__FLT64X_IS_IEC_60559__ 1
+__BFLT16_MANT_DIG__ 8
+__BFLT16_DIG__ 2
+__BFLT16_MIN_EXP__ (-125)
+__BFLT16_MIN_10_EXP__ (-37)
+__BFLT16_MAX_EXP__ 128
+__BFLT16_MAX_10_EXP__ 38
+__BFLT16_DECIMAL_DIG__ 4
+__BFLT16_MAX__ 3.38953138925153547590470800371487867e+38BF16
+__BFLT16_NORM_MAX__ 3.38953138925153547590470800371487867e+38BF16
+__BFLT16_MIN__ 1.17549435082228750796873653722224568e-38BF16
+__BFLT16_EPSILON__ 7.81250000000000000000000000000000000e-3BF16
+__BFLT16_DENORM_MIN__ 9.18354961579912115600575419704879436e-41BF16
+__BFLT16_HAS_DENORM__ 1
+__BFLT16_HAS_INFINITY__ 1
+__BFLT16_HAS_QUIET_NAN__ 1
+__BFLT16_IS_IEC_60559__ 0
+__DEC32_MANT_DIG__ 7
+__DEC32_MIN_EXP__ (-94)
+__DEC32_MAX_EXP__ 97
+__DEC32_MIN__ 1E-95DF
+__DEC32_MAX__ 9.999999E96DF
+__DEC32_EPSILON__ 1E-6DF
+__DEC32_SUBNORMAL_MIN__ 0.000001E-95DF
+__DEC64_MANT_DIG__ 16
+__DEC64_MIN_EXP__ (-382)
+__DEC64_MAX_EXP__ 385
+__DEC64_MIN__ 1E-383DD
+__DEC64_MAX__ 9.999999999999999E384DD
+__DEC64_EPSILON__ 1E-15DD
+__DEC64_SUBNORMAL_MIN__ 0.000000000000001E-383DD
+__DEC128_MANT_DIG__ 34
+__DEC128_MIN_EXP__ (-6142)
+__DEC128_MAX_EXP__ 6145
+__DEC128_MIN__ 1E-6143DL
+__DEC128_MAX__ 9.999999999999999999999999999999999E6144DL
+__DEC128_EPSILON__ 1E-33DL
+__DEC128_SUBNORMAL_MIN__ 0.000000000000000000000000000000001E-6143DL
+__REGISTER_PREFIX__ 
+__USER_LABEL_PREFIX__ 
+__GNUC_STDC_INLINE__ 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_1 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_2 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_4 1
+__GCC_HAVE_SYNC_COMPARE_AND_SWAP_8 1
+__GCC_ATOMIC_BOOL_LOCK_FREE 2
+__GCC_ATOMIC_CHAR_LOCK_FREE 2
+__GCC_ATOMIC_CHAR16_T_LOCK_FREE 2
+__GCC_ATOMIC_CHAR32_T_LOCK_FREE 2
+__GCC_ATOMIC_WCHAR_T_LOCK_FREE 2
+__GCC_ATOMIC_SHORT_LOCK_FREE 2
+__GCC_ATOMIC_INT_LOCK_FREE 2
+__GCC_ATOMIC_LONG_LOCK_FREE 2
+__GCC_ATOMIC_LLONG_LOCK_FREE 2
+__GCC_ATOMIC_TEST_AND_SET_TRUEVAL 1
+__GCC_DESTRUCTIVE_SIZE 64
+__GCC_CONSTRUCTIVE_SIZE 64
+__GCC_ATOMIC_POINTER_LOCK_FREE 2
+__HAVE_SPECULATION_SAFE_VALUE 1
+__GCC_HAVE_DWARF2_CFI_ASM 1
+__PRAGMA_REDEFINE_EXTNAME 1
+__SIZEOF_INT128__ 16
+__SIZEOF_WCHAR_T__ 4
+__SIZEOF_WINT_T__ 4
+__SIZEOF_PTRDIFF_T__ 8
+__amd64 1
+__amd64__ 1
+__x86_64 1
+__x86_64__ 1
+__SIZEOF_FLOAT80__ 16
+__SIZEOF_FLOAT128__ 16
+__ATOMIC_HLE_ACQUIRE 65536
+__ATOMIC_HLE_RELEASE 131072
+__GCC_ASM_FLAG_OUTPUTS__ 1
+__k8 1
+__k8__ 1
+__code_model_small__ 1
+__MMX__ 1
+__SSE__ 1
+__SSE2__ 1
+__FXSR__ 1
+__SSE_MATH__ 1
+__SSE2_MATH__ 1
+__MMX_WITH_SSE__ 1
+__SEG_FS 1
+__SEG_GS 1
+__gnu_linux__ 1
+__linux 1
+__linux__ 1
+linux 1
+__unix 1
+__unix__ 1
+unix 1
+__ELF__ 1
+__DECIMAL_BID_FORMAT__ 1
+_GNU_SOURCE 1
+file /home/osandov/src/elfutils/tests/main.cc
+ file /usr/include/stdc-predef.h
+  _STDC_PREDEF_H 1
+  __STDC_IEC_559__ 1
+  __STDC_IEC_60559_BFP__ 201404L
+  __STDC_IEC_559_COMPLEX__ 1
+  __STDC_IEC_60559_COMPLEX__ 201404L
+  __STDC_ISO_10646__ 201706L
+ /file
+ file /home/osandov/src/elfutils/tests/foobar.h
+  FROB(x) ((x) ^ 0x2a2a2a2a)
+  FRY(x) ((x) * 0x100000001b3)
+ /file
+ MAIN_ARGS int argc, char **argv
+/file
+EOF
+done
+
 exit 0
diff --git a/tests/run-dwfl-core-noncontig.sh b/tests/run-dwfl-core-noncontig.sh
new file mode 100755
index 00000000..1245b67f
--- /dev/null
+++ b/tests/run-dwfl-core-noncontig.sh
@@ -0,0 +1,63 @@
+#! /bin/sh
+# Copyright (C) 2023 Red Hat, Inc.
+# This file is part of elfutils.
+#
+# This file is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 3 of the License, or
+# (at your option) any later version.
+#
+# elfutils is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program.  If not, see <http://www.gnu.org/licenses/>.
+
+. $srcdir/test-subr.sh
+
+# Test whether libdwfl can handle corefiles containing non-contiguous
+# segments where multiple modules are contained within the address
+# space of some other module.
+
+# testcore-noncontig was generated from the following program with
+# systemd-coredump on RHEL 7.9 Workstation, kernel
+# 3.10.0-1160.105.1.el7.x86_64. liblgpllibs.so was packaged with
+# firefox-115.4.0-1.el7_9.x86_64.rpm.
+
+# #include <unistd.h>
+# #include <dlfcn.h>
+#
+# int main () {
+#   dlopen ("/usr/lib64/firefox/liblgpllibs.so", RTLD_GLOBAL | RTLD_NOW);
+#   sleep (60);
+#   return 0;
+# }
+#
+# gcc -ldl -o test test.c
+
+tempfiles out
+testfiles testcore-noncontig
+
+testrun ${abs_builddir}/dwfl-core-noncontig testcore-noncontig
+
+# Remove parts of the output that could change depending on which
+# libraries are locally installed.
+testrun ${abs_top_builddir}/src/unstrip -n --core testcore-noncontig \
+  | sed 's/+/ /g' | cut -d " " -f1,3 | sort > out
+
+testrun_compare cat out <<\EOF
+0x400000 3a1748a544b40a38b3be3d2d13ffa34a2a5a71c0@0x400284
+0x7f14e357e000 edf51350c7f71496149d064aa8b1441f786df88a@0x7f14e357e1d8
+0x7f14e3794000 7615604eaf4a068dfae5085444d15c0dee93dfbd@0x7f14e37941d8
+0x7f14e3a96000 09cfb171310110bc7ea9f4476c9fa044d85baff4@0x7f14e3a96210
+0x7f14e3d9e000 e10cc8f2b932fc3daeda22f8dac5ebb969524e5b@0x7f14e3d9e248
+0x7f14e3fba000 fc4fa58e47a5acc137eadb7689bce4357c557a96@0x7f14e3fba280
+0x7f14e4388000 7f2e9cb0769d7e57bd669b485a74b537b63a57c4@0x7f14e43881d8
+0x7f14e458c000 62c449974331341bb08dcce3859560a22af1e172@0x7f14e458c1d8
+0x7f14e4795000 175efdcef445455872a86a6fbee7567ca16a513e@0x7f14e4795248
+0x7ffcfe59f000 80d79b32785868a2dc10047b39a80d1daec8923d@0x7ffcfe59f328
+EOF
+
+exit 0
diff --git a/tests/run-dwfl-report-offline-memory.sh b/tests/run-dwfl-report-offline-memory.sh
index 644a45dc..84c7f999 100755
--- a/tests/run-dwfl-report-offline-memory.sh
+++ b/tests/run-dwfl-report-offline-memory.sh
@@ -20,7 +20,14 @@
 testfiles testfile-dwfl-report-elf-align-shlib.so
 testfiles testarchive64.a
 
-testrun ${abs_builddir}/dwfl-report-offline-memory ./testfile-dwfl-report-elf-align-shlib.so 1
-testrun ${abs_builddir}/dwfl-report-offline-memory ./testarchive64.a 3
+# echo "int _start(void) { return 0; }" > test.c
+# gcc test.c -nostdlib -static -o test.o
+# ar -r test-ar-duplicates.a test.o test.o test.o
+# bzip2 -zf test-ar-duplicates.a
+testfiles test-ar-duplicates.a
+
+testrun ${abs_builddir}/dwfl-report-offline-memory ./testfile-dwfl-report-elf-align-shlib.so 1 24
+testrun ${abs_builddir}/dwfl-report-offline-memory ./testarchive64.a 3 10
+testrun ${abs_builddir}/dwfl-report-offline-memory ./test-ar-duplicates.a 1 7
 
 exit 0
diff --git a/tests/run-elfgetzdata.sh b/tests/run-elfgetzdata.sh
index e2df3081..7d3d1a5e 100755
--- a/tests/run-elfgetzdata.sh
+++ b/tests/run-elfgetzdata.sh
@@ -42,6 +42,17 @@ testrun_compare ${abs_top_builddir}/tests/elfgetzdata mmap testfile-zgnu64 <<\EO
 8: .strtab, NOT compressed
 EOF
 
+testrun_compare ${abs_top_builddir}/tests/elfgetzdata mem testfile-zgnu64 <<\EOF
+1: .text, NOT compressed
+2: .zdebug_aranges, GNU compressed, size: 60
+3: .zdebug_info, GNU compressed, size: aa
+4: .debug_abbrev, NOT compressed
+5: .zdebug_line, GNU compressed, size: 8d
+6: .shstrtab, NOT compressed
+7: .symtab, NOT compressed
+8: .strtab, NOT compressed
+EOF
+
 testfiles testfile-zgnu64be
 testrun_compare ${abs_top_builddir}/tests/elfgetzdata read testfile-zgnu64be <<\EOF
 1: .text, NOT compressed
@@ -67,6 +78,18 @@ testrun_compare ${abs_top_builddir}/tests/elfgetzdata mmap testfile-zgnu64be <<\
 9: .strtab, NOT compressed
 EOF
 
+testrun_compare ${abs_top_builddir}/tests/elfgetzdata mem testfile-zgnu64be <<\EOF
+1: .text, NOT compressed
+2: .eh_frame, NOT compressed
+3: .zdebug_aranges, GNU compressed, size: 60
+4: .zdebug_info, GNU compressed, size: 7e
+5: .debug_abbrev, NOT compressed
+6: .zdebug_line, GNU compressed, size: 8d
+7: .shstrtab, NOT compressed
+8: .symtab, NOT compressed
+9: .strtab, NOT compressed
+EOF
+
 testfiles testfile-zgabi64
 testrun_compare ${abs_top_builddir}/tests/elfgetzdata read testfile-zgabi64 <<\EOF
 1: .text, NOT compressed
@@ -90,6 +113,17 @@ testrun_compare ${abs_top_builddir}/tests/elfgetzdata mmap testfile-zgabi64 <<\E
 8: .strtab, NOT compressed
 EOF
 
+testrun_compare ${abs_top_builddir}/tests/elfgetzdata mem testfile-zgabi64 <<\EOF
+1: .text, NOT compressed
+2: .debug_aranges, ELF compressed, size: 60
+3: .debug_info, ELF compressed, size: aa
+4: .debug_abbrev, NOT compressed
+5: .debug_line, ELF compressed, size: 8d
+6: .shstrtab, NOT compressed
+7: .symtab, NOT compressed
+8: .strtab, NOT compressed
+EOF
+
 testfiles testfile-zgabi64be
 testrun_compare ${abs_top_builddir}/tests/elfgetzdata read testfile-zgabi64be <<\EOF
 1: .text, NOT compressed
@@ -115,6 +149,18 @@ testrun_compare ${abs_top_builddir}/tests/elfgetzdata mmap testfile-zgabi64be <<
 9: .strtab, NOT compressed
 EOF
 
+testrun_compare ${abs_top_builddir}/tests/elfgetzdata mem testfile-zgabi64be <<\EOF
+1: .text, NOT compressed
+2: .eh_frame, NOT compressed
+3: .debug_aranges, ELF compressed, size: 60
+4: .debug_info, ELF compressed, size: 7e
+5: .debug_abbrev, NOT compressed
+6: .debug_line, ELF compressed, size: 8d
+7: .shstrtab, NOT compressed
+8: .symtab, NOT compressed
+9: .strtab, NOT compressed
+EOF
+
 testfiles testfile-zgnu32
 testrun_compare ${abs_top_builddir}/tests/elfgetzdata read testfile-zgnu32 <<\EOF
 1: .text, NOT compressed
@@ -138,6 +184,17 @@ testrun_compare ${abs_top_builddir}/tests/elfgetzdata mmap testfile-zgnu32 <<\EO
 8: .strtab, NOT compressed
 EOF
 
+testrun_compare ${abs_top_builddir}/tests/elfgetzdata mem testfile-zgnu32 <<\EOF
+1: .text, NOT compressed
+2: .zdebug_aranges, GNU compressed, size: 40
+3: .zdebug_info, GNU compressed, size: 9a
+4: .debug_abbrev, NOT compressed
+5: .zdebug_line, GNU compressed, size: 85
+6: .shstrtab, NOT compressed
+7: .symtab, NOT compressed
+8: .strtab, NOT compressed
+EOF
+
 testfiles testfile-zgnu32be
 testrun_compare ${abs_top_builddir}/tests/elfgetzdata read testfile-zgnu32be <<\EOF
 1: .text, NOT compressed
@@ -163,6 +220,18 @@ testrun_compare ${abs_top_builddir}/tests/elfgetzdata mmap testfile-zgnu32be <<\
 9: .strtab, NOT compressed
 EOF
 
+testrun_compare ${abs_top_builddir}/tests/elfgetzdata mem testfile-zgnu32be <<\EOF
+1: .text, NOT compressed
+2: .eh_frame, NOT compressed
+3: .zdebug_aranges, GNU compressed, size: 40
+4: .zdebug_info, GNU compressed, size: 6e
+5: .debug_abbrev, NOT compressed
+6: .zdebug_line, GNU compressed, size: 85
+7: .shstrtab, NOT compressed
+8: .symtab, NOT compressed
+9: .strtab, NOT compressed
+EOF
+
 testfiles testfile-zgabi32
 testrun_compare ${abs_top_builddir}/tests/elfgetzdata read testfile-zgabi32 <<\EOF
 1: .text, NOT compressed
@@ -186,6 +255,17 @@ testrun_compare ${abs_top_builddir}/tests/elfgetzdata mmap testfile-zgabi32 <<\E
 8: .strtab, NOT compressed
 EOF
 
+testrun_compare ${abs_top_builddir}/tests/elfgetzdata mem testfile-zgabi32 <<\EOF
+1: .text, NOT compressed
+2: .debug_aranges, ELF compressed, size: 40
+3: .debug_info, ELF compressed, size: 9a
+4: .debug_abbrev, NOT compressed
+5: .debug_line, ELF compressed, size: 85
+6: .shstrtab, NOT compressed
+7: .symtab, NOT compressed
+8: .strtab, NOT compressed
+EOF
+
 testfiles testfile-zgabi32be
 testrun_compare ${abs_top_builddir}/tests/elfgetzdata read testfile-zgabi32be <<\EOF
 1: .text, NOT compressed
@@ -211,4 +291,16 @@ testrun_compare ${abs_top_builddir}/tests/elfgetzdata mmap testfile-zgabi32be <<
 9: .strtab, NOT compressed
 EOF
 
+testrun_compare ${abs_top_builddir}/tests/elfgetzdata mem testfile-zgabi32be <<\EOF
+1: .text, NOT compressed
+2: .eh_frame, NOT compressed
+3: .debug_aranges, ELF compressed, size: 40
+4: .debug_info, ELF compressed, size: 6e
+5: .debug_abbrev, NOT compressed
+6: .debug_line, ELF compressed, size: 85
+7: .shstrtab, NOT compressed
+8: .symtab, NOT compressed
+9: .strtab, NOT compressed
+EOF
+
 exit 0
diff --git a/tests/run-get-files.sh b/tests/run-get-files.sh
index 6f90be7d..1306544d 100755
--- a/tests/run-get-files.sh
+++ b/tests/run-get-files.sh
@@ -130,4 +130,119 @@ cuhl = 20, o = 0, asz = 8, osz = 4, ncu = 296
  file[3] = "/usr/include/stdlib.h"
 EOF
 
+# See testfile-dwp.source.
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testfiles testfile-dwp-4 testfile-dwp-4.dwp
+
+testrun_compare ${abs_builddir}/get-files testfile-dwp-5 << EOF
+cuhl = 20, o = 0, asz = 8, osz = 4, ncu = 53
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 20, o = 21, asz = 8, osz = 4, ncu = 106
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 20, o = 42, asz = 8, osz = 4, ncu = 155
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+EOF
+
+# Note that this one includes the type units in .debug_info.dwo as expected.
+testrun_compare ${abs_builddir}/get-files testfile-dwp-5.dwp << EOF
+cuhl = 24, o = 0, asz = 8, osz = 4, ncu = 112
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 20, o = 0, asz = 8, osz = 4, ncu = 376
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 24, o = 0, asz = 8, osz = 4, ncu = 486
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 20, o = 0, asz = 8, osz = 4, ncu = 606
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 20, o = 0, asz = 8, osz = 4, ncu = 1009
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+EOF
+
+testrun_compare ${abs_builddir}/get-files testfile-dwp-4 << EOF
+cuhl = 11, o = 0, asz = 8, osz = 4, ncu = 56
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 11, o = 29, asz = 8, osz = 4, ncu = 108
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 11, o = 55, asz = 8, osz = 4, ncu = 160
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+EOF
+
+testrun_compare ${abs_builddir}/get-files testfile-dwp-4.dwp << EOF
+cuhl = 11, o = 0, asz = 8, osz = 4, ncu = 286
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 11, o = 0, asz = 8, osz = 4, ncu = 404
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+cuhl = 11, o = 0, asz = 8, osz = 4, ncu = 857
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+EOF
+
 exit 0
diff --git a/tests/run-get-lines.sh b/tests/run-get-lines.sh
index fb48c77d..0c4e3389 100755
--- a/tests/run-get-lines.sh
+++ b/tests/run-get-lines.sh
@@ -88,4 +88,248 @@ cuhl = 11, o = 125, asz = 8, osz = 4, ncu = 243
  0 lines
 EOF
 
+# See testfile-dwp.source.
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testfiles testfile-dwp-4 testfile-dwp-4.dwp
+
+testrun_compare ${abs_builddir}/get-lines testfile-dwp-5 << EOF
+cuhl = 20, o = 0, asz = 8, osz = 4, ncu = 53
+ 63 lines
+401190: /home/osandov/src/elfutils/tests/foo.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401192: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401196: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40119e: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40119e: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a1: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a1: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a4: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b0: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b0: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b6: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b6: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b9: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bc: /home/osandov/src/elfutils/tests/foo.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:15:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:16:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:16:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c2: /home/osandov/src/elfutils/tests/foo.cc:17:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c2: /home/osandov/src/elfutils/tests/foo.cc:17:11: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c5: /home/osandov/src/elfutils/tests/foo.cc:17:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c9: /home/osandov/src/elfutils/tests/foo.cc:18:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c9: /home/osandov/src/elfutils/tests/foo.cc:18:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:6:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cd: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d1: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d1: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d4: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d4: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d7: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e0: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e0: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e6: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e6: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e9: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:19:10: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f0: /home/osandov/src/elfutils/tests/foo.cc:20:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:6:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011fc: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+cuhl = 20, o = 21, asz = 8, osz = 4, ncu = 106
+ 7 lines
+401200: /home/osandov/src/elfutils/tests/bar.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/bar.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/bar.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401204: /home/osandov/src/elfutils/tests/bar.cc:8:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401207: /home/osandov/src/elfutils/tests/bar.cc:11:18: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40121a: /home/osandov/src/elfutils/tests/bar.cc:12:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40121b: /home/osandov/src/elfutils/tests/bar.cc:12:1: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+cuhl = 20, o = 42, asz = 8, osz = 4, ncu = 155
+ 41 lines
+401020: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401020: /home/osandov/src/elfutils/tests/main.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401020: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401021: /home/osandov/src/elfutils/tests/main.cc:8:28: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401028: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40102c: /home/osandov/src/elfutils/tests/main.cc:8:28: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/main.cc:9:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:17:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:20:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401032: /home/osandov/src/elfutils/tests/main.cc:8:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401036: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40103a: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40103a: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40103f: /home/osandov/src/elfutils/tests/foobar.h:25:25: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401044: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401049: /home/osandov/src/elfutils/tests/foobar.h:23:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401050: /home/osandov/src/elfutils/tests/foobar.h:27:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401053: /home/osandov/src/elfutils/tests/foobar.h:25:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401056: /home/osandov/src/elfutils/tests/foobar.h:27:9: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:28:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:29:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:29:4: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:25:7: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401060: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401060: /home/osandov/src/elfutils/tests/main.cc:9:51: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401065: /home/osandov/src/elfutils/tests/main.cc:9:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401068: /home/osandov/src/elfutils/tests/main.cc:9:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401076: /home/osandov/src/elfutils/tests/main.cc:9:51: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40107b: /home/osandov/src/elfutils/tests/main.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40107b: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401080: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401085: /home/osandov/src/elfutils/tests/main.cc:10:33: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40108a: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40108c: /home/osandov/src/elfutils/tests/main.cc:10:33: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401091: /home/osandov/src/elfutils/tests/main.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401095: /home/osandov/src/elfutils/tests/main.cc:10:22: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401097: /home/osandov/src/elfutils/tests/main.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401099: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4010a0: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+EOF
+
+testrun_compare ${abs_builddir}/get-lines testfile-dwp-4 << EOF
+cuhl = 11, o = 0, asz = 8, osz = 4, ncu = 56
+ 63 lines
+401190: /home/osandov/src/elfutils/tests/foo.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401192: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401196: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40119e: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40119e: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a1: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a1: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a4: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b0: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b0: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b6: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b6: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b9: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bc: /home/osandov/src/elfutils/tests/foo.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:15:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:16:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:16:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c2: /home/osandov/src/elfutils/tests/foo.cc:17:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c2: /home/osandov/src/elfutils/tests/foo.cc:17:11: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c5: /home/osandov/src/elfutils/tests/foo.cc:17:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c9: /home/osandov/src/elfutils/tests/foo.cc:18:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c9: /home/osandov/src/elfutils/tests/foo.cc:18:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:6:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cd: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d1: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d1: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d4: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d4: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d7: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e0: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e0: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e6: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e6: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e9: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:19:10: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f0: /home/osandov/src/elfutils/tests/foo.cc:20:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:6:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011fc: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+cuhl = 11, o = 29, asz = 8, osz = 4, ncu = 108
+ 7 lines
+401200: /home/osandov/src/elfutils/tests/bar.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/bar.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/bar.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401204: /home/osandov/src/elfutils/tests/bar.cc:8:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401207: /home/osandov/src/elfutils/tests/bar.cc:11:18: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40121a: /home/osandov/src/elfutils/tests/bar.cc:12:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40121b: /home/osandov/src/elfutils/tests/bar.cc:12:1: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+cuhl = 11, o = 55, asz = 8, osz = 4, ncu = 160
+ 41 lines
+401020: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401020: /home/osandov/src/elfutils/tests/main.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401020: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401021: /home/osandov/src/elfutils/tests/main.cc:8:28: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401028: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40102c: /home/osandov/src/elfutils/tests/main.cc:8:28: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/main.cc:9:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:17:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:20:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401032: /home/osandov/src/elfutils/tests/main.cc:8:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401036: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40103a: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40103a: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40103f: /home/osandov/src/elfutils/tests/foobar.h:25:25: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401044: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401049: /home/osandov/src/elfutils/tests/foobar.h:23:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401050: /home/osandov/src/elfutils/tests/foobar.h:27:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401053: /home/osandov/src/elfutils/tests/foobar.h:25:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401056: /home/osandov/src/elfutils/tests/foobar.h:27:9: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:28:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:29:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:29:4: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:25:7: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401060: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401060: /home/osandov/src/elfutils/tests/main.cc:9:51: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401065: /home/osandov/src/elfutils/tests/main.cc:9:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401068: /home/osandov/src/elfutils/tests/main.cc:9:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401076: /home/osandov/src/elfutils/tests/main.cc:9:51: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40107b: /home/osandov/src/elfutils/tests/main.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40107b: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401080: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401085: /home/osandov/src/elfutils/tests/main.cc:10:33: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40108a: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40108c: /home/osandov/src/elfutils/tests/main.cc:10:33: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401091: /home/osandov/src/elfutils/tests/main.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401095: /home/osandov/src/elfutils/tests/main.cc:10:22: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401097: /home/osandov/src/elfutils/tests/main.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401099: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4010a0: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+EOF
+
 exit 0
diff --git a/tests/run-get-units-split.sh b/tests/run-get-units-split.sh
index 7a43c670..6c7a4f25 100755
--- a/tests/run-get-units-split.sh
+++ b/tests/run-get-units-split.sh
@@ -63,4 +63,22 @@ EOF
 testrun_on_self_exe ${abs_builddir}/get-units-split
 testrun_on_self_lib ${abs_builddir}/get-units-split
 
+# See testfile-dwp.source.
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testfiles testfile-dwp-4 testfile-dwp-4.dwp
+testfiles testfile-dwp-4-strict testfile-dwp-4-strict.dwp
+
+for file in testfile-dwp-5 testfile-dwp-4 testfile-dwp-4-strict; do
+	testrun_compare ${abs_builddir}/get-units-split "$file" << EOF
+file: $file
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: foo.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: bar.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: main.cc
+
+EOF
+done
+
 exit 0
diff --git a/tests/run-getsrc-die.sh b/tests/run-getsrc-die.sh
index 4da16e7a..6740e5d9 100755
--- a/tests/run-getsrc-die.sh
+++ b/tests/run-getsrc-die.sh
@@ -22,13 +22,17 @@
 # which uses dwfl_module_getsrc. This test uses dwarf_addrdie and
 # dwarf_getsrc_die
 testfiles testfile testfile-inlines testfile-lex-inlines
+tempfiles testfile-no-aranges testfile-inlines-no-aranges getsrc_die.out
+tempfiles testfile-lex-inlines-no-aranges good1.out good2.out good3.out
 
-testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile 0x08048468 0x0804845c <<\EOF
+cat > good1.out <<\EOF
 /home/drepper/gnu/new-bu/build/ttt/f.c:3
 /home/drepper/gnu/new-bu/build/ttt/b.c:4
 EOF
 
-testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile-inlines 0x00000000000005a0 0x00000000000005a1 0x00000000000005b0 0x00000000000005b1 0x00000000000005c0 0x00000000000005d0 0x00000000000005e0 0x00000000000005e1 0x00000000000005f1 0x00000000000005f2 <<\EOF
+cat good1.out | testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile 0x08048468 0x0804845c
+
+cat > good2.out <<\EOF
 /tmp/x.cpp:5
 /tmp/x.cpp:6
 /tmp/x.cpp:10
@@ -41,11 +45,27 @@ testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile-inlines 0x00000000
 /tmp/x.cpp:5
 EOF
 
-testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile-lex-inlines 0x0000000000000680 0x0000000000000681 0x0000000000000690 0x0000000000000691 <<\EOF
+cat good2.out | testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile-inlines 0x00000000000005a0 0x00000000000005a1 0x00000000000005b0 0x00000000000005b1 0x00000000000005c0 0x00000000000005d0 0x00000000000005e0 0x00000000000005e1 0x00000000000005f1 0x00000000000005f2
+
+cat > good3.out <<\EOF
 /tmp/x.cpp:5
 /tmp/x.cpp:5
 /tmp/x.cpp:5
 /tmp/x.cpp:5
 EOF
 
+cat good3.out | testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile-lex-inlines 0x0000000000000680 0x0000000000000681 0x0000000000000690 0x0000000000000691
+
+# Each test should also pass with no .debug_aranges present.  If objcopy cannot
+# strip the testfiles then skip the remaining tests.
+objcopy --remove-section .debug_aranges testfile testfile-no-aranges || exit 0
+objcopy --remove-section .debug_aranges testfile-inlines testfile-inlines-no-aranges || exit 0
+objcopy --remove-section .debug_aranges testfile-lex-inlines testfile-lex-inlines-no-aranges || exit 0
+
+cat good1.out | testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile-no-aranges 0x08048468 0x0804845c
+
+cat good2.out | testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile-inlines-no-aranges 0x00000000000005a0 0x00000000000005a1 0x00000000000005b0 0x00000000000005b1 0x00000000000005c0 0x00000000000005d0 0x00000000000005e0 0x00000000000005e1 0x00000000000005f1 0x00000000000005f2
+
+cat good3.out | testrun_compare ${abs_top_builddir}/tests/getsrc_die testfile-lex-inlines-no-aranges 0x0000000000000680 0x0000000000000681 0x0000000000000690 0x0000000000000691
+
 exit 0
diff --git a/tests/run-large-elf-file.sh b/tests/run-large-elf-file.sh
index 7116de53..8108cb4b 100755
--- a/tests/run-large-elf-file.sh
+++ b/tests/run-large-elf-file.sh
@@ -122,4 +122,178 @@ test_file testfile38
 # 64bit, big endian, non-rel
 test_file testfile27
 
+# See testfile-dwp-cu-index-overflow.source
+testfiles testfile-dwp-5-cu-index-overflow testfile-dwp-5-cu-index-overflow.dwp
+
+testrun_compare ${abs_builddir}/cu-dwp-section-info testfile-dwp-5-cu-index-overflow.dwp << EOF
+file: testfile-dwp-5-cu-index-overflow.dwp
+INFO: 0x0 0x8000004c
+TYPES: 0x0 0x0
+ABBREV: 0x0 0x50
+LINE: 0x0 0x61
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x0 0x1c
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x8000004c 0x6f
+TYPES: 0x0 0x0
+ABBREV: 0x50 0x15e
+LINE: 0x61 0x63
+LOCLISTS: 0x0 0xd4
+STR_OFFSETS: 0x1c 0x24
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x22
+
+INFO: 0x800000bb 0xff
+TYPES: 0x0 0x0
+ABBREV: 0x50 0x15e
+LINE: 0x61 0x63
+LOCLISTS: 0x0 0xd4
+STR_OFFSETS: 0x1c 0x24
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x22
+
+INFO: 0x800001ba 0x8000004c
+TYPES: 0x0 0x0
+ABBREV: 0x1ae 0x50
+LINE: 0xc4 0x61
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x40 0x1c
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x100000206 0x6c
+TYPES: 0x0 0x0
+ABBREV: 0x1fe 0xc8
+LINE: 0x125 0x63
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x5c 0x20
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x100000272 0x6f
+TYPES: 0x0 0x0
+ABBREV: 0x1fe 0xc8
+LINE: 0x125 0x63
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x5c 0x20
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x1000002e1 0x182
+TYPES: 0x0 0x0
+ABBREV: 0x2c6 0x188
+LINE: 0x188 0x65
+LOCLISTS: 0xd4 0xee
+STR_OFFSETS: 0x7c 0x44
+MACRO: 0x0 0x0
+RNGLISTS: 0x22 0x43
+
+EOF
+
+testrun_compare ${abs_builddir}/get-units-split testfile-dwp-5-cu-index-overflow << EOF
+file: testfile-dwp-5-cu-index-overflow
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: filler1.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: foo.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: filler2.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: bar.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: main.cc
+
+EOF
+
+rm -f testfile-dwp-5-cu-index-overflow testfile-dwp-5-cu-index-overflow.dwp
+
+# See testfile-dwp-cu-index-overflow.source
+testfiles testfile-dwp-4-cu-index-overflow testfile-dwp-4-cu-index-overflow.dwp
+
+testrun_compare ${abs_builddir}/cu-dwp-section-info testfile-dwp-4-cu-index-overflow.dwp << EOF
+file: testfile-dwp-4-cu-index-overflow.dwp
+INFO: 0x0 0x8000004b
+TYPES: 0x0 0x0
+ABBREV: 0x0 0x58
+LINE: 0x0 0x2c
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x0 0x14
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x8000004b 0x116
+TYPES: 0x0 0x0
+ABBREV: 0x58 0x16f
+LINE: 0x2c 0x34
+LOCLISTS: 0x0 0x110
+STR_OFFSETS: 0x14 0x1c
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x80000161 0x8000004b
+TYPES: 0x0 0x0
+ABBREV: 0x1c7 0x58
+LINE: 0x60 0x2c
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x30 0x14
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x1000001ac 0x6e
+TYPES: 0x0 0x0
+ABBREV: 0x21f 0xd4
+LINE: 0x8c 0x34
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x44 0x18
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x10000021a 0x1b5
+TYPES: 0x0 0x0
+ABBREV: 0x2f3 0x19b
+LINE: 0xc0 0x35
+LOCLISTS: 0x110 0x12a
+STR_OFFSETS: 0x5c 0x3c
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x0 0x0
+TYPES: 0x0 0x6e
+ABBREV: 0x58 0x16f
+LINE: 0x2c 0x34
+LOCLISTS: 0x0 0x110
+STR_OFFSETS: 0x14 0x1c
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+INFO: 0x0 0x0
+TYPES: 0x6e 0x6b
+ABBREV: 0x21f 0xd4
+LINE: 0x8c 0x34
+LOCLISTS: 0x0 0x0
+STR_OFFSETS: 0x44 0x18
+MACRO: 0x0 0x0
+RNGLISTS: 0x0 0x0
+
+EOF
+
+testrun_compare ${abs_builddir}/get-units-split testfile-dwp-4-cu-index-overflow << EOF
+file: testfile-dwp-4-cu-index-overflow
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: filler1.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: foo.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: filler2.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: bar.cc
+Got cudie unit_type: 4
+Found a skeleton unit, with split die: main.cc
+
+EOF
+
+rm -f testfile-dwp-4-cu-index-overflow testfile-dwp-4-cu-index-overflow.dwp
+
 exit 0
diff --git a/tests/run-native-test.sh b/tests/run-native-test.sh
index 042a51c6..01a52e82 100755
--- a/tests/run-native-test.sh
+++ b/tests/run-native-test.sh
@@ -57,10 +57,10 @@ trap native_exit 0
 
 for cc in "$HOSTCC" "$HOST_CC" cc gcc "$CC"; do
   test "x$cc" != x || continue
-  $cc -o native -g native.c > /dev/null 2>&1 &&
+  $cc -o native -g native.c &&
   # Some shell versions don't do this right without the braces.
-  { ./native > /dev/null 2>&1 & native=$! ; } &&
-  sleep 1 && kill -0 $native 2> /dev/null &&
+  { ./native & native=$! ; } &&
+  sleep 1 && kill -0 $native &&
   break ||
   native=0
 done
@@ -68,14 +68,17 @@ done
 native_test()
 {
   # Try the build against itself, i.e. $config_host.
-  testrun "$@" -e $1 > /dev/null
+  echo "Try the build against itself: $@ -e $1"
+  testrun "$@" -e $1
 
   # Try the build against a presumed native process, running this sh.
   # For tests requiring debug information, this may not test anything.
-  testrun "$@" -p $$ > /dev/null
+  echo "Try the build against a presumed native process: $@ -p $$"
+  testrun "$@" -p $$
 
   # Try the build against the trivial native program we just built with -g.
-  test $native -eq 0 || testrun "$@" -p $native > /dev/null
+  echo "Try the build against the trivial native program: $@ -p $native"
+  test $native -eq 0 || testrun "$@" -p $native
 }
 
 native_test ${abs_builddir}/allregs
diff --git a/tests/run-next-files.sh b/tests/run-next-files.sh
index 7a3b6d0f..150a6a1a 100755
--- a/tests/run-next-files.sh
+++ b/tests/run-next-files.sh
@@ -162,4 +162,104 @@ off = 480
  file[1] = "f.c"
 EOF
 
+# See testfile-dwp.source.
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testfiles testfile-dwp-4 testfile-dwp-4.dwp
+
+testrun_compare ${abs_builddir}/next-files testfile-dwp-5 << EOF
+off = 0
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+off = 383
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+off = 487
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+EOF
+
+testrun_compare ${abs_builddir}/next-files testfile-dwp-5.dwp << EOF
+off = 0
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+off = 127
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+off = 254
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[1] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+EOF
+
+testrun_compare ${abs_builddir}/next-files testfile-dwp-4 << EOF
+off = 0
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+off = 397
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+off = 515
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+EOF
+
+testrun_compare ${abs_builddir}/next-files testfile-dwp-4.dwp << EOF
+off = 0
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/foo.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+off = 82
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/bar.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+off = 164
+ dirs[0] = "/home/osandov/src/elfutils/tests"
+ dirs[1] = "/usr/include"
+ file[0] = "???"
+ file[1] = "/home/osandov/src/elfutils/tests/main.cc"
+ file[2] = "/home/osandov/src/elfutils/tests/foobar.h"
+ file[3] = "/usr/include/stdc-predef.h"
+EOF
+
 exit 0
diff --git a/tests/run-next-lines.sh b/tests/run-next-lines.sh
index 84aee1c7..551b438e 100755
--- a/tests/run-next-lines.sh
+++ b/tests/run-next-lines.sh
@@ -113,4 +113,246 @@ off = 480
 8048472: f.c:5:0: is_stmt:yes, end_seq:yes, bb:no, prologue:no, epilogue:no
 EOF
 
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testrun_compare ${abs_builddir}/next-lines testfile-dwp-5 << EOF
+off = 0
+ 63 lines
+401190: /home/osandov/src/elfutils/tests/foo.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401192: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401196: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40119e: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40119e: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a1: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a1: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a4: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b0: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b0: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b6: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b6: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b9: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bc: /home/osandov/src/elfutils/tests/foo.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:15:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:16:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:16:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c2: /home/osandov/src/elfutils/tests/foo.cc:17:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c2: /home/osandov/src/elfutils/tests/foo.cc:17:11: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c5: /home/osandov/src/elfutils/tests/foo.cc:17:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c9: /home/osandov/src/elfutils/tests/foo.cc:18:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c9: /home/osandov/src/elfutils/tests/foo.cc:18:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:6:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cd: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d1: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d1: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d4: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d4: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d7: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e0: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e0: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e6: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e6: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e9: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:19:10: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f0: /home/osandov/src/elfutils/tests/foo.cc:20:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:6:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011fc: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+off = 383
+ 7 lines
+401200: /home/osandov/src/elfutils/tests/bar.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/bar.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/bar.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401204: /home/osandov/src/elfutils/tests/bar.cc:8:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401207: /home/osandov/src/elfutils/tests/bar.cc:11:18: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40121a: /home/osandov/src/elfutils/tests/bar.cc:12:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40121b: /home/osandov/src/elfutils/tests/bar.cc:12:1: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+off = 487
+ 41 lines
+401020: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401020: /home/osandov/src/elfutils/tests/main.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401020: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401021: /home/osandov/src/elfutils/tests/main.cc:8:28: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401028: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40102c: /home/osandov/src/elfutils/tests/main.cc:8:28: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/main.cc:9:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:17:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:20:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401032: /home/osandov/src/elfutils/tests/main.cc:8:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401036: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40103a: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40103a: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40103f: /home/osandov/src/elfutils/tests/foobar.h:25:25: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401044: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401049: /home/osandov/src/elfutils/tests/foobar.h:23:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401050: /home/osandov/src/elfutils/tests/foobar.h:27:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401053: /home/osandov/src/elfutils/tests/foobar.h:25:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401056: /home/osandov/src/elfutils/tests/foobar.h:27:9: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:28:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:29:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:29:4: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:25:7: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401060: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401060: /home/osandov/src/elfutils/tests/main.cc:9:51: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401065: /home/osandov/src/elfutils/tests/main.cc:9:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401068: /home/osandov/src/elfutils/tests/main.cc:9:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401076: /home/osandov/src/elfutils/tests/main.cc:9:51: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40107b: /home/osandov/src/elfutils/tests/main.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40107b: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401080: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401085: /home/osandov/src/elfutils/tests/main.cc:10:33: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40108a: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40108c: /home/osandov/src/elfutils/tests/main.cc:10:33: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401091: /home/osandov/src/elfutils/tests/main.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401095: /home/osandov/src/elfutils/tests/main.cc:10:22: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401097: /home/osandov/src/elfutils/tests/main.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401099: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4010a0: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+EOF
+
+testfiles testfile-dwp-4 testfile-dwp-4.dwp
+testrun_compare ${abs_builddir}/next-lines testfile-dwp-4 << EOF
+off = 0
+ 63 lines
+401190: /home/osandov/src/elfutils/tests/foo.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401190: /home/osandov/src/elfutils/tests/foo.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401192: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401196: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40119e: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40119e: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a1: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a1: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011a4: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b0: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b0: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b3: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b6: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b6: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011b9: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bb: /home/osandov/src/elfutils/tests/foo.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011bc: /home/osandov/src/elfutils/tests/foo.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:15:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:16:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c0: /home/osandov/src/elfutils/tests/foo.cc:16:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c2: /home/osandov/src/elfutils/tests/foo.cc:17:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c2: /home/osandov/src/elfutils/tests/foo.cc:17:11: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c5: /home/osandov/src/elfutils/tests/foo.cc:17:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c9: /home/osandov/src/elfutils/tests/foo.cc:18:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011c9: /home/osandov/src/elfutils/tests/foo.cc:18:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:6:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cb: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011cd: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d1: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d1: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d4: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d4: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011d7: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e0: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e0: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:9:5: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e3: /home/osandov/src/elfutils/tests/foo.cc:9:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e6: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e6: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011e9: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:10:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011eb: /home/osandov/src/elfutils/tests/foo.cc:19:10: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f0: /home/osandov/src/elfutils/tests/foo.cc:20:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:6:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011f8: /home/osandov/src/elfutils/tests/foo.cc:8:21: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+4011fc: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/foo.cc:8:12: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+off = 397
+ 7 lines
+401200: /home/osandov/src/elfutils/tests/bar.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/bar.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401200: /home/osandov/src/elfutils/tests/bar.cc:8:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401204: /home/osandov/src/elfutils/tests/bar.cc:8:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401207: /home/osandov/src/elfutils/tests/bar.cc:11:18: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40121a: /home/osandov/src/elfutils/tests/bar.cc:12:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40121b: /home/osandov/src/elfutils/tests/bar.cc:12:1: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+off = 515
+ 41 lines
+401020: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401020: /home/osandov/src/elfutils/tests/main.cc:8:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401020: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401021: /home/osandov/src/elfutils/tests/main.cc:8:28: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401028: /home/osandov/src/elfutils/tests/main.cc:7:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40102c: /home/osandov/src/elfutils/tests/main.cc:8:28: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/main.cc:9:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:17:1: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401030: /home/osandov/src/elfutils/tests/foobar.h:20:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401032: /home/osandov/src/elfutils/tests/main.cc:8:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401036: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40103a: /home/osandov/src/elfutils/tests/foobar.h:19:3: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40103a: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40103f: /home/osandov/src/elfutils/tests/foobar.h:25:25: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401044: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401049: /home/osandov/src/elfutils/tests/foobar.h:23:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401050: /home/osandov/src/elfutils/tests/foobar.h:27:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401053: /home/osandov/src/elfutils/tests/foobar.h:25:7: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401056: /home/osandov/src/elfutils/tests/foobar.h:27:9: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:28:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:29:4: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:29:4: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:25:7: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401059: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+401060: /home/osandov/src/elfutils/tests/foobar.h:25:34: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401060: /home/osandov/src/elfutils/tests/main.cc:9:51: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401065: /home/osandov/src/elfutils/tests/main.cc:9:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401068: /home/osandov/src/elfutils/tests/main.cc:9:40: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401076: /home/osandov/src/elfutils/tests/main.cc:9:51: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40107b: /home/osandov/src/elfutils/tests/main.cc:10:3: is_stmt:yes, end_seq:no, bb:no, prologue:no, epilogue:no
+40107b: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401080: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401085: /home/osandov/src/elfutils/tests/main.cc:10:33: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40108a: /home/osandov/src/elfutils/tests/main.cc:10:19: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+40108c: /home/osandov/src/elfutils/tests/main.cc:10:33: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401091: /home/osandov/src/elfutils/tests/main.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401095: /home/osandov/src/elfutils/tests/main.cc:10:22: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401097: /home/osandov/src/elfutils/tests/main.cc:11:1: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+401099: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:no, bb:no, prologue:no, epilogue:no
+4010a0: /home/osandov/src/elfutils/tests/foobar.h:24:12: is_stmt:no, end_seq:yes, bb:no, prologue:no, epilogue:no
+EOF
+
 exit 0
diff --git a/tests/run-srcfiles-self.sh b/tests/run-srcfiles-self.sh
index 0e64dd2b..515cc47a 100755
--- a/tests/run-srcfiles-self.sh
+++ b/tests/run-srcfiles-self.sh
@@ -1,4 +1,4 @@
-#! /bin/sh
+#! /usr/bin/env bash
 # Copyright (C) 2023 Red Hat, Inc.
 # This file is part of elfutils.
 #
@@ -15,7 +15,13 @@
 # You should have received a copy of the GNU General Public License
 # along with this program.  If not, see <http://www.gnu.org/licenses/>.
 
-. $srcdir/test-subr.sh
+. $srcdir/debuginfod-subr.sh
+
+# for test case debugging, uncomment:
+# set -x
+set -e
+base=14000
+get_ports
 
 # Test different command line combinations on the srcfiles binary itself.
 ET_EXEC="${abs_top_builddir}/src/srcfiles"
@@ -26,11 +32,16 @@ SRC_NAME="srcfiles.cxx"
 # Ensure the output contains the expected source file srcfiles.cxx
 testrun $ET_EXEC -e $ET_EXEC | grep $SRC_NAME > /dev/null
 
+# Check if zip option is available (only available if libarchive is available.
+#   Debuginfod optional to fetch source files from debuginfod federation.)
+$ET_EXEC --help | grep -q zip && command -v unzip >/dev/null 2>&1 && zip=true || zip=false
+
 for null_arg in --null ""; do
   for verbose_arg in --verbose ""; do
+    echo "Test with options $null_arg $verbose_arg"
     testrun $ET_EXEC $null_arg $verbose_arg -p $ET_PID > /dev/null
 
-    # Ensure that the output contains srclines.cxx
+    # Ensure that the output contains srcfiles.cxx
     cu_only=$(testrun $ET_EXEC $null_arg $verbose_arg -c -e $ET_EXEC)
     default=$(testrun $ET_EXEC $null_arg $verbose_arg -e $ET_EXEC)
     result1=$(echo "$cu_only" | grep "$SRC_NAME")
@@ -40,9 +51,64 @@ for null_arg in --null ""; do
       exit 1
     fi
 
-    # Ensure that the output with the cu-only option contains less source files
+    # Ensure that the output with the cu-only option contains fewer source files
     if [ $(echo "$cu_only" | wc -m) -gt $(echo "$default" | wc -m) ]; then
       exit 1
     fi
+
+    if $zip; then
+      # Zip option tests
+        testrun $ET_EXEC $verbose_arg -z -e $ET_EXEC > test.zip
+        tempfiles test.zip
+
+        unzip -v test.zip
+        unzip -t test.zip
+
+        # Ensure unzipped srcfiles.cxx and its contents are the same as the original source file
+        unzip -j test.zip "*/$SRC_NAME"
+        diff "$SRC_NAME" $abs_srcdir/../src/$SRC_NAME
+        rm -f test.zip $SRC_NAME
+    fi
   done
 done
+
+# Debuginfod source file downloading test.
+# Start debuginfod server on the elfutils build directory.
+if [ -x ${abs_builddir}/../debuginfod/debuginfod ] && $zip; then
+  LD_LIBRARY_PATH=$ldpath ${abs_builddir}/../debuginfod/debuginfod -vvvv -d debuginfod.sqlite3 -F -p $PORT1 ${abs_top_builddir}/src > debuginfod.log 2>&1 &
+  PID1=$!
+  tempfiles debuginfod.sqlite3 debuginfod.log
+  wait_ready $PORT1 'ready' 1
+  wait_ready $PORT1 'thread_work_total{role="traverse"}' 1
+  wait_ready $PORT1 'thread_work_pending{role="scan"}' 0
+  wait_ready4 $PORT1 'thread_busy{role="scan"}' 0 300 # lots of source files may be slow to index with $db on NFS
+
+  export DEBUGINFOD_URLS="http://localhost:${PORT1}/"
+  export DEBUGINFOD_VERBOSE=1
+  testrun $ET_EXEC -z -b -e $ET_EXEC > test.zip
+  tempfiles test.zip
+
+  unzip -v test.zip
+  unzip -t test.zip
+
+  # Extract the zip.
+  mkdir extracted
+  unzip test.zip -d extracted
+
+  # Ensure that source files for this tool have been archived.
+  source_files="srcfiles.cxx libdwfl.h gelf.h"
+  extracted_files=$(find extracted -type f)
+  for file in $source_files; do
+      echo "$extracted_files" | grep -q "$file" > /dev/null
+  done
+
+  # Compare between the extracted file and the actual source file srcfiles.cxx.
+  extracted_file=$(find extracted -name $SRC_NAME)
+  diff "$extracted_file" $abs_srcdir/../src/$SRC_NAME
+
+  rm -rf extracted
+
+  kill $PID1
+  wait
+  PID1=0
+fi
diff --git a/tests/run-unstrip-test.sh b/tests/run-unstrip-test.sh
index dc7d3a42..8b7143a2 100755
--- a/tests/run-unstrip-test.sh
+++ b/tests/run-unstrip-test.sh
@@ -33,6 +33,14 @@ testrun ${abs_top_builddir}/src/unstrip -o testfile.unstrip $stripped $debugfile
 
 testrun ${abs_top_builddir}/src/elfcmp --hash-inexact $original testfile.unstrip
 
+tempfiles syms-orig syms-testfile
+
+# Check whether relocated symbols changed.
+testrun ${abs_top_builddir}/tests/elf-print-reloc-syms $original > syms-orig
+testrun ${abs_top_builddir}/tests/elf-print-reloc-syms testfile.unstrip > syms-testfile
+
+testrun diff syms-orig syms-testfile
+
 # Also test modifying the file in place.
 
 rm -f testfile.inplace
diff --git a/tests/run-varlocs.sh b/tests/run-varlocs.sh
index cbbcf6c7..4ac5f367 100755
--- a/tests/run-varlocs.sh
+++ b/tests/run-varlocs.sh
@@ -601,4 +601,116 @@ module 'testfile-splitdwarf4-not-split4.debug'
       [4011a0,4011a1) {lit0, stack_value}
 EOF
 
+# See testfile-dwp.source.
+testfiles testfile-dwp-5 testfile-dwp-5.dwp
+testfiles testfile-dwp-4 testfile-dwp-4.dwp
+
+testrun_compare ${abs_builddir}/varlocs -e testfile-dwp-5 << EOF
+module 'testfile-dwp-5'
+[84] CU 'foo.cc'@401190
+  [c6] function 'foo'@4011c0
+    frame_base: {call_frame_cfa {bregx(7,8)}}
+    [e1] parameter 'this'
+      [4011c0,401200) {reg5}
+    [ea] variable 'x'
+      [4011c2,4011d4) {reg0}
+      [4011d4,4011d7) {reg1}
+      [4011d7,4011d9) {breg1(1), stack_value}
+      [4011f1,401200) {reg0}
+  [f9] inlined function 'x_x'@4011cb
+    [104] parameter 'x'
+      [4011cb,4011eb) {reg0}
+      [4011f1,401200) {reg0}
+  [14a] function 'x_x'@401190
+    frame_base: {call_frame_cfa {bregx(7,8)}}
+    [15b] parameter 'x'
+      [401190,4011a1) {reg5}
+      [4011a1,4011bd) {reg0}
+module 'testfile-dwp-5'
+[1fa] CU 'bar.cc'@401200
+  [23c] function 'bar'@401200
+    frame_base: {call_frame_cfa {bregx(7,8)}}
+    [253] parameter 'this'
+      [401200,40121b) {reg5}
+module 'testfile-dwp-5'
+[272] CU 'main.cc'@0
+  [2c7] function 'main'@401020
+    frame_base: {call_frame_cfa {bregx(7,8)}}
+    [2e0] parameter 'argc'
+      [401020,401068) {reg5}
+      [401068,401080) {fbreg(-40)}
+      [401080,401084) {breg5(0)}
+      [401084,401099) {entry_value(1) {reg5}, stack_value}
+      [401099,4010a0) {reg5}
+    [2ec] parameter 'argv'
+      [401020,40104b) {reg4}
+      [40104b,401099) {entry_value(1) {reg4}, stack_value}
+      [401099,4010a0) {reg4}
+    [2f8] variable 'myfoo'
+      [401020,4010a0) {fbreg(-40)}
+    [303] variable 'mybar'
+      [401020,4010a0) {fbreg(-32)}
+  [30d] inlined function 'fibonacci'@401030
+    [31c] parameter 'n'
+      [401030,401060) {reg5}
+      [401099,4010a0) {reg5}
+  [326] inlined function 'fibonacci'
+    [32f] parameter 'n'
+      <no value>
+EOF
+
+testrun_compare ${abs_builddir}/varlocs -e testfile-dwp-4 << EOF
+module 'testfile-dwp-4'
+[b] CU 'foo.cc'@401190
+  [54] function 'foo'@4011c0
+    frame_base: {call_frame_cfa {bregx(7,8)}}
+    [6f] parameter 'this'
+      [4011c0,401200) {reg5}
+    [78] variable 'x'
+      [4011c2,4011d4) {reg0}
+      [4011d4,4011d7) {reg1}
+      [4011d7,4011d9) {breg1(1), stack_value}
+      [4011f1,401200) {reg0}
+  [8a] inlined function 'x_x'@4011cb
+    [98] parameter 'x'
+      [4011cb,4011eb) {reg0}
+      [4011f1,401200) {reg0}
+  [e7] function 'x_x'@401190
+    frame_base: {call_frame_cfa {bregx(7,8)}}
+    [f8] parameter 'x'
+      [401190,4011a1) {reg5}
+      [4011a1,4011bd) {reg0}
+module 'testfile-dwp-4'
+[129] CU 'bar.cc'@401200
+  [172] function 'bar'@401200
+    frame_base: {call_frame_cfa {bregx(7,8)}}
+    [189] parameter 'this'
+      [401200,40121b) {reg5}
+module 'testfile-dwp-4'
+[19f] CU 'main.cc'@0
+  [1fd] function 'main'@401020
+    frame_base: {call_frame_cfa {bregx(7,8)}}
+    [216] parameter 'argc'
+      [401020,401068) {reg5}
+      [401068,401080) {fbreg(-40)}
+      [401080,401084) {breg5(0)}
+      [401084,401097) {GNU_entry_value(1) {reg5}, stack_value}
+      [401099,4010a0) {reg5}
+    [228] parameter 'argv'
+      [401020,40104b) {reg4}
+      [40104b,401099) {GNU_entry_value(1) {reg4}, stack_value}
+      [401099,4010a0) {reg4}
+    [23a] variable 'myfoo'
+      [401020,4010a0) {fbreg(-40)}
+    [247] variable 'mybar'
+      [401020,4010a0) {fbreg(-32)}
+  [253] inlined function 'fibonacci'@401030
+    [265] parameter 'n'
+      [401030,401060) {reg5}
+      [401099,4010a0) {reg5}
+  [272] inlined function 'fibonacci'
+    [27e] parameter 'n'
+      <no value>
+EOF
+
 exit 0
diff --git a/tests/show-die-info.c b/tests/show-die-info.c
index 1a3191cd..bda459a5 100644
--- a/tests/show-die-info.c
+++ b/tests/show-die-info.c
@@ -27,6 +27,7 @@
 #include <unistd.h>
 
 #include "../libdw/known-dwarf.h"
+#include "../lib/system.h"
 
 static const char *
 dwarf_tag_string (unsigned int tag)
@@ -318,7 +319,7 @@ main (int argc, char *argv[])
       int fd = open (argv[cnt], O_RDONLY);
       Dwarf *dbg;
 
-      printf ("file: %s\n", basename (argv[cnt]));
+      printf ("file: %s\n", xbasename (argv[cnt]));
 
       dbg = dwarf_begin (fd, DWARF_C_READ);
       if (dbg == NULL)
diff --git a/tests/test-ar-duplicates.a.bz2 b/tests/test-ar-duplicates.a.bz2
new file mode 100644
index 00000000..e8168c6b
Binary files /dev/null and b/tests/test-ar-duplicates.a.bz2 differ
diff --git a/tests/testcore-noncontig.bz2 b/tests/testcore-noncontig.bz2
new file mode 100644
index 00000000..514ad010
Binary files /dev/null and b/tests/testcore-noncontig.bz2 differ
diff --git a/tests/testfile-dwarf5-line-clang.bz2 b/tests/testfile-dwarf5-line-clang.bz2
new file mode 100755
index 00000000..bdd66e96
Binary files /dev/null and b/tests/testfile-dwarf5-line-clang.bz2 differ
diff --git a/tests/testfile-dwp-4-cu-index-overflow.bz2 b/tests/testfile-dwp-4-cu-index-overflow.bz2
new file mode 100755
index 00000000..2aaa4f40
Binary files /dev/null and b/tests/testfile-dwp-4-cu-index-overflow.bz2 differ
diff --git a/tests/testfile-dwp-4-cu-index-overflow.dwp.bz2 b/tests/testfile-dwp-4-cu-index-overflow.dwp.bz2
new file mode 100644
index 00000000..0718c1b2
Binary files /dev/null and b/tests/testfile-dwp-4-cu-index-overflow.dwp.bz2 differ
diff --git a/tests/testfile-dwp-4-strict.bz2 b/tests/testfile-dwp-4-strict.bz2
new file mode 100755
index 00000000..4f419c07
Binary files /dev/null and b/tests/testfile-dwp-4-strict.bz2 differ
diff --git a/tests/testfile-dwp-4-strict.dwp.bz2 b/tests/testfile-dwp-4-strict.dwp.bz2
new file mode 100644
index 00000000..8cc1bbe2
Binary files /dev/null and b/tests/testfile-dwp-4-strict.dwp.bz2 differ
diff --git a/tests/testfile-dwp-4.bz2 b/tests/testfile-dwp-4.bz2
new file mode 100755
index 00000000..ece5817b
Binary files /dev/null and b/tests/testfile-dwp-4.bz2 differ
diff --git a/tests/testfile-dwp-4.dwp.bz2 b/tests/testfile-dwp-4.dwp.bz2
new file mode 100644
index 00000000..1a63b42d
Binary files /dev/null and b/tests/testfile-dwp-4.dwp.bz2 differ
diff --git a/tests/testfile-dwp-5-cu-index-overflow.bz2 b/tests/testfile-dwp-5-cu-index-overflow.bz2
new file mode 100755
index 00000000..07185fe5
Binary files /dev/null and b/tests/testfile-dwp-5-cu-index-overflow.bz2 differ
diff --git a/tests/testfile-dwp-5-cu-index-overflow.dwp.bz2 b/tests/testfile-dwp-5-cu-index-overflow.dwp.bz2
new file mode 100644
index 00000000..dce34e3f
Binary files /dev/null and b/tests/testfile-dwp-5-cu-index-overflow.dwp.bz2 differ
diff --git a/tests/testfile-dwp-5.bz2 b/tests/testfile-dwp-5.bz2
new file mode 100755
index 00000000..2c768eac
Binary files /dev/null and b/tests/testfile-dwp-5.bz2 differ
diff --git a/tests/testfile-dwp-5.dwp.bz2 b/tests/testfile-dwp-5.dwp.bz2
new file mode 100644
index 00000000..ba28e501
Binary files /dev/null and b/tests/testfile-dwp-5.dwp.bz2 differ
diff --git a/tests/testfile-dwp-cu-index-overflow.source b/tests/testfile-dwp-cu-index-overflow.source
new file mode 100644
index 00000000..2de15441
--- /dev/null
+++ b/tests/testfile-dwp-cu-index-overflow.source
@@ -0,0 +1,86 @@
+# Dummy program that we patch to generate a dwp file with more than 4GB of
+# .debug_info.
+
+# Generate 2 dummy files that result in DWARF blocks.
+$ for (( i = 1; i <= 2; i++ )); do echo 'constexpr int filler'$i'[] = { 1 };' > filler$i.cc; done
+$ g++ -O2 -g -gsplit-dwarf -fdebug-types-section -dA -S filler{1,2}.cc foo.cc bar.cc main.cc
+# Patch the DWARF blocks to be 2GB.
+$ for (( i = 1; i <= 2; i++ )); do patch -p1 << EOF
+--- a/filler$i.s
++++ b/filler$i.s
+@@ -7,5 +7,5 @@
+ 	.section	.debug_info.dwo,"e",@progbits
+ .Ldebug_info0:
+-	.long	0x49	# Length of Compilation Unit Info
++	.long	0x80000048	# Length of Compilation Unit Info
+ 	.value	0x5	# DWARF version number
+ 	.byte	0x5	# DW_UT_split_compile
+@@ -51,9 +51,6 @@
+ 	.long	0x29	# DW_AT_type
+ 			# DW_AT_const_expr
+-	.byte	0x4	# DW_AT_const_value
+-	.byte	0x1	# fp or vector constant word 0
+-	.byte	0	# fp or vector constant word 1
+-	.byte	0	# fp or vector constant word 2
+-	.byte	0	# fp or vector constant word 3
++	.long	0x80000000	# DW_AT_const_value
++	.fill	0x80000000
+ 	.byte	0	# end of children of DIE 0x14
+ 	.section	.debug_info,"",@progbits
+@@ -171,5 +168,5 @@
+ 	.uleb128 0x19	# (DW_FORM_flag_present)
+ 	.uleb128 0x1c	# (DW_AT_const_value)
+-	.uleb128 0xa	# (DW_FORM_block1)
++	.uleb128 0x4	# (DW_FORM_block4)
+ 	.byte	0
+ 	.byte	0
+EOF
+done
+$ for (( i = 1; i <= 2; i++ )); do as filler$i.s -o filler$i.o; done
+$ as foo.s -o foo.o
+$ as bar.s -o bar.o
+$ as main.s -o main.o
+$ g++ filler1.o foo.o filler2.o bar.o main.o -o testfile-dwp-5-cu-index-overflow
+# -continue-on-cu-index-overflow was added in LLVM 17:
+# https://reviews.llvm.org/D144565.
+$ llvm-dwp -continue-on-cu-index-overflow filler1.o foo.o filler2.o bar.o main.o -o testfile-dwp-5-cu-index-overflow.dwp
+
+# Same thing for DWARF 4.
+$ g++ -O2 -g -gdwarf-4 -gsplit-dwarf -fdebug-types-section -dA -S filler{1,2}.cc foo.cc bar.cc main.cc
+$ for (( i = 1; i <= 2; i++ )); do patch -p1 << EOF
+--- a/filler$i.s
++++ b/filler$i.s
+@@ -6,5 +6,5 @@
+ 	.section	.debug_info.dwo,"e",@progbits
+ .Ldebug_info0:
+-	.long	0x48	# Length of Compilation Unit Info
++	.long	0x80000047	# Length of Compilation Unit Info
+ 	.value	0x4	# DWARF version number
+ 	.long	.Ldebug_abbrev0	# Offset Into Abbrev. Section
+@@ -49,9 +49,6 @@
+ 	.long	0x28	# DW_AT_type
+ 			# DW_AT_const_expr
+-	.byte	0x4	# DW_AT_const_value
+-	.byte	0x1	# fp or vector constant word 0
+-	.byte	0	# fp or vector constant word 1
+-	.byte	0	# fp or vector constant word 2
+-	.byte	0	# fp or vector constant word 3
++	.long	0x80000000	# DW_AT_const_value
++	.fill	0x80000000
+ 	.byte	0	# end of children of DIE 0xb
+ 	.section	.debug_info,"",@progbits
+@@ -172,5 +169,5 @@
+ 	.uleb128 0x19	# (DW_FORM_flag_present)
+ 	.uleb128 0x1c	# (DW_AT_const_value)
+-	.uleb128 0xa	# (DW_FORM_block1)
++	.uleb128 0x4	# (DW_FORM_block4)
+ 	.byte	0
+ 	.byte	0
+EOF
+done
+$ for (( i = 1; i <= 2; i++ )); do as filler$i.s -o filler$i.o; done
+$ as foo.s -o foo.o
+$ as bar.s -o bar.o
+$ as main.s -o main.o
+$ g++ filler1.o foo.o filler2.o bar.o main.o -o testfile-dwp-4-cu-index-overflow
+$ llvm-dwp -continue-on-cu-index-overflow filler1.o foo.o filler2.o bar.o main.o -o testfile-dwp-4-cu-index-overflow.dwp
diff --git a/tests/testfile-dwp.source b/tests/testfile-dwp.source
new file mode 100644
index 00000000..b0b0a97c
--- /dev/null
+++ b/tests/testfile-dwp.source
@@ -0,0 +1,102 @@
+# Nonsensical program used to generate example DWARF package files with type
+# units, location lists, range lists, and macros.
+
+# = foobar.h =
+
+struct Foo
+{
+  int a, b;
+  int foo ();
+};
+
+struct Bar
+{
+  long a, b;
+  long bar ();
+};
+
+#define FROB(x) ((x) ^ 0x2a2a2a2a)
+#define FRY(x) ((x) * 0x100000001b3)
+
+inline long
+fibonacci (unsigned int n)
+{
+  if (n == 0)
+    return 0;
+  else
+    {
+      long a = 0;
+      long b = 1;
+      for (unsigned int i = 2; i < n; i++)
+	{
+	  long tmp = a + b;
+	  a = b;
+	  b = tmp;
+	}
+      return b;
+    }
+}
+
+# = foo.cc =
+
+#include "foobar.h"
+
+#define ZERO() (1 - 1)
+
+int
+x_x (int x)
+{
+  for (int i = x; i > ZERO(); i--)
+    x *= x;
+  return x;
+}
+
+int
+Foo::foo ()
+{
+  int x = a;
+  if (a > b)
+    x -= b;
+  return FROB (x_x (x));
+}
+
+# = bar.cc =
+
+#include "foobar.h"
+
+#define ONE 1
+
+long
+Bar::bar ()
+{
+  if (a == b)
+    return ONE;
+  else
+    return a > b ? b : a;
+}
+
+# = main.cc =
+
+#include "foobar.h"
+
+#define MAIN_ARGS int argc, char **argv
+
+int
+main(MAIN_ARGS)
+{
+  struct Foo myfoo { argc, FROB (argc) };
+  struct Bar mybar { fibonacci (argc), FRY (argc) };
+  return myfoo.foo() + mybar.bar();
+}
+
+# Built with GCC at commit 80048aa13a6b ("debug/111409 - don't generate COMDAT
+# macro sections for split DWARF").
+$ g++ -gdwarf-5 -gsplit-dwarf -fdebug-types-section -g3 -O2 foo.cc bar.cc main.cc -o testfile-dwp-5
+# GNU dwp as of binutils 2.41 only supports DWARF 4.
+$ llvm-dwp -e testfile-dwp-5 -o testfile-dwp-5.dwp
+
+$ g++ -gdwarf-4 -gsplit-dwarf -fdebug-types-section -g3 -O2 foo.cc bar.cc main.cc -o testfile-dwp-4
+$ dwp -e testfile-dwp-4
+
+$ g++ -gdwarf-4 -gstrict-dwarf -gsplit-dwarf -fdebug-types-section -g3 -O2 foo.cc bar.cc main.cc -o testfile-dwp-4-strict
+$ dwp -e testfile-dwp-4-strict
diff --git a/tests/varlocs.c b/tests/varlocs.c
index 8e563fd3..1004f969 100644
--- a/tests/varlocs.c
+++ b/tests/varlocs.c
@@ -1120,7 +1120,7 @@ main (int argc, char *argv[])
 
 	  const char *name = (modname[0] != '\0'
 			      ? modname
-			      :  basename (mainfile));
+			      :  xbasename (mainfile));
 	  printf ("module '%s'\n", name);
 	  print_die (&cudie, "CU", 0);
 
diff --git a/version.h b/version.h
index f3e0b00b..bf14d61f 100644
--- a/version.h
+++ b/version.h
@@ -30,7 +30,7 @@
 #ifndef _ELFUTILS_VERSION_H
 #define _ELFUTILS_VERSION_H	1
 
-#define _ELFUTILS_VERSION	190
+#define _ELFUTILS_VERSION	191
 
 #define _ELFUTILS_PREREQ(major, minor) \
   (_ELFUTILS_VERSION >= ((major) * 1000 + (minor)))
```

