```diff
diff --git a/Android.bp b/Android.bp
index 6d99c5a..96beb97 100644
--- a/Android.bp
+++ b/Android.bp
@@ -1,36 +1 @@
-// This file is generated by cargo_embargo.
-// Do not modify this file after the first "rust_*" or "genrule" module
-// because the changes will be overridden on upgrade.
-// Content before the first "rust_*" or "genrule" module is preserved.
-
-rust_library_rlib {
-    name: "libsmccc",
-    crate_name: "smccc",
-    cargo_env_compat: true,
-    cargo_pkg_version: "0.1.1",
-    crate_root: "src/lib.rs",
-    edition: "2021",
-    apex_available: [
-        "//apex_available:platform",
-        "//apex_available:anyapex",
-    ],
-    prefer_rlib: true,
-    no_stdlibs: true,
-    stdlibs: [
-        "libcompiler_builtins.rust_sysroot",
-        "libcore.rust_sysroot",
-    ],
-    product_available: true,
-    vendor_available: true,
-}
-
-rust_test {
-    name: "smccc_test_src_lib",
-    crate_name: "smccc",
-    cargo_env_compat: true,
-    cargo_pkg_version: "0.1.1",
-    crate_root: "src/lib.rs",
-    test_suites: ["general-tests"],
-    auto_gen_config: true,
-    edition: "2021",
-}
+// This crate has been migrated to external/rust/android-crates-io.
diff --git a/cargo_embargo.json b/cargo_embargo.json
index e3c9cb8..77c1e14 100644
--- a/cargo_embargo.json
+++ b/cargo_embargo.json
@@ -7,5 +7,6 @@
     }
   },
   "run_cargo": false,
-  "tests": true
+  "tests": true,
+  "generate_rulesmk": true
 }
diff --git a/rules.mk b/rules.mk
new file mode 100644
index 0000000..cc22918
--- /dev/null
+++ b/rules.mk
@@ -0,0 +1,17 @@
+# This file is generated by cargo_embargo.
+# Do not modify this file after the LOCAL_DIR line
+# because the changes will be overridden on upgrade.
+# Content before the first line starting with LOCAL_DIR is preserved.
+// DO NOT SUBMIT: Add license before submitting.
+LOCAL_DIR := $(GET_LOCAL_DIR)
+MODULE := $(LOCAL_DIR)
+MODULE_CRATE_NAME := smccc
+MODULE_RUST_CRATE_TYPES := rlib
+MODULE_SRCS := $(LOCAL_DIR)/src/lib.rs
+MODULE_ADD_IMPLICIT_DEPS := false
+MODULE_RUST_EDITION := 2021
+MODULE_LIBRARY_DEPS := \
+	trusty/user/base/lib/libcompiler_builtins-rust \
+	trusty/user/base/lib/libcore-rust
+
+include make/library.mk
```

