```diff
diff --git a/.github/issue_template.md b/.github/issue_template.md
new file mode 100644
index 000000000..aa87fb1f8
--- /dev/null
+++ b/.github/issue_template.md
@@ -0,0 +1,7 @@
+Issues are *not* support forum.
+
+Bugs in the distro/kernel should be reported to your Linux distribution.
+You should report there: kernel, libc, distribution and LTP version.
+Also relevant logs (dmesg, test output).
+
+Issues are *only* for reporting bugs in tests.
diff --git a/.github/workflows/ci.yml b/.github/workflows/ci-docker-build.yml
similarity index 97%
rename from .github/workflows/ci.yml
rename to .github/workflows/ci-docker-build.yml
index a632ed96b..322c06efa 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci-docker-build.yml
@@ -1,6 +1,6 @@
-# Copyright (c) 2021-2023 Petr Vorel <pvorel@suse.cz>
+# Copyright (c) 2021-2024 Petr Vorel <pvorel@suse.cz>
 
-name: "CI: docker based builds"
+name: "Test building in various distros in Docker"
 on: [push, pull_request]
 
 permissions:
diff --git a/.github/workflows/ci-sphinx-doc.yml b/.github/workflows/ci-sphinx-doc.yml
new file mode 100644
index 000000000..9b1f4f34f
--- /dev/null
+++ b/.github/workflows/ci-sphinx-doc.yml
@@ -0,0 +1,39 @@
+# SPDX-License-Identifier: GPL-2.0-or-later
+# Copyright (c) 2024 Petr Vorel <pvorel@suse.cz>
+
+name: "Test building sphinx doc"
+
+on:
+  push:
+    paths: ['doc/**']
+  pull_request:
+    paths: ['doc/**']
+
+permissions: {}
+
+jobs:
+  sphinx:
+    runs-on: ubuntu-latest
+    steps:
+      - name: Checkout LTP
+        uses: actions/checkout@v2
+        with:
+          path: ltp
+
+      - name: Install sphinx
+        run: |
+          sudo apt update
+          sudo apt install python3-sphinx python3-virtualenv
+
+      - name: Install sphinx dependencies
+        run: |
+          cd "$GITHUB_WORKSPACE/ltp/doc/"
+          python3 -m virtualenv .venv
+          . .venv/bin/activate
+          pip install -r requirements.txt
+
+      - name: Build doc
+        run: |
+          cd "$GITHUB_WORKSPACE/ltp/doc/"
+          . .venv/bin/activate
+          make
diff --git a/.github/workflows/wiki-mirror.yml b/.github/workflows/wiki-mirror.yml
deleted file mode 100644
index a62ca676c..000000000
--- a/.github/workflows/wiki-mirror.yml
+++ /dev/null
@@ -1,47 +0,0 @@
-# SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) Linux Test Project, 2021
-
-name: "Mirror doc to wiki"
-
-on:
-  push:
-    branches:
-      - master
-
-permissions: {}
-jobs:
-  mirror:
-    permissions:
-      contents: write # for git push
-
-    runs-on: ubuntu-latest
-    if: ${{ github.repository == 'linux-test-project/ltp' }}
-    steps:
-      - name: Checkout LTP
-        uses: actions/checkout@v2
-        with:
-          path: ltp
-
-      - name: Checkout LTP wiki
-        uses: actions/checkout@v2
-        with:
-          repository: "linux-test-project/ltp.wiki"
-          path: ltp.wiki
-
-      - name: Copy files, push
-        run: |
-          git config --global user.email "actions@github.com"
-          git config --global user.name "Wiki mirror"
-
-          dir="$GITHUB_WORKSPACE/ltp/doc/"
-          cd $dir
-          commit=$(git log --pretty=format:"%h (\"%s\")" -1 .)
-
-          cd $GITHUB_WORKSPACE/ltp.wiki
-          # don't forget to add new extensions
-          cp -v $dir/*.asciidoc .
-          git add .
-
-          # only commit if there are changes
-          git diff-index --quiet HEAD -- || git commit -m "Update to $commit" .
-          git push
diff --git a/.readthedocs.yml b/.readthedocs.yml
new file mode 100644
index 000000000..28e8c88a5
--- /dev/null
+++ b/.readthedocs.yml
@@ -0,0 +1,18 @@
+version: 2
+
+build:
+  os: "ubuntu-22.04"
+  tools:
+    python: "3.6"
+  apt_packages:
+    - enchant-2
+    - hunspell-en-us
+
+# Build from the doc/ directory with Sphinx
+sphinx:
+  configuration: doc/conf.py
+
+# Explicitly set the version of Python and its requirements
+python:
+  install:
+    - requirements: doc/requirements.txt
diff --git a/Android.bp b/Android.bp
index 17409e61f..c389e1868 100644
--- a/Android.bp
+++ b/Android.bp
@@ -111,6 +111,9 @@ genrule {
 cc_defaults {
     name: "ltp_defaults",
 
+    // Upstream explicitly chooses this in its makefile.
+    c_std: "gnu99",
+
     cflags: [
         // Hacks for bionic compatibility
         "-include bionic-compat.h",
@@ -184,5 +187,5 @@ cc_defaults {
     gtest: false,
     cflags: ["-Wno-gnu-variable-sized-type-not-at-end"],
     no_named_install_directory: true,
-    relative_install_path: "ltp/testcases/bin",
+    relative_install_path: "vts_ltp_tests/testcases/bin",
 }
diff --git a/Makefile b/Makefile
index 53f94d9f7..d7d2815f1 100644
--- a/Makefile
+++ b/Makefile
@@ -1,5 +1,5 @@
 # SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) Linux Test Project, 2009-2022
+# Copyright (c) Linux Test Project, 2009-2024
 # Copyright (c) Cisco Systems Inc., 2009-2010
 # Ngie Cooper, July 2009
 
@@ -13,7 +13,6 @@ top_srcdir		?= $(CURDIR)
 
 include $(top_srcdir)/include/mk/env_pre.mk
 include $(top_srcdir)/include/mk/automake.mk
-include $(top_srcdir)/include/mk/gitignore.mk
 
 .SUFFIXES:
 .SUFFIXES: .am .default .h .in .m4 .mk
@@ -25,10 +24,6 @@ vpath %.in		$(top_srcdir)/include
 vpath %.m4		$(top_srcdir)/m4
 vpath %.mk		$(top_srcdir)/mk:$(top_srcdir)/mk/include
 
-# User wants uclinux binaries?
-UCLINUX			?= 0
-export UCLINUX
-
 # CLEAN_TARGETS:	Targets which exist solely in clean.
 # COMMON_TARGETS:	Targets which exist in all, clean, and install.
 # INSTALL_TARGETS:	Targets which exist in clean and install (contains
@@ -36,11 +31,7 @@ export UCLINUX
 # BOOTSTRAP_TARGETS:	Directories required to bootstrap out-of-build-tree
 # 			support.
 
-# We're not using uclinux based targets (default).
-ifneq ($(UCLINUX),1)
 COMMON_TARGETS		:= pan utils
-INSTALL_TARGETS		:= doc
-endif
 
 define target_to_dir_dep_mapping
 ifeq ($$(filter %-clean,$(1)),) # not *-clean
@@ -178,6 +169,9 @@ INSTALL_TARGETS		+= $(addprefix $(DESTDIR)/$(bindir)/,$(BINDIR_INSTALL_SCRIPTS))
 
 $(INSTALL_TARGETS): $(INSTALL_DIR) $(DESTDIR)/$(bindir)
 
+.PHONY: doc
+doc: metadata-all
+
 .PHONY: check
 check: $(CHECK_TARGETS)
 
@@ -209,7 +203,7 @@ endif
 	$(call _test,-s)
 
 test-metadata: metadata-all
-	$(MAKE) -C $(abs_srcdir)/metadata/ test
+	$(MAKE) -C $(abs_srcdir)/metadata test
 
 ## Help
 .PHONY: help
diff --git a/README.md b/README.md
deleted file mode 100644
index 6147c5f6f..000000000
--- a/README.md
+++ /dev/null
@@ -1,251 +0,0 @@
-Linux Test Project
-==================
-
-Linux Test Project is a joint project started by SGI, OSDL and Bull developed
-and maintained by IBM, Cisco, Fujitsu, SUSE, Red Hat, Oracle and others. The
-project goal is to deliver tests to the open source community that validate the
-reliability, robustness, and stability of Linux.
-
-The LTP testsuite contains a collection of tools for testing the Linux kernel
-and related features. Our goal is to improve the Linux kernel and system
-libraries by bringing test automation to the testing effort. Interested open
-source contributors are encouraged to join.
-
-Project pages are located at: http://linux-test-project.github.io/
-
-The latest image is always available at:
-https://github.com/linux-test-project/ltp/releases
-
-The discussion about the project happens at LTP mailing list:
-http://lists.linux.it/listinfo/ltp
-
-LTP mailing list is archived at:
-https://lore.kernel.org/ltp/
-
-IRC #ltp at: [irc.libera.chat](https://libera.chat/)
-
-The git repository is located at GitHub at:
-https://github.com/linux-test-project/ltp
-
-The patchwork instance is at:
-https://patchwork.ozlabs.org/project/ltp/list/
-
-Warning!
-========
-
-**Be careful with these tests!**
-
-Don't run them on production systems. Growfiles, doio, and iogen in particular
-stress the I/O capabilities of systems and while they should not cause problems
-on properly functioning systems, they are intended to find (or cause) problems.
-
-Quick guide to running the tests
-================================
-
-If you have git, autoconf, automake, m4, pkgconf / pkg-config, libc headers,
-linux kernel headers and other common development packages installed (see
-INSTALL and ci/*.sh), the chances are the following will work:
-
-```
-$ git clone https://github.com/linux-test-project/ltp.git
-$ cd ltp
-$ make autotools
-$ ./configure
-```
-
-Now you can continue either with compiling and running a single test or with
-compiling and installing the whole testsuite.
-
-For optional library dependencies look into scripts for major distros in
-`ci/` directory. You can also build whole LTP with `./build.sh` script.
-
-Shortcut to running a single test
----------------------------------
-If you need to execute a single test you actually do not need to compile
-the whole LTP, if you want to run a syscall testcase following should work.
-
-```
-$ cd testcases/kernel/syscalls/foo
-$ make
-$ PATH=$PATH:$PWD ./foo01
-```
-
-Shell testcases are a bit more complicated since these need a path to a shell
-library as well as to compiled binary helpers, but generally following should
-work.
-
-```
-$ cd testcases/lib
-$ make
-$ cd ../commands/foo
-$ PATH=$PATH:$PWD:$PWD/../../lib/ ./foo01.sh
-```
-
-Open Posix Testsuite has it's own build system which needs Makefiles to be
-generated first, then compilation should work in subdirectories as well.
-
-```
-$ cd testcases/open_posix_testsuite/
-$ make generate-makefiles
-$ cd conformance/interfaces/foo
-$ make
-$ ./foo_1-1.run-test
-```
-
-Compiling and installing all testcases
---------------------------------------
-
-```
-$ make
-$ make install
-```
-
-This will install LTP to `/opt/ltp`.
-* If you have a problem see `INSTALL` and `./configure --help`.
-* Failing that, ask for help on the mailing list or Github.
-
-Some tests will be disabled if the configure script can not find their build
-dependencies.
-
-* If a test returns `TCONF` due to a missing component, check the `./configure`
-  output.
-* If a tests fails due to a missing user or group, see the Quick Start section
-  of `INSTALL`.
-
-Running tests
--------------
-
-To run all the test suites
-
-```
-$ cd /opt/ltp
-$ ./runltp
-```
-
-Note that many test cases have to be executed as root.
-
-To run a particular test suite
-
-```
-$ ./runltp -f syscalls
-```
-
-To run all tests with `madvise` in the name
-
-```
-$ ./runltp -f syscalls -s madvise
-```
-Also see
-
-```
-$ ./runltp --help
-```
-
-Test suites (e.g. syscalls) are defined in the runtest directory. Each file
-contains a list of test cases in a simple format, see doc/ltp-run-files.txt.
-
-Each test case has its own executable or script, these can be executed
-directly
-
-```
-$ testcases/bin/abort01
-```
-
-Some have arguments
-
-```
-$ testcases/bin/mesgq_nstest -m none
-```
-
-The vast majority of test cases accept the -h (help) switch
-
-```
-$ testcases/bin/ioctl01 -h
-```
-
-Many require certain environment variables to be set
-
-```
-$ LTPROOT=/opt/ltp PATH="$PATH:$LTPROOT/testcases/bin" testcases/bin/wc01.sh
-```
-
-Most commonly, the path variable needs to be set and also `LTPROOT`, but there
-are a number of other variables, `runltp` usually sets these for you.
-
-Note that all shell scripts need the `PATH` to be set. However this is not
-limited to shell scripts, many C based tests need environment variables as
-well.
-
-For more info see `doc/User-Guidelines.asciidoc` or online at
-https://github.com/linux-test-project/ltp/wiki/User-Guidelines.
-
-Network tests
--------------
-Network tests require certain setup, described in `testcases/network/README.md`
-(online at https://github.com/linux-test-project/ltp/tree/master/testcases/network).
-
-Containers
-----------
-
-*Presently running the LTP inside a container is not a shortcut. It
-will make things much harder for you.*
-
-There is a Containerfile which can be used with Docker or
-Podman. Currently it can build Alpine and OpenSUSE images.
-
-The container can be built with a command like:
-
-```
-$ podman build -t tumbleweed/ltp \
-       --build-arg PREFIX=registry.opensuse.org/opensuse/ \
-       --build-arg DISTRO_NAME=tumbleweed \
-       --build-arg DISTRO_RELEASE=20230925 .
-```
-
-Or just `podman build .` which will create an Alpine container.
-
-It contains Kirk in /opt/kirk. So the following will run some tests.
-
-```
-$ podman run -it --rm tumbleweed/ltp:latest
-$ cd /opt/kirk && ./kirk -f ltp -r syscalls
-```
-
-SUSE also publishes a
-[smaller LTP container](https://registry.opensuse.org/cgi-bin/cooverview?srch_term=project%3D%5Ebenchmark+container%3D.*)
-that is not based on the Containerfile.
-
-Debugging with gdb
-==================
-
-The new test library runs the actual test, i.e. the `test()` function in a
-forked process. To get stack trace of a crashing test in gdb it's needed to
-[`set follow-fork-mode child`](https://ftp.gnu.org/old-gnu/Manuals/gdb/html_node/gdb_25.html).
-
-Developers corner
-=================
-
-Before you start you should read following documents:
-
-* `doc/Test-Writing-Guidelines.asciidoc`
-* `doc/Build-System.asciidoc`
-* `doc/LTP-Library-API-Writing-Guidelines.asciidoc`
-
-There is also a step-by-step tutorial:
-
-* `doc/C-Test-Case-Tutorial.asciidoc`
-
-If something is not covered there don't hesitate to ask on the LTP mailing
-list. Also note that these documents are available online at:
-
-* https://github.com/linux-test-project/ltp/wiki/Test-Writing-Guidelines
-* https://github.com/linux-test-project/ltp/wiki/LTP-Library-API-Writing-Guidelines
-* https://github.com/linux-test-project/ltp/wiki/Build-System
-* https://github.com/linux-test-project/ltp/wiki/C-Test-Case-Tutorial
-
-Although we accept GitHub pull requests, the preferred way is sending patches to our mailing list.
-
-It's a good idea to test patches on GitHub Actions before posting to mailing
-list. Our GitHub Actions setup covers various architectures and distributions in
-order to make sure LTP compiles cleanly on most common configurations.
-For testing you need to just push your changes to your own LTP fork on GitHub.
diff --git a/README.rst b/README.rst
new file mode 100644
index 000000000..3e176bd0b
--- /dev/null
+++ b/README.rst
@@ -0,0 +1,29 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Linux Test Project
+==================
+
+Linux Test Project is a joint project started by SGI, OSDL and Bull developed
+and maintained by SUSE, Red Hat, Fujitsu, IBM, Cisco, Oracle and others. The
+project goal is to deliver tests to the open source community that validate
+reliability, robustness, and stability of the Linux Kernel.
+
+The testing suites contain a collection of tools for testing the Linux kernel
+and related features. Our goal is to improve the Linux kernel and system
+libraries by bringing test automation.
+
+.. warning::
+
+   LTP tests shouldn't run in production systems. In particular,
+   growfiles, doio, and iogen, stress the I/O capabilities of the systems and
+   they are intended to find (or cause) problems.
+
+Some references:
+
+* `Documentation <http://linux-test-project.rtfd.io/>`_
+* `Source code <https://github.com/linux-test-project/ltp>`_
+* `Releases <https://github.com/linux-test-project/ltp/releases>`_
+* `Mailing List <http://lists.linux.it/listinfo/ltp>`_
+* `Working patches (patchwork) <https://patchwork.ozlabs.org/project/ltp/list/>`_
+* `Working patches (lore.kernel.org) <https://lore.kernel.org/ltp>`_
+* `#ltp @ libera chat <https://libera.chat/>`_
diff --git a/VERSION b/VERSION
index 5c916bb2a..660b1b67a 100644
--- a/VERSION
+++ b/VERSION
@@ -1 +1 @@
-20240129
+20240524
diff --git a/android/Android.bp b/android/Android.bp
index a8fb305d1..bc60e91e4 100644
--- a/android/Android.bp
+++ b/android/Android.bp
@@ -17,2726 +17,2888 @@ package {
     default_applicable_licenses: ["external_ltp_license"],
 }
 
+LTP_TESTS = [
+    ":ltp_runtests",
+    ":ltp_abort01",
+    ":ltp_abs01",
+    ":ltp_accept01",
+    ":ltp_accept02",
+    ":ltp_accept03",
+    ":ltp_accept4_01",
+    ":ltp_access01",
+    ":ltp_access02",
+    ":ltp_access03",
+    ":ltp_access04",
+    ":ltp_acct01",
+    ":ltp_acct02",
+    ":ltp_acct02_helper",
+    ":ltp_acl1",
+    ":ltp_add_key01",
+    ":ltp_add_key02",
+    ":ltp_add_key03",
+    ":ltp_add_key04",
+    ":ltp_add_key05",
+    ":ltp_adjtimex01",
+    ":ltp_adjtimex02",
+    ":ltp_adjtimex03",
+    ":ltp_af_alg01",
+    ":ltp_af_alg03",
+    ":ltp_af_alg04",
+    ":ltp_af_alg05",
+    ":ltp_af_alg06",
+    ":ltp_af_alg07",
+    ":ltp_aio-stress",
+    ":ltp_aio01",
+    ":ltp_aio02",
+    ":ltp_aiocp",
+    ":ltp_aiodio_append",
+    ":ltp_aiodio_sparse",
+    ":ltp_alarm02",
+    ":ltp_alarm03",
+    ":ltp_alarm05",
+    ":ltp_alarm06",
+    ":ltp_alarm07",
+    ":ltp_arch_prctl01",
+    ":ltp_asapi_01",
+    ":ltp_asapi_02",
+    ":ltp_asapi_03",
+    ":ltp_aslr01",
+    ":ltp_atof01",
+    ":ltp_autogroup01",
+    ":ltp_bind01",
+    ":ltp_bind02",
+    ":ltp_bind03",
+    ":ltp_bind04",
+    ":ltp_bind05",
+    ":ltp_bind06",
+    ":ltp_block_dev",
+    ":ltp_bpf_map01",
+    ":ltp_bpf_prog01",
+    ":ltp_bpf_prog02",
+    ":ltp_bpf_prog03",
+    ":ltp_bpf_prog04",
+    ":ltp_bpf_prog05",
+    ":ltp_bpf_prog06",
+    ":ltp_bpf_prog07",
+    ":ltp_brk01",
+    ":ltp_brk02",
+    ":ltp_cacheflush01",
+    ":ltp_can_bcm01",
+    ":ltp_can_filter",
+    ":ltp_can_rcv_own_msgs",
+    ":ltp_cap_bounds_r",
+    ":ltp_cap_bounds_rw",
+    ":ltp_cap_bset_inh_bounds",
+    ":ltp_capget01",
+    ":ltp_capget02",
+    ":ltp_capset01",
+    ":ltp_capset02",
+    ":ltp_capset03",
+    ":ltp_capset04",
+    ":ltp_cfs_bandwidth01",
+    ":ltp_cgroup_core01",
+    ":ltp_cgroup_core02",
+    ":ltp_cgroup_core03",
+    ":ltp_cgroup_fj_proc",
+    ":ltp_cgroup_regression_fork_processes",
+    ":ltp_cgroup_regression_getdelays",
+    ":ltp_cgroup_xattr",
+    ":ltp_chdir01",
+    ":ltp_chdir04",
+    ":ltp_check_keepcaps",
+    ":ltp_check_pe",
+    ":ltp_check_simple_capset",
+    ":ltp_chmod01",
+    ":ltp_chmod03",
+    ":ltp_chmod05",
+    ":ltp_chmod07",
+    ":ltp_chown01",
+    ":ltp_chown01_16",
+    ":ltp_chown02",
+    ":ltp_chown02_16",
+    ":ltp_chown03",
+    ":ltp_chown03_16",
+    ":ltp_chown05",
+    ":ltp_chown05_16",
+    ":ltp_chroot01",
+    ":ltp_chroot02",
+    ":ltp_chroot03",
+    ":ltp_chroot04",
+    ":ltp_clock_adjtime01",
+    ":ltp_clock_adjtime02",
+    ":ltp_clock_getres01",
+    ":ltp_clock_gettime01",
+    ":ltp_clock_gettime02",
+    ":ltp_clock_gettime03",
+    ":ltp_clock_gettime04",
+    ":ltp_clock_nanosleep01",
+    ":ltp_clock_nanosleep02",
+    ":ltp_clock_nanosleep03",
+    ":ltp_clock_nanosleep04",
+    ":ltp_clock_settime01",
+    ":ltp_clock_settime02",
+    ":ltp_clock_settime03",
+    ":ltp_clone01",
+    ":ltp_clone02",
+    ":ltp_clone03",
+    ":ltp_clone04",
+    ":ltp_clone05",
+    ":ltp_clone06",
+    ":ltp_clone07",
+    ":ltp_clone08",
+    ":ltp_clone09",
+    ":ltp_clone301",
+    ":ltp_clone302",
+    ":ltp_clone303",
+    ":ltp_close01",
+    ":ltp_close02",
+    ":ltp_close_range01",
+    ":ltp_close_range02",
+    ":ltp_connect01",
+    ":ltp_connect02",
+    ":ltp_copy_file_range01",
+    ":ltp_copy_file_range02",
+    ":ltp_copy_file_range03",
+    ":ltp_cpuacct_task",
+    ":ltp_cpuctl_def_task01",
+    ":ltp_cpuctl_def_task02",
+    ":ltp_cpuctl_def_task03",
+    ":ltp_cpuctl_def_task04",
+    ":ltp_cpuctl_fj_cpu-hog",
+    ":ltp_cpuctl_fj_simple_echo",
+    ":ltp_cpuctl_latency_check_task",
+    ":ltp_cpuctl_latency_test",
+    ":ltp_cpuctl_test01",
+    ":ltp_cpuctl_test02",
+    ":ltp_cpuctl_test03",
+    ":ltp_cpuctl_test04",
+    ":ltp_cpufreq_boost",
+    ":ltp_cpuset01",
+    ":ltp_cpuset_cpu_hog",
+    ":ltp_cpuset_list_compute",
+    ":ltp_cpuset_mem_hog",
+    ":ltp_cpuset_memory_pressure",
+    ":ltp_cpuset_sched_domains_check",
+    ":ltp_cpuset_syscall_test",
+    ":ltp_crash01",
+    ":ltp_crash02",
+    ":ltp_creat01",
+    ":ltp_creat03",
+    ":ltp_creat04",
+    ":ltp_creat05",
+    ":ltp_creat07",
+    ":ltp_creat07_child",
+    ":ltp_creat08",
+    ":ltp_creat09",
+    ":ltp_create_datafile",
+    ":ltp_crypto_user01",
+    ":ltp_crypto_user02",
+    ":ltp_cve-2014-0196",
+    ":ltp_cve-2015-3290",
+    ":ltp_cve-2016-10044",
+    ":ltp_cve-2016-7042",
+    ":ltp_cve-2016-7117",
+    ":ltp_cve-2017-16939",
+    ":ltp_cve-2017-17052",
+    ":ltp_cve-2017-17053",
+    ":ltp_cve-2017-2618",
+    ":ltp_cve-2017-2671",
+    ":ltp_cve-2022-4378",
+    ":ltp_data_space",
+    ":ltp_delete_module01",
+    ":ltp_delete_module02",
+    ":ltp_delete_module03",
+    ":ltp_dio_append",
+    ":ltp_dio_read",
+    ":ltp_dio_sparse",
+    ":ltp_dio_truncate",
+    ":ltp_diotest1",
+    ":ltp_diotest2",
+    ":ltp_diotest3",
+    ":ltp_diotest5",
+    ":ltp_diotest6",
+    ":ltp_dirty",
+    ":ltp_dirtyc0w",
+    ":ltp_dirtyc0w_child",
+    ":ltp_dirtyc0w_shmem",
+    ":ltp_dirtyc0w_shmem_child",
+    ":ltp_dirtypipe",
+    ":ltp_dma_thread_diotest",
+    ":ltp_dup01",
+    ":ltp_dup02",
+    ":ltp_dup03",
+    ":ltp_dup04",
+    ":ltp_dup05",
+    ":ltp_dup06",
+    ":ltp_dup07",
+    ":ltp_dup201",
+    ":ltp_dup202",
+    ":ltp_dup203",
+    ":ltp_dup204",
+    ":ltp_dup205",
+    ":ltp_dup206",
+    ":ltp_dup207",
+    ":ltp_dup3_01",
+    ":ltp_dup3_02",
+    ":ltp_eas_big_to_small",
+    ":ltp_eas_one_big_task",
+    ":ltp_eas_one_small_task",
+    ":ltp_eas_small_big_toggle",
+    ":ltp_eas_small_to_big",
+    ":ltp_eas_two_big_three_small",
+    ":ltp_endian_switch01",
+    ":ltp_epoll-ltp",
+    ":ltp_epoll_create01",
+    ":ltp_epoll_create02",
+    ":ltp_epoll_create1_01",
+    ":ltp_epoll_create1_02",
+    ":ltp_epoll_ctl01",
+    ":ltp_epoll_ctl02",
+    ":ltp_epoll_ctl03",
+    ":ltp_epoll_ctl04",
+    ":ltp_epoll_ctl05",
+    ":ltp_epoll_pwait01",
+    ":ltp_epoll_pwait02",
+    ":ltp_epoll_pwait03",
+    ":ltp_epoll_pwait04",
+    ":ltp_epoll_pwait05",
+    ":ltp_epoll_wait01",
+    ":ltp_epoll_wait02",
+    ":ltp_epoll_wait03",
+    ":ltp_epoll_wait04",
+    ":ltp_epoll_wait05",
+    ":ltp_epoll_wait06",
+    ":ltp_epoll_wait07",
+    ":ltp_event_generator",
+    ":ltp_eventfd01",
+    ":ltp_eventfd02",
+    ":ltp_eventfd03",
+    ":ltp_eventfd04",
+    ":ltp_eventfd05",
+    ":ltp_eventfd06",
+    ":ltp_eventfd2_01",
+    ":ltp_eventfd2_02",
+    ":ltp_eventfd2_03",
+    ":ltp_exec_with_inh",
+    ":ltp_exec_without_inh",
+    ":ltp_execl01",
+    ":ltp_execl01_child",
+    ":ltp_execle01",
+    ":ltp_execle01_child",
+    ":ltp_execlp01",
+    ":ltp_execlp01_child",
+    ":ltp_execv01",
+    ":ltp_execv01_child",
+    ":ltp_execve01",
+    ":ltp_execve01_child",
+    ":ltp_execve02",
+    ":ltp_execve03",
+    ":ltp_execve04",
+    ":ltp_execve05",
+    ":ltp_execve06",
+    ":ltp_execve06_child",
+    ":ltp_execve_child",
+    ":ltp_execveat01",
+    ":ltp_execveat02",
+    ":ltp_execveat03",
+    ":ltp_execveat_child",
+    ":ltp_execveat_errno",
+    ":ltp_execvp01",
+    ":ltp_execvp01_child",
+    ":ltp_exit01",
+    ":ltp_exit02",
+    ":ltp_exit_group01",
+    ":ltp_f1",
+    ":ltp_f2",
+    ":ltp_f3",
+    ":ltp_faccessat01",
+    ":ltp_faccessat02",
+    ":ltp_faccessat201",
+    ":ltp_faccessat202",
+    ":ltp_fallocate01",
+    ":ltp_fallocate02",
+    ":ltp_fallocate03",
+    ":ltp_fallocate04",
+    ":ltp_fallocate05",
+    ":ltp_fallocate06",
+    ":ltp_fanotify01",
+    ":ltp_fanotify02",
+    ":ltp_fanotify03",
+    ":ltp_fanotify04",
+    ":ltp_fanotify05",
+    ":ltp_fanotify06",
+    ":ltp_fanotify07",
+    ":ltp_fanotify08",
+    ":ltp_fanotify09",
+    ":ltp_fanotify10",
+    ":ltp_fanotify11",
+    ":ltp_fanotify12",
+    ":ltp_fanotify13",
+    ":ltp_fanotify14",
+    ":ltp_fanotify15",
+    ":ltp_fanotify16",
+    ":ltp_fanotify17",
+    ":ltp_fanotify18",
+    ":ltp_fanotify19",
+    ":ltp_fanotify20",
+    ":ltp_fanotify21",
+    ":ltp_fanotify22",
+    ":ltp_fanotify23",
+    ":ltp_fanotify_child",
+    ":ltp_fanout01",
+    ":ltp_fchdir01",
+    ":ltp_fchdir02",
+    ":ltp_fchdir03",
+    ":ltp_fchmod01",
+    ":ltp_fchmod02",
+    ":ltp_fchmod03",
+    ":ltp_fchmod04",
+    ":ltp_fchmod05",
+    ":ltp_fchmod06",
+    ":ltp_fchmodat01",
+    ":ltp_fchmodat02",
+    ":ltp_fchown01",
+    ":ltp_fchown01_16",
+    ":ltp_fchown02",
+    ":ltp_fchown02_16",
+    ":ltp_fchown03",
+    ":ltp_fchown03_16",
+    ":ltp_fchown04",
+    ":ltp_fchown04_16",
+    ":ltp_fchown05",
+    ":ltp_fchown05_16",
+    ":ltp_fchownat01",
+    ":ltp_fchownat02",
+    ":ltp_fcntl01",
+    ":ltp_fcntl01_64",
+    ":ltp_fcntl02",
+    ":ltp_fcntl02_64",
+    ":ltp_fcntl03",
+    ":ltp_fcntl03_64",
+    ":ltp_fcntl04",
+    ":ltp_fcntl04_64",
+    ":ltp_fcntl05",
+    ":ltp_fcntl05_64",
+    ":ltp_fcntl07",
+    ":ltp_fcntl07_64",
+    ":ltp_fcntl08",
+    ":ltp_fcntl08_64",
+    ":ltp_fcntl09",
+    ":ltp_fcntl09_64",
+    ":ltp_fcntl10",
+    ":ltp_fcntl10_64",
+    ":ltp_fcntl11",
+    ":ltp_fcntl11_64",
+    ":ltp_fcntl12",
+    ":ltp_fcntl12_64",
+    ":ltp_fcntl13",
+    ":ltp_fcntl13_64",
+    ":ltp_fcntl14",
+    ":ltp_fcntl14_64",
+    ":ltp_fcntl15",
+    ":ltp_fcntl15_64",
+    ":ltp_fcntl16",
+    ":ltp_fcntl16_64",
+    ":ltp_fcntl17",
+    ":ltp_fcntl17_64",
+    ":ltp_fcntl18",
+    ":ltp_fcntl18_64",
+    ":ltp_fcntl19",
+    ":ltp_fcntl19_64",
+    ":ltp_fcntl20",
+    ":ltp_fcntl20_64",
+    ":ltp_fcntl21",
+    ":ltp_fcntl21_64",
+    ":ltp_fcntl22",
+    ":ltp_fcntl22_64",
+    ":ltp_fcntl23",
+    ":ltp_fcntl23_64",
+    ":ltp_fcntl24",
+    ":ltp_fcntl24_64",
+    ":ltp_fcntl25",
+    ":ltp_fcntl25_64",
+    ":ltp_fcntl26",
+    ":ltp_fcntl26_64",
+    ":ltp_fcntl27",
+    ":ltp_fcntl27_64",
+    ":ltp_fcntl29",
+    ":ltp_fcntl29_64",
+    ":ltp_fcntl30",
+    ":ltp_fcntl30_64",
+    ":ltp_fcntl31",
+    ":ltp_fcntl31_64",
+    ":ltp_fcntl32",
+    ":ltp_fcntl32_64",
+    ":ltp_fcntl33",
+    ":ltp_fcntl33_64",
+    ":ltp_fcntl34",
+    ":ltp_fcntl34_64",
+    ":ltp_fcntl35",
+    ":ltp_fcntl35_64",
+    ":ltp_fcntl36",
+    ":ltp_fcntl36_64",
+    ":ltp_fcntl37",
+    ":ltp_fcntl37_64",
+    ":ltp_fcntl38",
+    ":ltp_fcntl38_64",
+    ":ltp_fcntl39",
+    ":ltp_fcntl39_64",
+    ":ltp_fdatasync01",
+    ":ltp_fdatasync02",
+    ":ltp_fdatasync03",
+    ":ltp_fgetxattr01",
+    ":ltp_fgetxattr02",
+    ":ltp_fgetxattr03",
+    ":ltp_finit_module01",
+    ":ltp_finit_module02",
+    ":ltp_flistxattr01",
+    ":ltp_flistxattr02",
+    ":ltp_flistxattr03",
+    ":ltp_float_bessel",
+    ":ltp_float_exp_log",
+    ":ltp_float_iperb",
+    ":ltp_float_power",
+    ":ltp_float_trigo",
+    ":ltp_flock01",
+    ":ltp_flock02",
+    ":ltp_flock03",
+    ":ltp_flock04",
+    ":ltp_flock06",
+    ":ltp_fork01",
+    ":ltp_fork03",
+    ":ltp_fork04",
+    ":ltp_fork05",
+    ":ltp_fork07",
+    ":ltp_fork08",
+    ":ltp_fork09",
+    ":ltp_fork10",
+    ":ltp_fork13",
+    ":ltp_fork14",
+    ":ltp_fork_exec_loop",
+    ":ltp_fork_procs",
+    ":ltp_fpathconf01",
+    ":ltp_fptest01",
+    ":ltp_fptest02",
+    ":ltp_frag",
+    ":ltp_fremovexattr01",
+    ":ltp_fremovexattr02",
+    ":ltp_fs_fill",
+    ":ltp_fs_perms",
+    ":ltp_fsconfig01",
+    ":ltp_fsconfig02",
+    ":ltp_fsconfig03",
+    ":ltp_fsetxattr01",
+    ":ltp_fsetxattr02",
+    ":ltp_fsmount01",
+    ":ltp_fsmount02",
+    ":ltp_fsopen01",
+    ":ltp_fsopen02",
+    ":ltp_fspick01",
+    ":ltp_fspick02",
+    ":ltp_fsstress",
+    ":ltp_fstat02",
+    ":ltp_fstat02_64",
+    ":ltp_fstat03",
+    ":ltp_fstat03_64",
+    ":ltp_fstatat01",
+    ":ltp_fstatfs01",
+    ":ltp_fstatfs01_64",
+    ":ltp_fstatfs02",
+    ":ltp_fstatfs02_64",
+    ":ltp_fsx-linux",
+    ":ltp_fsync01",
+    ":ltp_fsync02",
+    ":ltp_fsync03",
+    ":ltp_fsync04",
+    ":ltp_ftest01",
+    ":ltp_ftest02",
+    ":ltp_ftest03",
+    ":ltp_ftest04",
+    ":ltp_ftest05",
+    ":ltp_ftest06",
+    ":ltp_ftest07",
+    ":ltp_ftest08",
+    ":ltp_ftruncate01",
+    ":ltp_ftruncate01_64",
+    ":ltp_ftruncate03",
+    ":ltp_ftruncate03_64",
+    ":ltp_ftruncate04",
+    ":ltp_ftruncate04_64",
+    ":ltp_futex_cmp_requeue01",
+    ":ltp_futex_cmp_requeue02",
+    ":ltp_futex_wait01",
+    ":ltp_futex_wait03",
+    ":ltp_futex_wait04",
+    ":ltp_futex_wait05",
+    ":ltp_futex_wait_bitset01",
+    ":ltp_futex_waitv01",
+    ":ltp_futex_waitv02",
+    ":ltp_futex_waitv03",
+    ":ltp_futex_wake01",
+    ":ltp_futex_wake02",
+    ":ltp_futex_wake04",
+    ":ltp_futimesat01",
+    ":ltp_fw_load",
+    ":ltp_genacos",
+    ":ltp_genasin",
+    ":ltp_genatan",
+    ":ltp_genatan2",
+    ":ltp_genbessel",
+    ":ltp_genceil",
+    ":ltp_gencos",
+    ":ltp_gencosh",
+    ":ltp_genexp",
+    ":ltp_genexp_log",
+    ":ltp_genfabs",
+    ":ltp_genfloor",
+    ":ltp_genfmod",
+    ":ltp_genfrexp",
+    ":ltp_genhypot",
+    ":ltp_geniperb",
+    ":ltp_genj0",
+    ":ltp_genj1",
+    ":ltp_genldexp",
+    ":ltp_genlgamma",
+    ":ltp_genlog",
+    ":ltp_genlog10",
+    ":ltp_genmodf",
+    ":ltp_genpow",
+    ":ltp_genpower",
+    ":ltp_gensin",
+    ":ltp_gensinh",
+    ":ltp_gensqrt",
+    ":ltp_gentan",
+    ":ltp_gentanh",
+    ":ltp_gentrigo",
+    ":ltp_geny0",
+    ":ltp_geny1",
+    ":ltp_get_mempolicy01",
+    ":ltp_get_mempolicy02",
+    ":ltp_get_robust_list01",
+    ":ltp_getaddrinfo_01",
+    ":ltp_getcpu01",
+    ":ltp_getcwd01",
+    ":ltp_getcwd02",
+    ":ltp_getcwd03",
+    ":ltp_getcwd04",
+    ":ltp_getdents01",
+    ":ltp_getdents02",
+    ":ltp_getdomainname01",
+    ":ltp_getegid01",
+    ":ltp_getegid01_16",
+    ":ltp_getegid02",
+    ":ltp_getegid02_16",
+    ":ltp_geteuid01",
+    ":ltp_geteuid01_16",
+    ":ltp_geteuid02",
+    ":ltp_geteuid02_16",
+    ":ltp_getgid01",
+    ":ltp_getgid01_16",
+    ":ltp_getgid03",
+    ":ltp_getgid03_16",
+    ":ltp_getgroups01",
+    ":ltp_getgroups01_16",
+    ":ltp_getgroups03",
+    ":ltp_getgroups03_16",
+    ":ltp_gethostbyname_r01",
+    ":ltp_gethostname01",
+    ":ltp_gethostname02",
+    ":ltp_getitimer01",
+    ":ltp_getitimer02",
+    ":ltp_getpagesize01",
+    ":ltp_getpeername01",
+    ":ltp_getpgid01",
+    ":ltp_getpgid02",
+    ":ltp_getpgrp01",
+    ":ltp_getpid01",
+    ":ltp_getpid02",
+    ":ltp_getppid01",
+    ":ltp_getppid02",
+    ":ltp_getpriority01",
+    ":ltp_getpriority02",
+    ":ltp_getrandom01",
+    ":ltp_getrandom02",
+    ":ltp_getrandom03",
+    ":ltp_getrandom04",
+    ":ltp_getrandom05",
+    ":ltp_getresgid01",
+    ":ltp_getresgid01_16",
+    ":ltp_getresgid02",
+    ":ltp_getresgid02_16",
+    ":ltp_getresgid03",
+    ":ltp_getresgid03_16",
+    ":ltp_getresuid01",
+    ":ltp_getresuid01_16",
+    ":ltp_getresuid02",
+    ":ltp_getresuid02_16",
+    ":ltp_getresuid03",
+    ":ltp_getresuid03_16",
+    ":ltp_getrlimit01",
+    ":ltp_getrlimit02",
+    ":ltp_getrlimit03",
+    ":ltp_getrusage01",
+    ":ltp_getrusage02",
+    ":ltp_getrusage03_child",
+    ":ltp_getrusage04",
+    ":ltp_getsid01",
+    ":ltp_getsid02",
+    ":ltp_getsockname01",
+    ":ltp_getsockopt01",
+    ":ltp_getsockopt02",
+    ":ltp_gettid01",
+    ":ltp_gettid02",
+    ":ltp_gettimeofday01",
+    ":ltp_gettimeofday02",
+    ":ltp_getuid01",
+    ":ltp_getuid01_16",
+    ":ltp_getuid03",
+    ":ltp_getuid03_16",
+    ":ltp_getxattr01",
+    ":ltp_getxattr02",
+    ":ltp_getxattr03",
+    ":ltp_getxattr04",
+    ":ltp_getxattr05",
+    ":ltp_hackbench",
+    ":ltp_hangup01",
+    ":ltp_ht_affinity",
+    ":ltp_ht_enabled",
+    ":ltp_hugefallocate01",
+    ":ltp_hugefallocate02",
+    ":ltp_hugefork01",
+    ":ltp_hugefork02",
+    ":ltp_hugemmap01",
+    ":ltp_hugemmap02",
+    ":ltp_hugemmap04",
+    ":ltp_hugemmap06",
+    ":ltp_hugemmap07",
+    ":ltp_hugemmap08",
+    ":ltp_hugemmap09",
+    ":ltp_hugemmap10",
+    ":ltp_hugemmap11",
+    ":ltp_hugemmap12",
+    ":ltp_hugemmap13",
+    ":ltp_hugemmap14",
+    ":ltp_hugemmap16",
+    ":ltp_hugemmap17",
+    ":ltp_hugemmap18",
+    ":ltp_hugemmap19",
+    ":ltp_hugemmap20",
+    ":ltp_hugemmap21",
+    ":ltp_hugemmap22",
+    ":ltp_hugemmap23",
+    ":ltp_hugemmap24",
+    ":ltp_hugemmap25",
+    ":ltp_hugemmap26",
+    ":ltp_hugemmap27",
+    ":ltp_hugemmap28",
+    ":ltp_hugemmap29",
+    ":ltp_hugemmap30",
+    ":ltp_hugemmap31",
+    ":ltp_hugemmap32",
+    ":ltp_icmp_rate_limit01",
+    ":ltp_ima_boot_aggregate",
+    ":ltp_ima_mmap",
+    ":ltp_in",
+    ":ltp_in6_02",
+    ":ltp_inh_capped",
+    ":ltp_init_module01",
+    ":ltp_init_module02",
+    ":ltp_inode01",
+    ":ltp_inode02",
+    ":ltp_inotify01",
+    ":ltp_inotify02",
+    ":ltp_inotify03",
+    ":ltp_inotify04",
+    ":ltp_inotify05",
+    ":ltp_inotify06",
+    ":ltp_inotify07",
+    ":ltp_inotify08",
+    ":ltp_inotify09",
+    ":ltp_inotify10",
+    ":ltp_inotify11",
+    ":ltp_inotify12",
+    ":ltp_inotify_init1_01",
+    ":ltp_inotify_init1_02",
+    ":ltp_input01",
+    ":ltp_input02",
+    ":ltp_input04",
+    ":ltp_input05",
+    ":ltp_input06",
+    ":ltp_io_cancel01",
+    ":ltp_io_cancel02",
+    ":ltp_io_control01",
+    ":ltp_io_destroy01",
+    ":ltp_io_destroy02",
+    ":ltp_io_getevents01",
+    ":ltp_io_getevents02",
+    ":ltp_io_pgetevents01",
+    ":ltp_io_pgetevents02",
+    ":ltp_io_setup01",
+    ":ltp_io_setup02",
+    ":ltp_io_submit01",
+    ":ltp_io_submit02",
+    ":ltp_io_submit03",
+    ":ltp_io_uring01",
+    ":ltp_io_uring02",
+    ":ltp_ioctl01",
+    ":ltp_ioctl03",
+    ":ltp_ioctl04",
+    ":ltp_ioctl05",
+    ":ltp_ioctl06",
+    ":ltp_ioctl07",
+    ":ltp_ioctl08",
+    ":ltp_ioctl09",
+    ":ltp_ioctl_loop01",
+    ":ltp_ioctl_loop02",
+    ":ltp_ioctl_loop03",
+    ":ltp_ioctl_loop04",
+    ":ltp_ioctl_loop05",
+    ":ltp_ioctl_loop06",
+    ":ltp_ioctl_loop07",
+    ":ltp_ioctl_ns01",
+    ":ltp_ioctl_ns02",
+    ":ltp_ioctl_ns03",
+    ":ltp_ioctl_ns04",
+    ":ltp_ioctl_ns05",
+    ":ltp_ioctl_ns06",
+    ":ltp_ioctl_ns07",
+    ":ltp_ioctl_sg01",
+    ":ltp_iogen",
+    ":ltp_ioperm01",
+    ":ltp_ioperm02",
+    ":ltp_iopl01",
+    ":ltp_iopl02",
+    ":ltp_ioprio_get01",
+    ":ltp_ioprio_set01",
+    ":ltp_ioprio_set02",
+    ":ltp_ioprio_set03",
+    ":ltp_irqbalance01",
+    ":ltp_kallsyms",
+    ":ltp_kcmp01",
+    ":ltp_kcmp02",
+    ":ltp_kcmp03",
+    ":ltp_keyctl01",
+    ":ltp_keyctl02",
+    ":ltp_keyctl03",
+    ":ltp_keyctl04",
+    ":ltp_keyctl05",
+    ":ltp_keyctl06",
+    ":ltp_keyctl07",
+    ":ltp_keyctl08",
+    ":ltp_keyctl09",
+    ":ltp_kill02",
+    ":ltp_kill03",
+    ":ltp_kill06",
+    ":ltp_kill08",
+    ":ltp_kill09",
+    ":ltp_kill10",
+    ":ltp_kill11",
+    ":ltp_kill12",
+    ":ltp_kill13",
+    ":ltp_kmsg01",
+    ":ltp_ksm01",
+    ":ltp_ksm02",
+    ":ltp_ksm03",
+    ":ltp_ksm04",
+    ":ltp_ksm05",
+    ":ltp_ksm06",
+    ":ltp_ksm07",
+    ":ltp_lchown01",
+    ":ltp_lchown01_16",
+    ":ltp_lchown02",
+    ":ltp_lchown02_16",
+    ":ltp_lchown03",
+    ":ltp_lchown03_16",
+    ":ltp_leapsec01",
+    ":ltp_lftest",
+    ":ltp_lgetxattr01",
+    ":ltp_lgetxattr02",
+    ":ltp_link02",
+    ":ltp_link04",
+    ":ltp_link05",
+    ":ltp_link08",
+    ":ltp_linkat01",
+    ":ltp_linkat02",
+    ":ltp_listen01",
+    ":ltp_listxattr01",
+    ":ltp_listxattr02",
+    ":ltp_listxattr03",
+    ":ltp_llistxattr01",
+    ":ltp_llistxattr02",
+    ":ltp_llistxattr03",
+    ":ltp_llseek01",
+    ":ltp_llseek02",
+    ":ltp_llseek03",
+    ":ltp_locktests",
+    ":ltp_lremovexattr01",
+    ":ltp_lseek01",
+    ":ltp_lseek02",
+    ":ltp_lseek07",
+    ":ltp_lseek11",
+    ":ltp_lstat01",
+    ":ltp_lstat01_64",
+    ":ltp_lstat02",
+    ":ltp_lstat02_64",
+    ":ltp_ltpClient",
+    ":ltp_ltpServer",
+    ":ltp_ltp_acpi",
+    ":ltp_madvise01",
+    ":ltp_madvise02",
+    ":ltp_madvise05",
+    ":ltp_madvise06",
+    ":ltp_madvise07",
+    ":ltp_madvise08",
+    ":ltp_madvise09",
+    ":ltp_madvise10",
+    ":ltp_madvise11",
+    ":ltp_mallinfo01",
+    ":ltp_mallinfo02",
+    ":ltp_mallinfo2_01",
+    ":ltp_max_map_count",
+    ":ltp_mbind01",
+    ":ltp_mbind02",
+    ":ltp_mbind03",
+    ":ltp_mbind04",
+    ":ltp_mc_member_test",
+    ":ltp_mc_recv",
+    ":ltp_mc_send",
+    ":ltp_mc_verify_opts",
+    ":ltp_mc_verify_opts_error",
+    ":ltp_meltdown",
+    ":ltp_mem02",
+    ":ltp_mem_process",
+    ":ltp_membarrier01",
+    ":ltp_memcg_process_stress",
+    ":ltp_memcg_test_1",
+    ":ltp_memcg_test_2",
+    ":ltp_memcg_test_3",
+    ":ltp_memcg_test_4",
+    ":ltp_memcmp01",
+    ":ltp_memcontrol01",
+    ":ltp_memcontrol02",
+    ":ltp_memcontrol03",
+    ":ltp_memcontrol04",
+    ":ltp_memcpy01",
+    ":ltp_memctl_test01",
+    ":ltp_memfd_create01",
+    ":ltp_memfd_create02",
+    ":ltp_memfd_create03",
+    ":ltp_memfd_create04",
+    ":ltp_memset01",
+    ":ltp_memtoy",
+    ":ltp_migrate_pages01",
+    ":ltp_migrate_pages02",
+    ":ltp_migrate_pages03",
+    ":ltp_mincore01",
+    ":ltp_mincore02",
+    ":ltp_mincore03",
+    ":ltp_mincore04",
+    ":ltp_mkdir02",
+    ":ltp_mkdir03",
+    ":ltp_mkdir04",
+    ":ltp_mkdir05",
+    ":ltp_mkdir09",
+    ":ltp_mkdirat01",
+    ":ltp_mkdirat02",
+    ":ltp_mknod01",
+    ":ltp_mknod02",
+    ":ltp_mknod03",
+    ":ltp_mknod04",
+    ":ltp_mknod05",
+    ":ltp_mknod06",
+    ":ltp_mknod07",
+    ":ltp_mknod08",
+    ":ltp_mknod09",
+    ":ltp_mknodat01",
+    ":ltp_mknodat02",
+    ":ltp_mlock01",
+    ":ltp_mlock02",
+    ":ltp_mlock03",
+    ":ltp_mlock04",
+    ":ltp_mlock05",
+    ":ltp_mlock201",
+    ":ltp_mlock202",
+    ":ltp_mlock203",
+    ":ltp_mlockall01",
+    ":ltp_mlockall02",
+    ":ltp_mlockall03",
+    ":ltp_mmap-corruption01",
+    ":ltp_mmap001",
+    ":ltp_mmap01",
+    ":ltp_mmap02",
+    ":ltp_mmap03",
+    ":ltp_mmap04",
+    ":ltp_mmap05",
+    ":ltp_mmap06",
+    ":ltp_mmap08",
+    ":ltp_mmap09",
+    ":ltp_mmap1",
+    ":ltp_mmap10",
+    ":ltp_mmap11",
+    ":ltp_mmap12",
+    ":ltp_mmap13",
+    ":ltp_mmap14",
+    ":ltp_mmap15",
+    ":ltp_mmap16",
+    ":ltp_mmap17",
+    ":ltp_mmap18",
+    ":ltp_mmap19",
+    ":ltp_mmap2",
+    ":ltp_mmap20",
+    ":ltp_mmap3",
+    ":ltp_mmapstress01",
+    ":ltp_mmapstress02",
+    ":ltp_mmapstress03",
+    ":ltp_mmapstress04",
+    ":ltp_mmapstress05",
+    ":ltp_mmapstress06",
+    ":ltp_mmapstress07",
+    ":ltp_mmapstress08",
+    ":ltp_mmapstress09",
+    ":ltp_mmapstress10",
+    ":ltp_mmstress",
+    ":ltp_mmstress_dummy",
+    ":ltp_modify_ldt01",
+    ":ltp_modify_ldt02",
+    ":ltp_modify_ldt03",
+    ":ltp_mount01",
+    ":ltp_mount02",
+    ":ltp_mount03",
+    ":ltp_mount03_suid_child",
+    ":ltp_mount04",
+    ":ltp_mount05",
+    ":ltp_mount06",
+    ":ltp_mount07",
+    ":ltp_mount_setattr01",
+    ":ltp_move_mount01",
+    ":ltp_move_mount02",
+    ":ltp_move_pages01",
+    ":ltp_move_pages02",
+    ":ltp_move_pages03",
+    ":ltp_move_pages04",
+    ":ltp_move_pages05",
+    ":ltp_move_pages06",
+    ":ltp_move_pages07",
+    ":ltp_move_pages09",
+    ":ltp_move_pages10",
+    ":ltp_move_pages11",
+    ":ltp_move_pages12",
+    ":ltp_mprotect01",
+    ":ltp_mprotect02",
+    ":ltp_mprotect03",
+    ":ltp_mprotect04",
+    ":ltp_mprotect05",
+    ":ltp_mremap01",
+    ":ltp_mremap02",
+    ":ltp_mremap03",
+    ":ltp_mremap05",
+    ":ltp_mremap06",
+    ":ltp_msgget05",
+    ":ltp_msync01",
+    ":ltp_msync02",
+    ":ltp_msync03",
+    ":ltp_msync04",
+    ":ltp_mtest01",
+    ":ltp_munlock01",
+    ":ltp_munlock02",
+    ":ltp_munlockall01",
+    ":ltp_munmap01",
+    ":ltp_munmap02",
+    ":ltp_munmap03",
+    ":ltp_name_to_handle_at01",
+    ":ltp_name_to_handle_at02",
+    ":ltp_nanosleep01",
+    ":ltp_nanosleep02",
+    ":ltp_nanosleep04",
+    ":ltp_netstress",
+    ":ltp_newuname01",
+    ":ltp_nextafter01",
+    ":ltp_nfs01_open_files",
+    ":ltp_nfs04_create_file",
+    ":ltp_nfs05_make_tree",
+    ":ltp_nfs_flock",
+    ":ltp_nfs_flock_dgen",
+    ":ltp_nft02",
+    ":ltp_nftw01",
+    ":ltp_nftw6401",
+    ":ltp_nice01",
+    ":ltp_nice02",
+    ":ltp_nice03",
+    ":ltp_nice04",
+    ":ltp_nptl01",
+    ":ltp_ns-icmp_redirector",
+    ":ltp_ns-icmpv4_sender",
+    ":ltp_ns-icmpv6_sender",
+    ":ltp_ns-igmp_querier",
+    ":ltp_ns-mcast_join",
+    ":ltp_ns-mcast_receiver",
+    ":ltp_ns-tcpclient",
+    ":ltp_ns-tcpserver",
+    ":ltp_ns-udpclient",
+    ":ltp_ns-udpsender",
+    ":ltp_ns-udpserver",
+    ":ltp_oom01",
+    ":ltp_oom02",
+    ":ltp_oom03",
+    ":ltp_oom04",
+    ":ltp_oom05",
+    ":ltp_open01",
+    ":ltp_open02",
+    ":ltp_open03",
+    ":ltp_open04",
+    ":ltp_open06",
+    ":ltp_open07",
+    ":ltp_open08",
+    ":ltp_open09",
+    ":ltp_open10",
+    ":ltp_open11",
+    ":ltp_open12_child",
+    ":ltp_open13",
+    ":ltp_open14",
+    ":ltp_open_by_handle_at01",
+    ":ltp_open_by_handle_at02",
+    ":ltp_open_tree01",
+    ":ltp_open_tree02",
+    ":ltp_openat01",
+    ":ltp_openat02_child",
+    ":ltp_openat03",
+    ":ltp_openat04",
+    ":ltp_openat201",
+    ":ltp_openat202",
+    ":ltp_openat203",
+    ":ltp_openfile",
+    ":ltp_overcommit_memory",
+    ":ltp_page01",
+    ":ltp_page02",
+    ":ltp_pathconf01",
+    ":ltp_pathconf02",
+    ":ltp_pause01",
+    ":ltp_pause02",
+    ":ltp_pause03",
+    ":ltp_pcrypt_aead01",
+    ":ltp_pec_listener",
+    ":ltp_perf_event_open01",
+    ":ltp_perf_event_open02",
+    ":ltp_perf_event_open03",
+    ":ltp_personality01",
+    ":ltp_personality02",
+    ":ltp_pidfd_getfd01",
+    ":ltp_pidfd_getfd02",
+    ":ltp_pidfd_open01",
+    ":ltp_pidfd_open02",
+    ":ltp_pidfd_open03",
+    ":ltp_pidfd_open04",
+    ":ltp_pidfd_send_signal01",
+    ":ltp_pidfd_send_signal02",
+    ":ltp_pidfd_send_signal03",
+    ":ltp_pids_task1",
+    ":ltp_pids_task2",
+    ":ltp_pipe01",
+    ":ltp_pipe02",
+    ":ltp_pipe03",
+    ":ltp_pipe04",
+    ":ltp_pipe05",
+    ":ltp_pipe06",
+    ":ltp_pipe07",
+    ":ltp_pipe08",
+    ":ltp_pipe09",
+    ":ltp_pipe10",
+    ":ltp_pipe11",
+    ":ltp_pipe12",
+    ":ltp_pipe13",
+    ":ltp_pipe14",
+    ":ltp_pipe15",
+    ":ltp_pipe2_01",
+    ":ltp_pipe2_02",
+    ":ltp_pipe2_02_child",
+    ":ltp_pipe2_04",
+    ":ltp_pivot_root01",
+    ":ltp_pkey01",
+    ":ltp_pm_get_sched_values",
+    ":ltp_poll01",
+    ":ltp_poll02",
+    ":ltp_posix_fadvise01",
+    ":ltp_posix_fadvise01_64",
+    ":ltp_posix_fadvise02",
+    ":ltp_posix_fadvise02_64",
+    ":ltp_posix_fadvise03",
+    ":ltp_posix_fadvise03_64",
+    ":ltp_posix_fadvise04",
+    ":ltp_posix_fadvise04_64",
+    ":ltp_ppoll01",
+    ":ltp_prctl01",
+    ":ltp_prctl02",
+    ":ltp_prctl03",
+    ":ltp_prctl04",
+    ":ltp_prctl05",
+    ":ltp_prctl06",
+    ":ltp_prctl06_execve",
+    ":ltp_prctl07",
+    ":ltp_prctl08",
+    ":ltp_prctl09",
+    ":ltp_prctl10",
+    ":ltp_pread01",
+    ":ltp_pread01_64",
+    ":ltp_pread02",
+    ":ltp_pread02_64",
+    ":ltp_preadv01",
+    ":ltp_preadv01_64",
+    ":ltp_preadv02",
+    ":ltp_preadv02_64",
+    ":ltp_preadv03",
+    ":ltp_preadv03_64",
+    ":ltp_preadv201",
+    ":ltp_preadv201_64",
+    ":ltp_preadv202",
+    ":ltp_preadv202_64",
+    ":ltp_preadv203",
+    ":ltp_preadv203_64",
+    ":ltp_print_caps",
+    ":ltp_proc01",
+    ":ltp_proc_sched_rt01",
+    ":ltp_process_madvise01",
+    ":ltp_process_vm01",
+    ":ltp_process_vm_readv02",
+    ":ltp_process_vm_readv03",
+    ":ltp_process_vm_writev02",
+    ":ltp_pselect01",
+    ":ltp_pselect01_64",
+    ":ltp_pselect02",
+    ":ltp_pselect02_64",
+    ":ltp_pselect03",
+    ":ltp_pselect03_64",
+    ":ltp_pt_test",
+    ":ltp_ptem01",
+    ":ltp_pth_str01",
+    ":ltp_pth_str02",
+    ":ltp_pth_str03",
+    ":ltp_pthcli",
+    ":ltp_pthserv",
+    ":ltp_ptrace01",
+    ":ltp_ptrace02",
+    ":ltp_ptrace03",
+    ":ltp_ptrace04",
+    ":ltp_ptrace05",
+    ":ltp_ptrace06",
+    ":ltp_ptrace07",
+    ":ltp_ptrace08",
+    ":ltp_ptrace09",
+    ":ltp_ptrace10",
+    ":ltp_ptrace11",
+    ":ltp_pty01",
+    ":ltp_pty02",
+    ":ltp_pty03",
+    ":ltp_pty04",
+    ":ltp_pty06",
+    ":ltp_pty07",
+    ":ltp_pwrite01",
+    ":ltp_pwrite01_64",
+    ":ltp_pwrite02",
+    ":ltp_pwrite02_64",
+    ":ltp_pwrite03",
+    ":ltp_pwrite03_64",
+    ":ltp_pwrite04",
+    ":ltp_pwrite04_64",
+    ":ltp_pwritev01",
+    ":ltp_pwritev01_64",
+    ":ltp_pwritev02",
+    ":ltp_pwritev02_64",
+    ":ltp_pwritev03",
+    ":ltp_pwritev03_64",
+    ":ltp_pwritev201",
+    ":ltp_pwritev201_64",
+    ":ltp_pwritev202",
+    ":ltp_pwritev202_64",
+    ":ltp_quotactl01",
+    ":ltp_quotactl02",
+    ":ltp_quotactl03",
+    ":ltp_quotactl04",
+    ":ltp_quotactl05",
+    ":ltp_quotactl06",
+    ":ltp_quotactl07",
+    ":ltp_quotactl08",
+    ":ltp_quotactl09",
+    ":ltp_read01",
+    ":ltp_read02",
+    ":ltp_read03",
+    ":ltp_read04",
+    ":ltp_read_all",
+    ":ltp_readahead01",
+    ":ltp_readahead02",
+    ":ltp_readdir01",
+    ":ltp_readdir21",
+    ":ltp_readlink01",
+    ":ltp_readlink03",
+    ":ltp_readlinkat01",
+    ":ltp_readlinkat02",
+    ":ltp_readv01",
+    ":ltp_readv02",
+    ":ltp_realpath01",
+    ":ltp_reboot01",
+    ":ltp_reboot02",
+    ":ltp_recv01",
+    ":ltp_recvfrom01",
+    ":ltp_recvmmsg01",
+    ":ltp_recvmsg01",
+    ":ltp_recvmsg02",
+    ":ltp_recvmsg03",
+    ":ltp_remap_file_pages02",
+    ":ltp_removexattr01",
+    ":ltp_removexattr02",
+    ":ltp_rename01",
+    ":ltp_rename03",
+    ":ltp_rename04",
+    ":ltp_rename05",
+    ":ltp_rename06",
+    ":ltp_rename07",
+    ":ltp_rename08",
+    ":ltp_rename09",
+    ":ltp_rename10",
+    ":ltp_rename11",
+    ":ltp_rename12",
+    ":ltp_rename13",
+    ":ltp_rename14",
+    ":ltp_renameat01",
+    ":ltp_renameat201",
+    ":ltp_renameat202",
+    ":ltp_request_key01",
+    ":ltp_request_key02",
+    ":ltp_request_key03",
+    ":ltp_request_key04",
+    ":ltp_request_key05",
+    ":ltp_rmdir01",
+    ":ltp_rmdir02",
+    ":ltp_rmdir03",
+    ":ltp_route-change-netlink",
+    ":ltp_rt_sigaction01",
+    ":ltp_rt_sigaction02",
+    ":ltp_rt_sigaction03",
+    ":ltp_rt_sigpending02",
+    ":ltp_rt_sigprocmask01",
+    ":ltp_rt_sigprocmask02",
+    ":ltp_rt_sigqueueinfo01",
+    ":ltp_rt_sigsuspend01",
+    ":ltp_rt_sigtimedwait01",
+    ":ltp_rt_tgsigqueueinfo01",
+    ":ltp_rtc01",
+    ":ltp_rtc02",
+    ":ltp_sbrk01",
+    ":ltp_sbrk02",
+    ":ltp_sbrk03",
+    ":ltp_sched_boost",
+    ":ltp_sched_cfs_prio",
+    ":ltp_sched_dl_runtime",
+    ":ltp_sched_driver",
+    ":ltp_sched_get_priority_max01",
+    ":ltp_sched_get_priority_max02",
+    ":ltp_sched_get_priority_min01",
+    ":ltp_sched_get_priority_min02",
+    ":ltp_sched_getaffinity01",
+    ":ltp_sched_getattr01",
+    ":ltp_sched_getattr02",
+    ":ltp_sched_getparam01",
+    ":ltp_sched_getparam03",
+    ":ltp_sched_getscheduler01",
+    ":ltp_sched_getscheduler02",
+    ":ltp_sched_latency_dl",
+    ":ltp_sched_latency_rt",
+    ":ltp_sched_prio_3_fifo",
+    ":ltp_sched_prio_3_rr",
+    ":ltp_sched_rr_get_interval01",
+    ":ltp_sched_rr_get_interval02",
+    ":ltp_sched_rr_get_interval03",
+    ":ltp_sched_setaffinity01",
+    ":ltp_sched_setattr01",
+    ":ltp_sched_setparam01",
+    ":ltp_sched_setparam02",
+    ":ltp_sched_setparam03",
+    ":ltp_sched_setparam04",
+    ":ltp_sched_setparam05",
+    ":ltp_sched_setscheduler01",
+    ":ltp_sched_setscheduler02",
+    ":ltp_sched_setscheduler03",
+    ":ltp_sched_setscheduler04",
+    ":ltp_sched_tc0",
+    ":ltp_sched_tc1",
+    ":ltp_sched_tc2",
+    ":ltp_sched_tc3",
+    ":ltp_sched_tc4",
+    ":ltp_sched_tc5",
+    ":ltp_sched_tc6",
+    ":ltp_sched_yield01",
+    ":ltp_sctp_big_chunk",
+    ":ltp_select01",
+    ":ltp_select02",
+    ":ltp_select03",
+    ":ltp_select04",
+    ":ltp_semctl08",
+    ":ltp_semctl09",
+    ":ltp_send01",
+    ":ltp_send02",
+    ":ltp_sendfile02",
+    ":ltp_sendfile02_64",
+    ":ltp_sendfile03",
+    ":ltp_sendfile03_64",
+    ":ltp_sendfile04",
+    ":ltp_sendfile04_64",
+    ":ltp_sendfile05",
+    ":ltp_sendfile05_64",
+    ":ltp_sendfile06",
+    ":ltp_sendfile06_64",
+    ":ltp_sendfile07",
+    ":ltp_sendfile07_64",
+    ":ltp_sendfile08",
+    ":ltp_sendfile08_64",
+    ":ltp_sendfile09",
+    ":ltp_sendfile09_64",
+    ":ltp_sendmmsg01",
+    ":ltp_sendmmsg02",
+    ":ltp_sendmsg01",
+    ":ltp_sendmsg03",
+    ":ltp_sendto01",
+    ":ltp_sendto02",
+    ":ltp_sendto03",
+    ":ltp_set_robust_list01",
+    ":ltp_set_thread_area01",
+    ":ltp_set_tid_address01",
+    ":ltp_setdomainname01",
+    ":ltp_setdomainname02",
+    ":ltp_setdomainname03",
+    ":ltp_setegid01",
+    ":ltp_setegid02",
+    ":ltp_setfsgid01",
+    ":ltp_setfsgid01_16",
+    ":ltp_setfsgid02",
+    ":ltp_setfsgid02_16",
+    ":ltp_setfsgid03",
+    ":ltp_setfsgid03_16",
+    ":ltp_setfsuid01",
+    ":ltp_setfsuid01_16",
+    ":ltp_setfsuid02",
+    ":ltp_setfsuid02_16",
+    ":ltp_setfsuid03",
+    ":ltp_setfsuid03_16",
+    ":ltp_setfsuid04",
+    ":ltp_setfsuid04_16",
+    ":ltp_setgid01",
+    ":ltp_setgid01_16",
+    ":ltp_setgid02",
+    ":ltp_setgid02_16",
+    ":ltp_setgid03",
+    ":ltp_setgid03_16",
+    ":ltp_setgroups01",
+    ":ltp_setgroups01_16",
+    ":ltp_setgroups02",
+    ":ltp_setgroups02_16",
+    ":ltp_setgroups03",
+    ":ltp_setgroups03_16",
+    ":ltp_setgroups04",
+    ":ltp_setgroups04_16",
+    ":ltp_sethostname01",
+    ":ltp_sethostname02",
+    ":ltp_sethostname03",
+    ":ltp_setitimer01",
+    ":ltp_setitimer02",
+    ":ltp_setns01",
+    ":ltp_setpgid01",
+    ":ltp_setpgid02",
+    ":ltp_setpgid03",
+    ":ltp_setpgid03_child",
+    ":ltp_setpgrp01",
+    ":ltp_setpgrp02",
+    ":ltp_setpriority01",
+    ":ltp_setpriority02",
+    ":ltp_setregid01",
+    ":ltp_setregid01_16",
+    ":ltp_setregid02",
+    ":ltp_setregid02_16",
+    ":ltp_setregid03",
+    ":ltp_setregid03_16",
+    ":ltp_setregid04",
+    ":ltp_setregid04_16",
+    ":ltp_setresgid01",
+    ":ltp_setresgid01_16",
+    ":ltp_setresgid02",
+    ":ltp_setresgid02_16",
+    ":ltp_setresgid03",
+    ":ltp_setresgid03_16",
+    ":ltp_setresgid04",
+    ":ltp_setresgid04_16",
+    ":ltp_setresuid01",
+    ":ltp_setresuid01_16",
+    ":ltp_setresuid02",
+    ":ltp_setresuid02_16",
+    ":ltp_setresuid03",
+    ":ltp_setresuid03_16",
+    ":ltp_setresuid04",
+    ":ltp_setresuid04_16",
+    ":ltp_setresuid05",
+    ":ltp_setresuid05_16",
+    ":ltp_setreuid01",
+    ":ltp_setreuid01_16",
+    ":ltp_setreuid02",
+    ":ltp_setreuid02_16",
+    ":ltp_setreuid03",
+    ":ltp_setreuid03_16",
+    ":ltp_setreuid04",
+    ":ltp_setreuid04_16",
+    ":ltp_setreuid05",
+    ":ltp_setreuid05_16",
+    ":ltp_setreuid06",
+    ":ltp_setreuid06_16",
+    ":ltp_setreuid07",
+    ":ltp_setreuid07_16",
+    ":ltp_setrlimit01",
+    ":ltp_setrlimit02",
+    ":ltp_setrlimit03",
+    ":ltp_setrlimit04",
+    ":ltp_setrlimit05",
+    ":ltp_setrlimit06",
+    ":ltp_setsid01",
+    ":ltp_setsockopt01",
+    ":ltp_setsockopt02",
+    ":ltp_setsockopt03",
+    ":ltp_setsockopt04",
+    ":ltp_setsockopt05",
+    ":ltp_setsockopt06",
+    ":ltp_setsockopt07",
+    ":ltp_setsockopt08",
+    ":ltp_setsockopt09",
+    ":ltp_setsockopt10",
+    ":ltp_settimeofday01",
+    ":ltp_settimeofday02",
+    ":ltp_setuid01",
+    ":ltp_setuid01_16",
+    ":ltp_setuid03",
+    ":ltp_setuid03_16",
+    ":ltp_setuid04",
+    ":ltp_setuid04_16",
+    ":ltp_setxattr01",
+    ":ltp_setxattr02",
+    ":ltp_setxattr03",
+    ":ltp_sgetmask01",
+    ":ltp_shmat04",
+    ":ltp_sigaction01",
+    ":ltp_sigaction02",
+    ":ltp_sigaltstack01",
+    ":ltp_sigaltstack02",
+    ":ltp_sighold02",
+    ":ltp_signal01",
+    ":ltp_signal02",
+    ":ltp_signal03",
+    ":ltp_signal04",
+    ":ltp_signal05",
+    ":ltp_signal06",
+    ":ltp_signalfd01",
+    ":ltp_signalfd4_01",
+    ":ltp_signalfd4_02",
+    ":ltp_sigpending02",
+    ":ltp_sigprocmask01",
+    ":ltp_sigrelse01",
+    ":ltp_sigsuspend01",
+    ":ltp_sigtimedwait01",
+    ":ltp_sigwait01",
+    ":ltp_sigwaitinfo01",
+    ":ltp_smack_notroot",
+    ":ltp_smack_set_socket_labels",
+    ":ltp_snd_seq01",
+    ":ltp_snd_timer01",
+    ":ltp_socket01",
+    ":ltp_socket02",
+    ":ltp_socketcall01",
+    ":ltp_socketcall02",
+    ":ltp_socketcall03",
+    ":ltp_socketpair01",
+    ":ltp_socketpair02",
+    ":ltp_sockioctl01",
+    ":ltp_splice01",
+    ":ltp_splice02",
+    ":ltp_splice03",
+    ":ltp_splice04",
+    ":ltp_splice05",
+    ":ltp_splice06",
+    ":ltp_splice07",
+    ":ltp_splice08",
+    ":ltp_splice09",
+    ":ltp_ssetmask01",
+    ":ltp_stack_clash",
+    ":ltp_stack_space",
+    ":ltp_starvation",
+    ":ltp_stat01",
+    ":ltp_stat01_64",
+    ":ltp_stat02",
+    ":ltp_stat02_64",
+    ":ltp_stat03",
+    ":ltp_stat03_64",
+    ":ltp_statfs01",
+    ":ltp_statfs01_64",
+    ":ltp_statfs02",
+    ":ltp_statfs02_64",
+    ":ltp_statfs03",
+    ":ltp_statfs03_64",
+    ":ltp_statvfs01",
+    ":ltp_statvfs02",
+    ":ltp_statx01",
+    ":ltp_statx02",
+    ":ltp_statx03",
+    ":ltp_statx04",
+    ":ltp_statx06",
+    ":ltp_statx08",
+    ":ltp_statx09",
+    ":ltp_statx10",
+    ":ltp_statx11",
+    ":ltp_statx12",
+    ":ltp_stream01",
+    ":ltp_stream02",
+    ":ltp_stream03",
+    ":ltp_stream04",
+    ":ltp_stream05",
+    ":ltp_string01",
+    ":ltp_sugov_latency",
+    ":ltp_sugov_stale_util",
+    ":ltp_sugov_wakeups",
+    ":ltp_support_numa",
+    ":ltp_swapoff01",
+    ":ltp_swapoff02",
+    ":ltp_swapon01",
+    ":ltp_swapon02",
+    ":ltp_swapon03",
+    ":ltp_swapping01",
+    ":ltp_symlink01",
+    ":ltp_symlink02",
+    ":ltp_symlink03",
+    ":ltp_symlink04",
+    ":ltp_symlinkat01",
+    ":ltp_sync01",
+    ":ltp_sync_file_range01",
+    ":ltp_sync_file_range02",
+    ":ltp_syncfs01",
+    ":ltp_syscall01",
+    ":ltp_sysconf01",
+    ":ltp_sysctl01",
+    ":ltp_sysctl03",
+    ":ltp_sysctl04",
+    ":ltp_sysfs01",
+    ":ltp_sysfs02",
+    ":ltp_sysfs03",
+    ":ltp_sysfs04",
+    ":ltp_sysfs05",
+    ":ltp_sysinfo01",
+    ":ltp_sysinfo02",
+    ":ltp_sysinfo03",
+    ":ltp_syslog11",
+    ":ltp_syslog12",
+    ":ltp_tbio",
+    ":ltp_tcindex01",
+    ":ltp_tee01",
+    ":ltp_tee02",
+    ":ltp_test01",
+    ":ltp_test02",
+    ":ltp_test03",
+    ":ltp_test04",
+    ":ltp_test05",
+    ":ltp_test06",
+    ":ltp_test07",
+    ":ltp_test08",
+    ":ltp_test09",
+    ":ltp_test11",
+    ":ltp_test13",
+    ":ltp_test14",
+    ":ltp_test15",
+    ":ltp_test19",
+    ":ltp_test20",
+    ":ltp_test22",
+    ":ltp_test_assert",
+    ":ltp_test_children_cleanup",
+    ":ltp_test_exec",
+    ":ltp_test_exec_child",
+    ":ltp_test_guarded_buf",
+    ":ltp_test_kconfig",
+    ":ltp_test_kconfig01",
+    ":ltp_test_kconfig02",
+    ":ltp_test_kconfig03",
+    ":ltp_test_macros01",
+    ":ltp_test_macros02",
+    ":ltp_test_macros03",
+    ":ltp_test_macros04",
+    ":ltp_test_macros05",
+    ":ltp_test_macros06",
+    ":ltp_test_parse_filesize",
+    ":ltp_test_runtime01",
+    ":ltp_test_runtime02",
+    ":ltp_test_timer",
+    ":ltp_test_zero_hugepage",
+    ":ltp_testcases_bin_add_ipv6addr",
+    ":ltp_testcases_bin_ar01.sh",
+    ":ltp_testcases_bin_arping01.sh",
+    ":ltp_testcases_bin_ask_password.sh",
+    ":ltp_testcases_bin_assign_password.sh",
+    ":ltp_testcases_bin_bbr01.sh",
+    ":ltp_testcases_bin_bbr02.sh",
+    ":ltp_testcases_bin_bind_noport01.sh",
+    ":ltp_testcases_bin_binfmt_misc01.sh",
+    ":ltp_testcases_bin_binfmt_misc02.sh",
+    ":ltp_testcases_bin_binfmt_misc_lib.sh",
+    ":ltp_testcases_bin_broken_ip-checksum.sh",
+    ":ltp_testcases_bin_broken_ip-dstaddr.sh",
+    ":ltp_testcases_bin_broken_ip-fragment.sh",
+    ":ltp_testcases_bin_broken_ip-ihl.sh",
+    ":ltp_testcases_bin_broken_ip-nexthdr.sh",
+    ":ltp_testcases_bin_broken_ip-plen.sh",
+    ":ltp_testcases_bin_broken_ip-protcol.sh",
+    ":ltp_testcases_bin_broken_ip-version.sh",
+    ":ltp_testcases_bin_busy_poll01.sh",
+    ":ltp_testcases_bin_busy_poll02.sh",
+    ":ltp_testcases_bin_busy_poll03.sh",
+    ":ltp_testcases_bin_busy_poll_lib.sh",
+    ":ltp_testcases_bin_cgroup_fj_common.sh",
+    ":ltp_testcases_bin_cgroup_fj_function.sh",
+    ":ltp_testcases_bin_cgroup_fj_stress.sh",
+    ":ltp_testcases_bin_cgroup_lib.sh",
+    ":ltp_testcases_bin_cgroup_regression_3_1.sh",
+    ":ltp_testcases_bin_cgroup_regression_3_2.sh",
+    ":ltp_testcases_bin_cgroup_regression_5_1.sh",
+    ":ltp_testcases_bin_cgroup_regression_5_2.sh",
+    ":ltp_testcases_bin_cgroup_regression_6_1.sh",
+    ":ltp_testcases_bin_cgroup_regression_6_2.sh",
+    ":ltp_testcases_bin_cgroup_regression_test.sh",
+    ":ltp_testcases_bin_change_password.sh",
+    ":ltp_testcases_bin_check_envval",
+    ":ltp_testcases_bin_check_icmpv4_connectivity",
+    ":ltp_testcases_bin_check_icmpv6_connectivity",
+    ":ltp_testcases_bin_check_netem",
+    ":ltp_testcases_bin_check_setkey",
+    ":ltp_testcases_bin_cleanup_lvm.sh",
+    ":ltp_testcases_bin_cmdlib.sh",
+    ":ltp_testcases_bin_cp_tests.sh",
+    ":ltp_testcases_bin_cpio_tests.sh",
+    ":ltp_testcases_bin_cpuacct.sh",
+    ":ltp_testcases_bin_cpuhotplug01.sh",
+    ":ltp_testcases_bin_cpuhotplug02.sh",
+    ":ltp_testcases_bin_cpuhotplug03.sh",
+    ":ltp_testcases_bin_cpuhotplug04.sh",
+    ":ltp_testcases_bin_cpuhotplug05.sh",
+    ":ltp_testcases_bin_cpuhotplug06.sh",
+    ":ltp_testcases_bin_cpuhotplug07.sh",
+    ":ltp_testcases_bin_cpuhotplug_do_disk_write_loop",
+    ":ltp_testcases_bin_cpuhotplug_do_kcompile_loop",
+    ":ltp_testcases_bin_cpuhotplug_do_spin_loop",
+    ":ltp_testcases_bin_cpuhotplug_hotplug.sh",
+    ":ltp_testcases_bin_cpuhotplug_report_proc_interrupts",
+    ":ltp_testcases_bin_cpuhotplug_testsuite.sh",
+    ":ltp_testcases_bin_cpuset_base_ops_testset.sh",
+    ":ltp_testcases_bin_cpuset_exclusive_test.sh",
+    ":ltp_testcases_bin_cpuset_funcs.sh",
+    ":ltp_testcases_bin_cpuset_hierarchy_test.sh",
+    ":ltp_testcases_bin_cpuset_hotplug_test.sh",
+    ":ltp_testcases_bin_cpuset_inherit_testset.sh",
+    ":ltp_testcases_bin_cpuset_load_balance_test.sh",
+    ":ltp_testcases_bin_cpuset_memory_pressure_testset.sh",
+    ":ltp_testcases_bin_cpuset_memory_spread_testset.sh",
+    ":ltp_testcases_bin_cpuset_memory_testset.sh",
+    ":ltp_testcases_bin_cpuset_regression_test.sh",
+    ":ltp_testcases_bin_cpuset_sched_domains_test.sh",
+    ":ltp_testcases_bin_cpuset_syscall_testset.sh",
+    ":ltp_testcases_bin_create_file",
+    ":ltp_testcases_bin_daemonlib.sh",
+    ":ltp_testcases_bin_data",
+    ":ltp_testcases_bin_dccp01.sh",
+    ":ltp_testcases_bin_dccp_ipsec.sh",
+    ":ltp_testcases_bin_dccp_ipsec_vti.sh",
+    ":ltp_testcases_bin_dctcp01.sh",
+    ":ltp_testcases_bin_dhcp_lib.sh",
+    ":ltp_testcases_bin_dhcpd_tests.sh",
+    ":ltp_testcases_bin_dns-stress-lib.sh",
+    ":ltp_testcases_bin_dns-stress.sh",
+    ":ltp_testcases_bin_dns-stress01-rmt.sh",
+    ":ltp_testcases_bin_dns-stress02-rmt.sh",
+    ":ltp_testcases_bin_dnsmasq_tests.sh",
+    ":ltp_testcases_bin_dynamic_debug01.sh",
+    ":ltp_testcases_bin_evm_overlay.sh",
+    ":ltp_testcases_bin_file01.sh",
+    ":ltp_testcases_bin_filecapstest.sh",
+    ":ltp_testcases_bin_find_portbundle",
+    ":ltp_testcases_bin_force_erase.sh",
+    ":ltp_testcases_bin_fork_freeze.sh",
+    ":ltp_testcases_bin_fou01.sh",
+    ":ltp_testcases_bin_freeze_cancel.sh",
+    ":ltp_testcases_bin_freeze_kill_thaw.sh",
+    ":ltp_testcases_bin_freeze_move_thaw.sh",
+    ":ltp_testcases_bin_freeze_self_thaw.sh",
+    ":ltp_testcases_bin_freeze_sleep_thaw.sh",
+    ":ltp_testcases_bin_freeze_thaw.sh",
+    ":ltp_testcases_bin_freeze_write_freezing.sh",
+    ":ltp_testcases_bin_fs_bind01.sh",
+    ":ltp_testcases_bin_fs_bind02.sh",
+    ":ltp_testcases_bin_fs_bind03.sh",
+    ":ltp_testcases_bin_fs_bind04.sh",
+    ":ltp_testcases_bin_fs_bind05.sh",
+    ":ltp_testcases_bin_fs_bind06.sh",
+    ":ltp_testcases_bin_fs_bind07-2.sh",
+    ":ltp_testcases_bin_fs_bind07.sh",
+    ":ltp_testcases_bin_fs_bind08.sh",
+    ":ltp_testcases_bin_fs_bind09.sh",
+    ":ltp_testcases_bin_fs_bind10.sh",
+    ":ltp_testcases_bin_fs_bind11.sh",
+    ":ltp_testcases_bin_fs_bind12.sh",
+    ":ltp_testcases_bin_fs_bind13.sh",
+    ":ltp_testcases_bin_fs_bind14.sh",
+    ":ltp_testcases_bin_fs_bind15.sh",
+    ":ltp_testcases_bin_fs_bind16.sh",
+    ":ltp_testcases_bin_fs_bind17.sh",
+    ":ltp_testcases_bin_fs_bind18.sh",
+    ":ltp_testcases_bin_fs_bind19.sh",
+    ":ltp_testcases_bin_fs_bind20.sh",
+    ":ltp_testcases_bin_fs_bind21.sh",
+    ":ltp_testcases_bin_fs_bind22.sh",
+    ":ltp_testcases_bin_fs_bind23.sh",
+    ":ltp_testcases_bin_fs_bind24.sh",
+    ":ltp_testcases_bin_fs_bind_cloneNS01.sh",
+    ":ltp_testcases_bin_fs_bind_cloneNS02.sh",
+    ":ltp_testcases_bin_fs_bind_cloneNS03.sh",
+    ":ltp_testcases_bin_fs_bind_cloneNS04.sh",
+    ":ltp_testcases_bin_fs_bind_cloneNS05.sh",
+    ":ltp_testcases_bin_fs_bind_cloneNS06.sh",
+    ":ltp_testcases_bin_fs_bind_cloneNS07.sh",
+    ":ltp_testcases_bin_fs_bind_lib.sh",
+    ":ltp_testcases_bin_fs_bind_move01.sh",
+    ":ltp_testcases_bin_fs_bind_move02.sh",
+    ":ltp_testcases_bin_fs_bind_move03.sh",
+    ":ltp_testcases_bin_fs_bind_move04.sh",
+    ":ltp_testcases_bin_fs_bind_move05.sh",
+    ":ltp_testcases_bin_fs_bind_move06.sh",
+    ":ltp_testcases_bin_fs_bind_move07.sh",
+    ":ltp_testcases_bin_fs_bind_move08.sh",
+    ":ltp_testcases_bin_fs_bind_move09.sh",
+    ":ltp_testcases_bin_fs_bind_move10.sh",
+    ":ltp_testcases_bin_fs_bind_move11.sh",
+    ":ltp_testcases_bin_fs_bind_move12.sh",
+    ":ltp_testcases_bin_fs_bind_move13.sh",
+    ":ltp_testcases_bin_fs_bind_move14.sh",
+    ":ltp_testcases_bin_fs_bind_move15.sh",
+    ":ltp_testcases_bin_fs_bind_move16.sh",
+    ":ltp_testcases_bin_fs_bind_move17.sh",
+    ":ltp_testcases_bin_fs_bind_move18.sh",
+    ":ltp_testcases_bin_fs_bind_move19.sh",
+    ":ltp_testcases_bin_fs_bind_move20.sh",
+    ":ltp_testcases_bin_fs_bind_move21.sh",
+    ":ltp_testcases_bin_fs_bind_move22.sh",
+    ":ltp_testcases_bin_fs_bind_rbind01.sh",
+    ":ltp_testcases_bin_fs_bind_rbind02.sh",
+    ":ltp_testcases_bin_fs_bind_rbind03.sh",
+    ":ltp_testcases_bin_fs_bind_rbind04.sh",
+    ":ltp_testcases_bin_fs_bind_rbind05.sh",
+    ":ltp_testcases_bin_fs_bind_rbind06.sh",
+    ":ltp_testcases_bin_fs_bind_rbind07-2.sh",
+    ":ltp_testcases_bin_fs_bind_rbind07.sh",
+    ":ltp_testcases_bin_fs_bind_rbind08.sh",
+    ":ltp_testcases_bin_fs_bind_rbind09.sh",
+    ":ltp_testcases_bin_fs_bind_rbind10.sh",
+    ":ltp_testcases_bin_fs_bind_rbind11.sh",
+    ":ltp_testcases_bin_fs_bind_rbind12.sh",
+    ":ltp_testcases_bin_fs_bind_rbind13.sh",
+    ":ltp_testcases_bin_fs_bind_rbind14.sh",
+    ":ltp_testcases_bin_fs_bind_rbind15.sh",
+    ":ltp_testcases_bin_fs_bind_rbind16.sh",
+    ":ltp_testcases_bin_fs_bind_rbind17.sh",
+    ":ltp_testcases_bin_fs_bind_rbind18.sh",
+    ":ltp_testcases_bin_fs_bind_rbind19.sh",
+    ":ltp_testcases_bin_fs_bind_rbind20.sh",
+    ":ltp_testcases_bin_fs_bind_rbind21.sh",
+    ":ltp_testcases_bin_fs_bind_rbind22.sh",
+    ":ltp_testcases_bin_fs_bind_rbind23.sh",
+    ":ltp_testcases_bin_fs_bind_rbind24.sh",
+    ":ltp_testcases_bin_fs_bind_rbind25.sh",
+    ":ltp_testcases_bin_fs_bind_rbind26.sh",
+    ":ltp_testcases_bin_fs_bind_rbind27.sh",
+    ":ltp_testcases_bin_fs_bind_rbind28.sh",
+    ":ltp_testcases_bin_fs_bind_rbind29.sh",
+    ":ltp_testcases_bin_fs_bind_rbind30.sh",
+    ":ltp_testcases_bin_fs_bind_rbind31.sh",
+    ":ltp_testcases_bin_fs_bind_rbind32.sh",
+    ":ltp_testcases_bin_fs_bind_rbind33.sh",
+    ":ltp_testcases_bin_fs_bind_rbind34.sh",
+    ":ltp_testcases_bin_fs_bind_rbind35.sh",
+    ":ltp_testcases_bin_fs_bind_rbind36.sh",
+    ":ltp_testcases_bin_fs_bind_rbind37.sh",
+    ":ltp_testcases_bin_fs_bind_rbind38.sh",
+    ":ltp_testcases_bin_fs_bind_rbind39.sh",
+    ":ltp_testcases_bin_fs_bind_regression.sh",
+    ":ltp_testcases_bin_fs_di",
+    ":ltp_testcases_bin_fs_inod",
+    ":ltp_testcases_bin_fs_racer.sh",
+    ":ltp_testcases_bin_fs_racer_dir_create.sh",
+    ":ltp_testcases_bin_fs_racer_dir_test.sh",
+    ":ltp_testcases_bin_fs_racer_file_concat.sh",
+    ":ltp_testcases_bin_fs_racer_file_create.sh",
+    ":ltp_testcases_bin_fs_racer_file_link.sh",
+    ":ltp_testcases_bin_fs_racer_file_list.sh",
+    ":ltp_testcases_bin_fs_racer_file_rename.sh",
+    ":ltp_testcases_bin_fs_racer_file_rm.sh",
+    ":ltp_testcases_bin_fs_racer_file_symlink.sh",
+    ":ltp_testcases_bin_fsx.sh",
+    ":ltp_testcases_bin_ftp-download-stress.sh",
+    ":ltp_testcases_bin_ftp-download-stress01-rmt.sh",
+    ":ltp_testcases_bin_ftp-download-stress02-rmt.sh",
+    ":ltp_testcases_bin_ftp-upload-stress.sh",
+    ":ltp_testcases_bin_ftp-upload-stress01-rmt.sh",
+    ":ltp_testcases_bin_ftp-upload-stress02-rmt.sh",
+    ":ltp_testcases_bin_ftp01.sh",
+    ":ltp_testcases_bin_ftrace_lib.sh",
+    ":ltp_testcases_bin_ftrace_regression01.sh",
+    ":ltp_testcases_bin_ftrace_regression02.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_buffer_size_kb.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_current_tracer.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_ftrace_enabled.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_function_profile_enabled.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_set_event.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_set_ftrace_filter.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_set_ftrace_pid.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_stack_max_size.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_stack_trace.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_trace.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_trace_clock.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_trace_options.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_trace_pipe.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_trace_stat.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_tracing_cpumask.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_tracing_enabled.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_tracing_max_latency.sh",
+    ":ltp_testcases_bin_ftrace_stress_ftrace_tracing_on.sh",
+    ":ltp_testcases_bin_ftrace_stress_test.sh",
+    ":ltp_testcases_bin_gdb01.sh",
+    ":ltp_testcases_bin_generate_lvm_runfile.sh",
+    ":ltp_testcases_bin_geneve01.sh",
+    ":ltp_testcases_bin_geneve02.sh",
+    ":ltp_testcases_bin_get_ifname",
+    ":ltp_testcases_bin_gre01.sh",
+    ":ltp_testcases_bin_gre02.sh",
+    ":ltp_testcases_bin_http-stress.sh",
+    ":ltp_testcases_bin_http-stress01-rmt.sh",
+    ":ltp_testcases_bin_http-stress02-rmt.sh",
+    ":ltp_testcases_bin_icmp-uni-basic.sh",
+    ":ltp_testcases_bin_icmp-uni-vti.sh",
+    ":ltp_testcases_bin_icmp4-multi-diffip01",
+    ":ltp_testcases_bin_icmp4-multi-diffip02",
+    ":ltp_testcases_bin_icmp4-multi-diffip03",
+    ":ltp_testcases_bin_icmp4-multi-diffip04",
+    ":ltp_testcases_bin_icmp4-multi-diffip05",
+    ":ltp_testcases_bin_icmp4-multi-diffip06",
+    ":ltp_testcases_bin_icmp4-multi-diffip07",
+    ":ltp_testcases_bin_icmp4-multi-diffnic01",
+    ":ltp_testcases_bin_icmp4-multi-diffnic02",
+    ":ltp_testcases_bin_icmp4-multi-diffnic03",
+    ":ltp_testcases_bin_icmp4-multi-diffnic04",
+    ":ltp_testcases_bin_icmp4-multi-diffnic05",
+    ":ltp_testcases_bin_icmp4-multi-diffnic06",
+    ":ltp_testcases_bin_icmp4-multi-diffnic07",
+    ":ltp_testcases_bin_icmp6-multi-diffip01",
+    ":ltp_testcases_bin_icmp6-multi-diffip02",
+    ":ltp_testcases_bin_icmp6-multi-diffip03",
+    ":ltp_testcases_bin_icmp6-multi-diffip04",
+    ":ltp_testcases_bin_icmp6-multi-diffip05",
+    ":ltp_testcases_bin_icmp6-multi-diffip06",
+    ":ltp_testcases_bin_icmp6-multi-diffip07",
+    ":ltp_testcases_bin_icmp6-multi-diffnic01",
+    ":ltp_testcases_bin_icmp6-multi-diffnic02",
+    ":ltp_testcases_bin_icmp6-multi-diffnic03",
+    ":ltp_testcases_bin_icmp6-multi-diffnic04",
+    ":ltp_testcases_bin_icmp6-multi-diffnic05",
+    ":ltp_testcases_bin_icmp6-multi-diffnic06",
+    ":ltp_testcases_bin_icmp6-multi-diffnic07",
+    ":ltp_testcases_bin_if-addr-adddel.sh",
+    ":ltp_testcases_bin_if-addr-addlarge.sh",
+    ":ltp_testcases_bin_if-lib.sh",
+    ":ltp_testcases_bin_if-mtu-change.sh",
+    ":ltp_testcases_bin_if-route-adddel.sh",
+    ":ltp_testcases_bin_if-route-addlarge.sh",
+    ":ltp_testcases_bin_if-updown.sh",
+    ":ltp_testcases_bin_if4-addr-change.sh",
+    ":ltp_testcases_bin_ima_conditionals.sh",
+    ":ltp_testcases_bin_ima_kexec.sh",
+    ":ltp_testcases_bin_ima_keys.sh",
+    ":ltp_testcases_bin_ima_measurements.sh",
+    ":ltp_testcases_bin_ima_policy.sh",
+    ":ltp_testcases_bin_ima_selinux.sh",
+    ":ltp_testcases_bin_ima_setup.sh",
+    ":ltp_testcases_bin_ima_tpm.sh",
+    ":ltp_testcases_bin_ima_violations.sh",
+    ":ltp_testcases_bin_initialize_if",
+    ":ltp_testcases_bin_ip_tests.sh",
+    ":ltp_testcases_bin_ipneigh01.sh",
+    ":ltp_testcases_bin_ipsec_lib.sh",
+    ":ltp_testcases_bin_iptables01.sh",
+    ":ltp_testcases_bin_iptables_lib.sh",
+    ":ltp_testcases_bin_ipvlan01.sh",
+    ":ltp_testcases_bin_isofs.sh",
+    ":ltp_testcases_bin_killall_icmp_traffic",
+    ":ltp_testcases_bin_killall_tcp_traffic",
+    ":ltp_testcases_bin_killall_udp_traffic",
+    ":ltp_testcases_bin_ld01.sh",
+    ":ltp_testcases_bin_ldd01.sh",
+    ":ltp_testcases_bin_libcgroup_freezer",
+    ":ltp_testcases_bin_linktest.sh",
+    ":ltp_testcases_bin_ln_tests.sh",
+    ":ltp_testcases_bin_lock_torture.sh",
+    ":ltp_testcases_bin_ltpSockets.sh",
+    ":ltp_testcases_bin_macsec01.sh",
+    ":ltp_testcases_bin_macsec02.sh",
+    ":ltp_testcases_bin_macsec03.sh",
+    ":ltp_testcases_bin_macsec_lib.sh",
+    ":ltp_testcases_bin_macvlan01.sh",
+    ":ltp_testcases_bin_macvtap01.sh",
+    ":ltp_testcases_bin_mc_cmds.sh",
+    ":ltp_testcases_bin_mc_commo.sh",
+    ":ltp_testcases_bin_mc_member.sh",
+    ":ltp_testcases_bin_mc_opts.sh",
+    ":ltp_testcases_bin_mcast-group-multiple-socket.sh",
+    ":ltp_testcases_bin_mcast-group-same-group.sh",
+    ":ltp_testcases_bin_mcast-group-single-socket.sh",
+    ":ltp_testcases_bin_mcast-group-source-filter.sh",
+    ":ltp_testcases_bin_mcast-lib.sh",
+    ":ltp_testcases_bin_mcast-pktfld01.sh",
+    ":ltp_testcases_bin_mcast-pktfld02.sh",
+    ":ltp_testcases_bin_mcast-queryfld01.sh",
+    ":ltp_testcases_bin_mcast-queryfld02.sh",
+    ":ltp_testcases_bin_mcast-queryfld03.sh",
+    ":ltp_testcases_bin_mcast-queryfld04.sh",
+    ":ltp_testcases_bin_mcast-queryfld05.sh",
+    ":ltp_testcases_bin_mcast-queryfld06.sh",
+    ":ltp_testcases_bin_memcg_control_test.sh",
+    ":ltp_testcases_bin_memcg_failcnt.sh",
+    ":ltp_testcases_bin_memcg_force_empty.sh",
+    ":ltp_testcases_bin_memcg_lib.sh",
+    ":ltp_testcases_bin_memcg_limit_in_bytes.sh",
+    ":ltp_testcases_bin_memcg_max_usage_in_bytes_test.sh",
+    ":ltp_testcases_bin_memcg_memsw_limit_in_bytes_test.sh",
+    ":ltp_testcases_bin_memcg_move_charge_at_immigrate_test.sh",
+    ":ltp_testcases_bin_memcg_regression_test.sh",
+    ":ltp_testcases_bin_memcg_stat_rss.sh",
+    ":ltp_testcases_bin_memcg_stat_test.sh",
+    ":ltp_testcases_bin_memcg_stress_test.sh",
+    ":ltp_testcases_bin_memcg_subgroup_charge.sh",
+    ":ltp_testcases_bin_memcg_test_4.sh",
+    ":ltp_testcases_bin_memcg_usage_in_bytes_test.sh",
+    ":ltp_testcases_bin_memcg_use_hierarchy_test.sh",
+    ":ltp_testcases_bin_mkdir_tests.sh",
+    ":ltp_testcases_bin_mpls01.sh",
+    ":ltp_testcases_bin_mpls02.sh",
+    ":ltp_testcases_bin_mpls03.sh",
+    ":ltp_testcases_bin_mpls04.sh",
+    ":ltp_testcases_bin_mpls_lib.sh",
+    ":ltp_testcases_bin_myfunctions.sh",
+    ":ltp_testcases_bin_net_cmdlib.sh",
+    ":ltp_testcases_bin_netns_lib.sh",
+    ":ltp_testcases_bin_netstat01.sh",
+    ":ltp_testcases_bin_nfs01.sh",
+    ":ltp_testcases_bin_nfs02.sh",
+    ":ltp_testcases_bin_nfs03.sh",
+    ":ltp_testcases_bin_nfs04.sh",
+    ":ltp_testcases_bin_nfs05.sh",
+    ":ltp_testcases_bin_nfs06.sh",
+    ":ltp_testcases_bin_nfs07.sh",
+    ":ltp_testcases_bin_nfs08.sh",
+    ":ltp_testcases_bin_nfs09.sh",
+    ":ltp_testcases_bin_nfs_lib.sh",
+    ":ltp_testcases_bin_nfslock01.sh",
+    ":ltp_testcases_bin_nfsstat01.sh",
+    ":ltp_testcases_bin_nft01.sh",
+    ":ltp_testcases_bin_nm01.sh",
+    ":ltp_testcases_bin_ns-echoclient",
+    ":ltp_testcases_bin_numa01.sh",
+    ":ltp_testcases_bin_output_ipsec_conf",
+    ":ltp_testcases_bin_parameters.sh",
+    ":ltp_testcases_bin_pids.sh",
+    ":ltp_testcases_bin_ping01.sh",
+    ":ltp_testcases_bin_ping02.sh",
+    ":ltp_testcases_bin_pm_cpu_consolidation.py",
+    ":ltp_testcases_bin_pm_ilb_test.py",
+    ":ltp_testcases_bin_pm_include.sh",
+    ":ltp_testcases_bin_pm_sched_domain.py",
+    ":ltp_testcases_bin_pm_sched_mc.py",
+    ":ltp_testcases_bin_prepare_lvm.sh",
+    ":ltp_testcases_bin_quota_remount_test01.sh",
+    ":ltp_testcases_bin_rcu_torture.sh",
+    ":ltp_testcases_bin_remove_password.sh",
+    ":ltp_testcases_bin_route-change-dst.sh",
+    ":ltp_testcases_bin_route-change-gw.sh",
+    ":ltp_testcases_bin_route-change-if.sh",
+    ":ltp_testcases_bin_route-change-netlink-dst.sh",
+    ":ltp_testcases_bin_route-change-netlink-gw.sh",
+    ":ltp_testcases_bin_route-change-netlink-if.sh",
+    ":ltp_testcases_bin_route-lib.sh",
+    ":ltp_testcases_bin_route-redirect.sh",
+    ":ltp_testcases_bin_route4-rmmod",
+    ":ltp_testcases_bin_route6-rmmod",
+    ":ltp_testcases_bin_run_capbounds.sh",
+    ":ltp_testcases_bin_run_cpuctl_latency_test.sh",
+    ":ltp_testcases_bin_run_cpuctl_stress_test.sh",
+    ":ltp_testcases_bin_run_cpuctl_test.sh",
+    ":ltp_testcases_bin_run_cpuctl_test_fj.sh",
+    ":ltp_testcases_bin_run_freezer.sh",
+    ":ltp_testcases_bin_run_memctl_test.sh",
+    ":ltp_testcases_bin_run_sched_cliserv.sh",
+    ":ltp_testcases_bin_runpwtests01.sh",
+    ":ltp_testcases_bin_runpwtests02.sh",
+    ":ltp_testcases_bin_runpwtests03.sh",
+    ":ltp_testcases_bin_runpwtests04.sh",
+    ":ltp_testcases_bin_runpwtests05.sh",
+    ":ltp_testcases_bin_runpwtests06.sh",
+    ":ltp_testcases_bin_runpwtests_exclusive01.sh",
+    ":ltp_testcases_bin_runpwtests_exclusive02.sh",
+    ":ltp_testcases_bin_runpwtests_exclusive03.sh",
+    ":ltp_testcases_bin_runpwtests_exclusive04.sh",
+    ":ltp_testcases_bin_runpwtests_exclusive05.sh",
+    ":ltp_testcases_bin_rwtest",
+    ":ltp_testcases_bin_sched_stress.sh",
+    ":ltp_testcases_bin_sctp01.sh",
+    ":ltp_testcases_bin_sctp_ipsec.sh",
+    ":ltp_testcases_bin_sctp_ipsec_vti.sh",
+    ":ltp_testcases_bin_sendfile01.sh",
+    ":ltp_testcases_bin_set_ipv4addr",
+    ":ltp_testcases_bin_shell_pipe01.sh",
+    ":ltp_testcases_bin_sit01.sh",
+    ":ltp_testcases_bin_smack_common.sh",
+    ":ltp_testcases_bin_smack_file_access.sh",
+    ":ltp_testcases_bin_smack_set_ambient.sh",
+    ":ltp_testcases_bin_smack_set_cipso.sh",
+    ":ltp_testcases_bin_smack_set_current.sh",
+    ":ltp_testcases_bin_smack_set_direct.sh",
+    ":ltp_testcases_bin_smack_set_doi.sh",
+    ":ltp_testcases_bin_smack_set_load.sh",
+    ":ltp_testcases_bin_smack_set_netlabel.sh",
+    ":ltp_testcases_bin_smack_set_onlycap.sh",
+    ":ltp_testcases_bin_smt_smp_affinity.sh",
+    ":ltp_testcases_bin_smt_smp_enabled.sh",
+    ":ltp_testcases_bin_ssh-stress.sh",
+    ":ltp_testcases_bin_stop_freeze_sleep_thaw_cont.sh",
+    ":ltp_testcases_bin_stop_freeze_thaw_cont.sh",
+    ":ltp_testcases_bin_sysctl01.sh",
+    ":ltp_testcases_bin_sysctl02.sh",
+    ":ltp_testcases_bin_tc01.sh",
+    ":ltp_testcases_bin_tcp4-multi-diffip01",
+    ":ltp_testcases_bin_tcp4-multi-diffip02",
+    ":ltp_testcases_bin_tcp4-multi-diffip03",
+    ":ltp_testcases_bin_tcp4-multi-diffip04",
+    ":ltp_testcases_bin_tcp4-multi-diffip05",
+    ":ltp_testcases_bin_tcp4-multi-diffip06",
+    ":ltp_testcases_bin_tcp4-multi-diffip07",
+    ":ltp_testcases_bin_tcp4-multi-diffip08",
+    ":ltp_testcases_bin_tcp4-multi-diffip09",
+    ":ltp_testcases_bin_tcp4-multi-diffip10",
+    ":ltp_testcases_bin_tcp4-multi-diffip11",
+    ":ltp_testcases_bin_tcp4-multi-diffip12",
+    ":ltp_testcases_bin_tcp4-multi-diffip13",
+    ":ltp_testcases_bin_tcp4-multi-diffip14",
+    ":ltp_testcases_bin_tcp4-multi-diffnic01",
+    ":ltp_testcases_bin_tcp4-multi-diffnic02",
+    ":ltp_testcases_bin_tcp4-multi-diffnic03",
+    ":ltp_testcases_bin_tcp4-multi-diffnic04",
+    ":ltp_testcases_bin_tcp4-multi-diffnic05",
+    ":ltp_testcases_bin_tcp4-multi-diffnic06",
+    ":ltp_testcases_bin_tcp4-multi-diffnic07",
+    ":ltp_testcases_bin_tcp4-multi-diffnic08",
+    ":ltp_testcases_bin_tcp4-multi-diffnic09",
+    ":ltp_testcases_bin_tcp4-multi-diffnic10",
+    ":ltp_testcases_bin_tcp4-multi-diffnic11",
+    ":ltp_testcases_bin_tcp4-multi-diffnic12",
+    ":ltp_testcases_bin_tcp4-multi-diffnic13",
+    ":ltp_testcases_bin_tcp4-multi-diffnic14",
+    ":ltp_testcases_bin_tcp4-multi-diffport01",
+    ":ltp_testcases_bin_tcp4-multi-diffport02",
+    ":ltp_testcases_bin_tcp4-multi-diffport03",
+    ":ltp_testcases_bin_tcp4-multi-diffport04",
+    ":ltp_testcases_bin_tcp4-multi-diffport05",
+    ":ltp_testcases_bin_tcp4-multi-diffport06",
+    ":ltp_testcases_bin_tcp4-multi-diffport07",
+    ":ltp_testcases_bin_tcp4-multi-diffport08",
+    ":ltp_testcases_bin_tcp4-multi-diffport09",
+    ":ltp_testcases_bin_tcp4-multi-diffport10",
+    ":ltp_testcases_bin_tcp4-multi-diffport11",
+    ":ltp_testcases_bin_tcp4-multi-diffport12",
+    ":ltp_testcases_bin_tcp4-multi-diffport13",
+    ":ltp_testcases_bin_tcp4-multi-diffport14",
+    ":ltp_testcases_bin_tcp4-multi-sameport01",
+    ":ltp_testcases_bin_tcp4-multi-sameport02",
+    ":ltp_testcases_bin_tcp4-multi-sameport03",
+    ":ltp_testcases_bin_tcp4-multi-sameport04",
+    ":ltp_testcases_bin_tcp4-multi-sameport05",
+    ":ltp_testcases_bin_tcp4-multi-sameport06",
+    ":ltp_testcases_bin_tcp4-multi-sameport07",
+    ":ltp_testcases_bin_tcp4-multi-sameport08",
+    ":ltp_testcases_bin_tcp4-multi-sameport09",
+    ":ltp_testcases_bin_tcp4-multi-sameport10",
+    ":ltp_testcases_bin_tcp4-multi-sameport11",
+    ":ltp_testcases_bin_tcp4-multi-sameport12",
+    ":ltp_testcases_bin_tcp4-multi-sameport13",
+    ":ltp_testcases_bin_tcp4-multi-sameport14",
+    ":ltp_testcases_bin_tcp4-uni-basic01",
+    ":ltp_testcases_bin_tcp4-uni-basic02",
+    ":ltp_testcases_bin_tcp4-uni-basic03",
+    ":ltp_testcases_bin_tcp4-uni-basic04",
+    ":ltp_testcases_bin_tcp4-uni-basic05",
+    ":ltp_testcases_bin_tcp4-uni-basic06",
+    ":ltp_testcases_bin_tcp4-uni-basic07",
+    ":ltp_testcases_bin_tcp4-uni-basic08",
+    ":ltp_testcases_bin_tcp4-uni-basic09",
+    ":ltp_testcases_bin_tcp4-uni-basic10",
+    ":ltp_testcases_bin_tcp4-uni-basic11",
+    ":ltp_testcases_bin_tcp4-uni-basic12",
+    ":ltp_testcases_bin_tcp4-uni-basic13",
+    ":ltp_testcases_bin_tcp4-uni-basic14",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff01",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff02",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff03",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff04",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff05",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff06",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff07",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff08",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff09",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff10",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff11",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff12",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff13",
+    ":ltp_testcases_bin_tcp4-uni-dsackoff14",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup01",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup02",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup03",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup04",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup05",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup06",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup07",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup08",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup09",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup10",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup11",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup12",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup13",
+    ":ltp_testcases_bin_tcp4-uni-pktlossdup14",
+    ":ltp_testcases_bin_tcp4-uni-sackoff01",
+    ":ltp_testcases_bin_tcp4-uni-sackoff02",
+    ":ltp_testcases_bin_tcp4-uni-sackoff03",
+    ":ltp_testcases_bin_tcp4-uni-sackoff04",
+    ":ltp_testcases_bin_tcp4-uni-sackoff05",
+    ":ltp_testcases_bin_tcp4-uni-sackoff06",
+    ":ltp_testcases_bin_tcp4-uni-sackoff07",
+    ":ltp_testcases_bin_tcp4-uni-sackoff08",
+    ":ltp_testcases_bin_tcp4-uni-sackoff09",
+    ":ltp_testcases_bin_tcp4-uni-sackoff10",
+    ":ltp_testcases_bin_tcp4-uni-sackoff11",
+    ":ltp_testcases_bin_tcp4-uni-sackoff12",
+    ":ltp_testcases_bin_tcp4-uni-sackoff13",
+    ":ltp_testcases_bin_tcp4-uni-sackoff14",
+    ":ltp_testcases_bin_tcp4-uni-smallsend01",
+    ":ltp_testcases_bin_tcp4-uni-smallsend02",
+    ":ltp_testcases_bin_tcp4-uni-smallsend03",
+    ":ltp_testcases_bin_tcp4-uni-smallsend04",
+    ":ltp_testcases_bin_tcp4-uni-smallsend05",
+    ":ltp_testcases_bin_tcp4-uni-smallsend06",
+    ":ltp_testcases_bin_tcp4-uni-smallsend07",
+    ":ltp_testcases_bin_tcp4-uni-smallsend08",
+    ":ltp_testcases_bin_tcp4-uni-smallsend09",
+    ":ltp_testcases_bin_tcp4-uni-smallsend10",
+    ":ltp_testcases_bin_tcp4-uni-smallsend11",
+    ":ltp_testcases_bin_tcp4-uni-smallsend12",
+    ":ltp_testcases_bin_tcp4-uni-smallsend13",
+    ":ltp_testcases_bin_tcp4-uni-smallsend14",
+    ":ltp_testcases_bin_tcp4-uni-tso01",
+    ":ltp_testcases_bin_tcp4-uni-tso02",
+    ":ltp_testcases_bin_tcp4-uni-tso03",
+    ":ltp_testcases_bin_tcp4-uni-tso04",
+    ":ltp_testcases_bin_tcp4-uni-tso05",
+    ":ltp_testcases_bin_tcp4-uni-tso06",
+    ":ltp_testcases_bin_tcp4-uni-tso07",
+    ":ltp_testcases_bin_tcp4-uni-tso08",
+    ":ltp_testcases_bin_tcp4-uni-tso09",
+    ":ltp_testcases_bin_tcp4-uni-tso10",
+    ":ltp_testcases_bin_tcp4-uni-tso11",
+    ":ltp_testcases_bin_tcp4-uni-tso12",
+    ":ltp_testcases_bin_tcp4-uni-tso13",
+    ":ltp_testcases_bin_tcp4-uni-tso14",
+    ":ltp_testcases_bin_tcp4-uni-winscale01",
+    ":ltp_testcases_bin_tcp4-uni-winscale02",
+    ":ltp_testcases_bin_tcp4-uni-winscale03",
+    ":ltp_testcases_bin_tcp4-uni-winscale04",
+    ":ltp_testcases_bin_tcp4-uni-winscale05",
+    ":ltp_testcases_bin_tcp4-uni-winscale06",
+    ":ltp_testcases_bin_tcp4-uni-winscale07",
+    ":ltp_testcases_bin_tcp4-uni-winscale08",
+    ":ltp_testcases_bin_tcp4-uni-winscale09",
+    ":ltp_testcases_bin_tcp4-uni-winscale10",
+    ":ltp_testcases_bin_tcp4-uni-winscale11",
+    ":ltp_testcases_bin_tcp4-uni-winscale12",
+    ":ltp_testcases_bin_tcp4-uni-winscale13",
+    ":ltp_testcases_bin_tcp4-uni-winscale14",
+    ":ltp_testcases_bin_tcp6-multi-diffip01",
+    ":ltp_testcases_bin_tcp6-multi-diffip02",
+    ":ltp_testcases_bin_tcp6-multi-diffip03",
+    ":ltp_testcases_bin_tcp6-multi-diffip04",
+    ":ltp_testcases_bin_tcp6-multi-diffip05",
+    ":ltp_testcases_bin_tcp6-multi-diffip06",
+    ":ltp_testcases_bin_tcp6-multi-diffip07",
+    ":ltp_testcases_bin_tcp6-multi-diffip08",
+    ":ltp_testcases_bin_tcp6-multi-diffip09",
+    ":ltp_testcases_bin_tcp6-multi-diffip10",
+    ":ltp_testcases_bin_tcp6-multi-diffip11",
+    ":ltp_testcases_bin_tcp6-multi-diffip12",
+    ":ltp_testcases_bin_tcp6-multi-diffip13",
+    ":ltp_testcases_bin_tcp6-multi-diffip14",
+    ":ltp_testcases_bin_tcp6-multi-diffnic01",
+    ":ltp_testcases_bin_tcp6-multi-diffnic02",
+    ":ltp_testcases_bin_tcp6-multi-diffnic03",
+    ":ltp_testcases_bin_tcp6-multi-diffnic04",
+    ":ltp_testcases_bin_tcp6-multi-diffnic05",
+    ":ltp_testcases_bin_tcp6-multi-diffnic06",
+    ":ltp_testcases_bin_tcp6-multi-diffnic07",
+    ":ltp_testcases_bin_tcp6-multi-diffnic08",
+    ":ltp_testcases_bin_tcp6-multi-diffnic09",
+    ":ltp_testcases_bin_tcp6-multi-diffnic10",
+    ":ltp_testcases_bin_tcp6-multi-diffnic11",
+    ":ltp_testcases_bin_tcp6-multi-diffnic12",
+    ":ltp_testcases_bin_tcp6-multi-diffnic13",
+    ":ltp_testcases_bin_tcp6-multi-diffnic14",
+    ":ltp_testcases_bin_tcp6-multi-diffport01",
+    ":ltp_testcases_bin_tcp6-multi-diffport02",
+    ":ltp_testcases_bin_tcp6-multi-diffport03",
+    ":ltp_testcases_bin_tcp6-multi-diffport04",
+    ":ltp_testcases_bin_tcp6-multi-diffport05",
+    ":ltp_testcases_bin_tcp6-multi-diffport06",
+    ":ltp_testcases_bin_tcp6-multi-diffport07",
+    ":ltp_testcases_bin_tcp6-multi-diffport08",
+    ":ltp_testcases_bin_tcp6-multi-diffport09",
+    ":ltp_testcases_bin_tcp6-multi-diffport10",
+    ":ltp_testcases_bin_tcp6-multi-diffport11",
+    ":ltp_testcases_bin_tcp6-multi-diffport12",
+    ":ltp_testcases_bin_tcp6-multi-diffport13",
+    ":ltp_testcases_bin_tcp6-multi-diffport14",
+    ":ltp_testcases_bin_tcp6-multi-sameport01",
+    ":ltp_testcases_bin_tcp6-multi-sameport02",
+    ":ltp_testcases_bin_tcp6-multi-sameport03",
+    ":ltp_testcases_bin_tcp6-multi-sameport04",
+    ":ltp_testcases_bin_tcp6-multi-sameport05",
+    ":ltp_testcases_bin_tcp6-multi-sameport06",
+    ":ltp_testcases_bin_tcp6-multi-sameport07",
+    ":ltp_testcases_bin_tcp6-multi-sameport08",
+    ":ltp_testcases_bin_tcp6-multi-sameport09",
+    ":ltp_testcases_bin_tcp6-multi-sameport10",
+    ":ltp_testcases_bin_tcp6-multi-sameport11",
+    ":ltp_testcases_bin_tcp6-multi-sameport12",
+    ":ltp_testcases_bin_tcp6-multi-sameport13",
+    ":ltp_testcases_bin_tcp6-multi-sameport14",
+    ":ltp_testcases_bin_tcp6-uni-basic01",
+    ":ltp_testcases_bin_tcp6-uni-basic02",
+    ":ltp_testcases_bin_tcp6-uni-basic03",
+    ":ltp_testcases_bin_tcp6-uni-basic04",
+    ":ltp_testcases_bin_tcp6-uni-basic05",
+    ":ltp_testcases_bin_tcp6-uni-basic06",
+    ":ltp_testcases_bin_tcp6-uni-basic07",
+    ":ltp_testcases_bin_tcp6-uni-basic08",
+    ":ltp_testcases_bin_tcp6-uni-basic09",
+    ":ltp_testcases_bin_tcp6-uni-basic10",
+    ":ltp_testcases_bin_tcp6-uni-basic11",
+    ":ltp_testcases_bin_tcp6-uni-basic12",
+    ":ltp_testcases_bin_tcp6-uni-basic13",
+    ":ltp_testcases_bin_tcp6-uni-basic14",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff01",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff02",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff03",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff04",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff05",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff06",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff07",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff08",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff09",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff10",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff11",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff12",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff13",
+    ":ltp_testcases_bin_tcp6-uni-dsackoff14",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup01",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup02",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup03",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup04",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup05",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup06",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup07",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup08",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup09",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup10",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup11",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup12",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup13",
+    ":ltp_testcases_bin_tcp6-uni-pktlossdup14",
+    ":ltp_testcases_bin_tcp6-uni-sackoff01",
+    ":ltp_testcases_bin_tcp6-uni-sackoff02",
+    ":ltp_testcases_bin_tcp6-uni-sackoff03",
+    ":ltp_testcases_bin_tcp6-uni-sackoff04",
+    ":ltp_testcases_bin_tcp6-uni-sackoff05",
+    ":ltp_testcases_bin_tcp6-uni-sackoff06",
+    ":ltp_testcases_bin_tcp6-uni-sackoff07",
+    ":ltp_testcases_bin_tcp6-uni-sackoff08",
+    ":ltp_testcases_bin_tcp6-uni-sackoff09",
+    ":ltp_testcases_bin_tcp6-uni-sackoff10",
+    ":ltp_testcases_bin_tcp6-uni-sackoff11",
+    ":ltp_testcases_bin_tcp6-uni-sackoff12",
+    ":ltp_testcases_bin_tcp6-uni-sackoff13",
+    ":ltp_testcases_bin_tcp6-uni-sackoff14",
+    ":ltp_testcases_bin_tcp6-uni-smallsend01",
+    ":ltp_testcases_bin_tcp6-uni-smallsend02",
+    ":ltp_testcases_bin_tcp6-uni-smallsend03",
+    ":ltp_testcases_bin_tcp6-uni-smallsend04",
+    ":ltp_testcases_bin_tcp6-uni-smallsend05",
+    ":ltp_testcases_bin_tcp6-uni-smallsend06",
+    ":ltp_testcases_bin_tcp6-uni-smallsend07",
+    ":ltp_testcases_bin_tcp6-uni-smallsend08",
+    ":ltp_testcases_bin_tcp6-uni-smallsend09",
+    ":ltp_testcases_bin_tcp6-uni-smallsend10",
+    ":ltp_testcases_bin_tcp6-uni-smallsend11",
+    ":ltp_testcases_bin_tcp6-uni-smallsend12",
+    ":ltp_testcases_bin_tcp6-uni-smallsend13",
+    ":ltp_testcases_bin_tcp6-uni-smallsend14",
+    ":ltp_testcases_bin_tcp6-uni-tso01",
+    ":ltp_testcases_bin_tcp6-uni-tso02",
+    ":ltp_testcases_bin_tcp6-uni-tso03",
+    ":ltp_testcases_bin_tcp6-uni-tso04",
+    ":ltp_testcases_bin_tcp6-uni-tso05",
+    ":ltp_testcases_bin_tcp6-uni-tso06",
+    ":ltp_testcases_bin_tcp6-uni-tso07",
+    ":ltp_testcases_bin_tcp6-uni-tso08",
+    ":ltp_testcases_bin_tcp6-uni-tso09",
+    ":ltp_testcases_bin_tcp6-uni-tso10",
+    ":ltp_testcases_bin_tcp6-uni-tso11",
+    ":ltp_testcases_bin_tcp6-uni-tso12",
+    ":ltp_testcases_bin_tcp6-uni-tso13",
+    ":ltp_testcases_bin_tcp6-uni-tso14",
+    ":ltp_testcases_bin_tcp6-uni-winscale01",
+    ":ltp_testcases_bin_tcp6-uni-winscale02",
+    ":ltp_testcases_bin_tcp6-uni-winscale03",
+    ":ltp_testcases_bin_tcp6-uni-winscale04",
+    ":ltp_testcases_bin_tcp6-uni-winscale05",
+    ":ltp_testcases_bin_tcp6-uni-winscale06",
+    ":ltp_testcases_bin_tcp6-uni-winscale07",
+    ":ltp_testcases_bin_tcp6-uni-winscale08",
+    ":ltp_testcases_bin_tcp6-uni-winscale09",
+    ":ltp_testcases_bin_tcp6-uni-winscale10",
+    ":ltp_testcases_bin_tcp6-uni-winscale11",
+    ":ltp_testcases_bin_tcp6-uni-winscale12",
+    ":ltp_testcases_bin_tcp6-uni-winscale13",
+    ":ltp_testcases_bin_tcp6-uni-winscale14",
+    ":ltp_testcases_bin_tcp_cc_lib.sh",
+    ":ltp_testcases_bin_tcp_fastopen_run.sh",
+    ":ltp_testcases_bin_tcp_ipsec.sh",
+    ":ltp_testcases_bin_tcp_ipsec_vti.sh",
+    ":ltp_testcases_bin_tcpdump01.sh",
+    ":ltp_testcases_bin_test.sh",
+    ":ltp_testcases_bin_test_controllers.sh",
+    ":ltp_testcases_bin_test_ioctl",
+    ":ltp_testcases_bin_test_robind.sh",
+    ":ltp_testcases_bin_tracepath01.sh",
+    ":ltp_testcases_bin_traceroute01.sh",
+    ":ltp_testcases_bin_tst_ansi_color.sh",
+    ":ltp_testcases_bin_tst_net.sh",
+    ":ltp_testcases_bin_tst_net_stress.sh",
+    ":ltp_testcases_bin_tst_security.sh",
+    ":ltp_testcases_bin_tst_test.sh",
+    ":ltp_testcases_bin_udp4-multi-diffip01",
+    ":ltp_testcases_bin_udp4-multi-diffip02",
+    ":ltp_testcases_bin_udp4-multi-diffip03",
+    ":ltp_testcases_bin_udp4-multi-diffip04",
+    ":ltp_testcases_bin_udp4-multi-diffip05",
+    ":ltp_testcases_bin_udp4-multi-diffip06",
+    ":ltp_testcases_bin_udp4-multi-diffip07",
+    ":ltp_testcases_bin_udp4-multi-diffnic01",
+    ":ltp_testcases_bin_udp4-multi-diffnic02",
+    ":ltp_testcases_bin_udp4-multi-diffnic03",
+    ":ltp_testcases_bin_udp4-multi-diffnic04",
+    ":ltp_testcases_bin_udp4-multi-diffnic05",
+    ":ltp_testcases_bin_udp4-multi-diffnic06",
+    ":ltp_testcases_bin_udp4-multi-diffnic07",
+    ":ltp_testcases_bin_udp4-multi-diffport01",
+    ":ltp_testcases_bin_udp4-multi-diffport02",
+    ":ltp_testcases_bin_udp4-multi-diffport03",
+    ":ltp_testcases_bin_udp4-multi-diffport04",
+    ":ltp_testcases_bin_udp4-multi-diffport05",
+    ":ltp_testcases_bin_udp4-multi-diffport06",
+    ":ltp_testcases_bin_udp4-multi-diffport07",
+    ":ltp_testcases_bin_udp4-uni-basic01",
+    ":ltp_testcases_bin_udp4-uni-basic02",
+    ":ltp_testcases_bin_udp4-uni-basic03",
+    ":ltp_testcases_bin_udp4-uni-basic04",
+    ":ltp_testcases_bin_udp4-uni-basic05",
+    ":ltp_testcases_bin_udp4-uni-basic06",
+    ":ltp_testcases_bin_udp4-uni-basic07",
+    ":ltp_testcases_bin_udp6-multi-diffip01",
+    ":ltp_testcases_bin_udp6-multi-diffip02",
+    ":ltp_testcases_bin_udp6-multi-diffip03",
+    ":ltp_testcases_bin_udp6-multi-diffip04",
+    ":ltp_testcases_bin_udp6-multi-diffip05",
+    ":ltp_testcases_bin_udp6-multi-diffip06",
+    ":ltp_testcases_bin_udp6-multi-diffip07",
+    ":ltp_testcases_bin_udp6-multi-diffnic01",
+    ":ltp_testcases_bin_udp6-multi-diffnic02",
+    ":ltp_testcases_bin_udp6-multi-diffnic03",
+    ":ltp_testcases_bin_udp6-multi-diffnic04",
+    ":ltp_testcases_bin_udp6-multi-diffnic05",
+    ":ltp_testcases_bin_udp6-multi-diffnic06",
+    ":ltp_testcases_bin_udp6-multi-diffnic07",
+    ":ltp_testcases_bin_udp6-multi-diffport01",
+    ":ltp_testcases_bin_udp6-multi-diffport02",
+    ":ltp_testcases_bin_udp6-multi-diffport03",
+    ":ltp_testcases_bin_udp6-multi-diffport04",
+    ":ltp_testcases_bin_udp6-multi-diffport05",
+    ":ltp_testcases_bin_udp6-multi-diffport06",
+    ":ltp_testcases_bin_udp6-multi-diffport07",
+    ":ltp_testcases_bin_udp6-uni-basic01",
+    ":ltp_testcases_bin_udp6-uni-basic02",
+    ":ltp_testcases_bin_udp6-uni-basic03",
+    ":ltp_testcases_bin_udp6-uni-basic04",
+    ":ltp_testcases_bin_udp6-uni-basic05",
+    ":ltp_testcases_bin_udp6-uni-basic06",
+    ":ltp_testcases_bin_udp6-uni-basic07",
+    ":ltp_testcases_bin_udp_ipsec.sh",
+    ":ltp_testcases_bin_udp_ipsec_vti.sh",
+    ":ltp_testcases_bin_unshare01.sh",
+    ":ltp_testcases_bin_unzip01.sh",
+    ":ltp_testcases_bin_vfork_freeze.sh",
+    ":ltp_testcases_bin_virt_lib.sh",
+    ":ltp_testcases_bin_vlan01.sh",
+    ":ltp_testcases_bin_vlan02.sh",
+    ":ltp_testcases_bin_vlan03.sh",
+    ":ltp_testcases_bin_vma05.sh",
+    ":ltp_testcases_bin_vxlan01.sh",
+    ":ltp_testcases_bin_vxlan02.sh",
+    ":ltp_testcases_bin_vxlan03.sh",
+    ":ltp_testcases_bin_vxlan04.sh",
+    ":ltp_testcases_bin_wireguard01.sh",
+    ":ltp_testcases_bin_wireguard02.sh",
+    ":ltp_testcases_bin_wireguard_lib.sh",
+    ":ltp_testcases_bin_write_freezing.sh",
+    ":ltp_testcases_bin_zram01.sh",
+    ":ltp_testcases_bin_zram02.sh",
+    ":ltp_testcases_bin_zram_lib.sh",
+    ":ltp_testcases_data_ar01_file1.in",
+    ":ltp_testcases_data_ar01_file10.in",
+    ":ltp_testcases_data_ar01_file2.in",
+    ":ltp_testcases_data_ar01_file3.in",
+    ":ltp_testcases_data_ar01_file4.in",
+    ":ltp_testcases_data_binfmt_misc02_file.extension",
+    ":ltp_testcases_data_binfmt_misc02_file.magic",
+    ":ltp_testcases_data_file01_in.ar",
+    ":ltp_testcases_data_file01_in.bash",
+    ":ltp_testcases_data_file01_in.c",
+    ":ltp_testcases_data_file01_in.jpg",
+    ":ltp_testcases_data_file01_in.m4",
+    ":ltp_testcases_data_file01_in.mp3",
+    ":ltp_testcases_data_file01_in.pl",
+    ":ltp_testcases_data_file01_in.png",
+    ":ltp_testcases_data_file01_in.py",
+    ":ltp_testcases_data_file01_in.sh",
+    ":ltp_testcases_data_file01_in.src.rpm",
+    ":ltp_testcases_data_file01_in.tar",
+    ":ltp_testcases_data_file01_in.tar.bz2",
+    ":ltp_testcases_data_file01_in.tar.gz",
+    ":ltp_testcases_data_file01_in.txt",
+    ":ltp_testcases_data_file01_in.wav",
+    ":ltp_testcases_data_file01_in.zip",
+    ":ltp_testcases_data_ima_kexec_kexec.policy",
+    ":ltp_testcases_data_ima_keys_keycheck.policy",
+    ":ltp_testcases_data_ima_keys_x509_ima.der",
+    ":ltp_testcases_data_ima_policy_measure.policy",
+    ":ltp_testcases_data_ima_policy_measure.policy-invalid",
+    ":ltp_testcases_data_ima_selinux_selinux.policy",
+    ":ltp_testcases_data_ld01_d1.c",
+    ":ltp_testcases_data_ld01_f1.c",
+    ":ltp_testcases_data_ld01_main.c",
+    ":ltp_testcases_data_ld01_rd1.c",
+    ":ltp_testcases_data_ld01_rf1.c",
+    ":ltp_testcases_data_lvm_runfile.tpl",
+    ":ltp_testcases_data_mc_member_ManyGroups",
+    ":ltp_testcases_data_mc_member_TooManyGroups",
+    ":ltp_testcases_data_rpc01_file.1",
+    ":ltp_testcases_data_rpc01_file.2",
+    ":ltp_testcases_data_unzip01_dir.out",
+    ":ltp_testcases_data_unzip01_test.zip",
+    ":ltp_testsf_c",
+    ":ltp_testsf_c6",
+    ":ltp_testsf_s",
+    ":ltp_testsf_s6",
+    ":ltp_tgkill01",
+    ":ltp_tgkill02",
+    ":ltp_tgkill03",
+    ":ltp_thp01",
+    ":ltp_thp02",
+    ":ltp_thp03",
+    ":ltp_thp04",
+    ":ltp_time-schedule",
+    ":ltp_time01",
+    ":ltp_timed_forkbomb",
+    ":ltp_timens01",
+    ":ltp_timer_create01",
+    ":ltp_timer_create02",
+    ":ltp_timer_create03",
+    ":ltp_timer_delete01",
+    ":ltp_timer_delete02",
+    ":ltp_timer_getoverrun01",
+    ":ltp_timer_gettime01",
+    ":ltp_timer_settime01",
+    ":ltp_timer_settime02",
+    ":ltp_timer_settime03",
+    ":ltp_timerfd01",
+    ":ltp_timerfd02",
+    ":ltp_timerfd04",
+    ":ltp_timerfd_create01",
+    ":ltp_timerfd_gettime01",
+    ":ltp_timerfd_settime01",
+    ":ltp_timerfd_settime02",
+    ":ltp_times01",
+    ":ltp_times03",
+    ":ltp_tkill01",
+    ":ltp_tkill02",
+    ":ltp_tpci",
+    ":ltp_trace_sched",
+    ":ltp_trerrno",
+    ":ltp_truncate02",
+    ":ltp_truncate02_64",
+    ":ltp_truncate03",
+    ":ltp_truncate03_64",
+    ":ltp_tst_bool_expr",
+    ":ltp_tst_brk",
+    ":ltp_tst_brkm",
+    ":ltp_tst_capability01",
+    ":ltp_tst_capability02",
+    ":ltp_tst_cgctl",
+    ":ltp_tst_cgroup01",
+    ":ltp_tst_cgroup02",
+    ":ltp_tst_check_drivers",
+    ":ltp_tst_check_kconfigs",
+    ":ltp_tst_checkpoint",
+    ":ltp_tst_checkpoint_wait_timeout",
+    ":ltp_tst_checkpoint_wake_timeout",
+    ":ltp_tst_cleanup_once",
+    ":ltp_tst_dataroot01",
+    ":ltp_tst_dataroot02",
+    ":ltp_tst_dataroot03",
+    ":ltp_tst_device",
+    ":ltp_tst_exit",
+    ":ltp_tst_expiration_timer",
+    ":ltp_tst_fs_fill_hardlinks",
+    ":ltp_tst_fs_fill_subdirs",
+    ":ltp_tst_fs_has_free",
+    ":ltp_tst_fsfreeze",
+    ":ltp_tst_fuzzy_sync01",
+    ":ltp_tst_fuzzy_sync02",
+    ":ltp_tst_fuzzy_sync03",
+    ":ltp_tst_get_free_pids",
+    ":ltp_tst_get_median",
+    ":ltp_tst_get_unused_port",
+    ":ltp_tst_getconf",
+    ":ltp_tst_hexdump",
+    ":ltp_tst_kvcmp",
+    ":ltp_tst_lockdown_enabled",
+    ":ltp_tst_ncpus",
+    ":ltp_tst_ncpus_conf",
+    ":ltp_tst_ncpus_max",
+    ":ltp_tst_needs_cmds01",
+    ":ltp_tst_needs_cmds02",
+    ":ltp_tst_needs_cmds03",
+    ":ltp_tst_needs_cmds04",
+    ":ltp_tst_needs_cmds05",
+    ":ltp_tst_needs_cmds06",
+    ":ltp_tst_needs_cmds07",
+    ":ltp_tst_needs_cmds08",
+    ":ltp_tst_net_iface_prefix",
+    ":ltp_tst_net_ip_prefix",
+    ":ltp_tst_net_vars",
+    ":ltp_tst_ns_create",
+    ":ltp_tst_ns_exec",
+    ":ltp_tst_ns_ifmove",
+    ":ltp_tst_print_result",
+    ":ltp_tst_process_state",
+    ":ltp_tst_random",
+    ":ltp_tst_record_childstatus",
+    ":ltp_tst_res",
+    ":ltp_tst_res_flags",
+    ":ltp_tst_res_hexd",
+    ":ltp_tst_resm",
+    ":ltp_tst_rod",
+    ":ltp_tst_safe_fileops",
+    ":ltp_tst_safe_macros",
+    ":ltp_tst_safe_sscanf",
+    ":ltp_tst_secureboot_enabled",
+    ":ltp_tst_sleep",
+    ":ltp_tst_strerrno",
+    ":ltp_tst_strsig",
+    ":ltp_tst_strstatus",
+    ":ltp_tst_supported_fs",
+    ":ltp_tst_timeout_kill",
+    ":ltp_tst_tmpdir_test",
+    ":ltp_uaccess",
+    ":ltp_uevent01",
+    ":ltp_uevent02",
+    ":ltp_uevent03",
+    ":ltp_umask01",
+    ":ltp_umip_basic_test",
+    ":ltp_umount01",
+    ":ltp_umount02",
+    ":ltp_umount03",
+    ":ltp_umount2_01",
+    ":ltp_umount2_02",
+    ":ltp_uname01",
+    ":ltp_uname02",
+    ":ltp_uname04",
+    ":ltp_unlink05",
+    ":ltp_unlink07",
+    ":ltp_unlink08",
+    ":ltp_unlink09",
+    ":ltp_unlinkat01",
+    ":ltp_unshare01",
+    ":ltp_unshare02",
+    ":ltp_userfaultfd01",
+    ":ltp_ustat01",
+    ":ltp_ustat02",
+    ":ltp_utime01",
+    ":ltp_utime02",
+    ":ltp_utime03",
+    ":ltp_utime04",
+    ":ltp_utime05",
+    ":ltp_utime06",
+    ":ltp_utime07",
+    ":ltp_utimensat01",
+    ":ltp_utimes01",
+    ":ltp_utsname01",
+    ":ltp_utsname02",
+    ":ltp_utsname03",
+    ":ltp_utsname04",
+    ":ltp_variant",
+    ":ltp_verify_caps_exec",
+    ":ltp_vfork",
+    ":ltp_vfork01",
+    ":ltp_vfork02",
+    ":ltp_vhangup01",
+    ":ltp_vhangup02",
+    ":ltp_vma01",
+    ":ltp_vma02",
+    ":ltp_vma03",
+    ":ltp_vma04",
+    ":ltp_vma05_vdso",
+    ":ltp_vmsplice01",
+    ":ltp_vmsplice02",
+    ":ltp_vmsplice03",
+    ":ltp_vmsplice04",
+    ":ltp_vsock01",
+    ":ltp_wait01",
+    ":ltp_wait02",
+    ":ltp_wait401",
+    ":ltp_wait402",
+    ":ltp_wait403",
+    ":ltp_waitid01",
+    ":ltp_waitid02",
+    ":ltp_waitid03",
+    ":ltp_waitid04",
+    ":ltp_waitid05",
+    ":ltp_waitid06",
+    ":ltp_waitid07",
+    ":ltp_waitid08",
+    ":ltp_waitid09",
+    ":ltp_waitid10",
+    ":ltp_waitid11",
+    ":ltp_waitpid01",
+    ":ltp_waitpid03",
+    ":ltp_waitpid04",
+    ":ltp_waitpid06",
+    ":ltp_waitpid07",
+    ":ltp_waitpid08",
+    ":ltp_waitpid09",
+    ":ltp_waitpid10",
+    ":ltp_waitpid11",
+    ":ltp_waitpid12",
+    ":ltp_waitpid13",
+    ":ltp_wqueue01",
+    ":ltp_wqueue02",
+    ":ltp_wqueue03",
+    ":ltp_wqueue04",
+    ":ltp_wqueue05",
+    ":ltp_wqueue06",
+    ":ltp_wqueue07",
+    ":ltp_wqueue08",
+    ":ltp_wqueue09",
+    ":ltp_write01",
+    ":ltp_write02",
+    ":ltp_write03",
+    ":ltp_write04",
+    ":ltp_write05",
+    ":ltp_write06",
+    ":ltp_writetest",
+    ":ltp_writev01",
+    ":ltp_writev02",
+    ":ltp_writev03",
+    ":ltp_writev05",
+    ":ltp_writev06",
+    ":ltp_writev07",
+    ":ltp_zram03",
+]
+
+genrule {
+    name: "ltp_config_arm_64",
+    out: ["vts_ltp_test_arm_64.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch arm --bitness 64 --low-mem False --hwasan False $(out)",
+}
+
+genrule {
+    name: "ltp_config_arm_64_lowmem",
+    out: ["vts_ltp_test_arm_64_lowmem.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch arm --bitness 64 --low-mem True --hwasan False $(out)",
+}
+
+genrule {
+    name: "ltp_config_arm_64_hwasan",
+    out: ["vts_ltp_test_arm_64_hwasan.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch arm --bitness 64 --low-mem False --hwasan True $(out)",
+}
+
+genrule {
+    name: "ltp_config_arm_64_lowmem_hwasan",
+    out: ["vts_ltp_test_arm_64_lowmem_hwasan.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch arm --bitness 64 --low-mem True --hwasan True $(out)",
+}
+
+genrule {
+    name: "ltp_config_arm",
+    out: ["vts_ltp_test_arm.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch arm --bitness 32 --low-mem False --hwasan False $(out)",
+}
+
+genrule {
+    name: "ltp_config_arm_lowmem",
+    out: ["vts_ltp_test_arm_lowmem.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch arm --bitness 32 --low-mem True --hwasan False $(out)",
+}
+
+genrule {
+    name: "ltp_config_riscv_64",
+    out: ["vts_ltp_test_riscv_64.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch riscv --bitness 64 --low-mem False --hwasan False $(out)",
+}
+
+genrule {
+    name: "ltp_config_x86_64",
+    out: ["vts_ltp_test_x86_64.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch x86 --bitness 64 --low-mem False --hwasan False $(out)",
+}
+
+genrule {
+    name: "ltp_config_x86",
+    out: ["vts_ltp_test_x86.xml"],
+    tools: ["gen_ltp_config"],
+    cmd: "$(location gen_ltp_config) --arch x86 --bitness 32 --low-mem False --hwasan False $(out)",
+}
+
+sh_test {
+    name: "vts_ltp_test_arm_64",
+    src: "empty.sh",
+    test_config: ":ltp_config_arm_64",
+    test_suites: [
+        "general-tests",
+        "vts",
+    ],
+    enabled: false,
+    arch: {
+        arm64: {
+            enabled: true,
+        },
+    },
+    extra_test_configs: [
+        ":ltp_config_arm_64_lowmem",
+        ":ltp_config_arm_64_hwasan",
+        ":ltp_config_arm_64_lowmem_hwasan",
+    ],
+    data: LTP_TESTS,
+}
+
+sh_test {
+    name: "vts_ltp_test_arm",
+    src: "empty.sh",
+    test_config: ":ltp_config_arm",
+    test_suites: [
+        "general-tests",
+        "vts",
+    ],
+    enabled: false,
+    compile_multilib: "32",
+    arch: {
+        arm: {
+            enabled: true,
+        },
+        arm64: {
+            enabled: true,
+        },
+    },
+    extra_test_configs: [
+        ":ltp_config_arm_lowmem",
+    ],
+    data: LTP_TESTS,
+}
+
+sh_test {
+    name: "vts_ltp_test_riscv_64",
+    src: "empty.sh",
+    test_config: ":ltp_config_riscv_64",
+    test_suites: [
+        "general-tests",
+        "vts",
+    ],
+    enabled: false,
+    arch: {
+        riscv64: {
+            enabled: true,
+        },
+    },
+    data: LTP_TESTS,
+}
+
+sh_test {
+    name: "vts_ltp_test_x86_64",
+    src: "empty.sh",
+    test_config: ":ltp_config_x86_64",
+    test_suites: [
+        "general-tests",
+        "vts",
+    ],
+    enabled: false,
+    arch: {
+        x86_64: {
+            enabled: true,
+        },
+    },
+    data: LTP_TESTS,
+}
+
 sh_test {
-    name: "ltp",
-    src: "tools/disabled_tests.txt",
-    sub_dir: "ltp",
-    data: [":ltp_runtests"],
-    filename_from_src: true,
-    compile_multilib: "both",
-    auto_gen_config: false,
-    required: [
-        "ltp_abort01",
-        "ltp_abs01",
-        "ltp_accept01",
-        "ltp_accept02",
-        "ltp_accept03",
-        "ltp_accept4_01",
-        "ltp_access01",
-        "ltp_access02",
-        "ltp_access03",
-        "ltp_access04",
-        "ltp_acct01",
-        "ltp_acct02",
-        "ltp_acct02_helper",
-        "ltp_acl1",
-        "ltp_add_key01",
-        "ltp_add_key02",
-        "ltp_add_key03",
-        "ltp_add_key04",
-        "ltp_add_key05",
-        "ltp_adjtimex01",
-        "ltp_adjtimex02",
-        "ltp_adjtimex03",
-        "ltp_af_alg01",
-        "ltp_af_alg03",
-        "ltp_af_alg04",
-        "ltp_af_alg05",
-        "ltp_af_alg06",
-        "ltp_af_alg07",
-        "ltp_aio-stress",
-        "ltp_aio01",
-        "ltp_aio02",
-        "ltp_aiocp",
-        "ltp_aiodio_append",
-        "ltp_aiodio_sparse",
-        "ltp_alarm02",
-        "ltp_alarm03",
-        "ltp_alarm05",
-        "ltp_alarm06",
-        "ltp_alarm07",
-        "ltp_asapi_01",
-        "ltp_asapi_02",
-        "ltp_asapi_03",
-        "ltp_atof01",
-        "ltp_autogroup01",
-        "ltp_bind01",
-        "ltp_bind02",
-        "ltp_bind03",
-        "ltp_bind04",
-        "ltp_bind05",
-        "ltp_bind06",
-        "ltp_block_dev",
-        "ltp_bpf_map01",
-        "ltp_bpf_prog01",
-        "ltp_bpf_prog02",
-        "ltp_bpf_prog03",
-        "ltp_bpf_prog04",
-        "ltp_bpf_prog05",
-        "ltp_bpf_prog06",
-        "ltp_bpf_prog07",
-        "ltp_brk01",
-        "ltp_brk02",
-        "ltp_cacheflush01",
-        "ltp_can_bcm01",
-        "ltp_can_filter",
-        "ltp_can_rcv_own_msgs",
-        "ltp_cap_bounds_r",
-        "ltp_cap_bounds_rw",
-        "ltp_cap_bset_inh_bounds",
-        "ltp_capget01",
-        "ltp_capget02",
-        "ltp_capset01",
-        "ltp_capset02",
-        "ltp_capset03",
-        "ltp_capset04",
-        "ltp_cfs_bandwidth01",
-        "ltp_cgroup_core01",
-        "ltp_cgroup_core02",
-        "ltp_cgroup_core03",
-        "ltp_cgroup_fj_proc",
-        "ltp_cgroup_regression_fork_processes",
-        "ltp_cgroup_regression_getdelays",
-        "ltp_cgroup_xattr",
-        "ltp_chdir01",
-        "ltp_chdir04",
-        "ltp_check_keepcaps",
-        "ltp_check_pe",
-        "ltp_check_simple_capset",
-        "ltp_chmod01",
-        "ltp_chmod03",
-        "ltp_chmod05",
-        "ltp_chmod07",
-        "ltp_chown01",
-        "ltp_chown01_16",
-        "ltp_chown02",
-        "ltp_chown02_16",
-        "ltp_chown03",
-        "ltp_chown03_16",
-        "ltp_chown05",
-        "ltp_chown05_16",
-        "ltp_chroot01",
-        "ltp_chroot02",
-        "ltp_chroot03",
-        "ltp_chroot04",
-        "ltp_clock_adjtime01",
-        "ltp_clock_adjtime02",
-        "ltp_clock_getres01",
-        "ltp_clock_gettime01",
-        "ltp_clock_gettime02",
-        "ltp_clock_gettime03",
-        "ltp_clock_gettime04",
-        "ltp_clock_nanosleep01",
-        "ltp_clock_nanosleep02",
-        "ltp_clock_nanosleep03",
-        "ltp_clock_nanosleep04",
-        "ltp_clock_settime01",
-        "ltp_clock_settime02",
-        "ltp_clock_settime03",
-        "ltp_clone01",
-        "ltp_clone02",
-        "ltp_clone03",
-        "ltp_clone04",
-        "ltp_clone05",
-        "ltp_clone06",
-        "ltp_clone07",
-        "ltp_clone08",
-        "ltp_clone09",
-        "ltp_clone301",
-        "ltp_clone302",
-        "ltp_clone303",
-        "ltp_close01",
-        "ltp_close02",
-        "ltp_close_range01",
-        "ltp_close_range02",
-        "ltp_connect01",
-        "ltp_connect02",
-        "ltp_copy_file_range01",
-        "ltp_copy_file_range02",
-        "ltp_copy_file_range03",
-        "ltp_cpuacct_task",
-        "ltp_cpuctl_def_task01",
-        "ltp_cpuctl_def_task02",
-        "ltp_cpuctl_def_task03",
-        "ltp_cpuctl_def_task04",
-        "ltp_cpuctl_fj_cpu-hog",
-        "ltp_cpuctl_fj_simple_echo",
-        "ltp_cpuctl_latency_check_task",
-        "ltp_cpuctl_latency_test",
-        "ltp_cpuctl_test01",
-        "ltp_cpuctl_test02",
-        "ltp_cpuctl_test03",
-        "ltp_cpuctl_test04",
-        "ltp_cpufreq_boost",
-        "ltp_cpuset01",
-        "ltp_cpuset_cpu_hog",
-        "ltp_cpuset_list_compute",
-        "ltp_cpuset_mem_hog",
-        "ltp_cpuset_memory_pressure",
-        "ltp_cpuset_sched_domains_check",
-        "ltp_cpuset_syscall_test",
-        "ltp_crash01",
-        "ltp_crash02",
-        "ltp_creat01",
-        "ltp_creat03",
-        "ltp_creat04",
-        "ltp_creat05",
-        "ltp_creat07",
-        "ltp_creat07_child",
-        "ltp_creat08",
-        "ltp_creat09",
-        "ltp_create_datafile",
-        "ltp_crypto_user01",
-        "ltp_crypto_user02",
-        "ltp_cve-2014-0196",
-        "ltp_cve-2015-3290",
-        "ltp_cve-2016-10044",
-        "ltp_cve-2016-7042",
-        "ltp_cve-2016-7117",
-        "ltp_cve-2017-16939",
-        "ltp_cve-2017-17052",
-        "ltp_cve-2017-17053",
-        "ltp_cve-2017-2618",
-        "ltp_cve-2017-2671",
-        "ltp_cve-2022-4378",
-        "ltp_data_space",
-        "ltp_delete_module01",
-        "ltp_delete_module02",
-        "ltp_delete_module03",
-        "ltp_dio_append",
-        "ltp_dio_read",
-        "ltp_dio_sparse",
-        "ltp_dio_truncate",
-        "ltp_diotest1",
-        "ltp_diotest2",
-        "ltp_diotest3",
-        "ltp_diotest5",
-        "ltp_diotest6",
-        "ltp_dirty",
-        "ltp_dirtyc0w",
-        "ltp_dirtyc0w_child",
-        "ltp_dirtyc0w_shmem",
-        "ltp_dirtyc0w_shmem_child",
-        "ltp_dirtypipe",
-        "ltp_dma_thread_diotest",
-        "ltp_dup01",
-        "ltp_dup02",
-        "ltp_dup03",
-        "ltp_dup04",
-        "ltp_dup05",
-        "ltp_dup06",
-        "ltp_dup07",
-        "ltp_dup201",
-        "ltp_dup202",
-        "ltp_dup203",
-        "ltp_dup204",
-        "ltp_dup205",
-        "ltp_dup206",
-        "ltp_dup207",
-        "ltp_dup3_01",
-        "ltp_dup3_02",
-        "ltp_eas_big_to_small",
-        "ltp_eas_one_big_task",
-        "ltp_eas_one_small_task",
-        "ltp_eas_small_big_toggle",
-        "ltp_eas_small_to_big",
-        "ltp_eas_two_big_three_small",
-        "ltp_endian_switch01",
-        "ltp_epoll-ltp",
-        "ltp_epoll_create01",
-        "ltp_epoll_create02",
-        "ltp_epoll_create1_01",
-        "ltp_epoll_create1_02",
-        "ltp_epoll_ctl01",
-        "ltp_epoll_ctl02",
-        "ltp_epoll_ctl03",
-        "ltp_epoll_ctl04",
-        "ltp_epoll_ctl05",
-        "ltp_epoll_pwait01",
-        "ltp_epoll_pwait02",
-        "ltp_epoll_pwait03",
-        "ltp_epoll_pwait04",
-        "ltp_epoll_pwait05",
-        "ltp_epoll_wait01",
-        "ltp_epoll_wait02",
-        "ltp_epoll_wait03",
-        "ltp_epoll_wait04",
-        "ltp_epoll_wait05",
-        "ltp_epoll_wait06",
-        "ltp_epoll_wait07",
-        "ltp_event_generator",
-        "ltp_eventfd01",
-        "ltp_eventfd02",
-        "ltp_eventfd03",
-        "ltp_eventfd04",
-        "ltp_eventfd05",
-        "ltp_eventfd06",
-        "ltp_eventfd2_01",
-        "ltp_eventfd2_02",
-        "ltp_eventfd2_03",
-        "ltp_exec_with_inh",
-        "ltp_exec_without_inh",
-        "ltp_execl01",
-        "ltp_execl01_child",
-        "ltp_execle01",
-        "ltp_execle01_child",
-        "ltp_execlp01",
-        "ltp_execlp01_child",
-        "ltp_execv01",
-        "ltp_execv01_child",
-        "ltp_execve01",
-        "ltp_execve01_child",
-        "ltp_execve02",
-        "ltp_execve03",
-        "ltp_execve04",
-        "ltp_execve05",
-        "ltp_execve06",
-        "ltp_execve06_child",
-        "ltp_execve_child",
-        "ltp_execveat01",
-        "ltp_execveat02",
-        "ltp_execveat03",
-        "ltp_execveat_child",
-        "ltp_execveat_errno",
-        "ltp_execvp01",
-        "ltp_execvp01_child",
-        "ltp_exit01",
-        "ltp_exit02",
-        "ltp_exit_group01",
-        "ltp_f1",
-        "ltp_f2",
-        "ltp_f3",
-        "ltp_faccessat01",
-        "ltp_faccessat02",
-        "ltp_faccessat201",
-        "ltp_faccessat202",
-        "ltp_fallocate01",
-        "ltp_fallocate02",
-        "ltp_fallocate03",
-        "ltp_fallocate04",
-        "ltp_fallocate05",
-        "ltp_fallocate06",
-        "ltp_fanotify01",
-        "ltp_fanotify02",
-        "ltp_fanotify03",
-        "ltp_fanotify04",
-        "ltp_fanotify05",
-        "ltp_fanotify06",
-        "ltp_fanotify07",
-        "ltp_fanotify08",
-        "ltp_fanotify09",
-        "ltp_fanotify10",
-        "ltp_fanotify11",
-        "ltp_fanotify12",
-        "ltp_fanotify13",
-        "ltp_fanotify14",
-        "ltp_fanotify15",
-        "ltp_fanotify16",
-        "ltp_fanotify17",
-        "ltp_fanotify18",
-        "ltp_fanotify19",
-        "ltp_fanotify20",
-        "ltp_fanotify21",
-        "ltp_fanotify22",
-        "ltp_fanotify23",
-        "ltp_fanotify_child",
-        "ltp_fanout01",
-        "ltp_fchdir01",
-        "ltp_fchdir02",
-        "ltp_fchdir03",
-        "ltp_fchmod01",
-        "ltp_fchmod02",
-        "ltp_fchmod03",
-        "ltp_fchmod04",
-        "ltp_fchmod05",
-        "ltp_fchmod06",
-        "ltp_fchmodat01",
-        "ltp_fchmodat02",
-        "ltp_fchown01",
-        "ltp_fchown01_16",
-        "ltp_fchown02",
-        "ltp_fchown02_16",
-        "ltp_fchown03",
-        "ltp_fchown03_16",
-        "ltp_fchown04",
-        "ltp_fchown04_16",
-        "ltp_fchown05",
-        "ltp_fchown05_16",
-        "ltp_fchownat01",
-        "ltp_fchownat02",
-        "ltp_fcntl01",
-        "ltp_fcntl01_64",
-        "ltp_fcntl02",
-        "ltp_fcntl02_64",
-        "ltp_fcntl03",
-        "ltp_fcntl03_64",
-        "ltp_fcntl04",
-        "ltp_fcntl04_64",
-        "ltp_fcntl05",
-        "ltp_fcntl05_64",
-        "ltp_fcntl07",
-        "ltp_fcntl07_64",
-        "ltp_fcntl08",
-        "ltp_fcntl08_64",
-        "ltp_fcntl09",
-        "ltp_fcntl09_64",
-        "ltp_fcntl10",
-        "ltp_fcntl10_64",
-        "ltp_fcntl11",
-        "ltp_fcntl11_64",
-        "ltp_fcntl12",
-        "ltp_fcntl12_64",
-        "ltp_fcntl13",
-        "ltp_fcntl13_64",
-        "ltp_fcntl14",
-        "ltp_fcntl14_64",
-        "ltp_fcntl15",
-        "ltp_fcntl15_64",
-        "ltp_fcntl16",
-        "ltp_fcntl16_64",
-        "ltp_fcntl17",
-        "ltp_fcntl17_64",
-        "ltp_fcntl18",
-        "ltp_fcntl18_64",
-        "ltp_fcntl19",
-        "ltp_fcntl19_64",
-        "ltp_fcntl20",
-        "ltp_fcntl20_64",
-        "ltp_fcntl21",
-        "ltp_fcntl21_64",
-        "ltp_fcntl22",
-        "ltp_fcntl22_64",
-        "ltp_fcntl23",
-        "ltp_fcntl23_64",
-        "ltp_fcntl24",
-        "ltp_fcntl24_64",
-        "ltp_fcntl25",
-        "ltp_fcntl25_64",
-        "ltp_fcntl26",
-        "ltp_fcntl26_64",
-        "ltp_fcntl27",
-        "ltp_fcntl27_64",
-        "ltp_fcntl28",
-        "ltp_fcntl28_64",
-        "ltp_fcntl29",
-        "ltp_fcntl29_64",
-        "ltp_fcntl30",
-        "ltp_fcntl30_64",
-        "ltp_fcntl31",
-        "ltp_fcntl31_64",
-        "ltp_fcntl32",
-        "ltp_fcntl32_64",
-        "ltp_fcntl33",
-        "ltp_fcntl33_64",
-        "ltp_fcntl34",
-        "ltp_fcntl34_64",
-        "ltp_fcntl35",
-        "ltp_fcntl35_64",
-        "ltp_fcntl36",
-        "ltp_fcntl36_64",
-        "ltp_fcntl37",
-        "ltp_fcntl37_64",
-        "ltp_fcntl38",
-        "ltp_fcntl38_64",
-        "ltp_fcntl39",
-        "ltp_fcntl39_64",
-        "ltp_fdatasync01",
-        "ltp_fdatasync02",
-        "ltp_fdatasync03",
-        "ltp_fgetxattr01",
-        "ltp_fgetxattr02",
-        "ltp_fgetxattr03",
-        "ltp_finit_module01",
-        "ltp_finit_module02",
-        "ltp_flistxattr01",
-        "ltp_flistxattr02",
-        "ltp_flistxattr03",
-        "ltp_float_bessel",
-        "ltp_float_exp_log",
-        "ltp_float_iperb",
-        "ltp_float_power",
-        "ltp_float_trigo",
-        "ltp_flock01",
-        "ltp_flock02",
-        "ltp_flock03",
-        "ltp_flock04",
-        "ltp_flock06",
-        "ltp_fork01",
-        "ltp_fork03",
-        "ltp_fork04",
-        "ltp_fork05",
-        "ltp_fork07",
-        "ltp_fork08",
-        "ltp_fork09",
-        "ltp_fork10",
-        "ltp_fork13",
-        "ltp_fork14",
-        "ltp_fork_exec_loop",
-        "ltp_fork_procs",
-        "ltp_fpathconf01",
-        "ltp_fptest01",
-        "ltp_fptest02",
-        "ltp_frag",
-        "ltp_fremovexattr01",
-        "ltp_fremovexattr02",
-        "ltp_fs_fill",
-        "ltp_fs_perms",
-        "ltp_fsconfig01",
-        "ltp_fsconfig02",
-        "ltp_fsconfig03",
-        "ltp_fsetxattr01",
-        "ltp_fsetxattr02",
-        "ltp_fsmount01",
-        "ltp_fsmount02",
-        "ltp_fsopen01",
-        "ltp_fsopen02",
-        "ltp_fspick01",
-        "ltp_fspick02",
-        "ltp_fsstress",
-        "ltp_fstat02",
-        "ltp_fstat02_64",
-        "ltp_fstat03",
-        "ltp_fstat03_64",
-        "ltp_fstatat01",
-        "ltp_fstatfs01",
-        "ltp_fstatfs01_64",
-        "ltp_fstatfs02",
-        "ltp_fstatfs02_64",
-        "ltp_fsx-linux",
-        "ltp_fsync01",
-        "ltp_fsync02",
-        "ltp_fsync03",
-        "ltp_fsync04",
-        "ltp_ftest01",
-        "ltp_ftest02",
-        "ltp_ftest03",
-        "ltp_ftest04",
-        "ltp_ftest05",
-        "ltp_ftest06",
-        "ltp_ftest07",
-        "ltp_ftest08",
-        "ltp_ftruncate01",
-        "ltp_ftruncate01_64",
-        "ltp_ftruncate03",
-        "ltp_ftruncate03_64",
-        "ltp_ftruncate04",
-        "ltp_ftruncate04_64",
-        "ltp_futex_cmp_requeue01",
-        "ltp_futex_cmp_requeue02",
-        "ltp_futex_wait01",
-        "ltp_futex_wait03",
-        "ltp_futex_wait04",
-        "ltp_futex_wait05",
-        "ltp_futex_wait_bitset01",
-        "ltp_futex_waitv01",
-        "ltp_futex_waitv02",
-        "ltp_futex_waitv03",
-        "ltp_futex_wake01",
-        "ltp_futex_wake02",
-        "ltp_futex_wake04",
-        "ltp_futimesat01",
-        "ltp_fw_load",
-        "ltp_genacos",
-        "ltp_genasin",
-        "ltp_genatan",
-        "ltp_genatan2",
-        "ltp_genbessel",
-        "ltp_genceil",
-        "ltp_gencos",
-        "ltp_gencosh",
-        "ltp_genexp",
-        "ltp_genexp_log",
-        "ltp_genfabs",
-        "ltp_genfloor",
-        "ltp_genfmod",
-        "ltp_genfrexp",
-        "ltp_genhypot",
-        "ltp_geniperb",
-        "ltp_genj0",
-        "ltp_genj1",
-        "ltp_genldexp",
-        "ltp_genlgamma",
-        "ltp_genlog",
-        "ltp_genlog10",
-        "ltp_genmodf",
-        "ltp_genpow",
-        "ltp_genpower",
-        "ltp_gensin",
-        "ltp_gensinh",
-        "ltp_gensqrt",
-        "ltp_gentan",
-        "ltp_gentanh",
-        "ltp_gentrigo",
-        "ltp_geny0",
-        "ltp_geny1",
-        "ltp_get_mempolicy01",
-        "ltp_get_mempolicy02",
-        "ltp_get_robust_list01",
-        "ltp_getaddrinfo_01",
-        "ltp_getcpu01",
-        "ltp_getcwd01",
-        "ltp_getcwd02",
-        "ltp_getcwd03",
-        "ltp_getcwd04",
-        "ltp_getdents01",
-        "ltp_getdents02",
-        "ltp_getdomainname01",
-        "ltp_getegid01",
-        "ltp_getegid01_16",
-        "ltp_getegid02",
-        "ltp_getegid02_16",
-        "ltp_geteuid01",
-        "ltp_geteuid01_16",
-        "ltp_geteuid02",
-        "ltp_geteuid02_16",
-        "ltp_getgid01",
-        "ltp_getgid01_16",
-        "ltp_getgid03",
-        "ltp_getgid03_16",
-        "ltp_getgroups01",
-        "ltp_getgroups01_16",
-        "ltp_getgroups03",
-        "ltp_getgroups03_16",
-        "ltp_gethostbyname_r01",
-        "ltp_gethostname01",
-        "ltp_getitimer01",
-        "ltp_getitimer02",
-        "ltp_getpagesize01",
-        "ltp_getpeername01",
-        "ltp_getpgid01",
-        "ltp_getpgid02",
-        "ltp_getpgrp01",
-        "ltp_getpid01",
-        "ltp_getpid02",
-        "ltp_getppid01",
-        "ltp_getppid02",
-        "ltp_getpriority01",
-        "ltp_getpriority02",
-        "ltp_getrandom01",
-        "ltp_getrandom02",
-        "ltp_getrandom03",
-        "ltp_getrandom04",
-        "ltp_getresgid01",
-        "ltp_getresgid01_16",
-        "ltp_getresgid02",
-        "ltp_getresgid02_16",
-        "ltp_getresgid03",
-        "ltp_getresgid03_16",
-        "ltp_getresuid01",
-        "ltp_getresuid01_16",
-        "ltp_getresuid02",
-        "ltp_getresuid02_16",
-        "ltp_getresuid03",
-        "ltp_getresuid03_16",
-        "ltp_getrlimit01",
-        "ltp_getrlimit02",
-        "ltp_getrlimit03",
-        "ltp_getrusage01",
-        "ltp_getrusage02",
-        "ltp_getrusage03_child",
-        "ltp_getrusage04",
-        "ltp_getsid01",
-        "ltp_getsid02",
-        "ltp_getsockname01",
-        "ltp_getsockopt01",
-        "ltp_getsockopt02",
-        "ltp_gettid01",
-        "ltp_gettid02",
-        "ltp_gettimeofday01",
-        "ltp_gettimeofday02",
-        "ltp_getuid01",
-        "ltp_getuid01_16",
-        "ltp_getuid03",
-        "ltp_getuid03_16",
-        "ltp_getxattr01",
-        "ltp_getxattr02",
-        "ltp_getxattr03",
-        "ltp_getxattr04",
-        "ltp_getxattr05",
-        "ltp_hackbench",
-        "ltp_hangup01",
-        "ltp_ht_affinity",
-        "ltp_ht_enabled",
-        "ltp_hugefallocate01",
-        "ltp_hugefallocate02",
-        "ltp_hugefork01",
-        "ltp_hugefork02",
-        "ltp_hugemmap01",
-        "ltp_hugemmap02",
-        "ltp_hugemmap04",
-        "ltp_hugemmap06",
-        "ltp_hugemmap07",
-        "ltp_hugemmap08",
-        "ltp_hugemmap09",
-        "ltp_hugemmap10",
-        "ltp_hugemmap11",
-        "ltp_hugemmap12",
-        "ltp_hugemmap13",
-        "ltp_hugemmap14",
-        "ltp_hugemmap16",
-        "ltp_hugemmap17",
-        "ltp_hugemmap18",
-        "ltp_hugemmap19",
-        "ltp_hugemmap20",
-        "ltp_hugemmap21",
-        "ltp_hugemmap22",
-        "ltp_hugemmap23",
-        "ltp_hugemmap24",
-        "ltp_hugemmap25",
-        "ltp_hugemmap26",
-        "ltp_hugemmap27",
-        "ltp_hugemmap28",
-        "ltp_hugemmap29",
-        "ltp_hugemmap30",
-        "ltp_hugemmap31",
-        "ltp_hugemmap32",
-        "ltp_icmp_rate_limit01",
-        "ltp_ima_boot_aggregate",
-        "ltp_ima_mmap",
-        "ltp_in",
-        "ltp_in6_02",
-        "ltp_inh_capped",
-        "ltp_init_module01",
-        "ltp_init_module02",
-        "ltp_inode01",
-        "ltp_inode02",
-        "ltp_inotify01",
-        "ltp_inotify02",
-        "ltp_inotify03",
-        "ltp_inotify04",
-        "ltp_inotify05",
-        "ltp_inotify06",
-        "ltp_inotify07",
-        "ltp_inotify08",
-        "ltp_inotify09",
-        "ltp_inotify10",
-        "ltp_inotify11",
-        "ltp_inotify12",
-        "ltp_inotify_init1_01",
-        "ltp_inotify_init1_02",
-        "ltp_input01",
-        "ltp_input02",
-        "ltp_input04",
-        "ltp_input05",
-        "ltp_input06",
-        "ltp_io_cancel01",
-        "ltp_io_cancel02",
-        "ltp_io_control01",
-        "ltp_io_destroy01",
-        "ltp_io_destroy02",
-        "ltp_io_getevents01",
-        "ltp_io_getevents02",
-        "ltp_io_pgetevents01",
-        "ltp_io_pgetevents02",
-        "ltp_io_setup01",
-        "ltp_io_setup02",
-        "ltp_io_submit01",
-        "ltp_io_submit02",
-        "ltp_io_submit03",
-        "ltp_io_uring01",
-        "ltp_io_uring02",
-        "ltp_ioctl01",
-        "ltp_ioctl03",
-        "ltp_ioctl04",
-        "ltp_ioctl05",
-        "ltp_ioctl06",
-        "ltp_ioctl07",
-        "ltp_ioctl08",
-        "ltp_ioctl09",
-        "ltp_ioctl_loop01",
-        "ltp_ioctl_loop02",
-        "ltp_ioctl_loop03",
-        "ltp_ioctl_loop04",
-        "ltp_ioctl_loop05",
-        "ltp_ioctl_loop06",
-        "ltp_ioctl_loop07",
-        "ltp_ioctl_ns01",
-        "ltp_ioctl_ns02",
-        "ltp_ioctl_ns03",
-        "ltp_ioctl_ns04",
-        "ltp_ioctl_ns05",
-        "ltp_ioctl_ns06",
-        "ltp_ioctl_ns07",
-        "ltp_ioctl_sg01",
-        "ltp_iogen",
-        "ltp_ioperm01",
-        "ltp_ioperm02",
-        "ltp_iopl01",
-        "ltp_iopl02",
-        "ltp_ioprio_get01",
-        "ltp_ioprio_set01",
-        "ltp_ioprio_set02",
-        "ltp_ioprio_set03",
-        "ltp_irqbalance01",
-        "ltp_kcmp01",
-        "ltp_kcmp02",
-        "ltp_kcmp03",
-        "ltp_keyctl01",
-        "ltp_keyctl02",
-        "ltp_keyctl03",
-        "ltp_keyctl04",
-        "ltp_keyctl05",
-        "ltp_keyctl06",
-        "ltp_keyctl07",
-        "ltp_keyctl08",
-        "ltp_keyctl09",
-        "ltp_kill02",
-        "ltp_kill03",
-        "ltp_kill06",
-        "ltp_kill08",
-        "ltp_kill09",
-        "ltp_kill10",
-        "ltp_kill11",
-        "ltp_kill12",
-        "ltp_kill13",
-        "ltp_kmsg01",
-        "ltp_ksm01",
-        "ltp_ksm02",
-        "ltp_ksm03",
-        "ltp_ksm04",
-        "ltp_ksm05",
-        "ltp_ksm06",
-        "ltp_ksm07",
-        "ltp_lchown01",
-        "ltp_lchown01_16",
-        "ltp_lchown02",
-        "ltp_lchown02_16",
-        "ltp_lchown03",
-        "ltp_lchown03_16",
-        "ltp_leapsec01",
-        "ltp_lftest",
-        "ltp_lgetxattr01",
-        "ltp_lgetxattr02",
-        "ltp_link02",
-        "ltp_link04",
-        "ltp_link05",
-        "ltp_link08",
-        "ltp_linkat01",
-        "ltp_linkat02",
-        "ltp_listen01",
-        "ltp_listxattr01",
-        "ltp_listxattr02",
-        "ltp_listxattr03",
-        "ltp_llistxattr01",
-        "ltp_llistxattr02",
-        "ltp_llistxattr03",
-        "ltp_llseek01",
-        "ltp_llseek02",
-        "ltp_llseek03",
-        "ltp_locktests",
-        "ltp_lremovexattr01",
-        "ltp_lseek01",
-        "ltp_lseek02",
-        "ltp_lseek07",
-        "ltp_lseek11",
-        "ltp_lstat01",
-        "ltp_lstat01_64",
-        "ltp_lstat02",
-        "ltp_lstat02_64",
-        "ltp_ltpClient",
-        "ltp_ltpServer",
-        "ltp_ltp_acpi",
-        "ltp_madvise01",
-        "ltp_madvise02",
-        "ltp_madvise05",
-        "ltp_madvise06",
-        "ltp_madvise07",
-        "ltp_madvise08",
-        "ltp_madvise09",
-        "ltp_madvise10",
-        "ltp_madvise11",
-        "ltp_mallinfo01",
-        "ltp_mallinfo02",
-        "ltp_mallinfo2_01",
-        "ltp_max_map_count",
-        "ltp_mbind01",
-        "ltp_mbind02",
-        "ltp_mbind03",
-        "ltp_mbind04",
-        "ltp_mc_member_test",
-        "ltp_mc_recv",
-        "ltp_mc_send",
-        "ltp_mc_verify_opts",
-        "ltp_mc_verify_opts_error",
-        "ltp_meltdown",
-        "ltp_mem02",
-        "ltp_mem_process",
-        "ltp_membarrier01",
-        "ltp_memcg_process_stress",
-        "ltp_memcg_test_1",
-        "ltp_memcg_test_2",
-        "ltp_memcg_test_3",
-        "ltp_memcg_test_4",
-        "ltp_memcmp01",
-        "ltp_memcontrol01",
-        "ltp_memcontrol02",
-        "ltp_memcontrol03",
-        "ltp_memcontrol04",
-        "ltp_memcpy01",
-        "ltp_memctl_test01",
-        "ltp_memfd_create01",
-        "ltp_memfd_create02",
-        "ltp_memfd_create03",
-        "ltp_memfd_create04",
-        "ltp_memset01",
-        "ltp_memtoy",
-        "ltp_migrate_pages01",
-        "ltp_migrate_pages02",
-        "ltp_migrate_pages03",
-        "ltp_mincore01",
-        "ltp_mincore02",
-        "ltp_mincore03",
-        "ltp_mincore04",
-        "ltp_mkdir02",
-        "ltp_mkdir03",
-        "ltp_mkdir04",
-        "ltp_mkdir05",
-        "ltp_mkdir09",
-        "ltp_mkdirat01",
-        "ltp_mkdirat02",
-        "ltp_mknod01",
-        "ltp_mknod02",
-        "ltp_mknod03",
-        "ltp_mknod04",
-        "ltp_mknod05",
-        "ltp_mknod06",
-        "ltp_mknod07",
-        "ltp_mknod08",
-        "ltp_mknod09",
-        "ltp_mknodat01",
-        "ltp_mknodat02",
-        "ltp_mlock01",
-        "ltp_mlock02",
-        "ltp_mlock03",
-        "ltp_mlock04",
-        "ltp_mlock201",
-        "ltp_mlock202",
-        "ltp_mlock203",
-        "ltp_mlockall01",
-        "ltp_mlockall02",
-        "ltp_mlockall03",
-        "ltp_mmap-corruption01",
-        "ltp_mmap001",
-        "ltp_mmap01",
-        "ltp_mmap02",
-        "ltp_mmap03",
-        "ltp_mmap04",
-        "ltp_mmap05",
-        "ltp_mmap06",
-        "ltp_mmap08",
-        "ltp_mmap09",
-        "ltp_mmap1",
-        "ltp_mmap10",
-        "ltp_mmap11",
-        "ltp_mmap12",
-        "ltp_mmap13",
-        "ltp_mmap14",
-        "ltp_mmap15",
-        "ltp_mmap16",
-        "ltp_mmap17",
-        "ltp_mmap18",
-        "ltp_mmap19",
-        "ltp_mmap2",
-        "ltp_mmap20",
-        "ltp_mmap3",
-        "ltp_mmapstress01",
-        "ltp_mmapstress02",
-        "ltp_mmapstress03",
-        "ltp_mmapstress04",
-        "ltp_mmapstress05",
-        "ltp_mmapstress06",
-        "ltp_mmapstress07",
-        "ltp_mmapstress08",
-        "ltp_mmapstress09",
-        "ltp_mmapstress10",
-        "ltp_mmstress",
-        "ltp_mmstress_dummy",
-        "ltp_modify_ldt01",
-        "ltp_modify_ldt02",
-        "ltp_modify_ldt03",
-        "ltp_mount01",
-        "ltp_mount02",
-        "ltp_mount03",
-        "ltp_mount03_suid_child",
-        "ltp_mount04",
-        "ltp_mount05",
-        "ltp_mount06",
-        "ltp_mount07",
-        "ltp_mount_setattr01",
-        "ltp_move_mount01",
-        "ltp_move_mount02",
-        "ltp_move_pages01",
-        "ltp_move_pages02",
-        "ltp_move_pages03",
-        "ltp_move_pages04",
-        "ltp_move_pages05",
-        "ltp_move_pages06",
-        "ltp_move_pages07",
-        "ltp_move_pages09",
-        "ltp_move_pages10",
-        "ltp_move_pages11",
-        "ltp_move_pages12",
-        "ltp_mprotect01",
-        "ltp_mprotect02",
-        "ltp_mprotect03",
-        "ltp_mprotect04",
-        "ltp_mprotect05",
-        "ltp_mremap01",
-        "ltp_mremap02",
-        "ltp_mremap03",
-        "ltp_mremap05",
-        "ltp_mremap06",
-        "ltp_msgget05",
-        "ltp_msync01",
-        "ltp_msync02",
-        "ltp_msync03",
-        "ltp_msync04",
-        "ltp_mtest01",
-        "ltp_munlock01",
-        "ltp_munlock02",
-        "ltp_munlockall01",
-        "ltp_munmap01",
-        "ltp_munmap02",
-        "ltp_munmap03",
-        "ltp_name_to_handle_at01",
-        "ltp_name_to_handle_at02",
-        "ltp_nanosleep01",
-        "ltp_nanosleep02",
-        "ltp_nanosleep04",
-        "ltp_netstress",
-        "ltp_newuname01",
-        "ltp_nextafter01",
-        "ltp_nfs01_open_files",
-        "ltp_nfs04_create_file",
-        "ltp_nfs05_make_tree",
-        "ltp_nfs_flock",
-        "ltp_nfs_flock_dgen",
-        "ltp_nft02",
-        "ltp_nftw01",
-        "ltp_nftw6401",
-        "ltp_nice01",
-        "ltp_nice02",
-        "ltp_nice03",
-        "ltp_nice04",
-        "ltp_nptl01",
-        "ltp_ns-icmp_redirector",
-        "ltp_ns-icmpv4_sender",
-        "ltp_ns-icmpv6_sender",
-        "ltp_ns-igmp_querier",
-        "ltp_ns-mcast_join",
-        "ltp_ns-mcast_receiver",
-        "ltp_ns-tcpclient",
-        "ltp_ns-tcpserver",
-        "ltp_ns-udpclient",
-        "ltp_ns-udpsender",
-        "ltp_ns-udpserver",
-        "ltp_oom01",
-        "ltp_oom02",
-        "ltp_oom03",
-        "ltp_oom04",
-        "ltp_oom05",
-        "ltp_open01",
-        "ltp_open02",
-        "ltp_open03",
-        "ltp_open04",
-        "ltp_open06",
-        "ltp_open07",
-        "ltp_open08",
-        "ltp_open09",
-        "ltp_open10",
-        "ltp_open11",
-        "ltp_open12_child",
-        "ltp_open13",
-        "ltp_open14",
-        "ltp_open_by_handle_at01",
-        "ltp_open_by_handle_at02",
-        "ltp_open_tree01",
-        "ltp_open_tree02",
-        "ltp_openat01",
-        "ltp_openat02_child",
-        "ltp_openat03",
-        "ltp_openat04",
-        "ltp_openat201",
-        "ltp_openat202",
-        "ltp_openat203",
-        "ltp_openfile",
-        "ltp_overcommit_memory",
-        "ltp_page01",
-        "ltp_page02",
-        "ltp_pathconf01",
-        "ltp_pathconf02",
-        "ltp_pause01",
-        "ltp_pause02",
-        "ltp_pause03",
-        "ltp_pcrypt_aead01",
-        "ltp_pec_listener",
-        "ltp_perf_event_open01",
-        "ltp_perf_event_open02",
-        "ltp_perf_event_open03",
-        "ltp_personality01",
-        "ltp_personality02",
-        "ltp_pidfd_getfd01",
-        "ltp_pidfd_getfd02",
-        "ltp_pidfd_open01",
-        "ltp_pidfd_open02",
-        "ltp_pidfd_open03",
-        "ltp_pidfd_open04",
-        "ltp_pidfd_send_signal01",
-        "ltp_pidfd_send_signal02",
-        "ltp_pidfd_send_signal03",
-        "ltp_pids_task1",
-        "ltp_pids_task2",
-        "ltp_pipe01",
-        "ltp_pipe02",
-        "ltp_pipe03",
-        "ltp_pipe04",
-        "ltp_pipe05",
-        "ltp_pipe06",
-        "ltp_pipe07",
-        "ltp_pipe08",
-        "ltp_pipe09",
-        "ltp_pipe10",
-        "ltp_pipe11",
-        "ltp_pipe12",
-        "ltp_pipe13",
-        "ltp_pipe14",
-        "ltp_pipe15",
-        "ltp_pipe2_01",
-        "ltp_pipe2_02",
-        "ltp_pipe2_02_child",
-        "ltp_pipe2_04",
-        "ltp_pivot_root01",
-        "ltp_pkey01",
-        "ltp_pm_get_sched_values",
-        "ltp_poll01",
-        "ltp_poll02",
-        "ltp_posix_fadvise01",
-        "ltp_posix_fadvise01_64",
-        "ltp_posix_fadvise02",
-        "ltp_posix_fadvise02_64",
-        "ltp_posix_fadvise03",
-        "ltp_posix_fadvise03_64",
-        "ltp_posix_fadvise04",
-        "ltp_posix_fadvise04_64",
-        "ltp_ppoll01",
-        "ltp_prctl01",
-        "ltp_prctl02",
-        "ltp_prctl03",
-        "ltp_prctl04",
-        "ltp_prctl05",
-        "ltp_prctl06",
-        "ltp_prctl06_execve",
-        "ltp_prctl07",
-        "ltp_prctl08",
-        "ltp_prctl09",
-        "ltp_prctl10",
-        "ltp_pread01",
-        "ltp_pread01_64",
-        "ltp_pread02",
-        "ltp_pread02_64",
-        "ltp_preadv01",
-        "ltp_preadv01_64",
-        "ltp_preadv02",
-        "ltp_preadv02_64",
-        "ltp_preadv03",
-        "ltp_preadv03_64",
-        "ltp_preadv201",
-        "ltp_preadv201_64",
-        "ltp_preadv202",
-        "ltp_preadv202_64",
-        "ltp_preadv203",
-        "ltp_preadv203_64",
-        "ltp_print_caps",
-        "ltp_proc01",
-        "ltp_proc_sched_rt01",
-        "ltp_process_madvise01",
-        "ltp_process_vm01",
-        "ltp_process_vm_readv02",
-        "ltp_process_vm_readv03",
-        "ltp_process_vm_writev02",
-        "ltp_pselect01",
-        "ltp_pselect01_64",
-        "ltp_pselect02",
-        "ltp_pselect02_64",
-        "ltp_pselect03",
-        "ltp_pselect03_64",
-        "ltp_pt_test",
-        "ltp_ptem01",
-        "ltp_pth_str01",
-        "ltp_pth_str02",
-        "ltp_pth_str03",
-        "ltp_pthcli",
-        "ltp_pthserv",
-        "ltp_ptrace01",
-        "ltp_ptrace02",
-        "ltp_ptrace03",
-        "ltp_ptrace04",
-        "ltp_ptrace05",
-        "ltp_ptrace06",
-        "ltp_ptrace07",
-        "ltp_ptrace08",
-        "ltp_ptrace09",
-        "ltp_ptrace10",
-        "ltp_ptrace11",
-        "ltp_pty01",
-        "ltp_pty02",
-        "ltp_pty03",
-        "ltp_pty04",
-        "ltp_pty06",
-        "ltp_pty07",
-        "ltp_pwrite01",
-        "ltp_pwrite01_64",
-        "ltp_pwrite02",
-        "ltp_pwrite02_64",
-        "ltp_pwrite03",
-        "ltp_pwrite03_64",
-        "ltp_pwrite04",
-        "ltp_pwrite04_64",
-        "ltp_pwritev01",
-        "ltp_pwritev01_64",
-        "ltp_pwritev02",
-        "ltp_pwritev02_64",
-        "ltp_pwritev03",
-        "ltp_pwritev03_64",
-        "ltp_pwritev201",
-        "ltp_pwritev201_64",
-        "ltp_pwritev202",
-        "ltp_pwritev202_64",
-        "ltp_quotactl01",
-        "ltp_quotactl02",
-        "ltp_quotactl03",
-        "ltp_quotactl04",
-        "ltp_quotactl05",
-        "ltp_quotactl06",
-        "ltp_quotactl07",
-        "ltp_quotactl08",
-        "ltp_quotactl09",
-        "ltp_read01",
-        "ltp_read02",
-        "ltp_read03",
-        "ltp_read04",
-        "ltp_read_all",
-        "ltp_readahead01",
-        "ltp_readahead02",
-        "ltp_readdir01",
-        "ltp_readdir21",
-        "ltp_readlink01",
-        "ltp_readlink03",
-        "ltp_readlinkat01",
-        "ltp_readlinkat02",
-        "ltp_readv01",
-        "ltp_readv02",
-        "ltp_realpath01",
-        "ltp_reboot01",
-        "ltp_reboot02",
-        "ltp_recv01",
-        "ltp_recvfrom01",
-        "ltp_recvmmsg01",
-        "ltp_recvmsg01",
-        "ltp_recvmsg02",
-        "ltp_recvmsg03",
-        "ltp_remap_file_pages02",
-        "ltp_removexattr01",
-        "ltp_removexattr02",
-        "ltp_rename01",
-        "ltp_rename03",
-        "ltp_rename04",
-        "ltp_rename05",
-        "ltp_rename06",
-        "ltp_rename07",
-        "ltp_rename08",
-        "ltp_rename09",
-        "ltp_rename10",
-        "ltp_rename11",
-        "ltp_rename12",
-        "ltp_rename13",
-        "ltp_rename14",
-        "ltp_renameat01",
-        "ltp_renameat201",
-        "ltp_renameat202",
-        "ltp_request_key01",
-        "ltp_request_key02",
-        "ltp_request_key03",
-        "ltp_request_key04",
-        "ltp_request_key05",
-        "ltp_rmdir01",
-        "ltp_rmdir02",
-        "ltp_rmdir03",
-        "ltp_route-change-netlink",
-        "ltp_rt_sigaction01",
-        "ltp_rt_sigaction02",
-        "ltp_rt_sigaction03",
-        "ltp_rt_sigpending02",
-        "ltp_rt_sigprocmask01",
-        "ltp_rt_sigprocmask02",
-        "ltp_rt_sigqueueinfo01",
-        "ltp_rt_sigsuspend01",
-        "ltp_rt_sigtimedwait01",
-        "ltp_rt_tgsigqueueinfo01",
-        "ltp_rtc01",
-        "ltp_rtc02",
-        "ltp_sbrk01",
-        "ltp_sbrk02",
-        "ltp_sbrk03",
-        "ltp_sched_boost",
-        "ltp_sched_cfs_prio",
-        "ltp_sched_dl_runtime",
-        "ltp_sched_driver",
-        "ltp_sched_get_priority_max01",
-        "ltp_sched_get_priority_max02",
-        "ltp_sched_get_priority_min01",
-        "ltp_sched_get_priority_min02",
-        "ltp_sched_getaffinity01",
-        "ltp_sched_getattr01",
-        "ltp_sched_getattr02",
-        "ltp_sched_getparam01",
-        "ltp_sched_getparam03",
-        "ltp_sched_getscheduler01",
-        "ltp_sched_getscheduler02",
-        "ltp_sched_latency_dl",
-        "ltp_sched_latency_rt",
-        "ltp_sched_prio_3_fifo",
-        "ltp_sched_prio_3_rr",
-        "ltp_sched_rr_get_interval01",
-        "ltp_sched_rr_get_interval02",
-        "ltp_sched_rr_get_interval03",
-        "ltp_sched_setaffinity01",
-        "ltp_sched_setattr01",
-        "ltp_sched_setparam01",
-        "ltp_sched_setparam02",
-        "ltp_sched_setparam03",
-        "ltp_sched_setparam04",
-        "ltp_sched_setparam05",
-        "ltp_sched_setscheduler01",
-        "ltp_sched_setscheduler02",
-        "ltp_sched_setscheduler03",
-        "ltp_sched_setscheduler04",
-        "ltp_sched_tc0",
-        "ltp_sched_tc1",
-        "ltp_sched_tc2",
-        "ltp_sched_tc3",
-        "ltp_sched_tc4",
-        "ltp_sched_tc5",
-        "ltp_sched_tc6",
-        "ltp_sched_yield01",
-        "ltp_sctp_big_chunk",
-        "ltp_select01",
-        "ltp_select02",
-        "ltp_select03",
-        "ltp_select04",
-        "ltp_semctl08",
-        "ltp_semctl09",
-        "ltp_send01",
-        "ltp_send02",
-        "ltp_sendfile02",
-        "ltp_sendfile02_64",
-        "ltp_sendfile03",
-        "ltp_sendfile03_64",
-        "ltp_sendfile04",
-        "ltp_sendfile04_64",
-        "ltp_sendfile05",
-        "ltp_sendfile05_64",
-        "ltp_sendfile06",
-        "ltp_sendfile06_64",
-        "ltp_sendfile07",
-        "ltp_sendfile07_64",
-        "ltp_sendfile08",
-        "ltp_sendfile08_64",
-        "ltp_sendfile09",
-        "ltp_sendfile09_64",
-        "ltp_sendmmsg01",
-        "ltp_sendmmsg02",
-        "ltp_sendmsg01",
-        "ltp_sendmsg03",
-        "ltp_sendto01",
-        "ltp_sendto02",
-        "ltp_sendto03",
-        "ltp_set_robust_list01",
-        "ltp_set_thread_area01",
-        "ltp_set_tid_address01",
-        "ltp_setdomainname01",
-        "ltp_setdomainname02",
-        "ltp_setdomainname03",
-        "ltp_setegid01",
-        "ltp_setegid02",
-        "ltp_setfsgid01",
-        "ltp_setfsgid01_16",
-        "ltp_setfsgid02",
-        "ltp_setfsgid02_16",
-        "ltp_setfsgid03",
-        "ltp_setfsgid03_16",
-        "ltp_setfsuid01",
-        "ltp_setfsuid01_16",
-        "ltp_setfsuid02",
-        "ltp_setfsuid02_16",
-        "ltp_setfsuid03",
-        "ltp_setfsuid03_16",
-        "ltp_setfsuid04",
-        "ltp_setfsuid04_16",
-        "ltp_setgid01",
-        "ltp_setgid01_16",
-        "ltp_setgid02",
-        "ltp_setgid02_16",
-        "ltp_setgid03",
-        "ltp_setgid03_16",
-        "ltp_setgroups01",
-        "ltp_setgroups01_16",
-        "ltp_setgroups02",
-        "ltp_setgroups02_16",
-        "ltp_setgroups03",
-        "ltp_setgroups03_16",
-        "ltp_setgroups04",
-        "ltp_setgroups04_16",
-        "ltp_sethostname01",
-        "ltp_sethostname02",
-        "ltp_sethostname03",
-        "ltp_setitimer01",
-        "ltp_setitimer02",
-        "ltp_setns01",
-        "ltp_setpgid01",
-        "ltp_setpgid02",
-        "ltp_setpgid03",
-        "ltp_setpgid03_child",
-        "ltp_setpgrp01",
-        "ltp_setpgrp02",
-        "ltp_setpriority01",
-        "ltp_setpriority02",
-        "ltp_setregid01",
-        "ltp_setregid01_16",
-        "ltp_setregid02",
-        "ltp_setregid02_16",
-        "ltp_setregid03",
-        "ltp_setregid03_16",
-        "ltp_setregid04",
-        "ltp_setregid04_16",
-        "ltp_setresgid01",
-        "ltp_setresgid01_16",
-        "ltp_setresgid02",
-        "ltp_setresgid02_16",
-        "ltp_setresgid03",
-        "ltp_setresgid03_16",
-        "ltp_setresgid04",
-        "ltp_setresgid04_16",
-        "ltp_setresuid01",
-        "ltp_setresuid01_16",
-        "ltp_setresuid02",
-        "ltp_setresuid02_16",
-        "ltp_setresuid03",
-        "ltp_setresuid03_16",
-        "ltp_setresuid04",
-        "ltp_setresuid04_16",
-        "ltp_setresuid05",
-        "ltp_setresuid05_16",
-        "ltp_setreuid01",
-        "ltp_setreuid01_16",
-        "ltp_setreuid02",
-        "ltp_setreuid02_16",
-        "ltp_setreuid03",
-        "ltp_setreuid03_16",
-        "ltp_setreuid04",
-        "ltp_setreuid04_16",
-        "ltp_setreuid05",
-        "ltp_setreuid05_16",
-        "ltp_setreuid06",
-        "ltp_setreuid06_16",
-        "ltp_setreuid07",
-        "ltp_setreuid07_16",
-        "ltp_setrlimit01",
-        "ltp_setrlimit02",
-        "ltp_setrlimit03",
-        "ltp_setrlimit04",
-        "ltp_setrlimit05",
-        "ltp_setrlimit06",
-        "ltp_setsid01",
-        "ltp_setsockopt01",
-        "ltp_setsockopt02",
-        "ltp_setsockopt03",
-        "ltp_setsockopt04",
-        "ltp_setsockopt05",
-        "ltp_setsockopt06",
-        "ltp_setsockopt07",
-        "ltp_setsockopt08",
-        "ltp_setsockopt09",
-        "ltp_setsockopt10",
-        "ltp_settimeofday01",
-        "ltp_settimeofday02",
-        "ltp_setuid01",
-        "ltp_setuid01_16",
-        "ltp_setuid03",
-        "ltp_setuid03_16",
-        "ltp_setuid04",
-        "ltp_setuid04_16",
-        "ltp_setxattr01",
-        "ltp_setxattr02",
-        "ltp_setxattr03",
-        "ltp_sgetmask01",
-        "ltp_sigaction01",
-        "ltp_sigaction02",
-        "ltp_sigaltstack01",
-        "ltp_sigaltstack02",
-        "ltp_sighold02",
-        "ltp_signal01",
-        "ltp_signal02",
-        "ltp_signal03",
-        "ltp_signal04",
-        "ltp_signal05",
-        "ltp_signal06",
-        "ltp_signalfd01",
-        "ltp_signalfd4_01",
-        "ltp_signalfd4_02",
-        "ltp_sigpending02",
-        "ltp_sigprocmask01",
-        "ltp_sigrelse01",
-        "ltp_sigsuspend01",
-        "ltp_sigtimedwait01",
-        "ltp_sigwait01",
-        "ltp_sigwaitinfo01",
-        "ltp_smack_notroot",
-        "ltp_smack_set_socket_labels",
-        "ltp_snd_seq01",
-        "ltp_snd_timer01",
-        "ltp_socket01",
-        "ltp_socket02",
-        "ltp_socketcall01",
-        "ltp_socketcall02",
-        "ltp_socketcall03",
-        "ltp_socketpair01",
-        "ltp_socketpair02",
-        "ltp_sockioctl01",
-        "ltp_splice01",
-        "ltp_splice02",
-        "ltp_splice03",
-        "ltp_splice04",
-        "ltp_splice05",
-        "ltp_splice06",
-        "ltp_splice07",
-        "ltp_ssetmask01",
-        "ltp_stack_clash",
-        "ltp_stack_space",
-        "ltp_starvation",
-        "ltp_stat01",
-        "ltp_stat01_64",
-        "ltp_stat02",
-        "ltp_stat02_64",
-        "ltp_stat03",
-        "ltp_stat03_64",
-        "ltp_statfs01",
-        "ltp_statfs01_64",
-        "ltp_statfs02",
-        "ltp_statfs02_64",
-        "ltp_statfs03",
-        "ltp_statfs03_64",
-        "ltp_statvfs01",
-        "ltp_statvfs02",
-        "ltp_statx01",
-        "ltp_statx02",
-        "ltp_statx03",
-        "ltp_statx04",
-        "ltp_statx06",
-        "ltp_statx08",
-        "ltp_statx09",
-        "ltp_statx10",
-        "ltp_statx11",
-        "ltp_statx12",
-        "ltp_stream01",
-        "ltp_stream02",
-        "ltp_stream03",
-        "ltp_stream04",
-        "ltp_stream05",
-        "ltp_string01",
-        "ltp_sugov_latency",
-        "ltp_sugov_stale_util",
-        "ltp_sugov_wakeups",
-        "ltp_support_numa",
-        "ltp_swapoff01",
-        "ltp_swapoff02",
-        "ltp_swapon01",
-        "ltp_swapon02",
-        "ltp_swapon03",
-        "ltp_swapping01",
-        "ltp_symlink01",
-        "ltp_symlink02",
-        "ltp_symlink03",
-        "ltp_symlink04",
-        "ltp_symlinkat01",
-        "ltp_sync01",
-        "ltp_sync_file_range01",
-        "ltp_sync_file_range02",
-        "ltp_syncfs01",
-        "ltp_syscall01",
-        "ltp_sysconf01",
-        "ltp_sysctl01",
-        "ltp_sysctl03",
-        "ltp_sysctl04",
-        "ltp_sysfs01",
-        "ltp_sysfs02",
-        "ltp_sysfs03",
-        "ltp_sysfs04",
-        "ltp_sysfs05",
-        "ltp_sysinfo01",
-        "ltp_sysinfo02",
-        "ltp_sysinfo03",
-        "ltp_syslog11",
-        "ltp_syslog12",
-        "ltp_tbio",
-        "ltp_tcindex01",
-        "ltp_tee01",
-        "ltp_tee02",
-        "ltp_test01",
-        "ltp_test02",
-        "ltp_test03",
-        "ltp_test04",
-        "ltp_test05",
-        "ltp_test06",
-        "ltp_test07",
-        "ltp_test08",
-        "ltp_test09",
-        "ltp_test11",
-        "ltp_test13",
-        "ltp_test14",
-        "ltp_test15",
-        "ltp_test19",
-        "ltp_test20",
-        "ltp_test22",
-        "ltp_test_assert",
-        "ltp_test_children_cleanup",
-        "ltp_test_exec",
-        "ltp_test_exec_child",
-        "ltp_test_guarded_buf",
-        "ltp_test_kconfig",
-        "ltp_test_kconfig01",
-        "ltp_test_kconfig02",
-        "ltp_test_macros01",
-        "ltp_test_macros02",
-        "ltp_test_macros03",
-        "ltp_test_macros04",
-        "ltp_test_macros05",
-        "ltp_test_macros06",
-        "ltp_test_parse_filesize",
-        "ltp_test_runtime01",
-        "ltp_test_runtime02",
-        "ltp_test_timer",
-        "ltp_test_zero_hugepage",
-        "ltp_testcases_bin_add_ipv6addr",
-        "ltp_testcases_bin_ar01.sh",
-        "ltp_testcases_bin_arping01.sh",
-        "ltp_testcases_bin_ask_password.sh",
-        "ltp_testcases_bin_assign_password.sh",
-        "ltp_testcases_bin_bbr01.sh",
-        "ltp_testcases_bin_bbr02.sh",
-        "ltp_testcases_bin_bind_noport01.sh",
-        "ltp_testcases_bin_binfmt_misc01.sh",
-        "ltp_testcases_bin_binfmt_misc02.sh",
-        "ltp_testcases_bin_binfmt_misc_lib.sh",
-        "ltp_testcases_bin_broken_ip-checksum.sh",
-        "ltp_testcases_bin_broken_ip-dstaddr.sh",
-        "ltp_testcases_bin_broken_ip-fragment.sh",
-        "ltp_testcases_bin_broken_ip-ihl.sh",
-        "ltp_testcases_bin_broken_ip-nexthdr.sh",
-        "ltp_testcases_bin_broken_ip-plen.sh",
-        "ltp_testcases_bin_broken_ip-protcol.sh",
-        "ltp_testcases_bin_broken_ip-version.sh",
-        "ltp_testcases_bin_busy_poll01.sh",
-        "ltp_testcases_bin_busy_poll02.sh",
-        "ltp_testcases_bin_busy_poll03.sh",
-        "ltp_testcases_bin_busy_poll_lib.sh",
-        "ltp_testcases_bin_cgroup_fj_common.sh",
-        "ltp_testcases_bin_cgroup_fj_function.sh",
-        "ltp_testcases_bin_cgroup_fj_stress.sh",
-        "ltp_testcases_bin_cgroup_lib.sh",
-        "ltp_testcases_bin_cgroup_regression_3_1.sh",
-        "ltp_testcases_bin_cgroup_regression_3_2.sh",
-        "ltp_testcases_bin_cgroup_regression_5_1.sh",
-        "ltp_testcases_bin_cgroup_regression_5_2.sh",
-        "ltp_testcases_bin_cgroup_regression_6_1.sh",
-        "ltp_testcases_bin_cgroup_regression_6_2.sh",
-        "ltp_testcases_bin_cgroup_regression_test.sh",
-        "ltp_testcases_bin_change_password.sh",
-        "ltp_testcases_bin_check_envval",
-        "ltp_testcases_bin_check_icmpv4_connectivity",
-        "ltp_testcases_bin_check_icmpv6_connectivity",
-        "ltp_testcases_bin_check_netem",
-        "ltp_testcases_bin_check_setkey",
-        "ltp_testcases_bin_cleanup_lvm.sh",
-        "ltp_testcases_bin_clockdiff01.sh",
-        "ltp_testcases_bin_cmdlib.sh",
-        "ltp_testcases_bin_cp_tests.sh",
-        "ltp_testcases_bin_cpio_tests.sh",
-        "ltp_testcases_bin_cpuacct.sh",
-        "ltp_testcases_bin_cpuhotplug01.sh",
-        "ltp_testcases_bin_cpuhotplug02.sh",
-        "ltp_testcases_bin_cpuhotplug03.sh",
-        "ltp_testcases_bin_cpuhotplug04.sh",
-        "ltp_testcases_bin_cpuhotplug05.sh",
-        "ltp_testcases_bin_cpuhotplug06.sh",
-        "ltp_testcases_bin_cpuhotplug07.sh",
-        "ltp_testcases_bin_cpuhotplug_do_disk_write_loop",
-        "ltp_testcases_bin_cpuhotplug_do_kcompile_loop",
-        "ltp_testcases_bin_cpuhotplug_do_spin_loop",
-        "ltp_testcases_bin_cpuhotplug_hotplug.sh",
-        "ltp_testcases_bin_cpuhotplug_report_proc_interrupts",
-        "ltp_testcases_bin_cpuhotplug_testsuite.sh",
-        "ltp_testcases_bin_cpuset_base_ops_testset.sh",
-        "ltp_testcases_bin_cpuset_exclusive_test.sh",
-        "ltp_testcases_bin_cpuset_funcs.sh",
-        "ltp_testcases_bin_cpuset_hierarchy_test.sh",
-        "ltp_testcases_bin_cpuset_hotplug_test.sh",
-        "ltp_testcases_bin_cpuset_inherit_testset.sh",
-        "ltp_testcases_bin_cpuset_load_balance_test.sh",
-        "ltp_testcases_bin_cpuset_memory_pressure_testset.sh",
-        "ltp_testcases_bin_cpuset_memory_spread_testset.sh",
-        "ltp_testcases_bin_cpuset_memory_testset.sh",
-        "ltp_testcases_bin_cpuset_regression_test.sh",
-        "ltp_testcases_bin_cpuset_sched_domains_test.sh",
-        "ltp_testcases_bin_cpuset_syscall_testset.sh",
-        "ltp_testcases_bin_create_file",
-        "ltp_testcases_bin_daemonlib.sh",
-        "ltp_testcases_bin_data",
-        "ltp_testcases_bin_dccp01.sh",
-        "ltp_testcases_bin_dccp_ipsec.sh",
-        "ltp_testcases_bin_dccp_ipsec_vti.sh",
-        "ltp_testcases_bin_dctcp01.sh",
-        "ltp_testcases_bin_dhcp_lib.sh",
-        "ltp_testcases_bin_dhcpd_tests.sh",
-        "ltp_testcases_bin_dns-stress-lib.sh",
-        "ltp_testcases_bin_dns-stress.sh",
-        "ltp_testcases_bin_dns-stress01-rmt.sh",
-        "ltp_testcases_bin_dns-stress02-rmt.sh",
-        "ltp_testcases_bin_dnsmasq_tests.sh",
-        "ltp_testcases_bin_dynamic_debug01.sh",
-        "ltp_testcases_bin_evm_overlay.sh",
-        "ltp_testcases_bin_file01.sh",
-        "ltp_testcases_bin_filecapstest.sh",
-        "ltp_testcases_bin_find_portbundle",
-        "ltp_testcases_bin_force_erase.sh",
-        "ltp_testcases_bin_fork_freeze.sh",
-        "ltp_testcases_bin_fou01.sh",
-        "ltp_testcases_bin_freeze_cancel.sh",
-        "ltp_testcases_bin_freeze_kill_thaw.sh",
-        "ltp_testcases_bin_freeze_move_thaw.sh",
-        "ltp_testcases_bin_freeze_self_thaw.sh",
-        "ltp_testcases_bin_freeze_sleep_thaw.sh",
-        "ltp_testcases_bin_freeze_thaw.sh",
-        "ltp_testcases_bin_freeze_write_freezing.sh",
-        "ltp_testcases_bin_fs_bind01.sh",
-        "ltp_testcases_bin_fs_bind02.sh",
-        "ltp_testcases_bin_fs_bind03.sh",
-        "ltp_testcases_bin_fs_bind04.sh",
-        "ltp_testcases_bin_fs_bind05.sh",
-        "ltp_testcases_bin_fs_bind06.sh",
-        "ltp_testcases_bin_fs_bind07-2.sh",
-        "ltp_testcases_bin_fs_bind07.sh",
-        "ltp_testcases_bin_fs_bind08.sh",
-        "ltp_testcases_bin_fs_bind09.sh",
-        "ltp_testcases_bin_fs_bind10.sh",
-        "ltp_testcases_bin_fs_bind11.sh",
-        "ltp_testcases_bin_fs_bind12.sh",
-        "ltp_testcases_bin_fs_bind13.sh",
-        "ltp_testcases_bin_fs_bind14.sh",
-        "ltp_testcases_bin_fs_bind15.sh",
-        "ltp_testcases_bin_fs_bind16.sh",
-        "ltp_testcases_bin_fs_bind17.sh",
-        "ltp_testcases_bin_fs_bind18.sh",
-        "ltp_testcases_bin_fs_bind19.sh",
-        "ltp_testcases_bin_fs_bind20.sh",
-        "ltp_testcases_bin_fs_bind21.sh",
-        "ltp_testcases_bin_fs_bind22.sh",
-        "ltp_testcases_bin_fs_bind23.sh",
-        "ltp_testcases_bin_fs_bind24.sh",
-        "ltp_testcases_bin_fs_bind_cloneNS01.sh",
-        "ltp_testcases_bin_fs_bind_cloneNS02.sh",
-        "ltp_testcases_bin_fs_bind_cloneNS03.sh",
-        "ltp_testcases_bin_fs_bind_cloneNS04.sh",
-        "ltp_testcases_bin_fs_bind_cloneNS05.sh",
-        "ltp_testcases_bin_fs_bind_cloneNS06.sh",
-        "ltp_testcases_bin_fs_bind_cloneNS07.sh",
-        "ltp_testcases_bin_fs_bind_lib.sh",
-        "ltp_testcases_bin_fs_bind_move01.sh",
-        "ltp_testcases_bin_fs_bind_move02.sh",
-        "ltp_testcases_bin_fs_bind_move03.sh",
-        "ltp_testcases_bin_fs_bind_move04.sh",
-        "ltp_testcases_bin_fs_bind_move05.sh",
-        "ltp_testcases_bin_fs_bind_move06.sh",
-        "ltp_testcases_bin_fs_bind_move07.sh",
-        "ltp_testcases_bin_fs_bind_move08.sh",
-        "ltp_testcases_bin_fs_bind_move09.sh",
-        "ltp_testcases_bin_fs_bind_move10.sh",
-        "ltp_testcases_bin_fs_bind_move11.sh",
-        "ltp_testcases_bin_fs_bind_move12.sh",
-        "ltp_testcases_bin_fs_bind_move13.sh",
-        "ltp_testcases_bin_fs_bind_move14.sh",
-        "ltp_testcases_bin_fs_bind_move15.sh",
-        "ltp_testcases_bin_fs_bind_move16.sh",
-        "ltp_testcases_bin_fs_bind_move17.sh",
-        "ltp_testcases_bin_fs_bind_move18.sh",
-        "ltp_testcases_bin_fs_bind_move19.sh",
-        "ltp_testcases_bin_fs_bind_move20.sh",
-        "ltp_testcases_bin_fs_bind_move21.sh",
-        "ltp_testcases_bin_fs_bind_move22.sh",
-        "ltp_testcases_bin_fs_bind_rbind01.sh",
-        "ltp_testcases_bin_fs_bind_rbind02.sh",
-        "ltp_testcases_bin_fs_bind_rbind03.sh",
-        "ltp_testcases_bin_fs_bind_rbind04.sh",
-        "ltp_testcases_bin_fs_bind_rbind05.sh",
-        "ltp_testcases_bin_fs_bind_rbind06.sh",
-        "ltp_testcases_bin_fs_bind_rbind07-2.sh",
-        "ltp_testcases_bin_fs_bind_rbind07.sh",
-        "ltp_testcases_bin_fs_bind_rbind08.sh",
-        "ltp_testcases_bin_fs_bind_rbind09.sh",
-        "ltp_testcases_bin_fs_bind_rbind10.sh",
-        "ltp_testcases_bin_fs_bind_rbind11.sh",
-        "ltp_testcases_bin_fs_bind_rbind12.sh",
-        "ltp_testcases_bin_fs_bind_rbind13.sh",
-        "ltp_testcases_bin_fs_bind_rbind14.sh",
-        "ltp_testcases_bin_fs_bind_rbind15.sh",
-        "ltp_testcases_bin_fs_bind_rbind16.sh",
-        "ltp_testcases_bin_fs_bind_rbind17.sh",
-        "ltp_testcases_bin_fs_bind_rbind18.sh",
-        "ltp_testcases_bin_fs_bind_rbind19.sh",
-        "ltp_testcases_bin_fs_bind_rbind20.sh",
-        "ltp_testcases_bin_fs_bind_rbind21.sh",
-        "ltp_testcases_bin_fs_bind_rbind22.sh",
-        "ltp_testcases_bin_fs_bind_rbind23.sh",
-        "ltp_testcases_bin_fs_bind_rbind24.sh",
-        "ltp_testcases_bin_fs_bind_rbind25.sh",
-        "ltp_testcases_bin_fs_bind_rbind26.sh",
-        "ltp_testcases_bin_fs_bind_rbind27.sh",
-        "ltp_testcases_bin_fs_bind_rbind28.sh",
-        "ltp_testcases_bin_fs_bind_rbind29.sh",
-        "ltp_testcases_bin_fs_bind_rbind30.sh",
-        "ltp_testcases_bin_fs_bind_rbind31.sh",
-        "ltp_testcases_bin_fs_bind_rbind32.sh",
-        "ltp_testcases_bin_fs_bind_rbind33.sh",
-        "ltp_testcases_bin_fs_bind_rbind34.sh",
-        "ltp_testcases_bin_fs_bind_rbind35.sh",
-        "ltp_testcases_bin_fs_bind_rbind36.sh",
-        "ltp_testcases_bin_fs_bind_rbind37.sh",
-        "ltp_testcases_bin_fs_bind_rbind38.sh",
-        "ltp_testcases_bin_fs_bind_rbind39.sh",
-        "ltp_testcases_bin_fs_bind_regression.sh",
-        "ltp_testcases_bin_fs_di",
-        "ltp_testcases_bin_fs_inod",
-        "ltp_testcases_bin_fs_racer.sh",
-        "ltp_testcases_bin_fs_racer_dir_create.sh",
-        "ltp_testcases_bin_fs_racer_dir_test.sh",
-        "ltp_testcases_bin_fs_racer_file_concat.sh",
-        "ltp_testcases_bin_fs_racer_file_create.sh",
-        "ltp_testcases_bin_fs_racer_file_link.sh",
-        "ltp_testcases_bin_fs_racer_file_list.sh",
-        "ltp_testcases_bin_fs_racer_file_rename.sh",
-        "ltp_testcases_bin_fs_racer_file_rm.sh",
-        "ltp_testcases_bin_fs_racer_file_symlink.sh",
-        "ltp_testcases_bin_fsx.sh",
-        "ltp_testcases_bin_ftp-download-stress.sh",
-        "ltp_testcases_bin_ftp-download-stress01-rmt.sh",
-        "ltp_testcases_bin_ftp-download-stress02-rmt.sh",
-        "ltp_testcases_bin_ftp-upload-stress.sh",
-        "ltp_testcases_bin_ftp-upload-stress01-rmt.sh",
-        "ltp_testcases_bin_ftp-upload-stress02-rmt.sh",
-        "ltp_testcases_bin_ftp01.sh",
-        "ltp_testcases_bin_ftrace_lib.sh",
-        "ltp_testcases_bin_ftrace_regression01.sh",
-        "ltp_testcases_bin_ftrace_regression02.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_buffer_size_kb.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_current_tracer.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_ftrace_enabled.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_function_profile_enabled.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_set_event.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_set_ftrace_filter.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_set_ftrace_pid.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_stack_max_size.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_stack_trace.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_trace.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_trace_clock.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_trace_options.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_trace_pipe.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_trace_stat.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_tracing_cpumask.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_tracing_enabled.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_tracing_max_latency.sh",
-        "ltp_testcases_bin_ftrace_stress_ftrace_tracing_on.sh",
-        "ltp_testcases_bin_ftrace_stress_test.sh",
-        "ltp_testcases_bin_gdb01.sh",
-        "ltp_testcases_bin_generate_lvm_runfile.sh",
-        "ltp_testcases_bin_geneve01.sh",
-        "ltp_testcases_bin_geneve02.sh",
-        "ltp_testcases_bin_get_ifname",
-        "ltp_testcases_bin_gre01.sh",
-        "ltp_testcases_bin_gre02.sh",
-        "ltp_testcases_bin_host01.sh",
-        "ltp_testcases_bin_http-stress.sh",
-        "ltp_testcases_bin_http-stress01-rmt.sh",
-        "ltp_testcases_bin_http-stress02-rmt.sh",
-        "ltp_testcases_bin_icmp-uni-basic.sh",
-        "ltp_testcases_bin_icmp-uni-vti.sh",
-        "ltp_testcases_bin_icmp4-multi-diffip01",
-        "ltp_testcases_bin_icmp4-multi-diffip02",
-        "ltp_testcases_bin_icmp4-multi-diffip03",
-        "ltp_testcases_bin_icmp4-multi-diffip04",
-        "ltp_testcases_bin_icmp4-multi-diffip05",
-        "ltp_testcases_bin_icmp4-multi-diffip06",
-        "ltp_testcases_bin_icmp4-multi-diffip07",
-        "ltp_testcases_bin_icmp4-multi-diffnic01",
-        "ltp_testcases_bin_icmp4-multi-diffnic02",
-        "ltp_testcases_bin_icmp4-multi-diffnic03",
-        "ltp_testcases_bin_icmp4-multi-diffnic04",
-        "ltp_testcases_bin_icmp4-multi-diffnic05",
-        "ltp_testcases_bin_icmp4-multi-diffnic06",
-        "ltp_testcases_bin_icmp4-multi-diffnic07",
-        "ltp_testcases_bin_icmp6-multi-diffip01",
-        "ltp_testcases_bin_icmp6-multi-diffip02",
-        "ltp_testcases_bin_icmp6-multi-diffip03",
-        "ltp_testcases_bin_icmp6-multi-diffip04",
-        "ltp_testcases_bin_icmp6-multi-diffip05",
-        "ltp_testcases_bin_icmp6-multi-diffip06",
-        "ltp_testcases_bin_icmp6-multi-diffip07",
-        "ltp_testcases_bin_icmp6-multi-diffnic01",
-        "ltp_testcases_bin_icmp6-multi-diffnic02",
-        "ltp_testcases_bin_icmp6-multi-diffnic03",
-        "ltp_testcases_bin_icmp6-multi-diffnic04",
-        "ltp_testcases_bin_icmp6-multi-diffnic05",
-        "ltp_testcases_bin_icmp6-multi-diffnic06",
-        "ltp_testcases_bin_icmp6-multi-diffnic07",
-        "ltp_testcases_bin_if-addr-adddel.sh",
-        "ltp_testcases_bin_if-addr-addlarge.sh",
-        "ltp_testcases_bin_if-lib.sh",
-        "ltp_testcases_bin_if-mtu-change.sh",
-        "ltp_testcases_bin_if-route-adddel.sh",
-        "ltp_testcases_bin_if-route-addlarge.sh",
-        "ltp_testcases_bin_if-updown.sh",
-        "ltp_testcases_bin_if4-addr-change.sh",
-        "ltp_testcases_bin_ima_conditionals.sh",
-        "ltp_testcases_bin_ima_kexec.sh",
-        "ltp_testcases_bin_ima_keys.sh",
-        "ltp_testcases_bin_ima_measurements.sh",
-        "ltp_testcases_bin_ima_policy.sh",
-        "ltp_testcases_bin_ima_selinux.sh",
-        "ltp_testcases_bin_ima_setup.sh",
-        "ltp_testcases_bin_ima_tpm.sh",
-        "ltp_testcases_bin_ima_violations.sh",
-        "ltp_testcases_bin_initialize_if",
-        "ltp_testcases_bin_ip_tests.sh",
-        "ltp_testcases_bin_ipneigh01.sh",
-        "ltp_testcases_bin_ipsec_lib.sh",
-        "ltp_testcases_bin_iptables01.sh",
-        "ltp_testcases_bin_iptables_lib.sh",
-        "ltp_testcases_bin_ipvlan01.sh",
-        "ltp_testcases_bin_isofs.sh",
-        "ltp_testcases_bin_killall_icmp_traffic",
-        "ltp_testcases_bin_killall_tcp_traffic",
-        "ltp_testcases_bin_killall_udp_traffic",
-        "ltp_testcases_bin_ld01.sh",
-        "ltp_testcases_bin_ldd01.sh",
-        "ltp_testcases_bin_libcgroup_freezer",
-        "ltp_testcases_bin_linktest.sh",
-        "ltp_testcases_bin_ln_tests.sh",
-        "ltp_testcases_bin_lock_torture.sh",
-        "ltp_testcases_bin_ltpSockets.sh",
-        "ltp_testcases_bin_macsec01.sh",
-        "ltp_testcases_bin_macsec02.sh",
-        "ltp_testcases_bin_macsec03.sh",
-        "ltp_testcases_bin_macsec_lib.sh",
-        "ltp_testcases_bin_macvlan01.sh",
-        "ltp_testcases_bin_macvtap01.sh",
-        "ltp_testcases_bin_mc_cmds.sh",
-        "ltp_testcases_bin_mc_commo.sh",
-        "ltp_testcases_bin_mc_member.sh",
-        "ltp_testcases_bin_mc_opts.sh",
-        "ltp_testcases_bin_mcast-group-multiple-socket.sh",
-        "ltp_testcases_bin_mcast-group-same-group.sh",
-        "ltp_testcases_bin_mcast-group-single-socket.sh",
-        "ltp_testcases_bin_mcast-group-source-filter.sh",
-        "ltp_testcases_bin_mcast-lib.sh",
-        "ltp_testcases_bin_mcast-pktfld01.sh",
-        "ltp_testcases_bin_mcast-pktfld02.sh",
-        "ltp_testcases_bin_mcast-queryfld01.sh",
-        "ltp_testcases_bin_mcast-queryfld02.sh",
-        "ltp_testcases_bin_mcast-queryfld03.sh",
-        "ltp_testcases_bin_mcast-queryfld04.sh",
-        "ltp_testcases_bin_mcast-queryfld05.sh",
-        "ltp_testcases_bin_mcast-queryfld06.sh",
-        "ltp_testcases_bin_memcg_control_test.sh",
-        "ltp_testcases_bin_memcg_failcnt.sh",
-        "ltp_testcases_bin_memcg_force_empty.sh",
-        "ltp_testcases_bin_memcg_lib.sh",
-        "ltp_testcases_bin_memcg_limit_in_bytes.sh",
-        "ltp_testcases_bin_memcg_max_usage_in_bytes_test.sh",
-        "ltp_testcases_bin_memcg_memsw_limit_in_bytes_test.sh",
-        "ltp_testcases_bin_memcg_move_charge_at_immigrate_test.sh",
-        "ltp_testcases_bin_memcg_regression_test.sh",
-        "ltp_testcases_bin_memcg_stat_rss.sh",
-        "ltp_testcases_bin_memcg_stat_test.sh",
-        "ltp_testcases_bin_memcg_stress_test.sh",
-        "ltp_testcases_bin_memcg_subgroup_charge.sh",
-        "ltp_testcases_bin_memcg_test_4.sh",
-        "ltp_testcases_bin_memcg_usage_in_bytes_test.sh",
-        "ltp_testcases_bin_memcg_use_hierarchy_test.sh",
-        "ltp_testcases_bin_mkdir_tests.sh",
-        "ltp_testcases_bin_mpls01.sh",
-        "ltp_testcases_bin_mpls02.sh",
-        "ltp_testcases_bin_mpls03.sh",
-        "ltp_testcases_bin_mpls04.sh",
-        "ltp_testcases_bin_mpls_lib.sh",
-        "ltp_testcases_bin_myfunctions.sh",
-        "ltp_testcases_bin_net_cmdlib.sh",
-        "ltp_testcases_bin_netns_lib.sh",
-        "ltp_testcases_bin_netstat01.sh",
-        "ltp_testcases_bin_nfs01.sh",
-        "ltp_testcases_bin_nfs02.sh",
-        "ltp_testcases_bin_nfs03.sh",
-        "ltp_testcases_bin_nfs04.sh",
-        "ltp_testcases_bin_nfs05.sh",
-        "ltp_testcases_bin_nfs06.sh",
-        "ltp_testcases_bin_nfs07.sh",
-        "ltp_testcases_bin_nfs08.sh",
-        "ltp_testcases_bin_nfs_lib.sh",
-        "ltp_testcases_bin_nfslock01.sh",
-        "ltp_testcases_bin_nfsstat01.sh",
-        "ltp_testcases_bin_nft01.sh",
-        "ltp_testcases_bin_nm01.sh",
-        "ltp_testcases_bin_ns-echoclient",
-        "ltp_testcases_bin_numa01.sh",
-        "ltp_testcases_bin_output_ipsec_conf",
-        "ltp_testcases_bin_parameters.sh",
-        "ltp_testcases_bin_pids.sh",
-        "ltp_testcases_bin_ping01.sh",
-        "ltp_testcases_bin_ping02.sh",
-        "ltp_testcases_bin_pm_cpu_consolidation.py",
-        "ltp_testcases_bin_pm_ilb_test.py",
-        "ltp_testcases_bin_pm_include.sh",
-        "ltp_testcases_bin_pm_sched_domain.py",
-        "ltp_testcases_bin_pm_sched_mc.py",
-        "ltp_testcases_bin_prepare_lvm.sh",
-        "ltp_testcases_bin_quota_remount_test01.sh",
-        "ltp_testcases_bin_rcu_torture.sh",
-        "ltp_testcases_bin_remove_password.sh",
-        "ltp_testcases_bin_route-change-dst.sh",
-        "ltp_testcases_bin_route-change-gw.sh",
-        "ltp_testcases_bin_route-change-if.sh",
-        "ltp_testcases_bin_route-change-netlink-dst.sh",
-        "ltp_testcases_bin_route-change-netlink-gw.sh",
-        "ltp_testcases_bin_route-change-netlink-if.sh",
-        "ltp_testcases_bin_route-lib.sh",
-        "ltp_testcases_bin_route-redirect.sh",
-        "ltp_testcases_bin_route4-rmmod",
-        "ltp_testcases_bin_route6-rmmod",
-        "ltp_testcases_bin_run_capbounds.sh",
-        "ltp_testcases_bin_run_cpuctl_latency_test.sh",
-        "ltp_testcases_bin_run_cpuctl_stress_test.sh",
-        "ltp_testcases_bin_run_cpuctl_test.sh",
-        "ltp_testcases_bin_run_cpuctl_test_fj.sh",
-        "ltp_testcases_bin_run_freezer.sh",
-        "ltp_testcases_bin_run_memctl_test.sh",
-        "ltp_testcases_bin_run_sched_cliserv.sh",
-        "ltp_testcases_bin_runpwtests01.sh",
-        "ltp_testcases_bin_runpwtests02.sh",
-        "ltp_testcases_bin_runpwtests03.sh",
-        "ltp_testcases_bin_runpwtests04.sh",
-        "ltp_testcases_bin_runpwtests05.sh",
-        "ltp_testcases_bin_runpwtests06.sh",
-        "ltp_testcases_bin_runpwtests_exclusive01.sh",
-        "ltp_testcases_bin_runpwtests_exclusive02.sh",
-        "ltp_testcases_bin_runpwtests_exclusive03.sh",
-        "ltp_testcases_bin_runpwtests_exclusive04.sh",
-        "ltp_testcases_bin_runpwtests_exclusive05.sh",
-        "ltp_testcases_bin_rwtest",
-        "ltp_testcases_bin_sched_stress.sh",
-        "ltp_testcases_bin_sctp01.sh",
-        "ltp_testcases_bin_sctp_ipsec.sh",
-        "ltp_testcases_bin_sctp_ipsec_vti.sh",
-        "ltp_testcases_bin_sendfile01.sh",
-        "ltp_testcases_bin_set_ipv4addr",
-        "ltp_testcases_bin_shell_pipe01.sh",
-        "ltp_testcases_bin_sit01.sh",
-        "ltp_testcases_bin_smack_common.sh",
-        "ltp_testcases_bin_smack_file_access.sh",
-        "ltp_testcases_bin_smack_set_ambient.sh",
-        "ltp_testcases_bin_smack_set_cipso.sh",
-        "ltp_testcases_bin_smack_set_current.sh",
-        "ltp_testcases_bin_smack_set_direct.sh",
-        "ltp_testcases_bin_smack_set_doi.sh",
-        "ltp_testcases_bin_smack_set_load.sh",
-        "ltp_testcases_bin_smack_set_netlabel.sh",
-        "ltp_testcases_bin_smack_set_onlycap.sh",
-        "ltp_testcases_bin_smt_smp_affinity.sh",
-        "ltp_testcases_bin_smt_smp_enabled.sh",
-        "ltp_testcases_bin_ssh-stress.sh",
-        "ltp_testcases_bin_stop_freeze_sleep_thaw_cont.sh",
-        "ltp_testcases_bin_stop_freeze_thaw_cont.sh",
-        "ltp_testcases_bin_sysctl01.sh",
-        "ltp_testcases_bin_sysctl02.sh",
-        "ltp_testcases_bin_tc01.sh",
-        "ltp_testcases_bin_tcp4-multi-diffip01",
-        "ltp_testcases_bin_tcp4-multi-diffip02",
-        "ltp_testcases_bin_tcp4-multi-diffip03",
-        "ltp_testcases_bin_tcp4-multi-diffip04",
-        "ltp_testcases_bin_tcp4-multi-diffip05",
-        "ltp_testcases_bin_tcp4-multi-diffip06",
-        "ltp_testcases_bin_tcp4-multi-diffip07",
-        "ltp_testcases_bin_tcp4-multi-diffip08",
-        "ltp_testcases_bin_tcp4-multi-diffip09",
-        "ltp_testcases_bin_tcp4-multi-diffip10",
-        "ltp_testcases_bin_tcp4-multi-diffip11",
-        "ltp_testcases_bin_tcp4-multi-diffip12",
-        "ltp_testcases_bin_tcp4-multi-diffip13",
-        "ltp_testcases_bin_tcp4-multi-diffip14",
-        "ltp_testcases_bin_tcp4-multi-diffnic01",
-        "ltp_testcases_bin_tcp4-multi-diffnic02",
-        "ltp_testcases_bin_tcp4-multi-diffnic03",
-        "ltp_testcases_bin_tcp4-multi-diffnic04",
-        "ltp_testcases_bin_tcp4-multi-diffnic05",
-        "ltp_testcases_bin_tcp4-multi-diffnic06",
-        "ltp_testcases_bin_tcp4-multi-diffnic07",
-        "ltp_testcases_bin_tcp4-multi-diffnic08",
-        "ltp_testcases_bin_tcp4-multi-diffnic09",
-        "ltp_testcases_bin_tcp4-multi-diffnic10",
-        "ltp_testcases_bin_tcp4-multi-diffnic11",
-        "ltp_testcases_bin_tcp4-multi-diffnic12",
-        "ltp_testcases_bin_tcp4-multi-diffnic13",
-        "ltp_testcases_bin_tcp4-multi-diffnic14",
-        "ltp_testcases_bin_tcp4-multi-diffport01",
-        "ltp_testcases_bin_tcp4-multi-diffport02",
-        "ltp_testcases_bin_tcp4-multi-diffport03",
-        "ltp_testcases_bin_tcp4-multi-diffport04",
-        "ltp_testcases_bin_tcp4-multi-diffport05",
-        "ltp_testcases_bin_tcp4-multi-diffport06",
-        "ltp_testcases_bin_tcp4-multi-diffport07",
-        "ltp_testcases_bin_tcp4-multi-diffport08",
-        "ltp_testcases_bin_tcp4-multi-diffport09",
-        "ltp_testcases_bin_tcp4-multi-diffport10",
-        "ltp_testcases_bin_tcp4-multi-diffport11",
-        "ltp_testcases_bin_tcp4-multi-diffport12",
-        "ltp_testcases_bin_tcp4-multi-diffport13",
-        "ltp_testcases_bin_tcp4-multi-diffport14",
-        "ltp_testcases_bin_tcp4-multi-sameport01",
-        "ltp_testcases_bin_tcp4-multi-sameport02",
-        "ltp_testcases_bin_tcp4-multi-sameport03",
-        "ltp_testcases_bin_tcp4-multi-sameport04",
-        "ltp_testcases_bin_tcp4-multi-sameport05",
-        "ltp_testcases_bin_tcp4-multi-sameport06",
-        "ltp_testcases_bin_tcp4-multi-sameport07",
-        "ltp_testcases_bin_tcp4-multi-sameport08",
-        "ltp_testcases_bin_tcp4-multi-sameport09",
-        "ltp_testcases_bin_tcp4-multi-sameport10",
-        "ltp_testcases_bin_tcp4-multi-sameport11",
-        "ltp_testcases_bin_tcp4-multi-sameport12",
-        "ltp_testcases_bin_tcp4-multi-sameport13",
-        "ltp_testcases_bin_tcp4-multi-sameport14",
-        "ltp_testcases_bin_tcp4-uni-basic01",
-        "ltp_testcases_bin_tcp4-uni-basic02",
-        "ltp_testcases_bin_tcp4-uni-basic03",
-        "ltp_testcases_bin_tcp4-uni-basic04",
-        "ltp_testcases_bin_tcp4-uni-basic05",
-        "ltp_testcases_bin_tcp4-uni-basic06",
-        "ltp_testcases_bin_tcp4-uni-basic07",
-        "ltp_testcases_bin_tcp4-uni-basic08",
-        "ltp_testcases_bin_tcp4-uni-basic09",
-        "ltp_testcases_bin_tcp4-uni-basic10",
-        "ltp_testcases_bin_tcp4-uni-basic11",
-        "ltp_testcases_bin_tcp4-uni-basic12",
-        "ltp_testcases_bin_tcp4-uni-basic13",
-        "ltp_testcases_bin_tcp4-uni-basic14",
-        "ltp_testcases_bin_tcp4-uni-dsackoff01",
-        "ltp_testcases_bin_tcp4-uni-dsackoff02",
-        "ltp_testcases_bin_tcp4-uni-dsackoff03",
-        "ltp_testcases_bin_tcp4-uni-dsackoff04",
-        "ltp_testcases_bin_tcp4-uni-dsackoff05",
-        "ltp_testcases_bin_tcp4-uni-dsackoff06",
-        "ltp_testcases_bin_tcp4-uni-dsackoff07",
-        "ltp_testcases_bin_tcp4-uni-dsackoff08",
-        "ltp_testcases_bin_tcp4-uni-dsackoff09",
-        "ltp_testcases_bin_tcp4-uni-dsackoff10",
-        "ltp_testcases_bin_tcp4-uni-dsackoff11",
-        "ltp_testcases_bin_tcp4-uni-dsackoff12",
-        "ltp_testcases_bin_tcp4-uni-dsackoff13",
-        "ltp_testcases_bin_tcp4-uni-dsackoff14",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup01",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup02",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup03",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup04",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup05",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup06",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup07",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup08",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup09",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup10",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup11",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup12",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup13",
-        "ltp_testcases_bin_tcp4-uni-pktlossdup14",
-        "ltp_testcases_bin_tcp4-uni-sackoff01",
-        "ltp_testcases_bin_tcp4-uni-sackoff02",
-        "ltp_testcases_bin_tcp4-uni-sackoff03",
-        "ltp_testcases_bin_tcp4-uni-sackoff04",
-        "ltp_testcases_bin_tcp4-uni-sackoff05",
-        "ltp_testcases_bin_tcp4-uni-sackoff06",
-        "ltp_testcases_bin_tcp4-uni-sackoff07",
-        "ltp_testcases_bin_tcp4-uni-sackoff08",
-        "ltp_testcases_bin_tcp4-uni-sackoff09",
-        "ltp_testcases_bin_tcp4-uni-sackoff10",
-        "ltp_testcases_bin_tcp4-uni-sackoff11",
-        "ltp_testcases_bin_tcp4-uni-sackoff12",
-        "ltp_testcases_bin_tcp4-uni-sackoff13",
-        "ltp_testcases_bin_tcp4-uni-sackoff14",
-        "ltp_testcases_bin_tcp4-uni-smallsend01",
-        "ltp_testcases_bin_tcp4-uni-smallsend02",
-        "ltp_testcases_bin_tcp4-uni-smallsend03",
-        "ltp_testcases_bin_tcp4-uni-smallsend04",
-        "ltp_testcases_bin_tcp4-uni-smallsend05",
-        "ltp_testcases_bin_tcp4-uni-smallsend06",
-        "ltp_testcases_bin_tcp4-uni-smallsend07",
-        "ltp_testcases_bin_tcp4-uni-smallsend08",
-        "ltp_testcases_bin_tcp4-uni-smallsend09",
-        "ltp_testcases_bin_tcp4-uni-smallsend10",
-        "ltp_testcases_bin_tcp4-uni-smallsend11",
-        "ltp_testcases_bin_tcp4-uni-smallsend12",
-        "ltp_testcases_bin_tcp4-uni-smallsend13",
-        "ltp_testcases_bin_tcp4-uni-smallsend14",
-        "ltp_testcases_bin_tcp4-uni-tso01",
-        "ltp_testcases_bin_tcp4-uni-tso02",
-        "ltp_testcases_bin_tcp4-uni-tso03",
-        "ltp_testcases_bin_tcp4-uni-tso04",
-        "ltp_testcases_bin_tcp4-uni-tso05",
-        "ltp_testcases_bin_tcp4-uni-tso06",
-        "ltp_testcases_bin_tcp4-uni-tso07",
-        "ltp_testcases_bin_tcp4-uni-tso08",
-        "ltp_testcases_bin_tcp4-uni-tso09",
-        "ltp_testcases_bin_tcp4-uni-tso10",
-        "ltp_testcases_bin_tcp4-uni-tso11",
-        "ltp_testcases_bin_tcp4-uni-tso12",
-        "ltp_testcases_bin_tcp4-uni-tso13",
-        "ltp_testcases_bin_tcp4-uni-tso14",
-        "ltp_testcases_bin_tcp4-uni-winscale01",
-        "ltp_testcases_bin_tcp4-uni-winscale02",
-        "ltp_testcases_bin_tcp4-uni-winscale03",
-        "ltp_testcases_bin_tcp4-uni-winscale04",
-        "ltp_testcases_bin_tcp4-uni-winscale05",
-        "ltp_testcases_bin_tcp4-uni-winscale06",
-        "ltp_testcases_bin_tcp4-uni-winscale07",
-        "ltp_testcases_bin_tcp4-uni-winscale08",
-        "ltp_testcases_bin_tcp4-uni-winscale09",
-        "ltp_testcases_bin_tcp4-uni-winscale10",
-        "ltp_testcases_bin_tcp4-uni-winscale11",
-        "ltp_testcases_bin_tcp4-uni-winscale12",
-        "ltp_testcases_bin_tcp4-uni-winscale13",
-        "ltp_testcases_bin_tcp4-uni-winscale14",
-        "ltp_testcases_bin_tcp6-multi-diffip01",
-        "ltp_testcases_bin_tcp6-multi-diffip02",
-        "ltp_testcases_bin_tcp6-multi-diffip03",
-        "ltp_testcases_bin_tcp6-multi-diffip04",
-        "ltp_testcases_bin_tcp6-multi-diffip05",
-        "ltp_testcases_bin_tcp6-multi-diffip06",
-        "ltp_testcases_bin_tcp6-multi-diffip07",
-        "ltp_testcases_bin_tcp6-multi-diffip08",
-        "ltp_testcases_bin_tcp6-multi-diffip09",
-        "ltp_testcases_bin_tcp6-multi-diffip10",
-        "ltp_testcases_bin_tcp6-multi-diffip11",
-        "ltp_testcases_bin_tcp6-multi-diffip12",
-        "ltp_testcases_bin_tcp6-multi-diffip13",
-        "ltp_testcases_bin_tcp6-multi-diffip14",
-        "ltp_testcases_bin_tcp6-multi-diffnic01",
-        "ltp_testcases_bin_tcp6-multi-diffnic02",
-        "ltp_testcases_bin_tcp6-multi-diffnic03",
-        "ltp_testcases_bin_tcp6-multi-diffnic04",
-        "ltp_testcases_bin_tcp6-multi-diffnic05",
-        "ltp_testcases_bin_tcp6-multi-diffnic06",
-        "ltp_testcases_bin_tcp6-multi-diffnic07",
-        "ltp_testcases_bin_tcp6-multi-diffnic08",
-        "ltp_testcases_bin_tcp6-multi-diffnic09",
-        "ltp_testcases_bin_tcp6-multi-diffnic10",
-        "ltp_testcases_bin_tcp6-multi-diffnic11",
-        "ltp_testcases_bin_tcp6-multi-diffnic12",
-        "ltp_testcases_bin_tcp6-multi-diffnic13",
-        "ltp_testcases_bin_tcp6-multi-diffnic14",
-        "ltp_testcases_bin_tcp6-multi-diffport01",
-        "ltp_testcases_bin_tcp6-multi-diffport02",
-        "ltp_testcases_bin_tcp6-multi-diffport03",
-        "ltp_testcases_bin_tcp6-multi-diffport04",
-        "ltp_testcases_bin_tcp6-multi-diffport05",
-        "ltp_testcases_bin_tcp6-multi-diffport06",
-        "ltp_testcases_bin_tcp6-multi-diffport07",
-        "ltp_testcases_bin_tcp6-multi-diffport08",
-        "ltp_testcases_bin_tcp6-multi-diffport09",
-        "ltp_testcases_bin_tcp6-multi-diffport10",
-        "ltp_testcases_bin_tcp6-multi-diffport11",
-        "ltp_testcases_bin_tcp6-multi-diffport12",
-        "ltp_testcases_bin_tcp6-multi-diffport13",
-        "ltp_testcases_bin_tcp6-multi-diffport14",
-        "ltp_testcases_bin_tcp6-multi-sameport01",
-        "ltp_testcases_bin_tcp6-multi-sameport02",
-        "ltp_testcases_bin_tcp6-multi-sameport03",
-        "ltp_testcases_bin_tcp6-multi-sameport04",
-        "ltp_testcases_bin_tcp6-multi-sameport05",
-        "ltp_testcases_bin_tcp6-multi-sameport06",
-        "ltp_testcases_bin_tcp6-multi-sameport07",
-        "ltp_testcases_bin_tcp6-multi-sameport08",
-        "ltp_testcases_bin_tcp6-multi-sameport09",
-        "ltp_testcases_bin_tcp6-multi-sameport10",
-        "ltp_testcases_bin_tcp6-multi-sameport11",
-        "ltp_testcases_bin_tcp6-multi-sameport12",
-        "ltp_testcases_bin_tcp6-multi-sameport13",
-        "ltp_testcases_bin_tcp6-multi-sameport14",
-        "ltp_testcases_bin_tcp6-uni-basic01",
-        "ltp_testcases_bin_tcp6-uni-basic02",
-        "ltp_testcases_bin_tcp6-uni-basic03",
-        "ltp_testcases_bin_tcp6-uni-basic04",
-        "ltp_testcases_bin_tcp6-uni-basic05",
-        "ltp_testcases_bin_tcp6-uni-basic06",
-        "ltp_testcases_bin_tcp6-uni-basic07",
-        "ltp_testcases_bin_tcp6-uni-basic08",
-        "ltp_testcases_bin_tcp6-uni-basic09",
-        "ltp_testcases_bin_tcp6-uni-basic10",
-        "ltp_testcases_bin_tcp6-uni-basic11",
-        "ltp_testcases_bin_tcp6-uni-basic12",
-        "ltp_testcases_bin_tcp6-uni-basic13",
-        "ltp_testcases_bin_tcp6-uni-basic14",
-        "ltp_testcases_bin_tcp6-uni-dsackoff01",
-        "ltp_testcases_bin_tcp6-uni-dsackoff02",
-        "ltp_testcases_bin_tcp6-uni-dsackoff03",
-        "ltp_testcases_bin_tcp6-uni-dsackoff04",
-        "ltp_testcases_bin_tcp6-uni-dsackoff05",
-        "ltp_testcases_bin_tcp6-uni-dsackoff06",
-        "ltp_testcases_bin_tcp6-uni-dsackoff07",
-        "ltp_testcases_bin_tcp6-uni-dsackoff08",
-        "ltp_testcases_bin_tcp6-uni-dsackoff09",
-        "ltp_testcases_bin_tcp6-uni-dsackoff10",
-        "ltp_testcases_bin_tcp6-uni-dsackoff11",
-        "ltp_testcases_bin_tcp6-uni-dsackoff12",
-        "ltp_testcases_bin_tcp6-uni-dsackoff13",
-        "ltp_testcases_bin_tcp6-uni-dsackoff14",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup01",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup02",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup03",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup04",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup05",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup06",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup07",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup08",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup09",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup10",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup11",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup12",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup13",
-        "ltp_testcases_bin_tcp6-uni-pktlossdup14",
-        "ltp_testcases_bin_tcp6-uni-sackoff01",
-        "ltp_testcases_bin_tcp6-uni-sackoff02",
-        "ltp_testcases_bin_tcp6-uni-sackoff03",
-        "ltp_testcases_bin_tcp6-uni-sackoff04",
-        "ltp_testcases_bin_tcp6-uni-sackoff05",
-        "ltp_testcases_bin_tcp6-uni-sackoff06",
-        "ltp_testcases_bin_tcp6-uni-sackoff07",
-        "ltp_testcases_bin_tcp6-uni-sackoff08",
-        "ltp_testcases_bin_tcp6-uni-sackoff09",
-        "ltp_testcases_bin_tcp6-uni-sackoff10",
-        "ltp_testcases_bin_tcp6-uni-sackoff11",
-        "ltp_testcases_bin_tcp6-uni-sackoff12",
-        "ltp_testcases_bin_tcp6-uni-sackoff13",
-        "ltp_testcases_bin_tcp6-uni-sackoff14",
-        "ltp_testcases_bin_tcp6-uni-smallsend01",
-        "ltp_testcases_bin_tcp6-uni-smallsend02",
-        "ltp_testcases_bin_tcp6-uni-smallsend03",
-        "ltp_testcases_bin_tcp6-uni-smallsend04",
-        "ltp_testcases_bin_tcp6-uni-smallsend05",
-        "ltp_testcases_bin_tcp6-uni-smallsend06",
-        "ltp_testcases_bin_tcp6-uni-smallsend07",
-        "ltp_testcases_bin_tcp6-uni-smallsend08",
-        "ltp_testcases_bin_tcp6-uni-smallsend09",
-        "ltp_testcases_bin_tcp6-uni-smallsend10",
-        "ltp_testcases_bin_tcp6-uni-smallsend11",
-        "ltp_testcases_bin_tcp6-uni-smallsend12",
-        "ltp_testcases_bin_tcp6-uni-smallsend13",
-        "ltp_testcases_bin_tcp6-uni-smallsend14",
-        "ltp_testcases_bin_tcp6-uni-tso01",
-        "ltp_testcases_bin_tcp6-uni-tso02",
-        "ltp_testcases_bin_tcp6-uni-tso03",
-        "ltp_testcases_bin_tcp6-uni-tso04",
-        "ltp_testcases_bin_tcp6-uni-tso05",
-        "ltp_testcases_bin_tcp6-uni-tso06",
-        "ltp_testcases_bin_tcp6-uni-tso07",
-        "ltp_testcases_bin_tcp6-uni-tso08",
-        "ltp_testcases_bin_tcp6-uni-tso09",
-        "ltp_testcases_bin_tcp6-uni-tso10",
-        "ltp_testcases_bin_tcp6-uni-tso11",
-        "ltp_testcases_bin_tcp6-uni-tso12",
-        "ltp_testcases_bin_tcp6-uni-tso13",
-        "ltp_testcases_bin_tcp6-uni-tso14",
-        "ltp_testcases_bin_tcp6-uni-winscale01",
-        "ltp_testcases_bin_tcp6-uni-winscale02",
-        "ltp_testcases_bin_tcp6-uni-winscale03",
-        "ltp_testcases_bin_tcp6-uni-winscale04",
-        "ltp_testcases_bin_tcp6-uni-winscale05",
-        "ltp_testcases_bin_tcp6-uni-winscale06",
-        "ltp_testcases_bin_tcp6-uni-winscale07",
-        "ltp_testcases_bin_tcp6-uni-winscale08",
-        "ltp_testcases_bin_tcp6-uni-winscale09",
-        "ltp_testcases_bin_tcp6-uni-winscale10",
-        "ltp_testcases_bin_tcp6-uni-winscale11",
-        "ltp_testcases_bin_tcp6-uni-winscale12",
-        "ltp_testcases_bin_tcp6-uni-winscale13",
-        "ltp_testcases_bin_tcp6-uni-winscale14",
-        "ltp_testcases_bin_tcp_cc_lib.sh",
-        "ltp_testcases_bin_tcp_fastopen_run.sh",
-        "ltp_testcases_bin_tcp_ipsec.sh",
-        "ltp_testcases_bin_tcp_ipsec_vti.sh",
-        "ltp_testcases_bin_tcpdump01.sh",
-        "ltp_testcases_bin_telnet01.sh",
-        "ltp_testcases_bin_test.sh",
-        "ltp_testcases_bin_test_controllers.sh",
-        "ltp_testcases_bin_test_ioctl",
-        "ltp_testcases_bin_test_robind.sh",
-        "ltp_testcases_bin_tracepath01.sh",
-        "ltp_testcases_bin_traceroute01.sh",
-        "ltp_testcases_bin_tst_ansi_color.sh",
-        "ltp_testcases_bin_tst_net.sh",
-        "ltp_testcases_bin_tst_net_stress.sh",
-        "ltp_testcases_bin_tst_security.sh",
-        "ltp_testcases_bin_tst_test.sh",
-        "ltp_testcases_bin_udp4-multi-diffip01",
-        "ltp_testcases_bin_udp4-multi-diffip02",
-        "ltp_testcases_bin_udp4-multi-diffip03",
-        "ltp_testcases_bin_udp4-multi-diffip04",
-        "ltp_testcases_bin_udp4-multi-diffip05",
-        "ltp_testcases_bin_udp4-multi-diffip06",
-        "ltp_testcases_bin_udp4-multi-diffip07",
-        "ltp_testcases_bin_udp4-multi-diffnic01",
-        "ltp_testcases_bin_udp4-multi-diffnic02",
-        "ltp_testcases_bin_udp4-multi-diffnic03",
-        "ltp_testcases_bin_udp4-multi-diffnic04",
-        "ltp_testcases_bin_udp4-multi-diffnic05",
-        "ltp_testcases_bin_udp4-multi-diffnic06",
-        "ltp_testcases_bin_udp4-multi-diffnic07",
-        "ltp_testcases_bin_udp4-multi-diffport01",
-        "ltp_testcases_bin_udp4-multi-diffport02",
-        "ltp_testcases_bin_udp4-multi-diffport03",
-        "ltp_testcases_bin_udp4-multi-diffport04",
-        "ltp_testcases_bin_udp4-multi-diffport05",
-        "ltp_testcases_bin_udp4-multi-diffport06",
-        "ltp_testcases_bin_udp4-multi-diffport07",
-        "ltp_testcases_bin_udp4-uni-basic01",
-        "ltp_testcases_bin_udp4-uni-basic02",
-        "ltp_testcases_bin_udp4-uni-basic03",
-        "ltp_testcases_bin_udp4-uni-basic04",
-        "ltp_testcases_bin_udp4-uni-basic05",
-        "ltp_testcases_bin_udp4-uni-basic06",
-        "ltp_testcases_bin_udp4-uni-basic07",
-        "ltp_testcases_bin_udp6-multi-diffip01",
-        "ltp_testcases_bin_udp6-multi-diffip02",
-        "ltp_testcases_bin_udp6-multi-diffip03",
-        "ltp_testcases_bin_udp6-multi-diffip04",
-        "ltp_testcases_bin_udp6-multi-diffip05",
-        "ltp_testcases_bin_udp6-multi-diffip06",
-        "ltp_testcases_bin_udp6-multi-diffip07",
-        "ltp_testcases_bin_udp6-multi-diffnic01",
-        "ltp_testcases_bin_udp6-multi-diffnic02",
-        "ltp_testcases_bin_udp6-multi-diffnic03",
-        "ltp_testcases_bin_udp6-multi-diffnic04",
-        "ltp_testcases_bin_udp6-multi-diffnic05",
-        "ltp_testcases_bin_udp6-multi-diffnic06",
-        "ltp_testcases_bin_udp6-multi-diffnic07",
-        "ltp_testcases_bin_udp6-multi-diffport01",
-        "ltp_testcases_bin_udp6-multi-diffport02",
-        "ltp_testcases_bin_udp6-multi-diffport03",
-        "ltp_testcases_bin_udp6-multi-diffport04",
-        "ltp_testcases_bin_udp6-multi-diffport05",
-        "ltp_testcases_bin_udp6-multi-diffport06",
-        "ltp_testcases_bin_udp6-multi-diffport07",
-        "ltp_testcases_bin_udp6-uni-basic01",
-        "ltp_testcases_bin_udp6-uni-basic02",
-        "ltp_testcases_bin_udp6-uni-basic03",
-        "ltp_testcases_bin_udp6-uni-basic04",
-        "ltp_testcases_bin_udp6-uni-basic05",
-        "ltp_testcases_bin_udp6-uni-basic06",
-        "ltp_testcases_bin_udp6-uni-basic07",
-        "ltp_testcases_bin_udp_ipsec.sh",
-        "ltp_testcases_bin_udp_ipsec_vti.sh",
-        "ltp_testcases_bin_unshare01.sh",
-        "ltp_testcases_bin_unzip01.sh",
-        "ltp_testcases_bin_vfork_freeze.sh",
-        "ltp_testcases_bin_virt_lib.sh",
-        "ltp_testcases_bin_vlan01.sh",
-        "ltp_testcases_bin_vlan02.sh",
-        "ltp_testcases_bin_vlan03.sh",
-        "ltp_testcases_bin_vma05.sh",
-        "ltp_testcases_bin_vxlan01.sh",
-        "ltp_testcases_bin_vxlan02.sh",
-        "ltp_testcases_bin_vxlan03.sh",
-        "ltp_testcases_bin_vxlan04.sh",
-        "ltp_testcases_bin_wireguard01.sh",
-        "ltp_testcases_bin_wireguard02.sh",
-        "ltp_testcases_bin_wireguard_lib.sh",
-        "ltp_testcases_bin_write_freezing.sh",
-        "ltp_testcases_bin_xinetd_tests.sh",
-        "ltp_testcases_bin_zram01.sh",
-        "ltp_testcases_bin_zram02.sh",
-        "ltp_testcases_bin_zram_lib.sh",
-        "ltp_testcases_data_ar01_file1.in",
-        "ltp_testcases_data_ar01_file10.in",
-        "ltp_testcases_data_ar01_file2.in",
-        "ltp_testcases_data_ar01_file3.in",
-        "ltp_testcases_data_ar01_file4.in",
-        "ltp_testcases_data_binfmt_misc02_file.extension",
-        "ltp_testcases_data_binfmt_misc02_file.magic",
-        "ltp_testcases_data_file01_in.ar",
-        "ltp_testcases_data_file01_in.bash",
-        "ltp_testcases_data_file01_in.c",
-        "ltp_testcases_data_file01_in.jpg",
-        "ltp_testcases_data_file01_in.m4",
-        "ltp_testcases_data_file01_in.mp3",
-        "ltp_testcases_data_file01_in.pl",
-        "ltp_testcases_data_file01_in.png",
-        "ltp_testcases_data_file01_in.py",
-        "ltp_testcases_data_file01_in.sh",
-        "ltp_testcases_data_file01_in.src.rpm",
-        "ltp_testcases_data_file01_in.tar",
-        "ltp_testcases_data_file01_in.tar.bz2",
-        "ltp_testcases_data_file01_in.tar.gz",
-        "ltp_testcases_data_file01_in.txt",
-        "ltp_testcases_data_file01_in.wav",
-        "ltp_testcases_data_file01_in.zip",
-        "ltp_testcases_data_ima_kexec_kexec.policy",
-        "ltp_testcases_data_ima_keys_keycheck.policy",
-        "ltp_testcases_data_ima_keys_x509_ima.der",
-        "ltp_testcases_data_ima_policy_measure.policy",
-        "ltp_testcases_data_ima_policy_measure.policy-invalid",
-        "ltp_testcases_data_ima_selinux_selinux.policy",
-        "ltp_testcases_data_ld01_d1.c",
-        "ltp_testcases_data_ld01_f1.c",
-        "ltp_testcases_data_ld01_main.c",
-        "ltp_testcases_data_ld01_rd1.c",
-        "ltp_testcases_data_ld01_rf1.c",
-        "ltp_testcases_data_lvm_runfile.tpl",
-        "ltp_testcases_data_mc_member_ManyGroups",
-        "ltp_testcases_data_mc_member_TooManyGroups",
-        "ltp_testcases_data_rpc01_file.1",
-        "ltp_testcases_data_rpc01_file.2",
-        "ltp_testcases_data_unzip01_dir.out",
-        "ltp_testcases_data_unzip01_test.zip",
-        "ltp_testsf_c",
-        "ltp_testsf_c6",
-        "ltp_testsf_s",
-        "ltp_testsf_s6",
-        "ltp_tgkill01",
-        "ltp_tgkill02",
-        "ltp_tgkill03",
-        "ltp_thp01",
-        "ltp_thp02",
-        "ltp_thp03",
-        "ltp_thp04",
-        "ltp_time-schedule",
-        "ltp_time01",
-        "ltp_timed_forkbomb",
-        "ltp_timens01",
-        "ltp_timer_create01",
-        "ltp_timer_create02",
-        "ltp_timer_create03",
-        "ltp_timer_delete01",
-        "ltp_timer_delete02",
-        "ltp_timer_getoverrun01",
-        "ltp_timer_gettime01",
-        "ltp_timer_settime01",
-        "ltp_timer_settime02",
-        "ltp_timer_settime03",
-        "ltp_timerfd01",
-        "ltp_timerfd02",
-        "ltp_timerfd04",
-        "ltp_timerfd_create01",
-        "ltp_timerfd_gettime01",
-        "ltp_timerfd_settime01",
-        "ltp_timerfd_settime02",
-        "ltp_times01",
-        "ltp_times03",
-        "ltp_tkill01",
-        "ltp_tkill02",
-        "ltp_tpci",
-        "ltp_trace_sched",
-        "ltp_trerrno",
-        "ltp_truncate02",
-        "ltp_truncate02_64",
-        "ltp_truncate03",
-        "ltp_truncate03_64",
-        "ltp_tst_bool_expr",
-        "ltp_tst_brk",
-        "ltp_tst_brkm",
-        "ltp_tst_capability01",
-        "ltp_tst_capability02",
-        "ltp_tst_cgctl",
-        "ltp_tst_cgroup01",
-        "ltp_tst_cgroup02",
-        "ltp_tst_check_drivers",
-        "ltp_tst_check_kconfigs",
-        "ltp_tst_checkpoint",
-        "ltp_tst_checkpoint_wait_timeout",
-        "ltp_tst_checkpoint_wake_timeout",
-        "ltp_tst_cleanup_once",
-        "ltp_tst_dataroot01",
-        "ltp_tst_dataroot02",
-        "ltp_tst_dataroot03",
-        "ltp_tst_device",
-        "ltp_tst_exit",
-        "ltp_tst_expiration_timer",
-        "ltp_tst_fs_fill_hardlinks",
-        "ltp_tst_fs_fill_subdirs",
-        "ltp_tst_fs_has_free",
-        "ltp_tst_fsfreeze",
-        "ltp_tst_fuzzy_sync01",
-        "ltp_tst_fuzzy_sync02",
-        "ltp_tst_fuzzy_sync03",
-        "ltp_tst_get_free_pids",
-        "ltp_tst_get_median",
-        "ltp_tst_get_unused_port",
-        "ltp_tst_getconf",
-        "ltp_tst_hexdump",
-        "ltp_tst_kvcmp",
-        "ltp_tst_lockdown_enabled",
-        "ltp_tst_ncpus",
-        "ltp_tst_ncpus_conf",
-        "ltp_tst_ncpus_max",
-        "ltp_tst_needs_cmds01",
-        "ltp_tst_needs_cmds02",
-        "ltp_tst_needs_cmds03",
-        "ltp_tst_needs_cmds04",
-        "ltp_tst_needs_cmds05",
-        "ltp_tst_needs_cmds06",
-        "ltp_tst_needs_cmds07",
-        "ltp_tst_needs_cmds08",
-        "ltp_tst_net_iface_prefix",
-        "ltp_tst_net_ip_prefix",
-        "ltp_tst_net_vars",
-        "ltp_tst_ns_create",
-        "ltp_tst_ns_exec",
-        "ltp_tst_ns_ifmove",
-        "ltp_tst_print_result",
-        "ltp_tst_process_state",
-        "ltp_tst_random",
-        "ltp_tst_record_childstatus",
-        "ltp_tst_res",
-        "ltp_tst_res_flags",
-        "ltp_tst_res_hexd",
-        "ltp_tst_resm",
-        "ltp_tst_rod",
-        "ltp_tst_safe_fileops",
-        "ltp_tst_safe_macros",
-        "ltp_tst_secureboot_enabled",
-        "ltp_tst_sleep",
-        "ltp_tst_strerrno",
-        "ltp_tst_strsig",
-        "ltp_tst_strstatus",
-        "ltp_tst_supported_fs",
-        "ltp_tst_timeout_kill",
-        "ltp_tst_tmpdir_test",
-        "ltp_uaccess",
-        "ltp_uevent01",
-        "ltp_uevent02",
-        "ltp_uevent03",
-        "ltp_umask01",
-        "ltp_umip_basic_test",
-        "ltp_umount01",
-        "ltp_umount02",
-        "ltp_umount03",
-        "ltp_umount2_01",
-        "ltp_umount2_02",
-        "ltp_uname01",
-        "ltp_uname02",
-        "ltp_uname04",
-        "ltp_unlink05",
-        "ltp_unlink07",
-        "ltp_unlink08",
-        "ltp_unlinkat01",
-        "ltp_unshare01",
-        "ltp_unshare02",
-        "ltp_userfaultfd01",
-        "ltp_ustat01",
-        "ltp_ustat02",
-        "ltp_utime01",
-        "ltp_utime02",
-        "ltp_utime03",
-        "ltp_utime04",
-        "ltp_utime05",
-        "ltp_utime06",
-        "ltp_utimensat01",
-        "ltp_utimes01",
-        "ltp_utsname01",
-        "ltp_utsname02",
-        "ltp_utsname03",
-        "ltp_utsname04",
-        "ltp_variant",
-        "ltp_verify_caps_exec",
-        "ltp_vfork",
-        "ltp_vfork01",
-        "ltp_vfork02",
-        "ltp_vhangup01",
-        "ltp_vhangup02",
-        "ltp_vma01",
-        "ltp_vma02",
-        "ltp_vma03",
-        "ltp_vma04",
-        "ltp_vma05_vdso",
-        "ltp_vmsplice01",
-        "ltp_vmsplice02",
-        "ltp_vmsplice03",
-        "ltp_vmsplice04",
-        "ltp_vsock01",
-        "ltp_wait01",
-        "ltp_wait02",
-        "ltp_wait401",
-        "ltp_wait402",
-        "ltp_wait403",
-        "ltp_waitid01",
-        "ltp_waitid02",
-        "ltp_waitid03",
-        "ltp_waitid04",
-        "ltp_waitid05",
-        "ltp_waitid06",
-        "ltp_waitid07",
-        "ltp_waitid08",
-        "ltp_waitid09",
-        "ltp_waitid10",
-        "ltp_waitid11",
-        "ltp_waitpid01",
-        "ltp_waitpid02",
-        "ltp_waitpid03",
-        "ltp_waitpid04",
-        "ltp_waitpid05",
-        "ltp_waitpid06",
-        "ltp_waitpid07",
-        "ltp_waitpid08",
-        "ltp_waitpid09",
-        "ltp_waitpid10",
-        "ltp_waitpid11",
-        "ltp_waitpid12",
-        "ltp_waitpid13",
-        "ltp_wqueue01",
-        "ltp_wqueue02",
-        "ltp_wqueue03",
-        "ltp_wqueue04",
-        "ltp_wqueue05",
-        "ltp_wqueue06",
-        "ltp_wqueue07",
-        "ltp_wqueue08",
-        "ltp_wqueue09",
-        "ltp_write01",
-        "ltp_write02",
-        "ltp_write03",
-        "ltp_write04",
-        "ltp_write05",
-        "ltp_write06",
-        "ltp_writetest",
-        "ltp_writev01",
-        "ltp_writev02",
-        "ltp_writev03",
-        "ltp_writev05",
-        "ltp_writev06",
-        "ltp_writev07",
-        "ltp_zram03",
+    name: "vts_ltp_test_x86",
+    src: "empty.sh",
+    test_config: ":ltp_config_x86",
+    test_suites: [
+        "general-tests",
+        "vts",
     ],
+    enabled: false,
+    compile_multilib: "32",
+    arch: {
+        x86: {
+            enabled: true,
+        },
+        x86_64: {
+            enabled: true,
+        },
+    },
+    data: LTP_TESTS,
 }
diff --git a/android/empty.sh b/android/empty.sh
new file mode 100644
index 000000000..e69de29bb
diff --git a/android/ltp_package_list.mk b/android/ltp_package_list.mk
deleted file mode 100644
index df5e4936c..000000000
--- a/android/ltp_package_list.mk
+++ /dev/null
@@ -1,2728 +0,0 @@
-#
-# Copyright (C) 2016 The Android Open Source Project
-#
-# This software is licensed under the terms of the GNU General Public
-# License version 2, as published by the Free Software Foundation, and
-# may be copied, distributed, and modified under those terms.
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-#
-
-# This file is autogenerated by gen_android_build.sh
-
-ltp_packages := \
-  ltp_abort01 \
-  ltp_abs01 \
-  ltp_accept01 \
-  ltp_accept02 \
-  ltp_accept03 \
-  ltp_accept4_01 \
-  ltp_access01 \
-  ltp_access02 \
-  ltp_access03 \
-  ltp_access04 \
-  ltp_acct01 \
-  ltp_acct02 \
-  ltp_acct02_helper \
-  ltp_acl1 \
-  ltp_add_key01 \
-  ltp_add_key02 \
-  ltp_add_key03 \
-  ltp_add_key04 \
-  ltp_add_key05 \
-  ltp_adjtimex01 \
-  ltp_adjtimex02 \
-  ltp_adjtimex03 \
-  ltp_af_alg01 \
-  ltp_af_alg03 \
-  ltp_af_alg04 \
-  ltp_af_alg05 \
-  ltp_af_alg06 \
-  ltp_af_alg07 \
-  ltp_aio-stress \
-  ltp_aio01 \
-  ltp_aio02 \
-  ltp_aiocp \
-  ltp_aiodio_append \
-  ltp_aiodio_sparse \
-  ltp_alarm02 \
-  ltp_alarm03 \
-  ltp_alarm05 \
-  ltp_alarm06 \
-  ltp_alarm07 \
-  ltp_asapi_01 \
-  ltp_asapi_02 \
-  ltp_asapi_03 \
-  ltp_atof01 \
-  ltp_autogroup01 \
-  ltp_bind01 \
-  ltp_bind02 \
-  ltp_bind03 \
-  ltp_bind04 \
-  ltp_bind05 \
-  ltp_bind06 \
-  ltp_block_dev \
-  ltp_bpf_map01 \
-  ltp_bpf_prog01 \
-  ltp_bpf_prog02 \
-  ltp_bpf_prog03 \
-  ltp_bpf_prog04 \
-  ltp_bpf_prog05 \
-  ltp_bpf_prog06 \
-  ltp_bpf_prog07 \
-  ltp_brk01 \
-  ltp_brk02 \
-  ltp_cacheflush01 \
-  ltp_can_bcm01 \
-  ltp_can_filter \
-  ltp_can_rcv_own_msgs \
-  ltp_cap_bounds_r \
-  ltp_cap_bounds_rw \
-  ltp_cap_bset_inh_bounds \
-  ltp_capget01 \
-  ltp_capget02 \
-  ltp_capset01 \
-  ltp_capset02 \
-  ltp_capset03 \
-  ltp_capset04 \
-  ltp_cfs_bandwidth01 \
-  ltp_cgroup_core01 \
-  ltp_cgroup_core02 \
-  ltp_cgroup_core03 \
-  ltp_cgroup_fj_proc \
-  ltp_cgroup_regression_fork_processes \
-  ltp_cgroup_regression_getdelays \
-  ltp_cgroup_xattr \
-  ltp_chdir01 \
-  ltp_chdir04 \
-  ltp_check_keepcaps \
-  ltp_check_pe \
-  ltp_check_simple_capset \
-  ltp_chmod01 \
-  ltp_chmod03 \
-  ltp_chmod05 \
-  ltp_chmod07 \
-  ltp_chown01 \
-  ltp_chown01_16 \
-  ltp_chown02 \
-  ltp_chown02_16 \
-  ltp_chown03 \
-  ltp_chown03_16 \
-  ltp_chown05 \
-  ltp_chown05_16 \
-  ltp_chroot01 \
-  ltp_chroot02 \
-  ltp_chroot03 \
-  ltp_chroot04 \
-  ltp_clock_adjtime01 \
-  ltp_clock_adjtime02 \
-  ltp_clock_getres01 \
-  ltp_clock_gettime01 \
-  ltp_clock_gettime02 \
-  ltp_clock_gettime03 \
-  ltp_clock_gettime04 \
-  ltp_clock_nanosleep01 \
-  ltp_clock_nanosleep02 \
-  ltp_clock_nanosleep03 \
-  ltp_clock_nanosleep04 \
-  ltp_clock_settime01 \
-  ltp_clock_settime02 \
-  ltp_clock_settime03 \
-  ltp_clone01 \
-  ltp_clone02 \
-  ltp_clone03 \
-  ltp_clone04 \
-  ltp_clone05 \
-  ltp_clone06 \
-  ltp_clone07 \
-  ltp_clone08 \
-  ltp_clone09 \
-  ltp_clone301 \
-  ltp_clone302 \
-  ltp_clone303 \
-  ltp_close01 \
-  ltp_close02 \
-  ltp_close_range01 \
-  ltp_close_range02 \
-  ltp_connect01 \
-  ltp_connect02 \
-  ltp_copy_file_range01 \
-  ltp_copy_file_range02 \
-  ltp_copy_file_range03 \
-  ltp_cpuacct_task \
-  ltp_cpuctl_def_task01 \
-  ltp_cpuctl_def_task02 \
-  ltp_cpuctl_def_task03 \
-  ltp_cpuctl_def_task04 \
-  ltp_cpuctl_fj_cpu-hog \
-  ltp_cpuctl_fj_simple_echo \
-  ltp_cpuctl_latency_check_task \
-  ltp_cpuctl_latency_test \
-  ltp_cpuctl_test01 \
-  ltp_cpuctl_test02 \
-  ltp_cpuctl_test03 \
-  ltp_cpuctl_test04 \
-  ltp_cpufreq_boost \
-  ltp_cpuset01 \
-  ltp_cpuset_cpu_hog \
-  ltp_cpuset_list_compute \
-  ltp_cpuset_mem_hog \
-  ltp_cpuset_memory_pressure \
-  ltp_cpuset_sched_domains_check \
-  ltp_cpuset_syscall_test \
-  ltp_crash01 \
-  ltp_crash02 \
-  ltp_creat01 \
-  ltp_creat03 \
-  ltp_creat04 \
-  ltp_creat05 \
-  ltp_creat07 \
-  ltp_creat07_child \
-  ltp_creat08 \
-  ltp_creat09 \
-  ltp_create_datafile \
-  ltp_crypto_user01 \
-  ltp_crypto_user02 \
-  ltp_cve-2014-0196 \
-  ltp_cve-2015-3290 \
-  ltp_cve-2016-10044 \
-  ltp_cve-2016-7042 \
-  ltp_cve-2016-7117 \
-  ltp_cve-2017-16939 \
-  ltp_cve-2017-17052 \
-  ltp_cve-2017-17053 \
-  ltp_cve-2017-2618 \
-  ltp_cve-2017-2671 \
-  ltp_cve-2022-4378 \
-  ltp_data_space \
-  ltp_delete_module01 \
-  ltp_delete_module02 \
-  ltp_delete_module03 \
-  ltp_dio_append \
-  ltp_dio_read \
-  ltp_dio_sparse \
-  ltp_dio_truncate \
-  ltp_diotest1 \
-  ltp_diotest2 \
-  ltp_diotest3 \
-  ltp_diotest5 \
-  ltp_diotest6 \
-  ltp_dirty \
-  ltp_dirtyc0w \
-  ltp_dirtyc0w_child \
-  ltp_dirtyc0w_shmem \
-  ltp_dirtyc0w_shmem_child \
-  ltp_dirtypipe \
-  ltp_dma_thread_diotest \
-  ltp_dup01 \
-  ltp_dup02 \
-  ltp_dup03 \
-  ltp_dup04 \
-  ltp_dup05 \
-  ltp_dup06 \
-  ltp_dup07 \
-  ltp_dup201 \
-  ltp_dup202 \
-  ltp_dup203 \
-  ltp_dup204 \
-  ltp_dup205 \
-  ltp_dup206 \
-  ltp_dup207 \
-  ltp_dup3_01 \
-  ltp_dup3_02 \
-  ltp_eas_big_to_small \
-  ltp_eas_one_big_task \
-  ltp_eas_one_small_task \
-  ltp_eas_small_big_toggle \
-  ltp_eas_small_to_big \
-  ltp_eas_two_big_three_small \
-  ltp_endian_switch01 \
-  ltp_epoll-ltp \
-  ltp_epoll_create01 \
-  ltp_epoll_create02 \
-  ltp_epoll_create1_01 \
-  ltp_epoll_create1_02 \
-  ltp_epoll_ctl01 \
-  ltp_epoll_ctl02 \
-  ltp_epoll_ctl03 \
-  ltp_epoll_ctl04 \
-  ltp_epoll_ctl05 \
-  ltp_epoll_pwait01 \
-  ltp_epoll_pwait02 \
-  ltp_epoll_pwait03 \
-  ltp_epoll_pwait04 \
-  ltp_epoll_pwait05 \
-  ltp_epoll_wait01 \
-  ltp_epoll_wait02 \
-  ltp_epoll_wait03 \
-  ltp_epoll_wait04 \
-  ltp_epoll_wait05 \
-  ltp_epoll_wait06 \
-  ltp_epoll_wait07 \
-  ltp_event_generator \
-  ltp_eventfd01 \
-  ltp_eventfd02 \
-  ltp_eventfd03 \
-  ltp_eventfd04 \
-  ltp_eventfd05 \
-  ltp_eventfd06 \
-  ltp_eventfd2_01 \
-  ltp_eventfd2_02 \
-  ltp_eventfd2_03 \
-  ltp_exec_with_inh \
-  ltp_exec_without_inh \
-  ltp_execl01 \
-  ltp_execl01_child \
-  ltp_execle01 \
-  ltp_execle01_child \
-  ltp_execlp01 \
-  ltp_execlp01_child \
-  ltp_execv01 \
-  ltp_execv01_child \
-  ltp_execve01 \
-  ltp_execve01_child \
-  ltp_execve02 \
-  ltp_execve03 \
-  ltp_execve04 \
-  ltp_execve05 \
-  ltp_execve06 \
-  ltp_execve06_child \
-  ltp_execve_child \
-  ltp_execveat01 \
-  ltp_execveat02 \
-  ltp_execveat03 \
-  ltp_execveat_child \
-  ltp_execveat_errno \
-  ltp_execvp01 \
-  ltp_execvp01_child \
-  ltp_exit01 \
-  ltp_exit02 \
-  ltp_exit_group01 \
-  ltp_f1 \
-  ltp_f2 \
-  ltp_f3 \
-  ltp_faccessat01 \
-  ltp_faccessat02 \
-  ltp_faccessat201 \
-  ltp_faccessat202 \
-  ltp_fallocate01 \
-  ltp_fallocate02 \
-  ltp_fallocate03 \
-  ltp_fallocate04 \
-  ltp_fallocate05 \
-  ltp_fallocate06 \
-  ltp_fanotify01 \
-  ltp_fanotify02 \
-  ltp_fanotify03 \
-  ltp_fanotify04 \
-  ltp_fanotify05 \
-  ltp_fanotify06 \
-  ltp_fanotify07 \
-  ltp_fanotify08 \
-  ltp_fanotify09 \
-  ltp_fanotify10 \
-  ltp_fanotify11 \
-  ltp_fanotify12 \
-  ltp_fanotify13 \
-  ltp_fanotify14 \
-  ltp_fanotify15 \
-  ltp_fanotify16 \
-  ltp_fanotify17 \
-  ltp_fanotify18 \
-  ltp_fanotify19 \
-  ltp_fanotify20 \
-  ltp_fanotify21 \
-  ltp_fanotify22 \
-  ltp_fanotify23 \
-  ltp_fanotify_child \
-  ltp_fanout01 \
-  ltp_fchdir01 \
-  ltp_fchdir02 \
-  ltp_fchdir03 \
-  ltp_fchmod01 \
-  ltp_fchmod02 \
-  ltp_fchmod03 \
-  ltp_fchmod04 \
-  ltp_fchmod05 \
-  ltp_fchmod06 \
-  ltp_fchmodat01 \
-  ltp_fchmodat02 \
-  ltp_fchown01 \
-  ltp_fchown01_16 \
-  ltp_fchown02 \
-  ltp_fchown02_16 \
-  ltp_fchown03 \
-  ltp_fchown03_16 \
-  ltp_fchown04 \
-  ltp_fchown04_16 \
-  ltp_fchown05 \
-  ltp_fchown05_16 \
-  ltp_fchownat01 \
-  ltp_fchownat02 \
-  ltp_fcntl01 \
-  ltp_fcntl01_64 \
-  ltp_fcntl02 \
-  ltp_fcntl02_64 \
-  ltp_fcntl03 \
-  ltp_fcntl03_64 \
-  ltp_fcntl04 \
-  ltp_fcntl04_64 \
-  ltp_fcntl05 \
-  ltp_fcntl05_64 \
-  ltp_fcntl07 \
-  ltp_fcntl07_64 \
-  ltp_fcntl08 \
-  ltp_fcntl08_64 \
-  ltp_fcntl09 \
-  ltp_fcntl09_64 \
-  ltp_fcntl10 \
-  ltp_fcntl10_64 \
-  ltp_fcntl11 \
-  ltp_fcntl11_64 \
-  ltp_fcntl12 \
-  ltp_fcntl12_64 \
-  ltp_fcntl13 \
-  ltp_fcntl13_64 \
-  ltp_fcntl14 \
-  ltp_fcntl14_64 \
-  ltp_fcntl15 \
-  ltp_fcntl15_64 \
-  ltp_fcntl16 \
-  ltp_fcntl16_64 \
-  ltp_fcntl17 \
-  ltp_fcntl17_64 \
-  ltp_fcntl18 \
-  ltp_fcntl18_64 \
-  ltp_fcntl19 \
-  ltp_fcntl19_64 \
-  ltp_fcntl20 \
-  ltp_fcntl20_64 \
-  ltp_fcntl21 \
-  ltp_fcntl21_64 \
-  ltp_fcntl22 \
-  ltp_fcntl22_64 \
-  ltp_fcntl23 \
-  ltp_fcntl23_64 \
-  ltp_fcntl24 \
-  ltp_fcntl24_64 \
-  ltp_fcntl25 \
-  ltp_fcntl25_64 \
-  ltp_fcntl26 \
-  ltp_fcntl26_64 \
-  ltp_fcntl27 \
-  ltp_fcntl27_64 \
-  ltp_fcntl28 \
-  ltp_fcntl28_64 \
-  ltp_fcntl29 \
-  ltp_fcntl29_64 \
-  ltp_fcntl30 \
-  ltp_fcntl30_64 \
-  ltp_fcntl31 \
-  ltp_fcntl31_64 \
-  ltp_fcntl32 \
-  ltp_fcntl32_64 \
-  ltp_fcntl33 \
-  ltp_fcntl33_64 \
-  ltp_fcntl34 \
-  ltp_fcntl34_64 \
-  ltp_fcntl35 \
-  ltp_fcntl35_64 \
-  ltp_fcntl36 \
-  ltp_fcntl36_64 \
-  ltp_fcntl37 \
-  ltp_fcntl37_64 \
-  ltp_fcntl38 \
-  ltp_fcntl38_64 \
-  ltp_fcntl39 \
-  ltp_fcntl39_64 \
-  ltp_fdatasync01 \
-  ltp_fdatasync02 \
-  ltp_fdatasync03 \
-  ltp_fgetxattr01 \
-  ltp_fgetxattr02 \
-  ltp_fgetxattr03 \
-  ltp_finit_module01 \
-  ltp_finit_module02 \
-  ltp_flistxattr01 \
-  ltp_flistxattr02 \
-  ltp_flistxattr03 \
-  ltp_float_bessel \
-  ltp_float_exp_log \
-  ltp_float_iperb \
-  ltp_float_power \
-  ltp_float_trigo \
-  ltp_flock01 \
-  ltp_flock02 \
-  ltp_flock03 \
-  ltp_flock04 \
-  ltp_flock06 \
-  ltp_fork01 \
-  ltp_fork03 \
-  ltp_fork04 \
-  ltp_fork05 \
-  ltp_fork07 \
-  ltp_fork08 \
-  ltp_fork09 \
-  ltp_fork10 \
-  ltp_fork13 \
-  ltp_fork14 \
-  ltp_fork_exec_loop \
-  ltp_fork_procs \
-  ltp_fpathconf01 \
-  ltp_fptest01 \
-  ltp_fptest02 \
-  ltp_frag \
-  ltp_fremovexattr01 \
-  ltp_fremovexattr02 \
-  ltp_fs_fill \
-  ltp_fs_perms \
-  ltp_fsconfig01 \
-  ltp_fsconfig02 \
-  ltp_fsconfig03 \
-  ltp_fsetxattr01 \
-  ltp_fsetxattr02 \
-  ltp_fsmount01 \
-  ltp_fsmount02 \
-  ltp_fsopen01 \
-  ltp_fsopen02 \
-  ltp_fspick01 \
-  ltp_fspick02 \
-  ltp_fsstress \
-  ltp_fstat02 \
-  ltp_fstat02_64 \
-  ltp_fstat03 \
-  ltp_fstat03_64 \
-  ltp_fstatat01 \
-  ltp_fstatfs01 \
-  ltp_fstatfs01_64 \
-  ltp_fstatfs02 \
-  ltp_fstatfs02_64 \
-  ltp_fsx-linux \
-  ltp_fsync01 \
-  ltp_fsync02 \
-  ltp_fsync03 \
-  ltp_fsync04 \
-  ltp_ftest01 \
-  ltp_ftest02 \
-  ltp_ftest03 \
-  ltp_ftest04 \
-  ltp_ftest05 \
-  ltp_ftest06 \
-  ltp_ftest07 \
-  ltp_ftest08 \
-  ltp_ftruncate01 \
-  ltp_ftruncate01_64 \
-  ltp_ftruncate03 \
-  ltp_ftruncate03_64 \
-  ltp_ftruncate04 \
-  ltp_ftruncate04_64 \
-  ltp_futex_cmp_requeue01 \
-  ltp_futex_cmp_requeue02 \
-  ltp_futex_wait01 \
-  ltp_futex_wait03 \
-  ltp_futex_wait04 \
-  ltp_futex_wait05 \
-  ltp_futex_wait_bitset01 \
-  ltp_futex_waitv01 \
-  ltp_futex_waitv02 \
-  ltp_futex_waitv03 \
-  ltp_futex_wake01 \
-  ltp_futex_wake02 \
-  ltp_futex_wake04 \
-  ltp_futimesat01 \
-  ltp_fw_load \
-  ltp_genacos \
-  ltp_genasin \
-  ltp_genatan \
-  ltp_genatan2 \
-  ltp_genbessel \
-  ltp_genceil \
-  ltp_gencos \
-  ltp_gencosh \
-  ltp_genexp \
-  ltp_genexp_log \
-  ltp_genfabs \
-  ltp_genfloor \
-  ltp_genfmod \
-  ltp_genfrexp \
-  ltp_genhypot \
-  ltp_geniperb \
-  ltp_genj0 \
-  ltp_genj1 \
-  ltp_genldexp \
-  ltp_genlgamma \
-  ltp_genlog \
-  ltp_genlog10 \
-  ltp_genmodf \
-  ltp_genpow \
-  ltp_genpower \
-  ltp_gensin \
-  ltp_gensinh \
-  ltp_gensqrt \
-  ltp_gentan \
-  ltp_gentanh \
-  ltp_gentrigo \
-  ltp_geny0 \
-  ltp_geny1 \
-  ltp_get_mempolicy01 \
-  ltp_get_mempolicy02 \
-  ltp_get_robust_list01 \
-  ltp_getaddrinfo_01 \
-  ltp_getcpu01 \
-  ltp_getcwd01 \
-  ltp_getcwd02 \
-  ltp_getcwd03 \
-  ltp_getcwd04 \
-  ltp_getdents01 \
-  ltp_getdents02 \
-  ltp_getdomainname01 \
-  ltp_getegid01 \
-  ltp_getegid01_16 \
-  ltp_getegid02 \
-  ltp_getegid02_16 \
-  ltp_geteuid01 \
-  ltp_geteuid01_16 \
-  ltp_geteuid02 \
-  ltp_geteuid02_16 \
-  ltp_getgid01 \
-  ltp_getgid01_16 \
-  ltp_getgid03 \
-  ltp_getgid03_16 \
-  ltp_getgroups01 \
-  ltp_getgroups01_16 \
-  ltp_getgroups03 \
-  ltp_getgroups03_16 \
-  ltp_gethostbyname_r01 \
-  ltp_gethostname01 \
-  ltp_getitimer01 \
-  ltp_getitimer02 \
-  ltp_getpagesize01 \
-  ltp_getpeername01 \
-  ltp_getpgid01 \
-  ltp_getpgid02 \
-  ltp_getpgrp01 \
-  ltp_getpid01 \
-  ltp_getpid02 \
-  ltp_getppid01 \
-  ltp_getppid02 \
-  ltp_getpriority01 \
-  ltp_getpriority02 \
-  ltp_getrandom01 \
-  ltp_getrandom02 \
-  ltp_getrandom03 \
-  ltp_getrandom04 \
-  ltp_getresgid01 \
-  ltp_getresgid01_16 \
-  ltp_getresgid02 \
-  ltp_getresgid02_16 \
-  ltp_getresgid03 \
-  ltp_getresgid03_16 \
-  ltp_getresuid01 \
-  ltp_getresuid01_16 \
-  ltp_getresuid02 \
-  ltp_getresuid02_16 \
-  ltp_getresuid03 \
-  ltp_getresuid03_16 \
-  ltp_getrlimit01 \
-  ltp_getrlimit02 \
-  ltp_getrlimit03 \
-  ltp_getrusage01 \
-  ltp_getrusage02 \
-  ltp_getrusage03_child \
-  ltp_getrusage04 \
-  ltp_getsid01 \
-  ltp_getsid02 \
-  ltp_getsockname01 \
-  ltp_getsockopt01 \
-  ltp_getsockopt02 \
-  ltp_gettid01 \
-  ltp_gettid02 \
-  ltp_gettimeofday01 \
-  ltp_gettimeofday02 \
-  ltp_getuid01 \
-  ltp_getuid01_16 \
-  ltp_getuid03 \
-  ltp_getuid03_16 \
-  ltp_getxattr01 \
-  ltp_getxattr02 \
-  ltp_getxattr03 \
-  ltp_getxattr04 \
-  ltp_getxattr05 \
-  ltp_hackbench \
-  ltp_hangup01 \
-  ltp_ht_affinity \
-  ltp_ht_enabled \
-  ltp_hugefallocate01 \
-  ltp_hugefallocate02 \
-  ltp_hugefork01 \
-  ltp_hugefork02 \
-  ltp_hugemmap01 \
-  ltp_hugemmap02 \
-  ltp_hugemmap04 \
-  ltp_hugemmap06 \
-  ltp_hugemmap07 \
-  ltp_hugemmap08 \
-  ltp_hugemmap09 \
-  ltp_hugemmap10 \
-  ltp_hugemmap11 \
-  ltp_hugemmap12 \
-  ltp_hugemmap13 \
-  ltp_hugemmap14 \
-  ltp_hugemmap16 \
-  ltp_hugemmap17 \
-  ltp_hugemmap18 \
-  ltp_hugemmap19 \
-  ltp_hugemmap20 \
-  ltp_hugemmap21 \
-  ltp_hugemmap22 \
-  ltp_hugemmap23 \
-  ltp_hugemmap24 \
-  ltp_hugemmap25 \
-  ltp_hugemmap26 \
-  ltp_hugemmap27 \
-  ltp_hugemmap28 \
-  ltp_hugemmap29 \
-  ltp_hugemmap30 \
-  ltp_hugemmap31 \
-  ltp_hugemmap32 \
-  ltp_icmp_rate_limit01 \
-  ltp_ima_boot_aggregate \
-  ltp_ima_mmap \
-  ltp_in \
-  ltp_in6_02 \
-  ltp_inh_capped \
-  ltp_init_module01 \
-  ltp_init_module02 \
-  ltp_inode01 \
-  ltp_inode02 \
-  ltp_inotify01 \
-  ltp_inotify02 \
-  ltp_inotify03 \
-  ltp_inotify04 \
-  ltp_inotify05 \
-  ltp_inotify06 \
-  ltp_inotify07 \
-  ltp_inotify08 \
-  ltp_inotify09 \
-  ltp_inotify10 \
-  ltp_inotify11 \
-  ltp_inotify12 \
-  ltp_inotify_init1_01 \
-  ltp_inotify_init1_02 \
-  ltp_input01 \
-  ltp_input02 \
-  ltp_input04 \
-  ltp_input05 \
-  ltp_input06 \
-  ltp_io_cancel01 \
-  ltp_io_cancel02 \
-  ltp_io_control01 \
-  ltp_io_destroy01 \
-  ltp_io_destroy02 \
-  ltp_io_getevents01 \
-  ltp_io_getevents02 \
-  ltp_io_pgetevents01 \
-  ltp_io_pgetevents02 \
-  ltp_io_setup01 \
-  ltp_io_setup02 \
-  ltp_io_submit01 \
-  ltp_io_submit02 \
-  ltp_io_submit03 \
-  ltp_io_uring01 \
-  ltp_io_uring02 \
-  ltp_ioctl01 \
-  ltp_ioctl03 \
-  ltp_ioctl04 \
-  ltp_ioctl05 \
-  ltp_ioctl06 \
-  ltp_ioctl07 \
-  ltp_ioctl08 \
-  ltp_ioctl09 \
-  ltp_ioctl_loop01 \
-  ltp_ioctl_loop02 \
-  ltp_ioctl_loop03 \
-  ltp_ioctl_loop04 \
-  ltp_ioctl_loop05 \
-  ltp_ioctl_loop06 \
-  ltp_ioctl_loop07 \
-  ltp_ioctl_ns01 \
-  ltp_ioctl_ns02 \
-  ltp_ioctl_ns03 \
-  ltp_ioctl_ns04 \
-  ltp_ioctl_ns05 \
-  ltp_ioctl_ns06 \
-  ltp_ioctl_ns07 \
-  ltp_ioctl_sg01 \
-  ltp_iogen \
-  ltp_ioperm01 \
-  ltp_ioperm02 \
-  ltp_iopl01 \
-  ltp_iopl02 \
-  ltp_ioprio_get01 \
-  ltp_ioprio_set01 \
-  ltp_ioprio_set02 \
-  ltp_ioprio_set03 \
-  ltp_irqbalance01 \
-  ltp_kcmp01 \
-  ltp_kcmp02 \
-  ltp_kcmp03 \
-  ltp_keyctl01 \
-  ltp_keyctl02 \
-  ltp_keyctl03 \
-  ltp_keyctl04 \
-  ltp_keyctl05 \
-  ltp_keyctl06 \
-  ltp_keyctl07 \
-  ltp_keyctl08 \
-  ltp_keyctl09 \
-  ltp_kill02 \
-  ltp_kill03 \
-  ltp_kill06 \
-  ltp_kill08 \
-  ltp_kill09 \
-  ltp_kill10 \
-  ltp_kill11 \
-  ltp_kill12 \
-  ltp_kill13 \
-  ltp_kmsg01 \
-  ltp_ksm01 \
-  ltp_ksm02 \
-  ltp_ksm03 \
-  ltp_ksm04 \
-  ltp_ksm05 \
-  ltp_ksm06 \
-  ltp_ksm07 \
-  ltp_lchown01 \
-  ltp_lchown01_16 \
-  ltp_lchown02 \
-  ltp_lchown02_16 \
-  ltp_lchown03 \
-  ltp_lchown03_16 \
-  ltp_leapsec01 \
-  ltp_lftest \
-  ltp_lgetxattr01 \
-  ltp_lgetxattr02 \
-  ltp_link02 \
-  ltp_link04 \
-  ltp_link05 \
-  ltp_link08 \
-  ltp_linkat01 \
-  ltp_linkat02 \
-  ltp_listen01 \
-  ltp_listxattr01 \
-  ltp_listxattr02 \
-  ltp_listxattr03 \
-  ltp_llistxattr01 \
-  ltp_llistxattr02 \
-  ltp_llistxattr03 \
-  ltp_llseek01 \
-  ltp_llseek02 \
-  ltp_llseek03 \
-  ltp_locktests \
-  ltp_lremovexattr01 \
-  ltp_lseek01 \
-  ltp_lseek02 \
-  ltp_lseek07 \
-  ltp_lseek11 \
-  ltp_lstat01 \
-  ltp_lstat01_64 \
-  ltp_lstat02 \
-  ltp_lstat02_64 \
-  ltp_ltpClient \
-  ltp_ltpServer \
-  ltp_ltp_acpi \
-  ltp_madvise01 \
-  ltp_madvise02 \
-  ltp_madvise05 \
-  ltp_madvise06 \
-  ltp_madvise07 \
-  ltp_madvise08 \
-  ltp_madvise09 \
-  ltp_madvise10 \
-  ltp_madvise11 \
-  ltp_mallinfo01 \
-  ltp_mallinfo02 \
-  ltp_mallinfo2_01 \
-  ltp_max_map_count \
-  ltp_mbind01 \
-  ltp_mbind02 \
-  ltp_mbind03 \
-  ltp_mbind04 \
-  ltp_mc_member_test \
-  ltp_mc_recv \
-  ltp_mc_send \
-  ltp_mc_verify_opts \
-  ltp_mc_verify_opts_error \
-  ltp_meltdown \
-  ltp_mem02 \
-  ltp_mem_process \
-  ltp_membarrier01 \
-  ltp_memcg_process_stress \
-  ltp_memcg_test_1 \
-  ltp_memcg_test_2 \
-  ltp_memcg_test_3 \
-  ltp_memcg_test_4 \
-  ltp_memcmp01 \
-  ltp_memcontrol01 \
-  ltp_memcontrol02 \
-  ltp_memcontrol03 \
-  ltp_memcontrol04 \
-  ltp_memcpy01 \
-  ltp_memctl_test01 \
-  ltp_memfd_create01 \
-  ltp_memfd_create02 \
-  ltp_memfd_create03 \
-  ltp_memfd_create04 \
-  ltp_memset01 \
-  ltp_memtoy \
-  ltp_migrate_pages01 \
-  ltp_migrate_pages02 \
-  ltp_migrate_pages03 \
-  ltp_mincore01 \
-  ltp_mincore02 \
-  ltp_mincore03 \
-  ltp_mincore04 \
-  ltp_mkdir02 \
-  ltp_mkdir03 \
-  ltp_mkdir04 \
-  ltp_mkdir05 \
-  ltp_mkdir09 \
-  ltp_mkdirat01 \
-  ltp_mkdirat02 \
-  ltp_mknod01 \
-  ltp_mknod02 \
-  ltp_mknod03 \
-  ltp_mknod04 \
-  ltp_mknod05 \
-  ltp_mknod06 \
-  ltp_mknod07 \
-  ltp_mknod08 \
-  ltp_mknod09 \
-  ltp_mknodat01 \
-  ltp_mknodat02 \
-  ltp_mlock01 \
-  ltp_mlock02 \
-  ltp_mlock03 \
-  ltp_mlock04 \
-  ltp_mlock201 \
-  ltp_mlock202 \
-  ltp_mlock203 \
-  ltp_mlockall01 \
-  ltp_mlockall02 \
-  ltp_mlockall03 \
-  ltp_mmap-corruption01 \
-  ltp_mmap001 \
-  ltp_mmap01 \
-  ltp_mmap02 \
-  ltp_mmap03 \
-  ltp_mmap04 \
-  ltp_mmap05 \
-  ltp_mmap06 \
-  ltp_mmap08 \
-  ltp_mmap09 \
-  ltp_mmap1 \
-  ltp_mmap10 \
-  ltp_mmap11 \
-  ltp_mmap12 \
-  ltp_mmap13 \
-  ltp_mmap14 \
-  ltp_mmap15 \
-  ltp_mmap16 \
-  ltp_mmap17 \
-  ltp_mmap18 \
-  ltp_mmap19 \
-  ltp_mmap2 \
-  ltp_mmap20 \
-  ltp_mmap3 \
-  ltp_mmapstress01 \
-  ltp_mmapstress02 \
-  ltp_mmapstress03 \
-  ltp_mmapstress04 \
-  ltp_mmapstress05 \
-  ltp_mmapstress06 \
-  ltp_mmapstress07 \
-  ltp_mmapstress08 \
-  ltp_mmapstress09 \
-  ltp_mmapstress10 \
-  ltp_mmstress \
-  ltp_mmstress_dummy \
-  ltp_modify_ldt01 \
-  ltp_modify_ldt02 \
-  ltp_modify_ldt03 \
-  ltp_mount01 \
-  ltp_mount02 \
-  ltp_mount03 \
-  ltp_mount03_suid_child \
-  ltp_mount04 \
-  ltp_mount05 \
-  ltp_mount06 \
-  ltp_mount07 \
-  ltp_mount_setattr01 \
-  ltp_move_mount01 \
-  ltp_move_mount02 \
-  ltp_move_pages01 \
-  ltp_move_pages02 \
-  ltp_move_pages03 \
-  ltp_move_pages04 \
-  ltp_move_pages05 \
-  ltp_move_pages06 \
-  ltp_move_pages07 \
-  ltp_move_pages09 \
-  ltp_move_pages10 \
-  ltp_move_pages11 \
-  ltp_move_pages12 \
-  ltp_mprotect01 \
-  ltp_mprotect02 \
-  ltp_mprotect03 \
-  ltp_mprotect04 \
-  ltp_mprotect05 \
-  ltp_mremap01 \
-  ltp_mremap02 \
-  ltp_mremap03 \
-  ltp_mremap05 \
-  ltp_mremap06 \
-  ltp_msgget05 \
-  ltp_msync01 \
-  ltp_msync02 \
-  ltp_msync03 \
-  ltp_msync04 \
-  ltp_mtest01 \
-  ltp_munlock01 \
-  ltp_munlock02 \
-  ltp_munlockall01 \
-  ltp_munmap01 \
-  ltp_munmap02 \
-  ltp_munmap03 \
-  ltp_name_to_handle_at01 \
-  ltp_name_to_handle_at02 \
-  ltp_nanosleep01 \
-  ltp_nanosleep02 \
-  ltp_nanosleep04 \
-  ltp_netstress \
-  ltp_newuname01 \
-  ltp_nextafter01 \
-  ltp_nfs01_open_files \
-  ltp_nfs04_create_file \
-  ltp_nfs05_make_tree \
-  ltp_nfs_flock \
-  ltp_nfs_flock_dgen \
-  ltp_nft02 \
-  ltp_nftw01 \
-  ltp_nftw6401 \
-  ltp_nice01 \
-  ltp_nice02 \
-  ltp_nice03 \
-  ltp_nice04 \
-  ltp_nptl01 \
-  ltp_ns-icmp_redirector \
-  ltp_ns-icmpv4_sender \
-  ltp_ns-icmpv6_sender \
-  ltp_ns-igmp_querier \
-  ltp_ns-mcast_join \
-  ltp_ns-mcast_receiver \
-  ltp_ns-tcpclient \
-  ltp_ns-tcpserver \
-  ltp_ns-udpclient \
-  ltp_ns-udpsender \
-  ltp_ns-udpserver \
-  ltp_oom01 \
-  ltp_oom02 \
-  ltp_oom03 \
-  ltp_oom04 \
-  ltp_oom05 \
-  ltp_open01 \
-  ltp_open02 \
-  ltp_open03 \
-  ltp_open04 \
-  ltp_open06 \
-  ltp_open07 \
-  ltp_open08 \
-  ltp_open09 \
-  ltp_open10 \
-  ltp_open11 \
-  ltp_open12_child \
-  ltp_open13 \
-  ltp_open14 \
-  ltp_open_by_handle_at01 \
-  ltp_open_by_handle_at02 \
-  ltp_open_tree01 \
-  ltp_open_tree02 \
-  ltp_openat01 \
-  ltp_openat02_child \
-  ltp_openat03 \
-  ltp_openat04 \
-  ltp_openat201 \
-  ltp_openat202 \
-  ltp_openat203 \
-  ltp_openfile \
-  ltp_overcommit_memory \
-  ltp_page01 \
-  ltp_page02 \
-  ltp_pathconf01 \
-  ltp_pathconf02 \
-  ltp_pause01 \
-  ltp_pause02 \
-  ltp_pause03 \
-  ltp_pcrypt_aead01 \
-  ltp_pec_listener \
-  ltp_perf_event_open01 \
-  ltp_perf_event_open02 \
-  ltp_perf_event_open03 \
-  ltp_personality01 \
-  ltp_personality02 \
-  ltp_pidfd_getfd01 \
-  ltp_pidfd_getfd02 \
-  ltp_pidfd_open01 \
-  ltp_pidfd_open02 \
-  ltp_pidfd_open03 \
-  ltp_pidfd_open04 \
-  ltp_pidfd_send_signal01 \
-  ltp_pidfd_send_signal02 \
-  ltp_pidfd_send_signal03 \
-  ltp_pids_task1 \
-  ltp_pids_task2 \
-  ltp_pipe01 \
-  ltp_pipe02 \
-  ltp_pipe03 \
-  ltp_pipe04 \
-  ltp_pipe05 \
-  ltp_pipe06 \
-  ltp_pipe07 \
-  ltp_pipe08 \
-  ltp_pipe09 \
-  ltp_pipe10 \
-  ltp_pipe11 \
-  ltp_pipe12 \
-  ltp_pipe13 \
-  ltp_pipe14 \
-  ltp_pipe15 \
-  ltp_pipe2_01 \
-  ltp_pipe2_02 \
-  ltp_pipe2_02_child \
-  ltp_pipe2_04 \
-  ltp_pivot_root01 \
-  ltp_pkey01 \
-  ltp_pm_get_sched_values \
-  ltp_poll01 \
-  ltp_poll02 \
-  ltp_posix_fadvise01 \
-  ltp_posix_fadvise01_64 \
-  ltp_posix_fadvise02 \
-  ltp_posix_fadvise02_64 \
-  ltp_posix_fadvise03 \
-  ltp_posix_fadvise03_64 \
-  ltp_posix_fadvise04 \
-  ltp_posix_fadvise04_64 \
-  ltp_ppoll01 \
-  ltp_prctl01 \
-  ltp_prctl02 \
-  ltp_prctl03 \
-  ltp_prctl04 \
-  ltp_prctl05 \
-  ltp_prctl06 \
-  ltp_prctl06_execve \
-  ltp_prctl07 \
-  ltp_prctl08 \
-  ltp_prctl09 \
-  ltp_prctl10 \
-  ltp_pread01 \
-  ltp_pread01_64 \
-  ltp_pread02 \
-  ltp_pread02_64 \
-  ltp_preadv01 \
-  ltp_preadv01_64 \
-  ltp_preadv02 \
-  ltp_preadv02_64 \
-  ltp_preadv03 \
-  ltp_preadv03_64 \
-  ltp_preadv201 \
-  ltp_preadv201_64 \
-  ltp_preadv202 \
-  ltp_preadv202_64 \
-  ltp_preadv203 \
-  ltp_preadv203_64 \
-  ltp_print_caps \
-  ltp_proc01 \
-  ltp_proc_sched_rt01 \
-  ltp_process_madvise01 \
-  ltp_process_vm01 \
-  ltp_process_vm_readv02 \
-  ltp_process_vm_readv03 \
-  ltp_process_vm_writev02 \
-  ltp_pselect01 \
-  ltp_pselect01_64 \
-  ltp_pselect02 \
-  ltp_pselect02_64 \
-  ltp_pselect03 \
-  ltp_pselect03_64 \
-  ltp_pt_test \
-  ltp_ptem01 \
-  ltp_pth_str01 \
-  ltp_pth_str02 \
-  ltp_pth_str03 \
-  ltp_pthcli \
-  ltp_pthserv \
-  ltp_ptrace01 \
-  ltp_ptrace02 \
-  ltp_ptrace03 \
-  ltp_ptrace04 \
-  ltp_ptrace05 \
-  ltp_ptrace06 \
-  ltp_ptrace07 \
-  ltp_ptrace08 \
-  ltp_ptrace09 \
-  ltp_ptrace10 \
-  ltp_ptrace11 \
-  ltp_pty01 \
-  ltp_pty02 \
-  ltp_pty03 \
-  ltp_pty04 \
-  ltp_pty06 \
-  ltp_pty07 \
-  ltp_pwrite01 \
-  ltp_pwrite01_64 \
-  ltp_pwrite02 \
-  ltp_pwrite02_64 \
-  ltp_pwrite03 \
-  ltp_pwrite03_64 \
-  ltp_pwrite04 \
-  ltp_pwrite04_64 \
-  ltp_pwritev01 \
-  ltp_pwritev01_64 \
-  ltp_pwritev02 \
-  ltp_pwritev02_64 \
-  ltp_pwritev03 \
-  ltp_pwritev03_64 \
-  ltp_pwritev201 \
-  ltp_pwritev201_64 \
-  ltp_pwritev202 \
-  ltp_pwritev202_64 \
-  ltp_quotactl01 \
-  ltp_quotactl02 \
-  ltp_quotactl03 \
-  ltp_quotactl04 \
-  ltp_quotactl05 \
-  ltp_quotactl06 \
-  ltp_quotactl07 \
-  ltp_quotactl08 \
-  ltp_quotactl09 \
-  ltp_read01 \
-  ltp_read02 \
-  ltp_read03 \
-  ltp_read04 \
-  ltp_read_all \
-  ltp_readahead01 \
-  ltp_readahead02 \
-  ltp_readdir01 \
-  ltp_readdir21 \
-  ltp_readlink01 \
-  ltp_readlink03 \
-  ltp_readlinkat01 \
-  ltp_readlinkat02 \
-  ltp_readv01 \
-  ltp_readv02 \
-  ltp_realpath01 \
-  ltp_reboot01 \
-  ltp_reboot02 \
-  ltp_recv01 \
-  ltp_recvfrom01 \
-  ltp_recvmmsg01 \
-  ltp_recvmsg01 \
-  ltp_recvmsg02 \
-  ltp_recvmsg03 \
-  ltp_remap_file_pages02 \
-  ltp_removexattr01 \
-  ltp_removexattr02 \
-  ltp_rename01 \
-  ltp_rename03 \
-  ltp_rename04 \
-  ltp_rename05 \
-  ltp_rename06 \
-  ltp_rename07 \
-  ltp_rename08 \
-  ltp_rename09 \
-  ltp_rename10 \
-  ltp_rename11 \
-  ltp_rename12 \
-  ltp_rename13 \
-  ltp_rename14 \
-  ltp_renameat01 \
-  ltp_renameat201 \
-  ltp_renameat202 \
-  ltp_request_key01 \
-  ltp_request_key02 \
-  ltp_request_key03 \
-  ltp_request_key04 \
-  ltp_request_key05 \
-  ltp_rmdir01 \
-  ltp_rmdir02 \
-  ltp_rmdir03 \
-  ltp_route-change-netlink \
-  ltp_rt_sigaction01 \
-  ltp_rt_sigaction02 \
-  ltp_rt_sigaction03 \
-  ltp_rt_sigpending02 \
-  ltp_rt_sigprocmask01 \
-  ltp_rt_sigprocmask02 \
-  ltp_rt_sigqueueinfo01 \
-  ltp_rt_sigsuspend01 \
-  ltp_rt_sigtimedwait01 \
-  ltp_rt_tgsigqueueinfo01 \
-  ltp_rtc01 \
-  ltp_rtc02 \
-  ltp_sbrk01 \
-  ltp_sbrk02 \
-  ltp_sbrk03 \
-  ltp_sched_boost \
-  ltp_sched_cfs_prio \
-  ltp_sched_dl_runtime \
-  ltp_sched_driver \
-  ltp_sched_get_priority_max01 \
-  ltp_sched_get_priority_max02 \
-  ltp_sched_get_priority_min01 \
-  ltp_sched_get_priority_min02 \
-  ltp_sched_getaffinity01 \
-  ltp_sched_getattr01 \
-  ltp_sched_getattr02 \
-  ltp_sched_getparam01 \
-  ltp_sched_getparam03 \
-  ltp_sched_getscheduler01 \
-  ltp_sched_getscheduler02 \
-  ltp_sched_latency_dl \
-  ltp_sched_latency_rt \
-  ltp_sched_prio_3_fifo \
-  ltp_sched_prio_3_rr \
-  ltp_sched_rr_get_interval01 \
-  ltp_sched_rr_get_interval02 \
-  ltp_sched_rr_get_interval03 \
-  ltp_sched_setaffinity01 \
-  ltp_sched_setattr01 \
-  ltp_sched_setparam01 \
-  ltp_sched_setparam02 \
-  ltp_sched_setparam03 \
-  ltp_sched_setparam04 \
-  ltp_sched_setparam05 \
-  ltp_sched_setscheduler01 \
-  ltp_sched_setscheduler02 \
-  ltp_sched_setscheduler03 \
-  ltp_sched_setscheduler04 \
-  ltp_sched_tc0 \
-  ltp_sched_tc1 \
-  ltp_sched_tc2 \
-  ltp_sched_tc3 \
-  ltp_sched_tc4 \
-  ltp_sched_tc5 \
-  ltp_sched_tc6 \
-  ltp_sched_yield01 \
-  ltp_sctp_big_chunk \
-  ltp_select01 \
-  ltp_select02 \
-  ltp_select03 \
-  ltp_select04 \
-  ltp_semctl08 \
-  ltp_semctl09 \
-  ltp_send01 \
-  ltp_send02 \
-  ltp_sendfile02 \
-  ltp_sendfile02_64 \
-  ltp_sendfile03 \
-  ltp_sendfile03_64 \
-  ltp_sendfile04 \
-  ltp_sendfile04_64 \
-  ltp_sendfile05 \
-  ltp_sendfile05_64 \
-  ltp_sendfile06 \
-  ltp_sendfile06_64 \
-  ltp_sendfile07 \
-  ltp_sendfile07_64 \
-  ltp_sendfile08 \
-  ltp_sendfile08_64 \
-  ltp_sendfile09 \
-  ltp_sendfile09_64 \
-  ltp_sendmmsg01 \
-  ltp_sendmmsg02 \
-  ltp_sendmsg01 \
-  ltp_sendmsg03 \
-  ltp_sendto01 \
-  ltp_sendto02 \
-  ltp_sendto03 \
-  ltp_set_robust_list01 \
-  ltp_set_thread_area01 \
-  ltp_set_tid_address01 \
-  ltp_setdomainname01 \
-  ltp_setdomainname02 \
-  ltp_setdomainname03 \
-  ltp_setegid01 \
-  ltp_setegid02 \
-  ltp_setfsgid01 \
-  ltp_setfsgid01_16 \
-  ltp_setfsgid02 \
-  ltp_setfsgid02_16 \
-  ltp_setfsgid03 \
-  ltp_setfsgid03_16 \
-  ltp_setfsuid01 \
-  ltp_setfsuid01_16 \
-  ltp_setfsuid02 \
-  ltp_setfsuid02_16 \
-  ltp_setfsuid03 \
-  ltp_setfsuid03_16 \
-  ltp_setfsuid04 \
-  ltp_setfsuid04_16 \
-  ltp_setgid01 \
-  ltp_setgid01_16 \
-  ltp_setgid02 \
-  ltp_setgid02_16 \
-  ltp_setgid03 \
-  ltp_setgid03_16 \
-  ltp_setgroups01 \
-  ltp_setgroups01_16 \
-  ltp_setgroups02 \
-  ltp_setgroups02_16 \
-  ltp_setgroups03 \
-  ltp_setgroups03_16 \
-  ltp_setgroups04 \
-  ltp_setgroups04_16 \
-  ltp_sethostname01 \
-  ltp_sethostname02 \
-  ltp_sethostname03 \
-  ltp_setitimer01 \
-  ltp_setitimer02 \
-  ltp_setns01 \
-  ltp_setpgid01 \
-  ltp_setpgid02 \
-  ltp_setpgid03 \
-  ltp_setpgid03_child \
-  ltp_setpgrp01 \
-  ltp_setpgrp02 \
-  ltp_setpriority01 \
-  ltp_setpriority02 \
-  ltp_setregid01 \
-  ltp_setregid01_16 \
-  ltp_setregid02 \
-  ltp_setregid02_16 \
-  ltp_setregid03 \
-  ltp_setregid03_16 \
-  ltp_setregid04 \
-  ltp_setregid04_16 \
-  ltp_setresgid01 \
-  ltp_setresgid01_16 \
-  ltp_setresgid02 \
-  ltp_setresgid02_16 \
-  ltp_setresgid03 \
-  ltp_setresgid03_16 \
-  ltp_setresgid04 \
-  ltp_setresgid04_16 \
-  ltp_setresuid01 \
-  ltp_setresuid01_16 \
-  ltp_setresuid02 \
-  ltp_setresuid02_16 \
-  ltp_setresuid03 \
-  ltp_setresuid03_16 \
-  ltp_setresuid04 \
-  ltp_setresuid04_16 \
-  ltp_setresuid05 \
-  ltp_setresuid05_16 \
-  ltp_setreuid01 \
-  ltp_setreuid01_16 \
-  ltp_setreuid02 \
-  ltp_setreuid02_16 \
-  ltp_setreuid03 \
-  ltp_setreuid03_16 \
-  ltp_setreuid04 \
-  ltp_setreuid04_16 \
-  ltp_setreuid05 \
-  ltp_setreuid05_16 \
-  ltp_setreuid06 \
-  ltp_setreuid06_16 \
-  ltp_setreuid07 \
-  ltp_setreuid07_16 \
-  ltp_setrlimit01 \
-  ltp_setrlimit02 \
-  ltp_setrlimit03 \
-  ltp_setrlimit04 \
-  ltp_setrlimit05 \
-  ltp_setrlimit06 \
-  ltp_setsid01 \
-  ltp_setsockopt01 \
-  ltp_setsockopt02 \
-  ltp_setsockopt03 \
-  ltp_setsockopt04 \
-  ltp_setsockopt05 \
-  ltp_setsockopt06 \
-  ltp_setsockopt07 \
-  ltp_setsockopt08 \
-  ltp_setsockopt09 \
-  ltp_setsockopt10 \
-  ltp_settimeofday01 \
-  ltp_settimeofday02 \
-  ltp_setuid01 \
-  ltp_setuid01_16 \
-  ltp_setuid03 \
-  ltp_setuid03_16 \
-  ltp_setuid04 \
-  ltp_setuid04_16 \
-  ltp_setxattr01 \
-  ltp_setxattr02 \
-  ltp_setxattr03 \
-  ltp_sgetmask01 \
-  ltp_sigaction01 \
-  ltp_sigaction02 \
-  ltp_sigaltstack01 \
-  ltp_sigaltstack02 \
-  ltp_sighold02 \
-  ltp_signal01 \
-  ltp_signal02 \
-  ltp_signal03 \
-  ltp_signal04 \
-  ltp_signal05 \
-  ltp_signal06 \
-  ltp_signalfd01 \
-  ltp_signalfd4_01 \
-  ltp_signalfd4_02 \
-  ltp_sigpending02 \
-  ltp_sigprocmask01 \
-  ltp_sigrelse01 \
-  ltp_sigsuspend01 \
-  ltp_sigtimedwait01 \
-  ltp_sigwait01 \
-  ltp_sigwaitinfo01 \
-  ltp_smack_notroot \
-  ltp_smack_set_socket_labels \
-  ltp_snd_seq01 \
-  ltp_snd_timer01 \
-  ltp_socket01 \
-  ltp_socket02 \
-  ltp_socketcall01 \
-  ltp_socketcall02 \
-  ltp_socketcall03 \
-  ltp_socketpair01 \
-  ltp_socketpair02 \
-  ltp_sockioctl01 \
-  ltp_splice01 \
-  ltp_splice02 \
-  ltp_splice03 \
-  ltp_splice04 \
-  ltp_splice05 \
-  ltp_splice06 \
-  ltp_splice07 \
-  ltp_ssetmask01 \
-  ltp_stack_clash \
-  ltp_stack_space \
-  ltp_starvation \
-  ltp_stat01 \
-  ltp_stat01_64 \
-  ltp_stat02 \
-  ltp_stat02_64 \
-  ltp_stat03 \
-  ltp_stat03_64 \
-  ltp_statfs01 \
-  ltp_statfs01_64 \
-  ltp_statfs02 \
-  ltp_statfs02_64 \
-  ltp_statfs03 \
-  ltp_statfs03_64 \
-  ltp_statvfs01 \
-  ltp_statvfs02 \
-  ltp_statx01 \
-  ltp_statx02 \
-  ltp_statx03 \
-  ltp_statx04 \
-  ltp_statx06 \
-  ltp_statx08 \
-  ltp_statx09 \
-  ltp_statx10 \
-  ltp_statx11 \
-  ltp_statx12 \
-  ltp_stream01 \
-  ltp_stream02 \
-  ltp_stream03 \
-  ltp_stream04 \
-  ltp_stream05 \
-  ltp_string01 \
-  ltp_sugov_latency \
-  ltp_sugov_stale_util \
-  ltp_sugov_wakeups \
-  ltp_support_numa \
-  ltp_swapoff01 \
-  ltp_swapoff02 \
-  ltp_swapon01 \
-  ltp_swapon02 \
-  ltp_swapon03 \
-  ltp_swapping01 \
-  ltp_symlink01 \
-  ltp_symlink02 \
-  ltp_symlink03 \
-  ltp_symlink04 \
-  ltp_symlinkat01 \
-  ltp_sync01 \
-  ltp_sync_file_range01 \
-  ltp_sync_file_range02 \
-  ltp_syncfs01 \
-  ltp_syscall01 \
-  ltp_sysconf01 \
-  ltp_sysctl01 \
-  ltp_sysctl03 \
-  ltp_sysctl04 \
-  ltp_sysfs01 \
-  ltp_sysfs02 \
-  ltp_sysfs03 \
-  ltp_sysfs04 \
-  ltp_sysfs05 \
-  ltp_sysinfo01 \
-  ltp_sysinfo02 \
-  ltp_sysinfo03 \
-  ltp_syslog11 \
-  ltp_syslog12 \
-  ltp_tbio \
-  ltp_tcindex01 \
-  ltp_tee01 \
-  ltp_tee02 \
-  ltp_test01 \
-  ltp_test02 \
-  ltp_test03 \
-  ltp_test04 \
-  ltp_test05 \
-  ltp_test06 \
-  ltp_test07 \
-  ltp_test08 \
-  ltp_test09 \
-  ltp_test11 \
-  ltp_test13 \
-  ltp_test14 \
-  ltp_test15 \
-  ltp_test19 \
-  ltp_test20 \
-  ltp_test22 \
-  ltp_test_assert \
-  ltp_test_children_cleanup \
-  ltp_test_exec \
-  ltp_test_exec_child \
-  ltp_test_guarded_buf \
-  ltp_test_kconfig \
-  ltp_test_kconfig01 \
-  ltp_test_kconfig02 \
-  ltp_test_macros01 \
-  ltp_test_macros02 \
-  ltp_test_macros03 \
-  ltp_test_macros04 \
-  ltp_test_macros05 \
-  ltp_test_macros06 \
-  ltp_test_parse_filesize \
-  ltp_test_runtime01 \
-  ltp_test_runtime02 \
-  ltp_test_timer \
-  ltp_test_zero_hugepage \
-  ltp_testcases_bin_add_ipv6addr \
-  ltp_testcases_bin_ar01.sh \
-  ltp_testcases_bin_arping01.sh \
-  ltp_testcases_bin_ask_password.sh \
-  ltp_testcases_bin_assign_password.sh \
-  ltp_testcases_bin_bbr01.sh \
-  ltp_testcases_bin_bbr02.sh \
-  ltp_testcases_bin_bind_noport01.sh \
-  ltp_testcases_bin_binfmt_misc01.sh \
-  ltp_testcases_bin_binfmt_misc02.sh \
-  ltp_testcases_bin_binfmt_misc_lib.sh \
-  ltp_testcases_bin_broken_ip-checksum.sh \
-  ltp_testcases_bin_broken_ip-dstaddr.sh \
-  ltp_testcases_bin_broken_ip-fragment.sh \
-  ltp_testcases_bin_broken_ip-ihl.sh \
-  ltp_testcases_bin_broken_ip-nexthdr.sh \
-  ltp_testcases_bin_broken_ip-plen.sh \
-  ltp_testcases_bin_broken_ip-protcol.sh \
-  ltp_testcases_bin_broken_ip-version.sh \
-  ltp_testcases_bin_busy_poll01.sh \
-  ltp_testcases_bin_busy_poll02.sh \
-  ltp_testcases_bin_busy_poll03.sh \
-  ltp_testcases_bin_busy_poll_lib.sh \
-  ltp_testcases_bin_cgroup_fj_common.sh \
-  ltp_testcases_bin_cgroup_fj_function.sh \
-  ltp_testcases_bin_cgroup_fj_stress.sh \
-  ltp_testcases_bin_cgroup_lib.sh \
-  ltp_testcases_bin_cgroup_regression_3_1.sh \
-  ltp_testcases_bin_cgroup_regression_3_2.sh \
-  ltp_testcases_bin_cgroup_regression_5_1.sh \
-  ltp_testcases_bin_cgroup_regression_5_2.sh \
-  ltp_testcases_bin_cgroup_regression_6_1.sh \
-  ltp_testcases_bin_cgroup_regression_6_2.sh \
-  ltp_testcases_bin_cgroup_regression_test.sh \
-  ltp_testcases_bin_change_password.sh \
-  ltp_testcases_bin_check_envval \
-  ltp_testcases_bin_check_icmpv4_connectivity \
-  ltp_testcases_bin_check_icmpv6_connectivity \
-  ltp_testcases_bin_check_netem \
-  ltp_testcases_bin_check_setkey \
-  ltp_testcases_bin_cleanup_lvm.sh \
-  ltp_testcases_bin_clockdiff01.sh \
-  ltp_testcases_bin_cmdlib.sh \
-  ltp_testcases_bin_cp_tests.sh \
-  ltp_testcases_bin_cpio_tests.sh \
-  ltp_testcases_bin_cpuacct.sh \
-  ltp_testcases_bin_cpuhotplug01.sh \
-  ltp_testcases_bin_cpuhotplug02.sh \
-  ltp_testcases_bin_cpuhotplug03.sh \
-  ltp_testcases_bin_cpuhotplug04.sh \
-  ltp_testcases_bin_cpuhotplug05.sh \
-  ltp_testcases_bin_cpuhotplug06.sh \
-  ltp_testcases_bin_cpuhotplug07.sh \
-  ltp_testcases_bin_cpuhotplug_do_disk_write_loop \
-  ltp_testcases_bin_cpuhotplug_do_kcompile_loop \
-  ltp_testcases_bin_cpuhotplug_do_spin_loop \
-  ltp_testcases_bin_cpuhotplug_hotplug.sh \
-  ltp_testcases_bin_cpuhotplug_report_proc_interrupts \
-  ltp_testcases_bin_cpuhotplug_testsuite.sh \
-  ltp_testcases_bin_cpuset_base_ops_testset.sh \
-  ltp_testcases_bin_cpuset_exclusive_test.sh \
-  ltp_testcases_bin_cpuset_funcs.sh \
-  ltp_testcases_bin_cpuset_hierarchy_test.sh \
-  ltp_testcases_bin_cpuset_hotplug_test.sh \
-  ltp_testcases_bin_cpuset_inherit_testset.sh \
-  ltp_testcases_bin_cpuset_load_balance_test.sh \
-  ltp_testcases_bin_cpuset_memory_pressure_testset.sh \
-  ltp_testcases_bin_cpuset_memory_spread_testset.sh \
-  ltp_testcases_bin_cpuset_memory_testset.sh \
-  ltp_testcases_bin_cpuset_regression_test.sh \
-  ltp_testcases_bin_cpuset_sched_domains_test.sh \
-  ltp_testcases_bin_cpuset_syscall_testset.sh \
-  ltp_testcases_bin_create_file \
-  ltp_testcases_bin_daemonlib.sh \
-  ltp_testcases_bin_data \
-  ltp_testcases_bin_dccp01.sh \
-  ltp_testcases_bin_dccp_ipsec.sh \
-  ltp_testcases_bin_dccp_ipsec_vti.sh \
-  ltp_testcases_bin_dctcp01.sh \
-  ltp_testcases_bin_dhcp_lib.sh \
-  ltp_testcases_bin_dhcpd_tests.sh \
-  ltp_testcases_bin_dns-stress-lib.sh \
-  ltp_testcases_bin_dns-stress.sh \
-  ltp_testcases_bin_dns-stress01-rmt.sh \
-  ltp_testcases_bin_dns-stress02-rmt.sh \
-  ltp_testcases_bin_dnsmasq_tests.sh \
-  ltp_testcases_bin_dynamic_debug01.sh \
-  ltp_testcases_bin_evm_overlay.sh \
-  ltp_testcases_bin_file01.sh \
-  ltp_testcases_bin_filecapstest.sh \
-  ltp_testcases_bin_find_portbundle \
-  ltp_testcases_bin_force_erase.sh \
-  ltp_testcases_bin_fork_freeze.sh \
-  ltp_testcases_bin_fou01.sh \
-  ltp_testcases_bin_freeze_cancel.sh \
-  ltp_testcases_bin_freeze_kill_thaw.sh \
-  ltp_testcases_bin_freeze_move_thaw.sh \
-  ltp_testcases_bin_freeze_self_thaw.sh \
-  ltp_testcases_bin_freeze_sleep_thaw.sh \
-  ltp_testcases_bin_freeze_thaw.sh \
-  ltp_testcases_bin_freeze_write_freezing.sh \
-  ltp_testcases_bin_fs_bind01.sh \
-  ltp_testcases_bin_fs_bind02.sh \
-  ltp_testcases_bin_fs_bind03.sh \
-  ltp_testcases_bin_fs_bind04.sh \
-  ltp_testcases_bin_fs_bind05.sh \
-  ltp_testcases_bin_fs_bind06.sh \
-  ltp_testcases_bin_fs_bind07-2.sh \
-  ltp_testcases_bin_fs_bind07.sh \
-  ltp_testcases_bin_fs_bind08.sh \
-  ltp_testcases_bin_fs_bind09.sh \
-  ltp_testcases_bin_fs_bind10.sh \
-  ltp_testcases_bin_fs_bind11.sh \
-  ltp_testcases_bin_fs_bind12.sh \
-  ltp_testcases_bin_fs_bind13.sh \
-  ltp_testcases_bin_fs_bind14.sh \
-  ltp_testcases_bin_fs_bind15.sh \
-  ltp_testcases_bin_fs_bind16.sh \
-  ltp_testcases_bin_fs_bind17.sh \
-  ltp_testcases_bin_fs_bind18.sh \
-  ltp_testcases_bin_fs_bind19.sh \
-  ltp_testcases_bin_fs_bind20.sh \
-  ltp_testcases_bin_fs_bind21.sh \
-  ltp_testcases_bin_fs_bind22.sh \
-  ltp_testcases_bin_fs_bind23.sh \
-  ltp_testcases_bin_fs_bind24.sh \
-  ltp_testcases_bin_fs_bind_cloneNS01.sh \
-  ltp_testcases_bin_fs_bind_cloneNS02.sh \
-  ltp_testcases_bin_fs_bind_cloneNS03.sh \
-  ltp_testcases_bin_fs_bind_cloneNS04.sh \
-  ltp_testcases_bin_fs_bind_cloneNS05.sh \
-  ltp_testcases_bin_fs_bind_cloneNS06.sh \
-  ltp_testcases_bin_fs_bind_cloneNS07.sh \
-  ltp_testcases_bin_fs_bind_lib.sh \
-  ltp_testcases_bin_fs_bind_move01.sh \
-  ltp_testcases_bin_fs_bind_move02.sh \
-  ltp_testcases_bin_fs_bind_move03.sh \
-  ltp_testcases_bin_fs_bind_move04.sh \
-  ltp_testcases_bin_fs_bind_move05.sh \
-  ltp_testcases_bin_fs_bind_move06.sh \
-  ltp_testcases_bin_fs_bind_move07.sh \
-  ltp_testcases_bin_fs_bind_move08.sh \
-  ltp_testcases_bin_fs_bind_move09.sh \
-  ltp_testcases_bin_fs_bind_move10.sh \
-  ltp_testcases_bin_fs_bind_move11.sh \
-  ltp_testcases_bin_fs_bind_move12.sh \
-  ltp_testcases_bin_fs_bind_move13.sh \
-  ltp_testcases_bin_fs_bind_move14.sh \
-  ltp_testcases_bin_fs_bind_move15.sh \
-  ltp_testcases_bin_fs_bind_move16.sh \
-  ltp_testcases_bin_fs_bind_move17.sh \
-  ltp_testcases_bin_fs_bind_move18.sh \
-  ltp_testcases_bin_fs_bind_move19.sh \
-  ltp_testcases_bin_fs_bind_move20.sh \
-  ltp_testcases_bin_fs_bind_move21.sh \
-  ltp_testcases_bin_fs_bind_move22.sh \
-  ltp_testcases_bin_fs_bind_rbind01.sh \
-  ltp_testcases_bin_fs_bind_rbind02.sh \
-  ltp_testcases_bin_fs_bind_rbind03.sh \
-  ltp_testcases_bin_fs_bind_rbind04.sh \
-  ltp_testcases_bin_fs_bind_rbind05.sh \
-  ltp_testcases_bin_fs_bind_rbind06.sh \
-  ltp_testcases_bin_fs_bind_rbind07-2.sh \
-  ltp_testcases_bin_fs_bind_rbind07.sh \
-  ltp_testcases_bin_fs_bind_rbind08.sh \
-  ltp_testcases_bin_fs_bind_rbind09.sh \
-  ltp_testcases_bin_fs_bind_rbind10.sh \
-  ltp_testcases_bin_fs_bind_rbind11.sh \
-  ltp_testcases_bin_fs_bind_rbind12.sh \
-  ltp_testcases_bin_fs_bind_rbind13.sh \
-  ltp_testcases_bin_fs_bind_rbind14.sh \
-  ltp_testcases_bin_fs_bind_rbind15.sh \
-  ltp_testcases_bin_fs_bind_rbind16.sh \
-  ltp_testcases_bin_fs_bind_rbind17.sh \
-  ltp_testcases_bin_fs_bind_rbind18.sh \
-  ltp_testcases_bin_fs_bind_rbind19.sh \
-  ltp_testcases_bin_fs_bind_rbind20.sh \
-  ltp_testcases_bin_fs_bind_rbind21.sh \
-  ltp_testcases_bin_fs_bind_rbind22.sh \
-  ltp_testcases_bin_fs_bind_rbind23.sh \
-  ltp_testcases_bin_fs_bind_rbind24.sh \
-  ltp_testcases_bin_fs_bind_rbind25.sh \
-  ltp_testcases_bin_fs_bind_rbind26.sh \
-  ltp_testcases_bin_fs_bind_rbind27.sh \
-  ltp_testcases_bin_fs_bind_rbind28.sh \
-  ltp_testcases_bin_fs_bind_rbind29.sh \
-  ltp_testcases_bin_fs_bind_rbind30.sh \
-  ltp_testcases_bin_fs_bind_rbind31.sh \
-  ltp_testcases_bin_fs_bind_rbind32.sh \
-  ltp_testcases_bin_fs_bind_rbind33.sh \
-  ltp_testcases_bin_fs_bind_rbind34.sh \
-  ltp_testcases_bin_fs_bind_rbind35.sh \
-  ltp_testcases_bin_fs_bind_rbind36.sh \
-  ltp_testcases_bin_fs_bind_rbind37.sh \
-  ltp_testcases_bin_fs_bind_rbind38.sh \
-  ltp_testcases_bin_fs_bind_rbind39.sh \
-  ltp_testcases_bin_fs_bind_regression.sh \
-  ltp_testcases_bin_fs_di \
-  ltp_testcases_bin_fs_inod \
-  ltp_testcases_bin_fs_racer.sh \
-  ltp_testcases_bin_fs_racer_dir_create.sh \
-  ltp_testcases_bin_fs_racer_dir_test.sh \
-  ltp_testcases_bin_fs_racer_file_concat.sh \
-  ltp_testcases_bin_fs_racer_file_create.sh \
-  ltp_testcases_bin_fs_racer_file_link.sh \
-  ltp_testcases_bin_fs_racer_file_list.sh \
-  ltp_testcases_bin_fs_racer_file_rename.sh \
-  ltp_testcases_bin_fs_racer_file_rm.sh \
-  ltp_testcases_bin_fs_racer_file_symlink.sh \
-  ltp_testcases_bin_fsx.sh \
-  ltp_testcases_bin_ftp-download-stress.sh \
-  ltp_testcases_bin_ftp-download-stress01-rmt.sh \
-  ltp_testcases_bin_ftp-download-stress02-rmt.sh \
-  ltp_testcases_bin_ftp-upload-stress.sh \
-  ltp_testcases_bin_ftp-upload-stress01-rmt.sh \
-  ltp_testcases_bin_ftp-upload-stress02-rmt.sh \
-  ltp_testcases_bin_ftp01.sh \
-  ltp_testcases_bin_ftrace_lib.sh \
-  ltp_testcases_bin_ftrace_regression01.sh \
-  ltp_testcases_bin_ftrace_regression02.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_buffer_size_kb.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_current_tracer.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_ftrace_enabled.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_function_profile_enabled.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_set_event.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_set_ftrace_filter.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_set_ftrace_pid.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_stack_max_size.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_stack_trace.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_trace.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_trace_clock.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_trace_options.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_trace_pipe.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_trace_stat.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_tracing_cpumask.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_tracing_enabled.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_tracing_max_latency.sh \
-  ltp_testcases_bin_ftrace_stress_ftrace_tracing_on.sh \
-  ltp_testcases_bin_ftrace_stress_test.sh \
-  ltp_testcases_bin_gdb01.sh \
-  ltp_testcases_bin_generate_lvm_runfile.sh \
-  ltp_testcases_bin_geneve01.sh \
-  ltp_testcases_bin_geneve02.sh \
-  ltp_testcases_bin_get_ifname \
-  ltp_testcases_bin_gre01.sh \
-  ltp_testcases_bin_gre02.sh \
-  ltp_testcases_bin_host01.sh \
-  ltp_testcases_bin_http-stress.sh \
-  ltp_testcases_bin_http-stress01-rmt.sh \
-  ltp_testcases_bin_http-stress02-rmt.sh \
-  ltp_testcases_bin_icmp-uni-basic.sh \
-  ltp_testcases_bin_icmp-uni-vti.sh \
-  ltp_testcases_bin_icmp4-multi-diffip01 \
-  ltp_testcases_bin_icmp4-multi-diffip02 \
-  ltp_testcases_bin_icmp4-multi-diffip03 \
-  ltp_testcases_bin_icmp4-multi-diffip04 \
-  ltp_testcases_bin_icmp4-multi-diffip05 \
-  ltp_testcases_bin_icmp4-multi-diffip06 \
-  ltp_testcases_bin_icmp4-multi-diffip07 \
-  ltp_testcases_bin_icmp4-multi-diffnic01 \
-  ltp_testcases_bin_icmp4-multi-diffnic02 \
-  ltp_testcases_bin_icmp4-multi-diffnic03 \
-  ltp_testcases_bin_icmp4-multi-diffnic04 \
-  ltp_testcases_bin_icmp4-multi-diffnic05 \
-  ltp_testcases_bin_icmp4-multi-diffnic06 \
-  ltp_testcases_bin_icmp4-multi-diffnic07 \
-  ltp_testcases_bin_icmp6-multi-diffip01 \
-  ltp_testcases_bin_icmp6-multi-diffip02 \
-  ltp_testcases_bin_icmp6-multi-diffip03 \
-  ltp_testcases_bin_icmp6-multi-diffip04 \
-  ltp_testcases_bin_icmp6-multi-diffip05 \
-  ltp_testcases_bin_icmp6-multi-diffip06 \
-  ltp_testcases_bin_icmp6-multi-diffip07 \
-  ltp_testcases_bin_icmp6-multi-diffnic01 \
-  ltp_testcases_bin_icmp6-multi-diffnic02 \
-  ltp_testcases_bin_icmp6-multi-diffnic03 \
-  ltp_testcases_bin_icmp6-multi-diffnic04 \
-  ltp_testcases_bin_icmp6-multi-diffnic05 \
-  ltp_testcases_bin_icmp6-multi-diffnic06 \
-  ltp_testcases_bin_icmp6-multi-diffnic07 \
-  ltp_testcases_bin_if-addr-adddel.sh \
-  ltp_testcases_bin_if-addr-addlarge.sh \
-  ltp_testcases_bin_if-lib.sh \
-  ltp_testcases_bin_if-mtu-change.sh \
-  ltp_testcases_bin_if-route-adddel.sh \
-  ltp_testcases_bin_if-route-addlarge.sh \
-  ltp_testcases_bin_if-updown.sh \
-  ltp_testcases_bin_if4-addr-change.sh \
-  ltp_testcases_bin_ima_conditionals.sh \
-  ltp_testcases_bin_ima_kexec.sh \
-  ltp_testcases_bin_ima_keys.sh \
-  ltp_testcases_bin_ima_measurements.sh \
-  ltp_testcases_bin_ima_policy.sh \
-  ltp_testcases_bin_ima_selinux.sh \
-  ltp_testcases_bin_ima_setup.sh \
-  ltp_testcases_bin_ima_tpm.sh \
-  ltp_testcases_bin_ima_violations.sh \
-  ltp_testcases_bin_initialize_if \
-  ltp_testcases_bin_ip_tests.sh \
-  ltp_testcases_bin_ipneigh01.sh \
-  ltp_testcases_bin_ipsec_lib.sh \
-  ltp_testcases_bin_iptables01.sh \
-  ltp_testcases_bin_iptables_lib.sh \
-  ltp_testcases_bin_ipvlan01.sh \
-  ltp_testcases_bin_isofs.sh \
-  ltp_testcases_bin_killall_icmp_traffic \
-  ltp_testcases_bin_killall_tcp_traffic \
-  ltp_testcases_bin_killall_udp_traffic \
-  ltp_testcases_bin_ld01.sh \
-  ltp_testcases_bin_ldd01.sh \
-  ltp_testcases_bin_libcgroup_freezer \
-  ltp_testcases_bin_linktest.sh \
-  ltp_testcases_bin_ln_tests.sh \
-  ltp_testcases_bin_lock_torture.sh \
-  ltp_testcases_bin_ltpSockets.sh \
-  ltp_testcases_bin_macsec01.sh \
-  ltp_testcases_bin_macsec02.sh \
-  ltp_testcases_bin_macsec03.sh \
-  ltp_testcases_bin_macsec_lib.sh \
-  ltp_testcases_bin_macvlan01.sh \
-  ltp_testcases_bin_macvtap01.sh \
-  ltp_testcases_bin_mc_cmds.sh \
-  ltp_testcases_bin_mc_commo.sh \
-  ltp_testcases_bin_mc_member.sh \
-  ltp_testcases_bin_mc_opts.sh \
-  ltp_testcases_bin_mcast-group-multiple-socket.sh \
-  ltp_testcases_bin_mcast-group-same-group.sh \
-  ltp_testcases_bin_mcast-group-single-socket.sh \
-  ltp_testcases_bin_mcast-group-source-filter.sh \
-  ltp_testcases_bin_mcast-lib.sh \
-  ltp_testcases_bin_mcast-pktfld01.sh \
-  ltp_testcases_bin_mcast-pktfld02.sh \
-  ltp_testcases_bin_mcast-queryfld01.sh \
-  ltp_testcases_bin_mcast-queryfld02.sh \
-  ltp_testcases_bin_mcast-queryfld03.sh \
-  ltp_testcases_bin_mcast-queryfld04.sh \
-  ltp_testcases_bin_mcast-queryfld05.sh \
-  ltp_testcases_bin_mcast-queryfld06.sh \
-  ltp_testcases_bin_memcg_control_test.sh \
-  ltp_testcases_bin_memcg_failcnt.sh \
-  ltp_testcases_bin_memcg_force_empty.sh \
-  ltp_testcases_bin_memcg_lib.sh \
-  ltp_testcases_bin_memcg_limit_in_bytes.sh \
-  ltp_testcases_bin_memcg_max_usage_in_bytes_test.sh \
-  ltp_testcases_bin_memcg_memsw_limit_in_bytes_test.sh \
-  ltp_testcases_bin_memcg_move_charge_at_immigrate_test.sh \
-  ltp_testcases_bin_memcg_regression_test.sh \
-  ltp_testcases_bin_memcg_stat_rss.sh \
-  ltp_testcases_bin_memcg_stat_test.sh \
-  ltp_testcases_bin_memcg_stress_test.sh \
-  ltp_testcases_bin_memcg_subgroup_charge.sh \
-  ltp_testcases_bin_memcg_test_4.sh \
-  ltp_testcases_bin_memcg_usage_in_bytes_test.sh \
-  ltp_testcases_bin_memcg_use_hierarchy_test.sh \
-  ltp_testcases_bin_mkdir_tests.sh \
-  ltp_testcases_bin_mpls01.sh \
-  ltp_testcases_bin_mpls02.sh \
-  ltp_testcases_bin_mpls03.sh \
-  ltp_testcases_bin_mpls04.sh \
-  ltp_testcases_bin_mpls_lib.sh \
-  ltp_testcases_bin_myfunctions.sh \
-  ltp_testcases_bin_net_cmdlib.sh \
-  ltp_testcases_bin_netns_lib.sh \
-  ltp_testcases_bin_netstat01.sh \
-  ltp_testcases_bin_nfs01.sh \
-  ltp_testcases_bin_nfs02.sh \
-  ltp_testcases_bin_nfs03.sh \
-  ltp_testcases_bin_nfs04.sh \
-  ltp_testcases_bin_nfs05.sh \
-  ltp_testcases_bin_nfs06.sh \
-  ltp_testcases_bin_nfs07.sh \
-  ltp_testcases_bin_nfs08.sh \
-  ltp_testcases_bin_nfs_lib.sh \
-  ltp_testcases_bin_nfslock01.sh \
-  ltp_testcases_bin_nfsstat01.sh \
-  ltp_testcases_bin_nft01.sh \
-  ltp_testcases_bin_nm01.sh \
-  ltp_testcases_bin_ns-echoclient \
-  ltp_testcases_bin_numa01.sh \
-  ltp_testcases_bin_output_ipsec_conf \
-  ltp_testcases_bin_parameters.sh \
-  ltp_testcases_bin_pids.sh \
-  ltp_testcases_bin_ping01.sh \
-  ltp_testcases_bin_ping02.sh \
-  ltp_testcases_bin_pm_cpu_consolidation.py \
-  ltp_testcases_bin_pm_ilb_test.py \
-  ltp_testcases_bin_pm_include.sh \
-  ltp_testcases_bin_pm_sched_domain.py \
-  ltp_testcases_bin_pm_sched_mc.py \
-  ltp_testcases_bin_prepare_lvm.sh \
-  ltp_testcases_bin_quota_remount_test01.sh \
-  ltp_testcases_bin_rcu_torture.sh \
-  ltp_testcases_bin_remove_password.sh \
-  ltp_testcases_bin_route-change-dst.sh \
-  ltp_testcases_bin_route-change-gw.sh \
-  ltp_testcases_bin_route-change-if.sh \
-  ltp_testcases_bin_route-change-netlink-dst.sh \
-  ltp_testcases_bin_route-change-netlink-gw.sh \
-  ltp_testcases_bin_route-change-netlink-if.sh \
-  ltp_testcases_bin_route-lib.sh \
-  ltp_testcases_bin_route-redirect.sh \
-  ltp_testcases_bin_route4-rmmod \
-  ltp_testcases_bin_route6-rmmod \
-  ltp_testcases_bin_run_capbounds.sh \
-  ltp_testcases_bin_run_cpuctl_latency_test.sh \
-  ltp_testcases_bin_run_cpuctl_stress_test.sh \
-  ltp_testcases_bin_run_cpuctl_test.sh \
-  ltp_testcases_bin_run_cpuctl_test_fj.sh \
-  ltp_testcases_bin_run_freezer.sh \
-  ltp_testcases_bin_run_memctl_test.sh \
-  ltp_testcases_bin_run_sched_cliserv.sh \
-  ltp_testcases_bin_runpwtests01.sh \
-  ltp_testcases_bin_runpwtests02.sh \
-  ltp_testcases_bin_runpwtests03.sh \
-  ltp_testcases_bin_runpwtests04.sh \
-  ltp_testcases_bin_runpwtests05.sh \
-  ltp_testcases_bin_runpwtests06.sh \
-  ltp_testcases_bin_runpwtests_exclusive01.sh \
-  ltp_testcases_bin_runpwtests_exclusive02.sh \
-  ltp_testcases_bin_runpwtests_exclusive03.sh \
-  ltp_testcases_bin_runpwtests_exclusive04.sh \
-  ltp_testcases_bin_runpwtests_exclusive05.sh \
-  ltp_testcases_bin_rwtest \
-  ltp_testcases_bin_sched_stress.sh \
-  ltp_testcases_bin_sctp01.sh \
-  ltp_testcases_bin_sctp_ipsec.sh \
-  ltp_testcases_bin_sctp_ipsec_vti.sh \
-  ltp_testcases_bin_sendfile01.sh \
-  ltp_testcases_bin_set_ipv4addr \
-  ltp_testcases_bin_shell_pipe01.sh \
-  ltp_testcases_bin_sit01.sh \
-  ltp_testcases_bin_smack_common.sh \
-  ltp_testcases_bin_smack_file_access.sh \
-  ltp_testcases_bin_smack_set_ambient.sh \
-  ltp_testcases_bin_smack_set_cipso.sh \
-  ltp_testcases_bin_smack_set_current.sh \
-  ltp_testcases_bin_smack_set_direct.sh \
-  ltp_testcases_bin_smack_set_doi.sh \
-  ltp_testcases_bin_smack_set_load.sh \
-  ltp_testcases_bin_smack_set_netlabel.sh \
-  ltp_testcases_bin_smack_set_onlycap.sh \
-  ltp_testcases_bin_smt_smp_affinity.sh \
-  ltp_testcases_bin_smt_smp_enabled.sh \
-  ltp_testcases_bin_ssh-stress.sh \
-  ltp_testcases_bin_stop_freeze_sleep_thaw_cont.sh \
-  ltp_testcases_bin_stop_freeze_thaw_cont.sh \
-  ltp_testcases_bin_sysctl01.sh \
-  ltp_testcases_bin_sysctl02.sh \
-  ltp_testcases_bin_tc01.sh \
-  ltp_testcases_bin_tcp4-multi-diffip01 \
-  ltp_testcases_bin_tcp4-multi-diffip02 \
-  ltp_testcases_bin_tcp4-multi-diffip03 \
-  ltp_testcases_bin_tcp4-multi-diffip04 \
-  ltp_testcases_bin_tcp4-multi-diffip05 \
-  ltp_testcases_bin_tcp4-multi-diffip06 \
-  ltp_testcases_bin_tcp4-multi-diffip07 \
-  ltp_testcases_bin_tcp4-multi-diffip08 \
-  ltp_testcases_bin_tcp4-multi-diffip09 \
-  ltp_testcases_bin_tcp4-multi-diffip10 \
-  ltp_testcases_bin_tcp4-multi-diffip11 \
-  ltp_testcases_bin_tcp4-multi-diffip12 \
-  ltp_testcases_bin_tcp4-multi-diffip13 \
-  ltp_testcases_bin_tcp4-multi-diffip14 \
-  ltp_testcases_bin_tcp4-multi-diffnic01 \
-  ltp_testcases_bin_tcp4-multi-diffnic02 \
-  ltp_testcases_bin_tcp4-multi-diffnic03 \
-  ltp_testcases_bin_tcp4-multi-diffnic04 \
-  ltp_testcases_bin_tcp4-multi-diffnic05 \
-  ltp_testcases_bin_tcp4-multi-diffnic06 \
-  ltp_testcases_bin_tcp4-multi-diffnic07 \
-  ltp_testcases_bin_tcp4-multi-diffnic08 \
-  ltp_testcases_bin_tcp4-multi-diffnic09 \
-  ltp_testcases_bin_tcp4-multi-diffnic10 \
-  ltp_testcases_bin_tcp4-multi-diffnic11 \
-  ltp_testcases_bin_tcp4-multi-diffnic12 \
-  ltp_testcases_bin_tcp4-multi-diffnic13 \
-  ltp_testcases_bin_tcp4-multi-diffnic14 \
-  ltp_testcases_bin_tcp4-multi-diffport01 \
-  ltp_testcases_bin_tcp4-multi-diffport02 \
-  ltp_testcases_bin_tcp4-multi-diffport03 \
-  ltp_testcases_bin_tcp4-multi-diffport04 \
-  ltp_testcases_bin_tcp4-multi-diffport05 \
-  ltp_testcases_bin_tcp4-multi-diffport06 \
-  ltp_testcases_bin_tcp4-multi-diffport07 \
-  ltp_testcases_bin_tcp4-multi-diffport08 \
-  ltp_testcases_bin_tcp4-multi-diffport09 \
-  ltp_testcases_bin_tcp4-multi-diffport10 \
-  ltp_testcases_bin_tcp4-multi-diffport11 \
-  ltp_testcases_bin_tcp4-multi-diffport12 \
-  ltp_testcases_bin_tcp4-multi-diffport13 \
-  ltp_testcases_bin_tcp4-multi-diffport14 \
-  ltp_testcases_bin_tcp4-multi-sameport01 \
-  ltp_testcases_bin_tcp4-multi-sameport02 \
-  ltp_testcases_bin_tcp4-multi-sameport03 \
-  ltp_testcases_bin_tcp4-multi-sameport04 \
-  ltp_testcases_bin_tcp4-multi-sameport05 \
-  ltp_testcases_bin_tcp4-multi-sameport06 \
-  ltp_testcases_bin_tcp4-multi-sameport07 \
-  ltp_testcases_bin_tcp4-multi-sameport08 \
-  ltp_testcases_bin_tcp4-multi-sameport09 \
-  ltp_testcases_bin_tcp4-multi-sameport10 \
-  ltp_testcases_bin_tcp4-multi-sameport11 \
-  ltp_testcases_bin_tcp4-multi-sameport12 \
-  ltp_testcases_bin_tcp4-multi-sameport13 \
-  ltp_testcases_bin_tcp4-multi-sameport14 \
-  ltp_testcases_bin_tcp4-uni-basic01 \
-  ltp_testcases_bin_tcp4-uni-basic02 \
-  ltp_testcases_bin_tcp4-uni-basic03 \
-  ltp_testcases_bin_tcp4-uni-basic04 \
-  ltp_testcases_bin_tcp4-uni-basic05 \
-  ltp_testcases_bin_tcp4-uni-basic06 \
-  ltp_testcases_bin_tcp4-uni-basic07 \
-  ltp_testcases_bin_tcp4-uni-basic08 \
-  ltp_testcases_bin_tcp4-uni-basic09 \
-  ltp_testcases_bin_tcp4-uni-basic10 \
-  ltp_testcases_bin_tcp4-uni-basic11 \
-  ltp_testcases_bin_tcp4-uni-basic12 \
-  ltp_testcases_bin_tcp4-uni-basic13 \
-  ltp_testcases_bin_tcp4-uni-basic14 \
-  ltp_testcases_bin_tcp4-uni-dsackoff01 \
-  ltp_testcases_bin_tcp4-uni-dsackoff02 \
-  ltp_testcases_bin_tcp4-uni-dsackoff03 \
-  ltp_testcases_bin_tcp4-uni-dsackoff04 \
-  ltp_testcases_bin_tcp4-uni-dsackoff05 \
-  ltp_testcases_bin_tcp4-uni-dsackoff06 \
-  ltp_testcases_bin_tcp4-uni-dsackoff07 \
-  ltp_testcases_bin_tcp4-uni-dsackoff08 \
-  ltp_testcases_bin_tcp4-uni-dsackoff09 \
-  ltp_testcases_bin_tcp4-uni-dsackoff10 \
-  ltp_testcases_bin_tcp4-uni-dsackoff11 \
-  ltp_testcases_bin_tcp4-uni-dsackoff12 \
-  ltp_testcases_bin_tcp4-uni-dsackoff13 \
-  ltp_testcases_bin_tcp4-uni-dsackoff14 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup01 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup02 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup03 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup04 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup05 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup06 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup07 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup08 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup09 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup10 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup11 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup12 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup13 \
-  ltp_testcases_bin_tcp4-uni-pktlossdup14 \
-  ltp_testcases_bin_tcp4-uni-sackoff01 \
-  ltp_testcases_bin_tcp4-uni-sackoff02 \
-  ltp_testcases_bin_tcp4-uni-sackoff03 \
-  ltp_testcases_bin_tcp4-uni-sackoff04 \
-  ltp_testcases_bin_tcp4-uni-sackoff05 \
-  ltp_testcases_bin_tcp4-uni-sackoff06 \
-  ltp_testcases_bin_tcp4-uni-sackoff07 \
-  ltp_testcases_bin_tcp4-uni-sackoff08 \
-  ltp_testcases_bin_tcp4-uni-sackoff09 \
-  ltp_testcases_bin_tcp4-uni-sackoff10 \
-  ltp_testcases_bin_tcp4-uni-sackoff11 \
-  ltp_testcases_bin_tcp4-uni-sackoff12 \
-  ltp_testcases_bin_tcp4-uni-sackoff13 \
-  ltp_testcases_bin_tcp4-uni-sackoff14 \
-  ltp_testcases_bin_tcp4-uni-smallsend01 \
-  ltp_testcases_bin_tcp4-uni-smallsend02 \
-  ltp_testcases_bin_tcp4-uni-smallsend03 \
-  ltp_testcases_bin_tcp4-uni-smallsend04 \
-  ltp_testcases_bin_tcp4-uni-smallsend05 \
-  ltp_testcases_bin_tcp4-uni-smallsend06 \
-  ltp_testcases_bin_tcp4-uni-smallsend07 \
-  ltp_testcases_bin_tcp4-uni-smallsend08 \
-  ltp_testcases_bin_tcp4-uni-smallsend09 \
-  ltp_testcases_bin_tcp4-uni-smallsend10 \
-  ltp_testcases_bin_tcp4-uni-smallsend11 \
-  ltp_testcases_bin_tcp4-uni-smallsend12 \
-  ltp_testcases_bin_tcp4-uni-smallsend13 \
-  ltp_testcases_bin_tcp4-uni-smallsend14 \
-  ltp_testcases_bin_tcp4-uni-tso01 \
-  ltp_testcases_bin_tcp4-uni-tso02 \
-  ltp_testcases_bin_tcp4-uni-tso03 \
-  ltp_testcases_bin_tcp4-uni-tso04 \
-  ltp_testcases_bin_tcp4-uni-tso05 \
-  ltp_testcases_bin_tcp4-uni-tso06 \
-  ltp_testcases_bin_tcp4-uni-tso07 \
-  ltp_testcases_bin_tcp4-uni-tso08 \
-  ltp_testcases_bin_tcp4-uni-tso09 \
-  ltp_testcases_bin_tcp4-uni-tso10 \
-  ltp_testcases_bin_tcp4-uni-tso11 \
-  ltp_testcases_bin_tcp4-uni-tso12 \
-  ltp_testcases_bin_tcp4-uni-tso13 \
-  ltp_testcases_bin_tcp4-uni-tso14 \
-  ltp_testcases_bin_tcp4-uni-winscale01 \
-  ltp_testcases_bin_tcp4-uni-winscale02 \
-  ltp_testcases_bin_tcp4-uni-winscale03 \
-  ltp_testcases_bin_tcp4-uni-winscale04 \
-  ltp_testcases_bin_tcp4-uni-winscale05 \
-  ltp_testcases_bin_tcp4-uni-winscale06 \
-  ltp_testcases_bin_tcp4-uni-winscale07 \
-  ltp_testcases_bin_tcp4-uni-winscale08 \
-  ltp_testcases_bin_tcp4-uni-winscale09 \
-  ltp_testcases_bin_tcp4-uni-winscale10 \
-  ltp_testcases_bin_tcp4-uni-winscale11 \
-  ltp_testcases_bin_tcp4-uni-winscale12 \
-  ltp_testcases_bin_tcp4-uni-winscale13 \
-  ltp_testcases_bin_tcp4-uni-winscale14 \
-  ltp_testcases_bin_tcp6-multi-diffip01 \
-  ltp_testcases_bin_tcp6-multi-diffip02 \
-  ltp_testcases_bin_tcp6-multi-diffip03 \
-  ltp_testcases_bin_tcp6-multi-diffip04 \
-  ltp_testcases_bin_tcp6-multi-diffip05 \
-  ltp_testcases_bin_tcp6-multi-diffip06 \
-  ltp_testcases_bin_tcp6-multi-diffip07 \
-  ltp_testcases_bin_tcp6-multi-diffip08 \
-  ltp_testcases_bin_tcp6-multi-diffip09 \
-  ltp_testcases_bin_tcp6-multi-diffip10 \
-  ltp_testcases_bin_tcp6-multi-diffip11 \
-  ltp_testcases_bin_tcp6-multi-diffip12 \
-  ltp_testcases_bin_tcp6-multi-diffip13 \
-  ltp_testcases_bin_tcp6-multi-diffip14 \
-  ltp_testcases_bin_tcp6-multi-diffnic01 \
-  ltp_testcases_bin_tcp6-multi-diffnic02 \
-  ltp_testcases_bin_tcp6-multi-diffnic03 \
-  ltp_testcases_bin_tcp6-multi-diffnic04 \
-  ltp_testcases_bin_tcp6-multi-diffnic05 \
-  ltp_testcases_bin_tcp6-multi-diffnic06 \
-  ltp_testcases_bin_tcp6-multi-diffnic07 \
-  ltp_testcases_bin_tcp6-multi-diffnic08 \
-  ltp_testcases_bin_tcp6-multi-diffnic09 \
-  ltp_testcases_bin_tcp6-multi-diffnic10 \
-  ltp_testcases_bin_tcp6-multi-diffnic11 \
-  ltp_testcases_bin_tcp6-multi-diffnic12 \
-  ltp_testcases_bin_tcp6-multi-diffnic13 \
-  ltp_testcases_bin_tcp6-multi-diffnic14 \
-  ltp_testcases_bin_tcp6-multi-diffport01 \
-  ltp_testcases_bin_tcp6-multi-diffport02 \
-  ltp_testcases_bin_tcp6-multi-diffport03 \
-  ltp_testcases_bin_tcp6-multi-diffport04 \
-  ltp_testcases_bin_tcp6-multi-diffport05 \
-  ltp_testcases_bin_tcp6-multi-diffport06 \
-  ltp_testcases_bin_tcp6-multi-diffport07 \
-  ltp_testcases_bin_tcp6-multi-diffport08 \
-  ltp_testcases_bin_tcp6-multi-diffport09 \
-  ltp_testcases_bin_tcp6-multi-diffport10 \
-  ltp_testcases_bin_tcp6-multi-diffport11 \
-  ltp_testcases_bin_tcp6-multi-diffport12 \
-  ltp_testcases_bin_tcp6-multi-diffport13 \
-  ltp_testcases_bin_tcp6-multi-diffport14 \
-  ltp_testcases_bin_tcp6-multi-sameport01 \
-  ltp_testcases_bin_tcp6-multi-sameport02 \
-  ltp_testcases_bin_tcp6-multi-sameport03 \
-  ltp_testcases_bin_tcp6-multi-sameport04 \
-  ltp_testcases_bin_tcp6-multi-sameport05 \
-  ltp_testcases_bin_tcp6-multi-sameport06 \
-  ltp_testcases_bin_tcp6-multi-sameport07 \
-  ltp_testcases_bin_tcp6-multi-sameport08 \
-  ltp_testcases_bin_tcp6-multi-sameport09 \
-  ltp_testcases_bin_tcp6-multi-sameport10 \
-  ltp_testcases_bin_tcp6-multi-sameport11 \
-  ltp_testcases_bin_tcp6-multi-sameport12 \
-  ltp_testcases_bin_tcp6-multi-sameport13 \
-  ltp_testcases_bin_tcp6-multi-sameport14 \
-  ltp_testcases_bin_tcp6-uni-basic01 \
-  ltp_testcases_bin_tcp6-uni-basic02 \
-  ltp_testcases_bin_tcp6-uni-basic03 \
-  ltp_testcases_bin_tcp6-uni-basic04 \
-  ltp_testcases_bin_tcp6-uni-basic05 \
-  ltp_testcases_bin_tcp6-uni-basic06 \
-  ltp_testcases_bin_tcp6-uni-basic07 \
-  ltp_testcases_bin_tcp6-uni-basic08 \
-  ltp_testcases_bin_tcp6-uni-basic09 \
-  ltp_testcases_bin_tcp6-uni-basic10 \
-  ltp_testcases_bin_tcp6-uni-basic11 \
-  ltp_testcases_bin_tcp6-uni-basic12 \
-  ltp_testcases_bin_tcp6-uni-basic13 \
-  ltp_testcases_bin_tcp6-uni-basic14 \
-  ltp_testcases_bin_tcp6-uni-dsackoff01 \
-  ltp_testcases_bin_tcp6-uni-dsackoff02 \
-  ltp_testcases_bin_tcp6-uni-dsackoff03 \
-  ltp_testcases_bin_tcp6-uni-dsackoff04 \
-  ltp_testcases_bin_tcp6-uni-dsackoff05 \
-  ltp_testcases_bin_tcp6-uni-dsackoff06 \
-  ltp_testcases_bin_tcp6-uni-dsackoff07 \
-  ltp_testcases_bin_tcp6-uni-dsackoff08 \
-  ltp_testcases_bin_tcp6-uni-dsackoff09 \
-  ltp_testcases_bin_tcp6-uni-dsackoff10 \
-  ltp_testcases_bin_tcp6-uni-dsackoff11 \
-  ltp_testcases_bin_tcp6-uni-dsackoff12 \
-  ltp_testcases_bin_tcp6-uni-dsackoff13 \
-  ltp_testcases_bin_tcp6-uni-dsackoff14 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup01 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup02 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup03 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup04 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup05 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup06 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup07 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup08 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup09 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup10 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup11 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup12 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup13 \
-  ltp_testcases_bin_tcp6-uni-pktlossdup14 \
-  ltp_testcases_bin_tcp6-uni-sackoff01 \
-  ltp_testcases_bin_tcp6-uni-sackoff02 \
-  ltp_testcases_bin_tcp6-uni-sackoff03 \
-  ltp_testcases_bin_tcp6-uni-sackoff04 \
-  ltp_testcases_bin_tcp6-uni-sackoff05 \
-  ltp_testcases_bin_tcp6-uni-sackoff06 \
-  ltp_testcases_bin_tcp6-uni-sackoff07 \
-  ltp_testcases_bin_tcp6-uni-sackoff08 \
-  ltp_testcases_bin_tcp6-uni-sackoff09 \
-  ltp_testcases_bin_tcp6-uni-sackoff10 \
-  ltp_testcases_bin_tcp6-uni-sackoff11 \
-  ltp_testcases_bin_tcp6-uni-sackoff12 \
-  ltp_testcases_bin_tcp6-uni-sackoff13 \
-  ltp_testcases_bin_tcp6-uni-sackoff14 \
-  ltp_testcases_bin_tcp6-uni-smallsend01 \
-  ltp_testcases_bin_tcp6-uni-smallsend02 \
-  ltp_testcases_bin_tcp6-uni-smallsend03 \
-  ltp_testcases_bin_tcp6-uni-smallsend04 \
-  ltp_testcases_bin_tcp6-uni-smallsend05 \
-  ltp_testcases_bin_tcp6-uni-smallsend06 \
-  ltp_testcases_bin_tcp6-uni-smallsend07 \
-  ltp_testcases_bin_tcp6-uni-smallsend08 \
-  ltp_testcases_bin_tcp6-uni-smallsend09 \
-  ltp_testcases_bin_tcp6-uni-smallsend10 \
-  ltp_testcases_bin_tcp6-uni-smallsend11 \
-  ltp_testcases_bin_tcp6-uni-smallsend12 \
-  ltp_testcases_bin_tcp6-uni-smallsend13 \
-  ltp_testcases_bin_tcp6-uni-smallsend14 \
-  ltp_testcases_bin_tcp6-uni-tso01 \
-  ltp_testcases_bin_tcp6-uni-tso02 \
-  ltp_testcases_bin_tcp6-uni-tso03 \
-  ltp_testcases_bin_tcp6-uni-tso04 \
-  ltp_testcases_bin_tcp6-uni-tso05 \
-  ltp_testcases_bin_tcp6-uni-tso06 \
-  ltp_testcases_bin_tcp6-uni-tso07 \
-  ltp_testcases_bin_tcp6-uni-tso08 \
-  ltp_testcases_bin_tcp6-uni-tso09 \
-  ltp_testcases_bin_tcp6-uni-tso10 \
-  ltp_testcases_bin_tcp6-uni-tso11 \
-  ltp_testcases_bin_tcp6-uni-tso12 \
-  ltp_testcases_bin_tcp6-uni-tso13 \
-  ltp_testcases_bin_tcp6-uni-tso14 \
-  ltp_testcases_bin_tcp6-uni-winscale01 \
-  ltp_testcases_bin_tcp6-uni-winscale02 \
-  ltp_testcases_bin_tcp6-uni-winscale03 \
-  ltp_testcases_bin_tcp6-uni-winscale04 \
-  ltp_testcases_bin_tcp6-uni-winscale05 \
-  ltp_testcases_bin_tcp6-uni-winscale06 \
-  ltp_testcases_bin_tcp6-uni-winscale07 \
-  ltp_testcases_bin_tcp6-uni-winscale08 \
-  ltp_testcases_bin_tcp6-uni-winscale09 \
-  ltp_testcases_bin_tcp6-uni-winscale10 \
-  ltp_testcases_bin_tcp6-uni-winscale11 \
-  ltp_testcases_bin_tcp6-uni-winscale12 \
-  ltp_testcases_bin_tcp6-uni-winscale13 \
-  ltp_testcases_bin_tcp6-uni-winscale14 \
-  ltp_testcases_bin_tcp_cc_lib.sh \
-  ltp_testcases_bin_tcp_fastopen_run.sh \
-  ltp_testcases_bin_tcp_ipsec.sh \
-  ltp_testcases_bin_tcp_ipsec_vti.sh \
-  ltp_testcases_bin_tcpdump01.sh \
-  ltp_testcases_bin_telnet01.sh \
-  ltp_testcases_bin_test.sh \
-  ltp_testcases_bin_test_controllers.sh \
-  ltp_testcases_bin_test_ioctl \
-  ltp_testcases_bin_test_robind.sh \
-  ltp_testcases_bin_tracepath01.sh \
-  ltp_testcases_bin_traceroute01.sh \
-  ltp_testcases_bin_tst_ansi_color.sh \
-  ltp_testcases_bin_tst_net.sh \
-  ltp_testcases_bin_tst_net_stress.sh \
-  ltp_testcases_bin_tst_security.sh \
-  ltp_testcases_bin_tst_test.sh \
-  ltp_testcases_bin_udp4-multi-diffip01 \
-  ltp_testcases_bin_udp4-multi-diffip02 \
-  ltp_testcases_bin_udp4-multi-diffip03 \
-  ltp_testcases_bin_udp4-multi-diffip04 \
-  ltp_testcases_bin_udp4-multi-diffip05 \
-  ltp_testcases_bin_udp4-multi-diffip06 \
-  ltp_testcases_bin_udp4-multi-diffip07 \
-  ltp_testcases_bin_udp4-multi-diffnic01 \
-  ltp_testcases_bin_udp4-multi-diffnic02 \
-  ltp_testcases_bin_udp4-multi-diffnic03 \
-  ltp_testcases_bin_udp4-multi-diffnic04 \
-  ltp_testcases_bin_udp4-multi-diffnic05 \
-  ltp_testcases_bin_udp4-multi-diffnic06 \
-  ltp_testcases_bin_udp4-multi-diffnic07 \
-  ltp_testcases_bin_udp4-multi-diffport01 \
-  ltp_testcases_bin_udp4-multi-diffport02 \
-  ltp_testcases_bin_udp4-multi-diffport03 \
-  ltp_testcases_bin_udp4-multi-diffport04 \
-  ltp_testcases_bin_udp4-multi-diffport05 \
-  ltp_testcases_bin_udp4-multi-diffport06 \
-  ltp_testcases_bin_udp4-multi-diffport07 \
-  ltp_testcases_bin_udp4-uni-basic01 \
-  ltp_testcases_bin_udp4-uni-basic02 \
-  ltp_testcases_bin_udp4-uni-basic03 \
-  ltp_testcases_bin_udp4-uni-basic04 \
-  ltp_testcases_bin_udp4-uni-basic05 \
-  ltp_testcases_bin_udp4-uni-basic06 \
-  ltp_testcases_bin_udp4-uni-basic07 \
-  ltp_testcases_bin_udp6-multi-diffip01 \
-  ltp_testcases_bin_udp6-multi-diffip02 \
-  ltp_testcases_bin_udp6-multi-diffip03 \
-  ltp_testcases_bin_udp6-multi-diffip04 \
-  ltp_testcases_bin_udp6-multi-diffip05 \
-  ltp_testcases_bin_udp6-multi-diffip06 \
-  ltp_testcases_bin_udp6-multi-diffip07 \
-  ltp_testcases_bin_udp6-multi-diffnic01 \
-  ltp_testcases_bin_udp6-multi-diffnic02 \
-  ltp_testcases_bin_udp6-multi-diffnic03 \
-  ltp_testcases_bin_udp6-multi-diffnic04 \
-  ltp_testcases_bin_udp6-multi-diffnic05 \
-  ltp_testcases_bin_udp6-multi-diffnic06 \
-  ltp_testcases_bin_udp6-multi-diffnic07 \
-  ltp_testcases_bin_udp6-multi-diffport01 \
-  ltp_testcases_bin_udp6-multi-diffport02 \
-  ltp_testcases_bin_udp6-multi-diffport03 \
-  ltp_testcases_bin_udp6-multi-diffport04 \
-  ltp_testcases_bin_udp6-multi-diffport05 \
-  ltp_testcases_bin_udp6-multi-diffport06 \
-  ltp_testcases_bin_udp6-multi-diffport07 \
-  ltp_testcases_bin_udp6-uni-basic01 \
-  ltp_testcases_bin_udp6-uni-basic02 \
-  ltp_testcases_bin_udp6-uni-basic03 \
-  ltp_testcases_bin_udp6-uni-basic04 \
-  ltp_testcases_bin_udp6-uni-basic05 \
-  ltp_testcases_bin_udp6-uni-basic06 \
-  ltp_testcases_bin_udp6-uni-basic07 \
-  ltp_testcases_bin_udp_ipsec.sh \
-  ltp_testcases_bin_udp_ipsec_vti.sh \
-  ltp_testcases_bin_unshare01.sh \
-  ltp_testcases_bin_unzip01.sh \
-  ltp_testcases_bin_vfork_freeze.sh \
-  ltp_testcases_bin_virt_lib.sh \
-  ltp_testcases_bin_vlan01.sh \
-  ltp_testcases_bin_vlan02.sh \
-  ltp_testcases_bin_vlan03.sh \
-  ltp_testcases_bin_vma05.sh \
-  ltp_testcases_bin_vxlan01.sh \
-  ltp_testcases_bin_vxlan02.sh \
-  ltp_testcases_bin_vxlan03.sh \
-  ltp_testcases_bin_vxlan04.sh \
-  ltp_testcases_bin_wireguard01.sh \
-  ltp_testcases_bin_wireguard02.sh \
-  ltp_testcases_bin_wireguard_lib.sh \
-  ltp_testcases_bin_write_freezing.sh \
-  ltp_testcases_bin_xinetd_tests.sh \
-  ltp_testcases_bin_zram01.sh \
-  ltp_testcases_bin_zram02.sh \
-  ltp_testcases_bin_zram_lib.sh \
-  ltp_testcases_data_ar01_file1.in \
-  ltp_testcases_data_ar01_file10.in \
-  ltp_testcases_data_ar01_file2.in \
-  ltp_testcases_data_ar01_file3.in \
-  ltp_testcases_data_ar01_file4.in \
-  ltp_testcases_data_binfmt_misc02_file.extension \
-  ltp_testcases_data_binfmt_misc02_file.magic \
-  ltp_testcases_data_file01_in.ar \
-  ltp_testcases_data_file01_in.bash \
-  ltp_testcases_data_file01_in.c \
-  ltp_testcases_data_file01_in.jpg \
-  ltp_testcases_data_file01_in.m4 \
-  ltp_testcases_data_file01_in.mp3 \
-  ltp_testcases_data_file01_in.pl \
-  ltp_testcases_data_file01_in.png \
-  ltp_testcases_data_file01_in.py \
-  ltp_testcases_data_file01_in.sh \
-  ltp_testcases_data_file01_in.src.rpm \
-  ltp_testcases_data_file01_in.tar \
-  ltp_testcases_data_file01_in.tar.bz2 \
-  ltp_testcases_data_file01_in.tar.gz \
-  ltp_testcases_data_file01_in.txt \
-  ltp_testcases_data_file01_in.wav \
-  ltp_testcases_data_file01_in.zip \
-  ltp_testcases_data_ima_kexec_kexec.policy \
-  ltp_testcases_data_ima_keys_keycheck.policy \
-  ltp_testcases_data_ima_keys_x509_ima.der \
-  ltp_testcases_data_ima_policy_measure.policy \
-  ltp_testcases_data_ima_policy_measure.policy-invalid \
-  ltp_testcases_data_ima_selinux_selinux.policy \
-  ltp_testcases_data_ld01_d1.c \
-  ltp_testcases_data_ld01_f1.c \
-  ltp_testcases_data_ld01_main.c \
-  ltp_testcases_data_ld01_rd1.c \
-  ltp_testcases_data_ld01_rf1.c \
-  ltp_testcases_data_lvm_runfile.tpl \
-  ltp_testcases_data_mc_member_ManyGroups \
-  ltp_testcases_data_mc_member_TooManyGroups \
-  ltp_testcases_data_rpc01_file.1 \
-  ltp_testcases_data_rpc01_file.2 \
-  ltp_testcases_data_unzip01_dir.out \
-  ltp_testcases_data_unzip01_test.zip \
-  ltp_testsf_c \
-  ltp_testsf_c6 \
-  ltp_testsf_s \
-  ltp_testsf_s6 \
-  ltp_tgkill01 \
-  ltp_tgkill02 \
-  ltp_tgkill03 \
-  ltp_thp01 \
-  ltp_thp02 \
-  ltp_thp03 \
-  ltp_thp04 \
-  ltp_time-schedule \
-  ltp_time01 \
-  ltp_timed_forkbomb \
-  ltp_timens01 \
-  ltp_timer_create01 \
-  ltp_timer_create02 \
-  ltp_timer_create03 \
-  ltp_timer_delete01 \
-  ltp_timer_delete02 \
-  ltp_timer_getoverrun01 \
-  ltp_timer_gettime01 \
-  ltp_timer_settime01 \
-  ltp_timer_settime02 \
-  ltp_timer_settime03 \
-  ltp_timerfd01 \
-  ltp_timerfd02 \
-  ltp_timerfd04 \
-  ltp_timerfd_create01 \
-  ltp_timerfd_gettime01 \
-  ltp_timerfd_settime01 \
-  ltp_timerfd_settime02 \
-  ltp_times01 \
-  ltp_times03 \
-  ltp_tkill01 \
-  ltp_tkill02 \
-  ltp_tpci \
-  ltp_trace_sched \
-  ltp_trerrno \
-  ltp_truncate02 \
-  ltp_truncate02_64 \
-  ltp_truncate03 \
-  ltp_truncate03_64 \
-  ltp_tst_bool_expr \
-  ltp_tst_brk \
-  ltp_tst_brkm \
-  ltp_tst_capability01 \
-  ltp_tst_capability02 \
-  ltp_tst_cgctl \
-  ltp_tst_cgroup01 \
-  ltp_tst_cgroup02 \
-  ltp_tst_check_drivers \
-  ltp_tst_check_kconfigs \
-  ltp_tst_checkpoint \
-  ltp_tst_checkpoint_wait_timeout \
-  ltp_tst_checkpoint_wake_timeout \
-  ltp_tst_cleanup_once \
-  ltp_tst_dataroot01 \
-  ltp_tst_dataroot02 \
-  ltp_tst_dataroot03 \
-  ltp_tst_device \
-  ltp_tst_exit \
-  ltp_tst_expiration_timer \
-  ltp_tst_fs_fill_hardlinks \
-  ltp_tst_fs_fill_subdirs \
-  ltp_tst_fs_has_free \
-  ltp_tst_fsfreeze \
-  ltp_tst_fuzzy_sync01 \
-  ltp_tst_fuzzy_sync02 \
-  ltp_tst_fuzzy_sync03 \
-  ltp_tst_get_free_pids \
-  ltp_tst_get_median \
-  ltp_tst_get_unused_port \
-  ltp_tst_getconf \
-  ltp_tst_hexdump \
-  ltp_tst_kvcmp \
-  ltp_tst_lockdown_enabled \
-  ltp_tst_ncpus \
-  ltp_tst_ncpus_conf \
-  ltp_tst_ncpus_max \
-  ltp_tst_needs_cmds01 \
-  ltp_tst_needs_cmds02 \
-  ltp_tst_needs_cmds03 \
-  ltp_tst_needs_cmds04 \
-  ltp_tst_needs_cmds05 \
-  ltp_tst_needs_cmds06 \
-  ltp_tst_needs_cmds07 \
-  ltp_tst_needs_cmds08 \
-  ltp_tst_net_iface_prefix \
-  ltp_tst_net_ip_prefix \
-  ltp_tst_net_vars \
-  ltp_tst_ns_create \
-  ltp_tst_ns_exec \
-  ltp_tst_ns_ifmove \
-  ltp_tst_print_result \
-  ltp_tst_process_state \
-  ltp_tst_random \
-  ltp_tst_record_childstatus \
-  ltp_tst_res \
-  ltp_tst_res_flags \
-  ltp_tst_res_hexd \
-  ltp_tst_resm \
-  ltp_tst_rod \
-  ltp_tst_safe_fileops \
-  ltp_tst_safe_macros \
-  ltp_tst_secureboot_enabled \
-  ltp_tst_sleep \
-  ltp_tst_strerrno \
-  ltp_tst_strsig \
-  ltp_tst_strstatus \
-  ltp_tst_supported_fs \
-  ltp_tst_timeout_kill \
-  ltp_tst_tmpdir_test \
-  ltp_uaccess \
-  ltp_uevent01 \
-  ltp_uevent02 \
-  ltp_uevent03 \
-  ltp_umask01 \
-  ltp_umip_basic_test \
-  ltp_umount01 \
-  ltp_umount02 \
-  ltp_umount03 \
-  ltp_umount2_01 \
-  ltp_umount2_02 \
-  ltp_uname01 \
-  ltp_uname02 \
-  ltp_uname04 \
-  ltp_unlink05 \
-  ltp_unlink07 \
-  ltp_unlink08 \
-  ltp_unlinkat01 \
-  ltp_unshare01 \
-  ltp_unshare02 \
-  ltp_userfaultfd01 \
-  ltp_ustat01 \
-  ltp_ustat02 \
-  ltp_utime01 \
-  ltp_utime02 \
-  ltp_utime03 \
-  ltp_utime04 \
-  ltp_utime05 \
-  ltp_utime06 \
-  ltp_utimensat01 \
-  ltp_utimes01 \
-  ltp_utsname01 \
-  ltp_utsname02 \
-  ltp_utsname03 \
-  ltp_utsname04 \
-  ltp_variant \
-  ltp_verify_caps_exec \
-  ltp_vfork \
-  ltp_vfork01 \
-  ltp_vfork02 \
-  ltp_vhangup01 \
-  ltp_vhangup02 \
-  ltp_vma01 \
-  ltp_vma02 \
-  ltp_vma03 \
-  ltp_vma04 \
-  ltp_vma05_vdso \
-  ltp_vmsplice01 \
-  ltp_vmsplice02 \
-  ltp_vmsplice03 \
-  ltp_vmsplice04 \
-  ltp_vsock01 \
-  ltp_wait01 \
-  ltp_wait02 \
-  ltp_wait401 \
-  ltp_wait402 \
-  ltp_wait403 \
-  ltp_waitid01 \
-  ltp_waitid02 \
-  ltp_waitid03 \
-  ltp_waitid04 \
-  ltp_waitid05 \
-  ltp_waitid06 \
-  ltp_waitid07 \
-  ltp_waitid08 \
-  ltp_waitid09 \
-  ltp_waitid10 \
-  ltp_waitid11 \
-  ltp_waitpid01 \
-  ltp_waitpid02 \
-  ltp_waitpid03 \
-  ltp_waitpid04 \
-  ltp_waitpid05 \
-  ltp_waitpid06 \
-  ltp_waitpid07 \
-  ltp_waitpid08 \
-  ltp_waitpid09 \
-  ltp_waitpid10 \
-  ltp_waitpid11 \
-  ltp_waitpid12 \
-  ltp_waitpid13 \
-  ltp_wqueue01 \
-  ltp_wqueue02 \
-  ltp_wqueue03 \
-  ltp_wqueue04 \
-  ltp_wqueue05 \
-  ltp_wqueue06 \
-  ltp_wqueue07 \
-  ltp_wqueue08 \
-  ltp_wqueue09 \
-  ltp_write01 \
-  ltp_write02 \
-  ltp_write03 \
-  ltp_write04 \
-  ltp_write05 \
-  ltp_write06 \
-  ltp_writetest \
-  ltp_writev01 \
-  ltp_writev02 \
-  ltp_writev03 \
-  ltp_writev05 \
-  ltp_writev06 \
-  ltp_writev07 \
-  ltp_zram03
\ No newline at end of file
diff --git a/android/tools/android_build_generator.py b/android/tools/android_build_generator.py
old mode 100644
new mode 100755
index fd6c5a58f..140412c32
--- a/android/tools/android_build_generator.py
+++ b/android/tools/android_build_generator.py
@@ -16,7 +16,7 @@
 #
 
 # Parses the output of parse_ltp_{make,make_install} and generates a
-# corresponding Android.mk.
+# corresponding Android.bp.
 #
 # This process is split into two steps so this second step can later be replaced
 # with an Android.bp generator.
@@ -35,10 +35,39 @@ MAKE_INSTALL_DRY_RUN_FILE_NAME = os.path.join('dump', 'make_install_dry_run.dump
 DISABLED_TESTS_FILE_NAME = 'disabled_tests.txt'
 DISABLED_LIBS_FILE_NAME = 'disabled_libs.txt'
 DISABLED_CFLAGS_FILE_NAME = 'disabled_cflags.txt'
+TARGET_LIST = [
+    {
+        "arch": "arm",
+        "bitness": "64",
+        "extra_test_configs": ["lowmem", "hwasan", "lowmem_hwasan"],
+        "targets": ["arm64"],
+    },
+    {
+        "arch": "arm",
+        "bitness": "32",
+        "extra_test_configs": ["lowmem"],
+        "targets": ["arm", "arm64"],
+    },
+    {
+        "arch": "riscv",
+        "bitness": "64",
+        "targets": ["riscv64"],
+    },
+    {
+        "arch": "x86",
+        "bitness": "64",
+        "targets": ["x86_64"],
+    },
+    {
+        "arch": "x86",
+        "bitness": "32",
+        "targets": ["x86", "x86_64"],
+    },
+]
 
 
 class BuildGenerator(object):
-    '''A class to parse make output and convert the result to Android.ltp.mk modules.
+    '''A class to parse make output and convert the result to Android.bp modules.
 
     Attributes:
         _bp_result: directory of list of strings for blueprint file keyed by target name
@@ -111,8 +140,7 @@ class BuildGenerator(object):
         '''
         base_name = os.path.basename(cc_target)
         if base_name in ltp_names_used:
-            print('ERROR: base name {} of cc_target {} already used. Skipping...'.format(
-                base_name, cc_target))
+            print(f'ERROR: base name {base_name} of cc_target {cc_target} already used. Skipping...')
             return
         ltp_names_used.add(base_name)
 
@@ -122,11 +150,12 @@ class BuildGenerator(object):
 
         # ltp_defaults already adds the include directory
         local_c_includes = [i for i in local_c_includes if i != 'include']
-        target_name = 'ltp_%s' % base_name
+        target_name = f'ltp_{base_name}'
         target_bp = []
 
         self._packages.append(target_name)
 
+        target_bp.append('')
         target_bp.append('cc_test {')
         target_bp.append('    name: "%s",' % target_name)
         target_bp.append('    stem: "%s",' % base_name)
@@ -181,7 +210,6 @@ class BuildGenerator(object):
             target_bp.append('    ],')
 
         target_bp.append('}')
-        target_bp.append('')
         self._bp_result[target_name] = target_bp
 
     def BuildStaticLibrary(self, ar_target, local_src_files, local_cflags,
@@ -196,6 +224,7 @@ class BuildGenerator(object):
         '''
         target_name = 'libltp_%s' % self.ArTargetToLibraryName(ar_target)
         target_bp = []
+        target_bp.append('')
         target_bp.append('cc_library_static {')
         target_bp.append('    name: "%s",' % target_name)
         target_bp.append('    defaults: ["ltp_defaults"],')
@@ -218,7 +247,6 @@ class BuildGenerator(object):
         target_bp.append('    ],')
 
         target_bp.append('}')
-        target_bp.append('')
         self._bp_result[target_name] = target_bp
 
     def BuildShellScript(self, install_target, local_src_file):
@@ -237,14 +265,14 @@ class BuildGenerator(object):
         module_dir = os.path.dirname(install_target)
         module_stem = os.path.basename(install_target)
 
+        bp_result.append('')
         bp_result.append('sh_test {')
         bp_result.append('    name: "%s",' % module)
         bp_result.append('    src: "%s",' % local_src_file)
-        bp_result.append('    sub_dir: "ltp/%s",' % module_dir)
+        bp_result.append('    sub_dir: "vts_ltp_tests/%s",' % module_dir)
         bp_result.append('    filename: "%s",' % module_stem)
         bp_result.append('    compile_multilib: "both",')
         bp_result.append('}')
-        bp_result.append('')
 
         self._bp_result[module] = bp_result
 
@@ -264,15 +292,15 @@ class BuildGenerator(object):
         module_stem = os.path.basename(install_target)
 
         bp_result = []
+        bp_result.append('')
         bp_result.append('sh_test {')
         bp_result.append('    name: "%s",' % module)
         bp_result.append('    src: "%s",' % src)
-        bp_result.append('    sub_dir: "ltp/%s",' % module_dir)
+        bp_result.append('    sub_dir: "vts_ltp_tests/%s",' % module_dir)
         bp_result.append('    filename: "%s",' % module_stem)
         bp_result.append('    compile_multilib: "both",')
         bp_result.append('    auto_gen_config: false,')
         bp_result.append('}')
-        bp_result.append('')
 
         self._prebuilt_bp_result[base_name] = bp_result
         self._packages.append(module)
@@ -296,7 +324,7 @@ class BuildGenerator(object):
         rules.setdefault(rule, {})[rule_key] = rule_value
 
     def ParseInput(self, input_list, ltp_root):
-        '''Parse a interpreted make output and produce Android.ltp.mk module.
+        '''Parse a interpreted make output and produce Android.bp module.
 
         Args:
             input_list: list of string
@@ -339,7 +367,7 @@ class BuildGenerator(object):
                 cc_flags[target].remove('-Wno-error')
 
         print(
-            "Disabled lib tests: Test cases listed here are"
+            "Disabled lib tests: Test cases listed here are "
             "suggested to be disabled since they require a disabled library. "
             "Please copy and paste them into disabled_tests.txt\n")
         for i in cc_libraries:
@@ -347,7 +375,7 @@ class BuildGenerator(object):
                 if not os.path.basename(i) in disabled_tests:
                     print(os.path.basename(i))
 
-        print("Disabled_cflag tests: Test cases listed here are"
+        print("Disabled_cflag tests: Test cases listed here are "
               "suggested to be disabled since they require a disabled cflag. "
               "Please copy and paste them into disabled_tests.txt\n")
         for i in cc_flags:
@@ -397,7 +425,7 @@ class BuildGenerator(object):
             local_c_includes = set()
             local_libraries = cc_libraries[target]
             # Accumulate flags for all .c files needed to build the .o files.
-            # (Android.mk requires a consistent set of flags across a given target.
+            # (Android.bp requires a consistent set of flags across a given target.
             # Thankfully using the superset of all flags in the target works fine
             # with LTP tests.)
             for obj in cc_link[target]:
@@ -486,14 +514,108 @@ class BuildGenerator(object):
         Args:
             output_path: string
         '''
+        bp_result = []
+        bp_result.append('')
+        bp_result.append('package {')
+        bp_result.append('    default_applicable_licenses: ["external_ltp_license"],')
+        bp_result.append('}')
+        for k in sorted(self._prebuilt_bp_result.keys()):
+            bp_result.extend(self._prebuilt_bp_result[k])
+        self._prebuilt_bp_result = {}
         with open(output_path, 'a') as f:
-            f.write('package {\n')
-            f.write('    default_applicable_licenses: ["external_ltp_license"],\n')
-            f.write('}\n\n')
             for k in sorted(self._prebuilt_bp_result.keys()):
                 f.write('\n'.join(self._prebuilt_bp_result[k]))
                 f.write('\n')
             self._prebuilt_bp_result = {}
+            f.write('\n'.join(bp_result))
+            f.write('\n')
+
+    def ArchString(self, arch, bitness, lowmem=False, hwasan=False):
+        if bitness == '32':
+            arch_string = arch
+        else:
+            arch_string = f'{arch}_{bitness}'
+        if lowmem:
+            arch_string += '_lowmem'
+        if hwasan:
+            arch_string += '_hwasan'
+        return arch_string
+
+    def BuildConfigGenrule(self, arch, bitness, targets, extra_test_configs=None):
+        extra_test_configs = extra_test_configs if extra_test_configs else []
+        bp_result = []
+        arch_string = self.ArchString(arch, bitness)
+
+        bp_result.append('')
+        bp_result.append('genrule {')
+        bp_result.append('    name: "ltp_config_%s",' % arch_string)
+        bp_result.append('    out: ["vts_ltp_test_%s.xml"],' % arch_string)
+        bp_result.append('    tools: ["gen_ltp_config"],')
+        bp_result.append('    cmd: "$(location gen_ltp_config) --arch %s --bitness %s --low-mem %r --hwasan %r $(out)",' % (arch, bitness, lowmem, hwasan))
+        bp_result.append('}')
+
+        for config in extra_test_configs:
+            lowmem = 'lowmem' in config
+            hwasan = 'hwasan' in config
+            arch_string = self.ArchString(arch, bitness, lowmem, hwasan)
+
+            bp_result.append('')
+            bp_result.append('genrule {')
+            bp_result.append('    name: "ltp_config_%s",' % arch_string)
+            bp_result.append('    out: ["vts_ltp_test_%s.xml"],' % arch_string)
+            bp_result.append('    tools: ["gen_ltp_config"],')
+            bp_result.append('    cmd: "$(location gen_ltp_config) --arch %s --bitness %s --low-mem %r --hwasan %r $(out)",' % (arch, bitness, lowmem, hwasan))
+            bp_result.append('}')
+        return bp_result
+
+    def BuildPackageList(self):
+        bp_result = []
+        bp_result.append('')
+        bp_result.append('LTP_TESTS = [')
+        bp_result.append('    ":ltp_runtests",')
+        for package in sorted(self._packages):
+            bp_result.append('    ":%s",' % package)
+        bp_result.append(']')
+        return bp_result
+
+    def BuildLTPTestSuite(self, arch, bitness, targets, extra_test_configs=None):
+        extra_test_configs = extra_test_configs if extra_test_configs else []
+        bp_result = []
+        arch_string = self.ArchString(arch, bitness)
+
+        bp_result.append('')
+        bp_result.append('sh_test {')
+        bp_result.append('    name: "vts_ltp_test_%s",' % arch_string)
+        bp_result.append('    src: "empty.sh",')
+        bp_result.append('    test_config: ":ltp_config_%s",' % arch_string)
+        bp_result.append('    test_suites: [')
+        bp_result.append('        "general-tests",')
+        bp_result.append('        "vts",')
+        bp_result.append('    ],')
+        bp_result.append('    enabled: false,')
+
+        if bitness == '32':
+            bp_result.append('    compile_multilib: "32",')
+
+        bp_result.append('    arch: {')
+        for target in targets:
+            bp_result.append('        %s: {' % target)
+            bp_result.append('            enabled: true,')
+            bp_result.append('        },')
+        bp_result.append('    },')
+
+        if extra_test_configs:
+            bp_result.append('    extra_test_configs: [')
+            for config in extra_test_configs:
+                lowmem = 'lowmem' in config
+                hwasan = 'hwasan' in config
+                arch_string = self.ArchString(arch, bitness, lowmem, hwasan)
+                bp_result.append('        ":ltp_config_%s",' % arch_string)
+            bp_result.append('    ],')
+
+        bp_result.append('    data: LTP_TESTS,')
+        bp_result.append('}')
+        return bp_result
 
     def WriteLtpMainAndroidBp(self, output_path):
         '''Write the blueprint file of ltp main module.
@@ -502,23 +624,18 @@ class BuildGenerator(object):
             output_path: string
         '''
         bp_result = []
+        bp_result.append('')
         bp_result.append('package {')
         bp_result.append('    default_applicable_licenses: ["external_ltp_license"],')
         bp_result.append('}')
-        bp_result.append('')
-        bp_result.append('sh_test {')
-        bp_result.append('    name: "ltp",')
-        bp_result.append('    src: "tools/disabled_tests.txt",')
-        bp_result.append('    sub_dir: "ltp",')
-        bp_result.append('    data: [":ltp_runtests"],')
-        bp_result.append('    filename_from_src: true,')
-        bp_result.append('    compile_multilib: "both",')
-        bp_result.append('    auto_gen_config: false,')
-        bp_result.append('    required: [')
-        for package in sorted(self._packages):
-            bp_result.append('        "%s",' % package)
-        bp_result.append('    ],')
-        bp_result.append('}')
+
+        bp_result.extend(self.BuildPackageList())
+
+        for target in TARGET_LIST:
+            bp_result.extend(self.BuildConfigGenrule(**target))
+
+        for target in TARGET_LIST:
+            bp_result.extend(self.BuildLTPTestSuite(**target))
 
         with open(output_path, 'a') as f:
             f.write('\n'.join(bp_result))
@@ -542,7 +659,7 @@ class BuildGenerator(object):
 
 def main():
     parser = argparse.ArgumentParser(
-        description='Generate Android.mk from parsed LTP make output')
+        description='Generate Android.bp from parsed LTP make output')
     parser.add_argument(
         '--ltp_root', dest='ltp_root', required=True, help='LTP root dir')
     parser.add_argument(
diff --git a/android/tools/disabled_tests.txt b/android/tools/disabled_tests.txt
index dfa8902ee..5603f07b3 100644
--- a/android/tools/disabled_tests.txt
+++ b/android/tools/disabled_tests.txt
@@ -624,6 +624,8 @@ kvm_svm02
 kvm_svm02-payload.elf
 kvm_svm03
 kvm_svm03-payload.elf
+kvm_svm04
+kvm_svm04-payload.elf
 
 # Redefines cacheflush
 # b/277960476
diff --git a/android/tools/gen_android_build.sh b/android/tools/gen_android_build.sh
index ea5e54bb2..8d91dee47 100755
--- a/android/tools/gen_android_build.sh
+++ b/android/tools/gen_android_build.sh
@@ -59,17 +59,14 @@ fi
 sed "s%#%//%" $LTP_ANDROID_DIR/AOSP_license_text.txt > $OUTPUT_BP
 echo "" >> $OUTPUT_BP
 echo "// This file is autogenerated by $(basename $0)" >> $OUTPUT_BP
-echo "" >> $OUTPUT_BP
 
 sed "s%#%//%" $LTP_ANDROID_DIR/AOSP_license_text.txt > $OUTPUT_LTP_TESTCASE_BP
 echo "" >> $OUTPUT_LTP_TESTCASE_BP
 echo "// This file is autogenerated by $(basename $0)" >> $OUTPUT_LTP_TESTCASE_BP
-echo "" >> $OUTPUT_LTP_TESTCASE_BP
 
 sed "s%#%//%" $LTP_ANDROID_DIR/AOSP_license_text.txt > $OUTPUT_LTP_MAIN_BP
 echo "" >> $OUTPUT_LTP_MAIN_BP
 echo "// This file is autogenerated by $(basename $0)" >> $OUTPUT_LTP_MAIN_BP
-echo "" >> $OUTPUT_LTP_MAIN_BP
 
 echo ""
 echo "Parsing LTP make dry_run output..."
diff --git a/ci/debian.i386.sh b/ci/debian.i386.sh
index d28e552ff..284605309 100755
--- a/ci/debian.i386.sh
+++ b/ci/debian.i386.sh
@@ -1,6 +1,6 @@
 #!/bin/sh -eux
 # SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) 2018-2020 Petr Vorel <pvorel@suse.cz>
+# Copyright (c) 2018-2024 Petr Vorel <pvorel@suse.cz>
 
 dpkg --add-architecture i386
 apt update
@@ -8,13 +8,13 @@ apt update
 apt install -y --no-install-recommends \
 	linux-libc-dev:i386 \
 	gcc-multilib \
-	libacl1:i386 \
-	libaio1:i386 \
-	libcap2:i386 \
+	libacl1-dev:i386 \
+	libaio-dev:i386 \
+	libcap-dev:i386 \
 	libc6-dev-i386 \
 	libc6:i386 \
-	libkeyutils1:i386 \
-	libnuma1:i386 \
+	libkeyutils-dev:i386 \
+	libnuma-dev:i386 \
 	libssl-dev:i386 \
 	libtirpc-dev:i386 \
 	pkg-config:i386
diff --git a/ci/debian.minimal.sh b/ci/debian.minimal.sh
index 568125555..058419272 100755
--- a/ci/debian.minimal.sh
+++ b/ci/debian.minimal.sh
@@ -1,6 +1,6 @@
 #!/bin/sh -eux
 # SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) 2018-2023 Petr Vorel <pvorel@suse.cz>
+# Copyright (c) 2018-2024 Petr Vorel <pvorel@suse.cz>
 
 apt="apt remove -y"
 
@@ -9,11 +9,9 @@ $apt \
 	asciidoctor \
 	libacl1-dev \
 	libaio-dev \
-	libaio1 \
 	libcap-dev \
 	libkeyutils-dev \
 	libnuma-dev \
-	libnuma1 \
 	libselinux1-dev \
 	libsepol-dev \
 	libssl-dev
diff --git a/ci/debian.sh b/ci/debian.sh
index 96b55a35b..63cf242d2 100755
--- a/ci/debian.sh
+++ b/ci/debian.sh
@@ -1,6 +1,6 @@
 #!/bin/sh -eux
 # SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) 2018-2021 Petr Vorel <pvorel@suse.cz>
+# Copyright (c) 2018-2024 Petr Vorel <pvorel@suse.cz>
 
 # workaround for missing oldstable-updates repository
 # W: Failed to fetch http://deb.debian.org/debian/dists/oldstable-updates/main/binary-amd64/Packages
@@ -26,20 +26,15 @@ $apt \
 	gcc \
 	git \
 	iproute2 \
-	libacl1 \
 	libacl1-dev \
 	libaio-dev \
-	libaio1 \
 	libcap-dev \
-	libcap2 \
 	libc6 \
 	libc6-dev \
 	libjson-perl \
 	libkeyutils-dev \
-	libkeyutils1 \
 	libmnl-dev \
 	libnuma-dev \
-	libnuma1 \
 	libselinux1-dev \
 	libsepol-dev \
 	libssl-dev \
diff --git a/configure.ac b/configure.ac
index a676bc3f3..b1fee16c1 100644
--- a/configure.ac
+++ b/configure.ac
@@ -41,6 +41,7 @@ AC_CHECK_DECLS([SEM_STAT_ANY],,,[#include <sys/sem.h>])
 
 AC_CHECK_HEADERS_ONCE([ \
     asm/ldt.h \
+    asm/prctl.h \
     cpuid.h \
     emmintrin.h \
     ifaddrs.h \
@@ -77,6 +78,7 @@ AC_CHECK_HEADERS_ONCE([ \
     sys/inotify.h \
     sys/pidfd.h
     sys/prctl.h \
+    sys/random.h \
     sys/shm.h \
     sys/timerfd.h \
     sys/ustat.h \
@@ -187,14 +189,6 @@ AC_CHECK_TYPES([struct iovec],,,[#include <sys/uio.h>])
 AC_CHECK_TYPES([struct ipc64_perm],,,[#include <sys/ipcbuf.h>])
 AC_CHECK_TYPES([struct loop_config],,,[#include <linux/loop.h>])
 
-AC_CHECK_TYPES([struct __kernel_itimerspec],,,[#include <linux/time_types.h>])
-AC_CHECK_TYPES([struct __kernel_old_timespec],,,[#include <linux/time_types.h>])
-AC_CHECK_TYPES([struct __kernel_old_timeval],,,[#include <linux/time_types.h>])
-AC_CHECK_TYPES([struct __kernel_timespec],,,[#include <linux/time_types.h>])
-
-AC_CHECK_TYPES([struct __kernel_timex],,,[#include <sys/timex.h>])
-AC_CHECK_TYPES([struct __kernel_timex_timeval],,,[#include <sys/timex.h>])
-
 AC_CHECK_TYPES([struct mmsghdr],,,[
 #define _GNU_SOURCE
 #include <sys/types.h>
@@ -229,8 +223,19 @@ AC_CHECK_TYPES([struct xt_entry_match, struct xt_entry_target],,,[
 #include <linux/netfilter_ipv4/ip_tables.h>
 ])
 
+AC_CHECK_TYPES([struct __kernel_itimerspec],,,[#include <linux/time_types.h>])
+AC_CHECK_TYPES([struct __kernel_old_timespec],,,[#include <linux/time_types.h>])
+AC_CHECK_TYPES([struct __kernel_old_timeval],,,[#include <linux/time_types.h>])
+AC_CHECK_TYPES([struct __kernel_old_itimerval],,,[#include <linux/time_types.h>])
+AC_CHECK_TYPES([struct __kernel_old_itimerspec],,,[#include <linux/time_types.h>])
+AC_CHECK_TYPES([struct __kernel_timespec],,,[#include <linux/time_types.h>])
+
+AC_CHECK_TYPES([struct __kernel_timex],,,[#include <sys/timex.h>])
+AC_CHECK_TYPES([struct __kernel_timex_timeval],,,[#include <sys/timex.h>])
+
 AC_CHECK_TYPES([struct __kernel_old_timeval, struct __kernel_old_timespec, struct __kernel_timespec,
-                struct __kernel_old_itimerspec, struct __kernel_itimerspec],,,[#include <sys/socket.h>])
+                struct __kernel_old_itimerspec, struct __kernel_itimerspec,
+                struct __kernel_old_itimerval],,,[#include <sys/socket.h>])
 
 AC_CHECK_TYPES([struct futex_waitv],,,[#include <linux/futex.h>])
 AC_CHECK_TYPES([struct mount_attr],,,[
@@ -395,7 +400,6 @@ LTP_CHECK_KERNEL_DEVEL
 LTP_CHECK_KEYUTILS_SUPPORT
 LTP_CHECK_LIBMNL
 LTP_CHECK_LINUXRANDOM
-LTP_CHECK_NOMMU_LINUX
 LTP_CHECK_SELINUX
 LTP_CHECK_SYNC_ADD_AND_FETCH
 LTP_CHECK_SYSCALL_EVENTFD
@@ -403,7 +407,9 @@ LTP_CHECK_SYSCALL_FCNTL
 LTP_CHECK_FSVERITY
 
 AX_CHECK_COMPILE_FLAG([-no-pie], [LTP_CFLAGS_NOPIE=1])
+AX_CHECK_COMPILE_FLAG([-ffixed-ebp], [LTP_CFLAGS_FFIXED_EBP=1])
 AC_SUBST([LTP_CFLAGS_NOPIE])
+AC_SUBST([LTP_CFLAGS_FFIXED_EBP])
 
 if test "x$with_numa" = xyes; then
 	LTP_CHECK_SYSCALL_NUMA
diff --git a/doc/.gitignore b/doc/.gitignore
new file mode 100644
index 000000000..173179852
--- /dev/null
+++ b/doc/.gitignore
@@ -0,0 +1,4 @@
+html/
+build/
+_static/syscalls.rst
+syscalls.tbl
diff --git a/doc/Makefile b/doc/Makefile
index f7e4dd021..e536e95db 100644
--- a/doc/Makefile
+++ b/doc/Makefile
@@ -1,11 +1,8 @@
-# SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (C) 2009, Cisco Systems Inc.
-# Ngie Cooper, July 2009
+all:
+	sphinx-build -b html . html
 
-top_srcdir			?= ..
+spelling:
+	sphinx-build -b spelling -d build/doctree . build/spelling
 
-include $(top_srcdir)/include/mk/env_pre.mk
-
-RECURSIVE_TARGETS	:= install
-
-include $(top_srcdir)/include/mk/generic_trunk_target.mk
+clean:
+	rm -rf html/
diff --git a/doc/_static/custom.css b/doc/_static/custom.css
new file mode 100644
index 000000000..cb4d3821d
--- /dev/null
+++ b/doc/_static/custom.css
@@ -0,0 +1,4 @@
+/* set multiline tables cells */
+.wy-table-responsive table td {
+    white-space: normal;
+}
diff --git a/doc/conf.py b/doc/conf.py
new file mode 100644
index 000000000..9525ad7bb
--- /dev/null
+++ b/doc/conf.py
@@ -0,0 +1,227 @@
+# Configuration file for the Sphinx documentation builder.
+#
+# For the full list of built-in configuration values, see the documentation:
+# https://www.sphinx-doc.org/en/master/usage/configuration.html
+
+import os
+import re
+import sphinx
+import socket
+import urllib.request
+
+# -- Project information -----------------------------------------------------
+# https://www.sphinx-doc.org/en/master/usage/configuration.html#project-information
+
+project = 'Linux Test Project'
+copyright = '2024, Linux Test Project'
+author = 'Linux Test Project'
+release = '1.0'
+
+# -- General configuration ---------------------------------------------------
+# https://www.sphinx-doc.org/en/master/usage/configuration.html#general-configuration
+
+extensions = [
+    'linuxdoc.rstKernelDoc',
+    'sphinxcontrib.spelling',
+    'sphinx.ext.extlinks'
+]
+
+exclude_patterns = ["html*", '_static*']
+extlinks = {
+    'repo': ('https://github.com/linux-test-project/ltp/%s', '%s'),
+    'master': ('https://github.com/linux-test-project/ltp/blob/master/%s', '%s'),
+    'git_man': ('https://git-scm.com/docs/git-%s', 'git %s'),
+    # TODO: allow 2nd parameter to show page description instead of plain URL
+    'kernel_doc': ('https://docs.kernel.org/%s.html', 'https://docs.kernel.org/%s.html'),
+    'kernel_tree': ('https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/%s', '%s'),
+}
+
+spelling_lang = "en_US"
+spelling_warning = True
+spelling_exclude_patterns=['users/stats.rst']
+spelling_word_list_filename = "spelling_wordlist"
+
+# -- Options for HTML output -------------------------------------------------
+# https://www.sphinx-doc.org/en/master/usage/configuration.html#options-for-html-output
+
+html_theme = 'sphinx_rtd_theme'
+html_static_path = ['_static']
+
+
+def generate_syscalls_stats(_):
+    """
+    Generate statistics for syscalls. We fetch the syscalls list from the kernel
+    sources, then we compare it with testcases/kernel/syscalls folder and
+    generate a file that is included in the statistics documentation section.
+    """
+    output = '_static/syscalls.rst'
+
+    # sometimes checking testcases/kernel/syscalls file names are not enough,
+    # because in some cases (i.e. io_ring) syscalls are tested, but they are
+    # part of a more complex scenario. In the following list, we define syscalls
+    # which we know they are 100% tested already.
+    white_list = [
+        'rt_sigpending',
+        'sethostname',
+        'lsetxattr',
+        'inotify_add_watch',
+        'inotify_rm_watch',
+        'newfstatat',
+        'pselect6',
+        'fanotify_init',
+        'fanotify_mark',
+        'prlimit64',
+        'getdents64',
+        'pkey_mprotect',
+        'pkey_alloc',
+        'pkey_free',
+        'io_uring_setup',
+        'io_uring_enter',
+        'io_uring_register',
+        'epoll_pwait2',
+        'quotactl_fd',
+        'pread64',
+        'pwrite64',
+        'fadvise64',
+        'getmsg',
+        'getpmsg',
+        'putmsg',
+        'putpmsg',
+    ]
+
+    # populate with not implemented, reserved, unmaintained syscalls defined
+    # inside the syscalls file
+    black_list = [
+        'reserved177',
+        'reserved193',
+        'rseq',
+        '_newselect',
+        '_sysctl',
+        'create_module',
+        'get_kernel_syms',
+        'query_module',
+        'nfsservctl',
+        'afs_syscall',
+        'sysmips',
+        'mq_getsetattr',
+        'vserver',
+    ]
+
+    # fetch syscalls file
+    error = False
+    try:
+        socket.setdefaulttimeout(3)
+        urllib.request.urlretrieve(
+            "https://raw.githubusercontent.com/torvalds/linux/master/arch/mips/kernel/syscalls/syscall_n64.tbl",
+            "syscalls.tbl")
+    except Exception as err:
+        error = True
+        logger = sphinx.util.logging.getLogger(__name__)
+        msg = "Can't download syscall_n64.tbl from kernel sources"
+        logger.warning(msg)
+
+        with open(output, 'w+') as stats:
+            stats.write(f".. warning::\n\n    {msg}")
+
+    if error:
+        return
+
+    text = [
+        'Syscalls\n',
+        '--------\n\n',
+    ]
+
+    # collect all available kernel syscalls
+    regexp = re.compile(r'\d+\s+n64\s+(?P<syscall>\w+)\s+\w+')
+    ker_syscalls = []
+    with open("syscalls.tbl", 'r') as data:
+        for line in data:
+            match = regexp.search(line)
+            if match:
+                ker_syscalls.append(match.group('syscall'))
+
+    # collect all LTP tested syscalls
+    ltp_syscalls = []
+    for root, _, files in os.walk('../testcases/kernel/syscalls'):
+        for myfile in files:
+            if myfile.endswith('.c'):
+                ltp_syscalls.append(myfile)
+
+    # compare kernel syscalls with LTP tested syscalls
+    syscalls = {}
+    for kersc in ker_syscalls:
+        if kersc in black_list:
+            continue
+
+        if kersc not in syscalls:
+            if kersc in white_list:
+                syscalls[kersc] = True
+                continue
+
+            syscalls[kersc] = False
+
+        for ltpsc in ltp_syscalls:
+            if ltpsc.startswith(kersc):
+                syscalls[kersc] = True
+
+    # generate the statistics file
+    tested_syscalls = [key for key, val in syscalls.items() if val]
+    text.append('syscalls which are tested under :master:`testcases/kernel/syscalls`:\n\n')
+    text.append(f'* kernel syscalls: {len(ker_syscalls)}\n')
+    text.append(f'* tested syscalls: {len(tested_syscalls)}\n\n')
+
+    # create tested/untested syscalls table
+    index_tested = 0
+    table_tested = [
+        'Tested syscalls\n',
+        '~~~~~~~~~~~~~~~\n\n',
+        '.. list-table::\n',
+        '    :header-rows: 0\n\n',
+    ]
+
+    index_untest = 0
+    table_untest = [
+        'Untested syscalls\n',
+        '~~~~~~~~~~~~~~~~~\n\n',
+        '.. list-table::\n',
+        '    :header-rows: 0\n\n',
+    ]
+
+    for sysname, tested in syscalls.items():
+        if tested:
+            if (index_tested % 3) == 0:
+                table_tested.append(f'    * - {sysname}\n')
+            else:
+                table_tested.append(f'      - {sysname}\n')
+
+            index_tested += 1
+        else:
+            if (index_untest % 3) == 0:
+                table_untest.append(f'    * - {sysname}\n')
+            else:
+                table_untest.append(f'      - {sysname}\n')
+
+            index_untest += 1
+
+    left = index_tested % 3
+    if left > 0:
+        for index in range(0, 3 - left):
+            table_tested.append(f'      -\n')
+
+    left = index_untest % 3
+    if left > 0:
+        for index in range(0, 3 - left):
+            table_untest.append(f'      -\n')
+
+    text.extend(table_tested)
+    text.append('\n')
+    text.extend(table_untest)
+
+    # write the file
+    with open(output, 'w+') as stats:
+        stats.writelines(text)
+
+
+def setup(app):
+    app.add_css_file('custom.css')
+    app.connect('builder-inited', generate_syscalls_stats)
diff --git a/doc/developers/api_c_tests.rst b/doc/developers/api_c_tests.rst
new file mode 100644
index 000000000..2a9f3e7b9
--- /dev/null
+++ b/doc/developers/api_c_tests.rst
@@ -0,0 +1,39 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+.. Copyright (c) Linux Test Project, 2024
+
+.. Include headers in this file with:
+.. .. kernel-doc:: ../../include/tst_test.h
+
+Developing using C API
+======================
+
+Core LTP API
+------------
+
+.. kernel-doc:: ../../include/tst_res_flags.h
+.. kernel-doc:: ../../include/tst_test.h
+.. kernel-doc:: ../../include/tst_kernel.h
+
+Option parsing
+--------------
+
+.. kernel-doc:: ../../include/tst_parse.h
+
+Guarded buffers
+---------------
+
+.. kernel-doc:: ../../include/tst_buffers.h
+
+Checkpoints
+-----------
+
+.. kernel-doc:: ../../include/tst_checkpoint.h
+
+Capabilities
+------------
+
+.. kernel-doc:: ../../include/tst_capability.h
+
+libltpswap
+----------
+.. kernel-doc:: ../../include/libswap.h
diff --git a/doc/developers/api_kvm_tests.rst b/doc/developers/api_kvm_tests.rst
new file mode 100644
index 000000000..5ec3fc3a4
--- /dev/null
+++ b/doc/developers/api_kvm_tests.rst
@@ -0,0 +1,7 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+.. Include headers in this file with:
+.. .. kernel-doc:: ../../include/tst_test.h
+
+Developing using KVM API
+========================
diff --git a/doc/developers/api_network_tests.rst b/doc/developers/api_network_tests.rst
new file mode 100644
index 000000000..3e487d7f2
--- /dev/null
+++ b/doc/developers/api_network_tests.rst
@@ -0,0 +1,7 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+.. Include headers in this file with:
+.. .. kernel-doc:: ../../include/tst_test.h
+
+Developing using network API
+============================
diff --git a/doc/developers/api_shell_tests.rst b/doc/developers/api_shell_tests.rst
new file mode 100644
index 000000000..2fb2a5068
--- /dev/null
+++ b/doc/developers/api_shell_tests.rst
@@ -0,0 +1,4 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Developing using shell API
+==========================
diff --git a/doc/developers/build_system.rst b/doc/developers/build_system.rst
new file mode 100644
index 000000000..bf4714dd6
--- /dev/null
+++ b/doc/developers/build_system.rst
@@ -0,0 +1,213 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Build system
+============
+
+The following document briefly describes the steps and methodologies used for
+the new and improved Makefile system.
+
+The Problem
+-----------
+
+The problem with the old Makefile system is that it was very difficult to
+maintain and it lacked any sense of formal structure, thus developing for LTP
+and including new targets was more difficult than it should have been
+(maintenance). Furthermore, proper option-based cross-compilation was
+impossible due to the fact that the Makefiles didn't support a prefixing
+system, and the appropriate implicit / static rules hadn't been configured to
+compile into multiple object directories for out-of-tree build support (ease of
+use / functionality). Finally, there wasn't a means to setup dependencies
+between components, such that if a component required ``libltp.a`` in order to
+compile, it would go off and compile ``libltp.a`` first (ease of use).
+
+These items needed to be fixed to reduce maintenance nightmares for the
+development community contributing to LTP, and the project maintainers.
+
+Design
+------
+
+The system was designed such that including a single GNU Makefile compatible
+set in each new directory component is all that's essentially required to
+build the system.
+
+Say you had a directory like the following (with ``.c`` files in them which
+directly tie into applications, e.g. baz.c -> baz):
+
+.. code-block::
+
+    .../foo/
+        |--> Makefile
+        |
+        --> bar/
+            |
+            --> Makefile
+            |
+            --> baz.c
+
+.. code-block:: make
+  :caption: .../foo/Makefile
+
+    #
+    # Copyright disclaimer goes here -- please use GPLv2.
+    #
+
+    top_srcdir		?= ..
+
+    include $(top_srcdir)/include/mk/env_pre.mk
+    include $(top_srcdir)/include/mk/generic_trunk_target.mk
+
+.. code-block:: make
+  :caption: .../foo/bar/Makefile
+
+    #
+    # Copyright disclaimer goes here -- please use GPLv2.
+    #
+
+    top_srcdir		?= ../..
+
+    include $(top_srcdir)/include/mk/env_pre.mk
+    include $(top_srcdir)/include/mk/generic_leaf_target.mk
+
+Kernel Modules
+--------------
+
+Some of the tests need to build kernel modules, happily LTP has
+infrastructure for this.
+
+.. code-block:: make
+
+    ifneq ($(KERNELRELEASE),)
+
+    obj-m := module01.o
+
+    else
+
+    top_srcdir	?= ../../../..
+    include $(top_srcdir)/include/mk/testcases.mk
+
+    REQ_VERSION_MAJOR	:= 2
+    REQ_VERSION_PATCH	:= 6
+    MAKE_TARGETS		:= test01 test02 module01.ko
+
+    include $(top_srcdir)/include/mk/module.mk
+    include $(top_srcdir)/include/mk/generic_leaf_target.mk
+
+    endif
+
+This is a Makefile example that allows you to build kernel modules inside LTP.
+The prerequisites for the build are detected by the ``configure`` script.
+
+The ``REQ_VERSION_MAJOR`` and ``REQ_VERSION_PATCH`` describe minimal kernel
+version for which the build system tries to build the module.
+
+The build system is also forward compatible with changes in Linux kernel
+internal API so that, if module fails to build, the failure is ignored both on
+build and installation. If the userspace counterpart of the test fails to load
+the module because the file does not exists, the test is skipped.
+
+Note the ``ifneq($(KERNELRELEASE),)``. The reason it exists, it is that the
+Makefile is executed twice: once by LTP build system and once by kernel kbuild,
+see :kernel_doc:`kbuild/modules` in the Linux kernel documentation for details
+on external module build.
+
+Make Rules and Make Variables
+-----------------------------
+
+When using make rules, avoid writing ad hoc rules like:
+
+.. code-block:: make
+
+    [prog]: [dependencies]
+        cc -I../../include $(CFLAGS) $(CPPFLAGS) $(LDFLAGS) $(LDLIBS) \
+	    -o [prog] [dependencies]
+
+This makes cross-compilation and determinism difficult, if not impossible.
+Besides, implicit rules are your friends and as long as you use ``MAKEOPTS=;``
+in the top-level caller (or do ``$(subst r,$(MAKEOPTS)``) to remove ``-r``),
+the compile will complete successfully, assuming all other prerequisites have
+been fulfilled (libraries, headers, etc).
+
+.. list-table::
+    :header-rows: 1
+
+    * - Variable
+      - Explanation
+
+    * - $(AR)
+      - The library archiver
+
+    * - $(CC)
+      - The system C compiler
+
+    * - $(CCP)
+      - The system C preprocessor
+
+    * - $(CFLAGS)
+      - C compiler flags
+
+    * - $(CPPFLAGS)
+      - Preprocessor flags, e.g. ``-I`` arguments
+
+    * - $(DEBUG_CFLAGS)
+      - Debug flags to pass to ``$(CC)``, ``-g``, etc
+
+    * - $(KVM_LD)
+      - Special linker for wrapping KVM payload binaries into linkable object
+        files. Defaults to ``$(LD)``. Change this variable if the KVM Makefile
+        fails to build files named ``*-payload.o``
+
+    * - $(LD)
+      - The system linker (typically ``$(CC)``, but not necessarily)
+
+    * - $(LDFLAGS)
+      - What to pass in to the linker, including ``-L`` arguments and other ld
+        arguments, apart from ``-l`` library includes (see ``$(LDLIBS)``).
+        This should be done in the ``$(CC)`` args passing style when
+        ``LD := $(CC)``, e.g. ``-Wl,-foo``, as opposed to ``-foo``
+
+    * - $(LDLIBS)
+      - Libraries to pass to the linker (e.g. ``-lltp``, etc)
+
+    * - $(LTPLDLIBS)
+      - LTP internal libraries i.e. these in libs/ directory
+
+    * - $(OPT_CFLAGS)
+      - Optimization flags to pass into the C compiler, ``-O2``, etc. If you
+        specify ``-O2`` or higher, you should also specify
+        ``-fno-strict-aliasing``, because of gcc fstrict-aliasing optimization
+        bugs in the tree optimizer. Search for **fstrict-aliasing optimization
+        bug** with your favorite search engine.
+
+        Examples of more recent bugs: tree-optimization/17510
+        and tree-optimization/39100.
+
+        Various bugs have occurred in the past due to buggy logic in the
+        tree-optimization portion of the gcc compiler, from 3.3.x to 4.4.
+
+    * - $(RANLIB)
+      - What to run after archiving a library
+
+    * - $(WCFLAGS)
+      - Warning flags to pass to ``$(CC)``, e.g. ``-Werror``, ``-Wall``, etc.
+
+Make System Variables
+---------------------
+
+A series of variables are used within the make system that direct what actions
+need to be taken. Rather than listing the variables here, please refer to the
+comments contained in :master:`include/mk/env_pre.mk`.
+
+Guidelines and Recommendations
+------------------------------
+
+Of course, GNU Make manual is the key to understand the Make system, but
+following manuals are probably the most important:
+
+* `Implicit Rules <http://www.gnu.org/software/make/manual/make.html#Implicit-Rules>`_
+* `Variables and Expansion <http://www.gnu.org/software/make/manual/make.html#Using-Variables>`_
+* `Origin Use <http://www.gnu.org/software/make/manual/make.html#Origin-Function>`_
+* `VPath Use <http://www.gnu.org/software/make/manual/make.html#Directory-Search>`_
+
+.. warning::
+
+    Rebuild from scratch before committing anything in the build system.
diff --git a/doc/developers/debugging.rst b/doc/developers/debugging.rst
new file mode 100644
index 000000000..181e5b096
--- /dev/null
+++ b/doc/developers/debugging.rst
@@ -0,0 +1,23 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Debugging
+=========
+
+This section explains some tricks which can be used to debug test binaries.
+
+Debug messages
+--------------
+
+The LTP framework supports ``TDEBUG`` flag test debug messages. These
+messages can be enabled using the ``-D`` parameter or setting ``LTP_ENABLE_DEBUG=1``
+environment variable (see :doc:`../users/setup_tests`).
+
+Tracing and debugging syscalls
+------------------------------
+
+The new test library runs the actual test (i.e. the ``test()`` function) in a
+forked process. To get stack trace of a crashing test in ``gdb`` it's needed to
+`set follow-fork-mode child <https://sourceware.org/gdb/current/onlinedocs/gdb.html/Forks.html>`_.
+
+To trace the test, please use ``strace -f`` to enable tracing also for the
+forked processes.
diff --git a/doc/developers/documentation.rst b/doc/developers/documentation.rst
new file mode 100644
index 000000000..606edc014
--- /dev/null
+++ b/doc/developers/documentation.rst
@@ -0,0 +1,57 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Documentation
+=============
+
+This section explains how to use and develop the LTP documentation. The current
+documentation format is written using
+`reStructedText <https://www.sphinx-doc.org/en/master/usage/restructuredtext/index.html>`_
+and it's built on top of `Sphinx <https://www.sphinx-doc.org/en/master/>`_.
+
+Building documentation
+~~~~~~~~~~~~~~~~~~~~~~
+
+First of all, to build the documentation we must be sure that all dependencies
+have been installed (please check :master:`doc/requirements.txt` file). Sometimes the
+Linux distros are providing them, but the best way is to use ``virtualenv``
+command as following:
+
+.. code-block:: bash
+
+    cd doc
+
+    # prepare virtual enviroment
+    python3 -m virtualenv .venv
+    . .venv/bin/activate
+
+    pip install sphinx # usually packaged in distros
+    pip install -r requirements.txt
+
+    # build documentation
+    make
+
+Once the procedure has been completed, documentation will be visible at
+``doc/html/index.html``.
+
+.. warning::
+
+    The current :master:`.readthedocs.yml` workflow is using ``Python 3.6`` because
+    older Python versions were causing issues. No other version has been tested,
+    but it should work anyway.
+
+Validating spelling
+~~~~~~~~~~~~~~~~~~~
+
+To check documentation words spelling, we provide support for
+`aspell <http://aspell.net/>`_, so make sure that it's installed. The
+documentation can be tested via ``make spelling`` command. Output will be
+visible in the ``doc/build`` folder and, if any error will be found, a warning
+message will be shown.
+
+C API documentation
+~~~~~~~~~~~~~~~~~~~
+
+The C API documentation is generated from headers using
+`kernel-doc <https://return42.github.io/linuxdoc/linuxdoc-howto/kernel-doc-syntax.html>`_
+syntax which is supported by Sphinx via
+`linuxdoc <https://pypi.org/project/linuxdoc/>`_ extension.
diff --git a/doc/developers/ltp_library.rst b/doc/developers/ltp_library.rst
new file mode 100644
index 000000000..723781feb
--- /dev/null
+++ b/doc/developers/ltp_library.rst
@@ -0,0 +1,42 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+LTP Library guidelines
+======================
+
+General Rules
+-------------
+
+When we extend library API, we need to apply the same general rules that we use
+when writing tests, plus:
+
+#. LTP library tests must go inside :master:`lib/newlib_tests` directory
+#. LTP documentation has to be updated according to API changes
+
+Shell API
+---------
+
+API source code is in :master:`testcases/lib/tst_test.sh`,
+:master:`testcases/lib/tst_security.sh` and :master:`testcases/lib/tst_net.sh`.
+
+Changes in the shell API should not introduce uncommon dependencies
+(use basic commands installed everywhere by default).
+
+Shell libraries
+~~~~~~~~~~~~~~~
+
+Aside from shell API libraries in :master:`testcases/lib` directory, it's
+worth putting common code for a group of tests into a shell library.
+The filename should end with ``_lib.sh`` and the library should load
+``tst_test.sh`` or ``tst_net.sh``.
+
+Shell libraries should have conditional expansion for ``TST_SETUP`` or
+``TST_CLEANUP``, to avoid surprises when test specific setup/cleanup function is
+redefined by shell library.
+
+.. code-block:: bash
+
+    # ipsec_lib.sh
+    # SPDX-License-Identifier: GPL-2.0-or-later
+    TST_SETUP="${TST_SETUP:-ipsec_lib_setup}"
+    ...
+    . tst_test.sh
diff --git a/doc/developers/setup_mailinglist.rst b/doc/developers/setup_mailinglist.rst
new file mode 100644
index 000000000..1eee0ae9f
--- /dev/null
+++ b/doc/developers/setup_mailinglist.rst
@@ -0,0 +1,50 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Setting up the Mailing list
+===========================
+
+Before using ``git send-email``, you need to set up your email client to send
+emails from the command line. This typically involves configuring an SMTP server
+and authentication details.
+
+Open a terminal and configure Git with your email settings using the following
+commands:
+
+.. code-block:: bash
+
+    git config --global sendemail.from "Your Name <your_email@example.com>"
+    git config --global sendemail.smtpserver "smtp.example.com"
+    git config --global sendemail.smtpuser "your_email@example.com"
+    git config --global sendemail.smtpserverport 587
+    git config --global sendemail.smtpencryption tls
+
+Replace ``smtp.example.com`` with the SMTP server address provided by your email
+provider. Replace ``your_email@example.com`` with your email address. Adjust the
+SMTP port and encryption settings according to your email provider's
+requirements.
+
+To test the configuration you can use ``--dry-run`` parameter.
+
+.. code-block:: bash
+
+    git send-email --dry-run --to "ltp@lists.linux.it" --subject "Test Email" --body "This is a test email." HEAD^
+
+Depending on your SMTP server's configuration, you may need to authenticate
+before sending emails. If required, configure authentication settings using:
+
+.. code-block:: bash
+
+    git config --global sendemail.smtpuser "your_email@example.com"
+    git config --global sendemail.smtppass "your_password"
+
+Replace ``your_email@example.com`` with your email address and ``your_password``
+with your email account password.
+
+For any corner case, please take a look at the
+`email + git <https://git-send-email.io/>`_ documentation.
+
+.. note::
+
+    This method still works in most of the cases, but nowadays we often
+    require to setup a two factor authentication. If this is the case, please
+    consider setting up Git accordingly.
diff --git a/doc/developers/test_case_tutorial.rst b/doc/developers/test_case_tutorial.rst
new file mode 100644
index 000000000..be9a0ea8b
--- /dev/null
+++ b/doc/developers/test_case_tutorial.rst
@@ -0,0 +1,1033 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Test case tutorial
+==================
+
+This is a step-by-step tutorial on writing a simple C LTP test, where topics
+of the LTP and Linux kernel testing will be introduced gradually using a
+concrete example. Most sections will include exercises, some trivial and
+others not so much. If you find an exercise is leading you off at too much of
+a tangent, just leave it for later and move on.
+
+LTP tests can be written in C or Shell script. This tutorial is **only for tests
+written in C** using the new LTP test API. Note that while we go into some
+detail on using Git, this is not intended as a canonical or complete guide
+for Git.
+
+Assumptions & Feedback
+----------------------
+
+We assume the reader is familiar with C, Git and common Unix/Linux/GNU tools
+and has some general knowledge of Operating Systems. Experienced Linux
+developers may find it too verbose while people new to system level Linux
+development may find it overwhelming.
+
+Comments and feedback are welcome, please direct them to the Mailing list.
+
+Getting Started
+---------------
+
+First of all, make sure you have a copy of LTP in the current folder
+and we recommended cloning the Linux kernel repository for reference, this
+guide will refer to files and directories.
+
+.. code-block:: bash
+
+    git clone git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git
+
+There are a number of other repositories which are useful for reference as
+well, including the GNU C library ``glibc`` and the alternative C library
+``musl``. Some system calls are partially or even entirely implemented in user
+land as part of the standard C library. So in these cases, the C library is an
+important reference. ``glibc`` is the most common C library for Linux, however
+``musl`` is generally easier to understand.
+
+How system calls are implemented varies from one architecture to another and
+across kernel and C library versions. To find out whether a system call is
+actually accessing the kernel (whether it is actually a system call) on any
+given machine you can use the ``strace`` utility. This intercepts system calls
+made by an executable and prints them. We will use this later in the tutorial.
+
+Choose a System Call to test
+----------------------------
+
+We will use the ``statx()`` system call, to provide a concrete example of a
+test. At the time of writing there is no test for this call which was
+introduced in Linux kernel version 4.11.
+
+Linux system call specific tests are primarily contained in
+:master:`testcases/kernel/syscalls`, but you should also :git_man:`grep` the
+entire LTP repository to check for any existing usages of a system call.
+
+One way to find a system call which is not currently tested by the LTP is to
+look at :kernel_tree:`include/linux/syscalls.h` in the Linux kernel tree.
+
+Something the LTP excels to ensure bug-fixes are back ported to
+maintenance releases, so targeting a specific regression is another
+option.
+
+Find an untested System call
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Try to find an untested system call which has a manual page (i.e. ``man
+syscall`` produces a result). It is a good idea to Git-clone the latest kernel
+man-pages repository.
+
+.. code-block:: bash
+
+    git clone git://git.kernel.org/pub/scm/docs/man-pages/man-pages.git
+
+At the time of writing, the difference between the latest man-pages release and
+the ``HEAD`` of the repository (usually the latest commit) is well over 100
+commits. This represents about 9 weeks of changes. If you are using a stable
+Linux distribution, your man-pages package may well be years old. So as with
+the kernel, it is best to have the Git repository as a reference.
+
+You could also find a system call with untested parameters or use whatever it
+is you are planning to use the LTP for.
+
+Create the test skeleton
+------------------------
+
+I shall call my test ``statx01.c``, by the time you read this that file name
+will probably be taken, so increment the number in the file name as
+appropriate or replace ``statx`` with the system call in the chosen exercise.
+
+.. code-block:: bash
+
+    mkdir testcases/kernel/syscalls/statx
+    cd testcases/kernel/syscalls/statx
+    echo statx >> .gitignore
+
+Next open ``statx01.c`` and add the following boilerplate. Make sure to change
+the copyright notice to your name/company, correct the test name and minimum
+kernel version if necessary. I will explain what the code does below.
+
+.. code-block:: c
+
+    // SPDX-License-Identifier: GPL-2.0-or-later
+    /*
+    * Copyright (c) 2017 Instruction Ignorer <"can't"@be.bothered.com>
+    */
+
+    /*\
+    * [Description]
+    *
+    * All tests should start with a description of _what_ we are testing.
+    * Non-trivial explanations of _how_ the code works should also go here.
+    * Include relevant links, Git commit hashes and CVE numbers.
+    * Inline comments should be avoided.
+    */
+
+    #include "tst_test.h"
+
+    static void run(void)
+    {
+        tst_res(TPASS, "Doing hardly anything is easy");
+    }
+
+    static struct tst_test test = {
+        .test_all = run,
+        .min_kver = "4.11",
+    };
+
+Starting with the ``#include`` statement we copy in the main LTP test library
+headers. This includes the most common test API functions and the test harness
+initialization code. It is important to note that this is a completely
+ordinary, independent C program, however ``main()`` is missing because it is
+implemented in ``tst_test.h``.
+
+We specify what code we want to run as part of the test using the ``tst_test
+test`` structure. Various callbacks can be set by the test writer, including
+``test.test_all``, which we have set to ``run()``. The test harness will execute
+this callback in a separate process (using ``fork()``), forcibly terminating it
+if it does not return after ``test.timeout`` seconds.
+
+We have also set ``test.min_kver`` to the kernel version where ``statx`` was
+introduced. The test library will determine the kernel version at runtime. If
+the version is less than 4.11 then the test harness will return ``TCONF``,
+indicating that this test is not suitable for the current system
+configuration.
+
+Occasionally features are back ported to older kernel versions, so ``statx`` may
+exist on kernels with a lower version. However we don't need to worry about
+that unless there is evidence of it happening.
+
+As mentioned in the code itself, you should specify what you are testing and
+the expected outcome, even if it is relatively simple. If your program flow is
+necessarily complex and difficult to understand (which is often the case when
+trying to manipulate the kernel into doing something bad), then a detailed
+explanation of how the code works is welcome.
+
+What you should not do, is use inline comments or include the same level of
+explanation which is written here. As a general rule, if something is easy to
+document, then the code should also be easy to read. So don't document the easy
+stuff (except for the basic test specification).
+
+Before continuing we should compile this and check that the basics work. In
+order to compile the test we need a ``Makefile`` in the same subdirectory. If
+one already exists, then nothing needs to be done, otherwise add one with the
+following contents.
+
+.. code-block:: make
+
+    # SPDX-License-Identifier: GPL-2.0-or-later
+    # Copyright (c) 2019 Linux Test Project
+
+    top_srcdir		?= ../../../..
+
+    include $(top_srcdir)/include/mk/testcases.mk
+
+    include $(top_srcdir)/include/mk/generic_leaf_target.mk
+
+This will automatically add ``statx01.c`` as a build target producing a
+``statx01`` executable. Unless you have heavily deviated from the tutorial, and
+probably need to change ``top_srcdir``, nothing else needs to be done.
+
+Normally, if you were starting a Makefile from scratch, then you would need to
+add ``statx01`` as a build target. Specifying that you would like to run some
+program (e.g. ``gcc`` or ``clang``) to transform ``statx01.c`` into ``statx01``.
+Here we don't need to do that, but sometimes it is still necessary. For example,
+if we needed to link to the POSIX threading library, then we could add the
+following line after ``testcases.mk``.
+
+.. code-block:: make
+
+    statx01: CFLAGS += -pthread
+
+Assuming you are in the test's subdirectory :master:`testcases/kernel/syscalls/statx`,
+please do:
+
+.. code-block:: bash
+
+    make
+    ./statx01
+
+This should build the test and then run it. However, even though the test is
+in :master:`testcases/kernel/syscalls` directory it won't be automatically ran
+as part of the syscalls test group (e.g. not run via ``kirk -r math`` or
+``./runltp -f syscalls``). For this we need to add it to the runtest file. So
+open :master:`runtest/syscalls` and add the lines starting with a ``+``.
+
+.. code-block::
+
+    statvfs01 statvfs01
+    statvfs02 statvfs02
+
+    +statx01 statx01
+    +
+    stime01 stime01
+    stime02 stime02
+
+The :master:`runtest` files are in a two column format. The first column is the
+test name, which is mainly used by test runners for reporting and filtering. It
+is just a single string of text with no spaces. The second column, which can
+contain spaces, is passed to the shell in order to execute the test. Often it
+is just the executable name, but some tests also take arguments (the LTP has a
+library for argument parsing, by the way).
+
+If you haven't done so already, we should add all these new files to Git. It
+is vitally important that you do not make changes to the master branch. If you
+do then pulling changes from upstream becomes a major issue. So first of all
+create a new branch.
+
+.. code-block:: bash
+
+    git checkout -b statx01 master
+
+Now we want to add the files we have created or modified, but before doing a
+commit make sure you have configured Git correctly. You need to at least set
+your Name and e-mail address in ``~/.gitconfig``, but there are some other
+settings which come in handy too. My relatively simple configuration is similar
+to the below:
+
+.. code-block:: ini
+
+    [user]
+        name = Sarah Jane
+        email = sjane@e-mail.address
+    [core]
+        editor = emacs
+    [sendemail]
+        smtpServer = smtp.server.address
+
+Obviously you need to at least change your name and e-mail. The SMTP server is
+useful for :git_man:`send-email`, which we will discuss later. The editor value is
+used for things like writing commits (without the ``-m`` option).
+
+.. code-block:: bash
+
+    git add -v :/testcases/kernel/syscalls/statx :/runtest/syscalls
+    git commit -m "statx01: Add new test for statx syscall"
+
+This should add all the new files in the ``statx`` directory and the ``runtest``
+file. It is good practice to commit early and often. Later on we will do a
+Git-rebase, which allows us to clean up the commit history. So don't worry
+about how presentable your commit log is for now. Also don't hesitate to
+create a new branch when doing the exercises or experimenting. This will allow
+you to diverge from the tutorial and then easily come back again.
+
+I can't emphasize enough that Git makes things easy through branching and that
+things quickly get complicated if you don't do it. However if you do get into
+a mess, Git-reflog and Git-reset, will usually get you out of it. If you also
+mess that up then it may be possible to cherry pick 'dangling' commits out of
+the database into a branch.
+
+Report TCONF instead of TPASS
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Maybe the test should report ``TCONF: Not implemented`` instead or perhaps
+``TBROK``. Try changing it do so.
+
+Check Git ignores the executable
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Is your ``.gitignore`` correct?
+
+Run make check
+~~~~~~~~~~~~~~~~~~
+
+Check coding style with ``make check``.
+
+Install the LTP and run the test with runtest
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Run ``statx01`` on its own, also using ``-I0`` amd ``-I10``.
+
+Call the system call
+--------------------
+
+At the time of writing ``statx`` has no ``glibc`` wrapper. It is also fairly common
+for a distribution's C library version to be older than its kernel or it may use a
+cut down C library in comparison to the GNU one. So we must call ``statx()``
+using the general ``syscall()`` interface.
+
+The LTP contains a library for dealing with the ``syscall`` interface, which is
+located in :master:`include/lapi`. System call numbers are listed against the relevant
+call in the ``*.in`` files (e.g. ``x86_64.in``) which are used to generate
+``syscalls.h``, which is the header you should include. On rare occasions you
+may find the system call number is missing from the ``*.in`` files and will need
+to add it (see :master:`include/lapi/syscalls/strip_syscall.awk`).
+
+System call numbers vary between architectures, hence there are multiple
+``*.in`` files for each architecture. You can find the various values for the
+``statx`` system call across a number of ``unistd.h`` files in the Linux kernel.
+
+Note that we don't use the system-call-identifier value available in
+``/usr/include/linux/uinstd.h`` because the kernel might be much newer than the
+user land development packages.
+
+For ``statx`` we had to add ``statx 332`` to :master:`include/lapi/syscalls/x86_64.in`,
+``statx 383`` to :master:`include/lapi/syscalls/powerpc.in`, etc.  Now lets look at
+the code, which I will explain in more detail further down.
+
+.. code-block:: c
+
+    /*
+    * Test statx
+    *
+    * Check if statx exists and what error code it returns when we give it dodgy
+    * data.
+    */
+
+    #include <stdint.h>
+    #include "tst_test.h"
+    #include "lapi/syscalls.h"
+
+    struct statx_timestamp {
+        int64_t	       tv_sec;
+        uint32_t       tv_nsec;
+        int32_t	       __reserved;
+    };
+
+    struct statx {
+        uint32_t	stx_mask;
+        uint32_t	stx_blksize;
+        uint64_t	stx_attributes;
+        uint32_t	stx_nlink;
+        uint32_t	stx_uid;
+        uint32_t	stx_gid;
+        uint16_t	stx_mode;
+        uint16_t	__spare0[1];
+        uint64_t	stx_ino;
+        uint64_t	stx_size;
+        uint64_t	stx_blocks;
+        uint64_t	stx_attributes_mask;
+        struct statx_timestamp	stx_atime;
+        struct statx_timestamp	stx_btime;
+        struct statx_timestamp	stx_ctime;
+        struct statx_timestamp	stx_mtime;
+        uint32_t	stx_rdev_major;
+        uint32_t	stx_rdev_minor;
+        uint32_t	stx_dev_major;
+        uint32_t	stx_dev_minor;
+        uint64_t	__spare2[14];
+    };
+
+    static int sys_statx(int dirfd, const char *pathname, int flags,
+                unsigned int mask, struct statx *statxbuf)
+    {
+        return tst_syscall(__NR_statx, dirfd, pathname, flags, mask, statxbuf);
+    }
+
+    ...
+
+So the top part of the code is now boiler plate for calling ``statx``. It is
+common for the kernel to be newer than the user land libraries and headers. So
+for new system calls like ``statx``, we copy, with a few modifications, the
+relevant definitions into the LTP. This is somewhat like 'vendoring', although
+we are usually just copying headers required for interacting with the Kernel's
+ABI (Application Binary Interface), rather than integrating actual
+functionality.
+
+So from the top we include the ``stdint.h`` library which gives us the standard
+``(u)int*_t`` type definitions. We use these in place of the Kernel type
+definitions such as ``__u64`` in ``linux/types.h``. We then have a couple of
+structure definitions which form part of the ``statx`` API. These were copied
+from :kernel_tree:`include/uapi/linux/stat.h` in the Linux kernel tree.
+
+After that, there is a wrapper function, which saves us from writing
+``tst_syscall(__NR_statx, ...``, every time we want to make a call to
+``statx``. This also provides a stub for when ``statx`` is eventually integrated
+into the LTP library and also implemented by the C library. At that point we
+can switch to using the C library implementation if available or fallback to
+our own.
+
+The advantage of using the C library implementation is that it will often be
+better supported across multiple architectures. It will also mean we are using
+the system call in the same way most real programs would. Sometimes there are
+advantages to bypassing the C library, but in general it should not be our
+first choice.
+
+The final test should do a check during configuration (i.e. when we run
+``./configure`` before building) which checks if the ``statx`` system call and
+associated structures exists. This requires writing an ``m4`` file for use with
+:master:`configure.ac` which is processed during ``make autotools`` and produces the
+configure script.
+
+For the time being though we shall just ignore this. All you need to know for
+now is that this is a problem which eventually needs to be dealt with and that
+there is a system in place to handle it.
+
+.. code-block:: c
+
+    ...
+
+    static void run(void)
+    {
+        struct statx statxbuf = { 0 };
+
+        TEST(sys_statx(0, NULL, 0, 0, &statxbuf));
+
+        if (TST_RET == 0)
+            tst_res(TFAIL, "statx thinks it can stat NULL");
+        else if (TST_ERR == EFAULT)
+            tst_res(TPASS, "statx set errno to EFAULT as expected");
+        else
+            tst_res(TFAIL | TERRNO, "statx set errno to some unexpected value");
+    }
+
+    static struct tst_test test = {
+        .test_all = run,
+        .min_kver = "4.11",
+    };
+
+The ``TEST`` macro sets ``TST_RET`` to the return value of ``tst_statx()`` and
+``TST_ERR`` to the value of ``errno`` immediately after the functions
+return. This is mainly just for convenience, although it potentially could
+have other uses.
+
+We check whether the return value indicates success and if it doesn't also
+check the value of ``errno``. The last call to ``tst_res`` includes ``TERRNO``,
+which will print the current error number and associated description in
+addition to the message we have provided. Note that it uses the current value
+of ``errno`` not ``TST_ERR``.
+
+What we should have done in the example above is use ``TTERRNO`` which takes the
+value of ``TST_ERR``.
+
+If we try to run the test on a kernel where ``statx`` does not exist, then
+``tst_syscall`` will cause it to fail gracefully with ``TCONF``. Where ``TCONF``
+indicates the test is not applicable to our configuration.
+
+The function ``tst_syscall`` calls ``tst_brk(TCONF,...)`` on failure. ``tst_brk``
+causes the test to exit immediately, which prevents any further test code from
+being run.
+
+What are the differences between ``tst_brk`` and ``tst_res``?
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+See :master:`include/tst_test.h`. Also what do they have in common?
+
+What happens if you call ``tst_res(TINFO, ...)`` after ``sys_statx``?
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Does the test still function correctly?
+
+Extend the test to handle other basic error conditions
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+For example, see if you can trigger ``ENOENT`` instead. You shouldn't
+have to create any files, which is discussed in the next section.
+
+Setup, Cleanup and files
+------------------------
+
+Some tests require resources to be allocated, or system settings to be
+changed, before the test begins. This ``setup`` only has to be done once at the
+beginning and at the end of the test needs to be removed or reverted. The
+``cleanup`` also has to be done regardless of whether the test breaks.
+
+Fortunately, like most test libraries, we have setup and cleanup (teardown)
+callbacks. ``setup`` is called once before ``run`` and ``cleanup`` is called once
+afterwards. Note that ``run`` itself can be called multiple times by the test
+harness, but that ``setup`` and ``cleanup`` are only called once.
+
+If either your code, a ``SAFE_*`` macro or a library function such as
+``tst_syscall`` call ``tst_brk``, then ``run`` will exit immediately and the
+``cleanup`` function is then called. Once ``cleanup`` is completed, the test
+executable will then exit altogether abandoning any remaining iterations of
+``run``.
+
+For ``statx`` we would like to create some files or file like objects which we
+have control over. Deciding where to create the files is easy, we just create
+it in the current working directory and let the LTP test harness handle where
+that should be by setting ``.needs_tmpdir = 1``.
+
+.. code-block:: c
+
+    /*
+    * Test statx
+    *
+    * Check if statx exists and what error code it returns when we give it dodgy
+    * data. Then stat a file and check it returns success.
+    */
+
+    #include <stdint.h>
+    #include "tst_test.h"
+    #include "lapi/syscalls.h"
+    #include "lapi/fcntl.h"
+
+    #define FNAME "file_to_stat"
+    #define STATX_BASIC_STATS 0x000007ffU
+
+    /*************** statx structure and wrapper goes here ! ***************/
+    ...
+
+We have added an extra include :master:`lapi/fcntl.h` which wraps the system header by
+the same name (``#include <fcntl.h>``). This header ensures we have definitions
+for recently added macros such as ``AT_FDCWD`` by providing fall backs if the
+system header does not have them. The :master:`lapi/` directory contains a number of
+headers like this.
+
+At some point we may wish to add :master:`lapi/stat.h` to provide a fall back for
+macros such as ``STATX_BASIC_STATS``. However for the time being we have just
+defined it in the test.
+
+
+.. code-block:: c
+
+    ...
+
+    static void setup(void)
+    {
+        SAFE_TOUCH(FNAME, 0777, NULL);
+    }
+
+    static void run(void)
+    {
+        struct statx statxbuf = { 0 };
+
+        TEST(sys_statx(0, NULL, 0, 0, &statxbuf));
+        if (TST_RET == 0)
+            tst_res(TFAIL, "statx thinks it can stat NULL");
+        else if (TST_ERR == EFAULT)
+            tst_res(TPASS, "statx set errno to EFAULT as expected");
+        else
+            tst_res(TFAIL | TERRNO, "statx set errno to some unexpected value");
+
+        TEST(sys_statx(AT_FDCWD, FNAME, 0, STATX_BASIC_STATS, &statxbuf));
+        if (TST_RET == 0)
+            tst_res(TPASS, "It returned zero so it must have worked!");
+        else
+            tst_res(TFAIL | TERRNO, "statx can not stat a basic file");
+    }
+
+    static struct tst_test test = {
+        .setup = setup,
+        .test_all = run,
+        .min_kver = "4.11",
+        .needs_tmpdir = 1
+    };
+
+The ``setup`` callback uses one of the LTP's ``SAFE`` functions to create an empty
+file ``file_to_stat``. Because we have set ``.needs_tmpdir``, we can just create
+this file in the present working directory. We don't need to create a
+``cleanup`` callback yet because the LTP test harness will recursively delete
+the temporary directory and its contents.
+
+The ``run`` function can be called multiple times by the test harness, however
+``setup`` and ``cleanup`` callbacks will only be ran once.
+
+.. warning::
+
+    By this point you may have begun to explore the LTP library headers or older
+    tests. In which case you will have come across functions from the old API such
+    as ``tst_brkm``. The old API is being phased out, so you should not use these
+    functions.
+
+So far we haven't had to do any clean up. So our example doesn't answer the
+question "what happens if part of the clean up fails?". To answer this we are
+going to modify the test to ask the (highly contrived) question "What happens
+if I create and open a file, then create a hard-link to it, then call open
+again on the hard-link, then ``stat`` the file".
+
+
+.. code-block:: c
+
+    #define LNAME "file_to_stat_link"
+
+    ...
+
+    static void setup(void)
+    {
+        fd = SAFE_OPEN(FNAME, O_CREAT, 0777);
+        SAFE_LINK(FNAME, LNAME);
+        lfd = SAFE_OPEN(LNAME, 0);
+    }
+
+    static void cleanup(void)
+    {
+        if (lfd != 0)
+            SAFE_CLOSE(lfd);
+
+        if (fd != 0)
+            SAFE_CLOSE(fd);
+    }
+
+    static void run(void)
+    {
+            ...
+
+        TEST(sys_statx(AT_FDCWD, LNAME, 0, STATX_BASIC_STATS, &statxbuf));
+        if (TST_RET == 0)
+            tst_res(TPASS, "It returned zero so it must have worked!");
+        else
+            tst_res(TFAIL | TERRNO, "statx can not stat a basic file");
+    }
+
+    static struct tst_test test = {
+        .setup = setup,
+        .cleanup = cleanup,
+        .test_all = run,
+        .tcnt = 2,
+        .min_kver = "4.11",
+        .needs_tmpdir = 1
+    };
+
+Because we are now opening a file, we need a ``cleanup`` function to close the
+file descriptors. We have to manually close the files to ensure the temporary
+directory is deleted by the test harness (see :doc:`writing_tests` for details).
+
+As a matter of good practice, the file descriptors are closed in reverse
+order. In some circumstances the order which ``cleanup`` is performed is
+significant. In those cases, resources created towards the end of ``setup`` are
+dependent to ones near the beginning. During ``cleanup`` we remove the
+dependants before their dependencies.
+
+If, for some reason, the file descriptor ``lfd`` became invalid during the test,
+but ``fd`` was still open, we do not want ``SAFE_CLOSE(lfd)`` to cause the
+``cleanup`` function to exit prematurely. If it did, then ``fd`` would remain
+open which would cause problems on some file systems.
+
+Nor do we want to call ``cleanup`` recursively. So during ``cleanup``
+``tst_brk``, and consequently the ``SAFE`` functions, do not cause the test to
+exit with ``TBROK``. Instead they just print an error message with ``TWARN``.
+
+It is not entirely necessary to check if the file descriptors have a none zero
+value before attempting to close them. However it avoids a bunch of spurious
+warning messages if we fail to open ``file_to_stat``. Test case failures can be
+difficult to interpret at the best of times, so avoid filling the log with
+noise.
+
+Check ``statx`` returns the correct number of hard links
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+The field ``statx.stx_nlink`` should be equal to 2, right?
+
+Git-branch
+~~~~~~~~~~
+
+We are about to make some organizational changes to the test, so now would be
+a good time to branch. Then we can switch between the old and new versions, to
+check the behavior has not been changed by accident.
+
+Split the test
+--------------
+
+In our current test, we have essentially rolled two different test cases into
+one. Firstly we check if an error is returned when bad arguments are provided
+and secondly we check what happens when we stat an actual file. Quite often it
+makes sense to call ``tst_res`` multiple times in a single test case because we
+are checking different properties of the same result, but here we are clearly
+testing two different scenarios.
+
+So we should split the test in two. One obvious way to do this is to create
+``statx02.c``, but that seems like overkill in order to separate two simple test
+cases. So, for now at least, we are going to do it a different way.
+
+.. code-block:: c
+
+    ...
+
+    static void run_stat_null(void)
+    {
+        struct statx statxbuf = { 0 };
+
+        TEST(sys_statx(0, NULL, 0, 0, &statxbuf));
+        if (TST_RET == 0)
+            tst_res(TFAIL, "statx thinks it can stat NULL");
+        else if (TST_ERR == EFAULT)
+            tst_res(TPASS, "statx set errno to EFAULT as expected");
+        else
+            tst_res(TFAIL | TERRNO, "statx set errno to some unexpected value");
+    }
+
+    static void run_stat_symlink(void)
+    {
+        struct statx statxbuf = { 0 };
+
+        TEST(sys_statx(AT_FDCWD, LNAME, 0, STATX_BASIC_STATS, &statxbuf));
+        if (TST_RET == 0)
+            tst_res(TPASS, "It returned zero so it must have worked!");
+        else
+            tst_res(TFAIL | TERRNO, "statx can not stat a basic file");
+    }
+
+    static void run(unsigned int i)
+    {
+        switch(i) {
+        case 0: run_stat_null();
+        case 1: run_stat_symlink();
+        }
+    }
+
+    static struct tst_test test = {
+        .setup = setup,
+        .cleanup = cleanup,
+        .test = run,
+        .tcnt = 2,
+        .min_kver = "4.11",
+        .needs_tmpdir = 1
+    };
+
+So we have used an alternative form of the ``test`` or ``run`` callback which
+accepts an index. Some tests use this index with an array of parameters and
+expected return values. Others do something similar to the above. The index
+can be used how you want so long as each iteration calls ``tst_res`` in a
+meaningful way.
+
+If an iteration fails to return a result (i.e. call ``tst_res`` with a value
+other than ``TINFO``) then the test harness will report ``TBROK`` and print the
+iteration which failed. This prevents a scenario in your test from silently
+failing due to some faulty logic.
+
+What is wrong with the switch statement?
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Were you paying attention? Also see the output of ``make check``.
+
+Test a feature unique to statx
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+So far we have not tested anything which is unique to ``statx``. So, for
+example, you could check stx_btime is correct (possibly only to within a
+margin of error) and that it differs from ``stx_mtime`` after writing to the
+file.
+
+Alternatively you could check that ``stx_dev_major`` and ``stx_dev_minor`` are set
+correctly. Note that the LTP has helper functions for creating devices and
+file systems.
+
+This could be quite a challenging exercise. You may wish to tackle an
+altogether different test scenario instead. If you get stuck just move onto
+the next section and come back later.
+
+Submitting the test for review
+------------------------------
+
+Ignoring the fact we should probably create :master:`lapi/stat.h` along with a bunch
+of fallback logic in the build system. We can now get our test ready for
+submission.
+
+The first thing you need to do before considering submitting your test is run
+``make check-statx01`` or ``make check`` in the test's directory. Again, we use
+the kernel style guidelines where possible. Next you should create a new
+branch, this will allow you to reshape your commit history without fear.
+
+After that we have the pleasure of doing an interactive ``rebase`` to clean up
+our commit history. In its current form the test only really needs a single
+commit, but if you have been using Git correctly then you should have
+many. The main reason we want to compress it to a single commit, is to make
+the LTP's Git-log readable. It also allows us to write a coherent description
+of the work as a whole in retrospective. Although, when adding a new test, the
+test description in the code will probably make the commit message redundant.
+
+Anyway, as an example, we shall look at my personal commit history from this
+tutorial and ``rebase`` it. You should try following along with your own
+repository. First lets look at the commit history since we branched from
+master.
+
+.. code-block:: bash
+
+    git log --oneline master..HEAD
+    152d39fe7 (HEAD -> tutorial-rebase2, tutorial-rebase) tutorial: Start Submitting patch section
+    70f7ce7ce statx01: Stop checkpatch from complaining
+    bb0332bd7 tutorial: Fix review problems
+    6a87a084a statx01: Fix review problems
+    d784b1e85 test-writing-guidelines: Remove old API argument
+    c26e1be7a fixup! tutorial
+    1e24a5fb5 (me/tutorial-rebase) fixup! tutorial
+    568a3f7be fixup! tutorial
+    09dd2c829 statx: stage 6
+    bfeef7902 statx: stage 5b
+    76e03d714 statx: stage 5a
+    98f5bc7ac statx: stage 4
+    6f8c16438 statx: stage 3 (Add statx01)
+    5d93b84d8 Add statx and other syscall numbers
+    5ca627b78 tutorial: Add a step-by-step C test tutorial
+
+So we have told git to show all the commits which don't exist in ``master``, but
+are in ``HEAD``, where ``HEAD`` is the top of the current branch. The current
+branch is ``tutorial-rebase2`` which I just created. I have already done one
+``rebase`` and submitted a patch for review, so my original branch was just called
+``tutorial``.
+
+As usual my commit history is starting to look like a bit of mess! There is
+even a commit in there which should not be in the this branch (Remove old API
+argument), however it can be ignored for now and 'cherry picked' into a new branch
+later.
+
+For my patch I actually need at least two commits, one which contains the
+tutorial text and one which contains the test and associated files. So first
+of all I want to 'squash' (amalgamate) all the commits appended with
+``tutorial:`` into the bottom commit.
+
+.. code-block:: bash
+
+    $ git rebase -i 5ca627b78\^
+    ...
+
+This begins an interactive ``rebase`` where commit ``5ca6427b78`` is the earliest
+commit we want to edit. The ``^`` symbol after the commit hash, specifies the
+commit before this one. The interactive ``rebase`` command takes the last commit
+we want to keep unaltered as it's argument (in other words it takes a
+non-inclusive range).
+
+Upon entering a similar command you will be presented with a text file
+similar to the following. The file should be displayed in your text editor of
+choice, if it doesn't, then you may change the editor variable in
+``.gitconfig``.
+
+.. code-block:: bash
+
+    pick 5ca627b78 tutorial: Add a step-by-step C test tutorial
+    pick 5d93b84d8 Add statx and other syscall numbers
+    pick 6f8c16438 statx: stage 3 (Add statx01)
+    pick 98f5bc7ac statx: stage 4
+    pick 76e03d714 statx: stage 5a
+    pick bfeef7902 statx: stage 5b
+    pick 09dd2c829 statx: stage 6
+    pick 568a3f7be fixup! tutorial
+    pick 1e24a5fb5 fixup! tutorial
+    pick c26e1be7a fixup! tutorial
+    pick d784b1e85 test-writing-guidelines: Remove old API argument
+    pick 6a87a084a statx01: Fix review problems
+    pick bb0332bd7 tutorial: Fix review problems
+    pick 70f7ce7ce statx01: Stop checkpatch from complaining
+    pick 152d39fe7 tutorial: Start Submitting patch section
+
+The last commit from Git-log is shown at the top. The left hand column
+contains the commands we want to run on each commit. ``pick`` just means we
+re-apply the commit as-is. We can reorder the lines to apply the commits in a
+different order, but we need to be careful when reordering commits to the same
+file. If your ``rebase`` results in a merge conflict, then you have probably
+reordered some commits which contained changes to the same piece of code.
+
+Perhaps a better name for the interactive ``rebase`` command would be 'replay'. As
+we pick a point in the commit history, undo all those commits before that
+point, then reapply them one at a time. During the replay we can reorder the
+commits, drop, merge, split and edit them, creating a new history.
+
+The commands I am going to use are ``reword`` and ``fixup``. The ``reword`` command
+allows you to edit a single commit's message. The 'fixup' command 'squashes' a
+commit into the commit above/preceding it, merging the two commits into
+one. The commit which has ``fixup`` applied has its commit message deleted. If
+you think a commit might have something useful in its message then you can use
+``squash`` instead.
+
+.. code-block:: bash
+
+    reword 5ca627b78 tutorial: Add a step-by-step C test tutorial
+    fixup 568a3f7be fixup! tutorial
+    fixup 1e24a5fb5 fixup! tutorial
+    fixup c26e1be7a fixup! tutorial
+    fixup bb0332bd7 tutorial: Fix review problems
+    fixup 152d39fe7 tutorial: Start Submitting patch section
+    fixup 276edecab tutorial: Save changes before rebase
+    pick 5d93b84d8 Add statx and other syscall numbers
+    pick 6f8c16438 statx: stage 3 (Add statx01)
+    pick 98f5bc7ac statx: stage 4
+    pick 76e03d714 statx: stage 5a
+    pick bfeef7902 statx: stage 5b
+    pick 09dd2c829 statx: stage 6
+    pick d784b1e85 test-writing-guidelines: Remove old API argument
+    pick 6a87a084a statx01: Fix review problems
+
+So all the commits marked with ``fixup`` will be re-played by Git immediately
+after 5ca62 at the top. A new commit will then be created with the amalgamated
+changes of all the commits and 5ca62's log message. It turns out that I didn't
+need to reword anything, but there is no harm in checking. It is easy to
+forget the ``Signed-off-by:`` line.
+
+I could now do the same for the commits to the ``statx`` test, making the commit
+message prefixes consistent. However I am not actually going to submit the
+test (yet).
+
+I won't attempt to show you this, but if you need to do the opposite and split
+apart a commit. It is also possible using Git-rebase by marking a line with
+``edit``. This will pause Git just after replaying the marked commit. You can
+then use a 'soft' Git-reset to bring the selected commit's changes back into
+the 'index' where you are then able to un-stage some parts before
+re-committing.
+
+You can also use ``edit`` and ``git commit --amend`` together to change a commit
+deep in your history, but without resetting the 'index'. The 'index' contains
+changes which you have staged with :git_man:`add`, but not yet committed.
+
+So now that the commit history has been cleaned up, we need to submit a patch
+to the mailing list or make a pull request on GitHub. The mailing list is the
+preferred place to make submissions and is more difficult for most people, so
+I will only cover that method.
+
+Just before we create the patch, we need to check that our changes will still
+apply to the master branch without problems. To do this we can use another
+type of ``rebase`` and then try rebuilding and running the test.
+
+.. code-block:: bash
+
+    git checkout master
+    git pull origin
+    git checkout tutorial-rebase2
+    git rebase master
+
+Above, I update the master branch and then replay our changes onto it using
+``git rebase master``. You may find that after the rebase there is a merge
+conflict. This will result in something which looks like the following (taken
+from a Makefile conflict which was caused by reordering commits in a ``rebase``).
+
+.. code-block:: diff
+
+    <<<<<<< HEAD
+    cve-2016-7117:	LDFLAGS += -lpthread
+    =======
+    cve-2014-0196:	LDFLAGS += -lpthread -lutil -lrt
+    cve-2016-7117:	LDFLAGS += -lpthread -lrt
+    >>>>>>> 4dbfb8e79... Add -lrt
+
+The first line tells us this is the beginning of a conflict. The third line
+separates the two conflicting pieces of content and the last line is the end
+of the conflict. Usually, all you need to do is remove the lines you don't
+want, stage the changes and continue the ``rebase`` with ``git rebase
+--continue``.
+
+In order to create a patch e-mail we use :git_man:`format-patch`,
+we can then send that e-mail using :git_man:`send-email`.
+It is also possible to import the patch (``mbox``) file into a number of e-mail
+programs.
+
+.. code-block:: bash
+
+    $ git format-patch -1 -v 2 -o output --to ltp@lists.linux.it fd3cc8596
+    output/v2-0001-tutorial-Add-a-step-by-step-C-test-tutorial.patch
+
+The first argument ``-1`` specifies we want one commit from fd3cc8596
+onwards. If we wanted this commit and the one after it we could specify ``-2``
+instead.
+
+This is my second patch submission so I have used ``-v 2``, which indicates this
+is the second version of a patch set. The ``-o`` option specifies the output
+directory (literally called ``output``). The ``--to`` option adds the ``To:`` e-mail
+header, which I have set to the LTP mailing list.
+
+We can then send this patch with the following command sans ``--dry-run``.
+
+.. code-block:: bash
+
+    git send-email --dry-run output/v2-0001-tutorial-Add-a-step-by-step-C-test-tutorial.patch
+
+Git will ask some questions (which you can ignore) and then tell you what it
+would do if this weren't a dry-run. In order for this to work you have to have
+a valid SMTP server set in ``.gitconfig`` and also be signed up to the LTP
+mailing list under the same e-mail address you have configured in Git. You can
+sign up at https://lists.linux.it/listinfo/ltp.
+
+Doing code review
+-----------------
+
+While waiting for your test to be reviewed, you are invited and encouraged to
+review other contributors' code. This may seem bizarre when you are completely
+new to the project, but there are two important ways in which you can
+contribute here:
+
+A.   Point out logical errors in the code.
+B.   Improve your own understanding
+
+It doesn't matter whether you know the canonical way of writing an LTP test in
+C. An error of logic, when properly explained, is usually indisputable. These
+are the most important errors to find as they always result in false test
+results. Once someone points out such an error it is usually obvious to
+everyone that it is a bug and needs to be fixed.
+
+Obviously testing the patch is one way of finding errors. You can apply patches
+using :git_man:`am`. Then it is just a case of compiling and running the tests.
+
+Finally, reading and attempting to comment on other peoples patches, gives
+you a better understanding of the reviewers perspective. This is better for
+the project and for you.
+
+Style and organizational issues are best left to after you have found logical
+errors.
+
+Final notes
+-----------
+
+Hopefully you can now grasp the structure of an LTP test and have some idea of
+what is available in the LTP test library. There are a vast number of library
+functions available (mainly located in include and lib), some of which are
+documented in the test writing guidelines and many of which are not.
+
+We have only scratched the surface of the immense technical complexity of
+systems programming across multiple Kernel and C lib versions as well as
+different hardware architectures. The important thing to take away from this
+is that you have to be conscientious of what will happen on systems different
+from yours. The LTP has a huge and varied user base, so situations you may
+think are unlikely can and do happen to somebody.
+
+Of course you don't want to spend time allowing for situations which may never
+arise either, so you have to do your research and think about each situation
+critically. The more systems you can test on before submitting your changes,
+the better, although we understand not everyone has access to a lab.
+
+One important topic which has not been covered by this tutorial, is
+multi-process or multi-threaded testing. The LTP library functions work inside
+child processes and threads, but their semantics change slightly. There are
+also various helper functions for synchronizing and forking processes.
+
+.. note::
+
+    When it comes time to submit a test, the preferred way to do it is on the
+    mailing list although you can also use GitHub. The LTP follows similar rules
+    to the kernel for formatting and submitting patches. Generally speaking the
+    review cycle is easier for small patches, so try to make small changes or
+    additions where possible.
diff --git a/doc/developers/writing_tests.rst b/doc/developers/writing_tests.rst
new file mode 100644
index 000000000..2293800a1
--- /dev/null
+++ b/doc/developers/writing_tests.rst
@@ -0,0 +1,537 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Writing tests
+=============
+
+This document describes LTP guidelines and it's intended for anybody who wants
+to write or to modify a LTP testcase. It's not a definitive guide and it's not,
+by any means, a substitute for common sense.
+
+Guide to clean and understandable code
+--------------------------------------
+
+Testcases require that the source code is easy to follow. When a test starts to
+fail, the failure has to be analyzed and clean test codebase makes this task
+much easier and quicker.
+
+Keep things simple
+~~~~~~~~~~~~~~~~~~
+
+It's worth to keep testcases simple or, better, as simple as possible.
+
+The kernel and libc are tricky beasts and the complexity imposed by their
+interfaces is quite high. Concentrate on the interface you want to test and
+follow the UNIX philosophy.
+
+It's a good idea to make the test as self-contained as possible too, ideally
+tests should not depend on tools or libraries that are not widely available.
+
+Do not reinvent the wheel!
+
+* Use LTP standard interface
+* Do not add custom PASS/FAIL reporting functions
+* Do not write Makefiles from scratch, use LTP build system instead
+* Etc.
+
+Keep functions and variable names short
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Choosing a good name for an API functions or even variables is a difficult
+task do not underestimate it.
+
+There are a couple of customary names for different things that help people to
+understand code, for example:
+
+* For loop variables are usually named with a single letter ``i``, ``j``, ...
+* File descriptors ``fd`` or ``fd_foo``.
+* Number of bytes stored in file are usually named as ``size`` or ``len``
+* Etc.
+
+Do not over-comment
+~~~~~~~~~~~~~~~~~~~
+
+Comments can sometimes save your day, but they can easily do more harm than
+good. There has been several cases where comments and actual implementation
+drifted slowly apart which yielded into API misuses and hard to find bugs.
+Remember there is only one thing worse than no documentation: wrong
+documentation.
+
+Ideally, everybody should write code that is obvious, which unfortunately isn't
+always possible. If there is a code that requires to be commented, keep it
+short and to the point. These comments should explain *why* and not *how*
+things are done.
+
+Never ever comment the obvious.
+
+In case of LTP testcases, it's customary to add an asciidoc formatted comment
+paragraph with high-level test description at the beginning of the file right
+under the GPL SPDX header. This helps other people to understand the overall
+goal of the test before they dive into the technical details. It's also
+exported into generated documentation hence it should mostly explain what is
+tested.
+
+DRY (Code duplication)
+~~~~~~~~~~~~~~~~~~~~~~
+
+Copy & paste is a good servant but very poor master. If you are about to copy a
+large part of the code from one testcase to another, think what would happen if
+you find bug in the code that has been copied all around the tree. What about
+moving it to a library instead?
+
+The same goes for short but complicated parts, whenever you are about to copy &
+paste a syscall wrapper that packs arguments accordingly to machine
+architecture or similarly complicated code, put it into a header instead.
+
+C coding style
+--------------
+
+LTP adopted `Linux kernel coding style <https://www.kernel.org/doc/html/latest/process/coding-style.html>`_.
+Run ``make check`` in the test's directory and/or use ``make check-$TCID``, it
+uses (among other checks) our vendoring version of
+`checkpatch.pl <https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/plain/scripts/checkpatch.pl>`_
+script from kernel git tree.
+
+.. note::
+      If ``make check`` does not report any problems, the code still may be wrong
+      as all tools used for checking only look for common mistakes.
+
+The following linting code can be found when we run ``make check``:
+
+.. list-table::
+    :header-rows: 1
+
+    * - Linting code
+      - Message
+      - Explanation
+
+    * - LTP-001
+      - Library source files have ``tst_`` prefix
+      - API source code is inside headers in ``include/{empty}*.h``,
+        ``include/lapi/{empty}*.h`` (backward compatibility for old kernel and
+        libc) and C sources in ``lib/{empty}*.c``. Files must have ``tst_``
+        prefix.
+
+    * - LTP-002
+      - ``TST_RET`` and ``TST_ERR`` are never modified by test library functions
+      - The test author is guaranteed that the test API will not modify these
+        variables. This prevents silent errors where the return value and
+        errno are overwritten before the test has chance to check them.
+
+        The macros which are clearly intended to update these variables. That
+        is ``TEST`` and those in ``tst_test_macros.h``. Are of course allowed to
+        update these variables.
+
+    * - LTP-003
+      - Externally visible library symbols have the ``tst_`` prefix
+      - Functions, types and variables in the public test API should have the
+        ``tst_`` prefix. With some exceptions for symbols already prefixed with
+        ``safe_`` or ``ltp_``.
+
+        Static (private) symbols should not have the prefix.
+
+    * - LTP-004
+      - Test executable symbols are marked ``static``
+      - Test executables should not export symbols unnecessarily. This means
+        that all top-level variables and functions should be marked with the
+        ``static`` keyword. The only visible symbols should be those included
+        from shared object files.
+
+    * - LTP-005
+      - Array must terminate with a sentinel value (i.e. ``NULL`` or ``{}``)
+      - When defining arrays in the ``struct tst_test`` structure, we need to
+        end the array items with a sentinel ``NULL`` value.
+
+Shell coding style
+------------------
+
+When writing testcases in shell, write in *portable shell* only, it's a good
+idea to try to run the test using alternative shell (alternative to bash, for
+example dash) too.
+
+*Portable shell* means Shell Command Language as defined by POSIX with an
+exception of few widely used extensions, namely **local** keyword used inside of
+functions and ``-o`` and ``-a`` test parameters (that are marked as obsolete in
+POSIX).
+
+You can either try to run the testcases in Debian which has ``/bin/sh`` pointing
+to ``dash`` by default, or to install ``dash`` on your favorite distribution,
+then use it to run tests. If your distribution lacks ``dash`` package, you can
+always compile it from `sources <http://gondor.apana.org.au/~herbert/dash/files/>`_.
+
+Run ``make check`` in the test's directory and/or use ``make check-$TCID.sh``.
+It uses (among other checks) our vendoring version of
+`checkbashism.pl <https://salsa.debian.org/debian/devscripts/raw/master/scripts/checkbashisms.pl>`_
+from Debian that is used to check for non-portable shell code.
+
+.. note::
+
+      If ``make check`` does not report any problems the code still may be wrong,
+      as ``checkbashisms.pl`` is used for checking only common mistakes.
+
+Here there are some common sense style rules for shell
+
+* Keep lines under 80 chars
+* Use tabs for indentation
+* Keep things simple, avoid unnecessary subshells
+* Don't do confusing things (i.e. don't name your functions like common shell
+  commands, etc.)
+* Quote variables
+* Be consistent
+
+3 Backwards compatibility
+~~~~~~~~~~~~~~~~~~~~~~~~~
+
+LTP test should be as backward compatible as possible. Think of an enterprise
+distributions with long term support (more than five years since the initial
+release) or of an embedded platform that needs to use several years old
+toolchain supplied by the manufacturer.
+
+Therefore LTP test for more current features should be able to cope with older
+systems. It should at least compile fine and if it's not appropriate for the
+configuration it should return ``TCONF``.
+
+There are several types of checks we use:
+
+* The *configure script* is usually used to detect availability of a function
+  declarations in system headers. It's used to disable tests at compile time or
+  to enable fallback definitions.
+
+* Checking the ``errno`` value is another type of runtime check. Most of the
+  syscalls returns either ``EINVAL`` or ``ENOSYS`` when syscall was not
+  implemented or was disabled upon kernel compilation.
+
+* LTP has kernel version detection that can be used to disable tests at runtime.
+  Unfortunately, the kernel version does not always corresponds to a well
+  defined feature set, as distributions tend to backport hundreds of patches
+  while the kernel version stays the same. Use with caution.
+
+* Lately, we added a kernel ``.config`` parser. A test can define a boolean
+  expression of kernel config variables that has to be satisfied in order to run
+  a test. At the moment, this is mostly used for kernel namespaces.
+
+* Sometimes it makes sense to define a few macros instead of creating a
+  configure test. One example is Linux specific POSIX clock ids in
+  :master:`include/lapi/posix_clocks.h`.
+
+Dealing with messed up legacy code
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+LTP still contains a lot of old and messy code and we are cleaning it up as
+fast as we can but, despite the decade of efforts, there is still a lot of it.
+If you start modifying old or a messy testcase and your changes are more
+complicated than simple typo fixes, you should convert the test into a new
+library first.
+
+It's also much easier to review the changes if you split them into a smaller
+logical groups. The same goes for moving files: if you need to rename or to move
+files, do it in a separate patch.
+
+License
+~~~~~~~
+
+Code contributed to LTP should be licensed under GPLv2+ (GNU GPL version 2 or
+any later version).
+
+Use ``SPDX-License-Identifier: GPL-2.0-or-later``
+
+LTP Structure
+-------------
+
+The structure of LTP is quite simple. Each test is a binary written either in
+portable shell or C. The test gets a configuration via environment variables
+and/or command line parameters, it prints additional information into the
+stdout and reports overall success/failure via the exit value.
+
+Tests are generally placed under the :master:`testcases` directory. Everything that
+is a syscall or (slightly confusingly) libc syscall wrapper, goes under
+:master:`testcases/kernel/syscalls/`.
+
+There is also :master:`testcases/open_posix_testsuite/` which is a well maintained
+fork of the Open POSIX testsuite project, that has been dead since 2005.
+
+We also have a number of directories with tests for more specific features, such
+as containers, etc.
+
+Runtest Files
+~~~~~~~~~~~~~
+
+The list of tests to be executed is stored in runtest files under the
+:master:`runtest` directory. The default set of runtest files to be executed is
+stored in :master:`scenario_groups/default`. When you add a test, you should add
+corresponding entries into some runtest file(s) as well.
+
+Each line of runtest file contains one test. The first item is the test name.
+All other items, separated by space will be executed as a command.
+
+.. code-block:: bash
+
+      shell_test01 echo "SUCCESS" | shell_pipe01.sh
+      splice02 splice02 -s 20
+
+Blank lines and lines starting with a ``#`` (comments) are ignored.
+
+Syscalls tests, placed under :master:`testcases/kernel/syscalls/`, use
+:master:`runtest/syscalls` file. For kernel related tests for memory management we
+have :master:`runtest/mm`, etc.
+
+.. note::
+
+      runtest files should have one entry per a test. Creating a
+      wrapper that runs all your tests and adding it as a single test
+      into runtest file is strongly discouraged.
+
+Datafiles
+---------
+
+If your test needs data files, these should be put into a subdirectory
+named ``datafiles`` and installed into the ``testcases/data/$TCID`` directory.
+This will require to add ``INSTALL_DIR := testcases/data/TCID`` into
+correspondent ``datafiles/Makefile``.
+
+You can obtain path to datafiles via ``$TST_DATAROOT`` provided by ``test.sh``
+or via C function ``tst_dataroot()`` provided by libltp:
+
+.. code-block:: c
+
+      const char *dataroot = tst_dataroot();
+
+Datafiles can also be accessed as ``$LTPROOT/testcases/data/$TCID/...``,
+but ``$TST_DATAROOT`` and ``tst_dataroot()`` are preferred, as these can be used
+when running testcases directly in git tree as well as from install location.
+
+Sub-executables
+~~~~~~~~~~~~~~~
+
+If your test needs to execute a binary, place it in the same directory of the
+testcase and name the binary with ``$TESTNAME_`` prefix, where ``$TESTNAME`` is
+the name of the test binary. Once the test is executed by the framework, the
+path to the directory with all LTP binaries is added to the ``$PATH`` and you
+can execute it via its name.
+
+.. note::
+
+      If you need to execute a test from the LTP tree, you can add ``PATH`` to
+      the current directory with ``PATH="$PATH:$PWD" ./foo01``.
+
+Test Contribution Checklist
+---------------------------
+
+#. Test compiles and it runs fine (check with ``-i 10`` and ``-i 0`` too)
+#. ``make check`` should not emit any warnings for the test you are working on
+   (hint: run it in the test's directory and/or use ``make check-$TCID``)
+#. The runtest entries are in place
+#. New test binaries are added into the corresponding ``.gitignore`` files
+#. Patches apply over the latest git
+
+About .gitignore files
+~~~~~~~~~~~~~~~~~~~~~~
+
+There are numerous ``.gitignore`` files in the LTP tree. Usually, there is a
+``.gitignore`` file for a group of tests. The reason of this setup is simple:
+it's easier to maintain a ``.gitignore`` file per tests' directory, rather
+than having a single file in the project root directory. In this way, we don't
+have to update all the gitignore files when moving directories, and they get
+deleted automatically when a directory with tests is removed.
+
+Testing pre-release kernel features
+-----------------------------------
+
+Tests for features not yet in the mainline kernel release are accepted. However,
+they must be added only to :master:`runtest/staging`. Once a feature is part
+of the stable kernel ABI, the associated test must be moved out of staging.
+
+Testing builds with GitHub Actions
+----------------------------------
+
+Master branch is tested in GitHub :repo:`actions`
+to ensure LTP builds in various distributions, including old, current and
+bleeding edge. ``gcc`` and ``clang`` toolchains are also tested for various
+architectures using cross-compilation. For a full list of tested distros, please
+check :master:`.github/workflows/ci-docker-build.yml`.
+
+.. note::
+
+      Passing the GitHub Actions CI means that LTP compiles in a variety of
+      different distributions on their **newest releases**.
+      The CI also checks for code linting, running ``make check`` in the whole
+      LTP project.
+
+LTP C And Shell Test API Comparison
+-----------------------------------
+
+.. list-table::
+    :header-rows: 1
+
+    * - C API ``struct tst_test`` members
+      - Shell API ``$TST_*`` variables
+
+    * - .all_filesystems
+      - TST_ALL_FILESYSTEMS
+
+    * - .bufs
+      - \-
+
+    * - .caps
+      - \-
+
+    * - .child_needs_reinit
+      - not applicable
+
+    * - .cleanup
+      - TST_CLEANUP
+
+    * - .dev_extra_opts
+      - TST_DEV_EXTRA_OPTS
+
+    * - .dev_fs_opts
+      - TST_DEV_FS_OPTS
+
+    * - .dev_fs_type
+      - TST_FS_TYPE
+
+    * - .dev_min_size
+      - not applicable
+
+    * - .format_device
+      - TST_FORMAT_DEVICE
+
+    * - .max_runtime
+      - \-
+
+    * - .min_cpus
+      - not applicable
+
+    * - .min_kver
+      - TST_MIN_KVER
+
+    * - .min_mem_avail
+      - not applicable
+
+    * - .mnt_flags
+      - TST_MNT_PARAMS
+
+    * - .min_swap_avail
+      - not applicable
+
+    * - .mntpoint | .mnt_data
+      - TST_MNTPOINT
+
+    * - .mount_device
+      - TST_MOUNT_DEVICE
+
+    * - .needs_cgroup_ctrls
+      - \-
+
+    * - .needs_checkpoints
+      - TST_NEEDS_CHECKPOINTS
+
+    * - .needs_cmds
+      - TST_NEEDS_CMDS
+
+    * - .needs_devfs
+      - \-
+
+    * - .needs_device
+      - TST_NEEDS_DEVICE
+
+    * - .needs_drivers
+      - TST_NEEDS_DRIVERS
+
+    * - .needs_kconfigs
+      - TST_NEEDS_KCONFIGS
+
+    * - .needs_overlay
+      - \-
+
+    * - .needs_rofs
+      - \-
+
+    * - .needs_root
+      - TST_NEEDS_ROOT
+
+    * - .needs_tmpdir
+      - TST_NEEDS_TMPDIR
+
+    * - .options
+      - TST_PARSE_ARGS | TST_OPTS
+
+    * - .resource_files
+      - \-
+
+    * - .restore_wallclock
+      - not applicable
+
+    * - .sample
+      - \-
+
+    * - .save_restore
+      - \-
+
+    * - .scall
+      - not applicable
+
+    * - .setup
+      - TST_SETUP
+
+    * - .skip_filesystems
+      - TST_SKIP_FILESYSTEMS
+
+    * - .skip_in_compat
+      - \-
+
+    * - .skip_in_lockdown
+      - TST_SKIP_IN_LOCKDOWN
+
+    * - .skip_in_secureboot
+      - TST_SKIP_IN_SECUREBOOT
+
+    * - .supported_archs
+      - not applicable
+
+    * - .tags
+      - \-
+
+    * - .taint_check
+      - \-
+
+    * - .tcnt
+      - TST_CNT
+
+    * - .tconf_msg
+      - not applicable
+
+    * - .test | .test_all
+      - TST_TESTFUNC
+
+    * - .test_variants
+      - \-
+
+    * - .timeout
+      - TST_TIMEOUT
+
+    * - .tst_hugepage
+      - not applicable
+
+    * - .ulimit
+      - not applicable
+
+    * - not applicable
+      - TST_NEEDS_KCONFIGS_IFS
+
+    * - not applicable
+      - TST_NEEDS_MODULE
+
+    * - not applicable
+      - TST_POS_ARGS
+
+    * - not applicable
+      - TST_USAGE
+
+.. list-table::
+    :header-rows: 1
+
+    * - C API other structs
+      - Shell API ``$TST_*`` variables
+
+    * - struct tst_device
+      - TST_DEVICE
diff --git a/doc/index.rst b/doc/index.rst
new file mode 100644
index 000000000..b907ac36f
--- /dev/null
+++ b/doc/index.rst
@@ -0,0 +1,107 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+.. include:: ../README.rst
+
+.. toctree::
+   :maxdepth: 3
+   :hidden:
+   :caption: For users
+
+   users/quick_start
+   users/setup_tests
+   users/supported_systems
+   users/stats
+
+.. toctree::
+   :maxdepth: 3
+   :hidden:
+   :caption: For developers
+
+   developers/setup_mailinglist
+   developers/writing_tests
+   developers/test_case_tutorial
+   developers/api_c_tests
+   developers/api_shell_tests
+   developers/api_network_tests
+   developers/api_kvm_tests
+   developers/ltp_library
+   developers/build_system
+   developers/debugging
+   developers/documentation
+
+.. toctree::
+   :maxdepth: 3
+   :hidden:
+   :caption: For maintainers
+
+   maintainers/patch_review
+   maintainers/ltp_release_procedure
+
+For users
+---------
+
+.. descriptions here are active
+
+:doc:`users/quick_start`
+   How to build and use LTP framework in few steps
+
+:doc:`users/setup_tests`
+   How to setup tests execution
+
+:doc:`users/supported_systems`
+   A list of supported technologies by the LTP framework
+
+:doc:`users/stats`
+   Some LTP statistics
+
+For developers
+--------------
+
+.. descriptions here are active
+
+:doc:`developers/setup_mailinglist`
+   How to configure git and to start sending patches via :git_man:`send-email`.
+
+:doc:`developers/writing_tests`
+   Starting guide on writing tests
+
+:doc:`developers/test_case_tutorial`
+   A tutorial showing how to write a test from scratch using C API
+
+:doc:`developers/api_c_tests`
+   Walk through the C API features
+
+:doc:`developers/api_shell_tests`
+   Walk through the Shell API features
+
+:doc:`developers/api_network_tests`
+   Walk through the network API features
+
+:doc:`developers/api_kvm_tests`
+   Walk through the KVM API features
+
+:doc:`developers/ltp_library`
+   Developing new features in the LTP library
+
+:doc:`developers/build_system`
+   Short introduction to the LTP build system
+
+:doc:`developers/debugging`
+   How to debug LTP tests
+
+:doc:`developers/documentation`
+   How to use and develop LTP documentation
+
+For maintainers
+---------------
+
+:doc:`maintainers/patch_review`
+   Steps to follow when reviewing patches
+
+:doc:`maintainers/ltp_release_procedure`
+   Steps to follow for a new LTP release
+
+
+Getting help
+------------
+To report a problem or suggest any feature, please write at ltp@lists.linux.it
diff --git a/doc/maintainers/ltp_release_procedure.rst b/doc/maintainers/ltp_release_procedure.rst
new file mode 100644
index 000000000..5cb0bbb07
--- /dev/null
+++ b/doc/maintainers/ltp_release_procedure.rst
@@ -0,0 +1,171 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Release process
+===============
+
+Preparations
+------------
+
+The release procedure generally takes a few weeks. In the first week or two,
+patches that should go into the release are reviewed and possibly merged. These
+patches are either fixes or patches pointed out by the community.
+
+Patch review, when finished, is followed by a git freeze, which is a period
+where only fixes are pushed to the git. During that period community is
+expected to run a LTP pre-release tests, reports problems, and/or send fixes to
+the mailing list. In this period we are especially making sure that there are
+no regressions in the test results on a wide range of distributions and
+architectures.
+
+Once the stabilization period has ended the time has finally come to proceed
+with the release.
+
+Prepare the release notes
+-------------------------
+
+Part of the preparation is also to write the release notes, which are then
+added to the GitHub release and also sent as announcement to various mailing
+lists (see below).
+
+Have a look at `this release letter <https://lore.kernel.org/ltp/ZGNiQ1sMGvPU_ETp@yuki/>`_
+to get the idea how it should look.
+
+Tag the git and push changes to github
+--------------------------------------
+
+.. code-block:: bash
+
+    cd ltp
+    echo YYYYMMDD > VERSION
+    git commit -S -s -m 'LTP YYYYMMDD' VERSION
+    git tag -s -a YYYYMMDD -m 'LTP YYYYMMDD'
+    git push origin master:master
+    git push origin YYYYMMDD
+
+The string ``YYYYMMDD`` should be substituted to the current date.
+
+You can use :master:`tools/tag-release.sh` script to have the above automated
+process. It allows you to verify the tag before pushing it and does other
+checks.
+
+.. code-block:: bash
+
+    $ ./tools/tag-release.sh
+    ===== git push =====
+    new tag: 'YYYYMMDD', previous tag: '20230127'
+    tag YYYYMMDD
+    Tagger: Person-who-released LTP <foo@example.com>
+    Date:   ...
+
+    LTP YYYYMMDD
+    -----BEGIN PGP SIGNATURE-----
+    ...
+    -----END PGP SIGNATURE-----
+
+    commit 3ebc2dfa85c2445bb68d8c0d66e33c4da1e1b3a7
+    gpg:                using RSA key ...
+    ...
+    Primary key fingerprint: ...
+    Author: Person-who-released LTP <foo@example.com>
+    Date:   ...
+
+        LTP YYYYMMDD
+
+        Signed-off-by: Person-who-released LTP <foo@example.com>
+
+    diff --git a/VERSION b/VERSION
+    index af4c41fec..ae488c0e7 100644
+    --- a/VERSION
+    +++ b/VERSION
+    @@ -1 +1 @@
+    -20230127
+    +YYYYMMDD
+
+    Please check tag and signature. Proceed? [N/y]: y
+    Pushing changes to upstream git. Proceed? [N/y]: y
+    ...
+    To github.com:linux-test-project/ltp.git
+     * [new tag]             YYYYMMDD -> YYYYMMDD
+
+Prepare tarballs and metadata documentation
+-------------------------------------------
+
+The following procedure will show how to create the release archives and the
+metadata documentation:
+
+.. code-block:: bash
+
+    # clone already clonned git repository to new folder
+    cd ..
+    git clone ltp ltp-full-YYYYMMDD
+    cd ltp-full-YYYYMMDD
+
+    # update all submodules
+    git submodule update --init
+
+    # Generate configure script
+    make autotools
+
+    # Generate tarballs
+    cd ..
+    tar -cjf ltp-full-YYYYMMDD.tar.bz2 ltp-full-YYYYMMDD --exclude .git
+    tar -cJf ltp-full-YYYYMMDD.tar.xz ltp-full-YYYYMMDD --exclude .git
+
+    # Generate checksums
+    md5 ltp-full-YYYYMMDD.tar.xz > ltp-full-YYYYMMDD.tar.xz.md5
+    sha1 ltp-full-YYYYMMDD.tar.xz > ltp-full-YYYYMMDD.tar.xz.sha1
+    sha256sum ltp-full-YYYYMMDD.tar.xz > ltp-full-YYYYMMDD.tar.xz.sha256
+
+    # Generate metadata documentation
+    ./configure --with-metadata-generator=asciidoctor
+    make -C metadata
+    cp -v docparse/metadata.html ../metadata.YYYYMMDD.html
+
+You can use :master:`tools/create-tarballs-metadata.sh` script to have the above
+procedure automated. All generated files are placed in the
+``ltp-release-YYYYMMDD`` directory.
+
+.. code-block:: bash
+
+    $ ./tools/create-tarballs-metadata.sh
+    ===== git clone =====
+    Cloning into 'ltp-full-YYYYMMDD'...
+    done.
+    ===== Update submodules =====
+    Submodule 'tools/kirk' (https://github.com/linux-test-project/kirk.git) registered for path 'tools/kirk'
+    ...
+    ===== Generate configure script =====
+    sed -n '1{s:LTP-:m4_define([LTP_VERSION],[:;s:$:]):;p;q}' VERSION > m4/ltp-version.m4
+    aclocal -I m4
+    ...
+    ===== Generate tarballs =====
+    ===== Generate checksums =====
+    ===== Generate metadata documentation =====
+    checking for a BSD-compatible install... /usr/bin/install -c
+    ...
+    'docparse/metadata.html' -> '/home/foo/ltp-release-YYYYMMDD/metadata.YYYYMMDD.html'
+    Generated files are in '/home/foo/ltp-release-YYYYMMDD', upload them to github
+
+Upload the generated files to GitHub
+------------------------------------
+
+Go to :repo:`tags`. Click on ``Add release notes``.
+There should be ``Attach binaries ...`` link at the bottom of the page.
+
+Don't forget to upload checksums for the tarballs and metadata documentation
+as well.
+
+Send release announcement
+-------------------------
+
+The announcement is sent to:
+
+* ltp at lists.linux.it
+* linux-kernel at vger.kernel.org
+* libc-alpha at sourceware.org
+
+CCed to:
+
+* lwn at lwn.net
+* akpm at linux-foundation.org
+* torvalds at linux-foundation.org
diff --git a/doc/maintainers/patch_review.rst b/doc/maintainers/patch_review.rst
new file mode 100644
index 000000000..0561ffd9d
--- /dev/null
+++ b/doc/maintainers/patch_review.rst
@@ -0,0 +1,167 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Patch review
+============
+
+Anyone can and should review patches. It's the only way to get good at patch
+review and for the project to scale. For this reason, we have a short guide on
+what to do during the review process.
+
+Goals of patch review
+---------------------
+
+#. Prevent false positive test results
+#. Prevent false negative test results
+#. Keep the code as simple as possible, but no simpler
+
+How to find clear errors
+------------------------
+
+A clear error is one where there is unlikely to be any argument if you
+provide evidence of it. Evidence being an error trace or logical proof
+that an error will occur in a common situation.
+
+The following are examples and may not be appropriate for all tests.
+
+* Merge the patch locally. It should apply cleanly to master.
+* Compile the patch with default and non-default configurations.
+
+  * Use sanitizers e.g. undefined behavior, address.
+  * Compile on non-x86
+  * Compile on x86 with ``-m32``
+  * Compile testing patches with GitHub Actions in LTP repo fork can cover
+    various distros/architectures
+
+* Use ``make check``
+* Run effected tests in a VM
+
+  * Use single vCPU
+  * Use many vCPUs and enable NUMA
+  * Restrict RAM to < 1GB.
+
+* Run effected tests on an embedded device
+* Run effected tests on non-x86 machine in general
+* Run reproducers on a kernel where the bug is present
+* Run tests with ``-i0`` and ``-i2``
+* Compare usage of system calls with man page descriptions
+* Compare usage of system calls with kernel code
+* Double check commit message
+* Search the LTP library for existing helper functions
+* Check doc formatting, i.e. ``make doc && chromium docparse/metadata.html``
+
+How to find subtle errors
+-------------------------
+
+A subtle error is one where you can expect some argument because you
+do not have clear evidence of an error. It is best to state these as
+questions and not make assertions if possible.
+
+Although if it is a matter of style or "taste" then senior maintainers
+can assert what is correct to avoid bike shedding.
+
+* Ask what happens if there is an error, could it be debugged just
+  with the test output?
+* Are we testing undefined behavior?
+
+  * Could future kernel behavior change without "breaking userland"?
+  * Does the kernel behave differently depending on hardware?
+  * Does it behave differently depending on kernel configuration?
+  * Does it behave differently depending on the compiler?
+  * Would it behave differently if the order of checks on syscall parameters
+    changed in the kernel?
+
+* Will it scale to tiny and huge systems?
+
+  * What happens if there are 100+ CPUs?
+  * What happens if each CPU core is very slow?
+  * What happens if there are 2TB of RAM?
+
+* Are we repeating a pattern that can be turned into a library function?
+* Is a single test trying to do too much?
+* Could multiple similar tests be merged?
+* Race conditions
+
+  * What happens if a process gets preempted?
+  * Could checkpoints or fuzzsync by used instead?
+  * Note, usually you can insert a sleep to prove a race condition
+    exists however finding them is hard
+
+* Is there a simpler way to achieve the same kernel coverage?
+
+How to get patches merged
+-------------------------
+
+Once you think a patch is good enough you should add your ``Reviewed-by``
+and/or ``Tested-by`` tags. This means you will get some credit for getting
+the patch merged. Also some blame if there are problems.
+
+If you ran the test you can add the ``Tested-by`` tag. If you read the
+code or used static analysis tools on it, you can add the Reviewed-by
+tag.
+
+In addition you can expect others to review your patches and add their
+tags. This will speed up the process of getting your patches merged.
+
+Maintainers Checklist
+---------------------
+
+Patchset should be tested locally and ideally also in maintainer's fork in
+GitHub Actions on GitHub.
+
+.. note::
+
+    GitHub Actions do only build testing, passing the CI means only that
+    the test compiles fine on variety of different distributions and releases.
+
+The test should be executed at least once locally and should PASS as well.
+
+Commit messages should have
+
+* Author's ``Signed-off-by`` tag
+* Committer's ``Reviewed-by`` or ``Signed-off-by`` tag
+* Check also mailing lists for other reviewers / testers tags, notes and failure
+  reports
+* ``Fixes: hash`` if it fixes particular LTP commit
+* ``Fixes: #N`` if it fixes github issue number N, so it's automatically closed
+* LTP documentation should be kept up to date.
+
+After patch is accepted or rejected, set correct state and archive in the
+`LTP patchwork instance <https://patchwork.ozlabs.org/project/ltp/list/>`_.
+
+New tests
+---------
+
+New test should
+
+* Have a record in runtest file
+* Test should work fine with more than one iteration (e.g. run with ``-i 100``)
+* Run with ``-i 0`` to check that setup and cleanup are coded properly
+  (no test is being run)
+* Have a brief description
+* License: the default license for new tests is GPL v2 or later, use
+  ``GPL-2.0-or-later``; the license for test (e.g. GPL-2.0) should not change
+  unless test is completely rewritten
+* Old copyrights should be kept unless test is completely rewritten
+
+C tests
+~~~~~~~
+
+* Use the new C API, implementing ``struct tst_test``
+* Test binaries are added into corresponding ``.gitignore`` files
+* Check coding style with ``make check``
+* Docparse documentation
+* If a test is a regression test it should include ``.tags`` in the
+  ``struct tst_test`` definition
+
+Shell tests
+~~~~~~~~~~~
+
+* Use new shell API
+* Check coding style with ``make check``
+* If a test is a regression test it should include related kernel or glibc
+  commits as a comment
+
+LTP library
+~~~~~~~~~~~
+
+For patchset touching the LTP library, follow the LTP library guidelines.
diff --git a/doc/nommu-notes.txt b/doc/nommu-notes.txt
deleted file mode 100644
index 4baeff3b2..000000000
--- a/doc/nommu-notes.txt
+++ /dev/null
@@ -1,171 +0,0 @@
--------------
---- Intro ---
--------------
-
-Linux running on processors without a memory management unit place certain
-restrictions on the userspace programs.  Here we will provide some guidelines
-for people who are not familiar with such systems.
-
-If you are not familiar with virtual memory, you might want to review some
-background such as:
-	http://en.wikipedia.org/wiki/Virtual_Memory
-	/usr/src/linux/Documentation/nommu-mmap.txt
-
-----------------------------
---- No memory protection ---
-----------------------------
-
-By virtue of every process getting its own virtual memory space, applications
-are protected from each other.  So a bad memory access in one will not affect
-the memory of another.  When processors forgo virtual memory, they typically
-do not add memory protection back in to the hardware.  There are one or two
-exceptions to this rule, but for now, we'll assume no one supports it.
-
-In practical terms, this means you cannot dereference bad pointers directly
-and expect the kernel to catch and kill your application.  However, you can
-expect the kernel to catch some bad pointers when given to system calls.
-
-For example, this will "work" in the sense that no signal will be sent:
-	char *foo = NULL;
-	foo[0] = 'a';
-	foo[1] = 'b';
-
-However, the kernel should return errors when using "standard" bad pointers
-with system calls.  Such as:
-	char *foo = NULL;
-	write(1, foo, 10);
-	-> kernel will return EFAULT or similar
-The other bad pointer you can rely on in your tests is -1:
-	char *foo = (void *)-1;
-	read(0, foo, 10);
-	-> kernel will return EFAULT or similar
-
-Otherwise, no bad pointer may reliably be tested, either directly or
-indirectly via the kernel.  This tends to be a large part of the UCLINUX
-ifdef code that shows up in LTP.
-
-----------------
---- No forks ---
-----------------
-
-The ubiquitous fork() function relies completely on the Copy On Write (COW)
-functionality provided by virtual memory to share pages between processes.
-Since this isn't feasible without virtual memory, there is no fork() function.
-You will either get a linker error (undefined reference to fork) or you will
-get a runtime failure of ENOSYS.
-
-Typically, fork() is used for very few programming paradigms:
-	- daemonization
-	- run a program
-	- parallelism
-
-For the daemonization functionality, simply use the daemon() function.  This
-works under both MMU and NOMMU systems.
-
-To run a program, simply use vfork() followed by an exec-style function.
-And change the error handler in the child from exit() to _exit().  This too
-works under both MMU and NOMMU systems.  But be aware of vfork() semantics --
-since the parent and child share the same memory process, the child has to be
-careful in what it does.  This is why the recommended construct is simply:
-	pid_t child = vfork();
-	if (vfork == 0)
-		_exit(execl(....));
-
-For parallelism where processes use IPC to work together, you have to options,
-neither of which are easy.  You can rewrite to use threads, or you can re-exec
-yourself with special flags to pass along updated runtime state.  This is what
-the self_exec() helper function in LTP is designed for.
-
--------------------------
---- No overcommitting ---
--------------------------
-
-Virtual memory allows people to do malloc(128MiB) and get back a buffer that
-big.  But that buffer is only of virtual memory, not physical.  On a NOMMU
-system, the memory comes immediately from physical memory and takes it away
-from anyone else.
-
-Avoid large mallocs.
-
----------------------
---- Fragmentation ---
----------------------
-
-On a MMU system, when physical memory gets fragmented, things slow down.  But
-they keep working.  This is because every new process gets a clean virtual
-memory address space.  While processes can fragment their own virtual address
-space, this usually takes quite a long time and a lot of effort, so generally
-it is not a problem people hit.
-
-On a NOMMU system, when physical memory gets fragmented, access to large
-contiguous blocks becomes unavailable which means requests fail.  Even if your
-system has 40MiB _total_ free, the largest contiguous block might only be 1MiB
-which means that allocations larger than that will always fail.
-
-Break up your large memory allocations when possible.  Generally speaking,
-single allocations under 2MiB aren't a problem.
-
------------------
---- No paging ---
------------------
-
-No virtual memory means you can't mmap() a file and only have the pages read in
-(paged) on the fly.  So if you use mmap() on a file, the kernel must allocate
-memory for it and read in all the contents immediately.
-
----------------------
---- No swap space ---
----------------------
-
-See the "No paging" section above.  For the same reason, there is no support
-for swap partitions.  Plus, nommu typically means embedded which means flash
-based storage which means limited storage space and limited number of times
-you can write it.
-
--------------------------
---- No dynamic stacks ---
--------------------------
-
-No virtual memory means that applications can't all have their stacks at the
-top of memory and allowed to grown "indefinitely" downwards.  Stack space is
-fixed at process creation time (when it is first executed) and cannot grow.
-While the fixed size may be increased, it's best to avoid stack pressure in
-the first place.
-
-Avoid the alloca() function and use malloc()/free() instead.
-
-Avoid declaring large buffers on the stack.  Some people like to do things
-such as:
-	char buf[PATH_MAX];
-This will most likely smash the stack on nommu systems !  Use global variables
-(the bss), or use malloc()/free() type functions.
-
--------------------------------
---- No dynamic data segment ---
--------------------------------
-
-No virtual memory means that mappings cannot arbitrarily be extended.  Another
-process might have its own mapping right after yours!  This is where the brk()
-and sbrk() functions come into play.  These are most often used to dynamically
-increase the heap space via the C library, but a few people use these manually.
-
-Best if you simply avoid them, and if you're writing tests to exercise these
-functions specifically, make them nops/XFAIL for nommu systems.
-
--------------------------------
---- Limited shared mappings ---
--------------------------------
-
-No virtual memory means files cannot be mmapped in and have writes to it
-written back out to disk on the fly.  So you cannot use MAP_SHARED when
-mmapping a file.
-
--------------------------
---- No fixed mappings ---
--------------------------
-
-The MAP_FIXED option to mmap() is not supported.  It doesn't even really work
-all that well under MMU systems.
-
-Best if you simply avoid it, and if you're writing tests to exercise this
-option specifically, make them nops/XFAIL for nommu systems.
diff --git a/doc/Build-System.asciidoc b/doc/old/Build-System.asciidoc
similarity index 100%
rename from doc/Build-System.asciidoc
rename to doc/old/Build-System.asciidoc
diff --git a/doc/C-Test-API.asciidoc b/doc/old/C-Test-API.asciidoc
similarity index 99%
rename from doc/C-Test-API.asciidoc
rename to doc/old/C-Test-API.asciidoc
index db16be36e..08a76c403 100644
--- a/doc/C-Test-API.asciidoc
+++ b/doc/old/C-Test-API.asciidoc
@@ -340,7 +340,7 @@ if (TST_RET > -1) {
 -------------------------------------------------------------------------------
 
 The +TEST+ macro sets +TST_RET+ to its argument's return value and +TST_ERR+ to
-+errno+. The +TTERNO+ flag can be used to print the error number's symbolic
++errno+. The +TTERRNO+ flag can be used to print the error number's symbolic
 value.
 
 No LTP library function or macro, except those in 'tst_test_macros.h', will
@@ -1334,8 +1334,9 @@ return value is '255' if 'execvp()' failed with 'ENOENT' and '254' otherwise.
 'stdout_path' and 'stderr_path' determine where to redirect the program
 stdout and stderr I/O streams.
 
-The 'SAFE_CMD()' macro can be used automatic handling non-zero exits (exits
-with 'TBROK') and 'ENOENT' (exits with 'TCONF').
+'SAFE_CMD()' is a wrapper for 'tst_cmd()' which can be used for automatic
+handling non-zero exit (exits with 'TBROK') and 'ENOENT' (the program not in
+'$PATH', exits with 'TCONF').
 
 .Example
 [source,c]
@@ -2426,6 +2427,25 @@ Test can be skipped on various conditions: on enabled SecureBoot
 ('.skip_in_secureboot = 1'), lockdown ('.skip_in_lockdown = 1') or in 32-bit
 compat mode ('.skip_in_compat = 1').
 
+1.43 Set resource limits
+~~~~~~~~~~~~~~~~~~~~~~~~
+
+'.ulimit' allows to set resource limits on particular resource. NOTE: It sets 'rlim_max'
+only if it's higher than 'rlim_cur'.
+
+[source,c]
+-------------------------------------------------------------------------------
+#include "tst_test.h"
+
+static struct tst_test test = {
+	...
+	.ulimit = (const struct tst_ulimit_val[]) {
+		{RLIMIT_STACK, RLIM_INFINITY},
+		{}
+	},
+};
+-------------------------------------------------------------------------------
+
 2. Common problems
 ------------------
 
diff --git a/doc/C-Test-Case-Tutorial.asciidoc b/doc/old/C-Test-Case-Tutorial.asciidoc
similarity index 100%
rename from doc/C-Test-Case-Tutorial.asciidoc
rename to doc/old/C-Test-Case-Tutorial.asciidoc
diff --git a/doc/C-Test-Network-API.asciidoc b/doc/old/C-Test-Network-API.asciidoc
similarity index 100%
rename from doc/C-Test-Network-API.asciidoc
rename to doc/old/C-Test-Network-API.asciidoc
diff --git a/doc/Contact-Info.asciidoc b/doc/old/Contact-Info.asciidoc
similarity index 100%
rename from doc/Contact-Info.asciidoc
rename to doc/old/Contact-Info.asciidoc
diff --git a/doc/KVM-Test-API.asciidoc b/doc/old/KVM-Test-API.asciidoc
similarity index 100%
rename from doc/KVM-Test-API.asciidoc
rename to doc/old/KVM-Test-API.asciidoc
diff --git a/doc/LTP-Library-API-Writing-Guidelines.asciidoc b/doc/old/LTP-Library-API-Writing-Guidelines.asciidoc
similarity index 100%
rename from doc/LTP-Library-API-Writing-Guidelines.asciidoc
rename to doc/old/LTP-Library-API-Writing-Guidelines.asciidoc
diff --git a/doc/LTP-Release-Procedure.asciidoc b/doc/old/LTP-Release-Procedure.asciidoc
similarity index 100%
rename from doc/LTP-Release-Procedure.asciidoc
rename to doc/old/LTP-Release-Procedure.asciidoc
diff --git a/doc/Maintainer-Patch-Review-Checklist.asciidoc b/doc/old/Maintainer-Patch-Review-Checklist.asciidoc
similarity index 95%
rename from doc/Maintainer-Patch-Review-Checklist.asciidoc
rename to doc/old/Maintainer-Patch-Review-Checklist.asciidoc
index 452de0d49..8977b7585 100644
--- a/doc/Maintainer-Patch-Review-Checklist.asciidoc
+++ b/doc/old/Maintainer-Patch-Review-Checklist.asciidoc
@@ -22,6 +22,8 @@ The following are examples and may not be appropriate for all tests.
   - Use sanitizers e.g. undefined behaviour, address.
   - Compile on non-x86
   - Compile on x86 with -m32
+  - Compile testing patches with GitHub Actions in LTP repo fork can cover
+    various distros/architectures
 * Use `make check`
 * Run effected tests in a VM
   - Use single vCPU
@@ -30,10 +32,12 @@ The following are examples and may not be appropriate for all tests.
 * Run effected tests on an embedded device
 * Run effected tests on non-x86 machine in general
 * Run reproducers on a kernel where the bug is present
-* Run tests with "-i0"
+* Run tests with "-i0" and "-i2"
 * Compare usage of system calls with man page descriptions
 * Compare usage of system calls with kernel code
+* Double check commit message
 * Search the LTP library for existing helper functions
+* Check doc formatting, i.e. make doc && chromium docparse/metadata.html
 
 ## How to find subtle errors
 
@@ -123,9 +127,6 @@ New test should
 * Docparse documentation
 * If a test is a regression test it should include tags
   (more in https://github.com/linux-test-project/ltp/wiki/Test-Writing-Guidelines#2238-test-tags[Test tags])
-* When rewriting old tests, https://en.wikipedia.org/wiki/%CE%9CClinux[uClinux]
-  support should be removed (project has been discontinued).
-  E.g. remove `#ifdef UCLINUX`, replace `FORK_OR_VFORK()` with simple `fork()` or `SAFE_FORK()`.
 
 ### Shell tests
 * Use new https://github.com/linux-test-project/ltp/wiki/Test-Writing-Guidelines#23-writing-a-testcase-in-shell[shell API]
diff --git a/testcases/network/tcp_cmds/host/Makefile b/doc/old/Makefile
similarity index 58%
rename from testcases/network/tcp_cmds/host/Makefile
rename to doc/old/Makefile
index 453951e0d..f7e4dd021 100644
--- a/testcases/network/tcp_cmds/host/Makefile
+++ b/doc/old/Makefile
@@ -2,10 +2,10 @@
 # Copyright (C) 2009, Cisco Systems Inc.
 # Ngie Cooper, July 2009
 
-top_srcdir		?= ../../../..
+top_srcdir			?= ..
 
 include $(top_srcdir)/include/mk/env_pre.mk
 
-INSTALL_TARGETS		:= host01.sh
+RECURSIVE_TARGETS	:= install
 
-include $(top_srcdir)/include/mk/generic_leaf_target.mk
+include $(top_srcdir)/include/mk/generic_trunk_target.mk
diff --git a/doc/Shell-Test-API.asciidoc b/doc/old/Shell-Test-API.asciidoc
similarity index 100%
rename from doc/Shell-Test-API.asciidoc
rename to doc/old/Shell-Test-API.asciidoc
diff --git a/doc/Supported-kernel,-libc,-toolchain-versions.asciidoc b/doc/old/Supported-kernel,-libc,-toolchain-versions.asciidoc
similarity index 89%
rename from doc/Supported-kernel,-libc,-toolchain-versions.asciidoc
rename to doc/old/Supported-kernel,-libc,-toolchain-versions.asciidoc
index bdb3e44f3..6b53d4da0 100644
--- a/doc/Supported-kernel,-libc,-toolchain-versions.asciidoc
+++ b/doc/old/Supported-kernel,-libc,-toolchain-versions.asciidoc
@@ -8,7 +8,7 @@ We test master branch in https://github.com/linux-test-project/ltp/actions[GitHu
 to ensure LTP builds on various distributions including old, current and bleeding edge.
 We test both gcc and clang toolchains, various architectures with cross-compilation.
 For list of tested distros see
-https://github.com/linux-test-project/ltp/blob/master/.github/workflows/ci.yml[.github/workflows/ci.yml].
+https://github.com/linux-test-project/ltp/blob/master/.github/workflows/ci-docker-build.yml[.github/workflows/ci-docker-build.yml].
 
 
 NOTE: GitHub Actions does only build testing, passing the CI means only that
@@ -19,11 +19,12 @@ NOTE: GitHub Actions does only build testing, passing the CI means only that
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 [align="center",options="header"]
-|===============================================================
-| Distro                       | kernel  | glibc | gcc   | clang
-| openSUSE Leap 42.2           | 4.4     | 2.22  | 4.8.5 | -
-| Ubuntu 18.04 LTS bionic      | 4.15    | 2.27  | 7.3.0 | -
-|===============================================================
+|=================================================================
+| Distro                       | kernel  | glibc | gcc    | clang
+| openSUSE Leap 42.2           | 4.4     | 2.22  | 4.8.5  | -
+| Ubuntu 18.04 LTS bionic      | 4.15    | 2.27  | 7.3.0  | -
+| Debian 11 (bullseye)         | 5.10    | 2.31  | 10.2.1 | 11.0.1
+|=================================================================
 
 Older distributions are not officially supported, which means that it
 may or may not work. It all depends on your luck. It should be possible
@@ -53,7 +54,7 @@ distribution you may as well reconsider you life choices.
 1.3 Minimal supported kernel version
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
-Minimal supported kernel version is 3.10.
+Minimal supported kernel version is 4.4.
 
 1.4 Supported libc
 ~~~~~~~~~~~~~~~~~~
diff --git a/doc/Test-Writing-Guidelines.asciidoc b/doc/old/Test-Writing-Guidelines.asciidoc
similarity index 97%
rename from doc/Test-Writing-Guidelines.asciidoc
rename to doc/old/Test-Writing-Guidelines.asciidoc
index a81404fa6..4f40a4ab3 100644
--- a/doc/Test-Writing-Guidelines.asciidoc
+++ b/doc/old/Test-Writing-Guidelines.asciidoc
@@ -366,7 +366,7 @@ https://github.com/linux-test-project/ltp/wiki/Shell-Test-API[Shell Test API].
 
 [options="header"]
 |================================================================================
-|  C API ('struct tst_test' members) | shell API ('$TST_*' environment variables)
+| C API ('struct tst_test' members) | shell API ('$TST_*' environment variables)
 | '.all_filesystems' | 'TST_ALL_FILESYSTEMS'
 | '.bufs' | 
 | '.caps' | 
@@ -416,9 +416,15 @@ https://github.com/linux-test-project/ltp/wiki/Shell-Test-API[Shell Test API].
 | '.test_variants' | 
 | '.timeout' | 'TST_TIMEOUT'
 | '.tst_hugepage' | not applicable
-| .format_device | 'TST_DEVICE'
+| '.ulimit' | not applicable
 | not applicable | 'TST_NEEDS_KCONFIGS_IFS'
 | not applicable | 'TST_NEEDS_MODULE'
 | not applicable | 'TST_POS_ARGS'
 | not applicable | 'TST_USAGE'
 |================================================================================
+
+[options="header"]
+|================================================================================
+| C API (other structs) | shell API ('$TST_*' environment variables)
+| 'struct tst_device' | 'TST_DEVICE'
+|================================================================================
diff --git a/doc/User-Guidelines.asciidoc b/doc/old/User-Guidelines.asciidoc
similarity index 100%
rename from doc/User-Guidelines.asciidoc
rename to doc/old/User-Guidelines.asciidoc
diff --git a/doc/man1/Makefile b/doc/old/man1/Makefile
similarity index 100%
rename from doc/man1/Makefile
rename to doc/old/man1/Makefile
diff --git a/doc/man1/doio.1 b/doc/old/man1/doio.1
similarity index 100%
rename from doc/man1/doio.1
rename to doc/old/man1/doio.1
diff --git a/doc/man1/iogen.1 b/doc/old/man1/iogen.1
similarity index 100%
rename from doc/man1/iogen.1
rename to doc/old/man1/iogen.1
diff --git a/doc/man1/ltp-bump.1 b/doc/old/man1/ltp-bump.1
similarity index 100%
rename from doc/man1/ltp-bump.1
rename to doc/old/man1/ltp-bump.1
diff --git a/doc/man1/ltp-pan.1 b/doc/old/man1/ltp-pan.1
similarity index 100%
rename from doc/man1/ltp-pan.1
rename to doc/old/man1/ltp-pan.1
diff --git a/doc/man3/Makefile b/doc/old/man3/Makefile
similarity index 100%
rename from doc/man3/Makefile
rename to doc/old/man3/Makefile
diff --git a/doc/man3/parse_opts.3 b/doc/old/man3/parse_opts.3
similarity index 100%
rename from doc/man3/parse_opts.3
rename to doc/old/man3/parse_opts.3
diff --git a/doc/man3/parse_ranges.3 b/doc/old/man3/parse_ranges.3
similarity index 100%
rename from doc/man3/parse_ranges.3
rename to doc/old/man3/parse_ranges.3
diff --git a/doc/man3/random_range.3 b/doc/old/man3/random_range.3
similarity index 100%
rename from doc/man3/random_range.3
rename to doc/old/man3/random_range.3
diff --git a/doc/man3/random_range_seed.3 b/doc/old/man3/random_range_seed.3
similarity index 100%
rename from doc/man3/random_range_seed.3
rename to doc/old/man3/random_range_seed.3
diff --git a/doc/man3/tst_res.3 b/doc/old/man3/tst_res.3
similarity index 100%
rename from doc/man3/tst_res.3
rename to doc/old/man3/tst_res.3
diff --git a/doc/man3/tst_sig.3 b/doc/old/man3/tst_sig.3
similarity index 100%
rename from doc/man3/tst_sig.3
rename to doc/old/man3/tst_sig.3
diff --git a/doc/man3/tst_tmpdir.3 b/doc/old/man3/tst_tmpdir.3
similarity index 100%
rename from doc/man3/tst_tmpdir.3
rename to doc/old/man3/tst_tmpdir.3
diff --git a/doc/man3/usctest.3 b/doc/old/man3/usctest.3
similarity index 100%
rename from doc/man3/usctest.3
rename to doc/old/man3/usctest.3
diff --git a/doc/namespaces-helper-tools.txt b/doc/old/namespaces-helper-tools.txt
similarity index 100%
rename from doc/namespaces-helper-tools.txt
rename to doc/old/namespaces-helper-tools.txt
diff --git a/doc/rules.tsv b/doc/old/rules.tsv
similarity index 100%
rename from doc/rules.tsv
rename to doc/old/rules.tsv
diff --git a/doc/requirements.txt b/doc/requirements.txt
new file mode 100644
index 000000000..742fb8b4b
--- /dev/null
+++ b/doc/requirements.txt
@@ -0,0 +1,3 @@
+sphinx-rtd-theme==2.0.0
+linuxdoc==20231020
+sphinxcontrib-spelling==7.7.0
diff --git a/doc/spelling_wordlist b/doc/spelling_wordlist
new file mode 100644
index 000000000..506e5bdad
--- /dev/null
+++ b/doc/spelling_wordlist
@@ -0,0 +1,161 @@
+aarch
+akpm
+amd
+archiver
+archs
+args
+asciidoc
+autoconf
+automake
+backport
+baz
+btime
+bufs
+CCed
+cgroup
+cgroups
+checksum
+checksums
+cmds
+codebase
+compat
+config
+cpus
+ctrls
+datafiles
+dependants
+dev
+devfs
+dio
+distro
+distros
+docparse
+doio
+executables
+fd
+filesystem
+filesystems
+fixup
+fs
+fstrict
+fuzzsync
+gcc
+gdb
+github
+gitignore
+glibc
+growfiles
+hugepage
+iogen
+kbuild
+kconfigs
+kver
+ld
+le
+libc
+libltp
+libs
+linkable
+linux
+lockdown
+ltp
+lwn
+Maipo
+Makefile
+Makefiles
+mem
+mnt
+mntpoint
+msg
+namespace
+namespaces
+onwards
+openSUSE
+patchset
+pkgconf
+posix
+ppc
+pre
+pre
+preprocessor
+rebase
+reflog
+reinit
+repo
+rofs
+runtest
+scall
+secureboot
+sourceware
+statx
+stdout
+structs
+stx
+subdirectory
+subshell
+subshells
+syscall
+syscalls
+tcnt
+tconf
+teardown
+testcase
+testcases
+testsuite
+testsuites
+tmp
+tmpdir
+toolchain
+toolchains
+torvalds
+tst
+uClibc
+ulimit
+un
+userland
+userspace
+vCPU
+vCPUs
+vendoring
+vger
+wallclock
+pid
+TBROK
+mkfs
+hugepages
+hugetlbfs
+printf
+scanf
+argv
+argc
+pthread
+futex
+hdr
+brk
+iovec
+iov
+strdup
+aprintf
+alloc
+hexd
+tcases
+strsig
+strstatus
+strerrno
+libcap
+capset
+capget
+musl
+setrlimit
+rlim
+optstr
+tmpfs
+nodev
+sys
+proc
+arg
+ver
+bitwise
+dereferenced
+allocator
+ptr
diff --git a/doc/users/quick_start.rst b/doc/users/quick_start.rst
new file mode 100644
index 000000000..4a48745be
--- /dev/null
+++ b/doc/users/quick_start.rst
@@ -0,0 +1,126 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Installation and tests execution
+================================
+
+Basics requirements to build LTP are the following:
+
+* git
+* autoconf
+* automake
+* make
+* gcc
+* m4
+* pkgconf / pkg-config
+* libc headers
+* linux headers
+
+.. code-block:: console
+
+   $ git clone https://github.com/linux-test-project/ltp.git
+   $ cd ltp
+   $ make autotools
+   $ ./configure
+
+.. note::
+
+   For optional library dependencies, take a look at the scripts inside :master:`ci/`
+   directory.
+
+Running single tests
+--------------------
+
+LTP provides the possibility to build and run single tests:
+
+.. code-block:: console
+
+   $ cd testcases/kernel/syscalls/foo
+   $ make
+   $ PATH=$PATH:$PWD ./foo01
+
+Shell testcases are a bit more complicated, since they need to setup ``PATH``
+as well as to compiled binary helpers:
+
+.. code-block:: console
+
+   $ cd testcases/lib
+   $ make
+   $ cd ../commands/foo
+   $ PATH=$PATH:$PWD:$PWD/../../lib/ ./foo01.sh
+
+Open Posix Testsuite has it's own build system which needs Makefiles to be
+generated first:
+
+.. code-block:: console
+
+   $ cd testcases/open_posix_testsuite/
+   $ make generate-makefiles
+   $ cd conformance/interfaces/foo
+   $ make
+   $ ./foo_1-1.run-test
+
+Compiling and installing all testcases
+--------------------------------------
+
+To compile all tests is really simple:
+
+.. code-block:: console
+
+   $ make
+
+   $ # install LTP inside /opt/ltp by default
+   $ make install
+
+.. note::
+
+   Some tests will be disabled if ``configure`` script won't find the build
+   dependencies.
+
+Running tests
+-------------
+
+To run all the test suites
+
+.. code-block:: console
+
+   $ cd /opt/ltp
+
+   $ # run syscalls testing suite
+   $ ./kirk -f ltp -r syscalls
+
+.. note::
+
+   Many test cases have to be executed as root.
+
+Test suites (e.g. syscalls) are defined in the ``runtest`` directory. Each file
+contains a list of test cases in a simple format.
+
+Each test case has its own executable or script that can directly executed:
+
+.. code-block:: console
+
+   $ testcases/bin/abort01
+
+   $ # some tests have arguments
+   $ testcases/bin/mesgq_nstest -m none
+
+   $ # vast majority of tests have a help
+   $ testcases/bin/ioctl01 -h
+
+   $ # Many require certain environment variables to be set
+   $ LTPROOT=/opt/ltp PATH="$PATH:$LTPROOT/testcases/bin" testcases/bin/wc01.sh
+
+Most commonly, the ``PATH`` variable needs to be set and also ``LTPROOT``, but
+there are a number of other variables which usually ``kirk`` sets for you.
+
+.. note::
+
+   All shell scripts need the ``PATH`` to be set. However, this is not limited
+   to shell scripts and some C based tests need environment variables as well.
+   They usually raise a configuration error when this is needed.
+
+Network tests
+-------------
+
+Network tests usually require a certain setup that is described in
+:master:`testcases/network/README.md`.
diff --git a/doc/users/setup_tests.rst b/doc/users/setup_tests.rst
new file mode 100644
index 000000000..c5f82e627
--- /dev/null
+++ b/doc/users/setup_tests.rst
@@ -0,0 +1,104 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Tests setup
+===========
+
+The internal LTP library provides a set of features that permits to customize
+tests behavior by setting environment variables and using specific tests
+arguments.
+
+Library environment variables
+-----------------------------
+
+Following environment variables are expected to be set by LTP users. Therefore,
+with some exceptions, they have ``LTP_`` prefix. Environment variables with
+``TST_`` prefix are used inside LTP shell API and should **not** be set by
+users.
+
+.. list-table::
+   :header-rows: 1
+
+   * - Variable
+     - Note
+
+   * - KCONFIG_PATH
+     - The path to the kernel config file, (if not set, it tries the usual paths
+       ``/boot/config-RELEASE`` or ``/proc/config.gz``)
+
+   * - KCONFIG_SKIP_CHECK
+     - Skip kernel config check if variable set (not set by default)
+
+   * - LTPROOT
+     - Prefix for installed LTP.  **Should be always set**, since some tests
+       need it to use data files (``LTP_DATAROOT``). LTP is by default installed
+       into ``/opt/ltp``
+
+   * - LTP_COLORIZE_OUTPUT
+     - By default LTP colorizes it's output unless it's redirected to a pipe or
+       file. Force colorized output behavior: ``y`` or ``1``: always colorize,
+       ``n`` or ``0``: never colorize.
+
+   * - LTP_DEV
+     - Path to the block device to be used. C Language: ``.needs_device = 1``.
+       Shell language: ``TST_NEEDS_DEVICE=1``.
+
+   * - LTP_SINGLE_FS_TYPE
+     - Testing only - specifies filesystem instead all supported
+       (for tests with ``.all_filesystems``).
+
+   * - LTP_DEV_FS_TYPE
+     - Filesystem used for testing (default: ``ext2``).
+
+   * - LTP_TIMEOUT_MUL
+     - Multiplies timeout, must be number >= 0.1 (> 1 is useful for slow
+       machines to avoid unexpected timeout).
+
+   * - LTP_RUNTIME_MUL
+     - Multiplies maximal test iteration runtime. Tests that run for more than a
+       second or two are capped on runtime. You can scale the default runtime
+       both up and down with this multiplier. This is not yet implemented in the
+       shell API.
+
+   * - LTP_VIRT_OVERRIDE
+     - Overrides virtual machine detection in the test library. Setting it to
+       empty string, tells the library that system is not a virtual machine.
+       Other possible values are ``kvm``, ``xen``, ``zvm`` and ``microsoft``
+       that describe different types supervisors.
+
+   * - PATH
+     - It's required to adjust path: ``PATH="$PATH:$LTPROOT/testcases/bin"``
+
+   * - TMPDIR
+     - Base directory for template directory (C language: ``.needs_tmpdir = 1``
+       and shell: ``TST_NEEDS_TMPDIR=1``). Must be an absolute path (default:
+       '/tmp').
+
+   * - LTP_NO_CLEANUP
+     - Disable running test cleanup (defined in ``TST_CLEANUP``).
+       Shell API only.
+
+   * - LTP_ENABLE_DEBUG
+     - Enable debug info (value ``1`` or ``y``). Equivalent of ``-D`` parameter.
+
+Test execution time and timeout
+-------------------------------
+
+The limit on how long a test can run does compose of two parts: ``max_runtime``
+and ``timeout``. The limit does apply to a single test variant. That means, for
+example, that tests which run for all available filesystems will apply this
+limit for a single filesystem only.
+
+The ``max_runtime`` is a cap on how long the ``run()`` function can take and for
+most testcases this part is set to zero. For tests that do run for more than a
+second or two the ``max_runtime`` has to be defined and the ``run()`` function
+has to check actively how much runtime is left.
+
+Test runtime can be scaled up and down with ``LTP_RUNTIME_MUL`` environment
+variable or set on a command-line by the ``-I`` parameter. However,
+setting the runtime too low will cause long running tests to exit prematurely,
+possibly before having a chance to actually test anything.
+
+The timeout is a limit for test setup and cleanup and it's also a safety
+margin for the runtime accounting. It's currently set to 30 seconds but it may
+change later. If your target machine is too slow, it can be scaled up with the
+``LTP_TIMEOUT_MUL`` environment variable.
diff --git a/doc/users/stats.rst b/doc/users/stats.rst
new file mode 100644
index 000000000..7073442aa
--- /dev/null
+++ b/doc/users/stats.rst
@@ -0,0 +1,9 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Statistics
+==========
+
+In this section we collect some statistics related to the current state of
+LTP tests.
+
+.. include:: ../_static/syscalls.rst
diff --git a/doc/users/supported_systems.rst b/doc/users/supported_systems.rst
new file mode 100644
index 000000000..dabb5883a
--- /dev/null
+++ b/doc/users/supported_systems.rst
@@ -0,0 +1,114 @@
+.. SPDX-License-Identifier: GPL-2.0-or-later
+
+Supported systems
+=================
+
+LTP `master <https://github.com/linux-test-project/ltp/commits/master>`_
+branch is build tested in
+`GitHub Actions <https://github.com/linux-test-project/ltp/actions>`_.
+
+.. note::
+
+      There is no CI for the actual test runs.
+
+Kernel version
+--------------
+
+Minimal supported kernel version is **4.4**.
+
+Oldest build tested distributions
+---------------------------------
+
+.. list-table::
+    :header-rows: 1
+
+    * - Distro
+      - Kernel
+      - glibc
+      - gcc
+      - clang
+
+    * - openSUSE Leap 42.2
+      - 4.4
+      - 2.22
+      - 4.8.5
+      - \-
+
+    * - Ubuntu 18.04 LTS bionic
+      - 4.15
+      - 2.27
+      - 7.3.0
+      - \-
+
+    * - Debian 11 (bullseye)
+      - 5.10
+      - 2.31
+      - 10.2.1
+      - 11.0.1
+
+For a full list of build tested distros, please check :master:`.github/workflows/ci-docker-build.yml`.
+
+Older distributions are not officially supported, which means that it
+may or may not work. It all depends on your luck. It should be possible
+to compile latest LTP even on slightly older distributions than we
+support with a few manual tweaks, e.g. disabling manually tests for
+newly added syscalls, etc. **Trivial fixes/workarounds may be accepted,
+but users are encouraged to move to a newer distro.**
+
+If latest LTP cannot be compiled even with some amount of workarounds,
+you may result to older LTP releases, however these are **not** supported
+in any way. Also if you are trying to run LTP on more than 10 years old
+distribution you may as well reconsider you life choices.
+
+Build tested architectures
+--------------------------
+
+.. list-table::
+    :header-rows: 1
+
+    * - Architecture
+      - Build
+
+    * - x86_64
+      - native
+
+    * - x86 emulation
+      - native
+
+    * - aarch64
+      - cross compilation
+
+    * - ppc64le
+      - cross compilation
+
+    * - s390x
+      - cross compilation
+
+Supported C libraries
+---------------------
+
+.. list-table::
+    :header-rows: 1
+
+    * - C library
+      - Note
+
+    * - `glibc <https://www.gnu.org/software/libc/>`_
+      - Targeted libc, tested both compilation and actual test results.
+
+    * - `uClibc-ng <https://uclibc-ng.org/>`_
+      - Although not being tested, it should work as it attempt to maintain a glibc compatible interface.
+
+    * - `uClibc <https://www.uclibc.org/>`_
+      - Older uClibc might have problems.
+
+    * - `musl <https://musl.libc.org/>`_
+      - Not yet fully supported. Check :master:`ci/alpine.sh` script.
+
+    * - Android
+      - Please use `AOSP fork <https://android.googlesource.com/platform/external/ltp>`_.
+
+C version
+---------
+
+LTP is compiled with ``-std=gnu99``.
diff --git a/docparse/README.md b/docparse/README.md
index 9ccfa44af..c71062759 100644
--- a/docparse/README.md
+++ b/docparse/README.md
@@ -234,7 +234,7 @@ with a header describing the testsuite:
 Open Points
 ===========
 
-There are stil some loose ends. Mostly it's not well defined where to put
+There are still some loose ends. Mostly it's not well defined where to put
 things and how to format them.
 
 * Some of the hardware requirements are already listed in the tst\_test. Should
diff --git a/gen.bp b/gen.bp
index 7a2075053..ff438f92d 100644
--- a/gen.bp
+++ b/gen.bp
@@ -92,7 +92,6 @@ cc_library_static {
         "lib/safe_net.c",
         "lib/safe_pthread.c",
         "lib/safe_stdio.c",
-        "lib/self_exec.c",
         "lib/tlibio.c",
         "lib/tst_af_alg.c",
         "lib/tst_ansi_color.c",
@@ -116,7 +115,6 @@ cc_library_static {
         "lib/tst_fd.c",
         "lib/tst_fill_file.c",
         "lib/tst_fill_fs.c",
-        "lib/tst_fips.c",
         "lib/tst_fs_has_free.c",
         "lib/tst_fs_link_count.c",
         "lib/tst_fs_setup.c",
@@ -127,7 +125,6 @@ cc_library_static {
         "lib/tst_kconfig.c",
         "lib/tst_kernel.c",
         "lib/tst_kvercmp.c",
-        "lib/tst_lockdown.c",
         "lib/tst_memutils.c",
         "lib/tst_mkfs.c",
         "lib/tst_module.c",
@@ -147,6 +144,7 @@ cc_library_static {
         "lib/tst_safe_macros.c",
         "lib/tst_safe_sysv_ipc.c",
         "lib/tst_safe_timerfd.c",
+        "lib/tst_security.c",
         "lib/tst_sig.c",
         "lib/tst_sig_proc.c",
         "lib/tst_status.c",
@@ -614,6 +612,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_arch_prctl01",
+    stem: "arch_prctl01",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/arch_prctl/arch_prctl01.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_asapi_01",
     stem: "asapi_01",
@@ -644,6 +651,16 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_aslr01",
+    stem: "aslr01",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/security/aslr/aslr01.c"],
+    cflags: ["-D_GNU_SOURCE"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_atof01",
     stem: "atof01",
@@ -4685,42 +4702,6 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
-cc_test {
-    name: "ltp_fcntl28",
-    stem: "fcntl28",
-    defaults: ["ltp_test_defaults"],
-    srcs: ["testcases/kernel/syscalls/fcntl/fcntl28.c"],
-    cflags: [
-        "-D_GNU_SOURCE",
-        "-D_LARGEFILE64_SOURCE",
-    ],
-    local_include_dirs: [
-        "include/old",
-        "testcases/kernel/syscalls/fcntl",
-        "testcases/kernel/syscalls/utils",
-    ],
-    static_libs: ["libltp_ltp"],
-}
-
-cc_test {
-    name: "ltp_fcntl28_64",
-    stem: "fcntl28_64",
-    defaults: ["ltp_test_defaults"],
-    srcs: ["testcases/kernel/syscalls/fcntl/fcntl28.c"],
-    cflags: [
-        "-DTST_USE_NEWER64_SYSCALL=1",
-        "-D_FILE_OFFSET_BITS=64",
-        "-D_GNU_SOURCE",
-        "-D_LARGEFILE64_SOURCE",
-    ],
-    local_include_dirs: [
-        "include/old",
-        "testcases/kernel/syscalls/fcntl",
-        "testcases/kernel/syscalls/utils",
-    ],
-    static_libs: ["libltp_ltp"],
-}
-
 cc_test {
     name: "ltp_fcntl29",
     stem: "fcntl29",
@@ -6721,6 +6702,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_gethostname02",
+    stem: "gethostname02",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/gethostname/gethostname02.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_getitimer01",
     stem: "getitimer01",
@@ -6874,6 +6864,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_getrandom05",
+    stem: "getrandom05",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/getrandom/getrandom05.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_getresgid01",
     stem: "getresgid01",
@@ -8690,6 +8689,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_kallsyms",
+    stem: "kallsyms",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/security/kallsyms/kallsyms.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_kcmp01",
     stem: "kcmp01",
@@ -10198,6 +10206,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_mlock05",
+    stem: "mlock05",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/mlock/mlock05.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_mlock201",
     stem: "mlock201",
@@ -16366,6 +16383,18 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_shmat04",
+    stem: "shmat04",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/ipc/shmat/shmat04.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: [
+        "libltp_ltp",
+        "libltp_ltpnewipc",
+    ],
+}
+
 cc_test {
     name: "ltp_sigaction01",
     stem: "sigaction01",
@@ -16746,6 +16775,24 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_splice08",
+    stem: "splice08",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/splice/splice08.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
+cc_test {
+    name: "ltp_splice09",
+    stem: "splice09",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/splice/splice09.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_ssetmask01",
     stem: "ssetmask01",
@@ -17732,6 +17779,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_test_kconfig03",
+    stem: "test_kconfig03",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["lib/newlib_tests/test_kconfig03.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_test_macros01",
     stem: "test_macros01",
@@ -17834,7 +17890,7 @@ cc_test {
 sh_test {
     name: "ltp_testcases_bin_add_ipv6addr",
     src: "testcases/network/stress/ns-tools/add_ipv6addr",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "add_ipv6addr",
     compile_multilib: "both",
 }
@@ -17842,7 +17898,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ar01.sh",
     src: "testcases/commands/ar/ar01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ar01.sh",
     compile_multilib: "both",
 }
@@ -17850,7 +17906,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_arping01.sh",
     src: "testcases/network/tcp_cmds/arping/arping01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "arping01.sh",
     compile_multilib: "both",
 }
@@ -17858,7 +17914,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ask_password.sh",
     src: "testcases/kernel/security/mmc_security/ask_password.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ask_password.sh",
     compile_multilib: "both",
 }
@@ -17866,7 +17922,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_assign_password.sh",
     src: "testcases/kernel/security/mmc_security/assign_password.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "assign_password.sh",
     compile_multilib: "both",
 }
@@ -17874,7 +17930,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_bbr01.sh",
     src: "testcases/network/tcp_cc/bbr01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "bbr01.sh",
     compile_multilib: "both",
 }
@@ -17882,7 +17938,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_bbr02.sh",
     src: "testcases/network/tcp_cc/bbr02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "bbr02.sh",
     compile_multilib: "both",
 }
@@ -17890,7 +17946,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_bind_noport01.sh",
     src: "testcases/network/sockets/bind_noport01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "bind_noport01.sh",
     compile_multilib: "both",
 }
@@ -17898,7 +17954,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_binfmt_misc01.sh",
     src: "testcases/kernel/fs/binfmt_misc/binfmt_misc01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "binfmt_misc01.sh",
     compile_multilib: "both",
 }
@@ -17906,7 +17962,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_binfmt_misc02.sh",
     src: "testcases/kernel/fs/binfmt_misc/binfmt_misc02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "binfmt_misc02.sh",
     compile_multilib: "both",
 }
@@ -17914,7 +17970,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_binfmt_misc_lib.sh",
     src: "testcases/kernel/fs/binfmt_misc/binfmt_misc_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "binfmt_misc_lib.sh",
     compile_multilib: "both",
 }
@@ -17922,7 +17978,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_broken_ip-checksum.sh",
     src: "testcases/network/stress/broken_ip/broken_ip-checksum.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "broken_ip-checksum.sh",
     compile_multilib: "both",
 }
@@ -17930,7 +17986,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_broken_ip-dstaddr.sh",
     src: "testcases/network/stress/broken_ip/broken_ip-dstaddr.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "broken_ip-dstaddr.sh",
     compile_multilib: "both",
 }
@@ -17938,7 +17994,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_broken_ip-fragment.sh",
     src: "testcases/network/stress/broken_ip/broken_ip-fragment.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "broken_ip-fragment.sh",
     compile_multilib: "both",
 }
@@ -17946,7 +18002,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_broken_ip-ihl.sh",
     src: "testcases/network/stress/broken_ip/broken_ip-ihl.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "broken_ip-ihl.sh",
     compile_multilib: "both",
 }
@@ -17954,7 +18010,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_broken_ip-nexthdr.sh",
     src: "testcases/network/stress/broken_ip/broken_ip-nexthdr.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "broken_ip-nexthdr.sh",
     compile_multilib: "both",
 }
@@ -17962,7 +18018,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_broken_ip-plen.sh",
     src: "testcases/network/stress/broken_ip/broken_ip-plen.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "broken_ip-plen.sh",
     compile_multilib: "both",
 }
@@ -17970,7 +18026,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_broken_ip-protcol.sh",
     src: "testcases/network/stress/broken_ip/broken_ip-protcol.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "broken_ip-protcol.sh",
     compile_multilib: "both",
 }
@@ -17978,7 +18034,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_broken_ip-version.sh",
     src: "testcases/network/stress/broken_ip/broken_ip-version.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "broken_ip-version.sh",
     compile_multilib: "both",
 }
@@ -17986,7 +18042,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_busy_poll01.sh",
     src: "testcases/network/busy_poll/busy_poll01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "busy_poll01.sh",
     compile_multilib: "both",
 }
@@ -17994,7 +18050,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_busy_poll02.sh",
     src: "testcases/network/busy_poll/busy_poll02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "busy_poll02.sh",
     compile_multilib: "both",
 }
@@ -18002,7 +18058,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_busy_poll03.sh",
     src: "testcases/network/busy_poll/busy_poll03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "busy_poll03.sh",
     compile_multilib: "both",
 }
@@ -18010,7 +18066,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_busy_poll_lib.sh",
     src: "testcases/network/busy_poll/busy_poll_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "busy_poll_lib.sh",
     compile_multilib: "both",
 }
@@ -18018,7 +18074,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_fj_common.sh",
     src: "testcases/kernel/controllers/cgroup_fj/cgroup_fj_common.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_fj_common.sh",
     compile_multilib: "both",
 }
@@ -18026,7 +18082,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_fj_function.sh",
     src: "testcases/kernel/controllers/cgroup_fj/cgroup_fj_function.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_fj_function.sh",
     compile_multilib: "both",
 }
@@ -18034,7 +18090,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_fj_stress.sh",
     src: "testcases/kernel/controllers/cgroup_fj/cgroup_fj_stress.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_fj_stress.sh",
     compile_multilib: "both",
 }
@@ -18042,7 +18098,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_lib.sh",
     src: "testcases/kernel/controllers/cgroup_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_lib.sh",
     compile_multilib: "both",
 }
@@ -18050,7 +18106,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_regression_3_1.sh",
     src: "testcases/kernel/controllers/cgroup/cgroup_regression_3_1.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_regression_3_1.sh",
     compile_multilib: "both",
 }
@@ -18058,7 +18114,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_regression_3_2.sh",
     src: "testcases/kernel/controllers/cgroup/cgroup_regression_3_2.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_regression_3_2.sh",
     compile_multilib: "both",
 }
@@ -18066,7 +18122,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_regression_5_1.sh",
     src: "testcases/kernel/controllers/cgroup/cgroup_regression_5_1.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_regression_5_1.sh",
     compile_multilib: "both",
 }
@@ -18074,7 +18130,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_regression_5_2.sh",
     src: "testcases/kernel/controllers/cgroup/cgroup_regression_5_2.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_regression_5_2.sh",
     compile_multilib: "both",
 }
@@ -18082,7 +18138,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_regression_6_1.sh",
     src: "testcases/kernel/controllers/cgroup/cgroup_regression_6_1.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_regression_6_1.sh",
     compile_multilib: "both",
 }
@@ -18090,7 +18146,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_regression_6_2.sh",
     src: "testcases/kernel/controllers/cgroup/cgroup_regression_6_2.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_regression_6_2.sh",
     compile_multilib: "both",
 }
@@ -18098,7 +18154,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cgroup_regression_test.sh",
     src: "testcases/kernel/controllers/cgroup/cgroup_regression_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cgroup_regression_test.sh",
     compile_multilib: "both",
 }
@@ -18106,7 +18162,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_change_password.sh",
     src: "testcases/kernel/security/mmc_security/change_password.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "change_password.sh",
     compile_multilib: "both",
 }
@@ -18114,7 +18170,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_check_envval",
     src: "testcases/network/stress/ns-tools/check_envval",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "check_envval",
     compile_multilib: "both",
 }
@@ -18122,7 +18178,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_check_icmpv4_connectivity",
     src: "testcases/network/stress/ns-tools/check_icmpv4_connectivity",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "check_icmpv4_connectivity",
     compile_multilib: "both",
 }
@@ -18130,7 +18186,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_check_icmpv6_connectivity",
     src: "testcases/network/stress/ns-tools/check_icmpv6_connectivity",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "check_icmpv6_connectivity",
     compile_multilib: "both",
 }
@@ -18138,7 +18194,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_check_netem",
     src: "testcases/network/stress/ns-tools/check_netem",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "check_netem",
     compile_multilib: "both",
 }
@@ -18146,7 +18202,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_check_setkey",
     src: "testcases/network/stress/ns-tools/check_setkey",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "check_setkey",
     compile_multilib: "both",
 }
@@ -18154,23 +18210,15 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cleanup_lvm.sh",
     src: "testcases/misc/lvm/cleanup_lvm.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cleanup_lvm.sh",
     compile_multilib: "both",
 }
 
-sh_test {
-    name: "ltp_testcases_bin_clockdiff01.sh",
-    src: "testcases/network/tcp_cmds/clockdiff/clockdiff01.sh",
-    sub_dir: "ltp/testcases/bin",
-    filename: "clockdiff01.sh",
-    compile_multilib: "both",
-}
-
 sh_test {
     name: "ltp_testcases_bin_cmdlib.sh",
     src: "testcases/lib/cmdlib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cmdlib.sh",
     compile_multilib: "both",
 }
@@ -18178,7 +18226,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cp_tests.sh",
     src: "testcases/commands/cp/cp_tests.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cp_tests.sh",
     compile_multilib: "both",
 }
@@ -18186,7 +18234,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpio_tests.sh",
     src: "testcases/commands/cpio/cpio_tests.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpio_tests.sh",
     compile_multilib: "both",
 }
@@ -18194,7 +18242,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuacct.sh",
     src: "testcases/kernel/controllers/cpuacct/cpuacct.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuacct.sh",
     compile_multilib: "both",
 }
@@ -18202,7 +18250,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug01.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/functional/cpuhotplug01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug01.sh",
     compile_multilib: "both",
 }
@@ -18210,7 +18258,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug02.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/functional/cpuhotplug02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug02.sh",
     compile_multilib: "both",
 }
@@ -18218,7 +18266,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug03.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/functional/cpuhotplug03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug03.sh",
     compile_multilib: "both",
 }
@@ -18226,7 +18274,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug04.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/functional/cpuhotplug04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug04.sh",
     compile_multilib: "both",
 }
@@ -18234,7 +18282,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug05.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/functional/cpuhotplug05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug05.sh",
     compile_multilib: "both",
 }
@@ -18242,7 +18290,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug06.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/functional/cpuhotplug06.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug06.sh",
     compile_multilib: "both",
 }
@@ -18250,7 +18298,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug07.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/functional/cpuhotplug07.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug07.sh",
     compile_multilib: "both",
 }
@@ -18258,7 +18306,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug_do_disk_write_loop",
     src: "testcases/kernel/hotplug/cpu_hotplug/tools/cpuhotplug_do_disk_write_loop",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug_do_disk_write_loop",
     compile_multilib: "both",
 }
@@ -18266,7 +18314,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug_do_kcompile_loop",
     src: "testcases/kernel/hotplug/cpu_hotplug/tools/cpuhotplug_do_kcompile_loop",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug_do_kcompile_loop",
     compile_multilib: "both",
 }
@@ -18274,7 +18322,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug_do_spin_loop",
     src: "testcases/kernel/hotplug/cpu_hotplug/tools/cpuhotplug_do_spin_loop",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug_do_spin_loop",
     compile_multilib: "both",
 }
@@ -18282,7 +18330,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug_hotplug.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/include/cpuhotplug_hotplug.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug_hotplug.sh",
     compile_multilib: "both",
 }
@@ -18290,7 +18338,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug_report_proc_interrupts",
     src: "testcases/kernel/hotplug/cpu_hotplug/tools/cpuhotplug_report_proc_interrupts",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug_report_proc_interrupts",
     compile_multilib: "both",
 }
@@ -18298,7 +18346,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuhotplug_testsuite.sh",
     src: "testcases/kernel/hotplug/cpu_hotplug/include/cpuhotplug_testsuite.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuhotplug_testsuite.sh",
     compile_multilib: "both",
 }
@@ -18306,7 +18354,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_base_ops_testset.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_base_ops_test/cpuset_base_ops_testset.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_base_ops_testset.sh",
     compile_multilib: "both",
 }
@@ -18314,7 +18362,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_exclusive_test.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_exclusive_test/cpuset_exclusive_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_exclusive_test.sh",
     compile_multilib: "both",
 }
@@ -18322,7 +18370,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_funcs.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_funcs.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_funcs.sh",
     compile_multilib: "both",
 }
@@ -18330,7 +18378,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_hierarchy_test.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_hierarchy_test/cpuset_hierarchy_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_hierarchy_test.sh",
     compile_multilib: "both",
 }
@@ -18338,7 +18386,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_hotplug_test.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_hotplug_test/cpuset_hotplug_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_hotplug_test.sh",
     compile_multilib: "both",
 }
@@ -18346,7 +18394,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_inherit_testset.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_inherit_test/cpuset_inherit_testset.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_inherit_testset.sh",
     compile_multilib: "both",
 }
@@ -18354,7 +18402,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_load_balance_test.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_load_balance_test/cpuset_load_balance_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_load_balance_test.sh",
     compile_multilib: "both",
 }
@@ -18362,7 +18410,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_memory_pressure_testset.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_memory_pressure_test/cpuset_memory_pressure_testset.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_memory_pressure_testset.sh",
     compile_multilib: "both",
 }
@@ -18370,7 +18418,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_memory_spread_testset.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_memory_spread_test/cpuset_memory_spread_testset.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_memory_spread_testset.sh",
     compile_multilib: "both",
 }
@@ -18378,7 +18426,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_memory_testset.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_memory_test/cpuset_memory_testset.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_memory_testset.sh",
     compile_multilib: "both",
 }
@@ -18386,7 +18434,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_regression_test.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_regression_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_regression_test.sh",
     compile_multilib: "both",
 }
@@ -18394,7 +18442,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_sched_domains_test.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_load_balance_test/cpuset_sched_domains_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_sched_domains_test.sh",
     compile_multilib: "both",
 }
@@ -18402,7 +18450,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_cpuset_syscall_testset.sh",
     src: "testcases/kernel/controllers/cpuset/cpuset_syscall_test/cpuset_syscall_testset.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "cpuset_syscall_testset.sh",
     compile_multilib: "both",
 }
@@ -18410,7 +18458,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_create_file",
     src: "testcases/network/stress/ns-tools/create_file",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "create_file",
     compile_multilib: "both",
 }
@@ -18418,7 +18466,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_daemonlib.sh",
     src: "testcases/lib/daemonlib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "daemonlib.sh",
     compile_multilib: "both",
 }
@@ -18426,7 +18474,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_data",
     src: "testcases/kernel/sched/clisrv/data",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "data",
     compile_multilib: "both",
 }
@@ -18434,7 +18482,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dccp01.sh",
     src: "testcases/network/dccp/dccp01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dccp01.sh",
     compile_multilib: "both",
 }
@@ -18442,7 +18490,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dccp_ipsec.sh",
     src: "testcases/network/stress/dccp/dccp_ipsec.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dccp_ipsec.sh",
     compile_multilib: "both",
 }
@@ -18450,7 +18498,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dccp_ipsec_vti.sh",
     src: "testcases/network/stress/dccp/dccp_ipsec_vti.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dccp_ipsec_vti.sh",
     compile_multilib: "both",
 }
@@ -18458,7 +18506,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dctcp01.sh",
     src: "testcases/network/tcp_cc/dctcp01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dctcp01.sh",
     compile_multilib: "both",
 }
@@ -18466,7 +18514,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dhcp_lib.sh",
     src: "testcases/network/dhcp/dhcp_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dhcp_lib.sh",
     compile_multilib: "both",
 }
@@ -18474,7 +18522,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dhcpd_tests.sh",
     src: "testcases/network/dhcp/dhcpd_tests.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dhcpd_tests.sh",
     compile_multilib: "both",
 }
@@ -18482,7 +18530,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dns-stress-lib.sh",
     src: "testcases/network/stress/dns/dns-stress-lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dns-stress-lib.sh",
     compile_multilib: "both",
 }
@@ -18490,7 +18538,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dns-stress.sh",
     src: "testcases/network/stress/dns/dns-stress.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dns-stress.sh",
     compile_multilib: "both",
 }
@@ -18498,7 +18546,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dns-stress01-rmt.sh",
     src: "testcases/network/stress/dns/dns-stress01-rmt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dns-stress01-rmt.sh",
     compile_multilib: "both",
 }
@@ -18506,7 +18554,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dns-stress02-rmt.sh",
     src: "testcases/network/stress/dns/dns-stress02-rmt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dns-stress02-rmt.sh",
     compile_multilib: "both",
 }
@@ -18514,7 +18562,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dnsmasq_tests.sh",
     src: "testcases/network/dhcp/dnsmasq_tests.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dnsmasq_tests.sh",
     compile_multilib: "both",
 }
@@ -18522,7 +18570,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_dynamic_debug01.sh",
     src: "testcases/kernel/tracing/dynamic_debug/dynamic_debug01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "dynamic_debug01.sh",
     compile_multilib: "both",
 }
@@ -18530,7 +18578,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_evm_overlay.sh",
     src: "testcases/kernel/security/integrity/ima/tests/evm_overlay.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "evm_overlay.sh",
     compile_multilib: "both",
 }
@@ -18538,7 +18586,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_file01.sh",
     src: "testcases/commands/file/file01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "file01.sh",
     compile_multilib: "both",
 }
@@ -18546,7 +18594,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_filecapstest.sh",
     src: "testcases/kernel/security/filecaps/filecapstest.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "filecapstest.sh",
     compile_multilib: "both",
 }
@@ -18554,7 +18602,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_find_portbundle",
     src: "testcases/network/stress/ns-tools/find_portbundle",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "find_portbundle",
     compile_multilib: "both",
 }
@@ -18562,7 +18610,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_force_erase.sh",
     src: "testcases/kernel/security/mmc_security/force_erase.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "force_erase.sh",
     compile_multilib: "both",
 }
@@ -18570,7 +18618,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fork_freeze.sh",
     src: "testcases/kernel/controllers/freezer/fork_freeze.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fork_freeze.sh",
     compile_multilib: "both",
 }
@@ -18578,7 +18626,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fou01.sh",
     src: "testcases/network/virt/fou01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fou01.sh",
     compile_multilib: "both",
 }
@@ -18586,7 +18634,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_freeze_cancel.sh",
     src: "testcases/kernel/controllers/freezer/freeze_cancel.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "freeze_cancel.sh",
     compile_multilib: "both",
 }
@@ -18594,7 +18642,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_freeze_kill_thaw.sh",
     src: "testcases/kernel/controllers/freezer/freeze_kill_thaw.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "freeze_kill_thaw.sh",
     compile_multilib: "both",
 }
@@ -18602,7 +18650,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_freeze_move_thaw.sh",
     src: "testcases/kernel/controllers/freezer/freeze_move_thaw.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "freeze_move_thaw.sh",
     compile_multilib: "both",
 }
@@ -18610,7 +18658,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_freeze_self_thaw.sh",
     src: "testcases/kernel/controllers/freezer/freeze_self_thaw.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "freeze_self_thaw.sh",
     compile_multilib: "both",
 }
@@ -18618,7 +18666,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_freeze_sleep_thaw.sh",
     src: "testcases/kernel/controllers/freezer/freeze_sleep_thaw.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "freeze_sleep_thaw.sh",
     compile_multilib: "both",
 }
@@ -18626,7 +18674,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_freeze_thaw.sh",
     src: "testcases/kernel/controllers/freezer/freeze_thaw.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "freeze_thaw.sh",
     compile_multilib: "both",
 }
@@ -18634,7 +18682,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_freeze_write_freezing.sh",
     src: "testcases/kernel/controllers/freezer/freeze_write_freezing.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "freeze_write_freezing.sh",
     compile_multilib: "both",
 }
@@ -18642,7 +18690,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind01.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind01.sh",
     compile_multilib: "both",
 }
@@ -18650,7 +18698,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind02.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind02.sh",
     compile_multilib: "both",
 }
@@ -18658,7 +18706,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind03.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind03.sh",
     compile_multilib: "both",
 }
@@ -18666,7 +18714,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind04.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind04.sh",
     compile_multilib: "both",
 }
@@ -18674,7 +18722,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind05.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind05.sh",
     compile_multilib: "both",
 }
@@ -18682,7 +18730,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind06.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind06.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind06.sh",
     compile_multilib: "both",
 }
@@ -18690,7 +18738,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind07-2.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind07-2.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind07-2.sh",
     compile_multilib: "both",
 }
@@ -18698,7 +18746,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind07.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind07.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind07.sh",
     compile_multilib: "both",
 }
@@ -18706,7 +18754,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind08.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind08.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind08.sh",
     compile_multilib: "both",
 }
@@ -18714,7 +18762,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind09.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind09.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind09.sh",
     compile_multilib: "both",
 }
@@ -18722,7 +18770,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind10.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind10.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind10.sh",
     compile_multilib: "both",
 }
@@ -18730,7 +18778,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind11.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind11.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind11.sh",
     compile_multilib: "both",
 }
@@ -18738,7 +18786,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind12.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind12.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind12.sh",
     compile_multilib: "both",
 }
@@ -18746,7 +18794,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind13.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind13.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind13.sh",
     compile_multilib: "both",
 }
@@ -18754,7 +18802,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind14.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind14.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind14.sh",
     compile_multilib: "both",
 }
@@ -18762,7 +18810,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind15.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind15.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind15.sh",
     compile_multilib: "both",
 }
@@ -18770,7 +18818,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind16.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind16.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind16.sh",
     compile_multilib: "both",
 }
@@ -18778,7 +18826,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind17.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind17.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind17.sh",
     compile_multilib: "both",
 }
@@ -18786,7 +18834,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind18.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind18.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind18.sh",
     compile_multilib: "both",
 }
@@ -18794,7 +18842,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind19.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind19.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind19.sh",
     compile_multilib: "both",
 }
@@ -18802,7 +18850,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind20.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind20.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind20.sh",
     compile_multilib: "both",
 }
@@ -18810,7 +18858,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind21.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind21.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind21.sh",
     compile_multilib: "both",
 }
@@ -18818,7 +18866,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind22.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind22.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind22.sh",
     compile_multilib: "both",
 }
@@ -18826,7 +18874,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind23.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind23.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind23.sh",
     compile_multilib: "both",
 }
@@ -18834,7 +18882,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind24.sh",
     src: "testcases/kernel/fs/fs_bind/bind/fs_bind24.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind24.sh",
     compile_multilib: "both",
 }
@@ -18842,7 +18890,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_cloneNS01.sh",
     src: "testcases/kernel/fs/fs_bind/cloneNS/fs_bind_cloneNS01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_cloneNS01.sh",
     compile_multilib: "both",
 }
@@ -18850,7 +18898,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_cloneNS02.sh",
     src: "testcases/kernel/fs/fs_bind/cloneNS/fs_bind_cloneNS02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_cloneNS02.sh",
     compile_multilib: "both",
 }
@@ -18858,7 +18906,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_cloneNS03.sh",
     src: "testcases/kernel/fs/fs_bind/cloneNS/fs_bind_cloneNS03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_cloneNS03.sh",
     compile_multilib: "both",
 }
@@ -18866,7 +18914,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_cloneNS04.sh",
     src: "testcases/kernel/fs/fs_bind/cloneNS/fs_bind_cloneNS04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_cloneNS04.sh",
     compile_multilib: "both",
 }
@@ -18874,7 +18922,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_cloneNS05.sh",
     src: "testcases/kernel/fs/fs_bind/cloneNS/fs_bind_cloneNS05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_cloneNS05.sh",
     compile_multilib: "both",
 }
@@ -18882,7 +18930,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_cloneNS06.sh",
     src: "testcases/kernel/fs/fs_bind/cloneNS/fs_bind_cloneNS06.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_cloneNS06.sh",
     compile_multilib: "both",
 }
@@ -18890,7 +18938,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_cloneNS07.sh",
     src: "testcases/kernel/fs/fs_bind/cloneNS/fs_bind_cloneNS07.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_cloneNS07.sh",
     compile_multilib: "both",
 }
@@ -18898,7 +18946,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_lib.sh",
     src: "testcases/kernel/fs/fs_bind/fs_bind_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_lib.sh",
     compile_multilib: "both",
 }
@@ -18906,7 +18954,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move01.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move01.sh",
     compile_multilib: "both",
 }
@@ -18914,7 +18962,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move02.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move02.sh",
     compile_multilib: "both",
 }
@@ -18922,7 +18970,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move03.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move03.sh",
     compile_multilib: "both",
 }
@@ -18930,7 +18978,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move04.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move04.sh",
     compile_multilib: "both",
 }
@@ -18938,7 +18986,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move05.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move05.sh",
     compile_multilib: "both",
 }
@@ -18946,7 +18994,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move06.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move06.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move06.sh",
     compile_multilib: "both",
 }
@@ -18954,7 +19002,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move07.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move07.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move07.sh",
     compile_multilib: "both",
 }
@@ -18962,7 +19010,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move08.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move08.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move08.sh",
     compile_multilib: "both",
 }
@@ -18970,7 +19018,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move09.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move09.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move09.sh",
     compile_multilib: "both",
 }
@@ -18978,7 +19026,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move10.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move10.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move10.sh",
     compile_multilib: "both",
 }
@@ -18986,7 +19034,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move11.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move11.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move11.sh",
     compile_multilib: "both",
 }
@@ -18994,7 +19042,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move12.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move12.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move12.sh",
     compile_multilib: "both",
 }
@@ -19002,7 +19050,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move13.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move13.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move13.sh",
     compile_multilib: "both",
 }
@@ -19010,7 +19058,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move14.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move14.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move14.sh",
     compile_multilib: "both",
 }
@@ -19018,7 +19066,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move15.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move15.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move15.sh",
     compile_multilib: "both",
 }
@@ -19026,7 +19074,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move16.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move16.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move16.sh",
     compile_multilib: "both",
 }
@@ -19034,7 +19082,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move17.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move17.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move17.sh",
     compile_multilib: "both",
 }
@@ -19042,7 +19090,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move18.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move18.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move18.sh",
     compile_multilib: "both",
 }
@@ -19050,7 +19098,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move19.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move19.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move19.sh",
     compile_multilib: "both",
 }
@@ -19058,7 +19106,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move20.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move20.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move20.sh",
     compile_multilib: "both",
 }
@@ -19066,7 +19114,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move21.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move21.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move21.sh",
     compile_multilib: "both",
 }
@@ -19074,7 +19122,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_move22.sh",
     src: "testcases/kernel/fs/fs_bind/move/fs_bind_move22.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_move22.sh",
     compile_multilib: "both",
 }
@@ -19082,7 +19130,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind01.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind01.sh",
     compile_multilib: "both",
 }
@@ -19090,7 +19138,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind02.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind02.sh",
     compile_multilib: "both",
 }
@@ -19098,7 +19146,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind03.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind03.sh",
     compile_multilib: "both",
 }
@@ -19106,7 +19154,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind04.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind04.sh",
     compile_multilib: "both",
 }
@@ -19114,7 +19162,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind05.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind05.sh",
     compile_multilib: "both",
 }
@@ -19122,7 +19170,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind06.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind06.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind06.sh",
     compile_multilib: "both",
 }
@@ -19130,7 +19178,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind07-2.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind07-2.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind07-2.sh",
     compile_multilib: "both",
 }
@@ -19138,7 +19186,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind07.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind07.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind07.sh",
     compile_multilib: "both",
 }
@@ -19146,7 +19194,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind08.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind08.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind08.sh",
     compile_multilib: "both",
 }
@@ -19154,7 +19202,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind09.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind09.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind09.sh",
     compile_multilib: "both",
 }
@@ -19162,7 +19210,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind10.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind10.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind10.sh",
     compile_multilib: "both",
 }
@@ -19170,7 +19218,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind11.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind11.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind11.sh",
     compile_multilib: "both",
 }
@@ -19178,7 +19226,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind12.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind12.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind12.sh",
     compile_multilib: "both",
 }
@@ -19186,7 +19234,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind13.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind13.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind13.sh",
     compile_multilib: "both",
 }
@@ -19194,7 +19242,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind14.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind14.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind14.sh",
     compile_multilib: "both",
 }
@@ -19202,7 +19250,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind15.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind15.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind15.sh",
     compile_multilib: "both",
 }
@@ -19210,7 +19258,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind16.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind16.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind16.sh",
     compile_multilib: "both",
 }
@@ -19218,7 +19266,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind17.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind17.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind17.sh",
     compile_multilib: "both",
 }
@@ -19226,7 +19274,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind18.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind18.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind18.sh",
     compile_multilib: "both",
 }
@@ -19234,7 +19282,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind19.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind19.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind19.sh",
     compile_multilib: "both",
 }
@@ -19242,7 +19290,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind20.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind20.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind20.sh",
     compile_multilib: "both",
 }
@@ -19250,7 +19298,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind21.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind21.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind21.sh",
     compile_multilib: "both",
 }
@@ -19258,7 +19306,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind22.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind22.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind22.sh",
     compile_multilib: "both",
 }
@@ -19266,7 +19314,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind23.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind23.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind23.sh",
     compile_multilib: "both",
 }
@@ -19274,7 +19322,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind24.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind24.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind24.sh",
     compile_multilib: "both",
 }
@@ -19282,7 +19330,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind25.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind25.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind25.sh",
     compile_multilib: "both",
 }
@@ -19290,7 +19338,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind26.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind26.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind26.sh",
     compile_multilib: "both",
 }
@@ -19298,7 +19346,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind27.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind27.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind27.sh",
     compile_multilib: "both",
 }
@@ -19306,7 +19354,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind28.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind28.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind28.sh",
     compile_multilib: "both",
 }
@@ -19314,7 +19362,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind29.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind29.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind29.sh",
     compile_multilib: "both",
 }
@@ -19322,7 +19370,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind30.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind30.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind30.sh",
     compile_multilib: "both",
 }
@@ -19330,7 +19378,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind31.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind31.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind31.sh",
     compile_multilib: "both",
 }
@@ -19338,7 +19386,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind32.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind32.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind32.sh",
     compile_multilib: "both",
 }
@@ -19346,7 +19394,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind33.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind33.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind33.sh",
     compile_multilib: "both",
 }
@@ -19354,7 +19402,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind34.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind34.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind34.sh",
     compile_multilib: "both",
 }
@@ -19362,7 +19410,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind35.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind35.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind35.sh",
     compile_multilib: "both",
 }
@@ -19370,7 +19418,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind36.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind36.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind36.sh",
     compile_multilib: "both",
 }
@@ -19378,7 +19426,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind37.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind37.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind37.sh",
     compile_multilib: "both",
 }
@@ -19386,7 +19434,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind38.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind38.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind38.sh",
     compile_multilib: "both",
 }
@@ -19394,7 +19442,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_rbind39.sh",
     src: "testcases/kernel/fs/fs_bind/rbind/fs_bind_rbind39.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_rbind39.sh",
     compile_multilib: "both",
 }
@@ -19402,7 +19450,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_bind_regression.sh",
     src: "testcases/kernel/fs/fs_bind/fs_bind_regression.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_bind_regression.sh",
     compile_multilib: "both",
 }
@@ -19410,7 +19458,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_di",
     src: "testcases/kernel/fs/fs_di/fs_di",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_di",
     compile_multilib: "both",
 }
@@ -19418,7 +19466,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_inod",
     src: "testcases/kernel/fs/fs_inod/fs_inod",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_inod",
     compile_multilib: "both",
 }
@@ -19426,7 +19474,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer.sh",
     src: "testcases/kernel/fs/racer/fs_racer.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer.sh",
     compile_multilib: "both",
 }
@@ -19434,7 +19482,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_dir_create.sh",
     src: "testcases/kernel/fs/racer/fs_racer_dir_create.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_dir_create.sh",
     compile_multilib: "both",
 }
@@ -19442,7 +19490,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_dir_test.sh",
     src: "testcases/kernel/fs/racer/fs_racer_dir_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_dir_test.sh",
     compile_multilib: "both",
 }
@@ -19450,7 +19498,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_file_concat.sh",
     src: "testcases/kernel/fs/racer/fs_racer_file_concat.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_file_concat.sh",
     compile_multilib: "both",
 }
@@ -19458,7 +19506,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_file_create.sh",
     src: "testcases/kernel/fs/racer/fs_racer_file_create.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_file_create.sh",
     compile_multilib: "both",
 }
@@ -19466,7 +19514,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_file_link.sh",
     src: "testcases/kernel/fs/racer/fs_racer_file_link.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_file_link.sh",
     compile_multilib: "both",
 }
@@ -19474,7 +19522,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_file_list.sh",
     src: "testcases/kernel/fs/racer/fs_racer_file_list.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_file_list.sh",
     compile_multilib: "both",
 }
@@ -19482,7 +19530,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_file_rename.sh",
     src: "testcases/kernel/fs/racer/fs_racer_file_rename.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_file_rename.sh",
     compile_multilib: "both",
 }
@@ -19490,7 +19538,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_file_rm.sh",
     src: "testcases/kernel/fs/racer/fs_racer_file_rm.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_file_rm.sh",
     compile_multilib: "both",
 }
@@ -19498,7 +19546,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fs_racer_file_symlink.sh",
     src: "testcases/kernel/fs/racer/fs_racer_file_symlink.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fs_racer_file_symlink.sh",
     compile_multilib: "both",
 }
@@ -19506,7 +19554,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_fsx.sh",
     src: "testcases/network/nfs/fsx-linux/fsx.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "fsx.sh",
     compile_multilib: "both",
 }
@@ -19514,7 +19562,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftp-download-stress.sh",
     src: "testcases/network/stress/ftp/ftp-download-stress.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftp-download-stress.sh",
     compile_multilib: "both",
 }
@@ -19522,7 +19570,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftp-download-stress01-rmt.sh",
     src: "testcases/network/stress/ftp/ftp-download-stress01-rmt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftp-download-stress01-rmt.sh",
     compile_multilib: "both",
 }
@@ -19530,7 +19578,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftp-download-stress02-rmt.sh",
     src: "testcases/network/stress/ftp/ftp-download-stress02-rmt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftp-download-stress02-rmt.sh",
     compile_multilib: "both",
 }
@@ -19538,7 +19586,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftp-upload-stress.sh",
     src: "testcases/network/stress/ftp/ftp-upload-stress.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftp-upload-stress.sh",
     compile_multilib: "both",
 }
@@ -19546,7 +19594,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftp-upload-stress01-rmt.sh",
     src: "testcases/network/stress/ftp/ftp-upload-stress01-rmt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftp-upload-stress01-rmt.sh",
     compile_multilib: "both",
 }
@@ -19554,7 +19602,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftp-upload-stress02-rmt.sh",
     src: "testcases/network/stress/ftp/ftp-upload-stress02-rmt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftp-upload-stress02-rmt.sh",
     compile_multilib: "both",
 }
@@ -19562,7 +19610,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftp01.sh",
     src: "testcases/network/tcp_cmds/ftp/ftp01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftp01.sh",
     compile_multilib: "both",
 }
@@ -19570,7 +19618,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_lib.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftrace_lib.sh",
     compile_multilib: "both",
 }
@@ -19578,7 +19626,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_regression01.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_regression01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftrace_regression01.sh",
     compile_multilib: "both",
 }
@@ -19586,7 +19634,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_regression02.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_regression02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftrace_regression02.sh",
     compile_multilib: "both",
 }
@@ -19594,7 +19642,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_buffer_size_kb.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_buffer_size_kb.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_buffer_size_kb.sh",
     compile_multilib: "both",
 }
@@ -19602,7 +19650,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_current_tracer.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_current_tracer.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_current_tracer.sh",
     compile_multilib: "both",
 }
@@ -19610,7 +19658,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_ftrace_enabled.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_ftrace_enabled.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_ftrace_enabled.sh",
     compile_multilib: "both",
 }
@@ -19618,7 +19666,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_function_profile_enabled.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_function_profile_enabled.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_function_profile_enabled.sh",
     compile_multilib: "both",
 }
@@ -19626,7 +19674,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_set_event.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_set_event.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_set_event.sh",
     compile_multilib: "both",
 }
@@ -19634,7 +19682,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_set_ftrace_filter.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_set_ftrace_filter.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_set_ftrace_filter.sh",
     compile_multilib: "both",
 }
@@ -19642,7 +19690,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_set_ftrace_pid.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_set_ftrace_pid.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_set_ftrace_pid.sh",
     compile_multilib: "both",
 }
@@ -19650,7 +19698,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_stack_max_size.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_stack_max_size.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_stack_max_size.sh",
     compile_multilib: "both",
 }
@@ -19658,7 +19706,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_stack_trace.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_stack_trace.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_stack_trace.sh",
     compile_multilib: "both",
 }
@@ -19666,7 +19714,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_trace.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_trace.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_trace.sh",
     compile_multilib: "both",
 }
@@ -19674,7 +19722,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_trace_clock.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_trace_clock.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_trace_clock.sh",
     compile_multilib: "both",
 }
@@ -19682,7 +19730,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_trace_options.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_trace_options.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_trace_options.sh",
     compile_multilib: "both",
 }
@@ -19690,7 +19738,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_trace_pipe.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_trace_pipe.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_trace_pipe.sh",
     compile_multilib: "both",
 }
@@ -19698,7 +19746,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_trace_stat.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_trace_stat.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_trace_stat.sh",
     compile_multilib: "both",
 }
@@ -19706,7 +19754,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_tracing_cpumask.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_tracing_cpumask.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_tracing_cpumask.sh",
     compile_multilib: "both",
 }
@@ -19714,7 +19762,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_tracing_enabled.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_tracing_enabled.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_tracing_enabled.sh",
     compile_multilib: "both",
 }
@@ -19722,7 +19770,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_tracing_max_latency.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_tracing_max_latency.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_tracing_max_latency.sh",
     compile_multilib: "both",
 }
@@ -19730,7 +19778,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_ftrace_tracing_on.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress/ftrace_tracing_on.sh",
-    sub_dir: "ltp/testcases/bin/ftrace_stress",
+    sub_dir: "vts_ltp_tests/testcases/bin/ftrace_stress",
     filename: "ftrace_tracing_on.sh",
     compile_multilib: "both",
 }
@@ -19738,7 +19786,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ftrace_stress_test.sh",
     src: "testcases/kernel/tracing/ftrace_test/ftrace_stress_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ftrace_stress_test.sh",
     compile_multilib: "both",
 }
@@ -19746,7 +19794,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_gdb01.sh",
     src: "testcases/commands/gdb/gdb01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "gdb01.sh",
     compile_multilib: "both",
 }
@@ -19754,7 +19802,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_generate_lvm_runfile.sh",
     src: "testcases/misc/lvm/generate_lvm_runfile.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "generate_lvm_runfile.sh",
     compile_multilib: "both",
 }
@@ -19762,7 +19810,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_geneve01.sh",
     src: "testcases/network/virt/geneve01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "geneve01.sh",
     compile_multilib: "both",
 }
@@ -19770,7 +19818,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_geneve02.sh",
     src: "testcases/network/virt/geneve02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "geneve02.sh",
     compile_multilib: "both",
 }
@@ -19778,7 +19826,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_get_ifname",
     src: "testcases/network/stress/ns-tools/get_ifname",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "get_ifname",
     compile_multilib: "both",
 }
@@ -19786,7 +19834,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_gre01.sh",
     src: "testcases/network/virt/gre01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "gre01.sh",
     compile_multilib: "both",
 }
@@ -19794,23 +19842,15 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_gre02.sh",
     src: "testcases/network/virt/gre02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "gre02.sh",
     compile_multilib: "both",
 }
 
-sh_test {
-    name: "ltp_testcases_bin_host01.sh",
-    src: "testcases/network/tcp_cmds/host/host01.sh",
-    sub_dir: "ltp/testcases/bin",
-    filename: "host01.sh",
-    compile_multilib: "both",
-}
-
 sh_test {
     name: "ltp_testcases_bin_http-stress.sh",
     src: "testcases/network/stress/http/http-stress.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "http-stress.sh",
     compile_multilib: "both",
 }
@@ -19818,7 +19858,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_http-stress01-rmt.sh",
     src: "testcases/network/stress/http/http-stress01-rmt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "http-stress01-rmt.sh",
     compile_multilib: "both",
 }
@@ -19826,7 +19866,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_http-stress02-rmt.sh",
     src: "testcases/network/stress/http/http-stress02-rmt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "http-stress02-rmt.sh",
     compile_multilib: "both",
 }
@@ -19834,7 +19874,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp-uni-basic.sh",
     src: "testcases/network/stress/icmp/icmp-uni-basic.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp-uni-basic.sh",
     compile_multilib: "both",
 }
@@ -19842,7 +19882,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp-uni-vti.sh",
     src: "testcases/network/stress/icmp/icmp-uni-vti.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp-uni-vti.sh",
     compile_multilib: "both",
 }
@@ -19850,7 +19890,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffip01",
     src: "testcases/network/stress/icmp/multi-diffip/icmp4-multi-diffip01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffip01",
     compile_multilib: "both",
 }
@@ -19858,7 +19898,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffip02",
     src: "testcases/network/stress/icmp/multi-diffip/icmp4-multi-diffip02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffip02",
     compile_multilib: "both",
 }
@@ -19866,7 +19906,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffip03",
     src: "testcases/network/stress/icmp/multi-diffip/icmp4-multi-diffip03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffip03",
     compile_multilib: "both",
 }
@@ -19874,7 +19914,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffip04",
     src: "testcases/network/stress/icmp/multi-diffip/icmp4-multi-diffip04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffip04",
     compile_multilib: "both",
 }
@@ -19882,7 +19922,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffip05",
     src: "testcases/network/stress/icmp/multi-diffip/icmp4-multi-diffip05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffip05",
     compile_multilib: "both",
 }
@@ -19890,7 +19930,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffip06",
     src: "testcases/network/stress/icmp/multi-diffip/icmp4-multi-diffip06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffip06",
     compile_multilib: "both",
 }
@@ -19898,7 +19938,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffip07",
     src: "testcases/network/stress/icmp/multi-diffip/icmp4-multi-diffip07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffip07",
     compile_multilib: "both",
 }
@@ -19906,7 +19946,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffnic01",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp4-multi-diffnic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffnic01",
     compile_multilib: "both",
 }
@@ -19914,7 +19954,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffnic02",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp4-multi-diffnic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffnic02",
     compile_multilib: "both",
 }
@@ -19922,7 +19962,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffnic03",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp4-multi-diffnic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffnic03",
     compile_multilib: "both",
 }
@@ -19930,7 +19970,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffnic04",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp4-multi-diffnic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffnic04",
     compile_multilib: "both",
 }
@@ -19938,7 +19978,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffnic05",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp4-multi-diffnic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffnic05",
     compile_multilib: "both",
 }
@@ -19946,7 +19986,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffnic06",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp4-multi-diffnic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffnic06",
     compile_multilib: "both",
 }
@@ -19954,7 +19994,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp4-multi-diffnic07",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp4-multi-diffnic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp4-multi-diffnic07",
     compile_multilib: "both",
 }
@@ -19962,7 +20002,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffip01",
     src: "testcases/network/stress/icmp/multi-diffip/icmp6-multi-diffip01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffip01",
     compile_multilib: "both",
 }
@@ -19970,7 +20010,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffip02",
     src: "testcases/network/stress/icmp/multi-diffip/icmp6-multi-diffip02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffip02",
     compile_multilib: "both",
 }
@@ -19978,7 +20018,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffip03",
     src: "testcases/network/stress/icmp/multi-diffip/icmp6-multi-diffip03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffip03",
     compile_multilib: "both",
 }
@@ -19986,7 +20026,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffip04",
     src: "testcases/network/stress/icmp/multi-diffip/icmp6-multi-diffip04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffip04",
     compile_multilib: "both",
 }
@@ -19994,7 +20034,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffip05",
     src: "testcases/network/stress/icmp/multi-diffip/icmp6-multi-diffip05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffip05",
     compile_multilib: "both",
 }
@@ -20002,7 +20042,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffip06",
     src: "testcases/network/stress/icmp/multi-diffip/icmp6-multi-diffip06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffip06",
     compile_multilib: "both",
 }
@@ -20010,7 +20050,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffip07",
     src: "testcases/network/stress/icmp/multi-diffip/icmp6-multi-diffip07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffip07",
     compile_multilib: "both",
 }
@@ -20018,7 +20058,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffnic01",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp6-multi-diffnic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffnic01",
     compile_multilib: "both",
 }
@@ -20026,7 +20066,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffnic02",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp6-multi-diffnic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffnic02",
     compile_multilib: "both",
 }
@@ -20034,7 +20074,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffnic03",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp6-multi-diffnic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffnic03",
     compile_multilib: "both",
 }
@@ -20042,7 +20082,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffnic04",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp6-multi-diffnic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffnic04",
     compile_multilib: "both",
 }
@@ -20050,7 +20090,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffnic05",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp6-multi-diffnic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffnic05",
     compile_multilib: "both",
 }
@@ -20058,7 +20098,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffnic06",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp6-multi-diffnic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffnic06",
     compile_multilib: "both",
 }
@@ -20066,7 +20106,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_icmp6-multi-diffnic07",
     src: "testcases/network/stress/icmp/multi-diffnic/icmp6-multi-diffnic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "icmp6-multi-diffnic07",
     compile_multilib: "both",
 }
@@ -20074,7 +20114,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_if-addr-adddel.sh",
     src: "testcases/network/stress/interface/if-addr-adddel.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "if-addr-adddel.sh",
     compile_multilib: "both",
 }
@@ -20082,7 +20122,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_if-addr-addlarge.sh",
     src: "testcases/network/stress/interface/if-addr-addlarge.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "if-addr-addlarge.sh",
     compile_multilib: "both",
 }
@@ -20090,7 +20130,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_if-lib.sh",
     src: "testcases/network/stress/interface/if-lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "if-lib.sh",
     compile_multilib: "both",
 }
@@ -20098,7 +20138,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_if-mtu-change.sh",
     src: "testcases/network/stress/interface/if-mtu-change.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "if-mtu-change.sh",
     compile_multilib: "both",
 }
@@ -20106,7 +20146,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_if-route-adddel.sh",
     src: "testcases/network/stress/interface/if-route-adddel.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "if-route-adddel.sh",
     compile_multilib: "both",
 }
@@ -20114,7 +20154,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_if-route-addlarge.sh",
     src: "testcases/network/stress/interface/if-route-addlarge.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "if-route-addlarge.sh",
     compile_multilib: "both",
 }
@@ -20122,7 +20162,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_if-updown.sh",
     src: "testcases/network/stress/interface/if-updown.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "if-updown.sh",
     compile_multilib: "both",
 }
@@ -20130,7 +20170,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_if4-addr-change.sh",
     src: "testcases/network/stress/interface/if4-addr-change.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "if4-addr-change.sh",
     compile_multilib: "both",
 }
@@ -20138,7 +20178,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_conditionals.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_conditionals.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_conditionals.sh",
     compile_multilib: "both",
 }
@@ -20146,7 +20186,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_kexec.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_kexec.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_kexec.sh",
     compile_multilib: "both",
 }
@@ -20154,7 +20194,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_keys.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_keys.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_keys.sh",
     compile_multilib: "both",
 }
@@ -20162,7 +20202,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_measurements.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_measurements.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_measurements.sh",
     compile_multilib: "both",
 }
@@ -20170,7 +20210,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_policy.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_policy.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_policy.sh",
     compile_multilib: "both",
 }
@@ -20178,7 +20218,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_selinux.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_selinux.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_selinux.sh",
     compile_multilib: "both",
 }
@@ -20186,7 +20226,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_setup.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_setup.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_setup.sh",
     compile_multilib: "both",
 }
@@ -20194,7 +20234,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_tpm.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_tpm.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_tpm.sh",
     compile_multilib: "both",
 }
@@ -20202,7 +20242,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ima_violations.sh",
     src: "testcases/kernel/security/integrity/ima/tests/ima_violations.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ima_violations.sh",
     compile_multilib: "both",
 }
@@ -20210,7 +20250,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_initialize_if",
     src: "testcases/network/stress/ns-tools/initialize_if",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "initialize_if",
     compile_multilib: "both",
 }
@@ -20218,7 +20258,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ip_tests.sh",
     src: "testcases/network/iproute/ip_tests.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ip_tests.sh",
     compile_multilib: "both",
 }
@@ -20226,7 +20266,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ipneigh01.sh",
     src: "testcases/network/tcp_cmds/ipneigh/ipneigh01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ipneigh01.sh",
     compile_multilib: "both",
 }
@@ -20234,7 +20274,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ipsec_lib.sh",
     src: "testcases/network/stress/ipsec/ipsec_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ipsec_lib.sh",
     compile_multilib: "both",
 }
@@ -20242,7 +20282,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_iptables01.sh",
     src: "testcases/network/iptables/iptables01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "iptables01.sh",
     compile_multilib: "both",
 }
@@ -20250,7 +20290,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_iptables_lib.sh",
     src: "testcases/network/iptables/iptables_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "iptables_lib.sh",
     compile_multilib: "both",
 }
@@ -20258,7 +20298,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ipvlan01.sh",
     src: "testcases/network/virt/ipvlan01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ipvlan01.sh",
     compile_multilib: "both",
 }
@@ -20266,7 +20306,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_isofs.sh",
     src: "testcases/kernel/fs/iso9660/isofs.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "isofs.sh",
     compile_multilib: "both",
 }
@@ -20274,7 +20314,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_killall_icmp_traffic",
     src: "testcases/network/stress/ns-tools/killall_icmp_traffic",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "killall_icmp_traffic",
     compile_multilib: "both",
 }
@@ -20282,7 +20322,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_killall_tcp_traffic",
     src: "testcases/network/stress/ns-tools/killall_tcp_traffic",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "killall_tcp_traffic",
     compile_multilib: "both",
 }
@@ -20290,7 +20330,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_killall_udp_traffic",
     src: "testcases/network/stress/ns-tools/killall_udp_traffic",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "killall_udp_traffic",
     compile_multilib: "both",
 }
@@ -20298,7 +20338,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ld01.sh",
     src: "testcases/commands/ld/ld01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ld01.sh",
     compile_multilib: "both",
 }
@@ -20306,7 +20346,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ldd01.sh",
     src: "testcases/commands/ldd/ldd01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ldd01.sh",
     compile_multilib: "both",
 }
@@ -20314,7 +20354,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_libcgroup_freezer",
     src: "testcases/kernel/controllers/freezer/libcgroup_freezer",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "libcgroup_freezer",
     compile_multilib: "both",
 }
@@ -20322,7 +20362,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_linktest.sh",
     src: "testcases/kernel/fs/linktest/linktest.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "linktest.sh",
     compile_multilib: "both",
 }
@@ -20330,7 +20370,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ln_tests.sh",
     src: "testcases/commands/ln/ln_tests.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ln_tests.sh",
     compile_multilib: "both",
 }
@@ -20338,7 +20378,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_lock_torture.sh",
     src: "testcases/kernel/device-drivers/locking/lock_torture.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "lock_torture.sh",
     compile_multilib: "both",
 }
@@ -20346,7 +20386,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ltpSockets.sh",
     src: "testcases/network/sockets/ltpSockets.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ltpSockets.sh",
     compile_multilib: "both",
 }
@@ -20354,7 +20394,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_macsec01.sh",
     src: "testcases/network/virt/macsec01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "macsec01.sh",
     compile_multilib: "both",
 }
@@ -20362,7 +20402,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_macsec02.sh",
     src: "testcases/network/virt/macsec02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "macsec02.sh",
     compile_multilib: "both",
 }
@@ -20370,7 +20410,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_macsec03.sh",
     src: "testcases/network/virt/macsec03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "macsec03.sh",
     compile_multilib: "both",
 }
@@ -20378,7 +20418,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_macsec_lib.sh",
     src: "testcases/network/virt/macsec_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "macsec_lib.sh",
     compile_multilib: "both",
 }
@@ -20386,7 +20426,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_macvlan01.sh",
     src: "testcases/network/virt/macvlan01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "macvlan01.sh",
     compile_multilib: "both",
 }
@@ -20394,7 +20434,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_macvtap01.sh",
     src: "testcases/network/virt/macvtap01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "macvtap01.sh",
     compile_multilib: "both",
 }
@@ -20402,7 +20442,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mc_cmds.sh",
     src: "testcases/network/multicast/mc_cmds/mc_cmds.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mc_cmds.sh",
     compile_multilib: "both",
 }
@@ -20410,7 +20450,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mc_commo.sh",
     src: "testcases/network/multicast/mc_commo/mc_commo.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mc_commo.sh",
     compile_multilib: "both",
 }
@@ -20418,7 +20458,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mc_member.sh",
     src: "testcases/network/multicast/mc_member/mc_member.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mc_member.sh",
     compile_multilib: "both",
 }
@@ -20426,7 +20466,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mc_opts.sh",
     src: "testcases/network/multicast/mc_opts/mc_opts.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mc_opts.sh",
     compile_multilib: "both",
 }
@@ -20434,7 +20474,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-group-multiple-socket.sh",
     src: "testcases/network/stress/multicast/grp-operation/mcast-group-multiple-socket.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-group-multiple-socket.sh",
     compile_multilib: "both",
 }
@@ -20442,7 +20482,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-group-same-group.sh",
     src: "testcases/network/stress/multicast/grp-operation/mcast-group-same-group.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-group-same-group.sh",
     compile_multilib: "both",
 }
@@ -20450,7 +20490,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-group-single-socket.sh",
     src: "testcases/network/stress/multicast/grp-operation/mcast-group-single-socket.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-group-single-socket.sh",
     compile_multilib: "both",
 }
@@ -20458,7 +20498,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-group-source-filter.sh",
     src: "testcases/network/stress/multicast/grp-operation/mcast-group-source-filter.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-group-source-filter.sh",
     compile_multilib: "both",
 }
@@ -20466,7 +20506,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-lib.sh",
     src: "testcases/network/stress/multicast/grp-operation/mcast-lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-lib.sh",
     compile_multilib: "both",
 }
@@ -20474,7 +20514,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-pktfld01.sh",
     src: "testcases/network/stress/multicast/packet-flood/mcast-pktfld01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-pktfld01.sh",
     compile_multilib: "both",
 }
@@ -20482,7 +20522,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-pktfld02.sh",
     src: "testcases/network/stress/multicast/packet-flood/mcast-pktfld02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-pktfld02.sh",
     compile_multilib: "both",
 }
@@ -20490,7 +20530,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-queryfld01.sh",
     src: "testcases/network/stress/multicast/query-flood/mcast-queryfld01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-queryfld01.sh",
     compile_multilib: "both",
 }
@@ -20498,7 +20538,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-queryfld02.sh",
     src: "testcases/network/stress/multicast/query-flood/mcast-queryfld02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-queryfld02.sh",
     compile_multilib: "both",
 }
@@ -20506,7 +20546,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-queryfld03.sh",
     src: "testcases/network/stress/multicast/query-flood/mcast-queryfld03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-queryfld03.sh",
     compile_multilib: "both",
 }
@@ -20514,7 +20554,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-queryfld04.sh",
     src: "testcases/network/stress/multicast/query-flood/mcast-queryfld04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-queryfld04.sh",
     compile_multilib: "both",
 }
@@ -20522,7 +20562,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-queryfld05.sh",
     src: "testcases/network/stress/multicast/query-flood/mcast-queryfld05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-queryfld05.sh",
     compile_multilib: "both",
 }
@@ -20530,7 +20570,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mcast-queryfld06.sh",
     src: "testcases/network/stress/multicast/query-flood/mcast-queryfld06.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mcast-queryfld06.sh",
     compile_multilib: "both",
 }
@@ -20538,7 +20578,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_control_test.sh",
     src: "testcases/kernel/controllers/memcg/control/memcg_control_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_control_test.sh",
     compile_multilib: "both",
 }
@@ -20546,7 +20586,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_failcnt.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_failcnt.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_failcnt.sh",
     compile_multilib: "both",
 }
@@ -20554,7 +20594,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_force_empty.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_force_empty.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_force_empty.sh",
     compile_multilib: "both",
 }
@@ -20562,7 +20602,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_lib.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_lib.sh",
     compile_multilib: "both",
 }
@@ -20570,7 +20610,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_limit_in_bytes.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_limit_in_bytes.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_limit_in_bytes.sh",
     compile_multilib: "both",
 }
@@ -20578,7 +20618,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_max_usage_in_bytes_test.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_max_usage_in_bytes_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_max_usage_in_bytes_test.sh",
     compile_multilib: "both",
 }
@@ -20586,7 +20626,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_memsw_limit_in_bytes_test.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_memsw_limit_in_bytes_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_memsw_limit_in_bytes_test.sh",
     compile_multilib: "both",
 }
@@ -20594,7 +20634,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_move_charge_at_immigrate_test.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_move_charge_at_immigrate_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_move_charge_at_immigrate_test.sh",
     compile_multilib: "both",
 }
@@ -20602,7 +20642,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_regression_test.sh",
     src: "testcases/kernel/controllers/memcg/regression/memcg_regression_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_regression_test.sh",
     compile_multilib: "both",
 }
@@ -20610,7 +20650,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_stat_rss.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_stat_rss.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_stat_rss.sh",
     compile_multilib: "both",
 }
@@ -20618,7 +20658,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_stat_test.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_stat_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_stat_test.sh",
     compile_multilib: "both",
 }
@@ -20626,7 +20666,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_stress_test.sh",
     src: "testcases/kernel/controllers/memcg/stress/memcg_stress_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_stress_test.sh",
     compile_multilib: "both",
 }
@@ -20634,7 +20674,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_subgroup_charge.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_subgroup_charge.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_subgroup_charge.sh",
     compile_multilib: "both",
 }
@@ -20642,7 +20682,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_test_4.sh",
     src: "testcases/kernel/controllers/memcg/regression/memcg_test_4.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_test_4.sh",
     compile_multilib: "both",
 }
@@ -20650,7 +20690,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_usage_in_bytes_test.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_usage_in_bytes_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_usage_in_bytes_test.sh",
     compile_multilib: "both",
 }
@@ -20658,7 +20698,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_memcg_use_hierarchy_test.sh",
     src: "testcases/kernel/controllers/memcg/functional/memcg_use_hierarchy_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "memcg_use_hierarchy_test.sh",
     compile_multilib: "both",
 }
@@ -20666,7 +20706,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mkdir_tests.sh",
     src: "testcases/commands/mkdir/mkdir_tests.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mkdir_tests.sh",
     compile_multilib: "both",
 }
@@ -20674,7 +20714,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mpls01.sh",
     src: "testcases/network/mpls/mpls01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mpls01.sh",
     compile_multilib: "both",
 }
@@ -20682,7 +20722,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mpls02.sh",
     src: "testcases/network/mpls/mpls02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mpls02.sh",
     compile_multilib: "both",
 }
@@ -20690,7 +20730,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mpls03.sh",
     src: "testcases/network/mpls/mpls03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mpls03.sh",
     compile_multilib: "both",
 }
@@ -20698,7 +20738,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mpls04.sh",
     src: "testcases/network/mpls/mpls04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mpls04.sh",
     compile_multilib: "both",
 }
@@ -20706,7 +20746,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_mpls_lib.sh",
     src: "testcases/network/mpls/mpls_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "mpls_lib.sh",
     compile_multilib: "both",
 }
@@ -20714,7 +20754,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_myfunctions.sh",
     src: "testcases/kernel/controllers/memctl/myfunctions.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "myfunctions.sh",
     compile_multilib: "both",
 }
@@ -20722,7 +20762,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_net_cmdlib.sh",
     src: "testcases/lib/net_cmdlib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "net_cmdlib.sh",
     compile_multilib: "both",
 }
@@ -20730,7 +20770,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_netns_lib.sh",
     src: "testcases/kernel/containers/netns/netns_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "netns_lib.sh",
     compile_multilib: "both",
 }
@@ -20738,7 +20778,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_netstat01.sh",
     src: "testcases/network/tcp_cmds/netstat/netstat01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "netstat01.sh",
     compile_multilib: "both",
 }
@@ -20746,7 +20786,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfs01.sh",
     src: "testcases/network/nfs/nfs_stress/nfs01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs01.sh",
     compile_multilib: "both",
 }
@@ -20754,7 +20794,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfs02.sh",
     src: "testcases/network/nfs/nfs_stress/nfs02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs02.sh",
     compile_multilib: "both",
 }
@@ -20762,7 +20802,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfs03.sh",
     src: "testcases/network/nfs/nfs_stress/nfs03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs03.sh",
     compile_multilib: "both",
 }
@@ -20770,7 +20810,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfs04.sh",
     src: "testcases/network/nfs/nfs_stress/nfs04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs04.sh",
     compile_multilib: "both",
 }
@@ -20778,7 +20818,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfs05.sh",
     src: "testcases/network/nfs/nfs_stress/nfs05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs05.sh",
     compile_multilib: "both",
 }
@@ -20786,7 +20826,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfs06.sh",
     src: "testcases/network/nfs/nfs_stress/nfs06.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs06.sh",
     compile_multilib: "both",
 }
@@ -20794,7 +20834,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfs07.sh",
     src: "testcases/network/nfs/nfs_stress/nfs07.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs07.sh",
     compile_multilib: "both",
 }
@@ -20802,15 +20842,23 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfs08.sh",
     src: "testcases/network/nfs/nfs_stress/nfs08.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs08.sh",
     compile_multilib: "both",
 }
 
+sh_test {
+    name: "ltp_testcases_bin_nfs09.sh",
+    src: "testcases/network/nfs/nfs_stress/nfs09.sh",
+    sub_dir: "vts_ltp_tests/testcases/bin",
+    filename: "nfs09.sh",
+    compile_multilib: "both",
+}
+
 sh_test {
     name: "ltp_testcases_bin_nfs_lib.sh",
     src: "testcases/network/nfs/nfs_stress/nfs_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfs_lib.sh",
     compile_multilib: "both",
 }
@@ -20818,7 +20866,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfslock01.sh",
     src: "testcases/network/nfs/nfslock01/nfslock01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfslock01.sh",
     compile_multilib: "both",
 }
@@ -20826,7 +20874,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nfsstat01.sh",
     src: "testcases/network/nfs/nfsstat01/nfsstat01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nfsstat01.sh",
     compile_multilib: "both",
 }
@@ -20834,7 +20882,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nft01.sh",
     src: "testcases/network/iptables/nft01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nft01.sh",
     compile_multilib: "both",
 }
@@ -20842,7 +20890,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_nm01.sh",
     src: "testcases/commands/nm/nm01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "nm01.sh",
     compile_multilib: "both",
 }
@@ -20850,7 +20898,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ns-echoclient",
     src: "testcases/network/stress/ns-tools/ns-echoclient",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ns-echoclient",
     compile_multilib: "both",
 }
@@ -20858,7 +20906,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_numa01.sh",
     src: "testcases/kernel/numa/numa01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "numa01.sh",
     compile_multilib: "both",
 }
@@ -20866,7 +20914,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_output_ipsec_conf",
     src: "testcases/network/stress/ns-tools/output_ipsec_conf",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "output_ipsec_conf",
     compile_multilib: "both",
 }
@@ -20874,7 +20922,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_parameters.sh",
     src: "testcases/kernel/controllers/cpuctl/parameters.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "parameters.sh",
     compile_multilib: "both",
 }
@@ -20882,7 +20930,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_pids.sh",
     src: "testcases/kernel/controllers/pids/pids.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "pids.sh",
     compile_multilib: "both",
 }
@@ -20890,7 +20938,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ping01.sh",
     src: "testcases/network/tcp_cmds/ping/ping01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ping01.sh",
     compile_multilib: "both",
 }
@@ -20898,7 +20946,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ping02.sh",
     src: "testcases/network/tcp_cmds/ping/ping02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ping02.sh",
     compile_multilib: "both",
 }
@@ -20906,7 +20954,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_pm_cpu_consolidation.py",
     src: "testcases/kernel/power_management/pm_cpu_consolidation.py",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "pm_cpu_consolidation.py",
     compile_multilib: "both",
 }
@@ -20914,7 +20962,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_pm_ilb_test.py",
     src: "testcases/kernel/power_management/pm_ilb_test.py",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "pm_ilb_test.py",
     compile_multilib: "both",
 }
@@ -20922,7 +20970,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_pm_include.sh",
     src: "testcases/kernel/power_management/pm_include.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "pm_include.sh",
     compile_multilib: "both",
 }
@@ -20930,7 +20978,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_pm_sched_domain.py",
     src: "testcases/kernel/power_management/pm_sched_domain.py",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "pm_sched_domain.py",
     compile_multilib: "both",
 }
@@ -20938,7 +20986,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_pm_sched_mc.py",
     src: "testcases/kernel/power_management/lib/pm_sched_mc.py",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "pm_sched_mc.py",
     compile_multilib: "both",
 }
@@ -20946,7 +20994,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_prepare_lvm.sh",
     src: "testcases/misc/lvm/prepare_lvm.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "prepare_lvm.sh",
     compile_multilib: "both",
 }
@@ -20954,7 +21002,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_quota_remount_test01.sh",
     src: "testcases/kernel/fs/quota_remount/quota_remount_test01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "quota_remount_test01.sh",
     compile_multilib: "both",
 }
@@ -20962,7 +21010,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_rcu_torture.sh",
     src: "testcases/kernel/device-drivers/rcu/rcu_torture.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "rcu_torture.sh",
     compile_multilib: "both",
 }
@@ -20970,7 +21018,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_remove_password.sh",
     src: "testcases/kernel/security/mmc_security/remove_password.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "remove_password.sh",
     compile_multilib: "both",
 }
@@ -20978,7 +21026,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route-change-dst.sh",
     src: "testcases/network/stress/route/route-change-dst.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route-change-dst.sh",
     compile_multilib: "both",
 }
@@ -20986,7 +21034,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route-change-gw.sh",
     src: "testcases/network/stress/route/route-change-gw.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route-change-gw.sh",
     compile_multilib: "both",
 }
@@ -20994,7 +21042,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route-change-if.sh",
     src: "testcases/network/stress/route/route-change-if.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route-change-if.sh",
     compile_multilib: "both",
 }
@@ -21002,7 +21050,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route-change-netlink-dst.sh",
     src: "testcases/network/stress/route/route-change-netlink-dst.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route-change-netlink-dst.sh",
     compile_multilib: "both",
 }
@@ -21010,7 +21058,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route-change-netlink-gw.sh",
     src: "testcases/network/stress/route/route-change-netlink-gw.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route-change-netlink-gw.sh",
     compile_multilib: "both",
 }
@@ -21018,7 +21066,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route-change-netlink-if.sh",
     src: "testcases/network/stress/route/route-change-netlink-if.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route-change-netlink-if.sh",
     compile_multilib: "both",
 }
@@ -21026,7 +21074,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route-lib.sh",
     src: "testcases/network/stress/route/route-lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route-lib.sh",
     compile_multilib: "both",
 }
@@ -21034,7 +21082,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route-redirect.sh",
     src: "testcases/network/stress/route/route-redirect.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route-redirect.sh",
     compile_multilib: "both",
 }
@@ -21042,7 +21090,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route4-rmmod",
     src: "testcases/network/stress/route/route4-rmmod",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route4-rmmod",
     compile_multilib: "both",
 }
@@ -21050,7 +21098,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_route6-rmmod",
     src: "testcases/network/stress/route/route6-rmmod",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "route6-rmmod",
     compile_multilib: "both",
 }
@@ -21058,7 +21106,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_run_capbounds.sh",
     src: "testcases/kernel/security/cap_bound/run_capbounds.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "run_capbounds.sh",
     compile_multilib: "both",
 }
@@ -21066,7 +21114,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_run_cpuctl_latency_test.sh",
     src: "testcases/kernel/controllers/cpuctl/run_cpuctl_latency_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "run_cpuctl_latency_test.sh",
     compile_multilib: "both",
 }
@@ -21074,7 +21122,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_run_cpuctl_stress_test.sh",
     src: "testcases/kernel/controllers/cpuctl/run_cpuctl_stress_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "run_cpuctl_stress_test.sh",
     compile_multilib: "both",
 }
@@ -21082,7 +21130,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_run_cpuctl_test.sh",
     src: "testcases/kernel/controllers/cpuctl/run_cpuctl_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "run_cpuctl_test.sh",
     compile_multilib: "both",
 }
@@ -21090,7 +21138,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_run_cpuctl_test_fj.sh",
     src: "testcases/kernel/controllers/cpuctl_fj/run_cpuctl_test_fj.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "run_cpuctl_test_fj.sh",
     compile_multilib: "both",
 }
@@ -21098,7 +21146,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_run_freezer.sh",
     src: "testcases/kernel/controllers/freezer/run_freezer.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "run_freezer.sh",
     compile_multilib: "both",
 }
@@ -21106,7 +21154,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_run_memctl_test.sh",
     src: "testcases/kernel/controllers/memctl/run_memctl_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "run_memctl_test.sh",
     compile_multilib: "both",
 }
@@ -21114,7 +21162,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_run_sched_cliserv.sh",
     src: "testcases/kernel/sched/clisrv/run_sched_cliserv.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "run_sched_cliserv.sh",
     compile_multilib: "both",
 }
@@ -21122,7 +21170,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests01.sh",
     src: "testcases/kernel/power_management/runpwtests01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests01.sh",
     compile_multilib: "both",
 }
@@ -21130,7 +21178,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests02.sh",
     src: "testcases/kernel/power_management/runpwtests02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests02.sh",
     compile_multilib: "both",
 }
@@ -21138,7 +21186,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests03.sh",
     src: "testcases/kernel/power_management/runpwtests03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests03.sh",
     compile_multilib: "both",
 }
@@ -21146,7 +21194,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests04.sh",
     src: "testcases/kernel/power_management/runpwtests04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests04.sh",
     compile_multilib: "both",
 }
@@ -21154,7 +21202,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests05.sh",
     src: "testcases/kernel/power_management/runpwtests05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests05.sh",
     compile_multilib: "both",
 }
@@ -21162,7 +21210,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests06.sh",
     src: "testcases/kernel/power_management/runpwtests06.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests06.sh",
     compile_multilib: "both",
 }
@@ -21170,7 +21218,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests_exclusive01.sh",
     src: "testcases/kernel/power_management/runpwtests_exclusive01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests_exclusive01.sh",
     compile_multilib: "both",
 }
@@ -21178,7 +21226,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests_exclusive02.sh",
     src: "testcases/kernel/power_management/runpwtests_exclusive02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests_exclusive02.sh",
     compile_multilib: "both",
 }
@@ -21186,7 +21234,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests_exclusive03.sh",
     src: "testcases/kernel/power_management/runpwtests_exclusive03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests_exclusive03.sh",
     compile_multilib: "both",
 }
@@ -21194,7 +21242,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests_exclusive04.sh",
     src: "testcases/kernel/power_management/runpwtests_exclusive04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests_exclusive04.sh",
     compile_multilib: "both",
 }
@@ -21202,7 +21250,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_runpwtests_exclusive05.sh",
     src: "testcases/kernel/power_management/runpwtests_exclusive05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "runpwtests_exclusive05.sh",
     compile_multilib: "both",
 }
@@ -21210,7 +21258,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_rwtest",
     src: "testcases/kernel/fs/doio/rwtest",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "rwtest",
     compile_multilib: "both",
 }
@@ -21218,7 +21266,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_sched_stress.sh",
     src: "testcases/kernel/sched/sched_stress/sched_stress.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "sched_stress.sh",
     compile_multilib: "both",
 }
@@ -21226,7 +21274,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_sctp01.sh",
     src: "testcases/network/sctp/sctp01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "sctp01.sh",
     compile_multilib: "both",
 }
@@ -21234,7 +21282,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_sctp_ipsec.sh",
     src: "testcases/network/stress/sctp/sctp_ipsec.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "sctp_ipsec.sh",
     compile_multilib: "both",
 }
@@ -21242,7 +21290,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_sctp_ipsec_vti.sh",
     src: "testcases/network/stress/sctp/sctp_ipsec_vti.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "sctp_ipsec_vti.sh",
     compile_multilib: "both",
 }
@@ -21250,7 +21298,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_sendfile01.sh",
     src: "testcases/network/tcp_cmds/sendfile/sendfile01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "sendfile01.sh",
     compile_multilib: "both",
 }
@@ -21258,7 +21306,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_set_ipv4addr",
     src: "testcases/network/stress/ns-tools/set_ipv4addr",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "set_ipv4addr",
     compile_multilib: "both",
 }
@@ -21266,7 +21314,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_shell_pipe01.sh",
     src: "testcases/commands/shell/shell_pipe01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "shell_pipe01.sh",
     compile_multilib: "both",
 }
@@ -21274,7 +21322,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_sit01.sh",
     src: "testcases/network/virt/sit01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "sit01.sh",
     compile_multilib: "both",
 }
@@ -21282,7 +21330,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_common.sh",
     src: "testcases/kernel/security/smack/smack_common.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_common.sh",
     compile_multilib: "both",
 }
@@ -21290,7 +21338,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_file_access.sh",
     src: "testcases/kernel/security/smack/smack_file_access.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_file_access.sh",
     compile_multilib: "both",
 }
@@ -21298,7 +21346,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_set_ambient.sh",
     src: "testcases/kernel/security/smack/smack_set_ambient.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_set_ambient.sh",
     compile_multilib: "both",
 }
@@ -21306,7 +21354,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_set_cipso.sh",
     src: "testcases/kernel/security/smack/smack_set_cipso.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_set_cipso.sh",
     compile_multilib: "both",
 }
@@ -21314,7 +21362,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_set_current.sh",
     src: "testcases/kernel/security/smack/smack_set_current.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_set_current.sh",
     compile_multilib: "both",
 }
@@ -21322,7 +21370,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_set_direct.sh",
     src: "testcases/kernel/security/smack/smack_set_direct.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_set_direct.sh",
     compile_multilib: "both",
 }
@@ -21330,7 +21378,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_set_doi.sh",
     src: "testcases/kernel/security/smack/smack_set_doi.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_set_doi.sh",
     compile_multilib: "both",
 }
@@ -21338,7 +21386,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_set_load.sh",
     src: "testcases/kernel/security/smack/smack_set_load.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_set_load.sh",
     compile_multilib: "both",
 }
@@ -21346,7 +21394,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_set_netlabel.sh",
     src: "testcases/kernel/security/smack/smack_set_netlabel.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_set_netlabel.sh",
     compile_multilib: "both",
 }
@@ -21354,7 +21402,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smack_set_onlycap.sh",
     src: "testcases/kernel/security/smack/smack_set_onlycap.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smack_set_onlycap.sh",
     compile_multilib: "both",
 }
@@ -21362,7 +21410,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smt_smp_affinity.sh",
     src: "testcases/kernel/sched/hyperthreading/ht_affinity/smt_smp_affinity.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smt_smp_affinity.sh",
     compile_multilib: "both",
 }
@@ -21370,7 +21418,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_smt_smp_enabled.sh",
     src: "testcases/kernel/sched/hyperthreading/ht_enabled/smt_smp_enabled.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "smt_smp_enabled.sh",
     compile_multilib: "both",
 }
@@ -21378,7 +21426,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_ssh-stress.sh",
     src: "testcases/network/stress/ssh/ssh-stress.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "ssh-stress.sh",
     compile_multilib: "both",
 }
@@ -21386,7 +21434,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_stop_freeze_sleep_thaw_cont.sh",
     src: "testcases/kernel/controllers/freezer/stop_freeze_sleep_thaw_cont.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "stop_freeze_sleep_thaw_cont.sh",
     compile_multilib: "both",
 }
@@ -21394,7 +21442,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_stop_freeze_thaw_cont.sh",
     src: "testcases/kernel/controllers/freezer/stop_freeze_thaw_cont.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "stop_freeze_thaw_cont.sh",
     compile_multilib: "both",
 }
@@ -21402,7 +21450,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_sysctl01.sh",
     src: "testcases/commands/sysctl/sysctl01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "sysctl01.sh",
     compile_multilib: "both",
 }
@@ -21410,7 +21458,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_sysctl02.sh",
     src: "testcases/commands/sysctl/sysctl02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "sysctl02.sh",
     compile_multilib: "both",
 }
@@ -21418,7 +21466,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tc01.sh",
     src: "testcases/network/tcp_cmds/tc/tc01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tc01.sh",
     compile_multilib: "both",
 }
@@ -21426,7 +21474,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip01",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip01",
     compile_multilib: "both",
 }
@@ -21434,7 +21482,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip02",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip02",
     compile_multilib: "both",
 }
@@ -21442,7 +21490,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip03",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip03",
     compile_multilib: "both",
 }
@@ -21450,7 +21498,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip04",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip04",
     compile_multilib: "both",
 }
@@ -21458,7 +21506,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip05",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip05",
     compile_multilib: "both",
 }
@@ -21466,7 +21514,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip06",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip06",
     compile_multilib: "both",
 }
@@ -21474,7 +21522,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip07",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip07",
     compile_multilib: "both",
 }
@@ -21482,7 +21530,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip08",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip08",
     compile_multilib: "both",
 }
@@ -21490,7 +21538,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip09",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip09",
     compile_multilib: "both",
 }
@@ -21498,7 +21546,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip10",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip10",
     compile_multilib: "both",
 }
@@ -21506,7 +21554,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip11",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip11",
     compile_multilib: "both",
 }
@@ -21514,7 +21562,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip12",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip12",
     compile_multilib: "both",
 }
@@ -21522,7 +21570,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip13",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip13",
     compile_multilib: "both",
 }
@@ -21530,7 +21578,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffip14",
     src: "testcases/network/stress/tcp/multi-diffip/tcp4-multi-diffip14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffip14",
     compile_multilib: "both",
 }
@@ -21538,7 +21586,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic01",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic01",
     compile_multilib: "both",
 }
@@ -21546,7 +21594,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic02",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic02",
     compile_multilib: "both",
 }
@@ -21554,7 +21602,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic03",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic03",
     compile_multilib: "both",
 }
@@ -21562,7 +21610,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic04",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic04",
     compile_multilib: "both",
 }
@@ -21570,7 +21618,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic05",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic05",
     compile_multilib: "both",
 }
@@ -21578,7 +21626,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic06",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic06",
     compile_multilib: "both",
 }
@@ -21586,7 +21634,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic07",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic07",
     compile_multilib: "both",
 }
@@ -21594,7 +21642,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic08",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic08",
     compile_multilib: "both",
 }
@@ -21602,7 +21650,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic09",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic09",
     compile_multilib: "both",
 }
@@ -21610,7 +21658,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic10",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic10",
     compile_multilib: "both",
 }
@@ -21618,7 +21666,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic11",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic11",
     compile_multilib: "both",
 }
@@ -21626,7 +21674,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic12",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic12",
     compile_multilib: "both",
 }
@@ -21634,7 +21682,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic13",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic13",
     compile_multilib: "both",
 }
@@ -21642,7 +21690,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffnic14",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp4-multi-diffnic14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffnic14",
     compile_multilib: "both",
 }
@@ -21650,7 +21698,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport01",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport01",
     compile_multilib: "both",
 }
@@ -21658,7 +21706,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport02",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport02",
     compile_multilib: "both",
 }
@@ -21666,7 +21714,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport03",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport03",
     compile_multilib: "both",
 }
@@ -21674,7 +21722,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport04",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport04",
     compile_multilib: "both",
 }
@@ -21682,7 +21730,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport05",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport05",
     compile_multilib: "both",
 }
@@ -21690,7 +21738,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport06",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport06",
     compile_multilib: "both",
 }
@@ -21698,7 +21746,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport07",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport07",
     compile_multilib: "both",
 }
@@ -21706,7 +21754,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport08",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport08",
     compile_multilib: "both",
 }
@@ -21714,7 +21762,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport09",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport09",
     compile_multilib: "both",
 }
@@ -21722,7 +21770,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport10",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport10",
     compile_multilib: "both",
 }
@@ -21730,7 +21778,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport11",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport11",
     compile_multilib: "both",
 }
@@ -21738,7 +21786,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport12",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport12",
     compile_multilib: "both",
 }
@@ -21746,7 +21794,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport13",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport13",
     compile_multilib: "both",
 }
@@ -21754,7 +21802,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-diffport14",
     src: "testcases/network/stress/tcp/multi-diffport/tcp4-multi-diffport14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-diffport14",
     compile_multilib: "both",
 }
@@ -21762,7 +21810,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport01",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport01",
     compile_multilib: "both",
 }
@@ -21770,7 +21818,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport02",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport02",
     compile_multilib: "both",
 }
@@ -21778,7 +21826,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport03",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport03",
     compile_multilib: "both",
 }
@@ -21786,7 +21834,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport04",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport04",
     compile_multilib: "both",
 }
@@ -21794,7 +21842,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport05",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport05",
     compile_multilib: "both",
 }
@@ -21802,7 +21850,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport06",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport06",
     compile_multilib: "both",
 }
@@ -21810,7 +21858,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport07",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport07",
     compile_multilib: "both",
 }
@@ -21818,7 +21866,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport08",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport08",
     compile_multilib: "both",
 }
@@ -21826,7 +21874,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport09",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport09",
     compile_multilib: "both",
 }
@@ -21834,7 +21882,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport10",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport10",
     compile_multilib: "both",
 }
@@ -21842,7 +21890,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport11",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport11",
     compile_multilib: "both",
 }
@@ -21850,7 +21898,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport12",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport12",
     compile_multilib: "both",
 }
@@ -21858,7 +21906,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport13",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport13",
     compile_multilib: "both",
 }
@@ -21866,7 +21914,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-multi-sameport14",
     src: "testcases/network/stress/tcp/multi-sameport/tcp4-multi-sameport14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-multi-sameport14",
     compile_multilib: "both",
 }
@@ -21874,7 +21922,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic01",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic01",
     compile_multilib: "both",
 }
@@ -21882,7 +21930,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic02",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic02",
     compile_multilib: "both",
 }
@@ -21890,7 +21938,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic03",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic03",
     compile_multilib: "both",
 }
@@ -21898,7 +21946,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic04",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic04",
     compile_multilib: "both",
 }
@@ -21906,7 +21954,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic05",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic05",
     compile_multilib: "both",
 }
@@ -21914,7 +21962,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic06",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic06",
     compile_multilib: "both",
 }
@@ -21922,7 +21970,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic07",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic07",
     compile_multilib: "both",
 }
@@ -21930,7 +21978,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic08",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic08",
     compile_multilib: "both",
 }
@@ -21938,7 +21986,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic09",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic09",
     compile_multilib: "both",
 }
@@ -21946,7 +21994,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic10",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic10",
     compile_multilib: "both",
 }
@@ -21954,7 +22002,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic11",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic11",
     compile_multilib: "both",
 }
@@ -21962,7 +22010,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic12",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic12",
     compile_multilib: "both",
 }
@@ -21970,7 +22018,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic13",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic13",
     compile_multilib: "both",
 }
@@ -21978,7 +22026,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-basic14",
     src: "testcases/network/stress/tcp/uni-basic/tcp4-uni-basic14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-basic14",
     compile_multilib: "both",
 }
@@ -21986,7 +22034,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff01",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff01",
     compile_multilib: "both",
 }
@@ -21994,7 +22042,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff02",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff02",
     compile_multilib: "both",
 }
@@ -22002,7 +22050,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff03",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff03",
     compile_multilib: "both",
 }
@@ -22010,7 +22058,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff04",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff04",
     compile_multilib: "both",
 }
@@ -22018,7 +22066,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff05",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff05",
     compile_multilib: "both",
 }
@@ -22026,7 +22074,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff06",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff06",
     compile_multilib: "both",
 }
@@ -22034,7 +22082,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff07",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff07",
     compile_multilib: "both",
 }
@@ -22042,7 +22090,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff08",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff08",
     compile_multilib: "both",
 }
@@ -22050,7 +22098,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff09",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff09",
     compile_multilib: "both",
 }
@@ -22058,7 +22106,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff10",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff10",
     compile_multilib: "both",
 }
@@ -22066,7 +22114,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff11",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff11",
     compile_multilib: "both",
 }
@@ -22074,7 +22122,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff12",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff12",
     compile_multilib: "both",
 }
@@ -22082,7 +22130,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff13",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff13",
     compile_multilib: "both",
 }
@@ -22090,7 +22138,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-dsackoff14",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp4-uni-dsackoff14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-dsackoff14",
     compile_multilib: "both",
 }
@@ -22098,7 +22146,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup01",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup01",
     compile_multilib: "both",
 }
@@ -22106,7 +22154,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup02",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup02",
     compile_multilib: "both",
 }
@@ -22114,7 +22162,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup03",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup03",
     compile_multilib: "both",
 }
@@ -22122,7 +22170,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup04",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup04",
     compile_multilib: "both",
 }
@@ -22130,7 +22178,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup05",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup05",
     compile_multilib: "both",
 }
@@ -22138,7 +22186,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup06",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup06",
     compile_multilib: "both",
 }
@@ -22146,7 +22194,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup07",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup07",
     compile_multilib: "both",
 }
@@ -22154,7 +22202,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup08",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup08",
     compile_multilib: "both",
 }
@@ -22162,7 +22210,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup09",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup09",
     compile_multilib: "both",
 }
@@ -22170,7 +22218,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup10",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup10",
     compile_multilib: "both",
 }
@@ -22178,7 +22226,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup11",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup11",
     compile_multilib: "both",
 }
@@ -22186,7 +22234,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup12",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup12",
     compile_multilib: "both",
 }
@@ -22194,7 +22242,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup13",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup13",
     compile_multilib: "both",
 }
@@ -22202,7 +22250,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-pktlossdup14",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp4-uni-pktlossdup14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-pktlossdup14",
     compile_multilib: "both",
 }
@@ -22210,7 +22258,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff01",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff01",
     compile_multilib: "both",
 }
@@ -22218,7 +22266,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff02",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff02",
     compile_multilib: "both",
 }
@@ -22226,7 +22274,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff03",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff03",
     compile_multilib: "both",
 }
@@ -22234,7 +22282,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff04",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff04",
     compile_multilib: "both",
 }
@@ -22242,7 +22290,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff05",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff05",
     compile_multilib: "both",
 }
@@ -22250,7 +22298,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff06",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff06",
     compile_multilib: "both",
 }
@@ -22258,7 +22306,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff07",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff07",
     compile_multilib: "both",
 }
@@ -22266,7 +22314,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff08",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff08",
     compile_multilib: "both",
 }
@@ -22274,7 +22322,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff09",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff09",
     compile_multilib: "both",
 }
@@ -22282,7 +22330,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff10",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff10",
     compile_multilib: "both",
 }
@@ -22290,7 +22338,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff11",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff11",
     compile_multilib: "both",
 }
@@ -22298,7 +22346,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff12",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff12",
     compile_multilib: "both",
 }
@@ -22306,7 +22354,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff13",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff13",
     compile_multilib: "both",
 }
@@ -22314,7 +22362,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-sackoff14",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp4-uni-sackoff14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-sackoff14",
     compile_multilib: "both",
 }
@@ -22322,7 +22370,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend01",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend01",
     compile_multilib: "both",
 }
@@ -22330,7 +22378,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend02",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend02",
     compile_multilib: "both",
 }
@@ -22338,7 +22386,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend03",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend03",
     compile_multilib: "both",
 }
@@ -22346,7 +22394,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend04",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend04",
     compile_multilib: "both",
 }
@@ -22354,7 +22402,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend05",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend05",
     compile_multilib: "both",
 }
@@ -22362,7 +22410,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend06",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend06",
     compile_multilib: "both",
 }
@@ -22370,7 +22418,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend07",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend07",
     compile_multilib: "both",
 }
@@ -22378,7 +22426,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend08",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend08",
     compile_multilib: "both",
 }
@@ -22386,7 +22434,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend09",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend09",
     compile_multilib: "both",
 }
@@ -22394,7 +22442,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend10",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend10",
     compile_multilib: "both",
 }
@@ -22402,7 +22450,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend11",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend11",
     compile_multilib: "both",
 }
@@ -22410,7 +22458,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend12",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend12",
     compile_multilib: "both",
 }
@@ -22418,7 +22466,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend13",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend13",
     compile_multilib: "both",
 }
@@ -22426,7 +22474,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-smallsend14",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp4-uni-smallsend14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-smallsend14",
     compile_multilib: "both",
 }
@@ -22434,7 +22482,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso01",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso01",
     compile_multilib: "both",
 }
@@ -22442,7 +22490,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso02",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso02",
     compile_multilib: "both",
 }
@@ -22450,7 +22498,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso03",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso03",
     compile_multilib: "both",
 }
@@ -22458,7 +22506,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso04",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso04",
     compile_multilib: "both",
 }
@@ -22466,7 +22514,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso05",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso05",
     compile_multilib: "both",
 }
@@ -22474,7 +22522,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso06",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso06",
     compile_multilib: "both",
 }
@@ -22482,7 +22530,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso07",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso07",
     compile_multilib: "both",
 }
@@ -22490,7 +22538,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso08",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso08",
     compile_multilib: "both",
 }
@@ -22498,7 +22546,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso09",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso09",
     compile_multilib: "both",
 }
@@ -22506,7 +22554,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso10",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso10",
     compile_multilib: "both",
 }
@@ -22514,7 +22562,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso11",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso11",
     compile_multilib: "both",
 }
@@ -22522,7 +22570,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso12",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso12",
     compile_multilib: "both",
 }
@@ -22530,7 +22578,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso13",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso13",
     compile_multilib: "both",
 }
@@ -22538,7 +22586,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-tso14",
     src: "testcases/network/stress/tcp/uni-tso/tcp4-uni-tso14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-tso14",
     compile_multilib: "both",
 }
@@ -22546,7 +22594,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale01",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale01",
     compile_multilib: "both",
 }
@@ -22554,7 +22602,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale02",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale02",
     compile_multilib: "both",
 }
@@ -22562,7 +22610,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale03",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale03",
     compile_multilib: "both",
 }
@@ -22570,7 +22618,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale04",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale04",
     compile_multilib: "both",
 }
@@ -22578,7 +22626,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale05",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale05",
     compile_multilib: "both",
 }
@@ -22586,7 +22634,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale06",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale06",
     compile_multilib: "both",
 }
@@ -22594,7 +22642,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale07",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale07",
     compile_multilib: "both",
 }
@@ -22602,7 +22650,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale08",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale08",
     compile_multilib: "both",
 }
@@ -22610,7 +22658,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale09",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale09",
     compile_multilib: "both",
 }
@@ -22618,7 +22666,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale10",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale10",
     compile_multilib: "both",
 }
@@ -22626,7 +22674,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale11",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale11",
     compile_multilib: "both",
 }
@@ -22634,7 +22682,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale12",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale12",
     compile_multilib: "both",
 }
@@ -22642,7 +22690,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale13",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale13",
     compile_multilib: "both",
 }
@@ -22650,7 +22698,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp4-uni-winscale14",
     src: "testcases/network/stress/tcp/uni-winscale/tcp4-uni-winscale14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp4-uni-winscale14",
     compile_multilib: "both",
 }
@@ -22658,7 +22706,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip01",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip01",
     compile_multilib: "both",
 }
@@ -22666,7 +22714,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip02",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip02",
     compile_multilib: "both",
 }
@@ -22674,7 +22722,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip03",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip03",
     compile_multilib: "both",
 }
@@ -22682,7 +22730,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip04",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip04",
     compile_multilib: "both",
 }
@@ -22690,7 +22738,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip05",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip05",
     compile_multilib: "both",
 }
@@ -22698,7 +22746,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip06",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip06",
     compile_multilib: "both",
 }
@@ -22706,7 +22754,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip07",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip07",
     compile_multilib: "both",
 }
@@ -22714,7 +22762,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip08",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip08",
     compile_multilib: "both",
 }
@@ -22722,7 +22770,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip09",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip09",
     compile_multilib: "both",
 }
@@ -22730,7 +22778,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip10",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip10",
     compile_multilib: "both",
 }
@@ -22738,7 +22786,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip11",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip11",
     compile_multilib: "both",
 }
@@ -22746,7 +22794,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip12",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip12",
     compile_multilib: "both",
 }
@@ -22754,7 +22802,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip13",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip13",
     compile_multilib: "both",
 }
@@ -22762,7 +22810,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffip14",
     src: "testcases/network/stress/tcp/multi-diffip/tcp6-multi-diffip14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffip14",
     compile_multilib: "both",
 }
@@ -22770,7 +22818,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic01",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic01",
     compile_multilib: "both",
 }
@@ -22778,7 +22826,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic02",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic02",
     compile_multilib: "both",
 }
@@ -22786,7 +22834,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic03",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic03",
     compile_multilib: "both",
 }
@@ -22794,7 +22842,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic04",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic04",
     compile_multilib: "both",
 }
@@ -22802,7 +22850,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic05",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic05",
     compile_multilib: "both",
 }
@@ -22810,7 +22858,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic06",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic06",
     compile_multilib: "both",
 }
@@ -22818,7 +22866,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic07",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic07",
     compile_multilib: "both",
 }
@@ -22826,7 +22874,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic08",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic08",
     compile_multilib: "both",
 }
@@ -22834,7 +22882,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic09",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic09",
     compile_multilib: "both",
 }
@@ -22842,7 +22890,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic10",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic10",
     compile_multilib: "both",
 }
@@ -22850,7 +22898,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic11",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic11",
     compile_multilib: "both",
 }
@@ -22858,7 +22906,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic12",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic12",
     compile_multilib: "both",
 }
@@ -22866,7 +22914,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic13",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic13",
     compile_multilib: "both",
 }
@@ -22874,7 +22922,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffnic14",
     src: "testcases/network/stress/tcp/multi-diffnic/tcp6-multi-diffnic14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffnic14",
     compile_multilib: "both",
 }
@@ -22882,7 +22930,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport01",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport01",
     compile_multilib: "both",
 }
@@ -22890,7 +22938,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport02",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport02",
     compile_multilib: "both",
 }
@@ -22898,7 +22946,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport03",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport03",
     compile_multilib: "both",
 }
@@ -22906,7 +22954,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport04",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport04",
     compile_multilib: "both",
 }
@@ -22914,7 +22962,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport05",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport05",
     compile_multilib: "both",
 }
@@ -22922,7 +22970,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport06",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport06",
     compile_multilib: "both",
 }
@@ -22930,7 +22978,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport07",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport07",
     compile_multilib: "both",
 }
@@ -22938,7 +22986,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport08",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport08",
     compile_multilib: "both",
 }
@@ -22946,7 +22994,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport09",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport09",
     compile_multilib: "both",
 }
@@ -22954,7 +23002,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport10",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport10",
     compile_multilib: "both",
 }
@@ -22962,7 +23010,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport11",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport11",
     compile_multilib: "both",
 }
@@ -22970,7 +23018,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport12",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport12",
     compile_multilib: "both",
 }
@@ -22978,7 +23026,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport13",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport13",
     compile_multilib: "both",
 }
@@ -22986,7 +23034,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-diffport14",
     src: "testcases/network/stress/tcp/multi-diffport/tcp6-multi-diffport14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-diffport14",
     compile_multilib: "both",
 }
@@ -22994,7 +23042,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport01",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport01",
     compile_multilib: "both",
 }
@@ -23002,7 +23050,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport02",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport02",
     compile_multilib: "both",
 }
@@ -23010,7 +23058,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport03",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport03",
     compile_multilib: "both",
 }
@@ -23018,7 +23066,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport04",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport04",
     compile_multilib: "both",
 }
@@ -23026,7 +23074,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport05",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport05",
     compile_multilib: "both",
 }
@@ -23034,7 +23082,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport06",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport06",
     compile_multilib: "both",
 }
@@ -23042,7 +23090,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport07",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport07",
     compile_multilib: "both",
 }
@@ -23050,7 +23098,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport08",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport08",
     compile_multilib: "both",
 }
@@ -23058,7 +23106,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport09",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport09",
     compile_multilib: "both",
 }
@@ -23066,7 +23114,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport10",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport10",
     compile_multilib: "both",
 }
@@ -23074,7 +23122,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport11",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport11",
     compile_multilib: "both",
 }
@@ -23082,7 +23130,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport12",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport12",
     compile_multilib: "both",
 }
@@ -23090,7 +23138,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport13",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport13",
     compile_multilib: "both",
 }
@@ -23098,7 +23146,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-multi-sameport14",
     src: "testcases/network/stress/tcp/multi-sameport/tcp6-multi-sameport14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-multi-sameport14",
     compile_multilib: "both",
 }
@@ -23106,7 +23154,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic01",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic01",
     compile_multilib: "both",
 }
@@ -23114,7 +23162,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic02",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic02",
     compile_multilib: "both",
 }
@@ -23122,7 +23170,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic03",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic03",
     compile_multilib: "both",
 }
@@ -23130,7 +23178,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic04",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic04",
     compile_multilib: "both",
 }
@@ -23138,7 +23186,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic05",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic05",
     compile_multilib: "both",
 }
@@ -23146,7 +23194,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic06",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic06",
     compile_multilib: "both",
 }
@@ -23154,7 +23202,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic07",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic07",
     compile_multilib: "both",
 }
@@ -23162,7 +23210,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic08",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic08",
     compile_multilib: "both",
 }
@@ -23170,7 +23218,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic09",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic09",
     compile_multilib: "both",
 }
@@ -23178,7 +23226,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic10",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic10",
     compile_multilib: "both",
 }
@@ -23186,7 +23234,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic11",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic11",
     compile_multilib: "both",
 }
@@ -23194,7 +23242,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic12",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic12",
     compile_multilib: "both",
 }
@@ -23202,7 +23250,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic13",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic13",
     compile_multilib: "both",
 }
@@ -23210,7 +23258,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-basic14",
     src: "testcases/network/stress/tcp/uni-basic/tcp6-uni-basic14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-basic14",
     compile_multilib: "both",
 }
@@ -23218,7 +23266,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff01",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff01",
     compile_multilib: "both",
 }
@@ -23226,7 +23274,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff02",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff02",
     compile_multilib: "both",
 }
@@ -23234,7 +23282,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff03",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff03",
     compile_multilib: "both",
 }
@@ -23242,7 +23290,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff04",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff04",
     compile_multilib: "both",
 }
@@ -23250,7 +23298,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff05",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff05",
     compile_multilib: "both",
 }
@@ -23258,7 +23306,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff06",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff06",
     compile_multilib: "both",
 }
@@ -23266,7 +23314,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff07",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff07",
     compile_multilib: "both",
 }
@@ -23274,7 +23322,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff08",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff08",
     compile_multilib: "both",
 }
@@ -23282,7 +23330,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff09",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff09",
     compile_multilib: "both",
 }
@@ -23290,7 +23338,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff10",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff10",
     compile_multilib: "both",
 }
@@ -23298,7 +23346,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff11",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff11",
     compile_multilib: "both",
 }
@@ -23306,7 +23354,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff12",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff12",
     compile_multilib: "both",
 }
@@ -23314,7 +23362,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff13",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff13",
     compile_multilib: "both",
 }
@@ -23322,7 +23370,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-dsackoff14",
     src: "testcases/network/stress/tcp/uni-dsackoff/tcp6-uni-dsackoff14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-dsackoff14",
     compile_multilib: "both",
 }
@@ -23330,7 +23378,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup01",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup01",
     compile_multilib: "both",
 }
@@ -23338,7 +23386,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup02",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup02",
     compile_multilib: "both",
 }
@@ -23346,7 +23394,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup03",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup03",
     compile_multilib: "both",
 }
@@ -23354,7 +23402,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup04",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup04",
     compile_multilib: "both",
 }
@@ -23362,7 +23410,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup05",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup05",
     compile_multilib: "both",
 }
@@ -23370,7 +23418,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup06",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup06",
     compile_multilib: "both",
 }
@@ -23378,7 +23426,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup07",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup07",
     compile_multilib: "both",
 }
@@ -23386,7 +23434,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup08",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup08",
     compile_multilib: "both",
 }
@@ -23394,7 +23442,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup09",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup09",
     compile_multilib: "both",
 }
@@ -23402,7 +23450,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup10",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup10",
     compile_multilib: "both",
 }
@@ -23410,7 +23458,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup11",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup11",
     compile_multilib: "both",
 }
@@ -23418,7 +23466,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup12",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup12",
     compile_multilib: "both",
 }
@@ -23426,7 +23474,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup13",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup13",
     compile_multilib: "both",
 }
@@ -23434,7 +23482,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-pktlossdup14",
     src: "testcases/network/stress/tcp/uni-pktlossdup/tcp6-uni-pktlossdup14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-pktlossdup14",
     compile_multilib: "both",
 }
@@ -23442,7 +23490,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff01",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff01",
     compile_multilib: "both",
 }
@@ -23450,7 +23498,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff02",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff02",
     compile_multilib: "both",
 }
@@ -23458,7 +23506,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff03",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff03",
     compile_multilib: "both",
 }
@@ -23466,7 +23514,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff04",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff04",
     compile_multilib: "both",
 }
@@ -23474,7 +23522,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff05",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff05",
     compile_multilib: "both",
 }
@@ -23482,7 +23530,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff06",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff06",
     compile_multilib: "both",
 }
@@ -23490,7 +23538,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff07",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff07",
     compile_multilib: "both",
 }
@@ -23498,7 +23546,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff08",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff08",
     compile_multilib: "both",
 }
@@ -23506,7 +23554,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff09",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff09",
     compile_multilib: "both",
 }
@@ -23514,7 +23562,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff10",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff10",
     compile_multilib: "both",
 }
@@ -23522,7 +23570,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff11",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff11",
     compile_multilib: "both",
 }
@@ -23530,7 +23578,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff12",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff12",
     compile_multilib: "both",
 }
@@ -23538,7 +23586,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff13",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff13",
     compile_multilib: "both",
 }
@@ -23546,7 +23594,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-sackoff14",
     src: "testcases/network/stress/tcp/uni-sackoff/tcp6-uni-sackoff14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-sackoff14",
     compile_multilib: "both",
 }
@@ -23554,7 +23602,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend01",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend01",
     compile_multilib: "both",
 }
@@ -23562,7 +23610,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend02",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend02",
     compile_multilib: "both",
 }
@@ -23570,7 +23618,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend03",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend03",
     compile_multilib: "both",
 }
@@ -23578,7 +23626,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend04",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend04",
     compile_multilib: "both",
 }
@@ -23586,7 +23634,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend05",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend05",
     compile_multilib: "both",
 }
@@ -23594,7 +23642,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend06",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend06",
     compile_multilib: "both",
 }
@@ -23602,7 +23650,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend07",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend07",
     compile_multilib: "both",
 }
@@ -23610,7 +23658,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend08",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend08",
     compile_multilib: "both",
 }
@@ -23618,7 +23666,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend09",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend09",
     compile_multilib: "both",
 }
@@ -23626,7 +23674,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend10",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend10",
     compile_multilib: "both",
 }
@@ -23634,7 +23682,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend11",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend11",
     compile_multilib: "both",
 }
@@ -23642,7 +23690,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend12",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend12",
     compile_multilib: "both",
 }
@@ -23650,7 +23698,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend13",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend13",
     compile_multilib: "both",
 }
@@ -23658,7 +23706,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-smallsend14",
     src: "testcases/network/stress/tcp/uni-smallsend/tcp6-uni-smallsend14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-smallsend14",
     compile_multilib: "both",
 }
@@ -23666,7 +23714,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso01",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso01",
     compile_multilib: "both",
 }
@@ -23674,7 +23722,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso02",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso02",
     compile_multilib: "both",
 }
@@ -23682,7 +23730,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso03",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso03",
     compile_multilib: "both",
 }
@@ -23690,7 +23738,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso04",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso04",
     compile_multilib: "both",
 }
@@ -23698,7 +23746,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso05",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso05",
     compile_multilib: "both",
 }
@@ -23706,7 +23754,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso06",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso06",
     compile_multilib: "both",
 }
@@ -23714,7 +23762,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso07",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso07",
     compile_multilib: "both",
 }
@@ -23722,7 +23770,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso08",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso08",
     compile_multilib: "both",
 }
@@ -23730,7 +23778,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso09",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso09",
     compile_multilib: "both",
 }
@@ -23738,7 +23786,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso10",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso10",
     compile_multilib: "both",
 }
@@ -23746,7 +23794,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso11",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso11",
     compile_multilib: "both",
 }
@@ -23754,7 +23802,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso12",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso12",
     compile_multilib: "both",
 }
@@ -23762,7 +23810,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso13",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso13",
     compile_multilib: "both",
 }
@@ -23770,7 +23818,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-tso14",
     src: "testcases/network/stress/tcp/uni-tso/tcp6-uni-tso14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-tso14",
     compile_multilib: "both",
 }
@@ -23778,7 +23826,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale01",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale01",
     compile_multilib: "both",
 }
@@ -23786,7 +23834,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale02",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale02",
     compile_multilib: "both",
 }
@@ -23794,7 +23842,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale03",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale03",
     compile_multilib: "both",
 }
@@ -23802,7 +23850,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale04",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale04",
     compile_multilib: "both",
 }
@@ -23810,7 +23858,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale05",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale05",
     compile_multilib: "both",
 }
@@ -23818,7 +23866,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale06",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale06",
     compile_multilib: "both",
 }
@@ -23826,7 +23874,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale07",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale07",
     compile_multilib: "both",
 }
@@ -23834,7 +23882,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale08",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale08",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale08",
     compile_multilib: "both",
 }
@@ -23842,7 +23890,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale09",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale09",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale09",
     compile_multilib: "both",
 }
@@ -23850,7 +23898,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale10",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale10",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale10",
     compile_multilib: "both",
 }
@@ -23858,7 +23906,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale11",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale11",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale11",
     compile_multilib: "both",
 }
@@ -23866,7 +23914,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale12",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale12",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale12",
     compile_multilib: "both",
 }
@@ -23874,7 +23922,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale13",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale13",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale13",
     compile_multilib: "both",
 }
@@ -23882,7 +23930,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp6-uni-winscale14",
     src: "testcases/network/stress/tcp/uni-winscale/tcp6-uni-winscale14",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp6-uni-winscale14",
     compile_multilib: "both",
 }
@@ -23890,7 +23938,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp_cc_lib.sh",
     src: "testcases/network/tcp_cc/tcp_cc_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp_cc_lib.sh",
     compile_multilib: "both",
 }
@@ -23898,7 +23946,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp_fastopen_run.sh",
     src: "testcases/network/tcp_fastopen/tcp_fastopen_run.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp_fastopen_run.sh",
     compile_multilib: "both",
 }
@@ -23906,7 +23954,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp_ipsec.sh",
     src: "testcases/network/stress/tcp/tcp_ipsec.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp_ipsec.sh",
     compile_multilib: "both",
 }
@@ -23914,7 +23962,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcp_ipsec_vti.sh",
     src: "testcases/network/stress/tcp/tcp_ipsec_vti.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcp_ipsec_vti.sh",
     compile_multilib: "both",
 }
@@ -23922,23 +23970,15 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tcpdump01.sh",
     src: "testcases/network/tcp_cmds/tcpdump/tcpdump01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tcpdump01.sh",
     compile_multilib: "both",
 }
 
-sh_test {
-    name: "ltp_testcases_bin_telnet01.sh",
-    src: "testcases/network/tcp_cmds/telnet/telnet01.sh",
-    sub_dir: "ltp/testcases/bin",
-    filename: "telnet01.sh",
-    compile_multilib: "both",
-}
-
 sh_test {
     name: "ltp_testcases_bin_test.sh",
     src: "testcases/lib/test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "test.sh",
     compile_multilib: "both",
 }
@@ -23946,7 +23986,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_test_controllers.sh",
     src: "testcases/kernel/controllers/test_controllers.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "test_controllers.sh",
     compile_multilib: "both",
 }
@@ -23954,7 +23994,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_test_ioctl",
     src: "testcases/kernel/syscalls/ioctl/test_ioctl",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "test_ioctl",
     compile_multilib: "both",
 }
@@ -23962,7 +24002,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_test_robind.sh",
     src: "testcases/kernel/fs/fs_readonly/test_robind.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "test_robind.sh",
     compile_multilib: "both",
 }
@@ -23970,7 +24010,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tracepath01.sh",
     src: "testcases/network/tcp_cmds/tracepath/tracepath01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tracepath01.sh",
     compile_multilib: "both",
 }
@@ -23978,7 +24018,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_traceroute01.sh",
     src: "testcases/network/traceroute/traceroute01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "traceroute01.sh",
     compile_multilib: "both",
 }
@@ -23986,7 +24026,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tst_ansi_color.sh",
     src: "testcases/lib/tst_ansi_color.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tst_ansi_color.sh",
     compile_multilib: "both",
 }
@@ -23994,7 +24034,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tst_net.sh",
     src: "testcases/lib/tst_net.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tst_net.sh",
     compile_multilib: "both",
 }
@@ -24002,7 +24042,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tst_net_stress.sh",
     src: "testcases/network/stress/ns-tools/tst_net_stress.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tst_net_stress.sh",
     compile_multilib: "both",
 }
@@ -24010,7 +24050,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tst_security.sh",
     src: "testcases/lib/tst_security.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tst_security.sh",
     compile_multilib: "both",
 }
@@ -24018,7 +24058,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_tst_test.sh",
     src: "testcases/lib/tst_test.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "tst_test.sh",
     compile_multilib: "both",
 }
@@ -24026,7 +24066,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffip01",
     src: "testcases/network/stress/udp/multi-diffip/udp4-multi-diffip01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffip01",
     compile_multilib: "both",
 }
@@ -24034,7 +24074,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffip02",
     src: "testcases/network/stress/udp/multi-diffip/udp4-multi-diffip02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffip02",
     compile_multilib: "both",
 }
@@ -24042,7 +24082,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffip03",
     src: "testcases/network/stress/udp/multi-diffip/udp4-multi-diffip03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffip03",
     compile_multilib: "both",
 }
@@ -24050,7 +24090,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffip04",
     src: "testcases/network/stress/udp/multi-diffip/udp4-multi-diffip04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffip04",
     compile_multilib: "both",
 }
@@ -24058,7 +24098,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffip05",
     src: "testcases/network/stress/udp/multi-diffip/udp4-multi-diffip05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffip05",
     compile_multilib: "both",
 }
@@ -24066,7 +24106,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffip06",
     src: "testcases/network/stress/udp/multi-diffip/udp4-multi-diffip06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffip06",
     compile_multilib: "both",
 }
@@ -24074,7 +24114,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffip07",
     src: "testcases/network/stress/udp/multi-diffip/udp4-multi-diffip07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffip07",
     compile_multilib: "both",
 }
@@ -24082,7 +24122,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffnic01",
     src: "testcases/network/stress/udp/multi-diffnic/udp4-multi-diffnic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffnic01",
     compile_multilib: "both",
 }
@@ -24090,7 +24130,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffnic02",
     src: "testcases/network/stress/udp/multi-diffnic/udp4-multi-diffnic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffnic02",
     compile_multilib: "both",
 }
@@ -24098,7 +24138,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffnic03",
     src: "testcases/network/stress/udp/multi-diffnic/udp4-multi-diffnic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffnic03",
     compile_multilib: "both",
 }
@@ -24106,7 +24146,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffnic04",
     src: "testcases/network/stress/udp/multi-diffnic/udp4-multi-diffnic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffnic04",
     compile_multilib: "both",
 }
@@ -24114,7 +24154,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffnic05",
     src: "testcases/network/stress/udp/multi-diffnic/udp4-multi-diffnic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffnic05",
     compile_multilib: "both",
 }
@@ -24122,7 +24162,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffnic06",
     src: "testcases/network/stress/udp/multi-diffnic/udp4-multi-diffnic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffnic06",
     compile_multilib: "both",
 }
@@ -24130,7 +24170,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffnic07",
     src: "testcases/network/stress/udp/multi-diffnic/udp4-multi-diffnic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffnic07",
     compile_multilib: "both",
 }
@@ -24138,7 +24178,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffport01",
     src: "testcases/network/stress/udp/multi-diffport/udp4-multi-diffport01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffport01",
     compile_multilib: "both",
 }
@@ -24146,7 +24186,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffport02",
     src: "testcases/network/stress/udp/multi-diffport/udp4-multi-diffport02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffport02",
     compile_multilib: "both",
 }
@@ -24154,7 +24194,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffport03",
     src: "testcases/network/stress/udp/multi-diffport/udp4-multi-diffport03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffport03",
     compile_multilib: "both",
 }
@@ -24162,7 +24202,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffport04",
     src: "testcases/network/stress/udp/multi-diffport/udp4-multi-diffport04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffport04",
     compile_multilib: "both",
 }
@@ -24170,7 +24210,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffport05",
     src: "testcases/network/stress/udp/multi-diffport/udp4-multi-diffport05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffport05",
     compile_multilib: "both",
 }
@@ -24178,7 +24218,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffport06",
     src: "testcases/network/stress/udp/multi-diffport/udp4-multi-diffport06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffport06",
     compile_multilib: "both",
 }
@@ -24186,7 +24226,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-multi-diffport07",
     src: "testcases/network/stress/udp/multi-diffport/udp4-multi-diffport07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-multi-diffport07",
     compile_multilib: "both",
 }
@@ -24194,7 +24234,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-uni-basic01",
     src: "testcases/network/stress/udp/uni-basic/udp4-uni-basic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-uni-basic01",
     compile_multilib: "both",
 }
@@ -24202,7 +24242,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-uni-basic02",
     src: "testcases/network/stress/udp/uni-basic/udp4-uni-basic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-uni-basic02",
     compile_multilib: "both",
 }
@@ -24210,7 +24250,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-uni-basic03",
     src: "testcases/network/stress/udp/uni-basic/udp4-uni-basic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-uni-basic03",
     compile_multilib: "both",
 }
@@ -24218,7 +24258,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-uni-basic04",
     src: "testcases/network/stress/udp/uni-basic/udp4-uni-basic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-uni-basic04",
     compile_multilib: "both",
 }
@@ -24226,7 +24266,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-uni-basic05",
     src: "testcases/network/stress/udp/uni-basic/udp4-uni-basic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-uni-basic05",
     compile_multilib: "both",
 }
@@ -24234,7 +24274,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-uni-basic06",
     src: "testcases/network/stress/udp/uni-basic/udp4-uni-basic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-uni-basic06",
     compile_multilib: "both",
 }
@@ -24242,7 +24282,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp4-uni-basic07",
     src: "testcases/network/stress/udp/uni-basic/udp4-uni-basic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp4-uni-basic07",
     compile_multilib: "both",
 }
@@ -24250,7 +24290,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffip01",
     src: "testcases/network/stress/udp/multi-diffip/udp6-multi-diffip01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffip01",
     compile_multilib: "both",
 }
@@ -24258,7 +24298,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffip02",
     src: "testcases/network/stress/udp/multi-diffip/udp6-multi-diffip02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffip02",
     compile_multilib: "both",
 }
@@ -24266,7 +24306,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffip03",
     src: "testcases/network/stress/udp/multi-diffip/udp6-multi-diffip03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffip03",
     compile_multilib: "both",
 }
@@ -24274,7 +24314,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffip04",
     src: "testcases/network/stress/udp/multi-diffip/udp6-multi-diffip04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffip04",
     compile_multilib: "both",
 }
@@ -24282,7 +24322,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffip05",
     src: "testcases/network/stress/udp/multi-diffip/udp6-multi-diffip05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffip05",
     compile_multilib: "both",
 }
@@ -24290,7 +24330,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffip06",
     src: "testcases/network/stress/udp/multi-diffip/udp6-multi-diffip06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffip06",
     compile_multilib: "both",
 }
@@ -24298,7 +24338,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffip07",
     src: "testcases/network/stress/udp/multi-diffip/udp6-multi-diffip07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffip07",
     compile_multilib: "both",
 }
@@ -24306,7 +24346,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffnic01",
     src: "testcases/network/stress/udp/multi-diffnic/udp6-multi-diffnic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffnic01",
     compile_multilib: "both",
 }
@@ -24314,7 +24354,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffnic02",
     src: "testcases/network/stress/udp/multi-diffnic/udp6-multi-diffnic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffnic02",
     compile_multilib: "both",
 }
@@ -24322,7 +24362,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffnic03",
     src: "testcases/network/stress/udp/multi-diffnic/udp6-multi-diffnic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffnic03",
     compile_multilib: "both",
 }
@@ -24330,7 +24370,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffnic04",
     src: "testcases/network/stress/udp/multi-diffnic/udp6-multi-diffnic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffnic04",
     compile_multilib: "both",
 }
@@ -24338,7 +24378,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffnic05",
     src: "testcases/network/stress/udp/multi-diffnic/udp6-multi-diffnic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffnic05",
     compile_multilib: "both",
 }
@@ -24346,7 +24386,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffnic06",
     src: "testcases/network/stress/udp/multi-diffnic/udp6-multi-diffnic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffnic06",
     compile_multilib: "both",
 }
@@ -24354,7 +24394,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffnic07",
     src: "testcases/network/stress/udp/multi-diffnic/udp6-multi-diffnic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffnic07",
     compile_multilib: "both",
 }
@@ -24362,7 +24402,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffport01",
     src: "testcases/network/stress/udp/multi-diffport/udp6-multi-diffport01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffport01",
     compile_multilib: "both",
 }
@@ -24370,7 +24410,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffport02",
     src: "testcases/network/stress/udp/multi-diffport/udp6-multi-diffport02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffport02",
     compile_multilib: "both",
 }
@@ -24378,7 +24418,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffport03",
     src: "testcases/network/stress/udp/multi-diffport/udp6-multi-diffport03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffport03",
     compile_multilib: "both",
 }
@@ -24386,7 +24426,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffport04",
     src: "testcases/network/stress/udp/multi-diffport/udp6-multi-diffport04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffport04",
     compile_multilib: "both",
 }
@@ -24394,7 +24434,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffport05",
     src: "testcases/network/stress/udp/multi-diffport/udp6-multi-diffport05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffport05",
     compile_multilib: "both",
 }
@@ -24402,7 +24442,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffport06",
     src: "testcases/network/stress/udp/multi-diffport/udp6-multi-diffport06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffport06",
     compile_multilib: "both",
 }
@@ -24410,7 +24450,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-multi-diffport07",
     src: "testcases/network/stress/udp/multi-diffport/udp6-multi-diffport07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-multi-diffport07",
     compile_multilib: "both",
 }
@@ -24418,7 +24458,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-uni-basic01",
     src: "testcases/network/stress/udp/uni-basic/udp6-uni-basic01",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-uni-basic01",
     compile_multilib: "both",
 }
@@ -24426,7 +24466,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-uni-basic02",
     src: "testcases/network/stress/udp/uni-basic/udp6-uni-basic02",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-uni-basic02",
     compile_multilib: "both",
 }
@@ -24434,7 +24474,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-uni-basic03",
     src: "testcases/network/stress/udp/uni-basic/udp6-uni-basic03",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-uni-basic03",
     compile_multilib: "both",
 }
@@ -24442,7 +24482,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-uni-basic04",
     src: "testcases/network/stress/udp/uni-basic/udp6-uni-basic04",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-uni-basic04",
     compile_multilib: "both",
 }
@@ -24450,7 +24490,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-uni-basic05",
     src: "testcases/network/stress/udp/uni-basic/udp6-uni-basic05",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-uni-basic05",
     compile_multilib: "both",
 }
@@ -24458,7 +24498,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-uni-basic06",
     src: "testcases/network/stress/udp/uni-basic/udp6-uni-basic06",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-uni-basic06",
     compile_multilib: "both",
 }
@@ -24466,7 +24506,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp6-uni-basic07",
     src: "testcases/network/stress/udp/uni-basic/udp6-uni-basic07",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp6-uni-basic07",
     compile_multilib: "both",
 }
@@ -24474,7 +24514,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp_ipsec.sh",
     src: "testcases/network/stress/udp/udp_ipsec.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp_ipsec.sh",
     compile_multilib: "both",
 }
@@ -24482,7 +24522,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_udp_ipsec_vti.sh",
     src: "testcases/network/stress/udp/udp_ipsec_vti.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "udp_ipsec_vti.sh",
     compile_multilib: "both",
 }
@@ -24490,7 +24530,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_unshare01.sh",
     src: "testcases/commands/unshare/unshare01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "unshare01.sh",
     compile_multilib: "both",
 }
@@ -24498,7 +24538,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_unzip01.sh",
     src: "testcases/commands/unzip/unzip01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "unzip01.sh",
     compile_multilib: "both",
 }
@@ -24506,7 +24546,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vfork_freeze.sh",
     src: "testcases/kernel/controllers/freezer/vfork_freeze.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vfork_freeze.sh",
     compile_multilib: "both",
 }
@@ -24514,7 +24554,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_virt_lib.sh",
     src: "testcases/network/virt/virt_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "virt_lib.sh",
     compile_multilib: "both",
 }
@@ -24522,7 +24562,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vlan01.sh",
     src: "testcases/network/virt/vlan01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vlan01.sh",
     compile_multilib: "both",
 }
@@ -24530,7 +24570,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vlan02.sh",
     src: "testcases/network/virt/vlan02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vlan02.sh",
     compile_multilib: "both",
 }
@@ -24538,7 +24578,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vlan03.sh",
     src: "testcases/network/virt/vlan03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vlan03.sh",
     compile_multilib: "both",
 }
@@ -24546,7 +24586,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vma05.sh",
     src: "testcases/kernel/mem/vma/vma05.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vma05.sh",
     compile_multilib: "both",
 }
@@ -24554,7 +24594,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vxlan01.sh",
     src: "testcases/network/virt/vxlan01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vxlan01.sh",
     compile_multilib: "both",
 }
@@ -24562,7 +24602,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vxlan02.sh",
     src: "testcases/network/virt/vxlan02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vxlan02.sh",
     compile_multilib: "both",
 }
@@ -24570,7 +24610,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vxlan03.sh",
     src: "testcases/network/virt/vxlan03.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vxlan03.sh",
     compile_multilib: "both",
 }
@@ -24578,7 +24618,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_vxlan04.sh",
     src: "testcases/network/virt/vxlan04.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "vxlan04.sh",
     compile_multilib: "both",
 }
@@ -24586,7 +24626,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_wireguard01.sh",
     src: "testcases/network/virt/wireguard01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "wireguard01.sh",
     compile_multilib: "both",
 }
@@ -24594,7 +24634,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_wireguard02.sh",
     src: "testcases/network/virt/wireguard02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "wireguard02.sh",
     compile_multilib: "both",
 }
@@ -24602,7 +24642,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_wireguard_lib.sh",
     src: "testcases/network/virt/wireguard_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "wireguard_lib.sh",
     compile_multilib: "both",
 }
@@ -24610,23 +24650,15 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_write_freezing.sh",
     src: "testcases/kernel/controllers/freezer/write_freezing.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "write_freezing.sh",
     compile_multilib: "both",
 }
 
-sh_test {
-    name: "ltp_testcases_bin_xinetd_tests.sh",
-    src: "testcases/network/xinetd/xinetd_tests.sh",
-    sub_dir: "ltp/testcases/bin",
-    filename: "xinetd_tests.sh",
-    compile_multilib: "both",
-}
-
 sh_test {
     name: "ltp_testcases_bin_zram01.sh",
     src: "testcases/kernel/device-drivers/zram/zram01.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "zram01.sh",
     compile_multilib: "both",
 }
@@ -24634,7 +24666,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_zram02.sh",
     src: "testcases/kernel/device-drivers/zram/zram02.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "zram02.sh",
     compile_multilib: "both",
 }
@@ -24642,7 +24674,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_bin_zram_lib.sh",
     src: "testcases/kernel/device-drivers/zram/zram_lib.sh",
-    sub_dir: "ltp/testcases/bin",
+    sub_dir: "vts_ltp_tests/testcases/bin",
     filename: "zram_lib.sh",
     compile_multilib: "both",
 }
@@ -25271,7 +25303,7 @@ cc_test {
     name: "ltp_tst_device",
     stem: "tst_device",
     defaults: ["ltp_test_defaults"],
-    srcs: ["lib/newlib_tests/tst_device.c"],
+    srcs: ["lib/tests/tst_device.c"],
     local_include_dirs: ["include/old"],
     static_libs: ["libltp_ltp"],
 }
@@ -25679,6 +25711,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_tst_safe_sscanf",
+    stem: "tst_safe_sscanf",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["lib/newlib_tests/tst_safe_sscanf.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_tst_secureboot_enabled",
     stem: "tst_secureboot_enabled",
@@ -25908,6 +25949,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_unlink09",
+    stem: "unlink09",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/unlink/unlink09.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_unlinkat01",
     stem: "unlinkat01",
@@ -26016,6 +26066,15 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
+cc_test {
+    name: "ltp_utime07",
+    stem: "utime07",
+    defaults: ["ltp_test_defaults"],
+    srcs: ["testcases/kernel/syscalls/utime/utime07.c"],
+    local_include_dirs: ["include/old"],
+    static_libs: ["libltp_ltp"],
+}
+
 cc_test {
     name: "ltp_utimensat01",
     stem: "utimensat01",
@@ -26417,15 +26476,6 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
-cc_test {
-    name: "ltp_waitpid02",
-    stem: "waitpid02",
-    defaults: ["ltp_test_defaults"],
-    srcs: ["testcases/kernel/syscalls/waitpid/waitpid02.c"],
-    local_include_dirs: ["include/old"],
-    static_libs: ["libltp_ltp"],
-}
-
 cc_test {
     name: "ltp_waitpid03",
     stem: "waitpid03",
@@ -26444,15 +26494,6 @@ cc_test {
     static_libs: ["libltp_ltp"],
 }
 
-cc_test {
-    name: "ltp_waitpid05",
-    stem: "waitpid05",
-    defaults: ["ltp_test_defaults"],
-    srcs: ["testcases/kernel/syscalls/waitpid/waitpid05.c"],
-    local_include_dirs: ["include/old"],
-    static_libs: ["libltp_ltp"],
-}
-
 cc_test {
     name: "ltp_waitpid06",
     stem: "waitpid06",
diff --git a/include/lapi/arch_prctl.h b/include/lapi/arch_prctl.h
new file mode 100644
index 000000000..a4e7f8458
--- /dev/null
+++ b/include/lapi/arch_prctl.h
@@ -0,0 +1,22 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) 2024 Cyril Hrubis <chrubis@suse.cz>
+ */
+#ifndef LAPI_ARCH_PRCTL_H__
+#define LAPI_ARCH_PRCTL_H__
+
+#include "config.h"
+
+#ifdef HAVE_ASM_PRCTL_H
+# include <asm/prctl.h>
+#endif
+
+#ifndef ARCH_GET_CPUID
+# define ARCH_GET_CPUID 0x1011
+#endif
+
+#ifndef ARCH_SET_CPUID
+# define ARCH_SET_CPUID 0x1012
+#endif
+
+#endif /* LAPI_ARCH_PRCTL_H__ */
diff --git a/include/lapi/fs.h b/include/lapi/fs.h
index c19ee821d..635979b02 100644
--- a/include/lapi/fs.h
+++ b/include/lapi/fs.h
@@ -55,13 +55,13 @@
  * 64 bit: macro taken from kernel from include/linux/fs.h
  * 32 bit: own implementation
  */
-static inline loff_t tst_max_lfs_filesize(void)
+static inline long long tst_max_lfs_filesize(void)
 {
 #ifdef TST_ABI64
-	return (loff_t)LLONG_MAX;
+	return LLONG_MAX;
 #else
         long page_size = getpagesize();
-        loff_t ret = ULONG_MAX;
+        long long ret = ULONG_MAX;
 
         while (page_size >>= 1)
                 ret <<= 1;
diff --git a/include/lapi/getrandom.h b/include/lapi/getrandom.h
index c654ca1ac..706ef9b8f 100644
--- a/include/lapi/getrandom.h
+++ b/include/lapi/getrandom.h
@@ -8,10 +8,14 @@
 
 #include "config.h"
 
-#if HAVE_LINUX_RANDOM_H
-#include <linux/random.h>
+#ifdef HAVE_SYS_RANDOM_H
+# include <sys/random.h>
+#elif HAVE_LINUX_RANDOM_H
+# include <linux/random.h>
 #endif
 
+#include "lapi/syscalls.h"
+
 /*
  * Flags for getrandom(2)
  *
@@ -27,4 +31,11 @@
 # define GRND_RANDOM	0x0002
 #endif
 
+#ifndef HAVE_SYS_RANDOM_H
+static inline int getrandom(void *buf, size_t buflen, unsigned int flags)
+{
+	return tst_syscall(SYS_getrandom, buf, buflen, flags);
+}
+#endif
+
 #endif /* LAPI_GETRANDOM_H__ */
diff --git a/include/libswap.h b/include/libswap.h
index d4b5301a5..1389b5857 100644
--- a/include/libswap.h
+++ b/include/libswap.h
@@ -1,24 +1,124 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2013 Oracle and/or its affiliates. All Rights Reserved.
+ * Copyright (c) Linux Test Project, 2021-2024
  * Author: Stanislav Kholmanskikh <stanislav.kholmanskikh@oracle.com>
  */
 
 /*
- * Contains common content for all swapon/swapoff tests
+ * Contains common content for all swapon/swapoff tests.
  */
 
 #ifndef __LIBSWAP_H__
 #define __LIBSWAP_H__
 
+enum swapfile_method {
+    SWAPFILE_BY_SIZE,
+    SWAPFILE_BY_BLKS
+};
+
 /*
- * Make a swap file
+ * Create a swapfile of a specified size or number of blocks.
  */
-int make_swapfile(const char *swapfile, int safe);
+int make_swapfile(const char *file, const int lineno,
+			const char *swapfile, unsigned int num,
+			int safe, enum swapfile_method method);
 
-/*
+/** 65536 bytes is minimum for 64kb page size, let's use 1 MB */
+#define MINIMAL_SWAP_SIZE_MB 1
+
+/**
+ * MAKE_SMALL_SWAPFILE - create small swap file.
+ *
+ * Macro to create small swap file. Size defined with MINIMAL_SWAP_SIZE_MB.
+ *
+ * @swapfile: swap filename.
+ */
+#define MAKE_SMALL_SWAPFILE(swapfile) \
+    make_swapfile(__FILE__, __LINE__, swapfile, MINIMAL_SWAP_SIZE_MB, 0, \
+		  SWAPFILE_BY_SIZE)
+
+/**
+ * SAFE_MAKE_SMALL_SWAPFILE - create small swap file (safe version).
+ *
+ * Macro to create small swap file. Size defined with MINIMAL_SWAP_SIZE_MB.
+ * Includes safety checks to handle potential errors.
+ *
+ * @swapfile: swap filename.
+ */
+#define SAFE_MAKE_SMALL_SWAPFILE(swapfile) \
+    make_swapfile(__FILE__, __LINE__, swapfile, MINIMAL_SWAP_SIZE_MB, 1, \
+		  SWAPFILE_BY_SIZE)
+
+/**
+ * MAKE_SWAPFILE_SIZE - create swap file (MB).
+ *
+ * Macro to create swap file, size specified in megabytes (MB).
+ *
+ * @swapfile: swap filename.
+ * @size: swap size in MB.
+ */
+#define MAKE_SWAPFILE_SIZE(swapfile, size) \
+    make_swapfile(__FILE__, __LINE__, swapfile, size, 0, SWAPFILE_BY_SIZE)
+
+/**
+ * MAKE_SWAPFILE_BLKS - create swap file (blocks).
+ *
+ * Macro to create swap file, size specified in block numbers.
+ *
+ * @swapfile: swap filename.
+ * @blocks: number of blocks.
+ */
+#define MAKE_SWAPFILE_BLKS(swapfile, blocks) \
+    make_swapfile(__FILE__, __LINE__, swapfile, blocks, 0, SWAPFILE_BY_BLKS)
+
+/**
+ * SAFE_MAKE_SWAPFILE_SIZE - create swap file (MB, safe version).
+ *
+ * Macro to safely create swap file, size specified in megabytes (MB).
+ * Includes safety checks to handle potential errors.
+ *
+ * @swapfile: swap file name.
+ * @size: swap size in MB.
+ */
+#define SAFE_MAKE_SWAPFILE_SIZE(swapfile, size) \
+    make_swapfile(__FILE__, __LINE__, swapfile, size, 1, SWAPFILE_BY_SIZE)
+
+/**
+ * SAFE_MAKE_SWAPFILE_BLKS - create swap file (block, safe version)
+ *
+ * Macro to safely create swap file, size specified in block numbers.
+ * Includes safety checks to handle potential errors.
+ *
+ * @swapfile: swap file name.
+ * @blocks: number of blocks.
+ */
+#define SAFE_MAKE_SWAPFILE_BLKS(swapfile, blocks) \
+    make_swapfile(__FILE__, __LINE__, swapfile, blocks, 1, SWAPFILE_BY_BLKS)
+
+/**
+ * is_swap_supported() - Check swapon/swapoff support.
+ *
  * Check swapon/swapoff support status of filesystems or files
  * we are testing on.
+ *
+ * @filename: swap file name.
+ * Return: true if swap is supported, false if not.
  */
-void is_swap_supported(const char *filename);
+bool is_swap_supported(const char *filename);
+
+/**
+ * tst_max_swapfiles() - Get kernel constant MAX_SWAPFILES value.
+ *
+ * Return: MAX_SWAPFILES value.
+ */
+int tst_max_swapfiles(void);
+
+/**
+ * tst_count_swaps() - Get the used swapfiles number.
+ *
+ * Return: used swapfiles number.
+ */
+int tst_count_swaps(void);
+
 #endif /* __LIBSWAP_H__ */
diff --git a/include/mk/config.mk.in b/include/mk/config.mk.in
index 145b887fa..f6e02eaeb 100644
--- a/include/mk/config.mk.in
+++ b/include/mk/config.mk.in
@@ -86,6 +86,7 @@ LDFLAGS			+= $(WLDFLAGS)
 CFLAGS			+= $(DEBUG_CFLAGS) $(OPT_CFLAGS) $(WCFLAGS) $(STDCFLAGS)
 
 LTP_CFLAGS_NOPIE	:= @LTP_CFLAGS_NOPIE@
+LTP_CFLAGS_FFIXED_EBP	:= @LTP_CFLAGS_FFIXED_EBP@
 
 ifeq ($(strip $(HOST_CFLAGS)),)
 HOST_CFLAGS := $(CFLAGS)
diff --git a/include/mk/env_post.mk b/include/mk/env_post.mk
index a00f31b08..0bbbc3705 100644
--- a/include/mk/env_post.mk
+++ b/include/mk/env_post.mk
@@ -39,10 +39,6 @@ CPPFLAGS			+= -I$(top_srcdir)/include -I$(top_builddir)/include -I$(top_srcdir)/
 
 LDFLAGS				+= -L$(top_builddir)/lib
 
-ifeq ($(UCLINUX),1)
-CPPFLAGS			+= -D__UCLIBC__ -DUCLINUX
-endif
-
 ifeq ($(ANDROID),1)
 LDFLAGS				+= -L$(top_builddir)/lib/android_libpthread
 LDFLAGS				+= -L$(top_builddir)/lib/android_librt
diff --git a/include/mk/features.mk.in b/include/mk/features.mk.in
index 802ee0ba8..73a2f6658 100644
--- a/include/mk/features.mk.in
+++ b/include/mk/features.mk.in
@@ -36,22 +36,11 @@ WITH_METADATA_PDF		:= @WITH_METADATA_PDF@
 
 # Test suite knobs
 
-# Enable testcases/kernel/power_management's compile and install?
-ifeq ($(UCLINUX),1)
-WITH_POWER_MANAGEMENT_TESTSUITE	:= no
-else
-WITH_POWER_MANAGEMENT_TESTSUITE	:= yes
-endif
-
 # Enable testcases/open_posix_testsuite's compile and install?
 WITH_OPEN_POSIX_TESTSUITE	:= @WITH_OPEN_POSIX_TESTSUITE@
 
 # Enable testcases/realtime's compile and install?
-ifeq ($(UCLINUX),1)
-WITH_REALTIME_TESTSUITE		:= no
-else
 WITH_REALTIME_TESTSUITE		:= @WITH_REALTIME_TESTSUITE@
-endif
 
 # Enable testcases/kernel/kvm compile and install?
 WITH_KVM_TESTSUITE		:= @WITH_KVM_TESTSUITE@
diff --git a/include/mk/gitignore.mk b/include/mk/gitignore.mk
deleted file mode 100644
index 475206dcd..000000000
--- a/include/mk/gitignore.mk
+++ /dev/null
@@ -1,51 +0,0 @@
-#
-#    gitignore generation include Makefile.
-#
-#    Copyright (C) 2011, Linux Test Project.
-#
-#    This program is free software; you can redistribute it and/or modify
-#    it under the terms of the GNU General Public License as published by
-#    the Free Software Foundation; either version 2 of the License, or
-#    (at your option) any later version.
-#
-#    This program is distributed in the hope that it will be useful,
-#    but WITHOUT ANY WARRANTY; without even the implied warranty of
-#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#    GNU General Public License for more details.
-#
-#    You should have received a copy of the GNU General Public License along
-#    with this program; if not, write to the Free Software Foundation, Inc.,
-#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
-#
-# Ngie Cooper, January 2011
-#
-
-CLEAN_TARGETS+=		gitignore_clean
-
-BEFORE:=		.gitignore-before
-
-AFTER:=			.gitignore-after
-
-IGNORE_DIR_EXPR:=	egrep -v "^$$(echo "$(AUTOCONFED_SUBDIRS)" | tr " " "|")"
-
-# NOTE: The underscore is used in place of a dash to avoid implicit rule
-# evaluation in top-level Makefile.
-.PHONY: gitignore_clean
-gitignore_clean:
-	$(RM) -f $(BEFORE) $(AFTER)
-
-$(BEFORE):
-	$(MAKE) distclean
-	$(MAKE) ac-maintainer-clean
-	find . | $(IGNORE_DIR_EXPR) > $@
-
-$(AFTER):
-	$(MAKE) autotools
-	./configure --prefix=/dev/null
-	$(MAKE) all
-	find . | $(IGNORE_DIR_EXPR) > $@
-	# Set everything in autoconf land back to a sane state.
-	$(MAKE) distclean
-
-.gitignore: | $(BEFORE) $(AFTER)
-	diff -u $(BEFORE) $(AFTER) | grep '^+' | sed -e 's,^\+,,g' > $@
diff --git a/include/old/test.h b/include/old/test.h
index 834e92d9f..0e210e4ef 100644
--- a/include/old/test.h
+++ b/include/old/test.h
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * Copyright (c) 2009-2013 Cyril Hrubis chrubis@suse.cz
@@ -65,23 +65,6 @@
 					/* strings to control tst_res output */
 					/* If not set, TOUT_VERBOSE_S is assumed */
 
-/*
- * fork() can't be used on uClinux systems, so use FORK_OR_VFORK instead,
- * which will run vfork() on uClinux.
- * mmap() doesn't support MAP_PRIVATE on uClinux systems, so use
- * MAP_PRIVATE_EXCEPT_UCLINUX instead, which will skip the option on uClinux.
- * If MAP_PRIVATE really is required, the test can not be run on uClinux.
- */
-#ifdef UCLINUX
-# define FORK_OR_VFORK			tst_vfork
-# define MAP_PRIVATE_EXCEPT_UCLINUX	0
-/* tst_old_flush() + vfork() */
-pid_t tst_vfork(void);
-#else
-# define FORK_OR_VFORK			tst_fork
-# define MAP_PRIVATE_EXCEPT_UCLINUX	MAP_PRIVATE
-#endif
-
 /*
  * Macro to use for making functions called only once in
  * multi-threaded tests such as init or cleanup function.
@@ -184,10 +167,6 @@ extern int tst_count;
 /* lib/tst_sig.c */
 void tst_sig(int fork_flag, void (*handler)(), void (*cleanup)());
 
-/* lib/self_exec.c */
-void maybe_run_child(void (*child)(), const char *fmt, ...);
-int self_exec(const char *argv0, const char *fmt, ...);
-
 /* lib/tst_mkfs.c
  *
  * @dev: path to a device
diff --git a/include/pgsize_helpers.h b/include/pgsize_helpers.h
new file mode 100644
index 000000000..a66448a4f
--- /dev/null
+++ b/include/pgsize_helpers.h
@@ -0,0 +1,102 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) 2024 Google LLC. All rights reserved.
+ * Author(s): Kalesh Singh <kaleshsingh@google.com>
+ */
+
+#ifndef PGSIZE_HELPER_H
+#define PGSIZE_HELPER_H
+
+#include <stdlib.h>
+#include <string.h>
+#include <unistd.h>
+
+#define MAX_PAGE_SIZE (64*1024)
+
+#if defined(__x86_64__)
+/*
+ * Android emulates the userspace page size on some x86_64 emulators.
+ * The kernel page size still remains 4KiB (0x1000).
+ */
+static inline size_t kernel_page_size(void)
+{
+    return 0x1000;
+}
+
+/* Handle upto MAX_PAGE_SIZE emulation on 4KiB kernel base page size system */
+#define DECLARE_MINCORE_VECTOR(vec_name, num_pages) \
+    unsigned char vec_name[(num_pages) * (MAX_PAGE_SIZE / 4096)]
+
+#else	/* !defined(__x86_64__) */
+
+static inline size_t kernel_page_size(void)
+{
+	return getpagesize();
+}
+
+#define DECLARE_MINCORE_VECTOR(vec_name, num_pages) unsigned char vec_name[(num_pages)]
+#endif  /* defined(__x86_64__) */
+
+/*
+ * NOTE: For all cases except Android x86_64 page size emulators,
+ * kernel_page_size == page_size, and the below macros are effectively
+ * no-ops.
+ */
+
+/* The number of kernel pages covered by size */
+static inline size_t nr_kernel_pages(size_t size)
+{
+    return size / kernel_page_size();
+}
+
+/* The number of kernel pages in a @nr_pages userspace pages */
+static size_t nr_pgs_to_nr_kernel_pgs(size_t nr_pages)
+{
+    return nr_pages * nr_kernel_pages(getpagesize());
+}
+
+/* The number of userspace pages in a @nr_pages kernel pages */
+static size_t nr_kernel_pgs_to_nr_pgs(size_t nr_pages)
+{
+    return nr_pages / nr_kernel_pages(getpagesize());
+}
+
+/*
+ * Test populating the last partial 4KiB page if the page size is emulated,
+ * instead of the first. This faults in the preceding pages for convenient
+ * test accounting.
+ */
+#define MLOCK_PAGE_SIZE_EMULATION_OFFSET(tcases)                                            \
+do {                                                                                        \
+    if (getpagesize() != kernel_page_size()) {                                              \
+        for (int i = 0; i < ARRAY_SIZE(tcases); i++) {                                      \
+            struct tcase *test = tcases + i;                                                \
+            if (test->offset > 0) test->offset = pgsz - kernel_page_size() + test->offset;  \
+        }                                                                                   \
+    }                                                                                       \
+} while (0)
+
+/*
+ * Make the backing file large enough to cover the last corresponding kernel page.
+ *
+ * This is an artifact of x86_64 page size emulation on Android, to handle
+ * file_map_fault's, which does allow access to the partial page after the end
+ * of the file.
+ */
+#define SAFE_FILE_PRINTF_PGSIZE_EMULATION(file, str)                            \
+do {                                                                            \
+    if (kernel_page_size() == getpagesize()) {                                  \
+        SAFE_FILE_PRINTF(file, str);                                            \
+    } else {                                                                    \
+        int str_len = strlen(str);                                              \
+        int nr_writes = ((kernel_page_size()                                    \
+                            * (nr_pgs_to_nr_kernel_pgs(1) - 1)) / str_len) + 1; \
+        int total_len = str_len * nr_writes;                                    \
+        char *buffer = SAFE_MALLOC(total_len + 1);                              \
+        for (int i = 0; i < nr_writes; i++)                                     \
+            strcat(buffer, str);                                                \
+        SAFE_FILE_PRINTF(file, buffer);                                         \
+        free(buffer);                                                           \
+    }                                                                           \
+} while (0)
+#endif /* PGSIZE_HELPER_H */
diff --git a/include/safe_file_ops_fn.h b/include/safe_file_ops_fn.h
index aa6420d90..223fb0d68 100644
--- a/include/safe_file_ops_fn.h
+++ b/include/safe_file_ops_fn.h
@@ -90,8 +90,4 @@ int safe_touch(const char *file, const int lineno,
 		const char *pathname,
 		mode_t mode, const struct timespec times[2]);
 
-/* helper functions to setup overlayfs mountpoint */
-void create_overlay_dirs(void);
-int mount_overlay(const char *file, const int lineno, int strict);
-
 #endif /* SAFE_FILE_OPS_FN */
diff --git a/include/tst_buffers.h b/include/tst_buffers.h
index b5f355f0f..bd1a112a2 100644
--- a/include/tst_buffers.h
+++ b/include/tst_buffers.h
@@ -3,69 +3,95 @@
  * Copyright (c) 2019 Cyril Hrubis <chrubis@suse.cz>
  */
 
+/**
+ * DOC: Guarded buffers introduction
+ *
+ * Guarded buffer has a page with PROT_NONE allocated right before the start of
+ * the buffer and canary after the end of the buffer. That means that any
+ * memory access before the buffer ends with EFAULT or SEGFAULT and any write
+ * after the end of the buffer will be detected because it would overwrite the
+ * canaries.
+ *
+ * It should be used for all buffers passed to syscalls to make sure off-by-one
+ * buffer accesses does not happen.
+ */
+
 #ifndef TST_BUFFERS_H__
 #define TST_BUFFERS_H__
 
-/*
+/**
+ * struct tst_buffers - A guarded buffer description for allocator.
+ *
  * Buffer description consist of a pointer to a pointer and buffer type/size
  * encoded as a different structure members.
  *
- * Only one of the size and iov_sizes can be set at a time.
+ * @ptr: A pointer to the pointer to buffer. This is dereferenced and set by the
+ *       allocator.
+ * @size: A buffer size in bytes. Only one of size and iov_sizes can be set.
+ * @iov_sizes: An -1 terminated array of sizes used to construct a
+ *             struct iovec buffers.
+ * @str: If size is zero and iov_sizes is NULL this string is going to be
+ *       copied into the buffer.
  */
 struct tst_buffers {
-	/*
-	 * This pointer points to a buffer pointer.
-	 */
 	void *ptr;
-	/*
-	 * Buffer size.
-	 */
 	size_t size;
-	/*
-	 * Array of iov buffer sizes terminated by -1.
-	 */
 	int *iov_sizes;
-	/*
-	 * If size and iov_sizes is NULL this is the string we want to strdup()
-	 * into the buffer.
-	 */
 	char *str;
 };
 
-/*
- * Allocates buffers based on the tst_buffers structure.
+/**
+ * tst_buffers_alloc() - Allocates buffers based on the tst_buffers structure.
  *
- * @bufs NULL terminated array of test buffer descriptions.
+ * @bufs: A NULL terminated array of test buffer descriptions.
  *
- * This is called from the test library if the tst_test->bufs pointer is set.
+ * This is called from the test library if the tst_test.bufs pointer is set.
  */
 void tst_buffers_alloc(struct tst_buffers bufs[]);
 
-/*
- * strdup() that callls tst_alloc().
+/**
+ * tst_strdup() - Copies a string into a newly allocated guarded buffer.
+ *
+ * @str: A string to be duplicated.
+ * return: A pointer to the string duplicated in a guarded buffer.
+ *
+ * Allocates a buffer with tst_alloc() and copies the string into it.
  */
 char *tst_strdup(const char *str);
 
-/*
- * Allocates size bytes, returns pointer to the allocated buffer.
+/**
+ * tst_alloc() - Allocates a guarded buffer.
+ *
+ * @size: A size of the buffer.
+ * return: A newly allocated guarded buffer.
  */
 void *tst_alloc(size_t size);
 
-/*
- * Printf into a guarded buffer.
+/**
+ * tst_aprintf() - Printf into a newly allocated guarded buffer.
+ *
+ * @fmt: A printf-like format.
+ * @...: A printf-like parameters.
+ * return: A newly allocated buffer.
+ *
+ * Allocates a buffer with tst_alloc() then prints the data into it.
  */
 char *tst_aprintf(const char *fmt, ...)
       __attribute__((format (printf, 1, 2)));
 
-/*
- * Allocates iovec structure including the buffers.
+/**
+ * tst_iovec_alloc() - Allocates a complete iovec structure.
  *
- * @sizes -1 terminated array of buffer sizes.
+ * @sizes: A -1 terminated array of buffer sizes.
+ * return: Newly allocated iovec structure.
  */
 struct iovec *tst_iovec_alloc(int sizes[]);
 
-/*
- * Frees all allocated buffers.
+/**
+ * tst_free_all() - Frees all allocated buffers.
+ *
+ * It's important to free all guarded buffers because the canaries after the
+ * buffer are checked only when the buffer is being freed.
  *
  * This is called at the end of the test automatically.
  */
diff --git a/include/tst_capability.h b/include/tst_capability.h
index 6067804a3..ccf4bd77b 100644
--- a/include/tst_capability.h
+++ b/include/tst_capability.h
@@ -2,8 +2,9 @@
 /*
  * Copyright (c) 2019 Richard Palethorpe <rpalethorpe@suse.com>
  */
+
 /**
- * @file tst_capability.h
+ * DOC: Capabilities introduction
  *
  * Limited capability operations without libcap.
  */
@@ -15,22 +16,51 @@
 
 #include "lapi/capability.h"
 
-#define TST_CAP_DROP 1
-#define TST_CAP_REQ  (1 << 1)
-
-#define TST_CAP(action, capability) {action, capability, #capability}
+/**
+ * enum tst_cap_act - A capability action masks.
+ *
+ * @TST_CAP_DROP: Drop capabilities.
+ * @TST_CAP_REQ: Add capabilities.
+ */
+enum tst_cap_act {
+	TST_CAP_DROP = 1,
+	TST_CAP_REQ = (1 << 1)
+};
 
+/**
+ * struct tst_cap_user_header - Kernel capget(), capset() syscall header.
+ *
+ * @version: A capability API version.
+ * @pid: A process to operate on.
+ */
 struct tst_cap_user_header {
 	uint32_t version;
 	int pid;
 };
 
+/**
+ * struct tst_cap_user_data - Kernel capset(), capget() syscall payload.
+ *
+ * @effective: A capability effective set.
+ * @permitted: A capability permitted set.
+ * @inheritable: A capability inheritable set.
+ */
 struct tst_cap_user_data {
 	uint32_t effective;
 	uint32_t permitted;
 	uint32_t inheritable;
 };
 
+/**
+ * struct tst_cap - A capability to alter.
+ *
+ * @action: What should we do, i.e. drop or add a capability.
+ * @id: A capability id.
+ * @name: A capability name.
+ *
+ * This structure is usually constructed with the TST_CAP() macro so that the
+ * name is created automatically.
+ */
 struct tst_cap {
 	uint32_t action;
 	uint32_t id;
@@ -38,25 +68,43 @@ struct tst_cap {
 };
 
 /**
- * Get the capabilities as decided by hdr.
+ * TST_CAP() - Create a struct tst_cap entry.
  *
- * Note that the memory pointed to by data should be large enough to store two
- * structs.
+ * @action: What should we do, i.e. drop or add capability.
+ * @capability: A capability id, e.g. CAP_BPF.
+ */
+#define TST_CAP(action, capability) {action, capability, #capability}
+
+/**
+ * tst_capget() - Get the capabilities as decided by hdr.
+ *
+ * @hdr: A capability user header stores a pid to operate on and which
+ *       capability API version is used.
+ * @data: A memory to store the capabilities to. The memory pointed to by data
+ *        should be large enough to store two structs.
+ *
+ * return: Returns 0 on success, -1 on a failure and sets errno.
  */
 int tst_capget(struct tst_cap_user_header *hdr,
 	       struct tst_cap_user_data *data);
 
 /**
- * Set the capabilities as decided by hdr and data
+ * tst_capset() - Set the capabilities as decided by hdr and data
  *
- * Note that the memory pointed to by data should be large enough to store two
- * structs.
+ * @hdr: A capability user header stores a pid to operate on and which
+ *       capability API version is used.
+ * @data: A memory to store the capabilities to. The memory pointed to by data
+ *        should be large enough to store two structs.
+ *
+ * return: Returns 0 on success, -1 on a failure and sets errno.
  */
 int tst_capset(struct tst_cap_user_header *hdr,
 	       const struct tst_cap_user_data *data);
 
 /**
- * Add, check or remove a capability
+ * tst_cap_action() - Add, check or remove a capability.
+ *
+ * @cap: An {} terminated array of capabilities to alter.
  *
  * It will attempt to drop or add capability to the effective set. It will
  * try to detect if this is needed and whether it can or can't be done. If it
@@ -71,13 +119,17 @@ void tst_cap_action(struct tst_cap *cap);
 
 
 /**
- * Add, check or remove a capabilities
+ * tst_cap_setup() - Add, check or remove a capabilities.
+ *
+ * @cap: An {} terminated array of capabilities to alter.
+ * @action_mask: Decides which actions are done, i.e. only drop caps, add them
+ *               or both.
  *
  * Takes a NULL terminated array of structs which describe whether some
  * capabilities are needed or not and mask that determines subset of the
  * actions to be performed. Loops over the array and if mask matches the
  * element action it's passed to tst_cap_action().
  */
-void tst_cap_setup(struct tst_cap *cap, unsigned int action_mask);
+void tst_cap_setup(struct tst_cap *cap, enum tst_cap_act action_mask);
 
 #endif /* TST_CAPABILITY_H */
diff --git a/include/tst_cgroup.h b/include/tst_cgroup.h
index be14d07c6..d23a8e652 100644
--- a/include/tst_cgroup.h
+++ b/include/tst_cgroup.h
@@ -104,6 +104,7 @@ struct tst_cg_opts {
 	 * directory as opposed to the default pid of the calling process.
 	 */
 	int test_pid;
+	int needs_nsdelegate;
 };
 
 /* A Control Group in LTP's aggregated hierarchy */
diff --git a/include/tst_checkpoint.h b/include/tst_checkpoint.h
index 1b6911d73..a8d66a333 100644
--- a/include/tst_checkpoint.h
+++ b/include/tst_checkpoint.h
@@ -1,24 +1,86 @@
-/* SPDX-License-Identifier: GPL-2.0-or-later
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
  * Copyright (c) 2016 Cyril Hrubis <chrubis@suse.cz>
  */
 
+/**
+ * DOC: Checkpoints introduction
+ *
+ * Checkpoints implements a futex based synchronization primitive for threads
+ * and processes. When a process calls wait function its execution is suspended
+ * until wake is called for a corresponding checkpoint. Checkpoints are
+ * numbered from 0 and process can use at least hundred of them.
+ *
+ * In order to use checkpoints the test must set the tst_test.needs_checkpoints
+ * flag.
+ */
+
 #ifndef TST_CHECKPOINT__
 #define TST_CHECKPOINT__
 
 #include "tst_checkpoint_fn.h"
 
+/**
+ * TST_CHECKPOINT_WAIT() - Waits for a checkpoint.
+ *
+ * @id: A checkpoint id a positive integer.
+ *
+ * Suspends thread/process execution until it's woken up with a wake. The call
+ * does not wait indefinitely it gives up after 10 seconds. If an error
+ * happened or timeout was reached the function calls tst_brk(TBROK, ...) which
+ * exits the test.
+ */
 #define TST_CHECKPOINT_WAIT(id) \
         tst_safe_checkpoint_wait(__FILE__, __LINE__, NULL, id, 0)
 
+/**
+ * TST_CHECKPOINT_WAIT2() - Waits for a checkpoint.
+ *
+ * @id: A checkpoint id a positive integer.
+ * @msec_timeout: A timeout.
+ *
+ * Suspends thread/process execution until it's woken up with a wake. If an
+ * error happened or timeout was reached the function calls tst_brk(TBROK, ...)
+ * which exits the test.
+ */
 #define TST_CHECKPOINT_WAIT2(id, msec_timeout) \
         tst_safe_checkpoint_wait(__FILE__, __LINE__, NULL, id, msec_timeout)
 
+/**
+ * TST_CHECKPOINT_WAKE() - Wakes up a checkpoint.
+ *
+ * @id: A checkpoint id a positive integer.
+ *
+ * Wakes up a process suspended on a checkpoint and retries if there is no
+ * process suspended on the checkpoint yet. The call does not retry
+ * indefinitely but gives up after 10 seconds. If an error happened or timeout
+ * was reached the function calls tst_brk(TBROK, ...) which exits the test.
+ */
 #define TST_CHECKPOINT_WAKE(id) \
         tst_safe_checkpoint_wake(__FILE__, __LINE__, NULL, id, 1)
 
+/**
+ * TST_CHECKPOINT_WAKE2() - Wakes up several checkpoints.
+ *
+ * @id: A checkpoint id a positive integer.
+ * @nr_wake: A number of processes to wake.
+ *
+ * Wakes up nr_wake processes suspended on a checkpoint and retries if there
+ * wasn't enough process suspended on the checkpoint yet. The call does not
+ * retry indefinitely but gives up if it does not wake nr_wake processes after
+ * 10 seconds. If an error happened or timeout was reached the function calls
+ * tst_brk(TBROK, ...) which exits the test.
+ */
 #define TST_CHECKPOINT_WAKE2(id, nr_wake) \
         tst_safe_checkpoint_wake(__FILE__, __LINE__, NULL, id, nr_wake)
 
+/**
+ * TST_CHECKPOINT_WAKE_AND_WAIT() - Wakes up a checkpoint and immediately waits on it.
+ *
+ * @id: A checkpoint id a positive integer.
+ *
+ * This is a combination of TST_CHECKPOINT_WAKE() and TST_CHECKPOINT_WAIT().
+ */
 #define TST_CHECKPOINT_WAKE_AND_WAIT(id) do { \
         tst_safe_checkpoint_wake(__FILE__, __LINE__, NULL, id, 1); \
         tst_safe_checkpoint_wait(__FILE__, __LINE__, NULL, id, 0); \
diff --git a/include/tst_cmd.h b/include/tst_cmd.h
index 1f39f690f..939825646 100644
--- a/include/tst_cmd.h
+++ b/include/tst_cmd.h
@@ -18,14 +18,16 @@ enum tst_cmd_flags {
 
 /*
  * vfork() + execvp() specified program.
- * @argv: a list of two (at least program name + NULL) or more pointers that
+ *
+ * @param argv A list of two (at least program name + NULL) or more pointers that
  * represent the argument list to the new program. The array of pointers
  * must be terminated by a NULL pointer.
- * @stdout_fd: file descriptor where to redirect stdout. Set -1 if
+ * @param stdout_fd File descriptor where to redirect stdout. Set -1 if
  * redirection is not needed.
- * @stderr_fd: file descriptor where to redirect stderr. Set -1 if
+ * @param stderr_fd File descriptor where to redirect stderr. Set -1 if
  * redirection is not needed.
- * @flags: enum tst_cmd_flags
+ * @param flags enum tst_cmd_flags.
+ * @return The exit status of the program.
  */
 int tst_cmd_fds_(void (cleanup_fn)(void),
 			const char *const argv[],
@@ -33,12 +35,15 @@ int tst_cmd_fds_(void (cleanup_fn)(void),
 			int stderr_fd,
 			enum tst_cmd_flags flags);
 
-/* Executes tst_cmd_fds() and redirects its output to a file
- * @stdout_path: path where to redirect stdout. Set NULL if redirection is
+/*
+ * Executes tst_cmd_fds() and redirects its output to a file.
+ *
+ * @param stdout_path Path where to redirect stdout. Set NULL if redirection is
  * not needed.
- * @stderr_path: path where to redirect stderr. Set NULL if redirection is
+ * @param stderr_path Path where to redirect stderr. Set NULL if redirection is
  * not needed.
- * @flags: enum tst_cmd_flags
+ * @param flags enum tst_cmd_flags.
+ * @return The exit status of the program.
  */
 int tst_cmd_(void (cleanup_fn)(void),
 		const char *const argv[],
@@ -87,7 +92,7 @@ static inline int tst_cmd(void (cleanup_fn)(void),
 #endif
 
 /* Wrapper function for system(3), ignorcing SIGCHLD signal.
- * @command: the command to be run.
+ * @param command The command to be run.
  */
 int tst_system(const char *command);
 
diff --git a/include/tst_fips.h b/include/tst_fips.h
deleted file mode 100644
index 881c32391..000000000
--- a/include/tst_fips.h
+++ /dev/null
@@ -1,15 +0,0 @@
-// SPDX-License-Identifier: GPL-2.0-or-later
-/*
- * Copyright (c) 2021 Petr Vorel <pvorel@suse.cz>
- */
-
-#ifndef TST_FIPS_H__
-#define TST_FIPS_H__
-
-/*
- * Detect whether FIPS enabled
- * @return 0: FIPS not enabled, 1: FIPS enabled
- */
-int tst_fips_enabled(void);
-
-#endif /* TST_FIPS_H__ */
diff --git a/include/tst_fs.h b/include/tst_fs.h
index 1dd7d32fc..835f3511c 100644
--- a/include/tst_fs.h
+++ b/include/tst_fs.h
@@ -37,6 +37,8 @@
 /* fs/bcachefs/bcachefs_format.h */
 #define TST_BCACHE_MAGIC		0xca451a4e
 
+#include <stdint.h>
+
 enum tst_fill_access_pattern {
 	TST_FILL_BLOCKS,
 	TST_FILL_RANDOM
@@ -60,7 +62,7 @@ enum {
  * @mult: mult should be TST_KB, TST_MB or TST_GB
  * the required free space is calculated by @size * @mult
  */
-int tst_fs_has_free_(void (*cleanup)(void), const char *path, unsigned int size,
+int tst_fs_has_free_(void (*cleanup)(void), const char *path, uint64_t size,
 		     unsigned int mult);
 
 /*
@@ -225,7 +227,7 @@ static inline long tst_fs_type(const char *path)
 	return tst_fs_type_(NULL, path);
 }
 
-static inline int tst_fs_has_free(const char *path, unsigned int size,
+static inline int tst_fs_has_free(const char *path, uint64_t size,
 				  unsigned int mult)
 {
 	return tst_fs_has_free_(NULL, path, size, mult);
@@ -252,7 +254,7 @@ static inline long tst_fs_type(void (*cleanup)(void), const char *path)
 }
 
 static inline int tst_fs_has_free(void (*cleanup)(void), const char *path,
-				  unsigned int size, unsigned int mult)
+				  uint64_t size, unsigned int mult)
 {
 	return tst_fs_has_free_(cleanup, path, size, mult);
 }
diff --git a/include/tst_hugepage.h b/include/tst_hugepage.h
index 46327c79a..6b865b2f2 100644
--- a/include/tst_hugepage.h
+++ b/include/tst_hugepage.h
@@ -24,6 +24,8 @@ enum tst_hp_policy {
 	TST_NEEDS,
 };
 
+#define TST_NO_HUGEPAGES ((unsigned long)-1)
+
 struct tst_hugepage {
 	const unsigned long number;
 	enum  tst_hp_policy policy;
diff --git a/include/tst_kconfig.h b/include/tst_kconfig.h
index 8b24a8380..dcb370574 100644
--- a/include/tst_kconfig.h
+++ b/include/tst_kconfig.h
@@ -6,6 +6,8 @@
 #ifndef TST_KCONFIG_H__
 #define TST_KCONFIG_H__
 
+#include <stdbool.h>
+
 /**
  * Initialization helper macro for struct tst_kconfig_var. Requires <string.h>
  */
@@ -64,4 +66,36 @@ void tst_kconfig_read(struct tst_kconfig_var vars[], size_t vars_len);
  */
 int tst_kconfig_check(const char *const kconfigs[]);
 
+/**
+ * Macro to prepare a tst_kcmdline_var structure with a given parameter name.
+ *
+ * It initializes the .key field with the provided name, sets the .value field
+ * to an empty string, and marks the parameter as not found (.found = false).
+ *
+ * This macro is typically used to prepopulate an array with configuration
+ * parameters before processing the actual command line arguments.
+ */
+#define TST_KCMDLINE_INIT(paraname) { \
+	.key = paraname, \
+	.value = "", \
+	.found = false \
+}
+
+/**
+ * Structure for storing command-line parameter key and its corresponding
+ * value, and a flag indicating whether the parameter was found.
+ */
+struct tst_kcmdline_var {
+	const char *key;
+	char value[128];
+	bool found;
+};
+
+/**
+ * Parses command-line parameters from /proc/cmdline and stores them in params array.
+ * params: The array of tst_kcmdline_var structures to be filled with parsed key-value pairs.
+ * params_len: The length of the params array, indicating how many parameters to parse.
+ */
+void tst_kcmdline_parse(struct tst_kcmdline_var params[], size_t params_len);
+
 #endif	/* TST_KCONFIG_H__ */
diff --git a/include/tst_kernel.h b/include/tst_kernel.h
index 9d3a8d315..5f49952b7 100644
--- a/include/tst_kernel.h
+++ b/include/tst_kernel.h
@@ -1,32 +1,60 @@
 /* SPDX-License-Identifier: GPL-2.0-or-later
  * Copyright (c) 2017 Cyril Hrubis <chrubis@suse.cz>
+ * Copyright (c) Linux Test Project, 2018-2024
  */
 
 #ifndef TST_KERNEL_H__
 #define TST_KERNEL_H__
 
-/*
- * Returns 32 if we are running on 32bit kernel and 64 if on 64bit kernel.
+#include <stdbool.h>
+
+/**
+ * tst_kernel_bits() - Detect if running on 32bit or 64bit kernel.
+ *
+ * Return: 32 if the test process is running on 32bit kernel and 64 if on 64bit
+ * kernel.
  */
 int tst_kernel_bits(void);
 
-/*
- * Checks if the kernel module is built-in.
+/**
+ * tst_is_compat_mode() - Detect if running in compat mode.
+ *
+ * Detect if the test is 32bit binary executed on a 64bit kernel,
+ * i.e. we are testing the kernel compat layer.
+ *
+ * Return: non-zero if the test process is running in compat mode.
+ */
+int tst_is_compat_mode(void);
+
+/**
+ * tst_abi_bits() - Detect if compiled for required kernel ABI.
+ *
+ * @abi: kernel ABI bits (32 or 64).
  *
- * @param driver The name of the driver.
- * @return Returns 0 if builtin driver
- * -1 when driver is missing or config file not available.
- * On Android *always* 0 (always expect the driver is available).
+ * Return: true if compiled for required ABI or false otherwise.
+ */
+bool tst_abi_bits(int abi);
+
+/**
+ * tst_check_builtin_driver() - Check if the kernel module is built-in.
+ *
+ * @driver: the name of the driver.
+ *
+ * Return: 0 if builtin driver or -1 when driver is missing or config file not
+ * available. On Android *always* 0 (always expect the driver is available).
  */
 int tst_check_builtin_driver(const char *driver);
 
-/*
- * Checks support for the kernel module (both built-in and loadable).
+/**
+ * tst_check_driver() - Check support for the kernel module.
+ *
+ * Check support for the kernel module (both built-in and loadable).
+ *
+ * @driver: the name of the driver.
  *
- * @param driver The name of the driver.
- * @return Returns 0 if the kernel has the driver,
- * -1 when driver is missing or config file not available.
- * On Android *always* 0 (always expect the driver is available).
+ * Return: 0 if the kernel has the driver, -1 when driver is missing or config
+ * file not available. On Android *always* 0 (always expect the driver is
+ * available).
  */
 int tst_check_driver(const char *driver);
 
diff --git a/include/tst_lockdown.h b/include/tst_lockdown.h
deleted file mode 100644
index 2bd1aa251..000000000
--- a/include/tst_lockdown.h
+++ /dev/null
@@ -1,9 +0,0 @@
-// SPDX-License-Identifier: GPL-2.0-or-later
-
-#ifndef TST_LOCKDOWN_H
-#define TST_LOCKDOWN_H
-
-int tst_secureboot_enabled(void);
-int tst_lockdown_enabled(void);
-
-#endif /* TST_LOCKDOWN_H */
diff --git a/include/tst_netdevice.h b/include/tst_netdevice.h
index 8d40148a6..2394f9c7f 100644
--- a/include/tst_netdevice.h
+++ b/include/tst_netdevice.h
@@ -179,6 +179,11 @@ int tst_netdev_add_traffic_filter(const char *file, const int lineno,
 	tst_netdev_add_traffic_filter(__FILE__, __LINE__, 1, (ifname), \
 		(parent), (handle), (protocol), (priority), (f_kind), (config))
 
+#define NETDEV_ADD_TRAFFIC_FILTER_RET(ifname, parent, handle, protocol, \
+	priority, f_kind, config) \
+	tst_netdev_add_traffic_filter(__FILE__, __LINE__, 0, (ifname), \
+		(parent), (handle), (protocol), (priority), (f_kind), (config))
+
 int tst_netdev_remove_traffic_filter(const char *file, const int lineno,
 	int strict, const char *ifname, unsigned int parent,
 	unsigned int handle, unsigned int protocol, unsigned int priority,
diff --git a/include/tst_parse.h b/include/tst_parse.h
new file mode 100644
index 000000000..167d416f4
--- /dev/null
+++ b/include/tst_parse.h
@@ -0,0 +1,65 @@
+/* SPDX-License-Identifier: GPL-2.0-or-later */
+/*
+ * Copyright (c) 2015-2024 Cyril Hrubis <chrubis@suse.cz>
+ */
+
+/**
+ * DOC: Option parsing functions
+ *
+ * Implements simple helpers on the top of the strtol() and strtod() for
+ * command line option parsing.
+ */
+
+#ifndef TST_PARSE_H__
+#define TST_PARSE_H__
+
+/**
+ * tst_parse_int() - Parse an integer from a string.
+ *
+ * @str: A string with an integer number.
+ * @val: A pointer to integer to store the result to.
+ * @min: A lower bound, pass INT_MIN for full range.
+ * @max: An upper bound, pass INT_MAX for full range.
+ * return: A zero if whole string was consumed and the value was within bounds,
+ *         an errno otherwise.
+ */
+int tst_parse_int(const char *str, int *val, int min, int max);
+
+/**
+ * tst_parse_long() - Parse a long integer from a string.
+ *
+ * @str: A string with an integer number.
+ * @val: A pointer to long integer to store the result to.
+ * @min: A lower bound, pass LONG_MIN for full range.
+ * @max: An upper bound, pass LONG_MAX for full range.
+ * return: A zero if whole string was consumed and the value was within bounds,
+ *         an errno otherwise.
+ */
+int tst_parse_long(const char *str, long *val, long min, long max);
+
+/**
+ * tst_parse_float() - Parse a floating point number from a string.
+ *
+ * @str: A string with a floating point number.
+ * @val: A pointer to float to store the result to.
+ * @min: A lower bound.
+ * @max: An upper bound.
+ * return: A zero if whole string was consumed and the value was within bounds,
+ *         an errno otherwise.
+ */
+int tst_parse_float(const char *str, float *val, float min, float max);
+
+/**
+ * tst_parse_filesize() - Parse a file size from a string.
+ *
+ * @str: A string a positive number optionally followed by an unit, i.e. K, M,
+ *       or G for kilobytes, megabytes and gigabytes.
+ * @val: A pointer to long long integer to store the size in bytes to.
+ * @min: A lower bound.
+ * @max: An upper bound.
+ * return: A zero if whole string was consumed and the value was within bounds,
+ *         an errno otherwise.
+ */
+int tst_parse_filesize(const char *str, long long *val, long long min, long long max);
+
+#endif	/* TST_PARSE_H__ */
diff --git a/include/tst_res_flags.h b/include/tst_res_flags.h
index 872352144..806940e0d 100644
--- a/include/tst_res_flags.h
+++ b/include/tst_res_flags.h
@@ -1,24 +1,66 @@
-/* SPDX-License-Identifier: GPL-2.0-or-later
+/* SPDX-License-Identifier: GPL-2.0-or-later */
+/*
  * Copyright (c) Linux Test Project, 2014
  */
 
 #ifndef TST_RES_FLAGS_H
 #define TST_RES_FLAGS_H
 
-/* Use low 6 bits to encode test type */
-#define TTYPE_MASK	0x3f
-#define TPASS	0	/* Test passed flag */
-#define TFAIL	1	/* Test failed flag */
-#define TBROK	2	/* Test broken flag */
-#define TWARN	4	/* Test warning flag */
-#define TDEBUG	8	/* Test debug information flag */
-#define TINFO	16	/* Test information flag */
-#define TCONF	32	/* Test not appropriate for configuration flag */
-#define TTYPE_RESULT(ttype)	((ttype) & TTYPE_MASK)
+/**
+ * enum tst_res_flags - Test result reporting flags.
+ *
+ * @TPASS: Reports a single success.
+ * @TFAIL: Reports a single failure.
+ * @TBROK: Reports a single breakage.
+ * @TWARN: Reports a single warning. Warnings increment a warning counter and
+ *         show up in test results.
+ *
+ * @TDEBUG: Prints additional debugging messages, it does not change the test result counters and
+ *          the message is not displayed unless debugging is enabled with -D
+ *          test command line parameter.
+ *
+ * @TINFO: Prints an additional information, it does not change the test result
+ *         counters but unlike TDEBUG the message is always displayed.
+ *
+ * @TCONF: Reports unsupported configuration. When tests produce this result at
+ *         least a subset of test was skipped, because it couldn't run. The
+ *         usual reasons are, missing kernel modules or CONFIG options.
+ *         Unsuitable CPU architecture, not enough memory, etc.
+ *
+ * @TERRNO: Combine bitwise with result flags to append errno to the output message.
+ *
+ * @TTERRNO: Combine bitwise with result flags to append error from TST_ERR to
+ *           the message. The TST_TEST() macros store the errno into the
+ *           TST_ERR global variable in order to make sure it's not change
+ *           between the test is done and results are printed.
+ *
+ * @TRERRNO: Combine bitwise with result flags to errno from TST_RET variable
+ *           to the message. The TST_TEST() macros store return value into the
+ *           TST_RET global variable and quite a few, e.g. pthread functions,
+ *           return the error value directly instead of storing it to the errno.
+ *
+ * A result flag with optional bitwise combination of errno flag are passed to
+ * the tst_res() and tst_brk() functions. Each message counts as a single test
+ * result and tests can produce arbitrary number of results, i.e. TPASS, TFAIL,
+ * TBROK, TWARN and TCONF messages. Each such message increases a result
+ * counter in a piece of shared memory, which means that reported results are
+ * accounted immediately even from child processes and there is no need for
+ * result propagation.
+ */
+enum tst_res_flags {
+	TPASS = 0,
+	TFAIL = 1,
+	TBROK = 2,
+	TWARN = 4,
+	TDEBUG = 8,
+	TINFO = 16,
+	TCONF = 32,
+	TERRNO = 0x100,
+	TTERRNO = 0x200,
+	TRERRNO	= 0x400,
+};
 
-#define TERRNO	0x100	/* Append errno information to output */
-#define TTERRNO	0x200	/* Append TEST_ERRNO information to output */
-#define TRERRNO	0x400	/* Capture errno information from TEST_RETURN to
-			   output; useful for pthread-like APIs :). */
+#define TTYPE_RESULT(ttype)	((ttype) & TTYPE_MASK)
+#define TTYPE_MASK 0x3f
 
 #endif /* TST_RES_FLAGS_H */
diff --git a/include/tst_safe_file_ops.h b/include/tst_safe_file_ops.h
index 62f6600ec..0d8819594 100644
--- a/include/tst_safe_file_ops.h
+++ b/include/tst_safe_file_ops.h
@@ -56,10 +56,16 @@
 	safe_touch(__FILE__, __LINE__, NULL, \
 			(pathname), (mode), (times))
 
+/* New API only functions */
+
+/* helper functions to setup overlayfs mountpoint */
+void tst_create_overlay_dirs(void);
+int tst_mount_overlay(const char *file, const int lineno, int strict);
+
 #define SAFE_MOUNT_OVERLAY() \
-	((void) mount_overlay(__FILE__, __LINE__, 1))
+	((void) tst_mount_overlay(__FILE__, __LINE__, 1))
 
 #define TST_MOUNT_OVERLAY() \
-	(mount_overlay(__FILE__, __LINE__, 0) == 0)
+	(tst_mount_overlay(__FILE__, __LINE__, 0) == 0)
 
 #endif /* TST_SAFE_FILE_OPS */
diff --git a/include/tst_safe_macros.h b/include/tst_safe_macros.h
index f2ce8919b..8de8ef106 100644
--- a/include/tst_safe_macros.h
+++ b/include/tst_safe_macros.h
@@ -1,11 +1,12 @@
 /* SPDX-License-Identifier: GPL-2.0-or-later
- * Copyright (c) 2010-2018 Linux Test Project
+ * Copyright (c) 2010-2024 Linux Test Project
  * Copyright (c) 2011-2015 Cyril Hrubis <chrubis@suse.cz>
  */
 
 #ifndef TST_SAFE_MACROS_H__
 #define TST_SAFE_MACROS_H__
 
+#include <stdlib.h>
 #include <sys/mman.h>
 #include <sys/types.h>
 #include <sys/time.h>
@@ -24,6 +25,7 @@
 #include "safe_stdio_fn.h"
 #include "safe_macros_fn.h"
 #include "tst_cmd.h"
+#include "tst_safe_macros_inline.h"
 
 int safe_access(const char *filename, const int lineno, const char *pathname,
 		   int mode);
@@ -73,6 +75,11 @@ int safe_dup2(const char *file, const int lineno, int oldfd, int newfd);
 #define SAFE_MALLOC(size) \
 	safe_malloc(__FILE__, __LINE__, NULL, (size))
 
+void *safe_calloc(const char *file, const int lineno, size_t nmemb, size_t size);
+
+#define SAFE_CALLOC(nmemb, size) \
+	safe_calloc(__FILE__, __LINE__, (nmemb), (size))
+
 void *safe_realloc(const char *file, const int lineno, void *ptr, size_t size);
 
 #define SAFE_REALLOC(ptr, size) \
@@ -263,234 +270,40 @@ int safe_getgroups(const char *file, const int lineno, int size, gid_t list[]);
 	            "fcntl(%i,%s,...) failed", fd, #cmd), 0 \
 	 : tst_ret_;})
 
-/*
- * following functions are inline because the behaviour may depend on
- * -D_FILE_OFFSET_BITS=64 compile flag
- */
+void tst_prot_to_str(const int prot, char *buf);
 
 static inline void *safe_mmap(const char *file, const int lineno,
-                              void *addr, size_t length,
-                              int prot, int flags, int fd, off_t offset)
+	void *addr, size_t length, int prot, int flags, int fd, off_t offset)
 {
 	void *rval;
+	char prot_buf[512];
+
+	tst_prot_to_str(prot, prot_buf);
+
+	tst_res_(file, lineno, TDEBUG,
+		"mmap(%p, %zu, %s(%x), %d, %d, %ld)",
+		addr, length, prot_buf, prot, flags, fd, offset);
 
 	rval = mmap(addr, length, prot, flags, fd, offset);
 	if (rval == MAP_FAILED) {
 		tst_brk_(file, lineno, TBROK | TERRNO,
-			"mmap(%p,%zu,%d,%d,%d,%ld) failed",
-			addr, length, prot, flags, fd, (long) offset);
+			"mmap(%p,%zu,%s(%x),%d,%d,%ld) failed",
+			addr, length, prot_buf, prot, flags, fd, (long) offset);
 	}
 
 	return rval;
 }
+
+
 #define SAFE_MMAP(addr, length, prot, flags, fd, offset) \
 	safe_mmap(__FILE__, __LINE__, (addr), (length), (prot), \
 	(flags), (fd), (offset))
 
-static inline int safe_ftruncate(const char *file, const int lineno,
-                                 int fd, off_t length)
-{
-	int rval;
-
-	rval = ftruncate(fd, length);
-
-	if (rval == -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"ftruncate(%d,%ld) failed", fd, (long)length);
-	} else if (rval) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid ftruncate(%d,%ld) return value %d", fd,
-			(long)length, rval);
-	}
-
-	return rval;
-}
-#define SAFE_FTRUNCATE(fd, length) \
-	safe_ftruncate(__FILE__, __LINE__, (fd), (length))
-
-static inline int safe_posix_fadvise(const char *file, const int lineno,
-                                int fd, off_t offset, off_t len, int advice)
-{
-	int rval;
-
-	rval = posix_fadvise(fd, offset, len, advice);
-
-	if (rval)
-		tst_brk_(file, lineno, TBROK,
-			"posix_fadvise(%d,%ld,%ld,%d) failed: %s",
-			fd, (long)offset, (long)len, advice, tst_strerrno(rval));
-
-	return rval;
-}
-#define SAFE_POSIX_FADVISE(fd, offset, len, advice) \
-	safe_posix_fadvise(__FILE__, __LINE__, (fd), (offset), (len), (advice))
-
-static inline int safe_truncate(const char *file, const int lineno,
-                                const char *path, off_t length)
-{
-	int rval;
-
-	rval = truncate(path, length);
+int safe_mprotect(const char *file, const int lineno,
+	char *addr, size_t len, int prot);
 
-	if (rval == -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"truncate(%s,%ld) failed", path, (long)length);
-	} else if (rval) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid truncate(%s,%ld) return value %d", path,
-			(long)length, rval);
-	}
-
-	return rval;
-}
-#define SAFE_TRUNCATE(path, length) \
-	safe_truncate(__FILE__, __LINE__, (path), (length))
-
-static inline int safe_stat(const char *file, const int lineno,
-                            const char *path, struct stat *buf)
-{
-	int rval;
-
-	rval = stat(path, buf);
-
-	if (rval == -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"stat(%s,%p) failed", path, buf);
-	} else if (rval) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid stat(%s,%p) return value %d", path, buf,
-			rval);
-	}
-
-	return rval;
-}
-#define SAFE_STAT(path, buf) \
-	safe_stat(__FILE__, __LINE__, (path), (buf))
-
-static inline int safe_fstat(const char *file, const int lineno,
-                             int fd, struct stat *buf)
-{
-	int rval;
-
-	rval = fstat(fd, buf);
-
-	if (rval == -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"fstat(%d,%p) failed", fd, buf);
-	} else if (rval) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid fstat(%d,%p) return value %d", fd, buf, rval);
-	}
-
-	return rval;
-}
-#define SAFE_FSTAT(fd, buf) \
-	safe_fstat(__FILE__, __LINE__, (fd), (buf))
-
-static inline int safe_lstat(const char *file, const int lineno,
-	const char *path, struct stat *buf)
-{
-	int rval;
-
-	rval = lstat(path, buf);
-
-	if (rval == -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"lstat(%s,%p) failed", path, buf);
-	} else if (rval) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid lstat(%s,%p) return value %d", path, buf,
-			rval);
-	}
-
-	return rval;
-}
-#define SAFE_LSTAT(path, buf) \
-	safe_lstat(__FILE__, __LINE__, (path), (buf))
-
-static inline int safe_statfs(const char *file, const int lineno,
-                              const char *path, struct statfs *buf)
-{
-	int rval;
-
-	rval = statfs(path, buf);
-
-	if (rval == -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"statfs(%s,%p) failed", path, buf);
-	} else if (rval) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid statfs(%s,%p) return value %d", path, buf,
-			rval);
-	}
-
-	return rval;
-}
-#define SAFE_STATFS(path, buf) \
-	safe_statfs(__FILE__, __LINE__, (path), (buf))
-
-static inline off_t safe_lseek(const char *file, const int lineno,
-                               int fd, off_t offset, int whence)
-{
-	off_t rval;
-
-	rval = lseek(fd, offset, whence);
-
-	if (rval == (off_t) -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"lseek(%d,%ld,%d) failed", fd, (long)offset, whence);
-	} else if (rval < 0) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid lseek(%d,%ld,%d) return value %ld", fd,
-			(long)offset, whence, (long)rval);
-	}
-
-	return rval;
-}
-#define SAFE_LSEEK(fd, offset, whence) \
-	safe_lseek(__FILE__, __LINE__, (fd), (offset), (whence))
-
-static inline int safe_getrlimit(const char *file, const int lineno,
-                                 int resource, struct rlimit *rlim)
-{
-	int rval;
-
-	rval = getrlimit(resource, rlim);
-
-	if (rval == -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"getrlimit(%d,%p) failed", resource, rlim);
-	} else if (rval) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid getrlimit(%d,%p) return value %d", resource,
-			rlim, rval);
-	}
-
-	return rval;
-}
-#define SAFE_GETRLIMIT(resource, rlim) \
-	safe_getrlimit(__FILE__, __LINE__, (resource), (rlim))
-
-static inline int safe_setrlimit(const char *file, const int lineno,
-                                 int resource, const struct rlimit *rlim)
-{
-	int rval;
-
-	rval = setrlimit(resource, rlim);
-
-	if (rval == -1) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"setrlimit(%d,%p) failed", resource, rlim);
-	} else if (rval) {
-		tst_brk_(file, lineno, TBROK | TERRNO,
-			"Invalid setrlimit(%d,%p) return value %d", resource,
-			rlim, rval);
-	}
-
-	return rval;
-}
-#define SAFE_SETRLIMIT(resource, rlim) \
-	safe_setrlimit(__FILE__, __LINE__, (resource), (rlim))
+#define SAFE_MPROTECT(addr, len, prot) \
+	safe_mprotect(__FILE__, __LINE__, (addr), (len), (prot))
 
 typedef void (*sighandler_t)(int);
 sighandler_t safe_signal(const char *file, const int lineno,
@@ -653,9 +466,20 @@ int safe_unshare(const char *file, const int lineno, int flags);
 int safe_setns(const char *file, const int lineno, int fd, int nstype);
 #define SAFE_SETNS(fd, nstype) safe_setns(__FILE__, __LINE__, (fd), (nstype))
 
+/*
+ * SAFE_CMD() is a wrapper for tst_cmd(). It runs a command passed via argv[]
+ * and handles non-zero exit (exits with 'TBROK') and 'ENOENT' (the program not
+ * in '$PATH', exits with 'TCONF').
+ *
+ * @param argv[] a 'NULL' terminated array of strings starting with the program
+ * name which is followed by optional arguments.
+ * @param stdout_path: path where to redirect stdout. Set NULL if redirection is
+ * not needed.
+ * @param stderr_path: path where to redirect stderr. Set NULL if redirection is
+ * not needed.
+ */
 void safe_cmd(const char *file, const int lineno, const char *const argv[],
 	const char *stdout_path, const char *stderr_path);
-
 #define SAFE_CMD(argv, stdout_path, stderr_path) \
 	safe_cmd(__FILE__, __LINE__, (argv), (stdout_path), (stderr_path))
 /*
@@ -674,4 +498,9 @@ int safe_sysinfo(const char *file, const int lineno, struct sysinfo *info);
 
 void safe_print_file(const char *file, const int lineno, char *path);
 
-#endif /* SAFE_MACROS_H__ */
+int safe_sscanf(const char *file, const int lineno, const char *restrict buffer,
+	const char *restrict format, ...);
+#define SAFE_SSCANF(buffer, format, ...) \
+	safe_sscanf(__FILE__, __LINE__, (buffer), (format),	##__VA_ARGS__)
+
+#endif /* TST_SAFE_MACROS_H__ */
diff --git a/include/tst_safe_macros_inline.h b/include/tst_safe_macros_inline.h
new file mode 100644
index 000000000..5eed3a18d
--- /dev/null
+++ b/include/tst_safe_macros_inline.h
@@ -0,0 +1,230 @@
+/* SPDX-License-Identifier: GPL-2.0-or-later
+ * Copyright (c) 2010-2024 Linux Test Project
+ * Copyright (c) 2011-2015 Cyril Hrubis <chrubis@suse.cz>
+ */
+
+#ifndef TST_SAFE_MACROS_INLINE_H__
+#define TST_SAFE_MACROS_INLINE_H__
+
+/*
+ * Following functions are inline because the behaviour may depend on
+ * -D_FILE_OFFSET_BITS=64 compile flag (type off_t or structures containing
+ *  off_t fields), see man off_t(3type).
+ *
+ * Do not add other functions here.
+ */
+
+static inline int safe_ftruncate(const char *file, const int lineno,
+	int fd, off_t length)
+{
+	int rval;
+
+	rval = ftruncate(fd, length);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"ftruncate(%d,%ld) failed", fd, (long)length);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid ftruncate(%d,%ld) return value %d", fd,
+			(long)length, rval);
+	}
+
+	return rval;
+}
+
+#define SAFE_FTRUNCATE(fd, length) \
+	safe_ftruncate(__FILE__, __LINE__, (fd), (length))
+
+static inline int safe_posix_fadvise(const char *file, const int lineno,
+	int fd, off_t offset, off_t len, int advice)
+{
+	int rval;
+
+	rval = posix_fadvise(fd, offset, len, advice);
+
+	if (rval)
+		tst_brk_(file, lineno, TBROK,
+			"posix_fadvise(%d,%ld,%ld,%d) failed: %s",
+			fd, (long)offset, (long)len, advice, tst_strerrno(rval));
+
+	return rval;
+}
+
+#define SAFE_POSIX_FADVISE(fd, offset, len, advice) \
+	safe_posix_fadvise(__FILE__, __LINE__, (fd), (offset), (len), (advice))
+
+static inline int safe_truncate(const char *file, const int lineno,
+	const char *path, off_t length)
+{
+	int rval;
+
+	rval = truncate(path, length);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"truncate(%s,%ld) failed", path, (long)length);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid truncate(%s,%ld) return value %d", path,
+			(long)length, rval);
+	}
+
+	return rval;
+}
+
+#define SAFE_TRUNCATE(path, length) \
+	safe_truncate(__FILE__, __LINE__, (path), (length))
+
+static inline int safe_stat(const char *file, const int lineno,
+	const char *path, struct stat *buf)
+{
+	int rval;
+
+	rval = stat(path, buf);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"stat(%s,%p) failed", path, buf);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid stat(%s,%p) return value %d", path, buf,
+			rval);
+	}
+
+	return rval;
+}
+
+#define SAFE_STAT(path, buf) \
+	safe_stat(__FILE__, __LINE__, (path), (buf))
+
+static inline int safe_fstat(const char *file, const int lineno,
+	int fd, struct stat *buf)
+{
+	int rval;
+
+	rval = fstat(fd, buf);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"fstat(%d,%p) failed", fd, buf);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid fstat(%d,%p) return value %d", fd, buf, rval);
+	}
+
+	return rval;
+}
+#define SAFE_FSTAT(fd, buf) \
+	safe_fstat(__FILE__, __LINE__, (fd), (buf))
+
+static inline int safe_lstat(const char *file, const int lineno,
+	const char *path, struct stat *buf)
+{
+	int rval;
+
+	rval = lstat(path, buf);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"lstat(%s,%p) failed", path, buf);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid lstat(%s,%p) return value %d", path, buf,
+			rval);
+	}
+
+	return rval;
+}
+#define SAFE_LSTAT(path, buf) \
+	safe_lstat(__FILE__, __LINE__, (path), (buf))
+
+static inline int safe_statfs(const char *file, const int lineno,
+	const char *path, struct statfs *buf)
+{
+	int rval;
+
+	rval = statfs(path, buf);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"statfs(%s,%p) failed", path, buf);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid statfs(%s,%p) return value %d", path, buf,
+			rval);
+	}
+
+	return rval;
+}
+
+#define SAFE_STATFS(path, buf) \
+	safe_statfs(__FILE__, __LINE__, (path), (buf))
+
+static inline off_t safe_lseek(const char *file, const int lineno,
+	int fd, off_t offset, int whence)
+{
+	off_t rval;
+
+	rval = lseek(fd, offset, whence);
+
+	if (rval == (off_t) -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"lseek(%d,%ld,%d) failed", fd, (long)offset, whence);
+	} else if (rval < 0) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid lseek(%d,%ld,%d) return value %ld", fd,
+			(long)offset, whence, (long)rval);
+	}
+
+	return rval;
+}
+
+#define SAFE_LSEEK(fd, offset, whence) \
+	safe_lseek(__FILE__, __LINE__, (fd), (offset), (whence))
+
+static inline int safe_getrlimit(const char *file, const int lineno,
+	int resource, struct rlimit *rlim)
+{
+	int rval;
+
+	rval = getrlimit(resource, rlim);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"getrlimit(%d,%p) failed", resource, rlim);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid getrlimit(%d,%p) return value %d", resource,
+			rlim, rval);
+	}
+
+	return rval;
+}
+
+#define SAFE_GETRLIMIT(resource, rlim) \
+	safe_getrlimit(__FILE__, __LINE__, (resource), (rlim))
+
+static inline int safe_setrlimit(const char *file, const int lineno,
+	int resource, const struct rlimit *rlim)
+{
+	int rval;
+
+	rval = setrlimit(resource, rlim);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"setrlimit(%d,%p) failed", resource, rlim);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"Invalid setrlimit(%d,%p) return value %d", resource,
+			rlim, rval);
+	}
+
+	return rval;
+}
+
+#define SAFE_SETRLIMIT(resource, rlim) \
+	safe_setrlimit(__FILE__, __LINE__, (resource), (rlim))
+
+#endif /* TST_SAFE_MACROS_INLINE_H__ */
diff --git a/include/tst_security.h b/include/tst_security.h
new file mode 100644
index 000000000..5d91f8a98
--- /dev/null
+++ b/include/tst_security.h
@@ -0,0 +1,18 @@
+/* SPDX-License-Identifier: GPL-2.0-or-later
+ * Copyright (c) Linux Test Project, 2020-2024
+ */
+
+#ifndef TST_SECURITY_H__
+#define TST_SECURITY_H__
+
+/*
+ * Detect whether FIPS enabled
+ * @return 0: FIPS not enabled, 1: FIPS enabled
+ */
+int tst_fips_enabled(void);
+
+int tst_lockdown_enabled(void);
+int tst_secureboot_enabled(void);
+int tst_selinux_enforcing(void);
+
+#endif /* TST_SECURITY_H__ */
diff --git a/include/tst_test.h b/include/tst_test.h
index fda696eeb..3846afdff 100644
--- a/include/tst_test.h
+++ b/include/tst_test.h
@@ -1,7 +1,7 @@
-// SPDX-License-Identifier: GPL-2.0-or-later
+/* SPDX-License-Identifier: GPL-2.0-or-later */
 /*
  * Copyright (c) 2015-2016 Cyril Hrubis <chrubis@suse.cz>
- * Copyright (c) Linux Test Project, 2016-2019
+ * Copyright (c) Linux Test Project, 2016-2024
  */
 
 #ifndef TST_TEST_H__
@@ -15,9 +15,11 @@
 #include <limits.h>
 #include <string.h>
 #include <errno.h>
+#include <sys/resource.h>
 
 #include "tst_common.h"
 #include "tst_res_flags.h"
+#include "tst_parse.h"
 #include "tst_test_macros.h"
 #include "tst_checkpoint.h"
 #include "tst_device.h"
@@ -39,57 +41,108 @@
 #include "tst_capability.h"
 #include "tst_hugepage.h"
 #include "tst_assert.h"
-#include "tst_lockdown.h"
-#include "tst_fips.h"
+#include "tst_security.h"
 #include "tst_taint.h"
 #include "tst_memutils.h"
 #include "tst_arch.h"
 #include "tst_fd.h"
 
-/*
- * Reports testcase result.
- */
 void tst_res_(const char *file, const int lineno, int ttype,
               const char *fmt, ...)
               __attribute__ ((format (printf, 4, 5)));
 
+/**
+ * tst_res() - Reports a test result.
+ *
+ * @ttype: An enum tst_res_type.
+ * @arg_fmt: A printf-like format.
+ * @...: A printf-like parameters.
+ *
+ * This is the main test reporting function. Each time this function is called
+ * with one of TPASS, TFAIL, TCONF, TBROK or TWARN a counter in page of shared
+ * memory is incremented. This means that there is no need to propagate test
+ * results from children and that results are accounted for once this function
+ * returns. The counters are incremented atomically which makes this function
+ * thread-safe.
+ */
 #define tst_res(ttype, arg_fmt, ...) \
 	({									\
 		TST_RES_SUPPORTS_TCONF_TDEBUG_TFAIL_TINFO_TPASS_TWARN(\
 			!((TTYPE_RESULT(ttype) ?: TCONF) & \
-			(TCONF | TDEBUG | TFAIL | TINFO | TPASS | TWARN))); 				\
+			(TCONF | TDEBUG | TFAIL | TINFO | TPASS | TWARN)));				\
 		tst_res_(__FILE__, __LINE__, (ttype), (arg_fmt), ##__VA_ARGS__);\
 	})
 
 void tst_resm_hexd_(const char *file, const int lineno, int ttype,
 	const void *buf, size_t size, const char *arg_fmt, ...)
 	__attribute__ ((format (printf, 6, 7)));
-
+/**
+ * tst_res_hexd() - Reports a test result along with hex dump of a buffer.
+ *
+ * This call is the same as tst_res() but includes a pointer and size of the
+ * buffer that is going to be printed in the output in a hexadecimal format.
+ *
+ * @ttype: An enum tst_res_type.
+ * @buf: A pointer to a buffer to print in hexadecimal format.
+ * @size: A size of the buffer.
+ * @arg_fmt: A printf-like format.
+ * @...: A printf-like parameters.
+ */
 #define tst_res_hexd(ttype, buf, size, arg_fmt, ...) \
 	tst_resm_hexd_(__FILE__, __LINE__, (ttype), (buf), (size), \
 			(arg_fmt), ##__VA_ARGS__)
 
-/*
- * Reports result and exits a test.
- */
 void tst_brk_(const char *file, const int lineno, int ttype,
               const char *fmt, ...)
               __attribute__ ((format (printf, 4, 5)));
 
+/**
+ * tst_brk() - Reports a breakage and exits the test.
+ *
+ * @ttype: An enum tst_res_type.
+ * @arg_fmt: A printf-like format.
+ * @...: A printf-like parameters.
+ *
+ * Reports either TBROK or TCONF and exits the test immediately. When called
+ * all children in the same process group as the main test library process are
+ * killed. This function, unless in a test cleanup, calls _exit() and does not
+ * return.
+ *
+ * When test is in cleanup() function TBROK is converted into TWARN by the test
+ * library and we attempt to carry on with a cleanup even when tst_brk() was
+ * called. This makes it possible to use SAFE_FOO() macros in the test cleanup
+ * without interrupting the cleanup process on a failure.
+ */
 #define tst_brk(ttype, arg_fmt, ...)						\
 	({									\
 		TST_BRK_SUPPORTS_ONLY_TCONF_TBROK(!((ttype) &			\
-			(TBROK | TCONF | TFAIL))); 				\
+			(TBROK | TCONF | TFAIL)));				\
 		tst_brk_(__FILE__, __LINE__, (ttype), (arg_fmt), ##__VA_ARGS__);\
 	})
 
 void tst_printf(const char *const fmt, ...)
 		__attribute__((nonnull(1), format (printf, 1, 2)));
 
-/* flush stderr and stdout */
+/**
+ * tst_flush() - Flushes the output file streams.
+ *
+ * There are rare cases when we want to flush the output file streams
+ * explicitly, e.g. before we do an action that may crash the test to ensure
+ * that the messages have been written out.
+ *
+ * This is also called by the SAFE_FORK() because otherwise each child would
+ * end up with the same copy of the file in it's memory and any messages in
+ * buffers would be multiplied.
+ */
 void tst_flush(void);
 
 pid_t safe_fork(const char *filename, unsigned int lineno);
+/**
+ * SAFE_FORK() - Forks a test child.
+ *
+ * This call makes sure that output file streams are flushed and also handles
+ * errors from fork(). Use this instead of fork() whenever possible!
+ */
 #define SAFE_FORK() \
 	safe_fork(__FILE__, __LINE__)
 
@@ -97,15 +150,30 @@ pid_t safe_fork(const char *filename, unsigned int lineno);
 	({int ret = expr;                                           \
 	  ret != 0 ? tst_res(TINFO, #expr " failed"), ret : ret; }) \
 
-/*
- * Functions to convert ERRNO to its name and SIGNAL to its name.
+/**
+ * tst_strerrno() - Converts an errno number into a name.
+ *
+ * @err: An errno number.
+ * return: An errno name e.g. "EINVAL".
  */
 const char *tst_strerrno(int err);
+
+/**
+ * tst_strsig() - Converts a signal number into a name.
+ *
+ * @sig: A signal number.
+ * return: A signal name e.g. "SIGINT".
+ */
 const char *tst_strsig(int sig);
-/*
- * Returns string describing status as returned by wait().
+
+
+/**
+ * tst_strstatus() - Returns string describing status as returned by wait().
+ *
+ * WARNING: Not thread safe.
  *
- * BEWARE: Not thread safe.
+ * @status: A status as returned by wait()
+ * return: A string description for the status e.g. "killed by SIGKILL".
  */
 const char *tst_strstatus(int status);
 
@@ -115,30 +183,49 @@ const char *tst_strstatus(int status);
 #include "tst_clone.h"
 #include "tst_cgroup.h"
 
-/*
- * Wait for all children and exit with TBROK if
- * any of them returned a non-zero exit status.
+/**
+ * tst_reap_children() - Waits for all child processes to exit.
+ *
+ * Wait for all children and exit with TBROK if any of them returned a non-zero
+ * exit status.
  */
 void tst_reap_children(void);
 
+/**
+ * struct tst_option - Test command line option.
+ *
+ * @optstr: A short command line option, e.g. "a" or "a:".
+ * @arg: A pointer to store the option value to.
+ * @help: A help string for the option displayed when test is passed '-h' on
+ *        the command-line.
+ */
 struct tst_option {
 	char *optstr;
 	char **arg;
 	char *help;
 };
 
-/*
- * Options parsing helpers.
+/**
+ * struct tst_tag - A test tag.
  *
- * If str is NULL these are No-op.
+ * @name: A tag name.
+ * @value: A tag value.
  *
- * On failure non-zero (errno) is returned.
+ * This structure is used to encode pointers to upstream commits in regression
+ * tests as well as CVE numbers or any additional useful hints.
+ *
+ * The content of these tags is printed by the test on a failure to help the
+ * testers with debugging.
+ *
+ * The supported tags are:
+ *
+ * - "linux-git" with first 12 numbers from an upstream kernel git hash.
+ * - "CVE" with a CVE number e.g. "2000-1234".
+ * - "glibc-git" with first 12 numbers from an upstream glibc git hash.
+ * - "musl-git" with first 12 numbers from an upstream musl git hash.
+ * - "known-fail" a message describing something that is supposed to work but
+ *   rather than that produces a longstanding failures.
  */
-int tst_parse_int(const char *str, int *val, int min, int max);
-int tst_parse_long(const char *str, long *val, long min, long max);
-int tst_parse_float(const char *str, float *val, float min, float max);
-int tst_parse_filesize(const char *str, long long *val, long long min, long long max);
-
 struct tst_tag {
 	const char *name;
 	const char *value;
@@ -146,211 +233,363 @@ struct tst_tag {
 
 extern unsigned int tst_variant;
 
-#define TST_NO_HUGEPAGES ((unsigned long)-1)
-
 #define TST_UNLIMITED_RUNTIME (-1)
 
-struct tst_test {
-	/* number of tests available in test() function */
+/**
+ * struct tst_ulimit_val - An ulimit resource and value.
+ *
+ * @resource: Which resource limits should be adjusted. See setrlimit(2) for
+ *            the list of the RLIMIT_* constants.
+ * @rlim_cur: A limit value.
+ */
+struct tst_ulimit_val {
+	int resource;
+	rlim_t rlim_cur;
+};
+
+/**
+ * struct tst_test - A test description.
+ *
+ * @tcnt: A number of tests. If set the test() callback is called tcnt times
+ *        and each time passed an increasing counter value.
+ * @options: An NULL optstr terminated array of struct tst_option.
+ *
+ * @min_kver: A minimal kernel version the test can run on. e.g. "3.10".
+ *
+ * @supported_archs: A NULL terminated array of architectures the test runs on
+ *                   e.g. {"x86_64, "x86", NULL}. Calls tst_is_on_arch() to
+ *                   check if current CPU architecture is supported and exits
+ *                   the test with TCONF if it's not.
+ *
+ * @tconf_msg: If set the test exits with TCONF right after entering the test
+ *             library. This is used by the TST_TEST_TCONF() macro to disable
+ *             tests at compile time.
+ *
+ * @needs_tmpdir: If set a temporary directory is prepared for the test inside
+ *                $TMPDIR and the test $CWD is set to point to it. The content
+ *                of the temporary directory is removed automatically after
+ *                the test is finished.
+ *
+ * @needs_root: If set the test exit with TCONF unless it's executed under root
+ *              user.
+ *
+ * @forks_child: Has to be set if the test intends to fork children.
+ *
+ * @needs_device: If set a block device is prepared for the test, the device
+ *                path and size are set in the struct tst_device variable
+ *                called tst_device. If $LTP_DEV variable exists in the test
+ *                environment the test attempts to use that device first and
+ *                only if that fails the test falls back to use loop devices.
+ *                This flag implies needs_tmpdir flag because loop device
+ *                backing files are created in the test temporary directory.
+ *
+ * @needs_checkpoints: Has to be set if the test wants to use checkpoint
+ *                     synchronization primitives.
+ *
+ * @needs_overlay: If set overlay file system is mounted on the top of the
+ *                 file system at tst_test.mntpoint.
+ *
+ * @format_device: Does all tst_test.needs_device would do and also formats
+ *                 the device with tst_test.dev_fs_type file system as well.
+ *
+ * @mount_device: Does all tst_test.format_device would do and also mounts the
+ *                device at tst_test.mntpoint.
+ *
+ * @needs_rofs: If set a read-only file system is mounted at tst_test.mntpoint.
+ *
+ * @child_needs_reinit: Has to be set if the test needs to call tst_reinit()
+ *                      from a process started by exec().
+ *
+ * @needs_devfs: If set the devfs is mounted at tst_test.mntpoint. This is
+ *               needed for tests that need to create device files since tmpfs
+ *               at /tmp is usually mounted with 'nodev' option.
+ *
+ * @restore_wallclock: Saves wall clock at the start of the test and restores
+ *                     it at the end with the help of monotonic timers.
+ *                     Testcases that modify system wallclock use this to
+ *                     restore the system to the previous state.
+ *
+ * @all_filesystems: If set the test is executed for all supported filesytems,
+ *                   i.e. file system that is supported by the kernel and has
+ *                   mkfs installed on the system.The file system is mounted at
+ *                   tst_test.mntpoint and file system details, e.g. type are set
+ *                   in the struct tst_device. Each execution is independent,
+ *                   that means that for each iteration tst_test.setup() is
+ *                   called at the test start and tst_test.cleanup() is called
+ *                   at the end and tst_brk() only exits test for a single
+ *                   file system. That especially means that calling
+ *                   tst_brk(TCONF, ...) in the test setup will skip the
+ *                   current file system.
+ *
+ * @skip_in_lockdown: Skip the test if kernel lockdown is enabled.
+ *
+ * @skip_in_secureboot: Skip the test if secureboot is enabled.
+ *
+ * @skip_in_compat: Skip the test if we are executing 32bit binary on a 64bit
+ *                  kernel, i.e. we are testing the kernel compat layer.
+ *
+ * @needs_abi_bits: Skip the test if runs on a different kernel ABI than
+ *                  requested (on 32bit instead of 64bit or vice versa).
+ *                  Possible values: 32, 64.
+ *
+ * @needs_hugetlbfs: If set hugetlbfs is mounted at tst_test.mntpoint.
+ *
+ * @skip_filesystems: A NULL terminated array of unsupported file systems. The
+ *                    test reports TCONF if the file system to be tested is
+ *                    present in the array. This is especially useful to filter
+ *                    out unsupported file system when tst_test.all_filesystems
+ *                    is enabled.
+ *
+ * @min_cpus: Minimal number of online CPUs the test needs to run.
+ *
+ * @min_mem_avail: Minimal amount of available RAM memory in megabytes required
+ *                 for the test to run.
+ *
+ * @min_swap_avail: Minimal amount of available swap memory in megabytes
+ *                  required for the test to run.
+ *
+ * @hugepages: An interface to reserve hugepages prior running the test.
+ *             Request how many hugepages should be reserved in the global
+ *             pool and also if having hugepages is required for the test run
+ *             or not, i.e. if test should exit with TCONF if the requested
+ *             amount of hugepages cannot be reserved. If TST_REQUEST is set
+ *             the library will try it's best to reserve the hugepages and
+ *             return the number of available hugepages in tst_hugepages, which
+ *             may be 0 if there is no free memory or hugepages are not
+ *             supported at all. If TST_NEEDS the requested hugepages are
+ *             required for the test and the test exits if it couldn't be
+ *             required. It can also be used to disable hugepages by setting
+ *             .hugepages = {TST_NO_HUGEPAGES}. The test library restores the
+ *             original poll allocations after the test has finished.
+ *
+ * @taint_check: If set the test fails if kernel is tainted during the test run.
+ *               That means tst_taint_init() is called during the test setup
+ *               and tst_taint_check() at the end of the test. If all_filesystems
+ *               is set taint check will be performed after each iteration and
+ *               testing will be terminated by TBROK if taint is detected.
+ *
+ * @test_variants: If set denotes number of test variant, the test is executed
+ *                 variants times each time with tst_variant set to different
+ *                 number. This allows us to run the same test for different
+ *                 settings. The intended use is to test different syscall
+ *                 wrappers/variants but the API is generic and does not limit
+ *                 usage in any way.
+ *
+ * @dev_min_size: A minimal device size in megabytes.
+ *
+ * @dev_fs_type: If set overrides the default file system type for the device and
+ *               sets the tst_device.fs_type.
+ *
+ * @dev_fs_opts: A NULL terminated array of options passed to mkfs in the case
+ *               of 'tst_test.format_device'. These options are passed to mkfs
+ *               before the device path.
+ *
+ * @dev_extra_opts: A NULL terminated array of extra options passed to mkfs in
+ *                  the case of 'tst_test.format_device'. Extra options are
+ *                  passed to mkfs after the device path. Commonly the option
+ *                  after mkfs is the number of blocks and can be used to limit
+ *                  the file system not to use the whole block device.
+ *
+ * @mntpoint: A mount point where the test library mounts requested file system.
+ *            The directory is created by the library, the test must not create
+ *            it itself.
+ *
+ * @mnt_flags: MS_* flags passed to mount(2) when the test library mounts a
+ *             device in the case of 'tst_test.mount_device'.
+ *
+ * @mnt_data: The data passed to mount(2) when the test library mounts a device
+ *            in the case of 'tst_test.mount_device'.
+ *
+ * @max_runtime: Maximal test runtime in seconds. Any test that runs for more
+ *               than a second or two should set this and also use
+ *               tst_remaining_runtime() to exit when runtime was used up.
+ *               Tests may finish sooner, for example if requested number of
+ *               iterations was reached before the runtime runs out. If test
+ *               runtime cannot be know in advance it should be set to
+ *               TST_UNLIMITED_RUNTIME.
+ *
+ * @setup: Setup callback is called once at the start of the test in order to
+ *         prepare the test environment.
+ *
+ * @cleanup: Cleanup callback is either called at the end of the test, or in a
+ *           case that tst_brk() was called. That means that cleanup must be
+ *           able to handle all possible states the test can be in. This
+ *           usually means that we have to check if file descriptor was opened
+ *           before we attempt to close it, etc.
+ *
+ *
+ * @test: A main test function, only one of the tst_test.test and test_all can
+ *        be set. When this function is set the tst_test.tcnt must be set to a
+ *        positive integer and this function will be executed tcnt times
+ *        during a single test iteration. May be executed several times if test
+ *        was passed '-i' or '-d' command line parameters.
+ *
+ * @test_all: A main test function, only one of the tst_test.test and test_all
+ *            can be set. May be executed several times if test was passed '-i'
+ *            or '-d' command line parameters.
+ *
+ * @resource_files: A NULL terminated array of filenames that will be copied
+ *                  to the test temporary directory from the LTP datafiles
+ *                  directory.
+ *
+ * @needs_drivers: A NULL terminated array of kernel modules required to run
+ *                 the test. The module has to be build in or present in order
+ *                 for the test to run.
+ *
+ * @save_restore: A {} terminated array of /proc or /sys files that should
+ *                saved at the start of the test and restored at the end. See
+ *                tst_sys_conf_save() and struct tst_path_val for details.
+ *
+ * @ulimit: A {} terminated array of process limits RLIMIT_* to be adjusted for
+ *          the test.
+ *
+ * @needs_kconfigs: A NULL terminated array of kernel config options that are
+ *                  required for the test. All strings in the array have to be
+ *                  evaluated to true for the test to run. Boolean operators
+ *                  and parenthesis are supported, e.g.
+ *                  "CONFIG_X86_INTEL_UMIP=y | CONFIG_X86_UIMP=y" is evaluated
+ *                  to true if at least one of the options is present.
+ *
+ * @bufs: A description of guarded buffers to be allocated for the test. Guarded
+ *        buffers are buffers with poisoned page allocated right before the start
+ *        of the buffer and canary right after the end of the buffer. See
+ *        struct tst_buffers and tst_buffer_alloc() for details.
+ *
+ * @caps: A {} terminated array of capabilities to change before the start of
+ *        the test. See struct tst_cap and tst_cap_setup() for details.
+ *
+ * @tags: A {} terminated array of test tags. See struct tst_tag for details.
+ *
+ * @needs_cmds: A NULL terminated array of commands required for the test to run.
+ *
+ * @needs_cgroup_ver: If set the test will run only if the specified cgroup
+ *                    version is present on the system.
+ *
+ * @needs_cgroup_ctrls: A {} terminated array of cgroup controllers the test
+ *                      needs to run.
+ *
+ * @needs_cgroup_nsdelegate: If set test the will run only if cgroup2 is mounted
+ *                           with nsdelegate option.
+ */
+
+ struct tst_test {
 	unsigned int tcnt;
 
 	struct tst_option *options;
 
 	const char *min_kver;
 
-	/*
-	 * The supported_archs is a NULL terminated list of archs the test
-	 * does support.
-	 */
 	const char *const *supported_archs;
 
-	/* If set the test is compiled out */
 	const char *tconf_msg;
 
-	int needs_tmpdir:1;
-	int needs_root:1;
-	int forks_child:1;
-	int needs_device:1;
-	int needs_checkpoints:1;
-	int needs_overlay:1;
-	int format_device:1;
-	int mount_device:1;
-	int needs_rofs:1;
-	int child_needs_reinit:1;
-	int needs_devfs:1;
-	int restore_wallclock:1;
-
-	/*
-	 * If set the test function will be executed for all available
-	 * filesystems and the current filesystem type would be set in the
-	 * tst_device->fs_type.
-	 *
-	 * The test setup and cleanup are executed before/after __EACH__ call
-	 * to the test function.
-	 */
-	int all_filesystems:1;
-
-	int skip_in_lockdown:1;
-	int skip_in_secureboot:1;
-	int skip_in_compat:1;
-
-	/*
-	 * If set, the hugetlbfs will be mounted at .mntpoint.
-	 */
-	int needs_hugetlbfs:1;
-
-	/*
-	 * The skip_filesystems is a NULL terminated list of filesystems the
-	 * test does not support. It can also be used to disable whole class of
-	 * filesystems with a special keywords such as "fuse".
-	 */
+	unsigned int needs_tmpdir:1;
+	unsigned int needs_root:1;
+	unsigned int forks_child:1;
+	unsigned int needs_device:1;
+	unsigned int needs_checkpoints:1;
+	unsigned int needs_overlay:1;
+	unsigned int format_device:1;
+	unsigned int mount_device:1;
+	unsigned int needs_rofs:1;
+	unsigned int child_needs_reinit:1;
+	unsigned int needs_devfs:1;
+	unsigned int restore_wallclock:1;
+
+	unsigned int all_filesystems:1;
+
+	unsigned int skip_in_lockdown:1;
+	unsigned int skip_in_secureboot:1;
+	unsigned int skip_in_compat:1;
+	int needs_abi_bits;
+
+	unsigned int needs_hugetlbfs:1;
+
 	const char *const *skip_filesystems;
 
-	/* Minimum number of online CPU required by the test */
 	unsigned long min_cpus;
-
-	/* Minimum size(MB) of MemAvailable required by the test */
 	unsigned long min_mem_avail;
-
-	/* Minimum size(MB) of SwapFree required by the test */
 	unsigned long min_swap_avail;
 
-	/*
-	 * Two policies for reserving hugepage:
-	 *
-	 * TST_REQUEST:
-	 *   It will try the best to reserve available huge pages and return the number
-	 *   of available hugepages in tst_hugepages, which may be 0 if hugepages are
-	 *   not supported at all.
-	 *
-	 * TST_NEEDS:
-	 *   This is an enforced requirement, LTP should strictly do hpages applying and
-	 *   guarantee the 'HugePages_Free' no less than pages which makes that test can
-	 *   use these specified numbers correctly. Otherwise, test exits with TCONF if
-	 *   the attempt to reserve hugepages fails or reserves less than requested.
-	 *
-	 * With success test stores the reserved hugepage number in 'tst_hugepages. For
-	 * the system without hugetlb supporting, variable 'tst_hugepages' will be set to 0.
-	 * If the hugepage number needs to be set to 0 on supported hugetlb system, please
-	 * use '.hugepages = {TST_NO_HUGEPAGES}'.
-	 *
-	 * Also, we do cleanup and restore work for the hpages resetting automatically.
-	 */
 	struct tst_hugepage hugepages;
 
-	/*
-	 * If set to non-zero, call tst_taint_init(taint_check) during setup
-	 * and check kernel taint at the end of the test. If all_filesystems
-	 * is non-zero, taint check will be performed after each FS test and
-	 * testing will be terminated by TBROK if taint is detected.
-	 */
 	unsigned int taint_check;
 
-	/*
-	 * If set non-zero denotes number of test variant, the test is executed
-	 * variants times each time with tst_variant set to different number.
-	 *
-	 * This allows us to run the same test for different settings. The
-	 * intended use is to test different syscall wrappers/variants but the
-	 * API is generic and does not limit the usage in any way.
-	 */
 	unsigned int test_variants;
 
-	/* Minimal device size in megabytes */
 	unsigned int dev_min_size;
 
-	/* Device filesystem type override NULL == default */
 	const char *dev_fs_type;
 
-	/* Options passed to SAFE_MKFS() when format_device is set */
 	const char *const *dev_fs_opts;
 	const char *const *dev_extra_opts;
 
-	/* Device mount options, used if mount_device is set */
 	const char *mntpoint;
 	unsigned int mnt_flags;
 	void *mnt_data;
 
-	/*
-	 * Maximal test runtime in seconds.
-	 *
-	 * Any test that runs for more than a second or two should set this and
-	 * also use tst_remaining_runtime() to exit when runtime was used up.
-	 * Tests may finish sooner, for example if requested number of
-	 * iterations was reached before the runtime runs out.
-	 *
-	 * If test runtime cannot be know in advance it should be set to
-	 * TST_UNLIMITED_RUNTIME.
-	 */
 	int max_runtime;
 
 	void (*setup)(void);
 	void (*cleanup)(void);
-
 	void (*test)(unsigned int test_nr);
 	void (*test_all)(void);
 
-	/* Syscall name used by the timer measurement library */
 	const char *scall;
-
-	/* Sampling function for timer measurement testcases */
 	int (*sample)(int clk_id, long long usec);
 
-	/* NULL terminated array of resource file names */
 	const char *const *resource_files;
-
-	/* NULL terminated array of needed kernel drivers */
 	const char * const *needs_drivers;
 
-	/*
-	 * {NULL, NULL} terminated array of (/proc, /sys) files to save
-	 * before setup and restore after cleanup
-	 */
 	const struct tst_path_val *save_restore;
 
-	/*
-	 * NULL terminated array of kernel config options required for the
-	 * test.
-	 */
+	const struct tst_ulimit_val *ulimit;
+
 	const char *const *needs_kconfigs;
 
-	/*
-	 * {NULL, NULL} terminated array to be allocated buffers.
-	 */
 	struct tst_buffers *bufs;
 
-	/*
-	 * {NULL, NULL} terminated array of capability settings
-	 */
 	struct tst_cap *caps;
 
-	/*
-	 * {NULL, NULL} terminated array of tags.
-	 */
 	const struct tst_tag *tags;
 
-	/* NULL terminated array of required commands */
 	const char *const *needs_cmds;
 
-	/* Requires a particular CGroup API version. */
 	const enum tst_cg_ver needs_cgroup_ver;
 
-	/* {} terminated array of required CGroup controllers */
 	const char *const *needs_cgroup_ctrls;
+
+	int needs_cgroup_nsdelegate:1;
 };
 
-/*
- * Runs tests.
+/**
+ * tst_run_tcases() - Entry point to the test library.
+ *
+ * @argc: An argc that was passed to the main().
+ * @argv: An argv that was passed to the main().
+ * @self: The test description and callbacks packed in the struct tst_test
+ *        structure.
+ *
+ * A main() function which calls this function is added to each test
+ * automatically by including the tst_test.h header. The test has to define the
+ * struct tst_test called test.
+ *
+ * This function does not return, i.e. calls exit() after the test has finished.
  */
 void tst_run_tcases(int argc, char *argv[], struct tst_test *self)
                     __attribute__ ((noreturn));
 
 #define IPC_ENV_VAR "LTP_IPC_PATH"
 
-/*
- * Does library initialization for child processes started by exec()
+/**
+ * tst_reinit() - Reinitialize the test library.
  *
- * The LTP_IPC_PATH variable must be passed to the program environment.
+ * In a cases where a test child process calls exec() it no longer can access
+ * the test library shared memory and therefore use the test reporting
+ * functions, checkpoint library, etc. This function re-initializes the test
+ * library so that it can be used again.
+ *
+ * @important The LTP_IPC_PATH variable must be passed to the program environment.
  */
 void tst_reinit(void);
 
@@ -405,6 +644,12 @@ int main(int argc, char *argv[])
 
 #endif /* TST_NO_DEFAULT_MAIN */
 
+/**
+ * TST_TEST_TCONF() - Exit tests with a TCONF message.
+ *
+ * This macro is used in test that couldn't be compiled either because current
+ * CPU architecture is unsupported or because of missing development libraries.
+ */
 #define TST_TEST_TCONF(message)                                 \
         static struct tst_test test = { .tconf_msg = message  } \
 
diff --git a/include/tst_test_macros.h b/include/tst_test_macros.h
index d2e50a219..22b39fb14 100644
--- a/include/tst_test_macros.h
+++ b/include/tst_test_macros.h
@@ -227,6 +227,41 @@ const char *tst_errno_names(char *buf, const int *exp_errs, int exp_errs_cnt);
 		}                                                              \
 	} while (0)
 
+#define TST_EXP_FAIL_SILENT_PTR_(SCALL, SSCALL, FAIL_PTR_VAL,                  \
+	ERRNOS, ERRNOS_CNT, ...)                                               \
+	do {                                                                   \
+		TESTPTR(SCALL);                                                \
+		                                                               \
+		TST_PASS = 0;                                                  \
+		                                                               \
+		if (TST_RET_PTR != FAIL_PTR_VAL) {                             \
+			TST_MSG_(TFAIL, " succeeded", SSCALL, ##__VA_ARGS__);  \
+		        break;                                                 \
+		}                                                              \
+		                                                               \
+		if (!tst_errno_in_set(TST_ERR, ERRNOS, ERRNOS_CNT)) {          \
+			char tst_str_buf__[ERRNOS_CNT * 20];                   \
+			TST_MSGP_(TFAIL | TTERRNO, " expected %s",             \
+				  tst_errno_names(tst_str_buf__,               \
+						  ERRNOS, ERRNOS_CNT),         \
+				  SSCALL, ##__VA_ARGS__);                      \
+			break;                                                 \
+		}                                                              \
+                                                                               \
+		TST_PASS = 1;                                                  \
+                                                                               \
+	} while (0)
+
+#define TST_EXP_FAIL_PTR_(SCALL, SSCALL, FAIL_PTR_VAL,                         \
+	ERRNOS, ERRNOS_CNT, ...)                                               \
+	do {                                                                   \
+		TST_EXP_FAIL_SILENT_PTR_(SCALL, SSCALL, FAIL_PTR_VAL,          \
+	        ERRNOS, ERRNOS_CNT, ##__VA_ARGS__);                            \
+		if (TST_PASS)                                                  \
+			TST_MSG_(TPASS | TTERRNO, " ", SSCALL, ##__VA_ARGS__); \
+	} while (0)
+
+
 #define TST_EXP_FAIL_ARR_(SCALL, SSCALL, EXP_ERRS, EXP_ERRS_CNT, ...)          \
 	do {                                                                   \
 		TST_EXP_FAIL_SILENT_(TST_RET == 0, SCALL, SSCALL,              \
@@ -242,9 +277,9 @@ const char *tst_errno_names(char *buf, const int *exp_errs, int exp_errs_cnt);
                                   ##__VA_ARGS__);                              \
 	} while (0)
 
-#define TST_EXP_FAIL_ARR(SCALL, EXP_ERRS, ...)                                 \
+#define TST_EXP_FAIL_ARR(SCALL, EXP_ERRS, EXP_ERRS_CNT, ...)                   \
 		TST_EXP_FAIL_ARR_(SCALL, #SCALL, EXP_ERRS,                     \
-				  ARRAY_SIZE(EXP_ERRS), ##__VA_ARGS__);
+				  EXP_ERRS_CNT, ##__VA_ARGS__);
 
 #define TST_EXP_FAIL2_ARR_(SCALL, SSCALL, EXP_ERRS, EXP_ERRS_CNT, ...)         \
 	do {                                                                   \
@@ -254,9 +289,35 @@ const char *tst_errno_names(char *buf, const int *exp_errs, int exp_errs_cnt);
 			TST_MSG_(TPASS | TTERRNO, " ", SSCALL, ##__VA_ARGS__); \
 	} while (0)
 
-#define TST_EXP_FAIL2_ARR(SCALL, EXP_ERRS, ...)                                \
+#define TST_EXP_FAIL2_ARR(SCALL, EXP_ERRS, EXP_ERRS_CNT, ...)                \
 		TST_EXP_FAIL2_ARR_(SCALL, #SCALL, EXP_ERRS,                    \
-		                  ARRAY_SIZE(EXP_ERRS), ##__VA_ARGS__);
+		                  EXP_ERRS_CNT, ##__VA_ARGS__);
+
+#define TST_EXP_FAIL_PTR_NULL(SCALL, EXP_ERR, ...)                          \
+	do {                                                                   \
+		int tst_exp_err__ = EXP_ERR;                                   \
+		TST_EXP_FAIL_PTR_(SCALL, #SCALL, NULL,                         \
+			&tst_exp_err__, 1, ##__VA_ARGS__);                     \
+	} while (0)
+
+#define TST_EXP_FAIL_PTR_NULL_ARR(SCALL, EXP_ERRS, EXP_ERRS_CNT, ...)      \
+	do {                                                                   \
+		TST_EXP_FAIL_PTR_(SCALL, #SCALL, NULL,                         \
+			EXP_ERRS, EXP_ERRS_CNT, ##__VA_ARGS__);        \
+	} while (0)
+
+#define TST_EXP_FAIL_PTR_VOID(SCALL, EXP_ERR, ...)                         \
+	do {                                                                   \
+		int tst_exp_err__ = EXP_ERR;                                   \
+		TST_EXP_FAIL_PTR_(SCALL, #SCALL, (void *)-1,                   \
+			&tst_exp_err__, 1, ##__VA_ARGS__);                     \
+	} while (0)
+
+#define TST_EXP_FAIL_PTR_VOID_ARR(SCALL, EXP_ERRS, EXP_ERRS_CNT, ...)      \
+	do {                                                                   \
+		TST_EXP_FAIL_PTR_(SCALL, #SCALL, (void *)-1,                   \
+			EXP_ERRS, EXP_ERRS_CNT, ##__VA_ARGS__);        \
+	} while (0)
 
 #define TST_EXP_FAIL2(SCALL, EXP_ERR, ...)                                     \
 	do {                                                                   \
diff --git a/include/tst_timer.h b/include/tst_timer.h
index f5631e6cc..c477753c7 100644
--- a/include/tst_timer.h
+++ b/include/tst_timer.h
@@ -97,6 +97,8 @@ static inline long long tst_timeval_diff_ms(struct timeval t1,
 	return tst_timeval_to_ms(tst_timeval_diff(t1, t2));
 }
 
+#ifndef __kernel_timespec
+
 typedef __kernel_long_t	__kernel_old_time_t;
 
 #ifndef HAVE_STRUCT___KERNEL_OLD_TIMEVAL
@@ -136,6 +138,14 @@ struct __kernel_itimerspec {
 };
 #endif
 
+#ifndef HAVE_STRUCT___KERNEL_OLD_ITIMERVAL
+struct __kernel_old_itimerval {
+	struct __kernel_old_timeval it_interval;	/* timer interval */
+	struct __kernel_old_timeval it_value;		/* current value */
+};
+#endif
+#endif
+
 enum tst_ts_type {
 	TST_LIBC_TIMESPEC,
 	TST_KERN_OLD_TIMESPEC,
@@ -369,6 +379,11 @@ static inline int sys_timerfd_settime64(int fd, int flags, void *its,
 	return tst_syscall(__NR_timerfd_settime64, fd, flags, its, old_its);
 }
 
+static inline int sys_setitimer(int which, void *new_value, void *old_value)
+{
+	return tst_syscall(__NR_setitimer, which, new_value, old_value);
+}
+
 /*
  * Returns tst_ts seconds.
  */
diff --git a/lib/newlib_tests/.gitignore b/lib/newlib_tests/.gitignore
index a69b29e24..6d125f933 100644
--- a/lib/newlib_tests/.gitignore
+++ b/lib/newlib_tests/.gitignore
@@ -31,6 +31,7 @@ test_exec_child
 test_kconfig
 test_kconfig01
 test_kconfig02
+test_kconfig03
 variant
 test_guarded_buf
 tst_bool_expr
@@ -57,3 +58,4 @@ test_runtime01
 test_runtime02
 test_children_cleanup
 tst_res_flags
+tst_safe_sscanf
\ No newline at end of file
diff --git a/lib/newlib_tests/runtest.sh b/lib/newlib_tests/runtest.sh
index be707fe63..8f2a497b1 100755
--- a/lib/newlib_tests/runtest.sh
+++ b/lib/newlib_tests/runtest.sh
@@ -4,7 +4,7 @@
 LTP_C_API_TESTS="${LTP_C_API_TESTS:-test05 test07 test09 test15 test_runtime01
 tst_needs_cmds01 tst_needs_cmds02 tst_needs_cmds03 tst_needs_cmds06
 tst_needs_cmds07 tst_bool_expr test_exec test_timer tst_res_hexd tst_strstatus
-tst_fuzzy_sync03 test_zero_hugepage.sh test_kconfig.sh
+tst_fuzzy_sync03 test_zero_hugepage.sh test_kconfig.sh test_kconfig03
 test_children_cleanup.sh}"
 
 LTP_SHELL_API_TESTS="${LTP_SHELL_API_TESTS:-shell/tst_check_driver.sh
diff --git a/lib/newlib_tests/test_kconfig03.c b/lib/newlib_tests/test_kconfig03.c
new file mode 100644
index 000000000..52c0c1b4b
--- /dev/null
+++ b/lib/newlib_tests/test_kconfig03.c
@@ -0,0 +1,37 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) 2024 Li Wang <liwang@redhat.com>
+ */
+
+#include "tst_test.h"
+#include "tst_kconfig.h"
+
+static struct tst_kcmdline_var params[] = {
+	TST_KCMDLINE_INIT("BOOT_IMAGE"),
+	TST_KCMDLINE_INIT("root"),
+	TST_KCMDLINE_INIT("foo")
+};
+
+static void do_test(void)
+{
+	int i, N;
+
+	N = (int) ARRAY_SIZE(params);
+
+	tst_kcmdline_parse(params, N);
+
+	for (i = 0; i < N; i++) {
+		if (params[i].found) {
+			tst_res(TPASS, "params[%d] = {%s, %s}", i, params[i].key, params[i].value);
+		} else {
+			if (!strcmp(params[i].key, "foo"))
+				tst_res(TPASS, "%s is not found in /proc/cmdline", params[i].key);
+			else
+				tst_res(TFAIL, "%s is not found in /proc/cmdline", params[i].key);
+		}
+	}
+}
+
+static struct tst_test test = {
+	.test_all = do_test,
+};
diff --git a/lib/newlib_tests/test_macros02.c b/lib/newlib_tests/test_macros02.c
index 6c1ca7a8a..1b12fab73 100644
--- a/lib/newlib_tests/test_macros02.c
+++ b/lib/newlib_tests/test_macros02.c
@@ -1,10 +1,20 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2020 Cyril Hrubis <chrubis@suse.cz>
+ * Copyright (c) Linux Test Project, 2021-2024
  */
 
 /*
- * Test TST_EXP_FAIL and TST_EXP_FAIL2 macro.
+ * Test macros:
+ *
+ * - TST_EXP_FAIL
+ * - TST_EXP_FAIL_ARR
+ * - TST_EXP_FAIL2
+ * - TST_EXP_FAIL2_ARR
+ * - TST_EXP_FAIL_PTR_NULL
+ * - TST_EXP_FAIL_PTR_NULL_ARR
+ * - TST_EXP_FAIL_PTR_VOID
+ * - TST_EXP_FAIL_PTR_VOID_ARR
  */
 
 #include "tst_test.h"
@@ -25,38 +35,56 @@ static int inval_ret_fn(void)
 	return 42;
 }
 
+static char *fail_fn_null(void)
+{
+	errno = EINVAL;
+	return NULL;
+}
+
+static char *fail_fn_void(void)
+{
+	errno = EINVAL;
+	return (void *)-1;
+}
+
+static char *inval_ret_fn_char(void)
+{
+	return (void *)-1;
+}
+
+static char *pass_fn_char(void)
+{
+	return "pass";
+}
+
+#define TEST_MACRO(macro, macro_arr, fail_fn, pass_fn, inval_fn) \
+	do { \
+		tst_res(TINFO, "Testing " #macro " macro"); \
+		macro(fail_fn(), EINVAL, #fail_fn"()"); \
+		tst_res(TINFO, "TST_PASS = %i", TST_PASS); \
+		macro(fail_fn(), ENOTTY); /* skip msg parameter */ \
+		tst_res(TINFO, "TST_PASS = %i", TST_PASS); \
+		macro(pass_fn(), ENOTTY, #pass_fn"()"); \
+		tst_res(TINFO, "TST_PASS = %i", TST_PASS); \
+		macro(inval_fn(), ENOTTY, #inval_fn"()"); \
+		tst_res(TINFO, "TST_PASS = %i", TST_PASS); \
+		macro_arr(fail_fn(), exp_errs_pass, ARRAY_SIZE(exp_errs_pass), #fail_fn"()"); \
+		tst_res(TINFO, "TST_PASS = %i", TST_PASS); \
+		macro_arr(fail_fn(), exp_errs_fail, ARRAY_SIZE(exp_errs_fail)); /* skip msg parameter */ \
+		tst_res(TINFO, "TST_PASS = %i", TST_PASS); \
+	} while (0)
+
 static void do_test(void)
 {
 	const int exp_errs_pass[] = {ENOTTY, EINVAL};
 	const int exp_errs_fail[] = {ENOTTY, EISDIR};
 
-	tst_res(TINFO, "Testing TST_EXP_FAIL macro");
-	TST_EXP_FAIL(fail_fn(), EINVAL, "fail_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL(fail_fn(), ENOTTY, "fail_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL(pass_fn(), ENOTTY, "pass_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL(inval_ret_fn(), ENOTTY, "inval_ret_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL_ARR(fail_fn(), exp_errs_pass, "fail_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL_ARR(fail_fn(), exp_errs_fail, "fail_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-
-	tst_res(TINFO, "Testing TST_EXP_FAIL2 macro");
-	TST_EXP_FAIL2(fail_fn(), EINVAL, "fail_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL2(fail_fn(), ENOTTY, "fail_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL2(pass_fn(), ENOTTY, "pass_fn");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL2(inval_ret_fn(), ENOTTY, "inval_ret_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL2_ARR(fail_fn(), exp_errs_pass, "fail_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
-	TST_EXP_FAIL2_ARR(fail_fn(), exp_errs_fail, "fail_fn()");
-	tst_res(TINFO, "TST_PASS = %i", TST_PASS);
+	TEST_MACRO(TST_EXP_FAIL, TST_EXP_FAIL_ARR, fail_fn, pass_fn, inval_ret_fn);
+	TEST_MACRO(TST_EXP_FAIL2, TST_EXP_FAIL2_ARR, fail_fn, pass_fn, inval_ret_fn);
+	TEST_MACRO(TST_EXP_FAIL_PTR_NULL, TST_EXP_FAIL_PTR_NULL_ARR, fail_fn_null,
+			   pass_fn_char, inval_ret_fn_char);
+	TEST_MACRO(TST_EXP_FAIL_PTR_VOID, TST_EXP_FAIL_PTR_VOID_ARR, fail_fn_void,
+			   pass_fn_char, inval_ret_fn_char);
 }
 
 static struct tst_test test = {
diff --git a/lib/newlib_tests/tst_safe_sscanf.c b/lib/newlib_tests/tst_safe_sscanf.c
new file mode 100644
index 000000000..68f49a87a
--- /dev/null
+++ b/lib/newlib_tests/tst_safe_sscanf.c
@@ -0,0 +1,25 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) 2024 Linux Test Project
+ */
+
+/*
+ * Basic unit test for the tst_safe_sscanf() function.
+ */
+
+#include "tst_test.h"
+
+static void check_safe_sscanf(void)
+{
+	int day, month, year;
+	int nvalues = SAFE_SSCANF("14-07-2023", "%d-%d-%d", &day, &month, &year);
+
+	if (nvalues == 3 && day == 14 && month == 7 && year == 2023)
+		tst_res(TPASS, "%d values parsed : %d,%d,%d", nvalues, day, month, year);
+	else
+		tst_res(TFAIL, "expected 3 values 14,7,2023 got: %d values %d,%d,%d", nvalues, day, month, year);
+}
+
+static struct tst_test test = {
+	.test_all = check_safe_sscanf,
+};
diff --git a/lib/parse_opts.c b/lib/parse_opts.c
index a9d50589a..03e833312 100644
--- a/lib/parse_opts.c
+++ b/lib/parse_opts.c
@@ -88,11 +88,6 @@ static struct std_option_t {
 	{"h", "  -h      Show this help screen\n", NULL, NULL},
 	{"i:", "  -i n    Execute test n times\n", NULL, NULL},
 	{"I:", "  -I x    Execute test for x seconds\n", NULL, NULL},
-#ifdef UCLINUX
-	{"C:",
-	      "  -C ARG  Run the child process with arguments ARG (for internal use)\n",
-		    NULL, NULL},
-#endif
 	{NULL, NULL, NULL, NULL}
 };
 
@@ -118,11 +113,6 @@ static void usc_recressive_func();
 #define OPT_duration		04
 #define OPT_delay		010
 
-#ifdef UCLINUX
-/* Allocated and used in self_exec.c: */
-extern char *child_args;	/* Arguments to child when -C is used */
-#endif
-
 static void print_help(void (*user_help)(void))
 {
 	int i;
@@ -219,11 +209,6 @@ const char *parse_opts(int ac, char **av, const option_t * user_optarr,
 			print_help(uhf);
 			exit(0);
 			break;
-#ifdef UCLINUX
-		case 'C':	/* Run child */
-			child_args = optarg;
-			break;
-#endif
 		default:
 
 			/* Check all the user specified options */
@@ -400,7 +385,7 @@ const char *parse_opts(int ac, char **av, const option_t * user_optarr,
 				     STD_TP_sbrk);
 		}
 	}
-#if !defined(UCLINUX)
+
 	if ((ptr = getenv("USC_LP_SBRK")) != NULL) {
 		if (sscanf(ptr, "%i", &k) == 1 && k >= 0) {
 			STD_LP_sbrk = k;
@@ -410,7 +395,6 @@ const char *parse_opts(int ac, char **av, const option_t * user_optarr,
 				     STD_LP_sbrk);
 		}
 	}
-#endif /* if !defined(UCLINUX) */
 
 	if ((ptr = getenv("USC_LP_RECFUN")) != NULL) {
 		if (sscanf(ptr, "%i", &k) == 1 && k >= 0) {
@@ -453,7 +437,6 @@ const char *parse_opts(int ac, char **av, const option_t * user_optarr,
  ***********************************************************************/
 int usc_global_setup_hook(void)
 {
-#ifndef UCLINUX
 	if (STD_TP_sbrk || STD_LP_sbrk)
 		STD_start_break = sbrk(0);	/* get original sbreak size */
 
@@ -462,7 +445,6 @@ int usc_global_setup_hook(void)
 		if (Debug)
 			printf("after sbrk(%d)\n", STD_TP_sbrk);
 	}
-#endif
 	return 0;
 }
 
@@ -538,13 +520,12 @@ int usc_test_looping(int counter)
 			     STD_LP_recfun);
 		usc_recressive_func(0, STD_LP_recfun, *STD_bigstack);
 	}
-#if !defined(UCLINUX)
+
 	if (STD_LP_sbrk) {
 		if (Debug)
 			printf("about to do sbrk(%d)\n", STD_LP_sbrk);
 		sbrk(STD_LP_sbrk);
 	}
-#endif
 
 	if (keepgoing)
 		return 1;
diff --git a/lib/safe_macros.c b/lib/safe_macros.c
index 951e1b064..109268587 100644
--- a/lib/safe_macros.c
+++ b/lib/safe_macros.c
@@ -913,7 +913,10 @@ int safe_mount(const char *file, const int lineno, void (*cleanup_fn)(void),
 	 * the kernel's NTFS driver doesn't have proper write support.
 	 */
 	if (!filesystemtype || strcmp(filesystemtype, "ntfs")) {
+		mode_t old_umask = umask(0);
+
 		rval = mount(source, target, filesystemtype, mountflags, data);
+		umask(old_umask);
 		if (!rval)
 			return 0;
 	}
diff --git a/lib/self_exec.c b/lib/self_exec.c
deleted file mode 100644
index de7d09517..000000000
--- a/lib/self_exec.c
+++ /dev/null
@@ -1,225 +0,0 @@
-/* -*- mode: C; c-basic-offset: 4; indent-tabs-mode: t -*- */
-/*
- * self_exec.c: self_exec magic required to run child functions on uClinux
- *
- * Copyright (C) 2005 Paul J.Y. Lahaie <pjlahaie-at-steamballoon.com>
- *
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * This software was produced by Steamballoon Incorporated
- * 55 Byward Market Square, 2nd Floor North, Ottawa, ON K1N 9C3, Canada
- */
-
-#define _GNU_SOURCE		/* for asprintf */
-
-#include "config.h"
-
-#ifdef UCLINUX
-
-#include <stdarg.h>
-#include <string.h>
-#include <stdio.h>
-#include "test.h"
-#include "safe_macros.h"
-
-/* Set from parse_opts.c: */
-char *child_args;		/* Arguments to child when -C is used */
-
-static char *start_cwd;		/* Stores the starting directory for self_exec */
-
-int asprintf(char **app, const char *fmt, ...)
-{
-	va_list ptr;
-	int rv;
-	char *p;
-
-	/*
-	 * First iteration - find out size of buffer required and allocate it.
-	 */
-	va_start(ptr, fmt);
-	rv = vsnprintf(NULL, 0, fmt, ptr);
-	va_end(ptr);
-
-	p = malloc(++rv);	/* allocate the buffer */
-	*app = p;
-	if (!p) {
-		return -1;
-	}
-
-	/*
-	 * Second iteration - actually produce output.
-	 */
-	va_start(ptr, fmt);
-	rv = vsnprintf(p, rv, fmt, ptr);
-	va_end(ptr);
-
-	return rv;
-}
-
-void maybe_run_child(void (*child) (), const char *fmt, ...)
-{
-	va_list ap;
-	char *child_dir;
-	char *p, *tok;
-	int *iptr, i, j;
-	char *s;
-	char **sptr;
-	char *endptr;
-
-	/* Store the current directory for later use. */
-	start_cwd = getcwd(NULL, 0);
-
-	if (child_args) {
-		char *args = strdup(child_args);
-
-		child_dir = strtok(args, ",");
-		if (strlen(child_dir) == 0) {
-			tst_brkm(TBROK, NULL,
-				 "Could not get directory from -C option");
-			return;
-		}
-
-		va_start(ap, fmt);
-
-		for (p = fmt; *p; p++) {
-			tok = strtok(NULL, ",");
-			if (!tok || strlen(tok) == 0) {
-				tst_brkm(TBROK, NULL,
-					 "Invalid argument to -C option");
-				return;
-			}
-
-			switch (*p) {
-			case 'd':
-				iptr = va_arg(ap, int *);
-				i = strtol(tok, &endptr, 10);
-				if (*endptr != '\0') {
-					tst_brkm(TBROK, NULL,
-						 "Invalid argument to -C option");
-					return;
-				}
-				*iptr = i;
-				break;
-			case 'n':
-				j = va_arg(ap, int);
-				i = strtol(tok, &endptr, 10);
-				if (*endptr != '\0') {
-					tst_brkm(TBROK, NULL,
-						 "Invalid argument to -C option");
-					return;
-				}
-				if (j != i) {
-					va_end(ap);
-					free(args);
-					return;
-				}
-				break;
-			case 's':
-				s = va_arg(ap, char *);
-				if (!strncpy(s, tok, strlen(tok) + 1)) {
-					tst_brkm(TBROK, NULL,
-						 "Could not strncpy for -C option");
-					return;
-				}
-				break;
-			case 'S':
-				sptr = va_arg(ap, char **);
-				*sptr = strdup(tok);
-				if (!*sptr) {
-					tst_brkm(TBROK, NULL,
-						 "Could not strdup for -C option");
-					return;
-				}
-				break;
-			default:
-				tst_brkm(TBROK, NULL,
-					 "Format string option %c not implemented",
-					 *p);
-				return;
-			}
-		}
-
-		va_end(ap);
-		free(args);
-		SAFE_CHDIR(NULL, child_dir);
-
-		(*child) ();
-		tst_resm(TWARN, "Child function returned unexpectedly");
-		/* Exit here? or exit silently? */
-	}
-}
-
-int self_exec(const char *argv0, const char *fmt, ...)
-{
-	va_list ap;
-	char *p;
-	char *tmp_cwd;
-	char *arg;
-	int ival;
-	char *str;
-
-	if ((tmp_cwd = getcwd(NULL, 0)) == NULL) {
-		tst_resm(TBROK, "Could not getcwd()");
-		return -1;
-	}
-
-	arg = strdup(tmp_cwd);
-	if (arg == NULL) {
-		tst_resm(TBROK, "Could not produce self_exec string");
-		return -1;
-	}
-
-	va_start(ap, fmt);
-
-	for (p = fmt; *p; p++) {
-		switch (*p) {
-		case 'd':
-		case 'n':
-			ival = va_arg(ap, int);
-			if (asprintf(&arg, "%s,%d", arg, ival) < 0) {
-				tst_resm(TBROK,
-					 "Could not produce self_exec string");
-				return -1;
-			}
-			break;
-		case 's':
-		case 'S':
-			str = va_arg(ap, char *);
-			if (asprintf(&arg, "%s,%s", arg, str) < 0) {
-				tst_resm(TBROK,
-					 "Could not produce self_exec string");
-				return -1;
-			}
-			break;
-		default:
-			tst_resm(TBROK,
-				 "Format string option %c not implemented", *p);
-			return -1;
-			break;
-		}
-	}
-
-	va_end(ap);
-
-	if (chdir(start_cwd) < 0) {
-		tst_resm(TBROK, "Could not change to %s for self_exec",
-			 start_cwd);
-		return -1;
-	}
-
-	return execlp(argv0, argv0, "-C", arg, (char *)NULL);
-}
-
-#endif /* UCLINUX */
diff --git a/lib/tlibio.c b/lib/tlibio.c
index bfb4ea023..ed82a85b4 100644
--- a/lib/tlibio.c
+++ b/lib/tlibio.c
@@ -108,7 +108,7 @@
 #include <string.h>
 #endif
 #if defined(__linux__) || defined(__sun) || defined(__hpux) || defined(_AIX)
-#if !defined(UCLINUX) && !defined(__UCLIBC__)
+#ifndef __UCLIBC__
 #include <aio.h>
 #endif
 #endif
diff --git a/lib/tst_buffers.c b/lib/tst_buffers.c
index b0bd359eb..ac76a784b 100644
--- a/lib/tst_buffers.c
+++ b/lib/tst_buffers.c
@@ -25,6 +25,7 @@ static void setup_canary(struct map *map)
 
 	for (i = 0; i < map->buf_shift/2; i++) {
 		char c = random();
+
 		buf[map->buf_shift - i - 1] = c;
 		buf[i] = c;
 	}
@@ -39,7 +40,7 @@ static void check_canary(struct map *map)
 		if (buf[map->buf_shift - i - 1] != buf[i]) {
 			tst_res(TWARN,
 				"pid %i: buffer modified address %p[%zi]",
-				getpid(), (char*)map->addr + map->buf_shift, -i-1);
+				getpid(), (char *)map->addr + map->buf_shift, -i-1);
 		}
 	}
 }
@@ -58,7 +59,7 @@ void *tst_alloc(size_t size)
 	}
 
 	ret = SAFE_MMAP(NULL, page_size * pages, PROT_READ | PROT_WRITE,
-	                MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);
+			MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);
 
 	mprotect(ret + (pages-1) * page_size, page_size, PROT_NONE);
 
@@ -83,15 +84,15 @@ char *tst_aprintf(const char *fmt, ...)
 	int len;
 	char *ret;
 
-        va_start(va, fmt);
-        len = vsnprintf(NULL, 0, fmt, va)+1;
-        va_end(va);
+	va_start(va, fmt);
+	len = vsnprintf(NULL, 0, fmt, va)+1;
+	va_end(va);
 
 	ret = tst_alloc(len);
 
 	va_start(va, fmt);
-        vsprintf(ret, fmt, va);
-        va_end(va);
+	vsprintf(ret, fmt, va);
+	va_end(va);
 
 	return ret;
 }
@@ -100,7 +101,8 @@ static int count_iovec(int *sizes)
 {
 	int ret = 0;
 
-	while (sizes[ret++] != -1);
+	while (sizes[ret++] != -1)
+		;
 
 	return ret - 1;
 }
@@ -134,11 +136,11 @@ void tst_buffers_alloc(struct tst_buffers bufs[])
 
 	for (i = 0; bufs[i].ptr; i++) {
 		if (bufs[i].size)
-			*((void**)bufs[i].ptr) = tst_alloc(bufs[i].size);
+			*((void **)bufs[i].ptr) = tst_alloc(bufs[i].size);
 		else if (bufs[i].iov_sizes)
-			*((void**)bufs[i].ptr) = tst_iovec_alloc(bufs[i].iov_sizes);
+			*((void **)bufs[i].ptr) = tst_iovec_alloc(bufs[i].iov_sizes);
 		else
-			*((void**)bufs[i].ptr) = tst_strdup(bufs[i].str);
+			*((void **)bufs[i].ptr) = tst_strdup(bufs[i].str);
 	}
 }
 
@@ -155,6 +157,7 @@ void tst_free_all(void)
 
 	while (i) {
 		struct map *j = i;
+
 		check_canary(i);
 		SAFE_MUNMAP(i->addr, i->size);
 		i = i->next;
diff --git a/lib/tst_cgroup.c b/lib/tst_cgroup.c
index a8a598e0e..6055015eb 100644
--- a/lib/tst_cgroup.c
+++ b/lib/tst_cgroup.c
@@ -71,6 +71,8 @@ struct cgroup_root {
 	/* CGroup for current test. Which may have children. */
 	struct cgroup_dir test_dir;
 
+	int nsdelegate:1;
+
 	int we_mounted_it:1;
 	/* cpuset is in compatability mode */
 	int no_cpuset_prefix:1;
@@ -344,6 +346,11 @@ static int cgroup_v1_mounted(void)
 	return !!roots[1].ver;
 }
 
+static int cgroup_v2_nsdelegate(void)
+{
+	return !!roots[0].nsdelegate;
+}
+
 static int cgroup_mounted(void)
 {
 	return cgroup_v2_mounted() || cgroup_v1_mounted();
@@ -361,6 +368,7 @@ static void cgroup_dir_mk(const struct cgroup_dir *const parent,
 			  struct cgroup_dir *const new)
 {
 	const char *dpath;
+	mode_t old_umask = umask(0);
 
 	new->dir_root = parent->dir_root;
 	new->dir_name = dir_name;
@@ -394,6 +402,7 @@ static void cgroup_dir_mk(const struct cgroup_dir *const parent,
 opendir:
 	new->dir_fd = SAFE_OPENAT(parent->dir_fd, dir_name,
 				  O_PATH | O_DIRECTORY);
+	umask(old_umask);
 }
 
 #define PATH_MAX_STRLEN 4095
@@ -566,6 +575,7 @@ static void cgroup_root_scan(const char *const mnt_type,
 	struct cgroup_ctrl *ctrl;
 	uint32_t ctrl_field = 0;
 	int no_prefix = 0;
+	int nsdelegate = 0;
 	char buf[BUFSIZ];
 	char *tok;
 	const int mnt_dfd = SAFE_OPEN(mnt_dir, O_PATH | O_DIRECTORY);
@@ -580,6 +590,9 @@ static void cgroup_root_scan(const char *const mnt_type,
 		if (const_ctrl)
 			add_ctrl(&ctrl_field, const_ctrl);
 	}
+	for (tok = strtok(mnt_opts, ","); tok; tok = strtok(NULL, ",")) {
+		nsdelegate |= !strcmp("nsdelegate", tok);
+	}
 
 	if (root->ver && ctrl_field == root->ctrl_field)
 		goto discard;
@@ -630,6 +643,7 @@ backref:
 	root->mnt_dir.dir_fd = mnt_dfd;
 	root->ctrl_field = ctrl_field;
 	root->no_cpuset_prefix = no_prefix;
+	root->nsdelegate = nsdelegate;
 
 	for_each_ctrl(ctrl) {
 		if (has_ctrl(root->ctrl_field, ctrl))
@@ -867,6 +881,10 @@ void tst_cg_require(const char *const ctrl_name,
 
 mkdirs:
 	root = ctrl->ctrl_root;
+
+	if (options->needs_nsdelegate && cgroup_v2_mounted() && !cgroup_v2_nsdelegate())
+		tst_brk(TCONF, "Requires cgroup2 to be mounted with nsdelegate");
+
 	add_ctrl(&root->mnt_dir.ctrl_field, ctrl);
 
 	if (cgroup_ctrl_on_v2(ctrl) && options->needs_ver == TST_CG_V1) {
diff --git a/lib/tst_fips.c b/lib/tst_fips.c
deleted file mode 100644
index 82dafef7a..000000000
--- a/lib/tst_fips.c
+++ /dev/null
@@ -1,24 +0,0 @@
-// SPDX-License-Identifier: GPL-2.0-or-later
-/*
- * Copyright (c) 2021 Petr Vorel <pvorel@suse.cz>
- */
-
-#define TST_NO_DEFAULT_MAIN
-
-#define PATH_FIPS	"/proc/sys/crypto/fips_enabled"
-
-#include "tst_test.h"
-#include "tst_safe_macros.h"
-#include "tst_fips.h"
-
-int tst_fips_enabled(void)
-{
-	int fips = 0;
-
-	if (access(PATH_FIPS, R_OK) == 0) {
-		SAFE_FILE_SCANF(PATH_FIPS, "%d", &fips);
-	}
-
-	tst_res(TINFO, "FIPS: %s", fips ? "on" : "off");
-	return fips;
-}
diff --git a/lib/tst_fs_has_free.c b/lib/tst_fs_has_free.c
index e82dfa837..080d693ab 100644
--- a/lib/tst_fs_has_free.c
+++ b/lib/tst_fs_has_free.c
@@ -27,7 +27,7 @@
 #include "tst_fs.h"
 
 int tst_fs_has_free_(void (*cleanup)(void), const char *path,
-		     unsigned int size, unsigned int mult)
+		     uint64_t size, unsigned int mult)
 {
 	struct statfs sf;
 
diff --git a/lib/tst_fs_setup.c b/lib/tst_fs_setup.c
index aaa8f3bc9..d3284a145 100644
--- a/lib/tst_fs_setup.c
+++ b/lib/tst_fs_setup.c
@@ -11,9 +11,10 @@
 #define TST_FS_SETUP_OVERLAYFS_MSG "overlayfs is not configured in this kernel"
 #define TST_FS_SETUP_OVERLAYFS_CONFIG "lowerdir="OVL_LOWER",upperdir="OVL_UPPER",workdir="OVL_WORK
 
-void create_overlay_dirs(void)
+void tst_create_overlay_dirs(void)
 {
 	DIR *dir = opendir(OVL_LOWER);
+
 	if (dir == NULL) {
 		SAFE_MKDIR(OVL_LOWER, 0755);
 		SAFE_MKDIR(OVL_UPPER, 0755);
@@ -24,11 +25,11 @@ void create_overlay_dirs(void)
 	closedir(dir);
 }
 
-int mount_overlay(const char *file, const int lineno, int strict)
+int tst_mount_overlay(const char *file, const int lineno, int strict)
 {
 	int ret;
 
-	create_overlay_dirs();
+	tst_create_overlay_dirs();
 	ret = mount("overlay", OVL_MNT, "overlay", 0,
 				TST_FS_SETUP_OVERLAYFS_CONFIG);
 	if (ret == 0)
diff --git a/lib/tst_fs_type.c b/lib/tst_fs_type.c
index 7f0d61a8e..e9efb89dc 100644
--- a/lib/tst_fs_type.c
+++ b/lib/tst_fs_type.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2005-2021 Linux Test Project
  *
diff --git a/lib/tst_kconfig.c b/lib/tst_kconfig.c
index 595ea4b09..e16ca1400 100644
--- a/lib/tst_kconfig.c
+++ b/lib/tst_kconfig.c
@@ -14,6 +14,7 @@
 #include "tst_private.h"
 #include "tst_kconfig.h"
 #include "tst_bool_expr.h"
+#include "tst_safe_stdio.h"
 
 static int kconfig_skip_check(void)
 {
@@ -565,3 +566,68 @@ char tst_kconfig_get(const char *confname)
 
 	return var.choice;
 }
+
+void tst_kcmdline_parse(struct tst_kcmdline_var params[], size_t params_len)
+{
+	char buf[128], line[512];
+	size_t b_pos = 0,l_pos =0, i;
+	int var_id = -1;
+
+	FILE *f = SAFE_FOPEN("/proc/cmdline", "r");
+
+	if (fgets(line, sizeof(line), f) == NULL) {
+		SAFE_FCLOSE(f);
+		tst_brk(TBROK, "Failed to read /proc/cmdline");
+	}
+
+	for (l_pos = 0; line[l_pos] != '\0'; l_pos++) {
+		char c = line[l_pos];
+
+		switch (c) {
+		case '=':
+			buf[b_pos] = '\0';
+			for (i = 0; i < params_len; i++) {
+				if (strcmp(buf, params[i].key) == 0) {
+					var_id = (int)i;
+					params[i].found = true;
+				}
+			}
+
+			b_pos = 0;
+		break;
+		case ' ':
+		case '\n':
+			buf[b_pos] = '\0';
+			if (var_id >= 0 && var_id < (int)params_len)
+				strcpy(params[var_id].value, buf);
+
+			var_id = -1;
+			b_pos = 0;
+		break;
+		default:
+			if (b_pos + 1 >= sizeof(buf)) {
+				tst_res(TWARN, "Buffer overflowed while parsing /proc/cmdline");
+				while (line[l_pos] != '\0' && line[l_pos] != ' ' && line[l_pos] != '\n')
+					l_pos++;
+
+				var_id = -1;
+				b_pos = 0;
+
+				if (line[l_pos] != '\0')
+					l_pos--;
+			} else {
+				buf[b_pos++] = c;
+			}
+		break;
+		}
+	}
+
+	for (i = 0; i < params_len; i++) {
+		if (params[i].found)
+			tst_res(TINFO, "%s is found in /proc/cmdline", params[i].key);
+		else
+			tst_res(TINFO, "%s is not found in /proc/cmdline", params[i].key);
+	}
+
+	SAFE_FCLOSE(f);
+}
diff --git a/lib/tst_kernel.c b/lib/tst_kernel.c
index 51e4daa09..8dabfeba2 100644
--- a/lib/tst_kernel.c
+++ b/lib/tst_kernel.c
@@ -1,6 +1,7 @@
 /*
  * Copyright (c) 2017 Cyril Hrubis <chrubis@suse.cz>
  * Copyright (c) 2020-2021 Petr Vorel <pvorel@suse.cz>
+ * Copyright (c) Linux Test Project, 2017-2024
  *
  * This program is free software: you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
@@ -18,11 +19,13 @@
 
 #include <sys/personality.h>
 #include <sys/utsname.h>
+#include <stdbool.h>
 #include <limits.h>
 
 #include "test.h"
 #include "tst_kernel.h"
 #include "old_safe_stdio.h"
+#include "lapi/abisize.h"
 
 static int get_kernel_bits_from_uname(struct utsname *buf)
 {
@@ -90,6 +93,19 @@ int tst_kernel_bits(void)
 	return kernel_bits;
 }
 
+int tst_is_compat_mode(void)
+{
+	return TST_ABI != tst_kernel_bits();
+}
+
+bool tst_abi_bits(int abi)
+{
+	if (abi != 32 && abi != 64)
+		tst_brkm(TBROK | TERRNO, NULL, "abi parameter can be only 32 or 64");
+
+	return abi == TST_ABI;
+}
+
 static int tst_search_driver_(const char *driver, const char *file)
 {
 	struct stat st;
diff --git a/lib/tst_process_state.c b/lib/tst_process_state.c
index 08a9d0966..033af2023 100644
--- a/lib/tst_process_state.c
+++ b/lib/tst_process_state.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (C) 2012-2014 Cyril Hrubis chrubis@suse.cz
  * Copyright (c) 2021 Xie Ziyao <xieziyao@huawei.com>
@@ -22,7 +22,7 @@ int tst_process_state_wait(const char *file, const int lineno,
 
 	for (;;) {
 		safe_file_scanf(file, lineno, cleanup_fn, proc_path,
-				"%*i %*s %c", &cur_state);
+				"%*[^)]%*c %c", &cur_state);
 
 		if (state == cur_state)
 			break;
@@ -54,7 +54,7 @@ int tst_process_state_wait2(pid_t pid, const char state)
 			return 1;
 		}
 
-		if (fscanf(f, "%*i %*s %c", &cur_state) != 1) {
+		if (fscanf(f, "%*[^)]%*c %c", &cur_state) != 1) {
 			fclose(f);
 			fprintf(stderr, "Failed to read '%s': %s\n",
 				proc_path, strerror(errno));
diff --git a/lib/tst_res.c b/lib/tst_res.c
index e87918ed1..7c66d2f6c 100644
--- a/lib/tst_res.c
+++ b/lib/tst_res.c
@@ -471,14 +471,6 @@ void tst_record_childstatus(void (*cleanup)(void), pid_t child)
 	}
 }
 
-pid_t tst_vfork(void)
-{
-	NO_NEWLIB_ASSERT("Unknown", 0);
-
-	tst_old_flush();
-	return vfork();
-}
-
 /*
  * Make tst_brk reentrant so that one can call the SAFE_* macros from within
  * user-defined cleanup functions.
diff --git a/lib/tst_safe_macros.c b/lib/tst_safe_macros.c
index a178a13e7..39b8cc924 100644
--- a/lib/tst_safe_macros.c
+++ b/lib/tst_safe_macros.c
@@ -1,6 +1,7 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2017 Cyril Hrubis <chrubis@suse.cz>
+ * Copyright (c) 2017-2024 Linux Test Project
  */
 
 #define _GNU_SOURCE
@@ -225,8 +226,8 @@ int safe_setresuid(const char *file, const int lineno,
 }
 
 int safe_sigaction(const char *file, const int lineno,
-                   int signum, const struct sigaction *act,
-                   struct sigaction *oldact)
+				   int signum, const struct sigaction *act,
+				   struct sigaction *oldact)
 {
 	int rval;
 
@@ -246,7 +247,7 @@ int safe_sigaction(const char *file, const int lineno,
 }
 
 int safe_sigaddset(const char *file, const int lineno,
-                    sigset_t *sigs, int signo)
+				   sigset_t *sigs, int signo)
 {
 	int rval;
 
@@ -265,8 +266,7 @@ int safe_sigaddset(const char *file, const int lineno,
 	return rval;
 }
 
-int safe_sigdelset(const char *file, const int lineno,
-                    sigset_t *sigs, int signo)
+int safe_sigdelset(const char *file, const int lineno, sigset_t *sigs, int signo)
 {
 	int rval;
 
@@ -285,8 +285,7 @@ int safe_sigdelset(const char *file, const int lineno,
 	return rval;
 }
 
-int safe_sigemptyset(const char *file, const int lineno,
-                      sigset_t *sigs)
+int safe_sigemptyset(const char *file, const int lineno, sigset_t *sigs)
 {
 	int rval;
 
@@ -334,7 +333,7 @@ static const char *strhow(int how)
 }
 
 int safe_sigprocmask(const char *file, const int lineno,
-                      int how, sigset_t *set, sigset_t *oldset)
+					 int how, sigset_t *set, sigset_t *oldset)
 {
 	int rval;
 
@@ -353,8 +352,7 @@ int safe_sigprocmask(const char *file, const int lineno,
 	return rval;
 }
 
-int safe_sigwait(const char *file, const int lineno,
-                  sigset_t *set, int *sig)
+int safe_sigwait(const char *file, const int lineno, sigset_t *set, int *sig)
 {
 	int rval;
 
@@ -548,6 +546,20 @@ int safe_dup2(const char *file, const int lineno, int oldfd, int newfd)
 	return rval;
 }
 
+void *safe_calloc(const char *file, const int lineno, size_t nmemb, size_t size)
+{
+	void *rval;
+
+	rval = calloc(nmemb, size);
+
+	if (rval == NULL) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"calloc(%zu, %zu) failed", nmemb, size);
+	}
+
+	return rval;
+}
+
 void *safe_realloc(const char *file, const int lineno, void *ptr, size_t size)
 {
 	void *ret;
@@ -625,3 +637,76 @@ void safe_print_file(const char *file, const int lineno, char *path)
 
 	safe_fclose(file, lineno, NULL, pfile);
 }
+
+int safe_sscanf(const char *file, const int lineno, const char *restrict buffer, const char *restrict format, ...)
+{
+	va_list args;
+
+	va_start(args, format);
+	int ret = vsscanf(buffer, format, args);
+
+	va_end(args);
+	int placeholders = tst_count_scanf_conversions(format);
+
+	if (ret == EOF)
+		tst_brk_(file, lineno, TBROK | TERRNO, "got EOF from sscanf()");
+
+	if (ret != placeholders)
+		tst_brk_(file, lineno, TBROK | TERRNO, "wrong number of conversion, expected %d, got %d", placeholders, ret);
+
+	return ret;
+}
+
+#define PROT_FLAG_STR(f) #f " | "
+void tst_prot_to_str(const int prot, char *buf)
+{
+	char *ptr = buf;
+
+	if (prot == PROT_NONE) {
+		strcpy(buf, "PROT_NONE");
+		return;
+	}
+
+	if (prot & PROT_READ) {
+		strcpy(ptr, PROT_FLAG_STR(PROT_READ));
+		ptr += sizeof(PROT_FLAG_STR(PROT_READ)) - 1;
+	}
+
+	if (prot & PROT_WRITE) {
+		strcpy(ptr, PROT_FLAG_STR(PROT_WRITE));
+		ptr += sizeof(PROT_FLAG_STR(PROT_WRITE)) - 1;
+	}
+
+	if (prot & PROT_EXEC) {
+		strcpy(ptr, PROT_FLAG_STR(PROT_EXEC));
+		ptr += sizeof(PROT_FLAG_STR(PROT_EXEC)) - 1;
+	}
+
+	if (buf != ptr)
+		ptr[-3] = 0;
+}
+
+int safe_mprotect(const char *file, const int lineno,
+	char *addr, size_t len, int prot)
+{
+	int rval;
+	char prot_buf[512];
+
+	tst_prot_to_str(prot, prot_buf);
+
+	tst_res_(file, lineno, TDEBUG,
+		"mprotect(%p, %ld, %s(%x))", addr, len, prot_buf, prot);
+
+	rval = mprotect(addr, len, prot);
+
+	if (rval == -1) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"mprotect(%p, %ld, %s(%x))", addr, len, prot_buf, prot);
+	} else if (rval) {
+		tst_brk_(file, lineno, TBROK | TERRNO,
+			"mprotect(%p, %ld, %s(%x)) return value %d",
+			addr, len, prot_buf, prot, rval);
+	}
+
+	return rval;
+}
diff --git a/lib/tst_lockdown.c b/lib/tst_security.c
similarity index 77%
rename from lib/tst_lockdown.c
rename to lib/tst_security.c
index 38d830886..7d929fafe 100644
--- a/lib/tst_lockdown.c
+++ b/lib/tst_security.c
@@ -1,9 +1,23 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) Linux Test Project, 2020-2024
+ */
 
 #define TST_NO_DEFAULT_MAIN
 
+#define PATH_FIPS	"/proc/sys/crypto/fips_enabled"
 #define PATH_LOCKDOWN	"/sys/kernel/security/lockdown"
+#define SELINUX_STATUS_PATH "/sys/fs/selinux/enforce"
 
+#if defined(__powerpc64__) || defined(__ppc64__)
+# define SECUREBOOT_VAR "/proc/device-tree/ibm,secure-boot"
+# define VAR_DATA_SIZE 4
+#else
+# define SECUREBOOT_VAR "/sys/firmware/efi/efivars/SecureBoot-8be4df61-93ca-11d2-aa0d-00e098032b8c"
+# define VAR_DATA_SIZE 5
+#endif
+
+#include <fcntl.h>
 #include <stdio.h>
 #include <stdlib.h>
 #include <sys/mount.h>
@@ -11,41 +25,19 @@
 #include "tst_test.h"
 #include "tst_safe_macros.h"
 #include "tst_safe_stdio.h"
-#include "tst_lockdown.h"
+#include "tst_security.h"
 #include "tst_private.h"
 
-#if defined(__powerpc64__) || defined(__ppc64__)
-# define SECUREBOOT_VAR "/proc/device-tree/ibm,secure-boot"
-# define VAR_DATA_SIZE 4
-#else
-# define SECUREBOOT_VAR "/sys/firmware/efi/efivars/SecureBoot-8be4df61-93ca-11d2-aa0d-00e098032b8c"
-# define VAR_DATA_SIZE 5
-#endif
-
-int tst_secureboot_enabled(void)
+int tst_fips_enabled(void)
 {
-	int fd;
-	char data[5];
+	int fips = 0;
 
-	if (access(SECUREBOOT_VAR, F_OK)) {
-		tst_res(TINFO, "SecureBoot sysfs file not available");
-		return -1;
-	}
+	if (access(PATH_FIPS, R_OK) == 0)
+		SAFE_FILE_SCANF(PATH_FIPS, "%d", &fips);
 
-	fd = open(SECUREBOOT_VAR, O_RDONLY);
+	tst_res(TINFO, "FIPS: %s", fips ? "on" : "off");
 
-	if (fd == -1) {
-		tst_res(TINFO | TERRNO,
-			"Cannot open SecureBoot file");
-		return -1;
-	} else if (fd < 0) {
-		tst_brk(TBROK | TERRNO, "Invalid open() return value %d", fd);
-		return -1;
-	}
-	SAFE_READ(1, fd, data, VAR_DATA_SIZE);
-	SAFE_CLOSE(fd);
-	tst_res(TINFO, "SecureBoot: %s", data[VAR_DATA_SIZE - 1] ? "on" : "off");
-	return data[VAR_DATA_SIZE - 1];
+	return fips;
 }
 
 int tst_lockdown_enabled(void)
@@ -83,3 +75,41 @@ int tst_lockdown_enabled(void)
 
 	return ret;
 }
+
+int tst_secureboot_enabled(void)
+{
+	int fd;
+	char data[5];
+
+	if (access(SECUREBOOT_VAR, F_OK)) {
+		tst_res(TINFO, "SecureBoot sysfs file not available");
+		return -1;
+	}
+
+	fd = open(SECUREBOOT_VAR, O_RDONLY);
+
+	if (fd == -1) {
+		tst_res(TINFO | TERRNO,
+			"Cannot open SecureBoot file");
+		return -1;
+	} else if (fd < 0) {
+		tst_brk(TBROK | TERRNO, "Invalid open() return value %d", fd);
+		return -1;
+	}
+	SAFE_READ(1, fd, data, VAR_DATA_SIZE);
+	SAFE_CLOSE(fd);
+	tst_res(TINFO, "SecureBoot: %s", data[VAR_DATA_SIZE - 1] ? "on" : "off");
+	return data[VAR_DATA_SIZE - 1];
+}
+
+int tst_selinux_enforcing(void)
+{
+	int res = 0;
+
+	if (access(SELINUX_STATUS_PATH, F_OK) == 0)
+		SAFE_FILE_SCANF(SELINUX_STATUS_PATH, "%d", &res);
+
+	tst_res(TINFO, "SELinux enforcing: %s", res ? "on" : "off");
+
+	return res;
+}
diff --git a/lib/tst_test.c b/lib/tst_test.c
index bcf2c4555..0594cbaae 100644
--- a/lib/tst_test.c
+++ b/lib/tst_test.c
@@ -1,7 +1,7 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2015-2016 Cyril Hrubis <chrubis@suse.cz>
- * Copyright (c) Linux Test Project, 2016-2021
+ * Copyright (c) Linux Test Project, 2016-2024
  */
 
 #include <limits.h>
@@ -520,7 +520,6 @@ static struct option {
 	{"I:", "-I x     Execute test for n seconds"},
 	{"D",  "-D       Prints debug information"},
 	{"V",  "-V       Prints LTP version"},
-	{"C:", "-C ARG   Run child process with ARG arguments (used internally)"},
 };
 
 static void print_help(void)
@@ -660,11 +659,6 @@ static void parse_topt(unsigned int topts_len, int opt, char *optarg)
 	*(toptions[i].arg) = optarg ? optarg : "";
 }
 
-/* see self_exec.c */
-#ifdef UCLINUX
-extern char *child_args;
-#endif
-
 static void parse_opts(int argc, char *argv[])
 {
 	unsigned int i, topts_len = count_options();
@@ -708,11 +702,6 @@ static void parse_opts(int argc, char *argv[])
 			fprintf(stderr, "LTP version: " LTP_VERSION "\n");
 			exit(0);
 		break;
-		case 'C':
-#ifdef UCLINUX
-			child_args = optarg;
-#endif
-		break;
 		default:
 			parse_topt(topts_len, opt, optarg);
 		}
@@ -1138,6 +1127,7 @@ static void do_cgroup_requires(void)
 {
 	const struct tst_cg_opts cg_opts = {
 		.needs_ver = tst_test->needs_cgroup_ver,
+		.needs_nsdelegate = tst_test->needs_cgroup_nsdelegate,
 	};
 	const char *const *ctrl_names = tst_test->needs_cgroup_ctrls;
 
@@ -1147,6 +1137,29 @@ static void do_cgroup_requires(void)
 	tst_cg_init();
 }
 
+#define tst_set_ulimit(conf) \
+	set_ulimit_(__FILE__, __LINE__, (conf))
+
+/*
+ * Set resource limits.
+ */
+static void set_ulimit_(const char *file, const int lineno, const struct tst_ulimit_val *conf)
+{
+	struct rlimit rlim;
+
+	safe_getrlimit(file, lineno, conf->resource, &rlim);
+
+	rlim.rlim_cur = conf->rlim_cur;
+
+	if (conf->rlim_cur > rlim.rlim_max)
+		rlim.rlim_max = conf->rlim_cur;
+
+	tst_res_(file, lineno, TINFO, "Set ulimit resource: %d rlim_cur: %lu rlim_max: %lu",
+		conf->resource, rlim.rlim_cur, rlim.rlim_max);
+
+	safe_setrlimit(file, lineno, conf->resource, &rlim);
+}
+
 static void do_setup(int argc, char *argv[])
 {
 	char *tdebug_env = getenv("LTP_ENABLE_DEBUG");
@@ -1194,9 +1207,12 @@ static void do_setup(int argc, char *argv[])
 	if (tst_test->skip_in_secureboot && tst_secureboot_enabled() > 0)
 		tst_brk(TCONF, "SecureBoot enabled, skipping test");
 
-	if (tst_test->skip_in_compat && TST_ABI != tst_kernel_bits())
+	if (tst_test->skip_in_compat && tst_is_compat_mode())
 		tst_brk(TCONF, "Not supported in 32-bit compat mode");
 
+	if (tst_test->needs_abi_bits && !tst_abi_bits(tst_test->needs_abi_bits))
+		tst_brk(TCONF, "%dbit ABI is not supported", tst_test->needs_abi_bits);
+
 	if (tst_test->needs_cmds) {
 		const char *cmd;
 		int i;
@@ -1252,6 +1268,15 @@ static void do_setup(int argc, char *argv[])
 		}
 	}
 
+	if (tst_test->ulimit) {
+		const struct tst_ulimit_val *pvl = tst_test->ulimit;
+
+		while (pvl->resource) {
+			tst_set_ulimit(pvl);
+			pvl++;
+		}
+	}
+
 	if (tst_test->mntpoint)
 		SAFE_MKDIR(tst_test->mntpoint, 0777);
 
diff --git a/lib/tst_thread_state.c b/lib/tst_thread_state.c
index 6562dfaf0..4d04136ce 100644
--- a/lib/tst_thread_state.c
+++ b/lib/tst_thread_state.c
@@ -20,7 +20,7 @@ int tst_thread_state_wait(pid_t tid, const char state,
 	snprintf(proc_path, sizeof(proc_path), "/proc/self/task/%i/stat", tid);
 
 	for (;;) {
-		SAFE_FILE_SCANF(proc_path, "%*i %*s %c", &cur_state);
+		SAFE_FILE_SCANF(proc_path, "%*[^)]%*c %c", &cur_state);
 
 		if (state == cur_state)
 			break;
diff --git a/lib/tst_timer.c b/lib/tst_timer.c
index 62d8f9080..ecf165ca4 100644
--- a/lib/tst_timer.c
+++ b/lib/tst_timer.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (C) 2015 Cyril Hrubis <chrubis@suse.cz>
  */
diff --git a/libs/libltpswap/libswap.c b/libs/libltpswap/libswap.c
index 13610709e..ee964c7e1 100644
--- a/libs/libltpswap/libswap.c
+++ b/libs/libltpswap/libswap.c
@@ -1,68 +1,318 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2013 Oracle and/or its affiliates. All Rights Reserved.
+ * Copyright (c) Linux Test Project, 2014-2024
  * Author: Stanislav Kholmanskikh <stanislav.kholmanskikh@oracle.com>
  */
 
+#include <sys/statvfs.h>
+#include <linux/fs.h>
 #include <errno.h>
+#include <linux/fiemap.h>
+#include <stdlib.h>
+#include <stdbool.h>
 
 #define TST_NO_DEFAULT_MAIN
+#define DEFAULT_MAX_SWAPFILE 32
+#define BUFSIZE 200
 
 #include "tst_test.h"
 #include "libswap.h"
 #include "lapi/syscalls.h"
+#include "tst_kconfig.h"
+#include "tst_kvercmp.h"
+#include "tst_safe_stdio.h"
 
-/*
- * Make a swap file
- */
-int make_swapfile(const char *swapfile, int safe)
+static const char *const swap_supported_fs[] = {
+	"btrfs",
+	"ext2",
+	"ext3",
+	"ext4",
+	"xfs",
+	"vfat",
+	"exfat",
+	"ntfs",
+	NULL
+};
+
+static void set_nocow_attr(const char *filename)
+{
+	int fd;
+	int attrs;
+
+	tst_res(TINFO, "FS_NOCOW_FL attribute set on %s", filename);
+
+	fd = SAFE_OPEN(filename, O_RDONLY);
+
+	SAFE_IOCTL(fd, FS_IOC_GETFLAGS, &attrs);
+
+	attrs |= FS_NOCOW_FL;
+
+	SAFE_IOCTL(fd, FS_IOC_SETFLAGS, &attrs);
+
+	SAFE_CLOSE(fd);
+}
+
+static int prealloc_contiguous_file(const char *path, size_t bs, size_t bcount)
+{
+	int fd;
+
+	fd = open(path, O_CREAT|O_WRONLY|O_TRUNC, 0600);
+	if (fd < 0)
+		return -1;
+
+	/* Btrfs file need set 'nocow' attribute */
+	if (tst_fs_type(path) == TST_BTRFS_MAGIC)
+		set_nocow_attr(path);
+
+	if (tst_prealloc_size_fd(fd, bs, bcount)) {
+		close(fd);
+		unlink(path);
+		return -1;
+	}
+
+	if (close(fd) < 0) {
+		unlink(path);
+		return -1;
+	}
+
+	return 0;
+}
+
+static int file_is_contiguous(const char *filename)
+{
+	int fd, contiguous = 0;
+	struct fiemap *fiemap;
+
+	if (tst_fibmap(filename) == 0) {
+		contiguous = 1;
+		goto out;
+	}
+
+	if (tst_fs_type(filename) == TST_TMPFS_MAGIC)
+		goto out;
+
+	fd = SAFE_OPEN(filename, O_RDONLY);
+
+	fiemap = (struct fiemap *)SAFE_MALLOC(sizeof(struct fiemap)
+					      + sizeof(struct fiemap_extent));
+
+	memset(fiemap, 0, sizeof(struct fiemap) + sizeof(struct fiemap_extent));
+
+	fiemap->fm_start = 0;
+	fiemap->fm_length = ~0;
+	fiemap->fm_flags = 0;
+	fiemap->fm_extent_count = 1;
+
+	SAFE_IOCTL(fd, FS_IOC_FIEMAP, fiemap);
+
+	/*
+	 * fiemap->fm_mapped_extents != 1:
+	 *   This checks if the file does not have exactly one extent. If there are more
+	 *   or zero extents, the file is not stored in a single contiguous block.
+	 *
+	 * fiemap->fm_extents[0].fe_logical != 0:
+	 *   This checks if the first extent does not start at the logical offset 0 of
+	 *   the file. If it doesn't, it indicates that the file's first block of data
+	 *   is not at the beginning of the file, which implies non-contiguity.
+	 *
+	 * (fiemap->fm_extents[0].fe_flags & FIEMAP_EXTENT_LAST) != FIEMAP_EXTENT_LAST:
+	 *   This checks if the first extent does not have the FIEMAP_EXTENT_LAST flag set.
+	 *   If the flag isn't set, it means that this extent is not the last one, suggesting
+	 *   that there are more extents and the file is not contiguous.
+	 */
+	if (fiemap->fm_mapped_extents != 1 ||
+		fiemap->fm_extents[0].fe_logical != 0 ||
+		(fiemap->fm_extents[0].fe_flags & FIEMAP_EXTENT_LAST) != FIEMAP_EXTENT_LAST) {
+
+		tst_res(TINFO, "File '%s' is not contiguous", filename);
+		contiguous = 0;
+	}
+
+	SAFE_CLOSE(fd);
+	free(fiemap);
+
+out:
+	return contiguous;
+}
+
+int make_swapfile(const char *file, const int lineno,
+			const char *swapfile, unsigned int num,
+			int safe, enum swapfile_method method)
 {
-	if (!tst_fs_has_free(".", sysconf(_SC_PAGESIZE) * 10, TST_BYTES))
-		tst_brk(TBROK, "Insufficient disk space to create swap file");
+	struct statvfs fs_info;
+	unsigned long blk_size;
+	unsigned int blocks = 0;
+	size_t pg_size = sysconf(_SC_PAGESIZE);
+	char mnt_path[PATH_MAX];
+
+	if (statvfs(".", &fs_info) == -1)
+		tst_brk_(file, lineno, TBROK, "statvfs failed");
+
+	blk_size = fs_info.f_bsize;
+
+	if (method == SWAPFILE_BY_SIZE) {
+		tst_res_(file, lineno, TINFO, "create a swapfile size of %u megabytes (MB)", num);
+		blocks = num * 1024 * 1024 / blk_size;
+	} else if (method == SWAPFILE_BY_BLKS) {
+		blocks = num;
+		tst_res_(file, lineno, TINFO, "create a swapfile with %u block numbers", blocks);
+	} else {
+		tst_brk_(file, lineno, TBROK, "Invalid method, please see include/libswap.h");
+	}
+
+	/* To guarantee at least one page can be swapped out */
+	if (blk_size * blocks < pg_size) {
+		tst_res_(file, lineno, TWARN, "Swapfile size is less than the system page size. "
+			"Using page size (%lu bytes) instead of block size (%lu bytes).",
+			(unsigned long)pg_size, blk_size);
+		blk_size = pg_size;
+	}
+
+	if (sscanf(swapfile, "%[^/]", mnt_path) != 1)
+		tst_brk_(file, lineno, TBROK, "sscanf failed");
+
+	if (!tst_fs_has_free(mnt_path, blk_size * blocks, TST_BYTES))
+		tst_brk_(file, lineno, TCONF, "Insufficient disk space to create swap file");
 
 	/* create file */
-	if (tst_fill_file(swapfile, 0, sysconf(_SC_PAGESIZE), 10) != 0)
-		tst_brk(TBROK, "Failed to create swapfile");
+	if (prealloc_contiguous_file(swapfile, blk_size, blocks) != 0)
+		tst_brk_(file, lineno, TBROK, "Failed to create swapfile");
+
+	/* Fill the file if needed (specific to old xfs filesystems) */
+	if (tst_fs_type(swapfile) == TST_XFS_MAGIC) {
+		if (tst_fill_file(swapfile, 0, blk_size, blocks) != 0)
+			tst_brk_(file, lineno, TBROK, "Failed to fill swapfile");
+	}
 
 	/* make the file swapfile */
-	const char *argv[2 + 1];
-	argv[0] = "mkswap";
-	argv[1] = swapfile;
-	argv[2] = NULL;
+	const char *const argv[] = {"mkswap", swapfile, NULL};
 
 	return tst_cmd(argv, "/dev/null", "/dev/null", safe ?
-				   TST_CMD_PASS_RETVAL | TST_CMD_TCONF_ON_MISSING : 0);
+			TST_CMD_PASS_RETVAL | TST_CMD_TCONF_ON_MISSING : 0);
 }
 
-/*
- * Check swapon/swapoff support status of filesystems or files
- * we are testing on.
- */
-void is_swap_supported(const char *filename)
+bool is_swap_supported(const char *filename)
 {
-	int fibmap = tst_fibmap(filename);
+	int i, sw_support = 0;
+	int ret = SAFE_MAKE_SMALL_SWAPFILE(filename);
+	int fi_contiguous = file_is_contiguous(filename);
 	long fs_type = tst_fs_type(filename);
 	const char *fstype = tst_fs_type_name(fs_type);
 
-	int ret = make_swapfile(filename, 1);
+	if (fs_type == TST_BTRFS_MAGIC &&
+			tst_kvercmp(5, 0, 0) < 0)
+		tst_brk(TCONF, "Swapfile on Btrfs (kernel < 5.0) not implemented");
+
+	for (i = 0; swap_supported_fs[i]; i++) {
+		if (strstr(fstype, swap_supported_fs[i])) {
+			sw_support = 1;
+			break;
+		}
+	}
+
 	if (ret != 0) {
-		if (fibmap == 1)
+		if (fi_contiguous == 0 && sw_support == 0) {
 			tst_brk(TCONF, "mkswap on %s not supported", fstype);
-		else
-			tst_brk(TFAIL, "mkswap on %s failed", fstype);
+		} else {
+			tst_res(TFAIL, "mkswap on %s failed", fstype);
+			return false;
+		}
 	}
 
 	TEST(tst_syscall(__NR_swapon, filename, 0));
 	if (TST_RET == -1) {
-		if (errno == EPERM)
+		if (errno == EPERM) {
 			tst_brk(TCONF, "Permission denied for swapon()");
-		else if (fibmap == 1 && errno == EINVAL)
+		} else if (errno == EINVAL && fi_contiguous == 0 && sw_support == 0) {
 			tst_brk(TCONF, "Swapfile on %s not implemented", fstype);
-		else
-			tst_brk(TFAIL | TTERRNO, "swapon() on %s failed", fstype);
+		} else {
+			tst_res(TFAIL | TTERRNO, "swapon() on %s failed", fstype);
+			return false;
+		}
 	}
 
 	TEST(tst_syscall(__NR_swapoff, filename, 0));
-	if (TST_RET == -1)
-		tst_brk(TFAIL | TTERRNO, "swapoff on %s failed", fstype);
+	if (TST_RET == -1) {
+		tst_res(TFAIL | TTERRNO, "swapoff on %s failed", fstype);
+		return false;
+	}
+
+	return true;
+}
+
+int tst_max_swapfiles(void)
+{
+	unsigned int swp_migration_num = 0, swp_hwpoison_num = 0,
+		     swp_device_num = 0, swp_pte_marker_num = 0,
+		     swp_swapin_error_num = 0;
+	struct tst_kconfig_var migration = TST_KCONFIG_INIT("CONFIG_MIGRATION");
+	struct tst_kconfig_var memory = TST_KCONFIG_INIT("CONFIG_MEMORY_FAILURE");
+	struct tst_kconfig_var device = TST_KCONFIG_INIT("CONFIG_DEVICE_PRIVATE");
+	struct tst_kconfig_var marker = TST_KCONFIG_INIT("CONFIG_PTE_MARKER");
+	struct tst_kern_exv kvers_marker_migration[] = {
+		/* RHEL9 kernel has patch 6c287605f and 679d10331 since 5.14.0-179 */
+		{ "RHEL9", "5.14.0-179" },
+		{ NULL, NULL},
+	};
+
+	struct tst_kern_exv kvers_device[] = {
+		/* SLES12-SP4 has patch 5042db43cc26 since 4.12.14-5.5 */
+		{ "SLES", "4.12.14-5.5" },
+		{ NULL, NULL},
+	};
+
+	tst_kconfig_read(&migration, 1);
+	tst_kconfig_read(&memory, 1);
+	tst_kconfig_read(&device, 1);
+	tst_kconfig_read(&marker, 1);
+
+	if (migration.choice == 'y') {
+		if (tst_kvercmp2(5, 19, 0, kvers_marker_migration) < 0)
+			swp_migration_num = 2;
+		else
+			swp_migration_num = 3;
+	}
+
+	if (memory.choice == 'y')
+		swp_hwpoison_num = 1;
+
+	if (device.choice == 'y') {
+		if (tst_kvercmp2(4, 14, 0, kvers_device) >= 0)
+			swp_device_num = 2;
+		if (tst_kvercmp(5, 14, 0) >= 0)
+			swp_device_num = 4;
+	}
+
+	if ((marker.choice == 'y' &&
+	     tst_kvercmp2(5, 19, 0, kvers_marker_migration) >= 0)
+	    || tst_kvercmp(6, 2, 0) >= 0) {
+		swp_pte_marker_num = 1;
+	}
+
+	if ((tst_kvercmp(5, 19, 0) >= 0) && (tst_kvercmp(6, 2, 0) < 0))
+		swp_swapin_error_num = 1;
+
+	return DEFAULT_MAX_SWAPFILE - swp_migration_num - swp_hwpoison_num
+		- swp_device_num - swp_pte_marker_num - swp_swapin_error_num;
+}
+
+int tst_count_swaps(void)
+{
+	FILE *fp;
+	int used = -1;
+	char buf[BUFSIZE];
+
+	fp = SAFE_FOPEN("/proc/swaps", "r");
+	if (fp == NULL)
+		return -1;
+
+	while (fgets(buf, BUFSIZE, fp) != NULL)
+		used++;
+
+	SAFE_FCLOSE(fp);
+	if (used < 0)
+		tst_brk(TBROK, "can't read /proc/swaps to get used swapfiles resource total");
+
+	return used;
 }
diff --git a/m4/ltp-nommu-linux.m4 b/m4/ltp-nommu-linux.m4
deleted file mode 100644
index 7471ddd06..000000000
--- a/m4/ltp-nommu-linux.m4
+++ /dev/null
@@ -1,14 +0,0 @@
-dnl SPDX-License-Identifier: GPL-2.0-or-later
-dnl Copyright (c) Linux Test Project, 2010
-dnl Author: Mike Frysinger <vapier@gentoo.org>
-
-AC_DEFUN([LTP_CHECK_NOMMU_LINUX],
-[
-	AC_CHECK_FUNCS([fork daemon vfork])
-	UCLINUX=0
-	if test "x$ac_cv_func_fork" = "xno" ; then
-		UCLINUX=1
-		AC_DEFINE([UCLINUX], 1, [Target is running Linux w/out an MMU])
-	fi
-	AC_SUBST(UCLINUX)
-])
diff --git a/runtest/Makefile b/runtest/Makefile
index 6a1565b6a..0f95e69fa 100644
--- a/runtest/Makefile
+++ b/runtest/Makefile
@@ -32,10 +32,6 @@ UNWANTED_FILES		:= Makefile CVS STAX
 
 INSTALL_MODE		:= 00644
 
-ifneq ($(WITH_POWER_MANAGEMENT_TESTSUITE),yes)
-UNWANTED_FILES		+= power_management_tests
-endif
-
 INSTALL_TARGETS		:= $(filter-out $(UNWANTED_FILES),$(notdir $(patsubst $(abs_srcdir)/%,%,$(sort $(wildcard $(abs_srcdir)/*)))))
 
 MAKE_TARGETS		:=
diff --git a/runtest/cap_bounds b/runtest/cap_bounds
deleted file mode 100644
index 518d1e3ab..000000000
--- a/runtest/cap_bounds
+++ /dev/null
@@ -1,2 +0,0 @@
-#DESCRIPTION:Posix capability bounding set
-Cap_bounds	run_capbounds.sh
diff --git a/runtest/securebits b/runtest/capability
similarity index 53%
rename from runtest/securebits
rename to runtest/capability
index 64e6e0a0d..c7af1235e 100644
--- a/runtest/securebits
+++ b/runtest/capability
@@ -1,4 +1,7 @@
-#DESCRIPTION:securebits tests
+# various capability related tests
+cap_bounds run_capbounds.sh
+filecaps filecapstest.sh
+
 check_keepcaps01 check_keepcaps 1
 check_keepcaps02 check_keepcaps 2
 check_keepcaps03 check_keepcaps 3
diff --git a/runtest/filecaps b/runtest/filecaps
deleted file mode 100644
index 1872c0bc5..000000000
--- a/runtest/filecaps
+++ /dev/null
@@ -1,2 +0,0 @@
-#DESCRIPTION:file capabilities
-Filecaps	filecapstest.sh
diff --git a/runtest/io b/runtest/io
deleted file mode 100644
index cd51cce3c..000000000
--- a/runtest/io
+++ /dev/null
@@ -1,3 +0,0 @@
-#AIO01 & AIO02 tests to be run
-aio01 aio01
-aio02 aio02
diff --git a/runtest/kernel_misc b/runtest/kernel_misc
index 02b0ddd1a..78f00d305 100644
--- a/runtest/kernel_misc
+++ b/runtest/kernel_misc
@@ -15,3 +15,4 @@ zram01 zram01.sh
 zram02 zram02.sh
 zram03 zram03
 umip_basic_test umip_basic_test
+aslr01 aslr01
diff --git a/runtest/kvm b/runtest/kvm
index 4094a21a8..74a517add 100644
--- a/runtest/kvm
+++ b/runtest/kvm
@@ -1,4 +1,6 @@
-kvm_pagefault01 kvm_pagefault01
 kvm_svm01 kvm_svm01
 kvm_svm02 kvm_svm02
 kvm_svm03 kvm_svm03
+kvm_svm04 kvm_svm04
+# Tests below may interfere with bug reproducibility
+kvm_pagefault01 kvm_pagefault01
diff --git a/runtest/ltp-aiodio.part4 b/runtest/ltp-aiodio.part4
index c31bef934..de00b8a78 100644
--- a/runtest/ltp-aiodio.part4
+++ b/runtest/ltp-aiodio.part4
@@ -1,6 +1,6 @@
-# 3/2006
-# Malcles Jacky: this file is a copy from Ridgeway Marty's aio script
-#     goal: all aio tests using the same framework
+aio01 aio01
+aio02 aio02
+
 #Running dio_sparse & dirty tests
 DI000 dirty
 DS000 dio_sparse
diff --git a/runtest/mm b/runtest/mm
index d859b331c..d8e62af81 100644
--- a/runtest/mm
+++ b/runtest/mm
@@ -47,7 +47,7 @@ mmapstress03 mmapstress03
 mmapstress04 mmapstress04
 mmapstress05 mmapstress05
 mmapstress06 mmapstress06 20
-mmapstress07 TMPFILE=`mktemp /tmp/example.XXXXXXXXXXXX`; mmapstress07 $TMPFILE
+mmapstress07 TMPFILE=`mktemp $TMPDIR/example.XXXXXXXXXXXX`; mmapstress07 $TMPFILE
 mmapstress08 mmapstress08
 mmapstress09 mmapstress09 -p 20 -t 0.2
 mmapstress10 mmapstress10 -p 20 -t 0.2
@@ -58,6 +58,8 @@ mmap10_2 mmap10 -s
 mmap10_3 mmap10 -a -s
 mmap10_4 mmap10 -a -s -i 60
 
+kallsyms kallsyms
+
 ksm01 ksm01
 ksm01_1 ksm01 -u 128
 ksm02 ksm02
diff --git a/runtest/net.nfs b/runtest/net.nfs
index 15a960017..929868a7b 100644
--- a/runtest/net.nfs
+++ b/runtest/net.nfs
@@ -2,107 +2,127 @@
 #
 # PLEASE READ THE README FILE network/README.md BEFORE RUNNING THESE.
 #
-nfs3_01 nfs01.sh -v 3 -t udp
-nfs3t_01 nfs01.sh -v 3 -t tcp
-nfs4_01 nfs01.sh -v 4 -t tcp
-nfs41_01 nfs01.sh -v 4.1 -t tcp
-nfs42_01 nfs01.sh -v 4.2 -t tcp
-nfs3_ipv6_01 nfs01.sh -6 -v 3 -t udp
-nfs3t_ipv6_01 nfs01.sh -6 -v 3 -t tcp
-nfs4_ipv6_01 nfs01.sh -6 -v 4 -t tcp
-nfs41_ipv6_01 nfs01.sh -6 -v 4.1 -t tcp
-nfs42_ipv6_01 nfs01.sh -6 -v 4.2 -t tcp
+nfs01_v30_ip4u nfs01.sh -v 3 -t udp
+nfs01_v30_ip4t nfs01.sh -v 3 -t tcp
+nfs01_v40_ip4t nfs01.sh -v 4 -t tcp
+nfs01_v41_ip4t nfs01.sh -v 4.1 -t tcp
+nfs01_v42_ip4t nfs01.sh -v 4.2 -t tcp
+nfs01_v30_ip6u nfs01.sh -6 -v 3 -t udp
+nfs01_v30_ip6t nfs01.sh -6 -v 3 -t tcp
+nfs01_v40_ip6t nfs01.sh -6 -v 4 -t tcp
+nfs01_v41_ip6t nfs01.sh -6 -v 4.1 -t tcp
+nfs01_v42_ip6t nfs01.sh -6 -v 4.2 -t tcp
 
-nfs3_02 nfs02.sh -v 3 -t udp
-nfs3t_02 nfs02.sh -v 3 -t tcp
-nfs4_02 nfs02.sh -v 4 -t tcp
-nfs41_02 nfs02.sh -v 4.1 -t tcp
-nfs42_02 nfs02.sh -v 4.2 -t tcp
-nfs3_ipv6_02 nfs02.sh -6 -v 3 -t udp
-nfs3t_ipv6_02 nfs02.sh -6 -v 3 -t tcp
-nfs4_ipv6_02 nfs02.sh -6 -v 4 -t tcp
-nfs41_ipv6_02 nfs02.sh -6 -v 4.1 -t tcp
-nfs42_ipv6_02 nfs02.sh -6 -v 4.2 -t tcp
+nfs02_v30_ip4u nfs02.sh -v 3 -t udp
+nfs02_v30_ip4t nfs02.sh -v 3 -t tcp
+nfs02_v40_ip4t nfs02.sh -v 4 -t tcp
+nfs02_v41_ip4t nfs02.sh -v 4.1 -t tcp
+nfs02_v42_ip4t nfs02.sh -v 4.2 -t tcp
+nfs02_v30_ip6u nfs02.sh -6 -v 3 -t udp
+nfs02_v30_ip6t nfs02.sh -6 -v 3 -t tcp
+nfs02_v40_ip6t nfs02.sh -6 -v 4 -t tcp
+nfs02_v41_ip6t nfs02.sh -6 -v 4.1 -t tcp
+nfs02_v42_ip6t nfs02.sh -6 -v 4.2 -t tcp
 
-nfs3_03 nfs03.sh -v 3 -t udp
-nfs3t_03 nfs03.sh -v 3 -t tcp
-nfs4_03 nfs03.sh -v 4 -t tcp
-nfs41_03 nfs03.sh -v 4.1 -t tcp
-nfs42_03 nfs03.sh -v 4.2 -t tcp
-nfs3_ipv6_03 nfs03.sh -6 -v 3 -t udp
-nfs3t_ipv6_03 nfs03.sh -6 -v 3 -t tcp
-nfs4_ipv6_03 nfs03.sh -6 -v 4 -t tcp
-nfs41_ipv6_03 nfs03.sh -6 -v 4.1 -t tcp
-nfs42_ipv6_03 nfs03.sh -6 -v 4.2 -t tcp
+nfs03_v30_ip4u nfs03.sh -v 3 -t udp
+nfs03_v30_ip4t nfs03.sh -v 3 -t tcp
+nfs03_v40_ip4t nfs03.sh -v 4 -t tcp
+nfs03_v41_ip4t nfs03.sh -v 4.1 -t tcp
+nfs03_v42_ip4t nfs03.sh -v 4.2 -t tcp
+nfs03_v30_ip6u nfs03.sh -6 -v 3 -t udp
+nfs03_v30_ip6t nfs03.sh -6 -v 3 -t tcp
+nfs03_v40_ip6t nfs03.sh -6 -v 4 -t tcp
+nfs03_v41_ip6t nfs03.sh -6 -v 4.1 -t tcp
+nfs03_v42_ip6t nfs03.sh -6 -v 4.2 -t tcp
 
-nfs3_04 nfs04.sh -v 3 -t udp
-nfs3t_04 nfs04.sh -v 3 -t tcp
-nfs4_04 nfs04.sh -v 4 -t tcp
-nfs41_04 nfs04.sh -v 4.1 -t tcp
-nfs42_04 nfs04.sh -v 4.2 -t tcp
-nfs3_ipv6_04 nfs04.sh -6 -v 3 -t udp
-nfs3t_ipv6_04 nfs04.sh -6 -v 3 -t tcp
-nfs4_ipv6_04 nfs04.sh -6 -v 4 -t tcp
-nfs41_ipv6_04 nfs04.sh -6 -v 4.1 -t tcp
-nfs42_ipv6_04 nfs04.sh -6 -v 4.2 -t tcp
+nfs04_v30_ip4u nfs04.sh -v 3 -t udp
+nfs04_v30_ip4t nfs04.sh -v 3 -t tcp
+nfs04_v40_ip4t nfs04.sh -v 4 -t tcp
+nfs04_v41_ip4t nfs04.sh -v 4.1 -t tcp
+nfs04_v42_ip4t nfs04.sh -v 4.2 -t tcp
+nfs04_v30_ip6u nfs04.sh -6 -v 3 -t udp
+nfs04_v30_ip6t nfs04.sh -6 -v 3 -t tcp
+nfs04_v40_ip6t nfs04.sh -6 -v 4 -t tcp
+nfs04_v41_ip6t nfs04.sh -6 -v 4.1 -t tcp
+nfs04_v42_ip6t nfs04.sh -6 -v 4.2 -t tcp
 
-nfs3_05 nfs05.sh -v 3 -t udp
-nfs3t_05 nfs05.sh -v 3 -t tcp
-nfs4_05 nfs05.sh -v 4 -t tcp
-nfs41_05 nfs05.sh -v 4.1 -t tcp
-nfs42_05 nfs05.sh -v 4.2 -t tcp
-nfs3_ipv6_05 nfs05.sh -6 -v 3 -t udp
-nfs3t_ipv6_05 nfs05.sh -6 -v 3 -t tcp
-nfs4_ipv6_05 nfs05.sh -6 -v 4 -t tcp
-nfs41_ipv6_05 nfs05.sh -6 -v 4.1 -t tcp
-nfs42_ipv6_05 nfs05.sh -6 -v 4.2 -t tcp
+nfs05_v30_ip4u nfs05.sh -v 3 -t udp
+nfs05_v30_ip4t nfs05.sh -v 3 -t tcp
+nfs05_v40_ip4t nfs05.sh -v 4 -t tcp
+nfs05_v41_ip4t nfs05.sh -v 4.1 -t tcp
+nfs05_v42_ip4t nfs05.sh -v 4.2 -t tcp
+nfs05_v30_ip6u nfs05.sh -6 -v 3 -t udp
+nfs05_v30_ip6t nfs05.sh -6 -v 3 -t tcp
+nfs05_v40_ip6t nfs05.sh -6 -v 4 -t tcp
+nfs05_v41_ip6t nfs05.sh -6 -v 4.1 -t tcp
+nfs05_v42_ip6t nfs05.sh -6 -v 4.2 -t tcp
 
-nfs01_06  nfs06.sh -v "3,3,3,4,4,4" -t "udp,udp,tcp,tcp,tcp,tcp"
-nfs02_06 nfs06.sh -v "3,4,4.1,4.2,4.2,4.2" -t "tcp,tcp,tcp,tcp,tcp,tcp"
-nfs03_ipv6_06 nfs06.sh -6 -v "4,4.1,4.1,4.2,4.2,4.2" -t "tcp,tcp,tcp,tcp,tcp,tcp"
+nfs06_v30_v40_ip4  nfs06.sh -v "3,3,3,4,4,4" -t "udp,udp,tcp,tcp,tcp,tcp"
+nfs06_vall_ip4t nfs06.sh -v "3,4,4.1,4.2,4.2,4.2" -t "tcp,tcp,tcp,tcp,tcp,tcp"
+nfs06_v4x_ip6t nfs06.sh -6 -v "4,4.1,4.1,4.2,4.2,4.2" -t "tcp,tcp,tcp,tcp,tcp,tcp"
 
-nfs3_07 nfs07.sh -v 3 -t udp
-nfs3t_07 nfs07.sh -v 3 -t tcp
-nfs4_07 nfs07.sh -v 4 -t tcp
-nfs41_07 nfs07.sh -v 4.1 -t tcp
-nfs42_07 nfs07.sh -v 4.2 -t tcp
-nfs3_ipv6_07 nfs07.sh -6 -v 3 -t udp
-nfs3t_ipv6_07 nfs07.sh -6 -v 3 -t tcp
-nfs4_ipv6_07 nfs07.sh -6 -v 4 -t tcp
-nfs41_ipv6_07 nfs07.sh -6 -v 4.1 -t tcp
-nfs42_ipv6_07 nfs07.sh -6 -v 4.2 -t tcp
+nfs07_v30_ip4u nfs07.sh -v 3 -t udp
+nfs07_v30_ip4t nfs07.sh -v 3 -t tcp
+nfs07_v40_ip4t nfs07.sh -v 4 -t tcp
+nfs07_v41_ip4t nfs07.sh -v 4.1 -t tcp
+nfs07_v42_ip4t nfs07.sh -v 4.2 -t tcp
+nfs07_v30_ip6u nfs07.sh -6 -v 3 -t udp
+nfs07_v30_ip6t nfs07.sh -6 -v 3 -t tcp
+nfs07_v40_ip6t nfs07.sh -6 -v 4 -t tcp
+nfs07_v41_ip6t nfs07.sh -6 -v 4.1 -t tcp
+nfs07_v42_ip6t nfs07.sh -6 -v 4.2 -t tcp
 
-nfs3_08 nfs08.sh -v 3 -t udp
-nfs3t_08 nfs08.sh -v 3 -t tcp
-nfs4_08 nfs08.sh -v 4 -t tcp
-nfs41_08 nfs08.sh -v 4.1 -t tcp
-nfs42_08 nfs08.sh -v 4.2 -t tcp
-nfs3_ipv6_08 nfs08.sh -6 -v 3 -t udp
-nfs3t_ipv6_08 nfs08.sh -6 -v 3 -t tcp
-nfs4_ipv6_08 nfs08.sh -6 -v 4 -t tcp
-nfs41_ipv6_08 nfs08.sh -6 -v 4.1 -t tcp
-nfs42_ipv6_08 nfs08.sh -6 -v 4.2 -t tcp
+nfs08_v30_ip4u nfs08.sh -v 3 -t udp
+nfs08_v30_ip4t nfs08.sh -v 3 -t tcp
+nfs08_v40_ip4t nfs08.sh -v 4 -t tcp
+nfs08_v41_ip4t nfs08.sh -v 4.1 -t tcp
+nfs08_v42_ip4t nfs08.sh -v 4.2 -t tcp
+nfs08_v30_ip6u nfs08.sh -6 -v 3 -t udp
+nfs08_v30_ip6t nfs08.sh -6 -v 3 -t tcp
+nfs08_v40_ip6t nfs08.sh -6 -v 4 -t tcp
+nfs08_v41_ip6t nfs08.sh -6 -v 4.1 -t tcp
+nfs08_v42_ip6t nfs08.sh -6 -v 4.2 -t tcp
 
-nfslock3_01 nfslock01.sh -v 3 -t udp
-nfslock3t_01 nfslock01.sh -v 3 -t tcp
-nfslock4_01 nfslock01.sh -v 4 -t tcp
-nfslock41_01 nfslock01.sh -v 4.1 -t tcp
-nfslock42_01 nfslock01.sh -v 4.2 -t tcp
-nfslock3_ipv6_01 nfslock01.sh -6 -v 3 -t udp
-nfslock3t_ipv6_01 nfslock01.sh -6 -v 3 -t tcp
-nfslock4_ipv6_01 nfslock01.sh -6 -v 4 -t tcp
-nfslock41_ipv6_01 nfslock01.sh -6 -v 4.1 -t tcp
-nfslock42_ipv6_01 nfslock01.sh -6 -v 4.2 -t tcp
+nfs09_v30_ip4u nfs09.sh -v 3 -t udp
+nfs09_v30_ip4t nfs09.sh -v 3 -t tcp
+nfs09_v40_ip4t nfs09.sh -v 4 -t tcp
+nfs09_v41_ip4t nfs09.sh -v 4.1 -t tcp
+nfs09_v42_ip4t nfs09.sh -v 4.2 -t tcp
+nfs09_v30_ip6u nfs09.sh -6 -v 3 -t udp
+nfs09_v30_ip6t nfs09.sh -6 -v 3 -t tcp
+nfs09_v40_ip6t nfs09.sh -6 -v 4 -t tcp
+nfs09_v41_ip6t nfs09.sh -6 -v 4.1 -t tcp
+nfs09_v42_ip6t nfs09.sh -6 -v 4.2 -t tcp
 
-nfsstat3_01 nfsstat01.sh
+nfslock01_v30_ip4u nfslock01.sh -v 3 -t udp
+nfslock01_v30_ip4t nfslock01.sh -v 3 -t tcp
+nfslock01_v40_ip4t nfslock01.sh -v 4 -t tcp
+nfslock01_v41_ip4t nfslock01.sh -v 4.1 -t tcp
+nfslock01_v42_ip4t nfslock01.sh -v 4.2 -t tcp
+nfslock01_v30_ip6u nfslock01.sh -6 -v 3 -t udp
+nfslock01_v30_ip6t nfslock01.sh -6 -v 3 -t tcp
+nfslock01_v40_ip6t nfslock01.sh -6 -v 4 -t tcp
+nfslock01_v41_ip6t nfslock01.sh -6 -v 4.1 -t tcp
+nfslock01_v42_ip6t nfslock01.sh -6 -v 4.2 -t tcp
 
-nfsx3 fsx.sh -v 3 -t udp
-nfsx3t fsx.sh -v 3 -t tcp
-nfsx4 fsx.sh -v 4 -t tcp
-nfsx41 fsx.sh -v 4.1 -t tcp
-nfsx42 fsx.sh -v 4.2 -t tcp
-nfsx3_ipv6 fsx.sh -6 -v 3 -t udp
-nfsx3t_ipv6 fsx.sh -6 -v 3 -t tcp
-nfsx4_ipv6 fsx.sh -6 -v 4 -t tcp
-nfsx41_ipv6 fsx.sh -6 -v 4.1 -t tcp
-nfsx42_ipv6 fsx.sh -6 -v 4.2 -t tcp
+nfsstat01_v30_ip4u nfsstat01.sh -v 3 -t udp
+nfsstat01_v30_ip4t nfsstat01.sh -v 3 -t tcp
+nfsstat01_v40_ip4t nfsstat01.sh -v 4 -t tcp
+nfsstat01_v41_ip4t nfsstat01.sh -v 4.1 -t tcp
+nfsstat01_v42_ip4t nfsstat01.sh -v 4.2 -t tcp
+nfsstat01_v30_ip6u nfsstat01.sh -6 -v 3 -t udp
+nfsstat01_v30_ip6t nfsstat01.sh -6 -v 3 -t tcp
+nfsstat01_v40_ip6t nfsstat01.sh -6 -v 4 -t tcp
+nfsstat01_v41_ip6t nfsstat01.sh -6 -v 4.1 -t tcp
+nfsstat01_v42_ip6t nfsstat01.sh -6 -v 4.2 -t tcp
+
+fsx_v30_ip4u fsx.sh -v 3 -t udp
+fsx_v30_ip4t fsx.sh -v 3 -t tcp
+fsx_v40_ip4t fsx.sh -v 4 -t tcp
+fsx_v41_ip4t fsx.sh -v 4.1 -t tcp
+fsx_v42_ip4t fsx.sh -v 4.2 -t tcp
+fsx_v30_ip6u fsx.sh -6 -v 3 -t udp
+fsx_v30_ip6t fsx.sh -6 -v 3 -t tcp
+fsx_v40_ip6t fsx.sh -6 -v 4 -t tcp
+fsx_v41_ip6t fsx.sh -6 -v 4.1 -t tcp
+fsx_v42_ip6t fsx.sh -6 -v 4.2 -t tcp
diff --git a/runtest/net.tcp_cmds b/runtest/net.tcp_cmds
index 7e142de11..248c7371d 100644
--- a/runtest/net.tcp_cmds
+++ b/runtest/net.tcp_cmds
@@ -5,16 +5,13 @@
 ipneigh01_arp ipneigh01.sh -c arp
 ipneigh01_ip ipneigh01.sh -c ip
 arping01 arping01.sh
-clockdiff01 clockdiff01.sh
 ftp ftp01.sh
-host host01.sh
 netstat netstat01.sh
 ping01 ping01.sh
 ping02 ping02.sh
 sendfile sendfile01.sh
 tc01 tc01.sh
 tcpdump tcpdump01.sh
-telnet telnet01.sh
 iptables iptables01.sh
 nft nft01.sh
 dhcpd dhcpd_tests.sh
@@ -22,4 +19,3 @@ dnsmasq dnsmasq_tests.sh
 iproute ip_tests.sh
 tracepath01 tracepath01.sh
 traceroute01 traceroute01.sh
-xinetd xinetd_tests.sh
diff --git a/runtest/smoketest b/runtest/smoketest
index 83eebfe7b..f6f14fd2b 100644
--- a/runtest/smoketest
+++ b/runtest/smoketest
@@ -9,7 +9,7 @@ wait02 wait02
 write01 write01
 symlink01 symlink01
 stat04 symlink01 -T stat04
-utime01A symlink01 -T utime01
+utime07 utime07
 rename01A symlink01 -T rename01
 splice02 splice02 -s 20
 df01_sh df01.sh
diff --git a/runtest/syscalls b/runtest/syscalls
index db5648ee3..5fb1bf992 100644
--- a/runtest/syscalls
+++ b/runtest/syscalls
@@ -31,6 +31,8 @@ alarm05 alarm05
 alarm06 alarm06
 alarm07 alarm07
 
+arch_prctl01 arch_prctl01
+
 bind01 bind01
 bind02 bind02
 bind03 bind03
@@ -329,8 +331,6 @@ fcntl26 fcntl26
 fcntl26_64 fcntl26_64
 fcntl27 fcntl27
 fcntl27_64 fcntl27_64
-fcntl28 fcntl28
-fcntl28_64 fcntl28_64
 fcntl29 fcntl29
 fcntl29_64 fcntl29_64
 fcntl30 fcntl30
@@ -475,6 +475,7 @@ gethostbyname_r01 gethostbyname_r01
 gethostid01 gethostid01
 
 gethostname01 gethostname01
+gethostname02 gethostname02
 
 getitimer01 getitimer01
 getitimer02 getitimer02
@@ -501,6 +502,7 @@ getrandom01 getrandom01
 getrandom02 getrandom02
 getrandom03 getrandom03
 getrandom04 getrandom04
+getrandom05 getrandom05
 
 getresgid01 getresgid01
 getresgid01_16 getresgid01_16
@@ -757,7 +759,6 @@ mkdir02 mkdir02
 mkdir03 mkdir03
 mkdir04 mkdir04
 mkdir05 mkdir05
-mkdir05A symlink01 -T mkdir05
 mkdir09 mkdir09
 
 #mkdirat test cases
@@ -782,6 +783,7 @@ mlock01 mlock01
 mlock02 mlock02
 mlock03 mlock03 -i 20
 mlock04 mlock04
+mlock05 mlock05
 
 mlock201 mlock201
 mlock202 mlock202
@@ -866,12 +868,10 @@ msgctl03 msgctl03
 msgctl04 msgctl04
 msgctl05 msgctl05
 msgctl06 msgctl06
-msgstress01 msgstress01
-msgstress02 msgstress02
-msgstress03 msgstress03
-msgstress04 msgstress04
 msgctl12 msgctl12
 
+msgstress01 msgstress01
+
 msgget01 msgget01
 msgget02 msgget02
 msgget03 msgget03
@@ -1458,6 +1458,7 @@ setxattr03 setxattr03
 shmat01 shmat01
 shmat02 shmat02
 shmat03 shmat03
+shmat04 shmat04
 
 shmctl01 shmctl01
 shmctl02 shmctl02
@@ -1530,6 +1531,8 @@ splice04 splice04
 splice05 splice05
 splice06 splice06
 splice07 splice07
+splice08 splice08
+splice09 splice09
 
 tee01 tee01
 tee02 tee02
@@ -1666,6 +1669,7 @@ unlink01 symlink01 -T unlink01
 unlink05 unlink05
 unlink07 unlink07
 unlink08 unlink08
+unlink09 unlink09
 
 #unlinkat test cases
 unlinkat01 unlinkat01
@@ -1691,12 +1695,12 @@ ustat01 ustat01
 ustat02 ustat02
 
 utime01 utime01
-utime01A symlink01 -T utime01
 utime02 utime02
 utime03 utime03
 utime04 utime04
 utime05 utime05
 utime06 utime06
+utime07 utime07
 
 utimes01 utimes01
 
@@ -1723,10 +1727,8 @@ wait402 wait402
 wait403 wait403
 
 waitpid01 waitpid01
-waitpid02 waitpid02
 waitpid03 waitpid03
 waitpid04 waitpid04
-waitpid05 waitpid05
 waitpid06 waitpid06
 waitpid07 waitpid07
 waitpid08 waitpid08
diff --git a/runtest/syscalls-ipc b/runtest/syscalls-ipc
index df41140a7..8960c487c 100644
--- a/runtest/syscalls-ipc
+++ b/runtest/syscalls-ipc
@@ -4,12 +4,10 @@ msgctl03 msgctl03
 msgctl04 msgctl04
 msgctl05 msgctl05
 msgctl06 msgctl06
-msgstress01 msgstress01
-msgstress02 msgstress02
-msgstress03 msgstress03
-msgstress04 msgstress04
 msgctl12 msgctl12
 
+msgstress01 msgstress01
+
 msgget01 msgget01
 msgget02 msgget02
 msgget03 msgget03
@@ -49,6 +47,7 @@ semop03 semop03
 
 shmat01 shmat01
 shmat02 shmat02
+shmat04 shmat04
 
 shmctl01 shmctl01
 shmctl02 shmctl02
diff --git a/scenario_groups/default b/scenario_groups/default
index f17b2061a..0e76b2bee 100644
--- a/scenario_groups/default
+++ b/scenario_groups/default
@@ -2,7 +2,6 @@ syscalls
 fs
 fs_perms_simple
 dio
-io
 mm
 ipc
 irq
@@ -13,10 +12,7 @@ pty
 containers
 fs_bind
 controllers
-filecaps
-cap_bounds
 fcntl-locktests
-connectors
 power_management_tests
 hugetlb
 commands
diff --git a/scenario_groups/vts b/scenario_groups/vts
deleted file mode 100644
index 6519e39a3..000000000
--- a/scenario_groups/vts
+++ /dev/null
@@ -1,30 +0,0 @@
-can
-cap_bounds
-commands
-connectors
-containers
-cpuhotplug
-cve
-dio
-fcntl-locktests_android
-filecaps
-fs
-fs_bind
-fs_perms_simple
-fsx
-hugetlb
-hyperthreading
-input
-io
-ipc
-kernel_misc
-math
-mm
-nptl
-power_management_tests
-pty
-sched
-sched_low_mem
-securebits
-syscalls
-tracing
diff --git a/scripts/checkpatch.pl b/scripts/checkpatch.pl
index 8c74d07b4..21d9c9fe3 100755
--- a/scripts/checkpatch.pl
+++ b/scripts/checkpatch.pl
@@ -1,5 +1,5 @@
 #!/usr/bin/env perl
-# SPDX-License-Identifier: GPL-2.0
+# SPDX-License-Identifier: GPL-2.0-only
 #
 # (c) 2001, Dave Jones. (the file handling bit)
 # (c) 2005, Joel Schopp <jschopp@austin.ibm.com> (the ugly bit)
diff --git a/testcases/Android.bp b/testcases/Android.bp
index 081505ce1..79d68e7d4 100644
--- a/testcases/Android.bp
+++ b/testcases/Android.bp
@@ -20,7 +20,7 @@ package {
 sh_test {
     name: "ltp_testcases_data_mc_member_ManyGroups",
     src: "network/multicast/mc_member/datafiles/ManyGroups",
-    sub_dir: "ltp/testcases/data/mc_member",
+    sub_dir: "vts_ltp_tests/testcases/data/mc_member",
     filename: "ManyGroups",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -29,7 +29,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_mc_member_TooManyGroups",
     src: "network/multicast/mc_member/datafiles/TooManyGroups",
-    sub_dir: "ltp/testcases/data/mc_member",
+    sub_dir: "vts_ltp_tests/testcases/data/mc_member",
     filename: "TooManyGroups",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -38,7 +38,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ld01_d1.c",
     src: "commands/ld/datafiles/d1.c",
-    sub_dir: "ltp/testcases/data/ld01",
+    sub_dir: "vts_ltp_tests/testcases/data/ld01",
     filename: "d1.c",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -47,7 +47,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_unzip01_dir.out",
     src: "commands/unzip/datafiles/dir.out",
-    sub_dir: "ltp/testcases/data/unzip01",
+    sub_dir: "vts_ltp_tests/testcases/data/unzip01",
     filename: "dir.out",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -56,7 +56,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ld01_f1.c",
     src: "commands/ld/datafiles/f1.c",
-    sub_dir: "ltp/testcases/data/ld01",
+    sub_dir: "vts_ltp_tests/testcases/data/ld01",
     filename: "f1.c",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -65,7 +65,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_rpc01_file.1",
     src: "network/rpc/basic_tests/rpc01/datafiles/file.1",
-    sub_dir: "ltp/testcases/data/rpc01",
+    sub_dir: "vts_ltp_tests/testcases/data/rpc01",
     filename: "file.1",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -74,7 +74,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_rpc01_file.2",
     src: "network/rpc/basic_tests/rpc01/datafiles/file.2",
-    sub_dir: "ltp/testcases/data/rpc01",
+    sub_dir: "vts_ltp_tests/testcases/data/rpc01",
     filename: "file.2",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -83,7 +83,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_binfmt_misc02_file.extension",
     src: "kernel/fs/binfmt_misc/datafiles/file.extension",
-    sub_dir: "ltp/testcases/data/binfmt_misc02",
+    sub_dir: "vts_ltp_tests/testcases/data/binfmt_misc02",
     filename: "file.extension",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -92,7 +92,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_binfmt_misc02_file.magic",
     src: "kernel/fs/binfmt_misc/datafiles/file.magic",
-    sub_dir: "ltp/testcases/data/binfmt_misc02",
+    sub_dir: "vts_ltp_tests/testcases/data/binfmt_misc02",
     filename: "file.magic",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -101,7 +101,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ar01_file1.in",
     src: "commands/ar/datafiles/file1.in",
-    sub_dir: "ltp/testcases/data/ar01",
+    sub_dir: "vts_ltp_tests/testcases/data/ar01",
     filename: "file1.in",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -110,7 +110,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ar01_file10.in",
     src: "commands/ar/datafiles/file10.in",
-    sub_dir: "ltp/testcases/data/ar01",
+    sub_dir: "vts_ltp_tests/testcases/data/ar01",
     filename: "file10.in",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -119,7 +119,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ar01_file2.in",
     src: "commands/ar/datafiles/file2.in",
-    sub_dir: "ltp/testcases/data/ar01",
+    sub_dir: "vts_ltp_tests/testcases/data/ar01",
     filename: "file2.in",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -128,7 +128,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ar01_file3.in",
     src: "commands/ar/datafiles/file3.in",
-    sub_dir: "ltp/testcases/data/ar01",
+    sub_dir: "vts_ltp_tests/testcases/data/ar01",
     filename: "file3.in",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -137,7 +137,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ar01_file4.in",
     src: "commands/ar/datafiles/file4.in",
-    sub_dir: "ltp/testcases/data/ar01",
+    sub_dir: "vts_ltp_tests/testcases/data/ar01",
     filename: "file4.in",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -146,7 +146,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.ar",
     src: "commands/file/datafiles/in.ar",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.ar",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -155,7 +155,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.bash",
     src: "commands/file/datafiles/in.bash",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.bash",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -164,7 +164,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.c",
     src: "commands/file/datafiles/in.c",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.c",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -173,7 +173,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.jpg",
     src: "commands/file/datafiles/in.jpg",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.jpg",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -182,7 +182,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.m4",
     src: "commands/file/datafiles/in.m4",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.m4",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -191,7 +191,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.mp3",
     src: "commands/file/datafiles/in.mp3",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.mp3",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -200,7 +200,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.pl",
     src: "commands/file/datafiles/in.pl",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.pl",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -209,7 +209,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.png",
     src: "commands/file/datafiles/in.png",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.png",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -218,7 +218,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.py",
     src: "commands/file/datafiles/in.py",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.py",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -227,7 +227,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.sh",
     src: "commands/file/datafiles/in.sh",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.sh",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -236,7 +236,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.src.rpm",
     src: "commands/file/datafiles/in.src.rpm",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.src.rpm",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -245,7 +245,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.tar",
     src: "commands/file/datafiles/in.tar",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.tar",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -254,7 +254,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.tar.bz2",
     src: "commands/file/datafiles/in.tar.bz2",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.tar.bz2",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -263,7 +263,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.tar.gz",
     src: "commands/file/datafiles/in.tar.gz",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.tar.gz",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -272,7 +272,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.txt",
     src: "commands/file/datafiles/in.txt",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.txt",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -281,7 +281,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.wav",
     src: "commands/file/datafiles/in.wav",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.wav",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -290,7 +290,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_file01_in.zip",
     src: "commands/file/datafiles/in.zip",
-    sub_dir: "ltp/testcases/data/file01",
+    sub_dir: "vts_ltp_tests/testcases/data/file01",
     filename: "in.zip",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -299,7 +299,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ima_kexec_kexec.policy",
     src: "kernel/security/integrity/ima/datafiles/ima_kexec/kexec.policy",
-    sub_dir: "ltp/testcases/data/ima_kexec",
+    sub_dir: "vts_ltp_tests/testcases/data/ima_kexec",
     filename: "kexec.policy",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -308,7 +308,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ima_keys_keycheck.policy",
     src: "kernel/security/integrity/ima/datafiles/ima_keys/keycheck.policy",
-    sub_dir: "ltp/testcases/data/ima_keys",
+    sub_dir: "vts_ltp_tests/testcases/data/ima_keys",
     filename: "keycheck.policy",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -317,7 +317,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ld01_main.c",
     src: "commands/ld/datafiles/main.c",
-    sub_dir: "ltp/testcases/data/ld01",
+    sub_dir: "vts_ltp_tests/testcases/data/ld01",
     filename: "main.c",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -326,7 +326,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ima_policy_measure.policy",
     src: "kernel/security/integrity/ima/datafiles/ima_policy/measure.policy",
-    sub_dir: "ltp/testcases/data/ima_policy",
+    sub_dir: "vts_ltp_tests/testcases/data/ima_policy",
     filename: "measure.policy",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -335,7 +335,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ima_policy_measure.policy-invalid",
     src: "kernel/security/integrity/ima/datafiles/ima_policy/measure.policy-invalid",
-    sub_dir: "ltp/testcases/data/ima_policy",
+    sub_dir: "vts_ltp_tests/testcases/data/ima_policy",
     filename: "measure.policy-invalid",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -344,7 +344,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ld01_rd1.c",
     src: "commands/ld/datafiles/rd1.c",
-    sub_dir: "ltp/testcases/data/ld01",
+    sub_dir: "vts_ltp_tests/testcases/data/ld01",
     filename: "rd1.c",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -353,7 +353,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ld01_rf1.c",
     src: "commands/ld/datafiles/rf1.c",
-    sub_dir: "ltp/testcases/data/ld01",
+    sub_dir: "vts_ltp_tests/testcases/data/ld01",
     filename: "rf1.c",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -362,7 +362,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_lvm_runfile.tpl",
     src: "misc/lvm/datafiles/runfile.tpl",
-    sub_dir: "ltp/testcases/data/lvm",
+    sub_dir: "vts_ltp_tests/testcases/data/lvm",
     filename: "runfile.tpl",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -371,7 +371,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ima_selinux_selinux.policy",
     src: "kernel/security/integrity/ima/datafiles/ima_selinux/selinux.policy",
-    sub_dir: "ltp/testcases/data/ima_selinux",
+    sub_dir: "vts_ltp_tests/testcases/data/ima_selinux",
     filename: "selinux.policy",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -380,7 +380,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_unzip01_test.zip",
     src: "commands/unzip/datafiles/test.zip",
-    sub_dir: "ltp/testcases/data/unzip01",
+    sub_dir: "vts_ltp_tests/testcases/data/unzip01",
     filename: "test.zip",
     compile_multilib: "both",
     auto_gen_config: false,
@@ -389,7 +389,7 @@ sh_test {
 sh_test {
     name: "ltp_testcases_data_ima_keys_x509_ima.der",
     src: "kernel/security/integrity/ima/datafiles/ima_keys/x509_ima.der",
-    sub_dir: "ltp/testcases/data/ima_keys",
+    sub_dir: "vts_ltp_tests/testcases/data/ima_keys",
     filename: "x509_ima.der",
     compile_multilib: "both",
     auto_gen_config: false,
diff --git a/testcases/commands/logrotate/logrotate_tests.sh b/testcases/commands/logrotate/logrotate_tests.sh
index 105237716..1f3e61294 100755
--- a/testcases/commands/logrotate/logrotate_tests.sh
+++ b/testcases/commands/logrotate/logrotate_tests.sh
@@ -1,381 +1,132 @@
 #!/bin/sh
-################################################################################
-##                                                                            ##
-## Copyright (c) International Business Machines  Corp., 2001                 ##
-##                                                                            ##
-## This program is free software;  you can redistribute it and#or modify      ##
-## it under the terms of the GNU General Public License as published by       ##
-## the Free Software Foundation; either version 2 of the License, or          ##
-## (at your option) any later version.                                        ##
-##                                                                            ##
-## This program is distributed in the hope that it will be useful, but        ##
-## WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY ##
-## or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License   ##
-## for more details.                                                          ##
-##                                                                            ##
-## You should have received a copy of the GNU General Public License          ##
-## along with this program;  if not, write to the Free Software               ##
-## Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA    ##
-##                                                                            ##
-################################################################################
+# SPDX-License-Identifier: GPL-2.0-or-later
+# Copyright (c) International Business Machines Corp., 2001
+# Copyright (c) Linux Test Project, 2002-2024
+# Author: Manoj Iyer <manjo@mail.utexas.edu>
 #
-# File :        logrotate_tests.sh
+# Test Basic functionality of logrotate command.
 #
-# Description:    Test Basic functionality of logrotate command.
-#                Test #1: Test that logrotate -f <file.conf> rotates the logfile
-#                as per the specifications in the conf file. Create a file
-#                tst_logfile in /var/log/. Create a conf file such that this
-#                logfile is set for rotation every week. Execute the command
-#                logrotate -f <file.conf>, check to see if it forced rotation.
-#                Test #2: Check if logrotate running as a cronjob will rotate a
-#                logfile when it exceeds a specific size. Create two cronjobs
-#                1. runs a command to log a string to a logfile. 2. runs
-#                logrotate <file.conf> every minute. The conf file specifies
-#                that the rotation happen only if the log file exceeds 2k file
-#                size.
+# Test #1
+# Test that logrotate logrotate will rotate the logfile according to the
+# specifications in the config file.
+# - Create a config file that will rotate the /var/log/tst_logfile file.
+# - Use force option to force logrotate to cause the log file to be rotated.
+# - Compress the file after rotation.
 #
-# Author:        Manoj Iyer, manjo@mail.utexas.edu
-#
-# History:       Dec 23 2002 - Created - Manoj Iyer.
-#                Dec 24 2002 - Added   - Test #2 - Test to run logrotate as a
-#                                        cron job.
-#                Feb 28 2003 - Fixed   - Modified testcase to use functions.
-#
-# Function: 	chk_ifexists
-#
-# Description:  - Check if command required for this test exits.
-#
-# Input:        - $1 - calling test case.
-#               - $2 - command that needs to be checked.
-#
-# Return:		- zero on success.
-# 				- non-zero on failure.
-chk_ifexists()
-{
-	RC=0
-
-	which $2 > $LTPTMP/tst_logrotate.err 2>&1 || RC=$?
-	if [ $RC -ne 0 ]
-	then
-		tst_brkm TBROK NULL "$1: command $2 not found."
-	fi
-	return $RC
-}
-
-
-# Function: init
-#
-# Description:  - Check if command required for this test exits.
-#               - Create temporary directories required for this test.
-#               - Initialize global variables.
-#
-# Return:		- zero on success.
-# 				- non-zero on failure.
-init()
-{
-	# Initialize global variables.
-	export RC=0
-	export TST_TOTAL=2
-	export TCID="logrotate"
-	export TST_COUNT=0
-
-	# Inititalize cleanup function.
-	trap "cleanup" 0
-
-	# create the temporary directory used by this testcase
-	if [ -z $TMP ]
-	then
-		LTPTMP=/tmp/tst_logrotate.$$
-	else
-		LTPTMP=$TMP/tst_logrotate.$$
-	fi
-
-	mkdir -p $LTPTMP > /dev/null 2>&1 || RC=$?
-	if [ $RC -ne 0 ]
-	then
-		 tst_brkm TBROK "INIT: Unable to create temporary directory"
-		 return $RC
-	fi
-
-	# check if commands tst_*, logrotate, awk and file exists.
-	chk_ifexists INIT tst_resm  || return $RC
-	chk_ifexists INIT logrotate || return $RC
-	chk_ifexists INIT awk       || return $RC
-	chk_ifexists INIT file      || return $RC
-
-	return $RC
-}
+# Test #2
+# Test that logrotate logrotate will rotate the logfile if the logfile
+# exceeds a certain size.
+# - Create a config file that will rotate the /var/log/tst_largelogfile.
+# - Run logrotate in a cron job that runs every minute.
+# - Add messages to the logfile until it gets rotated when a re-dittermined size
+#   is reached.
 
+TST_NEEDS_CMDS="crontab file grep logrotate"
+TST_TESTFUNC=test
+TST_NEEDS_TMPDIR=1
+TST_CNT=2
+TST_CLEANUP=cleanup
 
-# Function: 	cleanup
-#
-# Description:  - remove temporaty files and directories. Stop all jobs stated
-#                 by this testcase.
-#
-# Return:		- zero on success.
-# 				- non-zero on failure.
 cleanup()
 {
-	#remove all cronjobs that were installed.
-	tst_resm TINFO "CLEAN: removing all cron jobs."
-	crontab -r > /dev/null 2>&1
-
-	# remove all the temporary files created by this test.
-	tst_resm TINFO "CLEAN: removing $LTPTMP"
-	rm -fr $LTPTMP
+	(crontab -l | grep -v tst_largelog) | crontab -
+	rm -rf /var/log/tst_logfile*
+	rm -rf /var/log/tst_largelogfile*
 }
 
-
-# Function: 	test01
-#
-# Description:  - Test that logrotate logrotate will rotate the logfile
-#                 according to the specifications in the config file.
-#               - create a config file that will rotate the /var/log/tst_logfile
-#                 file.
-#               - use force option to force logrotate to cause the log file to
-#                 be rotated.
-#               - compress the file after rotation.
-#
-# Return:		- zero on success.
-# 				- non-zero on failure.
-test01()
+check_log()
 {
-	count=0
-	files=" "
-	filesize=0
+	local file="$1"
 
-	TCID=logrotate01
-	TST_COUNT=1
+	EXPECT_PASS [ -f "$file" ]
 
-	tst_resm TINFO "Test #1: create a configfile $LTPTMP/var_mesg.config"
-	tst_resm TINFO "Test #1: use logrotate -f <config> to force rotation"
-	tst_resm TINFO "Test #1: this will rotate the log file according to"
-	tst_resm TINFO "Test #1: the specification in the configfile."
-	tst_resm TINFO "Test #1: 1. rotate /var/log/tst_logfile file."
-	tst_resm TINFO "Test #1: 2. compresses it."
+	if ! file "$file" | grep -q "gzip compressed data"; then
+		tst_res TFAIL "Failed to create a compressed file"
+	fi
+}
 
-	# Check if syslog group exists
+test1()
+{
 	local group="syslog"
+
 	grep -q $group /etc/group || group="root"
 
-	# create config file.
-	cat >$LTPTMP/tst_logrotate.conf <<-EOF
-	#****** Begin Config file *******
-	# create new (empty) log files after rotating old ones
-	create
+	cat >tst_logrotate.conf <<-EOF
+        #****** Begin Config file *******
+        # create new (empty) log files after rotating old ones
+        create
 
-	# compress the log files
-	compress
+        # compress the log files
+        compress
 
-	/var/log/tst_logfile {
-		su root $group
-		rotate 5
-		weekly
-	}
-	#****** End Config file *******
+        /var/log/tst_logfile {
+                su root $group
+                rotate 5
+                weekly
+        }
+        #****** End Config file *******
 	EOF
 
-	# create a log file in /var/log/
 	cat >/var/log/tst_logfile <<-EOF
-	#****** Begin Log File ********
-	# This is a dummy log file.
-	#****** End Log File ********
+        #****** Begin Log File ********
+        # This is a dummy log file.
+        #****** End Log File ********
 	EOF
 
-	while [ $count -lt 10 ]
-	do
-		echo "This a dummy log file used to test logrotate command." >> \
-			/var/log/tst_logfile
-		 		 count=$(( $count+1 ))
+	for i in $(seq 10); do
+		echo "This a dummy log file used to test logrotate command." >> /var/log/tst_logfile
 	done
 
-	# remove all old-n-stale logfiles.
-	for files in /var/log/tst_logfile.*
-	do
-		rm -f $files > /dev/null 2>&1
-	done
-
-	chmod 644 $LTPTMP/tst_logrotate.conf
-	logrotate -fv $LTPTMP/tst_logrotate.conf > $LTPTMP/tst_logrotate.out 2>&1 \
-		|| RC=$?
-	if [ $RC -eq 0 ]
-	then
-		# check if config file $LTPTMP/tst_logrotate.conf is read
-		# check if  /etc/logrotate.d is included/
-		# check if 5 rotations are forced.
-        # check if compression is done.
-		grep "reading config file $LTPTMP/tst_logrotate.conf" \
-			$LTPTMP/tst_logrotate.out   > $LTPTMP/tst_logrotate.err 2>&1 || RC=$?
-		grep "forced from command line (5 rotations)" \
-			$LTPTMP/tst_logrotate.out   > $LTPTMP/tst_logrotate.err 2>&1 || RC=$?
-		egrep "compressing new|log with" \
-			$LTPTMP/tst_logrotate.out   > $LTPTMP/tst_logrotate.err 2>&1 || RC=$?
-		if [ $RC -ne 0 ]
-		then
-			tst_res TFAIL $LTPTMP/tst_logrotate.err \
-				"Test #1: logrotate command failed. Reason:"
-		else
-			# Check if compressed log file is created.
-			if [ -f /var/log/tst_logfile.1.gz ]
-			then
-				file /var/log/tst_logfile.1.gz | grep "gzip compressed data" \
-					> $LTPTMP/tst_logrotate.out 2>&1 || RC=$?
-				if [ $RC -eq 0 ]
-				then
-					tst_resm TPASS \
-						"Test #1: logrotate created a compressed file."
-				else
-					tst_res TFAIL $LTPTMP/tst_logrotate.out \
-						"Test #1: Failed to create a compressed file. Reason:"
-				fi
-				return $RC
-			else
-				 tst_res TFAIL  $LTPTMP/tst_logrotate.out \
-				  "Test #1: Failed create /var/log/tst_logfile.1.gz. Reason:"
-				return $RC
-			fi
-		fi
-	else
-		tst_res TFAIL $LTPTMP/tst_logrotate.out \
-		"Test #1: logrotate command exited with $RC return code. Output:"
-	fi
-	return $RC
-}
-
-
-test02()
-{
-# Test #2
-# Test that logrotate logrotate will rotate the logfile if the logfile
-# exceeds a certain size.
-#     - create a config file that will rotate the /var/log/tst_largelogfile.
-#     - run logrotate in a cron job that runs every minute.
-#     - add messages to the logfile until it gets rotated when a re-dittermined
-#        size is reached.
-
-export TCID=logrotate02
-export TST_COUNT=2
-RC=0
-
-tst_resm TINFO "Test #2: create a configfile $LTPTMP/tst_largelog.conf"
-tst_resm TINFO "Test #2: logrotate $LTPTMP/tst_largelog.conf - cronjob"
-tst_resm TINFO "Test #2: set to rotate tst_largelogfile when size > 2K"
-
-
-# create config file.
-cat >$LTPTMP/tst_largelog.conf <<EOF
-# create new (empty) log files after rotating old ones
-create
-
-# compress the log files
-compress
+	ROD rm -f /var/log/tst_logfile.*
+	ROD chmod 644 tst_logrotate.conf
+	ROD logrotate -fv tst_logrotate.conf > tst_logrotate.out 2>&1
 
-# RPM packages drop log rotation information into this directory
-include /etc/logrotate.d
+	EXPECT_PASS grep -q "reading config file tst_logrotate.conf" tst_logrotate.out
+	EXPECT_PASS grep -q "forced from command line (5 rotations)" tst_logrotate.out
+	EXPECT_PASS grep -E -q "compressing new|log with" tst_logrotate.out
 
-/var/log/tst_largelogfile {
-    rotate 5
-    size=2k
+	check_log /var/log/tst_logfile.1.gz
 }
-EOF
 
-# create the pseudo-log file.
-cat >/var/log/tst_largelogfile <<EOF
-# This is a psuedo-log file. This file will grow to a 2k size before
-# getting rotated.
-EOF
-
-# create logrotate cron job.
-cat >$LTPTMP/tst_logrotate.cron <<EOF
-* * * * * logrotate $LTPTMP/tst_largelog.conf
-EOF
-
-chmod 777 $LTPTMP/tst_logrotate.cron > /dev/null 2>&1
-
-tst_resm TINFO "Test #2: Installing cron job to run logrotate"
-crontab $LTPTMP/tst_logrotate.cron > $LTPTMP/tst_logrotate.out 2>&1 || RC=$?
-if [ $RC -ne 0 ]
-then
-    echo "Exit status of crontab command: $RC" >> tst_logrotate.out 2>/dev/null
-    tst_brk TBROK $LTPTMP/tst_logrotate.out NULL \
-        "Test #2: crontab Broke while installing cronjob. Reason:"
-    TFAILCNT=$(( $TFAILCN+1 ))
-else
-    tst_resm TINFO "Test #2: Cronjob installed successfully"
-fi
-
-# cron job to increase the log file size.
-cat >$LTPTMP/tst_addtolog.cron <<EOF
-
-* * * * * echo "To Err Is Human, To Really Screw Up You Need A Computer."  >>/var/log/tst_largelogfile 2>/dev/null
-EOF
-
-tst_resm TINFO "Test #2: Installing cron job to increase logsize"
-crontab $LTPTMP/tst_addtolog.cron > $LTPTMP/tst_logrotate.out 2>&1 || RC=$?
-if [ $RC -ne 0 ]
-then
-    echo "Exit status of crontab command: $RC" >> tst_logrotate.out 2>/dev/null
-    tst_brk TBROK $LTPTMP/tst_logrotate.out NULL \
-        "Test #2: crontab Broke while installing cronjob. Reason:"
-    TFAILCNT=$(( $TFAILCN+1 ))
-else
-    tst_resm TINFO "Test #2: Cronjob installed successfully"
-fi
+test2()
+{
+	cat >tst_largelog.conf <<-EOF
+        # create new (empty) log files after rotating old ones
+        create
+        # compress the log files
+        compress
+        # RPM packages drop log rotation information into this directory
+        include /etc/logrotate.d
+        /var/log/tst_largelogfile {
+            rotate 5
+            size=2k
+        }
+	EOF
 
-# let cron jobs get started.
-sleep 10s
+	ROD chmod 644 tst_largelog.conf
 
-# increase the log file size.
+	cat >/var/log/tst_largelogfile <<-EOF
+        # This is a psuedo-log file. This file will grow to a 2k size before
+        # getting rotated.
+	EOF
 
-# wait for the /var/log/tst_largelogfile to be filled to a size greater than 2k
-tst_resm TINFO "Test #2: Checking if file size is > 2k"
-tst_resm TINFO "Test #2: Pls be patient this will take some time."
-tst_resm TINFO "Test #2: or killall -9 logrotate02 to skip.."
-if [ -f `which awk` ]
-then
-    while [ $filesize -lt 2046 ]
-    do
-        filesize=`ls -l /var/log/tst_largelogfile | awk '{print $5}'`
-    done
-	# wait for 1m  and check if logrotate has rotated the logfile. The cron job
-	# that does a logrotate runs every 1 minute so give the cron a minute...
-	sleep 1m
-else
-	tst_resm TINFO "Test #2: No AWK installed ... sleeping for 10mts"
-	sleep 10m
-fi
+	for i in $(seq 75); do
+		echo "Some text for testing rotation" >> /var/log/tst_largelogfile
+	done
 
+	# cron job for logrotating
+	(crontab -l 2>/dev/null; echo \
+		"* * * * * $(command -v logrotate) $(pwd)/tst_largelog.conf") | crontab -
+	if [ $? -ne 0 ]; then
+		tst_brk TBROK "Failed to create a cron job"
+	fi
 
-if [ -f /var/log/tst_largelogfile.1.gz ]
-then
-    file /var/log/tst_largelogfile.1.gz | grep "gzip compressed data" \
-        > $LTPTMP/tst_logrotate.out 2>&1 || RC=$?
-    if [ $RC -eq 0 ]
-    then
-        tst_resm TPASS \
-            "Test #1: logrotate worked as cron, created a compressed file."
-    else
-        tst_res TFAIL $LTPTMP/tst_logrotate.out \
-            "Test #1: Failed to create a compressed file. Reason:"
-    fi
-else
-    tst_res TFAIL  $LTPTMP/tst_logrotate.out \
-        "Test #1: Failed to create /var/log/tst_largelogfile.1.gz. Reason:"
-    TFAILCNT=$(( $TFAILCNT+1 ))
-fi
+	# 5 sec for cron job to start, 1 min for logrotate to rotate the logs
+	tst_res TINFO "sleep 1 min to wait for rotating logs"
+	tst_sleep 65s
 
+	check_log /var/log/tst_largelogfile.1.gz
 }
 
-# Function:	main
-#
-# Description:	- Execute all tests and report results.
-#
-# Exit:			- zero on success
-#               - non-zero on failure.
-
-RC=0
-init || exit $?
-
-test01 || RC=$?
-
-exit $RC
+. tst_test.sh
+tst_run
diff --git a/testcases/cve/stack_clash.c b/testcases/cve/stack_clash.c
index 56b970a1b..8cc2c20b5 100644
--- a/testcases/cve/stack_clash.c
+++ b/testcases/cve/stack_clash.c
@@ -44,6 +44,7 @@
 #include <stdlib.h>
 
 #include "tst_test.h"
+#include "tst_kconfig.h"
 #include "tst_safe_stdio.h"
 #include "lapi/mmap.h"
 
@@ -272,19 +273,14 @@ void do_child(void)
 
 void setup(void)
 {
-	char buf[4096], *p;
-
 	page_size = sysconf(_SC_PAGESIZE);
 	page_mask = ~(page_size - 1);
 
-	buf[4095] = '\0';
-	SAFE_FILE_SCANF("/proc/cmdline", "%4095[^\n]", buf);
+	struct tst_kcmdline_var params = TST_KCMDLINE_INIT("stack_guard_gap");
+	tst_kcmdline_parse(&params, 1);
 
-	if ((p = strstr(buf, "stack_guard_gap=")) != NULL) {
-		if (sscanf(p, "stack_guard_gap=%ld", &GAP_PAGES) != 1) {
-			tst_brk(TBROK | TERRNO, "sscanf");
-			return;
-		}
+	if (params.found) {
+		GAP_PAGES= atol(params.value);
 		tst_res(TINFO, "stack_guard_gap = %ld", GAP_PAGES);
 	}
 
diff --git a/testcases/cve/tcindex01.c b/testcases/cve/tcindex01.c
index 70e5639f1..e9c8a9a90 100644
--- a/testcases/cve/tcindex01.c
+++ b/testcases/cve/tcindex01.c
@@ -106,12 +106,23 @@ static void run(void)
 	NETDEV_ADD_QDISC(DEVNAME, AF_UNSPEC, TC_H_ROOT, qd_handle, "htb",
 		qd_config);
 	NETDEV_ADD_TRAFFIC_CLASS(DEVNAME, qd_handle, clsid, "htb", cls_config);
-	NETDEV_ADD_TRAFFIC_FILTER(DEVNAME, qd_handle, 10, ETH_P_IP, 1,
-		"tcindex", f_config);
+	ret = NETDEV_ADD_TRAFFIC_FILTER_RET(DEVNAME, qd_handle, 10, ETH_P_IP,
+		1, "tcindex", f_config);
+	TST_ERR = tst_netlink_errno;
+
+	if (!ret && TST_ERR == ENOENT) {
+		tst_res(TPASS | TTERRNO,
+			"tcindex module is blacklisted or unavailable");
+		return;
+	}
+
+	if (!ret)
+		tst_brk(TBROK | TTERRNO, "Cannot add tcindex filter");
+
 	NETDEV_REMOVE_TRAFFIC_FILTER(DEVNAME, qd_handle, 10, ETH_P_IP,
 		1, "tcindex");
-	ret = tst_netdev_add_traffic_filter(__FILE__, __LINE__, 0, DEVNAME,
-		qd_handle, 10, ETH_P_IP, 1, "tcindex", f_config);
+	ret = NETDEV_ADD_TRAFFIC_FILTER_RET(DEVNAME, qd_handle, 10, ETH_P_IP,
+		1, "tcindex", f_config);
 	TST_ERR = tst_netlink_errno;
 	NETDEV_REMOVE_QDISC(DEVNAME, AF_UNSPEC, TC_H_ROOT, qd_handle, "htb");
 
diff --git a/testcases/kernel/Makefile b/testcases/kernel/Makefile
index 81d109491..bff1bd1b9 100644
--- a/testcases/kernel/Makefile
+++ b/testcases/kernel/Makefile
@@ -15,7 +15,6 @@ SUBDIRS			:= syscalls
 # Build lib
 SUBDIRS			+= lib
 
-ifneq ($(UCLINUX),1)
 # KEEP THIS LIST ALPHABETIZED PLEASE!
 SUBDIRS			+= connectors \
 			   containers \
@@ -33,6 +32,7 @@ SUBDIRS			+= connectors \
 			   logging \
 			   mem \
 			   numa \
+			   power_management \
 			   pty \
 			   sched \
 			   security \
@@ -41,13 +41,8 @@ SUBDIRS			+= connectors \
 			   uevents \
 			   watchqueue \
 
-ifeq ($(WITH_POWER_MANAGEMENT_TESTSUITE),yes)
-SUBDIRS			+= power_management
-endif
-
 ifeq ($(WITH_KVM_TESTSUITE),yes)
 SUBDIRS			+= kvm
-endif
 
 endif
 
diff --git a/testcases/kernel/containers/mountns/mountns01.c b/testcases/kernel/containers/mountns/mountns01.c
index 8d821ea45..2205eb968 100644
--- a/testcases/kernel/containers/mountns/mountns01.c
+++ b/testcases/kernel/containers/mountns/mountns01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Red Hat, Inc.
  * Copyright (C) 2021 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
diff --git a/testcases/kernel/containers/mountns/mountns02.c b/testcases/kernel/containers/mountns/mountns02.c
index e7a80cbbf..56b1b4b6a 100644
--- a/testcases/kernel/containers/mountns/mountns02.c
+++ b/testcases/kernel/containers/mountns/mountns02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Red Hat, Inc.
  * Copyright (C) 2021 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
diff --git a/testcases/kernel/containers/mountns/mountns03.c b/testcases/kernel/containers/mountns/mountns03.c
index 6066d1c54..cdceb00d0 100644
--- a/testcases/kernel/containers/mountns/mountns03.c
+++ b/testcases/kernel/containers/mountns/mountns03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Red Hat, Inc.
  * Copyright (C) 2021 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
diff --git a/testcases/kernel/containers/mountns/mountns04.c b/testcases/kernel/containers/mountns/mountns04.c
index 7b4dcb16d..752d89920 100644
--- a/testcases/kernel/containers/mountns/mountns04.c
+++ b/testcases/kernel/containers/mountns/mountns04.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Red Hat, Inc.
  * Copyright (C) 2021 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
diff --git a/testcases/kernel/containers/mqns/mqns_02.c b/testcases/kernel/containers/mqns/mqns_02.c
index 4348be7fc..aef83a23a 100644
--- a/testcases/kernel/containers/mqns/mqns_02.c
+++ b/testcases/kernel/containers/mqns/mqns_02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) International Business Machines Corp., 2009
  * Copyright (c) Nadia Derbey, 2009 <Nadia.Derbey@bull.net>
diff --git a/testcases/kernel/containers/netns/netns_netlink.c b/testcases/kernel/containers/netns/netns_netlink.c
index e8df616e2..ba55ec70a 100644
--- a/testcases/kernel/containers/netns/netns_netlink.c
+++ b/testcases/kernel/containers/netns/netns_netlink.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Red Hat, Inc.
  * Copyright (c) 2021 Petr Vorel <pvorel@suse.cz>
diff --git a/testcases/kernel/containers/pidns/pidns03.c b/testcases/kernel/containers/pidns/pidns03.c
index d662ca9d5..d2a6178b9 100644
--- a/testcases/kernel/containers/pidns/pidns03.c
+++ b/testcases/kernel/containers/pidns/pidns03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Red Hat, Inc. All rights reserved.
  * Copyright (C) 2022 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
diff --git a/testcases/kernel/containers/pidns/pidns04.c b/testcases/kernel/containers/pidns/pidns04.c
index bed75a082..fdd532653 100644
--- a/testcases/kernel/containers/pidns/pidns04.c
+++ b/testcases/kernel/containers/pidns/pidns04.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (C) International Business Machines Corp., 2008
  * Copyright (C) 2022 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
diff --git a/testcases/kernel/containers/pidns/pidns06.c b/testcases/kernel/containers/pidns/pidns06.c
index c85a875e4..a71c844a3 100644
--- a/testcases/kernel/containers/pidns/pidns06.c
+++ b/testcases/kernel/containers/pidns/pidns06.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (C) International Business Machines Corp., 2008
  * Copyright (C) 2022 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
diff --git a/testcases/kernel/containers/pidns/pidns10.c b/testcases/kernel/containers/pidns/pidns10.c
index c2a9094b6..7e798420e 100644
--- a/testcases/kernel/containers/pidns/pidns10.c
+++ b/testcases/kernel/containers/pidns/pidns10.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (C) International Business Machines Corp., 2008
  * Copyright (C) 2022 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
diff --git a/testcases/kernel/controllers/cgroup/cgroup_core02.c b/testcases/kernel/controllers/cgroup/cgroup_core02.c
index 1872a7dff..733e88ee7 100644
--- a/testcases/kernel/controllers/cgroup/cgroup_core02.c
+++ b/testcases/kernel/controllers/cgroup/cgroup_core02.c
@@ -121,6 +121,7 @@ static struct tst_test test = {
 	.needs_root = 1,
 	.needs_cgroup_ctrls = (const char *const[]){"memory",  NULL},
 	.needs_cgroup_ver = TST_CG_V2,
+	.needs_cgroup_nsdelegate = 1,
 	.tags = (const struct tst_tag[]) {
 		{"linux-git", "e57457641613"},
 		{"CVE", "2021-4197"},
diff --git a/testcases/kernel/controllers/io/io_control01.c b/testcases/kernel/controllers/io/io_control01.c
index 691196886..47ae0f104 100644
--- a/testcases/kernel/controllers/io/io_control01.c
+++ b/testcases/kernel/controllers/io/io_control01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2022 SUSE LLC <rpalethorpe@suse.com>
  */
diff --git a/testcases/kernel/controllers/memcg/control/mem_process.c b/testcases/kernel/controllers/memcg/control/mem_process.c
index 8ecabb272..76cdf8066 100644
--- a/testcases/kernel/controllers/memcg/control/mem_process.c
+++ b/testcases/kernel/controllers/memcg/control/mem_process.c
@@ -11,6 +11,7 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <unistd.h>
+#include "pgsize_helpers.h"
 
 /*
  * Named pipe to act as a communication channel between
@@ -55,7 +56,7 @@ void touch_memory(char *p)
 	int i;
 	int pagesize = getpagesize();
 
-	for (i = 0; i < (int)memsize; i += pagesize)
+	for (i = 0; i < (int)memsize; i += kernel_page_size())
 		p[i] = 0xef;
 }
 
diff --git a/testcases/kernel/controllers/memcg/memcontrol01.c b/testcases/kernel/controllers/memcg/memcontrol01.c
index 935b97778..f4fadacdd 100644
--- a/testcases/kernel/controllers/memcg/memcontrol01.c
+++ b/testcases/kernel/controllers/memcg/memcontrol01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*\
  *
  * [Description]
diff --git a/testcases/kernel/controllers/memcg/memcontrol02.c b/testcases/kernel/controllers/memcg/memcontrol02.c
index 0d93abd9e..28c38c6d3 100644
--- a/testcases/kernel/controllers/memcg/memcontrol02.c
+++ b/testcases/kernel/controllers/memcg/memcontrol02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*\
  *
  * [Description]
@@ -24,6 +24,7 @@
 #define _GNU_SOURCE
 
 #include "memcontrol_common.h"
+#include "pgsize_helpers.h"
 
 static size_t page_size;
 static struct tst_cg_group *cg_child;
@@ -39,7 +40,7 @@ static void alloc_anon_50M_check(void)
 		TST_CG_VER_IS_V1(tst_cg, "memory") ? "rss %zd" : "anon %zd";
 
 	buf = SAFE_MALLOC(size);
-	for (ptr = buf; ptr < buf + size; ptr += page_size)
+	for (ptr = buf; ptr < buf + size; ptr += kernel_page_size())
 		*ptr = 0;
 
 	SAFE_CG_SCANF(cg_child, "memory.current", "%zd", &current);
diff --git a/testcases/kernel/controllers/memcg/memcontrol03.c b/testcases/kernel/controllers/memcg/memcontrol03.c
index 9c6c808e0..6d9c490b5 100644
--- a/testcases/kernel/controllers/memcg/memcontrol03.c
+++ b/testcases/kernel/controllers/memcg/memcontrol03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*\
  *
  * [Description]
@@ -144,6 +144,7 @@ static void alloc_pagecache_in_child(const struct tst_cg_group *const cg,
 	tst_res(TINFO, "Child %d in %s: Allocating pagecache: %"PRIdPTR,
 		getpid(), tst_cg_group_name(cg), size);
 	alloc_pagecache(fd, size);
+	SAFE_FSYNC(fd);
 
 	TST_CHECKPOINT_WAKE(CHILD_IDLE);
 	TST_CHECKPOINT_WAIT(TEST_DONE);
diff --git a/testcases/kernel/controllers/memcg/memcontrol04.c b/testcases/kernel/controllers/memcg/memcontrol04.c
index 32a0b9fd4..1b8d115f8 100644
--- a/testcases/kernel/controllers/memcg/memcontrol04.c
+++ b/testcases/kernel/controllers/memcg/memcontrol04.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*\
  *
  * [Description]
diff --git a/testcases/kernel/controllers/memcg/memcontrol_common.h b/testcases/kernel/controllers/memcg/memcontrol_common.h
index a3bd243f5..e39e455dd 100644
--- a/testcases/kernel/controllers/memcg/memcontrol_common.h
+++ b/testcases/kernel/controllers/memcg/memcontrol_common.h
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 
 #ifndef MEMCONTROL_COMMON_H__
 #define MEMCONTROL_COMMON_H__
diff --git a/testcases/kernel/controllers/memcg/regression/memcg_regression_test.sh b/testcases/kernel/controllers/memcg/regression/memcg_regression_test.sh
index 58759263e..afa59eeba 100755
--- a/testcases/kernel/controllers/memcg/regression/memcg_regression_test.sh
+++ b/testcases/kernel/controllers/memcg/regression/memcg_regression_test.sh
@@ -221,6 +221,7 @@ test_4()
 	local test_path
 	test_path="$test_dir/0"
 	create_testpath "$test_path"
+	swaps=$(cut -F1 /proc/swaps | tail -n +2)
 
 	./memcg_test_4.sh "$cgroup_version" "$mount_point" "$test_path"
 
@@ -236,7 +237,9 @@ test_4()
 	# if test_4.sh gets killed, it won't clean cgroup it created
 	cleanup_testpath "$test_path"
 
-	swapon -a
+	for s in $swaps; do
+		swapon $s
+	done
 }
 
 . cgroup_lib.sh
diff --git a/testcases/kernel/controllers/memcg/regression/memcg_test_4.sh b/testcases/kernel/controllers/memcg/regression/memcg_test_4.sh
index 8723abb2f..81e81c489 100755
--- a/testcases/kernel/controllers/memcg/regression/memcg_test_4.sh
+++ b/testcases/kernel/controllers/memcg/regression/memcg_test_4.sh
@@ -29,7 +29,9 @@ sleep 1
 echo 40M > "$test_path/$memory_limit"
 
 # turn off swap, and swapoff will be killed
-swapoff -a
+for s in $(cut -F1 /proc/swaps | tail -n +2); do
+	swapoff $s
+done
 sleep 1
 echo $pid > "$mount_point/$task_list" 2> /dev/null
 echo $$ > "$mount_point/$task_list"  2> /dev/null
diff --git a/testcases/kernel/device-drivers/zram/zram01.sh b/testcases/kernel/device-drivers/zram/zram01.sh
index 0c100b706..793f6603c 100755
--- a/testcases/kernel/device-drivers/zram/zram01.sh
+++ b/testcases/kernel/device-drivers/zram/zram01.sh
@@ -84,7 +84,6 @@ zram_makefs()
 			cat err.log
 			tst_res TFAIL "Failed to make $fs on /dev/zram$i"
 			tst_brk TBROK "Can't continue with mounting the FS"
-			return
 		fi
 
 		i=$(($i + 1))
@@ -155,7 +154,7 @@ zram_fill_fs()
 			continue
 		fi
 
-		TST_RETRY_FUNC "check_read_mem_used_total /sys/block/zram$i/mm_stat" 0
+		TST_RETRY_FN_EXP_BACKOFF "check_read_mem_used_total /sys/block/zram$i/mm_stat" 0 10
 		mem_used_total=$(read_mem_used_total /sys/block/zram$i/mm_stat)
 		tst_res TINFO "mem_used_total: $mem_used_total"
 
diff --git a/testcases/kernel/io/ltp-aiodio/aio-stress.c b/testcases/kernel/io/ltp-aiodio/aio-stress.c
index 5c3a0a3a4..c29ede671 100644
--- a/testcases/kernel/io/ltp-aiodio/aio-stress.c
+++ b/testcases/kernel/io/ltp-aiodio/aio-stress.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2004 SuSE, Inc.  All Rights Reserved.
  *               Written by: Chris Mason <mason@suse.com>
diff --git a/testcases/kernel/io/ltp-aiodio/common.h b/testcases/kernel/io/ltp-aiodio/common.h
index 200bbe18e..9a2d27166 100644
--- a/testcases/kernel/io/ltp-aiodio/common.h
+++ b/testcases/kernel/io/ltp-aiodio/common.h
@@ -62,8 +62,12 @@ static inline void io_read(const char *filename, int filesize, volatile int *run
 	int i;
 	int r;
 
-	while ((fd = open(filename, O_RDONLY, 0666)) < 0)
+	while ((fd = open(filename, O_RDONLY, 0666)) < 0) {
+		if (!*run_child)
+			return;
+
 		usleep(100);
+	}
 
 	tst_res(TINFO, "child %i reading file", getpid());
 
@@ -102,8 +106,12 @@ static inline void io_read_eof(const char *filename, volatile int *run_child)
 	int fd;
 	int r;
 
-	while ((fd = open(filename, O_RDONLY, 0666)) < 0)
+	while ((fd = open(filename, O_RDONLY, 0666)) < 0) {
+		if (!*run_child)
+			return;
+
 		usleep(100);
+	}
 
 	tst_res(TINFO, "child %i reading file", getpid());
 
diff --git a/testcases/kernel/io/ltp-aiodio/dio_append.c b/testcases/kernel/io/ltp-aiodio/dio_append.c
index 057ae73d9..0ecb76e2f 100644
--- a/testcases/kernel/io/ltp-aiodio/dio_append.c
+++ b/testcases/kernel/io/ltp-aiodio/dio_append.c
@@ -33,7 +33,7 @@ static void setup(void)
 {
 	numchildren = 16;
 	writesize = 64 * 1024;
-	appends = 1000;
+	appends = 10000;
 
 	if (tst_parse_int(str_numchildren, &numchildren, 1, INT_MAX))
 		tst_brk(TBROK, "Invalid number of children '%s'", str_numchildren);
@@ -44,6 +44,9 @@ static void setup(void)
 	if (tst_parse_int(str_appends, &appends, 1, INT_MAX))
 		tst_brk(TBROK, "Invalid number of appends '%s'", str_appends);
 
+	if (!tst_fs_has_free(".", appends, writesize))
+		tst_brk(TCONF, "Not enough space to run the test");
+
 	run_child = SAFE_MMAP(NULL, sizeof(int), PROT_READ | PROT_WRITE, MAP_SHARED | MAP_ANONYMOUS, -1, 0);
 }
 
@@ -97,7 +100,7 @@ static struct tst_test test = {
 	.options = (struct tst_option[]) {
 		{"n:", &str_numchildren, "Number of processes (default 16)"},
 		{"w:", &str_writesize, "Write size for each append (default 64K)"},
-		{"c:", &str_appends, "Number of appends (default 1000)"},
+		{"c:", &str_appends, "Number of appends (default 10000)"},
 		{}
 	},
 	.skip_filesystems = (const char *[]) {
diff --git a/testcases/kernel/kvm/.gitignore b/testcases/kernel/kvm/.gitignore
index 9638a6fc7..661472cae 100644
--- a/testcases/kernel/kvm/.gitignore
+++ b/testcases/kernel/kvm/.gitignore
@@ -2,3 +2,4 @@
 /kvm_svm01
 /kvm_svm02
 /kvm_svm03
+/kvm_svm04
diff --git a/testcases/kernel/kvm/Makefile b/testcases/kernel/kvm/Makefile
index ce4a5ede2..07bdd9705 100644
--- a/testcases/kernel/kvm/Makefile
+++ b/testcases/kernel/kvm/Makefile
@@ -24,6 +24,10 @@ endif
 ifeq ($(HOST_CPU),x86)
 	GUEST_CFLAGS += -m32
 	ASFLAGS += --32
+
+	ifdef LTP_CFLAGS_FFIXED_EBP
+		GUEST_CFLAGS += -ffixed-ebp
+	endif
 endif
 
 # Some distros enable -pie by default. That breaks KVM payload linking.
diff --git a/testcases/kernel/kvm/include/kvm_guest.h b/testcases/kernel/kvm/include/kvm_guest.h
index 96f246155..0eabfb9a0 100644
--- a/testcases/kernel/kvm/include/kvm_guest.h
+++ b/testcases/kernel/kvm/include/kvm_guest.h
@@ -8,6 +8,8 @@
 #ifndef KVM_GUEST_H_
 #define KVM_GUEST_H_
 
+#include <stdarg.h>
+
 /* The main LTP include dir is intentionally excluded during payload build */
 #include "../../../../include/tst_res_flags.h"
 #undef TERRNO
@@ -49,6 +51,11 @@ void *memcpy(void *dest, const void *src, size_t size);
 char *strcpy(char *dest, const char *src);
 char *strcat(char *dest, const char *src);
 size_t strlen(const char *str);
+char *strchr(const char *s, int c);
+char *strrchr(const char *s, int c);
+
+int vsprintf(char *dest, const char *fmt, va_list ap);
+int sprintf(char *dest, const char *fmt, ...);
 
 /* Exit the VM by looping on a HLT instruction forever */
 void kvm_exit(void) __attribute__((noreturn));
@@ -57,12 +64,16 @@ void kvm_exit(void) __attribute__((noreturn));
 void kvm_yield(void);
 
 void tst_res_(const char *file, const int lineno, int result,
-	const char *message);
-#define tst_res(result, msg) tst_res_(__FILE__, __LINE__, (result), (msg))
+	const char *fmt, ...)
+	__attribute__ ((format (printf, 4, 5)));
+#define tst_res(result, fmt, ...) \
+	tst_res_(__FILE__, __LINE__, (result), (fmt), ##__VA_ARGS__)
 
 void tst_brk_(const char *file, const int lineno, int result,
-	const char *message) __attribute__((noreturn));
-#define tst_brk(result, msg) tst_brk_(__FILE__, __LINE__, (result), (msg))
+	const char *fmt, ...) __attribute__((noreturn))
+	__attribute__ ((format (printf, 4, 5)));
+#define tst_brk(result, fmt, ...) \
+	tst_brk_(__FILE__, __LINE__, (result), (fmt), ##__VA_ARGS__)
 
 /*
  * Send asynchronous notification to host without stopping VM execution and
diff --git a/testcases/kernel/kvm/include/kvm_x86.h b/testcases/kernel/kvm/include/kvm_x86.h
index bc36c0e0f..08d3f6759 100644
--- a/testcases/kernel/kvm/include/kvm_x86.h
+++ b/testcases/kernel/kvm/include/kvm_x86.h
@@ -68,7 +68,17 @@
 
 
 /* Model-specific CPU register constants */
+#define MSR_SYSENTER_CS 0x174
+#define MSR_SYSENTER_ESP 0x175
+#define MSR_SYSENTER_EIP 0x176
 #define MSR_EFER 0xc0000080
+#define MSR_STAR 0xc0000081
+#define MSR_LSTAR 0xc0000082
+#define MSR_CSTAR 0xc0000083
+#define MSR_SFMASK 0xc0000084
+#define MSR_FS_BASE 0xc0000100
+#define MSR_GS_BASE 0xc0000101
+#define MSR_KERNEL_GS_BASE 0xc0000102
 #define MSR_VM_CR 0xc0010114
 #define MSR_VM_HSAVE_PA 0xc0010117
 
diff --git a/testcases/kernel/kvm/include/kvm_x86_svm.h b/testcases/kernel/kvm/include/kvm_x86_svm.h
index b4b1b80e2..73563ed2d 100644
--- a/testcases/kernel/kvm/include/kvm_x86_svm.h
+++ b/testcases/kernel/kvm/include/kvm_x86_svm.h
@@ -163,4 +163,10 @@ struct kvm_svm_vcpu *kvm_create_svm_vcpu(int (*guest_main)(void),
 
 void kvm_svm_vmrun(struct kvm_svm_vcpu *cpu);
 
+/* Load FS, GS, TR and LDTR state from vmsave_buf */
+void kvm_svm_vmload(struct kvm_vmcb *buf);
+
+/* Save current FS, GS, TR and LDTR state to vmsave_buf */
+void kvm_svm_vmsave(struct kvm_vmcb *buf);
+
 #endif /* KVM_X86_SVM_H_ */
diff --git a/testcases/kernel/kvm/kvm_svm02.c b/testcases/kernel/kvm/kvm_svm02.c
index 5d2e2ce37..6914fdcba 100644
--- a/testcases/kernel/kvm/kvm_svm02.c
+++ b/testcases/kernel/kvm/kvm_svm02.c
@@ -33,22 +33,14 @@ static void *vmsave_buf;
 /* Load FS, GS, TR and LDTR state from vmsave_buf */
 static int guest_vmload(void)
 {
-	asm (
-		"vmload %0\n"
-		:
-		: "a" (vmsave_buf)
-	);
+	kvm_svm_vmload(vmsave_buf);
 	return 0;
 }
 
 /* Save current FS, GS, TR and LDTR state to vmsave_buf */
 static int guest_vmsave(void)
 {
-	asm (
-		"vmsave %0\n"
-		:
-		: "a" (vmsave_buf)
-	);
+	kvm_svm_vmsave(vmsave_buf);
 	return 0;
 }
 
@@ -96,7 +88,7 @@ void main(void)
 	vmsave_buf = kvm_alloc_vmcb();
 
 	/* Save allocated stack for later VM reinit */
-	ss = vcpu->vmcb->ss.selector;
+	ss = vcpu->vmcb->ss.selector >> 3;
 	rsp = vcpu->vmcb->rsp;
 
 	/* Load partial state from vmsave_buf and save it to vcpu->vmcb */
diff --git a/testcases/kernel/kvm/kvm_svm04.c b/testcases/kernel/kvm/kvm_svm04.c
new file mode 100644
index 000000000..e69f0d4be
--- /dev/null
+++ b/testcases/kernel/kvm/kvm_svm04.c
@@ -0,0 +1,307 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (C) 2023 SUSE LLC <mdoucha@suse.cz>
+ */
+
+/*\
+ * [Description]
+ *
+ * Functional test for VMSAVE/VMLOAD instructions in KVM environment. Verify
+ * that both instructions save/load the CPU state according to CPU
+ * documentation.
+ */
+
+#include "kvm_test.h"
+
+#ifdef COMPILE_PAYLOAD
+#if defined(__i386__) || defined(__x86_64__)
+
+#include "kvm_x86_svm.h"
+
+static struct kvm_vmcb *src_vmcb, *dest_vmcb, *msr_vmcb;
+static struct kvm_sregs sregs_buf;
+
+static int check_descriptor(const char *name,
+	const struct kvm_vmcb_descriptor *data,
+	const struct kvm_vmcb_descriptor *exp)
+{
+	int ret = 0;
+
+	if (data->selector != exp->selector) {
+		tst_res(TFAIL, "%s.selector = %hx (expected %hx)",
+			name, data->selector, exp->selector);
+		ret = 1;
+	}
+
+	if (data->attrib != exp->attrib) {
+		tst_res(TFAIL, "%s.attrib = 0x%hx (expected 0x%hx)",
+			name, data->attrib, exp->attrib);
+		ret = 1;
+	}
+
+	if (data->limit != exp->limit) {
+		tst_res(TFAIL, "%s.limit = 0x%x (expected 0x%x)",
+			name, data->limit, exp->limit);
+		ret = 1;
+	}
+
+	if (data->base != exp->base) {
+		tst_res(TFAIL, "%s.base = 0x%llx (expected 0x%llx)",
+			name, data->base, exp->base);
+		ret = 1;
+	}
+
+	return ret;
+}
+
+static int check_value(const char *name, uint64_t val, uint64_t exp,
+	uint64_t backup, uint64_t reg, uint64_t nested_val)
+{
+	int ret = 0;
+
+	if (exp != backup) {
+		tst_res(TFAIL, "%s source was modified (0x%llx != 0x%llx)",
+			name, exp, backup);
+		ret = 1;
+	}
+
+	if (reg != exp) {
+		tst_res(TFAIL, "%s was not loaded (0x%llx != 0x%llx)",
+			name, reg, exp);
+		ret = 1;
+	}
+
+	if (val != exp) {
+		tst_res(TFAIL, "%s was not saved (0x%llx != 0x%llx)",
+			name, val, exp);
+		ret = 1;
+	}
+
+	if (val != nested_val) {
+		tst_res(TFAIL, "Inconsistent %s on VM exit (0x%llx != 0x%llx)",
+			name, val, nested_val);
+		ret = 1;
+	}
+
+	if (!ret)
+		tst_res(TPASS, "%s has correct value 0x%llx", name, val);
+
+	return ret;
+}
+
+static int vmsave_copy(void)
+{
+	kvm_svm_vmload(src_vmcb);
+	kvm_read_sregs(&sregs_buf);
+	msr_vmcb->star = kvm_rdmsr(MSR_STAR);
+	msr_vmcb->lstar = kvm_rdmsr(MSR_LSTAR);
+	msr_vmcb->cstar = kvm_rdmsr(MSR_CSTAR);
+	msr_vmcb->sfmask = kvm_rdmsr(MSR_SFMASK);
+	msr_vmcb->fs.base = kvm_rdmsr(MSR_FS_BASE);
+	msr_vmcb->gs.base = kvm_rdmsr(MSR_GS_BASE);
+	msr_vmcb->kernel_gs_base = kvm_rdmsr(MSR_KERNEL_GS_BASE);
+	msr_vmcb->sysenter_cs = kvm_rdmsr(MSR_SYSENTER_CS);
+	msr_vmcb->sysenter_esp = kvm_rdmsr(MSR_SYSENTER_ESP);
+	msr_vmcb->sysenter_eip = kvm_rdmsr(MSR_SYSENTER_EIP);
+	kvm_svm_vmsave(dest_vmcb);
+	return 0;
+}
+
+static int check_vmsave_result(struct kvm_vmcb *copy_vmcb,
+	struct kvm_vmcb *nested_vmcb)
+{
+	int ret = 0;
+
+	/* Nested VMCB is only compared to dest VMCB, bypass the check */
+	if (!nested_vmcb)
+		nested_vmcb = dest_vmcb;
+
+	ret = check_descriptor("FS", &dest_vmcb->fs, &src_vmcb->fs);
+	ret = check_value("FS.selector", dest_vmcb->fs.selector,
+		src_vmcb->fs.selector, copy_vmcb->fs.selector,
+		sregs_buf.fs, nested_vmcb->fs.selector) || ret;
+	ret = check_descriptor("GS", &dest_vmcb->gs, &src_vmcb->gs) || ret;
+	ret = check_value("GS.selector", dest_vmcb->gs.selector,
+		src_vmcb->gs.selector, copy_vmcb->gs.selector,
+		sregs_buf.gs, nested_vmcb->gs.selector) || ret;
+	ret = check_descriptor("LDTR", &dest_vmcb->ldtr, &src_vmcb->ldtr) ||
+		ret;
+	ret = check_descriptor("TR", &dest_vmcb->tr, &src_vmcb->tr) || ret;
+	ret = check_value("STAR", dest_vmcb->star, src_vmcb->star,
+		copy_vmcb->star, msr_vmcb->star, nested_vmcb->star) || ret;
+	ret = check_value("LSTAR", dest_vmcb->lstar, src_vmcb->lstar,
+		copy_vmcb->lstar, msr_vmcb->lstar, nested_vmcb->lstar) || ret;
+	ret = check_value("CSTAR", dest_vmcb->cstar, src_vmcb->cstar,
+		copy_vmcb->cstar, msr_vmcb->cstar, nested_vmcb->cstar) || ret;
+	ret = check_value("SFMASK", dest_vmcb->sfmask, src_vmcb->sfmask,
+		copy_vmcb->sfmask, msr_vmcb->sfmask, nested_vmcb->sfmask) ||
+		ret;
+	ret = check_value("FS.base", dest_vmcb->fs.base, src_vmcb->fs.base,
+		copy_vmcb->fs.base, msr_vmcb->fs.base, nested_vmcb->fs.base) ||
+		ret;
+	ret = check_value("GS.base", dest_vmcb->gs.base, src_vmcb->gs.base,
+		copy_vmcb->gs.base, msr_vmcb->gs.base, nested_vmcb->gs.base) ||
+		ret;
+	ret = check_value("KernelGSBase", dest_vmcb->kernel_gs_base,
+		src_vmcb->kernel_gs_base, copy_vmcb->kernel_gs_base,
+		msr_vmcb->kernel_gs_base, nested_vmcb->kernel_gs_base) || ret;
+	ret = check_value("Sysenter_CS", dest_vmcb->sysenter_cs,
+		src_vmcb->sysenter_cs, copy_vmcb->sysenter_cs,
+		msr_vmcb->sysenter_cs, nested_vmcb->sysenter_cs) || ret;
+	ret = check_value("Sysenter_ESP", dest_vmcb->sysenter_esp,
+		src_vmcb->sysenter_esp, copy_vmcb->sysenter_esp,
+		msr_vmcb->sysenter_esp, nested_vmcb->sysenter_esp) || ret;
+	ret = check_value("Sysenter_EIP", dest_vmcb->sysenter_eip,
+		src_vmcb->sysenter_eip, copy_vmcb->sysenter_eip,
+		msr_vmcb->sysenter_eip, nested_vmcb->sysenter_eip) || ret;
+
+	return ret;
+}
+
+static int create_segment_descriptor(uint64_t baseaddr, uint32_t limit,
+	unsigned int flags)
+{
+	int ret = kvm_find_free_descriptor(kvm_gdt, KVM_GDT_SIZE);
+
+	if (ret < 0)
+		tst_brk(TBROK, "Descriptor table is full");
+
+	kvm_set_segment_descriptor(kvm_gdt + ret, baseaddr, limit, flags);
+	return ret;
+}
+
+static void dirty_vmcb(struct kvm_vmcb *buf)
+{
+	buf->fs.selector = 0x60;
+	buf->fs.attrib = SEGTYPE_RWDATA | SEGFLAG_PRESENT;
+	buf->fs.limit = 0xffff;
+	buf->fs.base = 0xfff000;
+	buf->gs.selector = 0x68;
+	buf->gs.attrib = SEGTYPE_RWDATA | SEGFLAG_PRESENT;
+	buf->gs.limit = 0xffff;
+	buf->gs.base = 0xfff000;
+	buf->ldtr.selector = 0x70;
+	buf->ldtr.attrib = SEGTYPE_LDT | SEGFLAG_PRESENT;
+	buf->ldtr.limit = 0xffff;
+	buf->ldtr.base = 0xfff000;
+	buf->tr.selector = 0x78;
+	buf->tr.attrib = SEGTYPE_TSS | SEGFLAG_PRESENT;
+	buf->tr.limit = 0xffff;
+	buf->tr.base = 0xfff000;
+	buf->star = 0xffff;
+	buf->lstar = 0xffff;
+	buf->cstar = 0xffff;
+	buf->sfmask = 0xffff;
+	buf->fs.base = 0xffff;
+	buf->gs.base = 0xffff;
+	buf->kernel_gs_base = 0xffff;
+	buf->sysenter_cs = 0xffff;
+	buf->sysenter_esp = 0xffff;
+	buf->sysenter_eip = 0xffff;
+}
+
+void main(void)
+{
+	uint16_t ss;
+	uint64_t rsp;
+	struct kvm_svm_vcpu *vcpu;
+	int data_seg1, data_seg2, ldt_seg, task_seg;
+	struct segment_descriptor *ldt;
+	struct kvm_vmcb *backup_vmcb, *zero_vmcb;
+	unsigned int ldt_size = KVM_GDT_SIZE*sizeof(struct segment_descriptor);
+
+	kvm_init_svm();
+
+	src_vmcb = kvm_alloc_vmcb();
+	dest_vmcb = kvm_alloc_vmcb();
+	msr_vmcb = kvm_alloc_vmcb();
+	backup_vmcb = kvm_alloc_vmcb();
+	zero_vmcb = kvm_alloc_vmcb();
+
+	vcpu = kvm_create_svm_vcpu(vmsave_copy, 1);
+	kvm_vmcb_set_intercept(vcpu->vmcb, SVM_INTERCEPT_VMLOAD, 0);
+	kvm_vmcb_set_intercept(vcpu->vmcb, SVM_INTERCEPT_VMSAVE, 0);
+	/* Save allocated stack for later VM reinit */
+	ss = vcpu->vmcb->ss.selector >> 3;
+	rsp = vcpu->vmcb->rsp;
+
+	ldt = tst_heap_alloc_aligned(ldt_size, 8);
+	memset(ldt, 0, ldt_size);
+	data_seg1 = create_segment_descriptor(0xda7a1000, 0x1000,
+		SEGTYPE_RODATA | SEGFLAG_PRESENT);
+	data_seg2 = create_segment_descriptor(0xda7a2000, 2,
+		SEGTYPE_RWDATA | SEGFLAG_PRESENT | SEGFLAG_PAGE_LIMIT);
+	ldt_seg = create_segment_descriptor((uintptr_t)ldt, ldt_size,
+		SEGTYPE_LDT | SEGFLAG_PRESENT);
+	task_seg = create_segment_descriptor(0x7a53000, 0x1000,
+		SEGTYPE_TSS | SEGFLAG_PRESENT);
+	kvm_vmcb_copy_gdt_descriptor(&src_vmcb->fs, data_seg1);
+	kvm_vmcb_copy_gdt_descriptor(&src_vmcb->gs, data_seg2);
+	kvm_vmcb_copy_gdt_descriptor(&src_vmcb->ldtr, ldt_seg);
+	kvm_vmcb_copy_gdt_descriptor(&src_vmcb->tr, task_seg);
+
+	src_vmcb->star = 0x5742;
+	src_vmcb->lstar = 0x15742;
+	src_vmcb->cstar = 0xc5742;
+	src_vmcb->sfmask = 0xf731;
+	src_vmcb->fs.base = 0xf000;
+	src_vmcb->gs.base = 0x10000;
+	src_vmcb->kernel_gs_base = 0x20000;
+	src_vmcb->sysenter_cs = 0x595c5;
+	src_vmcb->sysenter_esp = 0x595e50;
+	src_vmcb->sysenter_eip = 0x595e10;
+
+	memcpy(backup_vmcb, src_vmcb, sizeof(struct kvm_vmcb));
+	tst_res(TINFO, "VMLOAD/VMSAVE non-zero values");
+	vmsave_copy();
+	check_vmsave_result(backup_vmcb, NULL);
+
+	memset(src_vmcb, 0, sizeof(struct kvm_vmcb));
+	tst_res(TINFO, "VMLOAD/VMSAVE zero values");
+	dirty_vmcb(dest_vmcb);
+	vmsave_copy();
+	check_vmsave_result(zero_vmcb, NULL);
+
+	memcpy(src_vmcb, backup_vmcb, sizeof(struct kvm_vmcb));
+	tst_res(TINFO, "Nested VMLOAD/VMSAVE non-zero values");
+	dirty_vmcb(vcpu->vmcb);
+	memset(dest_vmcb, 0, sizeof(struct kvm_vmcb));
+	kvm_svm_vmrun(vcpu);
+
+	if (vcpu->vmcb->exitcode != SVM_EXIT_HLT)
+		tst_brk(TBROK, "Nested VM exited unexpectedly");
+
+	check_vmsave_result(backup_vmcb, vcpu->vmcb);
+
+	memset(src_vmcb, 0, sizeof(struct kvm_vmcb));
+	tst_res(TINFO, "Nested VMLOAD/VMSAVE zero values");
+	kvm_init_guest_vmcb(vcpu->vmcb, 1, ss, (void *)rsp, vmsave_copy);
+	kvm_vmcb_set_intercept(vcpu->vmcb, SVM_INTERCEPT_VMLOAD, 0);
+	kvm_vmcb_set_intercept(vcpu->vmcb, SVM_INTERCEPT_VMSAVE, 0);
+	dirty_vmcb(vcpu->vmcb);
+	kvm_svm_vmrun(vcpu);
+
+	if (vcpu->vmcb->exitcode != SVM_EXIT_HLT)
+		tst_brk(TBROK, "Nested VM exited unexpectedly");
+
+	check_vmsave_result(zero_vmcb, vcpu->vmcb);
+}
+
+#else /* defined(__i386__) || defined(__x86_64__) */
+TST_TEST_TCONF("Test supported only on x86");
+#endif /* defined(__i386__) || defined(__x86_64__) */
+
+#else /* COMPILE_PAYLOAD */
+
+static struct tst_test test = {
+	.test_all = tst_kvm_run,
+	.setup = tst_kvm_setup,
+	.cleanup = tst_kvm_cleanup,
+	.supported_archs = (const char *const []) {
+		"x86_64",
+		"x86",
+		NULL
+	},
+};
+
+#endif /* COMPILE_PAYLOAD */
diff --git a/testcases/kernel/kvm/lib_guest.c b/testcases/kernel/kvm/lib_guest.c
index f3e21d3d6..2e3e9cb6e 100644
--- a/testcases/kernel/kvm/lib_guest.c
+++ b/testcases/kernel/kvm/lib_guest.c
@@ -76,6 +76,74 @@ size_t strlen(const char *str)
 	return ret;
 }
 
+char *strchr(const char *s, int c)
+{
+	for (; *s; s++) {
+		if (*s == c)
+			return (char *)s;
+	}
+
+	return NULL;
+}
+
+char *strrchr(const char *s, int c)
+{
+	const char *ret = NULL;
+
+	for (; *s; s++) {
+		if (*s == c)
+			ret = s;
+	}
+
+	return (char *)ret;
+}
+
+#if defined(__x86_64__) && !defined(__ILP32__)
+uint64_t u64divu16(uint64_t a, uint16_t b)
+{
+	return a / b;
+}
+
+unsigned int u64modu16(uint64_t a, uint16_t b)
+{
+	return a % b;
+}
+
+#else /* defined(__x86_64__) && !defined(__ILP32__) */
+
+/* u64 short division helpers to avoid need to link libgcc on 32bit archs */
+uint64_t u64divu16(uint64_t a, uint16_t b)
+{
+	uint64_t ret = 0;
+	uint32_t tmp = a >> 32;
+
+	ret = tmp / b;
+	ret <<= 32;
+	tmp %= b;
+	tmp <<= 16;
+	tmp |= (a >> 16) & 0xffff;
+	ret |= (tmp / b) << 16;
+	tmp %= b;
+	tmp <<= 16;
+	tmp |= a & 0xffff;
+	ret |= tmp / b;
+	return ret;
+}
+
+unsigned int u64modu16(uint64_t a, uint16_t b)
+{
+	uint32_t tmp = a >> 32;
+
+	tmp %= b;
+	tmp <<= 16;
+	tmp |= (a >> 16) & 0xffff;
+	tmp %= b;
+	tmp <<= 16;
+	tmp |= a & 0xffff;
+	return tmp % b;
+}
+#endif /* defined(__x86_64__) && !defined(__ILP32__) */
+
 char *ptr2hex(char *dest, uintptr_t val)
 {
 	unsigned int i;
@@ -95,6 +163,250 @@ char *ptr2hex(char *dest, uintptr_t val)
 	return ret;
 }
 
+char *u64tostr(char *dest, uint64_t val, uint16_t base, int caps)
+{
+	unsigned int i;
+	uintptr_t tmp = u64divu16(val, base);
+	char hex = caps ? 'A' : 'a';
+	char *ret = dest;
+
+	for (i = 1; tmp; i++, tmp = u64divu16(tmp, base))
+		;
+
+	dest[i] = '\0';
+
+	do {
+		tmp = u64modu16(val, base);
+		dest[--i] = tmp + (tmp >= 10 ? hex - 10 : '0');
+		val = u64divu16(val, base);
+	} while (i);
+
+	return ret;
+}
+
+char *i64tostr(char *dest, int64_t val)
+{
+	if (val < 0) {
+		dest[0] = '-';
+		u64tostr(dest + 1, -val, 10, 0);
+		return dest;
+	}
+
+	return u64tostr(dest, val, 10, 0);
+}
+
+int vsprintf(char *dest, const char *fmt, va_list ap)
+{
+	va_list args;
+	int ret = 0;
+	char conv;
+	uint64_t u64val = 0;
+	int64_t i64val = 0;
+	const char * const uint_conv = "ouxX";
+
+	va_copy(args, ap);
+
+	for (; *fmt; fmt++) {
+		if (*fmt != '%') {
+			dest[ret++] = *fmt;
+			continue;
+		}
+
+		conv = 0;
+		fmt++;
+
+		switch (*fmt) {
+		case '%':
+			dest[ret++] = *fmt;
+			break;
+
+		case 'c':
+			dest[ret++] = va_arg(args, int);
+			break;
+
+		case 's':
+			strcpy(dest + ret, va_arg(args, const char *));
+			ret += strlen(dest + ret);
+			break;
+
+		case 'p':
+			strcpy(dest + ret, "0x");
+			ptr2hex(dest + ret + 2,
+				(uintptr_t)va_arg(args, void *));
+			ret += strlen(dest + ret);
+			break;
+
+		case 'l':
+			fmt++;
+
+			switch (*fmt) {
+			case 'l':
+				fmt++;
+
+				if (*fmt == 'd' || *fmt == 'i') {
+					i64val = va_arg(args, long long);
+					conv = *fmt;
+					break;
+				}
+
+				if (strchr(uint_conv, *fmt)) {
+					u64val = va_arg(args,
+						unsigned long long);
+					conv = *fmt;
+					break;
+				}
+
+				va_end(args);
+				return -1;
+
+			case 'd':
+			case 'i':
+				i64val = va_arg(args, long);
+				conv = *fmt;
+				break;
+
+			default:
+				if (strchr(uint_conv, *fmt)) {
+					u64val = va_arg(args,
+						unsigned long);
+					conv = *fmt;
+					break;
+				}
+
+				va_end(args);
+				return -1;
+			}
+			break;
+
+		case 'h':
+			fmt++;
+
+			switch (*fmt) {
+			case 'h':
+				fmt++;
+
+				if (*fmt == 'd' || *fmt == 'i') {
+					i64val = (signed char)va_arg(args, int);
+					conv = *fmt;
+					break;
+				}
+
+				if (strchr(uint_conv, *fmt)) {
+					u64val = (unsigned char)va_arg(args,
+						unsigned int);
+					conv = *fmt;
+					break;
+				}
+
+				va_end(args);
+				return -1;
+
+			case 'd':
+			case 'i':
+				i64val = (short int)va_arg(args, int);
+				conv = *fmt;
+				break;
+
+			default:
+				if (strchr(uint_conv, *fmt)) {
+					u64val = (unsigned short int)va_arg(
+						args, unsigned int);
+					conv = *fmt;
+					break;
+				}
+
+				va_end(args);
+				return -1;
+			}
+			break;
+
+		case 'z':
+			fmt++;
+
+			if (*fmt == 'd' || *fmt == 'i') {
+				i64val = va_arg(args, ssize_t);
+				conv = *fmt;
+				break;
+			}
+
+			if (strchr(uint_conv, *fmt)) {
+				u64val = va_arg(args, size_t);
+				conv = *fmt;
+				break;
+			}
+
+			va_end(args);
+			return -1;
+
+		case 'd':
+		case 'i':
+			i64val = va_arg(args, int);
+			conv = *fmt;
+			break;
+
+		default:
+			if (strchr(uint_conv, *fmt)) {
+				u64val = va_arg(args, unsigned int);
+				conv = *fmt;
+				break;
+			}
+
+			va_end(args);
+			return -1;
+		}
+
+		switch (conv) {
+		case 0:
+			continue;
+
+		case 'd':
+		case 'i':
+			i64tostr(dest + ret, i64val);
+			ret += strlen(dest + ret);
+			break;
+
+		case 'o':
+			u64tostr(dest + ret, u64val, 8, 0);
+			ret += strlen(dest + ret);
+			break;
+
+		case 'u':
+			u64tostr(dest + ret, u64val, 10, 0);
+			ret += strlen(dest + ret);
+			break;
+
+		case 'x':
+			u64tostr(dest + ret, u64val, 16, 0);
+			ret += strlen(dest + ret);
+			break;
+
+		case 'X':
+			u64tostr(dest + ret, u64val, 16, 1);
+			ret += strlen(dest + ret);
+			break;
+
+		default:
+			va_end(args);
+			return -1;
+		}
+	}
+
+	va_end(args);
+	dest[ret++] = '\0';
+	return ret;
+}
+
+int sprintf(char *dest, const char *fmt, ...)
+{
+	va_list args;
+	int ret;
+
+	va_start(args, fmt);
+	ret = vsprintf(dest, fmt, args);
+	va_end(args);
+	return ret;
+}
+
 void *tst_heap_alloc_aligned(size_t size, size_t align)
 {
 	uintptr_t addr = (uintptr_t)heap_end;
@@ -131,6 +443,7 @@ static void tst_fatal_error(const char *file, const int lineno,
 	test_result->result = TBROK;
 	test_result->lineno = lineno;
 	test_result->file_addr = (uintptr_t)file;
+	/* Avoid sprintf() here in case of bugs */
 	strcpy(test_result->message, message);
 	strcat(test_result->message, " at address 0x");
 	ptr2hex(test_result->message + strlen(test_result->message), ip);
@@ -139,19 +452,46 @@ static void tst_fatal_error(const char *file, const int lineno,
 }
 
 void tst_res_(const char *file, const int lineno, int result,
-	const char *message)
+	const char *fmt, ...)
 {
+	va_list args;
+	int ret;
+
+	va_start(args, fmt);
 	test_result->result = result;
 	test_result->lineno = lineno;
 	test_result->file_addr = (uintptr_t)file;
-	strcpy(test_result->message, message);
+	ret = vsprintf(test_result->message, fmt, args);
+	va_end(args);
+
+	if (ret < 0) {
+		tst_brk_(file, lineno, TBROK, "Invalid tst_res() format: %s",
+			fmt);
+	}
+
 	kvm_yield();
 }
 
 void tst_brk_(const char *file, const int lineno, int result,
-	const char *message)
+	const char *fmt, ...)
 {
-	tst_res_(file, lineno, result, message);
+	va_list args;
+	int ret;
+
+	va_start(args, fmt);
+	test_result->result = result;
+	test_result->lineno = lineno;
+	test_result->file_addr = (uintptr_t)file;
+	ret = vsprintf(test_result->message, fmt, args);
+	va_end(args);
+
+	if (ret < 0) {
+		test_result->result = TBROK;
+		strcpy(test_result->message, "Invalid tst_brk() format: ");
+		strcat(test_result->message, fmt);
+	}
+
+	kvm_yield();
 	kvm_exit();
 }
 
diff --git a/testcases/kernel/kvm/lib_x86.c b/testcases/kernel/kvm/lib_x86.c
index 3e6656f11..8db3abd3f 100644
--- a/testcases/kernel/kvm/lib_x86.c
+++ b/testcases/kernel/kvm/lib_x86.c
@@ -174,7 +174,7 @@ int kvm_find_free_descriptor(const struct segment_descriptor *table,
 	const struct segment_descriptor *ptr;
 	size_t i;
 
-	for (i = 0, ptr = table; i < size; i++, ptr++) {
+	for (i = 1, ptr = table + 1; i < size; i++, ptr++) {
 		if (!(ptr->flags_lo & SEGFLAG_PRESENT))
 			return i;
 
@@ -393,3 +393,21 @@ struct kvm_svm_vcpu *kvm_create_svm_vcpu(int (*guest_main)(void),
 	ret->vmcb = vmcb;
 	return ret;
 }
+
+void kvm_svm_vmload(struct kvm_vmcb *buf)
+{
+	asm (
+		"vmload %0\n"
+		:
+		: "a" (buf)
+	);
+}
+
+void kvm_svm_vmsave(struct kvm_vmcb *buf)
+{
+	asm (
+		"vmsave %0\n"
+		:
+		: "a" (buf)
+	);
+}
diff --git a/testcases/kernel/mem/hugetlb/hugemmap/hugemmap15.c b/testcases/kernel/mem/hugetlb/hugemmap/hugemmap15.c
index 4d1984070..a84ba6476 100644
--- a/testcases/kernel/mem/hugetlb/hugemmap/hugemmap15.c
+++ b/testcases/kernel/mem/hugetlb/hugemmap/hugemmap15.c
@@ -47,7 +47,7 @@ static void cacheflush(void *p)
 {
 #if defined(__powerpc__)
 	asm volatile("dcbst 0,%0; sync; icbi 0,%0; isync" : : "r"(p));
-#elif defined(__arm__) || defined(__aarch64__)
+#elif defined(__arm__) || defined(__aarch64__) || defined(__riscv)
 	__clear_cache(p, p + COPY_SIZE);
 #else
 	(void)p;
diff --git a/testcases/kernel/mem/hugetlb/hugemmap/hugemmap24.c b/testcases/kernel/mem/hugetlb/hugemmap/hugemmap24.c
index 431dc1bbf..3ba0985dc 100644
--- a/testcases/kernel/mem/hugetlb/hugemmap/hugemmap24.c
+++ b/testcases/kernel/mem/hugetlb/hugemmap/hugemmap24.c
@@ -42,7 +42,6 @@ static int init_slice_boundary(int fd)
 
 	/* dummy malloc so we know where is heap */
 	heap = malloc(1);
-	free(heap);
 
 	 /* Avoid underflow on systems with large huge pages.
 	  * The additionally plus heap address is to reduce the possibility
@@ -51,6 +50,8 @@ static int init_slice_boundary(int fd)
 	while (slice_boundary + slice_size < (unsigned long)heap + 2*hpage_size)
 		slice_boundary += slice_size;
 
+	free(heap);
+
 	/* Find 2 neighbour slices with couple huge pages free
 	 * around slice boundary.
 	 * 16 is the maximum number of slices (low/high)
diff --git a/testcases/kernel/mem/swapping/swapping01.c b/testcases/kernel/mem/swapping/swapping01.c
index a0030a75f..79dd2b4d5 100644
--- a/testcases/kernel/mem/swapping/swapping01.c
+++ b/testcases/kernel/mem/swapping/swapping01.c
@@ -47,6 +47,7 @@
 #define COE_DELTA       1
 /* will try to alloc 1.3 * phy_mem */
 #define COE_SLIGHT_OVER 0.3
+#define MEM_SIZE 1024 * 1024
 
 static void init_meminfo(void);
 static void do_alloc(int allow_raise);
@@ -101,6 +102,13 @@ static void init_meminfo(void)
 				swap_free_init, mem_over_max);
 }
 
+static void memset_blocks(char *ptr, int mem_count, int sleep_time_ms) {
+	for (int i = 0; i < mem_count / 1024; i++) {
+		memset(ptr + (i * MEM_SIZE), 1, MEM_SIZE);
+		usleep(sleep_time_ms * 1000);
+	}
+}
+
 static void do_alloc(int allow_raise)
 {
 	long mem_count;
@@ -115,7 +123,7 @@ static void do_alloc(int allow_raise)
 	if (allow_raise == 1)
 		tst_res(TINFO, "try to allocate: %ld MB", mem_count / 1024);
 	s = SAFE_MALLOC(mem_count * 1024);
-	memset(s, 1, mem_count * 1024);
+	memset_blocks(s, mem_count, 1);
 
 	if ((allow_raise == 1) && (raise(SIGSTOP) == -1)) {
 		tst_res(TINFO, "memory allocated: %ld MB", mem_count / 1024);
diff --git a/testcases/kernel/sched/sched_stress/sched_driver.c b/testcases/kernel/sched/sched_stress/sched_driver.c
index 61573d788..5b8c187fe 100644
--- a/testcases/kernel/sched/sched_stress/sched_driver.c
+++ b/testcases/kernel/sched/sched_stress/sched_driver.c
@@ -136,7 +136,7 @@ int debug = 0;
 /*
  * Function prototypes
  */
-void startup(long);
+void startup(time_t);
 int start_testcase(char *, char *, char *, char *, char *, char *);
 int process_slots_in_use();
 int available_user_process_slots();
@@ -251,7 +251,7 @@ int main(int argc, char **argv)
  * information to the screen and .  It also initializes the	 *
  * process id list and other global variables.	 			 *
  *-----------------------------------------------------------------------*/
-void startup(long start_time)
+void startup(time_t start_time)
 {
 	char tempbuffer[50];	/* temporary buffer to hold names */
 
@@ -734,7 +734,7 @@ void kill_short_term_testcases()
 void finishup(start_time)
 long start_time;		/* starting time to calculate elapsed time */
 {
-	long end_time;		/* time when program finished */
+	time_t end_time;		/* time when program finished */
 
 	/*
 	 * Get the end time and calculate elapsed time; write all this out
diff --git a/testcases/kernel/security/aslr/.gitignore b/testcases/kernel/security/aslr/.gitignore
new file mode 100644
index 000000000..a15f88c39
--- /dev/null
+++ b/testcases/kernel/security/aslr/.gitignore
@@ -0,0 +1 @@
+aslr01
diff --git a/testcases/kernel/security/aslr/Makefile b/testcases/kernel/security/aslr/Makefile
new file mode 100644
index 000000000..1457667c5
--- /dev/null
+++ b/testcases/kernel/security/aslr/Makefile
@@ -0,0 +1,10 @@
+# SPDX-License-Identifier: GPL-2.0-or-later
+# Copyright (c) 2024 Linux Test Project
+
+top_srcdir		?= ../../../..
+
+include $(top_srcdir)/include/mk/testcases.mk
+
+CFLAGS			+= -D_GNU_SOURCE
+
+include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/kernel/security/aslr/aslr01.c b/testcases/kernel/security/aslr/aslr01.c
new file mode 100644
index 000000000..4d3c9bcdd
--- /dev/null
+++ b/testcases/kernel/security/aslr/aslr01.c
@@ -0,0 +1,286 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (C) 2024 SUSE LLC <mdoucha@suse.cz>
+ */
+
+/*\
+ * [Description]
+ *
+ * Test that address space layout randomization (ASLR) is sufficiently random.
+ * A bug in dynamic library mmapping may reduce ASLR randomness if the library
+ * file is larger than hugepage size. In 32bit compat mode, this may
+ * completely disable ASLR and force large dynamic libraries to be loaded
+ * at fixed addresses.
+ *
+ * The issue may not be reproducible if hugepage support is missing or no
+ * sufficiently large library is loaded into the test program. If libc is not
+ * large enough, you may use `export LD_PRELOAD=...` to load another
+ * sufficiently large library. The export keyword is required because
+ * the checks are done on a subprocess.
+ *
+ * In normal mode, the test checks that library base address has a minimum
+ * number of random bits (configurable using the -b option). In strict mode,
+ * the test checks that library base address is aligned to regular pagesize
+ * (not hugepage) and the number of random bits is at least
+ * CONFIG_ARCH_MMAP_RND_BITS_MIN or the compat equivalent. The -b option is
+ * ignored.
+ */
+
+#include <unistd.h>
+#include <string.h>
+#include <stdio.h>
+#include <inttypes.h>
+#include <sys/wait.h>
+
+#include "tst_test.h"
+#include "tst_kernel.h"
+#include "tst_kconfig.h"
+#include "tst_safe_stdio.h"
+
+/* Indices for aslr_kconfigs[] below */
+#define ASLR_HAVE_COMPAT 0
+#define ASLR_MINBITS 1
+#define ASLR_COMPAT_MINBITS 2
+
+static int pagebits, minbits = 8;
+static char *minbits_str, *strict_check;
+static char lib_path[PATH_MAX];
+static FILE *ldd;
+
+static struct tst_kconfig_var aslr_kconfigs[] = {
+	TST_KCONFIG_INIT("CONFIG_HAVE_ARCH_MMAP_RND_COMPAT_BITS"),
+	TST_KCONFIG_INIT("CONFIG_ARCH_MMAP_RND_BITS_MIN"),
+	TST_KCONFIG_INIT("CONFIG_ARCH_MMAP_RND_COMPAT_BITS_MIN"),
+};
+
+static int count_align_bits(size_t val)
+{
+	int ret = 0;
+
+	for (; val && !(val & 0x1); val >>= 1, ret++)
+		;
+
+	return ret;
+}
+
+static int count_bits(size_t val)
+{
+	int ret = 0;
+
+	for (; val; val >>= 1) {
+		if (val & 1)
+			ret++;
+	}
+
+	return ret;
+}
+
+/* Extract library path and base address from a line of ldd output. */
+static int parse_mapping(const char *line, char *path, uint64_t *addr)
+{
+	int ret;
+
+	line = strchr(line, '/');
+
+	if (!line)
+		return 0;
+
+	ret = sscanf(line, "%s (0x%" PRIx64 ")", path, addr);
+	return ret >= 2;
+}
+
+/*
+ * Run ldd on the test executable and pass each library/address to callback.
+ * If the callback returns non-zero, the reader loop will immediately exit.
+ */
+static void read_shared_libraries(int (*callback)(void*, const char*, uint64_t),
+	void *arg)
+{
+	char line[PATH_MAX], path[PATH_MAX];
+	uint64_t addr;
+	int ret;
+
+	sprintf(path, "ldd /proc/%d/exe", getpid());
+	ldd = SAFE_POPEN(path, "r");
+
+	while (fgets(line, PATH_MAX, ldd)) {
+		if (*line && !feof(ldd) && line[strlen(line) - 1] != '\n')
+			tst_brk(TBROK, "Dynamic library entry too long");
+
+		if (!parse_mapping(line, path, &addr))
+			continue;
+
+		if (callback(arg, path, addr))
+			break;
+	}
+
+	while (fgets(line, PATH_MAX, ldd))
+		;
+
+	ret = pclose(ldd);
+	ldd = NULL;
+
+	if (!WIFEXITED(ret) || WEXITSTATUS(ret))
+		tst_brk(TBROK, "Reading dynamic libraries failed");
+}
+
+static int find_large_lib_callback(void *arg, const char *path,
+	uint64_t addr LTP_ATTRIBUTE_UNUSED)
+{
+	size_t *libsize = arg;
+	struct stat statbuf;
+
+	SAFE_STAT(path, &statbuf);
+
+	if (*libsize < (size_t)statbuf.st_size) {
+		strcpy(lib_path, path);
+		*libsize = statbuf.st_size;
+	}
+
+	return 0;
+}
+
+static void find_large_lib(void)
+{
+	size_t hpsize, libsize = 0;
+
+	read_shared_libraries(find_large_lib_callback, &libsize);
+
+	if (!libsize) {
+		tst_brk(TCONF,
+			"No dynamic libraries loaded, please use LD_PRELOAD");
+	}
+
+	hpsize = tst_get_hugepage_size();
+	tst_res(TINFO, "Largest loaded library: %s (%zu bytes)", lib_path,
+		libsize);
+
+	if (!hpsize) {
+		tst_res(TCONF, "Hugepage support appears to be missing");
+	} else if (libsize < hpsize) {
+		tst_res(TCONF, "The largest dynamic library is smaller than hugepage size, "
+				"please use LD_PRELOAD to add larger library");
+	}
+}
+
+static int get_lib_address_callback(void *arg, const char *path, uint64_t addr)
+{
+	uint64_t *out_addr = arg;
+
+	if (!strcmp(path, lib_path)) {
+		*out_addr = addr;
+		return 1;
+	}
+
+	return 0;
+}
+
+static void setup(void)
+{
+	int compat = tst_is_compat_mode();
+	const char *kconf_minbits, *minbits_path;
+
+	pagebits = count_align_bits(getpagesize());
+	tst_kconfig_read(aslr_kconfigs, ARRAY_SIZE(aslr_kconfigs));
+
+	if (compat && aslr_kconfigs[ASLR_HAVE_COMPAT].choice != 'y')
+		tst_brk(TCONF, "ASLR not supported in compat mode");
+
+	if (!strict_check && tst_parse_int(minbits_str, &minbits, 1, 64))
+		tst_brk(TBROK, "Invalid bit count argument '%s'", minbits_str);
+
+	if (strict_check) {
+		if (compat) {
+			kconf_minbits = aslr_kconfigs[ASLR_COMPAT_MINBITS].val;
+			minbits_path = "/proc/sys/vm/mmap_rnd_compat_bits";
+		} else {
+			kconf_minbits = aslr_kconfigs[ASLR_MINBITS].val;
+			minbits_path = "/proc/sys/vm/mmap_rnd_bits";
+		}
+
+		/*
+		 * Reading mmap_rnd_bits usually requires root privileges.
+		 * Fall back to kernel config values if unprivileged.
+		 */
+		if (!access(minbits_path, R_OK))
+			SAFE_FILE_SCANF(minbits_path, "%d", &minbits);
+		else if (!kconf_minbits)
+			tst_brk(TBROK, "Cannot determine kernel ASLR min bits");
+		else if (tst_parse_int(kconf_minbits, &minbits, 1, 64))
+			tst_brk(TBROK, "Invalid kernel ASLR min bits value");
+	}
+
+	find_large_lib();
+}
+
+static void run(void)
+{
+	uint64_t rndbits = 0, fixbits, addr;
+	int rndcount, aligncount, i;
+
+	fixbits = ~rndbits;
+
+	for (i = 0; i < 512; i++) {
+		addr = 0;
+		read_shared_libraries(get_lib_address_callback, &addr);
+
+		if (!addr) {
+			tst_res(TWARN, "Library %s not found?!", lib_path);
+			continue;
+		}
+
+		rndbits |= addr;
+		fixbits &= addr;
+	}
+
+	rndcount = count_bits(rndbits & ~fixbits);
+	aligncount = count_align_bits(rndbits);
+
+	if (rndcount < minbits) {
+		tst_res(TFAIL,
+			"Large lib base address has less than %d random bits",
+			minbits);
+		return;
+	}
+
+	tst_res(TPASS, "Library address has %d random bits", rndcount);
+	tst_res(TINFO, "Library base address alignment: %d bits", aligncount);
+
+	if (aligncount > pagebits) {
+		tst_res(strict_check ? TFAIL : TINFO,
+			"Base address alignment is higher than expected (%d)",
+			pagebits);
+	}
+}
+
+static void cleanup(void)
+{
+	if (ldd) {
+		char buf[PATH_MAX];
+
+		while (fgets(buf, PATH_MAX, ldd))
+			;
+
+		pclose(ldd);
+	}
+}
+
+static struct tst_test test = {
+	.test_all = run,
+	.setup = setup,
+	.cleanup = cleanup,
+	.forks_child = 1,
+	.options = (struct tst_option []) {
+		{"b:", &minbits_str, "Minimum ASLR random bits (default: 8)"},
+		{"s", &strict_check, "Run in strict mode"},
+		{}
+	},
+	.needs_kconfigs = (const char *[]) {
+		"CONFIG_HAVE_ARCH_MMAP_RND_BITS=y",
+		NULL
+	},
+	.needs_cmds = (const char *[]) {
+		"ldd",
+		NULL
+	},
+};
diff --git a/testcases/kernel/security/dirtyc0w_shmem/dirtyc0w_shmem.c b/testcases/kernel/security/dirtyc0w_shmem/dirtyc0w_shmem.c
index f3d6e6423..82f2399e6 100644
--- a/testcases/kernel/security/dirtyc0w_shmem/dirtyc0w_shmem.c
+++ b/testcases/kernel/security/dirtyc0w_shmem/dirtyc0w_shmem.c
@@ -22,6 +22,7 @@
 #include <pwd.h>
 
 #include "tst_test.h"
+#include "pgsize_helpers.h"
 
 #define TMP_DIR "tmp_dirtyc0w_shmem"
 #define TEST_FILE TMP_DIR"/testfile"
@@ -62,7 +63,7 @@ static void dirtyc0w_shmem_test(void)
 	int pid;
 	char c;
 
-	SAFE_FILE_PRINTF(TEST_FILE, STR);
+	SAFE_FILE_PRINTF_PGSIZE_EMULATION(TEST_FILE, STR);
 	SAFE_CHMOD(TEST_FILE, 0444);
 
 	pid = SAFE_FORK();
diff --git a/testcases/kernel/security/dirtypipe/dirtypipe.c b/testcases/kernel/security/dirtypipe/dirtypipe.c
index 9568a9b84..bc9197a90 100644
--- a/testcases/kernel/security/dirtypipe/dirtypipe.c
+++ b/testcases/kernel/security/dirtypipe/dirtypipe.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright 2022 CM4all GmbH / IONOS SE
  *
diff --git a/testcases/kernel/security/kallsyms/.gitignore b/testcases/kernel/security/kallsyms/.gitignore
new file mode 100644
index 000000000..7074d4e24
--- /dev/null
+++ b/testcases/kernel/security/kallsyms/.gitignore
@@ -0,0 +1 @@
+kallsyms
diff --git a/testcases/kernel/security/kallsyms/Makefile b/testcases/kernel/security/kallsyms/Makefile
new file mode 100644
index 000000000..5ea7d67db
--- /dev/null
+++ b/testcases/kernel/security/kallsyms/Makefile
@@ -0,0 +1,6 @@
+# SPDX-License-Identifier: GPL-2.0-or-later
+
+top_srcdir		?= ../../../..
+
+include $(top_srcdir)/include/mk/testcases.mk
+include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/kernel/security/kallsyms/kallsyms.c b/testcases/kernel/security/kallsyms/kallsyms.c
new file mode 100644
index 000000000..ad3a9265a
--- /dev/null
+++ b/testcases/kernel/security/kallsyms/kallsyms.c
@@ -0,0 +1,145 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (C) 2024 Red Hat, Inc.
+ */
+
+/*\
+ * [Description]
+ *
+ * Utilize kernel's symbol table for unauthorized address access.
+ *
+ * Access the system symbols with root permission to test whether it's
+ * possible to read and write the memory addresses of kernel-space
+ * from user-space. This helps in identifying potential vulnerabilities
+ * where user-space processes can inappropriately access kernel memory.
+ *
+ * Steps:
+ *
+ *  1. Start a process that reads all symbols and their addresses from
+ *     /proc/kallsyms and stores them in a linked list.
+ *
+ *  2. Attempt to write to each kernel address found in the linked list.
+ *     The expectation is that each attempt will fail with a SIGSEGV
+ *     (segmentation fault), indicating that the user-space process
+ *     cannot write to kernel memory.
+ *
+ *  3. Handle each SIGSEGV using a signal handler that sets a flag and
+ *     long jumps out of the faulting context.
+ *
+ *  4. If any write operation does not result in a SIGSEGV, log this as
+ *     a potential security vulnerability.
+ *
+ *  5. Observe and log the behavior and any system responses to these
+ *     unauthorized access attempts.
+ */
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <assert.h>
+#include <unistd.h>
+#include <string.h>
+#include <setjmp.h>
+#include <signal.h>
+
+#include "tst_test.h"
+#include "tst_safe_stdio.h"
+
+struct kallsym {
+	unsigned long addr;
+	char type;
+	char name[128];
+};
+
+static struct kallsym *sym_table;
+static unsigned int nr_symbols;
+static sigjmp_buf jmpbuf;
+volatile sig_atomic_t segv_caught;
+
+static void segv_handler(int sig)
+{
+	if (sig == SIGSEGV)
+		segv_caught++;
+	else
+		tst_res(TFAIL, "Unexpected signal %s", strsignal(sig));
+
+	siglongjmp(jmpbuf, 1);
+}
+
+static unsigned int read_kallsyms(struct kallsym *table, unsigned int table_size)
+{
+	char *line = NULL;
+	size_t len = 0;
+	unsigned int nr_syms = 0;
+	FILE *stream = SAFE_FOPEN("/proc/kallsyms", "r");
+
+	while (getline(&line, &len, stream) != -1) {
+
+		if (table && nr_syms < table_size) {
+			sscanf(line, "%lx %c %s",
+					&table[nr_syms].addr,
+					&table[nr_syms].type,
+					table[nr_syms].name);
+		}
+
+		nr_syms++;
+	}
+
+	SAFE_FCLOSE(stream);
+
+	return nr_syms;
+}
+
+static void setup(void)
+{
+	struct sigaction sa;
+	memset(&sa, 0, sizeof(sa));
+	sa.sa_handler = segv_handler;
+	sigaction(SIGSEGV, &sa, NULL);
+
+	nr_symbols = read_kallsyms(NULL, 0);
+	sym_table = SAFE_CALLOC(nr_symbols, sizeof(*sym_table));
+	unsigned int read_symbols = read_kallsyms(sym_table, nr_symbols);
+
+	if (nr_symbols != read_symbols)
+		tst_res(TWARN, "/proc/kallsyms changed size!?");
+}
+
+static void access_ksymbols_address(struct kallsym *table)
+{
+	tst_res(TDEBUG, "Access kernel addr: 0x%lx (%c) (%s)",
+				table->addr, table->type, table->name);
+
+	if (sigsetjmp(jmpbuf, 1) == 0) {
+		*(volatile unsigned long *)table->addr = 0;
+
+		tst_res(TFAIL, "Successfully accessed kernel addr 0x%lx (%c) (%s)",
+				table->addr, table->type, table->name);
+	}
+}
+
+static void test_access_kernel_address(void)
+{
+	segv_caught = 0;
+
+	for (unsigned int i = 0; i < nr_symbols; i++)
+		access_ksymbols_address(&sym_table[i]);
+
+	if (segv_caught == (sig_atomic_t)nr_symbols)
+		tst_res(TPASS, "Caught %d SIGSEGV in access ksymbols addr", segv_caught);
+	else
+		tst_res(TFAIL, "Caught %d SIGSEGV but expected %d", segv_caught, nr_symbols);
+}
+
+static void cleanup(void)
+{
+	if (sym_table)
+		free(sym_table);
+}
+
+static struct tst_test test = {
+	.needs_root = 1,
+	.setup = setup,
+	.cleanup = cleanup,
+	.max_runtime = 60,
+	.test_all = test_access_kernel_address,
+};
diff --git a/testcases/kernel/syscalls/Makefile b/testcases/kernel/syscalls/Makefile
index c6dc8d9e7..b2e1b1caf 100644
--- a/testcases/kernel/syscalls/Makefile
+++ b/testcases/kernel/syscalls/Makefile
@@ -10,11 +10,6 @@ top_srcdir		?= ../../..
 
 include	$(top_srcdir)/include/mk/env_pre.mk
 
-ifeq ($(UCLINUX),1)
-FILTER_OUT_DIRS	+= capget capset chmod chown clone fork getcontext llseek \
-		   mincore mprotect nftw profil remap_file_pages sbrk
-endif
-
 ifeq ($(UCLIBC),1)
 FILTER_OUT_DIRS	+= profil
 endif
diff --git a/testcases/kernel/syscalls/access/Makefile b/testcases/kernel/syscalls/access/Makefile
index 5d89a6c05..044619fb8 100644
--- a/testcases/kernel/syscalls/access/Makefile
+++ b/testcases/kernel/syscalls/access/Makefile
@@ -3,10 +3,6 @@
 
 top_srcdir		?= ../../../..
 
-ifeq ($(UCLINUX),1)
-FILTER_OUT_MAKE_TARGETS += access02 access03
-endif
-
 include $(top_srcdir)/include/mk/testcases.mk
 
 include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/kernel/syscalls/adjtimex/adjtimex01.c b/testcases/kernel/syscalls/adjtimex/adjtimex01.c
index 60b3544a8..a03ecf2cb 100644
--- a/testcases/kernel/syscalls/adjtimex/adjtimex01.c
+++ b/testcases/kernel/syscalls/adjtimex/adjtimex01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
diff --git a/testcases/kernel/syscalls/adjtimex/adjtimex02.c b/testcases/kernel/syscalls/adjtimex/adjtimex02.c
index e66ba2a5c..7f7fb643e 100644
--- a/testcases/kernel/syscalls/adjtimex/adjtimex02.c
+++ b/testcases/kernel/syscalls/adjtimex/adjtimex02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
diff --git a/testcases/kernel/syscalls/arch_prctl/.gitignore b/testcases/kernel/syscalls/arch_prctl/.gitignore
new file mode 100644
index 000000000..24871e249
--- /dev/null
+++ b/testcases/kernel/syscalls/arch_prctl/.gitignore
@@ -0,0 +1 @@
+/arch_prctl01
diff --git a/testcases/kernel/syscalls/arch_prctl/Makefile b/testcases/kernel/syscalls/arch_prctl/Makefile
new file mode 100644
index 000000000..272949d57
--- /dev/null
+++ b/testcases/kernel/syscalls/arch_prctl/Makefile
@@ -0,0 +1,8 @@
+# SPDX-License-Identifier: GPL-2.0-or-later
+# Copyright (c) UnionTech Software Technology Co.,Ltd. 2024
+
+top_srcdir		?= ../../../..
+
+include $(top_srcdir)/include/mk/testcases.mk
+
+include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/kernel/syscalls/arch_prctl/arch_prctl01.c b/testcases/kernel/syscalls/arch_prctl/arch_prctl01.c
new file mode 100644
index 000000000..b98ef99d2
--- /dev/null
+++ b/testcases/kernel/syscalls/arch_prctl/arch_prctl01.c
@@ -0,0 +1,77 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) UnionTech Software Technology Co.,Ltd., 2024
+ * Author: Lu Fei <lufei@uniontech.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Simple test on arch_prctl to set and get cpuid instruction of test thread.
+ */
+
+#include "tst_test.h"
+#include "tst_safe_stdio.h"
+#include "lapi/syscalls.h"
+#include "lapi/arch_prctl.h"
+#include <stdlib.h>
+#include <string.h>
+
+static int arch_prctl_get(int code)
+{
+	return tst_syscall(__NR_arch_prctl, code, NULL);
+}
+
+static int arch_prctl_set(int code, unsigned long addr)
+{
+	return tst_syscall(__NR_arch_prctl, code, addr);
+}
+
+static bool tag;
+
+static void setup(void)
+{
+	FILE *f;
+	char flag_mid[] = " cpuid_fault ";
+	char flag_end[] = " cpuid_fault\n";
+	char *line = NULL;
+	size_t len = 0;
+
+	tag = false;
+
+	f = SAFE_FOPEN("/proc/cpuinfo", "r");
+
+	while (getline(&line, &len, f) != -1)
+		if (strncmp(line, "flags", strlen("flags")) == 0 &&
+				(strstr(line, flag_mid) != NULL ||
+				 strstr(line, flag_end) != NULL)) {
+			tag = true;
+			break;
+		}
+}
+
+static void run(unsigned int index)
+{
+	if (tag)
+		TST_EXP_PASS(arch_prctl_set(ARCH_SET_CPUID, index));
+	else
+		TST_EXP_FAIL(arch_prctl_set(ARCH_SET_CPUID, index), ENODEV);
+
+	// if cpu has cpuid_fault flag, ARCH_GET_CPUID returns what has been
+	// set: index, otherwise, returns default status: 1
+	int exp = tag ? index : 1;
+
+	TEST(arch_prctl_get(ARCH_GET_CPUID));
+	if (TST_RET == exp)
+		tst_res(TPASS, "get cpuid succeed.");
+	else
+		tst_res(TFAIL, "get wrong cpuid status");
+}
+
+static struct tst_test test = {
+	.test = run,
+	.setup = setup,
+	.tcnt = 2,
+	.min_kver = "4.12",
+	.supported_archs = (const char *const []){"x86_64", "x86", NULL}
+};
diff --git a/testcases/kernel/syscalls/bind/bind01.c b/testcases/kernel/syscalls/bind/bind01.c
index c008819a8..68a1e48f6 100644
--- a/testcases/kernel/syscalls/bind/bind01.c
+++ b/testcases/kernel/syscalls/bind/bind01.c
@@ -17,11 +17,16 @@
 
 #include "tst_test.h"
 
-int inet_socket;
-int dev_null;
+#define DIR_ENOTDIR "dir_enotdir"
+#define TEST_ENOTDIR "test_enotdir"
 
-struct sockaddr_in sin1, sin2, sin3;
-struct sockaddr_un sun;
+static int inet_socket;
+static int dev_null;
+static int fd_ebadf = -1;
+static int fd_enotdir;
+
+static struct sockaddr_in sin1, sin2, sin3;
+static struct sockaddr_un sun, sock_enotdir;
 
 static struct test_case {
 	int *socket_fd;
@@ -41,24 +46,28 @@ static struct test_case {
 	  EAFNOSUPPORT, "UNIX-domain of current directory" },
 	{ &inet_socket, (struct sockaddr *)&sin3, sizeof(sin3), -1,
 	  EADDRNOTAVAIL, "non-local address" },
+	{ &fd_ebadf, (struct sockaddr *)&sin1, sizeof(sin1), -1,
+	  EBADF, "sockfd is not a valid file descriptor" },
+	{ &fd_enotdir, (struct sockaddr *)&sock_enotdir, sizeof(sock_enotdir), -1,
+	  ENOTDIR, "a component of addr prefix is not a directory"},
 };
 
-void verify_bind(unsigned int nr)
+static void verify_bind(unsigned int nr)
 {
 	struct test_case *tcase = &tcases[nr];
 
 	if (tcase->experrno) {
 		TST_EXP_FAIL(bind(*tcase->socket_fd, tcase->sockaddr, tcase->salen),
-		             tcase->experrno, "%s", tcase->desc);
+				tcase->experrno, "%s", tcase->desc);
 	} else {
 		TST_EXP_PASS(bind(*tcase->socket_fd, tcase->sockaddr, tcase->salen),
-		             "%s", tcase->desc);
+				"%s", tcase->desc);
 		SAFE_CLOSE(inet_socket);
 		inet_socket = SAFE_SOCKET(PF_INET, SOCK_STREAM, 0);
 	}
 }
 
-void test_setup(void)
+static void test_setup(void)
 {
 	/* initialize sockaddr's */
 	sin1.sin_family = AF_INET;
@@ -78,14 +87,21 @@ void test_setup(void)
 	sun.sun_family = AF_UNIX;
 	strncpy(sun.sun_path, ".", sizeof(sun.sun_path));
 
+	SAFE_TOUCH(DIR_ENOTDIR, 0777, NULL);
+	sock_enotdir.sun_family = AF_UNIX;
+	strncpy(sock_enotdir.sun_path, DIR_ENOTDIR "/" TEST_ENOTDIR,
+		sizeof(sock_enotdir.sun_path));
+
 	inet_socket = SAFE_SOCKET(PF_INET, SOCK_STREAM, 0);
 	dev_null = SAFE_OPEN("/dev/null", O_WRONLY);
+	fd_enotdir = SAFE_SOCKET(AF_UNIX, SOCK_STREAM, 0);
 }
 
-void test_cleanup(void)
+static void test_cleanup(void)
 {
 	SAFE_CLOSE(inet_socket);
 	SAFE_CLOSE(dev_null);
+	SAFE_CLOSE(fd_enotdir);
 }
 
 static struct tst_test test = {
@@ -93,4 +109,5 @@ static struct tst_test test = {
 	.setup = test_setup,
 	.cleanup = test_cleanup,
 	.test = verify_bind,
+	.needs_tmpdir = 1,
 };
diff --git a/testcases/kernel/syscalls/capset/capset01.c b/testcases/kernel/syscalls/capset/capset01.c
index 25db8112c..029fe7f3d 100644
--- a/testcases/kernel/syscalls/capset/capset01.c
+++ b/testcases/kernel/syscalls/capset/capset01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
  * Author: Saji Kumar.V.R <saji.kumar@wipro.com>
diff --git a/testcases/kernel/syscalls/chown/chown01.c b/testcases/kernel/syscalls/chown/chown01.c
index 7fbb116bd..030130937 100644
--- a/testcases/kernel/syscalls/chown/chown01.c
+++ b/testcases/kernel/syscalls/chown/chown01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * AUTHOR: William Roske
diff --git a/testcases/kernel/syscalls/clock_gettime/leapsec01.c b/testcases/kernel/syscalls/clock_gettime/leapsec01.c
index 73078fb69..e623b4107 100644
--- a/testcases/kernel/syscalls/clock_gettime/leapsec01.c
+++ b/testcases/kernel/syscalls/clock_gettime/leapsec01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Red Hat, Inc., 2012.
  * Copyright (c) Linux Test Project, 2019
diff --git a/testcases/kernel/syscalls/clone/clone02.c b/testcases/kernel/syscalls/clone/clone02.c
index 42eea135a..821adc2d9 100644
--- a/testcases/kernel/syscalls/clone/clone02.c
+++ b/testcases/kernel/syscalls/clone/clone02.c
@@ -49,11 +49,6 @@
  *			test failed
  */
 
-#if defined UCLINUX && !__THROW
-/* workaround for libc bug */
-#define __THROW
-#endif
-
 #define _GNU_SOURCE
 
 #include <errno.h>
diff --git a/testcases/kernel/syscalls/close_range/close_range01.c b/testcases/kernel/syscalls/close_range/close_range01.c
index 072bbab66..adeb2e918 100644
--- a/testcases/kernel/syscalls/close_range/close_range01.c
+++ b/testcases/kernel/syscalls/close_range/close_range01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Taken from the kernel self tests, which in turn were based on
  * a Syzkaller reproducer.
diff --git a/testcases/kernel/syscalls/close_range/close_range02.c b/testcases/kernel/syscalls/close_range/close_range02.c
index 2aa6d2c9f..48d9a31df 100644
--- a/testcases/kernel/syscalls/close_range/close_range02.c
+++ b/testcases/kernel/syscalls/close_range/close_range02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2021 SUSE LLC
  */
diff --git a/testcases/kernel/syscalls/connect/connect01.c b/testcases/kernel/syscalls/connect/connect01.c
index 1c1630fa7..660c4f7a9 100644
--- a/testcases/kernel/syscalls/connect/connect01.c
+++ b/testcases/kernel/syscalls/connect/connect01.c
@@ -83,13 +83,10 @@ struct test_case_t {		/* test case structure */
 	PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&sin1,
 		    sizeof(struct sockaddr_in), -1, EBADF, setup0,
 		    cleanup0, "bad file descriptor"},
-#ifndef UCLINUX
-	    /* Skip since uClinux does not implement memory protection */
 	{
 	PF_INET, SOCK_STREAM, 0, (struct sockaddr *)-1,
 		    sizeof(struct sockaddr_in), -1, EFAULT, setup1,
 		    cleanup1, "invalid socket buffer"},
-#endif
 	{
 	PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&sin1,
 		    3, -1, EINVAL, setup1, cleanup1, "invalid salen"}, {
@@ -112,10 +109,6 @@ struct test_case_t {		/* test case structure */
 
 int TST_TOTAL = sizeof(tdat) / sizeof(tdat[0]);
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 /**
  * bionic's connect() implementation calls netdClientInitConnect() before
  * sending the request to the kernel.  We need to bypass this, or the test will
@@ -139,10 +132,6 @@ int main(int argc, char *argv[])
 	int lc;
 
 	tst_parse_opts(argc, argv, NULL, NULL);
-#ifdef UCLINUX
-	argv0 = argv[0];
-	maybe_run_child(&do_child, "d", &sfd);
-#endif
 
 	setup();
 
@@ -261,13 +250,9 @@ pid_t start_server(struct sockaddr_in *sin0)
 	}
 	SAFE_GETSOCKNAME(cleanup, sfd, (struct sockaddr *)sin0, &slen);
 
-	switch ((pid = FORK_OR_VFORK())) {
+	switch ((pid = tst_fork())) {
 	case 0:		/* child */
-#ifdef UCLINUX
-		self_exec(argv0, "d", sfd);
-#else
 		do_child();
-#endif
 		break;
 	case -1:
 		tst_brkm(TBROK | TERRNO, cleanup, "server fork failed");
diff --git a/testcases/kernel/syscalls/creat/creat06.c b/testcases/kernel/syscalls/creat/creat06.c
index 5c82e4757..bd9835ea3 100644
--- a/testcases/kernel/syscalls/creat/creat06.c
+++ b/testcases/kernel/syscalls/creat/creat06.c
@@ -60,9 +60,7 @@
 static void setup(void);
 static void test6_setup(void);
 static void test6_cleanup(void);
-#if !defined(UCLINUX)
 static void bad_addr_setup(int);
-#endif
 
 static struct passwd *ltpuser;
 static char long_name[PATH_MAX+2];
@@ -78,9 +76,7 @@ static struct test_case_t {
 	{long_name, MODE1, ENAMETOOLONG, NULL, NULL},
 	{NO_DIR, MODE1, ENOENT, NULL, NULL},
 	{NOT_DIR, MODE1, ENOTDIR, NULL, NULL},
-#if !defined(UCLINUX)
 	{NULL, MODE1, EFAULT, bad_addr_setup, NULL},
-#endif
 	{TEST6_FILE, MODE1, EACCES, test6_setup, test6_cleanup},
 	{TEST7_FILE, MODE1, ELOOP, NULL, NULL},
 	{TEST8_FILE, MODE1, EROFS, NULL, NULL},
@@ -127,7 +123,6 @@ static void setup(void)
 	SAFE_SYMLINK("test_file_eloop2", TEST7_FILE);
 }
 
-#if !defined(UCLINUX)
 static void bad_addr_setup(int i)
 {
 	if (tcases[i].fname)
@@ -136,7 +131,6 @@ static void bad_addr_setup(int i)
 	tcases[i].fname = SAFE_MMAP(0, 1, PROT_NONE,
 	                            MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
 }
-#endif
 
 static void test6_setup(void)
 {
diff --git a/testcases/kernel/syscalls/delete_module/delete_module01.c b/testcases/kernel/syscalls/delete_module/delete_module01.c
index 90d8b5289..11c4eae58 100644
--- a/testcases/kernel/syscalls/delete_module/delete_module01.c
+++ b/testcases/kernel/syscalls/delete_module/delete_module01.c
@@ -14,8 +14,10 @@
  * Install dummy_del_mod.ko and delete it with delete_module(2).
  */
 
+#include <stdlib.h>
 #include "tst_test.h"
 #include "tst_module.h"
+#include "tst_kconfig.h"
 #include "lapi/syscalls.h"
 
 #define MODULE_NAME	"dummy_del_mod"
@@ -25,6 +27,12 @@ static int module_loaded;
 
 static void do_delete_module(void)
 {
+	struct tst_kcmdline_var params = TST_KCMDLINE_INIT("module.sig_enforce");
+
+	tst_kcmdline_parse(&params, 1);
+	if (atoi(params.value) == 1)
+		tst_brk(TCONF, "module signature is enforced, skip test");
+
 	if (!module_loaded) {
 		tst_module_load(MODULE_NAME_KO, NULL);
 		module_loaded = 1;
diff --git a/testcases/kernel/syscalls/delete_module/delete_module03.c b/testcases/kernel/syscalls/delete_module/delete_module03.c
index 7e92fc2af..fdf0c293d 100644
--- a/testcases/kernel/syscalls/delete_module/delete_module03.c
+++ b/testcases/kernel/syscalls/delete_module/delete_module03.c
@@ -12,9 +12,11 @@
  * if tried to remove a module while other modules depend on this module.
  */
 
+#include <stdlib.h>
 #include <errno.h>
 #include "tst_test.h"
 #include "tst_module.h"
+#include "tst_kconfig.h"
 #include "lapi/syscalls.h"
 
 #define DUMMY_MOD		"dummy_del_mod"
@@ -50,6 +52,12 @@ static void do_delete_module(void)
 
 static void setup(void)
 {
+	struct tst_kcmdline_var params = TST_KCMDLINE_INIT("module.sig_enforce");
+
+	tst_kcmdline_parse(&params, 1);
+	if (atoi(params.value) == 1)
+		tst_brk(TCONF, "module signature is enforced, skip test");
+
 	/* Load first kernel module */
 	tst_module_load(DUMMY_MOD_KO, NULL);
 	dummy_mod_loaded = 1;
diff --git a/testcases/kernel/syscalls/epoll/epoll-ltp.c b/testcases/kernel/syscalls/epoll/epoll-ltp.c
index 8b04f5326..dac132e2f 100644
--- a/testcases/kernel/syscalls/epoll/epoll-ltp.c
+++ b/testcases/kernel/syscalls/epoll/epoll-ltp.c
@@ -143,7 +143,7 @@ do {					\
 	int kid_status;			\
 					\
 	tst_old_flush();			\
-	kid_pid = FORK_OR_VFORK();	\
+	kid_pid = tst_fork();	\
 	if (kid_pid == 0) {
 
 #define PROTECT_REGION_EXIT(errval) return (errval);
@@ -177,7 +177,7 @@ do {					\
 	int kid_status;								\
 										\
 	tst_old_flush();								\
-	kid_pid = FORK_OR_VFORK();						\
+	kid_pid = tst_fork();						\
 	if (kid_pid == 0) { /* Run the function */				\
 		return fn(epoll_fd);						\
 	} else {								\
diff --git a/testcases/kernel/syscalls/epoll_wait/epoll_wait06.c b/testcases/kernel/syscalls/epoll_wait/epoll_wait06.c
index f35e0423a..a167b232f 100644
--- a/testcases/kernel/syscalls/epoll_wait/epoll_wait06.c
+++ b/testcases/kernel/syscalls/epoll_wait/epoll_wait06.c
@@ -26,6 +26,7 @@
 #include <fcntl.h>
 #include "tst_test.h"
 #include "tst_epoll.h"
+#include "pgsize_helpers.h"
 
 static size_t write_size;
 static size_t read_size;
@@ -34,7 +35,16 @@ static int epfd;
 
 static void setup(void)
 {
-	write_size = getpagesize();
+	/*
+	 * NOTE: The sematics of this test don't hold across page boundaries for
+	 *       EPOLLET.
+	 *
+	 * The documentation says that it "might" / "probably" won't recieve a
+	 * new event for exisitng data. So we can't be guaranteed that it won't.
+	 *
+	 * https://man7.org/linux/man-pages/man7/epoll.7.html
+	 */
+	write_size = kernel_page_size();
 	read_size = write_size / 2;
 
 	SAFE_PIPE2(fds, O_NONBLOCK);
diff --git a/testcases/kernel/syscalls/execl/execl01.c b/testcases/kernel/syscalls/execl/execl01.c
index 9268d4976..dfefd1fa8 100644
--- a/testcases/kernel/syscalls/execl/execl01.c
+++ b/testcases/kernel/syscalls/execl/execl01.c
@@ -35,4 +35,8 @@ static struct tst_test test = {
 	.forks_child = 1,
 	.child_needs_reinit = 1,
 	.test_all = verify_execl,
+	.ulimit = (const struct tst_ulimit_val[]) {
+		{RLIMIT_STACK, RLIM_INFINITY},
+		{}
+	},
 };
diff --git a/testcases/kernel/syscalls/exit/exit01.c b/testcases/kernel/syscalls/exit/exit01.c
index 1c15f43b0..ca62dba49 100644
--- a/testcases/kernel/syscalls/exit/exit01.c
+++ b/testcases/kernel/syscalls/exit/exit01.c
@@ -52,7 +52,7 @@ int main(int ac, char **av)
 		sig = 0;
 		exno = 1;
 
-		pid = FORK_OR_VFORK();
+		pid = tst_fork();
 
 		switch (pid) {
 		case 0:
diff --git a/testcases/kernel/syscalls/fallocate/fallocate03.c b/testcases/kernel/syscalls/fallocate/fallocate03.c
index da2b3bfbe..b3e6b3817 100644
--- a/testcases/kernel/syscalls/fallocate/fallocate03.c
+++ b/testcases/kernel/syscalls/fallocate/fallocate03.c
@@ -1,277 +1,95 @@
-/******************************************************************************
- *				 fallocate03.c
- *	Mon Dec 24 2007
- *	Copyright (c) International Business Machines  Corp., 2007
- *	Emali : sharyathi@in.ibm.com
- ******************************************************************************/
+// SPDX-License-Identifier: GPL-2.0-or-later
 
-/***************************************************************************
- * This program is free software;  you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU Library General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
-***************************************************************************/
+/*
+ * Copyright (c) International Business Machines  Corp., 2007
+ * Author: Sharyathi Nagesh <sharyathi@in.ibm.com>
+ * Copyright (c) Linux Test Project, 2008-2017
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
+ */
 
-/*****************************************************************************
- *
- *	OS Test - International Business Machines Corp. 2007.
- *
- *	TEST IDENTIFIER	: fallocate03
- *
- *	EXECUTED BY		: anyone
- *
- *	TEST TITLE		: fallocate
- *
- *	TEST CASE TOTAL	: 8
- *
- *	CPU ARCHITECTURES	: PPC,X86, X86_64
- *
- *	AUTHOR			: Sharyathi Nagesh
- *
- *	CO-PILOT			:
- *
- *	DATE STARTED		: 24/12/2007
- *
- *	TEST CASES
- *	(Working of fallocate on a sparse file)
- *
- *
- *	INPUT SPECIFICATIONS
- *		No input needs to be specified
- *		  fallocate() in-puts are specified through test_data
- *
- *	OUTPUT SPECIFICATIONS
- *		Output describing whether test cases passed or failed.
- *
- *	ENVIRONMENTAL NEEDS
- *		Test Needs to be executed on file system supporting ext4
- *   LTP {TMP} Needs to be set to such a folder
- *
- *	SPECIAL PROCEDURAL REQUIREMENTS
- *		None
- *
- *	DETAILED DESCRIPTION
- *		This is a test case for fallocate() system call.
- *		This test suite tests working of fallocate on sparse file
- *		fallocate is tested for different offsets
- *
- *		Total 8 Test Cases :-
- *			Different offsets with in a sparse file is tested
- *
- *	Setup:
- *		Setup file on which fallocate is to be called
- *		Set up a file with hole, created through lseek
- *
- *	Test:
- *		Loop if the proper options are given
- *		Execute system call
- *		Check return code, if system call failed
- *		TEST fails, PASS the test otherwise
- *
- *	Cleanup:
- *		Cleanup the temporary folder
- *
-*************************************************************************/
+/*\
+ * [Description]
+ * Test fallocate() on sparse file for different offsets, with a total of 8 test cases
+ */
 
 #define _GNU_SOURCE
 
-#include <stdio.h>
-#include <stdlib.h>
-#include <endian.h>
-#include <errno.h>
-#include <sys/stat.h>
-#include <sys/types.h>		//Can be done with out
 #include <fcntl.h>
-#include <unistd.h>
-#include <inttypes.h>
-#include <sys/utsname.h>
-
-#include "test.h"
-#include "safe_macros.h"
-#include "lapi/fallocate.h"
+#include "tst_test.h"
 
 #define BLOCKS_WRITTEN 12
 #define HOLE_SIZE_IN_BLOCKS 12
 #define DEFAULT_MODE 0
-#define TRUE 0
-
-void get_blocksize(int);
-void populate_file();
-void file_seek(off_t);
 
-char *TCID = "fallocate03";
-char fname[255];
-int fd;
-struct test_data_t {
+static int fd;
+static struct test_case {
 	int mode;
 	loff_t offset;
-	loff_t len;
-	int error;
-} test_data[] = {
-	{
-	DEFAULT_MODE, 2, 1, TRUE}, {
-	DEFAULT_MODE, BLOCKS_WRITTEN, 1, TRUE}, {
-	DEFAULT_MODE, BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS / 2 - 1, 1, TRUE},
-	{
-	DEFAULT_MODE, BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS + 1, 1, TRUE}, {
-	FALLOC_FL_KEEP_SIZE, 2, 1, TRUE}, {
-	FALLOC_FL_KEEP_SIZE, BLOCKS_WRITTEN, 1, TRUE}, {
-	FALLOC_FL_KEEP_SIZE,
-		    BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS / 2 + 1, 1, TRUE}, {
-	FALLOC_FL_KEEP_SIZE, BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS + 2,
-		    1, TRUE}
+} test_cases[] = {
+	{DEFAULT_MODE, 2},
+	{DEFAULT_MODE, BLOCKS_WRITTEN},
+	{DEFAULT_MODE, BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS / 2 - 1},
+	{DEFAULT_MODE, BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS + 1},
+	{FALLOC_FL_KEEP_SIZE, 2},
+	{FALLOC_FL_KEEP_SIZE, BLOCKS_WRITTEN},
+	{FALLOC_FL_KEEP_SIZE, BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS / 2 + 1},
+	{FALLOC_FL_KEEP_SIZE, BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS + 2}
 };
 
-int TST_TOTAL = sizeof(test_data) / sizeof(test_data[0]);
-int block_size;
-int buf_size;
+static int block_size;
 
-/******************************************************************************
- * Performs all one time clean up for this test on successful
- * completion,  premature exit or  failure. Closes all temporary
- * files, removes all temporary directories exits the test with
- * appropriate return code by calling tst_exit() function.
-******************************************************************************/
-void cleanup(void)
+static void cleanup(void)
 {
-	/* Close all open file descriptors. */
-	if (close(fd) == -1)
-		tst_resm(TWARN | TERRNO, "close(%s) failed", fname);
-
-	tst_rmdir();
-
+	if (fd)
+		SAFE_CLOSE(fd);
 }
 
-/*****************************************************************************
- * Performs all one time setup for this test. This function is
- * used to create temporary dirs and temporary files
- * that may be used in the course of this test
- ******************************************************************************/
-
-void setup(void)
+static void write_data_to_file(int buf_size)
 {
-	/* Create temporary directories */
-	TEST_PAUSE;
+	char buf[buf_size + 1];
 
-	tst_tmpdir();
+	for (int blocks = 0; blocks < BLOCKS_WRITTEN; blocks++) {
+		for (int i = 0; i < buf_size; i++)
+			buf[i] = 'A' + (i % 26);
 
-	sprintf(fname, "tfile_sparse_%d", getpid());
-	fd = SAFE_OPEN(cleanup, fname, O_RDWR | O_CREAT, 0700);
-	get_blocksize(fd);
-	populate_file();
-	file_seek(BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS);	/* create holes */
-	populate_file();
-	file_seek(0);		/* Rewind */
+		buf[buf_size] = '\0';
+		SAFE_WRITE(SAFE_WRITE_ALL, fd, buf, buf_size);
+	}
 }
 
-/*****************************************************************************
- * Gets the block size for the file system
- ******************************************************************************/
-void get_blocksize(int fd)
+static void setup(void)
 {
+	char fname[NAME_MAX];
 	struct stat file_stat;
 
-	if (fstat(fd, &file_stat) < 0)
-		tst_resm(TFAIL | TERRNO,
-			 "fstat failed while getting block_size");
+	sprintf(fname, "tfile_sparse_%d", getpid());
+	fd = SAFE_OPEN(fname, O_RDWR | O_CREAT, 0700);
 
+	SAFE_FSTAT(fd, &file_stat);
 	block_size = (int)file_stat.st_blksize;
-	buf_size = block_size;
-}
 
-/*****************************************************************************
- * Create a Hole in the file
- ******************************************************************************/
-void file_seek(off_t offset)
-{
-	offset *= block_size;
-	lseek(fd, offset, SEEK_SET);
+	write_data_to_file(block_size);
+	SAFE_LSEEK(fd, block_size * (BLOCKS_WRITTEN + HOLE_SIZE_IN_BLOCKS), SEEK_SET);
+	write_data_to_file(block_size);
+	SAFE_LSEEK(fd, 0, SEEK_SET);
 }
 
-/*****************************************************************************
- * Writes data into the file
- ******************************************************************************/
-void populate_file(void)
-{
-	char buf[buf_size + 1];
-	int index;
-	int blocks;
-	int data;
-	for (blocks = 0; blocks < BLOCKS_WRITTEN; blocks++) {
-		for (index = 0; index < buf_size; index++)
-			buf[index] = 'A' + (index % 26);
-		buf[buf_size] = '\0';
-		if ((data = write(fd, buf, buf_size)) < 0)
-			tst_brkm(TBROK | TERRNO, cleanup,
-				 "Unable to write to %s", fname);
-	}
-}
 
-/*****************************************************************************
- * Main function that calls the system call with the  appropriate parameters
- ******************************************************************************/
-/* ac: number of command line parameters */
-/* av: pointer to the array of the command line parameters */
-int main(int ac, char **av)
+static void verify_fallocate(unsigned int nr)
 {
-	int test_index = 0;
-	int lc;
-
-	/***************************************************************
-	 * parse standard options
-	***************************************************************/
-	tst_parse_opts(ac, av, NULL, NULL);
+	struct test_case *tc = &test_cases[nr];
 
-	/* perform global test setup, call setup() function */
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		/* reset tst_count in case we are looping */
-		tst_count = 0;
-		for (test_index = 0; test_index < TST_TOTAL; test_index++) {
-			TEST(fallocate
-			     (fd, test_data[test_index].mode,
-			      test_data[test_index].offset * block_size,
-			      test_data[test_index].len * block_size));
-
-			/* check return code */
-			if (TEST_RETURN != test_data[test_index].error) {
-				if (TEST_ERRNO == EOPNOTSUPP
-				    || TEST_ERRNO == ENOSYS) {
-					tst_brkm(TCONF, cleanup,
-						 "fallocate system call is not implemented");
-				}
-				tst_resm(TFAIL | TTERRNO,
-					 "fallocate(%s, %d, %" PRId64 ", %"
-					 PRId64 ") failed", fname,
-					 test_data[test_index].mode,
-					 test_data[test_index].offset *
-					 block_size,
-					 test_data[test_index].len *
-					 block_size);
-			} else {
-				tst_resm(TPASS,
-					 "fallocate(%s, %d, %" PRId64
-					 ", %" PRId64 ") returned %ld",
-					 fname,
-					 test_data[test_index].mode,
-					 test_data[test_index].offset *
-					 block_size,
-					 test_data[test_index].len *
-					 block_size, TEST_RETURN);
-			}
-		}
-	}
-
-	cleanup();
-	tst_exit();
+	TST_EXP_PASS(
+		fallocate(fd, tc->mode, tc->offset * block_size, block_size),
+		"fallocate(fd, %s, %ld, %d)",
+		tc->mode ? "FALLOC_FL_KEEP_SIZE" : "DEFAULT_MODE",
+		tc->offset * block_size, block_size);
 }
+
+static struct tst_test test = {
+	.setup = setup,
+	.cleanup = cleanup,
+	.test = verify_fallocate,
+	.needs_tmpdir = 1,
+	.tcnt = ARRAY_SIZE(test_cases)
+};
diff --git a/testcases/kernel/syscalls/fanotify/fanotify.h b/testcases/kernel/syscalls/fanotify/fanotify.h
index e0d178bcc..554940a7e 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify.h
+++ b/testcases/kernel/syscalls/fanotify/fanotify.h
@@ -166,20 +166,23 @@ static inline int fanotify_flags_supported_on_fs(unsigned int init_flags,
 {
 	int fd;
 	int rval = 0;
+	int err = 0;
 
 	fd = fanotify_init(init_flags, O_RDONLY);
-
 	if (fd < 0) {
+		err = errno;
 		if (errno == ENOSYS)
 			tst_brk(TCONF, "fanotify not configured in kernel");
 		if (errno != EINVAL)
 			tst_brk(TBROK | TERRNO,
 				"fanotify_init(%x, O_RDONLY) failed",
 				init_flags);
+		errno = err;
 		return -1;
 	}
 
 	if (fname && fanotify_mark(fd, FAN_MARK_ADD | mark_flags, event_flags, AT_FDCWD, fname) < 0) {
+		err = errno;
 		if (errno == ENODEV || errno == EOPNOTSUPP || errno == EXDEV) {
 			rval = strcmp(fname, OVL_MNT) ? -2 : -3;
 		} else if (errno != EINVAL) {
@@ -194,6 +197,7 @@ static inline int fanotify_flags_supported_on_fs(unsigned int init_flags,
 
 	SAFE_CLOSE(fd);
 
+	errno = err;
 	return rval;
 }
 
diff --git a/testcases/kernel/syscalls/fanotify/fanotify01.c b/testcases/kernel/syscalls/fanotify/fanotify01.c
index e4398f236..5d18fe851 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify01.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2013 SUSE.  All Rights Reserved.
  *
@@ -77,6 +77,7 @@ static char buf[BUF_SIZE];
 static int fd_notify;
 static int fan_report_fid_unsupported;
 static int mount_mark_fid_unsupported;
+static int inode_mark_fid_xdev;
 static int filesystem_mark_unsupported;
 
 static unsigned long long event_set[EVENT_MAX];
@@ -328,6 +329,17 @@ pass:
 
 	}
 
+
+	/*
+	 * Try to setup a bogus mark on test tmp dir, to check if marks on
+	 * different filesystems are supported.
+	 * When tested fs has zero fsid (e.g. fuse) and events are reported
+	 * with fsid+fid, watching different filesystems is not supported.
+	 */
+	ret = report_fid ? inode_mark_fid_xdev : 0;
+	TST_EXP_FD_OR_FAIL(fanotify_mark(fd_notify, FAN_MARK_ADD, FAN_CLOSE_WRITE,
+					 AT_FDCWD, "."), ret);
+
 	/* Remove mark to clear FAN_MARK_IGNORED_SURV_MODIFY */
 	SAFE_FANOTIFY_MARK(fd_notify, FAN_MARK_REMOVE | mark->flag,
 			  FAN_ACCESS | FAN_MODIFY | FAN_CLOSE | FAN_OPEN,
@@ -352,6 +364,20 @@ static void setup(void)
 	mount_mark_fid_unsupported = fanotify_flags_supported_on_fs(FAN_REPORT_FID,
 								    FAN_MARK_MOUNT,
 								    FAN_OPEN, fname);
+	/*
+	 * When mount mark is not supported due to zero fsid (e.g. fuse) or if TMPDIR has
+	 * non-uniform fsid (e.g. btrfs subvol), multi fs inode marks are not supported.
+	 */
+	if (mount_mark_fid_unsupported && errno == ENODEV) {
+		tst_res(TINFO, "filesystem %s does not support reporting events with fid from multi fs",
+				tst_device->fs_type);
+		inode_mark_fid_xdev = EXDEV;
+	}
+
+	if (fanotify_flags_supported_on_fs(FAN_REPORT_FID, FAN_MARK_MOUNT, FAN_OPEN, ".")) {
+		inode_mark_fid_xdev = errno;
+		tst_res(TINFO, "TMPDIR does not support reporting events with fid from multi fs");
+	}
 }
 
 static void cleanup(void)
@@ -368,6 +394,7 @@ static struct tst_test test = {
 	.needs_root = 1,
 	.mount_device = 1,
 	.mntpoint = MOUNT_PATH,
+	.all_filesystems = 1,
 };
 
 #else
diff --git a/testcases/kernel/syscalls/fanotify/fanotify02.c b/testcases/kernel/syscalls/fanotify/fanotify02.c
index 3321e5526..19854064a 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify02.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2013 SUSE.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify03.c b/testcases/kernel/syscalls/fanotify/fanotify03.c
index 028da742c..3ed78e5fa 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify03.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2013 SUSE.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify04.c b/testcases/kernel/syscalls/fanotify/fanotify04.c
index 8541a7b96..378bc57c0 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify04.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify04.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2013 SUSE.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify05.c b/testcases/kernel/syscalls/fanotify/fanotify05.c
index 04670cb1c..12c240881 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify05.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify05.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2014 SUSE Linux.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify06.c b/testcases/kernel/syscalls/fanotify/fanotify06.c
index 618c85a43..8779e34d9 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify06.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify06.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2014 SUSE.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify08.c b/testcases/kernel/syscalls/fanotify/fanotify08.c
index de57f04d2..405965f7f 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify08.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify08.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2017 RedHat.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify10.c b/testcases/kernel/syscalls/fanotify/fanotify10.c
index 6c89ca1d0..c6d8ec922 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify10.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify10.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2014 SUSE.  All Rights Reserved.
  * Copyright (c) 2018 CTERA Networks.  All Rights Reserved.
diff --git a/testcases/kernel/syscalls/fanotify/fanotify12.c b/testcases/kernel/syscalls/fanotify/fanotify12.c
index 42ba08800..60ba27e16 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify12.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify12.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2018 Matthew Bobrowski. All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify13.c b/testcases/kernel/syscalls/fanotify/fanotify13.c
index 6086a81fc..5cd857707 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify13.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify13.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2018 Matthew Bobrowski. All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify14.c b/testcases/kernel/syscalls/fanotify/fanotify14.c
index 0b0da89ca..ee583a095 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify14.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify14.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2018 Matthew Bobrowski. All Rights Reserved.
  * Copyright (c) Linux Test Project, 2020-2022
@@ -47,6 +47,7 @@ static int pipes[2] = {-1, -1};
 static int fanotify_fd;
 static int ignore_mark_unsupported;
 static int filesystem_mark_unsupported;
+static int se_enforcing;
 static unsigned int supported_init_flags;
 
 struct test_case_flags_t {
@@ -274,6 +275,7 @@ static void do_test(unsigned int number)
 
 	/* Set mark on non-dir only when expecting error ENOTDIR */
 	const char *path = tc->expected_errno == ENOTDIR ? FILE1 : MNTPOINT;
+	const int exp_errs[] = {tc->expected_errno, EACCES};
 	int dirfd = AT_FDCWD;
 
 	if (tc->pfd) {
@@ -283,9 +285,9 @@ static void do_test(unsigned int number)
 
 	tst_res(TINFO, "Testing %s with %s",
 		tc->mark.desc, tc->mask.desc);
-	TST_EXP_FD_OR_FAIL(fanotify_mark(fanotify_fd, FAN_MARK_ADD | tc->mark.flags,
-					 tc->mask.flags, dirfd, path),
-					 tc->expected_errno);
+
+	TST_EXP_FAIL_ARR(fanotify_mark(fanotify_fd, FAN_MARK_ADD | tc->mark.flags,
+			 tc->mask.flags, dirfd, path), exp_errs, se_enforcing ? 2 : 1);
 
 	/*
 	 * ENOTDIR are errors for events/flags not allowed on a non-dir inode.
@@ -334,6 +336,8 @@ static void do_setup(void)
 	SAFE_FILE_PRINTF(FILE1, "0");
 	/* Create anonymous pipes to place marks on */
 	SAFE_PIPE2(pipes, O_CLOEXEC);
+
+	se_enforcing = tst_selinux_enforcing();
 }
 
 static void do_cleanup(void)
diff --git a/testcases/kernel/syscalls/fanotify/fanotify23.c b/testcases/kernel/syscalls/fanotify/fanotify23.c
index 5a03503e9..35a613fea 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify23.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify23.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2022 CTERA Networks.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fanotify/fanotify_child.c b/testcases/kernel/syscalls/fanotify/fanotify_child.c
index 2e4e189cb..73f634514 100644
--- a/testcases/kernel/syscalls/fanotify/fanotify_child.c
+++ b/testcases/kernel/syscalls/fanotify/fanotify_child.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2018 Matthew Bobrowski. All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fcntl/.gitignore b/testcases/kernel/syscalls/fcntl/.gitignore
index 10cb0995f..e60176973 100644
--- a/testcases/kernel/syscalls/fcntl/.gitignore
+++ b/testcases/kernel/syscalls/fcntl/.gitignore
@@ -50,8 +50,6 @@
 /fcntl26_64
 /fcntl27
 /fcntl27_64
-/fcntl28
-/fcntl28_64
 /fcntl29
 /fcntl29_64
 /fcntl30
diff --git a/testcases/kernel/syscalls/fcntl/fcntl07.c b/testcases/kernel/syscalls/fcntl/fcntl07.c
index 9108b79c1..10d1186fc 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl07.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl07.c
@@ -101,7 +101,7 @@ static void verify_cloexec(struct tcase *tc)
 
 	sprintf(pidname, "%d", fd);
 
-	switch (pid = FORK_OR_VFORK()) {
+	switch (pid = tst_fork()) {
 	case -1:
 		tst_resm(TBROK | TERRNO, "fork() failed");
 		return;
diff --git a/testcases/kernel/syscalls/fcntl/fcntl08.c b/testcases/kernel/syscalls/fcntl/fcntl08.c
index 5241adfe3..ea7602d9e 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl08.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl08.c
@@ -1,100 +1,42 @@
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
- *  AUTHOR		: William Roske
- *  CO-PILOT		: Dave Fenner
- *
- * This program is free software; you can redistribute it and/or modify it
- * under the terms of version 2 of the GNU General Public License as
- * published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it would be useful, but
- * WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- *
- * Further, this software is distributed without any warranty that it is
- * free of the rightful claim of any third person regarding infringement
- * or the like.  Any license provided herein, whether implied or
- * otherwise, applies only to this software file.  Patent licenses, if
- * any, provided herein do not apply to combinations of this program with
- * other software, or any other product whatsoever.
- *
- * You should have received a copy of the GNU General Public License along
- * with this program; if not, write the Free Software Foundation, Inc.,
- * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
- *
- * Contact information: Silicon Graphics, Inc., 1600 Amphitheatre Pkwy,
- * Mountain View, CA  94043, or:
- *
- * http://www.sgi.com
- *
- * For further information regarding this notice, see:
- *
- * http://oss.sgi.com/projects/GenInfo/NoticeExplan/
- *
+ * Authors: William Roske, Dave Fenner
+ * Copyright (c) 2014 Fujitsu Ltd.
+ * Copyright (c) Linux Test Project, 2005-2015
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-#include <sys/types.h>
-#include <fcntl.h>
-#include <unistd.h>
-#include <sys/stat.h>
-#include <errno.h>
-#include <string.h>
-#include <signal.h>
-
-#include "test.h"
-#include "safe_macros.h"
-
-static void setup(void);
-static void cleanup(void);
+/*\
+ * [Description]
+ *
+ * Basic test for fcntl(2) using F_SETFL with flags O_NDELAY | O_APPEND | O_NONBLOCK.
+ */
 
-char *TCID = "fcntl08";
-int TST_TOTAL = 1;
+#include "lapi/fcntl.h"
+#include "tst_test.h"
 
 static int fd;
 
-int main(int ac, char **av)
+static void setup(void)
 {
-	int lc;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-
-		tst_count = 0;
-
-		TEST(fcntl(fd, F_SETFL, O_NDELAY | O_APPEND | O_NONBLOCK));
-
-		if (TEST_RETURN == -1) {
-			tst_resm(TFAIL | TTERRNO, "fcntl failed");
-		} else {
-			tst_resm(TPASS, "fcntl returned %ld",
-				 TEST_RETURN);
-		}
-
-	}
-
-	cleanup();
-	tst_exit();
+	fd = SAFE_OPEN("testfile", O_RDWR | O_CREAT, 0700);
 }
 
-void setup(void)
+static void cleanup(void)
 {
-
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-
-	tst_tmpdir();
-
-	fd = SAFE_OPEN(cleanup, "test_file", O_RDWR | O_CREAT, 0700);
+	if (fd > 0)
+		SAFE_CLOSE(fd);
 }
 
-void cleanup(void)
+static void run(void)
 {
-	if (close(fd) == -1)
-		tst_resm(TWARN | TERRNO, "close failed");
-
-	tst_rmdir();
+	TST_EXP_PASS(fcntl(fd, F_SETFL, O_NDELAY | O_APPEND | O_NONBLOCK));
 }
+
+static struct tst_test test = {
+	.test_all = run,
+	.setup = setup,
+	.cleanup = cleanup,
+	.needs_tmpdir = 1,
+};
diff --git a/testcases/kernel/syscalls/fcntl/fcntl11.c b/testcases/kernel/syscalls/fcntl/fcntl11.c
index d042c6b9b..4fd9fcca9 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl11.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl11.c
@@ -245,10 +245,6 @@ int main(int ac, char **av)
 	int lc;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "ddddd", &parent_pipe[0],
-			&parent_pipe[1], &child_pipe[0], &child_pipe[1], &fd);
-#endif
 
 	setup();		/* global setup */
 
@@ -257,17 +253,9 @@ int main(int ac, char **av)
 		/* reset tst_count in case we are looping */
 		tst_count = 0;
 
-		if ((child_pid = FORK_OR_VFORK()) == 0) {	/* parent */
-#ifdef UCLINUX
-			if (self_exec(av[0], "ddddd", parent_pipe[0],
-				      parent_pipe[1], child_pipe[0],
-				      child_pipe[1], fd) < 0)
-				tst_brkm(TBROK | TERRNO, cleanup,
-					 "self_exec failed");
-#else
+		if ((child_pid = tst_fork()) == 0) /* parent */
 			do_child();
-#endif
-		} else if (child_pid == -1)
+		else if (child_pid == -1)
 			tst_brkm(TBROK | TERRNO, cleanup, "fork failed");
 
 		SAFE_CLOSE(cleanup, parent_pipe[0]);
diff --git a/testcases/kernel/syscalls/fcntl/fcntl14.c b/testcases/kernel/syscalls/fcntl/fcntl14.c
index ca68d0f98..d38220951 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl14.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl14.c
@@ -547,10 +547,6 @@ char *TCID = "fcntl14";
 int TST_TOTAL = 1;
 int NO_NFS = 1;
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 void cleanup(void)
 {
 	tst_rmdir();
@@ -738,21 +734,14 @@ void dochild(void)
 		 * need some way to have fcntl() atomically unblock a
 		 * signal and wait for the lock.)
 		 */
-		pid = FORK_OR_VFORK();
+		pid = tst_fork();
 		switch (pid) {
 		case -1:
 			tst_resm(TFAIL, "Fork failed");
 			fail = 1;
 			break;
 		case 0:
-#ifdef UCLINUX
-			if (self_exec(argv0, "nd", 1, parent) < 0) {
-				tst_resm(TFAIL, "self_exec failed");
-				break;
-			}
-#else
 			do_usleep_child();
-#endif
 			break;
 
 		default:
@@ -828,19 +817,9 @@ void run_test(int file_flag, int file_mode, int seek, int start, int end)
 		/* flush the stdout to avoid garbled output */
 		fflush(stdout);
 
-		if ((child = FORK_OR_VFORK()) == 0) {
-#ifdef UCLINUX
-			if (self_exec(argv0, "nddddddddd", 2, thiscase->c_type,
-				      thiscase->c_whence, thiscase->c_start,
-				      thiscase->c_len, thiscase->c_flag,
-				      thiscase->a_type, fd, test, parent) < 0) {
-				tst_resm(TFAIL, "self_exec failed");
-				cleanup();
-			}
-#else
+		if ((child = tst_fork()) == 0)
 			dochild();
-#endif
-		}
+
 		if (child < 0)
 			tst_brkm(TBROK|TERRNO, cleanup, "Fork failed");
 
@@ -943,17 +922,6 @@ int main(int ac, char **av)
 	int lc;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	argv0 = av[0];
-
-	maybe_run_child(&do_usleep_child, "nd", 1, &parent);
-	thiscase = malloc(sizeof(testcase));
-
-	maybe_run_child(&dochild, "nddddddddd", 2, &thiscase->c_type,
-			&thiscase->c_whence, &thiscase->c_start,
-			&thiscase->c_len, &thiscase->c_flag, &thiscase->a_type,
-			&fd, &test, &parent);
-#endif
 
 	setup();
 
@@ -1079,19 +1047,9 @@ int main(int ac, char **av)
 		if (sighold(SIGUSR1) < 0)
 			tst_brkm(TBROK, cleanup, "sighold failed");
 
-		if ((child = FORK_OR_VFORK()) == 0) {
-#ifdef UCLINUX
-			if (self_exec(argv0, "nddddddddd", 2, thiscase->c_type,
-				      thiscase->c_whence, thiscase->c_start,
-				      thiscase->c_len, thiscase->c_flag,
-				      thiscase->a_type, fd, test, parent) < 0) {
-				tst_resm(TFAIL, "self_exec failed");
-				cleanup();
-			}
-#else
+		if ((child = tst_fork()) == 0)
 			dochild();
-#endif
-		}
+
 		if (child < 0)
 			tst_brkm(TBROK|TERRNO, cleanup, "Fork failed");
 
diff --git a/testcases/kernel/syscalls/fcntl/fcntl16.c b/testcases/kernel/syscalls/fcntl/fcntl16.c
index a77a81298..4ae9e6e7a 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl16.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl16.c
@@ -279,10 +279,6 @@ extern void catch_int(int sig);	/* signal catching subroutine */
 char *TCID = "fcntl16";
 int TST_TOTAL = 1;
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 /*
  * cleanup - performs all the ONE TIME cleanup for this test at completion or
  *	premature exit
@@ -339,15 +335,6 @@ void dochild(int kid)
 	exit(0);
 }				/* end of child process */
 
-#ifdef UCLINUX
-static int kid_uc;
-
-void dochild_uc(void)
-{
-	dochild(kid_uc);
-}
-#endif
-
 void catch_alarm(int sig)
 {
 	alarm_flag = 1;
@@ -497,17 +484,8 @@ int run_test(int file_flag, int file_mode, int start, int end)
 		/* spawn child processes */
 		for (i = 0; i < 2; i++) {
 			if (thislock->l_type != IGNORED) {
-				if ((child = FORK_OR_VFORK()) == 0) {
-#ifdef UCLINUX
-					if (self_exec(argv0, "ddddd", i, parent,
-						      test, thislock, fd) < 0) {
-						perror("self_exec failed");
-						return 1;
-					}
-#else
+				if ((child = tst_fork()) == 0)
 					dochild(i);
-#endif
-				}
 				if (child < 0) {
 					perror("Fork failed");
 					return 1;
@@ -654,11 +632,6 @@ int main(int ac, char **av)
 	int lc;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(dochild_uc, "ddddd", &kid_uc, &parent, &test,
-			&thislock, &fd);
-	argv0 = av[0];
-#endif
 
 	setup();		/* global setup */
 
diff --git a/testcases/kernel/syscalls/fcntl/fcntl17.c b/testcases/kernel/syscalls/fcntl/fcntl17.c
index e055f1a12..5a52f0af3 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl17.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl17.c
@@ -438,23 +438,6 @@ int main(int ac, char **av)
 	int fail = 0;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child1, "nddddddddd", 1, &file_fd,
-			&parent_pipe[0], &parent_pipe[1],
-			&child_pipe1[0], &child_pipe1[1],
-			&child_pipe2[0], &child_pipe2[1],
-			&child_pipe3[0], &child_pipe3[1]);
-	maybe_run_child(&do_child2, "nddddddddd", 2, &file_fd,
-			&parent_pipe[0], &parent_pipe[1],
-			&child_pipe1[0], &child_pipe1[1],
-			&child_pipe2[0], &child_pipe2[1],
-			&child_pipe3[0], &child_pipe3[1]);
-	maybe_run_child(&do_child3, "nddddddddd", 3, &file_fd,
-			&parent_pipe[0], &parent_pipe[1],
-			&child_pipe1[0], &child_pipe1[1],
-			&child_pipe2[0], &child_pipe2[1],
-			&child_pipe3[0], &child_pipe3[1]);
-#endif
 
 	if (setup()) {		/* global testup */
 		tst_resm(TINFO, "setup failed");
@@ -467,56 +450,22 @@ int main(int ac, char **av)
 		tst_count = 0;
 
 		tst_resm(TINFO, "Enter preparation phase");
-		if ((child_pid1 = FORK_OR_VFORK()) == 0) {	/* first child */
-#ifdef UCLINUX
-			if (self_exec(av[0], "nddddddddd", 1, file_fd,
-				      parent_pipe[0], parent_pipe[1],
-				      child_pipe1[0], child_pipe1[1],
-				      child_pipe2[0], child_pipe2[1],
-				      child_pipe3[0], child_pipe3[1]) < 0) {
-				perror("self_exec failed, child 1");
-				cleanup();
-			}
-#else
+		if ((child_pid1 = tst_fork()) == 0)	/* first child */
 			do_child1();
-#endif
-		} else if (child_pid1 < 0)
+		else if (child_pid1 < 0)
 			tst_brkm(TBROK|TERRNO, cleanup, "Fork failed: child 1");
 
 		/* parent */
 
-		if ((child_pid2 = fork()) == 0) {	/* second child */
-#ifdef UCLINUX
-			if (self_exec(av[0], "nddddddddd", 2, file_fd,
-				      parent_pipe[0], parent_pipe[1],
-				      child_pipe1[0], child_pipe1[1],
-				      child_pipe2[0], child_pipe2[1],
-				      child_pipe3[0], child_pipe3[1]) < 0) {
-				perror("self_exec failed, child 2");
-				cleanup();
-			}
-#else
+		if ((child_pid2 = fork()) == 0)	/* second child */
 			do_child2();
-#endif
-		} else if (child_pid2 < 0) {
+		else if (child_pid2 < 0)
 			tst_brkm(TBROK|TERRNO, cleanup, "Fork failed: child 2");
-		}
 
 		/* parent */
 
 		if ((child_pid3 = fork()) == 0) {	/* third child */
-#ifdef UCLINUX
-			if (self_exec(av[0], "nddddddddd", 3, file_fd,
-				      parent_pipe[0], parent_pipe[1],
-				      child_pipe1[0], child_pipe1[1],
-				      child_pipe2[0], child_pipe2[1],
-				      child_pipe3[0], child_pipe3[1]) < 0) {
-				perror("self_exec failed, child 3");
-				cleanup();
-			}
-#else
 			do_child3();
-#endif
 			do_child3();
 		} else if (child_pid3 < 0) {
 			tst_brkm(TBROK|TERRNO, cleanup, "Fork failed: child 3");
diff --git a/testcases/kernel/syscalls/fcntl/fcntl18.c b/testcases/kernel/syscalls/fcntl/fcntl18.c
index 1105dd393..7a26f65a2 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl18.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl18.c
@@ -70,8 +70,6 @@ int main(int ac, char **av)
 	setup();		/* global setup */
 
 /* //block1: */
-#ifndef UCLINUX
-	/* Skip since uClinux does not implement memory protection */
 	tst_resm(TINFO, "Enter block 1");
 	fail = 0;
 	if ((fd = open("temp.dat", O_CREAT | O_RDWR, 0777)) < 0) {	//mode must be specified when O_CREATE is in the flag
@@ -93,13 +91,8 @@ int main(int ac, char **av)
 		tst_resm(TINFO, "Block 1 PASSED");
 	}
 	tst_resm(TINFO, "Exit block 1");
-#else
-	tst_resm(TINFO, "Skip block 1 on uClinux");
-#endif
 
 /* //block2: */
-#ifndef UCLINUX
-	/* Skip since uClinux does not implement memory protection */
 	tst_resm(TINFO, "Enter block 2");
 	fail = 0;
 	/* Error condition if address is bad */
@@ -116,14 +109,11 @@ int main(int ac, char **av)
 		tst_resm(TINFO, "Block 2 PASSED");
 	}
 	tst_resm(TINFO, "Exit block 2");
-#else
-	tst_resm(TINFO, "Skip block 2 on uClinux");
-#endif
 
 /* //block3: */
 	tst_resm(TINFO, "Enter block 3");
 	fail = 0;
-	if ((pid = FORK_OR_VFORK()) == 0) {	/* child */
+	if ((pid = tst_fork()) == 0) {	/* child */
 		fail = 0;
 		pass = getpwnam("nobody");
 		retval = setreuid(-1, pass->pw_uid);
diff --git a/testcases/kernel/syscalls/fcntl/fcntl19.c b/testcases/kernel/syscalls/fcntl/fcntl19.c
index f929aff99..a58e921c3 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl19.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl19.c
@@ -284,10 +284,6 @@ int main(int ac, char **av)
 	int lc;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "ddddd", &parent_pipe[0], &parent_pipe[1],
-			&child_pipe[0], &child_pipe[1], &fd);
-#endif
 
 	setup();		/* global setup */
 
@@ -296,17 +292,8 @@ int main(int ac, char **av)
 		/* reset tst_count in case we are looping */
 		tst_count = 0;
 
-		if ((child_pid = FORK_OR_VFORK()) == 0) {	/* child */
-#ifdef UCLINUX
-			if (self_exec
-			    (av[0], "ddddd", parent_pipe[0], parent_pipe[1],
-			     child_pipe[0], child_pipe[1], fd) < 0) {
-				tst_resm(TFAIL, "self_exec failed");
-				cleanup();
-			}
-#else
+		if ((child_pid = tst_fork()) == 0) {	/* child */
 			do_child();
-#endif
 		} else if (child_pid < 0) {
 			tst_resm(TFAIL, "Fork failed");
 			cleanup();
diff --git a/testcases/kernel/syscalls/fcntl/fcntl20.c b/testcases/kernel/syscalls/fcntl/fcntl20.c
index 4aa773451..f271eeb2d 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl20.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl20.c
@@ -283,10 +283,6 @@ int main(int ac, char **av)
 	int lc;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "ddddd", &parent_pipe[0], &parent_pipe[1],
-			&child_pipe[0], &child_pipe[1], &fd);
-#endif
 
 	setup();		/* global setup */
 
@@ -295,18 +291,8 @@ int main(int ac, char **av)
 		/* reset tst_count in case we are looping */
 		tst_count = 0;
 
-		if ((child_pid = FORK_OR_VFORK()) == 0) {	/* child */
-#ifdef UCLINUX
-			if (self_exec
-			    (av[0], "ddddd", parent_pipe[0], parent_pipe[1],
-			     child_pipe[0], child_pipe[1], fd) < 0) {
-				tst_resm(TFAIL, "self_exec failed");
-				cleanup();
-			}
-#else
+		if ((child_pid = tst_fork()) == 0)	/* child */
 			do_child();
-#endif
-		}
 
 		if (child_pid < 0) {
 			tst_resm(TFAIL, "Fork failed");
diff --git a/testcases/kernel/syscalls/fcntl/fcntl21.c b/testcases/kernel/syscalls/fcntl/fcntl21.c
index 824b8c059..a262ae8dd 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl21.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl21.c
@@ -291,11 +291,6 @@ int main(int ac, char **av)
 	int lc;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "ddddd", &parent_pipe[0], &parent_pipe[1],
-			&child_pipe[0], &child_pipe[1], &fd);
-#endif
-
 	setup();		/* global setup */
 
 	/* Check for looping state if -i option is given */
@@ -303,18 +298,9 @@ int main(int ac, char **av)
 		/* reset tst_count in case we are looping */
 		tst_count = 0;
 
-		if ((child_pid = FORK_OR_VFORK()) == 0) {
-#ifdef UCLINUX
-			if (self_exec
-			    (av[0], "ddddd", parent_pipe[0], parent_pipe[1],
-			     child_pipe[0], child_pipe[1], fd) < 0) {
-				tst_resm(TFAIL, "self_exec failed");
-				cleanup();
-			}
-#else
+		if ((child_pid = tst_fork()) == 0)
 			do_child();
-#endif
-		}
+
 		if (child_pid < 0) {
 			tst_resm(TFAIL, "Fork failed");
 			cleanup();
diff --git a/testcases/kernel/syscalls/fcntl/fcntl22.c b/testcases/kernel/syscalls/fcntl/fcntl22.c
index 2e94a1257..507934389 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl22.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl22.c
@@ -60,7 +60,7 @@ int main(int ac, char **av)
 	for (lc = 0; TEST_LOOPING(lc); lc++) {
 		tst_count = 0;
 
-		child_pid = FORK_OR_VFORK();
+		child_pid = tst_fork();
 		switch (child_pid) {
 		case 0:
 			TEST(fcntl(file, F_SETLK, &fl));
diff --git a/testcases/kernel/syscalls/fcntl/fcntl27.c b/testcases/kernel/syscalls/fcntl/fcntl27.c
index eeb5d63c9..6dbf58feb 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl27.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl27.c
@@ -1,192 +1,47 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *
- *   Copyright (C) Bull S.A. 2005
- *   Copyright (c) International Business Machines  Corp., 2004
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2004
+ * Copyright (C) Bull S.A.S 2005-2006
+ * Author: Jacky Malcles
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/**********************************************************
- *
- *    TEST IDENTIFIER		 : fcntl27
- *
- *    EXECUTED BY		 : anyone
- *
- *    TEST TITLE		 : Basic test for fcntl(2) using F_SETLEASE & F_RDLCK argument.
- *
- *    TEST CASE TOTAL		 : 1
- *
- *    WALL CLOCK TIME		 : 1
- *
- *    CPU TYPES				 : ALL
- *
- *    AUTHOR				 : Jacky Malcles
- *
- *    TEST CASES
- *
- *		 1.) fcntl(2) returns...(See Description)
- *
- *    INPUT SPECIFICATIONS
- *		 The standard options for system call tests are accepted.
- *		 (See the parse_opts(3) man page).
- *
- *    OUTPUT SPECIFICATIONS
- *
- *    DURATION
- *		 Terminates - with frequency and infinite modes.
- *
- *    SIGNALS
- *		 Uses SIGUSR1 to pause before test if option set.
- *		 (See the parse_opts(3) man page).
- *
- *    RESOURCES
- *		 None
- *
- *    ENVIRONMENTAL NEEDS
- *      No run-time environmental needs.
- *
- *    SPECIAL PROCEDURAL REQUIREMENTS
- *		 None
- *
- *    INTERCASE DEPENDENCIES
- *		 None
- *
- *    DETAILED DESCRIPTION
- *		 This is a Phase I test for the fcntl(2) system call.  It is intended
- *		 to provide a limited exposure of the system call, for now.  It
- *		 should/will be extended when full functional tests are written for
- *		 fcntl(2).
- *
- *		 Setup:
- *		   Setup signal handling.
- *		   Pause for SIGUSR1 if option specified.
+/*\
+ * [Description]
  *
- *		 Test:
- *		  Loop if the proper options are given.
- *		   Execute system call
- *		   Check return code, if system call failed (return=-1)
- *				 Log the errno and Issue a FAIL message.
- *		   Otherwise, Issue a PASS message.
- *
- *		 Cleanup:
- *		   Print errno log and/or timing stats if options given
- *
- *
- *#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#**/
-
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <fcntl.h>
-#include <unistd.h>
-#include <errno.h>
-#include <string.h>
-#include <signal.h>
-#include "test.h"
-
-void setup();
-void cleanup();
+ * Basic test for fcntl(2) using F_SETLEASE and F_RDLCK argument,
+ * testing O_RDWR and O_WRONLY.
+ */
 
-char *TCID = "fcntl27";
-int TST_TOTAL = 1;
+#include "lapi/fcntl.h"
+#include "tst_test.h"
 
-char fname[255];
-int fd;
+#define TC(x, y) .oflags = x, .mode = y, .desc = #x " with mode " #y,
 
-int main(int ac, char **av)
+static struct test_case
 {
-	int lc, expected_result = -1;
-    /***************************************************************
-     * parse standard options
-     ***************************************************************/
-	tst_parse_opts(ac, av, NULL, NULL);
-
-    /***************************************************************
-     * perform global setup for test
-     ***************************************************************/
-	setup();
-
-	expected_result = -1;
-
-    /***************************************************************
-     * check looping state if -c option given
-     ***************************************************************/
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-
-		tst_count = 0;
-
-#ifdef F_SETLEASE
-		/*
-		 * Call fcntl(2) with F_SETLEASE & F_RDLCK argument on fname
-		 */
-		TEST(fcntl(fd, F_SETLEASE, F_RDLCK));
-
-		/* check return code */
-		if (TEST_RETURN == expected_result) {
-			tst_resm(TPASS,
-				 "fcntl(fd, F_SETLEASE, F_RDLCK) succeeded");
-		} else {
-			tst_resm(TFAIL, "fcntl(%s, F_SETLEASE, F_RDLCK)"
-				 " failed with errno %d : %s", fname,
-				 TEST_ERRNO, strerror(TEST_ERRNO));
-		}
-#else
-		tst_resm(TINFO, "F_SETLEASE not defined, skipping test");
-#endif
-	}
-
-    /***************************************************************
-     * cleanup and exit
-     ***************************************************************/
-	cleanup();
-	tst_exit();
-
-}
-
-/***************************************************************
- * setup() - performs all ONE TIME setup for this test.
- ***************************************************************/
-void setup(void)
+	int oflags;
+	mode_t mode;
+	char *desc;
+} tcases[] = {
+	{ TC(O_RDWR | O_CREAT, 0777) },
+	{ TC(O_WRONLY | O_CREAT, 0222) },
+};
+
+static void verify_fcntl(unsigned int nr)
 {
+	struct test_case *tc = &tcases[nr];
 
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
+	tst_res(TINFO, "Testing %s", tc->desc);
 
-	tst_tmpdir();
+	int fd = SAFE_OPEN("testfile", tc->oflags, tc->mode);
 
-	sprintf(fname, "tfile_%d", getpid());
-	if ((fd = open(fname, O_RDWR | O_CREAT, 0777)) == -1) {
-		tst_brkm(TBROK, cleanup,
-			 "open(%s, O_RDWR|O_CREAT,0777) Failed, errno=%d : %s",
-			 fname, errno, strerror(errno));
-	}
+	TST_EXP_FAIL(fcntl(fd, F_SETLEASE, F_RDLCK), EAGAIN);
+	SAFE_CLOSE(fd);
 }
 
-/***************************************************************
- * cleanup() - performs all ONE TIME cleanup for this test at
- *				 completion or premature exit.
- ***************************************************************/
-void cleanup(void)
-{
-
-	/* close the file we've had open */
-	if (close(fd) == -1) {
-		tst_resm(TWARN, "close(%s) Failed, errno=%d : %s", fname, errno,
-			 strerror(errno));
-	}
-
-	tst_rmdir();
-
-}
+static struct tst_test test = {
+	.test = verify_fcntl,
+	.tcnt = ARRAY_SIZE(tcases),
+	.needs_tmpdir = 1,
+};
diff --git a/testcases/kernel/syscalls/fcntl/fcntl28.c b/testcases/kernel/syscalls/fcntl/fcntl28.c
deleted file mode 100644
index 4da04c48e..000000000
--- a/testcases/kernel/syscalls/fcntl/fcntl28.c
+++ /dev/null
@@ -1,190 +0,0 @@
-/*
- *   Copyright (C) Bull S.A.S  2006
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- */
-
-/**********************************************************
- *
- *    TEST IDENTIFIER		 : fcntl28
- *
- *    EXECUTED BY		 : anyone
- *
- *    TEST TITLE		 : Basic test for fcntl(2) using F_SETLEASE & F_RDLCK argument.
- *
- *    TEST CASE TOTAL		 : 1
- *
- *    WALL CLOCK TIME		 : 1
- *
- *    CPU TYPES				 : ALL
- *
- *    AUTHOR				 : Jacky Malcles
- *
- *    TEST CASES
- *
- *		 1.) fcntl(2) returns...(See Description)
- *
- *    INPUT SPECIFICATIONS
- *		 The standard options for system call tests are accepted.
- *		 (See the parse_opts(3) man page).
- *
- *    OUTPUT SPECIFICATIONS
- *
- *    DURATION
- *		 Terminates - with frequency and infinite modes.
- *
- *    SIGNALS
- *		 Uses SIGUSR1 to pause before test if option set.
- *		 (See the parse_opts(3) man page).
- *
- *    RESOURCES
- *		 None
- *
- *    ENVIRONMENTAL NEEDS
- *      No run-time environmental needs.
- *
- *    SPECIAL PROCEDURAL REQUIREMENTS
- *		 None
- *
- *    INTERCASE DEPENDENCIES
- *		 None
- *
- *    DETAILED DESCRIPTION
- *		 This is a Phase I test for the fcntl(2) system call.  It is intended
- *		 to provide a limited exposure of the system call, for now.  It
- *		 should/will be extended when full functional tests are written for
- *		 fcntl(2).
- *
- *		 Setup:
- *		   Setup signal handling.
- *		   Pause for SIGUSR1 if option specified.
- *
- *		 Test:
- *		  Loop if the proper options are given.
- *		   Execute system call
- *		   Check return code, if system call failed (return=-1)
- *				 Log the errno and Issue a FAIL message.
- *		   Otherwise, Issue a PASS message.
- *
- *		 Cleanup:
- *		   Print errno log and/or timing stats if options given
- *
- *
- *#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#**/
-
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <fcntl.h>
-#include <unistd.h>
-#include <errno.h>
-#include <string.h>
-#include <signal.h>
-#include "test.h"
-
-void setup();
-void cleanup();
-
-char *TCID = "fcntl28";
-int TST_TOTAL = 1;
-
-char fname[255];
-int fd;
-
-int main(int ac, char **av)
-{
-	int lc, expected_result = -1;
-    /***************************************************************
-     * parse standard options
-     ***************************************************************/
-	tst_parse_opts(ac, av, NULL, NULL);
-
-    /***************************************************************
-     * perform global setup for test
-     ***************************************************************/
-	setup();
-
-	expected_result = -1;
-
-    /***************************************************************
-     * check looping state if -c option given
-     ***************************************************************/
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-
-		tst_count = 0;
-
-#ifdef F_SETLEASE
-		/*
-		 * Call fcntl(2) with F_SETLEASE & F_RDLCK argument on fname
-		 */
-		TEST(fcntl(fd, F_SETLEASE, F_RDLCK));
-
-		/* check return code */
-		if (TEST_RETURN == expected_result) {
-			tst_resm(TPASS,
-				 "fcntl(fd, F_SETLEASE, F_RDLCK) succeeded");
-		} else {
-			tst_resm(TFAIL, "fcntl(%s, F_SETLEASE, F_RDLCK)"
-				 " failed with errno %d : %s", fname,
-				 TEST_ERRNO, strerror(TEST_ERRNO));
-		}
-
-#else
-		tst_resm(TINFO, "F_SETLEASE not defined, skipping test");
-#endif
-	}
-
-    /***************************************************************
-     * cleanup and exit
-     ***************************************************************/
-	cleanup();
-	tst_exit();
-
-}
-
-/***************************************************************
- * setup() - performs all ONE TIME setup for this test.
- ***************************************************************/
-void setup(void)
-{
-
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-
-	tst_tmpdir();
-
-	sprintf(fname, "tfile_%d", getpid());
-	if ((fd = open(fname, O_WRONLY | O_CREAT, 0222)) == -1) {
-		tst_brkm(TBROK, cleanup,
-			 "open(%s, O_WRONLY|O_CREAT,0222) Failed, errno=%d : %s",
-			 fname, errno, strerror(errno));
-	}
-}
-
-/***************************************************************
- * cleanup() - performs all ONE TIME cleanup for this test at
- *				 completion or premature exit.
- ***************************************************************/
-void cleanup(void)
-{
-
-	/* close the file we've had open */
-	if (close(fd) == -1) {
-		tst_resm(TWARN, "close(%s) Failed, errno=%d : %s", fname, errno,
-			 strerror(errno));
-	}
-
-	tst_rmdir();
-
-}
diff --git a/testcases/kernel/syscalls/fcntl/fcntl29.c b/testcases/kernel/syscalls/fcntl/fcntl29.c
index c94c9e748..24d3983ed 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl29.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl29.c
@@ -1,102 +1,49 @@
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Fujitsu Ltd.
  * Author: Xiaoguang Wang <wangxg.fnst@cn.fujitsu.com>
- *
- * This program is free software; you can redistribute it and/or modify it
- * under the terms of version 2 of the GNU General Public License as
- * published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it would be useful, but
- * WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- *
- * You should have received a copy of the GNU General Public License along
- * with this program; if not, write the Free Software Foundation, Inc.,
- * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
- * Description:
- * Verify that,
- *   Basic test for fcntl(2) using F_DUPFD_CLOEXEC argument.
+/*\
+ * [Description]
+ *
+ * Basic test for fcntl(2) using F_DUPFD_CLOEXEC and getting FD_CLOEXEC.
  */
 
-#include <stdio.h>
-#include <errno.h>
-#include <unistd.h>
-#include <string.h>
-#include <signal.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <pwd.h>
-
-#include "test.h"
-#include "safe_macros.h"
 #include "lapi/fcntl.h"
+#include <tst_test.h>
 
-char *TCID = "fcntl29";
-int TST_TOTAL = 1;
-
-static void setup(void);
-static void cleanup(void);
+static int fd;
 
-static int test_fd;
-
-int main(int ac, char **av)
+static void setup(void)
 {
-	int lc, dup_fd;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-
-		TEST(fcntl(test_fd, F_DUPFD_CLOEXEC, 0));
-		if (TEST_RETURN < 0) {
-			tst_brkm(TFAIL | TTERRNO, cleanup, "fcntl "
-				 "test F_DUPFD_CLOEXEC failed");
-		}
-		dup_fd = TEST_RETURN;
-
-		TEST(fcntl(dup_fd, F_GETFD));
-		if (TEST_RETURN < 0) {
-			SAFE_CLOSE(cleanup, dup_fd);
-			tst_brkm(TFAIL | TTERRNO, cleanup, "fcntl "
-				 "test F_GETFD failed");
-		}
-
-		if (TEST_RETURN & FD_CLOEXEC) {
-			tst_resm(TPASS, "fcntl test "
-				 "F_DUPFD_CLOEXEC success");
-		} else {
-			tst_resm(TFAIL, "fcntl test "
-				 "F_DUPFD_CLOEXEC fail");
-		}
-
-		SAFE_CLOSE(cleanup, dup_fd);
-	}
-
-	cleanup();
-	tst_exit();
+	fd = SAFE_CREAT("testfile", 0644);
 }
 
-static void setup(void)
+static void cleanup(void)
 {
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-
-	tst_tmpdir();
-
-	TEST_PAUSE;
-
-	test_fd = SAFE_CREAT(cleanup, "testfile", 0644);
+	if (fd > 0)
+		SAFE_CLOSE(fd);
 }
 
-static void cleanup(void)
+static void run(void)
 {
-	if (test_fd > 0)
-		SAFE_CLOSE(NULL, test_fd);
+	TST_EXP_FD(fcntl(fd, F_DUPFD_CLOEXEC, 0));
+	int dup_fd = TST_RET;
+
+	TST_EXP_POSITIVE(fcntl(dup_fd, F_GETFD), "fcntl test F_GETFD");
+	if (TST_RET & FD_CLOEXEC)
+		tst_res(TPASS, "fcntl() set FD_CLOEXEC");
+	else
+		tst_res(TFAIL, "fcntl() did not set FD_CLOEXEC");
 
-	tst_rmdir();
+	SAFE_CLOSE(dup_fd);
 }
+
+static struct tst_test test = {
+	.test_all = run,
+	.setup = setup,
+	.cleanup = cleanup,
+	.needs_tmpdir = 1,
+};
diff --git a/testcases/kernel/syscalls/fcntl/fcntl30.c b/testcases/kernel/syscalls/fcntl/fcntl30.c
index 64bbb9e3a..725385b39 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl30.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl30.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Fujitsu Ltd.
  * Author: Xiaoguang Wang <wangxg.fnst@cn.fujitsu.com>
diff --git a/testcases/kernel/syscalls/fcntl/fcntl33.c b/testcases/kernel/syscalls/fcntl/fcntl33.c
index 3c6a38b81..e0a2009b5 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl33.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl33.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2015 Fujitsu Ltd.
  * Author: Guangwen Feng <fenggw-fnst@cn.fujitsu.com>
diff --git a/testcases/kernel/syscalls/fcntl/fcntl35.c b/testcases/kernel/syscalls/fcntl/fcntl35.c
index 2d730377b..def5ccef4 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl35.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl35.c
@@ -30,6 +30,9 @@
 
 #include "lapi/fcntl.h"
 #include "tst_test.h"
+#include "pgsize_helpers.h"
+
+#define PIPE_DEF_BUFFERS 16
 
 static int pipe_max_unpriv;
 static int test_max_unpriv;
@@ -47,7 +50,12 @@ static struct tcase {
 static void setup(void)
 {
 	test_max_unpriv = getpagesize();
-	test_max_priv = test_max_unpriv * 16;
+	/*
+	 * The test doesn't set the pipe's size so we are actually checking the default size.
+	 * In the case of a privileged user this is determined by PIPE_DEF_BUFFERS number of
+	 * pages in the kernel.
+	 */
+	test_max_priv = kernel_page_size() * PIPE_DEF_BUFFERS;
 
 	if (!access("/proc/sys/fs/pipe-max-size", F_OK)) {
 		SAFE_FILE_SCANF("/proc/sys/fs/pipe-max-size", "%d",
diff --git a/testcases/kernel/syscalls/fcntl/fcntl38.c b/testcases/kernel/syscalls/fcntl/fcntl38.c
index 2f1b0229e..d867bf876 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl38.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl38.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2020 CTERA Networks. All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/fcntl/fcntl39.c b/testcases/kernel/syscalls/fcntl/fcntl39.c
index 973b6a652..30aada2aa 100644
--- a/testcases/kernel/syscalls/fcntl/fcntl39.c
+++ b/testcases/kernel/syscalls/fcntl/fcntl39.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2021 CTERA Networks. All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/finit_module/finit_module01.c b/testcases/kernel/syscalls/finit_module/finit_module01.c
index 1929c30fa..1546d4fb7 100644
--- a/testcases/kernel/syscalls/finit_module/finit_module01.c
+++ b/testcases/kernel/syscalls/finit_module/finit_module01.c
@@ -13,18 +13,26 @@
  * Inserts a simple module after opening and mmaping the module file.
  */
 
+#include <stdlib.h>
 #include <errno.h>
 #include "lapi/init_module.h"
 #include "tst_module.h"
+#include "tst_kconfig.h"
 
 #define MODULE_NAME	"finit_module.ko"
 
-static int fd;
+static int fd, sig_enforce;
 
 static char *mod_path;
 
 static void setup(void)
 {
+	struct tst_kcmdline_var params = TST_KCMDLINE_INIT("module.sig_enforce");
+
+	tst_kcmdline_parse(&params, 1);
+	if (params.found)
+		sig_enforce = atoi(params.value);
+
 	tst_module_exists(MODULE_NAME, &mod_path);
 
 	fd = SAFE_OPEN(mod_path, O_RDONLY|O_CLOEXEC);
@@ -32,6 +40,12 @@ static void setup(void)
 
 static void run(void)
 {
+	if (sig_enforce == 1) {
+		tst_res(TINFO, "module signature is enforced");
+		TST_EXP_FAIL(finit_module(fd, "status=valid", 0), EKEYREJECTED);
+		return;
+	}
+
 	TST_EXP_PASS(finit_module(fd, "status=valid", 0));
 	if (!TST_PASS)
 		return;
diff --git a/testcases/kernel/syscalls/finit_module/finit_module02.c b/testcases/kernel/syscalls/finit_module/finit_module02.c
index 223d9b388..2fe70af4d 100644
--- a/testcases/kernel/syscalls/finit_module/finit_module02.c
+++ b/testcases/kernel/syscalls/finit_module/finit_module02.c
@@ -14,9 +14,11 @@
  */
 
 #include <linux/capability.h>
+#include <stdlib.h>
 #include <errno.h>
 #include "lapi/init_module.h"
 #include "tst_module.h"
+#include "tst_kconfig.h"
 #include "tst_capability.h"
 
 #define MODULE_NAME	"finit_module.ko"
@@ -25,7 +27,7 @@
 static char *mod_path;
 
 static int fd, fd_zero, fd_invalid = -1, fd_dir;
-static int kernel_lockdown, secure_boot;
+static int kernel_lockdown, secure_boot, sig_enforce;
 
 static struct tst_cap cap_req = TST_CAP(TST_CAP_REQ, CAP_SYS_MODULE);
 static struct tst_cap cap_drop = TST_CAP(TST_CAP_DROP, CAP_SYS_MODULE);
@@ -59,27 +61,27 @@ static void dir_setup(struct tcase *tc)
 }
 
 static struct tcase tcases[] = {
-	{"invalid-fd", &fd_invalid, "", O_RDONLY | O_CLOEXEC, 0, 0, 0, 0,
-		bad_fd_setup},
+	{"invalid-fd", &fd_invalid, "", O_RDONLY | O_CLOEXEC, 0, 0, 0, 0, bad_fd_setup},
 	{"zero-fd", &fd_zero, "", O_RDONLY | O_CLOEXEC, 0, 0, EINVAL, 0, NULL},
 	{"null-param", &fd, NULL, O_RDONLY | O_CLOEXEC, 0, 0, EFAULT, 1, NULL},
-	{"invalid-param", &fd, "status=invalid", O_RDONLY | O_CLOEXEC, 0, 0,
-		EINVAL, 1, NULL},
-	{"invalid-flags", &fd, "", O_RDONLY | O_CLOEXEC, -1, 0, EINVAL, 0,
-		NULL},
+	{"invalid-param", &fd, "status=invalid", O_RDONLY | O_CLOEXEC, 0, 0, EINVAL, 1, NULL},
+	{"invalid-flags", &fd, "", O_RDONLY | O_CLOEXEC, -1, 0, EINVAL, 0, NULL},
 	{"no-perm", &fd, "", O_RDONLY | O_CLOEXEC, 0, 1, EPERM, 0, NULL},
-	{"module-exists", &fd, "", O_RDONLY | O_CLOEXEC, 0, 0, EEXIST, 1,
-		NULL},
-	{"file-not-readable", &fd, "", O_WRONLY | O_CLOEXEC, 0, 0, EBADF, 0,
-		NULL},
-	{"file-readwrite", &fd, "", O_RDWR | O_CLOEXEC, 0, 0, ETXTBSY, 0,
-		NULL},
+	{"module-exists", &fd, "", O_RDONLY | O_CLOEXEC, 0, 0, EEXIST, 1, NULL},
+	{"module-unsigned", &fd, "", O_RDONLY | O_CLOEXEC, 0, 0, EKEYREJECTED, 1, NULL},
+	{"file-not-readable", &fd, "", O_WRONLY | O_CLOEXEC, 0, 0, EBADF, 0, NULL},
+	{"file-readwrite", &fd, "", O_RDWR | O_CLOEXEC, 0, 0, ETXTBSY, 0, NULL},
 	{"directory", &fd_dir, "", O_RDONLY | O_CLOEXEC, 0, 0, 0, 0, dir_setup},
 };
 
 static void setup(void)
 {
 	unsigned long int i;
+	struct tst_kcmdline_var params = TST_KCMDLINE_INIT("module.sig_enforce");
+
+	tst_kcmdline_parse(&params, 1);
+	if (params.found)
+		sig_enforce = atoi(params.value);
 
 	tst_module_exists(MODULE_NAME, &mod_path);
 
@@ -109,6 +111,16 @@ static void run(unsigned int n)
 		return;
 	}
 
+	if ((sig_enforce == 1) && (tc->exp_errno != EKEYREJECTED)) {
+		tst_res(TCONF, "module signature is enforced, skipping %s", tc->name);
+		return;
+	}
+
+	if ((sig_enforce != 1) && (tc->exp_errno == EKEYREJECTED)) {
+		tst_res(TCONF, "module signature is not enforced, skipping %s", tc->name);
+		return;
+	}
+
 	fd = SAFE_OPEN(mod_path, tc->open_flags);
 
 	if (tc->cap)
diff --git a/testcases/kernel/syscalls/fork/fork04.c b/testcases/kernel/syscalls/fork/fork04.c
index 1a515987e..b0c6bebe0 100644
--- a/testcases/kernel/syscalls/fork/fork04.c
+++ b/testcases/kernel/syscalls/fork/fork04.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * Copyright (c) Linux Test Project, 2001-2023
diff --git a/testcases/kernel/syscalls/fork/fork13.c b/testcases/kernel/syscalls/fork/fork13.c
index bbfbf5c3b..4923d8a91 100644
--- a/testcases/kernel/syscalls/fork/fork13.c
+++ b/testcases/kernel/syscalls/fork/fork13.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) 2010  Red Hat, Inc.
  * Copyright (C) 2022 Cyril Hrubis <chrubis@suse.cz>
diff --git a/testcases/kernel/syscalls/fork/fork14.c b/testcases/kernel/syscalls/fork/fork14.c
index 93af2ebac..d61864b52 100644
--- a/testcases/kernel/syscalls/fork/fork14.c
+++ b/testcases/kernel/syscalls/fork/fork14.c
@@ -1,143 +1,124 @@
-/*********************************************************************
+// SPDX-License-Identifier: GPL-2.0-only
+/*
  * Copyright (C) 2014  Red Hat, Inc.
+ * Copyright (C) 2024 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
+ */
+
+/*\
+ * [Description]
  *
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of version 2 of the GNU General Public
- * License as published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it would be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- *
- * Further, this software is distributed without any warranty that it
- * is free of the rightful claim of any third person regarding
- * infringement or the like.  Any license provided herein, whether
- * implied or otherwise, applies only to this software file.  Patent
- * licenses, if any, provided herein do not apply to combinations of
- * this program with other software, or any other product whatsoever.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
- * 02110-1301, USA.
+ * This test is a reproducer for kernel 3.5:
+ * 7edc8b0ac16c ("mm/fork: fix overflow in vma length when copying mmap on clone")
  *
- * This test is a reporducer for this patch:
- *              https://lkml.org/lkml/2012/4/24/328
- * Since vma length in dup_mmap is calculated and stored in a unsigned
+ * Since VMA length in dup_mmap() is calculated and stored in a unsigned
  * int, it will overflow when length of mmaped memory > 16 TB. When
- * overflow occur, fork will  incorrectly succeed. The patch above
- * fixed it.
- ********************************************************************/
+ * overflow occurs, fork will incorrectly succeed. The patch above fixed it.
+ */
 
-#include <sys/mman.h>
+#include "tst_test.h"
+#include <stdlib.h>
 #include <sys/wait.h>
-#include <stdio.h>
-#include <unistd.h>
-#include "test.h"
-#include "safe_macros.h"
-#include "lapi/abisize.h"
-
-char *TCID = "fork14";
-int TST_TOTAL = 1;
-
-#define GB		(1024 * 1024 * 1024L)
 
-/* set mmap threshold to 16TB */
 #define LARGE		(16 * 1024)
 #define EXTENT		(16 * 1024 + 10)
 
-static char **pointer_vec;
+static char **memvec;
 
-static void setup(void);
-static void cleanup(void);
-static int  fork_test(void);
-
-int main(int ac, char **av)
+static void run(void)
 {
-	int lc, reproduced;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-/*
- * Tested on ppc64/x86_64/i386/s390x. And only 64bit has this issue.
- * Since a 32bit program can't mmap so many memory.
- */
-#ifdef TST_ABI32
-	tst_brkm(TCONF, NULL, "This test is only for 64bit.");
-#endif
-	setup();
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-
-		reproduced = fork_test();
-		if (reproduced == 0)
-			tst_resm(TPASS, "fork failed as expected.");
-	}
-	cleanup();
-	tst_exit();
-}
+	int i, j, ret;
+	pid_t pid;
+	void *mem;
+	int prev_failed = 0;
+	int passed = 1;
+	int failures = 0;
 
-static void setup(void)
-{
-	tst_sig(FORK, DEF_HANDLER, cleanup);
-	TEST_PAUSE;
+	memset(memvec, 0, EXTENT);
 
-	pointer_vec = SAFE_MALLOC(cleanup, EXTENT * sizeof(char *));
-}
+	for (i = 0; i < EXTENT; i++) {
+		mem = mmap(NULL, 1 * TST_GB,
+			PROT_READ | PROT_WRITE,
+			MAP_PRIVATE | MAP_ANONYMOUS,
+			0, 0);
 
-static void cleanup(void)
-{
-	free(pointer_vec);
-}
+		if (mem == MAP_FAILED) {
+			failures++;
 
-static int fork_test(void)
-{
-	int i, j, prev_failed = 0, fails = 0, cnt = 0;
-	int reproduced = 0;
-	void *addr;
+			tst_res(TINFO, "mmap() failed");
 
-	for (i = 0; i < EXTENT; i++) {
-		addr = mmap(NULL, 1 * GB, PROT_READ | PROT_WRITE,
-			    MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
-		if (addr == MAP_FAILED) {
-			pointer_vec[i] = NULL;
-			fails++;
-			/*
-			 * EXTENT is "16*1024+10", if fails count exceeds 10,
-			 * we are almost impossible to get an vm_area_struct
-			 * sized 16TB
-			 */
-			if (fails == 11) {
-				tst_brkm(TCONF, cleanup, "mmap() fails too many"
-					 "times, so we are almost impossible to"
-					 " get an vm_area_struct sized 16TB.");
+			if (failures > 10) {
+				tst_brk(TCONF, "mmap() fails too many "
+					"times, so it's almost impossible to "
+					"get a vm_area_struct sized 16TB");
 			}
-		} else {
-			pointer_vec[i] = addr;
+
+			continue;
 		}
-		cnt++;
 
-		switch (tst_fork()) {
-		case -1:
+		memvec[i] = mem;
+
+		pid = fork();
+
+		if (pid == -1) {
+			/* keep track of the failed fork() and verify that next one
+			 * is failing as well.
+			 */
 			prev_failed = 1;
-		break;
-		case 0:
+			continue;
+		}
+
+		if (!pid)
 			exit(0);
-		default:
-			SAFE_WAITPID(cleanup, -1, NULL, 0);
 
-			if (prev_failed > 0 && i >= LARGE) {
-				tst_resm(TFAIL, "Fork succeeds incorrectly");
-				reproduced = 1;
-				goto clear_memory_map;
-			}
+		ret = waitpid(pid, NULL, 0);
+		if (ret == -1 && errno != ECHILD)
+			tst_brk(TBROK | TERRNO, "waitpid() error");
+
+		if (prev_failed && i >= LARGE) {
+			passed = 0;
+			break;
 		}
+
+		prev_failed = 0;
+
+		tst_res(TDEBUG, "fork() passed at %d attempt", i);
 	}
 
-clear_memory_map:
-	for (j = 0; j < cnt; j++) {
-		if (pointer_vec[j])
-			SAFE_MUNMAP(cleanup, pointer_vec[j], 1 * GB);
+	for (j = 0; j < i; j++) {
+		if (memvec[j])
+			SAFE_MUNMAP(memvec[j], 1 * TST_GB);
 	}
 
-	return reproduced;
+	if (passed)
+		tst_res(TPASS, "fork() failed as expected");
+	else
+		tst_res(TFAIL, "fork() succeeded incorrectly");
 }
+
+static void setup(void)
+{
+	memvec = SAFE_MALLOC(EXTENT * sizeof(char *));
+}
+
+static void cleanup(void)
+{
+	for (long i = 0; i < EXTENT; i++) {
+		if (memvec && memvec[i])
+			SAFE_MUNMAP(memvec[i], 1 * TST_GB);
+	}
+
+	if (memvec)
+		free(memvec);
+}
+
+static struct tst_test test = {
+	.test_all = run,
+	.setup = setup,
+	.cleanup = cleanup,
+	.forks_child = 1,
+	.needs_abi_bits = 64,
+	.tags = (const struct tst_tag[]) {
+		{"linux-git", "7edc8b0ac16c"},
+		{}
+	}
+};
diff --git a/testcases/kernel/syscalls/fpathconf/fpathconf01.c b/testcases/kernel/syscalls/fpathconf/fpathconf01.c
index d38db401a..a328f972f 100644
--- a/testcases/kernel/syscalls/fpathconf/fpathconf01.c
+++ b/testcases/kernel/syscalls/fpathconf/fpathconf01.c
@@ -1,54 +1,18 @@
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
- * Author: William Roske
- * Co-pilot: Dave Fenner
- *
- * This program is free software; you can redistribute it and/or modify it
- * under the terms of version 2 of the GNU General Public License as
- * published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it would be useful, but
- * WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- *
- * Further, this software is distributed without any warranty that it is
- * free of the rightful claim of any third person regarding infringement
- * or the like.  Any license provided herein, whether implied or
- * otherwise, applies only to this software file.  Patent licenses, if
- * any, provided herein do not apply to combinations of this program with
- * other software, or any other product whatsoever.
- *
- * You should have received a copy of the GNU General Public License along
- * with this program; if not, write the Free Software Foundation, Inc.,
- * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
- *
- * Contact information: Silicon Graphics, Inc., 1600 Amphitheatre Pkwy,
- * Mountain View, CA  94043, or:
- *
- * http://www.sgi.com
- *
- * For further information regarding this notice, see:
- *
- * http://oss.sgi.com/projects/GenInfo/NoticeExplan/
- *
+ * Copyright (c) Linux Test Project, 2003-2024
  */
 
-/*
- * Testcase to test the basic functionality of fpathconf(2) system call.
+/*\
+ * [Description]
+ *
+ * Check the basic functionality of the fpathconf(2) system call.
  */
 
-#include <fcntl.h>
-#include <unistd.h>
-#include <errno.h>
-#include <string.h>
-#include <signal.h>
-#include "test.h"
-#include "safe_macros.h"
+#include "tst_test.h"
 
-static void setup(void);
-static void cleanup(void);
-
-static struct pathconf_args {
+static struct tcase {
 	char *name;
 	int value;
 } test_cases[] = {
@@ -63,67 +27,30 @@ static struct pathconf_args {
 	{"_PC_NO_TRUNC", _PC_NO_TRUNC},
 };
 
-char *TCID = "fpathconf01";
-int TST_TOTAL = ARRAY_SIZE(test_cases);
-
 static int fd;
 
-int main(int ac, char **av)
+static void verify_fpathconf(unsigned int n)
 {
-	int lc;
-	int i;
-
-	tst_parse_opts(ac, av, NULL, NULL);
+	struct tcase *tc = &test_cases[n];
 
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-
-		tst_count = 0;
-
-		for (i = 0; i < TST_TOTAL; i++) {
-			errno = 0;
-
-			TEST(fpathconf(fd, test_cases[i].value));
-
-			if (TEST_RETURN == -1) {
-				if (TEST_ERRNO == 0) {
-					tst_resm(TINFO,
-						 "fpathconf has NO limit for "
-						 "%s", test_cases[i].name);
-				} else {
-					tst_resm(TFAIL | TTERRNO,
-						 "fpathconf(fd, %s) failed",
-						 test_cases[i].name);
-				}
-			} else {
-				tst_resm(TPASS,
-					 "fpathconf(fd, %s) returned %ld",
-					 test_cases[i].name, TEST_RETURN);
-			}
-		}
-	}
-
-	cleanup();
-
-	tst_exit();
+	TST_EXP_POSITIVE(fpathconf(fd, tc->value));
 }
 
 static void setup(void)
 {
-	tst_sig(FORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-
-	tst_tmpdir();
-
-	fd = SAFE_OPEN(cleanup, "fpafile01", O_RDWR | O_CREAT, 0700);
+	fd = SAFE_OPEN("fpafile01", O_RDWR | O_CREAT, 0700);
 }
 
 static void cleanup(void)
 {
 	if (fd > 0)
-		SAFE_CLOSE(NULL, fd);
-
-	tst_rmdir();
+		SAFE_CLOSE(fd);
 }
+
+static struct tst_test test = {
+	.needs_tmpdir = 1,
+	.test  = verify_fpathconf,
+	.tcnt = ARRAY_SIZE(test_cases),
+	.setup = setup,
+	.cleanup = cleanup,
+};
diff --git a/testcases/kernel/syscalls/fstatfs/fstatfs01.c b/testcases/kernel/syscalls/fstatfs/fstatfs01.c
index 6b14fd0d6..9d3909ace 100644
--- a/testcases/kernel/syscalls/fstatfs/fstatfs01.c
+++ b/testcases/kernel/syscalls/fstatfs/fstatfs01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * Copyright (c) 2022 SUSE LLC Avinesh Kumar <avinesh.kumar@suse.com>
diff --git a/testcases/kernel/syscalls/futex/futex2test.h b/testcases/kernel/syscalls/futex/futex2test.h
index ce97f47c1..a3cd0ef5c 100644
--- a/testcases/kernel/syscalls/futex/futex2test.h
+++ b/testcases/kernel/syscalls/futex/futex2test.h
@@ -12,6 +12,14 @@
 #include <stdint.h>
 #include "lapi/syscalls.h"
 #include "futextest.h"
+#include "lapi/abisize.h"
+
+#ifdef TST_ABI32
+struct timespec64 {
+	int64_t tv_sec;
+	int64_t tv_nsec;
+};
+#endif
 
 /**
  * futex_waitv - Wait at multiple futexes, wake on any
@@ -24,7 +32,16 @@ static inline int futex_waitv(volatile struct futex_waitv *waiters,
 			      unsigned long nr_waiters, unsigned long flags,
 			      struct timespec *timo, clockid_t clockid)
 {
+#ifdef TST_ABI32
+	struct timespec64 timo64 = {0};
+
+	timo64.tv_sec = timo->tv_sec;
+	timo64.tv_nsec = timo->tv_nsec;
+	return tst_syscall(__NR_futex_waitv, waiters, nr_waiters, flags, &timo64, clockid);
+#else
 	return tst_syscall(__NR_futex_waitv, waiters, nr_waiters, flags, timo, clockid);
+
+#endif
 }
 
 #endif /* _FUTEX2TEST_H */
diff --git a/testcases/kernel/syscalls/getgid/getgid01.c b/testcases/kernel/syscalls/getgid/getgid01.c
index dec0fca42..3d914f73f 100644
--- a/testcases/kernel/syscalls/getgid/getgid01.c
+++ b/testcases/kernel/syscalls/getgid/getgid01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * AUTHOR		: William Roske
diff --git a/testcases/kernel/syscalls/gethostbyname_r/gethostbyname_r01.c b/testcases/kernel/syscalls/gethostbyname_r/gethostbyname_r01.c
index 53261ea4d..605975307 100644
--- a/testcases/kernel/syscalls/gethostbyname_r/gethostbyname_r01.c
+++ b/testcases/kernel/syscalls/gethostbyname_r/gethostbyname_r01.c
@@ -1,36 +1,24 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  *   Copyright (c) 2015 Fujitsu Ltd.
  *   Author: Zeng Linggang <zenglg.jy@cn.fujitsu.com>
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
+ *   Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
- * This is a test for glibc bug:
+/*\
+ * [Description]
+ *
+ * Test for GHOST: glibc vulnerability (CVE-2015-0235).
+ *
  * https://www.qualys.com/research/security-advisories/GHOST-CVE-2015-0235.txt
  */
 
-#include <netdb.h>
-#include <stdio.h>
-#include <stdlib.h>
-#include <string.h>
-#include <errno.h>
-#include "test.h"
+#include "tst_test.h"
 
 #define CANARY "in_the_coal_mine"
 
-static void setup(void);
-static void check_vulnerable(void);
-
-static struct {
+static struct
+{
 	char buffer[1024];
 	char canary[sizeof(CANARY)];
 } temp = {
@@ -38,31 +26,6 @@ static struct {
 	CANARY,
 };
 
-char *TCID = "gethostbyname_r01";
-int TST_TOTAL = 1;
-
-int main(int ac, char **av)
-{
-	int lc;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-		check_vulnerable();
-	}
-
-	tst_exit();
-}
-
-static void setup(void)
-{
-	tst_sig(NOFORK, DEF_HANDLER, NULL);
-	TEST_PAUSE;
-}
-
 static void check_vulnerable(void)
 {
 	struct hostent resbuf;
@@ -78,22 +41,24 @@ static void check_vulnerable(void)
 	 *                sizeof(*h_addr_ptrs) - 1;
 	 */
 	len = sizeof(temp.buffer) - 16 - 2 * sizeof(char *) - 1;
+
 	memset(name, '0', len);
 	name[len] = '\0';
-
 	retval = gethostbyname_r(name, &resbuf, temp.buffer,
 				 sizeof(temp.buffer), &result, &herrno);
 
-	if (strcmp(temp.canary, CANARY) != 0) {
-		tst_resm(TFAIL, "vulnerable");
-		return;
-	}
+	/* has canary been overwritten? */
+	if (strcmp(temp.canary, CANARY) != 0)
+		tst_res(TFAIL, "GHOST CVE-2015-0235 vulnerable");
+	else
+		TST_EXP_EQ_LI(retval, ERANGE);
+}
 
-	if (retval == ERANGE) {
-		tst_resm(TPASS, "not vulnerable");
-		return;
+static struct tst_test test = {
+	.test_all = check_vulnerable,
+	.tags = (const struct tst_tag[]) {
+		{"glibc-git", "d5dd6189d506"},
+		{"CVE", "CVE-2015-0235"},
+		{}
 	}
-
-	tst_resm(TFAIL, "gethostbyname_r() returned %s, expected ERANGE",
-		 tst_strerrno(retval));
-}
+};
diff --git a/testcases/kernel/syscalls/gethostid/gethostid01.c b/testcases/kernel/syscalls/gethostid/gethostid01.c
index c176e5182..3fc280327 100644
--- a/testcases/kernel/syscalls/gethostid/gethostid01.c
+++ b/testcases/kernel/syscalls/gethostid/gethostid01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * Copyright (c) 2021 Xie Ziyao <xieziyao@huawei.com>
diff --git a/testcases/kernel/syscalls/gethostname/.gitignore b/testcases/kernel/syscalls/gethostname/.gitignore
index d09d5d288..d6e4cffcb 100644
--- a/testcases/kernel/syscalls/gethostname/.gitignore
+++ b/testcases/kernel/syscalls/gethostname/.gitignore
@@ -1 +1,2 @@
 /gethostname01
+/gethostname02
diff --git a/testcases/kernel/syscalls/gethostname/gethostname01.c b/testcases/kernel/syscalls/gethostname/gethostname01.c
index f2276a38c..5d882514a 100644
--- a/testcases/kernel/syscalls/gethostname/gethostname01.c
+++ b/testcases/kernel/syscalls/gethostname/gethostname01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * Copyright (c) 2023 SUSE LLC Ioannis Bonatakis <ybonatakis@suse.com>
diff --git a/testcases/kernel/syscalls/gethostname/gethostname02.c b/testcases/kernel/syscalls/gethostname/gethostname02.c
new file mode 100644
index 000000000..250e5f2fd
--- /dev/null
+++ b/testcases/kernel/syscalls/gethostname/gethostname02.c
@@ -0,0 +1,31 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) 2024 FUJITSU LIMITED. All Rights Reserved.
+ * Author: Yang Xu <xuyang2018.jy@fujitsu.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Verify that gethostname(2) fails with
+ *
+ * - ENAMETOOLONG when len is smaller than the actual size
+ */
+
+#include "tst_test.h"
+
+static void verify_gethostname(void)
+{
+	char hostname[HOST_NAME_MAX];
+	int real_length;
+
+	SAFE_GETHOSTNAME(hostname, sizeof(hostname));
+	real_length = strlen(hostname);
+
+	TST_EXP_FAIL(gethostname(hostname, real_length - 1), ENAMETOOLONG,
+		"len is smaller than the actual size");
+}
+
+static struct tst_test test = {
+	.test_all = verify_gethostname,
+};
diff --git a/testcases/kernel/syscalls/getpagesize/getpagesize01.c b/testcases/kernel/syscalls/getpagesize/getpagesize01.c
index 2ba8ba70f..c88071ba4 100644
--- a/testcases/kernel/syscalls/getpagesize/getpagesize01.c
+++ b/testcases/kernel/syscalls/getpagesize/getpagesize01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) International Business Machines  Corp., 2005
  *   Robbie Williamson <robbiew@us.ibm.com>
diff --git a/testcases/kernel/syscalls/getpeername/getpeername01.c b/testcases/kernel/syscalls/getpeername/getpeername01.c
index 817cd38ad..0f2600bee 100644
--- a/testcases/kernel/syscalls/getpeername/getpeername01.c
+++ b/testcases/kernel/syscalls/getpeername/getpeername01.c
@@ -1,178 +1,110 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *   07/2001 Ported by Wayne Boyer
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software Foundation,
- *   Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2001
+ * 07/2001 Ported by Wayne Boyer
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
- *  Verify that getpeername() returns the proper errno for various failure cases
+/*\
+ * [Description]
+ *
+ * Verify that getpeername() returns the proper errno for various failure cases:
+ *
+ * - EBADF on invalid address.
+ * - ENOTSOCK on socket opened on /dev/null.
+ * - ENOTCONN on socket not connected.
+ * - EINVAL on negative addrlen.
+ * - EFAULT on invalid addr/addrlen pointers.
  */
 
-#include <stdio.h>
-#include <unistd.h>
-#include <errno.h>
-#include <fcntl.h>
-#include <sys/types.h>
-#include <sys/socket.h>
-#include <sys/signal.h>
-#include <sys/ioctl.h>
-#include <netinet/in.h>
-
-#include "test.h"
-#include "safe_macros.h"
+#include "tst_test.h"
 
 static struct sockaddr_in server_addr;
 static struct sockaddr_in fsin1;
 static socklen_t sinlen;
 static socklen_t invalid_sinlen = -1;
 static int sv[2];
+static int sockfd = -1;
 
-static void setup(void);
-static void setup2(int);
-static void setup3(int);
-static void setup4(int);
-static void cleanup(void);
-static void cleanup2(int);
-static void cleanup4(int);
-
-struct test_case_t {
-	int sockfd;
-	struct sockaddr *sockaddr;
-	socklen_t *addrlen;
-	int expretval;
-	int experrno;
-	void (*setup) (int);
-	void (*cleanup) (int);
-	char *name;
-} test_cases[] = {
-	{-1, (struct sockaddr *)&fsin1, &sinlen, -1, EBADF, NULL, NULL,
-	 "EBADF"},
-	{-1, (struct sockaddr *)&fsin1, &sinlen, -1, ENOTSOCK, setup2, cleanup2,
-	 "ENOTSOCK"},
-	{-1, (struct sockaddr *)&fsin1, &sinlen, -1, ENOTCONN, setup3, cleanup2,
-	 "ENOTCONN"},
-	{-1, (struct sockaddr *)&fsin1, &invalid_sinlen, -1, EINVAL, setup4,
-	 cleanup4, "EINVAL"},
-#ifndef UCLINUX
-	{-1, (struct sockaddr *)-1, &sinlen, -1, EFAULT, setup4, cleanup4,
-	 "EFAULT"},
-	{-1, (struct sockaddr *)&fsin1, NULL, -1, EFAULT, setup4,
-	 cleanup4, "EFAULT"},
-	{-1, (struct sockaddr *)&fsin1, (socklen_t *)1, -1, EFAULT, setup4,
-	 cleanup4, "EFAULT"},
-#endif
-};
-
-char *TCID = "getpeername01";
-int TST_TOTAL = ARRAY_SIZE(test_cases);
-
-int main(int argc, char *argv[])
+static void setup_fd_file(void)
 {
-	int lc;
-	int i;
+	sockfd = SAFE_OPEN("/dev/null", O_WRONLY, 0666);
+}
 
-	tst_parse_opts(argc, argv, NULL, NULL);
+static void setup_fd_stream(void)
+{
+	sockfd = SAFE_SOCKET(PF_INET, SOCK_STREAM, 0);
+	SAFE_BIND(sockfd, (struct sockaddr *)&server_addr, sizeof(server_addr));
+}
 
-	setup();
+static void cleanup_fd(void)
+{
+	if (sockfd)
+		SAFE_CLOSE(sockfd);
+}
 
-	for (lc = 0; TEST_LOOPING(lc); ++lc) {
+static void setup_pair(void)
+{
+	SAFE_SOCKETPAIR(PF_UNIX, SOCK_STREAM, 0, sv);
+	sockfd = sv[0];
+}
 
-		tst_count = 0;
+static void cleanup_pair(void)
+{
+	if (sv[0])
+		SAFE_CLOSE(sv[0]);
 
-		for (i = 0; i < TST_TOTAL; ++i) {
+	if (sv[1])
+		SAFE_CLOSE(sv[1]);
+}
 
-			if (test_cases[i].setup != NULL)
-				test_cases[i].setup(i);
+static struct test_case {
+	struct sockaddr *sockaddr;
+	socklen_t *addrlen;
+	int experrno;
+	void (*setup)(void);
+	void (*cleanup)(void);
+} test_cases[] = {
+	{.addrlen = &sinlen, .experrno = EBADF},
+	{.addrlen = &sinlen, .experrno = ENOTSOCK, .setup = setup_fd_file,
+		.cleanup = cleanup_fd },
+	{.addrlen = &sinlen, .experrno = ENOTCONN, .setup = setup_fd_stream,
+		.cleanup = cleanup_fd },
+	{.addrlen = &invalid_sinlen, .experrno = EINVAL, .setup = setup_pair,
+		.cleanup = cleanup_pair},
+	{.sockaddr = (struct sockaddr *) -1, .addrlen = &sinlen, .experrno = EFAULT,
+		.setup = setup_pair, .cleanup = cleanup_pair},
+	{.experrno = EFAULT, .setup = setup_pair, .cleanup = cleanup_pair},
+	{.addrlen = (socklen_t *) 1, .experrno = EFAULT, .setup = setup_pair,
+		.cleanup = cleanup_pair },
+};
 
-			TEST(getpeername(test_cases[i].sockfd,
-					 test_cases[i].sockaddr,
-					 test_cases[i].addrlen));
+static void verify_getpeername(unsigned int nr)
+{
+	struct test_case *tc = &test_cases[nr];
 
-			if (TEST_RETURN == test_cases[i].expretval &&
-			    TEST_ERRNO == test_cases[i].experrno) {
-				tst_resm(TPASS,
-					 "test getpeername() %s successful",
-					 test_cases[i].name);
-			} else {
-				tst_resm(TFAIL,
-					 "test getpeername() %s failed; "
-					 "returned %ld (expected %d), errno %d "
-					 "(expected %d)", test_cases[i].name,
-					 TEST_RETURN, test_cases[i].expretval,
-					 TEST_ERRNO, test_cases[i].experrno);
-			}
+	if (tc->setup != NULL)
+		tc->setup();
 
-			if (test_cases[i].cleanup != NULL)
-				test_cases[i].cleanup(i);
-		}
-	}
+	if (!tc->sockaddr)
+		tc->sockaddr = (struct sockaddr *)&fsin1;
 
-	cleanup();
+	TST_EXP_FAIL(getpeername(sockfd, tc->sockaddr, tc->addrlen), tc->experrno);
 
-	tst_exit();
+	if (tc->cleanup != NULL)
+		tc->cleanup();
 }
 
 static void setup(void)
 {
-	TEST_PAUSE;
-
 	server_addr.sin_family = AF_INET;
 	server_addr.sin_port = 0;
 	server_addr.sin_addr.s_addr = INADDR_ANY;
-
 	sinlen = sizeof(fsin1);
 }
 
-static void cleanup(void)
-{
-}
-
-static void setup2(int i)
-{
-	test_cases[i].sockfd = SAFE_OPEN(cleanup, "/dev/null", O_WRONLY, 0666);
-}
-
-static void setup3(int i)
-{
-	test_cases[i].sockfd = socket(PF_INET, SOCK_STREAM, 0);
-	if (test_cases[i].sockfd < 0) {
-		tst_brkm(TBROK | TERRNO, cleanup,
-			 "socket setup failed for getpeername test %d", i);
-	}
-	SAFE_BIND(cleanup, test_cases[i].sockfd,
-		  (struct sockaddr *)&server_addr, sizeof(server_addr));
-}
-
-static void setup4(int i)
-{
-	if (socketpair(PF_UNIX, SOCK_STREAM, 0, sv) < 0) {
-		tst_brkm(TBROK | TERRNO, cleanup,
-			 "socketpair failed for getpeername test %d", i);
-	}
-	test_cases[i].sockfd = sv[0];
-}
-
-static void cleanup2(int i)
-{
-	SAFE_CLOSE(cleanup, test_cases[i].sockfd);
-}
-
-static void cleanup4(int i)
-{
-	SAFE_CLOSE(cleanup, sv[0]);
-	SAFE_CLOSE(cleanup, sv[1]);
-}
+static struct tst_test test = {
+	.setup = setup,
+	.test = verify_getpeername,
+	.tcnt = ARRAY_SIZE(test_cases),
+};
diff --git a/testcases/kernel/syscalls/getpgrp/getpgrp01.c b/testcases/kernel/syscalls/getpgrp/getpgrp01.c
index a94736661..fe2e0c582 100644
--- a/testcases/kernel/syscalls/getpgrp/getpgrp01.c
+++ b/testcases/kernel/syscalls/getpgrp/getpgrp01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * AUTHOR: William Roske, CO-PILOT: Dave Fenner
diff --git a/testcases/kernel/syscalls/getppid/getppid01.c b/testcases/kernel/syscalls/getppid/getppid01.c
index 57efe1c1f..614eea9fd 100644
--- a/testcases/kernel/syscalls/getppid/getppid01.c
+++ b/testcases/kernel/syscalls/getppid/getppid01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * Copyright (c) Linux Test Project, 2006-2023
diff --git a/testcases/kernel/syscalls/getrandom/.gitignore b/testcases/kernel/syscalls/getrandom/.gitignore
index ef06ece9d..e47d8b3f4 100644
--- a/testcases/kernel/syscalls/getrandom/.gitignore
+++ b/testcases/kernel/syscalls/getrandom/.gitignore
@@ -2,3 +2,4 @@
 /getrandom02
 /getrandom03
 /getrandom04
+/getrandom05
diff --git a/testcases/kernel/syscalls/getrandom/getrandom05.c b/testcases/kernel/syscalls/getrandom/getrandom05.c
new file mode 100644
index 000000000..92098deb7
--- /dev/null
+++ b/testcases/kernel/syscalls/getrandom/getrandom05.c
@@ -0,0 +1,46 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) 2024 FUJITSU LIMITED. All Rights Reserved.
+ * Copyright (c) Linux Test Project, 2024
+ * Author: Yang Xu <xuyang2018.jy@fujitsu.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Verify that getrandom(2) fails with
+ *
+ * - EFAULT when buf address is outside the accessible address space
+ * - EINVAL when flag is invalid
+ */
+
+#include "tst_test.h"
+#include "lapi/getrandom.h"
+
+static char buff_efault[64];
+static char buff_einval[64];
+
+static struct test_case_t {
+	char *buff;
+	size_t size;
+	unsigned int flag;
+	int expected_errno;
+	char *desc;
+} tcases[] = {
+	{(void *)-1, sizeof(buff_efault), 0, EFAULT,
+		"buf address is outside the accessible address space"},
+	{buff_einval, sizeof(buff_einval), -1, EINVAL, "flag is invalid"},
+};
+
+static void verify_getrandom(unsigned int i)
+{
+	struct test_case_t *tc = &tcases[i];
+
+	TST_EXP_FAIL2(getrandom(tc->buff, tc->size, tc->flag),
+		tc->expected_errno, "%s", tc->desc);
+}
+
+static struct tst_test test = {
+	.tcnt = ARRAY_SIZE(tcases),
+	.test = verify_getrandom,
+};
diff --git a/testcases/kernel/syscalls/getrusage/getrusage01.c b/testcases/kernel/syscalls/getrusage/getrusage01.c
index e0a7e28f7..83275dd34 100644
--- a/testcases/kernel/syscalls/getrusage/getrusage01.c
+++ b/testcases/kernel/syscalls/getrusage/getrusage01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
  * AUTHOR: Saji Kumar.V.R <saji.kumar@wipro.com>
diff --git a/testcases/kernel/syscalls/getrusage/getrusage03.c b/testcases/kernel/syscalls/getrusage/getrusage03.c
index fc14e93cf..c8e974567 100644
--- a/testcases/kernel/syscalls/getrusage/getrusage03.c
+++ b/testcases/kernel/syscalls/getrusage/getrusage03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) 2011  Red Hat, Inc.
  * Copyright (C) 2021 Xie Ziyao <xieziyao@huawei.com>
diff --git a/testcases/kernel/syscalls/getrusage/getrusage03.h b/testcases/kernel/syscalls/getrusage/getrusage03.h
index b28b9d4c3..8bee0b9e5 100644
--- a/testcases/kernel/syscalls/getrusage/getrusage03.h
+++ b/testcases/kernel/syscalls/getrusage/getrusage03.h
@@ -1,4 +1,4 @@
-/* SPDX-License-Identifier: GPL-2.0
+/* SPDX-License-Identifier: GPL-2.0-only
  * Copyright (C) 2011  Red Hat, Inc.
  * Copyright (C) 2021 Xie Ziyao <xieziyao@huawei.com>
  */
diff --git a/testcases/kernel/syscalls/getrusage/getrusage03_child.c b/testcases/kernel/syscalls/getrusage/getrusage03_child.c
index e8252084f..18627a98c 100644
--- a/testcases/kernel/syscalls/getrusage/getrusage03_child.c
+++ b/testcases/kernel/syscalls/getrusage/getrusage03_child.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) 2011  Red Hat, Inc.
  * Copyright (C) 2021 Xie Ziyao <xieziyao@huawei.com>
diff --git a/testcases/kernel/syscalls/getsockname/getsockname01.c b/testcases/kernel/syscalls/getsockname/getsockname01.c
index cce1543fd..becd7133a 100644
--- a/testcases/kernel/syscalls/getsockname/getsockname01.c
+++ b/testcases/kernel/syscalls/getsockname/getsockname01.c
@@ -1,181 +1,70 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2001
+ * 07/2001 Ported by Wayne Boyer
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
- * Test Name: getsockname01
+/*\
+ * [Description]
+ * Verify that getsockname() returns the proper errno for various failure cases:
  *
- * Test Description:
- *  Verify that getsockname() returns the proper errno for various failure cases
- *
- * Usage:  <for command-line>
- *  getsockname01 [-c n] [-e] [-i n] [-I x] [-P x] [-t]
- *     where,  -c n : Run n copies concurrently.
- *             -e   : Turn on errno logging.
- *	       -i n : Execute test n times.
- *	       -I x : Execute test for x seconds.
- *	       -P x : Pause for x seconds between iterations.
- *	       -t   : Turn on syscall timing.
- *
- * HISTORY
- *	07/2001 Ported by Wayne Boyer
- *
- * RESTRICTIONS:
- *  None.
+ * - EBADF on a not open file
+ * - ENOTSOCK on a file descriptor not linked to a socket
+ * - EFAULT on invalid socket buffer o invalid socklen
+ * - EINVALI on an invalid addrlen
  */
 
-#include <stdio.h>
-#include <unistd.h>
-#include <errno.h>
-#include <fcntl.h>
-
-#include <sys/types.h>
-#include <sys/socket.h>
-#include <sys/signal.h>
-#include <sys/ioctl.h>
+#include "tst_test.h"
 
-#include <netinet/in.h>
+static struct sockaddr_in sin0, fsin1;
+static int sock_null, sock_bind, sock_fake;
+static socklen_t sinlen;
+static socklen_t sininval = -1;
 
-#include "test.h"
-#include "safe_macros.h"
-
-char *TCID = "getsockname01";
-int testno;
-
-int s;				/* socket descriptor */
-struct sockaddr_in sin0, fsin1;
-socklen_t sinlen;
-
-void setup(void), setup0(void), setup1(void),
-cleanup(void), cleanup0(void), cleanup1(void);
-
-struct test_case_t {		/* test case structure */
-	int domain;		/* PF_INET, PF_UNIX, ... */
-	int type;		/* SOCK_STREAM, SOCK_DGRAM ... */
-	int proto;		/* protocol number (usually 0 = default) */
-	struct sockaddr *sockaddr;	/* socket address buffer */
-	socklen_t *salen;	/* getsockname's 3rd argument */
-	int retval;		/* syscall return value */
-	int experrno;		/* expected errno */
-	void (*setup) (void);
-	void (*cleanup) (void);
+static struct test_case {
+	int *sock;
+	struct sockaddr_in *sockaddr;
+	socklen_t *addrlen;
+	int experrno;
 	char *desc;
-} tdat[] = {
-	{
-	PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&fsin1,
-		    &sinlen, -1, EBADF, setup0, cleanup0,
-		    "bad file descriptor"}, {
-	PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&fsin1,
-		    &sinlen, -1, ENOTSOCK, setup0, cleanup0,
-		    "bad file descriptor"},
-#ifndef UCLINUX
-	    /* Skip since uClinux does not implement memory protection */
-	{
-	PF_INET, SOCK_STREAM, 0, NULL,
-		    &sinlen, -1, EFAULT, setup1, cleanup1,
-		    "invalid socket buffer"}, {
-		/* invalid salen test for aligned input */
-	PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&fsin1,
-		    NULL, -1, EFAULT, setup1, cleanup1,
-		    "invalid aligned salen"}, {
-		/* invalid salen test for unaligned input */
-	PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&fsin1,
-		    (socklen_t *) 1, -1, EFAULT, setup1, cleanup1,
-		    "invalid unaligned salen"},
-#endif
+} tcases[] = {
+	{ .sock = &sock_fake, .sockaddr = &fsin1, .addrlen = &sinlen,
+		.experrno = EBADF, "bad file descriptor"},
+	{ .sock = &sock_null, .sockaddr = &fsin1, .addrlen = &sinlen,
+		.experrno = ENOTSOCK, "bad file descriptor"},
+	{ .sock = &sock_bind, .sockaddr = NULL, .addrlen = &sinlen,
+		.experrno = EFAULT, "invalid socket buffer"},
+	{ .sock = &sock_bind, .sockaddr = &fsin1, .addrlen = NULL,
+		.experrno = EFAULT, "invalid aligned salen"},
+	{ .sock = &sock_bind, .sockaddr = &fsin1, .addrlen = (socklen_t *) 1,
+		.experrno = EFAULT, "invalid unaligned salen"},
+	{ .sock = &sock_bind, .sockaddr = &fsin1, .addrlen = &sininval,
+		.experrno = EINVAL, "invalid socklen"},
 };
 
-int TST_TOTAL = sizeof(tdat) / sizeof(tdat[0]);
-
-int main(int argc, char *argv[])
+static void check_getsockname(unsigned int nr)
 {
-	int lc;
-
-	tst_parse_opts(argc, argv, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); ++lc) {
-		tst_count = 0;
-		for (testno = 0; testno < TST_TOTAL; ++testno) {
-			tdat[testno].setup();
-
-			TEST(getsockname(s, tdat[testno].sockaddr,
-					 tdat[testno].salen));
-			if (TEST_RETURN != tdat[testno].retval ||
-			    (TEST_RETURN < 0 &&
-			     TEST_ERRNO != tdat[testno].experrno)) {
-				tst_resm(TFAIL, "%s ; returned"
-					 " %ld (expected %d), errno %d (expected"
-					 " %d)", tdat[testno].desc,
-					 TEST_RETURN, tdat[testno].retval,
-					 TEST_ERRNO, tdat[testno].experrno);
-			} else {
-				tst_resm(TPASS, "%s successful",
-					 tdat[testno].desc);
-			}
-			tdat[testno].cleanup();
-		}
-	}
-	cleanup();
+	struct test_case *tc = &tcases[nr];
 
-	tst_exit();
+	TST_EXP_FAIL(getsockname(*(tc->sock), (struct sockaddr *) tc->sockaddr,
+				 tc->addrlen), tc->experrno, "%s", tc->desc);
 }
 
-void setup(void)
+static void setup(void)
 {
-	TEST_PAUSE;
-
-	/* initialize local sockaddr */
 	sin0.sin_family = AF_INET;
 	sin0.sin_port = 0;
 	sin0.sin_addr.s_addr = INADDR_ANY;
+	sock_fake = 400;
+	sock_null = SAFE_OPEN("/dev/null", O_WRONLY);
+	sock_bind = SAFE_SOCKET(PF_INET, SOCK_STREAM, 0);
+	SAFE_BIND(sock_bind, (struct sockaddr *)&sin0, sizeof(sin0));
+	sinlen = sizeof(sin0);
 }
 
-void cleanup(void)
-{
-}
-
-void setup0(void)
-{
-	if (tdat[testno].experrno == EBADF)
-		s = 400;	/* anything not an open file */
-	else if ((s = open("/dev/null", O_WRONLY)) == -1)
-		tst_brkm(TBROK, cleanup, "error opening /dev/null - "
-			 "errno: %s", strerror(errno));
-
-}
-
-void cleanup0(void)
-{
-	s = -1;
-}
-
-void setup1(void)
-{
-	s = SAFE_SOCKET(cleanup, tdat[testno].domain, tdat[testno].type,
-			tdat[testno].proto);
-	SAFE_BIND(cleanup, s, (struct sockaddr *)&sin0, sizeof(sin0));
-	sinlen = sizeof(fsin1);
-}
-
-void cleanup1(void)
-{
-	(void)close(s);
-	s = -1;
-}
+static struct tst_test test = {
+	.setup = setup,
+	.test = check_getsockname,
+	.tcnt = ARRAY_SIZE(tcases),
+};
diff --git a/testcases/kernel/syscalls/getsockopt/getsockopt01.c b/testcases/kernel/syscalls/getsockopt/getsockopt01.c
index d1692fcd3..9effbf30c 100644
--- a/testcases/kernel/syscalls/getsockopt/getsockopt01.c
+++ b/testcases/kernel/syscalls/getsockopt/getsockopt01.c
@@ -1,208 +1,92 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2001
+ * 07/2001 Ported by Wayne Boyer
+ * Copyright (c) Linux Test Project, 2003-2017
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
- * Test Name: getsockopt01
+/*\
+ * [Description]
+ * Verify that getsockopt() returns the proper errno for various failure cases:
  *
- * Test Description:
- *  Verify that getsockopt() returns the proper errno for various failure cases
- *
- * Usage:  <for command-line>
- *  getsockopt01 [-c n] [-e] [-i n] [-I x] [-P x] [-t]
- *     where,  -c n : Run n copies concurrently.
- *             -e   : Turn on errno logging.
- *	       -i n : Execute test n times.
- *	       -I x : Execute test for x seconds.
- *	       -P x : Pause for x seconds between iterations.
- *	       -t   : Turn on syscall timing.
- *
- * HISTORY
- *	07/2001 Ported by Wayne Boyer
- *
- * RESTRICTIONS:
- *  None.
+ * - EBADF on a not open file
+ * - ENOTSOCK on a file descriptor not linked to a socket
+ * - EFAULT on invalid address of value or length
+ * - EOPNOTSUPP on invalid option name or protocol
+ * - EINVAL on an invalid optlen
  */
 
-#include <stdio.h>
-#include <unistd.h>
-#include <errno.h>
-#include <fcntl.h>
+#include "tst_test.h"
 
-#include <sys/types.h>
-#include <sys/socket.h>
-#include <sys/signal.h>
-#include <sys/ioctl.h>
+static int sock_fake, sock_null, sock_bind;
+static struct sockaddr_in sin0;
+static int sinlen;
+static int optval;
+static socklen_t optlen;
+static socklen_t optleninval = -1;
 
-#include <netinet/in.h>
+static struct test_case {
+	int *sockfd;
+	int level;
+	int optname;
+	void *optval;
+	socklen_t *optlen;
+	int experrno;
+	char *desc;
+} tcases[] = {
+	{.sockfd = &sock_fake, .level = SOL_SOCKET, .optname = SO_OOBINLINE, .optval = &optval,
+	.optlen = &optlen, .experrno = EBADF, .desc = "bad file descriptor"},
 
-#include "test.h"
-#include "safe_macros.h"
+	{.sockfd = &sock_null, .level = SOL_SOCKET, .optname = SO_OOBINLINE, .optval = &optval,
+	.optlen = &optlen, .experrno = ENOTSOCK, .desc = "bad file descriptor"},
 
-char *TCID = "getsockopt01";
-int testno;
+	{.sockfd = &sock_bind, .level = SOL_SOCKET, .optname = SO_OOBINLINE, .optval = 0,
+	.optlen = &optlen, .experrno = EFAULT, .desc = "invalid option buffer"},
 
-int s;				/* socket descriptor */
-struct sockaddr_in sin0, fsin1;
-int sinlen;
-int optval;
-socklen_t optlen;
+	{.sockfd = &sock_bind, .level = SOL_SOCKET, .optname = SO_OOBINLINE, .optval = &optval,
+	.optlen = 0, .experrno = EFAULT, .desc = "invalid optlen"},
 
-void setup(void), setup0(void), setup1(void),
-cleanup(void), cleanup0(void), cleanup1(void);
+	{.sockfd = &sock_bind, .level = 500, .optname = SO_OOBINLINE, .optval = &optval,
+	.optlen = &optlen, .experrno = EOPNOTSUPP, .desc = "invalid level"},
 
-struct test_case_t {		/* test case structure */
-	int domain;		/* PF_INET, PF_UNIX, ... */
-	int type;		/* SOCK_STREAM, SOCK_DGRAM ... */
-	int proto;		/* protocol number (usually 0 = default) */
-	int level;		/* IPPROTO_* */
-	int optname;
-	void *optval;
-	socklen_t *optlen;
-	struct sockaddr *sin;
-	int salen;
-	int retval;		/* syscall return value */
-	int experrno;		/* expected errno */
-	void (*setup) (void);
-	void (*cleanup) (void);
-	char *desc;
-} tdat[] = {
-	{
-	PF_INET, SOCK_STREAM, 0, SOL_SOCKET, SO_OOBINLINE, &optval,
-		    &optlen, (struct sockaddr *)&fsin1, sizeof(fsin1),
-		    -1, EBADF, setup0, cleanup0, "bad file descriptor"}
-	, {
-	PF_INET, SOCK_STREAM, 0, SOL_SOCKET, SO_OOBINLINE, &optval,
-		    &optlen, (struct sockaddr *)&fsin1, sizeof(fsin1),
-		    -1, ENOTSOCK, setup0, cleanup0, "bad file descriptor"}
-	,
-#ifndef UCLINUX
-	{
-	PF_INET, SOCK_STREAM, 0, SOL_SOCKET, SO_OOBINLINE, 0, &optlen,
-		    (struct sockaddr *)&fsin1, sizeof(fsin1), -1,
-		    EFAULT, setup1, cleanup1, "invalid option buffer"}
-	, {
-	PF_INET, SOCK_STREAM, 0, SOL_SOCKET, SO_OOBINLINE, &optval, 0,
-		    (struct sockaddr *)&fsin1, sizeof(fsin1), -1,
-		    EFAULT, setup1, cleanup1, "invalid optlen"}
-	,
-#endif /* UCLINUX */
-	{
-	PF_INET, SOCK_STREAM, 0, 500, SO_OOBINLINE, &optval, &optlen,
-		    (struct sockaddr *)&fsin1, sizeof(fsin1), -1,
-		    EOPNOTSUPP, setup1, cleanup1, "invalid level"}
-	, {
-	PF_INET, SOCK_STREAM, 0, IPPROTO_UDP, SO_OOBINLINE, &optval,
-		    &optlen, (struct sockaddr *)&fsin1, sizeof(fsin1),
-		    -1, EOPNOTSUPP, setup1, cleanup1, "invalid option name"}
-	, {
-	PF_INET, SOCK_STREAM, 0, IPPROTO_UDP, SO_OOBINLINE, &optval,
-		    &optlen, (struct sockaddr *)&fsin1, sizeof(fsin1),
-		    -1, EOPNOTSUPP, setup1, cleanup1,
-		    "invalid option name (UDP)"}
-	, {
-	PF_INET, SOCK_STREAM, 0, IPPROTO_IP, -1, &optval, &optlen,
-		    (struct sockaddr *)&fsin1, sizeof(fsin1), -1,
-		    ENOPROTOOPT, setup1, cleanup1, "invalid option name (IP)"}
-	, {
-	PF_INET, SOCK_STREAM, 0, IPPROTO_TCP, -1, &optval, &optlen,
-		    (struct sockaddr *)&fsin1, sizeof(fsin1), -1,
-		    ENOPROTOOPT, setup1, cleanup1, "invalid option name (TCP)"}
-,};
-
-int TST_TOTAL = sizeof(tdat) / sizeof(tdat[0]);
-
-int main(int argc, char *argv[])
-{
-	int lc;
-
-	tst_parse_opts(argc, argv, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); ++lc) {
-		tst_count = 0;
-		for (testno = 0; testno < TST_TOTAL; ++testno) {
-			tdat[testno].setup();
-
-			TEST(getsockopt(s, tdat[testno].level,
-					tdat[testno].optname,
-					tdat[testno].optval,
-					tdat[testno].optlen));
-			if (TEST_RETURN != tdat[testno].retval ||
-			    (TEST_RETURN < 0 &&
-			     TEST_ERRNO != tdat[testno].experrno)) {
-				tst_resm(TFAIL, "%s ; returned"
-					 " %ld (expected %d), errno %d (expected"
-					 " %d)", tdat[testno].desc,
-					 TEST_RETURN, tdat[testno].retval,
-					 TEST_ERRNO, tdat[testno].experrno);
-			} else {
-				tst_resm(TPASS, "%s successful",
-					 tdat[testno].desc);
-			}
-			tdat[testno].cleanup();
-		}
-	}
-	cleanup();
-
-	tst_exit();
-}
+	{.sockfd = &sock_bind, .level = IPPROTO_UDP, .optname = SO_OOBINLINE, .optval = &optval,
+	.optlen = &optlen, .experrno = EOPNOTSUPP, .desc = "not supported option name (UDP)"},
 
-void setup(void)
-{
-	TEST_PAUSE;
+	{.sockfd = &sock_bind, .level = IPPROTO_IP, .optname = -1, .optval = &optval,
+	.optlen = &optlen, .experrno = ENOPROTOOPT, .desc =  "invalid option name (IP)"},
 
-	/* initialize local sockaddr */
-	sin0.sin_family = AF_INET;
-	sin0.sin_port = 0;
-	sin0.sin_addr.s_addr = INADDR_ANY;
-}
+	{.sockfd = &sock_bind, .level = IPPROTO_TCP, .optname = -1, .optval = &optval,
+	.optlen = &optlen, .experrno = ENOPROTOOPT, .desc = "invalid option name (TCP)"},
 
-void cleanup(void)
-{
-}
+	{.sockfd = &sock_bind, .level = SOL_SOCKET, .optname = SO_OOBINLINE, .optval = &optval,
+	.optlen = &optleninval, .experrno = EINVAL, .desc = "invalid optlen"},
+};
 
-void setup0(void)
-{
-	if (tdat[testno].experrno == EBADF)
-		s = 400;	/* anything not an open file */
-	else if ((s = open("/dev/null", O_WRONLY)) == -1)
-		tst_brkm(TBROK, cleanup, "error opening /dev/null - "
-			 "errno: %s", strerror(errno));
-}
 
-void cleanup0(void)
+static void check_getsockopt(unsigned int nr)
 {
-	s = -1;
+	struct test_case *tc = &tcases[nr];
+
+	TST_EXP_FAIL(getsockopt(*(tc->sockfd), tc->level, tc->optname, tc->optval, tc->optlen),
+		     tc->experrno, "%s", tc->desc);
 }
 
-void setup1(void)
+static void setup(void)
 {
-	s = SAFE_SOCKET(cleanup, tdat[testno].domain, tdat[testno].type,
-			tdat[testno].proto);
-	SAFE_BIND(cleanup, s, (struct sockaddr *)&sin0, sizeof(sin0));
-	sinlen = sizeof(fsin1);
+	sin0.sin_family = AF_INET;
+	sin0.sin_port = 0;
+	sin0.sin_addr.s_addr = INADDR_ANY;
+	sock_fake = 400;
+	sock_null = SAFE_OPEN("/dev/null", O_WRONLY);
+	sock_bind = SAFE_SOCKET(PF_INET, SOCK_STREAM, 0);
+	SAFE_BIND(sock_bind, (struct sockaddr *)&sin0, sizeof(sin0));
+	sinlen = sizeof(sin0);
 	optlen = sizeof(optval);
 }
 
-void cleanup1(void)
-{
-	(void)close(s);
-	s = -1;
-}
+static struct tst_test test = {
+	.setup = setup,
+	.test = check_getsockopt,
+	.tcnt = ARRAY_SIZE(tcases),
+};
diff --git a/testcases/kernel/syscalls/getxattr/getxattr01.c b/testcases/kernel/syscalls/getxattr/getxattr01.c
index cec802a33..50b00c0a5 100644
--- a/testcases/kernel/syscalls/getxattr/getxattr01.c
+++ b/testcases/kernel/syscalls/getxattr/getxattr01.c
@@ -1,142 +1,64 @@
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) 2011  Red Hat, Inc.
- *
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of version 2 of the GNU General Public
- * License as published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it would be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- *
- * Further, this software is distributed without any warranty that it
- * is free of the rightful claim of any third person regarding
- * infringement or the like.  Any license provided herein, whether
- * implied or otherwise, applies only to this software file.  Patent
- * licenses, if any, provided herein do not apply to combinations of
- * this program with other software, or any other product whatsoever.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
- * 02110-1301, USA.
+ * Copyright (c) Linux Test Project, 2012-2024
  */
 
-/*
+/*\
+ * [Description]
+ *
  * Basic tests for getxattr(2) and make sure getxattr(2) handles error
  * conditions correctly.
  *
- * There are 4 test cases:
- * 1. Get an non-existing attribute,
- *    getxattr(2) should return -1 and set errno to ENODATA
- * 2. Buffer size is smaller than attribute value size,
- *    getxattr(2) should return -1 and set errno to ERANGE
- * 3. Get attribute, getxattr(2) should succeed
- * 4. Verify the attribute got by getxattr(2) is same as the value we set
+ * 1. Get an non-existing attribute, getxattr(2) should return -1 and set errno
+ *    to ENODATA.
+ * 2. Buffer size is smaller than attribute value size, getxattr(2) should
+ *    return -1 and set errno to ERANGE.
+ * 3. Get attribute, getxattr(2) should succeed, and the attribute got by
+ *    getxattr(2) should be same as the value we set.
  */
 
-#include "config.h"
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <errno.h>
-#include <fcntl.h>
-#include <unistd.h>
-#include <stdio.h>
 #include <stdlib.h>
-#include <string.h>
-#ifdef HAVE_SYS_XATTR_H
-# include <sys/xattr.h>
-#endif
-#include "test.h"
-#include "safe_macros.h"
+#include "tst_test.h"
+#include <sys/xattr.h>
 
-char *TCID = "getxattr01";
+#define XATTR_TEST_NOKEY	"user.nosuchkey"
+#define XATTR_TEST_KEY		"user.testkey"
+#define XATTR_TEST_VALUE	"this is a test value"
+#define XATTR_TEST_VALUE_SIZE	20
+#define BUFFSIZE		64
 
-#ifdef HAVE_SYS_XATTR_H
-#define XATTR_TEST_KEY "user.testkey"
-#define XATTR_TEST_VALUE "this is a test value"
-#define XATTR_TEST_VALUE_SIZE 20
-#define BUFFSIZE 64
+static char filename[BUFSIZ];
 
-static void setup(void);
-static void cleanup(void);
-
-char filename[BUFSIZ];
-
-struct test_case {
-	char *fname;
+static struct tcase {
 	char *key;
 	char *value;
 	size_t size;
 	int exp_err;
-};
-struct test_case tc[] = {
-	{			/* case 00, get non-existing attribute */
-	 .fname = filename,
-	 .key = "user.nosuchkey",
-	 .value = NULL,
-	 .size = BUFFSIZE - 1,
-	 .exp_err = ENODATA,
-	 },
-	{			/* case 01, small value buffer */
-	 .fname = filename,
-	 .key = XATTR_TEST_KEY,
-	 .value = NULL,
-	 .size = 1,
-	 .exp_err = ERANGE,
-	 },
-	{			/* case 02, get existing attribute */
-	 .fname = filename,
-	 .key = XATTR_TEST_KEY,
-	 .value = NULL,
-	 .size = BUFFSIZE - 1,
-	 .exp_err = 0,
-	 },
+} tcases[] = {
+	{ .key = XATTR_TEST_NOKEY, .size = BUFFSIZE - 1, .exp_err = ENODATA },
+	{ .key = XATTR_TEST_KEY, .size = 1, .exp_err = ERANGE },
+	{ .key = XATTR_TEST_KEY, .size = BUFFSIZE - 1 },
 };
 
-int TST_TOTAL = sizeof(tc) / sizeof(tc[0]) + 1;
-
-int main(int argc, char *argv[])
+static void run(unsigned int n)
 {
-	int lc;
-	int i;
-
-	tst_parse_opts(argc, argv, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-
-		for (i = 0; i < (int)ARRAY_SIZE(tc); i++) {
-			TEST(getxattr(tc[i].fname, tc[i].key, tc[i].value,
-				      tc[i].size));
-
-			if (TEST_ERRNO == tc[i].exp_err) {
-				tst_resm(TPASS | TTERRNO, "expected behavior");
-			} else {
-				tst_resm(TFAIL | TTERRNO, "unexpected behavior"
-					 "- expected errno %d - Got",
-					 tc[i].exp_err);
-			}
-		}
-
-		if (TEST_RETURN != XATTR_TEST_VALUE_SIZE) {
-			tst_resm(TFAIL,
-				 "getxattr() returned wrong size %ld expected %d",
-				 TEST_RETURN, XATTR_TEST_VALUE_SIZE);
-			continue;
-		}
-
-		if (memcmp(tc[i - 1].value, XATTR_TEST_VALUE, XATTR_TEST_VALUE_SIZE))
-			tst_resm(TFAIL, "Wrong value, expect \"%s\" got \"%s\"",
-				 XATTR_TEST_VALUE, tc[i - 1].value);
-		else
-			tst_resm(TPASS, "Got the right value");
+	struct tcase *tc = &tcases[n];
+
+	if (tc->exp_err) {
+		TST_EXP_FAIL(getxattr(filename, tc->key, tc->value, tc->size),
+			     tc->exp_err);
+		return;
 	}
 
-	cleanup();
-	tst_exit();
+	TST_EXP_VAL(getxattr(filename, tc->key, tc->value, tc->size),
+			XATTR_TEST_VALUE_SIZE);
+
+	if (memcmp(tc->value, XATTR_TEST_VALUE, XATTR_TEST_VALUE_SIZE))
+		tst_res(TFAIL, "Wrong value, expect '%s' got '%s'",
+			XATTR_TEST_VALUE, tc->value);
+	else
+		tst_res(TPASS, "getxattr() retrieved expected value");
 }
 
 static void setup(void)
@@ -144,41 +66,31 @@ static void setup(void)
 	int fd;
 	unsigned int i;
 
-	tst_require_root();
-
-	tst_tmpdir();
-
 	/* Create test file and setup initial xattr */
 	snprintf(filename, BUFSIZ, "getxattr01testfile");
-	fd = SAFE_CREAT(cleanup, filename, 0644);
-	close(fd);
-	if (setxattr(filename, XATTR_TEST_KEY, XATTR_TEST_VALUE,
-		     strlen(XATTR_TEST_VALUE), XATTR_CREATE) == -1) {
-		if (errno == ENOTSUP) {
-			tst_brkm(TCONF, cleanup, "No xattr support in fs or "
-				 "mount without user_xattr option");
-		}
-	}
+	fd = SAFE_CREAT(filename, 0644);
+	SAFE_CLOSE(fd);
 
-	/* Prepare test cases */
-	for (i = 0; i < ARRAY_SIZE(tc); i++) {
-		tc[i].value = malloc(BUFFSIZE);
-		if (tc[i].value == NULL) {
-			tst_brkm(TBROK | TERRNO, cleanup,
-				 "Cannot allocate memory");
-		}
-	}
+	SAFE_SETXATTR(filename, XATTR_TEST_KEY, XATTR_TEST_VALUE,
+		      strlen(XATTR_TEST_VALUE), XATTR_CREATE);
 
-	TEST_PAUSE;
+	for (i = 0; i < ARRAY_SIZE(tcases); i++)
+		tcases[i].value = SAFE_MALLOC(BUFFSIZE);
 }
 
 static void cleanup(void)
 {
-	tst_rmdir();
-}
-#else /* HAVE_SYS_XATTR_H */
-int main(int argc, char *argv[])
-{
-	tst_brkm(TCONF, NULL, "<sys/xattr.h> does not exist.");
+	unsigned int i;
+
+	for (i = 0; i < ARRAY_SIZE(tcases); i++)
+		free(tcases[i].value);
 }
-#endif
+
+static struct tst_test test = {
+	.needs_tmpdir = 1,
+	.needs_root = 1,
+	.setup = setup,
+	.cleanup = cleanup,
+	.tcnt = ARRAY_SIZE(tcases),
+	.test = run,
+};
diff --git a/testcases/kernel/syscalls/getxattr/getxattr04.c b/testcases/kernel/syscalls/getxattr/getxattr04.c
index e64f2a1f1..61c8826c9 100644
--- a/testcases/kernel/syscalls/getxattr/getxattr04.c
+++ b/testcases/kernel/syscalls/getxattr/getxattr04.c
@@ -4,19 +4,16 @@
  * Author: Xiao Yang <yangx.jy@cn.fujitsu.com>
  */
 
-/*
+/*\
+ * [Description]
+ *
  * This is a regression test for the race between getting an existing
  * xattr and setting/removing a large xattr.  This bug leads to that
  * getxattr() fails to get an existing xattr and returns ENOATTR in xfs
  * filesystem.
  *
- * Thie bug has been fixed in:
- *
- * commit 5a93790d4e2df73e30c965ec6e49be82fc3ccfce
- * Author: Brian Foster <bfoster@redhat.com>
- * Date:   Wed Jan 25 07:53:43 2017 -0800
- *
- * xfs: remove racy hasattr check from attr ops
+ * This bug has been fixed in:
+ * 5a93790d4e2d ("xfs: remove racy hasattr check from attr ops")
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/getxattr/getxattr05.c b/testcases/kernel/syscalls/getxattr/getxattr05.c
index 8d1752fd0..d9717a695 100644
--- a/testcases/kernel/syscalls/getxattr/getxattr05.c
+++ b/testcases/kernel/syscalls/getxattr/getxattr05.c
@@ -4,15 +4,18 @@
  * Author: Xiao Yang <yangx.jy@cn.fujitsu.com>
  */
 
-/*
- * Description:
- * 1) Witout a user namespace, getxattr(2) should get same data when
- *    acquiring the value of system.posix_acl_access twice.
- * 2) With/Without mapped root UID in a user namespaces, getxattr(2) should
- *    get same data when acquiring the value of system.posix_acl_access twice.
+/*\
+ * [Description]
+ *
+ * This test verifies that:
+ *
+ * - Without a user namespace, getxattr(2) should get same data when
+ *   acquiring the value of system.posix_acl_access twice.
+ * - With/Without mapped root UID in a user namespaces, getxattr(2) should
+ *   get same data when acquiring the value of system.posix_acl_access twice.
  *
  * This issue included by getxattr05 has been fixed in kernel:
- * '82c9a927bc5d ("getxattr: use correct xattr length")'
+ * 82c9a927bc5d ("getxattr: use correct xattr length")
  */
 
 #define _GNU_SOURCE
@@ -175,6 +178,10 @@ static struct tst_test test = {
 	.cleanup = cleanup,
 	.tcnt = ARRAY_SIZE(tcases),
 	.test = do_getxattr,
+	.tags = (const struct tst_tag[]) {
+		{"linux-git", "82c9a927bc5d"},
+		{}
+},
 };
 
 #else /* HAVE_SYS_XATTR_H && HAVE_LIBACL*/
diff --git a/testcases/kernel/syscalls/init_module/init_module01.c b/testcases/kernel/syscalls/init_module/init_module01.c
index 26ff0b93b..27a1fc627 100644
--- a/testcases/kernel/syscalls/init_module/init_module01.c
+++ b/testcases/kernel/syscalls/init_module/init_module01.c
@@ -13,18 +13,26 @@
  * Inserts a simple module after opening and mmaping the module file.
  */
 
+#include <stdlib.h>
 #include <errno.h>
 #include "lapi/init_module.h"
 #include "tst_module.h"
+#include "tst_kconfig.h"
 
 #define MODULE_NAME	"init_module.ko"
 
 static struct stat sb;
 static void *buf;
+static int sig_enforce;
 
 static void setup(void)
 {
 	int fd;
+	struct tst_kcmdline_var params = TST_KCMDLINE_INIT("module.sig_enforce");
+
+	tst_kcmdline_parse(&params, 1);
+	if (params.found)
+		sig_enforce = atoi(params.value);
 
 	tst_module_exists(MODULE_NAME, NULL);
 
@@ -36,6 +44,12 @@ static void setup(void)
 
 static void run(void)
 {
+	if (sig_enforce == 1) {
+		tst_res(TINFO, "module signature is enforced");
+		TST_EXP_FAIL(init_module(buf, sb.st_size, "status=valid"), EKEYREJECTED);
+		return;
+	}
+
 	TST_EXP_PASS(init_module(buf, sb.st_size, "status=valid"));
 	if (!TST_PASS)
 		return;
diff --git a/testcases/kernel/syscalls/init_module/init_module02.c b/testcases/kernel/syscalls/init_module/init_module02.c
index e6730e21c..68d9ff16b 100644
--- a/testcases/kernel/syscalls/init_module/init_module02.c
+++ b/testcases/kernel/syscalls/init_module/init_module02.c
@@ -14,15 +14,17 @@
  */
 
 #include <linux/capability.h>
+#include <stdlib.h>
 #include <errno.h>
 #include "lapi/init_module.h"
+#include "tst_kconfig.h"
 #include "tst_module.h"
 #include "tst_capability.h"
 
 #define MODULE_NAME	"init_module.ko"
 
 static unsigned long size, zero_size;
-static int kernel_lockdown, secure_boot;
+static int kernel_lockdown, secure_boot, sig_enforce;
 static void *buf, *faulty_buf, *null_buf;
 
 static struct tst_cap cap_req = TST_CAP(TST_CAP_REQ, CAP_SYS_MODULE);
@@ -44,12 +46,18 @@ static struct tcase {
 	{"invalid_param", &buf, &size, "status=invalid", 0, 1, EINVAL},
 	{"no-perm", &buf, &size, "", 1, 0, EPERM},
 	{"module-exists", &buf, &size, "", 0, 1, EEXIST},
+	{"module-unsigned", &buf, &size, "", 0, 1, EKEYREJECTED},
 };
 
 static void setup(void)
 {
 	struct stat sb;
 	int fd;
+	struct tst_kcmdline_var params = TST_KCMDLINE_INIT("module.sig_enforce");
+
+	tst_kcmdline_parse(&params, 1);
+	if (params.found)
+		sig_enforce = atoi(params.value);
 
 	tst_module_exists(MODULE_NAME, NULL);
 
@@ -73,6 +81,16 @@ static void run(unsigned int n)
 		return;
 	}
 
+	if ((sig_enforce == 1) && (tc->exp_errno != EKEYREJECTED)) {
+		tst_res(TCONF, "module signature is enforced, skipping %s", tc->name);
+		return;
+	}
+
+	if ((sig_enforce != 1) && (tc->exp_errno == EKEYREJECTED)) {
+		tst_res(TCONF, "module signature is not enforced, skipping %s", tc->name);
+		return;
+	}
+
 	if (tc->cap)
 		tst_cap_action(&cap_drop);
 
diff --git a/testcases/kernel/syscalls/inotify/inotify01.c b/testcases/kernel/syscalls/inotify/inotify01.c
index 2d82e5970..e0fa0ba50 100644
--- a/testcases/kernel/syscalls/inotify/inotify01.c
+++ b/testcases/kernel/syscalls/inotify/inotify01.c
@@ -2,13 +2,14 @@
 /*
  * Copyright (c) 2007 SWSoft.  All Rights Reserved.
  * Author: Andrew Vagin <avagin@sw.ru>
+ */
+
+/*\
+ * [Description]
  *
- * DESCRIPTION
- *     Check that inotify work for a file
- *
- * ALGORITHM
- *     Execute sequence file's operation and check return events
+ * Basic test for inotify events on file.
  */
+
 #include "config.h"
 
 #include <stdio.h>
diff --git a/testcases/kernel/syscalls/inotify/inotify02.c b/testcases/kernel/syscalls/inotify/inotify02.c
index cd1cb97bd..d75395bae 100644
--- a/testcases/kernel/syscalls/inotify/inotify02.c
+++ b/testcases/kernel/syscalls/inotify/inotify02.c
@@ -2,12 +2,12 @@
 /*
  * Copyright (c) 2007 SWSoft.  All Rights Reserved.
  * Author: Andrew Vagin <avagin@sw.ru>
+ */
+
+/*\
+ * [Description]
  *
- * DESCRIPTION
- *     Check that inotify work for a directory
- *
- * ALGORITHM
- *     Execute sequence file's operation and check return events
+ * Basic test for inotify events on directory.
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify03.c b/testcases/kernel/syscalls/inotify/inotify03.c
index 01a115546..ff025b360 100644
--- a/testcases/kernel/syscalls/inotify/inotify03.c
+++ b/testcases/kernel/syscalls/inotify/inotify03.c
@@ -2,13 +2,12 @@
 /*
  * Copyright (c) 2008 Parallels.  All Rights Reserved.
  * Author: Andrew Vagin <avagin@gmail.com>
+ */
+
+/*\
+ * [Description]
  *
- * DESCRIPTION
- *	Check that inotify get IN_UNMOUNT event and
- *	don't block the umount command.
- *
- * ALGORITHM
- *	Execute sequence file's operation and check return events
+ * Check that inotify get IN_UNMOUNT event and don't block the umount command.
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify04.c b/testcases/kernel/syscalls/inotify/inotify04.c
index 70c7fecfd..120e73b91 100644
--- a/testcases/kernel/syscalls/inotify/inotify04.c
+++ b/testcases/kernel/syscalls/inotify/inotify04.c
@@ -1,18 +1,22 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2012 Linux Test Project.  All Rights Reserved.
  * Ngie Cooper, April 2012
+ */
+
+/*\
+ * [Description]
+ *
+ * Test for inotify IN_DELETE_SELF event.
  *
- * DESCRIPTION
- *     verify that IN_DELETE_SELF functions as expected
+ * [Algorithm]
  *
- * ALGORITHM
- *     This testcase creates a temporary directory, then add watches to a
- *     predefined file and subdirectory, and delete the file and directory to
- *     ensure that the IN_DELETE_SELF event is captured properly.
+ * This testcase creates a temporary directory, then add watches to a
+ * predefined file and subdirectory, and delete the file and directory
+ * to ensure that the IN_DELETE_SELF event is captured properly.
  *
- *     Because of how the inotify(7) API is designed, we also need to catch the
- *     IN_ATTRIB and IN_IGNORED events.
+ * Because of how the inotify(7) API is designed, we also need to catch
+ * the IN_ATTRIB and IN_IGNORED events.
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify05.c b/testcases/kernel/syscalls/inotify/inotify05.c
index c83ff45a1..a1597217f 100644
--- a/testcases/kernel/syscalls/inotify/inotify05.c
+++ b/testcases/kernel/syscalls/inotify/inotify05.c
@@ -2,14 +2,14 @@
 /*
  * Copyright (c) 2014 SUSE Linux.  All Rights Reserved.
  * Author: Jan Kara <jack@suse.cz>
+ */
+
+/*\
+ * [Description]
  *
- * DESCRIPTION
- *     Check that inotify overflow event is properly generated
- *
- * ALGORITHM
- *     Generate enough events without reading them and check that overflow
- *     event is generated.
+ * Check that inotify overflow event is properly generated.
  */
+
 #include "config.h"
 
 #include <stdio.h>
diff --git a/testcases/kernel/syscalls/inotify/inotify06.c b/testcases/kernel/syscalls/inotify/inotify06.c
index 900bc1cb2..7452ee47d 100644
--- a/testcases/kernel/syscalls/inotify/inotify06.c
+++ b/testcases/kernel/syscalls/inotify/inotify06.c
@@ -2,8 +2,11 @@
 /*
  * Copyright (c) 2015 SUSE Linux.  All Rights Reserved.
  * Author: Jan Kara <jack@suse.cz>
+ */
+
+/*\
+ * [Description]
  *
- * DESCRIPTION
  * Test for inotify mark destruction race.
  *
  * Kernels prior to 4.2 have a race when inode is being deleted while
@@ -11,7 +14,7 @@
  * hit, the kernel crashes or loops.
  *
  * The problem has been fixed by commit:
- *  8f2f3eb59dff "fsnotify: fix oops in fsnotify_clear_marks_by_group_flags()".
+ * 8f2f3eb59dff ("fsnotify: fix oops in fsnotify_clear_marks_by_group_flags()").
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify07.c b/testcases/kernel/syscalls/inotify/inotify07.c
index a8820f0c7..08ea1e06a 100644
--- a/testcases/kernel/syscalls/inotify/inotify07.c
+++ b/testcases/kernel/syscalls/inotify/inotify07.c
@@ -2,22 +2,26 @@
 /*
  * Copyright (c) 2018 CTERA Networks.  All Rights Reserved.
  * Author: Amir Goldstein <amir73il@gmail.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Check that inotify work for an overlayfs directory after copy up and
+ * drop caches.
  *
- * DESCRIPTION
- *     Check that inotify work for an overlayfs directory after copy up and
- *     drop caches.
+ * An inotify watch pins the directory inode in cache, but not the dentry.
+ * The watch will not report events on the directory if overlayfs does not
+ * obtain the pinned inode to the new allocated dentry after drop caches.
  *
- *     An inotify watch pins the directory inode in cache, but not the dentry.
- *     The watch will not report events on the directory if overlayfs does not
- *     obtain the pinned inode to the new allocated dentry after drop caches.
+ * The problem has been fixed by commit:
+ * 31747eda41ef ("ovl: hash directory inodes for fsnotify").
  *
- *     The problem has been fixed by commit:
- *       31747eda41ef "ovl: hash directory inodes for fsnotify"
+ * [Algorithm]
  *
- * ALGORITHM
- *     Add watch on an overlayfs lower directory then chmod directory and drop
- *     dentry and inode caches. Execute operations on directory and child and
- *     expect events to be reported on directory watch.
+ * Add watch on an overlayfs lower directory then chmod directory and drop
+ * dentry and inode caches. Execute operations on directory and child and
+ * expect events to be reported on directory watch.
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify08.c b/testcases/kernel/syscalls/inotify/inotify08.c
index 6a4278cba..9c2ecdabd 100644
--- a/testcases/kernel/syscalls/inotify/inotify08.c
+++ b/testcases/kernel/syscalls/inotify/inotify08.c
@@ -2,22 +2,26 @@
 /*
  * Copyright (c) 2018 CTERA Networks.  All Rights Reserved.
  * Author: Amir Goldstein <amir73il@gmail.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Check that inotify work for an overlayfs file after copy up and
+ * drop caches.
  *
- * DESCRIPTION
- *     Check that inotify work for an overlayfs file after copy up and
- *     drop caches.
+ * An inotify watch pins the file inode in cache, but not the dentry.
+ * The watch will not report events on the file if overlayfs does not
+ * obtain the pinned inode to the new allocated dentry after drop caches.
  *
- *     An inotify watch pins the file inode in cache, but not the dentry.
- *     The watch will not report events on the file if overlayfs does not
- *     obtain the pinned inode to the new allocated dentry after drop caches.
+ * The problem has been fixed by commit:
+ * 764baba80168 ("ovl: hash non-dir by lower inode for fsnotify").
  *
- *     The problem has been fixed by commit:
- *       764baba80168 "ovl: hash non-dir by lower inode for fsnotify"
+ * [Algorithm]
  *
- * ALGORITHM
- *     Add watch on an overlayfs lower file then chmod file and drop dentry
- *     and inode caches. Execute operations on file and expect events to be
- *     reported on file watch.
+ * Add watch on an overlayfs lower file then chmod file and drop dentry
+ * and inode caches. Execute operations on file and expect events to be
+ * reported on file watch.
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify09.c b/testcases/kernel/syscalls/inotify/inotify09.c
index 4ce8e51da..62d529d04 100644
--- a/testcases/kernel/syscalls/inotify/inotify09.c
+++ b/testcases/kernel/syscalls/inotify/inotify09.c
@@ -3,8 +3,11 @@
  * Copyright (c) 2018 SUSE Linux.  All Rights Reserved.
  * Author: Jan Kara <jack@suse.cz>
  * Chnaged to use fzsync library by Cyril Hrubis <chrubis@suse.cz>
+ */
+
+/*\
+ * [Description]
  *
- * DESCRIPTION
  * Test for inotify mark connector destruction race.
  *
  * Kernels prior to 4.17 have a race when the last fsnotify mark on the inode
@@ -12,7 +15,7 @@
  * inode. When the race is hit, the kernel crashes or loops.
  *
  * The problem has been fixed by commit:
- * d90a10e2444b "fsnotify: Fix fsnotify_mark_connector race"
+ * d90a10e2444b ("fsnotify: Fix fsnotify_mark_connector race").
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify10.c b/testcases/kernel/syscalls/inotify/inotify10.c
index eb2322090..6a9a0a436 100644
--- a/testcases/kernel/syscalls/inotify/inotify10.c
+++ b/testcases/kernel/syscalls/inotify/inotify10.c
@@ -1,17 +1,20 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2020 CTERA Networks. All Rights Reserved.
  *
  * Started by Amir Goldstein <amir73il@gmail.com>
+ */
+
+/*\
+ * [Description]
  *
- * DESCRIPTION
- *     Check that event is reported to watching parent and watching child
- *     based on their interest
+ * Check that event is reported to watching parent and watching child
+ * based on their interest.
  *
  * Test case #3 is a regression test for commit fecc4559780d that fixes
  * a bug introduced in kernel v5.9:
  *
- *     fsnotify: fix events reported to watching parent and child
+ * fecc4559780d ("fsnotify: fix events reported to watching parent and child").
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify11.c b/testcases/kernel/syscalls/inotify/inotify11.c
index dd32ea7fd..b750e6c04 100644
--- a/testcases/kernel/syscalls/inotify/inotify11.c
+++ b/testcases/kernel/syscalls/inotify/inotify11.c
@@ -8,12 +8,13 @@
 
 /*\
  * [Description]
+ *
  * Test opening files after receiving IN_DELETE.
  *
  * Kernel v5.13 has a regression allowing files to be open after IN_DELETE.
  *
  * The problem has been fixed by commit:
- *  a37d9a17f099 "fsnotify: invalidate dcache before IN_DELETE event".
+ * a37d9a17f099 ("fsnotify: invalidate dcache before IN_DELETE event").
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/inotify/inotify12.c b/testcases/kernel/syscalls/inotify/inotify12.c
index e658f4ae7..2eef545cf 100644
--- a/testcases/kernel/syscalls/inotify/inotify12.c
+++ b/testcases/kernel/syscalls/inotify/inotify12.c
@@ -7,10 +7,11 @@
 
 /*\
  * [Description]
+ *
  * Test special inotify mask flags.
  *
  * Regression test for kernel commit:
- * a32e697cda27 ("inotify: show inotify mask flags in proc fdinfo")
+ * a32e697cda27 ("inotify: show inotify mask flags in proc fdinfo").
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/io_submit/Makefile b/testcases/kernel/syscalls/io_submit/Makefile
index ce4f13b72..7d39a3690 100644
--- a/testcases/kernel/syscalls/io_submit/Makefile
+++ b/testcases/kernel/syscalls/io_submit/Makefile
@@ -5,6 +5,6 @@ top_srcdir		?= ../../../..
 
 include $(top_srcdir)/include/mk/testcases.mk
 
-LDLIBS			+= $(AIO_LIBS)
+io_submit01:	LDLIBS	+= $(AIO_LIBS)
 
 include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/kernel/syscalls/ioctl/ioctl02.c b/testcases/kernel/syscalls/ioctl/ioctl02.c
index aab80b251..f3bfb239a 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl02.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl02.c
@@ -26,7 +26,7 @@
 
 #include <stdio.h>
 #include <stdlib.h>
-#include <termios.h>
+#include <asm/termbits.h>
 
 #include "lapi/ioctl.h"
 #include "tst_test.h"
diff --git a/testcases/kernel/syscalls/ioctl/ioctl03.c b/testcases/kernel/syscalls/ioctl/ioctl03.c
index 5a7a0a6a2..890238f7d 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl03.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl03.c
@@ -4,12 +4,14 @@
  * Copyright (c) Linux Test Project, 2017-2019
  * Author: Rusty Russell <rusty@rustcorp.com.au>
  * Ported to LTP: subrata <subrata@linux.vnet.ibm.com>
+ * Test ioriginally written for kernel 2.6.27.
  */
 
-/*
- * This program tests whether all the valid IFF flags are
- * returned properly by implementation of TUNGETFEATURES ioctl
- * on kernel 2.6.27
+/*\
+ * [Description]
+ *
+ * Test whether all the valid IFF flags are returned properly by implementation
+ * of TUNGETFEATURES ioctl.
  */
 
 #include <sys/types.h>
diff --git a/testcases/kernel/syscalls/ioctl/ioctl04.c b/testcases/kernel/syscalls/ioctl/ioctl04.c
index d9ddb8e59..262c06e97 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl04.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl04.c
@@ -2,7 +2,10 @@
 /*
  * Copyright (c) 2017 Cyril Hrubis <chrubis@suse.cz>
  */
-/*
+
+/*\
+ * [Description]
+ *
  * Basic test for the BLKROSET and BLKROGET ioctls.
  *
  * - Set the device read only, read the value back.
diff --git a/testcases/kernel/syscalls/ioctl/ioctl05.c b/testcases/kernel/syscalls/ioctl/ioctl05.c
index a53e8adbe..8e3abf14f 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl05.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl05.c
@@ -2,7 +2,10 @@
 /*
  * Copyright (c) 2017 Cyril Hrubis <chrubis@suse.cz>
  */
-/*
+
+/*\
+ * [Description]
+ *
  * Basic test for the BLKGETSIZE and BLKGETSIZE64 ioctls.
  *
  * - BLKGETSIZE returns size in 512 byte blocks BLKGETSIZE64 in bytes
diff --git a/testcases/kernel/syscalls/ioctl/ioctl06.c b/testcases/kernel/syscalls/ioctl/ioctl06.c
index 6e56beeef..754d4acfc 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl06.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl06.c
@@ -2,7 +2,10 @@
 /*
  * Copyright (c) 2017 Cyril Hrubis <chrubis@suse.cz>
  */
-/*
+
+/*\
+ * [Description]
+ *
  * Basic test for the BLKRASET and BLKRAGET ioctls.
  *
  * Sets device read-ahead, reads it back and compares the values.
diff --git a/testcases/kernel/syscalls/ioctl/ioctl07.c b/testcases/kernel/syscalls/ioctl/ioctl07.c
index 073ff033f..ea88cf73b 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl07.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl07.c
@@ -2,11 +2,14 @@
 /*
  * Copyright (c) 2017 Carlo Marcelo Arenas Beln <carenas@gmail.com>
  */
-/*
+
+/*\
+ * [Description]
+ *
  * Very basic test for the RND* ioctls.
  *
  * Reads the entropy available from both /proc and the ioctl and compares
- * they are similar enough (within a configured fuzz factor)
+ * they are similar enough (within a configured fuzz factor).
  *
  */
 
diff --git a/testcases/kernel/syscalls/ioctl/ioctl08.c b/testcases/kernel/syscalls/ioctl/ioctl08.c
index b877bf2ad..1fb195797 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl08.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl08.c
@@ -2,17 +2,21 @@
 /*
  * Copyright (c) 2019 SUSE LLC
  * Author: Christian Amann <camann@suse.com>
+ */
+
+/*\
+ * [Description]
  *
  * Tests the ioctl functionality to deduplicate fileranges using
  * btrfs filesystem.
  *
- * 1)	Sets the same contents for two files and deduplicates it.
+ * 1. Sets the same contents for two files and deduplicates it.
  *	Deduplicates 3 bytes and set the status to
  *	FILE_DEDUPE_RANGE_SAME.
- * 2)	Sets different content for two files and tries to
+ * 2. Sets different content for two files and tries to
  *	deduplicate it. 0 bytes get deduplicated and status is
  *	set to FILE_DEDUPE_RANGE_DIFFERS.
- * 3)	Sets same content for two files but sets the length to
+ * 3. Sets same content for two files but sets the length to
  *	deduplicate to -1. ioctl(FIDEDUPERANGE) fails with EINVAL.
  */
 
diff --git a/testcases/kernel/syscalls/ioctl/ioctl09.c b/testcases/kernel/syscalls/ioctl/ioctl09.c
index 23ad6e30a..9c7921086 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl09.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl09.c
@@ -2,6 +2,10 @@
 /*
  * Copyright (c) 2020 FUJITSU LIMITED. All rights reserved.
  * Author: Yang Xu <xuyang2018.jy@cn.jujitsu.com>
+ */
+
+/*\
+ * [Description]
  *
  * Basic test for the BLKRRPART ioctl, it is the same as blockdev
  * --rereadpt command.
diff --git a/testcases/kernel/syscalls/ioctl/ioctl_sg01.c b/testcases/kernel/syscalls/ioctl/ioctl_sg01.c
index dfbba399d..d130e7130 100644
--- a/testcases/kernel/syscalls/ioctl/ioctl_sg01.c
+++ b/testcases/kernel/syscalls/ioctl/ioctl_sg01.c
@@ -3,7 +3,9 @@
  * Copyright (c) 2019 SUSE LLC <mdoucha@suse.cz>
  */
 
-/*
+/*\
+ * [Description]
+ *
  * CVE-2018-1000204
  *
  * Test ioctl(SG_IO) and check that kernel doesn't leak data. Requires
diff --git a/testcases/kernel/syscalls/iopl/iopl01.c b/testcases/kernel/syscalls/iopl/iopl01.c
index 70e2a7ff1..0b7e8823f 100644
--- a/testcases/kernel/syscalls/iopl/iopl01.c
+++ b/testcases/kernel/syscalls/iopl/iopl01.c
@@ -1,17 +1,18 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *  Copyright (c) Linux Test Project, 2020
- *  Copyright (c) Wipro Technologies Ltd, 2002
+ * Copyright (c) Linux Test Project, 2003-2024
+ * Copyright (c) Wipro Technologies Ltd, 2002
+ * Author: Subhab Biswas <subhabrata.biswas@wipro.com>
  */
 
-/*
+/*\
+ * [Description]
+ *
  * This is a basic test for iopl(2) system call.
  *
- * Test the system call for possible privelege levels.
- * As the privelge level for a normal process is 0, start by
+ * Test the system call for possible privilege levels.
+ * As the privilege level for a normal process is 0, start by
  * setting/changing the level to 0.
- *
- * Author: Subhab Biswas <subhabrata.biswas@wipro.com>
  */
 
 #include <errno.h>
diff --git a/testcases/kernel/syscalls/iopl/iopl02.c b/testcases/kernel/syscalls/iopl/iopl02.c
index 7301442f9..1a588590e 100644
--- a/testcases/kernel/syscalls/iopl/iopl02.c
+++ b/testcases/kernel/syscalls/iopl/iopl02.c
@@ -1,19 +1,17 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *  Copyright (c) Linux Test Project, 2020
- *  Copyright (c) Wipro Technologies Ltd, 2002
+ * Copyright (c) Linux Test Project, 2020
+ * Copyright (c) Wipro Technologies Ltd, 2002
+ * Author: Subhab Biswas <subhabrata.biswas@wipro.com>
  */
 
-/*
- * This is an error test for iopl(2) system call.
+/*\
+ * [Description]
  *
- * Verify that
- *  1) iopl(2) returns -1 and sets errno to EINVAL for privilege
- *     level greater than 3.
- *  2) iopl(2) returns -1 and sets errno to EPERM if the current
- *     user is not the super-user.
+ * Test for iopl(2) system call error.
  *
- * Author: Subhab Biswas <subhabrata.biswas@wipro.com>
+ * - iopl(2) fail with EINVAL when privilege level greater than 3.
+ * - iopl(2) fail with EPERM when the current user is not the super-user.
  */
 
 #include <errno.h>
diff --git a/testcases/kernel/syscalls/ipc/msgsnd/Makefile b/testcases/kernel/syscalls/ipc/msgsnd/Makefile
index 85017fe90..63aee01d4 100644
--- a/testcases/kernel/syscalls/ipc/msgsnd/Makefile
+++ b/testcases/kernel/syscalls/ipc/msgsnd/Makefile
@@ -5,10 +5,6 @@ top_srcdir              ?= ../../../../..
 
 LTPLIBS = ltpnewipc
 
-ifeq ($(UCLINUX),1)
-FILTER_OUT_MAKE_TARGETS += msgsnd05 msgsnd06
-endif
-
 include $(top_srcdir)/include/mk/testcases.mk
 
 LTPLDLIBS  += -lltpnewipc
diff --git a/testcases/kernel/syscalls/ipc/msgstress/.gitignore b/testcases/kernel/syscalls/ipc/msgstress/.gitignore
index a8f675399..fe9780693 100644
--- a/testcases/kernel/syscalls/ipc/msgstress/.gitignore
+++ b/testcases/kernel/syscalls/ipc/msgstress/.gitignore
@@ -1,4 +1 @@
 /msgstress01
-/msgstress02
-/msgstress03
-/msgstress04
diff --git a/testcases/kernel/syscalls/ipc/msgstress/Makefile b/testcases/kernel/syscalls/ipc/msgstress/Makefile
index b821bda01..442eb87d5 100644
--- a/testcases/kernel/syscalls/ipc/msgstress/Makefile
+++ b/testcases/kernel/syscalls/ipc/msgstress/Makefile
@@ -3,10 +3,5 @@
 
 top_srcdir              ?= ../../../../..
 
-LTPLIBS = ltpipc
-
 include $(top_srcdir)/include/mk/testcases.mk
-
-LTPLDLIBS  += -lltpipc
-
 include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/kernel/syscalls/ipc/msgstress/msgstress01.c b/testcases/kernel/syscalls/ipc/msgstress/msgstress01.c
index 84e338437..b6a64cf4f 100644
--- a/testcases/kernel/syscalls/ipc/msgstress/msgstress01.c
+++ b/testcases/kernel/syscalls/ipc/msgstress/msgstress01.c
@@ -1,301 +1,321 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- * Copyright (c) International Business Machines  Corp., 2002
- *
- * This program is free software;  you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY;  without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- * the GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program;  if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
- * 06/30/2001   Port to Linux   nsharoff@us.ibm.com
- * 11/06/2002   Port to LTP     dbarrera@us.ibm.com
+ * Copyright (c) International Business Machines Corp., 2002
+ *   06/30/2001   Port to Linux   nsharoff@us.ibm.com
+ *   11/11/2002   Port to LTP     dbarrera@us.ibm.com
+ * Copyright (C) 2024 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
  */
 
-/*
- * Get and manipulate a message queue.
+/*\
+ * [Description]
+ *
+ * Stress test for SysV IPC. We send multiple messages at the same time,
+ * checking that we are not loosing any byte once we receive the messages
+ * from multiple children.
+ *
+ * The number of messages to send is determined by the free slots available
+ * in SysV IPC and the available number of children which can be spawned by
+ * the process. Each sender will spawn multiple messages at the same time and
+ * each receiver will read them one by one.
  */
 
-#define _XOPEN_SOURCE 500
-#include <signal.h>
-#include <errno.h>
-#include <string.h>
-#include <fcntl.h>
 #include <stdlib.h>
-#include <stdio.h>
-#include <unistd.h>
-#include <values.h>
-#include <sys/types.h>
-#include <sys/wait.h>
-#include <sys/stat.h>
-#include <sys/ipc.h>
-#include <sys/msg.h>
-#include "test.h"
-#include "ipcmsg.h"
-#include "libmsgctl.h"
-
-char *TCID = "msgstress01";
-int TST_TOTAL = 1;
-
-#ifndef CONFIG_COLDFIRE
-#define MAXNPROCS	1000000	/* This value is set to an arbitrary high limit. */
-#else
-#define MAXNPROCS	 100000	/* Coldfire can't deal with 1000000 */
-#endif
-#define MAXNREPS	100000
-
-static key_t keyarray[MAXNPROCS];
-static int pidarray[MAXNPROCS];
-static int tid;
-static int MSGMNI, nprocs, nreps;
-static int procstat;
-static int mykid;
-
-void setup(void);
-void cleanup(void);
-
-static int dotest(key_t key, int child_process);
-static void sig_handler();
-
-static char *opt_nprocs;
-static char *opt_nreps;
-
-static option_t options[] = {
-	{"n:", NULL, &opt_nprocs},
-	{"l:", NULL, &opt_nreps},
-	{NULL, NULL, NULL},
+#include "tst_safe_sysv_ipc.h"
+#include "tst_safe_stdio.h"
+#include "tst_test.h"
+
+#define SYSVIPC_TOTAL "/proc/sys/kernel/msgmni"
+#define SYSVIPC_USED "/proc/sysvipc/msg"
+#define MSGTYPE 10
+#define MAXNREPS 100000
+
+struct sysv_msg {
+	long type;
+	struct {
+		char len;
+		char pbytes[99];
+	} data;
 };
 
-static void usage(void)
+struct sysv_data {
+	int id;
+	struct sysv_msg msg;
+};
+
+static struct sysv_data *ipc_data;
+static int ipc_data_len;
+
+static char *str_num_messages;
+static char *str_num_iterations;
+static int num_messages = 1000;
+static int num_iterations = MAXNREPS;
+static volatile int *stop;
+static volatile int *fail;
+static int *finished;
+static int *flags;
+
+static int get_used_sysvipc(void)
 {
-	printf("  -n      Number of processes\n");
-	printf("  -l      Number of iterations\n");
+	FILE *fp;
+	int used = -1;
+	char buf[BUFSIZ];
+
+	fp = SAFE_FOPEN(SYSVIPC_USED, "r");
+
+	while (fgets(buf, BUFSIZ, fp) != NULL)
+		used++;
+
+	SAFE_FCLOSE(fp);
+
+	if (used < 0)
+		tst_brk(TBROK, "Can't read %s to get used sysvipc resource", SYSVIPC_USED);
+
+	return used;
 }
 
-int main(int argc, char **argv)
+static void reset_messages(void)
 {
-	int i, j, ok, pid;
-	int count, status;
-	struct sigaction act;
+	ipc_data_len = 0;
+	memset(ipc_data, 0, sizeof(struct sysv_data) * num_messages);
 
-	tst_parse_opts(argc, argv, options, usage);
+	for (int i = 0; i < num_messages; i++)
+		ipc_data[i].id = -1;
 
-	setup();
+	*stop = 0;
+	*fail = 0;
+	*finished = 0;
+}
 
-	nreps = MAXNREPS;
-	nprocs = MSGMNI;
+static int create_message(const int id)
+{
+	int pos = ipc_data_len;
+	struct sysv_data *buff = ipc_data + pos;
 
-	if (opt_nreps) {
-		nreps = atoi(opt_nreps);
-		if (nreps > MAXNREPS) {
-			tst_resm(TINFO,
-				 "Requested number of iterations too large, "
-				 "setting to Max. of %d", MAXNREPS);
-			nreps = MAXNREPS;
-		}
-	}
+	buff->id = id;
+	buff->msg.type = MSGTYPE;
+	buff->msg.data.len = (rand() % 99) + 1;
 
-	if (opt_nprocs) {
-		nprocs = atoi(opt_nprocs);
-		if (nprocs > MSGMNI) {
-			tst_resm(TINFO,
-				 "Requested number of processes too large, "
-				 "setting to Max. of %d", MSGMNI);
-			nprocs = MSGMNI;
+	for (int i = 0; i < buff->msg.data.len; i++)
+		buff->msg.data.pbytes[i] = rand() % 255;
+
+	ipc_data_len++;
+
+	return pos;
+}
+
+static void writer(const int id, const int pos)
+{
+	struct sysv_data *buff = &ipc_data[pos];
+	int iter = num_iterations;
+
+	while (--iter >= 0 && !(*stop)) {
+		int size = msgsnd(id, &buff->msg, 100, IPC_NOWAIT);
+
+		if (size < 0) {
+			if (errno == EAGAIN) {
+				usleep(10);
+				continue;
+			}
+
+			tst_brk(TBROK | TERRNO, "msgsnd() failed");
 		}
 	}
 
-	srand(getpid());
-	tid = -1;
+	tst_atomic_inc(finished);
+}
 
-	/* Setup signal handling routine */
-	memset(&act, 0, sizeof(act));
-	act.sa_handler = sig_handler;
-	sigemptyset(&act.sa_mask);
-	sigaddset(&act.sa_mask, SIGTERM);
-	if (sigaction(SIGTERM, &act, NULL) < 0) {
-		tst_brkm(TFAIL, NULL, "Sigset SIGTERM failed");
-	}
-	/* Set up array of unique keys for use in allocating message
-	 * queues
-	 */
-	for (i = 0; i < nprocs; i++) {
-		ok = 1;
-		do {
-			/* Get random key */
-			keyarray[i] = (key_t) rand();
-			/* Make sure key is unique and not private */
-			if (keyarray[i] == IPC_PRIVATE) {
-				ok = 0;
+static void reader(const int id, const int pos)
+{
+	int size;
+	int iter = num_iterations;
+	struct sysv_msg msg_recv;
+	struct sysv_data *buff = &ipc_data[pos];
+
+	while (--iter >= 0 && !(*stop)) {
+		memset(&msg_recv, 0, sizeof(struct sysv_msg));
+
+		size = msgrcv(id, &msg_recv, 100, MSGTYPE, IPC_NOWAIT);
+		if (size < 0) {
+			if (errno == ENOMSG) {
+				usleep(10);
 				continue;
 			}
-			for (j = 0; j < i; j++) {
-				if (keyarray[j] == keyarray[i]) {
-					ok = 0;
-					break;
-				}
-				ok = 1;
-			}
-		} while (ok == 0);
-	}
 
-	/* Fork a number of processes, each of which will
-	 * create a message queue with one reader/writer
-	 * pair which will read and write a number (iterations)
-	 * of random length messages with specific values.
-	 */
+			tst_brk(TBROK | TERRNO, "msgrcv() failed");
+		}
+
+		if (msg_recv.type != buff->msg.type) {
+			tst_res(TFAIL, "Received the wrong message type");
 
-	for (i = 0; i < nprocs; i++) {
-		fflush(stdout);
-		if ((pid = FORK_OR_VFORK()) < 0) {
-			tst_brkm(TFAIL,
-				 NULL,
-				 "\tFork failed (may be OK if under stress)");
+			*stop = 1;
+			*fail = 1;
+			return;
 		}
-		/* Child does this */
-		if (pid == 0) {
-			procstat = 1;
-			exit(dotest(keyarray[i], i));
+
+		if (msg_recv.data.len != buff->msg.data.len) {
+			tst_res(TFAIL, "Received the wrong message data length");
+
+			*stop = 1;
+			*fail = 1;
+			return;
 		}
-		pidarray[i] = pid;
-	}
 
-	count = 0;
-	while (1) {
-		if ((wait(&status)) > 0) {
-			if (status >> 8 != 0) {
-				tst_brkm(TFAIL, NULL,
-					 "Child exit status = %d",
-					 status >> 8);
-			}
-			count++;
-		} else {
-			if (errno != EINTR) {
-				break;
+		for (int i = 0; i < msg_recv.data.len; i++) {
+			if (msg_recv.data.pbytes[i] != buff->msg.data.pbytes[i]) {
+				tst_res(TFAIL, "Received wrong data at index %d: %x != %x", i,
+					msg_recv.data.pbytes[i],
+					buff->msg.data.pbytes[i]);
+
+				*stop = 1;
+				*fail = 1;
+				return;
 			}
-#ifdef DEBUG
-			tst_resm(TINFO, "Signal detected during wait");
-#endif
 		}
-	}
-	/* Make sure proper number of children exited */
-	if (count != nprocs) {
-		tst_brkm(TFAIL,
-			 NULL,
-			 "Wrong number of children exited, Saw %d, Expected %d",
-			 count, nprocs);
+
+		tst_res(TDEBUG, "Received correct data");
+		tst_res(TDEBUG, "msg_recv.type = %ld", msg_recv.type);
+		tst_res(TDEBUG, "msg_recv.data.len = %d", msg_recv.data.len);
 	}
 
-	tst_resm(TPASS, "Test ran successfully!");
+	tst_atomic_inc(finished);
+}
+
+static void remove_queues(void)
+{
+	for (int pos = 0; pos < num_messages; pos++) {
+		struct sysv_data *buff = &ipc_data[pos];
 
-	cleanup();
-	tst_exit();
+		if (buff->id != -1)
+			SAFE_MSGCTL(buff->id, IPC_RMID, NULL);
+	}
 }
 
-static int dotest(key_t key, int child_process)
+static void run(void)
 {
-	int id, pid;
-	int ret, status;
+	int id, pos;
 
-	sighold(SIGTERM);
-	TEST(msgget(key, IPC_CREAT | S_IRUSR | S_IWUSR));
-	if (TEST_RETURN < 0) {
-		printf("msgget() error in child %d: %s\n",
-			child_process, strerror(TEST_ERRNO));
+	reset_messages();
 
-		return FAIL;
-	}
-	tid = id = TEST_RETURN;
-	sigrelse(SIGTERM);
-
-	fflush(stdout);
-	if ((pid = FORK_OR_VFORK()) < 0) {
-		printf("\tFork failed (may be OK if under stress)\n");
-		TEST(msgctl(tid, IPC_RMID, 0));
-		if (TEST_RETURN < 0) {
-			printf("mscgtl() error in cleanup: %s\n",
-				strerror(TEST_ERRNO));
+	for (int i = 0; i < num_messages; i++) {
+		id = SAFE_MSGGET(IPC_PRIVATE, IPC_CREAT | 0600);
+		pos = create_message(id);
+
+		if (!SAFE_FORK()) {
+			writer(id, pos);
+			return;
+		}
+
+		if (!SAFE_FORK()) {
+			reader(id, pos);
+			return;
+		}
+
+		if (*stop)
+			break;
+
+		if (!tst_remaining_runtime()) {
+			tst_res(TWARN, "Out of runtime during forking...");
+			*stop = 1;
+			break;
 		}
-		return FAIL;
 	}
-	/* Child does this */
-	if (pid == 0)
-		exit(doreader(key, id, 1, child_process, nreps));
-	/* Parent does this */
-	mykid = pid;
-	procstat = 2;
-	ret = dowriter(key, id, 1, child_process, nreps);
-	wait(&status);
-
-	if (ret != PASS)
-		exit(FAIL);
-
-	if ((!WIFEXITED(status) || (WEXITSTATUS(status) != PASS)))
-		exit(FAIL);
-
-	TEST(msgctl(id, IPC_RMID, 0));
-	if (TEST_RETURN < 0) {
-		printf("msgctl() errno %d: %s\n",
-			TEST_ERRNO, strerror(TEST_ERRNO));
-
-		return FAIL;
+
+	if (!(*stop))
+		tst_res(TINFO, "All processes running");
+
+	for (;;) {
+		if (tst_atomic_load(finished) == 2 * num_messages)
+			break;
+
+		if (*stop)
+			break;
+
+		if (!tst_remaining_runtime()) {
+			tst_res(TINFO, "Out of runtime, stopping processes...");
+			*stop = 1;
+			break;
+		}
+
+		sleep(1);
 	}
-	return PASS;
-}
 
-static void sig_handler(void)
-{
+	tst_reap_children();
+	remove_queues();
+
+	if (!(*fail))
+		tst_res(TPASS, "Test passed. All messages have been received");
 }
 
-void setup(void)
+static void setup(void)
 {
-	int nr_msgqs;
+	int total_msg;
+	int avail_msg;
+	int free_msgs;
+	int free_pids;
 
-	tst_tmpdir();
+	srand(time(0));
 
-	tst_sig(FORK, DEF_HANDLER, cleanup);
+	SAFE_FILE_SCANF(SYSVIPC_TOTAL, "%i", &total_msg);
 
-	TEST_PAUSE;
+	free_msgs = total_msg - get_used_sysvipc();
 
-	nr_msgqs = get_max_msgqueues();
-	if (nr_msgqs < 0)
-		cleanup();
+	/* We remove 10% of free pids, just to be sure
+	 * we won't saturate the sysyem with processes.
+	 */
+	free_pids = tst_get_free_pids() / 2.1;
 
-	nr_msgqs -= get_used_msgqueues();
-	if (nr_msgqs <= 0) {
-		tst_resm(TBROK,
-			 "Max number of message queues already used, cannot create more.");
-		cleanup();
-	}
+	avail_msg = MIN(free_msgs, free_pids);
+	if (!avail_msg)
+		tst_brk(TCONF, "Unavailable messages slots");
 
-	/*
-	 * Since msgmni scales to the memory size, it may reach huge values
-	 * that are not necessary for this test.
-	 * That's why we define NR_MSGQUEUES as a high boundary for it.
-	 */
-	MSGMNI = MIN(nr_msgqs, NR_MSGQUEUES);
+	tst_res(TINFO, "Available messages slots: %d", avail_msg);
+
+	if (tst_parse_int(str_num_messages, &num_messages, 1, avail_msg))
+		tst_brk(TBROK, "Invalid number of messages '%s'", str_num_messages);
+
+	if (tst_parse_int(str_num_iterations, &num_iterations, 1, MAXNREPS))
+		tst_brk(TBROK, "Invalid number of messages iterations '%s'", str_num_iterations);
+
+	ipc_data = SAFE_MMAP(
+		NULL,
+		sizeof(struct sysv_data) * num_messages,
+		PROT_READ | PROT_WRITE,
+		MAP_SHARED | MAP_ANONYMOUS,
+		-1, 0);
+
+	flags = SAFE_MMAP(
+		NULL,
+		sizeof(int) * 3,
+		PROT_READ | PROT_WRITE,
+		MAP_SHARED | MAP_ANONYMOUS,
+		-1, 0);
+
+	stop = &flags[0];
+	fail = &flags[1];
+	finished = &flags[2];
 }
 
-void cleanup(void)
+static void cleanup(void)
 {
-	int status;
+	if (!ipc_data)
+		return;
 
-#ifdef DEBUG
-	tst_resm(TINFO, "Removing the message queue");
-#endif
-	(void)msgctl(tid, IPC_RMID, NULL);
-	if ((status = msgctl(tid, IPC_STAT, NULL)) != -1) {
-		(void)msgctl(tid, IPC_RMID, NULL);
-		tst_resm(TFAIL, "msgctl(tid, IPC_RMID) failed");
+	remove_queues();
 
-	}
-
-	tst_rmdir();
+	SAFE_MUNMAP(ipc_data, sizeof(struct sysv_data) * num_messages);
+	SAFE_MUNMAP(flags, sizeof(int) * 3);
 }
+
+static struct tst_test test = {
+	.test_all = run,
+	.setup = setup,
+	.cleanup = cleanup,
+	.forks_child = 1,
+	.max_runtime = 180,
+	.options = (struct tst_option[]) {
+		{"n:", &str_num_messages, "Number of messages to send (default: 1000)"},
+		{"l:", &str_num_iterations, "Number iterations per message (default: "
+			TST_TO_STR(MAXNREPS) ")"},
+		{},
+	},
+};
diff --git a/testcases/kernel/syscalls/ipc/msgstress/msgstress02.c b/testcases/kernel/syscalls/ipc/msgstress/msgstress02.c
deleted file mode 100644
index a0f894b05..000000000
--- a/testcases/kernel/syscalls/ipc/msgstress/msgstress02.c
+++ /dev/null
@@ -1,408 +0,0 @@
-/*
- * Copyright (c) International Business Machines  Corp., 2002
- *
- * This program is free software;  you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY;  without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- * the GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program;  if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
- * 06/30/2001   Port to Linux   nsharoff@us.ibm.com
- * 11/11/2002   Port to LTP     dbarrera@us.ibm.com
- */
-
-/*
- * Get and manipulate a message queue.
- */
-
-#define _XOPEN_SOURCE 500
-#include <sys/stat.h>
-#include <sys/types.h>
-#include <sys/ipc.h>
-#include <sys/msg.h>
-#include <sys/wait.h>
-#include <signal.h>
-#include <errno.h>
-#include <stdio.h>
-#include <string.h>
-#include <stdlib.h>
-#include <unistd.h>
-#include "test.h"
-#include "ipcmsg.h"
-#include "libmsgctl.h"
-
-char *TCID = "msgstress02";
-int TST_TOTAL = 1;
-
-#define MAXNREPS	1000
-#ifndef CONFIG_COLDFIRE
-#define MAXNPROCS	 1000000	/* This value is set to an arbitrary high limit. */
-#else
-#define MAXNPROCS	 100000	/* Coldfire can't deal with 1000000 */
-#endif
-#define MAXNKIDS	10
-
-static key_t keyarray[MAXNPROCS];
-static int pidarray[MAXNPROCS];
-static int rkidarray[MAXNKIDS];
-static int wkidarray[MAXNKIDS];
-static int tid;
-static int nprocs, nreps, nkids, MSGMNI;
-static int procstat;
-
-void setup(void);
-void cleanup(void);
-
-static void term(int);
-static int dotest(key_t, int);
-static void cleanup_msgqueue(int i, int tid);
-
-static char *opt_nprocs;
-static char *opt_nkids;
-static char *opt_nreps;
-
-static option_t options[] = {
-	{"n:", NULL, &opt_nprocs},
-	{"c:", NULL, &opt_nkids},
-	{"l:", NULL, &opt_nreps},
-	{NULL, NULL, NULL},
-};
-
-static void usage(void)
-{
-	printf("  -n      Number of processes\n");
-	printf("  -c      Number of read/write child pairs\n");
-	printf("  -l      Number of iterations\n");
-}
-
-int main(int argc, char **argv)
-{
-	int i, j, ok, pid;
-	int count, status;
-
-	tst_parse_opts(argc, argv, options, usage);
-
-	setup();
-
-	nreps = MAXNREPS;
-	nprocs = MSGMNI;
-	nkids = MAXNKIDS;
-
-	if (opt_nreps) {
-		nreps = atoi(opt_nreps);
-		if (nreps > MAXNREPS) {
-			tst_resm(TINFO,
-				 "Requested number of iterations too large, "
-				 "setting to Max. of %d", MAXNREPS);
-			nreps = MAXNREPS;
-		}
-	}
-
-	if (opt_nprocs) {
-		nprocs = atoi(opt_nprocs);
-		if (nprocs > MSGMNI) {
-			tst_resm(TINFO,
-				 "Requested number of processes too large, "
-				 "setting to Max. of %d", MSGMNI);
-			nprocs = MSGMNI;
-		}
-	}
-
-	if (opt_nkids) {
-		nkids = atoi(opt_nkids);
-		if (nkids > MAXNKIDS) {
-			tst_resm(TINFO,
-				 "Requested number of read/write pairs too "
-				 "large, setting to Max. of %d", MAXNKIDS);
-			nkids = MAXNKIDS;
-		}
-	}
-
-	procstat = 0;
-	srand48((unsigned)getpid() + (unsigned)(getppid() << 16));
-	tid = -1;
-
-	/* Setup signal handleing routine */
-	if (sigset(SIGTERM, term) == SIG_ERR) {
-		tst_brkm(TFAIL, NULL, "Sigset SIGTERM failed");
-	}
-	/* Set up array of unique keys for use in allocating message
-	 * queues
-	 */
-	for (i = 0; i < nprocs; i++) {
-		ok = 1;
-		do {
-			/* Get random key */
-			keyarray[i] = (key_t) lrand48();
-			/* Make sure key is unique and not private */
-			if (keyarray[i] == IPC_PRIVATE) {
-				ok = 0;
-				continue;
-			}
-			for (j = 0; j < i; j++) {
-				if (keyarray[j] == keyarray[i]) {
-					ok = 0;
-					break;
-				}
-				ok = 1;
-			}
-		} while (ok == 0);
-	}
-	/* Fork a number of processes (nprocs), each of which will
-	 * create a message queue with several (nkids) reader/writer
-	 * pairs which will read and write a number (iterations)
-	 * of random length messages with specific values (keys).
-	 */
-
-	for (i = 0; i < nprocs; i++) {
-		fflush(stdout);
-		if ((pid = FORK_OR_VFORK()) < 0) {
-			tst_brkm(TFAIL,
-				 NULL,
-				 "\tFork failed (may be OK if under stress)");
-		}
-		/* Child does this */
-		if (pid == 0) {
-			procstat = 1;
-			exit(dotest(keyarray[i], i));
-		}
-		pidarray[i] = pid;
-	}
-
-	count = 0;
-	while (1) {
-		if ((wait(&status)) > 0) {
-			if (status >> 8 != PASS) {
-				tst_brkm(TFAIL, NULL,
-					 "Child exit status = %d",
-					 status >> 8);
-			}
-			count++;
-		} else {
-			if (errno != EINTR) {
-				break;
-			}
-#ifdef DEBUG
-			tst_resm(TINFO, "Signal detected during wait");
-#endif
-		}
-	}
-	/* Make sure proper number of children exited */
-	if (count != nprocs) {
-		tst_brkm(TFAIL,
-			 NULL,
-			 "Wrong number of children exited, Saw %d, Expected %d",
-			 count, nprocs);
-	}
-
-	tst_resm(TPASS, "Test ran successfully!");
-
-	cleanup();
-	tst_exit();
-}
-
-static void cleanup_msgqueue(int i, int tid)
-{
-	/*
-	 * Decrease the value of i by 1 because it
-	 * is getting incremented even if the fork
-	 * is failing.
-	 */
-
-	i--;
-	/*
-	 * Kill all children & free message queue.
-	 */
-	for (; i >= 0; i--) {
-		(void)kill(rkidarray[i], SIGKILL);
-		(void)kill(wkidarray[i], SIGKILL);
-	}
-
-	if (msgctl(tid, IPC_RMID, 0) < 0) {
-		tst_brkm(TFAIL | TERRNO, NULL, "Msgctl error in cleanup");
-	}
-}
-
-static int dotest(key_t key, int child_process)
-{
-	int id, pid;
-	int i, count, status, exit_status;
-
-	sighold(SIGTERM);
-	if ((id = msgget(key, IPC_CREAT | S_IRUSR | S_IWUSR)) < 0) {
-		printf("msgget() error in child %d: %s\n",
-			child_process, strerror(errno));
-		return FAIL;
-	}
-	tid = id;
-	sigrelse(SIGTERM);
-
-	exit_status = PASS;
-
-	for (i = 0; i < nkids; i++) {
-		fflush(stdout);
-		if ((pid = FORK_OR_VFORK()) < 0) {
-			printf("Fork failure in the first child of child group %d\n",
-				child_process);
-			cleanup_msgqueue(i, tid);
-			return FAIL;
-		}
-		/* First child does this */
-		if (pid == 0) {
-			procstat = 2;
-			exit(doreader(key, tid, getpid(),
-					child_process, nreps));
-		}
-		rkidarray[i] = pid;
-		fflush(stdout);
-		if ((pid = FORK_OR_VFORK()) < 0) {
-			printf("Fork failure in the second child of child group %d\n",
-				child_process);
-			/*
-			 * Kill the reader child process
-			 */
-			(void)kill(rkidarray[i], SIGKILL);
-
-			cleanup_msgqueue(i, tid);
-			return FAIL;
-		}
-		/* Second child does this */
-		if (pid == 0) {
-			procstat = 2;
-			exit(dowriter(key, tid, rkidarray[i],
-					child_process, nreps));
-		}
-		wkidarray[i] = pid;
-	}
-	/* Parent does this */
-	count = 0;
-	while (1) {
-		if ((wait(&status)) > 0) {
-			if (status >> 8 != PASS) {
-				printf("Child exit status = %d from child group %d\n",
-					status >> 8, child_process);
-				for (i = 0; i < nkids; i++) {
-					kill(rkidarray[i], SIGTERM);
-					kill(wkidarray[i], SIGTERM);
-				}
-				if (msgctl(tid, IPC_RMID, 0) < 0) {
-					printf("msgctl() error: %s\n",
-						strerror(errno));
-				}
-				return FAIL;
-			}
-			count++;
-		} else {
-			if (errno != EINTR) {
-				break;
-			}
-		}
-	}
-	/* Make sure proper number of children exited */
-	if (count != (nkids * 2)) {
-		printf("Wrong number of children exited in child group %d, saw %d, expected %d\n",
-			child_process, count, (nkids * 2));
-		if (msgctl(tid, IPC_RMID, 0) < 0) {
-			printf("msgctl() error: %s\n", strerror(errno));
-		}
-		return FAIL;
-	}
-	if (msgctl(id, IPC_RMID, 0) < 0) {
-		printf("msgctl() failure in child group %d: %s\n",
-			child_process, strerror(errno));
-		return FAIL;
-	}
-	return exit_status;
-}
-
-static void term(int sig LTP_ATTRIBUTE_UNUSED)
-{
-	int i;
-
-	if (procstat == 0) {
-#ifdef DEBUG
-		tst_resm(TINFO, "SIGTERM signal received, test killing kids");
-#endif
-		for (i = 0; i < nprocs; i++) {
-			if (pidarray[i] > 0) {
-				if (kill(pidarray[i], SIGTERM) < 0) {
-					printf("Kill failed to kill child %d",
-						i);
-					exit(FAIL);
-				}
-			}
-		}
-		return;
-	}
-
-	if (procstat == 2) {
-		fflush(stdout);
-		exit(PASS);
-	}
-
-	if (tid == -1) {
-		exit(FAIL);
-	}
-	for (i = 0; i < nkids; i++) {
-		if (rkidarray[i] > 0)
-			kill(rkidarray[i], SIGTERM);
-		if (wkidarray[i] > 0)
-			kill(wkidarray[i], SIGTERM);
-	}
-}
-
-void setup(void)
-{
-	int nr_msgqs;
-
-	tst_tmpdir();
-
-	tst_sig(FORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-
-	nr_msgqs = get_max_msgqueues();
-	if (nr_msgqs < 0)
-		cleanup();
-
-	nr_msgqs -= get_used_msgqueues();
-	if (nr_msgqs <= 0) {
-		tst_resm(TBROK,
-			 "Max number of message queues already used, cannot create more.");
-		cleanup();
-	}
-
-	/*
-	 * Since msgmni scales to the memory size, it may reach huge values
-	 * that are not necessary for this test.
-	 * That's why we define NR_MSGQUEUES as a high boundary for it.
-	 */
-	MSGMNI = MIN(nr_msgqs, NR_MSGQUEUES);
-}
-
-void cleanup(void)
-{
-	int status;
-
-#ifdef DEBUG
-	tst_resm(TINFO, "Removing the message queue");
-#endif
-	fflush(stdout);
-	(void)msgctl(tid, IPC_RMID, NULL);
-	if ((status = msgctl(tid, IPC_STAT, NULL)) != -1) {
-		(void)msgctl(tid, IPC_RMID, NULL);
-		tst_resm(TFAIL, "msgctl(tid, IPC_RMID) failed");
-
-	}
-
-	fflush(stdout);
-	tst_rmdir();
-}
diff --git a/testcases/kernel/syscalls/ipc/msgstress/msgstress03.c b/testcases/kernel/syscalls/ipc/msgstress/msgstress03.c
deleted file mode 100644
index aa37d9058..000000000
--- a/testcases/kernel/syscalls/ipc/msgstress/msgstress03.c
+++ /dev/null
@@ -1,299 +0,0 @@
-/*
- * Copyright (c) International Business Machines  Corp., 2002
- *
- * This program is free software;  you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY;  without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- * the GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program;  if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
- * 06/30/2001   Port to Linux   nsharoff@us.ibm.com
- * 11/06/2002   Port to LTP     dbarrera@us.ibm.com
- */
-
-/*
- * Get and manipulate a message queue.
- * Same as msgstress01 but gets the actual msgmni value under procfs.
- */
-
-#define _XOPEN_SOURCE 500
-#include <signal.h>
-#include <errno.h>
-#include <string.h>
-#include <fcntl.h>
-#include <stdlib.h>
-#include <stdio.h>
-#include <unistd.h>
-#include <values.h>
-#include <sys/types.h>
-#include <sys/wait.h>
-#include <sys/stat.h>
-#include <sys/ipc.h>
-#include <sys/msg.h>
-#include "test.h"
-#include "ipcmsg.h"
-#include "libmsgctl.h"
-
-char *TCID = "msgstress03";
-int TST_TOTAL = 1;
-
-#define MAXNPROCS	10000	/*These should be sufficient */
-#define MAXNREPS	10000	/*Else they srewup the system un-necessarily */
-
-static key_t keyarray[MAXNPROCS];
-static int pidarray[MAXNPROCS];
-static int tid;
-static int MSGMNI, nprocs, nreps;
-static int procstat;
-static int mykid;
-
-void setup(void);
-void cleanup(void);
-
-static int dotest(key_t key, int child_process);
-static void sig_handler(int signo);
-
-static char *opt_nprocs;
-static char *opt_nreps;
-
-static option_t options[] = {
-	{"n:", NULL, &opt_nprocs},
-	{"l:", NULL, &opt_nreps},
-	{NULL, NULL, NULL},
-};
-
-static void usage(void)
-{
-	printf("  -n      Number of processes\n");
-	printf("  -l      Number of iterations\n");
-}
-
-int main(int argc, char **argv)
-{
-	int i, j, ok, pid, free_pids;
-	int count, status;
-	struct sigaction act;
-
-	tst_parse_opts(argc, argv, options, usage);
-
-	setup();
-
-	nreps = MAXNREPS;
-	nprocs = MSGMNI;
-
-	if (opt_nreps) {
-		nreps = atoi(opt_nreps);
-		if (nreps > MAXNREPS) {
-			tst_resm(TINFO,
-				 "Requested number of iterations too large, "
-				 "setting to Max. of %d", MAXNREPS);
-			nreps = MAXNREPS;
-		}
-	}
-
-	if (opt_nprocs) {
-		nprocs = atoi(opt_nprocs);
-		if (nprocs > MSGMNI) {
-			tst_resm(TINFO,
-				 "Requested number of processes too large, "
-				 "setting to Max. of %d", MSGMNI);
-			nprocs = MSGMNI;
-		}
-	}
-
-	free_pids = tst_get_free_pids(cleanup);
-	/* Each forked child forks once, take it into account here. */
-	if (nprocs * 2 >= free_pids) {
-		tst_resm(TINFO,
-			 "Requested number of processes higher than limit (%d > %d), "
-			 "setting to %d", nprocs * 2, free_pids, free_pids);
-		nprocs = free_pids / 2;
-	}
-
-	srand(getpid());
-	tid = -1;
-
-	/* Setup signal handling routine */
-	memset(&act, 0, sizeof(act));
-	act.sa_handler = sig_handler;
-	sigemptyset(&act.sa_mask);
-	sigaddset(&act.sa_mask, SIGTERM);
-	if (sigaction(SIGTERM, &act, NULL) < 0) {
-		tst_brkm(TFAIL, NULL, "Sigset SIGTERM failed");
-	}
-	/* Set up array of unique keys for use in allocating message
-	 * queues
-	 */
-	for (i = 0; i < nprocs; i++) {
-		ok = 1;
-		do {
-			/* Get random key */
-			keyarray[i] = (key_t) rand();
-			/* Make sure key is unique and not private */
-			if (keyarray[i] == IPC_PRIVATE) {
-				ok = 0;
-				continue;
-			}
-			for (j = 0; j < i; j++) {
-				if (keyarray[j] == keyarray[i]) {
-					ok = 0;
-					break;
-				}
-				ok = 1;
-			}
-		} while (ok == 0);
-	}
-
-	/* Fork a number of processes, each of which will
-	 * create a message queue with one reader/writer
-	 * pair which will read and write a number (iterations)
-	 * of random length messages with specific values.
-	 */
-
-	for (i = 0; i < nprocs; i++) {
-		fflush(stdout);
-		if ((pid = FORK_OR_VFORK()) < 0) {
-			tst_brkm(TFAIL,
-				 NULL,
-				 "\tFork failed (may be OK if under stress)");
-		}
-		/* Child does this */
-		if (pid == 0) {
-			procstat = 1;
-			exit(dotest(keyarray[i], i));
-		}
-		pidarray[i] = pid;
-	}
-
-	count = 0;
-	while (1) {
-		if ((wait(&status)) > 0) {
-			if (status >> 8 != 0) {
-				tst_brkm(TFAIL, NULL,
-					 "Child exit status = %d",
-					 status >> 8);
-			}
-			count++;
-		} else {
-			if (errno != EINTR) {
-				break;
-			}
-#ifdef DEBUG
-			tst_resm(TINFO, "Signal detected during wait");
-#endif
-		}
-	}
-	/* Make sure proper number of children exited */
-	if (count != nprocs) {
-		tst_brkm(TFAIL,
-			 NULL,
-			 "Wrong number of children exited, Saw %d, Expected %d",
-			 count, nprocs);
-	}
-
-	tst_resm(TPASS, "Test ran successfully!");
-
-	cleanup();
-	tst_exit();
-}
-
-static int dotest(key_t key, int child_process)
-{
-	int id, pid;
-	int ret, status;
-
-	sighold(SIGTERM);
-	TEST(msgget(key, IPC_CREAT | S_IRUSR | S_IWUSR));
-	if (TEST_RETURN < 0) {
-		printf("msgget() error in child %d: %s\n",
-			child_process, strerror(TEST_ERRNO));
-		return FAIL;
-	}
-	tid = id = TEST_RETURN;
-	sigrelse(SIGTERM);
-
-	fflush(stdout);
-	if ((pid = FORK_OR_VFORK()) < 0) {
-		printf("Fork failed (may be OK if under stress)\n");
-		TEST(msgctl(tid, IPC_RMID, 0));
-		if (TEST_RETURN < 0) {
-			printf("msgctl() error in cleanup: %s\n",
-				strerror(TEST_ERRNO));
-		}
-		return FAIL;
-	}
-	if (pid == 0)
-		exit(doreader(key, id, 1, child_process, nreps));
-
-	mykid = pid;
-	procstat = 2;
-	ret = dowriter(key, id, 1, child_process, nreps);
-	wait(&status);
-
-	if (ret != PASS)
-		exit(FAIL);
-
-	if ((!WIFEXITED(status) || (WEXITSTATUS(status) != PASS)))
-		exit(FAIL);
-
-	TEST(msgctl(id, IPC_RMID, 0));
-	if (TEST_RETURN < 0) {
-		printf("msgctl() failed: %s\n",
-			strerror(TEST_ERRNO));
-		return FAIL;
-	}
-	return PASS;
-}
-
-static void sig_handler(int signo LTP_ATTRIBUTE_UNUSED)
-{
-}
-
-void setup(void)
-{
-	int nr_msgqs;
-
-	tst_tmpdir();
-
-	tst_sig(FORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-
-	nr_msgqs = get_max_msgqueues();
-	if (nr_msgqs < 0)
-		cleanup();
-
-	MSGMNI = nr_msgqs - get_used_msgqueues();
-	if (MSGMNI > MAXNPROCS)
-		MSGMNI = MAXNPROCS;
-	if (MSGMNI <= 0) {
-		tst_resm(TBROK,
-			 "Max number of message queues already used, cannot create more.");
-		cleanup();
-	}
-}
-
-void cleanup(void)
-{
-	int status;
-
-#ifdef DEBUG
-	tst_resm(TINFO, "Removing the message queue");
-#endif
-	(void)msgctl(tid, IPC_RMID, NULL);
-	if ((status = msgctl(tid, IPC_STAT, NULL)) != -1) {
-		(void)msgctl(tid, IPC_RMID, NULL);
-		tst_resm(TFAIL, "msgctl(tid, IPC_RMID) failed");
-
-	}
-
-	tst_rmdir();
-}
diff --git a/testcases/kernel/syscalls/ipc/msgstress/msgstress04.c b/testcases/kernel/syscalls/ipc/msgstress/msgstress04.c
deleted file mode 100644
index b9ebf9035..000000000
--- a/testcases/kernel/syscalls/ipc/msgstress/msgstress04.c
+++ /dev/null
@@ -1,444 +0,0 @@
-/*
- * Copyright (c) International Business Machines  Corp., 2002
- *
- * This program is free software;  you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY;  without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- * the GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program;  if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- *
- * 06/30/2001   Port to Linux   nsharoff@us.ibm.com
- * 11/11/2002   Port to LTP     dbarrera@us.ibm.com
- */
-
-/*
- * Get and manipulate a message queue.
- * Same as msgstress02 but gets the actual msgmni value under procfs.
- */
-
-#define _XOPEN_SOURCE 500
-#include <sys/stat.h>
-#include <sys/types.h>
-#include <sys/ipc.h>
-#include <sys/msg.h>
-#include <sys/wait.h>
-#include <signal.h>
-#include <errno.h>
-#include <stdio.h>
-#include <string.h>
-#include <stdlib.h>
-#include <unistd.h>
-#include "test.h"
-#include "ipcmsg.h"
-#include "libmsgctl.h"
-
-char *TCID = "msgstress04";
-int TST_TOTAL = 1;
-
-#define MAXNREPS	1000
-#ifndef CONFIG_COLDFIRE
-#define MAXNPROCS	 1000000	/* This value is set to an arbitrary high limit. */
-#else
-#define MAXNPROCS	 100000	/* Coldfire can't deal with 1000000 */
-#endif
-#define MAXNKIDS	10
-#define DEFNKIDS	2
-
-static int maxnkids = MAXNKIDS;	/* Used if pid_max is exceeded */
-static key_t keyarray[MAXNPROCS];
-static int pidarray[MAXNPROCS];
-static int rkidarray[MAXNKIDS];
-static int wkidarray[MAXNKIDS];
-static int tid;
-static int nprocs, nreps, nkids, MSGMNI;
-static int maxnprocs;
-static int procstat;
-
-void setup(void);
-void cleanup(void);
-
-static void term(int);
-static int dotest(key_t, int);
-static void dotest_iteration(int off);
-static void cleanup_msgqueue(int i, int tid);
-
-static char *opt_maxnprocs;
-static char *opt_nkids;
-static char *opt_nreps;
-
-static option_t options[] = {
-	{"n:", NULL, &opt_maxnprocs},
-	{"c:", NULL, &opt_nkids},
-	{"l:", NULL, &opt_nreps},
-	{NULL, NULL, NULL},
-};
-
-static void usage(void)
-{
-	printf("  -n      Number of processes\n");
-	printf("  -c      Number of read/write child pairs\n");
-	printf("  -l      Number of iterations\n");
-}
-
-
-int main(int argc, char **argv)
-{
-	int i, j, ok;
-
-	tst_parse_opts(argc, argv, options, usage);
-
-	setup();
-
-	nreps = MAXNREPS;
-	nkids = MAXNKIDS;
-
-	if (opt_nreps) {
-		nreps = atoi(opt_nreps);
-		if (nreps > MAXNREPS) {
-			tst_resm(TINFO,
-				 "Requested number of iterations too large, "
-				 "setting to Max. of %d", MAXNREPS);
-			nreps = MAXNREPS;
-		}
-	}
-
-	if (opt_nkids) {
-		nkids = atoi(opt_nkids);
-		if (nkids > MAXNKIDS) {
-			tst_resm(TINFO,
-				 "Requested number of read/write pairs too "
-				 "large, setting to Max. of %d", MAXNKIDS);
-			nkids = MAXNKIDS;
-		}
-	}
-
-
-	if (opt_maxnprocs) {
-		if (atoi(opt_maxnprocs) > maxnprocs) {
-			tst_resm(TINFO,
-				 "Requested number of processes too large, "
-				 "setting to Max. of %d", MSGMNI);
-		} else {
-			maxnprocs = atoi(opt_maxnprocs);
-		}
-	}
-
-	procstat = 0;
-	srand48((unsigned)getpid() + (unsigned)(getppid() << 16));
-	tid = -1;
-
-	/* Setup signal handling routine */
-	if (sigset(SIGTERM, term) == SIG_ERR)
-		tst_brkm(TFAIL, cleanup, "Sigset SIGTERM failed");
-
-	/* Set up array of unique keys for use in allocating message
-	 * queues
-	 */
-	for (i = 0; i < MSGMNI; i++) {
-		ok = 1;
-		do {
-			/* Get random key */
-			keyarray[i] = (key_t) lrand48();
-			/* Make sure key is unique and not private */
-			if (keyarray[i] == IPC_PRIVATE) {
-				ok = 0;
-				continue;
-			}
-			for (j = 0; j < i; j++) {
-				if (keyarray[j] == keyarray[i]) {
-					ok = 0;
-					break;
-				}
-				ok = 1;
-			}
-		} while (ok == 0);
-	}
-	/* Fork a number of processes, each of which will
-	 * create a message queue with several (nkids) reader/writer
-	 * pairs which will read and write a number (iterations)
-	 * of random length messages with specific values (keys).
-	 *
-	 * We do not fork more than maxnprocs at a time and
-	 * we fork until all the message queues get used.
-	 */
-
-	if (MSGMNI <= maxnprocs) {
-		nprocs = MSGMNI;
-		dotest_iteration(0);
-	} else {
-		for (i = 0; i < (MSGMNI / maxnprocs); i++) {
-			nprocs = maxnprocs;
-			dotest_iteration(i * maxnprocs);
-		}
-
-		nprocs = MSGMNI % maxnprocs;
-		dotest_iteration(i * maxnprocs);
-	}
-
-	tst_resm(TPASS, "Test ran successfully!");
-
-	cleanup();
-	tst_exit();
-}
-
-static void dotest_iteration(int off)
-{
-	key_t key;
-	int i, count, status;
-	pid_t pid;
-
-	memset(pidarray, 0, sizeof(pidarray));
-
-	for (i = 0; i < nprocs; i++) {
-		key = keyarray[off + i];
-
-		if ((pid = FORK_OR_VFORK()) < 0)
-			tst_brkm(TFAIL, cleanup,
-				 "Fork failed (may be OK if under stress)");
-
-		/* Child does this */
-		if (pid == 0) {
-			procstat = 1;
-			exit(dotest(key, i));
-		}
-		pidarray[i] = pid;
-	}
-
-	count = 0;
-	while (1) {
-		if ((wait(&status)) > 0) {
-			if (status >> 8 != PASS)
-				tst_brkm(TFAIL, cleanup,
-					"Child exit status = %d", status >> 8);
-			count++;
-		} else {
-			if (errno != EINTR) {
-				break;
-			}
-#ifdef DEBUG
-			tst_resm(TINFO, "Signal detected during wait");
-#endif
-		}
-	}
-	/* Make sure proper number of children exited */
-	if (count != nprocs)
-		tst_brkm(TFAIL, cleanup,
-			 "Wrong number of children exited, Saw %d, Expected %d",
-			 count, nprocs);
-}
-
-static void cleanup_msgqueue(int i, int tid)
-{
-	/*
-	 * Decrease the value of i by 1 because it
-	 * is getting incremented even if the fork
-	 * is failing.
-	 */
-
-	i--;
-	/*
-	 * Kill all children & free message queue.
-	 */
-	for (; i >= 0; i--) {
-		(void)kill(rkidarray[i], SIGKILL);
-		(void)kill(wkidarray[i], SIGKILL);
-	}
-
-	if (msgctl(tid, IPC_RMID, 0) < 0) {
-		printf("Msgctl error in cleanup_msgqueue %d\n", errno);
-		exit(FAIL);
-	}
-}
-
-static int dotest(key_t key, int child_process)
-{
-	int id, pid;
-	int i, count, status, exit_status;
-
-	sighold(SIGTERM);
-	if ((id = msgget(key, IPC_CREAT | S_IRUSR | S_IWUSR)) < 0) {
-		printf("msgget() error in child %d: %s\n",
-			child_process, strerror(errno));
-		return FAIL;
-	}
-	tid = id;
-	sigrelse(SIGTERM);
-
-	exit_status = PASS;
-
-	for (i = 0; i < nkids; i++) {
-		if ((pid = FORK_OR_VFORK()) < 0) {
-			printf("Fork failure in the first child of child group %d\n",
-				child_process);
-			cleanup_msgqueue(i, tid);
-			return FAIL;
-		}
-		/* First child does this */
-		if (pid == 0) {
-			procstat = 2;
-			exit(doreader(key, tid, getpid(),
-					child_process, nreps));
-		}
-		rkidarray[i] = pid;
-		if ((pid = FORK_OR_VFORK()) < 0) {
-			printf("Fork failure in the second child of child group %d\n",
-				child_process);
-			/*
-			 * Kill the reader child process
-			 */
-			(void)kill(rkidarray[i], SIGKILL);
-
-			cleanup_msgqueue(i, tid);
-			return FAIL;
-		}
-		/* Second child does this */
-		if (pid == 0) {
-			procstat = 2;
-			exit(dowriter(key, tid, rkidarray[i],
-					child_process, nreps));
-		}
-		wkidarray[i] = pid;
-	}
-	/* Parent does this */
-	count = 0;
-	while (1) {
-		if ((wait(&status)) > 0) {
-			if (status >> 8 != PASS) {
-				printf("Child exit status = %d from child group %d\n",
-					status >> 8, child_process);
-				for (i = 0; i < nkids; i++) {
-					kill(rkidarray[i], SIGTERM);
-					kill(wkidarray[i], SIGTERM);
-				}
-				if (msgctl(tid, IPC_RMID, 0) < 0) {
-					printf("msgctl() error: %s\n",
-						strerror(errno));
-				}
-				return FAIL;
-			}
-			count++;
-		} else {
-			if (errno != EINTR) {
-				break;
-			}
-		}
-	}
-	/* Make sure proper number of children exited */
-	if (count != (nkids * 2)) {
-		printf("Wrong number of children exited in child group %d, saw %d, expected %d\n",
-			child_process, count, (nkids * 2));
-		if (msgctl(tid, IPC_RMID, 0) < 0) {
-			printf("msgctl() error: %s\n", strerror(errno));
-		}
-		return FAIL;
-	}
-	if (msgctl(id, IPC_RMID, 0) < 0) {
-		printf("msgctl() failure in child group %d: %s\n",
-			child_process, strerror(errno));
-		return FAIL;
-	}
-	return exit_status;
-}
-
-/* ARGSUSED */
-static void term(int sig LTP_ATTRIBUTE_UNUSED)
-{
-	int i;
-
-	if (procstat == 0) {
-#ifdef DEBUG
-		tst_resm(TINFO, "SIGTERM signal received, test killing kids");
-#endif
-		for (i = 0; i < nprocs; i++) {
-			if (pidarray[i] > 0) {
-				if (kill(pidarray[i], SIGTERM) < 0) {
-					tst_resm(TBROK,
-						 "Kill failed to kill child %d",
-						 i);
-					exit(FAIL);
-				}
-			}
-		}
-		return;
-	}
-
-	if (procstat == 2) {
-		exit(PASS);
-	}
-
-	if (tid == -1) {
-		exit(FAIL);
-	}
-	for (i = 0; i < nkids; i++) {
-		if (rkidarray[i] > 0)
-			kill(rkidarray[i], SIGTERM);
-		if (wkidarray[i] > 0)
-			kill(wkidarray[i], SIGTERM);
-	}
-}
-
-void setup(void)
-{
-	int nr_msgqs, free_pids;
-
-	tst_tmpdir();
-	/* You will want to enable some signal handling so you can capture
-	 * unexpected signals like SIGSEGV.
-	 */
-	tst_sig(FORK, DEF_HANDLER, cleanup);
-
-	/* One cavet that hasn't been fixed yet.  TEST_PAUSE contains the code to
-	 * fork the test with the -c option.  You want to make sure you do this
-	 * before you create your temporary directory.
-	 */
-	TEST_PAUSE;
-
-	nr_msgqs = get_max_msgqueues();
-	if (nr_msgqs < 0)
-		tst_brkm(TBROK, cleanup, "get_max_msgqueues() failed");
-
-	MSGMNI = nr_msgqs - get_used_msgqueues();
-	if (MSGMNI <= 0)
-		tst_brkm(TBROK, cleanup,
-			 "Max number of message queues already used, cannot create more.");
-
-	tst_resm(TINFO, "Found %d available message queues", MSGMNI);
-
-	free_pids = tst_get_free_pids(cleanup);
-	/* We don't use more than a half of available pids.
-	 * For each child we fork up to 2*maxnkids grandchildren. */
-	maxnprocs = (free_pids / 2) / (1 + 2 * maxnkids);
-
-	if (!maxnprocs)
-		tst_brkm(TBROK, cleanup, "Not enough free pids");
-
-	tst_resm(TINFO, "Using upto %d pids", free_pids / 2);
-}
-
-void cleanup(void)
-{
-	int status;
-
-	/*
-	 * Remove the message queue from the system
-	 */
-#ifdef DEBUG
-	tst_resm(TINFO, "Removing the message queue");
-#endif
-	(void)msgctl(tid, IPC_RMID, NULL);
-	if ((status = msgctl(tid, IPC_STAT, NULL)) != -1) {
-		(void)msgctl(tid, IPC_RMID, NULL);
-		tst_resm(TFAIL, "msgctl(tid, IPC_RMID) failed");
-
-	}
-
-	tst_rmdir();
-}
diff --git a/testcases/kernel/syscalls/ipc/semctl/semctl06.c b/testcases/kernel/syscalls/ipc/semctl/semctl06.c
index b3af41fb3..b8734c2fa 100644
--- a/testcases/kernel/syscalls/ipc/semctl/semctl06.c
+++ b/testcases/kernel/syscalls/ipc/semctl/semctl06.c
@@ -44,11 +44,6 @@
 
 #define DEBUG 0
 
-#ifdef UCLINUX
-#define _GNU_SOURCE
-#include <stdio.h>
-#endif
-
 #include <sys/types.h>
 #include <sys/ipc.h>
 #include <sys/sem.h>
@@ -112,7 +107,7 @@ int main(int argc, char **argv)
 	}
 
 	for (i = 0; i < NPROCS; i++) {
-		if ((pid = FORK_OR_VFORK()) < 0) {
+		if ((pid = tst_fork()) < 0) {
 			tst_resm(TFAIL,
 				 "\tFork failed (may be OK if under stress)");
 
@@ -188,7 +183,7 @@ static void dotest(key_t key)
 	}
 
 	for (i = 0; i < NKIDS; i++) {
-		if ((pid = FORK_OR_VFORK()) < 0) {
+		if ((pid = tst_fork()) < 0) {
 			tst_resm(TFAIL, "\tfork failed");
 		}
 		if (pid == 0)
diff --git a/testcases/kernel/syscalls/ipc/shmat/.gitignore b/testcases/kernel/syscalls/ipc/shmat/.gitignore
index 2b972f8f2..5600b2742 100644
--- a/testcases/kernel/syscalls/ipc/shmat/.gitignore
+++ b/testcases/kernel/syscalls/ipc/shmat/.gitignore
@@ -1,3 +1,4 @@
 /shmat01
 /shmat02
 /shmat03
+/shmat04
diff --git a/testcases/kernel/syscalls/ipc/shmat/shmat02.c b/testcases/kernel/syscalls/ipc/shmat/shmat02.c
index 53cb6f542..3ad1fd08e 100644
--- a/testcases/kernel/syscalls/ipc/shmat/shmat02.c
+++ b/testcases/kernel/syscalls/ipc/shmat/shmat02.c
@@ -44,20 +44,7 @@ static struct test_case_t {
 
 static void verify_shmat(struct test_case_t *tc)
 {
-	void *addr;
-
-	addr = shmat(*tc->shmid, *tc->shmaddr, 0);
-	if (addr != (void *)-1) {
-		tst_res(TFAIL, "shmat() succeeded unexpectedly");
-		return;
-	}
-
-	if (errno == tc->exp_err) {
-		tst_res(TPASS | TERRNO, "shmat() failed as expected");
-	} else {
-		tst_res(TFAIL | TERRNO, "shmat() failed unexpectedly, expected: %s",
-			tst_strerrno(tc->exp_err));
-	}
+	TST_EXP_FAIL_PTR_VOID(shmat(*tc->shmid, *tc->shmaddr, 0), tc->exp_err);
 }
 
 static void do_shmat(unsigned int n)
diff --git a/testcases/kernel/syscalls/ipc/shmat/shmat04.c b/testcases/kernel/syscalls/ipc/shmat/shmat04.c
new file mode 100644
index 000000000..9dda5c77a
--- /dev/null
+++ b/testcases/kernel/syscalls/ipc/shmat/shmat04.c
@@ -0,0 +1,96 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (C) 2024 SUSE LLC
+ * Author: Michal Hocko <mhocko@suse.com>
+ * LTP port: Andrea Cervesato <andrea.cervesato@suse.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * When debugging issues with a workload using SysV shmem, Michal Hocko has
+ * come up with a reproducer that shows how a series of mprotect()
+ * operations can result in an elevated shm_nattch and thus leak of the
+ * resource.
+ *
+ * The problem is caused by wrong assumptions in vma_merge() commit
+ * 714965ca8252 ("mm/mmap: start distinguishing if vma can be removed in
+ * mergeability test"). The shmem vmas have a vma_ops->close callback
+ * that decrements shm_nattch, and we remove the vma without calling it.
+ *
+ * Patch: https://lore.kernel.org/all/20240222215930.14637-2-vbabka@suse.cz/
+ */
+
+#include "tst_test.h"
+#include "tst_safe_sysv_ipc.h"
+#include "libnewipc.h"
+
+static int segment_id = -1;
+static int key_id;
+static int page_size;
+static size_t segment_size;
+
+static void run(void)
+{
+	struct shmid_ds shmid_ds;
+	void *sh_mem;
+
+	segment_id = SAFE_SHMGET(
+		key_id,
+		segment_size,
+		IPC_CREAT | IPC_EXCL | 0600);
+
+	sh_mem = SAFE_SHMAT(segment_id, NULL, 0);
+
+	tst_res(TINFO, "Attached at %p. key: %d - size: %lu",
+		sh_mem, segment_id, segment_size);
+
+	SAFE_SHMCTL(segment_id, IPC_STAT, &shmid_ds);
+
+	tst_res(TINFO, "Number of attaches: %lu", shmid_ds.shm_nattch);
+
+	SAFE_MPROTECT(sh_mem + page_size, page_size, PROT_NONE);
+	SAFE_MPROTECT(sh_mem, 2 * page_size, PROT_WRITE);
+
+	SAFE_SHMCTL(segment_id, IPC_STAT, &shmid_ds);
+
+	tst_res(TINFO, "Number of attaches: %lu", shmid_ds.shm_nattch);
+	tst_res(TINFO, "Delete attached memory");
+
+	SAFE_SHMDT(sh_mem);
+	SAFE_SHMCTL(segment_id, IPC_STAT, &shmid_ds);
+
+	tst_res(TINFO, "Number of attaches: %lu", shmid_ds.shm_nattch);
+
+	SAFE_SHMCTL(segment_id, IPC_RMID, NULL);
+	segment_id = -1;
+
+	TST_EXP_EQ_LU(shmid_ds.shm_nattch, 0);
+}
+
+static void setup(void)
+{
+	key_id = GETIPCKEY() + 1;
+	page_size = getpagesize();
+
+	tst_res(TINFO, "Key id: %d", key_id);
+	tst_res(TINFO, "Page size: %d", page_size);
+
+	segment_size = 3 * page_size;
+}
+
+static void cleanup(void)
+{
+	if (segment_id != -1)
+		SAFE_SHMCTL(segment_id, IPC_RMID, NULL);
+}
+
+static struct tst_test test = {
+	.test_all = run,
+	.setup = setup,
+	.cleanup = cleanup,
+	.tags = (const struct tst_tag[]) {
+		{"linux-git", "fc0c8f9089c2"},
+		{}
+	}
+};
diff --git a/testcases/kernel/syscalls/kill/kill02.c b/testcases/kernel/syscalls/kill/kill02.c
index 7ae2427c8..776540b4e 100644
--- a/testcases/kernel/syscalls/kill/kill02.c
+++ b/testcases/kernel/syscalls/kill/kill02.c
@@ -203,51 +203,23 @@ void cleanup();
 char *TCID = "kill02";
 int TST_TOTAL = 2;
 
-#ifdef UCLINUX
-static char *argv0;
-void childA_rout_uclinux();
-void childB_rout_uclinux();
-#endif
-
 int main(int ac, char **av)
 {
 	int lc;
 
 	tst_parse_opts(ac, av, NULL, NULL);
 
-#ifdef UCLINUX
-	argv0 = av[0];
-
-	maybe_run_child(&childA_rout_uclinux, "nd", 1, &pipeA_fd[1]);
-	maybe_run_child(&childB_rout_uclinux, "nd", 2, &pipeB_fd[1]);
-	maybe_run_child(&child1_rout, "ndddddd", 3, &pipe1_fd[1], &pipe2_fd[1],
-			&pipeA_fd[0], &pipeA_fd[1], &pipeB_fd[0], &pipeB_fd[1]);
-	maybe_run_child(&child2_rout, "nd", 4, &pipe2_fd[1]);
-#endif
-
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); lc++) {
 
 		tst_count = 0;
 
-		if ((pid1 = FORK_OR_VFORK()) > 0) {
-			if ((pid2 = FORK_OR_VFORK()) > 0) {
+		if ((pid1 = tst_fork()) > 0) {
+			if ((pid2 = tst_fork()) > 0) {
 				(void)parent_rout();
 			} else if (pid2 == 0) {
-#ifdef UCLINUX
-				if (self_exec(argv0, "nd", 4, pipe2_fd[1]) < 0) {
-					if (kill(pid1, SIGKILL) == -1
-					    && errno != ESRCH) {
-						tst_resm(TWARN,
-							 "Child process may not have been killed.");
-					}
-					tst_brkm(TBROK | TERRNO, cleanup,
-						 "fork failed");
-				}
-#else
 				(void)child2_rout();
-#endif
 			} else {
 				/*
 				 *  The second fork failed kill the first child.
@@ -264,17 +236,7 @@ int main(int ac, char **av)
 			/*
 			 *  This is child 1.
 			 */
-#ifdef UCLINUX
-			if (self_exec
-			    (argv0, "ndddddd", 3, pipe1_fd[1], pipe2_fd[1],
-			     pipeA_fd[0], pipeA_fd[1], pipeB_fd[0],
-			     pipeB_fd[1]) < 0) {
-				tst_brkm(TBROK | TERRNO, cleanup,
-					 "self_exec() failed");
-			}
-#else
 			(void)child1_rout();
-#endif
 		} else {
 			/*
 			 * Fork failed.
@@ -452,22 +414,14 @@ void child1_rout(void)
 	/*
 	 *  Create children A & B.
 	 */
-	if ((pidA = FORK_OR_VFORK()) > 0) {
+	if ((pidA = tst_fork()) > 0) {
 		/*
 		 *  This is the parent(child1), fork again to create child B.
 		 */
-		if ((pidB = FORK_OR_VFORK()) == 0) {
+
+		if ((pidB = tst_fork()) == 0) {
 			/* This is child B. */
-#ifdef UCLINUX
-			if (self_exec(argv0, "nd", 2, pipeB_fd[1]) < 0) {
-				tst_brkm(TBROK | TERRNO, NULL,
-					 "self_exec() failed");
-				(void)write(pipe1_fd[1], CHAR_SET_FAILED, 1);
-				exit(0);
-			}
-#else
 			(void)childB_rout();
-#endif
 		}
 
 		else if (pidB == -1) {
@@ -485,16 +439,7 @@ void child1_rout(void)
 
 	else if (pidA == 0) {
 		/* This is child A. */
-#ifdef UCLINUX
-		if (self_exec(argv0, "nd", 1, pipeA_fd[1]) < 0) {
-			tst_brkm(TBROK | TERRNO, NULL, "self_exec() failed");
-			(void)write(pipe1_fd[1], CHAR_SET_FAILED, 1);
-			exit(0);
-		}
-#else
 		(void)childA_rout();
-#endif
-
 	}
 
 	else if (pidA == -1) {
@@ -625,24 +570,6 @@ void childA_rout(void)
 	exit(0);
 }				/*End of childA_rout */
 
-#ifdef UCLINUX
-/*******************************************************************************
- *  This is the routine for child A after self_exec
- ******************************************************************************/
-void childA_rout_uclinux(void)
-{
-	/* Setup the signal handler again */
-	if (signal(SIGUSR1, usr1_rout) == SIG_ERR) {
-		tst_brkm(TBROK, NULL,
-			 "Could not set to catch the childrens signal.");
-		(void)write(pipeA_fd[1], CHAR_SET_FAILED, 1);
-		exit(0);
-	}
-
-	childA_rout();
-}
-#endif
-
 /*******************************************************************************
  *  This is the routine for child B, which should not receive the parents signal.
  ******************************************************************************/
@@ -667,24 +594,6 @@ void childB_rout(void)
 	exit(0);
 }
 
-#ifdef UCLINUX
-/*******************************************************************************
- *  This is the routine for child B after self_exec
- ******************************************************************************/
-void childB_rout_uclinux(void)
-{
-	/* Setup the signal handler again */
-	if (signal(SIGUSR1, usr1_rout) == SIG_ERR) {
-		tst_brkm(TBROK, NULL,
-			 "Could not set to catch the childrens signal.");
-		(void)write(pipeB_fd[1], CHAR_SET_FAILED, 1);
-		exit(0);
-	}
-
-	childB_rout();
-}
-#endif
-
 /*******************************************************************************
  *  This routine sets up the interprocess communication pipes, signal handling,
  *  and process group information.
diff --git a/testcases/kernel/syscalls/kill/kill07.c b/testcases/kernel/syscalls/kill/kill07.c
index c566a0a09..ac4ebd941 100644
--- a/testcases/kernel/syscalls/kill/kill07.c
+++ b/testcases/kernel/syscalls/kill/kill07.c
@@ -91,9 +91,6 @@ int main(int ac, char **av)
 	struct sigaction my_act, old_act;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "");
-#endif
 
 	setup();		/* global setup */
 
@@ -124,18 +121,11 @@ int main(int ac, char **av)
 		/* setup the signal handler */
 		ret = sigaction(TEST_SIG, &my_act, &old_act);
 
-		pid = FORK_OR_VFORK();
+		pid = tst_fork();
 		if (pid < 0) {
 			tst_brkm(TBROK, cleanup, "Fork of child failed");
 		} else if (pid == 0) {
-#ifdef UCLINUX
-			if (self_exec(av[0], "") < 0) {
-				tst_brkm(TBROK, cleanup,
-					 "self_exec of child failed");
-			}
-#else
 			do_child();
-#endif
 		} else {
 			/* sighandler should not catch this signal */
 			/* if it does flag will be set to 1 */
diff --git a/testcases/kernel/syscalls/kill/kill08.c b/testcases/kernel/syscalls/kill/kill08.c
index b0826c2e5..9302f5470 100644
--- a/testcases/kernel/syscalls/kill/kill08.c
+++ b/testcases/kernel/syscalls/kill/kill08.c
@@ -78,9 +78,6 @@ int main(int ac, char **av)
 	int exno, status, nsig, i;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "");
-#endif
 
 	setup();		/* global setup */
 
@@ -95,25 +92,17 @@ int main(int ac, char **av)
 		/* Fork a process and set the process group so that */
 		/* it is different from this one.  Fork 5 more children. */
 
-		pid1 = FORK_OR_VFORK();
+		pid1 = tst_fork();
 		if (pid1 < 0) {
 			tst_brkm(TBROK, cleanup, "Fork of first child failed");
 		} else if (pid1 == 0) {
 			setpgrp();
 			for (i = 0; i < 5; i++) {
-				pid2 = FORK_OR_VFORK();
+				pid2 = tst_fork();
 				if (pid2 < 0) {
 					tst_brkm(TBROK, cleanup, "Fork failed");
 				} else if (pid2 == 0) {
-#ifdef UCLINUX
-					if (self_exec(av[0], "") < 0) {
-						tst_brkm(TBROK, cleanup,
-							 "self_exec of "
-							 "child failed");
-					}
-#else
 					do_child();
-#endif
 				}
 			}
 			/* Kill all processes in this process group */
diff --git a/testcases/kernel/syscalls/kill/kill09.c b/testcases/kernel/syscalls/kill/kill09.c
index c5878923c..c0b703119 100644
--- a/testcases/kernel/syscalls/kill/kill09.c
+++ b/testcases/kernel/syscalls/kill/kill09.c
@@ -135,28 +135,17 @@ int main(int ac, char **av)
 
 	tst_parse_opts(ac, av, NULL, NULL);
 
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "");
-#endif
-
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); lc++) {
 
 		tst_count = 0;
 
-		if ((fork_pid = FORK_OR_VFORK()) == -1)
+		if ((fork_pid = tst_fork()) == -1)
 			tst_brkm(TBROK | TERRNO, cleanup, "fork failed");
 
 		if (fork_pid == 0) {
-#ifdef UCLINUX
-			if (self_exec(av[0], "") < 0) {
-				tst_brkm(TBROK, cleanup,
-					 "self_exec of child failed");
-			}
-#else
 			do_child();
-#endif
 		}
 
 		TEST(kill(fork_pid, SIGKILL));
diff --git a/testcases/kernel/syscalls/kill/kill12.c b/testcases/kernel/syscalls/kill/kill12.c
index 8ab641d39..f864bdcb6 100644
--- a/testcases/kernel/syscalls/kill/kill12.c
+++ b/testcases/kernel/syscalls/kill/kill12.c
@@ -95,7 +95,7 @@ int main(int argc, char **argv)
 		fflush(temp);
 		chflag = 0;
 
-		pid = FORK_OR_VFORK();
+		pid = tst_fork();
 		if (pid < 0) {
 			forkfail();
 		}
diff --git a/testcases/kernel/syscalls/link/link05.c b/testcases/kernel/syscalls/link/link05.c
index dfef3d458..b6c49bcca 100644
--- a/testcases/kernel/syscalls/link/link05.c
+++ b/testcases/kernel/syscalls/link/link05.c
@@ -17,25 +17,27 @@
 #include "tst_test.h"
 
 #define BASENAME	"lkfile"
+#define NLINKS	1000
 
 static char fname[255];
 
-static int nlinks = 1000;
-
 static void verify_link(void)
 {
-	int cnt;
+	int cnt = 0, created;
 	char lname[1024];
 	struct stat fbuf, lbuf;
 
-	for (cnt = 1; cnt < nlinks; cnt++) {
-		sprintf(lname, "%s_%d", fname, cnt);
-		TST_EXP_PASS_SILENT(link(fname, lname), "link(%s, %s)", fname, lname);
+	for (created = 1; created < NLINKS; created++) {
+		sprintf(lname, "%s_%d", fname, created);
+		TST_EXP_PASS_SILENT(link(fname, lname), "%d: link(%s, %s)", created,
+							fname, lname);
+		if (!TST_PASS)
+			goto cleanup;
 	}
 
 	SAFE_STAT(fname, &fbuf);
 
-	for (cnt = 1; cnt < nlinks; cnt++) {
+	for (cnt = 1; cnt < NLINKS; cnt++) {
 		sprintf(lname, "%s_%d", fname, cnt);
 
 		SAFE_STAT(lname, &lbuf);
@@ -44,19 +46,20 @@ static void verify_link(void)
 
 			tst_res(TFAIL,
 				 "link(%s, %s[1-%d]) ret %ld for %d files, stat values do not match %d %d",
-				 fname, fname, nlinks, TST_RET, nlinks,
+				 fname, fname, NLINKS, TST_RET, NLINKS,
 				 (int)fbuf.st_nlink, (int)lbuf.st_nlink);
 			break;
 		}
 	}
 
-	if (cnt >= nlinks) {
+	if (cnt == NLINKS) {
 		tst_res(TPASS,
 			 "link(%s, %s[1-%d]) ret %ld for %d files, stat linkcounts match %d",
-			 fname, fname, nlinks, TST_RET, nlinks, (int)fbuf.st_nlink);
+			 fname, fname, NLINKS, TST_RET, NLINKS, (int)fbuf.st_nlink);
 	}
 
-	for (cnt = 1; cnt < nlinks; cnt++) {
+cleanup:
+	for (cnt = 1; cnt < created; cnt++) {
 		sprintf(lname, "%s_%d", fname, cnt);
 		SAFE_UNLINK(lname);
 	}
diff --git a/testcases/kernel/syscalls/listxattr/listxattr01.c b/testcases/kernel/syscalls/listxattr/listxattr01.c
index 62198b2a7..d3c3794cd 100644
--- a/testcases/kernel/syscalls/listxattr/listxattr01.c
+++ b/testcases/kernel/syscalls/listxattr/listxattr01.c
@@ -1,18 +1,18 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
-*  Copyright (c) 2016 RT-RK Institute for Computer Based Systems
-*  Author: Dejan Jovicevic <dejan.jovicevic@rt-rk.com>
-*/
-
-/*
-* Test Name: listxattr01
-*
-* Description:
-* The testcase checks the basic functionality of the listxattr(2).
-* listxattr(2) retrieves the list of extended attribute names
-* associated with the file itself in the filesystem.
-*
-*/
+ * Copyright (c) 2016 RT-RK Institute for Computer Based Systems
+ * Copyright (c) Linux Test Project, 2016-2024
+ * Author: Dejan Jovicevic <dejan.jovicevic@rt-rk.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Test for listxattr(2) system call.
+ *
+ * listxattr(2) retrieves the list of extended attribute names
+ * associated with the file itself in the filesystem.
+ */
 
 #include "config.h"
 #include <errno.h>
diff --git a/testcases/kernel/syscalls/listxattr/listxattr02.c b/testcases/kernel/syscalls/listxattr/listxattr02.c
index 98a0985b3..0dc83cb40 100644
--- a/testcases/kernel/syscalls/listxattr/listxattr02.c
+++ b/testcases/kernel/syscalls/listxattr/listxattr02.c
@@ -1,25 +1,20 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
-*  Copyright (c) 2016 RT-RK Institute for Computer Based Systems
-*  Author: Dejan Jovicevic <dejan.jovicevic@rt-rk.com>
-*/
-
-/*
-* Test Name: listxattr02
-*
-* Description:
-* 1) listxattr(2) fails if the size of the list buffer is too small
-* to hold the result.
-* 2) listxattr(2) fails if path is an empty string.
-* 3) listxattr(2) fails when attempted to read from a invalid address.
-* 4) listxattr(2) fails if path is longer than allowed.
-*
-* Expected Result:
-* 1) listxattr(2) should return -1 and set errno to ERANGE.
-* 2) listxattr(2) should return -1 and set errno to ENOENT.
-* 3) listxattr(2) should return -1 and set errno to EFAULT.
-* 4) listxattr(2) should return -1 and set errno to ENAMETOOLONG.
-*/
+ * Copyright (c) 2016 RT-RK Institute for Computer Based Systems
+ * Copyright (c) Linux Test Project, 2016-2024
+ * Author: Dejan Jovicevic <dejan.jovicevic@rt-rk.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Test for listxattr error.
+ *
+ * - ERANGE - the size of the list buffer is too small to hold the result.
+ * - ENOENT - path is an empty string.
+ * - EFAULT - attempted to read from a invalid address.
+ * - ENAMETOOLONG - path is longer than allowed.
+ */
 
 #include "config.h"
 #include <errno.h>
@@ -38,7 +33,7 @@
 #define VALUE_SIZE	(sizeof(VALUE) - 1)
 #define TESTFILE    "testfile"
 
-char longpathname[PATH_MAX + 2];
+static char longpathname[PATH_MAX + 2];
 
 static struct test_case {
 	const char *path;
diff --git a/testcases/kernel/syscalls/listxattr/listxattr03.c b/testcases/kernel/syscalls/listxattr/listxattr03.c
index 4c1e7f16c..31125e8cd 100644
--- a/testcases/kernel/syscalls/listxattr/listxattr03.c
+++ b/testcases/kernel/syscalls/listxattr/listxattr03.c
@@ -1,16 +1,16 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
-*  Copyright (c) 2016 RT-RK Institute for Computer Based Systems
-*  Author: Dejan Jovicevic <dejan.jovicevic@rt-rk.com>
-*/
+ * Copyright (c) 2016 RT-RK Institute for Computer Based Systems
+ * Copyright (c) Linux Test Project, 2016-2024
+ * Author: Dejan Jovicevic <dejan.jovicevic@rt-rk.com>
+ */
 
 /*
-* Test Name: listxattr03
-*
-* Description:
-* An empty buffer of size zero can return the current size of the list
-* of extended attribute names, which can be used to estimate a suitable buffer.
-*/
+ * [Description]
+ *
+ * Test for returning the current size of the list of extended attribute names,
+ * with size specified as zero.
+ */
 
 #include "config.h"
 #include <errno.h>
diff --git a/testcases/kernel/syscalls/lstat/lstat01.c b/testcases/kernel/syscalls/lstat/lstat01.c
index becfe6217..62c530419 100644
--- a/testcases/kernel/syscalls/lstat/lstat01.c
+++ b/testcases/kernel/syscalls/lstat/lstat01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  *  Authors:	William Roske, Dave Fenner
diff --git a/testcases/kernel/syscalls/madvise/madvise02.c b/testcases/kernel/syscalls/madvise/madvise02.c
index 90c0431c5..cc3faf5cf 100644
--- a/testcases/kernel/syscalls/madvise/madvise02.c
+++ b/testcases/kernel/syscalls/madvise/madvise02.c
@@ -58,6 +58,8 @@ static char *ptr_addr;
 static char *tmp_addr;
 static char *nonalign;
 
+#define TCASE(adv, nm, add, ee) {adv, nm, add, ee, 0}
+
 static struct tcase {
 	int advice;
 	char *name;
@@ -65,19 +67,19 @@ static struct tcase {
 	int exp_errno;
 	int skip;
 } tcases[] = {
-	{MADV_NORMAL,      "MADV_NORMAL",      &nonalign, EINVAL, 0},
-	{1212,             "MADV_NORMAL",      &file1,    EINVAL, 0},
-	{MADV_REMOVE,      "MADV_REMOVE",      &file1,    EINVAL, 0},
-	{MADV_DONTNEED,    "MADV_DONTNEED",    &file1,    EINVAL, 1},
-	{MADV_MERGEABLE,   "MADV_MERGEABLE",   &file1,    EINVAL, 0},
-	{MADV_UNMERGEABLE, "MADV_UNMERGEABLE", &file1,    EINVAL, 0},
-	{MADV_NORMAL,      "MADV_NORMAL",      &file2,    ENOMEM, 0},
-	{MADV_WILLNEED,    "MADV_WILLNEED",    &file2,    ENOMEM, 0},
-	{MADV_WILLNEED,    "MADV_WILLNEED",    &tmp_addr,  EBADF, 0},
-	{MADV_FREE,        "MADV_FREE",        &file1,    EINVAL, 0},
-	{MADV_WIPEONFORK,  "MADV_WIPEONFORK",  &file1,    EINVAL, 0},
-	{MADV_WIPEONFORK,  "MADV_WIPEONFORK shared_anon", &shared_anon, EINVAL, 0},
-	{MADV_WIPEONFORK,  "MADV_WIPEONFORK private file backed", &file3, EINVAL, 0},
+	TCASE(MADV_NORMAL,      "MADV_NORMAL",      &nonalign, EINVAL),
+	TCASE(1212,             "MADV_NORMAL",      &file1,    EINVAL),
+	TCASE(MADV_REMOVE,      "MADV_REMOVE",      &file1,    EINVAL),
+	TCASE(MADV_DONTNEED,    "MADV_DONTNEED",    &file1,    EINVAL),
+	TCASE(MADV_MERGEABLE,   "MADV_MERGEABLE",   &file1,    EINVAL),
+	TCASE(MADV_UNMERGEABLE, "MADV_UNMERGEABLE", &file1,    EINVAL),
+	TCASE(MADV_NORMAL,      "MADV_NORMAL",      &file2,    ENOMEM),
+	TCASE(MADV_WILLNEED,    "MADV_WILLNEED",    &file2,    ENOMEM),
+	TCASE(MADV_WILLNEED,    "MADV_WILLNEED",    &tmp_addr,  EBADF),
+	TCASE(MADV_FREE,        "MADV_FREE",        &file1,    EINVAL),
+	TCASE(MADV_WIPEONFORK,  "MADV_WIPEONFORK",  &file1,    EINVAL),
+	TCASE(MADV_WIPEONFORK,  "MADV_WIPEONFORK shared_anon", &shared_anon, EINVAL),
+	TCASE(MADV_WIPEONFORK,  "MADV_WIPEONFORK private file backed", &file3, EINVAL),
 };
 
 static void tcases_filter(void)
@@ -89,11 +91,8 @@ static void tcases_filter(void)
 
 		switch (tc->advice) {
 		case MADV_DONTNEED:
-#if !defined(UCLINUX)
 			if (mlock(file1, st.st_size) < 0)
 				tst_brk(TBROK | TERRNO, "mlock failed");
-			tc->skip = 0;
-#endif /* if !defined(UCLINUX) */
 		break;
 		case MADV_MERGEABLE:
 		case MADV_UNMERGEABLE:
diff --git a/testcases/kernel/syscalls/madvise/madvise06.c b/testcases/kernel/syscalls/madvise/madvise06.c
index be22318ea..b227840df 100644
--- a/testcases/kernel/syscalls/madvise/madvise06.c
+++ b/testcases/kernel/syscalls/madvise/madvise06.c
@@ -242,6 +242,7 @@ static struct tst_test test = {
 	.setup = setup,
 	.needs_tmpdir = 1,
 	.needs_root = 1,
+	.max_runtime = 60,
 	.taint_check = TST_TAINT_W | TST_TAINT_D,
 	.save_restore = (const struct tst_path_val[]) {
 		{"/proc/sys/vm/swappiness", NULL,
diff --git a/testcases/kernel/syscalls/madvise/madvise11.c b/testcases/kernel/syscalls/madvise/madvise11.c
index 7a12abf20..fe27a18d8 100644
--- a/testcases/kernel/syscalls/madvise/madvise11.c
+++ b/testcases/kernel/syscalls/madvise/madvise11.c
@@ -128,6 +128,8 @@ static int allocate_offline(int tnum)
 				return -1;
 
 			if (madvise(ptrs[num_alloc], pagesize, MADV_SOFT_OFFLINE) == -1) {
+				if (errno == EBUSY)
+					continue;
 				if (errno != EINVAL)
 					tst_res(TFAIL | TERRNO, "madvise failed");
 				if (errno == EINVAL)
diff --git a/testcases/kernel/syscalls/mincore/mincore02.c b/testcases/kernel/syscalls/mincore/mincore02.c
index ab73f4bf5..1918d6c08 100644
--- a/testcases/kernel/syscalls/mincore/mincore02.c
+++ b/testcases/kernel/syscalls/mincore/mincore02.c
@@ -1,136 +1,71 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+
 /*
  * Copyright (c) International Business Machines  Corp., 2001
- *   Author: Rajeev Tiwari: rajeevti@in.ibm.com
+ * Author: Rajeev Tiwari: rajeevti@in.ibm.com
  * Copyright (c) 2004 Gernot Payer <gpayer@suse.de>
  * Copyright (c) 2013 Cyril Hrubis <chrubis@suse.cz>
- *
- * This program is free software;  you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY;  without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- * the GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program;  if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
+/*\
+ * [Description]
+ *
  * This test case provides a functional validation for mincore system call.
  * We mmap a file of known size (multiple of page size) and lock it in
  * memory. Then we obtain page location information via mincore and compare
  * the result with the expected value.
  */
 
-#include <sys/mman.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <sys/wait.h>
-#include <fcntl.h>
-#include <unistd.h>
-#include <signal.h>
-#include <errno.h>
-
-#include "test.h"
-#include "safe_macros.h"
+#include "tst_test.h"
 
-char *TCID = "mincore02";
-int TST_TOTAL = 1;
+#define NUM_PAGES 4
 
-static int fd = 0;
-static void *addr = NULL;
-static int page_size;
-static int num_pages = 4;
-static unsigned char *vec = NULL;
+static void *addr;
+static int size;
+static unsigned char vec[NUM_PAGES];
+static int fd;
 
 static void cleanup(void)
 {
-	free(vec);
-	munlock(addr, page_size * num_pages);
-	munmap(addr, page_size * num_pages);
-	close(fd);
-	tst_rmdir();
+	if (addr) {
+		SAFE_MUNLOCK(addr, size);
+		SAFE_MUNMAP(addr, size);
+	}
+	if (fd > 0)
+		SAFE_CLOSE(fd);
 }
 
 static void setup(void)
 {
-	char *buf;
-	size_t size;
-
-	tst_tmpdir();
-
-	page_size = getpagesize();
-	if (page_size == -1)
-		tst_brkm(TBROK | TERRNO, cleanup, "Unable to get page size");
-
-	size = page_size * num_pages;
-	buf = malloc(size);
+	size = getpagesize() * NUM_PAGES;
+	char buf[size];
 
 	memset(buf, 42, size);
-	vec = malloc((size + page_size - 1) / page_size);
-	
-	fd = SAFE_OPEN(cleanup, "mincore02", O_CREAT | O_RDWR,
-		       S_IRUSR | S_IWUSR);
-
-	/* fill the temporary file with two pages of data */
-	if (write(fd, buf, size) < 0) {
-		tst_brkm(TBROK | TERRNO, cleanup,
-		         "Error in writing to the file");
-	}
-	free(buf);
 
-	addr = mmap(NULL, size, PROT_READ | PROT_WRITE | PROT_EXEC,
-	            MAP_SHARED, fd, 0);
+	int fd = SAFE_OPEN("mincore02", O_CREAT | O_RDWR, 0600);
 
-	if (addr == MAP_FAILED) {
-		tst_brkm(TBROK | TERRNO, cleanup,
-                         "Unable to map file for read/write");
-	}
+	SAFE_WRITE(SAFE_WRITE_ALL, fd, buf, size);
+	addr = SAFE_MMAP(NULL, size, PROT_READ | PROT_WRITE | PROT_EXEC, MAP_SHARED, fd, 0);
 
-	/* lock mmapped file, so mincore returns "in core" for all pages */
-	if (mlock(addr, size) == -1)
-		tst_brkm(TBROK | TERRNO, cleanup, "Unable to lock the file");
+	SAFE_MLOCK(addr, size);
 }
 
-int main(int argc, char **argv)
+static void check_mincore(void)
 {
-	int lock_pages, counter;
-	int lc;
-
-	tst_parse_opts(argc, argv, NULL, NULL);
-
-	setup();
+	TST_EXP_PASS(mincore(addr, size, vec));
 
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
+	int locked_pages = 0;
 
-		if (mincore(addr, num_pages * page_size, vec) == -1) {
-			tst_brkm(TBROK | TERRNO, cleanup,
-			         "Unable to execute mincore system call");
-		}
+	for (int i = 0; i < NUM_PAGES; i++)
+		locked_pages += (vec[i] & 1);
 
-		/* check status of pages */
-		lock_pages = 0;
-
-		for (counter = 0; counter < num_pages; counter++) {
-			if (vec[counter] & 1)
-				lock_pages++;
-		}
-
-		if (lock_pages == num_pages) {
-			tst_resm(TPASS, "%d pages locked, %d pages in-core", num_pages,
-				 lock_pages);
-		} else {
-			tst_resm(TFAIL,
-				 "not all locked pages are in-core: no. locked: %d, no. in-core: %d",
-				 num_pages, lock_pages);
-		}
-	}
-
-	cleanup();
-	tst_exit();
+	TST_EXP_EQ_SZ(locked_pages, NUM_PAGES);
 }
+
+static struct tst_test test = {
+	.setup = setup,
+	.cleanup = cleanup,
+	.test_all = check_mincore,
+	.needs_tmpdir = 1,
+};
diff --git a/testcases/kernel/syscalls/mincore/mincore03.c b/testcases/kernel/syscalls/mincore/mincore03.c
index 774fce98b..c3ef2d203 100644
--- a/testcases/kernel/syscalls/mincore/mincore03.c
+++ b/testcases/kernel/syscalls/mincore/mincore03.c
@@ -16,6 +16,7 @@
 #include <unistd.h>
 #include <sys/mman.h>
 #include "tst_test.h"
+#include "pgsize_helpers.h"
 
 #define NUM_PAGES 3
 
@@ -46,7 +47,7 @@ static void setup(void)
 static void test_mincore(unsigned int test_nr)
 {
 	const struct tcase *tc = &tcases[test_nr];
-	unsigned char vec[NUM_PAGES];
+	DECLARE_MINCORE_VECTOR(vec, NUM_PAGES);
 	int locked_pages;
 	int count, mincore_ret;
 
@@ -58,9 +59,10 @@ static void test_mincore(unsigned int test_nr)
 	if (mincore_ret == -1)
 		tst_brk(TBROK | TERRNO, "mincore failed");
 	locked_pages = 0;
-	for (count = 0; count < NUM_PAGES; count++)
+	for (count = 0; count < nr_pgs_to_nr_kernel_pgs(NUM_PAGES); count++)
 		if (vec[count] & 1)
 			locked_pages++;
+	locked_pages = nr_kernel_pgs_to_nr_pgs(locked_pages);
 
 	if (locked_pages == tc->expected_pages)
 		tst_res(TPASS, "mincore() reports %s", tc->desc);
diff --git a/testcases/kernel/syscalls/mincore/mincore04.c b/testcases/kernel/syscalls/mincore/mincore04.c
index ed0ab7dfa..f718301fb 100644
--- a/testcases/kernel/syscalls/mincore/mincore04.c
+++ b/testcases/kernel/syscalls/mincore/mincore04.c
@@ -20,6 +20,7 @@
 #include <fcntl.h>
 #include <stdlib.h>
 #include "tst_test.h"
+#include "pgsize_helpers.h"
 
 #define NUM_PAGES 3
 
@@ -64,17 +65,18 @@ static int count_pages_in_cache(void)
 {
 	int locked_pages = 0;
 	int count, ret;
-	unsigned char vec[NUM_PAGES];
+	DECLARE_MINCORE_VECTOR(vec, NUM_PAGES);
 
 	TST_CHECKPOINT_WAIT(0);
 
 	ret = mincore(ptr, size, vec);
 	if (ret == -1)
 		tst_brk(TBROK | TERRNO, "mincore failed");
-	for (count = 0; count < NUM_PAGES; count++) {
+	for (count = 0; count < nr_pgs_to_nr_kernel_pgs(NUM_PAGES); count++) {
 		if (vec[count] & 1)
 			locked_pages++;
 	}
+	locked_pages = nr_kernel_pgs_to_nr_pgs(locked_pages);
 
 	TST_CHECKPOINT_WAKE(1);
 	return locked_pages;
diff --git a/testcases/kernel/syscalls/mkdir/mkdir03.c b/testcases/kernel/syscalls/mkdir/mkdir03.c
index d5141bb64..20089c9c9 100644
--- a/testcases/kernel/syscalls/mkdir/mkdir03.c
+++ b/testcases/kernel/syscalls/mkdir/mkdir03.c
@@ -1,14 +1,21 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *   Copyright (c) International Business Machines Corp., 2001
+ * Copyright (c) International Business Machines Corp., 2001
+ * Copyright (c) Linux Test Project, 2002-2024
  * Ported to LTP: Wayne Boyer
  */
-/*
- * DESCRIPTION
- *	check mkdir() with various error conditions that should produce
- *	EFAULT, ENAMETOOLONG, EEXIST, ENOENT, ENOTDIR, ELOOP and EROFS
+
+/*\
+ * [Description]
+ *
+ * Check mkdir() with various error conditions that should produce
+ * EFAULT, ENAMETOOLONG, EEXIST, ENOENT, ENOTDIR, ELOOP and EROFS.
+ *
+ * Testing on various types of files (symlinks, directories, pipes, devices, etc).
  */
 
+#include <paths.h>
+#include <stdlib.h>
 #include <errno.h>
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -19,6 +26,10 @@
 #include "tst_test.h"
 
 #define TST_EEXIST	"tst_eexist"
+#define TST_PIPE	"tst_pipe"
+#define TST_FOLDER	"tst_folder"
+#define TST_SYMLINK	"tst_symlink"
+#define TST_NULLDEV	_PATH_DEVNULL
 #define TST_ENOENT	"tst_enoent/tst"
 #define TST_ENOTDIR_FILE "tst_enotdir"
 #define TST_ENOTDIR_DIR	"tst_enotdir/tst"
@@ -41,6 +52,10 @@ static struct tcase {
 	{NULL, EFAULT},
 	{long_dir, ENAMETOOLONG},
 	{TST_EEXIST, EEXIST},
+	{TST_FOLDER, EEXIST},
+	{TST_PIPE, EEXIST},
+	{TST_SYMLINK, EEXIST},
+	{TST_NULLDEV, EEXIST},
 	{TST_ENOENT, ENOENT},
 	{TST_ENOTDIR_DIR, ENOTDIR},
 	{loop_dir, ELOOP},
@@ -70,7 +85,13 @@ static void verify_mkdir(unsigned int n)
 static void setup(void)
 {
 	unsigned int i;
+	char *tmpdir = tst_get_tmpdir();
+
+	SAFE_SYMLINK(tmpdir, TST_SYMLINK);
+	free(tmpdir);
 
+	SAFE_MKFIFO(TST_PIPE, 0777);
+	SAFE_MKDIR(TST_FOLDER, 0777);
 	SAFE_TOUCH(TST_EEXIST, MODE, NULL);
 	SAFE_TOUCH(TST_ENOTDIR_FILE, MODE, NULL);
 
diff --git a/testcases/kernel/syscalls/mknod/mknod01.c b/testcases/kernel/syscalls/mknod/mknod01.c
index 7a4d5b43f..f800b996d 100644
--- a/testcases/kernel/syscalls/mknod/mknod01.c
+++ b/testcases/kernel/syscalls/mknod/mknod01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  *  AUTHOR: William Roske, CO-PILOT: Dave Fenner
diff --git a/testcases/kernel/syscalls/mknod/mknod09.c b/testcases/kernel/syscalls/mknod/mknod09.c
index 57b953790..e3b5dceae 100644
--- a/testcases/kernel/syscalls/mknod/mknod09.c
+++ b/testcases/kernel/syscalls/mknod/mknod09.c
@@ -1,149 +1,28 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+
 /*
- *   Copyright (C) Bull S.A. 2001
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (C) Bull S.A. 2001
+ * Copyright (c) International Business Machines  Corp., 2001
+ * 05/2002 Ported by Andr Merlier
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
-/*
- * Test Name: mknod09
- *
- * Test Description:
- *  Verify that, mknod() fails with -1 and sets errno to EINVAL if the mode is
- *  different than a normal file, device special file or FIFO.
- *
- * Expected Result:
- *  mknod() should fail with return value -1 and sets expected errno.
- *
- * Algorithm:
- *  Setup:
- *   Setup signal handling.
- *   Check id is super/root
- *   Pause for SIGUSR1 if option specified.
- *   Create temporary directory.
- *
- *  Test:
- *   Loop if the proper options are given.
- *   Execute system call
- *   Check return code, if system call failed (return=-1)
- *	if errno set == expected errno
- *		Issue sys call fails with expected return value and errno.
- *	Otherwise,
- *		Issue sys call fails with unexpected errno.
- *   Otherwise,
- *	Issue sys call returns unexpected value.
- *
- *  Cleanup:
- *   Print errno log and/or timing stats if options given
- *   Delete the temporary directory created.
- *
- * Usage:  <for command-line>
- *  mknod09 [-c n] [-e] [-f] [-i n] [-I x] [-P x] [-t]
- *     where,  -c n : Run n copies concurrently.
- *             -e   : Turn on errno logging.
- *             -f   : Turn off functionality Testing.
- *	       -i n : Execute test n times.
- *	       -I x : Execute test for x seconds.
- *	       -P x : Pause for x seconds between iterations.
- *	       -t   : Turn on syscall timing.
- *
- * HISTORY
- *	05/2002 Ported by Andr Merlier
- *
- * RESTRICTIONS:
- *  This test should be run by 'super-user' (root) only.
+
+/*\
+ * [Description]
  *
+ * Verify that mknod() fails with -1 and sets errno to EINVAL if the mode is
+ * different than a normal file, device special file or FIFO.
  */
 
-#include <errno.h>
-#include <sys/stat.h>
-#include "test.h"
-
-#define MODE_RWX	S_IFMT	/* mode different from those expected */
-#define TNODE		"tnode"	/*pathname */
+#include "tst_test.h"
 
-char *TCID = "mknod09";
-int TST_TOTAL = 1;
-
-void setup();			/* setup function for the test */
-void cleanup();			/* cleanup function for the test */
-
-int main(int ac, char **av)
+static void check_mknod(void)
 {
-	int lc;
-	char *test_desc;	/* test specific error message */
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		test_desc = "EINVAL";
-
-		tst_count = 0;
-
-		/*
-		 * Call mknod(2) to test condition.
-		 * verify that it fails with -1 return value and
-		 * sets appropriate errno.
-		 */
-		TEST(mknod(TNODE, MODE_RWX, 0));
-
-		/* Check return code from mknod(2) */
-		if (TEST_RETURN != -1) {
-			tst_resm(TFAIL, "mknod() returned %ld, "
-				 "expected -1, errno=%d", TEST_RETURN,
-				 EINVAL);
-		} else {
-			if (TEST_ERRNO == EINVAL) {
-				tst_resm(TPASS, "mknod() fails with expected "
-					 "error EINVAL errno:%d", TEST_ERRNO);
-			} else {
-				tst_resm(TFAIL, "mknod() fails, %s, "
-					 "errno=%d, expected errno=%d",
-					 test_desc, TEST_ERRNO, EINVAL);
-			}
-		}
-	}
-
-	cleanup();
-
-	tst_exit();
+	TST_EXP_FAIL(mknod("tnode", S_IFMT, 0), EINVAL);
 }
 
-/*
- * setup(void)
- */
-void setup(void)
-{
-	tst_require_root();
-
-	/* Capture unexpected signals */
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-
-	/* Make a temp dir and cd to it */
-	tst_tmpdir();
-}
-
-/*
- * cleanup()
- */
-void cleanup(void)
-{
-
-	tst_rmdir();
-
-}
+static struct tst_test test = {
+	.test_all = check_mknod,
+	.needs_tmpdir = 1,
+	.needs_root = 1
+};
diff --git a/testcases/kernel/syscalls/mlock/.gitignore b/testcases/kernel/syscalls/mlock/.gitignore
index 306574bbc..1872229b8 100644
--- a/testcases/kernel/syscalls/mlock/.gitignore
+++ b/testcases/kernel/syscalls/mlock/.gitignore
@@ -2,3 +2,4 @@
 /mlock02
 /mlock03
 /mlock04
+/mlock05
diff --git a/testcases/kernel/syscalls/mlock/mlock03.c b/testcases/kernel/syscalls/mlock/mlock03.c
index 3700b64b0..202a9063d 100644
--- a/testcases/kernel/syscalls/mlock/mlock03.c
+++ b/testcases/kernel/syscalls/mlock/mlock03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) 2010  Red Hat, Inc.
  */
diff --git a/testcases/kernel/syscalls/mlock/mlock04.c b/testcases/kernel/syscalls/mlock/mlock04.c
index f25460ba1..64f1bc5a0 100644
--- a/testcases/kernel/syscalls/mlock/mlock04.c
+++ b/testcases/kernel/syscalls/mlock/mlock04.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) 2010  Red Hat, Inc.
  */
diff --git a/testcases/kernel/syscalls/mlock/mlock05.c b/testcases/kernel/syscalls/mlock/mlock05.c
new file mode 100644
index 000000000..8e805736d
--- /dev/null
+++ b/testcases/kernel/syscalls/mlock/mlock05.c
@@ -0,0 +1,114 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright Red Hat
+ * Author: Filippo Storniolo <fstornio@redhat.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Verify mlock() causes pre-faulting of PTEs and prevent memory to be swapped out.
+ *
+ * Find the new mapping in /proc/$pid/smaps and check Rss and Locked fields after
+ * mlock syscall:
+ * Rss and Locked size should be equal to the size of the memory allocation
+ */
+
+#include "tst_test.h"
+#include "tst_safe_stdio.h"
+
+#define MMAPLEN			(1UL<<20)
+#define LINELEN			256
+
+static void get_proc_smaps_info(unsigned long desired_mapping_address, unsigned long *Rss, unsigned long *Locked)
+{
+	bool mapping_found = false;
+	bool Locked_found = false;
+	bool Rss_found = false;
+	char buffer[LINELEN];
+	FILE *fp;
+	int ret;
+
+	fp = SAFE_FOPEN("/proc/self/smaps", "r");
+
+	while (fgets(buffer, LINELEN, fp) != NULL) {
+		unsigned long mapping_address;
+
+		ret = sscanf(buffer, "%lx[^-]", &mapping_address);
+		if ((ret == 1) && (mapping_address == desired_mapping_address)) {
+			mapping_found = true;
+			break;
+		}
+	}
+
+	if (!mapping_found) {
+		SAFE_FCLOSE(fp);
+		tst_brk(TBROK, "Mapping %lx not found in /proc/self/smaps", desired_mapping_address);
+		return;
+	}
+
+	while (fgets(buffer, LINELEN, fp) != NULL) {
+		unsigned long possible_starting_mapping;
+		unsigned long possible_ending_mapping;
+
+		ret = sscanf(buffer, "%lx-%lx", &possible_starting_mapping, &possible_ending_mapping);
+		if (ret == 2)
+			break;
+
+		if (strncmp(buffer, "Rss", strlen("Rss")) == 0) {
+			ret = sscanf(buffer, "%*[^:]:%lu kB", Rss);
+			if (ret != 1) {
+				SAFE_FCLOSE(fp);
+				tst_brk(TBROK, "failure occurred while reading field Rss");
+				return;
+			}
+
+			Rss_found = true;
+		}
+
+		if (strncmp(buffer, "Locked", strlen("Locked")) == 0) {
+			ret = sscanf(buffer, "%*[^:]:%lu kB", Locked);
+			if (ret != 1) {
+				SAFE_FCLOSE(fp);
+				tst_brk(TBROK, "failure occurred while reading field Locked");
+				return;
+			}
+
+			Locked_found =  true;
+		}
+
+		if (Rss_found && Locked_found) {
+			SAFE_FCLOSE(fp);
+			return;
+		}
+	}
+
+	SAFE_FCLOSE(fp);
+	tst_brk(TBROK, "cannot find both Rss and Locked in mapping %lx", desired_mapping_address);
+}
+
+static void verify_mlock(void)
+{
+	unsigned long Locked;
+	unsigned long Rss;
+	char *buf;
+
+	buf = SAFE_MMAP(NULL, MMAPLEN, PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);
+	SAFE_MLOCK(buf, MMAPLEN);
+
+	get_proc_smaps_info((unsigned long)buf, &Rss, &Locked);
+
+	// Convertion from KiB to B
+	Rss *= 1024;
+	Locked *= 1024;
+
+	TST_EXP_EQ_LU(Rss, MMAPLEN);
+	TST_EXP_EQ_LU(Locked, MMAPLEN);
+
+	SAFE_MUNLOCK(buf, MMAPLEN);
+	SAFE_MUNMAP(buf, MMAPLEN);
+}
+
+static struct tst_test test = {
+	.test_all = verify_mlock,
+};
diff --git a/testcases/kernel/syscalls/mlock2/mlock201.c b/testcases/kernel/syscalls/mlock2/mlock201.c
index b0e5f12b7..1994a119d 100644
--- a/testcases/kernel/syscalls/mlock2/mlock201.c
+++ b/testcases/kernel/syscalls/mlock2/mlock201.c
@@ -25,17 +25,19 @@
 #include "tst_test.h"
 #include "lapi/syscalls.h"
 #include "lapi/mlock2.h"
+#include "pgsize_helpers.h"
 
 #define PAGES	8
 #define HPAGES	(PAGES / 2)
 
 static size_t pgsz;
-static unsigned char vec[PAGES+1];
+
+static DECLARE_MINCORE_VECTOR(vec, PAGES+1);
 
 static struct tcase {
 	size_t populate_pages;
 	size_t lock_pages;
-	size_t offset;
+	ssize_t offset; /* Can be negative */
 	size_t exp_vmlcks;
 	size_t exp_present_pages;
 	int flag;
@@ -78,12 +80,12 @@ static size_t check_locked_pages(char *addr, size_t len, size_t num_pgs)
 
 	SAFE_MINCORE(addr, len, vec);
 
-	for (n = 0; n < num_pgs; n++) {
+	for (n = 0; n < nr_pgs_to_nr_kernel_pgs(num_pgs); n++) {
 		if (vec[n] & 1)
 			act_pages++;
 	}
 
-	return act_pages;
+	return nr_kernel_pgs_to_nr_pgs(act_pages);
 }
 
 static void verify_mlock2(unsigned int n)
@@ -137,6 +139,7 @@ end2:
 static void setup(void)
 {
 	pgsz = getpagesize();
+	MLOCK_PAGE_SIZE_EMULATION_OFFSET(tcases);
 }
 
 static struct tst_test test = {
diff --git a/testcases/kernel/syscalls/mlockall/mlockall01.c b/testcases/kernel/syscalls/mlockall/mlockall01.c
index fa43dad33..50cdfc256 100644
--- a/testcases/kernel/syscalls/mlockall/mlockall01.c
+++ b/testcases/kernel/syscalls/mlockall/mlockall01.c
@@ -75,8 +75,6 @@ void cleanup();
 char *TCID = "mlockall01";
 int TST_TOTAL = 3;
 
-#if !defined(UCLINUX)
-
 struct test_case_t {
 	int flag;
 	char *fdesc;
@@ -127,16 +125,6 @@ int main(int ac, char **av)
 	tst_exit();
 }
 
-#else
-
-int main(void)
-{
-	tst_resm(TINFO, "test is not available on uClinux");
-	tst_exit();
-}
-
-#endif
-
 /*
  * setup() - performs all ONE TIME setup for this test.
  */
diff --git a/testcases/kernel/syscalls/mlockall/mlockall02.c b/testcases/kernel/syscalls/mlockall/mlockall02.c
index 94d6e3270..6524cb4a8 100644
--- a/testcases/kernel/syscalls/mlockall/mlockall02.c
+++ b/testcases/kernel/syscalls/mlockall/mlockall02.c
@@ -99,8 +99,6 @@ struct test_case_t {
 	0, EINVAL, "Unknown flag"}
 };
 
-#if !defined(UCLINUX)
-
 int main(int ac, char **av)
 {
 	int lc, i;
@@ -258,13 +256,3 @@ void cleanup(void)
 {
 	return;
 }
-
-#else
-
-int main(void)
-{
-	tst_resm(TINFO, "test is not available on uClinux");
-	tst_exit();
-}
-
-#endif /* if !defined(UCLINUX) */
diff --git a/testcases/kernel/syscalls/mlockall/mlockall03.c b/testcases/kernel/syscalls/mlockall/mlockall03.c
index 7418dd64d..a505891fc 100644
--- a/testcases/kernel/syscalls/mlockall/mlockall03.c
+++ b/testcases/kernel/syscalls/mlockall/mlockall03.c
@@ -92,8 +92,6 @@ void cleanup();
 char *TCID = "mlockall03";
 int TST_TOTAL = 3;
 
-#if !defined(UCLINUX)
-
 char *ref_release = "2.6.8\0";
 
 struct test_case_t {
@@ -286,16 +284,6 @@ void cleanup_test(int i)
 	}
 }
 
-#else
-
-int main(void)
-{
-	tst_resm(TINFO, "test is not available on uClinux");
-	tst_exit();
-}
-
-#endif /* if !defined(UCLINUX) */
-
 /*
  * cleanup() - performs all ONE TIME cleanup for this test at
  *		completion or premature exit.
diff --git a/testcases/kernel/syscalls/mmap/mmap06.c b/testcases/kernel/syscalls/mmap/mmap06.c
index 615743fa7..9d983250c 100644
--- a/testcases/kernel/syscalls/mmap/mmap06.c
+++ b/testcases/kernel/syscalls/mmap/mmap06.c
@@ -56,16 +56,10 @@ static void run(unsigned int i)
 {
 	struct tcase *tc = &tcases[i];
 
-	TESTPTR(mmap(NULL, tc->length, tc->prot, tc->flags, fd, 0));
+	TST_EXP_FAIL_PTR_VOID(mmap(NULL, tc->length, tc->prot, tc->flags, fd, 0), tc->exp_errno);
 
-	if (TST_RET_PTR != MAP_FAILED) {
-		tst_res(TFAIL, "mmap() was successful unexpectedly");
-		SAFE_MUNMAP(TST_RET_PTR, MMAPSIZE);
-	} else if (TST_ERR == tc->exp_errno) {
-		tst_res(TPASS | TERRNO, "mmap() failed with");
-	} else {
-		tst_res(TFAIL | TERRNO, "mmap() failed unexpectedly");
-	}
+	if (TST_RET_PTR != MAP_FAILED)
+		SAFE_MUNMAP(TST_RET_PTR, page_sz);
 }
 
 static void cleanup(void)
diff --git a/testcases/kernel/syscalls/mmap/mmap08.c b/testcases/kernel/syscalls/mmap/mmap08.c
index 5c9fd782c..18db0b46f 100644
--- a/testcases/kernel/syscalls/mmap/mmap08.c
+++ b/testcases/kernel/syscalls/mmap/mmap08.c
@@ -8,7 +8,7 @@
 /*\
  * [Description]
  *
- * verify that, mmap() calls fails with errno EBADF when a file mapping
+ * Verify that, mmap() calls fails with errno EBADF when a file mapping
  * is requested but the fd is not a valid file descriptor.
  */
 
@@ -27,16 +27,11 @@ static void setup(void)
 
 static void run(void)
 {
-	TESTPTR(mmap(NULL, page_sz, PROT_WRITE, MAP_FILE | MAP_SHARED, fd, 0));
+	TST_EXP_FAIL_PTR_VOID(mmap(NULL, page_sz, PROT_WRITE,
+				   MAP_FILE | MAP_SHARED, fd, 0), EBADF);
 
-	if (TST_RET_PTR != MAP_FAILED) {
-		tst_res(TFAIL, "mmap() passed unexpectedly");
+	if (TST_RET_PTR != MAP_FAILED)
 		SAFE_MUNMAP(TST_RET_PTR, page_sz);
-	} else if (TST_ERR == EBADF) {
-		tst_res(TPASS, "mmap() failed with EBADF");
-	} else {
-		tst_res(TFAIL | TERRNO, "mmap() failed with an invalid errno");
-	}
 }
 
 static void cleanup(void)
diff --git a/testcases/kernel/syscalls/mmap/mmap09.c b/testcases/kernel/syscalls/mmap/mmap09.c
index 4ab0da470..16634dc30 100644
--- a/testcases/kernel/syscalls/mmap/mmap09.c
+++ b/testcases/kernel/syscalls/mmap/mmap09.c
@@ -1,119 +1,73 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+
 /*
  * Copyright (c) International Business Machines  Corp., 2003
- *
- * This program is free software;  you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY;  without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- * the GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program;  if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Author: by Paul Larson
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
- * Test Description:
- *  Verify that truncating a mmaped file works correctly.
+/*\
+ * [Description]
  *
- * Expected Result:
- *  ftruncate should be allowed to increase, decrease, or zero the
- *  size of a file that has been mmaped
+ * Verify that truncating a mmaped file works correctly.
  *
- *  Test:
- *   Use ftruncate to shrink the file while it is mapped
- *   Use ftruncate to grow the file while it is mapped
- *   Use ftruncate to zero the size of the file while it is mapped
+ * Use ftruncate to:
  *
- * HISTORY
- *	04/2003 Written by Paul Larson
+ * 1. shrink the file while it is mapped
+ * 2. grow the file while it is mapped
+ * 3. zero the size of the file while it is mapped
  */
-#include <stdio.h>
-#include <unistd.h>
-#include <fcntl.h>
-#include <errno.h>
-#include <sys/mman.h>
-#include <sys/types.h>
-#include "test.h"
 
-#define mapsize (1 << 14)
+#include "tst_test.h"
 
-char *TCID = "mmap09";
-int TST_TOTAL = 3;
+/* size of the test file = 64 KB */
+#define MAPSIZE (64 * 1024)
 
 static int fd;
 static char *maddr;
 
-static struct test_case_t {
+static struct test_case
+{
 	off_t newsize;
 	char *desc;
-} TC[] = {
-	{mapsize - 8192, "ftruncate mmaped file to a smaller size"},
-	{mapsize + 1024, "ftruncate mmaped file to a larger size"},
+} tcases[] = {
+	{MAPSIZE - 8192, "ftruncate mmaped file to a smaller size"},
+	{MAPSIZE + 1024, "ftruncate mmaped file to a larger size"},
 	{0, "ftruncate mmaped file to 0 size"},
 };
 
-static void setup(void);
-static void cleanup(void);
-
-int main(int argc, char **argv)
+static void verify_mmap(unsigned int nr)
 {
-	int lc;
-	int i;
-
-	tst_parse_opts(argc, argv, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-		for (i = 0; i < TST_TOTAL; i++) {
-			TEST(ftruncate(fd, TC[i].newsize));
+	struct test_case *tc = &tcases[nr];
 
-			if (TEST_RETURN == -1) {
-				tst_resm(TFAIL | TTERRNO, "%s", TC[i].desc);
-			} else {
-				tst_resm(TPASS, "%s", TC[i].desc);
-			}
-		}
-
-	}
-
-	cleanup();
-	tst_exit();
+	TST_EXP_PASS(ftruncate(fd, tc->newsize), "%s", tc->desc);
 }
 
 static void setup(void)
 {
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-
-	tst_tmpdir();
-
-	if ((fd = open("mmaptest", O_RDWR | O_CREAT, 0666)) < 0)
-		tst_brkm(TFAIL | TERRNO, cleanup, "opening mmaptest failed");
+	fd = SAFE_OPEN("/tmp/mmaptest", O_RDWR | O_CREAT, 0666);
 
-	/* ftruncate the file to 16k */
-	if (ftruncate(fd, mapsize) < 0)
-		tst_brkm(TFAIL | TERRNO, cleanup, "ftruncate file failed");
-
-	maddr = mmap(0, mapsize, PROT_READ | PROT_WRITE,
-		     MAP_FILE | MAP_SHARED, fd, 0);
-	if (maddr == MAP_FAILED)
-		tst_brkm(TFAIL | TERRNO, cleanup, "mmapping mmaptest failed");
+	/* set the file to initial size */
+	SAFE_FTRUNCATE(fd, MAPSIZE);
+	maddr = SAFE_MMAP(0, MAPSIZE, PROT_READ | PROT_WRITE, MAP_FILE | MAP_SHARED, fd, 0);
 
 	/* fill up the file with A's */
-	memset(maddr, 'A', mapsize);
+	memset(maddr, 'A', MAPSIZE);
 }
 
 static void cleanup(void)
 {
-	munmap(maddr, mapsize);
-	close(fd);
-	tst_rmdir();
+	if (maddr)
+		SAFE_MUNMAP(maddr, MAPSIZE);
+
+	if (fd)
+		SAFE_CLOSE(fd);
 }
+
+static struct tst_test test = {
+	.setup = setup,
+	.cleanup = cleanup,
+	.test = verify_mmap,
+	.tcnt = ARRAY_SIZE(tcases),
+	.needs_tmpdir = 1,
+};
diff --git a/testcases/kernel/syscalls/mmap/mmap13.c b/testcases/kernel/syscalls/mmap/mmap13.c
index c5a2058e9..7298f5de5 100644
--- a/testcases/kernel/syscalls/mmap/mmap13.c
+++ b/testcases/kernel/syscalls/mmap/mmap13.c
@@ -1,142 +1,78 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2013 FNST, DAN LI <li.dan@cn.fujitsu.com>
- *
- * This program is free software;  you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY;  without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- * the GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program;  if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) 2024 SUSE LLC Avinesh Kumar <avinesh.kumar@suse.com>
  */
 
-/*
- * Test Description:
- *  Verify error signal SIGBUS.
- *  "Attempted access to a portion of the buffer that does not correspond
- *   to the file."
+/*\
+ * [Description]
  *
- * Expected Result:
- *  mmap() should succeed returning the address of the mapped region,
- *  and an attempt to access the memory which does not correspond to the file
- *  should rise the signal SIGBUS.
+ * Verify that, mmap() call succeeds to create a file mapping with length
+ * argument greater than the file size but any attempt to reference the
+ * memory region which does not correspond to the file causes SIGBUS signal.
  */
-#include <stdio.h>
+
 #include <stdlib.h>
-#include <sys/types.h>
-#include <errno.h>
-#include <unistd.h>
-#include <fcntl.h>
-#include <string.h>
-#include <signal.h>
-#include <sys/stat.h>
-#include <sys/mman.h>
 #include <setjmp.h>
-
-#include "test.h"
+#include "tst_test.h"
 
 #define TEMPFILE	"mmapfile"
-
-char *TCID = "mmap13";
-int TST_TOTAL = 1;
-
 static size_t page_sz;
 static char *addr;
-static int fildes;
+static int fd;
 static volatile sig_atomic_t pass;
 static sigjmp_buf env;
 
-static void setup(void);
-static void cleanup(void);
-static void sig_handler(int sig);
-
-int main(int argc, char *argv[])
+static void sig_handler(int sig)
 {
-	int lc;
-	char *ch;
-
-	tst_parse_opts(argc, argv, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-
-		addr = mmap(NULL, page_sz * 2, PROT_READ | PROT_WRITE,
-			    MAP_FILE | MAP_SHARED, fildes, 0);
-
-		if (addr == MAP_FAILED) {
-			tst_resm(TFAIL | TERRNO, "mmap() failed on %s",
-				 TEMPFILE);
-			continue;
-		}
-
-		if (sigsetjmp(env, 1) == 0) {
-			ch = addr + page_sz + 1;
-			*ch = 0;
-		}
-
-		if (pass)
-			tst_resm(TPASS, "Got SIGBUS "
-					"as expected");
-		else
-			tst_resm(TFAIL, "Invalid access not "
-						"rise SIGBUS");
-
-		if (munmap(addr, page_sz * 2) != 0)
-			tst_brkm(TFAIL | TERRNO, cleanup,
-				 "failed to unmap the mmapped pages");
-
-		pass = 0;
+	if (sig == SIGBUS) {
+		pass = 1;
+		siglongjmp(env, 1);
 	}
-
-	cleanup();
-	tst_exit();
 }
 
 static void setup(void)
 {
-	tst_sig(NOFORK, sig_handler, cleanup);
-
-	TEST_PAUSE;
+	SAFE_SIGNAL(SIGBUS, sig_handler);
 
 	page_sz = getpagesize();
 
-	tst_tmpdir();
-
-	fildes = open(TEMPFILE, O_RDWR | O_CREAT, 0766);
-	if (fildes < 0)
-		tst_brkm(TFAIL | TERRNO, cleanup, "opening %s failed",
-			 TEMPFILE);
-
-	if (ftruncate(fildes, page_sz / 2) == -1)
-		tst_brkm(TFAIL | TERRNO, cleanup, "ftruncate %s failed",
-			 TEMPFILE);
+	fd = SAFE_OPEN(TEMPFILE, O_RDWR | O_CREAT, 0666);
+	SAFE_FTRUNCATE(fd, page_sz / 2);
 }
 
-/*
- *   This function gets executed when the test process receives
- *   the signal SIGBUS while trying to access the memory which
- *   does not correspond to the file.
- */
-static void sig_handler(int sig)
+static void run(void)
 {
-	if (sig == SIGBUS) {
-		pass = 1;
-		siglongjmp(env, 1);
-	} else {
-		tst_brkm(TBROK, cleanup, "received an unexpected signal");
+	char *ch;
+
+	addr = mmap(0, page_sz * 2, PROT_READ | PROT_WRITE, MAP_FILE | MAP_SHARED, fd, 0);
+	if (addr == MAP_FAILED) {
+		tst_res(TFAIL | TERRNO, "mmap() of %s failed", TEMPFILE);
+		return;
 	}
+
+	if (sigsetjmp(env, 1) == 0) {
+		ch = addr + page_sz + 1;
+		*ch = 0;
+	}
+
+	if (pass == 1)
+		tst_res(TPASS, "Received SIGBUS signal as expected");
+	else
+		tst_res(TFAIL, "SIGBUS signal not received");
+
+	SAFE_MUNMAP(addr, page_sz * 2);
 }
 
 static void cleanup(void)
 {
-	close(fildes);
-	tst_rmdir();
+	if (fd > 0)
+		SAFE_CLOSE(fd);
 }
+
+static struct tst_test test = {
+	.setup = setup,
+	.cleanup = cleanup,
+	.test_all = run,
+	.needs_tmpdir = 1
+};
diff --git a/testcases/kernel/syscalls/mmap/mmap15.c b/testcases/kernel/syscalls/mmap/mmap15.c
index 71c18a10a..2128e0b57 100644
--- a/testcases/kernel/syscalls/mmap/mmap15.c
+++ b/testcases/kernel/syscalls/mmap/mmap15.c
@@ -61,6 +61,5 @@ static struct tst_test test = {
 	.setup = setup,
 	.cleanup = cleanup,
 	.test_all = run,
-	.skip_in_compat = 1,
 	.needs_tmpdir = 1
 };
diff --git a/testcases/kernel/syscalls/modify_ldt/modify_ldt02.c b/testcases/kernel/syscalls/modify_ldt/modify_ldt02.c
index f911aa5fd..5113b3fb4 100644
--- a/testcases/kernel/syscalls/modify_ldt/modify_ldt02.c
+++ b/testcases/kernel/syscalls/modify_ldt/modify_ldt02.c
@@ -119,7 +119,7 @@ int main(int ac, char **av)
 		}
 
 		tst_old_flush();
-		if ((pid = FORK_OR_VFORK()) == 0) {
+		if ((pid = tst_fork()) == 0) {
 			signal(SIGSEGV, SIG_DFL);
 			val = read_segment(0);
 			exit(1);
diff --git a/testcases/kernel/syscalls/mount/mount01.c b/testcases/kernel/syscalls/mount/mount01.c
index 1d902ba89..588e7c567 100644
--- a/testcases/kernel/syscalls/mount/mount01.c
+++ b/testcases/kernel/syscalls/mount/mount01.c
@@ -1,99 +1,48 @@
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
+ *               Nirmala Devi Dhanasekar <nirmala.devi@wipro.com>
+ * Copyright (C) 2024 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
+ */
+
+/*\
+ * [Description]
  *
- * This program is free software; you can redistribute it and/or modify it
- * under the terms of version 2 of the GNU General Public License as
- * published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it would be useful, but
- * WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- *
- * You should have received a copy of the GNU General Public License along
- * with this program; if not, write the Free Software Foundation, Inc.,
- * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
- *
- *    AUTHOR		: Nirmala Devi Dhanasekar <nirmala.devi@wipro.com>
- *
- *    DESCRIPTION
- *	This is a Phase I test for the mount(2) system call.
- *	It is intended to provide a limited exposure of the system call.
+ * Basic test that checks mount() syscall works on multiple filesystems.
  */
 
-#include <errno.h>
+#include "tst_test.h"
 #include <sys/mount.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include "test.h"
-#include "safe_macros.h"
-
-static void setup(void);
-static void cleanup(void);
-
-char *TCID = "mount01";
-int TST_TOTAL = 1;
 
-#define DIR_MODE (S_IRWXU | S_IRUSR | S_IXUSR | S_IRGRP | S_IXGRP)
 #define MNTPOINT "mntpoint"
 
-static const char *device;
-static const char *fs_type;
-
-int main(int ac, char **av)
+static void cleanup(void)
 {
-	int lc;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-
-		tst_count = 0;
-
-		TEST(mount(device, MNTPOINT, fs_type, 0, NULL));
-
-		if (TEST_RETURN != 0) {
-			tst_resm(TFAIL | TTERRNO, "mount(2) failed");
-		} else {
-			tst_resm(TPASS, "mount(2) passed ");
-			TEST(tst_umount(MNTPOINT));
-			if (TEST_RETURN != 0) {
-				tst_brkm(TBROK | TTERRNO, cleanup,
-					 "umount(2) failed");
-			}
-		}
-	}
-
-	cleanup();
-	tst_exit();
+	if (tst_is_mounted(MNTPOINT))
+		SAFE_UMOUNT(MNTPOINT);
 }
 
-static void setup(void)
+static void run(void)
 {
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-
-	tst_require_root();
-
-	tst_tmpdir();
-
-	fs_type = tst_dev_fs_type();
-	device = tst_acquire_device(cleanup);
-
-	if (!device)
-		tst_brkm(TCONF, cleanup, "Failed to obtain block device");
+	TST_EXP_PASS(mount(tst_device->dev, MNTPOINT, tst_device->fs_type, 0, NULL));
 
-	tst_mkfs(cleanup, device, fs_type, NULL, NULL);
-
-	SAFE_MKDIR(cleanup, MNTPOINT, DIR_MODE);
-
-	TEST_PAUSE;
+	if (tst_is_mounted(MNTPOINT)) {
+		tst_res(TPASS, "folder has been mounted");
+		SAFE_UMOUNT(MNTPOINT);
+	} else {
+		tst_res(TFAIL, "folder has not been mounted");
+	}
 }
 
-static void cleanup(void)
-{
-	if (device)
-		tst_release_device(device);
-
-	tst_rmdir();
-}
+static struct tst_test test = {
+	.cleanup = cleanup,
+	.test_all = run,
+	.needs_root = 1,
+	.format_device = 1,
+	.all_filesystems = 1,
+	.mntpoint = MNTPOINT,
+	.skip_filesystems = (const char *const []){
+		"ntfs",
+		NULL
+	},
+};
diff --git a/testcases/kernel/syscalls/mount/mount02.c b/testcases/kernel/syscalls/mount/mount02.c
index 392b4fd3a..ae3884f98 100644
--- a/testcases/kernel/syscalls/mount/mount02.c
+++ b/testcases/kernel/syscalls/mount/mount02.c
@@ -1,212 +1,150 @@
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
- *  AUTHOR: Nirmala Devi Dhanasekar <nirmala.devi@wipro.com>
- * Copyright (c) 2014 Cyril Hrubis <chrubis@suse.cz>
- *
- * This program is free software; you can redistribute it and/or modify it
- * under the terms of version 2 of the GNU General Public License as
- * published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it would be useful, but
- * WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
+ *               Nirmala Devi Dhanasekar <nirmala.devi@wipro.com>
+ * Copyright (c) Linux Test Project, 2005-2023
+ * Copyright (C) 2024 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
+ */
+
+/*\
+ * [Description]
  *
- * You should have received a copy of the GNU General Public License along
- * with this program; if not, write the Free Software Foundation, Inc.,
- * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
+ * Check for basic errors returned by mount(2) system call.
  *
+ * - ENODEV if filesystem type not configured
+ * - ENOTBLK if specialfile is not a block device
+ * - EBUSY if specialfile is already mounted or it  cannot  be remounted
+ *   read-only, because it still holds files open for writing.
+ * - EINVAL if specialfile or device is invalid or a remount was attempted,
+ *   while source was not already mounted on target.
+ * - EFAULT if special file or device file points to invalid address space.
+ * - ENAMETOOLONG if pathname was longer than MAXPATHLEN.
+ * - ENOENT if pathname was empty or has a nonexistent component.
+ * - ENOTDIR if not a directory.
  */
 
-/*
-
-   DESCRIPTION
-	Check for basic errors returned by mount(2) system call.
-
-	Verify that mount(2) returns -1 and sets errno to
-	1) ENODEV if filesystem type not configured
-	2) ENOTBLK if specialfile is not a block device
-	3) EBUSY if specialfile is already mounted or
-		it  cannot  be remounted read-only, because it still holds
-		files open for writing.
-	4) EINVAL if specialfile or device is invalid or
-		 a remount was attempted, while source was not already
-		 mounted on target.
-	5) EFAULT if specialfile or device file points to invalid address space.
-	6) ENAMETOOLONG if pathname was longer than MAXPATHLEN.
-	7) ENOENT if pathname was empty or has a nonexistent component.
-	8) ENOTDIR if not a directory.
-*/
-
-#include <errno.h>
+#include "tst_test.h"
 #include <sys/mount.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <sys/sysmacros.h>
-#include <fcntl.h>
-#include "test.h"
-#include "safe_macros.h"
 
-static void setup(void);
-static void cleanup(void);
-
-char *TCID = "mount02";
-
-#define DIR_MODE	(S_IRWXU | S_IRUSR | S_IXUSR | S_IRGRP | S_IXGRP)
-#define FILE_MODE	(S_IRWXU | S_IRWXG | S_IRWXO)
+#define MNTPOINT "mntpoint"
+#define TEST_FILE MNTPOINT"/file"
 
 static char path[PATH_MAX + 2];
 static const char *long_path = path;
+static const char *device;
 static const char *fs_type;
+static const char *null;
 static const char *wrong_fs_type = "error";
-static const char *mntpoint = "mntpoint";
-static const char *device;
-static const char *null = NULL;
-static const char *fault = (void*)-1;
+static const char *mntpoint = MNTPOINT;
+static const char *fault;
 static const char *nonexistent = "nonexistent";
 static const char *char_dev = "char_device";
 static const char *file = "filename";
 static int fd;
 
-static void do_umount(void);
-static void close_umount(void);
-static void do_mount(void);
-static void mount_open(void);
+static void pre_mount(void);
+static void post_umount(void);
+static void pre_create_file(void);
+static void post_delete_file(void);
 
 static struct test_case {
 	const char **device;
 	const char **mntpoint;
 	const char **fs_type;
+	const char *desc;
 	unsigned long flag;
 	int exp_errno;
 	void (*setup)(void);
 	void (*cleanup)(void);
-} tc[] = {
-	{&device, &mntpoint, &wrong_fs_type, 0, ENODEV, NULL, NULL},
-	{&char_dev, &mntpoint, &fs_type, 0, ENOTBLK, NULL, NULL},
-	{&device, &mntpoint, &fs_type, 0, EBUSY, do_mount, do_umount},
-	{&device, &mntpoint, &fs_type, MS_REMOUNT | MS_RDONLY, EBUSY,
-	 mount_open, close_umount},
-	{&null, &mntpoint, &fs_type, 0, EINVAL, NULL, NULL},
-	{&device, &mntpoint, &null, 0, EINVAL, NULL, NULL},
-	{&device, &mntpoint, &fs_type, MS_REMOUNT, EINVAL, NULL, NULL},
-	{&fault, &mntpoint, &fs_type, 0, EFAULT, NULL, NULL},
-	{&device, &mntpoint, &fault, 0, EFAULT, NULL, NULL},
-	{&device, &long_path, &fs_type, 0, ENAMETOOLONG, NULL, NULL},
-	{&device, &nonexistent, &fs_type, 0, ENOENT, NULL, NULL},
-	{&device, &file, &fs_type, 0, ENOTDIR, NULL, NULL},
+} test_cases[] = {
+	{.fs_type = &wrong_fs_type, .desc = "wrong FS type", .exp_errno = ENODEV},
+	{.device = &char_dev, .desc = "char device", .exp_errno = ENOTBLK},
+	{.desc = "mounted folder", .exp_errno = EBUSY, .setup = pre_mount, .cleanup = post_umount},
+	{.desc = "mounted folder containing file", .flag = MS_REMOUNT | MS_RDONLY,
+		.exp_errno = EBUSY, .setup = pre_create_file, .cleanup = post_delete_file},
+	{.device = &null, .desc = "invalid device", .exp_errno = EINVAL},
+	{.fs_type = &null, .desc = "invalid device type", .exp_errno = EINVAL},
+	{.desc = "mounted folder", .flag = MS_REMOUNT, .exp_errno = EINVAL},
+	{.device = &fault, .desc = "fault device", .exp_errno = EFAULT},
+	{.fs_type = &fault, .desc = "fault device type", .exp_errno = EFAULT},
+	{.mntpoint = &long_path, .desc = "long name", .exp_errno = ENAMETOOLONG},
+	{.mntpoint = &nonexistent, .desc = "non existant folder", .exp_errno = ENOENT},
+	{.device = &device, .mntpoint = &file, .desc = "file", .exp_errno = ENOTDIR},
 };
 
-int TST_TOTAL = ARRAY_SIZE(tc);
-
-static void verify_mount(struct test_case *tc)
-{
-	if (tc->setup)
-		tc->setup();
-
-	TEST(mount(*tc->device, *tc->mntpoint, *tc->fs_type, tc->flag, NULL));
-
-	if (TEST_RETURN != -1) {
-		tst_resm(TFAIL, "mount() succeded unexpectedly (ret=%li)",
-		         TEST_RETURN);
-		goto cleanup;
-	}
-
-	if (TEST_ERRNO != tc->exp_errno) {
-		tst_resm(TFAIL | TTERRNO,
-		         "mount() was expected to fail with %s(%i)",
-		         tst_strerrno(tc->exp_errno), tc->exp_errno);
-		goto cleanup;
-	}
-
-	tst_resm(TPASS | TTERRNO, "mount() failed expectedly");
-
-cleanup:
-	if (tc->cleanup)
-		tc->cleanup();
-}
-
-int main(int ac, char **av)
-{
-	int lc, i;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-
-		for (i = 0; i < TST_TOTAL; ++i)
-			verify_mount(tc + i);
-	}
-
-	cleanup();
-	tst_exit();
-}
-
-static void do_mount(void)
+static void pre_mount(void)
 {
-	if (mount(device, mntpoint, fs_type, 0, NULL))
-		tst_brkm(TBROK | TERRNO, cleanup, "Failed to mount(mntpoint)");
+	SAFE_MOUNT(device, mntpoint, fs_type, 0, NULL);
 }
 
-static void mount_open(void)
+static void post_umount(void)
 {
-	do_mount();
-
-	fd = SAFE_OPEN(cleanup, "mntpoint/file", O_CREAT | O_RDWR, S_IRWXU);
+	if (tst_is_mounted(MNTPOINT))
+		SAFE_UMOUNT(MNTPOINT);
 }
 
-static void close_umount(void)
+static void pre_create_file(void)
 {
-	SAFE_CLOSE(cleanup, fd);
-	do_umount();
+	pre_mount();
+	fd = SAFE_OPEN(TEST_FILE, O_CREAT | O_RDWR, 0700);
 }
 
-static void do_umount(void)
+static void post_delete_file(void)
 {
-	if (tst_umount(mntpoint))
-		tst_brkm(TBROK | TERRNO, cleanup, "Failed to umount(mntpoint)");
+	SAFE_CLOSE(fd);
+	post_umount();
 }
 
 static void setup(void)
 {
-	dev_t dev;
+	fault = tst_get_bad_addr(NULL);
 
-	tst_sig(FORK, DEF_HANDLER, cleanup);
+	device = tst_device->dev;
+	fs_type = tst_device->fs_type;
 
-	tst_require_root();
+	memset(path, 'a', PATH_MAX + 1);
 
-	tst_tmpdir();
+	SAFE_MKNOD(char_dev, S_IFCHR | 0777, 0);
+	SAFE_TOUCH(file, 0777, 0);
+}
 
-	SAFE_TOUCH(cleanup, file, FILE_MODE, NULL);
+static void cleanup(void)
+{
+	if (tst_is_mounted(MNTPOINT))
+		SAFE_UMOUNT(MNTPOINT);
+}
 
-	fs_type = tst_dev_fs_type();
-	device = tst_acquire_device(cleanup);
+static void run(unsigned int i)
+{
+	struct test_case *tc = &test_cases[i];
 
-	if (!device)
-		tst_brkm(TCONF, cleanup, "Failed to obtain block device");
+	if (!tc->device)
+		tc->device = &device;
 
-	tst_mkfs(cleanup, device, fs_type, NULL, NULL);
+	if (!tc->mntpoint)
+		tc->mntpoint = &mntpoint;
 
-	SAFE_MKDIR(cleanup, mntpoint, DIR_MODE);
+	if (!tc->fs_type)
+		tc->fs_type = &fs_type;
 
-	memset(path, 'a', PATH_MAX + 1);
+	if (tc->setup)
+		tc->setup();
 
-	dev = makedev(1, 3);
-	if (mknod(char_dev, S_IFCHR | FILE_MODE, dev)) {
-		tst_brkm(TBROK | TERRNO, cleanup,
-			 "failed to mknod(char_dev, S_IFCHR | FILE_MODE, %lu)",
-			 dev);
-	}
+	TST_EXP_FAIL(mount(*tc->device, *tc->mntpoint, *tc->fs_type, tc->flag, NULL),
+		tc->exp_errno,
+		"mounting %s",
+		tc->desc);
 
-	TEST_PAUSE;
+	if (tc->cleanup)
+		tc->cleanup();
 }
 
-static void cleanup(void)
-{
-	if (device)
-		tst_release_device(device);
-
-	tst_rmdir();
-}
+static struct tst_test test = {
+	.tcnt = ARRAY_SIZE(test_cases),
+	.test = run,
+	.setup = setup,
+	.cleanup = cleanup,
+	.needs_root = 1,
+	.format_device = 1,
+	.mntpoint = MNTPOINT,
+};
diff --git a/testcases/kernel/syscalls/mount/mount03.c b/testcases/kernel/syscalls/mount/mount03.c
index 98d5933b7..c3202574f 100644
--- a/testcases/kernel/syscalls/mount/mount03.c
+++ b/testcases/kernel/syscalls/mount/mount03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Linux Test Project, 2022
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
diff --git a/testcases/kernel/syscalls/mount/mount03_suid_child.c b/testcases/kernel/syscalls/mount/mount03_suid_child.c
index 3b5cf5fe8..40c800efe 100644
--- a/testcases/kernel/syscalls/mount/mount03_suid_child.c
+++ b/testcases/kernel/syscalls/mount/mount03_suid_child.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
  * Copyright (c) 2022 Petr Vorel <pvorel@suse.cz>
diff --git a/testcases/kernel/syscalls/move_pages/move_pages12.c b/testcases/kernel/syscalls/move_pages/move_pages12.c
index fd7017d79..dd2764b42 100644
--- a/testcases/kernel/syscalls/move_pages/move_pages12.c
+++ b/testcases/kernel/syscalls/move_pages/move_pages12.c
@@ -154,6 +154,8 @@ static void do_test(unsigned int n)
 	pid_t cpid = -1;
 	int status;
 
+	SAFE_FILE_PRINTF("/proc/sys/vm/compact_memory", "1");
+
 	addr = SAFE_MMAP(NULL, tcases[n].tpages * hpsz, PROT_READ | PROT_WRITE,
 		MAP_PRIVATE | MAP_ANONYMOUS | MAP_HUGETLB, -1, 0);
 
@@ -269,6 +271,7 @@ static void setup(void)
 	pgsz = (int)get_page_size();
 	SAFE_FILE_LINES_SCANF(PATH_MEMINFO, "Hugepagesize: %d", &hpsz);
 
+	SAFE_FILE_PRINTF("/proc/sys/vm/drop_caches", "3");
 	SAFE_FILE_LINES_SCANF(PATH_MEMINFO, "MemFree: %ld", &memfree);
 	tst_res(TINFO, "Free RAM %ld kB", memfree);
 
diff --git a/testcases/kernel/syscalls/mprotect/mprotect02.c b/testcases/kernel/syscalls/mprotect/mprotect02.c
index af282bba7..de894868f 100644
--- a/testcases/kernel/syscalls/mprotect/mprotect02.c
+++ b/testcases/kernel/syscalls/mprotect/mprotect02.c
@@ -89,7 +89,7 @@ int main(int ac, char **av)
 		addr = SAFE_MMAP(cleanup, 0, sizeof(buf), PROT_READ,
 				 MAP_SHARED, fd, 0);
 
-		if ((pid = FORK_OR_VFORK()) == -1)
+		if ((pid = tst_fork()) == -1)
 			tst_brkm(TBROK | TERRNO, cleanup, "fork #1 failed");
 
 		if (pid == 0) {
@@ -118,7 +118,7 @@ int main(int ac, char **av)
 		TEST(mprotect(addr, sizeof(buf), PROT_WRITE));
 
 		if (TEST_RETURN != -1) {
-			if ((pid = FORK_OR_VFORK()) == -1)
+			if ((pid = tst_fork()) == -1)
 				tst_brkm(TBROK | TERRNO, cleanup,
 					 "fork #2 failed");
 
diff --git a/testcases/kernel/syscalls/mprotect/mprotect03.c b/testcases/kernel/syscalls/mprotect/mprotect03.c
index ed0c1a7de..8ef64f212 100644
--- a/testcases/kernel/syscalls/mprotect/mprotect03.c
+++ b/testcases/kernel/syscalls/mprotect/mprotect03.c
@@ -95,7 +95,7 @@ int main(int ac, char **av)
 		TEST(mprotect(addr, strlen(buf), PROT_READ));
 
 		if (TEST_RETURN != -1) {
-			if ((pid = FORK_OR_VFORK()) == -1) {
+			if ((pid = tst_fork()) == -1) {
 				tst_brkm(TBROK, cleanup, "fork failed");
 			}
 
diff --git a/testcases/kernel/syscalls/mremap/mremap06.c b/testcases/kernel/syscalls/mremap/mremap06.c
index 3bbaf441a..d18da199b 100644
--- a/testcases/kernel/syscalls/mremap/mremap06.c
+++ b/testcases/kernel/syscalls/mremap/mremap06.c
@@ -104,8 +104,13 @@ static void setup(void)
 	fd = SAFE_OPEN("testfile", O_CREAT | O_RDWR | O_TRUNC, 0600);
 
 	ret = fallocate(fd, 0, 0, mmap_size);
-	if (ret == -1)
+	if (ret != 0) {
+		if (tst_fs_type(".") == TST_NFS_MAGIC && (errno == EOPNOTSUPP ||
+							  errno == ENOSYS)) {
+			tst_brk(TCONF, "fallocate system call is not implemented");
+		}
 		tst_brk(TBROK, "fallocate() failed");
+	}
 
 	buf = SAFE_MMAP(0, mmap_size, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);
 
diff --git a/testcases/kernel/syscalls/msync/msync04.c b/testcases/kernel/syscalls/msync/msync04.c
index 72ddc27a4..645201ee5 100644
--- a/testcases/kernel/syscalls/msync/msync04.c
+++ b/testcases/kernel/syscalls/msync/msync04.c
@@ -13,6 +13,7 @@
 
 #include <errno.h>
 #include "tst_test.h"
+#include "pgsize_helpers.h"
 
 static int test_fd;
 static char *mmaped_area;
@@ -27,7 +28,7 @@ uint64_t get_dirty_bit(void *data)
 	uint64_t pagemap_entry, pageflag_entry, pfn, index;
 
 	addr = (unsigned long)data;
-	index = (addr / pagesize) * sizeof(uint64_t);
+	index = (addr / kernel_page_size()) * sizeof(uint64_t);
 	pagemap_fd = SAFE_OPEN("/proc/self/pagemap", O_RDONLY);
 	SAFE_LSEEK(pagemap_fd, index, SEEK_SET);
 	SAFE_READ(1, pagemap_fd, &pagemap_entry, sizeof(pagemap_entry));
diff --git a/testcases/kernel/syscalls/munlock/munlock01.c b/testcases/kernel/syscalls/munlock/munlock01.c
index 31d749e66..65a49d7ee 100644
--- a/testcases/kernel/syscalls/munlock/munlock01.c
+++ b/testcases/kernel/syscalls/munlock/munlock01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
  * AUTHOR: Nirmala Devi Dhanasekar <nirmala.devi@wipro.com>
diff --git a/testcases/kernel/syscalls/munlock/munlock02.c b/testcases/kernel/syscalls/munlock/munlock02.c
index f51c3d21f..55e313c95 100644
--- a/testcases/kernel/syscalls/munlock/munlock02.c
+++ b/testcases/kernel/syscalls/munlock/munlock02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
  * AUTHOR: Nirmala Devi Dhanasekar <nirmala.devi@wipro.com>
diff --git a/testcases/kernel/syscalls/munlockall/munlockall01.c b/testcases/kernel/syscalls/munlockall/munlockall01.c
index 51f731b65..86469107e 100644
--- a/testcases/kernel/syscalls/munlockall/munlockall01.c
+++ b/testcases/kernel/syscalls/munlockall/munlockall01.c
@@ -1,134 +1,46 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
- *
- * This program is free software; you can redistribute it and/or modify it
- * under the terms of version 2 of the GNU General Public License as
- * published by the Free Software Foundation.
- *
- * This program is distributed in the hope that it would be useful, but
- * WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
- *
- * You should have received a copy of the GNU General Public License along
- * with this program; if not, write the Free Software Foundation, Inc.,
- * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
- *
+ * Copyright Red Hat
+ * Author: Dennis Brendel <dbrendel@redhat.com>
  */
-/**************************************************************************
- *
- *    TEST IDENTIFIER	: munlockall01
- *
- *    EXECUTED BY	: root / superuser
- *
- *    TEST TITLE	: Basic test for munlockall(2)
- *
- *    TEST CASE TOTAL	: 1
- *
- *    AUTHOR		: sowmya adiga<sowmya.adiga@wipro.com>
- *
- *    SIGNALS
- * 	Uses SIGUSR1 to pause before test if option set.
- * 	(See the parse_opts(3) man page).
- *
- *    DESCRIPTION
- *	This is a phase I test for the munlockall(2) system call.
- *	It is intended to provide a limited exposure of the system call.
- *
- * 	Setup:
- *	  Setup signal handling.
- *	  Pause for SIGUSR1 if option specified.
- *
- * 	Test:
- *        Execute system call
- *	  Check return code, if system call failed (return=-1)
- *	  Log the errno and Issue a FAIL message.
- *	  Otherwise, Issue a PASS message.
- *
- * 	Cleanup:
- * 	  Print errno log and/or timing stats if options given
- *
- * USAGE:  <for command-line>
- *  munlockall01 [-c n] [-e] [-i n] [-I x] [-p x] [-t]
- *		where,		-c n : Run n copies concurrently
- *	               		-e   : Turn on errno logging.
- *				-h   : Show this help screen
- *				-i n : Execute test n times.
- *				-I x : Execute test for x seconds.
- *				-p   : Pause for SIGUSR1 before starting
- *                      	-P x : Pause for x seconds between iterations.
- *                       	 t   : Turn on syscall timing.
- *
- * RESTRICTIONS
- * Must be root/superuser to run it.
- *****************************************************************************/
-#include <errno.h>
-#include <sys/mman.h>
-#include "test.h"
 
-void setup();
-void cleanup();
+/*\
+ * [Description]
+ *
+ * Verify that munlockall(2) unlocks all previously locked memory.
+ */
 
-char *TCID = "munlockall01";
-int TST_TOTAL = 1;
+#include <sys/mman.h>
 
-#if !defined(UCLINUX)
+#include "tst_test.h"
 
-int main(int ac, char **av)
+static void verify_munlockall(void)
 {
-	int lc;
-
-	tst_parse_opts(ac, av, NULL, NULL);
+	unsigned long size = 0;
 
-	setup();
+	SAFE_FILE_LINES_SCANF("/proc/self/status", "VmLck: %ld", &size);
 
-	/* check looping state */
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
+	if (size != 0UL)
+		tst_brk(TBROK, "Locked memory after init should be 0 but is %ld", size);
 
-		tst_count = 0;
+	if (mlockall(MCL_CURRENT | MCL_FUTURE) != 0)
+		tst_brk(TBROK | TERRNO, "Could not lock memory using mlockall()");
 
-		TEST(munlockall());
+	SAFE_FILE_LINES_SCANF("/proc/self/status", "VmLck: %ld", &size);
 
-		/* check return code */
-		if (TEST_RETURN == -1) {
-			tst_resm(TFAIL | TTERRNO, "munlockall() Failed with"
-				 " return=%ld", TEST_RETURN);
-		} else {
-			tst_resm(TPASS, "munlockall() passed with"
-				 " return=%ld ", TEST_RETURN);
+	if (size == 0UL)
+		tst_brk(TBROK, "Locked memory after mlockall() should be > 0");
 
-		}
-	}
+	TST_EXP_PASS(munlockall(), "Unlock memory using munlockall()");
 
-	/* cleanup and exit */
-	cleanup();
-	tst_exit();
+	SAFE_FILE_LINES_SCANF("/proc/self/status", "VmLck: %ld", &size);
 
+	if (size != 0UL)
+		tst_res(TFAIL, "Locked memory after munlockall() should be 0 but is %ld", size);
+	else
+		tst_res(TPASS, "Memory successfully locked and unlocked");
 }
 
-#else
-
-int main(void)
-{
-	tst_resm(TINFO, "test is not available on uClinux");
-	tst_exit();
-}
-
-#endif /* if !defined(UCLINUX) */
-
-/* setup() - performs all ONE TIME setup for this test. */
-void setup(void)
-{
-	tst_require_root();
-
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-}
-
-/*
- * cleanup() - performs all ONE TIME cleanup for this test at
- *		completion or premature exit.
- */
-void cleanup(void)
-{
-}
+static struct tst_test test = {
+	.test_all = verify_munlockall,
+};
diff --git a/testcases/kernel/syscalls/munmap/munmap01.c b/testcases/kernel/syscalls/munmap/munmap01.c
index 7d10c0eac..dfd81fa2b 100644
--- a/testcases/kernel/syscalls/munmap/munmap01.c
+++ b/testcases/kernel/syscalls/munmap/munmap01.c
@@ -114,13 +114,7 @@ int main(int ac, char **av)
 				 TEST_ERRNO, strerror(TEST_ERRNO));
 			continue;
 		}
-#ifdef UCLINUX
-		/*
-		 * No SIGSEGV on uClinux since
-		 * MMU not implemented on uClinux
-		 */
-		tst_resm(TPASS, "call succedded");
-#else
+
 		/*
 		 * Check whether further reference is possible
 		 * to the unmapped memory region by writing
@@ -130,9 +124,7 @@ int main(int ac, char **av)
 		*addr = 50;
 
 		/* This message is printed if no SIGSEGV */
-		tst_resm(TFAIL, "process succeeds to refer unmapped "
-			 "memory region");
-#endif
+		tst_resm(TFAIL, "process succeeds to refer unmapped memory region");
 
 		cleanup();
 
@@ -195,14 +187,8 @@ void setup(void)
 	 * into the calling process's address space at the system choosen
 	 * with read/write permissions to the mapped region.
 	 */
-#ifdef UCLINUX
-	/* MAP_SHARED is not implemented on uClinux */
-	addr = mmap(0, map_len, PROT_READ | PROT_WRITE,
-		    MAP_FILE | MAP_PRIVATE, fildes, 0);
-#else
 	addr = mmap(0, map_len, PROT_READ | PROT_WRITE,
 		    MAP_FILE | MAP_SHARED, fildes, 0);
-#endif
 
 	/* check for the return value of mmap system call */
 	if (addr == (char *)MAP_FAILED) {
diff --git a/testcases/kernel/syscalls/munmap/munmap02.c b/testcases/kernel/syscalls/munmap/munmap02.c
index cd85d9436..311c0ea14 100644
--- a/testcases/kernel/syscalls/munmap/munmap02.c
+++ b/testcases/kernel/syscalls/munmap/munmap02.c
@@ -92,8 +92,6 @@ void setup();			/* Main setup function of test */
 void cleanup();			/* cleanup function for the test */
 void sig_handler();		/* signal catching function */
 
-#ifndef UCLINUX
-
 int main(int ac, char **av)
 {
 	int lc;
@@ -136,16 +134,6 @@ int main(int ac, char **av)
 	tst_exit();
 }
 
-#else
-
-int main(void)
-{
-	tst_resm(TINFO, "munmap02 test is not available on uClinux");
-	tst_exit();
-}
-
-#endif /* ifndef UCLINUX */
-
 /*
  * setup() - performs all ONE TIME setup for this test.
  * Setup signal handler to catch SIGSEGV.
@@ -199,14 +187,8 @@ void setup(void)
 	 * into the calling process's address space at the system choosen
 	 * with read/write permissions to the mapped region.
 	 */
-#ifdef UCLINUX
-	/* mmap() doesn't support MAP_SHARED on uClinux */
-	addr = mmap(0, map_len, PROT_READ | PROT_WRITE,
-		    MAP_FILE | MAP_PRIVATE, fildes, 0);
-#else
 	addr = mmap(0, map_len, PROT_READ | PROT_WRITE,
 		    MAP_FILE | MAP_SHARED, fildes, 0);
-#endif
 
 	/* check for the return value of mmap system call */
 	if (addr == (char *)MAP_FAILED) {
diff --git a/testcases/kernel/syscalls/munmap/munmap03.c b/testcases/kernel/syscalls/munmap/munmap03.c
index 23875e7b3..60bcb93b0 100644
--- a/testcases/kernel/syscalls/munmap/munmap03.c
+++ b/testcases/kernel/syscalls/munmap/munmap03.c
@@ -87,8 +87,7 @@ static void setup(void)
 
 	global_maplen = page_sz * 2;
 	global_addr = SAFE_MMAP(cleanup, NULL, global_maplen, PROT_READ |
-				PROT_WRITE, MAP_PRIVATE_EXCEPT_UCLINUX |
-				MAP_ANONYMOUS, -1, 0);
+				PROT_WRITE, MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);
 }
 
 static void check_and_print(int expected_errno)
diff --git a/testcases/kernel/syscalls/open/open07.c b/testcases/kernel/syscalls/open/open07.c
index f36db00cb..0c53798e3 100644
--- a/testcases/kernel/syscalls/open/open07.c
+++ b/testcases/kernel/syscalls/open/open07.c
@@ -1,249 +1,76 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2001
+ *	07/2001 Ported by Wayne Boyer
+ * Copyright (c) 2024 SUSE LLC <mdoucha@suse.cz>
  */
 
-/*
- * NAME
- *	open07.c
- *
- * DESCRIPTION
- *	Test the open(2) system call to ensure that it sets ELOOP correctly.
- *
- * CALLS
- *	open()
- *
- * ALGORITHM
- *	1. Create a symbolic link to a file, and call open(O_NOFOLLOW). Check
- *	   that it returns ELOOP.
+/*\
+ * [Description]
  *
- *	2. Create a symbolic link to a directory, and call open(O_NOFOLLOW).
- *	   Check that it returns ELOOP.
- *
- *	3. Create a symbolic link to a symbolic link, and call open(O_NOFOLLOW).
- *	   Check that it returns ELOOP.
- *
- *	4. Create a symbolic link to a symbolically linked directory, and call
- *	   open(O_NOFOLLOW). Check that it returns ELOOP.
- *
- *	5. Create a symbolic link to a directory, and call
- *         open("link/", O_NOFOLLOW). Check that it succeeds.
- *
- * USAGE:  <for command-line>
- *  open07 [-c n] [-e] [-i n] [-I x] [-P x] [-t]
- *     where,  -c n : Run n copies concurrently.
- *             -e   : Turn on errno logging.
- *             -i n : Execute test n times.
- *             -I x : Execute test for x seconds.
- *             -P x : Pause for x seconds between iterations.
- *             -t   : Turn on syscall timing.
- *
- * HISTORY
- *	07/2001 Ported by Wayne Boyer
- *
- * RESTRICTIONS
- *	None
+ * Test functionality and error conditions of open(O_NOFOLLOW) system call.
  */
-#define _GNU_SOURCE		/* for O_NOFOLLOW */
-#include <stdio.h>
-#include <errno.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <fcntl.h>
-#include "test.h"
-#include "safe_macros.h"
-
-static void setup(void);
-static void cleanup(void);
-static void setupfunc_test1();
-static void setupfunc_test2();
-static void setupfunc_test3();
-static void setupfunc_test4();
-static void setupfunc_test5();
-
-char *TCID = "open07";
-int TST_TOTAL = 5;
 
-static int fd1, fd2;
-
-static struct test_case_t {
-	char *desc;
-	char filename[100];
-	int flags;
-	int mode;
-	void (*setupfunc) ();
-	int exp_errno;
-} TC[] = {
-	{"Test for ELOOP on f2: f1 -> f2", {},
-	 O_NOFOLLOW, 00700, setupfunc_test1, ELOOP},
-	{"Test for ELOOP on d2: d1 -> d2", {},
-	 O_NOFOLLOW, 00700, setupfunc_test2, ELOOP},
-	{"Test for ELOOP on f3: f1 -> f2 -> f3", {},
-	 O_NOFOLLOW, 00700, setupfunc_test3, ELOOP},
-	{"Test for ELOOP on d3: d1 -> d2 -> d3", {},
-	 O_NOFOLLOW, 00700, setupfunc_test4, ELOOP},
-	{"Test for success on d2: d1 -> d2", {},
-	 O_NOFOLLOW, 00700, setupfunc_test5, 0},
-	{NULL, {}, 0, 0, NULL, 0}
+#include "tst_test.h"
+#include "tst_safe_macros.h"
+
+#define TESTFILE "testfile"
+#define TESTDIR "testdir"
+#define SYMFILE1 "symfile1"
+#define SYMFILE2 "symfile2"
+#define SYMDIR1 "symdir1"
+#define SYMDIR2 "symdir2"
+#define PASSFILE "symdir1/testfile"
+
+static struct testcase {
+	const char *path;
+	int err;
+	const char *desc;
+} testcase_list[] = {
+	{SYMFILE1, ELOOP, "open(O_NOFOLLOW) a symlink to file"},
+	{SYMFILE2, ELOOP, "open(O_NOFOLLOW) a double symlink to file"},
+	{SYMDIR1, ELOOP, "open(O_NOFOLLOW) a symlink to directory"},
+	{SYMDIR2, ELOOP, "open(O_NOFOLLOW) a double symlink to directory"},
+	{PASSFILE, 0, "open(O_NOFOLLOW) a file in symlinked directory"},
 };
 
-int main(int ac, char **av)
-{
-	int lc;
-	int i;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	/* run the setup routines for the individual tests */
-	for (i = 0; i < TST_TOTAL; i++) {
-		if (TC[i].setupfunc != NULL)
-			TC[i].setupfunc();
-	}
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-
-		for (i = 0; TC[i].desc != NULL; ++i) {
-			TEST(open(TC[i].filename, TC[i].flags, TC[i].mode));
-
-			if (TC[i].exp_errno != 0) {
-				if (TEST_RETURN != -1) {
-					tst_resm(TFAIL, "open succeeded "
-						 "unexpectedly");
-				}
-
-				if (TEST_ERRNO != TC[i].exp_errno) {
-					tst_resm(TFAIL, "open returned "
-						 "unexpected errno, expected: "
-						 "%d, got: %d",
-						 TC[i].exp_errno, TEST_ERRNO);
-				} else {
-					tst_resm(TPASS, "open returned "
-						 "expected ELOOP error");
-				}
-			} else {
-				if (TEST_RETURN == -1) {
-					tst_resm(TFAIL, "open failed "
-						 "unexpectedly with errno %d",
-						 TEST_ERRNO);
-				} else {
-					tst_resm(TPASS, "open succeeded as "
-						 "expected");
-				}
-			}
-
-			if (TEST_RETURN != -1)
-				close(TEST_RETURN);
-		}
-	}
-
-	cleanup();
-	tst_exit();
-}
-
-static void setupfunc_test1(void)
-{
-	char file1[100], file2[100];
-
-	sprintf(file1, "open03.1.%d", getpid());
-	sprintf(file2, "open03.2.%d", getpid());
-	fd1 = SAFE_CREAT(cleanup, file1, 00700);
-
-	SAFE_SYMLINK(cleanup, file1, file2);
-
-	strcpy(TC[0].filename, file2);
-}
-
-static void setupfunc_test2(void)
-{
-	char file1[100], file2[100];
-
-	sprintf(file1, "open03.3.%d", getpid());
-	sprintf(file2, "open03.4.%d", getpid());
-	SAFE_MKDIR(cleanup, file1, 00700);
-
-	SAFE_SYMLINK(cleanup, file1, file2);
-
-	strcpy(TC[1].filename, file2);
-}
-
-static void setupfunc_test3(void)
-{
-	char file1[100], file2[100], file3[100];
-
-	sprintf(file1, "open03.5.%d", getpid());
-	sprintf(file2, "open03.6.%d", getpid());
-	sprintf(file3, "open03.7.%d", getpid());
-	fd2 = SAFE_CREAT(cleanup, file1, 00700);
-
-	SAFE_SYMLINK(cleanup, file1, file2);
-
-	SAFE_SYMLINK(cleanup, file2, file3);
-
-	strcpy(TC[2].filename, file3);
-}
-
-static void setupfunc_test4(void)
-{
-	char file1[100], file2[100], file3[100];
-
-	sprintf(file1, "open03.8.%d", getpid());
-	sprintf(file2, "open03.9.%d", getpid());
-	sprintf(file3, "open03.10.%d", getpid());
-	SAFE_MKDIR(cleanup, file1, 00700);
-
-	SAFE_SYMLINK(cleanup, file1, file2);
-
-	SAFE_SYMLINK(cleanup, file2, file3);
-
-	strcpy(TC[3].filename, file3);
-}
-
-static void setupfunc_test5(void)
-{
-	char file1[100], file2[100];
-
-	sprintf(file1, "open11.3.%d", getpid());
-	sprintf(file2, "open12.4.%d", getpid());
-	SAFE_MKDIR(cleanup, file1, 00700);
-
-	SAFE_SYMLINK(cleanup, file1, file2);
-
-	strcpy(TC[4].filename, file2);
-	strcat(TC[4].filename, "/");
-}
-
 static void setup(void)
 {
-	umask(0);
+	int fd;
 
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
+	umask(0);
+	fd = SAFE_CREAT(TESTFILE, 0644);
+	SAFE_CLOSE(fd);
+	SAFE_MKDIR(TESTDIR, 0755);
 
-	TEST_PAUSE;
+	SAFE_SYMLINK(TESTFILE, SYMFILE1);
+	SAFE_SYMLINK(SYMFILE1, SYMFILE2);
+	SAFE_SYMLINK(TESTDIR, SYMDIR1);
+	SAFE_SYMLINK(SYMDIR1, SYMDIR2);
 
-	tst_tmpdir();
+	fd = SAFE_CREAT(PASSFILE, 0644);
+	SAFE_CLOSE(fd);
 }
 
-static void cleanup(void)
+static void run(unsigned int n)
 {
-	close(fd1);
-	close(fd2);
+	const struct testcase *tc = testcase_list + n;
+
+	if (tc->err) {
+		TST_EXP_FAIL2(open(tc->path, O_NOFOLLOW | O_RDONLY), tc->err,
+			"%s", tc->desc);
+	} else {
+		TST_EXP_FD(open(tc->path, O_NOFOLLOW | O_RDONLY),
+			"%s", tc->desc);
+	}
 
-	tst_rmdir();
+	if (TST_RET >= 0)
+		SAFE_CLOSE(TST_RET);
 }
+
+static struct tst_test test = {
+	.setup = setup,
+	.test = run,
+	.tcnt = ARRAY_SIZE(testcase_list),
+	.needs_tmpdir = 1
+};
diff --git a/testcases/kernel/syscalls/open/open09.c b/testcases/kernel/syscalls/open/open09.c
index 331ce0f6c..0e89a87f8 100644
--- a/testcases/kernel/syscalls/open/open09.c
+++ b/testcases/kernel/syscalls/open/open09.c
@@ -1,109 +1,45 @@
-/*
- *   Copyright (c) International Business Machines  Corp., 2002
- *   Copyright (c) 2013 Wanlong Gao <gaowanlong@cn.fujitsu.com>
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- */
+// SPDX-License-Identifier: GPL-2.0-or-later
 
 /*
- * Description:
- *	1. open an O_WRONLY file, test if read failed.
- *	2. open an O_RDONLY file, test if write failed.
+ * Copyright (c) International Business Machines  Corp., 2002
+ * Copyright (c) 2013 Wanlong Gao <gaowanlong@cn.fujitsu.com>
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <stdio.h>
-#include <fcntl.h>
-#include "test.h"
-
-char *TCID = "open09";
-int TST_TOTAL = 2;
-
-#define PASSED 1
-#define FAILED 0
+/*\
+ * [Description]
+ *
+ * This test verifies that a file opened with O_RDONLY can't be writable
+ * and it verifies that a file opened with O_WRONLY can't be readable.
+ */
 
-static char tempfile[40] = "";
+#include "tst_test.h"
 
-static void setup(void);
-static void cleanup(void);
+#define TEMPFILE "testfile"
 
-int main(int ac, char *av[])
+static void setup(void)
 {
-	int fildes;
-	int ret = 0;
-	char pbuf[BUFSIZ];
-
-	int lc;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-
-		fildes = open(tempfile, O_WRONLY);
-		if (fildes == -1)
-			tst_brkm(TFAIL, cleanup, "\t\t\topen failed");
-
-		ret = read(fildes, pbuf, 1);
-		if (ret != -1)
-			tst_resm(TFAIL, "read should not succeed");
-		else
-			tst_resm(TPASS, "Test passed in O_WRONLY.");
-
-		close(fildes);
-
-		fildes = open(tempfile, O_RDONLY);
-		if (fildes == -1) {
-			tst_resm(TFAIL, "\t\t\topen failed");
-		} else {
-			ret = write(fildes, pbuf, 1);
-			if (ret != -1)
-				tst_resm(TFAIL, "write should not succeed");
-			else
-				tst_resm(TPASS, "Test passed in O_RDONLY.");
-		}
-		close(fildes);
-	}
-
-	cleanup();
-	tst_exit();
+	SAFE_CREAT(TEMPFILE, 0600);
 }
 
-static void setup(void)
+static void verify_open(unsigned int nr)
 {
-	int fildes;
-
-	tst_sig(NOFORK, DEF_HANDLER, cleanup);
-	TEST_PAUSE;
-	tst_tmpdir();
-
-	sprintf(tempfile, "open09.%d", getpid());
+	char pbuf[BUFSIZ];
+	int fd = 0;
 
-	fildes = creat(tempfile, 0600);
-	if (fildes == -1) {
-		tst_brkm(TBROK, cleanup, "\t\t\tcan't create '%s'",
-			 tempfile);
+	if (nr == 0) {
+		fd = SAFE_OPEN(TEMPFILE, O_RDONLY);
+		TST_EXP_FAIL(write(fd, pbuf, 1), EBADF);
 	} else {
-		close(fildes);
+		fd = SAFE_OPEN(TEMPFILE, O_WRONLY);
+		TST_EXP_FAIL(read(fd, pbuf, 1), EBADF);
 	}
+	SAFE_CLOSE(fd);
 }
 
-static void cleanup(void)
-{
-	unlink(tempfile);
-	tst_rmdir();
-}
+static struct tst_test test = {
+	.setup = setup,
+	.test = verify_open,
+	.tcnt = 2,
+	.needs_tmpdir = 1,
+};
diff --git a/testcases/kernel/syscalls/pause/pause02.c b/testcases/kernel/syscalls/pause/pause02.c
index 32b41bd7d..0853232fd 100644
--- a/testcases/kernel/syscalls/pause/pause02.c
+++ b/testcases/kernel/syscalls/pause/pause02.c
@@ -45,27 +45,18 @@ int main(int ac, char **av)
 
 	tst_parse_opts(ac, av, NULL, NULL);
 
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "");
-#endif
-
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); lc++) {
 		tst_count = 0;
 
-		cpid = FORK_OR_VFORK();
+		cpid = tst_fork();
 		switch (cpid) {
 		case -1:
 			tst_brkm(TBROK, cleanup, "fork() failed");
 		break;
 		case 0:
-#ifdef UCLINUX
-			if (self_exec(av[0], "") < 0)
-				tst_brkm(TBROK, cleanup, "self_exec failed");
-#else
 			do_child();
-#endif
 		break;
 		default:
 		break;
diff --git a/testcases/kernel/syscalls/pause/pause03.c b/testcases/kernel/syscalls/pause/pause03.c
index b1503fc5c..459222045 100644
--- a/testcases/kernel/syscalls/pause/pause03.c
+++ b/testcases/kernel/syscalls/pause/pause03.c
@@ -44,26 +44,17 @@ int main(int ac, char **av)
 	int status;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "");
-#endif
 
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); lc++) {
 		tst_count = 0;
 
-		if ((cpid = FORK_OR_VFORK()) == -1)
+		if ((cpid = tst_fork()) == -1)
 			tst_brkm(TBROK | TERRNO, NULL, "fork() failed");
 
-		if (cpid == 0) {
-#ifdef UCLINUX
-			if (self_exec(av[0], "") < 0)
-				tst_brkm(TBROK, cleanup, "self_exec failed");
-#else
+		if (cpid == 0)
 			do_child();
-#endif
-		}
 
 		TST_PROCESS_STATE_WAIT(cleanup, cpid, 'S');
 
diff --git a/testcases/kernel/syscalls/pipe/pipe02.c b/testcases/kernel/syscalls/pipe/pipe02.c
index 2247037b1..d6cbff92d 100644
--- a/testcases/kernel/syscalls/pipe/pipe02.c
+++ b/testcases/kernel/syscalls/pipe/pipe02.c
@@ -41,10 +41,6 @@ static void verify_pipe(void)
 
 	memset(wrbuf, 'a', SIZE);
 
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "dd", &fd[0], &fd[1]);
-#endif
-
 	TEST(pipe(fd));
 	if (TST_RET == -1) {
 		tst_res(TFAIL|TTERRNO, "pipe() failed");
@@ -53,12 +49,7 @@ static void verify_pipe(void)
 
 	pid = SAFE_FORK();
 	if (pid == 0) {
-#ifdef UCLINUX
-		if (self_exec(av[0], "dd", fd[0], fd[1]) < 0)
-			tst_brk(TBROK, "self_exec failed");
-#else
 		do_child();
-#endif
 	}
 
 	memset(rdbuf, 0, SIZE);
diff --git a/testcases/kernel/syscalls/pipe/pipe04.c b/testcases/kernel/syscalls/pipe/pipe04.c
index a3c56e337..219daecd8 100644
--- a/testcases/kernel/syscalls/pipe/pipe04.c
+++ b/testcases/kernel/syscalls/pipe/pipe04.c
@@ -84,11 +84,6 @@ int main(int ac, char **av)
 	char rbuf[BUFSIZ];
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&c1func, "ndd", 1, &fildes[0], &fildes[1]);
-	maybe_run_child(&c2func, "ndd", 2, &fildes[0], &fildes[1]);
-#endif
-
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); lc++) {
@@ -98,30 +93,16 @@ int main(int ac, char **av)
 
 		SAFE_PIPE(cleanup, fildes);
 
-		if ((c1pid = FORK_OR_VFORK()) == -1)
+		if ((c1pid = tst_fork()) == -1)
 			tst_brkm(TBROK, cleanup, "fork() failed - "
 				 "errno %d", errno);
 		if (c1pid == 0)
-#ifdef UCLINUX
-			if (self_exec(av[0], "ndd", 1, fildes[0], fildes[1]) <
-			    0) {
-				tst_brkm(TBROK, cleanup, "self_exec failed");
-			}
-#else
 			c1func();
-#endif
-		if ((c2pid = FORK_OR_VFORK()) == -1)
+		if ((c2pid = tst_fork()) == -1)
 			tst_brkm(TBROK, cleanup, "fork() failed - "
 				 "errno %d", errno);
 		if (c2pid == 0)
-#ifdef UCLINUX
-			if (self_exec(av[0], "ndd", 2, fildes[0], fildes[1]) <
-			    0) {
-				tst_brkm(TBROK, cleanup, "self_exec failed");
-			}
-#else
 			c2func();
-#endif
 
 		/* PARENT */
 		if (close(fildes[1]) == -1)
diff --git a/testcases/kernel/syscalls/pipe/pipe09.c b/testcases/kernel/syscalls/pipe/pipe09.c
index a4b2f8231..86282de49 100644
--- a/testcases/kernel/syscalls/pipe/pipe09.c
+++ b/testcases/kernel/syscalls/pipe/pipe09.c
@@ -98,7 +98,7 @@ int main(int ac, char **av)
 			continue;
 		}
 
-		if ((fork_1 = FORK_OR_VFORK()) == -1) {
+		if ((fork_1 = tst_fork()) == -1) {
 			tst_brkm(TBROK, cleanup, "fork() #1 failed");
 		}
 
@@ -125,7 +125,7 @@ int main(int ac, char **av)
 			tst_brkm(TBROK, cleanup, "child exited abnormally");
 		}
 
-		if ((fork_2 = FORK_OR_VFORK()) == -1) {
+		if ((fork_2 = tst_fork()) == -1) {
 			tst_brkm(TBROK, cleanup, "fork() #2 failed");
 		}
 
diff --git a/testcases/kernel/syscalls/pipe/pipe15.c b/testcases/kernel/syscalls/pipe/pipe15.c
index c85ad1820..ebdb195b3 100644
--- a/testcases/kernel/syscalls/pipe/pipe15.c
+++ b/testcases/kernel/syscalls/pipe/pipe15.c
@@ -48,6 +48,7 @@ static void setup(void)
 
 	SAFE_PIPE(pipe);
 	const int buffer_size = SAFE_FCNTL(pipe[1], F_GETPIPE_SZ);
+
 	SAFE_CLOSE(pipe[0]);
 	SAFE_CLOSE(pipe[1]);
 
@@ -59,8 +60,9 @@ static void setup(void)
 	tst_res(TINFO, "Creating %i pipes", pipe_count);
 
 	SAFE_GETRLIMIT(RLIMIT_NOFILE, &nfd);
-	if (nfd.rlim_max < (unsigned long)pipe_count)
+	if (nfd.rlim_max < (unsigned long)pipe_count * 2 + 3)
 		tst_brk(TCONF, "NOFILE limit max too low: %lu < %i", nfd.rlim_max, pipe_count);
+
 	if (nfd.rlim_cur < nfd.rlim_max) {
 		nfd.rlim_cur = nfd.rlim_max;
 		SAFE_SETRLIMIT(RLIMIT_NOFILE, &nfd);
@@ -75,11 +77,14 @@ static void setup(void)
 
 static void cleanup(void)
 {
-	for (int i = 0; i < pipe_count * 2; i++)
-		if (pipes[i] > 0)
-			SAFE_CLOSE(pipes[i]);
-	if (pipes)
+	if (pipes) {
+		for (int i = 0; i < pipe_count * 2; i++) {
+			if (pipes[i] > 0)
+				SAFE_CLOSE(pipes[i]);
+		}
 		free(pipes);
+	}
+
 	if (buffer)
 		free(buffer);
 }
diff --git a/testcases/kernel/syscalls/pipe2/pipe2_04.c b/testcases/kernel/syscalls/pipe2/pipe2_04.c
index 3911f95b4..40ab005cf 100644
--- a/testcases/kernel/syscalls/pipe2/pipe2_04.c
+++ b/testcases/kernel/syscalls/pipe2/pipe2_04.c
@@ -15,6 +15,7 @@
 #include <stdio.h>
 #include "lapi/fcntl.h"
 #include "tst_test.h"
+#include "pgsize_helpers.h"
 
 static int fds[2];
 static int flags;
@@ -61,7 +62,7 @@ static void setup(void)
 	char *write_buffer;
 
 	SAFE_PIPE2(fds, O_NONBLOCK);
-	page_size = SAFE_SYSCONF(_SC_PAGESIZE);
+	page_size = kernel_page_size();
 
 	flags = SAFE_FCNTL(fds[1], F_GETFL);
 	if (!(flags & O_NONBLOCK))
diff --git a/testcases/kernel/syscalls/ptrace/ptrace01.c b/testcases/kernel/syscalls/ptrace/ptrace01.c
index 53ddfb393..18b00ebfd 100644
--- a/testcases/kernel/syscalls/ptrace/ptrace01.c
+++ b/testcases/kernel/syscalls/ptrace/ptrace01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
  * Copyright (c) 2019 SUSE LLC
diff --git a/testcases/kernel/syscalls/ptrace/ptrace08.c b/testcases/kernel/syscalls/ptrace/ptrace08.c
index d17d6b411..754ab23ab 100644
--- a/testcases/kernel/syscalls/ptrace/ptrace08.c
+++ b/testcases/kernel/syscalls/ptrace/ptrace08.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2018 Andrew Lutomirski
  * Copyright (C) 2020 SUSE LLC <mdoucha@suse.cz>
diff --git a/testcases/kernel/syscalls/pwritev2/pwritev201.c b/testcases/kernel/syscalls/pwritev2/pwritev201.c
index eba45b7d3..987412ba8 100644
--- a/testcases/kernel/syscalls/pwritev2/pwritev201.c
+++ b/testcases/kernel/syscalls/pwritev2/pwritev201.c
@@ -3,15 +3,18 @@
  * Copyright (c) 2019 FUJITSU LIMITED. All rights reserved.
  * Author: Jinhui Huang <huangjh.jy@cn.fujitsu.com>
  */
-/*
- * Description:
+
+/*\
+ * [Description]
+ *
  * Testcase to check the basic functionality of the pwritev2(2).
- * 1) If the file offset argument is not -1, pwritev2() should succeed
- *    in writing the expected content of data and the file offset is
- *    not changed after writing.
- * 2) If the file offset argument is -1, pwritev2() should succeed in
- *    writing the expected content of data and the current file offset
- *    is used and changed after writing.
+ *
+ * - If the file offset argument is not -1, pwritev2() should succeed
+ *   in writing the expected content of data and the file offset is
+ *   not changed after writing.
+ * - If the file offset argument is -1, pwritev2() should succeed in
+ *   writing the expected content of data and the current file offset
+ *   is used and changed after writing.
  */
 
 #define _GNU_SOURCE
diff --git a/testcases/kernel/syscalls/pwritev2/pwritev202.c b/testcases/kernel/syscalls/pwritev2/pwritev202.c
index b44620ccc..5a1c4c6b6 100644
--- a/testcases/kernel/syscalls/pwritev2/pwritev202.c
+++ b/testcases/kernel/syscalls/pwritev2/pwritev202.c
@@ -3,19 +3,22 @@
  * Copyright (c) 2019 FUJITSU LIMITED. All rights reserved.
  * Author: Jinhui Huang <huangjh.jy@cn.fujitsu.com>
  */
-/*
- * Description:
+
+/*\
+ * [Description]
+ *
  * Check various errnos for pwritev2(2).
- * 1) pwritev2() fails and sets errno to EINVAL if iov_len is invalid.
- * 2) pwritev2() fails and sets errno to EINVAL if the vector count iovcnt is
+ *
+ * - pwritev2() fails and sets errno to EINVAL if iov_len is invalid.
+ * - pwritev2() fails and sets errno to EINVAL if the vector count iovcnt is
  *    less than zero.
- * 3) pwritev2() fails and sets errno to EOPNOTSUPP if flag is invalid.
- * 4) pwritev2() fails and sets errno to EFAULT when writing data from invalid
+ * - pwritev2() fails and sets errno to EOPNOTSUPP if flag is invalid.
+ * - pwritev2() fails and sets errno to EFAULT when writing data from invalid
  *    address.
- * 5) pwritev2() fails and sets errno to EBADF if file descriptor is invalid.
- * 6) pwritev2() fails and sets errno to EBADF if file descriptor is open for
- *    reading.
- * 7) pwritev2() fails and sets errno to ESPIPE if fd is associated with a pipe.
+ * - pwritev2() fails and sets errno to EBADF if file descriptor is invalid.
+ * - pwritev2() fails and sets errno to EBADF if file descriptor is open for
+ *   reading.
+ * - pwritev2() fails and sets errno to ESPIPE if fd is associated with a pipe.
  */
 
 #define _GNU_SOURCE
diff --git a/testcases/kernel/syscalls/read/read02.c b/testcases/kernel/syscalls/read/read02.c
index 9199a95f6..3b4af1643 100644
--- a/testcases/kernel/syscalls/read/read02.c
+++ b/testcases/kernel/syscalls/read/read02.c
@@ -52,9 +52,7 @@ static struct tcase {
 } tcases[] = {
 	{&badfd, &bufaddr, 1, EBADF},
 	{&fd2, &bufaddr, 1, EISDIR},
-#ifndef UCLINUX
 	{&fd3, &outside_buf, 1, EFAULT},
-#endif
 	{&fd4, &addr4, 1, EINVAL},
 	{&fd4, &addr5, 4096, EINVAL},
 };
@@ -98,10 +96,8 @@ static void setup(void)
 
 	fd3 = SAFE_OPEN("test_file", O_RDWR);
 
-#if !defined(UCLINUX)
 	outside_buf = SAFE_MMAP(0, 1, PROT_NONE,
 				MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
-#endif
 
 	addr4 = SAFE_MEMALIGN(getpagesize(), (4096 * 10));
 	addr5 = addr4 + 1;
diff --git a/testcases/kernel/syscalls/readahead/readahead01.c b/testcases/kernel/syscalls/readahead/readahead01.c
index 8ccdcbfbd..aed8e7f31 100644
--- a/testcases/kernel/syscalls/readahead/readahead01.c
+++ b/testcases/kernel/syscalls/readahead/readahead01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (C) 2012 Linux Test Project, Inc.
  * Copyright (C) 2023-2024 Cyril Hrubis <chrubis@suse.cz>
@@ -62,7 +62,7 @@ static void test_invalid_fd(struct tst_fd *fd)
 	int exp_errnos[] = {EBADF, EINVAL, ESPIPE};
 
 	TST_EXP_FAIL_ARR(readahead(fd->fd, 0, getpagesize()), exp_errnos,
-			"readahead() on %s", tst_fd_desc(fd));
+			ARRAY_SIZE(exp_errnos), "readahead() on %s", tst_fd_desc(fd));
 }
 
 static void test_readahead(void)
diff --git a/testcases/kernel/syscalls/readahead/readahead02.c b/testcases/kernel/syscalls/readahead/readahead02.c
index dc03c5931..a109573fe 100644
--- a/testcases/kernel/syscalls/readahead/readahead02.c
+++ b/testcases/kernel/syscalls/readahead/readahead02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) 2012 Linux Test Project, Inc.
  */
diff --git a/testcases/kernel/syscalls/realpath/realpath01.c b/testcases/kernel/syscalls/realpath/realpath01.c
index c0381e9cb..c4c603609 100644
--- a/testcases/kernel/syscalls/realpath/realpath01.c
+++ b/testcases/kernel/syscalls/realpath/realpath01.c
@@ -24,16 +24,7 @@ static void setup(void)
 
 static void run(void)
 {
-	TESTPTR(realpath(".", NULL));
-
-	if (TST_ERR != ENOENT) {
-		tst_res(TFAIL | TTERRNO, "returned unexpected errno");
-	} else	if (TST_RET_PTR != NULL) {
-		tst_res(TFAIL, "syscall didn't return NULL: '%s'",
-				(char *)TST_RET_PTR);
-	} else {
-		tst_res(TPASS, "bug not reproduced");
-	}
+	TST_EXP_FAIL_PTR_NULL(realpath(".", NULL), ENOENT);
 }
 
 static struct tst_test test = {
diff --git a/testcases/kernel/syscalls/reboot/reboot01.c b/testcases/kernel/syscalls/reboot/reboot01.c
index 646ddf61c..098b287b6 100644
--- a/testcases/kernel/syscalls/reboot/reboot01.c
+++ b/testcases/kernel/syscalls/reboot/reboot01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Linux Test Project, 2006-2021
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
diff --git a/testcases/kernel/syscalls/reboot/reboot02.c b/testcases/kernel/syscalls/reboot/reboot02.c
index 671e984dd..2e95fd063 100644
--- a/testcases/kernel/syscalls/reboot/reboot02.c
+++ b/testcases/kernel/syscalls/reboot/reboot02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Linux Test Project, 2009-2021
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
diff --git a/testcases/kernel/syscalls/recv/recv01.c b/testcases/kernel/syscalls/recv/recv01.c
index 2f09864a5..d71243c30 100644
--- a/testcases/kernel/syscalls/recv/recv01.c
+++ b/testcases/kernel/syscalls/recv/recv01.c
@@ -87,13 +87,10 @@ struct test_case_t {		/* test case structure */
 	0, 0, 0, buf, sizeof(buf), 0,
 		    -1, ENOTSOCK, setup0, cleanup0, "invalid socket"}
 	,
-#ifndef UCLINUX
-	    /* Skip since uClinux does not implement memory protection */
 	{
 	PF_INET, SOCK_STREAM, 0, (void *)-1, sizeof(buf), 0,
 		    -1, EFAULT, setup1, cleanup1, "invalid recv buffer"}
 	,
-#endif
 	{
 	PF_INET, SOCK_STREAM, 0, buf, sizeof(buf), MSG_OOB,
 		    -1, EINVAL, setup1, cleanup1, "invalid MSG_OOB flag set"}
@@ -105,19 +102,11 @@ struct test_case_t {		/* test case structure */
 
 int TST_TOTAL = sizeof(tdat) / sizeof(tdat[0]);
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 int main(int argc, char *argv[])
 {
 	int lc;
 
 	tst_parse_opts(argc, argv, NULL, NULL);
-#ifdef UCLINUX
-	argv0 = argv[0];
-	maybe_run_child(&do_child, "d", &sfd);
-#endif
 
 	setup();
 
@@ -240,15 +229,9 @@ pid_t start_server(struct sockaddr_in *sin0)
 	}
 	SAFE_GETSOCKNAME(cleanup, sfd, (struct sockaddr *)sin0, &slen);
 
-	switch ((pid = FORK_OR_VFORK())) {
+	switch ((pid = tst_fork())) {
 	case 0:		/* child */
-#ifdef UCLINUX
-		if (self_exec(argv0, "d", sfd) < 0)
-			tst_brkm(TBROK | TERRNO, cleanup,
-				 "server self_exec failed");
-#else
 		do_child();
-#endif
 		break;
 	case -1:
 		tst_brkm(TBROK | TERRNO, cleanup, "server fork failed");
diff --git a/testcases/kernel/syscalls/recvfrom/recvfrom01.c b/testcases/kernel/syscalls/recvfrom/recvfrom01.c
index 853d1cb9f..f26f85688 100644
--- a/testcases/kernel/syscalls/recvfrom/recvfrom01.c
+++ b/testcases/kernel/syscalls/recvfrom/recvfrom01.c
@@ -126,21 +126,12 @@ struct test_case_t {		/* test case structure */
 
 int TST_TOTAL = sizeof(tdat) / sizeof(tdat[0]);
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 int main(int argc, char *argv[])
 {
 	int lc;
 
 	tst_parse_opts(argc, argv, NULL, NULL);
 
-#ifdef UCLINUX
-	argv0 = argv[0];
-	maybe_run_child(&do_child, "d", &sfd);
-#endif
-
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); ++lc) {
@@ -269,15 +260,9 @@ pid_t start_server(struct sockaddr_in *sin0)
 	}
 	SAFE_GETSOCKNAME(cleanup, sfd, (struct sockaddr *)sin0, &slen);
 
-	switch ((pid = FORK_OR_VFORK())) {
+	switch ((pid = tst_fork())) {
 	case 0:		/* child */
-#ifdef UCLINUX
-		if (self_exec(argv0, "d", sfd) < 0) {
-			tst_brkm(TBROK, cleanup, "server self_exec failed");
-		}
-#else
 		do_child();
-#endif
 		break;
 	case -1:
 		tst_brkm(TBROK | TERRNO, cleanup, "server fork failed");
diff --git a/testcases/kernel/syscalls/remap_file_pages/remap_file_pages02.c b/testcases/kernel/syscalls/remap_file_pages/remap_file_pages02.c
index d296022ce..858651fab 100644
--- a/testcases/kernel/syscalls/remap_file_pages/remap_file_pages02.c
+++ b/testcases/kernel/syscalls/remap_file_pages/remap_file_pages02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) Ricardo Salveti de Araujo <rsalvetidev@gmail.com>, 2007
  *
diff --git a/testcases/kernel/syscalls/rename/rename14.c b/testcases/kernel/syscalls/rename/rename14.c
index 726b35ce2..c0e96cef0 100644
--- a/testcases/kernel/syscalls/rename/rename14.c
+++ b/testcases/kernel/syscalls/rename/rename14.c
@@ -89,14 +89,14 @@ int main(int argc, char *argv[])
 	parent_pid = getpid();
 	tst_tmpdir();
 
-	pid = FORK_OR_VFORK();
+	pid = tst_fork();
 	if (pid < 0)
 		tst_brkm(TBROK, NULL, "fork() returned %d", pid);
 	if (pid == 0)
 		dochild1();
 
 	kidpid[0] = pid;
-	pid = FORK_OR_VFORK();
+	pid = tst_fork();
 	if (pid < 0) {
 		(void)kill(kidpid[0], SIGTERM);
 		(void)unlink("./rename14");
diff --git a/testcases/kernel/syscalls/sbrk/sbrk01.c b/testcases/kernel/syscalls/sbrk/sbrk01.c
index c99fb0106..bb78d9a7b 100644
--- a/testcases/kernel/syscalls/sbrk/sbrk01.c
+++ b/testcases/kernel/syscalls/sbrk/sbrk01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  *  AUTHOR : William Roske, CO-PILOT : Dave Fenner
diff --git a/testcases/kernel/syscalls/sbrk/sbrk02.c b/testcases/kernel/syscalls/sbrk/sbrk02.c
index 7fccc4d3a..dc344577e 100644
--- a/testcases/kernel/syscalls/sbrk/sbrk02.c
+++ b/testcases/kernel/syscalls/sbrk/sbrk02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Fujitsu Ltd.
  * Author: Zeng Linggang <zenglg.jy@cn.fujitsu.com>
diff --git a/testcases/kernel/syscalls/sbrk/sbrk03.c b/testcases/kernel/syscalls/sbrk/sbrk03.c
index 80d2020ff..875815629 100644
--- a/testcases/kernel/syscalls/sbrk/sbrk03.c
+++ b/testcases/kernel/syscalls/sbrk/sbrk03.c
@@ -39,7 +39,6 @@
 
 static void sbrk_test(void)
 {
-#if defined(__s390__) && defined(TST_ABI32)
 	void *ret1, *ret2;
 
 	/* set bkr to 0x10000000 */
@@ -59,13 +58,15 @@ static void sbrk_test(void)
 	}
 
 	tst_res(TPASS, "sbrk verify: %p", ret2);
-#else
-	tst_res(TCONF, "Only works in 32bit on s390 series system");
-#endif
 }
 
 static struct tst_test test = {
 	.test_all = sbrk_test,
+	.supported_archs = (const char *const []) {
+		"s390",
+		NULL
+	},
+	.needs_abi_bits = 32,
 	.tags = (const struct tst_tag[]) {
 		{"linux-git", "473a06572fcd"},
 		{}
diff --git a/testcases/kernel/syscalls/send/send01.c b/testcases/kernel/syscalls/send/send01.c
index 2e0ae2177..41859ff6f 100644
--- a/testcases/kernel/syscalls/send/send01.c
+++ b/testcases/kernel/syscalls/send/send01.c
@@ -100,8 +100,6 @@ static struct test_case_t tdat[] = {
 	 .cleanup = cleanup0,
 	 .desc = "invalid socket"}
 	,
-#ifndef UCLINUX
-	/* Skip since uClinux does not implement memory protection */
 	{.domain = PF_INET,
 	 .type = SOCK_STREAM,
 	 .proto = 0,
@@ -114,7 +112,6 @@ static struct test_case_t tdat[] = {
 	 .cleanup = cleanup1,
 	 .desc = "invalid send buffer"}
 	,
-#endif
 	{.domain = PF_INET,
 	 .type = SOCK_DGRAM,
 	 .proto = 0,
@@ -139,8 +136,6 @@ static struct test_case_t tdat[] = {
 	 .cleanup = cleanup1,
 	 .desc = "local endpoint shutdown"}
 	,
-#ifndef UCLINUX
-	/* Skip since uClinux does not implement memory protection */
 	{.domain = PF_INET,
 	 .type = SOCK_DGRAM,
 	 .proto = 0,
@@ -152,15 +147,10 @@ static struct test_case_t tdat[] = {
 	 .setup = setup1,
 	 .cleanup = cleanup1,
 	 .desc = "invalid flags set"}
-#endif
 };
 
 int TST_TOTAL = sizeof(tdat) / sizeof(tdat[0]);
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 static pid_t start_server(struct sockaddr_in *sin0)
 {
 	pid_t pid;
@@ -185,15 +175,9 @@ static pid_t start_server(struct sockaddr_in *sin0)
 	}
 	SAFE_GETSOCKNAME(cleanup, sfd, (struct sockaddr *)sin0, &slen);
 
-	switch ((pid = FORK_OR_VFORK())) {
+	switch ((pid = tst_fork())) {
 	case 0:
-#ifdef UCLINUX
-		if (self_exec(argv0, "d", sfd) < 0)
-			tst_brkm(TBROK | TERRNO, cleanup,
-				 "server self_exec failed");
-#else
 		do_child();
-#endif
 		break;
 	case -1:
 		tst_brkm(TBROK | TERRNO, cleanup, "server fork failed");
@@ -253,11 +237,6 @@ int main(int ac, char *av[])
 
 	tst_parse_opts(ac, av, NULL, NULL);
 
-#ifdef UCLINUX
-	argv0 = av[0];
-	maybe_run_child(&do_child, "d", &sfd);
-#endif
-
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); ++lc) {
diff --git a/testcases/kernel/syscalls/send/send02.c b/testcases/kernel/syscalls/send/send02.c
index 4d8da1613..3a735d3be 100644
--- a/testcases/kernel/syscalls/send/send02.c
+++ b/testcases/kernel/syscalls/send/send02.c
@@ -3,9 +3,11 @@
  * Copyright (c) 2020 SUSE LLC <mdoucha@suse.cz>
  */
 
-/*
+/*\
+ * [Description]
+ *
  * Check that the kernel correctly handles send()/sendto()/sendmsg() calls
- * with MSG_MORE flag
+ * with MSG_MORE flag.
  */
 
 #define _GNU_SOURCE
@@ -128,7 +130,7 @@ static void run(unsigned int n)
 	struct test_case *tc = testcase_list + n;
 	socklen_t len = sizeof(addr);
 
-	tst_res(TINFO, "Tesing %s", tc->name);
+	tst_res(TINFO, "Testing %s", tc->name);
 
 	tst_init_sockaddr_inet_bin(&addr, INADDR_LOOPBACK, 0);
 	listen_sock = SAFE_SOCKET(tc->domain, tc->type, tc->protocol);
diff --git a/testcases/kernel/syscalls/sendmsg/sendmsg01.c b/testcases/kernel/syscalls/sendmsg/sendmsg01.c
index cf6e74289..38cd7182c 100644
--- a/testcases/kernel/syscalls/sendmsg/sendmsg01.c
+++ b/testcases/kernel/syscalls/sendmsg/sendmsg01.c
@@ -358,21 +358,12 @@ struct test_case_t tdat[] = {
 
 int TST_TOTAL = sizeof(tdat) / sizeof(tdat[0]);
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 int main(int argc, char *argv[])
 {
 	int lc;
 
 	tst_parse_opts(argc, argv, NULL, NULL);
 
-#ifdef UCLINUX
-	argv0 = argv[0];
-	maybe_run_child(&do_child, "dd", &sfd, &ufd);
-#endif
-
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); ++lc) {
@@ -457,14 +448,9 @@ static pid_t start_server(struct sockaddr_in *sin0, struct sockaddr_un *sun0)
 		return -1;
 	}
 
-	switch ((pid = FORK_OR_VFORK())) {
+	switch ((pid = tst_fork())) {
 	case 0:
-#ifdef UCLINUX
-		if (self_exec(argv0, "dd", sfd, ufd) < 0)
-			tst_brkm(TBROK, cleanup, "server self_exec failed");
-#else
 		do_child();
-#endif
 		break;
 	case -1:
 		tst_brkm(TBROK, cleanup, "server fork failed: %s",
diff --git a/testcases/kernel/syscalls/sendto/sendto01.c b/testcases/kernel/syscalls/sendto/sendto01.c
index 6fe0274ee..b3b7b6efd 100644
--- a/testcases/kernel/syscalls/sendto/sendto01.c
+++ b/testcases/kernel/syscalls/sendto/sendto01.c
@@ -106,8 +106,6 @@ struct test_case_t tdat[] = {
 	 .cleanup = cleanup0,
 	 .desc = "invalid socket"}
 	,
-#ifndef UCLINUX
-	/* Skip since uClinux does not implement memory protection */
 	{.domain = PF_INET,
 	 .type = SOCK_DGRAM,
 	 .proto = 0,
@@ -122,7 +120,6 @@ struct test_case_t tdat[] = {
 	 .cleanup = cleanup1,
 	 .desc = "invalid send buffer"}
 	,
-#endif
 	{.domain = PF_INET,
 	 .type = SOCK_STREAM,
 	 .proto = 0,
@@ -165,8 +162,6 @@ struct test_case_t tdat[] = {
 	 .cleanup = cleanup1,
 	 .desc = "invalid to buffer length"}
 	,
-#ifndef UCLINUX
-	/* Skip since uClinux does not implement memory protection */
 	{.domain = PF_INET,
 	 .type = SOCK_DGRAM,
 	 .proto = 0,
@@ -181,7 +176,6 @@ struct test_case_t tdat[] = {
 	 .cleanup = cleanup1,
 	 .desc = "invalid to buffer"}
 	,
-#endif
 	{.domain = PF_INET,
 	 .type = SOCK_DGRAM,
 	 .proto = 0,
@@ -227,10 +221,6 @@ struct test_case_t tdat[] = {
 
 int TST_TOTAL = sizeof(tdat) / sizeof(tdat[0]);
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 static pid_t start_server(struct sockaddr_in *sin0)
 {
 	pid_t pid;
@@ -255,15 +245,9 @@ static pid_t start_server(struct sockaddr_in *sin0)
 	}
 	SAFE_GETSOCKNAME(cleanup, sfd, (struct sockaddr *)sin0, &slen);
 
-	switch ((pid = FORK_OR_VFORK())) {
+	switch ((pid = tst_fork())) {
 	case 0:
-#ifdef UCLINUX
-		if (self_exec(argv0, "d", sfd) < 0)
-			tst_brkm(TBROK | TERRNO, cleanup,
-				 "server self_exec failed");
-#else
 		do_child();
-#endif
 		break;
 	case -1:
 		tst_brkm(TBROK | TERRNO, cleanup, "server fork failed");
@@ -323,11 +307,6 @@ int main(int ac, char *av[])
 
 	tst_parse_opts(ac, av, NULL, NULL);
 
-#ifdef UCLINUX
-	argv0 = av[0];
-	maybe_run_child(&do_child, "d", &sfd);
-#endif
-
 	setup();
 
 	for (lc = 0; TEST_LOOPING(lc); ++lc) {
diff --git a/testcases/kernel/syscalls/setdomainname/setdomainname01.c b/testcases/kernel/syscalls/setdomainname/setdomainname01.c
index 4c2c53124..c50f787ba 100644
--- a/testcases/kernel/syscalls/setdomainname/setdomainname01.c
+++ b/testcases/kernel/syscalls/setdomainname/setdomainname01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002. All Rights Reserved.
  * Copyright (c) 2019 Petr Vorel <petr.vorel@gmail.com>
diff --git a/testcases/kernel/syscalls/setdomainname/setdomainname02.c b/testcases/kernel/syscalls/setdomainname/setdomainname02.c
index 875ed0c44..e710a7bf4 100644
--- a/testcases/kernel/syscalls/setdomainname/setdomainname02.c
+++ b/testcases/kernel/syscalls/setdomainname/setdomainname02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002. All Rights Reserved.
  * Copyright (c) 2019 Petr Vorel <petr.vorel@gmail.com>
diff --git a/testcases/kernel/syscalls/setdomainname/setdomainname03.c b/testcases/kernel/syscalls/setdomainname/setdomainname03.c
index b8d17d8da..3cd1ce3d9 100644
--- a/testcases/kernel/syscalls/setdomainname/setdomainname03.c
+++ b/testcases/kernel/syscalls/setdomainname/setdomainname03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002. All Rights Reserved.
  * Copyright (c) 2019 Petr Vorel <petr.vorel@gmail.com>
diff --git a/testcases/kernel/syscalls/setfsuid/setfsuid04.c b/testcases/kernel/syscalls/setfsuid/setfsuid04.c
index 8585d6207..e1525a731 100644
--- a/testcases/kernel/syscalls/setfsuid/setfsuid04.c
+++ b/testcases/kernel/syscalls/setfsuid/setfsuid04.c
@@ -62,7 +62,7 @@ int main(int ac, char **av)
 
 	setup();
 
-	pid = FORK_OR_VFORK();
+	pid = tst_fork();
 	if (pid < 0)
 		tst_brkm(TBROK, cleanup, "Fork failed");
 
@@ -106,7 +106,7 @@ static void do_master_child(void)
 	/* Test 2: Check a son process cannot open the file
 	 *         with RDWR permissions.
 	 */
-	pid = FORK_OR_VFORK();
+	pid = tst_fork();
 	if (pid < 0) {
 		perror("Fork failed");
 		exit(TFAIL);
diff --git a/testcases/kernel/syscalls/setgid/setgid01.c b/testcases/kernel/syscalls/setgid/setgid01.c
index 91d615261..4e225b13e 100644
--- a/testcases/kernel/syscalls/setgid/setgid01.c
+++ b/testcases/kernel/syscalls/setgid/setgid01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/setgroups/setgroups04.c b/testcases/kernel/syscalls/setgroups/setgroups04.c
index 93a064cda..71e2ca105 100644
--- a/testcases/kernel/syscalls/setgroups/setgroups04.c
+++ b/testcases/kernel/syscalls/setgroups/setgroups04.c
@@ -84,8 +84,6 @@ GID_T groups_list[NGROUPS];
 void setup();			/* setup function for the test */
 void cleanup();			/* cleanup function for the test */
 
-#if !defined(UCLINUX)
-
 int main(int ac, char **av)
 {
 	int lc;
@@ -135,16 +133,6 @@ int main(int ac, char **av)
 
 }
 
-#else
-
-int main(void)
-{
-	tst_resm(TINFO, "test is not available on uClinux");
-	tst_exit();
-}
-
-#endif /* if !defined(UCLINUX) */
-
 /*
  * setup()
  */
diff --git a/testcases/kernel/syscalls/setitimer/setitimer01.c b/testcases/kernel/syscalls/setitimer/setitimer01.c
index d12abe904..94ee51c6a 100644
--- a/testcases/kernel/syscalls/setitimer/setitimer01.c
+++ b/testcases/kernel/syscalls/setitimer/setitimer01.c
@@ -20,9 +20,10 @@
 #include "tst_test.h"
 #include "lapi/syscalls.h"
 #include "tst_safe_clocks.h"
+#include "tst_timer.h"
 
 static struct timeval tv;
-static struct itimerval *value, *ovalue;
+static struct __kernel_old_itimerval *value, *ovalue;
 static volatile unsigned long sigcnt;
 static long time_step;
 static long time_sec;
@@ -38,11 +39,6 @@ static struct tcase {
 	{ITIMER_PROF,    "ITIMER_PROF",    SIGPROF},
 };
 
-static int sys_setitimer(int which, void *new_value, void *old_value)
-{
-	return tst_syscall(__NR_setitimer, which, new_value, old_value);
-}
-
 static void sig_routine(int signo LTP_ATTRIBUTE_UNUSED)
 {
 	sigcnt++;
diff --git a/testcases/kernel/syscalls/setitimer/setitimer02.c b/testcases/kernel/syscalls/setitimer/setitimer02.c
index b012d71fa..c545f6288 100644
--- a/testcases/kernel/syscalls/setitimer/setitimer02.c
+++ b/testcases/kernel/syscalls/setitimer/setitimer02.c
@@ -19,13 +19,9 @@
 #include <stdlib.h>
 #include "tst_test.h"
 #include "lapi/syscalls.h"
+#include "tst_timer.h"
 
-static struct itimerval *value, *ovalue;
-
-static int sys_setitimer(int which, void *new_value, void *old_value)
-{
-	return tst_syscall(__NR_setitimer, which, new_value, old_value);
-}
+static struct __kernel_old_itimerval *value, *ovalue;
 
 static void verify_setitimer(unsigned int i)
 {
@@ -55,8 +51,8 @@ static struct tst_test test = {
 	.test = verify_setitimer,
 	.setup = setup,
 	.bufs = (struct tst_buffers[]) {
-		{&value,  .size = sizeof(struct itimerval)},
-		{&ovalue, .size = sizeof(struct itimerval)},
+		{&value,  .size = sizeof(struct __kernel_old_itimerval)},
+		{&ovalue, .size = sizeof(struct __kernel_old_itimerval)},
 		{}
 	}
 };
diff --git a/testcases/kernel/syscalls/setpgid/setpgid01.c b/testcases/kernel/syscalls/setpgid/setpgid01.c
index 89c9a3779..60034e016 100644
--- a/testcases/kernel/syscalls/setpgid/setpgid01.c
+++ b/testcases/kernel/syscalls/setpgid/setpgid01.c
@@ -108,7 +108,7 @@ static void setpgid_test2(void)
 	int ret;
 	pid_t pgid, pid;
 
-	pid = FORK_OR_VFORK();
+	pid = tst_fork();
 	if (pid == -1)
 		tst_brkm(TBROK | TERRNO, cleanup, "fork()");
 
diff --git a/testcases/kernel/syscalls/setpgrp/setpgrp01.c b/testcases/kernel/syscalls/setpgrp/setpgrp01.c
index 3fdb8cb4c..543106f14 100644
--- a/testcases/kernel/syscalls/setpgrp/setpgrp01.c
+++ b/testcases/kernel/syscalls/setpgrp/setpgrp01.c
@@ -92,7 +92,7 @@ void setup(void)
 	 * Make sure current process is NOT a session or pgrp leader
 	 */
 	if (getpgrp() == getpid()) {
-		if ((pid = FORK_OR_VFORK()) == -1) {
+		if ((pid = tst_fork()) == -1) {
 			tst_brkm(TBROK, cleanup,
 				 "fork() in setup() failed - errno %d", errno);
 		}
diff --git a/testcases/kernel/syscalls/setpgrp/setpgrp02.c b/testcases/kernel/syscalls/setpgrp/setpgrp02.c
index f1f6ce72a..f58f494e7 100644
--- a/testcases/kernel/syscalls/setpgrp/setpgrp02.c
+++ b/testcases/kernel/syscalls/setpgrp/setpgrp02.c
@@ -1,130 +1,35 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+
 /*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2001
+ * 07/2001 Ported by Wayne Boyer
+ * Copyright (c) Linux Test Project, 2001-2016
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
- * NAME
- *	setpgrp02.c
- *
- * DESCRIPTION
- *	Testcase to check the basic functionality of the setpgrp(2) syscall.
- *
- * ALGORITHM
- *	Check the values that setpgrp() and getpgrp() return. The setpgrp()
- *	returns 0 on success in Linux, but, in DYNIX/ptx this call returns
- *	the new pgid.
- *
- * USAGE:  <for command-line>
- *  setpgrp02 [-c n] [-f] [-i n] [-I x] [-P x] [-t]
- *     where,  -c n : Run n copies concurrently.
- *             -f   : Turn off functionality Testing.
- *             -i n : Execute test n times.
- *             -I x : Execute test for x seconds.
- *             -P x : Pause for x seconds between iterations.
- *             -t   : Turn on syscall timing.
+/*\
+ * [Description]
  *
- * HISTORY
- *	07/2001 Ported by Wayne Boyer
- *
- * RESTRICTIONS
- *	None
+ * Testcase to check the basic functionality of the setpgrp(2) syscall.
  */
-#include <errno.h>
-#include <sys/wait.h>
-#include "test.h"
-
-char *TCID = "setpgrp02";
-int TST_TOTAL = 1;
 
-void setup(void);
-void cleanup(void);
+#include <unistd.h>
+#include "tst_test.h"
 
-int main(int ac, char **av)
+static void verify_setpgrp(void)
 {
-	int lc;
-
-	int pid, oldpgrp;
-	int e_code, status, retval = 0;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-
-		/* reset tst_count in case we are looping */
-		tst_count = 0;
-
-		if ((pid = FORK_OR_VFORK()) == -1) {
-			tst_brkm(TBROK, cleanup, "fork() failed");
-		}
-
-		if (pid == 0) {	/* child */
-			oldpgrp = getpgrp();
-
-			TEST(setpgrp());
-
-			if (TEST_RETURN != 0) {
-				retval = 1;
-				tst_resm(TFAIL, "setpgrp() FAILED, errno:%d",
-					 errno);
-				continue;
-			}
-
-			if (getpgrp() == oldpgrp) {
-				retval = 1;
-				tst_resm(TFAIL, "setpgrp() FAILED to set "
-					 "new group id");
-				continue;
-			} else {
-				tst_resm(TPASS, "functionality is correct");
-			}
-			exit(retval);
-		} else {	/* parent */
-			/* wait for the child to finish */
-			wait(&status);
-			/* make sure the child returned a good exit status */
-			e_code = status >> 8;
-			if ((e_code != 0) || (retval != 0)) {
-				tst_resm(TFAIL, "Failures reported above");
-			}
-			cleanup();
-		}
+	if (!SAFE_FORK()) {
+		int oldpgrp = getpgrp();
+
+		TST_EXP_PASS(setpgrp());
+		if (getpgrp() == oldpgrp)
+			tst_res(TFAIL, "setpgrp() FAILED to set new group id");
+		else
+			tst_res(TPASS, "functionality is correct");
 	}
-	tst_exit();
-}
-
-/*
- * setup() - performs all ONE TIME setup for this test.
- */
-void setup(void)
-{
-
-	tst_sig(FORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
 }
 
-/*
- * cleanup() - performs all ONE TIME cleanup for this test at
- *	       completion or premature exit.
- */
-void cleanup(void)
-{
-
-}
+static struct tst_test test = {
+	.test_all = verify_setpgrp,
+	.forks_child = 1
+};
diff --git a/testcases/kernel/syscalls/setregid/setregid01.c b/testcases/kernel/syscalls/setregid/setregid01.c
index 741028a4a..2750208d4 100644
--- a/testcases/kernel/syscalls/setregid/setregid01.c
+++ b/testcases/kernel/syscalls/setregid/setregid01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/setregid/setregid02.c b/testcases/kernel/syscalls/setregid/setregid02.c
index 0210f485a..fed60a89e 100644
--- a/testcases/kernel/syscalls/setregid/setregid02.c
+++ b/testcases/kernel/syscalls/setregid/setregid02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  *   Copyright (c) International Business Machines  Corp., 2001
  *
diff --git a/testcases/kernel/syscalls/setregid/setregid03.c b/testcases/kernel/syscalls/setregid/setregid03.c
index 467bc3bbf..fca8ecfae 100644
--- a/testcases/kernel/syscalls/setregid/setregid03.c
+++ b/testcases/kernel/syscalls/setregid/setregid03.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) International Business Machines  Corp., 2001
  *
diff --git a/testcases/kernel/syscalls/setregid/setregid04.c b/testcases/kernel/syscalls/setregid/setregid04.c
index dbeb98ae6..19261dc1c 100644
--- a/testcases/kernel/syscalls/setregid/setregid04.c
+++ b/testcases/kernel/syscalls/setregid/setregid04.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) International Business Machines  Corp., 2001
  *
diff --git a/testcases/kernel/syscalls/setresuid/setresuid05.c b/testcases/kernel/syscalls/setresuid/setresuid05.c
index efdcbd18f..3a0eb4708 100644
--- a/testcases/kernel/syscalls/setresuid/setresuid05.c
+++ b/testcases/kernel/syscalls/setresuid/setresuid05.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2014 Fujitsu Ltd.
  * Author: Zeng Linggang <zenglg.jy@cn.fujitsu.com>
diff --git a/testcases/kernel/syscalls/setreuid/setreuid01.c b/testcases/kernel/syscalls/setreuid/setreuid01.c
index 7c2b6d589..5398246a6 100644
--- a/testcases/kernel/syscalls/setreuid/setreuid01.c
+++ b/testcases/kernel/syscalls/setreuid/setreuid01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  *	Author: William Roske
diff --git a/testcases/kernel/syscalls/setreuid/setreuid07.c b/testcases/kernel/syscalls/setreuid/setreuid07.c
index 5faf3cb7f..62b9ec4cd 100644
--- a/testcases/kernel/syscalls/setreuid/setreuid07.c
+++ b/testcases/kernel/syscalls/setreuid/setreuid07.c
@@ -60,5 +60,6 @@ static struct tst_test test = {
 	.setup = setup,
 	.test_all = run,
 	.needs_root = 1,
-	.forks_child = 1
+	.forks_child = 1,
+	.needs_tmpdir = 1,
 };
diff --git a/testcases/kernel/syscalls/setrlimit/setrlimit01.c b/testcases/kernel/syscalls/setrlimit/setrlimit01.c
index 7b133ef9e..188d310b2 100644
--- a/testcases/kernel/syscalls/setrlimit/setrlimit01.c
+++ b/testcases/kernel/syscalls/setrlimit/setrlimit01.c
@@ -134,7 +134,7 @@ static void test2(void)
 	 * output will be saved to the logfile (instead of stdout)
 	 * when the testcase (parent) is run from the driver.
 	 */
-	pid = FORK_OR_VFORK();
+	pid = tst_fork();
 	if (pid == -1)
 		tst_brkm(TBROK, cleanup, "fork() failed");
 
@@ -218,7 +218,7 @@ static void test3(void)
 	}
 
 	for (i = 0; i < 20; i++) {
-		pid = FORK_OR_VFORK();
+		pid = tst_fork();
 		if (pid == -1) {
 			if (errno != EAGAIN) {
 				tst_resm(TWARN, "Expected EAGAIN got %d",
@@ -251,7 +251,7 @@ static void test4(void)
 		return;
 	}
 
-	pid = FORK_OR_VFORK();
+	pid = tst_fork();
 	if (pid == -1)
 		tst_brkm(TBROK, cleanup, "fork() failed");
 
diff --git a/testcases/kernel/syscalls/setsid/setsid01.c b/testcases/kernel/syscalls/setsid/setsid01.c
index 08a7e2595..197e865cb 100644
--- a/testcases/kernel/syscalls/setsid/setsid01.c
+++ b/testcases/kernel/syscalls/setsid/setsid01.c
@@ -49,10 +49,6 @@
 char *TCID = "setsid01";
 int TST_TOTAL = 1;
 
-#ifdef UCLINUX
-static char *argv0;
-#endif
-
 void do_child_1(void);
 void do_child_2(void);
 void setup(void);
@@ -68,12 +64,6 @@ int main(int ac, char **av)
 	int lc;
 
 	tst_parse_opts(ac, av, NULL, NULL);
-#ifdef UCLINUX
-	argv0 = av[0];
-
-	maybe_run_child(&do_child_1, "n", 1);
-	maybe_run_child(&do_child_2, "n", 2);
-#endif
 
 	/*
 	 * perform global setup for the test
@@ -90,22 +80,15 @@ int main(int ac, char **av)
 		 * and then it attached itself to another process
 		 * group and tries to setsid
 		 */
-		pid = FORK_OR_VFORK();
+		pid = tst_fork();
 
 		if (pid == 0) {
-			if ((pid = FORK_OR_VFORK()) == -1) {
+			if ((pid = tst_fork()) == -1) {
 				tst_resm(TFAIL, "Fork failed");
 
 			}
 			if (pid == 0) {
-#ifdef UCLINUX
-				if (self_exec(argv0, "n", 1) < 0) {
-					tst_resm(TFAIL, "self_exec failed");
-
-				}
-#else
 				do_child_1();
-#endif
 			} else {
 				if (setpgid(0, 0) < 0) {
 					tst_resm(TFAIL,
@@ -161,17 +144,11 @@ void do_child_1(void)
 		exno = 1;
 	}
 
-	if ((pid = FORK_OR_VFORK()) == -1) {
+	if ((pid = tst_fork()) == -1) {
 		tst_brkm(TFAIL, NULL, "Fork failed");
 	}
 	if (pid == 0) {
-#ifdef UCLINUX
-		if (self_exec(argv0, "n", 2) < 0) {
-			tst_brkm(TFAIL, NULL, "self_exec failed");
-		}
-#else
 		do_child_2();
-#endif
 	} else {
 		retval = setpgid(0, getppid());
 		if (retval < 0) {
diff --git a/testcases/kernel/syscalls/setsockopt/setsockopt03.c b/testcases/kernel/syscalls/setsockopt/setsockopt03.c
index 210b75429..7a1458277 100644
--- a/testcases/kernel/syscalls/setsockopt/setsockopt03.c
+++ b/testcases/kernel/syscalls/setsockopt/setsockopt03.c
@@ -3,7 +3,10 @@
  * Copyright (c) 2017 Richard Palethorpe <rpalethorpe@suse.com>
  * Based on repro-compatReleaseEntry.c by NCC group
  */
-/*
+
+/*\
+ * [Description]
+ *
  * Test for CVE-2016-4997
  *
  * For a full explanation of how the vulnerability works see:
@@ -11,7 +14,7 @@
  *
  * The original vulnerability was present in the 32-bit compatibility system
  * call, so the test should be compiled with -m32 and run on a 64-bit kernel.
- * For simplicities sake the test requests root privliges instead of creating
+ * For simplicities sake the test requests root privileges instead of creating
  * a user namespace.
  */
 
diff --git a/testcases/kernel/syscalls/settimeofday/settimeofday01.c b/testcases/kernel/syscalls/settimeofday/settimeofday01.c
index b7f84b00f..e523b5b97 100644
--- a/testcases/kernel/syscalls/settimeofday/settimeofday01.c
+++ b/testcases/kernel/syscalls/settimeofday/settimeofday01.c
@@ -1,8 +1,13 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) International Business Machines  Corp., 2001
- * Ported to LTP 07/2001 John George
- * Testcase to check the basic functionality of settimeofday().
+ * Copyright (c) Linux Test Project, 2001-2024
+ */
+
+/*\
+ * [Description]
+ *
+ * Check the basic functionality of settimeofday().
  */
 
 #include <sys/time.h>
diff --git a/testcases/kernel/syscalls/settimeofday/settimeofday02.c b/testcases/kernel/syscalls/settimeofday/settimeofday02.c
index 0fa8a147a..06021b953 100644
--- a/testcases/kernel/syscalls/settimeofday/settimeofday02.c
+++ b/testcases/kernel/syscalls/settimeofday/settimeofday02.c
@@ -1,8 +1,13 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) International Business Machines  Corp., 2001
- * Ported to LTP 07/2001 John George
- * Testcase to check that settimeofday() sets errnos correctly.
+ * Copyright (c) Linux Test Project, 2001-2024
+ */
+
+/*\
+ * [Description]
+ *
+ * Check that settimeofday() sets errnos correctly.
  */
 
 #include <stdio.h>
@@ -27,16 +32,7 @@ static void verify_settimeofday(unsigned int n)
 	struct tcase *tc = &tcases[n];
 
 	tst_res(TINFO, "%s", tc->message);
-	TEST(settimeofday(&tc->tv, NULL));
-	if (TST_RET != -1) {
-		tst_res(TFAIL, "settimeofday() succeeded unexpectedly");
-		return;
-	}
-
-	if (TST_ERR != tc->exp_errno)
-		tst_res(TFAIL | TTERRNO, "Expected %s got ", tst_strerrno(tc->exp_errno));
-	else
-		tst_res(TPASS | TTERRNO, "Received expected errno");
+	TST_EXP_FAIL(settimeofday(&tc->tv, NULL), tc->exp_errno);
 }
 
 static struct tst_test test = {
diff --git a/testcases/kernel/syscalls/setxattr/setxattr01.c b/testcases/kernel/syscalls/setxattr/setxattr01.c
index 31f41369a..de3ea67ec 100644
--- a/testcases/kernel/syscalls/setxattr/setxattr01.c
+++ b/testcases/kernel/syscalls/setxattr/setxattr01.c
@@ -1,31 +1,24 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (C) 2011 Red Hat, Inc.
+ * Copyright (c) Linux Test Project, 2011-2024
  */
 
-/*
- * Basic tests for setxattr(2) and make sure setxattr(2) handles error
+/*\
+ * [Description]
+ *
+ * Tests for setxattr(2) and make sure setxattr(2) handles error
  * conditions correctly.
  *
- * There are 7 test cases:
- * 1. Any other flags being set except XATTR_CREATE and XATTR_REPLACE,
- *    setxattr(2) should return -1 and set errno to EINVAL
- * 2. With XATTR_REPLACE flag set but the attribute does not exist,
- *    setxattr(2) should return -1 and set errno to ENODATA
- * 3. Create new attr with name length greater than XATTR_NAME_MAX(255)
- *    setxattr(2) should return -1 and set errno to ERANGE
- * 4. Create new attr whose value length is greater than XATTR_SIZE_MAX(65536)
- *    setxattr(2) should return -1 and set errno to E2BIG
- * 5. Create new attr whose value length is zero,
- *    setxattr(2) should succeed
- * 6. Replace the attr value without XATTR_REPLACE flag being set,
- *    setxattr(2) should return -1 and set errno to EEXIST
- * 7. Replace attr value with XATTR_REPLACE flag being set,
- *    setxattr(2) should succeed
- * 8. Create new attr whose key length is zero,
- *    setxattr(2) should return -1 and set errno to ERANGE
- * 9. Create new attr whose key is NULL,
- *    setxattr(2) should return -1 and set errno to EFAULT
+ * - EINVAL - any other flags being set except XATTR_CREATE and XATTR_REPLACE
+ * - ENODATA - with XATTR_REPLACE flag set but the attribute does not exist
+ * - ERANGE - create new attr with name length greater than XATTR_NAME_MAX(255)
+ * - E2BIG - create new attr whose value length is greater than XATTR_SIZE_MAX(65536)
+ * - SUCCEED - create new attr whose value length is zero
+ * - EEXIST - replace the attr value without XATTR_REPLACE flag being set
+ * - SUCCEED - replace attr value with XATTR_REPLACE flag being set
+ * - ERANGE - create new attr whose key length is zero
+ * - EFAULT - create new attr whose key is NULL
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/setxattr/setxattr02.c b/testcases/kernel/syscalls/setxattr/setxattr02.c
index 9796f9a52..18afc031b 100644
--- a/testcases/kernel/syscalls/setxattr/setxattr02.c
+++ b/testcases/kernel/syscalls/setxattr/setxattr02.c
@@ -1,26 +1,23 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (C) 2011 Red Hat, Inc.
+ * Copyright (c) Linux Test Project, 2011-2024
  */
 
-/*
+/*\
+ * [Description]
+ *
  * In the user.* namespace, only regular files and directories can
  * have extended attributes. Otherwise setxattr(2) will return -1
  * and set errno to EPERM.
  *
- * There are 7 test cases:
- * 1. Set attribute to a regular file, setxattr(2) should succeed
- * 2. Set attribute to a directory, setxattr(2) should succeed
- * 3. Set attribute to a symlink which points to the regular file,
- *    setxattr(2) should return -1 and set errno to EEXIST
- * 4. Set attribute to a FIFO, setxattr(2) should return -1 and set
- *    errno to EPERM
- * 5. Set attribute to a char special file, setxattr(2) should
- *    return -1 and set errno to EPERM
- * 6. Set attribute to a block special file, setxattr(2) should
- *    return -1 and set errno to EPERM
- * 7. Set attribute to a UNIX domain socket, setxattr(2) should
- *    return -1 and set errno to EPERM
+ * - SUCCEED - set attribute to a regular file
+ * - SUCCEED - set attribute to a directory
+ * - EEXIST - set attribute to a symlink which points to the regular file
+ * - EPERM - set attribute to a FIFO
+ * - EPERM - set attribute to a char special file
+ * - EPERM - set attribute to a block special file
+ * - EPERM - set attribute to a UNIX domain socket
  */
 
 #include "config.h"
diff --git a/testcases/kernel/syscalls/setxattr/setxattr03.c b/testcases/kernel/syscalls/setxattr/setxattr03.c
index 58ee0f880..52cec0788 100644
--- a/testcases/kernel/syscalls/setxattr/setxattr03.c
+++ b/testcases/kernel/syscalls/setxattr/setxattr03.c
@@ -1,16 +1,16 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (C) 2012 Red Hat, Inc.
+ * Copyright (c) Linux Test Project, 2012-2024
  */
 
-/*
+/*\
+ * [Description]
+ *
  * setxattr(2) to immutable and append-only files should get EPERM
  *
- * There are 2 test cases:
- * 1. Set attribute to a immutable file, setxattr(2) should return -1
- *    and set errno to EPERM
- * 2. Set attribute to a append-only file, setxattr(2) should return
- *    -1 and set errno to EPERM
+ * - Set attribute to a immutable file
+ * - Set attribute to a append-only file
  */
 
 #define _GNU_SOURCE
diff --git a/testcases/kernel/syscalls/sigaltstack/sigaltstack02.c b/testcases/kernel/syscalls/sigaltstack/sigaltstack02.c
index c5ab79715..5a34851c0 100644
--- a/testcases/kernel/syscalls/sigaltstack/sigaltstack02.c
+++ b/testcases/kernel/syscalls/sigaltstack/sigaltstack02.c
@@ -1,191 +1,63 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+
 /*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2001
+ * Ported by John George (2001)
+ * Copyright (C) 2024 SUSE LLC Andrea Manzini <andrea.manzini@suse.com>
  */
 
-/*
- * Test Name: sigalstack02
- *
- * Test Description:
- *  Verify that,
- *   1. sigaltstack() fails and sets errno to EINVAL when "ss_flags" field
- *      pointed to by 'ss' contains invalid flags.
- *   2. sigaltstack() fails and sets errno to ENOMEM when the size of alternate
- *      stack area is less than MINSIGSTKSZ.
- *
- * Expected Result:
- *  sigaltstack() should fail with return value -1 and set expected errno.
- *
- * Algorithm:
- *  Setup:
- *   Setup signal handling.
- *   Create temporary directory.
- *   Pause for SIGUSR1 if option specified.
+/*\
+ * [Description]
  *
- *  Test:
- *   Loop if the proper options are given.
- *   Execute system call
- *   Check return code, if system call failed (return=-1)
- *	if errno set == expected errno
- *		Issue sys call fails with expected return value and errno.
- *	Otherwise,
- *		Issue sys call fails with unexpected errno.
- *   Otherwise,
- *	Issue sys call returns unexpected value.
+ * Verify that sigaltstack() fails with return value -1 and set expected errno:
  *
- *  Cleanup:
- *   Print errno log and/or timing stats if options given
- *   Delete the temporary directory(s)/file(s) created.
- *
- * Usage:  <for command-line>
- *  sigaltstack02 [-c n] [-e] [-f] [-i n] [-I x] [-p x] [-t]
- *	where,  -c n : Run n copies concurrently.
- *		-e   : Turn on errno logging.
- *		-f   : Turn off functionality Testing.
- *		-i n : Execute test n times.
- *		-I x : Execute test for x seconds.
- *		-P x : Pause for x seconds between iterations.
- *		-t   : Turn on syscall timing.
- *
- * History
- *	07/2001 John George
- *		-Ported
- *
- * Restrictions:
- *  This test should be executed by super-user (root) only.
+ * - EINVAL on invalid value.
+ * - ENOMEM on stack is < MINSIGSTKSZ.
  */
 
-#include <stdio.h>
-#include <sys/types.h>
-#include <unistd.h>
-#include <signal.h>
-#include <string.h>
-#include <ucontext.h>
-#include <errno.h>
-
-#include "test.h"
+#include <stdlib.h>
+#include "tst_test.h"
 
 #define INVAL_FLAGS	9999
 
-char *TCID = "sigaltstack02";
-int TST_TOTAL = 2;
-
-stack_t sigstk;			/* signal stack storing struct. */
+static stack_t sigstk;
 
-void setup(void);			/* Main setup function of test */
-void cleanup(void);			/* cleanup function for the test */
-
-struct test_case_t {		/* test case struct. to hold diff. test.conds */
+static struct test_case {
 	int flag;
 	int size;
 	char *desc;
 	int exp_errno;
-} Test_cases[] = {
-	{
-	INVAL_FLAGS, SIGSTKSZ, "Invalid Flag value", EINVAL},
+} tcases[] = {
+	{INVAL_FLAGS, SIGSTKSZ, "Invalid Flag value", EINVAL},
 	/* use value low enough for all kernel versions
 	 * avoid using MINSIGSTKSZ defined by glibc as it could be different
 	 * from the one in kernel ABI
 	 */
-	{
-	0, (2048 - 1), "alternate stack is < MINSIGSTKSZ", ENOMEM},
-	{
-	0, 0, NULL, 0}
-};
+	{0, (2048 - 1), "alternate stack is < MINSIGSTKSZ", ENOMEM} };
 
-int main(int ac, char **av)
+static void check_sigaltstack(unsigned int nr)
 {
-	int lc;
-	char *test_desc;	/* test specific error message */
-	int ind;		/* counter to test different test conditions */
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-
-		tst_count = 0;
-
-		for (ind = 0; Test_cases[ind].desc != NULL; ind++) {
-			sigstk.ss_size = Test_cases[ind].size;
-			sigstk.ss_flags = Test_cases[ind].flag;
-			test_desc = Test_cases[ind].desc;
-
-			/* Verify sigaltstack() fails and sets errno */
-			TEST(sigaltstack(&sigstk, NULL));
-
-			/* Check return code from sigaltstack() */
-			if (TEST_RETURN == -1) {
-				if (TEST_ERRNO ==
-				    Test_cases[ind].exp_errno) {
-					tst_resm(TPASS, "stgaltstack() "
-						 "fails, %s, errno:%d",
-						 test_desc, TEST_ERRNO);
-				} else {
-					tst_resm(TFAIL, "sigaltstack() "
-						 "fails, %s, errno:%d, "
-						 "expected errno:%d",
-						 test_desc, TEST_ERRNO,
-						 Test_cases
-						 [ind].exp_errno);
-				}
-			} else {
-				tst_resm(TFAIL, "sigaltstack() returned %ld, "
-					 "expected -1, errno:%d", TEST_RETURN,
-					 Test_cases[ind].exp_errno);
-			}
-		}
-		tst_count++;	/* incr. TEST_LOOP counter */
-	}
-
-	cleanup();
-	tst_exit();
+	struct test_case *tc = &tcases[nr];
 
+	sigstk.ss_size = tc->size;
+	sigstk.ss_flags = tc->flag;
+	TST_EXP_FAIL(sigaltstack(&sigstk, NULL), tc->exp_errno, "%s", tc->desc);
 }
 
-/*
- * void
- * setup() - performs all ONE TIME setup for this test.
- * Allocate memory for the alternative stack.
- */
-void setup(void)
+static void setup(void)
 {
-
-	tst_sig(FORK, DEF_HANDLER, cleanup);
-
-	TEST_PAUSE;
-
-	/* Allocate memory for the alternate stack */
-	if ((sigstk.ss_sp = malloc(SIGSTKSZ)) == NULL) {
-		tst_brkm(TFAIL, cleanup,
-			 "could not allocate memory for the alternate stack");
-	}
+	sigstk.ss_sp = SAFE_MALLOC(SIGSTKSZ);
 }
 
-/*
- * void
- * cleanup() - performs all ONE TIME cleanup for this test at
- *             completion or premature exit.
- *  Free the memory allocated for alternate stack.
- */
-void cleanup(void)
+static void cleanup(void)
 {
-
 	free(sigstk.ss_sp);
-
 }
+
+static struct tst_test test = {
+	.setup = setup,
+	.cleanup = cleanup,
+	.test = check_sigaltstack,
+	.tcnt = ARRAY_SIZE(tcases),
+	.needs_tmpdir = 1
+};
diff --git a/testcases/kernel/syscalls/signal/signal06.c b/testcases/kernel/syscalls/signal/signal06.c
index cf0706ea4..1a28b2767 100644
--- a/testcases/kernel/syscalls/signal/signal06.c
+++ b/testcases/kernel/syscalls/signal/signal06.c
@@ -49,6 +49,7 @@
 
 #include "test.h"
 #include "lapi/syscalls.h"
+#include "pgsize_helpers.h"
 
 char *TCID = "signal06";
 int TST_TOTAL = 5;
@@ -61,7 +62,7 @@ int TST_TOTAL = 5;
 volatile double D;
 volatile int FLAGE;
 
-char altstack[4096 * 10] __attribute__((aligned(4096)));
+char altstack[MAX_PAGE_SIZE * 10] __attribute__((aligned(MAX_PAGE_SIZE)));
 
 void test(void)
 {
diff --git a/testcases/kernel/syscalls/sigpending/sigpending02.c b/testcases/kernel/syscalls/sigpending/sigpending02.c
index b9a3c5e84..d901540ca 100644
--- a/testcases/kernel/syscalls/sigpending/sigpending02.c
+++ b/testcases/kernel/syscalls/sigpending/sigpending02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) International Business Machines  Corp., 2002
  * Copyright (c) Linux Test Project, 2009-2019
diff --git a/testcases/kernel/syscalls/sigrelse/sigrelse01.c b/testcases/kernel/syscalls/sigrelse/sigrelse01.c
index 3b86d0bdb..8a91ea811 100644
--- a/testcases/kernel/syscalls/sigrelse/sigrelse01.c
+++ b/testcases/kernel/syscalls/sigrelse/sigrelse01.c
@@ -192,9 +192,6 @@ int main(int argc, char **argv)
 	 * parse standard options
 	 */
 	tst_parse_opts(argc, argv, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&child, "dd", &pipe_fd[1], &pipe_fd2[0]);
-#endif
 
 	/*
 	 * perform global setup for test
@@ -208,23 +205,12 @@ int main(int argc, char **argv)
 		/*
 		 * fork off a child process
 		 */
-		if ((pid = FORK_OR_VFORK()) < 0) {
+		if ((pid = tst_fork()) < 0)
 			tst_brkm(TBROK | TERRNO, cleanup, "fork() failed");
-
-		} else if (pid > 0) {
+		else if (pid > 0)
 			parent();
-
-		} else {
-#ifdef UCLINUX
-			if (self_exec(argv[0], "dd", pipe_fd[1], pipe_fd2[0]) <
-			    0) {
-				tst_brkm(TBROK | TERRNO, cleanup,
-					 "self_exec() failed");
-			}
-#else
+		else
 			child();
-#endif
-		}
 
 	}
 
diff --git a/testcases/kernel/syscalls/socketpair/socketpair01.c b/testcases/kernel/syscalls/socketpair/socketpair01.c
index 675eb535d..5d9610b12 100644
--- a/testcases/kernel/syscalls/socketpair/socketpair01.c
+++ b/testcases/kernel/syscalls/socketpair/socketpair01.c
@@ -34,10 +34,8 @@ struct test_case_t {
 	{PF_INET, 75, 0, fds, -1, EINVAL, "invalid type"},
 	{PF_UNIX, SOCK_DGRAM, 0, fds, 0, 0, "UNIX domain dgram"},
 	{PF_INET, SOCK_RAW, 0, fds, -1, EPROTONOSUPPORT, "raw open as non-root"},
-#ifndef UCLINUX
 	{PF_UNIX, SOCK_STREAM, 0, 0, -1, EFAULT, "bad aligned pointer"},
 	{PF_UNIX, SOCK_STREAM, 0, (int *)7, -1, EFAULT, "bad unaligned pointer"},
-#endif
 	{PF_INET, SOCK_DGRAM, 17, fds, -1, EOPNOTSUPP, "UDP socket"},
 	{PF_INET, SOCK_DGRAM, 6, fds, -1, EPROTONOSUPPORT, "TCP dgram"},
 	{PF_INET, SOCK_STREAM, 6, fds, -1, EOPNOTSUPP, "TCP socket"},
diff --git a/testcases/kernel/syscalls/sockioctl/sockioctl01.c b/testcases/kernel/syscalls/sockioctl/sockioctl01.c
index ff3738f32..e81ec20a5 100644
--- a/testcases/kernel/syscalls/sockioctl/sockioctl01.c
+++ b/testcases/kernel/syscalls/sockioctl/sockioctl01.c
@@ -87,13 +87,11 @@ struct test_case_t {
 		    (struct sockaddr *)&fsin1, sizeof(fsin1), -1,
 		    EINVAL, setup0, cleanup0, "not a socket"}
 	,
-#if !defined(UCLINUX)
 	{
 	PF_INET, SOCK_STREAM, 0, SIOCATMARK, 0,
 		    (struct sockaddr *)&fsin1, sizeof(fsin1), -1,
 		    EFAULT, setup1, cleanup1, "invalid option buffer"}
 	,
-#endif
 	{
 	PF_INET, SOCK_DGRAM, 0, SIOCATMARK, &optval,
 		    (struct sockaddr *)&fsin1, sizeof(fsin1), -1,
diff --git a/testcases/kernel/syscalls/splice/.gitignore b/testcases/kernel/syscalls/splice/.gitignore
index 88a8dff78..96b1727a1 100644
--- a/testcases/kernel/syscalls/splice/.gitignore
+++ b/testcases/kernel/syscalls/splice/.gitignore
@@ -5,3 +5,5 @@
 /splice05
 /splice06
 /splice07
+/splice08
+/splice09
diff --git a/testcases/kernel/syscalls/splice/splice07.c b/testcases/kernel/syscalls/splice/splice07.c
index 9c23e0aac..d3b527a4f 100644
--- a/testcases/kernel/syscalls/splice/splice07.c
+++ b/testcases/kernel/syscalls/splice/splice07.c
@@ -54,7 +54,7 @@ static void check_splice(struct tst_fd *fd_in, struct tst_fd *fd_out)
 	const int exp_errnos[] = {EBADF, EINVAL};
 
 	TST_EXP_FAIL2_ARR(splice(fd_in->fd, NULL, fd_out->fd, NULL, 1, 0),
-		exp_errnos, "splice() on %s -> %s",
+		exp_errnos, ARRAY_SIZE(exp_errnos), "splice() on %s -> %s",
 		tst_fd_desc(fd_in), tst_fd_desc(fd_out));
 }
 
diff --git a/testcases/kernel/syscalls/splice/splice08.c b/testcases/kernel/syscalls/splice/splice08.c
new file mode 100644
index 000000000..6f2209468
--- /dev/null
+++ b/testcases/kernel/syscalls/splice/splice08.c
@@ -0,0 +1,94 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (C) 2024 Cyril Hrubis <chrubis@suse.cz>
+ */
+
+/*\
+ * [Description]
+ *
+ * Test for splicing from /dev/zero and /dev/full.
+ *
+ * The support for splicing from /dev/zero and /dev/full was removed in:
+ * c6585011bc1d ("splice: Remove generic_file_splice_read()")
+ *
+ * And added back in:
+ * 1b057bd800c3 ("drivers/char/mem: implement splice() for /dev/zero, /dev/full")
+ */
+
+#define _GNU_SOURCE
+#include "tst_test.h"
+
+static int fd_zero;
+static int fd_full;
+
+static void test_splice(unsigned int bytes, int dev_fd)
+{
+	int pipefd[2];
+	char buf[bytes];
+	size_t i;
+	int fail = 0;
+
+	memset(buf, 0xff, sizeof(buf));
+
+	SAFE_PIPE(pipefd);
+
+	TST_EXP_POSITIVE(splice(dev_fd, NULL, pipefd[1], NULL, sizeof(buf), 0));
+
+	if (!TST_PASS)
+		goto ret;
+
+	if ((size_t)TST_RET != sizeof(buf)) {
+		tst_res(TFAIL, "Only part %lu bytes of %u were spliced",
+			TST_RET, bytes);
+		goto ret;
+	}
+
+	SAFE_READ(1, pipefd[0], buf, sizeof(buf));
+
+	for (i = 0; i < sizeof(buf); i++) {
+		if (buf[i])
+			fail++;
+	}
+
+	if (fail)
+		tst_res(TFAIL, "%i non-zero bytes spliced from /dev/zero", fail);
+	else
+		tst_res(TPASS, "All bytes spliced from /dev/zero are zeroed");
+
+ret:
+	SAFE_CLOSE(pipefd[0]);
+	SAFE_CLOSE(pipefd[1]);
+}
+
+static void verify_splice(unsigned int n)
+{
+	unsigned int bytes = 1009 * n;
+
+	tst_res(TINFO, "Splicing %u bytes from /dev/zero", bytes);
+	test_splice(bytes, fd_zero);
+	tst_res(TINFO, "Splicing %u bytes from /dev/full", bytes);
+	test_splice(bytes, fd_full);
+}
+
+static void setup(void)
+{
+	fd_zero = SAFE_OPEN("/dev/zero", O_RDONLY);
+	fd_full = SAFE_OPEN("/dev/full", O_RDONLY);
+}
+
+static void cleanup(void)
+{
+	if (fd_zero > 0)
+		SAFE_CLOSE(fd_zero);
+
+	if (fd_full > 0)
+		SAFE_CLOSE(fd_full);
+}
+
+static struct tst_test test = {
+	.test = verify_splice,
+	.tcnt = 9,
+	.setup = setup,
+	.cleanup = cleanup,
+	.min_kver = "6.7",
+};
diff --git a/testcases/kernel/syscalls/splice/splice09.c b/testcases/kernel/syscalls/splice/splice09.c
new file mode 100644
index 000000000..9c63fb03c
--- /dev/null
+++ b/testcases/kernel/syscalls/splice/splice09.c
@@ -0,0 +1,53 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (C) 2024 Cyril Hrubis <chrubis@suse.cz>
+ */
+
+/*\
+ * [Description]
+ *
+ * Test for splicing to /dev/zero and /dev/null these two devices discard all
+ * data written to them.
+ *
+ * The support for splicing to /dev/zero was added in:
+ * 1b057bd800c3 ("drivers/char/mem: implement splice() for /dev/zero, /dev/full")
+ */
+
+#define _GNU_SOURCE
+#include "tst_test.h"
+
+static const char *const test_devices[] = {
+	"/dev/null",
+	"/dev/zero",
+};
+
+static void verify_splice(unsigned int n)
+{
+	char buf[1024];
+	char dev_fd;
+	int pipefd[2];
+
+	memset(buf, 0xff, sizeof(buf));
+
+	tst_res(TINFO, "Testing %s", test_devices[n]);
+
+	dev_fd = SAFE_OPEN(test_devices[n], O_WRONLY);
+
+	SAFE_PIPE(pipefd);
+	SAFE_WRITE(1, pipefd[1], buf, sizeof(buf));
+
+	TST_EXP_POSITIVE(splice(pipefd[0], NULL, dev_fd, NULL, sizeof(buf), 0));
+
+	if (TST_PASS && TST_RET != sizeof(buf))
+		tst_res(TFAIL, "Wrote only part of the pipe buffer");
+
+	SAFE_CLOSE(pipefd[0]);
+	SAFE_CLOSE(pipefd[1]);
+	SAFE_CLOSE(dev_fd);
+}
+
+static struct tst_test test = {
+	.test = verify_splice,
+	.tcnt = ARRAY_SIZE(test_devices),
+	.min_kver = "6.7",
+};
diff --git a/testcases/kernel/syscalls/statfs/statfs01.c b/testcases/kernel/syscalls/statfs/statfs01.c
index a2043f03d..62e1d00ed 100644
--- a/testcases/kernel/syscalls/statfs/statfs01.c
+++ b/testcases/kernel/syscalls/statfs/statfs01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  * AUTHOR : William Roske, CO-PILOT	: Dave Fenner
diff --git a/testcases/kernel/syscalls/statvfs/statvfs01.c b/testcases/kernel/syscalls/statvfs/statvfs01.c
index c10c67b18..1aafe5e4b 100644
--- a/testcases/kernel/syscalls/statvfs/statvfs01.c
+++ b/testcases/kernel/syscalls/statvfs/statvfs01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2005.  All Rights Reserved.
  *    AUTHOR: Prashant P Yendigeri <prashant.yendigeri@wipro.com>
diff --git a/testcases/kernel/syscalls/statvfs/statvfs02.c b/testcases/kernel/syscalls/statvfs/statvfs02.c
index 6f36530bf..506a35fea 100644
--- a/testcases/kernel/syscalls/statvfs/statvfs02.c
+++ b/testcases/kernel/syscalls/statvfs/statvfs02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 
 /*
  * Copyright (c) 2014 Fujitsu Ltd.
diff --git a/testcases/kernel/syscalls/statx/statx04.c b/testcases/kernel/syscalls/statx/statx04.c
index 58296bd24..c2ed52deb 100644
--- a/testcases/kernel/syscalls/statx/statx04.c
+++ b/testcases/kernel/syscalls/statx/statx04.c
@@ -96,8 +96,9 @@ static void setup(void)
 	for (i = 0, expected_mask = 0; i < ARRAY_SIZE(attr_list); i++)
 		expected_mask |= attr_list[i].attr;
 
-	/* STATX_ATTR_COMPRESSED not supported on XFS, TMPFS */
-	if (!strcmp(tst_device->fs_type, "xfs") || !strcmp(tst_device->fs_type, "tmpfs"))
+	/* STATX_ATTR_COMPRESSED not supported on Bcachefs, TMPFS, XFS */
+	if (!strcmp(tst_device->fs_type, "bcachefs") || !strcmp(tst_device->fs_type, "tmpfs") ||
+	    !strcmp(tst_device->fs_type, "xfs"))
 		expected_mask &= ~STATX_ATTR_COMPRESSED;
 
 	/* Attribute support was added to Btrfs statx() in kernel v4.13 */
diff --git a/testcases/kernel/syscalls/statx/statx07.c b/testcases/kernel/syscalls/statx/statx07.c
index 4dbf83e18..1a568ec9e 100644
--- a/testcases/kernel/syscalls/statx/statx07.c
+++ b/testcases/kernel/syscalls/statx/statx07.c
@@ -118,11 +118,15 @@ static void setup(void)
 
 	cwd = tst_get_tmpdir();
 
+	mode_t old_umask = umask(0);
+
 	SAFE_MKDIR(SERV_PATH, DEFAULT_MODE);
 	SAFE_MKDIR(CLI_PATH, DEFAULT_MODE);
 	SAFE_CREAT(SERV_FORCE_SYNC, DEFAULT_MODE);
 	SAFE_CREAT(SERV_DONT_SYNC, DEFAULT_MODE);
 
+	umask(old_umask);
+
 	snprintf(server_path, sizeof(server_path), ":%s/%s", cwd, SERV_PATH);
 
 	snprintf(cmd, sizeof(cmd),
diff --git a/testcases/kernel/syscalls/swapoff/swapoff01.c b/testcases/kernel/syscalls/swapoff/swapoff01.c
index b27eecdad..314630267 100644
--- a/testcases/kernel/syscalls/swapoff/swapoff01.c
+++ b/testcases/kernel/syscalls/swapoff/swapoff01.c
@@ -17,15 +17,19 @@
 #include "lapi/syscalls.h"
 #include "libswap.h"
 
+#define MNTPOINT	"mntpoint"
+#define TEST_FILE	MNTPOINT"/testswap"
+#define SWAP_FILE	MNTPOINT"/swapfile"
+
 static void verify_swapoff(void)
 {
-	if (tst_syscall(__NR_swapon, "./swapfile01", 0) != 0) {
+	if (tst_syscall(__NR_swapon, SWAP_FILE, 0) != 0) {
 		tst_res(TFAIL | TERRNO, "Failed to turn on the swap file"
 			 ", skipping test iteration");
 		return;
 	}
 
-	TEST(tst_syscall(__NR_swapoff, "./swapfile01"));
+	TEST(tst_syscall(__NR_swapoff, SWAP_FILE));
 
 	if (TST_RET == -1) {
 		tst_res(TFAIL | TTERRNO, "Failed to turn off swapfile,"
@@ -38,22 +42,16 @@ static void verify_swapoff(void)
 
 static void setup(void)
 {
-	is_swap_supported("./tstswap");
-
-	if (!tst_fs_has_free(".", 64, TST_MB))
-		tst_brk(TBROK,
-			"Insufficient disk space to create swap file");
-
-	if (tst_fill_file("swapfile01", 0x00, 1024, 65536))
-		tst_brk(TBROK, "Failed to create file for swap");
-
-	if (system("mkswap swapfile01 > tmpfile 2>&1") != 0)
-		tst_brk(TBROK, "Failed to make swapfile");
+	is_swap_supported(TEST_FILE);
+	SAFE_MAKE_SWAPFILE_BLKS(SWAP_FILE, 65536);
 }
 
 static struct tst_test test = {
+	.mntpoint = MNTPOINT,
+	.mount_device = 1,
+	.dev_min_size = 350,
+	.all_filesystems = 1,
 	.needs_root = 1,
-	.needs_tmpdir = 1,
 	.test_all = verify_swapoff,
 	.setup = setup
 };
diff --git a/testcases/kernel/syscalls/swapoff/swapoff02.c b/testcases/kernel/syscalls/swapoff/swapoff02.c
index cd940b1e7..0ab8338c5 100644
--- a/testcases/kernel/syscalls/swapoff/swapoff02.c
+++ b/testcases/kernel/syscalls/swapoff/swapoff02.c
@@ -18,6 +18,10 @@
 #include "lapi/syscalls.h"
 #include "libswap.h"
 
+#define MNTPOINT	"mntpoint"
+#define TEST_FILE	MNTPOINT"/testswap"
+#define SWAP_FILE	MNTPOINT"/swapfile"
+
 static int setup01(void);
 static void cleanup01(void);
 
@@ -32,8 +36,8 @@ static struct tcase {
 	void (*cleanup)(void);
 } tcases[] = {
 	{"path does not exist", ENOENT, "ENOENT", "./doesnotexist", NULL, NULL},
-	{"Invalid file", EINVAL, "EINVAL", "./swapfile01", NULL, NULL},
-	{"Permission denied", EPERM, "EPERM", "./swapfile01", setup01, cleanup01}
+	{"Invalid file", EINVAL, "EINVAL", SWAP_FILE, NULL, NULL},
+	{"Permission denied", EPERM, "EPERM", SWAP_FILE, setup01, cleanup01}
 };
 
 static void verify_swapoff(unsigned int i)
@@ -82,18 +86,15 @@ static void setup(void)
 	nobody = SAFE_GETPWNAM("nobody");
 	nobody_uid = nobody->pw_uid;
 
-	is_swap_supported("./tstswap");
-
-	if (!tst_fs_has_free(".", 1, TST_KB))
-		tst_brk(TBROK, "Insufficient disk space to create swap file");
-
-	if (tst_fill_file("./swapfile01", 0x00, 1024, 1))
-		tst_brk(TBROK, "Failed to create swapfile");
+	is_swap_supported(TEST_FILE);
+	SAFE_MAKE_SMALL_SWAPFILE(SWAP_FILE);
 }
 
 static struct tst_test test = {
+	.mntpoint = MNTPOINT,
+	.mount_device = 1,
+	.all_filesystems = 1,
 	.needs_root = 1,
-	.needs_tmpdir = 1,
 	.test = verify_swapoff,
 	.tcnt = ARRAY_SIZE(tcases),
 	.setup = setup
diff --git a/testcases/kernel/syscalls/swapon/Makefile b/testcases/kernel/syscalls/swapon/Makefile
index 53c795090..6954112a8 100644
--- a/testcases/kernel/syscalls/swapon/Makefile
+++ b/testcases/kernel/syscalls/swapon/Makefile
@@ -1,11 +1,6 @@
 # SPDX-License-Identifier: GPL-2.0-or-later
 # Copyright (c) International Business Machines Corp., 2001
 
-NEEDSPECIAL	:= $(shell echo MAX_SWAPFILES | $(CC) -E -xc -include linux/swap.h 2>/dev/null - | tail -n 1 | grep 32; echo $?)
-ifneq ($(strip $(NEEDSPECIAL)),)
-export CFLAGS	+= -DOLDER_DISTRO_RELEASE
-endif
-
 top_srcdir		?= ../../../..
 
 LTPLIBS = ltpswap
diff --git a/testcases/kernel/syscalls/swapon/swapon01.c b/testcases/kernel/syscalls/swapon/swapon01.c
index e59fb20a1..49915c32d 100644
--- a/testcases/kernel/syscalls/swapon/swapon01.c
+++ b/testcases/kernel/syscalls/swapon/swapon01.c
@@ -8,6 +8,7 @@
  * [Description]
  *
  * Checks that swapon() succeds with swapfile.
+ * Testing on all filesystems which support swap file.
  */
 
 #include <unistd.h>
@@ -17,12 +18,17 @@
 #include "lapi/syscalls.h"
 #include "libswap.h"
 
-#define SWAP_FILE "swapfile01"
+#define MNTPOINT	"mntpoint"
+#define SWAP_FILE	MNTPOINT"/swapfile01"
+#define TESTMEM		(1UL<<30)
 
 static void verify_swapon(void)
 {
 	TST_EXP_PASS(tst_syscall(__NR_swapon, SWAP_FILE, 0));
 
+	tst_pollute_memory(TESTMEM, 0x41);
+	tst_res(TINFO, "SwapCached: %ld Kb", SAFE_READ_MEMINFO("SwapCached:"));
+
 	if (TST_PASS && tst_syscall(__NR_swapoff, SWAP_FILE) != 0) {
 		tst_brk(TBROK | TERRNO,
 				"Failed to turn off swapfile, system reboot recommended");
@@ -32,12 +38,18 @@ static void verify_swapon(void)
 static void setup(void)
 {
 	is_swap_supported(SWAP_FILE);
-	make_swapfile(SWAP_FILE, 0);
+	MAKE_SWAPFILE_SIZE(SWAP_FILE, 128);
+
+	SAFE_CG_PRINTF(tst_cg, "cgroup.procs", "%d", getpid());
+	SAFE_CG_PRINTF(tst_cg, "memory.max", "%lu", TESTMEM);
 }
 
 static struct tst_test test = {
+	.mntpoint = MNTPOINT,
+	.mount_device = 1,
 	.needs_root = 1,
-	.needs_tmpdir = 1,
+	.all_filesystems = 1,
+	.needs_cgroup_ctrls = (const char *const []){ "memory", NULL },
 	.test_all = verify_swapon,
 	.setup = setup
 };
diff --git a/testcases/kernel/syscalls/swapon/swapon02.c b/testcases/kernel/syscalls/swapon/swapon02.c
index fceea77be..73cc3bb44 100644
--- a/testcases/kernel/syscalls/swapon/swapon02.c
+++ b/testcases/kernel/syscalls/swapon/swapon02.c
@@ -7,7 +7,8 @@
 /*\
  * [Description]
  *
- * This test case checks whether swapon(2) system call returns
+ * This test case checks whether swapon(2) system call returns:
+ *
  * - ENOENT when the path does not exist
  * - EINVAL when the path exists but is invalid
  * - EPERM when user is not a superuser
@@ -20,6 +21,12 @@
 #include "lapi/syscalls.h"
 #include "libswap.h"
 
+#define MNTPOINT	"mntpoint"
+#define TEST_FILE	MNTPOINT"/testswap"
+#define NOTSWAP_FILE	MNTPOINT"/notswap"
+#define SWAP_FILE	MNTPOINT"/swapfile"
+#define USED_FILE	MNTPOINT"/alreadyused"
+
 static uid_t nobody_uid;
 static int do_swapoff;
 
@@ -29,9 +36,9 @@ static struct tcase {
 	char *path;
 } tcases[] = {
 	{"Path does not exist", ENOENT, "./doesnotexist"},
-	{"Invalid path", EINVAL, "./notswap"},
-	{"Permission denied", EPERM, "./swapfile01"},
-	{"File already used", EBUSY, "./alreadyused"},
+	{"Invalid path", EINVAL, NOTSWAP_FILE},
+	{"Permission denied", EPERM, SWAP_FILE},
+	{"File already used", EBUSY, USED_FILE},
 };
 
 static void setup(void)
@@ -41,13 +48,13 @@ static void setup(void)
 	nobody = SAFE_GETPWNAM("nobody");
 	nobody_uid = nobody->pw_uid;
 
-	is_swap_supported("./tstswap");
+	is_swap_supported(TEST_FILE);
 
-	SAFE_TOUCH("notswap", 0777, NULL);
-	make_swapfile("swapfile01", 0);
-	make_swapfile("alreadyused", 0);
+	SAFE_TOUCH(NOTSWAP_FILE, 0777, NULL);
+	MAKE_SMALL_SWAPFILE(SWAP_FILE);
+	MAKE_SMALL_SWAPFILE(USED_FILE);
 
-	if (tst_syscall(__NR_swapon, "alreadyused", 0))
+	if (tst_syscall(__NR_swapon, USED_FILE, 0))
 		tst_res(TWARN | TERRNO, "swapon(alreadyused) failed");
 	else
 		do_swapoff = 1;
@@ -55,7 +62,7 @@ static void setup(void)
 
 static void cleanup(void)
 {
-	if (do_swapoff && tst_syscall(__NR_swapoff, "alreadyused"))
+	if (do_swapoff && tst_syscall(__NR_swapoff, USED_FILE))
 		tst_res(TWARN | TERRNO, "swapoff(alreadyused) failed");
 }
 
@@ -78,8 +85,10 @@ static void verify_swapon(unsigned int i)
 }
 
 static struct tst_test test = {
+	.mntpoint = MNTPOINT,
+	.mount_device = 1,
+	.all_filesystems = 1,
 	.needs_root = 1,
-	.needs_tmpdir = 1,
 	.test = verify_swapon,
 	.tcnt = ARRAY_SIZE(tcases),
 	.setup = setup,
diff --git a/testcases/kernel/syscalls/swapon/swapon03.c b/testcases/kernel/syscalls/swapon/swapon03.c
index dc633ebc6..436f864eb 100644
--- a/testcases/kernel/syscalls/swapon/swapon03.c
+++ b/testcases/kernel/syscalls/swapon/swapon03.c
@@ -9,6 +9,7 @@
  * [Description]
  *
  * This test case checks whether swapon(2) system call returns:
+ *
  *  - EPERM when there are more than MAX_SWAPFILES already in use.
  */
 
@@ -16,239 +17,94 @@
 #include <errno.h>
 #include <stdlib.h>
 #include <sys/wait.h>
-
+#include <sys/swap.h>
 #include "tst_test.h"
 #include "lapi/syscalls.h"
-#include "swaponoff.h"
 #include "libswap.h"
 
-static int setup_swap(void);
-static int clean_swap(void);
-static int check_and_swapoff(const char *filename);
+#define MNTPOINT	"mntpoint"
+#define TEST_FILE	MNTPOINT"/testswap"
 
 static int swapfiles;
 
-int testfiles = 3;
-static struct swap_testfile_t {
-	char *filename;
-} swap_testfiles[] = {
-	{"firstswapfile"},
-	{"secondswapfile"},
-	{"thirdswapfile"}
-};
-
-int expected_errno = EPERM;
-
-static void verify_swapon(void)
-{
-	if (setup_swap() < 0) {
-		clean_swap();
-		tst_brk(TBROK, "Setup failed, quitting the test");
-	}
-
-	TEST(tst_syscall(__NR_swapon, swap_testfiles[0].filename, 0));
-
-	if ((TST_RET == -1) && (TST_ERR == expected_errno)) {
-		tst_res(TPASS, "swapon(2) got expected failure (%d),",
-			expected_errno);
-	} else if (TST_RET < 0) {
-		tst_res(TFAIL | TTERRNO,
-			"swapon(2) failed to produce expected error "
-			"(%d). System reboot recommended.",
-			expected_errno);
-	} else {
-		/* Probably the system supports MAX_SWAPFILES > 30,
-		 * let's try with MAX_SWAPFILES == 32 */
-
-		/* Call swapon sys call once again for 32
-		 * now we can't receive an error */
-		TEST(tst_syscall(__NR_swapon, swap_testfiles[1].filename, 0));
-
-		/* Check return code (now we're expecting success) */
-		if (TST_RET < 0) {
-			tst_res(TFAIL | TTERRNO,
-				"swapon(2) got an unexpected failure");
-		} else {
-			/* Call swapon sys call once again for 33
-			 * now we have to receive an error */
-			TEST(tst_syscall(__NR_swapon, swap_testfiles[2].filename, 0));
-
-			/* Check return code (should be an error) */
-			if ((TST_RET == -1) && (TST_ERR == expected_errno)) {
-				tst_res(TPASS,
-					"swapon(2) got expected failure;"
-					" Got errno = %d, probably your"
-					" MAX_SWAPFILES is 32",
-					expected_errno);
-			} else {
-				tst_res(TFAIL,
-					"swapon(2) failed to produce"
-					" expected error: %d, got %s."
-					" System reboot after execution of LTP"
-					" test suite is recommended.",
-					expected_errno, strerror(TST_ERR));
-			}
-		}
-	}
-
-	if (clean_swap() < 0)
-		tst_brk(TBROK, "Cleanup failed, quitting the test");
-}
-
-/*
- * Create 33 and activate 30 swapfiles.
- */
 static int setup_swap(void)
 {
 	pid_t pid;
-	int j, fd;
 	int status;
-	int res = 0;
+	int j, max_swapfiles, used_swapfiles;
 	char filename[FILENAME_MAX];
-	char buf[BUFSIZ + 1];
 
-	/* Find out how many swapfiles (1 line per entry) already exist */
-	swapfiles = 0;
-
-	if (seteuid(0) < 0)
-		tst_brk(TFAIL | TERRNO, "Failed to call seteuid");
-
-	/* This includes the first (header) line */
-	if ((fd = open("/proc/swaps", O_RDONLY)) == -1) {
-		tst_brk(TFAIL | TERRNO,
-			"Failed to find out existing number of swap files");
-	}
-	do {
-		char *p = buf;
-		res = read(fd, buf, BUFSIZ);
-		if (res < 0) {
-			tst_brk(TFAIL | TERRNO,
-				 "Failed to find out existing number of swap files");
-		}
-		buf[res] = '\0';
-		while ((p = strchr(p, '\n'))) {
-			p++;
-			swapfiles++;
-		}
-	} while (BUFSIZ <= res);
-	close(fd);
-	if (swapfiles)
-		swapfiles--;	/* don't count the /proc/swaps header */
-
-	if (swapfiles < 0)
-		tst_brk(TFAIL, "Failed to find existing number of swapfiles");
+	SAFE_SETEUID(0);
 
 	/* Determine how many more files are to be created */
-	swapfiles = MAX_SWAPFILES - swapfiles;
-	if (swapfiles > MAX_SWAPFILES)
-		swapfiles = MAX_SWAPFILES;
+	max_swapfiles = tst_max_swapfiles();
+	used_swapfiles = tst_count_swaps();
+	swapfiles = max_swapfiles - used_swapfiles;
+	if (swapfiles > max_swapfiles)
+		swapfiles = max_swapfiles;
+
 	pid = SAFE_FORK();
 	if (pid == 0) {
 		/*create and turn on remaining swapfiles */
 		for (j = 0; j < swapfiles; j++) {
 
-			/* prepare filename for the iteration */
-			if (sprintf(filename, "swapfile%02d", j + 2) < 0) {
-				printf("sprintf() failed to create "
-				       "filename");
-				exit(1);
-			}
-
 			/* Create the swapfile */
-			make_swapfile(filename, 0);
+			snprintf(filename, sizeof(filename), "%s%02d", TEST_FILE, j + 2);
+			MAKE_SMALL_SWAPFILE(filename);
 
 			/* turn on the swap file */
-			res = tst_syscall(__NR_swapon, filename, 0);
-			if (res != 0) {
-				if (errno == EPERM) {
-					printf("Successfully created %d swapfiles\n", j);
-					break;
-				} else {
-					printf("Failed to create swapfile: %s\n", filename);
-					exit(1);
-				}
-			}
+			TST_EXP_PASS_SILENT(swapon(filename, 0));
 		}
 		exit(0);
 	} else
 		waitpid(pid, &status, 0);
 
 	if (WEXITSTATUS(status))
-		tst_brk(TFAIL, "Failed to setup swaps");
+		tst_brk(TFAIL, "Failed to setup swap files");
 
-	/* Create all needed extra swapfiles for testing */
-	for (j = 0; j < testfiles; j++)
-		make_swapfile(swap_testfiles[j].filename, 0);
+	tst_res(TINFO, "Successfully created %d swap files", swapfiles);
+	MAKE_SMALL_SWAPFILE(TEST_FILE);
 
 	return 0;
 }
 
 /*
- * Turn off all swapfiles previously turned on
+ * Check if the file is at /proc/swaps and remove it giving swapoff
  */
-static int clean_swap(void)
+static int check_and_swapoff(const char *filename)
 {
-	int j;
-	char filename[FILENAME_MAX];
+	char cmd_buffer[256];
+	int rc = -1;
 
-	for (j = 0; j < swapfiles; j++) {
-		if (snprintf(filename, sizeof(filename),
-			     "swapfile%02d", j + 2) < 0) {
-			tst_res(TWARN, "sprintf() failed to create filename");
-			tst_res(TWARN, "Failed to turn off swap files. System"
-				 " reboot after execution of LTP test"
-				 " suite is recommended");
-			return -1;
-		}
-		if (check_and_swapoff(filename) != 0) {
-			tst_res(TWARN, "Failed to turn off swap file %s.", filename);
-			return -1;
-		}
-	}
+	snprintf(cmd_buffer, sizeof(cmd_buffer), "grep -q '%s.*file' /proc/swaps", filename);
 
-	for (j = 0; j < testfiles; j++) {
-		if (check_and_swapoff(swap_testfiles[j].filename) != 0) {
-			tst_res(TWARN, "Failed to turn off swap file %s.",
-				 swap_testfiles[j].filename);
-			return -1;
-		}
+	if (system(cmd_buffer) == 0 && swapoff(filename) != 0) {
+		tst_res(TWARN, "Failed to swapoff %s", filename);
+		rc = -1;
 	}
 
-	return 0;
+	return rc;
 }
 
 /*
- * Check if the file is at /proc/swaps and remove it giving swapoff
+ * Turn off all swapfiles previously turned on
  */
-static int check_and_swapoff(const char *filename)
+static void clean_swap(void)
 {
-	char cmd_buffer[256];
-	int rc = -1;
-
-	if (snprintf(cmd_buffer, sizeof(cmd_buffer),
-		     "grep -q '%s.*file' /proc/swaps", filename) < 0) {
-		tst_res(TWARN, "sprintf() failed to create the command string");
-	} else {
-
-		rc = 0;
-
-		if (system(cmd_buffer) == 0) {
-
-			/* now we need to swapoff the file */
-			if (tst_syscall(__NR_swapoff, filename) != 0) {
-
-				tst_res(TWARN, "Failed to turn off swap "
-					 "file. system reboot after "
-					 "execution of LTP test suite "
-					 "is recommended");
-				rc = -1;
-
-			}
+	int j;
+	char filename[FILENAME_MAX];
 
-		}
+	for (j = 0; j < swapfiles; j++) {
+		snprintf(filename, sizeof(filename), "%s%02d", TEST_FILE, j + 2);
+		check_and_swapoff(filename);
 	}
 
-	return rc;
+	check_and_swapoff("testfile");
+}
+
+static void verify_swapon(void)
+{
+	TST_EXP_FAIL(swapon(TEST_FILE, 0), EPERM, "swapon(%s, 0)", TEST_FILE);
 }
 
 static void setup(void)
@@ -256,7 +112,11 @@ static void setup(void)
 	if (access("/proc/swaps", F_OK))
 		tst_brk(TCONF, "swap not supported by kernel");
 
-	is_swap_supported("./tstswap");
+	is_swap_supported(TEST_FILE);
+	if (setup_swap() < 0) {
+		clean_swap();
+		tst_brk(TBROK, "Setup failed, quitting the test");
+	}
 }
 
 static void cleanup(void)
@@ -265,8 +125,10 @@ static void cleanup(void)
 }
 
 static struct tst_test test = {
+	.mntpoint = MNTPOINT,
+	.mount_device = 1,
+	.all_filesystems = 1,
 	.needs_root = 1,
-	.needs_tmpdir = 1,
 	.forks_child = 1,
 	.test_all = verify_swapon,
 	.setup = setup,
diff --git a/testcases/kernel/syscalls/swapon/swaponoff.h b/testcases/kernel/syscalls/swapon/swaponoff.h
deleted file mode 100644
index 900761bda..000000000
--- a/testcases/kernel/syscalls/swapon/swaponoff.h
+++ /dev/null
@@ -1,8 +0,0 @@
-
-#ifndef __SWAP_ON_OFF_H_
-#define __SWAP_ON_OFF_H_
-
-#include <linux/version.h>
-#define MAX_SWAPFILES 30
-
-#endif
diff --git a/testcases/kernel/syscalls/sysinfo/sysinfo02.c b/testcases/kernel/syscalls/sysinfo/sysinfo02.c
index 7ad0e8bdc..4ce06e0a7 100644
--- a/testcases/kernel/syscalls/sysinfo/sysinfo02.c
+++ b/testcases/kernel/syscalls/sysinfo/sysinfo02.c
@@ -78,8 +78,6 @@ void cleanup();
 char *TCID = "sysinfo02";
 int TST_TOTAL = 1;
 
-#if !defined(UCLINUX)
-
 int main(int ac, char **av)
 {
 	struct sysinfo *sysinfo_buf;
@@ -115,16 +113,6 @@ int main(int ac, char **av)
 
 }
 
-#else
-
-int main(void)
-{
-	tst_resm(TINFO, "test is not available on uClinux");
-	tst_exit();
-}
-
-#endif /* if !defined(UCLINUX) */
-
 /*
  * setup()
  *	performs one time setup
diff --git a/testcases/kernel/syscalls/timer_create/timer_create01.c b/testcases/kernel/syscalls/timer_create/timer_create01.c
index d56e68c23..dfbdc9125 100644
--- a/testcases/kernel/syscalls/timer_create/timer_create01.c
+++ b/testcases/kernel/syscalls/timer_create/timer_create01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2003.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/timer_create/timer_create02.c b/testcases/kernel/syscalls/timer_create/timer_create02.c
index 1920f0874..551cf50b9 100644
--- a/testcases/kernel/syscalls/timer_create/timer_create02.c
+++ b/testcases/kernel/syscalls/timer_create/timer_create02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2003.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/timer_delete/timer_delete01.c b/testcases/kernel/syscalls/timer_delete/timer_delete01.c
index bdc2e44cc..4d1b6ddfc 100644
--- a/testcases/kernel/syscalls/timer_delete/timer_delete01.c
+++ b/testcases/kernel/syscalls/timer_delete/timer_delete01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2003.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/timer_delete/timer_delete02.c b/testcases/kernel/syscalls/timer_delete/timer_delete02.c
index 29614f62e..9df959f9d 100644
--- a/testcases/kernel/syscalls/timer_delete/timer_delete02.c
+++ b/testcases/kernel/syscalls/timer_delete/timer_delete02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2003.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/timer_getoverrun/timer_getoverrun01.c b/testcases/kernel/syscalls/timer_getoverrun/timer_getoverrun01.c
index aa9881f27..57c2147bf 100644
--- a/testcases/kernel/syscalls/timer_getoverrun/timer_getoverrun01.c
+++ b/testcases/kernel/syscalls/timer_getoverrun/timer_getoverrun01.c
@@ -1,88 +1,46 @@
-/******************************************************************************
- * Copyright (c) Crackerjack Project., 2007                                   *
- * Porting from Crackerjack to LTP is done by:                                *
- *              Manas Kumar Nayak <maknayak@in.ibm.com>                       *
- * Copyright (c) 2013 Cyril Hrubis <chrubis@suse.cz>                          *
- *                                                                            *
- * This program is free software;  you can redistribute it and/or modify      *
- * it under the terms of the GNU General Public License as published by       *
- * the Free Software Foundation; either version 2 of the License, or          *
- * (at your option) any later version.                                        *
- *                                                                            *
- * This program is distributed in the hope that it will be useful,            *
- * but WITHOUT ANY WARRANTY;  without even the implied warranty of            *
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See                  *
- * the GNU General Public License for more details.                           *
- *                                                                            *
- * You should have received a copy of the GNU General Public License          *
- * along with this program;  if not, write to the Free Software Foundation,   *
- * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA           *
- *                                                                            *
- ******************************************************************************/
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) International Business Machines Corp., 2001
+ * Porting from Crackerjack to LTP is done by:
+ *              Manas Kumar Nayak <maknayak@in.ibm.com>
+ *
+ * Copyright (c) Linux Test Project, 2009-2023
+ * Copyright (c) 2013 Cyril Hrubis <chrubis@suse.cz>
+ * Copyright (C) 2023 SUSE LLC Andrea Cervesato <andrea.cervesato@suse.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * This test checks base timer_getoverrun() functionality.
+ */
 
-#include <stdio.h>
-#include <errno.h>
-#include <time.h>
 #include <signal.h>
-#include <sys/syscall.h>
-
-#include "test.h"
+#include <time.h>
+#include "tst_safe_clocks.h"
 #include "lapi/syscalls.h"
+#include "lapi/common_timers.h"
 
-char *TCID = "timer_getoverrun01";
-int TST_TOTAL = 1;
-
-static void cleanup(void)
+static void run(void)
 {
-
-	tst_rmdir();
-}
-
-static void setup(void)
-{
-	TEST_PAUSE;
-	tst_tmpdir();
-}
-
-int main(int ac, char **av)
-{
-	int lc;
-	int timer;
+	kernel_timer_t timer;
 	struct sigevent ev;
 
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
 	ev.sigev_value = (union sigval) 0;
-	ev.sigev_signo = SIGALRM;
 	ev.sigev_notify = SIGEV_SIGNAL;
-	TEST(tst_syscall(__NR_timer_create, CLOCK_REALTIME, &ev, &timer));
-
-	if (TEST_RETURN != 0)
-		tst_brkm(TBROK | TTERRNO, cleanup, "Failed to create timer");
+	ev.sigev_signo = SIGALRM;
 
-	for (lc = 0; TEST_LOOPING(lc); ++lc) {
-		tst_count = 0;
+	if (tst_syscall(__NR_timer_create, CLOCK_REALTIME, &ev, &timer))
+		tst_brk(TBROK | TERRNO, "timer_create() failed");
 
-		TEST(tst_syscall(__NR_timer_getoverrun, timer));
-		if (TEST_RETURN == 0) {
-			tst_resm(TPASS,
-			         "timer_getoverrun(CLOCK_REALTIME) Passed");
-		} else {
-			tst_resm(TFAIL | TTERRNO,
-			         "timer_getoverrun(CLOCK_REALTIME) Failed");
-		}
+	TST_EXP_POSITIVE(tst_syscall(__NR_timer_getoverrun, timer));
 
-		TEST(tst_syscall(__NR_timer_getoverrun, -1));
-		if (TEST_RETURN == -1 && TEST_ERRNO == EINVAL) {
-			tst_resm(TPASS,	"timer_gettime(-1) Failed: EINVAL");
-		} else {
-			tst_resm(TFAIL | TTERRNO,
-			         "timer_gettime(-1) = %li", TEST_RETURN);
-		}
-	}
+	if (tst_syscall(__NR_timer_delete, timer))
+		tst_brk(TBROK | TERRNO, "timer_delete() failed");
 
-	cleanup();
-	tst_exit();
+	TST_EXP_FAIL(tst_syscall(__NR_timer_getoverrun, timer), EINVAL);
 }
+
+static struct tst_test test = {
+	.test_all = run,
+};
diff --git a/testcases/kernel/syscalls/timer_settime/timer_settime01.c b/testcases/kernel/syscalls/timer_settime/timer_settime01.c
index 5aee8b38a..1d9d5e49b 100644
--- a/testcases/kernel/syscalls/timer_settime/timer_settime01.c
+++ b/testcases/kernel/syscalls/timer_settime/timer_settime01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2003.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/timer_settime/timer_settime02.c b/testcases/kernel/syscalls/timer_settime/timer_settime02.c
index 3309a81ad..2723dc03d 100644
--- a/testcases/kernel/syscalls/timer_settime/timer_settime02.c
+++ b/testcases/kernel/syscalls/timer_settime/timer_settime02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2003.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/unlink/.gitignore b/testcases/kernel/syscalls/unlink/.gitignore
index 2e783580d..6038cc29d 100644
--- a/testcases/kernel/syscalls/unlink/.gitignore
+++ b/testcases/kernel/syscalls/unlink/.gitignore
@@ -1,3 +1,4 @@
 /unlink05
 /unlink07
 /unlink08
+/unlink09
diff --git a/testcases/kernel/syscalls/unlink/unlink05.c b/testcases/kernel/syscalls/unlink/unlink05.c
index adb90fa68..81afeebf5 100644
--- a/testcases/kernel/syscalls/unlink/unlink05.c
+++ b/testcases/kernel/syscalls/unlink/unlink05.c
@@ -1,13 +1,16 @@
 // SPDX-License-Identifier: GPL-2.0-or-later
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
+ * Copyright (c) Linux Test Project, 2006-2024
  */
 
-/*
- * Description:
- * The testcase checks the basic functionality of the unlink(2).
- * 1) unlink() can delete regular file successfully.
- * 2) unlink() can delete fifo file successfully.
+/*\
+ * [Description]
+ *
+ * Check the basic functionality of the unlink(2):
+ *
+ * - unlink(2) can delete regular file successfully.
+ * - unlink(2) can delete fifo file successfully.
  */
 
 #include <errno.h>
@@ -16,17 +19,6 @@
 #include <stdio.h>
 #include "tst_test.h"
 
-static void file_create(char *);
-static void fifo_create(char *);
-
-static struct test_case_t {
-	void (*setupfunc)(char *);
-	char *desc;
-} tcases[] = {
-	{file_create, "file"},
-	{fifo_create, "fifo"},
-};
-
 static void file_create(char *name)
 {
 	sprintf(name, "tfile_%d", getpid());
@@ -39,6 +31,14 @@ static void fifo_create(char *name)
 	SAFE_MKFIFO(name, 0777);
 }
 
+static struct test_case_t {
+	void (*setupfunc)(char *name);
+	char *desc;
+} tcases[] = {
+	{file_create, "file"},
+	{fifo_create, "fifo"},
+};
+
 static void verify_unlink(unsigned int n)
 {
 	char fname[255];
diff --git a/testcases/kernel/syscalls/unlink/unlink09.c b/testcases/kernel/syscalls/unlink/unlink09.c
new file mode 100644
index 000000000..cc4b4a07e
--- /dev/null
+++ b/testcases/kernel/syscalls/unlink/unlink09.c
@@ -0,0 +1,102 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
+/*
+ * Copyright (c) 2024 FUJITSU LIMITED. All Rights Reserved.
+ * Author: Yang Xu <xuyang2018.jy@fujitsu.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * Verify that unlink(2) fails with
+ *
+ * - EPERM when target file is marked as immutable or append-only
+ * - EROFS when target file is on a read-only filesystem.
+ */
+
+#include <sys/ioctl.h>
+#include "tst_test.h"
+#include "lapi/fs.h"
+
+#define TEST_EPERM_IMMUTABLE "test_eperm_immutable"
+#define TEST_EPERM_APPEND_ONLY "test_eperm_append_only"
+#define DIR_EROFS "erofs"
+#define TEST_EROFS "erofs/test_erofs"
+
+static int fd_immutable;
+static int fd_append_only;
+
+static struct test_case_t {
+	char *filename;
+	int *fd;
+	int flag;
+	int expected_errno;
+	char *desc;
+} tcases[] = {
+	{TEST_EPERM_IMMUTABLE, &fd_immutable, FS_IMMUTABLE_FL, EPERM,
+		"target file is immutable"},
+	{TEST_EPERM_APPEND_ONLY, &fd_append_only, FS_APPEND_FL, EPERM,
+		"target file is append-only"},
+	{TEST_EROFS, NULL, 0, EROFS, "target file in read-only filesystem"},
+};
+
+static void setup(void)
+{
+	int attr;
+
+	fd_immutable = SAFE_OPEN(TEST_EPERM_IMMUTABLE, O_CREAT, 0600);
+	SAFE_IOCTL(fd_immutable, FS_IOC_GETFLAGS, &attr);
+	attr |= FS_IMMUTABLE_FL;
+	SAFE_IOCTL(fd_immutable, FS_IOC_SETFLAGS, &attr);
+
+	fd_append_only = SAFE_OPEN(TEST_EPERM_APPEND_ONLY, O_CREAT, 0600);
+	SAFE_IOCTL(fd_append_only, FS_IOC_GETFLAGS, &attr);
+	attr |= FS_APPEND_FL;
+	SAFE_IOCTL(fd_append_only, FS_IOC_SETFLAGS, &attr);
+}
+
+static void cleanup(void)
+{
+	int attr;
+
+	SAFE_IOCTL(fd_immutable, FS_IOC_GETFLAGS, &attr);
+	attr &= ~FS_IMMUTABLE_FL;
+	SAFE_IOCTL(fd_immutable, FS_IOC_SETFLAGS, &attr);
+	SAFE_CLOSE(fd_immutable);
+
+	SAFE_IOCTL(fd_append_only, FS_IOC_GETFLAGS, &attr);
+	attr &= ~FS_APPEND_FL;
+	SAFE_IOCTL(fd_append_only, FS_IOC_SETFLAGS, &attr);
+	SAFE_CLOSE(fd_append_only);
+}
+
+static void verify_unlink(unsigned int i)
+{
+	struct test_case_t *tc = &tcases[i];
+	int attr;
+
+	TST_EXP_FAIL(unlink(tc->filename), tc->expected_errno, "%s", tc->desc);
+
+	/* If unlink() succeeded unexpectedly, test file should be restored. */
+	if (!TST_RET) {
+		if (tc->fd) {
+			*(tc->fd) = SAFE_OPEN(tc->filename, O_CREAT, 0600);
+			if (tc->flag) {
+				SAFE_IOCTL(*(tc->fd), FS_IOC_GETFLAGS, &attr);
+				attr |= tc->flag;
+				SAFE_IOCTL(*(tc->fd), FS_IOC_SETFLAGS, &attr);
+			}
+		} else {
+			SAFE_TOUCH(tc->filename, 0600, 0);
+		}
+	}
+}
+
+static struct tst_test test = {
+	.setup = setup,
+	.tcnt = ARRAY_SIZE(tcases),
+	.cleanup = cleanup,
+	.test = verify_unlink,
+	.needs_rofs = 1,
+	.mntpoint = DIR_EROFS,
+	.needs_root = 1,
+};
diff --git a/testcases/kernel/syscalls/ustat/ustat01.c b/testcases/kernel/syscalls/ustat/ustat01.c
index 70a44adb4..161006058 100644
--- a/testcases/kernel/syscalls/ustat/ustat01.c
+++ b/testcases/kernel/syscalls/ustat/ustat01.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2003.  All Rights Reserved.
  *
diff --git a/testcases/kernel/syscalls/ustat/ustat02.c b/testcases/kernel/syscalls/ustat/ustat02.c
index a5b0cc1b6..84becaa1f 100644
--- a/testcases/kernel/syscalls/ustat/ustat02.c
+++ b/testcases/kernel/syscalls/ustat/ustat02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) Wipro Technologies Ltd, 2002.  All Rights Reserved.
  *
@@ -30,9 +30,7 @@ static struct test_case_t {
 	struct ustat *buf;
 } tc[] = {
 	{"Invalid parameter", EINVAL, "EINVAL", &invalid_dev, &ubuf},
-#ifndef UCLINUX
 	{"Bad address", EFAULT, "EFAULT", &root_dev, (void*)-1}
-#endif
 };
 
 int TST_TOTAL = ARRAY_SIZE(tc);
diff --git a/testcases/kernel/syscalls/utime/.gitignore b/testcases/kernel/syscalls/utime/.gitignore
index 94c0ae07c..403764521 100644
--- a/testcases/kernel/syscalls/utime/.gitignore
+++ b/testcases/kernel/syscalls/utime/.gitignore
@@ -4,3 +4,4 @@
 /utime04
 /utime05
 /utime06
+/utime07
diff --git a/testcases/kernel/syscalls/utime/utime07.c b/testcases/kernel/syscalls/utime/utime07.c
new file mode 100644
index 000000000..3aff2c8ef
--- /dev/null
+++ b/testcases/kernel/syscalls/utime/utime07.c
@@ -0,0 +1,99 @@
+// SPDX-License-Identifier: GPL-2.0-only
+/*
+ * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
+ * Authors: David Fenner, Jon Hendrickson
+ * Copyright (C) 2024 Andrea Cervesato <andrea.cervesato@suse.com>
+ */
+
+/*\
+ * [Description]
+ *
+ * This test verifies that utime() is working correctly on symlink()
+ * generated files.
+ *
+ * Also verify if utime() fails with:
+ *
+ * - ENOENT when symlink points to nowhere
+ * - ELOOP when symlink is looping
+ */
+
+#include <utime.h>
+#include "tst_test.h"
+
+#define TIME_DIFF 100
+
+static void create_symlink(const char *path, const char *symname)
+{
+	struct stat asymlink;
+
+	SAFE_SYMLINK(path, symname);
+	SAFE_LSTAT(symname, &asymlink);
+
+	if ((asymlink.st_mode & S_IFMT) != S_IFLNK) {
+		tst_brk(TBROK, "symlink generated a non-symbolic link %s to %s",
+			symname, path);
+	}
+}
+
+static void test_utime(void)
+{
+	char *symname = "my_symlink0";
+	struct stat oldsym_stat;
+	struct stat newsym_stat;
+
+	tst_res(TINFO, "Test if utime() changes access time");
+
+	create_symlink(tst_get_tmpdir(), symname);
+	SAFE_STAT(symname, &oldsym_stat);
+
+	struct utimbuf utimes = {
+		.actime = oldsym_stat.st_atime + TIME_DIFF,
+		.modtime = oldsym_stat.st_mtime + TIME_DIFF
+	};
+
+	TST_EXP_PASS(utime(symname, &utimes));
+	SAFE_STAT(symname, &newsym_stat);
+
+	TST_EXP_EQ_LI(newsym_stat.st_atime - oldsym_stat.st_atime, TIME_DIFF);
+	TST_EXP_EQ_LI(newsym_stat.st_mtime - oldsym_stat.st_mtime, TIME_DIFF);
+
+	SAFE_UNLINK(symname);
+}
+
+static void test_utime_no_path(void)
+{
+	char *symname = "my_symlink1";
+	struct utimbuf utimes;
+
+	tst_res(TINFO, "Test if utime() raises ENOENT when symlink points to nowhere");
+
+	create_symlink("bc+eFhi!k", symname);
+	TST_EXP_FAIL(utime(symname, &utimes), ENOENT);
+
+	SAFE_UNLINK(symname);
+}
+
+static void test_utime_loop(void)
+{
+	char *symname = "my_symlink2";
+	struct utimbuf utimes;
+
+	tst_res(TINFO, "Test if utime() raises ELOOP when symlink is looping");
+
+	create_symlink(symname, symname);
+	TST_EXP_FAIL(utime(symname, &utimes), ELOOP);
+
+	SAFE_UNLINK(symname);
+}
+
+static void run(void)
+{
+	test_utime();
+	test_utime_no_path();
+	test_utime_loop();
+}
+
+static struct tst_test test = {
+	.test_all = run,
+	.needs_tmpdir = 1,
+};
diff --git a/testcases/kernel/syscalls/wait/wait01.c b/testcases/kernel/syscalls/wait/wait01.c
index aec91b911..8245898dd 100644
--- a/testcases/kernel/syscalls/wait/wait01.c
+++ b/testcases/kernel/syscalls/wait/wait01.c
@@ -16,7 +16,7 @@
 
 static void verify_wait(void)
 {
-	TST_EXP_FAIL(wait(NULL), ECHILD);
+	TST_EXP_FAIL2(wait(NULL), ECHILD);
 }
 
 static struct tst_test test = {
diff --git a/testcases/kernel/syscalls/wait/wait02.c b/testcases/kernel/syscalls/wait/wait02.c
index bc617f7ac..806557c1b 100644
--- a/testcases/kernel/syscalls/wait/wait02.c
+++ b/testcases/kernel/syscalls/wait/wait02.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2000 Silicon Graphics, Inc.  All Rights Reserved.
  *    AUTHOR		: William Roske
diff --git a/testcases/kernel/syscalls/waitid/waitid10.c b/testcases/kernel/syscalls/waitid/waitid10.c
index e55e88c23..9100cc2d7 100644
--- a/testcases/kernel/syscalls/waitid/waitid10.c
+++ b/testcases/kernel/syscalls/waitid/waitid10.c
@@ -76,4 +76,5 @@ static struct tst_test test = {
 		{&infop, .size = sizeof(*infop)},
 		{},
 	},
+	.needs_tmpdir = 1,
 };
diff --git a/testcases/kernel/syscalls/waitpid/.gitignore b/testcases/kernel/syscalls/waitpid/.gitignore
index cf9ddf6fa..51a424653 100644
--- a/testcases/kernel/syscalls/waitpid/.gitignore
+++ b/testcases/kernel/syscalls/waitpid/.gitignore
@@ -1,8 +1,6 @@
 /waitpid01
-/waitpid02
 /waitpid03
 /waitpid04
-/waitpid05
 /waitpid06
 /waitpid07
 /waitpid08
diff --git a/testcases/kernel/syscalls/waitpid/waitpid01.c b/testcases/kernel/syscalls/waitpid/waitpid01.c
index 5a39a1107..1e38863e6 100644
--- a/testcases/kernel/syscalls/waitpid/waitpid01.c
+++ b/testcases/kernel/syscalls/waitpid/waitpid01.c
@@ -5,27 +5,101 @@
  * Copyright (c) 2018 Cyril Hrubis <chrubis@suse.cz>
  */
 
-/*
- * Check that when a child kills itself by SIGALRM the waiting parent is
- * correctly notified.
+/*\
+ * [Description]
+ *
+ * Check that when a child kills itself with one of the standard signals,
+ * the waiting parent is correctly notified.
  *
- * Fork a child that raises(SIGALRM), the parent checks that SIGALRM was
- * returned.
+ * Fork a child that sends given signal to itself using raise() or kill(),
+ * the parent checks that the signal was returned.
  */
 #include <stdlib.h>
 #include <sys/wait.h>
 #include "tst_test.h"
 
-static void run(void)
+static int test_coredump;
+static struct testcase {
+	int sig;
+	int coredump;
+} testcase_list[] = {
+	{SIGABRT, 1},
+	{SIGALRM, 0},
+	{SIGBUS, 1},
+	{SIGFPE, 1},
+	{SIGHUP, 0},
+	{SIGILL, 1},
+	{SIGINT, 0},
+	{SIGKILL, 0},
+	{SIGPIPE, 0},
+	{SIGPOLL, 0},
+	{SIGPROF, 0},
+	{SIGQUIT, 1},
+	{SIGSEGV, 1},
+	{SIGSYS, 1},
+	{SIGTERM, 0},
+	{SIGTRAP, 1},
+	{SIGUSR1, 0},
+	{SIGUSR2, 0},
+	{SIGVTALRM, 0},
+	{SIGXCPU, 1},
+	{SIGXFSZ, 1}
+};
+
+static void child_raise(int sig)
+{
+	raise(sig);
+	exit(0);
+}
+
+static void child_kill(int sig)
+{
+	kill(getpid(), sig);
+	exit(0);
+}
+
+static struct testvariant {
+	void (*func)(int sig);
+	const char *desc;
+} variant_list[] = {
+	{child_raise, "raise(sig)"},
+	{child_kill, "kill(getpid(), sig)"}
+};
+
+static void setup(void)
+{
+	struct rlimit lim = { 0 };
+
+	/* Disable core dumps */
+	SAFE_GETRLIMIT(RLIMIT_CORE, &lim);
+
+	if (lim.rlim_max) {
+		lim.rlim_cur = getpagesize();
+
+		if (lim.rlim_max > 0 && lim.rlim_max < lim.rlim_cur)
+			lim.rlim_cur = lim.rlim_max;
+
+		SAFE_SETRLIMIT(RLIMIT_CORE, &lim);
+		test_coredump = 1;
+	} else {
+		tst_res(TCONF, "Skipping coredump tests due to low rlimit");
+	}
+
+	tst_res(TINFO, "Testing child: %s", variant_list[tst_variant].desc);
+}
+
+static void run(unsigned int n)
 {
 	pid_t pid;
 	int status;
+	const struct testcase *tc = testcase_list + n;
+
+	if (tc->sig != SIGKILL)
+		SAFE_SIGNAL(tc->sig, SIG_DFL);
 
 	pid = SAFE_FORK();
-	if (!pid) {
-		raise(SIGALRM);
-		exit(0);
-	}
+	if (!pid)
+		variant_list[tst_variant].func(tc->sig);
 
 	TST_EXP_PID_SILENT(waitpid(pid, &status, 0));
 	if (!TST_PASS)
@@ -40,22 +114,43 @@ static void run(void)
 
 	if (!WIFSIGNALED(status)) {
 		tst_res(TFAIL, "WIFSIGNALED() not set in status (%s)",
-		        tst_strstatus(status));
+			tst_strstatus(status));
 		return;
 	}
 
 	tst_res(TPASS, "WIFSIGNALED() set in status");
 
-	if (WTERMSIG(status) != SIGALRM) {
-		tst_res(TFAIL, "WTERMSIG() != SIGALRM but %s",
-		        tst_strsig(WTERMSIG(status)));
+	if (WTERMSIG(status) != tc->sig) {
+		tst_res(TFAIL, "WTERMSIG() != %s but %s", tst_strsig(tc->sig),
+			tst_strsig(WTERMSIG(status)));
+		return;
+	}
+
+	tst_res(TPASS, "WTERMSIG() == %s", tst_strsig(tc->sig));
+
+	if (!test_coredump)
+		return;
+
+	if (!tc->coredump) {
+		if (WCOREDUMP(status))
+			tst_res(TFAIL, "Child unexpectedly dumped core");
+
+		return;
+	}
+
+	if (!WCOREDUMP(status)) {
+		tst_res(TFAIL, "Child did not dump core when expected");
 		return;
 	}
 
-	tst_res(TPASS, "WTERMSIG() == SIGALRM");
+	tst_res(TPASS, "Child dumped core as expected");
 }
 
 static struct tst_test test = {
 	.forks_child = 1,
-	.test_all = run,
+	.setup = setup,
+	.test = run,
+	.tcnt = ARRAY_SIZE(testcase_list),
+	.test_variants = ARRAY_SIZE(variant_list),
+	.needs_tmpdir = 1	/* for coredumps */
 };
diff --git a/testcases/kernel/syscalls/waitpid/waitpid02.c b/testcases/kernel/syscalls/waitpid/waitpid02.c
deleted file mode 100644
index 1164a7834..000000000
--- a/testcases/kernel/syscalls/waitpid/waitpid02.c
+++ /dev/null
@@ -1,167 +0,0 @@
-/*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- */
-
-/*
- * NAME
- *	waitpid02.c
- *
- * DESCRIPTION
- *	Check that when a child gets killed by an integer zero
- *	divide exception, the waiting parent is correctly notified.
- *
- * ALGORITHM
- *	Fork a child and send a SIGFPE to it. The parent waits for the
- *	death of the child and checks that SIGFPE was returned.
- *
- * USAGE:  <for command-line>
- *      waitpid02 [-c n] [-e] [-i n] [-I x] [-P x] [-t]
- *      where,  -c n : Run n copies concurrently.
- *              -e   : Turn on errno logging.
- *              -i n : Execute test n times.
- *              -I x : Execute test for x seconds.
- *              -P x : Pause for x seconds between iterations.
- *              -t   : Turn on syscall timing.
- *
- * History
- *	07/2001 John George
- *		-Ported
- *	10/2002 Paul Larson
- *		Div by zero doesn't cause SIGFPE on some archs, fixed
- *		to send the signal with kill
- *
- * Restrictions
- *	None
- */
-
-#include <sys/file.h>
-#include <sys/resource.h>
-#include <sys/signal.h>
-#include <sys/types.h>
-#include <sys/wait.h>
-#include <errno.h>
-#include "test.h"
-
-static void do_child(void);
-static void setup(void);
-
-char *TCID = "waitpid02";
-int TST_TOTAL = 1;
-
-int main(int argc, char **argv)
-{
-	int lc;
-
-	int pid, npid, sig, nsig;
-	int nexno, status;
-
-	tst_parse_opts(argc, argv, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "");
-#endif
-
-	setup();
-
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		tst_count = 0;
-
-		sig = SIGFPE;
-
-		pid = FORK_OR_VFORK();
-
-		if (pid < 0)
-			tst_brkm(TBROK|TERRNO, NULL, "fork failed");
-
-		if (pid == 0) {
-#ifdef UCLINUX
-			self_exec(argv[0], "");
-			/* No fork() error check is done so don't check here */
-#else
-			do_child();
-#endif
-		} else {
-			kill(pid, sig);
-			errno = 0;
-			while (((npid = waitpid(pid, &status, 0)) != -1) ||
-			       (errno == EINTR)) {
-				if (errno == EINTR)
-					continue;
-
-				if (npid != pid) {
-					tst_resm(TFAIL, "waitpid error: "
-						 "unexpected pid returned");
-				} else {
-					tst_resm(TPASS,
-						 "received expected pid");
-				}
-
-				nsig = WTERMSIG(status);
-
-				/*
-				 * nsig is the signal number returned by
-				 * waitpid
-				 */
-				if (nsig != sig) {
-					tst_resm(TFAIL, "waitpid error: "
-						 "unexpected signal returned");
-				} else {
-					tst_resm(TPASS, "received expected "
-						 "signal");
-				}
-
-				/*
-				 * nexno is the exit number returned by
-				 * waitpid
-				 */
-				nexno = WEXITSTATUS(status);
-				if (nexno != 0) {
-					tst_resm(TFAIL, "signal error: "
-						 "unexpected exit number "
-						 "returned");
-				} else {
-					tst_resm(TPASS, "received expected "
-						 "exit value");
-				}
-			}
-		}
-	}
-
-	tst_exit();
-}
-
-static void do_child(void)
-{
-	int exno = 1;
-
-	while (1)
-		usleep(10);
-
-	exit(exno);
-}
-
-static void setup(void)
-{
-	/* SIGFPE is expected signal, so avoid creating any corefile.
-	 * '1' is a special value, that will also avoid dumping via pipe. */
-	struct rlimit r;
-	r.rlim_cur = 1;
-	r.rlim_max = 1;
-	setrlimit(RLIMIT_CORE, &r);
-
-	TEST_PAUSE;
-}
diff --git a/testcases/kernel/syscalls/waitpid/waitpid03.c b/testcases/kernel/syscalls/waitpid/waitpid03.c
index 7eae3ad5a..b2ee0549c 100644
--- a/testcases/kernel/syscalls/waitpid/waitpid03.c
+++ b/testcases/kernel/syscalls/waitpid/waitpid03.c
@@ -1,194 +1,80 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2001
+ * Copyright (c) 2024 SUSE LLC <mdoucha@suse.cz>
  */
 
-/*
- * NAME
- *	waitpid03.c
- *
- * DESCRIPTION
- *	Check that parent waits unitl specific child has returned.
- *
- * ALGORITHM
- *	Parent forks numerous (22 = MAXUPRC - 3) children, and starts waits :
- *	Should only wait for the specific child, a second wait on the same
- *	child should return with -1 and not one of the other zombied
- *	children.
+/*\
+ * [Description]
  *
- * USAGE:  <for command-line>
- *      waitpid03 [-c n] [-i n] [-I x] [-P x] [-t]
- *      where,  -c n : Run n copies concurrently.
- *              -i n : Execute test n times.
- *              -I x : Execute test for x seconds.
- *              -P x : Pause for x seconds between iterations.
- *              -t   : Turn on syscall timing.
- *
- * History
- *	07/2001 John George
- *		-Ported
- *	04/2002 wjhuie sigset cleanups
- *
- * Restrictions
- *	None
+ * Check that waitpid() returns the exit status of a specific child process
+ * and repeated call on the same process will fail with ECHILD.
  */
 
-#define DEBUG 0
-
+#include <stdlib.h>
 #include <sys/types.h>
 #include <signal.h>
 #include <errno.h>
 #include <sys/wait.h>
-#include "test.h"
 
-static void do_child(int);
-static void setup(void);
-static void cleanup(void);
+#include "tst_test.h"
 
-char *TCID = "waitpid03";
-int TST_TOTAL = 1;
+#define	MAX_CHILDREN 25
 
-#define	MAXUPRC	25
+static pid_t children[MAX_CHILDREN];
 
-static int ikids;
-static int pid[MAXUPRC];
-static int condition_number;
+static void check_waitpid(pid_t pid, int reaped)
+{
+	TEST(waitpid(pid, NULL, 0));
 
-#ifdef UCLINUX
-static void do_child_uclinux(void);
-static int ikids_uclinux;
-#endif
+	if (!reaped && pid == (pid_t)TST_RET) {
+		tst_res(TPASS, "waitpid(%d) returned correct PID", pid);
+		return;
+	}
 
-int main(int argc, char **argv)
-{
-	int lc;
-
-	int status, ret;
-
-	tst_parse_opts(argc, argv, NULL, NULL);
-#ifdef UCLINUX
-	maybe_run_child(&do_child, "d", &ikids_uclinux);
-#endif
-
-	setup();
-
-	/* check for looping state if -i option is given */
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		/* reset tst_count in case we are looping */
-		tst_count = 0;
-
-		/*
-		 * Set SIGTERM to SIG_DFL as test driver sets up to ignore
-		 * SIGTERM
-		 */
-		if ((sig_t) signal(SIGTERM, SIG_DFL) == SIG_ERR) {
-			tst_resm(TFAIL, "Signal SIGTERM failed, errno = %d",
-				 errno);
-
-		}
-
-		while (++ikids < MAXUPRC) {
-			pid[ikids] = FORK_OR_VFORK();
-			if (pid[ikids] > 0) {
-				if (DEBUG)
-					tst_resm(TINFO, "child # %d", ikids);
-			} else if (pid[ikids] == -1) {
-				tst_brkm(TBROK|TERRNO, cleanup, "cannot open "
-					"fork #%d", ikids);
-
-			} else {
-#ifdef UCLINUX
-				if (self_exec(argv[0], "d", ikids) < 0) {
-					tst_resm(TFAIL, "cannot self_exec #%d",
-						 ikids);
-				}
-#else
-				do_child(ikids);
-#endif
-			}
-		}
-
-		for (ikids = 1; ikids < MAXUPRC; ikids++) {
-			if (DEBUG)
-				tst_resm(TINFO, "Killing #%d", ikids);
-			kill(pid[ikids], SIGTERM);
-		}
-
-		ikids = 0;
-		condition_number = 1;
-
-		/* Wait on one specific child */
-		if (DEBUG)
-			tst_resm(TINFO, "Waiting for child:#%d", MAXUPRC / 2);
-		ret = waitpid(pid[MAXUPRC / 2], &status, 0);
-		if (ret != pid[MAXUPRC / 2]) {
-			tst_resm(TFAIL, "condition %d test failed. "
-				 "waitpid(%d) returned %d.",
-				 condition_number, pid[MAXUPRC / 2], ret);
-		} else {
-			tst_resm(TPASS, "Got correct child PID");
-		}
-		condition_number++;
-
-		/*
-		 * Child has already been waited on, waitpid should return
-		 * -1
-		 */
-		ret = waitpid(pid[MAXUPRC / 2], &status, 0);
-		if (ret != -1) {
-			tst_resm(TFAIL, "condition %d test failed",
-				 condition_number);
-		} else {
-			tst_resm(TPASS, "Condition %d test passed",
-				 condition_number);
-		}
-		condition_number++;
+	if (reaped && TST_RET == -1 && TST_ERR == ECHILD) {
+		tst_res(TPASS | TTERRNO, "waitpid(%d) failed on reaped child",
+			pid);
+		return;
 	}
 
-	cleanup();
-	tst_exit();
-}
+	if (TST_RET == -1) {
+		tst_res(TFAIL | TTERRNO, "waitpid(%d) failed", pid);
+		return;
+	}
 
-static void do_child(int ikids)
-{
-	if (DEBUG)
-		tst_resm(TINFO, "child:%d", ikids);
-	pause();
-	exit(0);
-}
+	if (TST_RET < 0) {
+		tst_res(TFAIL | TTERRNO,
+			"Unexpected waitpid(%d) return value %ld", pid,
+			TST_RET);
+		return;
+	}
 
-#ifdef UCLINUX
-/*
- * do_child_uclinux()
- *	run do_child with the appropriate ikids variable
- */
-static void do_child_uclinux(void)
-{
-	do_child(ikids_uclinux);
+	tst_res(TFAIL, "waitpid(%d) returned unexpected PID %ld", pid, TST_RET);
 }
-#endif
 
-static void setup(void)
+static void run(void)
 {
-	TEST_PAUSE;
-}
+	int i;
 
-static void cleanup(void)
-{
-	while (ikids-- > 1)
-		kill(pid[ikids], SIGKILL);
+	for (i = 0; i < MAX_CHILDREN; i++) {
+		children[i] = SAFE_FORK();
+
+		/* Children have nothing to do... */
+		if (!children[i])
+			exit(0);
+	}
+
+	/* Wait for one specific child */
+	i = MAX_CHILDREN / 2;
+	check_waitpid(children[i], 0);
+
+	/* Try the same child again after it was reaped */
+	check_waitpid(children[i], 1);
+	tst_reap_children();
 }
+
+static struct tst_test test = {
+	.test_all = run,
+	.forks_child = 1
+};
diff --git a/testcases/kernel/syscalls/waitpid/waitpid04.c b/testcases/kernel/syscalls/waitpid/waitpid04.c
index abf94eed1..7e60ef6ab 100644
--- a/testcases/kernel/syscalls/waitpid/waitpid04.c
+++ b/testcases/kernel/syscalls/waitpid/waitpid04.c
@@ -1,144 +1,39 @@
+// SPDX-License-Identifier: GPL-2.0-or-later
 /*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
+ * Copyright (c) International Business Machines  Corp., 2001
+ * Copyright (c) 2024 SUSE LLC <mdoucha@suse.cz>
  */
 
-/*
- * NAME
- *	waitpid04.c
- *
- * DESCRIPTION
- *	test to check the error conditions in waitpid sys call
- *
- * USAGE:  <for command-line>
- *      waitpid04 [-c n] [-e] [-i n] [-I x] [-P x] [-t]
- *      where,  -c n : Run n copies concurrently.
- *              -e   : Turn on errno logging.
- *              -i n : Execute test n times.
- *              -I x : Execute test for x seconds.
- *              -P x : Pause for x seconds between iterations.
- *              -t   : Turn on syscall timing.
+/*\
+ * [Description]
  *
- * History
- *	07/2001 John George
- *		-Ported
- *
- * Restrictions
- *	NONE
+ * Test to check the error conditions in waitpid() syscall.
  */
 
-#include <sys/signal.h>
-#include <sys/types.h>
+#include <signal.h>
 #include <sys/wait.h>
-#include <errno.h>
-#include "test.h"
-
-static void setup(void);
-static void cleanup(void);
-
-char *TCID = "waitpid04";
-int TST_TOTAL = 1;
-
-#define INVAL_FLAG	-1
-
-static int flag, condition_number;
-
-int main(int ac, char **av)
+#include "tst_test.h"
+
+static struct testcase {
+	pid_t pid;
+	int flags;
+	int err;
+} testcase_list[] = {
+	{-1, 0, ECHILD},	/* Wait for any child when none exist */
+	{1, 0, ECHILD},		/* Wait for non-child process */
+	{-1, -1, EINVAL},	/* Invalid flags */
+	{INT_MIN, 0, ESRCH},	/* Wait for invalid process group */
+};
+
+static void run(unsigned int n)
 {
-	int pid, status, ret;
+	const struct testcase *tc = testcase_list + n;
 
-	int lc;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-	setup();
-
-	/* check for looping state if -i option is given */
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		/* reset tst_count in case we are looping */
-		tst_count = 0;
-
-		ret = waitpid(pid, &status, WNOHANG);
-		flag = 0;
-		condition_number = 1;
-		if (ret != -1) {
-			tst_resm(TFAIL, "condition %d test failed",
-				 condition_number);
-		} else {
-			if (errno != ECHILD) {
-				tst_resm(TFAIL, "waitpid() set invalid "
-					 "errno, expected ECHILD, got: %d",
-					 errno);
-			} else {
-				tst_resm(TPASS, "condition %d test passed",
-					 condition_number);
-			}
-		}
-		condition_number++;
-
-		if (FORK_OR_VFORK() == 0)
-			exit(0);
-
-		pid = 1;
-		ret = waitpid(pid, &status, WUNTRACED);
-		flag = 0;
-		if (ret != -1) {
-			tst_resm(TFAIL, "condition %d test failed",
-				 condition_number);
-		} else {
-			if (errno != ECHILD) {
-				tst_resm(TFAIL, "waitpid() set invalid "
-					 "errno, expected ECHILD, got: %d",
-					 errno);
-			} else {
-				tst_resm(TPASS, "condition %d test passed",
-					 condition_number);
-			}
-		}
-		condition_number++;
-
-		/* Option is Inval = INVAL_FLAG */
-		ret = waitpid(pid, &status, INVAL_FLAG);
-		flag = 0;
-		if (ret != -1) {
-			tst_resm(TFAIL, "condition %d test failed",
-				 condition_number);
-		} else {
-			if (errno != EINVAL) {
-				tst_resm(TFAIL, "waitpid() set invalid "
-					 "errno, expected EINVAL, got: %d",
-					 errno);
-			} else {
-				tst_resm(TPASS, "condition %d test passed",
-					 condition_number);
-			}
-		}
-		condition_number++;
-	}
-
-	cleanup();
-	tst_exit();
-}
-
-static void setup(void)
-{
-	TEST_PAUSE;
+	TST_EXP_FAIL2(waitpid(tc->pid, NULL, tc->flags), tc->err,
+		"waipid(%d, NULL, 0x%x)", tc->pid, tc->flags);
 }
 
-static void cleanup(void)
-{
-}
+static struct tst_test test = {
+	.test = run,
+	.tcnt = ARRAY_SIZE(testcase_list)
+};
diff --git a/testcases/kernel/syscalls/waitpid/waitpid05.c b/testcases/kernel/syscalls/waitpid/waitpid05.c
deleted file mode 100644
index 5466fd911..000000000
--- a/testcases/kernel/syscalls/waitpid/waitpid05.c
+++ /dev/null
@@ -1,247 +0,0 @@
-/*
- *
- *   Copyright (c) International Business Machines  Corp., 2001
- *
- *   This program is free software;  you can redistribute it and/or modify
- *   it under the terms of the GNU General Public License as published by
- *   the Free Software Foundation; either version 2 of the License, or
- *   (at your option) any later version.
- *
- *   This program is distributed in the hope that it will be useful,
- *   but WITHOUT ANY WARRANTY;  without even the implied warranty of
- *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
- *   the GNU General Public License for more details.
- *
- *   You should have received a copy of the GNU General Public License
- *   along with this program;  if not, write to the Free Software
- *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- */
-
-/*
- * NAME
- *	waitpid05.c
- *
- * DESCRIPTION
- *	Check that when a child kills itself with a kill statement after
- *	determining its process id by using getpid, the parent receives a
- *	correct report of the cause of its death. This also indirectly
- *	checks that getpid returns the correct process id.
- *
- * ALGORITHM
- *	For signals 1 - 15: fork a child that determines it's own process
- *	id, then sends the signal to itself.  The parent waits to see if the
- *	demise of the child results in the signal number being returned to
- *	the parent.
- *
- * USAGE:  <for command-line>
- *      waitpid05 [-c n] [-e] [-i n] [-I x] [-P x] [-t]
- *      where,  -c n : Run n copies concurrently.
- *              -e   : Turn on errno logging.
- *              -i n : Execute test n times.
- *              -I x : Execute test for x seconds.
- *              -P x : Pause for x seconds between iterations.
- *              -t   : Turn on syscall timing.
- *
- * History
- *	07/2001 John George
- *		-Ported
- *	04/2002 wjhuie sigset cleanups
- *
- * Restrictions
- *	None
- */
-
-#include <sys/file.h>
-#include <sys/signal.h>
-#include <sys/types.h>
-#include <sys/wait.h>
-#include <sys/time.h>
-#include <sys/resource.h>
-#include <unistd.h>
-#include <errno.h>
-#include "test.h"
-
-static void do_child(int);
-static void setup(void);
-static void cleanup(void);
-
-char *TCID = "waitpid05";
-int TST_TOTAL = 1;
-
-#ifdef UCLINUX
-static void do_child_uclinux(void);
-static int sig_uclinux;
-#endif
-
-int main(int ac, char **av)
-{
-	int pid, npid, sig, nsig;
-	int exno, nexno, status;
-	int lc;
-
-	tst_parse_opts(ac, av, NULL, NULL);
-
-#ifdef UCLINUX
-	maybe_run_child(&do_child_uclinux, "d", &sig_uclinux);
-#endif
-
-	setup();
-
-	/* check for looping state if -i option is given */
-	for (lc = 0; TEST_LOOPING(lc); lc++) {
-		/* reset tst_count in case we are looping */
-		tst_count = 0;
-
-		/*
-		 * Set SIGTERM to SIG_DFL as test driver sets up to ignore
-		 * SIGTERM
-		 */
-		if (signal(SIGTERM, SIG_DFL) == SIG_ERR) {
-			tst_resm(TFAIL, "Sigset SIGTERM failed, errno = %d",
-				 errno);
-
-		}
-
-		exno = 1;
-		for (sig = 1; sig <= 15; sig++) {
-			if (sig == SIGUSR1 || sig == SIGUSR2 || sig == SIGBUS)
-				continue;
-
-			/*Initialize signal to its default action */
-			signal(sig, SIG_DFL);
-			pid = FORK_OR_VFORK();
-
-			if (pid == 0) {
-#ifdef UCLINUX
-				self_exec(av[0], "d", sig);
-				/* No fork() error check is done so don't */
-				/* do an error check here */
-#else
-				do_child(sig);
-#endif
-			} else {
-				errno = 0;
-				while (((npid = waitpid(pid, &status, 0)) !=
-					-1) || (errno == EINTR)) {
-					if (errno == EINTR)
-						continue;
-
-					if (npid != pid) {
-						tst_resm(TFAIL, "waitpid "
-							 "error: unexpected "
-							 "pid returned");
-					} else {
-						tst_resm(TPASS, "received "
-							 "expected pid.");
-					}
-
-					nsig = status % 256;
-
-					/*
-					 * to check if the core dump bit has
-					 * been set, bit #7
-					 */
-					if (nsig >= 128) {
-						nsig -= 128;
-						if ((sig == 1) || (sig == 2) ||
-						    (sig == 9) || (sig == 13) ||
-						    (sig == 14) ||
-						    (sig == 15)) {
-							tst_resm(TFAIL,
-								 "signal "
-								 "error : "
-								 "core dump "
-								 "bit set for"
-								 " exception "
-								 "number %d",
-								 sig);
-						}
-					} else if ((sig == 3) || (sig == 4) ||
-						   (sig == 5) || (sig == 6) ||
-						   (sig == 8) || (sig == 11)) {
-						tst_resm(TFAIL,
-							 "signal error: "
-							 "core dump bit not "
-							 "set for exception "
-							 "number %d", sig);
-					}
-
-					/*
-					 * nsig is the signal number returned
-					 * by waitpid
-					 */
-					if (nsig != sig) {
-						tst_resm(TFAIL, "waitpid "
-							 "error: unexpected "
-							 "signal returned");
-						tst_resm(TINFO, "got signal "
-							 "%d, expected  "
-							 "%d", nsig, sig);
-					}
-
-					/*
-					 * nexno is the exit number returned
-					 * by waitpid
-					 */
-					nexno = status / 256;
-					if (nexno != 0) {
-						tst_resm(TFAIL, "signal "
-							 "error: unexpected "
-							 "exit number "
-							 "returned");
-					} else {
-						tst_resm(TPASS, "received "
-							 "expected exit number.");
-					}
-				}
-			}
-		}
-
-		if (access("core", F_OK) == 0)
-			unlink("core");
-	}
-
-	cleanup();
-	tst_exit();
-}
-
-static void do_child(int sig)
-{
-	int exno = 1;
-	int pid = getpid();
-
-	if (kill(pid, sig) == -1) {
-		tst_resm(TFAIL, "kill error: kill unsuccessful");
-		exit(exno);
-	}
-}
-
-#ifdef UCLINUX
-/*
- * do_child_uclinux()
- *	run do_child with the appropriate sig variable
- */
-static void do_child_uclinux(void)
-{
-	do_child(sig_uclinux);
-}
-#endif
-
-static void setup(void)
-{
-	struct rlimit newlimit;
-
-	TEST_PAUSE;
-
-	tst_tmpdir();
-
-	newlimit.rlim_max = newlimit.rlim_cur = RLIM_INFINITY;
-	if (setrlimit(RLIMIT_CORE, &newlimit) != 0)
-		tst_resm(TWARN,
-			 "setrlimit(RLIMIT_CORE,RLIM_INFINITY) failed; this may cause some false core-dump test failures");
-}
-
-static void cleanup(void)
-{
-	tst_rmdir();
-}
diff --git a/testcases/kernel/syscalls/writev/Makefile b/testcases/kernel/syscalls/writev/Makefile
index 6627abaed..2eb46974e 100644
--- a/testcases/kernel/syscalls/writev/Makefile
+++ b/testcases/kernel/syscalls/writev/Makefile
@@ -3,10 +3,6 @@
 
 top_srcdir		?= ../../../..
 
-ifeq ($(UCLINUX),1)
-FILTER_OUT_MAKE_TARGETS	+= writev02
-endif
-
 include $(top_srcdir)/include/mk/testcases.mk
 
 writev03: CFLAGS += -pthread
diff --git a/testcases/kernel/syscalls/writev/writev02.c b/testcases/kernel/syscalls/writev/writev02.c
index 005f37a14..a7d11de30 100644
--- a/testcases/kernel/syscalls/writev/writev02.c
+++ b/testcases/kernel/syscalls/writev/writev02.c
@@ -179,8 +179,7 @@ void setup(void)
 	strcpy(name, DATA_FILE);
 	sprintf(f_name, "%s.%d", name, getpid());
 
-	bad_addr = mmap(0, 1, PROT_NONE,
-			MAP_PRIVATE_EXCEPT_UCLINUX | MAP_ANONYMOUS, 0, 0);
+	bad_addr = mmap(0, 1, PROT_NONE, MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
 	if (bad_addr == MAP_FAILED)
 		tst_brkm(TBROK | TERRNO, cleanup, "mmap failed");
 	wr_iovec[0].iov_base = bad_addr;
diff --git a/testcases/kernel/syscalls/writev/writev05.c b/testcases/kernel/syscalls/writev/writev05.c
index c939e7de0..3bee6f59c 100644
--- a/testcases/kernel/syscalls/writev/writev05.c
+++ b/testcases/kernel/syscalls/writev/writev05.c
@@ -83,8 +83,6 @@ long l_seek(int, long, int);
 void setup(void);
 void cleanup(void);
 
-#if !defined(UCLINUX)
-
 int main(int argc, char **argv)
 {
 	int lc;
@@ -178,16 +176,6 @@ int main(int argc, char **argv)
 
 }
 
-#else
-
-int main(void)
-{
-	tst_resm(TINFO, "test is not available on uClinux");
-	tst_exit();
-}
-
-#endif /* if !defined(UCLINUX) */
-
 /*
  * setup()
  *	performs all ONE TIME setup for this test
@@ -210,8 +198,7 @@ void setup(void)
 	strcpy(name, DATA_FILE);
 	sprintf(f_name, "%s.%d", name, getpid());
 
-	bad_addr = mmap(0, 1, PROT_NONE,
-			MAP_PRIVATE_EXCEPT_UCLINUX | MAP_ANONYMOUS, 0, 0);
+	bad_addr = mmap(0, 1, PROT_NONE, MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
 	if (bad_addr == MAP_FAILED) {
 		printf("mmap failed\n");
 	}
diff --git a/testcases/kernel/syscalls/writev/writev06.c b/testcases/kernel/syscalls/writev/writev06.c
index e97ae6f21..b60c727b6 100644
--- a/testcases/kernel/syscalls/writev/writev06.c
+++ b/testcases/kernel/syscalls/writev/writev06.c
@@ -162,22 +162,22 @@ void setup(void)
 	/* Crate two readable and writeble mappings with non reabable
 	 * mapping around */
 	bad_addr[0] = mmap(NULL, page_size * 3, PROT_NONE,
-			   MAP_PRIVATE_EXCEPT_UCLINUX | MAP_ANONYMOUS, 0, 0);
+			   MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
 	if (bad_addr[0] == MAP_FAILED)
 		tst_brkm(TBROK, cleanup, "mmap failed for bad_addr[0]");
 
 	good_addr[0] = mmap(NULL, page_size, PROT_READ | PROT_WRITE,
-			    MAP_PRIVATE_EXCEPT_UCLINUX | MAP_ANONYMOUS, 0, 0);
+			    MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
 	if (good_addr[0] == MAP_FAILED)
 		tst_brkm(TBROK, cleanup, "mmap failed for good_addr[0]");
 
 	bad_addr[1] = mmap(NULL, page_size * 3, PROT_NONE,
-			   MAP_PRIVATE_EXCEPT_UCLINUX | MAP_ANONYMOUS, 0, 0);
+			   MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
 	if (bad_addr[1] == MAP_FAILED)
 		tst_brkm(TBROK, cleanup, "mmap failed for bad_addr[1]");
 
 	good_addr[1] = mmap(NULL, page_size, PROT_READ | PROT_WRITE,
-			    MAP_PRIVATE_EXCEPT_UCLINUX | MAP_ANONYMOUS, 0, 0);
+			    MAP_PRIVATE | MAP_ANONYMOUS, 0, 0);
 	if (good_addr[1] == MAP_FAILED)
 		tst_brkm(TBROK, cleanup, "mmap failed for good_addr[1]");
 
diff --git a/testcases/lib/tst_net.sh b/testcases/lib/tst_net.sh
index 6cf7f2fcb..ee0ae1cad 100644
--- a/testcases/lib/tst_net.sh
+++ b/testcases/lib/tst_net.sh
@@ -928,7 +928,10 @@ tst_ping()
 		c) ping_count="$OPTARG";;
 		s) msg_sizes="$OPTARG";;
 		p) pattern_opt="-p $OPTARG";;
-		I) src_iface="$OPTARG";;
+		I) src_iface="$OPTARG"
+		   tst_ping_opt_unsupported -I $OPTARG && \
+			   tst_brk_ TCONF "unsupported ping version (ping from inetutils?)"
+		   ;;
 		H) dst_addr="$OPTARG";;
 		*) tst_brk_ TBROK "tst_ping: unknown option: $OPTARG";;
 		esac
diff --git a/testcases/lib/tst_ns_create.c b/testcases/lib/tst_ns_create.c
index 1c6258cd1..ce3707a60 100644
--- a/testcases/lib/tst_ns_create.c
+++ b/testcases/lib/tst_ns_create.c
@@ -57,7 +57,7 @@ static void child_fn(void)
 
 int main(int argc, char *argv[])
 {
-	struct tst_clone_args args = { 0, SIGCHLD };
+	struct tst_clone_args args = { .exit_signal = SIGCHLD };
 	char *token;
 	int pid;
 
diff --git a/testcases/lib/tst_ns_exec.c b/testcases/lib/tst_ns_exec.c
index 66a4e69d3..6a8e39339 100644
--- a/testcases/lib/tst_ns_exec.c
+++ b/testcases/lib/tst_ns_exec.c
@@ -67,7 +67,7 @@ static void close_ns_fd(void)
 
 int main(int argc, char *argv[])
 {
-	struct tst_clone_args args = { 0, SIGCHLD };
+	struct tst_clone_args args = { .exit_signal = SIGCHLD };
 	int i, status, pid;
 	char *token;
 
diff --git a/testcases/network/README.md b/testcases/network/README.md
index e1b1296d6..0b64df01e 100644
--- a/testcases/network/README.md
+++ b/testcases/network/README.md
@@ -88,6 +88,13 @@ Tests which use `tst_netload_compare()` test also performance. They can fail on
 overloaded SUT.  To ignore performance failure and test only the network functionality,
 set `LTP_NET_FEATURES_IGNORE_PERFORMANCE_FAILURE=1` environment variable.
 
+## Dependencies
+
+Some network tests which use `tst_ping()` function require `ping` with `-I` support,
+which is not supported by `ping` from [inetutils](https://www.gnu.org/software/inetutils/).
+Use `ping` from [iputils](https://github.com/iputils/iputils/) or from [BusyBox](https://busybox.net/)
+(configured with `CONFIG_FEATURE_IPV6=y` `CONFIG_FEATURE_FANCY_PING=y`).
+
 ## Debugging
 Both single and two host configurations support debugging via
 `TST_NET_RHOST_RUN_DEBUG=1` environment variable.
diff --git a/testcases/network/dhcp/dnsmasq_tests.sh b/testcases/network/dhcp/dnsmasq_tests.sh
index 0183c1da2..c0b7686a3 100755
--- a/testcases/network/dhcp/dnsmasq_tests.sh
+++ b/testcases/network/dhcp/dnsmasq_tests.sh
@@ -33,12 +33,12 @@ print_dhcp_version()
 	dnsmasq --version | head -2
 }
 
+dhcp_name="dnsmasq"
 . dhcp_lib.sh
 
 lease_dir="/var/lib/misc"
 tst_selinux_enforced && lease_dir="/var/lib/dnsmasq"
 
-dhcp_name="dnsmasq"
 log="/var/log/dnsmasq.tst.log"
 
 lease_file="$lease_dir/dnsmasq.tst.leases"
diff --git a/testcases/network/iptables/nft02.c b/testcases/network/iptables/nft02.c
index 20475fee4..8b7248c69 100644
--- a/testcases/network/iptables/nft02.c
+++ b/testcases/network/iptables/nft02.c
@@ -42,27 +42,27 @@ static struct tst_netlink_context *ctx;
 
 /* Table creation config */
 static const struct tst_netlink_attr_list table_config[] = {
-	{NFTA_TABLE_NAME, TABNAME, sizeof(TABNAME), NULL},
+	{NFTA_TABLE_NAME, TABNAME, strlen(TABNAME) + 1, NULL},
 	{0, NULL, -1, NULL}
 };
 
 /* Chain creation and deletion config */
 static const struct tst_netlink_attr_list destchain_config[] = {
-	{NFTA_TABLE_NAME, TABNAME, sizeof(TABNAME), NULL},
-	{NFTA_CHAIN_NAME, DESTCHAIN, sizeof(DESTCHAIN), NULL},
+	{NFTA_TABLE_NAME, TABNAME, strlen(TABNAME) + 1, NULL},
+	{NFTA_CHAIN_NAME, DESTCHAIN, strlen(DESTCHAIN) + 1, NULL},
 	{NFTA_CHAIN_ID, &chain_id, sizeof(chain_id), NULL},
 	{0, NULL, -1, NULL}
 };
 
 static const struct tst_netlink_attr_list delchain_config[] = {
-	{NFTA_TABLE_NAME, TABNAME, sizeof(TABNAME), NULL},
-	{NFTA_CHAIN_NAME, DESTCHAIN, sizeof(DESTCHAIN), NULL},
+	{NFTA_TABLE_NAME, TABNAME, strlen(TABNAME) + 1, NULL},
+	{NFTA_CHAIN_NAME, DESTCHAIN, strlen(DESTCHAIN) + 1, NULL},
 	{0, NULL, -1, NULL}
 };
 
 static const struct tst_netlink_attr_list srcchain_config[] = {
-	{NFTA_TABLE_NAME, TABNAME, sizeof(TABNAME), NULL},
-	{NFTA_CHAIN_NAME, SRCCHAIN, sizeof(SRCCHAIN), NULL},
+	{NFTA_TABLE_NAME, TABNAME, strlen(TABNAME) + 1, NULL},
+	{NFTA_CHAIN_NAME, SRCCHAIN, strlen(SRCCHAIN) + 1, NULL},
 	{0, NULL, -1, NULL}
 };
 
@@ -93,8 +93,8 @@ static const struct tst_netlink_attr_list rule_expr_config[] = {
 
 static const struct tst_netlink_attr_list rule_config[] = {
 	{NFTA_RULE_EXPRESSIONS, NULL, 0, rule_expr_config},
-	{NFTA_RULE_TABLE, TABNAME, sizeof(TABNAME), NULL},
-	{NFTA_RULE_CHAIN, SRCCHAIN, sizeof(SRCCHAIN), NULL},
+	{NFTA_RULE_TABLE, TABNAME, strlen(TABNAME) + 1, NULL},
+	{NFTA_RULE_CHAIN, SRCCHAIN, strlen(SRCCHAIN) + 1, NULL},
 	{0, NULL, -1, NULL}
 };
 
diff --git a/testcases/network/nfs/nfs_stress/nfs09.sh b/testcases/network/nfs/nfs_stress/nfs09.sh
new file mode 100755
index 000000000..88c1a1ec5
--- /dev/null
+++ b/testcases/network/nfs/nfs_stress/nfs09.sh
@@ -0,0 +1,34 @@
+#!/bin/sh
+# SPDX-License-Identifier: GPL-2.0-or-later
+# Copyright (C) 2024 SUSE LLC <mdoucha@suse.cz>
+#
+# DESCRIPTION: Check that stale NFS client cache does not prevent file
+# truncation.
+#
+# 1. Through NFS, access metadata of a file that does not exist
+# 2. Create the file on the remote end (bypassing NFS)
+# 3. Through NFS, try to overwrite the file with shorter data
+
+TST_TESTFUNC="do_test"
+
+do_test()
+{
+	local local_file="testfile"
+	local remote_file="$(nfs_get_remote_path)/$local_file"
+	local testmsg='File truncated'
+	local data
+
+	EXPECT_FAIL "ls -l '$local_file'"
+	tst_rhost_run -c "echo -n 'File rewritten not' >'$remote_file'"
+	echo -n "$testmsg" >"$local_file"
+	data=$(tst_rhost_run -c "cat '$remote_file'")
+
+	if [ "$data" != "$testmsg" ]; then
+		tst_res TFAIL "Wrong file contents, expected '$testmsg', got '$data'"
+	else
+		tst_res TPASS "File was truncated correctly"
+	fi
+}
+
+. nfs_lib.sh
+tst_run
diff --git a/testcases/network/nfs/nfsstat01/nfsstat01.sh b/testcases/network/nfs/nfsstat01/nfsstat01.sh
index 6589c0930..c2856eff1 100755
--- a/testcases/network/nfs/nfsstat01/nfsstat01.sh
+++ b/testcases/network/nfs/nfsstat01/nfsstat01.sh
@@ -11,20 +11,33 @@ get_calls()
 	local name=$1
 	local field=$2
 	local nfs_f=$3
-	local calls=
-	local opt=
+	local type="lhost"
+	local calls opt
+
 	[ "$name" = "rpc" ] && opt="r" || opt="n"
+	! tst_net_use_netns && [ "$nfs_f" != "nfs" ] && type="rhost"
 
-	if tst_net_use_netns || [ "$nfs_f" = "nfs" ]; then
+	if [ "$type" = "lhost" ]; then
 		calls="$(grep $name /proc/net/rpc/$nfs_f | cut -d' ' -f$field)"
 		ROD nfsstat -c$opt | grep -q "$calls"
-		echo "$calls"
-		return
+	else
+		calls=$(tst_rhost_run -c "grep $name /proc/net/rpc/$nfs_f" | \
+			cut -d' ' -f$field)
+		tst_rhost_run -s -c "nfsstat -s$opt" | grep -q "$calls"
+	fi
+
+	if ! tst_is_int "$calls"; then
+		if [ "$type" = "lhost" ]; then
+			tst_res TINFO "lhost /proc/net/rpc/$nfs_f"
+			cat /proc/net/rpc/$nfs_f >&2
+		else
+			tst_res TINFO "rhost /proc/net/rpc/$nfs_f"
+			tst_rhost_run -c "cat /proc/net/rpc/$nfs_f" >&2
+		fi
+
+		tst_res TWARN "get_calls: failed to get integer value (args: $@)"
 	fi
 
-	calls=$(tst_rhost_run -c "grep $name /proc/net/rpc/$nfs_f" | \
-		cut -d' ' -f$field)
-	tst_rhost_run -s -c "nfsstat -s$opt" | grep -q "$calls"
 	echo "$calls"
 }
 
@@ -32,18 +45,22 @@ get_calls()
 #           tracking using the 'nfsstat' command and /proc/net/rpc
 do_test()
 {
+	local client_calls server_calls new_server_calls new_client_calls
+	local client_field server_field
+	local client_v=$VERSION server_v=$VERSION
+
 	tst_res TINFO "checking RPC calls for server/client"
 
-	local server_calls="$(get_calls rpc 2 nfsd)"
-	local client_calls="$(get_calls rpc 2 nfs)"
+	server_calls="$(get_calls rpc 2 nfsd)"
+	client_calls="$(get_calls rpc 2 nfs)"
 
 	tst_res TINFO "calls $server_calls/$client_calls"
 
 	tst_res TINFO "Checking for tracking of RPC calls for server/client"
 	cat /proc/cpuinfo > nfsstat01.tmp
 
-	local new_server_calls="$(get_calls rpc 2 nfsd)"
-	local new_client_calls="$(get_calls rpc 2 nfs)"
+	new_server_calls="$(get_calls rpc 2 nfsd)"
+	new_client_calls="$(get_calls rpc 2 nfs)"
 	tst_res TINFO "new calls $new_server_calls/$new_client_calls"
 
 	if [ "$new_server_calls" -le "$server_calls" ]; then
@@ -59,23 +76,24 @@ do_test()
 	fi
 
 	tst_res TINFO "checking NFS calls for server/client"
-	local field=
 	case $VERSION in
-	2) field=13
+	2) client_field=13 server_field=13
+	;;
+	3) client_field=15 server_field=15
 	;;
-	*) field=15
+	4*) client_field=24 server_field=31 client_v=4 server_v=4ops
 	;;
 	esac
 
-	server_calls="$(get_calls proc$VERSION $field nfsd)"
-	client_calls="$(get_calls proc$VERSION $field nfs)"
+	server_calls="$(get_calls proc$server_v $server_field nfsd)"
+	client_calls="$(get_calls proc$client_v $client_field nfs)"
 	tst_res TINFO "calls $server_calls/$client_calls"
 
 	tst_res TINFO "Checking for tracking of NFS calls for server/client"
 	rm -f nfsstat01.tmp
 
-	new_server_calls="$(get_calls proc$VERSION $field nfsd)"
-	new_client_calls="$(get_calls proc$VERSION $field nfs)"
+	new_server_calls="$(get_calls proc$server_v $server_field nfsd)"
+	new_client_calls="$(get_calls proc$client_v $client_field nfs)"
 	tst_res TINFO "new calls $new_server_calls/$new_client_calls"
 
 	if [ "$new_server_calls" -le "$server_calls" ]; then
diff --git a/testcases/network/tcp_cmds/clockdiff/Makefile b/testcases/network/tcp_cmds/clockdiff/Makefile
deleted file mode 100644
index d2e72519a..000000000
--- a/testcases/network/tcp_cmds/clockdiff/Makefile
+++ /dev/null
@@ -1,10 +0,0 @@
-# SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) 2016-2019 Oracle and/or its affiliates. All Rights Reserved.
-
-top_srcdir		?= ../../../..
-
-include $(top_srcdir)/include/mk/env_pre.mk
-
-INSTALL_TARGETS		:= clockdiff01.sh
-
-include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/network/tcp_cmds/clockdiff/clockdiff01.sh b/testcases/network/tcp_cmds/clockdiff/clockdiff01.sh
deleted file mode 100755
index 4058fbe11..000000000
--- a/testcases/network/tcp_cmds/clockdiff/clockdiff01.sh
+++ /dev/null
@@ -1,30 +0,0 @@
-#!/bin/sh
-# SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) 2016-2019 Oracle and/or its affiliates. All Rights Reserved.
-# Author: Alexey Kodanev <alexey.kodanev@oracle.com>
-
-TST_TESTFUNC="do_test"
-TST_NEEDS_ROOT=1
-TST_NEEDS_CMDS="cut clockdiff"
-
-
-do_test()
-{
-	tst_res TINFO "check time delta for $(tst_ipaddr)"
-
-	local output=$(clockdiff $(tst_ipaddr))
-
-	if [ $? -ne 0 ]; then
-		tst_res TFAIL "clockdiff failed to get delta"
-	else
-		delta=$(echo "$output" | cut -d' ' -f2,3)
-		if [ "$delta" = "0 0" ]; then
-			tst_res TPASS "delta is 0 as expected"
-		else
-			tst_res TFAIL "not expected data received: '$output'"
-		fi
-	fi
-}
-
-. tst_net.sh
-tst_run
diff --git a/testcases/network/tcp_cmds/host/host01.sh b/testcases/network/tcp_cmds/host/host01.sh
deleted file mode 100755
index 9ed44bae3..000000000
--- a/testcases/network/tcp_cmds/host/host01.sh
+++ /dev/null
@@ -1,34 +0,0 @@
-#!/bin/sh
-# SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) 2020 Petr Vorel <pvorel@suse.cz>
-# Copyright (c) Kry Maincent <kory.maincent@bootlin.com> 2020
-# Copyright (c) Manoj Iyer <manjo@mail.utexas.edu> 2003
-# Copyright (c) Robbie Williamson <robbiew@us.ibm.com> 2001
-# Copyright (c) International Business Machines  Corp., 2000
-
-TST_TESTFUNC="do_test"
-TST_NEEDS_CMDS="awk grep host hostname tail"
-
-
-do_test()
-{
-	local lhost="${HOSTNAME:-$(hostname)}"
-	local addr
-
-	tst_res TINFO "test basic functionality of the host command"
-	tst_res TINFO "lhost: $lhost"
-
-	if addr=$(host $lhost); then
-		addr=$(echo "$addr" | grep address | tail -1 | awk '{print $NF}')
-		if [ -z "$addr" ]; then
-			tst_res TFAIL "empty address"
-			return
-		fi
-		EXPECT_PASS host $addr \>/dev/null
-	else
-		tst_res TFAIL "host $lhost on local machine failed"
-	fi
-}
-
-. tst_net.sh
-tst_run
diff --git a/testcases/network/tcp_cmds/telnet/Makefile b/testcases/network/tcp_cmds/telnet/Makefile
deleted file mode 100644
index 90e879de2..000000000
--- a/testcases/network/tcp_cmds/telnet/Makefile
+++ /dev/null
@@ -1,29 +0,0 @@
-#
-#    network/tcp_cmds/telnet testcases Makefile.
-#
-#    Copyright (C) 2009, Cisco Systems Inc.
-#
-#    This program is free software; you can redistribute it and/or modify
-#    it under the terms of the GNU General Public License as published by
-#    the Free Software Foundation; either version 2 of the License, or
-#    (at your option) any later version.
-#
-#    This program is distributed in the hope that it will be useful,
-#    but WITHOUT ANY WARRANTY; without even the implied warranty of
-#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#    GNU General Public License for more details.
-#
-#    You should have received a copy of the GNU General Public License along
-#    with this program; if not, write to the Free Software Foundation, Inc.,
-#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
-#
-# Ngie Cooper, July 2009
-#
-
-top_srcdir		?= ../../../..
-
-include $(top_srcdir)/include/mk/env_pre.mk
-
-INSTALL_TARGETS		:= telnet01.sh
-
-include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/network/tcp_cmds/telnet/telnet01.sh b/testcases/network/tcp_cmds/telnet/telnet01.sh
deleted file mode 100755
index 93343b995..000000000
--- a/testcases/network/tcp_cmds/telnet/telnet01.sh
+++ /dev/null
@@ -1,96 +0,0 @@
-#!/bin/sh
-#   Copyright (c) International Business Machines  Corp., 2000
-#
-#   This program is free software;  you can redistribute it and/or modify
-#   it under the terms of the GNU General Public License as published by
-#   the Free Software Foundation; either version 2 of the License, or
-#   (at your option) any later version.
-#
-#   This program is distributed in the hope that it will be useful,
-#   but WITHOUT ANY WARRANTY;  without even the implied warranty of
-#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
-#   the GNU General Public License for more details.
-#
-#   You should have received a copy of the GNU General Public License
-#   along with this program;  if not, write to the Free Software
-#   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
-#
-#    03/01 Robbie Williamson (robbiew@us.ibm.com)
-
-TCID="telnet01"
-TST_TOTAL=1
-
-TST_USE_LEGACY_API=1
-
-setup()
-{
-	tst_require_cmds telnet expect
-
-	if [ -z $RUSER ]; then
-		RUSER=root
-	fi
-
-	if [ -z $PASSWD ]; then
-		tst_brkm TCONF "Please set PASSWD for $RUSER."
-	fi
-
-	if [ -z $RHOST ]; then
-		tst_brkm TCONF "Please set RHOST."
-	fi
-
-	if [ -z $LOOPCOUNT ]; then
-		LOOPCOUNT=25
-	fi
-}
-
-do_test()
-{
-	tst_resm TINFO "Starting"
-
-	for i in $(seq 1 ${LOOPCOUNT})
-	do
-		telnet_test || return 1
-	done
-}
-
-telnet_test()
-{
-	tst_resm TINFO "login with telnet($i/$LOOPCOUNT)"
-
-	expect -c "
-		spawn telnet $RHOST
-
-		expect -re \"login:\"
-		send \"$RUSER\r\"
-
-		expect -re \"Password:\"
-		send \"$PASSWD\r\"
-
-		expect {
-			\"incorrect\" {
-				exit 1
-			} \"$RUSER@\" {
-				send \"LC_ALL=C ls -l /etc/hosts | \\
-				       wc -w > $RUSER.$RHOST\rexit\r\";
-				exp_continue}
-		}
-
-	" > /dev/null || return 1
-
-	tst_resm TINFO "checking telnet status($i/$LOOPCOUNT)"
-	tst_rhost_run -u $RUSER -c "grep -q 9 $RUSER.$RHOST" || return 1
-	tst_rhost_run -u $RUSER -c "rm -f $RUSER.$RHOST"
-}
-
-. tst_net.sh
-
-setup
-
-do_test
-if [ $? -ne 0 ]; then
-	tst_resm TFAIL "Test $TCID failed."
-else
-	tst_resm TPASS "Test $TCID succeeded."
-fi
-
-tst_exit
diff --git a/testcases/network/xinetd/Makefile b/testcases/network/xinetd/Makefile
deleted file mode 100644
index b789b2a3a..000000000
--- a/testcases/network/xinetd/Makefile
+++ /dev/null
@@ -1,11 +0,0 @@
-# SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (C) 2009, Cisco Systems Inc.
-# Ngie Cooper, July 2009
-
-top_srcdir		?= ../../..
-
-include $(top_srcdir)/include/mk/env_pre.mk
-
-INSTALL_TARGETS		:= xinetd_tests.sh
-
-include $(top_srcdir)/include/mk/generic_leaf_target.mk
diff --git a/testcases/network/xinetd/xinetd_tests.sh b/testcases/network/xinetd/xinetd_tests.sh
deleted file mode 100755
index 25ec91d26..000000000
--- a/testcases/network/xinetd/xinetd_tests.sh
+++ /dev/null
@@ -1,113 +0,0 @@
-#!/bin/sh
-# SPDX-License-Identifier: GPL-2.0-or-later
-# Copyright (c) 2020 Petr Vorel <pvorel@suse.cz>
-# Copyright (c) 2016 Oracle and/or its affiliates. All Rights Reserved.
-# Copyright (c) International Business Machines  Corp., 2001
-
-TST_SETUP="setup"
-TST_CLEANUP="cleanup"
-TST_NEEDS_CMDS="diff telnet in.telnetd xinetd"
-TST_NEEDS_TMPDIR=1
-TST_TESTFUNC="do_test"
-TST_CNT=2
-
-. daemonlib.sh
-
-setup()
-{
-	[ -f "/usr/lib/systemd/system/telnet.socket" ] && \
-		tst_brk TCONF "xinetd doesn't manage telnet"
-
-	check_addr="127.0.0.1"
-	ip a | grep -q inet6 && check_addr="$check_addr ::1"
-
-	cat > tst_xinetd.conf.1 <<-EOF
-defaults
-{
-    instances      = 25
-    log_type       = FILE /var/log/servicelog
-    log_on_success = HOST PID
-    log_on_failure = HOST
-    disabled       = telnet
-}
-EOF
-
-	cat > tst_xinetd.conf.2 <<-EOF
-defaults
-{
-    instances      = 25
-    log_type       = FILE /var/log/servicelog
-    log_on_success = HOST PID
-    log_on_failure = HOST
-    # disabled       = telnet
-}
-
-service telnet
-{
-    socket_type     = stream
-    protocol        = tcp
-    wait            = no
-    user            = root
-    server          = /usr/sbin/in.telnetd
-    server_args     = -n
-    no_access       =
-    flags           = IPv6
-}
-EOF
-	ROD mv /etc/xinetd.conf xinetd.conf.orig
-}
-
-cleanup()
-{
-	[ -f xinetd.conf.orig ] && \
-		mv xinetd.conf.orig /etc/xinetd.conf
-
-	restart_daemon xinetd
-}
-
-restart_xinetd()
-{
-	tst_res TINFO "restart xinetd"
-	restart_daemon xinetd > tst_xinetd.out 2>&1
-	if [ $? -ne 0 ]; then
-		cat tst_xinetd.out
-		tst_brk TBROK "unable to restart service with telnet disabled"
-	fi
-
-	grep -qi "fail" tst_xinetd.out && \
-		tst_brk TBROK "xinetd failed to restart"
-}
-
-xinetd_test()
-{
-	local cnt=$1
-	local desc="$2"
-	local pattern="$3"
-	local a p
-
-	tst_res TINFO "install the new config file with telnet $desc"
-	ROD mv tst_xinetd.conf.$cnt /etc/xinetd.conf
-	restart_xinetd
-
-	for a in $check_addr; do
-		p=$(echo $pattern | sed "s/ADDR/$a/")
-		if ! echo '' | telnet $a 2>&1 | grep -qiE "$p"; then
-			tst_res TFAIL "not expected output for 'telnet $a'"
-			return
-		fi
-	done
-	tst_res TPASS "expected output with telnet $desc"
-}
-
-do_test()
-{
-	case $1 in
-	1) xinetd_test $1 "disabled" \
-			"telnet: (connect to address ADDR|Unable to connect to remote host): Connection refused";;
-	2) xinetd_test $1 "enabled" \
-			"Connection closed by foreign host";;
-	esac
-}
-
-. tst_net.sh
-tst_run
diff --git a/testcases/open_posix_testsuite/conformance/interfaces/shm_open/37-1.c b/testcases/open_posix_testsuite/conformance/interfaces/shm_open/37-1.c
index 09b4d6657..d9da1cab0 100644
--- a/testcases/open_posix_testsuite/conformance/interfaces/shm_open/37-1.c
+++ b/testcases/open_posix_testsuite/conformance/interfaces/shm_open/37-1.c
@@ -1,4 +1,4 @@
-// SPDX-License-Identifier: GPL-2.0
+// SPDX-License-Identifier: GPL-2.0-only
 /*
  * Test that the shm_open() function sets errno = EINVAL if the shm_open()
  * operation is not supported for the given name.
diff --git a/testcases/open_posix_testsuite/include/mk/config.mk.in b/testcases/open_posix_testsuite/include/mk/config.mk.in
index c9a4b5c5a..20422e0f1 100644
--- a/testcases/open_posix_testsuite/include/mk/config.mk.in
+++ b/testcases/open_posix_testsuite/include/mk/config.mk.in
@@ -14,4 +14,4 @@ testdir_rel := @testdir@
 testdir     := ${prefix}/${testdir_rel}
 testdir_bin := ${testdir}/bin
 
-CFLAGS  += -std=c99 -D_POSIX_C_SOURCE=200809L -D_XOPEN_SOURCE=700 -W -Wall
+CFLAGS  += -std=c99 -D_POSIX_C_SOURCE=200809L -D_XOPEN_SOURCE=700 -Wall -Wextra
diff --git a/testcases/open_posix_testsuite/include/posixtest.h b/testcases/open_posix_testsuite/include/posixtest.h
index d1b298488..01d9ef2a5 100644
--- a/testcases/open_posix_testsuite/include/posixtest.h
+++ b/testcases/open_posix_testsuite/include/posixtest.h
@@ -20,9 +20,29 @@
 #define ARRAY_SIZE(arr) (sizeof(arr) / sizeof(arr[0]))
 #endif
 
-#define PTS_ATTRIBUTE_NORETURN		__attribute__((noreturn))
-#define PTS_ATTRIBUTE_UNUSED		__attribute__((unused))
-#define PTS_ATTRIBUTE_UNUSED_RESULT	__attribute__((warn_unused_result))
+/* __attribute__ is a non portable gcc extension */
+/* TODO: Add support for C23 attributes */
+#if defined __has_attribute
+# if __has_attribute(noreturn)
+#  define PTS_ATTRIBUTE_NORETURN      __attribute__((noreturn))
+# endif
+# if __has_attribute(unused)
+#  define PTS_ATTRIBUTE_UNUSED        __attribute__((unused))
+# endif
+# if __has_attribute(warn_unused_result)
+#  define PTS_ATTRIBUTE_UNUSED_RESULT __attribute__((warn_unused_result))
+# endif
+#endif
+
+#ifndef PTS_ATTRIBUTE_NORETURN
+# define PTS_ATTRIBUTE_NORETURN
+#endif
+#ifndef PTS_ATTRIBUTE_UNUSED
+# define PTS_ATTRIBUTE_UNUSED
+#endif
+#ifndef PTS_ATTRIBUTE_UNUSED_RESULT
+# define PTS_ATTRIBUTE_UNUSED_RESULT
+#endif
 
 #define PTS_WRITE_MSG(msg) do { \
          if (write(STDOUT_FILENO, msg, sizeof(msg) - 1)) { \
diff --git a/testcases/realtime/Makefile b/testcases/realtime/Makefile
index a7491654c..61663bfd9 100644
--- a/testcases/realtime/Makefile
+++ b/testcases/realtime/Makefile
@@ -36,7 +36,6 @@ include $(top_srcdir)/include/mk/env_pre.mk
 ifeq ($(filter autotools %clean .gitignore gitignore.%,$(MAKECMDGOALS)),)
 include $(abs_srcdir)/config.mk
 endif
-include $(top_srcdir)/include/mk/gitignore.mk
 
 LIBDIR			:= lib
 FILTER_OUT_DIRS		:= $(LIBDIR) m4
diff --git a/tools/create_dmesg_entries_for_each_test.awk b/tools/create_dmesg_entries_for_each_test.awk
index ffd807fb4..b21364ae0 100644
--- a/tools/create_dmesg_entries_for_each_test.awk
+++ b/tools/create_dmesg_entries_for_each_test.awk
@@ -28,6 +28,8 @@ NF && ! /^#/ {
 		s = s " " $i
 	}
 	sub(/[;]+$/, "", s)
+	s = s "; EXIT_CODE=$?"
 	s = s "; dmesg > " DMESG_DIR "/" $1 ".dmesg.log"
+	s = s "; exit $EXIT_CODE"
 	print s
 }
diff --git a/utils/sctp/func_tests/test_1_to_1_events.c b/utils/sctp/func_tests/test_1_to_1_events.c
index 447845ff3..889d2ff33 100644
--- a/utils/sctp/func_tests/test_1_to_1_events.c
+++ b/utils/sctp/func_tests/test_1_to_1_events.c
@@ -96,6 +96,7 @@ main(void)
 	/* Create the client socket.  */
 	clt_sk = test_socket(AF_INET, SOCK_STREAM, IPPROTO_SCTP);
 
+	memset(&event, 0, sizeof(struct sctp_event_subscribe));
 	event.sctp_data_io_event = 1;
 	event.sctp_association_event = 1;
 	event.sctp_shutdown_event = 1;
```

